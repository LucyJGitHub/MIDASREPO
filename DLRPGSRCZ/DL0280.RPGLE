     H DEBUG
     F*****************************************************************
/*S*D ***RPGBASE*******************************************************                      BUG6293
/*STD *  RPGBASEBND                                                   *                      BUG6293
/*EXI *  TEXT('Midas DL Deals update phase 2')                        *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *  DL0280 - DEALS FILE UPDATE                                   *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *                                                               *
      *****************************************************************
      *** Code Stripped ***                                           **
      /COPY DLCPYSRC,DL0280FHD5                                                             RT937392
      /COPY DLCPYSRC,DL0280FHD3                                                            BUG27027A
      /COPY DLCPYSRC,DL0280FHD1
      *** Code Stripped ***                                           *
      /COPY DLCPYSRC,DL0280FHD6                                                             RT937392
      /COPY DLCPYSRC,DL0280FHD4                                                            BUG27027A
      /COPY DLCPYSRC,DL0280FHD2
      /COPY WNCPYSRC,DL0280F001
      *****************************************************************
     FDLOPOSPD  O  A E             DISK
     FCLINT     IF   E           K DISK                                         S01383
     FSDBRTDL1  IF   E           K DISK                                         S01383
     FSDCBRTL1  IF   E           K DISK                                         S01383
     FSDFRCTL0  IF   E           K DISK                                         CRE007
     FINTPSL25  UF A E           K DISK    EXTIND(*INU1)                        S01383
     F                                     RENAME(INTPSDDF:INTPSDDX)            068074
     F                                     RENAME(COINTDDF:COINTDDX)            068074
     FTABTG30   IT   F   40        DISK                                         S01093
     F***DEALS** IF  F    2247  6AI     2 DISK                                         CAS004 CAS005
     F***DEALS** IF  F    2441  6AI     2 DISK                                         CAS005 CAS006
     F***DEALS** IF  F    2448  6AI     2 DISK                                         CAS006 CDL017
     F*DEALS****IF   F 2540     6AIDISK    KEYLOC(2)                                  CDL017 CAS008
     F*DEALS****IF   F 2550     6AIDISK    KEYLOC(2)                                   CAS008 CDL038
     FDEALS     IF   F 2606     6AIDISK    KEYLOC(2)                                         CDL038
     F/COPY WNCPYSRC,DL0280F002
0014 FDAMSX     IF   E           K DISK                                         BHF641
     FDLEMDAPD  UF A E           K DISK                                         BUG4426
     F                                     RENAME(DEAMSDIF:DLEMDAD0)            BUG4426
     FDLDTSCPD  IF   E           K DISK    USROPN                               CIR001
     FDLCFSCPD  IF   E           K DISK    USROPN                               CIR001
     FDLPCSCPD  IF   E           K DISK    USROPN                               CIR001
     FDLDGUPL1  UF   E           K DISK
0017 FDKEYSHH   O  A F  128        DISK
     F***DKEYSDP O   F     332            DISK                      A                  CGL020 CGL029
     F*DKEYSDP**O  A F  350        DISK                                                       CDL038
     F*DKEYSDP**O  A F  364        DISK                                                CDL038 CSD027
     FDKEYSDP   O  A F  370        DISK                                                       CSD027
0017 FDKEYSZZ   O  A F  128        DISK
     FPTYSEQPD  UF A E           K DISK    EXTIND(*INU1)                        058320
     F/COPY WNCPYSRC,DL0280F004
0019 FMINTNMH   O  A F   64        DISK    EXTIND(*INU2)
0019 FMINTNMD   O  A F   64        DISK    EXTIND(*INU2)
0019 FMINTNMT   O  A F   64        DISK    EXTIND(*INU2)
     FFDDTSTYT  IF   E           K DISK                                                       207288
     FDL0280P1  O    F  132        PRINTER INFDS(SPOOL)                         S01117
     F                                     OFLIND(*INOF)
     F                                     USROPN
     FDL0280P2  O    F  132        PRINTER INFDS(SPOOL2)
     F                                     USROPN
     F/COPY WNCPYSRC,DL0280F005
     FDL0280AU  O    F  132        PRINTER INFDS(SPOOLU)                        S01117
     F                                     OFLIND(*INOA)
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0280FFP3                                           S01408
     F*                                                                   S01408
     F***DLBHISPDO   F    1249            DISK                      A                  CAS001 CAS005
     F*DLBHISPD* O  A F 1291        DISK                                                      CDL038
     F*DLBHISPD* O  A F 1367        DISK                                             CDL038 BUG25189
     F***DLBHISPD**O**A F 1368        DISK                                           BUG25189 CSW212
     FDLBHISPD  O  A F 2025        DISK                                                       CSW212
      *                                                                                       CAS001
     F***DLCHISPDO   F    1636            DISK                      A                  CAS001 CAS005
     F*DLCHISPD*O  A F 1720        DISK                                                       CDL038
     F*DLCHISPD*O  A F 1901        DISK                                                CDL038 CAS009
     F***DLCHISPD  O  A F 2013        DISK                                             CAS009 233324
     F*DLCHISPD**O  A F 2039        DISK                                             233324 BUG24989
     F***DLCHISPD  O  A F 2083        DISK                                         BUG24989 AR782597
     F***DLCHISPD  O  A F 2090        DISK                                           AR782597 CRE073
     FDLCHISPD  O  A F 2139        DISK                                                       CRE073
      *                                                                                       CAS001
     F***DLDHISPDO   F    1167            DISK                      A                  CAS001 CAS005
     F*DLDHISPD*O  A F 1244        DISK                                                       CDL038
     F*DLDHISPD*O  A F 1320        DISK                                                CDL038 CAS009
     F***DLDHISPD  O  A F 1432        DISK                                           CAS009 AR782597
     FDLDHISPD  O  A F 1445        DISK                                                     AR782597
      *                                                                                       CAS001
     F*DLEHISPD*O  A F 1047        DISK                                                CEU003 CDL038
     FDLEHISPD  O  A F 1105        DISK                                                       CDL038
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0280FFP4                                           S01408
     F*                                                                   S01408
     F***DLGHISPDO   F    2212            DISK                      A                  CAP056 CAS005
     F***DLGHISPDO   F    2441            DISK                      A                  CAS005 CAS006
     F*DLGHISPDO**F****2448            DISK                      A                     CAS006 217684
     F*DLGHISPD*O**A*F*2468*****   DISK                                                217684 CAS008
     F*DLGHISPD*O  A F 2550        DISK                                                CAS008 CDL038
     FDLGHISPD  O  A F 2606        DISK                                                       CDL038
      *                                                                                       CAS001
     F***DEALSL1 UP  F    2247  6AI     2 DISK                                         CAS004 CAS005
     F***DEALSL1 UP  F    2441  6AI     2 DISK                                         CAS005 CAS006
     F*DEALSL1*UP*F****2448  6AI     2 DISK                                            CAS006 217684
     F***DEALSL1 UP  F    2468  6AI     2 DISK                                         217684 CGL029
     F*DEALSL1**UP***F 2540     6AIDISK    KEYLOC(2)                                   CGL029 CAS008
     F*DEALSL1**UP   F 2550     6AIDISK    KEYLOC(2)                                   CAS008 CDL038
     F***DEALSL1   UP   F 2606     6AIDISK    KEYLOC(2)                              CDL038 AR866124
     FDEALSL1   UP   F 2608     6AIDISK    KEYLOC(2)                                        AR866124
     FFDDTSTL0  IF   E           K DISK                                                       CAS009
     FPMHSEXPD  IF   E           K DISK    USROPN                               S01486
     FPMPORTPD  IF   E           K DISK    USROPN                               S01486
     F/COPY WNCPYSRC,DL0280F003
     F*****MMDELULL  IF   F 1154     6AIDISK    KEYLOC(2)                            S01486   205045
     FDEALSALL  IF   F 1154     6AIDISK    KEYLOC(2)                                          205045
     F                                     USROPN
     FSDSTAAL1  IF   E           K DISK    USROPN                                             CDL013
     FGLWHTCL0  UF A E           K DISK    USROPN                                             CDL013
     FGLXTAXL0  UF A E           K DISK    USROPN                                             CDL013
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0280FFPG                                           S01408
     FDLTCSTPD  O  A F   73        DISK    USROPN
     FDLTCSTV0  UF   E           K DISK    USROPN
     F                                     RENAME(DLTCSTP0:DLTCSTP1)
     FDLTCSTV1  UF   E           K DISK    USROPN
     F                                     RENAME(DLTCSTP0:DLTCSTP2)
     FDLTCSTV2  UF   E           K DISK    USROPN
     F                                     RENAME(DLTCSTP0:DLTCSTP3)
     FDLTCSTV4  IF   E           K DISK    USROPN
     F                                     RENAME(DLTCSTP0:DLTCSTP4)
     FDEALDCV0  IF   E           K DISK    USROPN
     F                                     RENAME(DEALSDCF:DLDCSTMT)
     FDLCCGDL0  IF   E           K DISK    USROPN                               CDL006
      **  Midas DL Charge Types Codes file (FDCCY/FDCCOM).                CDL006
     FDLGXSTL0  IF   E           K DISK                                         CIR003
      *                                                                                       CGL031
      **  Midas SD Customer Income                                                            CGL031
     F***SDCSINL6  IF   E           K DISK                                          CGL031 MD024874A
     FSDCSINL10 IF   E           K DISK                                                    MD024874A
      *                                                                   CDL006
     FASHTRNLA  IF   E           K DISK
     FASHTRNLB  IF   E           K DISK                                                       228701
     F                                     RENAME(ASHTRND0:ASHTRNDB)                          228701
     FASFHTRL3  IF   E           K DISK                                                       228701
     FDLDLHBL0  IF   E           K DISK
     F                                     RENAME(DEALSDBF:DLDLHB)
     FDLDLHCL0  IF   E           K DISK
     F                                     RENAME(DEALSDCF:DLDLHC)
      *                                                                                       CAS006
     FASHGLKL1  IF   E           K DISK
      ** Midas Hedge linkage file retrieval by Hedge id                                       CAS006
      *                                                                                       CAS006
     FDLNPVPL2  UF   E           K DISK
      *                                                                                       CAS005
     FDLFSACL0  UF   E           K DISK
      **  Multiple Settlement Accounts - CDL018                                               CDL018
      *                                                                                       CDL018
     FDLDEALL5  UF   E           K DISK                                                            B
      **  Midas DL Deals Extension File                                                      BUG3937
      *                                                                                      BUG3937
     FDLDIRHPD  UF A E           K DISK                                                       CDL034
      **  Midas DL Deals Interest History file                                                CDL034
     F***MMCFLSPD**UF A E           K DISK                                           CAS009 BUG13075
     FMMCFLSL0  UF A E           K DISK                                                     BUG13075
     FMMHISTL0  IF A E           K DISK                                                       232928
     F/COPY WNCPYSRC,DL0280FFP1                                           S01408
      *                                                                                       CDL033
     FDLFRSCL5  IF   E           K DISK    USROPN                                             CDL033
      *                                                                                       CDL033
      ** Midas DL FRCD Issued Date Schedule                                                   CDL033
      ** (unprocessed rate change dates) file                                                 CDL033
      *                                                                                       CDL033
     FDLFRSCL0  UF   E           K DISK    USROPN                                             CDL033
     F                                     RENAME(DLFRSCD0:DLFRSCD1)                          CDL033
      ** Midas DL FRCD Issued Date Schedule update file                                       CDL033
      *                                                                                       233277
      ** Midas SD Joint Account Member details by Account Holders                             233277
     FSDJACCLB  IF   E           K DISK                                                       233277
     F/COPY WNCPYSRC,DLH00065
      *                                                                                       233277
      ** Midas SD Customer Income file                                                        233277
     FSDCSINPD  O    E             DISK                                                       233277
     F                                     RENAME(SDCSIND0:SDCSINF0)                          233277
      *                                                                                       233277
      ** Midas SD Customer Income by Deal/Trade Number                                        233324
     FSDCSINLD  UF   E           K DISK                                                       233324
     F                                     RENAME(SDCSIND0:SDCSINDD)                          233324
      *                                                                                       CDL033
      ** Midas SD Interest Payment History File by Cust/Branch                                CER048
     FSDINPHL2  UF   E           K DISK                                                       CER048
      *                                                                                       CER048
      ** Customer Details by Country of Tax                                                BUG26037B
     FSDACTXL1  IF   E           K DISK                                                    BUG26037B
      *                                                                                     AR755195
     FHISTSAA   O    E             DISK    PREFIX(H_)                                       AR755195
     FDLIWHTTD  O    E             DISK                                                       CRE105
0021 F********************************************************************
0022 F* FUNCTION OF INDICATORS                                                              AR866124
     F/COPY DLCPYSRC,DL0280FIND                                                             AR866124
0110 F********************************************************************
      *                                                                   CDL006
      **  Arrays used to retrieve percentage of current range for         CDL006
      **  Deal Principal Amount.                                          CDL006
      *                                                                   CDL006
     D/COPY WNCPYSRC,DL0280EEP1                                           S01408
     D BBE             S             15    DIM(2) CTDATA PERRCD(1)                            CDL099
      *                                                                                       CDL033
      ** FRCD arrays.                                                                         CDL033
      *                                                                                       CDL033
      ** Array 1 contains the following dates: interest accrual                               CDL033
      ** control date (for short term rate) and rate fix date.                                CDL033
      ** It is used to determine sequence of processing for                                   CDL033
      ** the following: short term rate and rate fix date.                                    CDL033
      *                                                                                       CDL033
     D CFA1            S              5  0 DIM(2)                                             CDL033
      *                                                                                       CDL033
      ** Array 2 is used to determine what processing is                                      CDL033
      ** to be executed: S = short term rate, F = rate fix date.                              CDL033
      *                                                                                       CDL033
     D CFA2            S              1    DIM(2)                                             CDL033
      *                                                                                       CDL033
     D CPY@            S             80    DIM(1) CTDATA PERRCD(1)                               S01
0113 D AKY             S              1    DIM(10)
     D/COPY WNCPYSRC,DL0280EEP2                                           S01408
0117 D ZFMD            S              2    DIM(12) CTDATA PERRCD(12)            ZFREQ SR. ARRAY
0118 D ZYDY            S              4  0 DIM(4) CTDATA PERRCD(4)              ZDATE1/2 SR.ARRAY
0119 D ZMDY            S              3  0 DIM(13) CTDATA PERRCD(13)            ZDATE1/2 SR.ARRAY
0120 D ZMNM            S              3    DIM(12) CTDATA PERRCD(12)            ZDATE2 SR. ARRAY
     D/COPY WNCPYSRC,DL0280E001
     D NEV             S             15    DIM(12) CTDATA PERRCD(1)                              CIR
      ***  Array 'NEV' was changed to add 5 elements                      CIR001
     D/COPY WNCPYSRC,DL0280E002
      *                                                                   CIR001
     D CY              S              3    DIM(200) FROMFILE(TABTG30) PERRCD(1) CCY/CCY DETAILS  S01
     D CYD             S             37    DIM(200) ALT(CY)
     D FRQ             S              1    DIM(5) CTDATA PERRCD(5)              FREQS FOR NWD CHKS01
     D**********/COPY ZSRSRC,ZHOLE                                        S01195             BUG6293
     D/COPY ZSRSRC,ZHOLELE                                                                   BUG6293
     D/COPY WNCPYSRC,DL0280E004
     D*@DTP*****       S              2    DIM(30) CTDATA PERRCD(30)                   CDL    CDL033
     D*@DTP*****       S              2    DIM(31) CTDATA PERRCD(31)             CDL CDL033 BUG11013
     D @DTP            S              2    DIM(32) CTDATA PERRCD(32)                        BUG11013
     D/COPY WNCPYSRC,DL0280E005
     D POWERS          S              7  3 DIM(7) CTDATA PERRCD(1)                               S01
     D*KEY******       S              1    DIM(18)                                            CDL038
     D*TKEY*****       S             18    DIM(500)                                           CDL038
     D*TAMT*****       S             13  0 DIM(500)                                           CDL038
     D KEY             S              1    DIM(22)                                           CDL038
     D*TKEY*****       S             22    DIM(990)                                    CDL038 262532
     D*TAMT*****       S             13  0 DIM(990)                                    CDL038 262532
     D TKEY            S             22    DIM(9999)                                          262532
     D/COPY WNCPYSRC,DLH00066
     D TAMT            S             13  0 DIM(9999)                                          262532
     D***ZIBEGBV         S              5  0 DIM(99)                               MD031283 MD033566
     D ZIBEGBV         S              5  0 DIM(999)                                         MD033566
     D***ZIENDBV         S              5  0 DIM(99)                               MD031283 MD033566
     D ZIENDBV         S              5  0 DIM(999)                                         MD033566
     D***BSRTBV*         S             11  7 DIM(99)                               MD031283 MD033566
     D BSRTBV          S             11  7 DIM(999)                                         MD033566
     D**********/COPY ZSRSRC,ZDATE9Z1                                     066550             BUG6293
     D/COPY ZSRSRC,ZDATE9Z1LE                                                                BUG6293
     D**********/COPY ZSRSRC,ZPOWERZ1                                     S01486             BUG6293
     D/COPY ZSRSRC,ZPOWERZ1IL                                                                BUG6293
     D/COPY WNCPYSRC,DL0280E003
     D ACR             S              2    DIM(8) CTDATA PERRCD(1)
     D CYDDS           DS                                                       S01093
     D**   CURRENCY DETAILS FROM TABTG10                                  S01093
     D  CDP                    1      1  0                                      S01093
     D  SPOT                   2      8P 8                                      S01093
     D  MDIN                   9      9  0                                      S01093
     D  ERLC                  10     16P 8                                      S01093
     D  TNOT                  17     17  0                                      S01093
     D  CCNM                  18     31                                         S01093
     D  TEAC                  32     35                                         S01093
     D  SSNO                  36     37  0                                      S01093
     D/COPY WNCPYSRC,DL0280IIP3                                           S01408
     D*                                                                   S01119
     D UFRDKY          DS                                                       S01119
     D*   DATA STRUCTURES FOR FRA/IRS MOVE STATEMENTS                     S01119
     D  UCUCY                  1      3                                         S01119
     D  PCCY                   1      3                                         S01119
     D  PSETM                  4      5  0                                      S01119
     D**********                              6  17 UPACC                              S01119 CGL029
     D  UPACQQ                 6     17
     D  USLIP                 18     22  0                                      S01119
     D  UBRTT                 23     24  0                                      S01119
     D  UBRTE                 25     35  7                                      S01119
     D  URTSP                 36     46  7                                      S01119
     D  UEINR                 47     57  7                                      S01119
     D  UPAMT                 58     70  0                                      S01119
     D  POBR                  71     73                                         LN0711
     D  PSCY                  74     76                                         CEU003
     D  UPACC                 77     94
     D TFRDKY          DS                                                       S01119
     D  TCUCY                  1      3                                         S01119
     D  RSETM                  4      5  0                                      S01119
     D**********                              6  17 URACC                              S01119 CGL029
     D  URACQQ                 6     17
     D  TSLIP                 18     22  0                                      S01119
     D  TBRTT                 23     24  0                                      S01119
     D  TBRTE                 25     35  7                                      S01119
     D  TRTSP                 36     46  7                                      S01119
     D  TEINR                 47     57  7                                      S01119
     D  TPAMT                 58     70  0                                      S01119
     D  ROBR                  71     73                                         LN0711
     D  RSCY                  74     76                                         CEU003
     D  URACC                 77     94
     D FRDKY           DS                                                       S01119
     D  KYCCY                  1      3                                         S01119
     D  KYSETL                 4      5  0                                      S01119
     D**********                              6  17 KYOSTL                             S01119 CGL029
     D  QQOSTL                 6     17
     D  SLID                  18     22  0                                      S01119
     D  BRTT                  23     24  0                                      S01119
     D  NRBRTT                23     24                                         S01119
     D  BRTE                  25     35  7                                      S01119
     D  RTSP                  36     46  7                                      S01119
     D  FINTR                 47     57  7                                      S01119
     D  NRRT                  47     57  7                                      S01119
     D  NRRPUR                58     70  0                                      S01119
     D  KYSTBR                71     73                                         LN0711
     D  KYSCY                 74     76                                         CEU003
     D  KYOSTL                77     94
     D** DS TO CONVERT CUSTOMER NUMBER ( ALPHA <---> NUM )                S01486
     D                 DS                                                       S01486
     D**WWCNUM**               1      6  0                                      S01486        CSD027
     D  WWCNUM                 1      6                                         S01486        CSD027
     D  WWCUST                 1      6                                         S01486
     D WSETT           DS
     D**WWROCN**               1      6  0                                                    CSD027
     D**WWROBN**               7     12  0                                                    CSD027
     D**WWPOCN**              13     18  0                                                    CSD027
     D**WWPOBN**              19     24  0                                                    CSD027
     D  WWROCN                 1      6                                                       CSD027
     D  WWROBN                 7     12                                                       CSD027
     D  WWPOCN                13     18                                                       CSD027
     D  WWPOBN                19     24                                                       CSD027
     D SPOOL           DS                                                       S01117
     D* FILE INFORMATION DATA STRUCTURE                                   S01117
     D  SFILE                 83     92                                         S01117
     D  SFNUM                123    124B 0                                      S01117
     D SPOOL2          DS
      ** File Information Data Structure                                                      CAS005
      *                                                                                       CAS005
     D  SFILE2                83     92
     D  SFNUM2               123    124B 0
     D  PRTLNE               367    368B 0
     D/COPY WNCPYSRC,DL0280I016
     D SPOOLU          DS                                                       S01117
     D* FILE INFORMATION DATA STRUCTURE                                   S01117
     D  SFILEU                83     92                                         S01117
     D  SFNUMU               123    124B 0                                      S01117
      *** Code Stripped ***                                                                 AR937392
      /COPY DLCPYSRC,DL0280EXTN                                                             AR937392
      *                                                                                       CIR007
      ** Data Structure for Postings File                                                     CIR007
      *                                                                                       CIR007
     D***L3PSTR*     DS                            332                                 CGL020 CGL029
     D*L3PSTR***       DS           350                                                       CDL038
     D*L3PSTR***       DS           364                                                CDL038 CSD027
     D L3PSTR          DS           370                                                       CSD027
     D  LNRECI                 1      1
     D  AKEY1                  2      2
     D  AKEY2                  3      3
     D  AKEY3                  4      4
     D  AKEY4                  5      5
     D  AKEY5                  6      6
     D  AKEY6                  7      7
     D  AKEY7                  8      8
     D  AKEY8                  9      9
     D  AKEY9                 10     10
     D  AKEY0                 11     11
     D  DLNO                  12     17  0
     D**CNUM****              18     23  0                                                    CSD027
     D  CNUM                  18     23                                                       CSD027
     D  BRCA                  24     26
     D  ACSQ                  27     28  0
     D  KYDAT                 29     31P 0
     D  KYAMT                 32     38P 0
     D  L3YCCY                39     41
     D  L3SETL                42     43  0
     D**********                             44  55 L3OSTL                             CIR007 CGL029
     D  L3OSQQ                44     55
     D  REVI                  56     56  0
     D  KYOTH                 57     63P 0
     D  KYOCCY                64     66
     D  L3EXRT                67     73P 8
     D  VDAT                  74     76P 0
     D  L3SLID                77     79P 0
     D  MDAT                  80     82P 0
     D  L3BRTT                83     84  0
     D  L3BRTE                85     90P 7
     D  L3RTSP                91     96P 7
     D  INTR                  97    102P 7
     D  KYFED                103    105P 0
     D  YRAT                 106    111P 7
     D  FFIN                 112    112
     D  ZZ002                113    114
     D**CHNA****             115    118P 0                                                    CSD027
     D  CHNAX                115    118                                                       CSD027
     D  FACOA                119    128
     D  OPPRFC               129    132
     D  L3STBR               133    135
     D  BOKC                 136    137
     D  RBDN                 138    143  0
     D  PTFR                 144    147
     D  L3YSCY               148    150
     D  @RTFC                151    153
     D  F1FFLG               154    154
     D  F1FVAL               155    161P 0
     D  F1FPCT               162    166  2
     D  F1RACT               167    186
     D  F1RCTY               187    188
     D  F1RBNK               189    208
     D  F1RCDE               209    219
     D  F1PACT               220    239
     D  F1PCTY               240    241
     D  F1PBNK               242    261
     D  F1PCDE               262    272
     D  F1DACT               273    307
     D  F1DCTY               308    309
     D  F1DBNK               310    329
     D  F1SDAT               330    332P 0
     D  L3OSTL               333    350
     D**CHNA****             351    356                                             CSD027 AR1037807
     D**L3AKEY**             351    364                                                CDL038 CSD027
     D**L3AKEY**             357    370                                             CSD027 AR1037807
     D  L3AKEY               351    364                                                    AR1037807
     D  CHNA                 365    370                                                    AR1037807
     D/COPY WNCPYSRC,DL0280I010
     D*
      ** Data Structure for Access to Country Code Details                CRE007
      *                                                                   CRE007
      ** Data-structure used to set up arrays ZRA and ZPE from            CDL006
      ** DL Charges Types logical file DLCCGDL0, to locate the highest    CDL006
      ** range for Principal amount.                                      CDL006
      *                                                                   CDL006
      ** Data-structure used to set up field DBKEY.                       CDL006
     D DBKEY           DS            29                                         CDL006
     D  W1@3                   1      3                                         CDL006
     D  W4@5                   4      5                                         CDL006
     D  W1@6                   1      6                                         CDL006
     D  W7@10                  7     10                                         CDL006
     D  W11@12                11     12                                         CDL006
     D  W13@14                13     14                                         CDL006
     D  W15@17                15     17                                         CDL006
      *                                                                   CIR005
      ** DS for payment convention currencies                             CIR005
     D WCCYPY          DS                                                       CIR005
     D  WCYP1                  1      3                                         CIR005
     D  WCYP2                  4      6                                         CIR005
     D  WCYP3                  7      9                                         CIR005
     D  WCYP4                 10     12                                         CIR005
     D  WCYP5                 13     15                                         CIR005
     D  WCYP6                 16     18                                         CIR005
     D  WCYP7                 19     21                                         CIR005
     D  WCYP8                 22     24                                         CIR005
     D  WCYP9                 25     27                                         CIR005
     D  WCYP0                 28     30                                         CIR005
      *                                                                   CIR005
      ** DS for rate convention currencies                                CIR005
     D WCCYRT          DS                                                       CIR005
     D  WCYR1                  1      3                                         CIR005
     D  WCYR2                  4      6                                         CIR005
     D  WCYR3                  7      9                                         CIR005
     D  WCYR4                 10     12                                         CIR005
     D  WCYR5                 13     15                                         CIR005
     D  WCYR6                 16     18                                         CIR005
     D  WCYR7                 19     21                                         CIR005
     D  WCYR8                 22     24                                         CIR005
     D  WCYR9                 25     27                                         CIR005
     D  WCYR0                 28     30                                         CIR005
      *                                                                                       CAS005
     D XXKEY           DS
     D  XXBRCA                 1      3
     D  XXBKCD                 4      5
     D  XXCYCD                 6      8
     D  XXDTYP                 9     10
     D  XXDLST                11     12
     D  XXAKY                  9     18
     D  XXCLAS                19     22                                                       CDL038
      *                                                                                       233277
     D                 DS                                                                     233277
     D**P@ACCT**               1      4  0                                           233277 BUG10239
     D**P@ASEQ**               5      6  0                                           233277 BUG10239
     D**P@CNUM**               7     12  0                                           233277 BUG10239
     D**P@STYP**              13     14  0                                           233277 BUG10239
     D  P@ACCT                 1     10  0                                                  BUG10239
     D  P@ASEQ                11     12  0                                                  BUG10239
     D**P@CNUM**              13     18  0                                          BUG10239 CSD027A
     D  P@CNUM                13     18                                                      CSD027A
     D  P@STYP                19     20  0                                                  BUG10239
      *                                                                                       233324
     D                 DS                                                                     233324
     D  KDLLN                  1      6  0                                                    233324
     D PSysVal01       S             20A                                                      245308
     D PCurSet01       S            200A                                                      245308
     D PSysVal02       S             20A                                                      245308
     D PCurSet02       S            200A                                                      245308
     D PSysVal03       S             20A                                                      245308
     D PCurSet03       S            200A                                                      245308
     D PSysVal04       S             20A                                                      245308
     D PCurSet04       S            200A                                                      245308
     D PSysVal05       S             20A                                                      245308
     D PCurSet05       S            200A                                                      245308
     D PSysVal06       S             20A                                                      245308
     D PCurSet06       S            200A                                                      245308
     D PSysVal07       S             20A                                                      245308
     D PCurSet07       S            200A                                                      245308
     D PSysVal08       S             20A                                                      245308
     D PCurSet08       S            200A                                                      245308
     D PSysVal09       S             20A                                                      245308
     D PCurSet09       S            200A                                                      245308
     D PSysVal10       S             20A                                                      245308
     D PCurSet10       S            200A                                                      245308
      *                                                                                       CRE073
     D PBSRT           S                   LIKE(BRTEDM)                                       CRE073
     D PCNSP           S                   LIKE(CNSP)                                         CRE073
     D PCNSG           S              1A                                                      CRE073
     D PRDMT           S                   LIKE(RDMT)                                         CRE073
     D PRDFD           S                   LIKE(RDFD)                                         CRE073
     D PNWSP           S                   LIKE(BRTEDM)                                       CRE073
     D PFRAT           S                   LIKE(BRTEDM)                                     AR847249
     D CRE073          S              1A                                                      CRE073
     D*CFC006***       S              1A                                          AR1097176 MD020563
     D VdatDMW         S                   LIKE(VDATDM)                                     MD031283
     D DlnoDMSV        S                   LIKE(DLNODM)                                     MD031283
     D VdatDMSV        S                   LIKE(VDATDM)                                     MD031283
     D RtspDMSV        S                   LIKE(RTSP)                                       MD031283
     D WkIntBV         S                   LIKE(WKINT)                                      MD031283
     D***CtrBV**         S              2  0                                       MD031283 MD033566
     D CtrBV           S              3  0                                                  MD033566
     D***RtvBV**         S              2  0                                       MD031283 MD033566
     D RtvBV           S              3  0                                                  MD033566
     D HSTRAT          S              1A                                                    MD031283
     D NIDATF          S              1A                                                    MD031631
      *                                                                                       CRE073
     DGLWHT            DS             1                                                       CDL013
     DDLPOST                   1      1                                                       CDL013
      *                                                                                       CIR008
     D LDA             DS           256
      *                                                                                       CIR008
      ** Local Data Area for Database Error Details                                           CIR008
      *                                                                   CIR005
     D IRRTFX          C                   CONST('IRRTFXCNV')                   CIR005
     D ZAAML           C                   CONST('ZAAMLSETDL')
     D FRAAccNHL       C                   Const('DLFRAAccrueNoHdgLnk')                       245308
     D WPARML          C                   CONST('LECalcBasis6LeapYear')                    MD035545
     D UseDealCust     C                   Const('UseDealCustforEuTax')                     MD026788
     D UseHistRate     C                   Const('UseHistRateforBVDeal')                    MD031283
     D/COPY ZSRSRC,ZHOLILE                                                                   BUG6293
     D/COPY ZSRSRC,ZINTDYZ1LE                                                                BUG6293
     D/COPY ZSRSRC,ZDATE9Z2LE                                                                BUG6293
     D/COPY ZSRSRC,ZDAT10Z1LE                                                                BUG6293
     D/COPY ZSRSRC,ZFEB29Z1LE                                                                 CIR013
     D CIR014          S              1A                                                      CIR014
     D WCAPIT          S              1A                                                      CIR014
     D W_UNIPD         S                   LIKE(UNIPD)                                        CIR014
     D W_TNIPD         S                   LIKE(TNIPD)                                        CIR014
     D W_PRVI          S              1A                                                      CIR014
     D WSAMT           S              1A                                                    BUG13075
     D W#BSRD          S              1A                                                      CDL081
     D W#NBRD          S              1A                                                      CDL081
     D CDL081          S              1A                                                      CDL081
     D C#BASE          C                   CONST('BasCcyTaxRoundDown')                        CDL081
     D C#NBAS          C                   CONST('NBasCcyTaxRoundDown')                       CDL081
     D SUPFLG          S              1A                                                      CFC006
     D PNAME           S             10A                                                      CFC006
     D PCSEQ           S              5A                                                      CFC006
     D PSCTN           S             50A                                                      CFC006
     D W#INTR          S                   LIKE(INTR)                                      MD022399B
     D W#RTSP          S                   LIKE(RTSP)                                      MD022399B
     D W#BRTE          S                   LIKE(BRTE)                                      MD022399B
     D W#BRTT          S                   LIKE(BRTT)                                      MD022399B
     D CRE105          S              1A                                                      CRE105
     D WACNT           S             10A                                                      CRE105
     D WCUST           S              6A                                                      CRE105
     D WNOSC           S              2A                                                      CRE105
     D WCCY            S              3A                                                      CRE105
     D WBRCH           S              3A                                                      CRE105
     D WACCD           S             10A                                                      CRE105
     D WASEQ           S              2A                                                      CRE105
      *                                                                   066550
     IDEALSL1   NS  01    1 CH                                                  S01117
0123 I*    DEALS FILE - HEADER RECORD.
0129 I*
0130 I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
0131 I*
0132 I          NS  02    1 CD    8 CB
0133 I         OR   02    1 CE    8 CB
0134 I         OR   02    1 CM    8 CB
0135 I         OR   02    1 CR    8 CB
     I**********                              11249 UBDATA                             CAS001 CAS005
     I**********                        1 1291  UBDATA                                        CDL038
     I**********                        1 1367  UBDATA                               CDL038 BUG25189
     I**********                        1 1368  UBDATA                               BUG25189 CSW212
     I                                  1 2025  UBDATA                                        CSW212
0136 I                                  1    1  RECR
0137 I                                  2    7 0DLNO
0138 I                                  8    8  RCDT
0139 I                                  9   10 0RCDC
0140 I**********                       11   16 0CNUM                                          CSD027
0140 I                                 11   16  CNUM                                          CSD027
0141 I                                 17   19  BRCA          L1                S01117
0142 I                                 20   21  DTYP
0143 I                                 22   23  DLST
0144 I                             P   24   26 0DDAT
0145 I                             P   27   29 0VDAT
0146 I                             P   30   32 0OTDT
0147 I                                 33   34 0ACSQ                    39
0148 I                                 35   38  BRKC
0149 I                             P   39   45 0BAGE
0150 I                                 46   48  PCCY
0151 I                             P   49   55 0PAMT
0152 I                             P   56   62 8EXRT
0153 I                                 86   88  SLCY
0154 I                             P   89   95 0SLAM
0155 I                             P  117  123 0BCEQ
0156 I                             P  124  130 0OBCE
0157 I                             P  131  137 8LCXR
0158 I                                138  139 0PCST
0159 I**********                            140 151 OPCA                                      CGL029
     I                                140  151  OPCAQQ
0160 I                                152  161  TSCN
0161 I                                162  163 0SCST
0162 I**********                            164 175 OSCA                                      CGL029
     I                                164  175  OSCAQQ
0163 I                                176  185  TPCN
0164 I                             P  192  198 0ORPA
0165 I                             P  205  211 0ORSA
0166 I                                212  212 0FSLI
0167 I                             P  213  219 0LIPD
0168 I                             P  227  233 0DIPD
0169 I                             P  241  247 0SPPD
0170 I                             P  248  254 0SPLA
0171 I                                255  257  SPLC
0172 I                                258  260  ILCY
0173 I                             P  261  267 0ILAM
0174 I                                268  270  IDCY
0175 I                             P  271  277 0IDAM
0176 I                             P  278  284 0IDIA
0177 I                                285  290 0SODN                            S01434
0261 I                                300  309  FACOA                           S05452
0179 I                                310  344  SPI
0180 I                             P  347  352 7ILIR
0181 I                             P  353  358 7IDIR
0182 I                             P  360  366 0ILIA
0183 I                                370  370  DNSI
0184 I                                371  371  DSTI
0185 I                                372  372  CNFI
0186 I                                373  373  ACEI
0187 I                                374  374  TLXI
0188 I                                382  382 0ILCM
0189 I                                383  383 0IDCM
0190 I                             P  391  393 0ORED
0191 I                             P  394  396 0LCD
0192 I                                397  397  CHTP
0193 I                             P  398  400 0TNLU
0193 I                                401  402  BOKC                            S01182
     I                                403  408 0LNKDN
     I/COPY WNCPYSRC,DL0280I012
0193 I                                429  430 0RSTM                            096561
     I**********                      466  471 0ROBN                                          CSD027
     I**********                      472  477 0ROCN                                          CSD027
     I                                466  471  ROBN                                          CSD027
     I                                472  477  ROCN                                          CSD027
     I                                478  479 0PSTM
     I                                480  491  PONSQQ
     I                                492  499  PIBN
     I                                500  534  PIBA
     I**********                      535  540 0POBN                                          CSD027
     I**********                      541  546 0POCN                                          CSD027
     I                                535  540  POBN                                          CSD027
     I                                541  546  POCN                                          CSD027
     I                                547  554  RCRN
     I                                555  589  RCRA
     I                                590  597  RVNO
     I                                598  605  AWBN
     I                                606  640  AWBA
     I                                641  648  BENN
     I                                649  683  BENA
     I                               1037 1039  ORBR                            S01117
     I                               1040 1043  PRFC                            S01117
     I                               1044 1046  ROBR                            S01117
     I                               1047 1049  POBR                            S01117
     I                               1051 1051  JLRDF                           S01392
     I                               1052 1052  JDRDF                           S01392
     I                             P 1053 1059 0GCPCAP                          S01440
     I                             P 1060 1066 0GCSCAP                          S01440
     I                             P 1071 1077 0MGAM                            CAC001
     I                               1078 1080  MGCY                            CAC001
     I/COPY WNCPYSRC,DL0280I017
     I                               1150 1153  PTFR                            S01486
     I                               1155 1158  ICPC                            CAC001
     I                               1159 1159  NETBY                           126836
     I                               1160 1178  NETBR                           126836
     I                               1179 1179  NETSL                           126836
     I                               1180 1198  NETSR                           126836
     I                               1199 1199  MATCH                           126836
     I                               1200 1202  RSCY                            CEU003
     I                               1203 1205  PSCY                            CEU003
     I                               1206 1208  IC72                            CEU003
     I                               1209 1209  REPI                            CPB001
     I                               1210 1210  AUTH                            CAP051
     I                               1211 1211  CLSS                            CDL008
     I                               1212 1216  FSOYLC
     I                               1217 1221  FSTYLC
     I                             P 1222 1228 0FSURPL
     I                             P 1229 1235 0FSTUPL
     I                             P 1236 1242 0FSPUPL
     I                             P 1243 1249 0FSYUPL
     I                             P 1250 1256 0FSSUPL
     I                             P 1257 1263 0FSSYPL
     I                             P 1264 1270 0FSEFUP
     I                             P 1271 1277 0FSECUP
     I                             P 1278 1284 0FSXFUP
     I                             P 1285 1291 0FSXCUP
     I                               1292 1309  OPCA
     I                               1310 1327  OSCA
     I                               1328 1345  RONS                                        BUG10238
     I                               1346 1363  PONS                                        BUG10238
     I                               1364 1367  CLAS                                          CDL038
     I**********                     1368 1368  FGREIN                             BUG23926 MD021143
     I**********                   P 1369 1375 8FSRRAT                             AR317892 MD021143
     I                             P 1368 1374 8FSRRAT                                      MD021143
     I                               1375 1375  FGREIN                                      MD021143
     I                               1376 1410  DSR1                                          CSW212
     I                               1411 1445  DSR2                                          CSW212
     I                               1446 1480  DSR3                                          CSW212
     I                               1481 1515  DSR4                                          CSW212
     I                               1516 1550  DSR5                                          CSW212
     I                               1551 1585  DSR6                                          CSW212
     I                               1586 1620  SSR1                                          CSW212
     I                               1621 1655  SSR2                                          CSW212
     I                               1656 1690  SSR3                                          CSW212
     I                               1691 1725  SSR4                                          CSW212
     I                               1726 1760  SSR5                                          CSW212
     I                               1761 1795  SSR6                                          CSW212
     I                               1796 1830  CND1                                          CSW212
     I                               1831 1865  CND2                                          CSW212
     I                               1866 1900  CND3                                          CSW212
     I                               1901 1935  CND4                                          CSW212
     I                               1936 1970  CND5                                          CSW212
     I                               1971 2005  CND6                                          CSW212
     I                               2006 2009 0ISDA                                          CSW212
     I                               2010 2015  AGTY                                          CSW212
     I                               2016 2021 0AGDT                                          CSW212
     I                               2022 2023 0AGVV                                          CSW212
     I                               2024 2025 0AGVC                                          CSW212
     I                             P 2236 2238 0BSDT1                                         CDL099
     I                             P 2239 2241 0BSDT2                                         CDL099
     I                             P 2242 2244 0BRSD2                                         CDL099
0197 I*
0198 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0199 I*
0200 I          NS  03    1 CD    8 CC
0201 I         OR   03    1 CE    8 CC
0202 I         OR   03    1 CM    8 CC
0203 I         OR   03    1 CR    8 CC
     I**********                              11636 UCDATA                             CAS001 CAS005
     I**********                        1 1720  UCDATA                                        CDL038
     I**********                        1 1901  UCDATA                                 CDL038 CAS009
     I**********                        1 2013  UCDATA                                 CAS009 233324
     I**********                        1 2039  UCDATA                               233324 BUG24989
     I/COPY WNCPYSRC,DLH00151
     I**********                        1 2083  UCDATA                               BUG24989 CRE073
     I/COPY WNCPYSRC,DLH00152
     I                                  1 2139  UCDATA                                        CRE073
0204 I                                  1    1  RECR
0205 I                                  2    7 0DLNO
0206 I                                  8    8  RCDT
0207 I                                  9   10 0RCDC
0208 I**********                       11   16 0CNUM                                          CSD027
0208 I                                 11   16  CNUM                                          CSD027
0209 I                                 17   19  BRCA          L1                S01117
0210 I                                 20   21  DTYP
0211 I                                 22   23  DLST
0212 I                             P   24   26 0DDAT
0213 I                             P   27   29 0VDAT
0214 I                             P   30   32 0MDAT
0215 I                                 33   34 0ACSQ                    39
0216 I                                 35   38  BRKC
0217 I                             P   39   45 0BAGE
0218 I                                 46   48  PCCY
0219 I                             P   49   55 0PAMT
     I/COPY WNCPYSRC,DL0280IIP5                                           S01408
0220 I                             P   49   55 0YYPAMT
0221 I                                 56   56  INTC
0222 I                                 63   64 0BRTT
0223 I                             P   65   70 7BRTE
0224 I                             P   71   76 7RTSP
0225 I                             P   77   82 7INTR
0226 I                                 83   85 0NOTD
0227 I                                 86  105  RNNA
0228 I**********                      106  111 0CHNA                                          CSD027
0228 I                                106  111  CHNA                                          CSD027
0229 I                                112  114 0FACT
0230 I                                115  116 0FCNO
0231 I                             P  117  123 0OPAM
0232 I                             P  124  130 8BCXR
0233 I                             P  131  137 8LCXR
0234 I                                138  139 0SDST
0235 I**********                            140 151 OSDA                                      CGL029
     I                                140  151  OSDAQQ
0236 I                                152  161  TSTN
0237 I                                162  163 0MDST
0238 I**********                            164 175 OMDA                                      CGL029
     I                                164  175  OMDAQQ
0239 I                                176  185  TMAN
0240 I                                186  191 0RODN
0241 I                             P  192  198 0RODA
0242 I                                199  204 0RBDN
0243 I                             P  205  211 0RBDA
0244 I                                212  212 0ICBS
0245 I                                213  213  IPFR
0246 I                             P  214  220 0TOTI
0247 I                             P  221  223 0NIDT
0248 I                             P  224  226 0IBDT
0249 I                             P  227  229 0SLID
0250 I                             P  230  236 0AIPD
0251 I                             P  237  239 0DLRC
0252 I                             P  240  242 0IACD
0253 I                             P  243  249 0AITC
0254 I                             P  250  256 0AIAN
0255 I                             P  257  263 0AIAP
0256 I                             P  264  270 0IPRD
0257 I                             P  271  277 0IPRM
0258 I                             P  278  284 0ICTD
0259 I                             P  294  296 0DAVD
0260 I                                297  299 0DASN
0261 I                                300  309  FACOA                           S05452
0262 I                                310  344  SPI
0263 I                                345  346 0INTF
0264 I                                355  355  TAXI
0265 I                             P  356  362 0TAXD
0266 I                             P  363  369 0TAXM
0267 I                                370  370  DNSI
0268 I                                371  371  DSTI
0269 I                                372  372  CNFI
0270 I                                373  373  ACEI
0271 I                                374  374  TLXI
0272 I                             P  391  393 0ORED
0273 I                             P  394  396 0LCD
0274 I                                397  397  CHTP
0275 I                             P  398  400 0TNLU
     I                                414  414  DRID
     I/COPY WNCPYSRC,DL0280I008
0193 I                                421  422  BOKC                            S01182
     I                                429  430 0RSTM                            099469
     I                                498  499 0PSTM
     I                                500  511  PONSQQ
     I                                512  519  PIBN
     I                                520  554  PIBA
     I**********                      555  560 0POBN                                          CSD027
     I**********                      561  566 0POCN                                          CSD027
     I                                555  560  POBN                                          CSD027
     I                                561  566  POCN                                          CSD027
     I                                567  574  RCRN
     I                                575  609  RCRA
     I                                610  617  RVNO
     I                                618  625  AWBN
     I                                626  660  AWBA
     I                                661  668  BENN
     I                                669  703  BENA
     I                                704  738  DTP1
     I                                739  773  DTP2
     I                                774  808  DTP3
     I                                809  843  DTP4
     I                                844  846  DCHG
     I                                847  881  BTB1
     I                                882  916  BTB2
     I                                917  951  BTB3
     I                                952  986  BTB4
     I                                987 1021  BTB5
     I                               1022 1056  BTB6
      *                                                                                       CDL017
     I**********                      486  491 0ROBN                                          CSD027
     I**********                      492  497 0ROCN                                          CSD027
     I**********                      555  560 0POBN                                          CSD027
     I**********                      561  566 0POCN                                          CSD027
     I                                486  491  ROBN                                          CSD027
     I                                492  497  ROCN                                          CSD027
     I                                555  560  POBN                                          CSD027
     I                                561  566  POCN                                          CSD027
     I                                618  625  AWBN
     I                                626  660  AWBA
     I                                661  668  BENN
     I                                669  703  BENA
     I                               1057 1059  ORBR                            S01117
     I                               1060 1063  PRFC                            S01117
     I                               1064 1066  ROBR                            S01117
     I                               1067 1069  POBR                            S01117
0271 I                               1071 1071  DNACSG                          S01383
     I                               1072 1072  JRDFC                           S01392
     I                               1073 1073  JFLID                           S01392
     I                               1074 1074  FUID                            S01392
     I                               1076 1076  IPDS                            S01434
     I                               1115 1116  IMET                            S01434
     I**********                           11171131 INSA                               S01434 CGL029
     I                               1117 1131  INSAQQ
     I                               1143 1146  PTFR                            S01486
     I                             P 1147 1153 8FXRD                            S01486
     I                             P 1155 1160 7FSRP                            CAC001
     I                               1161 1161  FSGN                            CAC001
     I                               1162 1165  FPRC                            CAC001
     I                             P 1166 1172 0TCOF                            CAC001
     I                             P 1173 1179 0ACPD                            CAC001
     I                             P 1180 1186 0ACDA                            CAC001
     I                             P 1187 1193 0ACAP                            CAC001
     I                             P 1194 1200 0ACAN                            CAC001
     I                             P 1201 1207 0COFD                            CAC001
     I                             P 1208 1214 0COFM                            CAC001
     I                             P 1215 1221 0CFCD                            CAC001
     I                             P 1222 1224 0FCTD                            CAC001
     I                               1225 1227  STCY                            CEU003
     I                               1228 1230  IC72                            CEU003
     I                               1231 1233  ISCY                            CEU003
     I                               1234 1236  II72                            CEU003
     I                               1237 1239  RTFC                            CEU015
      *                                                                   CDL006
      ** Additional fields for Fiduciary Dealing                          CDL006
     I                               1240 1241  FCGC                            CDL006
     I                             P 1262 1268 0FCGA                            CDL006
     I                               1274 1275  FCMC                            CDL006
     I                             P 1296 1302 0FCMA                            CDL006
     I                             P 1549 1555 0FACTC                           CDL006
     I                             P 1556 1562 0FACPD                           CDL006
     I                             P 1563 1569 0FCPRD                           CDL006
     I                               1570 1570  REPI                            CPB001
     I                             P 1571 1573 0OMDT                            CDL007
     I                             P 1574 1580 0PENA                            CDL007
     I                               1581 1590  BUSR                            CDL007
     I                               1591 1591  PRIN                            CDL007
     I                               1592 1592  AUTH                            CAP051
     I                               1604 1608  FSOYLC
     I                             P 1609 1615 0FSURPL
     I                             P 1616 1622 0FSTUPL
     I                             P 1623 1629 0FSPUPL
     I                             P 1630 1636 0FSYUPL
     I                             P 1637 1643 0FSEFUP
     I                             P 1644 1650 0FSECUP
     I                             P 1651 1656 7FSLQPR
     I                               1657 1657  FSLQPS
     I                             P 1658 1664 0FSAIPN
     I                             P 1665 1671 0FSIPRN
     I                             P 1672 1678 0FSAIAN
     I                             P 1679 1685 0FSAITN
     I                             P 1686 1692 0FSAINN
     I                             P 1693 1699 0FSIPMN
     I                             P 1700 1706 0FSICTN
     I                             P 1707 1713 0FSTOTN
     I                             P 1714 1720 0FSPAMT
     I**********                           17211741 INSA                              CGL029 BUG1809
     I**********                           17421759 OMDA                              CGL029 BUG1809
     I**********                           17601777 OSDA                              CGL029 BUG1809
     I                               1721 1738  OSDA                                               B
     I                               1739 1756  OMDA                                               B
     I                               1757 1774  RONS                                        BUG10238
     I                               1775 1792  PONS                                        BUG10238
     I                               1793 1813  INSA                                               B
     I                             P 1836 1838 0FSCAND
     I                               1839 1839  FSPNPR
     I                               1840 1840  FSFBRT                                     AR1075873
     I                               1841 1841  FSRMAC
     I                               1842 1842  FSPMAC
     I                             P 1843 1850 0BCAM                                          CDL033
     I                             P 1851 1853 0XKRCDT                                        CDL033
     I                               1854 1854  XKRCFR                                        CDL033
     I                               1855 1856 0XKRCDM                                        CDL033
     I                               1857 1857  XKSTRF                                        CDL033
     I**********                     1858 1863  XKSTRT                               CDL033 BUG11182
     I                             P 1858 1863 0XKSTRT                                      BUG11182
     I                             P 1864 1870 0XKAILC                                        CDL033
     I                             P 1871 1877 0XKACDA                                        CDL033
     I                               1878 1878  XKSTVF                                        CDL033
     I                               1879 1879  XKBSVF                                        CDL033
     I                               1880 1881 0XKFXDM                                        CDL033
     I**********                     1882 1884 0XKINFD                                CDL033 BUG9127
     I                             P 1882 1884 0XKINFD                                       BUG9127
     I                               1885 1885  XKINFF                                        CDL033
     I                             P 1886 1891 7XKBSRF                                        CDL033
     I                               1892 1892  XKFRCI                                        CDL033
     I                               1893 1897  XKFYLD                                        CDL033
     I**********                     1898 1901  CLAS                                 CDL038 BUG10282
     I                               2010 2013  CLAS                                        BUG10282
     I                             P 2014 2020 0EUTO                                          233324
     I                             P 2021 2027 0EUTB                                          233324
     I                             P 2028 2034 0EUTX                                          233324
     I                               2035 2037  EUCY                                          233324
     I                               2038 2039  COLC                                          233324
     I                             P 2040 2046 8FSRRAT                                      AR762808
     I                             P 2047 2049 0ISDT                                        AR762808
     I                             P 2050 2052 0FMDT                                        AR762808
     I                               2053 2058 0ORDN                                        AR762808
     I                             P 2059 2066 0STXO                                        AR762808
     I                             P 2067 2074 0STXS                                        AR762808
     I                             P 2075 2082 0STXT                                        AR762808
     I                             P 2083 2090 0STXB                                        AR762808
     I**********                   P 2040 2042 0ISDT                               BUG23926 AR762808
     I**********                   P 2043 2045 0FMDT                               BUG23926 AR762808
     I**********                     2046 2051 0ORDN                               BUG23926 AR762808
     I**********                   P 2052 2059 0STXO                               BUG23926 AR762808
     I**********                   P 2060 2067 0STXS                               BUG23926 AR762808
     I**********                   P 2068 2075 0STXT                               BUG23926 AR762808
     I**********                   P 2076 2083 0STXB                               BUG23926 AR762808
     I**********                   P 2040 2047 0STXO                                 CER048 BUG23926
     I**********                   P 2056 2063 0STXT                                 CER048 BUG23926
     I**********                   P 2064 2071 0STXB                                 CER048 BUG23926
     I**********                   P 2040 2047 0TTXO                                 CER054 AR762808
     I**********                   P 2056 2063 0TTXT                                 CER054 AR762808
     I**********                   P 2064 2071 0TTXB                                 CER054 AR762808
     I                             P 2091 2098 0TTXO                                        AR762808
     I                             P 2099 2106 0TTXS                                        AR762808
     I                             P 2107 2114 0TTXT                                        AR762808
     I                             P 2115 2122 0TTXB                                        AR762808
     I                             P 2123 2128 7CNSP                                          CRE073
     I                               2129 2135  RDMT                                          CRE073
     I                               2136 2139  RDFD                                          CRE073
     I                               2350 2379  CCYPC                                         CDL096
     I                               2350 2352  C1PC                                          CDL096
     I                               2353 2355  C2PC                                          CDL096
     I                               2356 2358  C3PC                                          CDL096
     I                               2359 2361  C4PC                                          CDL096
     I                               2362 2364  C5PC                                          CDL096
     I                               2365 2367  C6PC                                          CDL096
     I                               2368 2370  C7PC                                          CDL096
     I                               2371 2373  C8PC                                          CDL096
     I                               2374 2376  C9PC                                          CDL096
     I                               2377 2379  C0PC                                          CDL096
     I                               2380 2381  PYDC                                          CDL096
     I                               2382 2383  AMTC                                          CDL096
     I                               2384 2385  TXC1                                          CGL165
     I                               2386 2387  TXC2                                          CGL165
0278 I*
0280 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
0281 I*
0282 I          NS  04    1 CD    8 CD
0283 I         OR   04    1 CE    8 CD
0284 I         OR   04    1 CM    8 CD
0285 I         OR   04    1 CR    8 CD
     I**********                              11167 UDDATA                             CAS001 CAS005
     I**********                        1 1244  UDDATA                                        CDL038
     I**********                        1 1320  UDDATA                                 CDL038 CAS009
     I**********                        1 1432  UDDATA                               CAS009 AR854656
     I                                  1 1445  UDDATA                                      AR854656
0286 I                                  1    1  RECR
0287 I                                  2    7 0DLNO
0288 I                                  8    8  RCDT
0289 I                                  9   10 0RCDC
0290 I**********                       11   16 0CNUM                                          CSD027
0290 I                                 11   16  CNUM                                          CSD027
0291 I                                 17   19  BRCA          L1                S01117
0292 I                                 20   21  DTYP
0293 I                                 22   23  DLST
0294 I                             P   24   26 0DDAT
0295 I                             P   27   29 0VDAT
0296 I                             P   30   32 0MDAT
0297 I                                 33   34 0ACSQ                    39
0298 I                                 35   38  BRKC
0299 I                             P   39   45 0BAGE
0300 I                                 46   48  PCCY
0301 I                             P   49   55 0PAMT
0302 I                             P   57   62 7YRAT
0303 I                             P   71   76 7RTSP
0304 I                             P   77   82 7INTR
0305 I                                 86  105  RNNA
0306 I**********                      106  111 0PCUS                                          CSD027
0306 I                                106  111  PCUS                                          CSD027
0307 I                                112  114 0FACT
0308 I                                115  116 0FCNO
0309 I                             P  117  123 0FVAL
0310 I                             P  124  130 8BCXR
0311 I                             P  131  137 8LCXR
0312 I                                138  139 0SDST
0313 I**********                            140 151 OSDA                                      CGL029
     I                                140  151  OSDAQQ
0314 I                                152  161  TSTN
0315 I                                162  163 0MDST
0316 I**********                            164 175 OMDA                                      CGL029
     I                                164  175  OMDAQQ
0317 I                                176  185  TMAN
0318 I                             P  192  198 0DISA
0319 I                             P  205  211 0DPTD
0320 I                                212  212 0ICBS
0321 I                                213  213  IPFR
0322 I                             P  214  220 0TOTI
0323 I                             P  221  223 0NIDT
0324 I                             P  224  226 0IBDT
0325 I                             P  227  229 0SLID
0326 I                             P  230  236 0AIPD
0327 I                             P  237  239 0DLRC
0328 I                             P  240  242 0IACD
0329 I                             P  243  249 0AITC
0330 I                             P  250  256 0AIAN
0331 I                             P  257  263 0AIAP
0332 I                             P  264  270 0IPRD
0333 I                             P  271  277 0IPRM
0334 I                             P  278  284 0SAPR
0335 I                                285  290 0ASDN
0336 I                             P  291  293 0SADT
0337 I                             P  294  296 0DAVD
0338 I                                297  299 0DASN
0261 I                                300  309  FACOA                           S05452
0340 I                                310  344  SPI
0341 I                                345  346 0INTF
0341 I                             P  348  354 0PINT
0341 I                             P  348  354 0SPINT                           E11369
0342 I                                370  370  DNSI
0343 I                                371  371  DSTI
0344 I                                372  372  CNFI
0345 I                                373  373  ACEI
0346 I                                374  374  TLXI
0347 I                             P  391  393 0ORED
0348 I                             P  394  396 0LCD
0349 I                                397  397  CHTP
0350 I                             P  398  400 0TNLU
0193 I                                401  402  BOKC                            S01182
     I                                409  410 0RSTM                            099469
     I**********                      466  471 0ROBN                                          CSD027
     I**********                      472  477 0ROCN                                          CSD027
     I**********                      535  540 0POBN                                          CSD027
     I**********                      541  546 0POCN                                          CSD027
     I                                466  471  ROBN                                          CSD027
     I                                472  477  ROCN                                          CSD027
     I                                535  540  POBN                                          CSD027
     I                                541  546  POCN                                          CSD027
     I                                598  605  AWBN
     I                                606  640  AWBA
     I                                641  648  BENN
     I                                649  683  BENA
     I                               1037 1039  ORBR                            S01117
     I                               1040 1043  PRFC                            S01117
     I                               1044 1046  ROBR                            S01117
     I                               1047 1049  POBR                            S01117
     I                               1055 1055  PCLI                            S01378
     I                             P 1056 1058 0PPSZ                            S01378
     I                             P 1059 1065 0OPUP                            S01378
     I                             P 1066 1068 0NSLD                            S01378
     I                               1051 1051  JRDFC                           S01392
     I                             P 1069 1074 7FSRP                            CAC001
     I                               1075 1075  FSGN                            CAC001
     I                               1076 1079  FPRC                            CAC001
     I                             P 1080 1086 0TCOF                            CAC001
     I                             P 1087 1093 0ACPD                            CAC001
     I                             P 1094 1100 0ACDA                            CAC001
     I                             P 1101 1107 0ACAP                            CAC001
     I                             P 1108 1114 0ACAN                            CAC001
     I                             P 1115 1121 0COFD                            CAC001
     I                             P 1122 1128 0COFM                            CAC001
     I                               1129 1131  STCY                            CEU003
     I                               1132 1134  IC72                            CEU003
     I                               1135 1139  FSOYLC
     I                             P 1140 1146 0FSURPL
     I                             P 1147 1153 0FSTUPL
     I                             P 1154 1160 0FSPUPL
     I                             P 1161 1167 0FSYUPL
     I                             P 1168 1174 0FSEFUP
     I                             P 1175 1181 0FSECUP
     I                             P 1182 1187 7FSLQPR
     I                               1188 1188  FSLQPS
     I                             P 1189 1195 0FSAIPN
     I                             P 1196 1202 0FSIPRN
     I                             P 1203 1209 0FSAIAN
     I                             P 1210 1216 0FSAITN
     I                             P 1217 1223 0FSAINN
     I                             P 1224 1230 0FSIPMN
     I                             P 1231 1237 0FSTOTN
     I                             P 1238 1244 0FSPINN
     I**********                     1245 1262  OMDA                                         BUG7958
     I**********                     1263 1280  OSDA                                         BUG7958
     I                               1245 1262  OSDA                                         BUG7958
     I                               1263 1280  OMDA                                         BUG7958
     I                               1281 1298  RONS                                        BUG10238
     I                               1299 1316  PONS                                        BUG10238
     I                               1317 1320  CLAS                                          CDL038
     I**********                   P 1633 1640 0TFDP                                CAS009 AR762808A
     I**********                   P 1641 1648 0TFDPA                               CAS009 AR762808A
     I                             P 1321 1328 0TFDP                                       AR762808A
     I                             P 1329 1336 0TFDPA                                      AR762808A
     I                             P 1439 1445 8FSRRAT                                      AR317892
0354 I*
0355 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
0356 I*
0357 I          NS  05    1 CD    8 CE
0358 I         OR   05    1 CE    8 CE
0359 I         OR   05    1 CM    8 CE
0360 I         OR   05    1 CR    8 CE
     I**********                        1 1047  UEDATA                                 CEU003 CDL038
     I                                  1 1105  UEDATA                                        CDL038
0361 I                                  1    1  RECR
0362 I                                  2    7 0DLNO
0363 I                                  8    8  RCDT
0364 I                                  9   10 0RCDC
0365 I**********                       11   16 0CNUM                                          CSD027
0365 I                                 11   16  CNUM                                          CSD027
0366 I                                 17   19  BRCA          L1                S01117
0367 I                                 20   21  DTYP
0368 I                                 22   23  DLST
0369 I                             P   24   26 0DDAT
0370 I                             P   27   29 0VDAT
0371 I                                 33   34 0ACSQ                    39
0372 I                                 35   38  BRKC
0373 I                             P   39   45 0BAGE
0374 I                                 46   48  PCCY
0375 I                             P   49   55 0PAMT
0376 I                             P   57   62 7YRAT
0377 I                             P   77   82 7INTR
0378 I                                 86  105  RNNA
0379 I**********                      106  111 0SCUS                                          CSD027
0379 I                                106  111  SCUS                                          CSD027
0380 I                             P  117  123 0FVAL
0381 I                                138  139 0SETPDL
0382 I**********                            140 151 OSACDL                                    CGL029
     I                                140  151  OSACQQ
0383 I                                152  161  TSEN
     I                                162  164  ORBR                            S01117
     I                                165  167  ROBR                            S01117
     I                                168  171  PRFC                            S01117
0384 I                                285  290 0RPDN                            S01434
0385 I                                370  370  DNSI
0386 I                                371  371  DSTI
0387 I                                372  372  CNFI
0388 I                                373  373  ACEI
0389 I                                374  374  TLXI
0390 I                             P  391  393 0ORED
0391 I                             P  394  396 0LCD
0392 I                                397  397  CHTP
0393 I                             P  398  400 0TNLU
0193 I                                401  402  BOKC                            S01182
     I                                409  410 0RSTM                            099469
     I**********                      466  471 0ROBN                                          CSD027
     I**********                      472  477 0ROCN                                          CSD027
     I**********                      535  540 0POBN                                          CSD027
     I**********                      541  546 0POCN                                          CSD027
     I                                466  471  ROBN                                          CSD027
     I                                472  477  ROCN                                          CSD027
     I                                535  540  POBN                                          CSD027
     I                                541  546  POCN                                          CSD027
     I                                598  605  AWBN
     I                                606  640  AWBA
     I                                641  648  BENN
     I                                649  683  BENA
     I                               1038 1038  PCLI                            S01378
     I                             P 1039 1041 0PSZE                            S01378
     I                               1042 1044  STCY                            CEU003
     I                               1045 1047  IC72                            CEU003
     I                               1048 1065  OSACDL
     I                               1066 1083  RONS                                        BUG10238
     I                               1084 1101  PONS                                        BUG10238
     I                               1102 1105  CLAS                                          CDL038
     I*                                                                   S01119
     I*    DEALS FILE - DETAIL - FRA/IRS                                  S01119
     I*                                                                   S01119
     I          NS  10    1 CD    8 CG                                          S01119
     I         OR         1 CM    8 CG                                          S01119
     I         OR         1 CR    8 CG                                          S01119
     I**********                              12212 UGDATA                             CAP056 CAS005
     I**********                              12441 UGDATA                             CAS005 CAS006
     I**********                              12448 UGDATA                             CAS006 217684
     I**********                        1 2468  UGDATA                                 217684 CAS008
     I**********                        1 2550  UGDATA                                 CAS008 CDL038
     I                                  1 2606  UGDATA                                        CDL038
     I                                  1    1  RECR                            S01119
     I                                  2    7 0DLNO                            S01119
     I                                  8    8  RCDT                            S01119
     I                                  9   10 0RCDC                            S01119
     I**********                       11   16 0CNUM                            S01119        CSD027
     I                                 11   16  CNUM                            S01119        CSD027
     I                                 17   19  BRCA          L1                S01117
     I                                 20   21  DTYP                            S01119
     I                                 22   23  DLST                            S01119
     I                             P   24   26 0DDAT                            S01119
     I                             P   27   29 0VDAT                            S01119
     I                             P   30   32 0MDAT                            S01119
     I                                 33   34 0ACSQ                    39      E22689
     I                                 35   38  BRKC                            S01119
     I                             P   39   45 0BAGE                            S01119
     I                                 46   51 0LNKDN                           S01119
     I                                 52   52  HEDIN                           S01119
     I                                 53   53  TAXI                            S01119
     I                                 54   56  UCUCY                           S01119
     I                             P   57   63 0UPAMT                           S01119
     I                                 64   65 0UBRTT                           S01119
     I                             P   66   71 7USTRT                           S01119
     I                             P   72   77 7UBRTE                           S01119
     I                             P   78   83 7URTSP                           S01119
     I                                 84   84  USPIN                           S01119
     I                             P   85   90 7UEINR                           S01119
     I                                 91   91 0UICBS                           S01119
     I                                 92   93 0UFRFD                           S01119
     I                             P   94   96 0UINFD                           S01119
     I                             P   97   99 0USLIP                           S01119
     I                             P  100  102 0UNICD                           S01119
     I                             P  103  105 0UICBD                           S01119
     I                                106  106  UICFR                           S01119
     I                                107  108 0UICFD                           S01119
     I                             P  109  111 0UNIPD                           S01119
     I                             P  112  114 0UIPBD                           S01119
     I                                115  115  UIPFR                           S01119
     I                                116  117 0UIPFD                           S01119
     I                             P  118  124 8UBCXR                           S01119
     I                             P  125  127 0UIACD                           S01119
     I                             P  128  134 0UIALC                           S01119
     I                             P  135  141 0UAITC                           S01119
     I                             P  142  148 0UAIPD                           S01119
     I                             P  149  155 0UAIAN                           S01119
     I                             P  156  162 0UAIAP                           S01119
     I                             P  163  169 0UIPRD                           S01119
     I                             P  170  176 0UIPRM                           S01119
     I                             P  177  183 0UNSAM                           S01119
     I                             P  184  190 0UTAXD                           S01119
     I                             P  191  197 0UTAXM                           S01119
     I                                198  200  TCUCY                           S01119
     I                             P  201  207 0TPAMT                           S01119
     I                                208  209 0TBRTT                           S01119
     I                             P  210  215 7TSTRT                           S01119
     I                             P  216  221 7TBRTE                           S01119
     I                             P  222  227 7TRTSP                           S01119
     I                                228  228  TSPIN                           S01119
     I                             P  229  234 7TEINR                           S01119
     I                                235  235 0TICBS                           S01119
     I                                236  237 0TFRFD                           S01119
     I                             P  238  240 0TINFD                           S01119
     I                             P  241  243 0TSLIP                           S01119
     I                             P  244  246 0TNICD                           S01119
     I                             P  247  249 0TICBD                           S01119
     I                                250  250  TICFR                           S01119
     I                                251  252 0TICFD                           S01119
     I                             P  253  255 0TNIPD                           S01119
     I                             P  256  258 0TIPBD                           S01119
     I                                259  259  TIPFR                           S01119
     I                                260  261 0TIPFD                           S01119
     I                             P  262  268 8TBCXR                           S01119
     I                             P  269  271 0TIACD                           S01119
     I                             P  272  278 0TIALC                           S01119
     I                             P  279  285 0TAITC                           S01119
     I                             P  286  292 0TAIPD                           S01119
     I                             P  293  299 0TAIAN                           S01119
     I                             P  300  306 0TAIAP                           S01119
     I                             P  307  313 0TIPRD                           S01119
     I                             P  314  320 0TIPRM                           S01119
     I                             P  321  327 0TNSAM                           S01119
     I                             P  328  334 0TTAXD                           S01119
     I                             P  335  341 0TTAXM                           S01119
     I                             P  342  347 7CLRAT                           S01119
     I                             P  348  353 7FLRAT                           S01119
     I                             P  354  355 0AVPER                           S01119
     I                             P  356  363 8TIRAT                           S01119
     I                             P  364  369 7AACRT                           S01119
     I                                370  371 0RSETM                           S01119
     I**********                            372 383 URACC                              S01119 CGL029
     I                                372  383  URACQQ
     I                                384  393  CPPBK                           S01119
     I                                394  395 0PSETM                           S01119
     I**********                            396 407 UPACC                              S01119 CGL029
     I                                396  407  UPACQQ
     I                                408  417  CPRBK                           S01119
     I                                418  427  FACO                            S01119
     I                                428  462  SPI                             S01119
     I                             P  463  465 0SDCAR                           S01119
     I                             P  466  468 0ULPCD                           S01119
     I                             P  469  471 0TLPCD                           S01119
     I                             P  472  478 0UAEXA                           S01119
     I                             P  479  485 0TAEXA                           S01119
     I                             P  486  493 0UNRL                            S01328
     I                             P  494  501 0UNRLP                           S01328
     I                                569  569  BYSL                            LN0780
     I                                570  570  UDNSI                           S01119
     I                                571  571  TDNSI                           S01119
     I                                572  572  UDSTI                           S01119
     I                                573  573  TDSTI                           S01119
     I                                574  574  CNFI                            S01119
     I                                575  575  ACEI                            S01119
     I                                576  576  TLXI                            S01119
     I                                577  577  SETF                            AUS021
     I                             P  587  588 0LSWC                            S01119
     I                             P  589  590 0LSWS                            S01119
     I                             P  591  593 0ORED                            S01119
     I                             P  594  596 0LCD                             S01119
     I                                597  597  CHTP                            S01119
     I                             P  598  600 0TNLU                            S01119
0193 I                                601  602  BOKC                            S01182
     I                                606  608  ROBR                            LN0711
     I                                609  611  POBR                            LN0711
     I                                612  615  PRFC                            LN0711
     I                                616  616  UINPM                           CIR001
     I                             P  617  619 0UNPCD                           CIR001
     I                                620  620  TINPM                           CIR001
     I                             P  621  623 0TNPCD                           CIR001
     I                             P  624  626 0UPVD                            CIR001
     I                             P  627  633 0UPFE                            CIR001
     I                                634  634  UPPR                            CIR001
     I                             P  635  641 0UPAD                            CIR001
     I                             P  642  644 0BODD                            CIR001
     I                             P  645  647 0BOVD                            CIR001
     I                             P  648  654 0BOAM                            CIR001
     I                                655  655  BAPR                            CIR001
     I                             P  656  663 0OUSI                            CIR001
     I                             P  664  671 0OUSA                            CIR001
     I                             P  672  679 0TUSI                            CIR001
     I                             P  680  687 0TUSA                            CIR001
     I/COPY WNCPYSRC,DL0280I001
     I                                688  688  URFIN                           CSW005
     I                                689  689  TRFIN                           CSW005
     I                             P  690  695 7UOBRT                           CSW005
     I                             P  696  701 7TOBRT                           CSW005
     I                               1995 1995  VDEI                            CIR003
     I                               1996 1996  MDEI                            CIR003
     I                               1997 1997  PDEI                            CIR003
      *                                                                   179458
      ** Take Settlement details from DEALSDG for FRA/IRS deals.          179458
      *                                                                   179458
     I                                716  717 0RSTM                            179458
     I**********                            718 729 RONS                               179458 CGL029
     I                                718  729  RONSQQ
     I**********                      773  778 0ROBN                                          CSD027
     I**********                      779  784 0ROCN                                          CSD027
     I                                773  778  ROBN                                          CSD027
     I                                779  784  ROCN                                          CSD027
     I                                785  786 0PSTM                            179458
     I**********                            787 798 PONS                               179458 CGL029
     I                                787  798  PONSQQ
     I**********                      842  847 0POBN                                          CSD027
     I**********                      848  853 0POCN                                          CSD027
     I                                842  847  POBN                                          CSD027
     I                                848  853  POCN                                          CSD027
     I                                905  912  AWBN
     I                                913  947  AWBA
     I                                948  955  BENN
     I                                956  990  BENA
     I                               1998 2000  RSCY                            CEU003
     I                               2001 2003  PSCY                            CEU003
     I                               2004 2006  IC72                            CEU003
     I                             P 2054 2056 0PLULRC                          171698
     I                             P 2057 2059 0PLTLRC                          171698
     I                               2063 2092  CCYPY1                          CIR005
     I                               2063 2065  L1CYP1                          CIR005
     I                               2066 2068  L1CYP2                          CIR005
     I                               2069 2071  L1CYP3                          CIR005
     I                               2072 2074  L1CYP4                          CIR005
     I                               2075 2077  L1CYP5                          CIR005
     I                               2078 2080  L1CYP6                          CIR005
     I                               2081 2083  L1CYP7                          CIR005
     I                               2084 2086  L1CYP8                          CIR005
     I                               2087 2089  L1CYP9                          CIR005
     I                               2090 2092  L1CYP0                          CIR005
     I                               2093 2094  L1PDCN                          CIR005
     I                               2095 2096  L1AMCN                          CIR005
     I                               2097 2126  CCYRT1                          CIR005
     I                               2097 2099  L1CYR1                          CIR005
     I                               2100 2102  L1CYR2                          CIR005
     I                               2103 2105  L1CYR3                          CIR005
     I                               2106 2108  L1CYR4                          CIR005
     I                               2109 2111  L1CYR5                          CIR005
     I                               2112 2114  L1CYR6                          CIR005
     I                               2115 2117  L1CYR7                          CIR005
     I                               2118 2120  L1CYR8                          CIR005
     I                               2121 2123  L1CYR9                          CIR005
     I                               2124 2126  L1CYR0                          CIR005
     I                               2127 2156  CCYPY2                          CIR005
     I                               2127 2129  L2CYP1                          CIR005
     I                               2130 2132  L2CYP2                          CIR005
     I                               2133 2135  L2CYP3                          CIR005
     I                               2136 2138  L2CYP4                          CIR005
     I                               2139 2141  L2CYP5                          CIR005
     I                               2142 2144  L2CYP6                          CIR005
     I                               2145 2147  L2CYP7                          CIR005
     I                               2148 2150  L2CYP8                          CIR005
     I                               2151 2153  L2CYP9                          CIR005
     I                               2154 2156  L2CYP0                          CIR005
     I                               2157 2158  L2PDCN                          CIR005
     I                               2159 2160  L2AMCN                          CIR005
     I                               2161 2190  CCYRT2                          CIR005
     I                               2161 2163  L2CYR1                          CIR005
     I                               2164 2166  L2CYR2                          CIR005
     I                               2167 2169  L2CYR3                          CIR005
     I                               2170 2172  L2CYR4                          CIR005
     I                               2173 2175  L2CYR5                          CIR005
     I                               2176 2178  L2CYR6                          CIR005
     I                               2179 2181  L2CYR7                          CIR005
     I                               2182 2184  L2CYR8                          CIR005
     I                               2185 2187  L2CYR9                          CIR005
     I                               2188 2190  L2CYR0                          CIR005
     I                               2191 2195  FSOYLC
     I                               2196 2200  FSTYLC
     I                               2201 2210  FIUSRI
     I                               2211 2211  FIDSTS
     I                               2212 2212  FIAUTH
     I                               2449 2458  FIUSRA
     I                               2459 2468  FIUSRX
     I                             P 2213 2219 0FSEFUP
     I                             P 2220 2226 0FSECUP
     I                             P 2227 2233 0FSXFUP
     I                             P 2234 2240 0FSXCUP
     I                             P 2241 2247 0FSTRUP
     I                             P 2248 2254 0FSUIPB
     I                             P 2255 2261 0FSUPRB
     I                             P 2262 2268 0FSUIAB
     I                             P 2269 2275 0FSUALB
     I                             P 2276 2282 0FSUITB
     I                             P 2283 2289 0FSUINB
     I                             P 2290 2296 0FSUPMB
     I                             P 2297 2303 0FSUSAB
     I                             P 2304 2310 0FSUPAM
     I                             P 2311 2318 0FSUURL
     I                             P 2319 2326 0FSUURP
     I                             P 2327 2333 0FSTIPB
     I                             P 2334 2340 0FSTPRB
     I                             P 2341 2347 0FSTIAB
     I                             P 2348 2354 0FSTALB
     I                             P 2355 2361 0FSTITB
     I                             P 2362 2368 0FSTINB
     I                             P 2369 2375 0FSTPMB
     I                             P 2376 2382 0FSTSAB
     I                             P 2383 2389 0FSTPAM
     I                             P 2390 2397 0FSTURL
     I                             P 2398 2405 0FSTURP
     I                             P 2406 2412 0FSTFUP
     I                             P 2413 2419 0FSTCUP
     I                             P 2420 2425 7FSUEFR
     I                             P 2426 2431 7FSTEFR
     I                               2432 2436  FSOFYC
     I                               2437 2441  FSTFYC
     I                             P 2442 2447 7FSRKVL
     I                               2448 2448  FSRKSN
     I                               2469 2486  URACC
     I                               2487 2504  UPACC
     I                               2505 2522  RONS
     I                               2523 2540  PONS
     I                               2541 2545  FSOFCC                                        CAS008
     I                               2546 2550  FSTFCC                                        CAS008
     I                               2603 2606  CLAS                                          CDL038
0397 I*
0398 I*    DEALS FILE -TRAILER RECORD.
0399 I*
0400 I          NS  06    1 CT
0401 I                                  1    1  RECI
0402 I                                  2    7 0DLNO
0403 I                                  8    8  RCDT
0404 I                                  9   10 0RCDC
0405 I**********                       11   16 0CNUM                                          CSD027
0405 I                                 11   16  CNUM                                          CSD027
0406 I                             P   17   19 0NORD
0407 I                             P   20   22 0FLSZ
0408 I                             P   23   25 0NLRB
0409 I                             P   26   28 0NINS
0410 I                             P   29   31 0NDEL
0411 I                             P   32   34 0NLRA
0412 I                             P   35   42 0VLBF
0413 I                             P   43   44 0VLBL
0414 I                             P   45   52 0VRIF
0415 I                             P   53   54 0VRIL
0416 I                             P   55   62 0VRDF
0417 I                             P   63   64 0VRDL
0418 I                             P   65   72 0VLAFD
0419 I                             P   73   74 0VLALD
0420 I                             P   75   77 0DTMR
0421 I                             P   78   80 0ITMR
0422 I                             P  394  396 0LCD
0423 I                                397  397  CHTP
0424 I                             P  398  400 0TNLU
0427 I*
0428 I          NS  18
     I/COPY WNCPYSRC,DL0280I005
      *                                                                   S01486
     I*****MMDELULL  NS        1 CD                                                    S01486 205045
     IDEALSALL  NS        1 CD                                                                205045
     I         OR         1 CM                                                  S01486
     I         OR         1 CN                                                  S01486
     I         OR         1 C*                                                  S01486
     I         OR         1 CR                                                  S01486
     I                             P 1147 1153 8DLFXRD                          S01486
     I                                230  231  HKMTAX                                        CER048
      *                                                                                       232928
     IHISTSHMF                                                                                232928
     I              VDAT                        MVDAT                                         232928
     I              CCY                         MFCCY                                       BUG12910
     I              AMTP                        MAMTP                                         232928
     I              AITC                        MAITC                                         232928
     I              INTR                        MINTR                                         232928
     I              IPRD                        MIPRD                                         232928
      *                                                                                       232928
     IHISTSHPF                                                                                232928
     I              VDAT                        PVDAT                                         232928
     I              CCY                         PFCCY                                       BUG12910
     I              AMTP                        PAMTP                                         232928
     I              AITC                        PAITC                                         232928
     I              INTR                        HPINTR                                        232928
     I              IPRD                        PIPRD                                         232928
      *                                                                                       232928
     IHISTSHQF                                                                                232928
     I              VDAT                        QVDAT                                         232928
     I              AMTP                        QAMTP                                         232928
     I              AITC                        QAITC                                         232928
     I              INTR                        QINTR                                         232928
     I              IPRD                        QIPRD                                         232928
0431 I*
0432 IDEAMSDHF      07
0430 I*    DEAL AMENDMENTS FILE - HEADER RECORD.
0429 I*
0434 I              DLNO                        DLNODM
0435 I              VDAT                        VDATDM
0438 I              PAQI                        ACRIND
     I/COPY WNCPYSRC,DL0280I013
0442 I*
0446 IDEAMSDIF      08
     I/COPY WNCPYSRC,DL0280I014
0444 I*    DEALS AMENDMENT FILE - DETAIL RECORD.
0443 I*
0448 I              DLNO                        DLNODM
0449 I              VDAT                        VDATDM
0450 I              DASN                        DASNDM
0451 I              DTYP                        DTYPDM
0452 I              DLST                        DLSTDM
0455 I              BRTT                        BRTTDM
0456 I              RTSP                        RTSPDM
0460 I              CNUM                        CNUMDM
     I              BRCA                        BRCADM                          096561
     I/COPY WNCPYSRC,DL0280I003
     I              FSRP                        FSRPDM                          CAC001
     I              STCY                        STCYM                           CEU003
      *                                                                                       CDL017
     I              PSTM                        PSTMDM
     I              PONS                        PONSDM
     I              PIBN                        PIBNDM
     I              PIBA                        PIBADM
     I              POBN                        POBNDM
     I              POCN                        POCNDM
     I              RCRN                        RCRNDM
     I              RCRA                        RCRADM
     I              RVNO                        RVNODM
     I              AWBN                        AWBNDM
     I              AWBA                        AWBADM
     I              BENN                        BENNDM
     I              BENA                        BENADM
     I              DTP1                        DTP1DM
     I              DTP2                        DTP2DM
     I              DTP3                        DTP3DM
     I              DTP4                        DTP4DM
     I              DCHG                        DCHGDM
     I              BTB1                        BTB1DM
     I              BTB2                        BTB2DM
     I              BTB3                        BTB3DM
     I              BTB4                        BTB4DM
     I              BTB5                        BTB5DM
     I              BTB6                        BTB6DM
     I              BRTE                        BRTEDM
      *                                                                                       CDL017
     I              ROBN                        RROBN
     I              ROCN                        RROCN
     I**********    POBN                            RPOBN                              CGL020 CDL017
     I**********    POCN                            RPOCN                              CGL020 CDL017
     I**********    AWBN                            RAWBN                              CGL020 CDL017
     I**********    AWBA                            RAWBA                              CGL020 CDL017
     I**********    BENN                            RBENN                              CGL020 CDL017
     I**********    BENA                            RBENA                              CGL020 CDL017
     I              CLAS                        CLASDM                                        CDL038
     I              CNSP                        CNSPDM                                        CRE073
     I              CNSG                        CNSGDM                                        CRE073
     I              RDMT                        RDMTDM                                        CRE073
     I              RDFD                        RDFDDM                                        CRE073
     I/COPY WNCPYSRC,DL0280I004
     IDAMBRDIF      08
     I/COPY WNCPYSRC,DL0280I015
     I              DLNO                        DLNODM
     I              VDAT                        VDATDM
     I              DASN                        DASNDM
     I              DTYP                        DTYPDM
     I              DLST                        DLSTDM
     I              BRTT                        BRTTDM
     I              RTSP                        RTSPDM
     I              CNUM                        CNUMDM
     I              BRCA                        BRCADM                          096561
     I              CLAS                        CLASDM                                        CDL038
     I              ORED                        OREDDM                                      MD031283
0473 I*
     I** NA's Parcels extract detail  (Output by DL4040/DLC0606A)         S01378
     IDAPCLIF       08                                                          S01378
     I              PSZE                        PSZEDM                          S01378
     I              DLNO                        DLNODM                          S01378
     I              VDAT                        VDATDM                          S01378
     I              DASN                        DASNDM                          S01378
     I              DTYP                        DTYPDM                          S01378
     I              DLST                        DLSTDM                          S01378
     I              BRTT                        BRTTDM                          S01378
     I              RTSP                        RTSPDM                          S01378
     I              CNUM                        CNUMDM                          S01378
     I              CLAS                        CLASDM                                        CDL038
0474 I*
0477 IDEAMSDJF      09
0475 I*    DEALS AMENDMENT FILE - TRAILER RECORD.
0476 I*
0479 I              DLNO                        DLNODM
0480 I              VDAT                        VDATDM
0481 I              DASN                        DASNDM
0482 I              NORE                        NORDAM
0489 I              NLRA                        NLRADM
0490 I              VLBF                        VLBFDM
0491 I              VLBL                        VLBLDM
0500 I              VLAF                        VLAFDM
0501 I              VLAL                        VLALDM
0505 I*
     I**  NA's Parcels extract trailer (output by DL4040/DLC0606A)        S01378
     IDAPCLJF       09                                                          S01378
     I              DLNO                        DLNODM                          S01378
     I              VDAT                        VDATDM                          S01378
     I              DASN                        DASNDM                          S01378
     I              NORE                        NORDAM                          S01378
     I              NLRA                        NLRADM                          S01378
     I              VLBF                        VLBFDM                          S01378
     I              VLBL                        VLBLDM                          S01378
     I              VLAF                        VLAFDM                          S01378
     I              VLAL                        VLALDM                          S01378
     I*                                                                   S01378
     IDAMBRDJF      09
     I              DLNO                        DLNODM              17
     I              VDAT                        VDATDM
     I              DASN                        DASNDM
     I              NORE                        NORDAM
     I              NLRA                        NLRADM
     I              VLBF                        VLBFDM
     I              VLBL                        VLBLDM
     I              VLAF                        VLAFDM
     I              VLAL                        VLALDM
     I/COPY WNCPYSRC,DL0280IIP2                                           S01408
     IDLEMDAD0                                                                                     B
     I*    Early maturity Deal Amendments                                                    BUG4426
     I              DLNO                        DLNODM                                             B
     I              VDAT                        VDATDM                                             B
     I              DASN                        DASNDM                                             B
     I              DTYP                        DTYPDM                                             B
     I              DLST                        DLSTDM                                             B
     I              BRTT                        BRTTDM                                             B
     I              RTSP                        RTSPDM                                             B
     I              CNUM                        CNUMDM                                             B
     I              BRCA                        BRCADM                                             B
     I              FSRP                        FSRPDM                                             B
     I              STCY                        STCYM                                              B
     I              PSTM                        PSTMDM                                             B
     I              PONS                        PONSDM                                             B
     I              PIBN                        PIBNDM                                             B
     I              PIBA                        PIBADM                                             B
     I              POBN                        POBNDM                                             B
     I              POCN                        POCNDM                                             B
     I              RCRN                        RCRNDM                                             B
     I              RCRA                        RCRADM                                             B
     I              RVNO                        RVNODM                                             B
     I              AWBN                        AWBNDM                                             B
     I              AWBA                        AWBADM                                             B
     I              BENN                        BENNDM                                             B
     I              BENA                        BENADM                                             B
     I              DTP1                        DTP1DM                                             B
     I              DTP2                        DTP2DM                                             B
     I              DTP3                        DTP3DM                                             B
     I              DTP4                        DTP4DM                                             B
     I              DCHG                        DCHGDM                                             B
     I              BTB1                        BTB1DM                                             B
     I              BTB2                        BTB2DM                                             B
     I              BTB3                        BTB3DM                                             B
     I              BTB4                        BTB4DM                                             B
     I              BTB5                        BTB5DM                                             B
     I              BTB6                        BTB6DM                                             B
     I              BRTE                        BRTEDM                                             B
     I              ROBN                        RROBN                                              B
     I              ROCN                        RROCN                                              B
     I              CLAS                        CLASDM                                        CDL038
      *                                                                                      BUG4426
     IDEALS     NS        8 CD
     I                                  1    1  RECR2
     I                                138  139 0SDST2
     I**********                            140 151 OSDA2                              CGL020 CGL029
     I                                140  151  OSDAQQ
     I                             P  214  220 0TOTI2
     I**********                      466  471 0WROBN                                         CSD027
     I**********                      472  477 0WROCN                                         CSD027
     I**********                      535  540 0WPOBN                                         CSD027
     I**********                      541  546 0WPOCN                                         CSD027
     I                                466  471  WROBN                                         CSD027
     I                                472  477  WROCN                                         CSD027
     I                                535  540  WPOBN                                         CSD027
     I                                541  546  WPOCN                                         CSD027
     I                                598  605  WAWBN
     I                                606  640  WAWBA
     I                                641  648  WBENN
     I                                649  683  WBENA
     I                               1263 1280  OSDA2
     IDEALS     NS        8 CC
     I                                  1    1  RECR2
     I                                138  139 0SDST2
     I**********                            140 151 OSDA2                              CGL020 CGL029
     I                                140  151  OSDAQQ
     I                             P  214  220 0TOTI2
     I**********                      486  491 0WROBN                                         CSD027
     I**********                      492  497 0WROCN                                         CSD027
     I**********                      555  560 0WPOBN                                         CSD027
     I**********                      561  566 0WPOCN                                         CSD027
     I                                486  491  WROBN                                         CSD027
     I                                492  497  WROCN                                         CSD027
     I                                555  560  WPOBN                                         CSD027
     I                                561  566  WPOCN                                         CSD027
     I                                618  625  WAWBN
     I                                626  660  WAWBA
     I                                661  668  WBENN
     I                                669  703  WBENA
     I**********                     1760 1777  OSDA2                                         240667
     I                               1721 1738  OSDA2                                         240667
     IDEALS     NS                                                              S01392
     I                                  1    1  RECR2                           S01392
     I                             P  214  220 0TOTI2                           S01392
     I/COPY WNCPYSRC,DL0280I006
0234 I                                138  139 0SDST2                           080603
0235 I**********                            140 151 OSDA2                              080603 CGL029
     I                                140  151  OSDAQQ
     I/COPY WNCPYSRC,DL0280I007
0507 I*
     I** RENAME FIELD ON INTEREST HISTORY FILES                           S01383
     I*                                                                   CIR001
     IDLCFSCD0                                                                  CIR001
     I              CFLA                        ULCFLA                          CIR001
     IDLNPVPD0
     I              FSDAMT                      DLDAMT
     I/COPY WNCPYSRC,DL0280I009
     IDLPCSCD0                                                                  CIR001
     I              PAMT                        ULPAMT                          CIR001
     I              OTIN                        ULOTIN                          CIR001
     I/COPY WNCPYSRC,DL0280I002
     IASHTRND0                                                                                CLE148
     I              FSDLNO                      FSDLNX                                        CLE148
     IASHTRNDB                                                                                CLE148
     I              FSDLNO                      FSDLNX                                        CLE148
     IINTPSDDX      69                                                          068074
     I              RECI                        RECII                           S01383
     I              CCY                         CCYI                            S01383
     I              BRCA                        BRCAI                           S01383
     I              CNUM                        CNUMI                           068074
     ICOINTDDX      99                                                          068074
     I              RECI                        RECII                           S01383
     I              CCY                         CCYI                            S01383
     I              BRCA                        BRCAI                           S01383
     I              CNUM                        CNUMI                           068074
     I/COPY WNCPYSRC,DL0280IIP4                                           S01408
     I/COPY WNCPYSRC,DL0280IIP1                                           S01408
     I*                                                                   S01408
     I**********/COPY ZSRSRC,ZHOLI                                        S01195             BUG6293
     I**********/COPY ZSRSRC,ZINTDYZ1                                     066550             BUG6293
     I**********/COPY ZSRSRC,ZDATE9Z2                                     066550             BUG6293
     I**********/COPY ZSRSRC,ZDAT10Z1                                     126017             BUG6293
     I/COPY WNCPYSRC,DL0280I011
0618 I/EJECT
     C/COPY WNCPYSRC,DL0280C552
     C     DMBRKY        KLIST                                                                 S0111
     C                   KFLD                    DLNODM                                        S0111
     C                   KFLD                    VDATDM                                        S0111
     C     *LIKE         DEFINE    CNUM          ##CNUM                                        CPM00
     C     *LIKE         DEFINE    KYSETL        WYSETL
     C     *LIKE         DEFINE    KYOSTL        WYOSTL
     C     *LIKE         DEFINE    KYSTBR        WYSTBR
     C     *LIKE         DEFINE    RECI          FSROLI
     C     PMPOKY        KLIST                                                                 S0148
     C                   KFLD                    ##CNUM                                        CPM00
     C                   KFLD                    PTFR                                          S0148
     C     KHDGKY        KLIST
     C                   KFLD                    KMOD              2
     C**********         KFLD                    DLNO                                         CLE148
     C                   KFLD                    DLNOA             6                          CLE148
     C     KHDGK1        KLIST                                                                228701
     C                   KFLD                    FSHEDI                                       228701
     C                   KFLD                    KDHIN             1                          228701
     C     KDTST         KLIST                                                                228701
     C                   KFLD                    DTYP                                         228701
     C                   KFLD                    DLST                                         228701
     C/COPY WNCPYSRC,DL0280C024
      *                                                                                       CDL033
      ** Key list to access FRCD Issued Date Schedule file.                                   CDL033
      *                                                                                       CDL033
     C     KFRCD1        KLIST                                                                CDL033
     C                   KFLD                    DLNO                                         CDL033
     C                   KFLD                    KRCIP             1                          CDL033
     C                   KFLD                    KPRDT             5 0                        CDL033
0618 C/SPACE 5                                                            S01119
0619 C   40              GOTO      BEGIN
     C/COPY WNCPYSRC,DL0280CCP8                                           S01408
0620 C*
0622 C*      CALCULATIONS.
0623 C*
0624 C     FIRST         TAG                                                    ** FIRST TAG **
      *                                                                   CDL006
      ** Key list to access SE Charge Types logical file.                 CDL006
      *                                                                   CDL006
     C/COPY WNCPYSRC,DLH00456
     C     KDLCCG        KLIST                                                                 CDL00
     C                   KFLD                    KCYCD             3                           CDL00
     C                   KFLD                    FCMC                                          CDL00
     C     HISKEY        KLIST                                                                CDL013
     C                   KFLD                    ECUST                                        CDL013
     C                   KFLD                    EDLAC                                        CDL013
     C                   KFLD                    EDAIN                                        CDL013
     C     EXTKEY        KLIST                                                                CDL013
     C                   KFLD                    ECURR                                        CDL013
     C                   KFLD                    EBRCA                                        CDL013
     C                   KFLD                    EDAIN                                        CDL013
     C                   KFLD                    EDLAC                                        CDL013
     C/COPY WNCPYSRC,DL0280CP14                                           S01408
     C* SETLL                                                             CIR001
     C     KDTSL         KLIST                                                                 CIR00
     C                   KFLD                    DLNO                                          CIR00
     C                   KFLD                    OTIN                                          CIR00
     C                   KFLD                    RCIP                                          CIR00
     C                   KFLD                    PRDT                                          CIR00
     C* READE                                                             CIR001
     C     KDTSP         KLIST                                                                 CIR00
     C                   KFLD                    DLNO                                          CIR00
     C                   KFLD                    OTIN                                          CIR00
     C                   KFLD                    RCIP                                          CIR00
     C* SETLL/CHAIN                                                       CIR001
     C     KCFSL         KLIST                                                                 CIR00
     C                   KFLD                    DLNO                                          CIR00
     C                   KFLD                    OTIN                                          CIR00
     C                   KFLD                    PRDT                                          CIR00
     C* READE                                                             CIR001
     C     KCFSP         KLIST                                                                 CIR00
     C                   KFLD                    DLNO                                          CIR00
     C                   KFLD                    OTIN                                          CIR00
     C* SETLL/CHAIN                                                       CIR001
     C     KPCSL         KLIST                                                                 CIR00
     C                   KFLD                    DLNO                                          CIR00
     C                   KFLD                    PORTH             1                           CIR00
     C                   KFLD                    PRDT                                          CIR00
     C* READE                                                             CIR001
     C     KPCSP         KLIST                                                                 CIR00
     C                   KFLD                    DLNO                                          CIR00
     C                   KFLD                    PORTH                                         CIR00
     C     IRHKEY        KLIST                                                                CDL034
     C                   KFLD                    DLNO                                         CDL034
     C                   KFLD                    KDATE             5 0                        CDL034
0625 C*
0626 C*          GET INSTALLATION CONTROL RECS.
     C/COPY WNCPYSRC,DL0280C654
0628 C                   SETON                                          40                     S0111
     C/COPY WNCPYSRC,DL0280CCP1                                           S01408
     C                   MOVEA     CPY@          CPY2@            80
     C                   CLEAR                   L3PSTR                                       CDL038
     C                   Z-ADD     *ZEROS        KYOTH                                       BUG8466
     C                   Z-ADD     *ZEROS        F1FVAL                                      BUG8466
     C                   Z-ADD     *ZEROS        F1SDAT                                      BUG8466
     C                   Z-ADD     *ZEROS        SLID                                      BUG11013A
     C                   Z-ADD     *ZEROS        MDAT                                      BUG11013A
     C                   Z-ADD     *ZEROS        BRTT                                      BUG11013A
     C                   Z-ADD     *ZEROS        BRTE                                      BUG11013A
     C                   Z-ADD     *ZEROS        RTSP                                      BUG11013A
     C                   Z-ADD     *ZEROS        INTR                                      BUG11013A
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             S01194
     C                   CALL      'AOBANKR0'                                                  S0119
     C                   PARM      '*MSG    '    @RTCD             7                           S0119
     C                   PARM      '*FIRST  '    @OPTN             7                           S0119
     C     @BANK         PARM      @BANK         DSFDY                                         S0119
     C     @RTCD         IFNE      *BLANK                                                      S0119
     C                   MOVEL     'SDBANKPD'    DBFILE           10             ************* S0119
     C                   MOVEL     '01'          DBASE             3             *DBERROR 001* S0119
     C                   MOVEL     @OPTN         DBOPTN            7             ************* S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   EXSR      *PSSR                                                       S0119
     C                   GOTO      EOJ                                                         S0119
     C                   END                                                                   S0119
     C/COPY WNCPYSRC,DL0280C153                                           S01408
2891 C     BJDFIN        COMP      'M'                                    98    MMDDYY, 98 ON  S0119
0642 C*  CHECK FOR LAST DAY ACCRUAL,TAX AND FEDERAL FUNDS & FRA/IRS       S01194
     C** CALL ACCESS PROGRAM FOR GENERAL LEDGER DETAILS                   S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                   CALL      'AOGELRR1'
     C                   PARM      '*MSG    '    @RTCD                                         S0119
     C                   PARM      '*FIRST  '    @OPTN                                         S0119
     C********** SDGELR    PARM SDGELR    DSFDY                                        CIR005 CGL029
     C     SDGELR        PARM      SDGELR        DSSDY
     C*                                                                   S01194
     C     @RTCD         IFNE      *BLANK                                                      S0119
     C                   MOVEL     'SDGELRPD'    DBFILE                          ************* S0119
     C                   MOVEL     '02'          DBASE                           *DBERROR 002* S0119
     C                   MOVEL     @OPTN         DBOPTN                          ************* S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   EXSR      *PSSR                                                       S0119
     C                   GOTO      EOJ                                                         S0119
     C                   END                                                                   S0119
     C     BJDNWD        SUB       BKAPDT        Wdiff404          5 0                      BUG13404
     C*                                                                   S01194
0642 C*     CHECK FOR LAST DAY ACCRUALS INDICATOR                         S01194
     C*                                                                   S01194
0644 C     BKALDI        COMP      'Y'                                    29                   S0119
     C/COPY WNCPYSRC,DLH00067
      *                                                                                       CAS001
      ** Access AOSARDR0 and check if CAS001 is installed                                     CAS001
      *                                                                                       CAS001
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CAS001'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF    '
     C                   MOVE      'SCSARDPD'    DBFILE
     C                   MOVEL     '040'         DBASE
     C                   MOVEL     'CAS001'      DBKEY
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   EXSR      *PSSR
     C                   ENDIF
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CAS001            1
     C                   ELSE
     C                   MOVE      'N'           CAS001
     C                   ENDIF
      *                                                                                       CGL020
      ** Access AOSARDR0 and check if CGL020 is installed                                     CGL020
      *                                                                                       CGL020
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CGL020'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF    '
     C                   MOVE      'SCSARDPD'    DBFILE
     C                   MOVEL     '042'         DBASE
     C                   MOVEL     'CGL020'      DBKEY
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   EXSR      *PSSR
     C                   ENDIF
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CGL020            1
     C                   MOVE      *BLANKS       STINFO            2
     C                   ELSE
     C                   MOVE      'N'           CGL020
     C                   ENDIF
     C** CALL ACCESS PROGRAM FOR DEALING DETAILS                          S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                   CALL      'AODEALR1'
     C                   PARM      '*MSG    '    @RTCD                                         S0119
     C                   PARM      '*FIRST  '    @OPTN                                         S0119
     C********** @DEAL     PARM @DEAL     DSFDY                           S01194              CGL029
     C     @DEAL         PARM      @DEAL         DSSDY
     C     @RTCD         IFNE      *BLANK                                                      S0119
     C                   MOVEL     'SDDEALPD'    DBFILE                          ************* S0119
     C                   MOVEL     '03'          DBASE                           *DBERROR 003* S0119
     C                   MOVEL     @OPTN         DBOPTN                          ************* S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   EXSR      *PSSR                                                       S0119
     C                   GOTO      EOJ                                                         S0119
     C                   END                                                                   S0119
     C/COPY WNCPYSRC,DL0280C718
     C     @RTCD         IFEQ      *BLANKS
     C     CAS001        ANDEQ     'Y'
     C     BNBCPL        ANDEQ     'Y'
     C                   MOVE      'Y'           WBCPL             1
     C                   ELSE
     C                   MOVE      'N'           WBCPL
     C                   ENDIF
     C***/COPY*WNCPYSRC,DL0280C655***                                                         CFC006
     C/COPY WNCPYSRC,DL0280C655                                                             MD020563
      *****************************************************************           AR1097176 MD020563
      ***Check*if*CFC006*is*installed**********************************           AR1097176 MD020563
      *****************************************************************           AR1097176 MD020563
     C**********         EVAL      CFC006 = 'N'                                   AR1097176 MD020563
     C**********         CALL      'AOSARDR0'                                     AR1097176 MD020563
     C**********         PARM      *BLANKS       PRTCD                            AR1097176 MD020563
     C**********         PARM      '*VERIFY'     POPTN                            AR1097176 MD020563
     C**********         PARM      'CFC006'      PSARD                            AR1097176 MD020563
     C*****SCSARD        PARM      SCSARD        DSFDY                            AR1097176 MD020563
      *****************************************************************           AR1097176 MD020563
     C**********         IF        PRTCD = *BLANKS                                AR1097176 MD020563
     C**********         EVAL      CFC006 = 'Y'                                   AR1097176 MD020563
     C**********         ENDIF                                                    AR1097176 MD020563
      *****************************************************************           AR1097176 MD020563
     C                   EVAL      SUPFLG = 'N'                                               CFC006
     C**********         IF        CFC006 = 'Y'                                   AR1097176 MD020563
     C                   CALL      'AOCOMR0'                                                  CFC006
     C**********         PARM      'DLC0603'     PNAME                              CFC006 AR1097176
     C                   PARM      'DLC0606B'    PNAME                                     AR1097176
     C                   PARM      '*ALL'        PCSEQ                                        CFC006
     C**********         PARM      'DL0195001'   PSCTN                              CFC006 AR1097176
     C                   PARM      'DL0280001'   PSCTN                                     AR1097176
     C                   PARM      *BLANKS       PRTCD                                        CFC006
      *                                                                                       CFC006
     C                   IF        PRTCD = 'Y      '                                          CFC006
     C                   EVAL      SUPFLG = 'Y'                                               CFC006
     C                   ENDIF                                                                CFC006
     C**********         ENDIF                                                    AR1097176 MD020563
     C*                                                                   CIR001
     C** Check if switchable feature CIR001 is switched on                CIR001
     C*                                                                   CIR001
     C                   CALL      'AOSARDR0'                                                  CIR00
     C                   PARM      *BLANKS       @RTCD                                         CIR00
     C                   PARM      '*VERIFY'     @OPTN                                         CIR00
     C                   PARM      'CIR001'      @SARD             6                           CIR00
     C     SCSARD        PARM      SCSARD        DSFDY                                         CIR00
     C     @RTCD         IFNE      *BLANK                                                      CIR00
     C     @RTCD         ANDNE     '*NRF   '                                                   CIR00
     C                   MOVEL     'SCSARDPD'    DBFILE                         ***************CIR00
     C                   MOVEL     '16'          DBASE                          * DB ERROR 16 *CIR00
     C                   MOVEL     'CIR001'      DBKEY                          ***************CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   END                                                                   CIR00
     C     @RTCD         IFEQ      *BLANKS                                                     CIR00
     C                   MOVE      'Y'           CIR001            1                           CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'N'           CIR001                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C** Check if switchable feature CIR002 is switched on                CIR002
     C*                                                                   CIR002
     C                   CALL      'AOSARDR0'                                                  CIR00
     C                   PARM      *BLANKS       @RTCD                                         CIR00
     C                   PARM      '*VERIFY'     @OPTN                                         CIR00
     C                   PARM      'CIR002'      @SARD             6                           CIR00
     C     SCSARD        PARM      SCSARD        DSFDY                                         CIR00
     C     @RTCD         IFNE      *BLANK                                                      CIR00
     C     @RTCD         ANDNE     '*NRF   '                                                   CIR00
     C                   MOVEL     'SCSARDPD'    DBFILE                         ***************CIR00
     C                   MOVEL     '17'          DBASE                          * DB ERROR 17 *CIR00
     C                   MOVEL     'CIR002'      DBKEY                          ***************CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   END                                                                   CIR00
     C     @RTCD         IFEQ      *BLANKS                                                     CIR00
     C                   MOVE      'Y'           CIR002            1                           CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'N'           CIR002                                        CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C637
      *                                                                   CEU003
      ** Access AOSARDR0 to check if CEU003 is installed                  CEU003
      *                                                                   CEU003
     C                   CALL      'AOSARDR0'                                                  CEU00
     C                   PARM      *BLANKS       @RTCD             7                           CEU00
     C                   PARM      '*VERIFY'     @OPTN             7                           CEU00
     C                   PARM      'CEU003'      @SARD             6                           CEU00
     C     @RTCD         IFEQ      *BLANKS                                                     CEU00
     C                   MOVE      'Y'           CEU003            1                           CEU00
     C                   ELSE                                                                  CEU00
     C                   MOVE      'N'           CEU003                                        CEU00
     C                   END                                                                   CEU00
      *                                                                   CEU015
      ** Access AOSARDR0 to check if CEU015 is installed                  CEU015
      *                                                                   CEU015
     C                   CALL      'AOSARDR0'                                                  CEU01
     C                   PARM      '       '     @RTCD                                         CEU01
     C                   PARM      '*VERIFY'     @OPTN                                         CEU01
     C                   PARM      'CEU015'      @SARD             6                           CEU01
     C     @RTCD         IFNE      *BLANK                                                      CEU01
     C     @RTCD         ANDNE     '*NRF   '                                                   CEU01
     C                   MOVEL     'SCSARDPD'    DBFILE                          ************* CEU01
     C                   MOVEL     '19'          DBASE                           *DBERROR 019* CEU01
     C                   MOVEL     @RTCD         DBKEY                           * * * * * * * CEU01
     C                   SETON                                        U7U8LR                   CEU01
     C                   EXSR      *PSSR                                                       CEU01
     C                   GOTO      EOJ                                                         CEU01
     C                   ENDIF                                                                 CEU01
     C     @RTCD         IFEQ      *BLANK                                                      CEU01
     C                   MOVE      'Y'           CEU015            1                           CEU01
     C                   ENDIF                                                                 CEU01
      *                                                                   CSW005
      ** Access AOSARDR0 to check if CSW005 is switched on                CSW005
      *                                                                   CSW005
     C                   CALL      'AOSARDR0'                                                  CSW00
     C                   PARM      '       '     #RTCD             7                           CSW00
     C                   PARM      '*VERIFY'     @OPTN             7                           CSW00
     C                   PARM      'CSW005'      @SARD             6                           CSW00
     C     SCSARD        PARM      SCSARD        DSFDY                                         CSW00
     C     #RTCD         IFNE      *BLANK                                                      CSW00
     C     #RTCD         ANDNE     '*NRF   '                                                   CSW00
     C                   MOVEL     'SCSARDPD'    DBFILE                                        CSW00
     C                   MOVEL     '19'          DBASE                                         CSW00
     C                   MOVEL     'CSW005'      DBKEY                          * DB ERROR 19* CSW00
     C                   SETON                                        U7U8LR                   CSW00
     C                   EXSR      *PSSR                                                       CSW00
     C                   GOTO      EOJ                                                         CSW00
     C                   ENDIF                                                                 CSW00
     C     #RTCD         IFEQ      *BLANKS                                                     CSW00
     C                   MOVE      'Y'           CSW005            1                           CSW00
     C                   ELSE                                                                  CSW00
     C                   MOVE      'N'           CSW005                                        CSW00
     C                   ENDIF                                                                 CSW00
     C/COPY WNCPYSRC,DL0280C519
      *                                                                   CSW011
      ** Access AOSARDR0 to check if CSW011 is switched on                CSW011
      *                                                                   CSW011
     C                   CALL      'AOSARDR0'                                                  CSW01
     C                   PARM      '       '     #RTCD             7                           CSW01
     C                   PARM      '*VERIFY'     @OPTN             7                           CSW01
     C                   PARM      'CSW011'      @SARD             6                           CSW01
     C     SCSARD        PARM      SCSARD        DSFDY                                         CSW01
     C     #RTCD         IFNE      *BLANK                                                      CSW01
     C     #RTCD         ANDNE     '*NRF   '                                                   CSW01
     C                   MOVEL     'SCSARDPD'    DBFILE                                        CSW01
     C                   MOVEL     '20'          DBASE                                         CSW01
     C                   MOVEL     'CSW011'      DBKEY                          * DB ERROR 20* CSW01
     C                   SETON                                        U7U8LR                   CSW01
     C                   EXSR      *PSSR                                                       CSW01
     C                   GOTO      EOJ                                                         CSW01
     C                   ENDIF                                                                 CSW01
     C     #RTCD         IFEQ      *BLANKS                                                     CSW01
     C                   MOVE      'Y'           CSW011            1                           CSW01
     C                   ELSE                                                                  CSW01
     C                   MOVE      'N'           CSW011                                        CSW01
     C                   ENDIF                                                                 CSW01
     C/COPY WNCPYSRC,DL0280C065
     C**                                                                  S01383
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED     S01383
     C**                                                                  S01383
     C                   CALL      'AOSARDR0'                                                  S0138
     C                   PARM      '       '     @RTCD                                         S0138
     C                   PARM      '*VERIFY'     @OPTN                                         S0138
     C                   PARM      'S01383'      @SARD             6                           S0138
     C     @RTCD         IFNE      *BLANK                                                      S0138
     C     @RTCD         ANDNE     '*NRF   '                                                   S0138
     C                   MOVEL     'SCSARDPD'    DBFILE                          ************* S0138
     C                   MOVEL     '10'          DBASE                           *DBERROR 010* S0138
     C                   MOVEL     @RTCD         DBKEY                           * * * * * * * S0138
     C                   SETON                                        U7U8LR                   S0138
     C                   EXSR      *PSSR                                                       S0138
     C                   GOTO      EOJ                                                         S0138
     C                   END                                                                   S0138
     C     @RTCD         IFEQ      *BLANK                                                      S0138
     C                   MOVEL     'Y'           S01383            1                           S0138
     C                   MOVEL     '1'           *IN19                                         S0138
     C                   END                                                                   S0138
     C*                                                                   S01194
     C**   CHECK ROLLOVER SWITCH ON                                       S01434
     C*                                                                   S01434
     C                   CALL      'AOSARDR0'                                                  S0143
     C/COPY WNCPYSRC,DL0280C438
     C                   PARM      '       '     @RTCD             7                           08060
     C/COPY WNCPYSRC,DL0280C439
     C                   PARM      '*KEY   '     @OPTN             7                           S0143
     C                   PARM      'S01434'      @SARD             6                           S0143
     C     SCSARD        PARM      SCSARD        DSFDY                                         S0143
     C     @RTCD         IFEQ      *BLANKS                                                     S0143
     C                   MOVE      'Y'           S01434            1                           S0143
     C                   ELSE                                                                  S0143
     C                   MOVE      'N'           S01434                                        S0143
     C                   ENDIF                                                                 S0143
     C*                                                                   S01434
     C**   CHECK 'WITHHOLD TAX' SWITCH ON                                 S01460
     C*                                                                   S01460
     C                   CALL      'AOSARDR0'                                                  S0146
     C/COPY WNCPYSRC,DL0280C440
     C                   PARM      '       '     @RTCD             7                           08060
     C/COPY WNCPYSRC,DL0280C441
     C                   PARM      '*KEY   '     @OPTN             7                           S0146
     C                   PARM      'S01460'      @SARD             6                           S0146
     C     SCSARD        PARM      SCSARD        DSFDY                                         S0146
     C     @RTCD         IFEQ      *BLANKS                                                     S0146
     C                   MOVE      'Y'           S01460            1                           S0146
     C/COPY WNCPYSRC,DL0280C442
     C                   MOVEL     '1'           *IN19                                         08060
     C/COPY WNCPYSRC,DL0280C443
     C                   ELSE                                                                  S0146
     C                   MOVE      'N'           S01460                                        S0146
     C                   ENDIF                                                                 S0146
     C*                                                                   S01460
     C** IF BRT SAR NOT INSTALLED,                                        S01383
0642 C*       CHECK FOR TAX RATE                                          S01194
     C*                                                                   S01383
     C/COPY WNCPYSRC,DL0280C444
0645 C     BNHKTR        IFNE      0                                                           11083
     C/COPY WNCPYSRC,DL0280C445
0645 C                   MOVE      '1'           *IN19                                         11083
     C                   END                                                                   S0138
      *                                                                   CIR004
      ** Access Switchable Features Details                               CIR004
      *                                                                   CIR004
     C                   CALL      'AOSARDR0'                                                  CIR00
     C                   PARM      *BLANKS       PRTCD                                         CIR00
     C                   PARM      '*VERIFY '    POPTN                                         CIR00
     C                   PARM      'CIR004'      PSARD             6                           CIR00
     C     SCSARD        PARM      SCSARD        DSSDY                                         CIR00
     C     PRTCD         IFEQ      *BLANKS                                                     CIR00
     C                   MOVE      'Y'           CIR004            1                           CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'N'           CIR004                                        CIR00
     C                   ENDIF                                                                 CIR00
     C/COPY WNCPYSRC,DL0280C569
      *                                                                   CDL006
      ** Access Switchable Feature Details, Check if CDL006 is            CDL006
      ** switch on.                                                       CDL006
      *                                                                   CDL006
     C                   CALL      'AOSARDR0'                                                  CDL00
     C                   PARM      *BLANKS       PRTCD             7                           CDL00
     C                   PARM      '*VERIFY '    POPTN             7                           CDL00
     C                   PARM      'CDL006'      PSARD             6                           CDL00
     C     SCSARD        PARM      SCSARD        DSSDY                                         CDL00
     C     PRTCD         IFNE      *BLANKS                                                     CDL00
     C     PRTCD         ANDNE     '*NRF '                                                     CDL00
     C                   MOVEL     '011'         DBASE                                         CDL00
     C                   MOVEL     'SCSARDPD'    DBFILE                                        CDL00
     C                   MOVEL     PSARD         DBKEY                                         CDL00
     C                   SETON                                        U7U8LR                   CDL00
     C                   EXSR      *PSSR                                                       CDL00
     C                   GOTO      EOJ                                                         CDL00
     C                   ENDIF                                                                 CDL00
     C     PRTCD         IFEQ      *BLANKS                                                     CDL00
     C                   MOVE      'Y'           CDL006            1                           CDL00
     C                   ELSE                                                                  CDL00
     C                   MOVE      'N'           CDL006                                        CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CIR005
      ** Access Switchable Feature Details, Check if CIR005 is            CIR005
      ** switch on.                                                       CIR005
      *                                                                   CIR005
     C                   CALL      'AOSARDR0'                                                  CIR00
     C                   PARM      *BLANKS       PRTCD                                         CIR00
     C                   PARM      '*VERIFY '    POPTN                                         CIR00
     C                   PARM      'CIR005'      PSARD                                         CIR00
     C     SCSARD        PARM      SCSARD        DSFDY                                         CIR00
     C     PRTCD         IFNE      *BLANKS                                                     CIR00
     C     PRTCD         ANDNE     '*NRF '                                                     CIR00
     C                   MOVEL     '025'         DBASE                                         CIR00
     C                   MOVEL     'SCSARDPD'    DBFILE                                        CIR00
     C                   MOVEL     PSARD         DBKEY                                         CIR00
     C                   MOVE      *ON           *INU7                                         CIR00
     C                   MOVE      *ON           *INU8                                         CIR00
     C                   MOVE      *ON           *INLR                                         CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
     C     PRTCD         IFEQ      *BLANKS                                                     CIR00
     C                   MOVE      'Y'           CIR005            1                           CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'N'           CIR005                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
      ** Check if switchable feature CIR003 is switched on                CIR003
      *                                                                   CIR003
     C                   CALL      'AOSARDR0'                                                  CIR00
     C                   PARM      *BLANKS       PRTCD                                         CIR00
     C                   PARM      '*VERIFY'     POPTN                                         CIR00
     C                   PARM      'CIR003'      PSARD                                         CIR00
     C     SCSARD        PARM      SCSARD        DSFDY                                         CIR00
     C     PRTCD         IFNE      *BLANKS                                                     CIR00
     C     PRTCD         ANDNE     '*NRF '                                                     CIR00
     C                   MOVEL     '026'         DBASE                                         CIR00
     C                   MOVEL     'SCSARDPD'    DBFILE                                        CIR00
     C                   MOVEL     PSARD         DBKEY                                         CIR00
     C                   MOVE      *ON           *INU7                                         CIR00
     C                   MOVE      *ON           *INU8                                         CIR00
     C                   MOVE      *ON           *INLR                                         CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
     C     PRTCD         IFEQ      *BLANKS                                                     CIR00
     C                   MOVE      'Y'           CIR003            1                           CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'N'           CIR003                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
      ** Check if switchable feature CIR006 is switched on                CIR006
      *                                                                   CIR006
     C                   CALL      'AOSARDR0'                                                  CIR00
     C                   PARM      *BLANKS       PRTCD                                         CIR00
     C                   PARM      '*VERIFY'     POPTN                                         CIR00
     C                   PARM      'CIR006'      PSARD                                         CIR00
     C     SCSARD        PARM      SCSARD        DSFDY                                         CIR00
     C     PRTCD         IFNE      *BLANKS                                                     CIR00
     C     PRTCD         ANDNE     '*NRF '                                                     CIR00
     C                   MOVEL     '027'         DBASE                                         CIR00
     C                   MOVEL     'SCSARDPD'    DBFILE                                        CIR00
     C                   MOVEL     PSARD         DBKEY                                         CIR00
     C                   MOVE      *ON           *INU7                                         CIR00
     C                   MOVE      *ON           *INU8                                         CIR00
     C                   MOVE      *ON           *INLR                                         CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
     C     PRTCD         IFEQ      *BLANKS                                                     CIR00
     C                   MOVE      'Y'           CIR006            1                           CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'N'           CIR006                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                                       CIR007
      ** Access AOSARDR0 and check if CIR007 is installed                                     CIR007
      *                                                                                       CIR007
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CIR007'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF    '
     C                   MOVE      'SCSARDPD'    DBFILE                         ***************
     C                   MOVEL     '039'         DBASE                          * DB ERROR 39 *
     C                   MOVEL     'CIR007'      DBKEY                          ***************
     C                   SETON                                        U7U8LR
     C                   EXSR      *PSSR
     C                   ENDIF
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CIR007            1
     C                   ELSE
     C                   MOVE      'N'           CIR007
     C                   ENDIF
      *                                                                                       CIR008
      ** Access AOSARDR0 and check if CIR008 is installed                                     CIR008
      *                                                                                       CIR008
     C     *DTAARA       DEFINE                  LDA
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CIR008'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CIR008
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF    '
     C     *LOCK         IN        LDA
     C                   MOVE      'SCSARDPD'    DBFILE
     C                   MOVEL     '041'         DBASE
     C                   MOVEL     'CIR008'      DBKEY
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   OUT       LDA
     C                   EXSR      *PSSR
     C                   ENDIF
      *                                                                                       CIR008
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CIR008            1
     C                   ELSE
     C                   MOVE      'N'           CIR008
     C                   ENDIF
      *                                                                                       CAS004
      ** Access AOSARDR0 and check if CAS004 is installed                                     CAS004
      *                                                                                       CAS004
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CAS004'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CAS004
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF    '
     C                   MOVE      'SCSARDPD'    DBFILE
     C                   MOVEL     '042'         DBASE
     C                   MOVEL     'CAS004'      DBKEY
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   EXSR      *PSSR
     C                   ENDIF
      *                                                                                       CAS004
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CAS004            1
     C                   ELSE
     C                   MOVE      'N'           CAS004
     C                   ENDIF
      *                                                                                       CAS005
      ** Access AOSARDR0 and check if CAS005 is installed                                     CAS005
      *                                                                                       CAS005
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CAS005'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CAS005
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF    '
     C                   MOVE      'SCSARDPD'    DBFILE
     C                   MOVEL     '043'         DBASE
     C                   MOVEL     'CAS005'      DBKEY
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   EXSR      *PSSR
     C                   ENDIF
      *                                                                                       CAS005
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CAS005            1
     C                   ELSE
     C                   MOVE      'N'           CAS005
     C                   ENDIF
      *                                                                                       CAS005
     C**********         Z-ADD     0             C                 3 0                        262532
     C                   Z-ADD     0             C                 4 0                        262532
      *                                                                                       CAS006
      ** Access AOSARDR0 and check if CAS006 is installed                                     CAS006
      *                                                                                       CAS006
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CAS006'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
      *                                                                                       CAS006
     C     PRTCD         IFNE      *BLANKS
     C     PRTCD         ANDNE     '*NRF    '
     C                   MOVE      'SCSARDPD'    DBFILE
     C                   MOVEL     '044'         DBASE
     C                   MOVEL     'CAS006'      DBKEY
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   EXSR      *PSSR
     C                   ENDIF
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CAS006            1
     C                   ELSE
     C                   MOVE      'N'           CAS006
     C                   ENDIF
      ** Check if Interest Statement for Call/Time Deposit feature is ON                      CDL012
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CDL012'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
     C     PRTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CDL012            1
     C                   OPEN      DLTCSTPD
     C                   OPEN      DLTCSTV4
     C                   OPEN      DEALDCV0
     C                   ELSE
     C                   MOVE      'N'           CDL012
     C                   ENDIF
      *                                                                                       CDL018
      ** Check if CDL018 is switched on                                                       CDL018
      *                                                                                       CDL018
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CDL018'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
     C     PRTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CDL018            1
     C                   ELSE
     C                   MOVE      'N'           CDL018
     C                   ENDIF
      *                                                                                     AR755195
      ** Check if CDL019 is switched on                                                     AR755195
      *                                                                                     AR755195
     C                   CALL      'AOSARDR0'                                               AR755195
     C                   PARM      *BLANKS       PRTCD                                      AR755195
     C                   PARM      '*VERIFY'     POPTN                                      AR755195
     C                   PARM      'CDL019'      PSARD                                      AR755195
     C     SCSARD        PARM      SCSARD        DSFDY                                      AR755195
     C     PRTCD         IFEQ      *BLANK                                                   AR755195
     C                   MOVE      'Y'           CDL019            1                        AR755195
     C                   ELSE                                                               AR755195
     C                   MOVE      'N'           CDL019                                     AR755195
     C                   ENDIF                                                              AR755195
      *                                                                                       CDL020
      ** Check if CDL020 is switched on                                                       CDL020
      *                                                                                       CDL020
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CDL020'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
     C     PRTCD         IFEQ      *BLANK
     C                   MOVE      'Y'           CDL020            1
     C                   ELSE
     C                   MOVE      'N'           CDL020
     C                   ENDIF
      *                                                                                      BUG3937
     C                   CALL      'AOSARDR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*VERIFY'     POPTN
     C                   PARM      'CLE025'      PSARD
     C     SCSARD        PARM      SCSARD        DSFDY
     C     PRTCD         IFEQ      *BLANKS
     C                   MOVE      'Y'           CLE025            1
     C                   ELSE
     C                   MOVE      'N'           CLE025
     C                   ENDIF
      *                                                                                       CDL034
      ** Check for CDL034                                                                     CDL034
     C                   CALL      'AOSARDR0'                                                 CDL034
     C                   PARM      *BLANKS       PRTCD                                        CDL034
     C                   PARM      '*VERIFY'     POPTN                                        CDL034
     C                   PARM      'CDL034'      PSARD                                        CDL034
     C     SCSARD        PARM      SCSARD        DSFDY                                        CDL034
     C     PRTCD         IFEQ      *BLANKS                                                    CDL034
     C                   MOVE      'Y'           CDL034            1                          CDL034
     C                   ELSE                                                                 CDL034
     C                   MOVE      'N'           CDL034                                       CDL034
     C                   ENDIF                                                                CDL034
      ** Access AOSARDR0 and check if CAS009 is installed                                     CAS009
     C                   CALL      'AOSARDR0'                                                 CAS009
     C                   PARM      *BLANKS       PRTCD                                        CAS009
     C                   PARM      '*VERIFY'     POPTN                                        CAS009
     C                   PARM      'CAS009'      PSARD                                        CAS009
     C     SCSARD        PARM      SCSARD        DSFDY                                        CAS009
                                                                                              CAS009
     C                   IF        PRTCD <> *BLANKS AND PRTCD <> '*NRF   '                    CAS009
     C                   EVAL      DBFILE = 'SCSARDPD'                                        CAS009
     C                   EVAL      DBASE  = '045'                                             CAS009
     C                   EVAL      DBKEY  = 'CAS009'                                          CAS009
     C                   EVAL      *INU7 = *ON                                                CAS009
     C                   EVAL      *INU8 = *ON                                                CAS009
     C                   EVAL      *INLR = *ON                                                CAS009
     C                   EXSR      *PSSR                                                      CAS009
     C                   ENDIF                                                                CAS009
                                                                                              CAS009
     C                   IF        PRTCD = *BLANKS                                            CAS009
     C                   MOVE      'Y'           CAS009            1                          CAS009
     C                   ELSE                                                                 CAS009
     C                   MOVE      'N'           CAS009                                       CAS009
     C                   ENDIF                                                                CAS009
                                                                                              CAS009
     C                   IF        CAS009 = 'Y'                                               CAS009
      ** Mandatory read so read 1st record                                                    CAS009
     C**********         READ      MMCFLSPD                               45         CAS009 BUG13075
     C                   READ      MMCFLSL0                               45                BUG13075
      *                                                                                       232928
      ** Mandatory read so read 1st record, keep the orig value of IN60                       232928
      *                                                                                       232928
     C                   MOVE      *IN60         W#TIND            1                          232928
      *                                                                                       232928
     C                   READ      MMHISTL0                               60                  232928
      *                                                                                       232928
     C                   MOVE      W#TIND        *IN60                                        232928
      ** Retrieve Hedging ICd                                                                 CAS009
     C                   CALL      'AOHEDGR0'                                                 CAS009
     C                   PARM      *BLANKS       PRTCD                                        CAS009
     C                   PARM      '*FIRST'      POPTN                                        CAS009
     C     SDHEDG        PARM      SDHEDG        DSFDY                                        CAS009
                                                                                              CAS009
     C                   IF        PRTCD <> *BLANKS                                           CAS009
     C                   EVAL      DBFILE = 'SCHEDGPD'                                        CAS009
     C                   EVAL      DBASE = '46'                                               CAS009
     C                   EVAL      DBKEY = '*FIRST'                                           CAS009
     C                   OUT       LDA                                                        CAS009
     C                   EXSR      *PSSR                                                      CAS009
     C                   ENDIF                                                                CAS009
     C                   ENDIF                                                                CAS009
      *                                                                                       CGL031
      ** Access AOSARDR0 and check if CGL031 is installed                                     CGL031
      *                                                                                       CGL031
     C                   CALL      'AOSARDR0'                                                 CGL031
     C                   PARM      *BLANKS       PRTCD                                        CGL031
     C                   PARM      '*VERIFY'     POPTN                                        CGL031
     C                   PARM      'CGL031'      PSARD                                        CGL031
     C     SCSARD        PARM      SCSARD        DSFDY                                        CGL031
      *                                                                                       CGL031
     C     PRTCD         IFNE      *BLANKS                                                    CGL031
     C     PRTCD         ANDNE     '*NRF    '                                                 CGL031
     C                   MOVE      'SCSARDPD'    DBFILE                                       CGL031
     C                   MOVEL     '042'         DBASE                                        CGL031
     C                   MOVEL     'CGL031'      DBKEY                                        CGL031
     C                   MOVE      *ON           *INU7                                        CGL031
     C                   MOVE      *ON           *INU8                                        CGL031
     C                   MOVE      *ON           *INLR                                        CGL031
     C                   EXSR      *PSSR                                                      CGL031
     C                   ENDIF                                                                CGL031
      *                                                                                       CGL031
     C     PRTCD         IFEQ      *BLANKS                                                    CGL031
     C                   MOVE      'Y'           CGL031            1                          CGL031
     C                   ELSE                                                                 CGL031
     C                   MOVE      'N'           CGL031                                       CGL031
     C                   ENDIF                                                                CGL031
      *                                                                                     MD026788
      ** Access system values file                                                          MD026788
      *                                                                                     MD026788
     C     CGL031        IFEQ      'Y'                                                      MD026788
     C                   CALL      'AOSVALR0'                                               MD026788
     C                   PARM      *BLANKS       PRTCD                                      MD026788
     C                   PARM      UseDealCust   PSysVal01                                  MD026788
     C                   PARM                    PCurSet01                                  MD026788
     C                   PARM                    PSysVal02                                  MD026788
     C                   PARM                    PCurSet02                                  MD026788
     C                   PARM                    PSysVal03                                  MD026788
     C                   PARM                    PCurSet03                                  MD026788
     C                   PARM                    PSysVal04                                  MD026788
     C                   PARM                    PCurSet04                                  MD026788
     C                   PARM                    PSysVal05                                  MD026788
     C                   PARM                    PCurSet05                                  MD026788
     C                   PARM                    PSysVal06                                  MD026788
     C                   PARM                    PCurSet06                                  MD026788
     C                   PARM                    PSysVal07                                  MD026788
     C                   PARM                    PCurSet07                                  MD026788
     C                   PARM                    PSysVal08                                  MD026788
     C                   PARM                    PCurSet08                                  MD026788
     C                   PARM                    PSysVal09                                  MD026788
     C                   PARM                    PCurSet09                                  MD026788
     C                   PARM                    PSysVal10                                  MD026788
     C                   PARM                    PCurSet10                                  MD026788
      *                                                                                     MD026788
     C                   IF        PRTCD <> *Blanks                                         MD026788
     C     *LOCK         IN        LDA                                                      MD026788
     C                   EVAL      DBFILE = 'SDSVALPD'                                      MD026788
     C                   EVAL      DBASE = '58'                                             MD026788
     C                   EVAL      DBKEY = PSysVal01                                        MD026788
     C                   OUT       LDA                                                      MD026788
     C                   EXSR      *PSSR                                                    MD026788
     C                   ENDIF                                                              MD026788
      *                                                                                     MD026788
     C                   MOVEL     PCurSet01     DealCust          1                        MD026788
     C                   ENDIF                                                              MD026788
      *                                                                                       233277
      ** Access AOSARDR0 and check if CGL032 is installed                                     233277
      *                                                                                       233277
     C                   CALL      'AOSARDR0'                                                 233277
     C                   PARM      *BLANKS       PRTCD                                        233277
     C                   PARM      '*VERIFY'     POPTN                                        233277
     C                   PARM      'CGL032'      PSARD                                        233277
     C     SCSARD        PARM      SCSARD        DSFDY                                        233277
      *                                                                                       233277
     C     PRTCD         IFNE      *BLANKS                                                    233277
     C     PRTCD         ANDNE     '*NRF    '                                                 233277
     C                   MOVE      'SCSARDPD'    DBFILE                                       233277
     C                   MOVEL     '045'         DBASE                                        233277
     C                   MOVEL     'CGL032'      DBKEY                                        233277
     C                   MOVE      *ON           *INU7                                        233277
     C                   MOVE      *ON           *INU8                                        233277
     C                   MOVE      *ON           *INLR                                        233277
     C                   EXSR      *PSSR                                                      233277
     C                   ENDIF                                                                233277
      *                                                                                       233277
     C     PRTCD         IFEQ      *BLANKS                                                    233277
     C                   MOVE      'Y'           CGL032            1                          233277
     C                   ELSE                                                                 233277
     C                   MOVE      'N'           CGL032                                       233277
     C                   ENDIF                                                                233277
      *                                                                                    BUG23009A
      ** Access AOSARDR0 and check if CER048 is installed                                  BUG23009A
      *                                                                                    BUG23009A
     C                   CALL      'AOSARDR0'                                              BUG23009A
     C                   PARM      *BLANKS       PRTCD                                     BUG23009A
     C                   PARM      '*VERIFY'     POPTN                                     BUG23009A
     C                   PARM      'CER048'      PSARD                                     BUG23009A
     C     SCSARD        PARM      SCSARD        DSFDY                                     BUG23009A
      *                                                                                    BUG23009A
     C     PRTCD         IFNE      *BLANKS                                                 BUG23009A
     C     PRTCD         ANDNE     '*NRF    '                                              BUG23009A
     C                   MOVE      'SCSARDPD'    DBFILE                                    BUG23009A
     C                   MOVEL     '049'         DBASE                                     BUG23009A
     C                   MOVEL     'CER048'      DBKEY                                     BUG23009A
     C                   MOVE      *ON           *INU7                                     BUG23009A
     C                   MOVE      *ON           *INU8                                     BUG23009A
     C                   MOVE      *ON           *INLR                                     BUG23009A
     C                   EXSR      *PSSR                                                   BUG23009A
     C                   ENDIF                                                             BUG23009A
      *                                                                                    BUG23009A
     C     PRTCD         IFEQ      *BLANKS                                                 BUG23009A
     C                   MOVE      'Y'           CER048            1                       BUG23009A
     C                   ELSE                                                              BUG23009A
     C                   MOVE      'N'           CER048                                    BUG23009A
     C                   ENDIF                                                             BUG23009A
     C/COPY WNCPYSRC,DLH00457
      *                                                                                     MD031283
     C                   IF        CDL020 = 'Y'                                             MD031283
     C                   EVAL      PSysVal02 = UseHistRate                                  MD031283
     C                   ENDIF                                                              MD031283
      *                                                                                       245308
      ** Access system values file                                                            245308
      **                                                                                      245308
      *                                                                                       245308
     C                   CALL      'AOSVALR0'                                                 245308
     C                   PARM      *BLANKS       PRTCD                                        245308
     C                   PARM      FRAAccNHL     PSysVal01                                    245308
     C                   PARM                    PCurSet01                                    245308
     C                   PARM                    PSysVal02                                    245308
     C                   PARM                    PCurSet02                                    245308
     C                   PARM                    PSysVal03                                    245308
     C                   PARM                    PCurSet03                                    245308
     C                   PARM                    PSysVal04                                    245308
     C                   PARM                    PCurSet04                                    245308
     C                   PARM                    PSysVal05                                    245308
     C                   PARM                    PCurSet05                                    245308
     C                   PARM                    PSysVal06                                    245308
     C                   PARM                    PCurSet06                                    245308
     C                   PARM                    PSysVal07                                    245308
     C                   PARM                    PCurSet07                                    245308
     C                   PARM                    PSysVal08                                    245308
     C                   PARM                    PCurSet08                                    245308
     C                   PARM                    PSysVal09                                    245308
     C                   PARM                    PCurSet09                                    245308
     C                   PARM                    PSysVal10                                    245308
     C                   PARM                    PCurSet10                                    245308
                                                                                              245308
     C                   IF        PRTCD <> *Blanks                                           245308
     C     *LOCK         IN        LDA                                                        245308
     C                   EVAL      DBFILE = 'SDSVALPD'                                        245308
     C                   EVAL      DBASE = '57'                                               245308
     C                   EVAL      DBKEY = PSysVal01                                          245308
     C                   OUT       LDA                                                        245308
     C                   EXSR      *PSSR                                                      245308
     C                   ENDIF                                                                245308
                                                                                              245308
     C                   MOVEL     PCurSet01     FRAACCHDG         1                          245308
      *                                                                                     MD031283
     C                   MOVEL     'N'           HSTRAT                                     MD031283
     C                   IF        CDL020 = 'Y'                                             MD031283
     C                   MOVEL     PCurSet02     HSTRAT                                     MD031283
     C                   ENDIF                                                              MD031283
      *                                                                                       CGL031
     C     KYEUTI        KLIST                                                                CGL031
     C                   KFLD                    BJRDNB                                       CGL031
     C                   KFLD                    WEVDAT            5 0                     MD024874A
     C                   KFLD                    WKMODI            1                          CGL031
     C                   KFLD                    DLNO                                         CGL031
      *                                                                                       CGL031
     C     WDLKEY        KLIST                                                                 CIR00
     C                   KFLD                    DLNO                                          CIR00
     C                   KFLD                    KEDCD                                         CIR00
     C/COPY WNCPYSRC,DL0280C670
      *                                                                   CDL006
      ** Open Charge type file (DLCCGDL0) if feature CDL006 is            CDL006
      ** installed.                                                       CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Commission taken, Charges taken, Charges on principal         CDL006
      ** changes or Accrue commission.                                    CDL006
     C     BNCOTK        IFEQ      'Y'                                                         CDL00
     C     BNCHTK        OREQ      'Y'                                                         CDL00
     C     BNCHPC        OREQ      'Y'                                                         CDL00
     C     BNACCO        OREQ      'Y'                                                         CDL00
     C                   MOVE      'Y'           WUCHCO            1                           CDL00
     C                   OPEN      DLCCGDL0                                                    CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C                   CALL      'AOSARDR0'                                                 CDL013
     C                   PARM      *BLANKS       @RTCD             7                          CDL013
     C                   PARM      '*VERIFY'     @OPTN             7                          CDL013
     C                   PARM      'CDL013'      @SARD             6                          CDL013
     C                   PARM                    DSFDY                                        CDL013
     C     @RTCD         IFNE      *BLANKS                                                    CDL013
     C                   MOVE      '0'           CDL013            1                          CDL013
     C                   ELSE                                                                 CDL013
     C                   MOVE      '1'           CDL013                                       CDL013
     C                   MOVE      *ON           *IN19                                        CDL013
     C                   MOVEL(P)  'RETAIL'      WTYPE            10                          CDL013
     C                   OPEN      SDSTAAL1                                                   CDL013
     C     WTYPE         CHAIN     SDSTAAL1                           18                      CDL013
     C     *IN18         IFEQ      '1'                                                        CDL013
     C                   MOVEL     'SDSTAAL1'    DBFILE           10            ************  CDL013
     C                   MOVEL     WTYPE         DBOPTN            7            * DBERR 48 *  CDL013
     C                   MOVEL     '48'          DBASE             3            ************  CDL013
     C                   SETON                                        U7U8LR                  CDL013
     C                   EXSR      *PSSR                                                      CDL013
     C                   GOTO      EOJ                                                        CDL013
     C                   ENDIF                                                                CDL013
     C                   OPEN      GLWHTCL0                                                   CDL013
     C                   OPEN      GLXTAXL0                                                   CDL013
     C     *DTAARA       DEFINE                  GLWHT                                        CDL013
     C     *LOCK         IN        GLWHT                                                      CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280C111                                           S01408
      *                                                                                       CDL099
      ** Determine if CDL099 feature is enabled                                               CDL099
      *                                                                                       CDL099
     C                   MOVE      *BLANK        CDL099            1                          CDL099
     C                   CALL      'AOSARDR0'                                                 CDL099
     C                   PARM      *BLANKS       PRTCD                                        CDL099
     C                   PARM      '*VERIFY'     POPTN                                        CDL099
     C                   PARM      'CDL099'      PSARD                                        CDL099
     C     SCSARD        PARM      SCSARD        DSFDY                                        CDL099
      *                                                                                       CDL099
     C     PRTCD         IFEQ      *BLANKS                                                    CDL099
     C                   MOVE      'Y'           CDL099                                       CDL099
     C                   ELSE                                                                 CDL099
     C                   MOVE      'N'           CDL099                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL033
      ** Determine if Floating Rate CD Issued feature is                                      CDL033
      ** switched on.                                                                         CDL033
      *                                                                                       CDL033
     C                   MOVE      *BLANK        CDL033            1                          CDL033
     C                   CALL      'AOSARDR0'                                                 CDL033
     C                   PARM      *BLANKS       PRTCD                                        CDL033
     C                   PARM      '*VERIFY'     POPTN                                        CDL033
     C                   PARM      'CDL033'      PSARD                                        CDL033
     C     SCSARD        PARM      SCSARD        DSFDY                                        CDL033
      *                                                                                       CDL033
     C     PRTCD         IFEQ      *BLANKS                                                    CDL033
     C                   MOVE      'Y'           CDL033                                       CDL033
     C                   OPEN      DLFRSCL5                                                   CDL033
     C     *INU1         IFEQ      *ON                                                        CDL033
     C                   OPEN      DLFRSCL0                                                   CDL033
     C                   ENDIF                                                                CDL033
     C                   ELSE                                                                 CDL033
     C     PRTCD         IFNE      '*NRF   '                                                  CDL033
     C                   MOVE      '025'         DBASE                                        CDL033
     C                   MOVEL     'CDL033'      DBKEY                                        CDL033
     C                   MOVEL     POPTN         DBOPTN                                       CDL033
     C                   MOVEL     'SCSARDPD'    DBFILE                                       CDL033
     C                   MOVE      *ON           *INU7                                        CDL033
     C                   MOVE      *ON           *INU8                                        CDL033
     C                   MOVE      *ON           *INLR                                        CDL033
     C                   EXSR      *PSSR                                                      CDL033
     C                   GOTO      EOJ                                                        CDL033
     C                   ELSE                                                               MD026719
     C     PRTCD         IFEQ      '*NRF   '                                                MD026719
     C                   MOVE      'N'           CDL033                                     MD026719
     C                   ENDIF                                                              MD026719
     C                   ENDIF                                                                CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CIR014
      ** Determine if switchable feature CIR014 is installed.                                 CIR014
      *                                                                                       CIR014
     C                   MOVE      *BLANK        CIR014                                       CIR014
     C                   CALL      'AOSARDR0'                                                 CIR014
     C                   PARM      *BLANKS       PRTCD                                        CIR014
     C                   PARM      '*VERIFY'     POPTN                                        CIR014
     C                   PARM      'CIR014'      PSARD                                        CIR014
     C     SCSARD        PARM      SCSARD        DSFDY                                        CIR014
      *                                                                                       CIR014
     C                   IF        PRTCD = *BLANKS                                            CIR014
     C                   EVAL      CIR014 = 'Y'                                               CIR014
     C                   ELSE                                                                 CIR014
     C                   IF        PRTCD <> '*NRF   '                                         CIR014
     C                   MOVEL     '026'         DBASE                                        CIR014
     C                   MOVEL     'CIR014'      DBKEY                                        CIR014
     C                   MOVEL     POPTN         DBOPTN                                       CIR014
     C                   MOVEL     'SCSARDPD'    DBFILE                                       CIR014
     C                   MOVE      *ON           *INU7                                        CIR014
     C                   MOVE      *ON           *INU8                                        CIR014
     C                   MOVE      *ON           *INLR                                        CIR014
     C                   EXSR      *PSSR                                                      CIR014
     C                   GOTO      EOJ                                                        CIR014
     C                   ENDIF                                                                CIR014
     C                   ENDIF                                                                CIR014
      *                                                                                       CIR014
      *                                                                                       CIR017
      ** Check if CIR017 - Separate Business Day Convention for SIRS                          CIR017
      *                                                                                       CIR017
     C                   CALL      'AOSARDR0'                                                 CIR017
     C                   PARM                    @RTCD                                        CIR017
     C                   PARM      '*VERIFY'     @OPTN                                        CIR017
     C                   PARM      'CIR017'      @SARD                                        CIR017
      *                                                                                       CIR017
     C     @RTCD         IFEQ      *BLANKS                                                    CIR017
     C                   MOVE      'Y'           CIR017            1                          CIR017
     C                   ELSE                                                                 CIR017
     C                   MOVE      'N'           CIR017                                       CIR017
     C                   ENDIF                                                                CIR017
      ** Check if CIR018 - Separate Business Day Convention for SIRS                          CIR018
      *                                                                                       CIR018
     C                   CALL      'AOSARDR0'                                                 CIR018
     C                   PARM                    @RTCD                                        CIR018
     C                   PARM      '*VERIFY'     @OPTN                                        CIR018
     C                   PARM      'CIR018'      @SARD                                        CIR018
      *                                                                                       CIR018
     C     @RTCD         IFEQ      *BLANKS                                                    CIR018
     C                   MOVE      'Y'           CIR018            1                          CIR018
     C                   ELSE                                                                 CIR018
     C                   MOVE      'N'           CIR018                                       CIR018
     C                   ENDIF                                                                CIR018
      *                                                                                       CDL096
      ** Check if CDL096 - Business Day Conventions for MM Deals - is switched on             CDL096
      *                                                                                       CDL096
     C                   CALL      'AOSARDR0'                                                 CDL096
     C                   PARM                    @RTCD                                        CDL096
     C                   PARM      '*VERIFY'     @OPTN                                        CDL096
     C                   PARM      'CDL096'      @SARD                                        CDL096
      *                                                                                       CDL096
     C     @RTCD         IFEQ      *BLANKS                                                    CDL096
     C                   MOVE      'Y'           CDL096            1                          CDL096
     C                   ELSE                                                                 CDL096
     C                   MOVE      'N'           CDL096                                       CDL096
     C                   ENDIF                                                                CDL096
      *                                                                                       CDL093
      ** Check if CDL093 is installed                                                         CDL093
      *                                                                                       CDL093
     C                   CALL      'AOSARDR0'                                                 CDL093
     C                   PARM      *BLANKS       @RTCD                                        CDL093
     C                   PARM      '*VERIFY'     @OPTN                                        CDL093
     C                   PARM      'CDL093'      @SARD                                        CDL093
      *                                                                                       CDL093
     C     @RTCD         IFEQ      *BLANKS                                                    CDL093
     C                   MOVE      'Y'           CDL093            1                          CDL093
     C                   ELSE                                                                 CDL093
     C                   MOVE      'N'           CDL093                                       CDL093
     C                   ENDIF                                                                CDL093
      *                                                                                       CDL093
      ** Check if CDL081 is installed                                                         CDL081
      *                                                                                       CDL081
     C                   EVAL      CDL081 = 'N'                                               CDL081
     C                   CALL      'AOSARDR0'                                                 CDL081
     C                   PARM      *BLANKS       PRTCD                                        CDL081
     C                   PARM      '*VERIFY'     POPTN                                        CDL081
     C                   PARM      'CDL081'      PSARD                                        CDL081
     C     SCSARD        PARM      SCSARD        DSFDY                                        CDL081
                                                                                              CDL081
     C                   IF        PRTCD <> *BLANKS                                           CDL081
     C                             AND PRTCD <> '*NRF'                                        CDL081
     C                   EVAL      DBFILE = 'SCSARDPD'                                        CDL081
     C                   EVAL      DBASE  = '058'                                             CDL081
     C                   EVAL      DBOPTN = POPTN                                             CDL081
     C                   EXSR      *PSSR                                                      CDL081
     C                   ENDIF                                                                CDL081
                                                                                              CDL081
     C                   IF        PRTCD = *BLANKS                                            CDL081
     C                   EVAL      CDL081 = 'Y'                                               CDL081
     C                   ENDIF                                                                CDL081
                                                                                              CRE105
      ** Check if CRE105 is installed                                                         CRE105
                                                                                              CRE105
     C                   EVAL      CRE105 = 'N'                                               CRE105
     C                   CALL      'AOSARDR0'                                                 CRE105
     C                   PARM      *BLANKS       PRTCD                                        CRE105
     C                   PARM      '*VERIFY'     POPTN                                        CRE105
     C                   PARM      'CRE105'      PSARD                                        CRE105
     C     SCSARD        PARM      SCSARD        DSFDY                                        CRE105
                                                                                              CRE105
     C                   IF        PRTCD <> *BLANKS                                           CRE105
     C                             AND PRTCD <> '*NRF'                                        CRE105
     C                   EVAL      DBFILE = 'SCSARDPD'                                        CRE105
     C                   EVAL      DBASE = '99'                                               CRE105
     C                   EVAL      DBKEY = PSARD                                              CRE105
     C                   EXSR      *PSSR                                                      CRE105
     C                   ENDIF                                                                CRE105
                                                                                              CRE105
     C                   IF        PRTCD = *BLANKS                                            CRE105
     C                   EVAL      CRE105 = 'Y'                                               CRE105
     C                   ENDIF                                                                CRE105
                                                                                              CRE073
      ** Check if CRE073 is installed                                                         CRE073
                                                                                              CRE073
     C                   EVAL      CRE073 = 'N'                                               CRE073
     C                   CALL      'AOSARDR0'                                                 CRE073
     C                   PARM      *BLANKS       PRTCD                                        CRE073
     C                   PARM      '*VERIFY'     POPTN                                        CRE073
     C                   PARM      'CRE073'      PSARD                                        CRE073
     C     SCSARD        PARM      SCSARD        DSFDY                                        CRE073
                                                                                              CRE073
     C                   IF        PRTCD <> *BLANKS                                           CRE073
     C                             AND PRTCD <> '*NRF'                                        CRE073
     C                   EVAL      DBFILE = 'SCSARDPD'                                        CRE073
     C                   EVAL      DBASE  = '060'                                             CRE073
     C                   EVAL      DBOPTN = POPTN                                             CRE073
     C                   EXSR      *PSSR                                                      CRE073
     C                   ENDIF                                                                CRE073
                                                                                              CRE073
     C                   IF        PRTCD = *BLANKS                                            CRE073
     C                   EVAL      CRE073 = 'Y'                                               CRE073
     C                   ENDIF                                                                CRE073
                                                                                              CGL165
      ** Check if CGL165 is installed                                                         CGL165
     C                   MOVE      'N'           CGL165            1                          CGL165
     C                   CALL      'AOSARDR0'                                                 CGL165
     C                   PARM      *BLANKS       PRTCD                                        CGL165
     C                   PARM      '*VERIFY'     POPTN                                        CGL165
     C                   PARM      'CGL165'      PSARD                                        CGL165
     C     SCSARD        PARM      SCSARD        DSFDY                                        CGL165
                                                                                              CGL165
     C                   IF        PRTCD = *BLANKS                                            CGL165
     C                   EVAL      CGL165 = 'Y'                                               CGL165
     C                   MOVE      *ON           *IN19                                        CGL165
     C                   ENDIF                                                                CGL165
                                                                                              CDL081
      ** Access withholding tax round down system values if CDL081 is on                      CDL081
                                                                                              CDL081
     C                   IF        CDL081 = 'Y'                                               CDL081
     C                   CALL      'AOSVALR0'                                                 CDL081
     C                   PARM      *BLANKS       PRTCD                                        CDL081
     C                   PARM      C#BASE        PSysVal01                                    CDL081
     C                   PARM                    PCurSet01                                    CDL081
     C                   PARM      C#NBAS        PSysVal02                                    CDL081
     C                   PARM                    PCurSet02                                    CDL081
     C                   PARM                    PSysVal03                                    CDL081
     C                   PARM                    PCurSet03                                    CDL081
     C                   PARM                    PSysVal04                                    CDL081
     C                   PARM                    PCurSet04                                    CDL081
     C                   PARM                    PSysVal05                                    CDL081
     C                   PARM                    PCurSet05                                    CDL081
     C                   PARM                    PSysVal06                                    CDL081
     C                   PARM                    PCurSet06                                    CDL081
     C                   PARM                    PSysVal07                                    CDL081
     C                   PARM                    PCurSet07                                    CDL081
     C                   PARM                    PSysVal08                                    CDL081
     C                   PARM                    PCurSet08                                    CDL081
     C                   PARM                    PSysVal09                                    CDL081
     C                   PARM                    PCurSet09                                    CDL081
     C                   PARM                    PSysVal10                                    CDL081
     C                   PARM                    PCurSet10                                    CDL081
                                                                                              CDL081
     C                   IF        PRTCD <> *BLANKS                                           CDL081
     C                   IF        PCurSet01 = '*NRF'                                         CDL081
     C                   EVAL      DBKEY  = PSysVal01                                         CDL081
     C                   ENDIF                                                                CDL081
     C                   IF        PCurSet02 = '*NRF'                                         CDL081
     C                   EVAL      DBKEY  = PSysVal02                                         CDL081
     C                   ENDIF                                                                CDL081
     C                   EVAL      DBASE  = '059'                                             CDL081
     C                   EVAL      DBFILE = 'SCSARDPD'                                        CDL081
     C                   EXSR      *PSSR                                                      CDL081
     C                   ENDIF                                                                CDL081
                                                                                              CDL081
      ** Setup tax amount rounding down indicators                                            CDL081
                                                                                              CDL081
     C                   EVAL      W#BSRD = PCurSet01                                         CDL081
     C                   EVAL      W#NBRD = PCurSet02                                         CDL081
     C                   ENDIF                                                                CDL081
     C*                                                                   S01194
0656 C*    CHECK FOR NEGOTIABLE ASSETS ACCRUALS INDICATOR                 S01194
0658 C     BNNAIA        COMP      'Y'                                    28                   S0119
     C*                                                                   S01194
     C** CALL ACCESS PROGRAM FOR MIDAS MODULES DETAILS                    S01194
     C                   CALL      'AOMMODR0'                                                  S0119
     C                   PARM      '*MSG    '    @RTCD                                         S0119
     C                   PARM      '*FIRST  '    @OPTN                                         S0119
     C     @MMOD         PARM      @MMOD         DSFDY                                         S0119
     C*                                                                   S01194
     C     @RTCD         IFNE      *BLANK                                                      S0119
     C                   MOVEL     'SDMMODPD'    DBFILE                          ************* S0119
     C                   MOVEL     '04'          DBASE                           *DBERROR 004* S0119
     C                   MOVEL     @OPTN         DBOPTN                          ************* S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   EXSR      *PSSR                                                       S0119
     C                   GOTO      EOJ                                                         S0119
     C                   END                                                                   S0119
      *                                                                   CPB002
      ** If Private Banking Module is installed and program DL0280 is     CPB002
      ** running during C.O.B.                                            CPB002
      *                                                                   CPB002
     C     BGN4ST        IFEQ      'Y'                                           Begin BGN4ST  CPB00
     C     *INU1         ANDEQ     *ON                                                         CPB00
      *                                                                   CPB002
      ** Set up Replication Processing Indicator.                         CPB002
     C                   MOVE      'Y'           REPLIC            1                           CPB00
      *                                                                   CPB002
     C                   ENDIF                                                   End BGN4ST    CPB00
     C*                                                                   S01194
      ** Open files for Portfolio Management                              080205
     C     BGPFMG        IFEQ      'Y'                                                         08020
     C                   OPEN      PMHSEXPD                                                    08020
     C                   OPEN      PMPORTPD                                                    08020
     C**********         OPEN      MMDELULL                                             08020 205045
     C                   OPEN      DEALSALL                                                   205045
      *                                                                   CPM004
      ** CALL ACCESS PROGRAM FOR MIDAS MODULES DETAILS                    CPM004
     C                   CALL      'AOPORTR0'                                                  CPM00
     C                   PARM      '*MSG    '    @RTCD                                         CPM00
     C                   PARM      '*FIRST  '    @OPTN                                         CPM00
     C     SDPORT        PARM      SDPORT        DSFDY                                         CPM00
      *                                                                   CPM004
     C     @RTCD         IFNE      *BLANK                                                      CPM00
     C                   MOVEL     'SDPORTPD'    DBFILE                          ************* CPM00
     C                   MOVEL     '18'          DBASE                           *DBERROR 018* CPM00
     C                   MOVEL     @OPTN         DBOPTN                          ************* CPM00
     C                   SETON                                        U7U8LR                   CPM00
     C                   EXSR      *PSSR                                                       CPM00
     C                   GOTO      EOJ                                                         CPM00
     C                   END                                                                   CPM00
     C                   END                                                                   08020
     C*                                                                   CIR001
     C** Open files for Australian Modifications                          CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   OPEN      DLCFSCPD                                                    CIR00
     C                   OPEN      DLDTSCPD                                                    CIR00
     C                   OPEN      DLPCSCPD                                                    CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C553
     C*                                                                   S01194
0642 C*  CHECK FOR FRA/IRS INDICATOR                                      S01194
     C     BGFIIN        COMP      'Y'                                    13                   S0119
     C/COPY WNCPYSRC,DL0280C584
     C*                                                                   LN0884
0642 C*  CHECK FOR MULTIBRANCHING INDICATOR                               LN0884
     C     BGMBIN        IFEQ      'Y'                                                         LN088
      ** This indicator was not used in the program,                                        AR853123
      **  commented out and re-used for Base Rate Change                                    AR853123
     C**********         MOVE      '1'           *IN36                                LN088 AR853123
     C                   END                                                                   LN088
     C/COPY WNCPYSRC,DL0280C585
     C*                                                                   LN0884
     C** CALL ACCESS PROGRAM FOR TRADING DATA  DETAILS                    S01194
     C                   CALL      'AOTRADR0'                                                  S0119
     C                   PARM      '*MSG    '    @RTCD                                         S0119
     C                   PARM      '*FIRST  '    @OPTN                                         S0119
     C     @TRAD         PARM      @TRAD         DSFDY                                         S0119
     C*                                                                   S01194
     C     @RTCD         IFNE      *BLANK                                                      S0119
     C                   MOVEL     'SDTRADPD'    DBFILE                          ************* S0119
     C                   MOVEL     '05'          DBASE                           *DBERROR 005* S0119
     C                   MOVEL     @OPTN         DBOPTN                          ************* S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   EXSR      *PSSR                                                       S0119
     C                   GOTO      EOJ                                                         S0119
     C                   END                                                                   S0119
     C*                                                                   S01383
     C** IF BRT SAR INSTALLED, ACCESS BRT INSTALLATION CONTROL DATA       S01383
     C*                                                                   S01383
     C     S01383        IFEQ      'Y'                                                         S0138
     C                   MOVE      'D'           KRECI             1                           S0138
     C     KRECI         CHAIN     SDBRTDD0                           60                       S0138
     C     *IN60         IFEQ      '1'                                                         S0138
     C                   MOVEL     'SDBRTDPD'    DBFILE                          * * * * * * * S0138
     C                   MOVEL     '11'          DBASE                           *DBERROR 011* S0138
     C                   SETON                                        U7U8LR     * * * * * * * S0138
     C                   EXSR      *PSSR                                                       S0138
     C                   GOTO      EOJ                                                         S0138
     C                   END                                                                   S0138
     C*                                                                   S01383
     C** SET UP WORK FIELDS TO HOLD HALF THE BRT RATES                    S01383
     C*                                                                   S01383
     C     BRTR          DIV(H)    2             WBRTR             7 5          CURRENT RATE   S0138
     C     PBRTR         DIV(H)    2             WPBRTR            7 5          PREVIOUS RATE  S0138
     C*                                                                   S01383
     C**   DETERMINE NUMBER OF DECIMAL PLACES - BASE CURRENCY             S01383
     C*                                                                   S01383
     C                   Z-ADD     1             I                                             S0138
     C     BJCYCD        LOOKUP    CY(I)                                  53                   S0138
     C     *IN53         IFEQ      '1'                                          ** IF  001     S0138
     C                   MOVE      CYD(I)        CYDDS                                         S0138
     C                   Z-ADD     CDP           BCDP              1 0                         S0138
     C                   Z-ADD     SPOT          BSPOT            13 8                         S0138
     C                   Z-ADD     MDIN          BMDIN             1 0                         S0138
     C                   ELSE                                                                  S0138
     C**    ERROR IF NOT FOUND                                            S01383
     C**********         MOVE      '1'           *INU8                                S0138 AR547995
     C                   MOVE      *ON           *INU7                                      AR547995
     C                   MOVE      '1'           *INLR                                         S0138
     C                   MOVE      '1'           *IN80                                         S0138
     C                   MOVE      BJCYCD        XCCY                                          S0138
     C                   GOTO      EOJ                                                         S0138
     C                   END                                                    ** END 001     S0138
     C*                                                                   S01383
     C**   DETERMINE NUMBER OF DECIMAL PLACES - STERLING CURRENCY         S01383
     C*                                                                   S01383
     C                   Z-ADD     1             I                                             S0138
     C     BLCYCD        LOOKUP    CY(I)                                  53                   S0138
     C     *IN53         IFEQ      '1'                                          ** IF  001     S0138
     C                   MOVE      CYD(I)        CYDDS                                         S0138
     C                   Z-ADD     CDP           SCDP              1 0                         S0138
     C                   Z-ADD     SPOT          SSPOT            13 8                         S0138
     C                   Z-ADD     MDIN          SMDIN             1 0                         S0138
     C                   ELSE                                                                  S0138
     C**    ERROR IF NOT FOUND                                            S01383
     C**********         MOVE      '1'           *INU8                                S0138 AR547995
     C                   MOVE      *ON           *INU7                                      AR547995
     C                   MOVE      '1'           *INLR                                         S0138
     C                   MOVE      '1'           *IN80                                         S0138
     C                   MOVE      BLCYCD        XCCY                                          S0138
     C                   GOTO      EOJ                                                         S0138
     C                   END                                                    ** END 001     S0138
     C                   ELSE                                                                  CIR00
      *                                                                   CIR003
      ** Access base currency details                                     CIR003
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     1             I                                             CIR00
     C     BJCYCD        LOOKUP    CY(I)                                  53                   CIR00
     C     *IN53         IFEQ      '1'                                                         CIR00
     C                   MOVE      CYD(I)        CYDDS                                         CIR00
     C                   Z-ADD     CDP           BCDP                                          CIR00
     C                   Z-ADD     SPOT          BSPOT                                         CIR00
     C                   Z-ADD     MDIN          BMDIN                                         CIR00
     C                   ELSE                                                                  CIR00
      ** Error if not found                                               CIR003
     C**********         MOVE      '1'           *INU8                                CIR00 AR547995
     C                   MOVE      *ON           *INU7                                      AR547995
     C                   MOVE      '1'           *INLR                                         CIR00
     C                   MOVE      '1'           *IN80                                         CIR00
     C                   MOVE      BJCYCD        XCCY                                          CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C                   END                                                                   S0138
     C*
0642 C*  CHECK FOR  FEDERAL FUNDS INDICATOR                               S01194
0644 C     BLFFIN        COMP      'Y'                                    14                   S0119
     C*                                                                   S01194
0637 C     BGFIIN        IFEQ      'Y'                                                         S0119
     C** CALL ACCESS PROGRAM FOR FRA/IRS  DETAILS                         S01194
     C                   CALL      'AOFAISR0'                                                  S0119
     C                   PARM      '*MSG    '    @RTCD                                         S0119
     C                   PARM      '*FIRST  '    @OPTN                                         S0119
     C     @FAIS         PARM      @FAIS         DSFDY                                         S0119
     C*                                                                   S01194
     C     @RTCD         IFNE      *BLANK                                                      S0119
     C                   MOVEL     'SDFAISPD'    DBFILE                          ************* S0119
     C                   MOVEL     '06'          DBASE                           *DBERROR 006* S0119
     C                   MOVEL     @OPTN         DBOPTN                          ************* S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   EXSR      *PSSR                                                       S0119
     C                   GOTO      EOJ                                                         S0119
     C                   END                                                                   S0119
     C                   END                                                                   S0119
      *                                                                                     MD035545
      ** Retrieve system value setting                                                      MD035545
      *                                                                                     MD035545
     C                   MOVEL     WPARML        P@OP01                                     MD035545
     C                   CALL      'AOSVALR0'                                               MD035545
     C                   PARM      *BLANKS       W0RTCD            7                        MD035545
     C                   PARM                    P@OP01           20                        MD035545
     C                   PARM                    P@VL01          200                        MD035545
     C                   PARM                    P@OP02           20                        MD035545
     C                   PARM                    P@VL02          200                        MD035545
     C                   PARM                    P@OP03           20                        MD035545
     C                   PARM                    P@VL03          200                        MD035545
     C                   PARM                    P@OP04           20                        MD035545
     C                   PARM                    P@VL04          200                        MD035545
     C                   PARM                    P@OP05           20                        MD035545
     C                   PARM                    P@VL05          200                        MD035545
     C                   PARM                    P@OP06           20                        MD035545
     C                   PARM                    P@VL06          200                        MD035545
     C                   PARM                    P@OP07           20                        MD035545
     C                   PARM                    P@VL07          200                        MD035545
     C                   PARM                    P@OP08           20                        MD035545
     C                   PARM                    P@VL08          200                        MD035545
     C                   PARM                    P@OP09           20                        MD035545
     C                   PARM                    P@VL09          200                        MD035545
     C                   PARM                    P@OP10           20                        MD035545
     C                   PARM                    P@VL10          200                        MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'                             MD035545
      *                                                                                     MD035545
     C     W0RTCD        IFNE      '       '                                                MD035545
     C                   MOVE      'N'           WCALC6                                     MD035545
     C                   ELSE                                                               MD035545
     C                   MOVEL     P@VL01        WCALC6                                     MD035545
     C*****WCALC6        IFEQ      'Y'                                             MD035545 MD047993
     C*****BKALDI        ANDEQ     'Y'                                             MD035545 MD047993
     C**********         MOVE      'Y'           WCALC6                            MD035545 MD047993
     C**********         ELSE                                                      MD035545 MD047993
     C**********         MOVE      'N'           WCALC6                            MD035545 MD047993
     C**********         ENDIF                                                     MD035545 MD047993
     C                   ENDIF                                                              MD035545
      *                                                                                     MD035545
     C/COPY WNCPYSRC,DLH00133
0646 C*
0652 C**N01*****         SETON                                        86LRU8                AR547995
     C  N01              SETON                                        86LRU7                AR547995
0653 C   86              GOTO      EOJ
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
     C                   Z-ADD     1             I                                             CDL00
     C     BJCYCD        LOOKUP    CY(I)                                  53                   CDL00
      *                                                                   CDL006
     C     *IN53         IFEQ      '1'                                                         CDL00
     C                   MOVE      CYD(I)        CYDDS                                         CDL00
     C                   Z-ADD     CDP           BCDP              1 0                         CDL00
     C                   Z-ADD     SPOT          BSPOT            13 8                         CDL00
     C                   Z-ADD     MDIN          BMDIN             1 0                         CDL00
      *                                                                   CDL006
      **  ERROR if not found.                                             CDL006
     C                   ELSE                                                                  CDL00
     C**********         MOVE      '1'           *INU8                                CDL00 AR547995
     C                   MOVE      *ON           *INU7                                      AR547995
     C                   MOVE      '1'           *INLR                                         CDL00
     C                   MOVE      '1'           *IN80                                         CDL00
     C                   MOVE      BJCYCD        XCCY                                          CDL00
     C                   GOTO      EOJ                                                         CDL00
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C154                                           S01408
0654 C*
0656 C**         AND OUTPUT MINTN HEADER RECORD
0657 C*
0658 C                   EXCEPT
0660 C     DKREC         ADD       1             DKREC
0661 C   19TNREC         ADD       1             TNREC
0662 C     TOTDLS        ADD       1             TOTDLS            5 0
0663 C*
0664 C*****  GET DAMSX HEADER
0665 C*
0666 C                   READ      DAMSX                                  85                   BHF64
0667 C**N07*****         SETON                                        U8LR85                AR547995
     C  N07              SETON                                        U7LR85                AR547995
0668 C   85              GOTO      EOJ
0669 C     ACRIND        COMP      'Y'                                    52
0670 C     TOTDMS        ADD       1             TOTDMS            5 0
0671 C                   Z-ADD     0             ZERO3             3 0
0672 C                   Z-ADD     0             ZERO5             5 0
0672 C                   Z-ADD     0             ZERO6             6 0                         S0545
0673 C                   Z-ADD     0             ZERO13           13 0
0674 C                   Z-ADD     0             ZERO15           15 0
     C                   Z-ADD     0             ZER117           11 7
     C                   Z-ADD     1             RPAGE1            1 0                         S0111
0674 C                   MOVE      *BLANKS       BLNK10           10                           S0545
0674 C                   MOVE      *BLANKS       BLNK6             6                          CSD027
     C                   MOVE      *BLANKS       @ACCD            10                        AR746445
     C                   MOVE      *BLANKS       @KEYC            10                        AR746445
     C*                                                                   BHF641
     C** READ AGAIN FROM DAMSX.IF A TRAILER,THERE ARE NO DEAL AMENDMENTS  BHF641
     C** TODAY SO INDICATOR 35 IS SET ON TO STOP ANY READING OF THIS FILE BHF641
     C*                                                                   BHF641
0666 C                   READ      DAMSX                                  85                   BHF64
0667 C   09              SETON                                            35                   BHF64
2080 C   09              ADD       1             TOTDMS                                        BHF64
     C/COPY WNCPYSRC,DL0280C036
0667 C***85*****         SETON                                          U8LR          BHF64 AR547995
     C   85              SETON                                          U7LR                AR547995
0675 C                   GOTO      EOJ2
0676 C*
0677 C*****    BEGIN IS THE STARTING POINT FOR ALL DETAIL
0678 C*             PROCESSING.
0679 C*
0680 C     BEGIN         TAG                                                    ** BEGIN TAG **LN071
     C                   EVAL      PSTXA = 0                                                MD037285
     C                   MOVE      TAXI          WTAXI             1                          CER069
     C                   IF        *IN03 = *ON AND TAXI = 'A'                                 CER069
     C                   EXSR      SRACTX                                                     CER069
     C                   ENDIF                                                                CER069
     C                   EVAL      CtrBV = 0                                                MD031283
     C                   EVAL      NIDATF= 'N'                                              MD031631
     C                   EVAL      *IN36 = '0'                                              AR853123
     C                   MOVE      *BLANKS       FSACAI                                       CAS009
     C                   IF        CAS009 = 'Y' AND DTYP <> 'IL' AND                          CAS009
     C                             DTYP <> 'ID'                                               CAS009
     C                   IF        *IN03 = *ON OR *IN04 = *ON OR *IN05 = *ON                  CAS009
     C                   MOVE      *IN54         SVIN54            1                          CAS009
     C     KDTST         CHAIN     FDDTSTL0                           54                      CAS009
     C                   IF        *IN54 = *ON                                                CAS009
     C                   EVAL      DBFILE = 'FDDTSTPD'                                        CAS009
     C                   EVAL      DBASE = '47'                                               CAS009
     C                   EVAL      DBOPTN = @OPTN                                             CAS009
     C                   EVAL      DBKEY = DTYP                                               CAS009
     C                   SETON                                        U7U8LR                  CAS009
     C                   EXSR      *PSSR                                                      CAS009
     C                   ENDIF                                                                CAS009
     C                   MOVE      SVIN54        *IN54                                        CAS009
     C                   ENDIF                                                                CAS009
     C                   ENDIF                                                                CAS009
     C*                                                                   S01117
     C     CDL012        IFEQ      'Y'
     C                   SETOFF                                       U4
     C                   Z-ADD     0             UGNIDT
     C                   ENDIF
      *                                                                                       CDL012
     C     *INL1         IFEQ      '1'                                                         S0111
     C                   CLOSE     DL0280P1                                                    DT006
     C                   MOVE      *BLANKS       SALCY                                         S0111
     C** If Branch Report                                                 S01117
     C                   SETON                                            11                   S0111
     C                   SETOFF                                           12                   LN071
     C                   OPEN      DL0280P1                                                    DT006
     C*      PLINES IS THE NUMBER OF LINES THAT WILL HAVE BEEN PRINTED    S01117
     C*      OUT ONTO THE PRINTER FILE WHEN THE NEXT CYCLE HAS            S01117
     C*      COMPLETED.  IT WILL BE USED TO CONTROL THE OVERFLOW          S01117
     C*      INDICATOR WHICH CONTROLS OUTPUT OF HEADINGS VIA FETCH        S01117
     C*      OVERFLOW                                                     S01117
     C*  Z-ADD 13 IF MULTIBRANCHED ELSE Z-ADD 11 (BRANCH HEADING TAKES    LN0884
     C*  UP TWO LINES IF MULTIBRANCHED)                                   LN0884
     C     BGMBIN        IFEQ      'Y'                                                         LN088
     C                   Z-ADD     13            PLINES            2 0                         LN088
     C                   ELSE                                                                  LN088
     C                   Z-ADD     11            PLINES            2 0                         S0111
     C                   END                                                                   LN088
     C*                                                                   LN0884
     C                   Z-ADD     0             PAGE                                          S0111
     C*                                                                   DT0067
     C** REPORT SPOOL FILE GENERATION                                     DT0067
     C                   Z-ADD     SFNUM         ZSNUM             6 0                         DT006
     C                   CALL      'ZSFILE'                                                    DT006
     C                   PARM                    SEQ               5                           DT006
     C                   PARM      BRCA          @PARM             3                           DT006
     C                   PARM                    SFILE                                         DT006
     C                   PARM                    ZSNUM                                         DT006
     C                   PARM                    ZSERR             1                           DT006
     C*                                                                   DT0067
     C     ZSERR         IFEQ      'Y'                                                         DT006
     C                   SETON                                        U7U8LR                   DT006
     C                   RETURN                                                                DT006
     C                   END                                                                   DT006
     C/COPY WNCPYSRC,DL0280C586
     C**                                                                  S01117
     C** To get Branch Name(in BRNM) :                                    S01117
     C** CALL ACCESS PROGRAM FOR BRANCH  DETAILS                          S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                   CALL      'AOBRCHR1'
     C                   PARM      '*MSG    '    @RTCD                                         S0119
     C                   PARM      '*KEY    '    @OPTN                                         S0119
     C                   PARM      BRCA          @DSNB             3                           S0119
     C********** @BRCH     PARM @BRCH     DSFDY                                        S01194 CGL029
     C     @BRCH         PARM      @BRCH         DSSDY
     C*                                                                   S01194
     C     @RTCD         IFNE      *BLANK                                                      S0119
     C                   MOVEL     'SDBRCHPD'    DBFILE                          ************* S0119
     C                   MOVEL     '07'          DBASE                           *DBERROR 007* S0119
     C                   MOVEL     @OPTN         DBOPTN                          ************* S0119
     C                   MOVEL     BRCA          DBKEY            29                           S0119
     C                   SETON                                        U7U8LR                   S0119
     C                   EXSR      *PSSR                                                       S0119
     C                   GOTO      EOJ                                                         S0119
     C                   END                                                                   S0119
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C143                                           S01408
     C*                                                                   S01408
0682 C*****    COUNT OF RECORDS READ
0683 C  N18TOTDLS        ADD       1             TOTDLS
0684 C   18
0685 COR 06              GOTO      EOJ2
     C/COPY WNCPYSRC,DL0280C587
     C**  RESET DEALS FILE UPDATE INDICATOR                               S01093
     C                   MOVE      '0'           *IN15                                         S0109
     C     RECR          IFNE      'D'
     C                   EXSR      UPFAMD
     C                   ENDIF
0686 C*
0687 C*****    CHECK IF EXPIRED RECORD TO BE MATURED
0688 C*
0689 C     RECR          COMP      'E'                                    53
     C   53              GOTO      EOJ                                                         S0109
0692 C*
0693 C*****    TEST RECORD ID.
0694 C*
0695 C                   SETOFF                                       53
0696 C     RECR          COMP      'R'                                    47
0697 C  N47RECR          COMP      'D'                                    53
0698 C*
0699 C*****    ACCUMULATE RECORD COUNTS
0700 C*
0701 C   53TOTDTD        ADD       1             TOTDTD            5 0
     C  N47
0702 CANN53TOTMM         ADD       1             TOTMM             5 0
0704 C*
0705 C*****    ZEROISE YIELD RATE ON DKEYS FOR FX AND LOAN/DEP.
0706 C*
0707 C   02
     COR 10                                                                                    S0111
0708 COR 03              Z-ADD     0             YRAT
0709 C   03              Z-ADD     0             TAXA             13 0
     C/COPY WNCPYSRC,DL0280C520
     C*                                                                   S01378
     C** Reuse *IN12 for parcelled NA's. Check NA's purchased and sold    S01378
     C** to see if parcelling flag is set to 'P' (ie parcelled)           S01378
     C                   SETOFF                                       89                       S0137
     C   04                                                                                    S0137
     COR 05PCLI          COMP      'P'                                    89                   S0137
0710 C*
0711 C*****    SET UP FIRST RECORD ON DAMSX FILE.
0712 C*
0713 C                   SETOFF                                       484942
0714 C                   SETOFF                                       616251
0715 C                   SETOFF                                       411873
0716 C                   SETOFF                                       747576
0717 C                   SETOFF                                       212223
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** Set up Fiduciary Deposit flag.                                   CDL006
      *                                                                   CDL006
     C                   MOVE      'N'           WUFIDE            1                           CDL00
      *                                                                   CDL006
      ** If Charges/commission.                                           CDL006
      *                                                                   CDL006
     C     WUCHCO        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Fixed Term Deposit or Call/Notice Deposit.                    CDL006
      *                                                                   CDL006
     C     DTYP          IFEQ      'FT'                                                        CDL00
     C     DTYP          OREQ      'DT'                                                        CDL00
     C     DTYP          OREQ      'LT'                                                        CDL00
      *                                                                   CDL006
     C     DTYP          IFEQ      'LT'                                                        CDL00
     C                   MOVE      'L'           WUFIDE                                        CDL00
     C                   ELSE                                                                  CDL00
     C                   MOVE      'D'           WUFIDE                                        CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** Save Last interest accrual date.                                 CDL006
      *                                                                   CDL006
     C                   Z-ADD     IACD          WUIACD            5 0                         CDL00
      *                                                                   CDL006
      ** Set up MM Deals record update flag.                              CDL006
      *                                                                   CDL006
     C                   MOVE      'N'           WUDXUP            1                           CDL00
      *                                                                   CDL006
      ** If commission taken.                                             CDL006
      *                                                                   CDL006
     C     BNCOTK        IFEQ      'Y'                                                         CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** Only for Call deposits : retrieve range upper limits.            CDL006
      *                                                                   CDL006
     C     DTYP          IFEQ      'DT'                                                        CDL00
     C     DTYP          OREQ      'LT'                                                        CDL00
      *                                                                   CDL006
      ** If Commission tables in Base currency, access to Charge          CDL006
      ** Types record with base currency.                                 CDL006
     C                   MOVE      PCCY          KCYCD                                         CDL00
     C     BNCTBC        IFEQ      'Y'                                                         CDL00
     C                   MOVE      BJCYCD        KCYCD                                         CDL00
     C                   END                                                                   CDL00
      *                                                                   CDL006
      ** Access DL Charges Types logical file DLCCGDL0 to retrieve        CDL006
      ** range upper limits and percentages for commission                CDL006
      ** calculation.                                                     CDL006
      *                                                                   CDL006
     C                   Z-ADD     0             ZRA                                           CDL00
     C                   Z-ADD     0             ZPE                                           CDL00
     C     KDLCCG        CHAIN     DLCCGDL0                           31                       CDL00
      *                                                                   CDL006
      ** If record doesn't exist for Base currency, database error.       CDL006
      *                                                                   CDL006
     C     KCYCD         IFEQ      BJCYCD                                                      CDL00
     C     *IN31         IFEQ      '1'                                                         CDL00
     C     *IN31         OREQ      '0'                                                         CDL00
     C     FDRECI        ANDNE     'D'                                                         CDL00
     C                   MOVEL     'DLCCGDL0'    DBFILE                                        CDL00
     C                   MOVEL     '22'          DBASE                          ***************CDL00
     C                   MOVEL     '*KEY    '    DBOPTN                         * DB ERROR 22 *CDL00
     C                   MOVEL     KCYCD         W1@3                           ***************CDL00
     C                   MOVE      FCGC          W4@5                                          CDL00
     C                   SETON                                        U7U8LR                   CDL00
     C                   EXSR      *PSSR                                                       CDL00
     C                   GOTO      EOJ                                                         CDL00
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** If Commission tables in Base currency, convert the range         CDL006
      ** limits amounts from Base currency to Deal currency, only         CDL006
      ** if at least one percentage not equal to 0.                       CDL006
      *                                                                   CDL006
     C     BNCTBC        IFEQ      'Y'                                                         CDL00
     C     PCCY          ANDNE     BJCYCD                                                      CDL00
     C     ZPE(1)        ANDNE     0                                                           CDL00
     C                   EXSR      RLACVT                                                      CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** Access SD Customer file to retrieve Agent percentage.            CDL006
      *                                                                   CDL006
     C                   MOVEL     CNUM          W0CNUM            6                           CDL00
     C                   CALL      'AOCUSTR0'                                                  CDL00
     C                   PARM      '*MSG   '     PRTCD                                         CDL00
     C                   PARM      '*KEY   '     POPTN                                         CDL00
     C                   PARM      W0CNUM        PKEY1            10                           CDL00
     C                   PARM                    PKEYST            7                           CDL00
     C     SDCUST        PARM      SDCUST        DSSDY                                         CDL00
      *                                                                   CDL006
      ** If record doesn't exist, database error.                         CDL006
      *                                                                   CDL006
     C     PRTCD         IFNE      *BLANKS                                                     CDL00
     C                   MOVEL     CNUM          DBKEY                                         CDL00
     C                   MOVEL     'SDCUSTPD'    DBFILE                          **************CDL00
     C                   MOVEL     '024'         DBASE                           * DB ERROR 24 CDL00
     C                   SETON                                        U7U8LR     **************CDL00
     C                   EXSR      *PSSR                                                       CDL00
     C                   GOTO      EOJ                                                         CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C151                                           S01408
0721 C     REDDM         TAG                                                    ** REDDM TAG **
0722 C                   MOVE      '  '          STAMND
     C/COPY WNCPYSRC,DL0280C588
0723 C                   SETOFF                                       070809
     C/COPY WNCPYSRC,DL0280C589
0723 C                   SETOFF                                       4142                     BHF64
      *                                                                   094711
      *** Save the branch and the original entry date of the deal         094711
      *                                                                   094711
     C     *LIKE         DEFINE    BRCA          WSBRCA                                        09471
     C     *LIKE         DEFINE    ORED          WSORED                                        09471
     C                   MOVE      BRCA          WSBRCA                                        09471
     C                   MOVE      ORED          WSORED                                        09471
     C     CDL034        IFEQ      'Y'                                                        CDL034
     C                   Z-ADD     IACD          WKIACD            5 0                        CDL034
     C                   ENDIF                                                                CDL034
      *                                                                   169550
      ** Initialise amendment type to blanks.  This is to prevent         169550
      ** other deals without deal amendments from using its value.        169550
      *                                                                   169550
     C                   MOVE      *BLANKS       AMTP                                          16955
     C**                                                                  BHF641
     C** IF DAMSX FILE NOT EMPTY,CHECK IF DEAL AMENDMENTS ARE DUE FOR THISBHF641
     C** DEAL.IF SO, READ THE FIRST.REMAINDER (IF ANY) ARE READ IN DLAMND BHF641
     C**                                                                  BHF641
     C  N35              Z-ADD     1             XX                2 0                         BHF64
     C  N35DTYP          LOOKUP    @DTP(XX)                               41                   BHF64
     C  N35
     CAN 41DLNO          SETLL     DAMSX                                  41                   BHF64
0727 C   35                                                                                    BHF64
     CORN35
0727 CANN41              GOTO      DLAD                                                        BHF64
     C                   READ      DAMSX                                  42                   BHF64
0728 C     TOTDMD        ADD       1             TOTDMD            5 0
0729 C     TOTDMS        ADD       1             TOTDMS
0730 C                   Z-ADD     TOTDHI        ZZTOTI                          HASH
0731 C                   Z-ADD     TOTDHD        ZZTOTD                           CONTROLS
0732 C     DAAM          DIV       1000          ZZAMT                           FOR DAMSX
0733 C                   EXSR      GLZADD                                         RECORDS
0734 C                   Z-ADD     ZZTOTI        TOTDHI           15 0
0735 C                   Z-ADD     ZZTOTD        TOTDHD            3 0
0736 C*
0737 C*****    ACCUMULATE HASH CONTROLS FOR DEALS RECORDS.
0738 C*
0739 C     DLAD          TAG                                                    ** DLAD TAG  **
     C                   SETOFF                                       34                       BHF64
0743 C   41PSEQ          COMP      5                                  3434
0745 C   47              Z-ADD     TOTDDI        ZZTOTI                                        E1016
0746 C   47              Z-ADD     TOTDDD        ZZTOTD                                        E1016
0745 C   53              Z-ADD     TOTDLI        ZZTOTI
0746 C   53              Z-ADD     TOTDLD        ZZTOTD
     C  N53
0747 CANN47              Z-ADD     TOTMI         ZZTOTI                                        E1052
     C  N53
0748 CANN47              Z-ADD     TOTMD         ZZTOTD                                        E1052
0749 C     PAMT          DIV       1000          ZZAMT
0749 C   10UPAMT         DIV       1000          ZZAMT                                         S0111
                                                                                              CIR014
     C                   IF        CIR014 = 'Y' AND (*INU1=*ON)                               CIR014
     C                   MOVE      DLNO          KDLNO                                        CIR014
     C     KDLNO         CHAIN     DLDLDGD0                                                   CIR014
     C                   IF        %FOUND(DLDEALL5) AND                                       CIR014
     C                             F1PRVI = 'O'                                               CIR014
     C                             AND F1PRVR <> 0                                          BUG12456
                                                                                              CIR014
     C                   EVAL      W_UNIPD = UNIPD                                            CIR014
     C                   IF        UNIPD = 0  AND (CIR001 = 'Y')                              CIR014
     C                             AND (BOVD <= EVCD) AND (BOVD <> 0)                         CIR014
     C                   EVAL      W_UNIPD = MDAT                                             CIR014
     C                   ENDIF                                                                CIR014
                                                                                              CIR014
     C                   IF        F1NPRI <> 0 AND                                            CIR014
     C                             W_UNIPD <= EVCD                                            CIR014
     C                   IF        W_UNIPD < MDAT OR                                          CIR014
     C                             (W_UNIPD = MDAT AND                                        CIR014
     C                             (UINPM = 'C' OR UINPM = 'K' OR                             CIR014
     C                             UINPM = 'A' OR UINPM = 'I'))                               CIR014
      ** Use the original amount when reporting live totals, change in principal            BUG12456
      ** will be reported under capitalisation when principal amt is updated                BUG12456
     C**********         EVAL      ZZAMT = F1NPRI/1000                               CIR014 BUG12456
     C                   ENDIF                                                                CIR014
     C                   ENDIF                                                                CIR014
      *                                                                                       CIR014
     C                   ENDIF                                                                CIR014
     C                   ENDIF                                                                CIR014
                                                                                              CIR014
0750 C                   EXSR      GLZADD
0751 C   47              Z-ADD     ZZTOTI        TOTDDI           15 0                         E1016
0752 C   47              Z-ADD     ZZTOTD        TOTDDD            3 0                         E1016
0751 C   53              Z-ADD     ZZTOTI        TOTDLI           15 0
0752 C   53              Z-ADD     ZZTOTD        TOTDLD            3 0
     C  N53
0753 CANN47              Z-ADD     ZZTOTI        TOTMI            15 0                         E1052
     C  N53
0754 CANN47              Z-ADD     ZZTOTD        TOTMD             3 0                         E1052
     C/COPY WNCPYSRC,DL0280C435
     C  N53
     CANN47IPFR          CABNE     'N'           EOJ                                           AUS00
     C/COPY WNCPYSRC,DL0280C436
0756 C*
0757 C*****    FIND NO.OF DECIMAL PLACES FOR PRIME CCY.
0758 C*
     C                   Z-ADD     1             I                 3 0                         S0109
     C     PCCY          LOOKUP    CY(I)                                  53                   S0109
     C     *IN53         IFEQ      '1'                                          ** IF  001     S0109
     C                   MOVE      CYD(I)        CYDDS                                         S0109
     C     CDP           COMP      1                                    4344                   S0109
     C     CDP           COMP      2                                  46  45                   S0109
     C   10              MOVE      CDP           UDECP             1 0                   S01119S0109
     C                   ELSE                                                   ** ELS 001     S0109
     C**    ERROR IF NOT FOUND                                            S01093
     C                   MOVE      '1'           *INU8                                         S0109
     C                   MOVE      '1'           *INLR                                         S0109
     C                   MOVE      '1'           *IN80                                         S0109
     C                   MOVE      PCCY          XCCY              3                           S0109
     C                   GOTO      EOJ                                                         S0109
     C                   END                                                    ** END 001     S0109
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Commission taken on Fiduciary Call or Time deposits.          CDL006
      *                                                                   CDL006
     C     BNCOTK        IFEQ      'Y'                                                         CDL00
     C     WUFIDE        ANDEQ     'D'                                                         CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
     C     BNCOTK        OREQ      'Y'                                                         CDL00
     C     WUFIDE        ANDEQ     'L'                                                         CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** Save Deal currency Number of decimal places, Spot rate and       CDL006
      ** Multiply/Divide indicator.                                       CDL006
      *                                                                   CDL006
     C                   Z-ADD     CDP           WUDCDP            1 0                         CDL00
     C                   Z-ADD     SPOT          WUDCSR           13 8                         CDL00
     C                   Z-ADD     MDIN          WUDCMD            1 0                         CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C037
0769 C*
0768 C*****     FIND NO.OF DECIMAL PLACES FOR SALE CCY
0769 C*
     C**   ALSO FOR THEIR CURRENCY ON FRA/IRS DEALS                       S01119
     C     *IN02         IFEQ      '1'                                          ** IF  001     S0109
     C     *IN10         OREQ      '1'                                                         S0109
     C                   Z-ADD     1             I                                             S0109
     C   02SLCY          LOOKUP    CY(I)                                  53                   S0111
     C   10TCUCY         LOOKUP    CY(I)                                  53                   S0109
     C     *IN53         IFEQ      '1'                                          ** IF  002     S0109
     C                   MOVE      CYD(I)        CYDDS                                         S0109
     C     CDP           COMP      1                                    7374                   S0109
     C     CDP           COMP      2                                  76  75                   S0109
     C   10              MOVE      CDP           TDECP             1 0                         S0111
     C                   ELSE                                                   ** ELS 002     S0109
     C**    ERROR IF NOT FOUND                                            S01093
     C                   MOVE      '1'           *INU8                                         S0109
     C                   MOVE      '1'           *INLR                                         S0109
     C                   MOVE      '1'           *IN80                                         S0109
     C                   MOVE      SLCY          XCCY                                          S0109
     C   10              MOVE      TCUCY         XCCY                                          S0111
     C                   GOTO      EOJ                                                         S0109
     C                   END                                                    ** END 002     S0109
     C                   END                                                    ** END 001     S0109
0777 C*
0778 C*****     TEST FOR FED.FUNDS
0779 C*
0780 C                   TESTB     '2'           DSTI                     61
     C   10              TESTB     '2'           UDSTI                    61                   S0111
     C   10
     CANN61              TESTB     '2'           TDSTI                    61                   S0111
0781 C   02              TESTB     '3'           DSTI                     62
0782 C*
0783 C*****    IF REVERSAL ALREADY PROCESSED, GO TO EOJ.
0784 C*
0785 C   47              TESTB     '7'           ACEI                     53
     C   47
0786 CAN 53              GOTO      EOJ
0787 C   47              BITON     '7'           ACEI
0788 C*
0789 C*****    DETERM IS A ROUTINE TO DETERMINE THE
0790 C*           DEAL GROUPING FOR EVENT DATE PROCESSING.
0791 C*
0792 C     DETERM        TAG                                                    ** DETERM TAG *
      *                                                                                       CDL017
      ** Set flag to indicate deal is a fixed loan/deposit deal type                          CDL017
      *                                                                                       CDL017
     C     DTYP          IFEQ      'TD'
     C     DTYP          OREQ      'IT'
     C     DTYP          OREQ      'TI'
     C     DTYP          OREQ      'IP'
     C                   MOVE      'Y'           FIXDEP            1
     C                   ELSE
     C                   MOVE      'N'           FIXDEP
     C                   ENDIF
     C                   Z-ADD     XKRCDT        WKRCDT            5 0                        CDL017
      *                                                                                       CDL017
     C                   IF        CDL033 = 'Y' AND                                        AR1075873
     C                             FSFBRT = 'Y'                                            AR1075873
     C                   EVAL      FIXDEP = 'Y'                                            AR1075873
     C                   ENDIF                                                             AR1075873
     C                   MOVE      'N'           FLRDEL            1                          CDL033
     C     FIXDEP        IFEQ      'Y'                                                        CDL033
     C     DTYP          OREQ      'CI'                                                       CDL033
     C                   MOVE      'Y'           FLRDEL                                       CDL033
     C                   ENDIF                                                                CDL033
0793 C*
0794 C*****     LOAN/DEPOSIT.
0795 C*
     C/COPY WNCPYSRC,DL0280C155                                           S01408
     C   03
0796 CANN19              GOTO      DEPOS
     C/COPY WNCPYSRC,DL0280C156                                           S01408
0797 C*
0798 C*    DETERMINE DEAL TYPES 'IT','CD' OR 'TD'
0799 C   03DTYP          COMP      'IT'                                   21
     C   03
0800 CANN21DTYP          COMP      'CD'                                   22
     C   03
     CANN21
0801 CANN22DTYP          COMP      'TD'                                   21
     C   03
0802 CAN 22              SETON                                        21
     C/COPY WNCPYSRC,DL0280C157                                           S01408
0804 C*
0805 C*    DETERMINE IF TAX PAYABLE
0806 C   03TAXI          COMP      'Y'                                    23
     C***03*****                                                                  BUG26576 BUG26576A
     C*ANN23TAXI         COMP      'T'                                    23      BUG26576 BUG26576A
     C     CDL013        IFEQ      '1'                                                        CDL013
     C     *IN03         ANDEQ     *ON                                                        CDL013
     C     TAXI          IFNE      '0'                                                        CDL013
     C                   MOVE      *ON           *IN23                                        CDL013
     C                   ENDIF                                                                CDL013
     C                   MOVE      *BLANKS       @KEY1            10                          CDL013
     C                   MOVEL     CNUM          @KEY1                                        CDL013
     C                   CALL      'AOCUSTR0'                                                 CDL013
     C                   PARM      *BLANKS       @RTCD             7                          CDL013
     C                   PARM      '*KEY  '      @OPTN             7                          CDL013
     C                   PARM                    @KEY1            10                          CDL013
     C                   PARM                    @KYST             7                          CDL013
     C     SDCUST        PARM      SDCUST        DSSDY                                        CDL013
     C     @RTCD         IFNE      *BLANKS                                                    CDL013
     C                   MOVEL     'SDCUSTPD'    DBFILE           10            ************  CDL013
     C                   MOVEL     @OPTN         DBOPTN            7            * DBERR 49 *  CDL013
     C                   MOVEL     '49'          DBASE             3            ************  CDL013
     C                   SETON                                        U7U8LR                  CDL013
     C                   EXSR      *PSSR                                                      CDL013
     C                   GOTO      EOJ                                                        CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280C007                                           S01408
0807 C*
0808 C   03              GOTO      DEPOS
0809 C*
0810 C*****     NEGOTIABLE ASSETS SOLD.
0811 C   05DTYP          COMP      'TS'                                   51
     C   05
0812 CANN51DTYP          COMP      'RA'                                   51
     C   05
0813 CANN51DTYP          COMP      'TR'                                   51
0814 C*
0815 C   05              GOTO      NEGSLD
0816 C*
0817 C*****     NEGOTIABLE ASSETS PURCHASED - INTEREST BEARING.
0832 C** 04                SETOF                     262710         E43766S01119
0832 C   04              SETOFF                                       262754                   S0111
     C   04
0833 CAN 28DISA          COMP      0                                    27      *PREM. OR DISC.
     C     Wdiff404      IFNE      1                                                        BUG13404
     C     BKANWD        ANDEQ     '1'                                                      BUG13404
     C     BKANWD        OREQ      '0'                                                     BUG13085B
     C     ORED          ANDEQ     BKAPDT                                                  BUG13085B
     C     *IN04         ANDEQ     '1'                                                     BUG13085B
     C   04              ADD       DISA          TFDP                                         CAS009
     C   04              ADD       DISA          TFDPA                                        CAS009
     C                   ENDIF                                                              BUG13404
0818 C*
0819 C   04DTYP          COMP      'C1'                                   48
     C   04
0836 CAN 48              SETON                                        26
     C   04
0820 CANN48DTYP          COMP      'C2'                                   48
     C   04
     CAN 48
     CANN26              SETON                                        54        C2 DEAL TYPE   S0111
     C   04
0821 CANN48DTYP          COMP      'BD'                                   48
     C   04
     CAN 48
     CANN26              SETON                                        54        BD DEAL TYPE R2E2259
     C   04
0822 CANN48DTYP          COMP      'BP'                                   48
     C   04
     CAN 48
     CANN26              SETON                                        54        BP DEAL TYPE R2E2259
     C   04
0823 CAN 48              GOTO      NAPUR
0824 C*
0825 C*****     NEGOTIABLE ASSETS PURCHASED - NON-INTEREST BEARING.
0826 C*
0827 C***04N48             SETON                         49               E22595
     C   04
0827 CANN48              SETON                                          5449                   E2259
     C   04
0828 CANN48              GOTO      NAPUR
0829 C*
0830 C*****     F/X OUTRIGHTS AND OPTIONS.
     C/COPY WNCPYSRC,DL0280C126                                           S01408
      *                                                                                       CDL099
     C     CDL099        IFEQ      'Y'                                                        CDL099
      *                                                                                       CDL099
      ** If Sale Value Date is Zero, Set Equal to Value Date.                                 CDL099
      *                                                                                       CDL099
     C     BSDT2         IFEQ      0                                                          CDL099
     C                   Z-ADD     VDAT          BSDT2                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
      ** If Other Leg Value Date is Zero, Set to other Leg Value Date                         CDL099
      *                                                                                       CDL099
     C     BRSD2         IFEQ      0                                                          CDL099
     C                   Z-ADD     OTDT          BRSD2                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
      ** Ensure SWAP P/L 'END' Date (TDAT) is the Value Date of P/L Ccy                       CDL099
      *                                                                                       CDL099
     C     PCCY          IFEQ      SPLC                                                       CDL099
     C                   Z-ADD     VDAT          TDAT              6 0                        CDL099
     C                   ELSE                                                                 CDL099
     C                   Z-ADD     BSDT2         TDAT                                         CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
      ** Reset 'ACCRUALS COMPLETE' Flag.                                                      CDL099
      *                                                                                       CDL099
     C                   MOVE      *BLANK        @DACCF            1                          CDL099
     C                   MOVE      *BLANK        @LACCF            1                          CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
0832 C   02DTYP          COMP      'FP'                                   50
     C   02
0833 CANN50DTYP          COMP      'FS'                                   50
     C   02
0834 CANN50DTYP          COMP      'PI'                                   50
     C   02
0835 CANN50DTYP          COMP      'SI'                                   50
     C   02
0836 CANN50DTYP          COMP      'CX'                                   50
     C   02
0837 CANN50DTYP          COMP      'OP'                                   50
     C   02
0838 CANN50DTYP          COMP      'OT'                                   50
     C   02
     CANN50DTYP          COMP      'NX'                                   50                   S0109
     C   02
0839 CAN 50              GOTO      FXOUTR
0840 C*
0841 C*****     F/X SWAPS AND POSITION SWAPS.
0842 C*
     C   02
0843 CANN50DTYP          COMP      'PS'                                   51
     C   02
0843 CANN50DTYP          COMP      'SW'                                   50                   S0111
     C   02
     CAN 51                                                                                    S0111
     COR 02
0844 CAN 50              GOTO      FXSWAP                                                      S0111
     C*                                                                   S01119
     C******     FRA/IRS DEAL TYPES                                       S01119
     C*                                                                   S01119
     C   10DTYP          COMP      'FR'                                   31                   S0111
     C   10
     CANN31DTYP          COMP      'RS'                                   31                   S0111
     C   10
     CANN31DTYP          COMP      'RR'                                   31                   S0115
     C   10
     CANN31DTYP          COMP      'RP'                                   31                   S0115
     C   10
     CANN31DTYP          COMP      'RF'                                   31                   S0115
     C   10
     CANN31DTYP          COMP      'RX'                                   31                   S0111
     C   10
0844 CAN 31              GOTO      FRAIRS                                                      S0111
0845 C**********         SETON                                        79LRU8                AR547995
     C                   SETON                                        79LRU7                AR547995
0846 C   79              GOTO      EOJ
0847 C*
0848 C********************************************************************
0849 C*
0850 C*****     DEPOS IS THE FIRST TAG IN A SET OF ROUTINES
0851 C*            THAT CONTAIN THE DEPOSITS EVENT DATES
0852 C*            PROCESSING.
0853 C*
0854 C     DEPOS         TAG                                                    ** DEPOS TAG **
     C/COPY WNCPYSRC,DL0280C158                                           S01408
      *                                                                                       CDL033
      ** Perform initial processing for CF deals if this is                                   CDL033
      ** not a reversal.                                                                      CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
     C                   EXSR      SRFRC1                                                     CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
      ** If base rate change and 'UseHistRateforBVDeal' is Y                                MD031283
      ** execute new routine for backdated MM deals                                         MD031283
      *                                                                                     MD031283
     C                   EVAL      CtrBV = 0                                                MD031283
     C                   CLEAR                   ZiBegBV                                    MD031283
     C                   CLEAR                   ZiEndBV                                    MD031283
     C                   CLEAR                   BsrtBV                                     MD031283
      *                                                                                     MD031283
     C                   IF        HSTRAT = 'Y' AND                                         MD031283
     C                             AMTP   = 'BR'                                            MD031283
0859 C                   EXSR      DLHSRT                                                   MD031283
     C                   ENDIF                                                              MD031283
0855 C*
0856 C*****    DEAL DATE PROCESSING
      *                                                                   104044
      ** Initialize Int/Sold Amt/Swap Profit to zero.                     104044
      *                                                                   104044
     C                   Z-ADD     0             NRRSAL                                        10404
     C/COPY WNCPYSRC,DL0280C693
0858 C   41              Z-ADD     DDAT          PARDAT            5 0
0859 C   41              EXSR      DLAMND
     C   U8              GOTO      EOJ                                                         S0138
     C/COPY WNCPYSRC,DL0280C694
0862 C*
0863 C*****    ASCERTAIN IF DEAL DATE PROCESSING REQUIRED.
0864 C*
0865 C   47              TESTB     '0'           ACEI                 53          REVERSAL
     C   47
0866 CAN 53              GOTO      EOJ
0867 C  N47DDAT          COMP      EVCD                               53
     C  N47
0868 CAN 53              GOTO      EOJ
0869 C  N47              TESTB     '0'           ACEI                     53
     C  N47
0870 CAN 53              GOTO      DEPVD
     C/COPY WNCPYSRC,DL0280C695
      *                                                                                       CDL033
      ** For CF deals and if this is not a reversal, process                                  CDL033
      ** the following if they were not yet processed before                                  CDL033
      ** in this run: short term rate, rate fix date                                          CDL033
      ** and/or rate change date.                                                             CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
      *                                                                                       CDL033
     C     WFLAGS        IFEQ      *BLANK                                                     CDL033
     C     WFLAGF        OREQ      *BLANK                                                     CDL033
     C     WFLAGR        OREQ      *BLANK                                                     CDL033
     C                   Z-ADD     DDAT          WCFDAT            5 0                        CDL033
     C                   EXSR      SRFRC2                                                     CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
0871 C*
0872 C*****    GENERATE DEAL DATE ACCOUNT KEY
0873 C*
0874 C                   MOVE      'D'           AKY(3)
0875 C                   MOVEA     DLST          AKY(4)
0876 C                   MOVEA     '    '        AKY(6)
0877 C                   MOVE      'A'           AKY(10)
0878 C                   Z-ADD     DDAT          KYDAT
0879 C  N47              Z-ADD     YYPAMT        KYAMT
0880 C   47PAMT          SUB       ICTD          KYAMT
     C/COPY WNCPYSRC,DL0280C191                                           S01408
0881 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
0882 C                   Z-ADD     SDST          KYSETL
0883 C                   MOVE      OSDA          KYOSTL
     C     DTYP          IFEQ      'IP'                                                        BHF85
     C     DTYP          OREQ      'TI'                                                        BHF85
     C     DTYP          OREQ      'LN'                                                        BHF85
     C     DTYP          OREQ      'CL'                                                        BHF85
     C     DTYP          OREQ      'DL'                                                        BHF85
     C     DTYP          OREQ      'IL'                                                        S0135
0962 C                   MOVE      POBR          KYSTBR                                        BHF85
0962 C                   ELSE                                                                  BHF85
0962 C                   MOVE      ROBR          KYSTBR            3                           S0111
0962 C                   END                                                                   BHF85
     C                   MOVE      PRFC          OPPRFC            4                           S0111
     C*                                                                   S01486
     C** IF PM INSTALLED, CALCULATE FX RATE                               S01486
     C     BGPFMG        IFEQ      'Y'                                                         S0148
     C     PTFR          ANDNE     *BLANKS                                                     S0148
     C     *IN47         ANDNE     '1'                                          not a reversal 11035
     C                   EXSR      P01                                                         S0148
     C     WWERRF        CABEQ     'Y'           EOJ                                           S0148
     C                   END                                                                   S0148
0884 C*
0885 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
0886 C*
0887 C                   EXSR      FEDAT
0888 C*
0889 C                   MOVEL     NEV(1)        NARREV           13                           E1119
0890 C                   Z-ADD     KYAMT         NRRPUR           13 0
0891 C                   Z-ADD     INTR          NARRAT           13 8
0892 C                   SETON                                        71
0893 C                   EXSR      EXCP
0894 C                   BITON     '0'           ACEI
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
0895 C*
0896 C*****    DEPVD IS A ROUTINE TO HANDLE VALUE DATE PROCESSING
0897 C*            IF REQUIRED.
0898 C*
0899 C     DEPVD         TAG                                                    ** DEPVD TAG **
     C/COPY WNCPYSRC,DL0280C696
0900 C   41              Z-ADD     VDAT          PARDAT
0901 C   41              EXSR      DLAMND
     C   U8              GOTO      EOJ                                                         S0138
     C/COPY WNCPYSRC,DL0280C697
0904 C   47              TESTB     '1'           ACEI                 53
     C/COPY WNCPYSRC,DL0280C005
     C   47
0905 CAN 53              GOTO      EOJ                                            REVERSAL
0906 C  N47VDAT          COMP      EVCD                               53
     C/COPY WNCPYSRC,DL0280C006
     C  N47
0907 CAN 53              GOTO      EOJ
0908 C  N47              TESTB     '1'           ACEI                     53
     C  N47
0909 CAN 53              GOTO      DEPINT
     C/COPY WNCPYSRC,DL0280C698
      *                                                                                       CDL033
      ** For CF deals and if this is not a reversal, do                                       CDL033
      ** the following processing.                                                            CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
      *                                                                                       CDL033
      ** Process the following if they were not yet processed                                 CDL033
      ** before in this run: short term rate, rate fix date                                   CDL033
      ** and/or rate change date.                                                             CDL033
      *                                                                                       CDL033
     C     WFLAGS        IFEQ      *BLANK                                                     CDL033
     C     WFLAGF        OREQ      *BLANK                                                     CDL033
     C     WFLAGR        OREQ      *BLANK                                                     CDL033
     C                   Z-ADD     VDAT          WCFDAT                                       CDL033
     C                   EXSR      SRFRC2                                                     CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
      ** Set up effective rate for value date if this rate                                    CDL033
      ** has to be set to the fixed base rate.                                                CDL033
      *                                                                                       CDL033
     C     XKBSVF        IFEQ      *BLANK                                                     CDL033
     C                   EXSR      SRFRC6                                                     CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
      ** Update fixed base rate applied on value date and                                     CDL033
      ** short term rate on value date flags to 'Y'.                                          CDL033
      *                                                                                       CDL033
     C                   MOVE      'Y'           XKBSVF                                       CDL033
     C                   MOVE      'Y'           XKSTVF                                       CDL033
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
      *                                                                   CDL034
      ** Write Deal Interest History record for value date                CDL034
      *                                                                   CDL034
     C     CDL034        IFEQ      'Y'                                                        CDL034
     C     BRTT          IFNE      0                                                          CDL034
     C                   Z-ADD     VDAT          A2HISD                                       CDL034
     C                   Z-ADD     0             A2AINP                                       CDL034
     C                   EXSR      WRTIRH                                                     CDL034
     C                   ENDIF                                                                CDL034
     C                   ENDIF                                                                CDL034
0910 C*
0911 C*****    GENERATE VALUE DATE ACCOUNT KEY
0912 C*
0913 C                   MOVE      'V'           AKY(3)
0914 C                   MOVEA     DLST          AKY(4)
0915 C                   MOVEA     '    '        AKY(6)
0916 C                   Z-ADD     VDAT          KYDAT
     C                   MOVE      STCY          KYSCY                                         CEU00
0917 C                   MOVE      PCCY          KYCCY
0918 C                   Z-ADD     SDST          KYSETL
0919 C                   MOVE      OSDA          KYOSTL
     C     DTYP          IFEQ      'IP'                                                        BHF85
     C     DTYP          OREQ      'TI'                                                        BHF85
     C     DTYP          OREQ      'LN'                                                        BHF85
     C     DTYP          OREQ      'CL'                                                        BHF85
     C     DTYP          OREQ      'DL'                                                        BHF85
     C     DTYP          OREQ      'IL'                                                        S0135
0962 C                   MOVE      POBR          KYSTBR                                        BHF85
0962 C                   ELSE                                                                  BHF85
0962 C                   MOVE      ROBR          KYSTBR                                        S0111
0962 C                   END                                                                   BHF85
     C                   MOVE      PRFC          OPPRFC                                        S0112
0920 C*
0921 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
0922 C*
0923 C                   EXSR      FEDAT
     C/COPY WNCPYSRC,DL0280C446
0925 C     RODN          COMP      0                                      53                   08060
     C/COPY WNCPYSRC,DL0280C447
0926 C                   Z-ADD     PAMT          KYAMT
0927 C   53              MOVE      'A'           AKY(10)
     C     *IN53         IFEQ      '0'                                                         S0139
     C     FUID          IFEQ      'Y'                                                         S0139
0928 C                   MOVE      'A'           AKY(10)                                       S0139
     C                   ELSE                                                                  S0139
0928 C                   MOVE      'R'           AKY(10)                                       S0139
     C     CEU015        IFEQ      'Y'                                                         CEU01
     C     S01434        ANDEQ     'Y'                                                         CEU01
     C     RTFC          ANDNE     *BLANKS                                                     CEU01
     C                   MOVE      'X'           AKY(9)                                        CEU01
     C                   ENDIF                                                                 CEU01
     C                   END                                                                   S0139
     C                   END                                                                   S0139
0929 C   47PAMT          SUB       ICTD          KYAMT
     C/COPY WNCPYSRC,DL0280C192                                           S01408
     C*                                                            043181 101999
     C     CEU015        IFEQ      'Y'                                                         CEU01
     C     *IN47         ANDEQ     *ON                                                         CEU01
     C     AKY(9)        ANDEQ     'X'                                                         CEU01
     C                   MOVE      *BLANKS       AKY(9)                                        CEU01
     C                   ENDIF                                                                 CEU01
     C*                                                            043181 101999
0930 C   47              MOVE      'A'           AKY(10)                                       10199
0931 C                   Z-ADD     KYAMT         NRRPUR
     C***   ONLY MOVE PRINCIPAL AMOUNT WHEN IT IS NOT A REVERSAL
     C  N47              Z-ADD     YYPAMT        KYAMT
0933 C                   Z-ADD     INTR          NARRAT
0934 C                   MOVEL     NEV(2)        NARREV
     C/COPY WNCPYSRC,DL0280C448
     C     FUID          IFNE      'Y'                                                         08060
0935 C                   SETON                                        71
     C                   ENDIF                                                                 08060
     C/COPY WNCPYSRC,DL0280C449
0936 C                   EXSR      EXCP
      *                                                                                       CAS009
     C                   MOVE      'SAMT'        WCFTP             4                          CAS009
     C                   EXSR      SRMMCF                                                     CAS009
      *                                                                                       CDL018
      ** If feature CDL018 is installed generate additional account key                       CDL018
      *                                                                                       CDL018
     C     CDL018        IFEQ      'Y'
     C     AKY(10)       ANDEQ     'A'
     C     FIXDEP        IFEQ      'Y'
     C                   MOVE      'B'           AKY(10)
     C                   EXSR      EXCP
     C                   ENDIF
     C                   ENDIF
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** Fiduciary Call or Time Deposits                                  CDL006
      *                                                                   CDL006
     C     DTYP          IFEQ      'FT'                                                        CDL00
     C     DTYP          OREQ      'DT'                                                        CDL00
     C     DTYP          OREQ      'LT'                                                        CDL00
      *                                                                   CDL006
      ** Initialize Charge and tax on charge amounts used to              CDL006
      ** calculate Net amount to be settled.                              CDL006
      *                                                                   CDL006
     C                   Z-ADD     *ZEROS        W0FCGA           13 0                         CDL00
      *                                                                   CDL006
      ** If charges taken.                                                CDL006
      *                                                                   CDL006
     C     BNCHTK        IFEQ      'Y'                                                         CDL00
     C     FCGC          ANDNE     *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** Build account key for Charge at value date.                      CDL006
      *                                                                   CDL006
     C                   MOVE      'V'           AKY(3)                                        CDL00
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
     C                   MOVE      'X'           AKY(10)                                       CDL00
     C                   Z-ADD     FCGA          KYAMT                                         CDL00
     C                   Z-ADD     FCGA          W0FCGA                                        CDL00
      *                                                                   CDL006
      ** Generate Account key for Charge at value date.                   CDL006
      *                                                                   CDL006
     C                   EXSR      EXCP                                                        CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C038
     C*                                                                   S01392
     C* IF FRONT UP INTEREST =Y, GENERATE NET AND TOTAL INTEREST A/C KEYS S01392
     C*                                                                   S01392
     C     FUID          IFEQ      'Y'                                                         S0139
      *                                                                   CDL006
      ** Or feature CDL006 installed.                                     CDL006
      *                                                                   CDL006
     C     CDL006        OREQ      'Y'                                                         CDL00
     C                   Z-ADD     PAMT          KYAMT                                         CDL00
      *                                                                   CDL006
      ** Net Settlement Account Key                                       CDL006
      *                                                                   CDL006
      ** If front-up interest indicator set to 'Y'.                       CDL006
      *                                                                   CDL006
     C     FUID          IFEQ      'Y'                                                         CDL00
     C/COPY WNCPYSRC,DL0280C039
     C*                                                                   S01392
     C* NET SETTLEMENT A/C KEY                                            S01392
     C*                                                                   S01392
     C                   SUB       TOTI          KYAMT                                         CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** If feature CDL006 installed.                                     CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Fiduciary Call or Time deposits.                              CDL006
      *                                                                   CDL006
     C     WUFIDE        IFEQ      'D'                                                         CDL00
     C     WUFIDE        OREQ      'L'                                                         CDL00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'N'           F1FFLG
     C                   Z-ADD     W0FCGA        F1FVAL
     C                   Z-ADD     0             WKAMT            13 4
     C     KYAMT         IFNE      0
     C     W0FCGA        DIV(H)    KYAMT         WKAMT
     C     WKAMT         MULT      100           F1FPCT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CGL020
     C                   ADD       W0FCGA        KYAMT                                         CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C040
     C                   Z-ADD     KYAMT         NRRPUR                                        S0139
     C   53              MOVE      'N'           AKY(10)                        NOT ROLLOVER   S0139
     C  N53              MOVE      'R'           AKY(10)                        ROLLOVER       S0139
     C  N53
     CAN 47              MOVE      'N'           AKY(10)                        ROLLOVER REVRSLS0139
     C/COPY WNCPYSRC,DL0280C450
0936 C                   EXSR      EXCP                                                        S0139
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
      *                                                                   CDL006
      ** If front-up interest indicator set to 'Y'.                       CDL006
      *                                                                   CDL006
     C     FUID          IFEQ      'Y'                                                         CDL00
     C/COPY WNCPYSRC,DL0280C041
     C*                                                                   S01392
     C* TOTAL INTEREST A/C KEY                                            S01392
     C*                                                                   S01392
     C                   Z-ADD     PAMT          NRRPUR                                        08060
     C/COPY WNCPYSRC,DL0280C451
     C                   Z-ADD     TOTI          KYAMT                                         S0139
     C                   Z-ADD     KYAMT         NRRSAL                                        S0139
     C                   MOVE      'I'           AKY(10)                                       S0139
     C                   SETON                                        71                       S0139
0936 C                   EXSR      EXCP                                                        S0139
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C042
     C                   END                                                                   S0139
      *                                                                   CAC001
      ** For Loans/Deposits, set-up the following Value Date              CAC001
      ** account keys.                                                    CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Principal - Transaction Profit Centre                            CAC001
      *                                                                   CAC001
     C                   MOVE      'V'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C     *IN47         IFEQ      '1'                                                         CAC00
     C     PAMT          SUB       CFCD          KYAMT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD     YYPAMT        KYAMT                                         CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Principal - Funding Profit Centre                                CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST=Y      CAC00
      *                                                                   CAC001
0937 C                   BITON     '1'           ACEI
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
0938 C*
0939 C*****    DEPINT IS A ROUTINE TO HANDLE NEXT INTEREST PAYMENT
0940 C*         DATE(S)  PROCESSING IF REQUIRED.
0941 C*
0942 C     DEPINT        TAG                                                    ** DEPINT TAG *
     C/COPY WNCPYSRC,DL0280C699
0943 C   41              Z-ADD     NIDT          PARDAT
     C/COPY WNCPYSRC,DL0280C533
     C   41
     CAN 19
0944 CAN 21              SETON                                        25
0945 C   41              EXSR      DLAMND
     C/COPY WNCPYSRC,DL0280C700
0946 C                   SETOFF                                       25                       E4729
     C   U8              GOTO      EOJ                                                         S0138
0949 C                   MOVEL     NEV(3)        NARREV
     C                   Z-ADD     PAMT          NRRPUR                                        05114
0950 C  N47              GOTO      NOTREV
0951 C*
0952 C*****    THIS SECTION GENERATES ALL OUTSTANDING ACCOUNT KEYS FOR
0953 C*         A REVERSAL.
     C*
0955 C                   Z-ADD     INTR          NARRAT
0956 C                   MOVEA     DLST          AKY(4)
0957 C                   MOVE      'I'           AKY(3)
0958 C                   MOVEA     '    '        AKY(6)
0959 C                   Z-ADD     SLID          KYDAT
0960 C                   MOVE      PCCY          KYCCY
     C     IPDS          IFEQ      'Y'                                                         CEU00
     C                   MOVE      ISCY          KYSCY                                         CEU00
     C                   ELSE                                                                  CEU00
     C                   MOVE      STCY          KYSCY                                         CEU00
     C                   ENDIF                                                                 CEU00
0961 C                   Z-ADD     MDST          KYSETL
0962 C                   MOVE      OMDA          KYOSTL
     C/COPY WNCPYSRC,DL0280C002
     C* FOR A REVERSAL MUST PROCESS THE PAY BRANCH (EQUIVALENT TO      d
     C* MATURITY DATE BRANCH)                                           pay
     C     DTYP          IFEQ      'IP'                                                        BHF85
     C     DTYP          OREQ      'TI'                                                        BHF85
     C     DTYP          OREQ      'LN'                                                        BHF85
     C     DTYP          OREQ      'CL'                                                        BHF85
     C     DTYP          OREQ      'DL'                                                        BHF85
     C     DTYP          OREQ      'IL'                                                        S0135
0962 C                   MOVE      ROBR          KYSTBR                                        BHF85
0962 C                   ELSE                                                                  BHF85
0962 C                   MOVE      POBR          KYSTBR                                        S0111
     C                   END                                                                   05896
0962 C                   MOVE      PRFC          OPPRFC                                        S0111
     C/COPY WNCPYSRC,DL0280C487
0963 C*
0964 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
0965 C*
0966 C                   EXSR      FEDAT
0967 C*
0968 C                   Z-ADD     TAXD          TAXA                                          S0138
0969 C*
     C/COPY WNCPYSRC,DL0280C159                                           S01408
0970 C*
     C*    TO ALLOW FOR REVERSAL OF DEPOSITS WITH NEGATIVE INTEREST
     C*    CHECK FOR AMOUNT NOT EQUAL TO 0
     C   19
     CAN 21              MOVE      '1'           *IN25                                         08060
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C214                                           S01408
     C*                                                                   S01408
     C** Reverse out Interest Paid/Received                               117032
     C*                                                                   117032
     C                   Z-ADD     IPRD          WORKD                                         08060
      *                                                                   CAC001
      ** Calculate WORKD for Funding                                      CAC001
      *                                                                   CAC001
     C                   Z-ADD     0             WRKD             13 0                         CAC00
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C     AMTP          IFEQ      'CI'                                                        10198
     C     INTC          OREQ      'Y'                                                         13160
     C                   Z-ADD     CFCD          WRKD                                          CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD     COFD          WRKD                                          CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF                                                                 CAC00
     C*                                                                   080603
     C     WORKD         IFNE      0                                                           08060
     C     WRKD          ORNE      0                                                           CAC00
     C                   MOVE      'P'           INTRVT            1                           11703
     C                   EXSR      INTREV                                                      08060
     C                   END                                                                   08060
     C*                                                                   117032
     C** Reverse out Interest Capitalised                                 117032
     C*                                                                   117032
     C                   Z-ADD     ICTD          WORKD                                         11703
     C     WORKD         IFNE      0                                                           11703
     C                   MOVE      'C'           INTRVT                                        11703
     C                   EXSR      INTREV                                                      11703
     C                   END                                                                   11703
     C*                                                                   117032
     C                   MOVE      '0'           *IN25                                         08060
     C/COPY WNCPYSRC,DL0280C215                                           S01408
     C*                                                                   S01408
     C*    TO ALLOW FOR REVERSAL OF DEPOSITS WITH NEGATIVE INTEREST
     C*    CHECK FOR AMOUNT NOT EQUAL TO 0
     C     AIPD          COMP      0                                  5353      ACCRUED INT.
1003 C   53              MOVE      'A'           AKY(3)                             POSTED
1004 C   53              MOVE      'A'           AKY(10)
1005 C   53              Z-ADD     AIPD          KYAMT
     C*    ACCRUAL REVERSALS SHOULD BE VALUED ON RUN DATE
     C   53              Z-ADD     BJRDNB        KYDAT                                         S0119
1007 C*
1008 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1009 C*
1010 C                   EXSR      FEDAT
     C/COPY WNCPYSRC,DL0280C160                                           S01408
1011 C*
1012 C   53              Z-ADD     KYAMT         NRRSAL           13 0
1013 C   53              SETON                                        71
1014 C   53              EXSR      EXCP
      *                                                                   CDL006
      ** If Feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Fiduciary Fixed term deposit with Accrued commission          CDL006
      ** posted to date.                                                  CDL006
     C     WUFIDE        IFEQ      'D'                                                         CDL00
     C     DTYP          ANDEQ     'FT'                                                        CDL00
     C     FACPD         ANDNE     0                                                           CDL00
     C     WUFIDE        OREQ      'L'                                                         CDL00
     C     DTYP          ANDEQ     'FT'                                                        CDL00
     C     FACPD         ANDNE     0                                                           CDL00
      *                                                                   CDL006
      ** Build Accrued commission posted to date Account Key.             CDL006
      *                                                                   CDL006
     C                   MOVE      'A'           AKY(3)                                        CDL00
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
     C                   MOVE      'C'           AKY(10)                                       CDL00
     C                   Z-ADD     FACPD         KYAMT                                         CDL00
      *                                                                   CDL006
      ** Generate Accrued commission Account Key.                         CDL006
      *                                                                   CDL006
     C                   EXSR      EXCP                                                        CDL00
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C161                                           S01408
      *                                                                                       CAS004
      ** DEALSDC Transaction Deletion Reversals                                               221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     CAS001        OREQ      'Y'
     C                   Z-ADD     BJRDNB        KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
      *                                                                   CAC001
      ** Generate the following Accrual Date account keys for reversals   CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C     ACPD          ANDNE     0                                                           CAC00
      *                                                                   CAC001
      ** Cost of Fund Accrued Posted to Date - Transaction Profit Centre  CAC001
      *                                                                   CAC001
     C                   MOVE      'A'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   Z-ADD     ACPD          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Fund Accrued Posted to Date - Funding Profit Centre      CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST=Y      CAC00
     C* IF BRT SAR IS INSTALLED, AND DL0280 IS BEING RUN DURING           S01383
     C* THE CLOSE OF BUSINESS (IE NOT INPUT CYCLE INITIATION)             S01383
     C*                                                                   S01383
     C     S01383        IFEQ      'Y'                                          B 001          S0138
     C     *INU1         ANDEQ     '1'                                                         S0138
     C*                                                                   S01383
     C** SINCE DEAL IS REVERSED OUT, RECORDS WRITTEN TO INTPSDD MUST      S01383
     C** BE REMOVED.                                                      S01383
     C*                                                                   S01383
     C     DLNO          SETLL     INTPSL25                                                    S0138
     C                   MOVE      '0'           *IN31                                         S0138
     C*                                                                   068074
     C** Save current value of indicators to temporary field              068074
     C*                                                                   068074
     C                   MOVE      *IN69         IN69              1                           06807
     C                   MOVE      *IN99         IN99              1                           06807
     C*                                                                   S01383
     C     *IN31         DOUNE     '0'                                                         S0138
     C                   MOVE      '0'           *IN69                                         06807
     C                   MOVE      '0'           *IN99                                         06807
     C     DLNO          READE     INTPSL25                               31                   S0138
     C     *IN31         IFNE      '1'                                                         S0138
     C     CNUM          ANDEQ     CNUMI                                                       06807
     C                   MOVE      '*'           RECII                                         S0138
     C     *IN69         IFEQ      '1'                                                         06807
     C                   UPDATE    INTPSDDX                                                    06807
     C                   END                                                                   06807
     C     *IN99         IFEQ      '1'                                                         06807
     C                   UPDATE    COINTDDX                                                    06807
     C                   END                                                                   06807
     C                   END                                                                   S0138
     C                   END                                                                   S0138
     C*                                                                   068074
     C** Restore back the saved values unto the indicators                068074
     C*                                                                   068074
     C                   MOVE      IN69          *IN69                                         06807
     C                   MOVE      IN99          *IN99                                         06807
     C*                                                                   S01383
     C                   END                                                    E 001          S0138
     C*                                                                   S01383
     C/COPY WNCPYSRC,DL0280C193                                           S01408
1015 C                   GOTO      EOJ
1016 C*
1017 C*****    NOTREV IS A ROUTINE TO HANDLE INTEREST DATE PROCESSING
1018 C*         FOR NON-REVERSALS.
1019 C*
1020 C     NOTREV        TAG                                                    ** NOTREV TAG *
     C/COPY WNCPYSRC,DL0280C632
1021 C     NIDT          COMP      EVCD                               53
     C/COPY WNCPYSRC,DLH00068
     C     IPFR          IFNE      'N'                                                         AUS00
1022 C  N53NIDT          COMP      SLID                                 5353
     C/COPY WNCPYSRC,DL0280C633
     C                   ELSE                                                                  AUS00
     C  N53NIDT          COMP      SLID                                 53                     AUS00
     C/COPY WNCPYSRC,DLH00069
     C                   END                                                                   AUS00
     C/COPY WNCPYSRC,DL0280C008
1023 C   53              GOTO      DPMAT
     C/COPY WNCPYSRC,DL0280C534
      *                                                                                       CDL033
      ** For CF deals and if this is not a reversal, process                                  CDL033
      ** the following if they were not yet processed before                                  CDL033
      ** in this run: short term rate, rate fix date                                          CDL033
      ** and/or rate change date.                                                             CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
      *                                                                                       CDL033
     C     WFLAGS        IFEQ      *BLANK                                                     CDL033
     C     WFLAGF        OREQ      *BLANK                                                     CDL033
     C     WFLAGR        OREQ      *BLANK                                                     CDL033
     C                   Z-ADD     NIDT          WCFDAT                                       CDL033
     C                   EXSR      SRFRC2                                                     CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
1024 C                   Z-ADD     NIDT          NIPAR
     C     IPFR          IFEQ      'N'                                                         AUS00
     C     MDAT          ANDNE     *ZERO                                                       AUS00
     C     MDAT          ANDLE     NIDT                                                        AUS00
     C     MDAT          SUB       1             NIPAR                                         AUS00
     C                   MOVE      'XX'          MATURE            2                           AUS00
     C                   END                                                                   AUS00
     C   19
1025 CAN 21              SETON                                        25                       E4725
     C/COPY WNCPYSRC,DL0280C634
      * If CDL096 is On and Amount Convention is 'A', update Next Interest                    CDL096
      * Payment Date to be the Interest Base Date (which contains the                         CDL096
      * correct date that interest should be calculated up to)                                CDL096
     C     CDL096        IFEQ      'Y'                                                        CDL096
     C     IPFR          ANDNE     *BLANKS                                                    CDL096
     C     AMTC          ANDEQ     'A '                                                       CDL096
      *                                                                                       CDL096
      * Save value of Next Interest Payment date for use in updating                          CDL096
      * Value date field on Account Key generation                                            CDL096
     C                   Z-ADD     NIPAR         WNIPAR            5 0                        CDL096
     C                   Z-ADD     IBDT          NIPAR                                        CDL096
     C                   ENDIF                                                                CDL096
      *                                                                                     MD031631
     C                   EVAL      NIDATF= 'Y'                                              MD031631
1026 C                   EXSR      NIDAT
     C/COPY WNCPYSRC,DL0280C003
     C   U8              GOTO      EOJ                                                         S0138
1027 C   19              SETOFF                                       25
1028 C     IPFR          COMP      ' '                                5353
     C/COPY WNCPYSRC,DL0280C489
     C     CDL012        IFEQ      'Y'
     C  N53              Z-ADD     NIDT          UGNIDT            5 0
     C                   ENDIF
1029 C  N53              Z-ADD     0             NIDT
     C/COPY WNCPYSRC,DL0280C009
1030 C  N53              GOTO      DPMAT                                        CHECK FOR
     C/COPY WNCPYSRC,DL0280C701
      *                                                                                       CDL033
      ** If frequency of next interest payment                                                CDL033
      ** date is irregular, process differently.                                              CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     IPFR          ANDEQ     'Z'                                                        CDL033
      *                                                                                       CDL033
     C                   EXSR      SRFRC7                                                     CDL033
      *                                                                                       CDL033
     C     NIDT          IFNE      *ZERO                                                      CDL033
      *                                                                                       CDL033
     C     MDAT          IFNE      *ZERO                                                      CDL033
     C     NIDT          ANDLT     MDAT                                                       CDL033
     C     MDAT          OREQ      *ZERO                                                      CDL033
     C                   GOTO      DEPINT                                                     CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C                   ELSE                                                                 CDL033
      *                                                                                       CDL033
1031 C                   Z-ADD     IBDT          ZDAYNO                           FURTHER INT.
     C     IPFR          IFNE      'N'                                                         AUS00
1032 C                   MOVE      IPFR          ZFREQ                           DATES.
     C                   ELSE                                                                  AUS00
     C                   MOVE      'M'           ZFREQ                                         AUS00
     C                   END                                                                   AUS00
     C/COPY WNCPYSRC,DL0280C527
1033 C                   MOVE      PCCY          ZCCY
     C     CEU003        IFEQ      'Y'                                                         CEU00
     C     IPDS          ANDEQ     'Y'                                                         CEU00
     C     ISCY          ANDNE     *BLANKS                                                     CEU00
     C                   MOVE      ISCY          ZCCY                                          CEU00
     C                   ENDIF                                                                 CEU00
     C     CEU003        IFEQ      'Y'                                                         CEU00
     C     IPDS          ANDNE     'Y'                                                         CEU00
     C     STCY          ANDNE     *BLANKS                                                     CEU00
     C                   MOVE      STCY          ZCCY                                          CEU00
     C                   ENDIF                                                                 CEU00
1034 C                   Z-ADD     INTF          ZMDAY
     C                   MOVE      BJSLCD        ZLOC                                          S0119
     C/COPY WNCPYSRC,DL0280C239
      * If CDL096 is On, determine next interest payment date considering Business            CDL096
      * Day convention details defined for the deal                                           CDL096
     C     CDL096        IFEQ      'Y'                                                        CDL096
     C     IPFR          ANDNE     ' '                                                        CDL096
     C     CCYPC         ANDNE     *BLANKS                                                    CDL096
      *                                                                                       CDL096
     C                   EXSR      ZFRQB3                                                     CDL096
      *                                                                                       CDL096
     C                   CALL      'DLZIRP'                                                   CDL096
     C                   PARM                    ZDAYNO                                       CDL096
     C                   PARM      CCYPC         PCURR                                        CDL096
     C                   PARM      PYDC          PPDCN                                        CDL096
     C                   PARM                    ZLOC                                         CDL096
     C                   PARM                    BJDFIN                                       CDL096
     C                   PARM      *ZEROS        PAJDT                                        CDL096
     C                   PARM      *ZEROS        PBSDT                                        CDL096
     C                   Z-ADD     PAJDT         ZDYNBR                                       CDL096
     C                   Z-ADD     PBSDT         ZDAYNO                                       CDL096
      *                                                                                       CDL096
      ** Do not return adjusted date if it is equal to or earlier than                        CDL096
      ** previous date (only happens for 'previous' date calculations);                       CDL096
      ** instead use the base date                                                            CDL096
      *                                                                                       CDL096
     C     IBDT          IFGE      ZDYNBR                                                     CDL096
     C                   Z-ADD     PBSDT         ZDYNBR                                       CDL096
     C                   ENDIF                                                                CDL096
      *                                                                                       CDL096
1036 C                   Z-ADD     ZDAYNO        FREQDN            5 0                        CDL096
      *                                                                                       CDL096
     C                   ELSE                                                                 CDL096
1035 C                   EXSR      ZFREQC                                                      S0119
1036 C                   Z-ADD     ZDAYNO        FREQDN            5 0
     C/COPY WNCPYSRC,DL0280C528
     C**  ZFREQ MAY RETURN A NON-WORKING DAY FOR FREQ W,F,S,R AND L       S01093
     C**  CHECK WITH  ZFWDT AND GET NEXT WORKING DAY                      S01093
     C     ZFREQ         LOOKUP    FRQ                                    50                   S0109
     C     *IN50         IFEQ      '1'                                          ** IF  001     S0109
     C/COPY WNCPYSRC,DL0280C562
     C                   Z-ADD     0             ZNRDYS                                        S0119
     C                   MOVE      BJSLCD        ZLOC                                          S0119
1038 C                   EXSR      ZFWDT                                                       S0119
     C                   ELSE                                                   ** ELS 001     S0109
     C                   Z-ADD     ZDAYNO        ZDYNBR                                        S0109
     C                   END                                                    ** END 001     S0109
     C                   ENDIF                                                                CDL096
     C/COPY WNCPYSRC,DL0280C240
1039 C     MDAT          COMP      0                                      53
1040 C  N53ZDAYNO        COMP      MDAT                                 53
     C     ZDYNBR        IFNE      *ZERO                                                      255705
     C     ZDYNBR        ANDLE     NIDT                                                       255705
     C                   MOVE      '0'           *IN53                                        255705
     C                   ENDIF                                                                255705
1041 C   53              Z-ADD     FREQDN        IBDT
     C     CDL012        IFEQ      'Y'
     C   53              Z-ADD     NIDT          UGNIDT
     C                   ENDIF
1042 C   53              Z-ADD     ZDYNBR        NIDT                                          S0109
1043 C   53              GOTO      DEPINT
     C/COPY WNCPYSRC,DL0280C702
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C     RECR          IFEQ      'M'                                                         AUS00
     C     IPFR          ANDEQ     'N'                                                         AUS00
     C     ZDYNBR        ANDGT     EVCD                                                        AUS00
     C                   GOTO      DPMAT                                                       AUS00
     C                   END                                                                   AUS00
     C     IPFR          IFEQ      'N'                                                         AUS00
     C                   Z-ADD     FREQDN        IBDT                                          AUS00
     C     CDL012        IFEQ      'Y'
     C                   Z-ADD     NIDT          UGNIDT
     C                   ENDIF
     C                   Z-ADD     ZDYNBR        NIDT                                          AUS00
     C                   GOTO      DEPINT                                                      AUS00
     C                   END                                                                   AUS00
1044 C                   Z-ADD     0             IBDT
     C/COPY WNCPYSRC,DL0280C490
     C     CDL012        IFEQ      'Y'
     C                   Z-ADD     NIDT          UGNIDT
     C                   ENDIF
1045 C                   Z-ADD     0             NIDT
1046 C                   MOVE      ' '           IPFR
1045 C                   Z-ADD     0             INTF
     C/COPY WNCPYSRC,DL0280C010
1047 C*
1048 C*****    DPMAT IS A ROUTINE TO HANDLE THE MATURITY DATE PROCESSING
1049 C*           FOR DEPOSITS.
1050 C*
1051 C     DPMAT         TAG                                                    ** DPMAT TAG **
     C/COPY WNCPYSRC,DL0280C703
1052 C   41MDAT          COMP      0                                      53
     C   41
1053 CAN 53              Z-ADD     99999         PARDAT
     C   41
1054 CANN53              Z-ADD     MDAT          PARDAT
     C   41
     CAN 19
1055 CAN 21              SETON                                        25
1056 C   41              EXSR      DLAMND
     C/COPY WNCPYSRC,DL0280C704
     C                   SETOFF                                       25
     C   U8              GOTO      EOJ                                                         S0138
1060 C     MDAT          COMP      0                                      53
1061 C  N53MDAT          COMP      EVCD                               53
1062 C   53              GOTO      DPACCR
1063 C                   TESTB     '2'           ACEI                     53
1064 C   53              GOTO      EOJ
     C/COPY WNCPYSRC,DL0280C705
1066 C***41*****         SETON                                        64LRU8                AR547995
     C   41              SETON                                        64LRU7                AR547995
1067 C   41              GOTO      EOJ
     C/COPY WNCPYSRC,DL0280C706
1068 C                   TESTB     '2'           DNSI                     53
      *                                                                                       CDL019
      ** If deal type is fixed deposit/loan then force final interest                         CDL019
      ** at maturity to be calculated rather than use residual of TOTI.                       CDL019
      *                                                                                       CDL019
     C     FIXDEP        IFEQ      'Y'
     C                   MOVE      *ON           *IN53
     C                   ENDIF
      *                                                                                       CDL019
     C/COPY WNCPYSRC,DL0280C707
      *                                                                                       CDL033
      ** For CF deals and if this is not a reversal, process                                  CDL033
      ** the following if they were not yet processed before                                  CDL033
      ** in this run: short term rate, rate fix date                                          CDL033
      ** and/or rate change date.                                                             CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
      *                                                                                       CDL033
     C     WFLAGS        IFEQ      *BLANK                                                     CDL033
     C     WFLAGF        OREQ      *BLANK                                                     CDL033
     C     WFLAGR        OREQ      *BLANK                                                     CDL033
     C                   Z-ADD     MDAT          WCFDAT                                       CDL033
     C                   EXSR      SRFRC2                                                     CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
1069 C*
1070 C*****     CALCULATE INTEREST AMOUNTS
1071 C*
1072 C                   MOVEL     NEV(4)        NARREV
     C/COPY WNCPYSRC,DL0280C717
1073 C  N53              GOTO      DPIC2
1074 C                   Z-ADD     IACD          ZIBEG
1075 C                   Z-ADD     MDAT          ZIEND                          INT.
1076 C                   Z-ADD     PAMT          ZIAMT                           CALCULATED
1077 C                   Z-ADD     ICBS          ZICALC
1078 C                   Z-ADD     INTR          ZIRATE
     C/COPY WNCPYSRC,DL0280CP20                                           S01408
1079 C                   EXSR      GLINTC
     C/COPY WNCPYSRC,DL0280CP21                                           S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT            13 0                         06655
     C                   END                                                                   06655
     C*                                                                   066550
      *                                                                                       CDL034
      ** Calculate accrued interest from Deal Interest Rate History file                      CDL034
      *                                                                                       CDL034
     C     CDL034        IFEQ      'Y'                                                        CDL034
     C     BRTT          IFNE      0                                                          CDL034
     C                   MOVE      'M'           INTMAT                                       CDL034
     C                   EXSR      DLINT                                                      CDL034
     C                   ENDIF                                                                CDL034
     C                   ENDIF                                                                CDL034
     C/COPY WNCPYSRC,DL0280C241
1080 C     WKINT         ADD       AITC          WORKTD                          ACCRUED TO
     C     CDL034        IFEQ      'Y'                                                        CDL034
     C     BRTT          IFNE      0                                                          CDL034
     C                   ADD       IRHADJ        WORKTD                                       CDL034
     C                   ENDIF                                                                CDL034
     C                   ENDIF                                                                CDL034
1081 C     WORKTD        ADD       AIAN          WORKTD                              DATE
1082 C     WORKTD        ADD       AIAP          WORKTD
1083 C     WORKTD        SUB       AIPD          WORKTP                         INT.TO POST.
1084 C     WORKTD        SUB       IPRD          WORKD
1085 C     WORKD         SUB       ICTD          WORKD                           INT. DUE
      **********                                                                   MD031283 MD031631
      ***If*'UseHistRateforBVDeal'*is*Y*and*multiple*base*rate*change              MD031283 MD031631
      ***detected*then*recalculate*Total*interest*for*backdated*MM*deals           MD031283 MD031631
      **********                                                                   MD031283 MD031631
     C**********         IF        HSTRAT = 'Y' AND                                MD031283 MD031631
     C**********                   CtrBV  > 0                                      MD031283 MD031631
2238 C**********         EVAL      TOTI = WORKD                                    MD031283 MD031631
2238 C**********         ENDIF                                                     MD031283 MD031631
     C/COPY WNCPYSRC,DL0280C491
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C                   Z-ADD     INTR          WRKINT           11 7
     C                   EXSR      SRNTR
      *                                                                                       CAS005
     C                   Z-ADD     IACD          ZIBEG
     C                   Z-ADD     MDAT          ZIEND
     C                   Z-ADD     FSPAMT        ZIAMT
     C                   Z-ADD     ICBS          ZICALC
     C                   Z-ADD     WKINTR        ZIRATE
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
     C     WINTST        ADD       FSAITN        WKNTRD           13 0
     C     WKNTRD        ADD       FSAINN        WKNTRD
     C     WKNTRD        ADD       FSAIAN        WKNTRD
     C     WKNTRD        SUB       FSAIPN        WKNTRP           13 0
     C     WKNTRD        SUB       FSIPRN        WKNTR            13 0
     C     WKNTR         SUB       FSICTN        WKNTR
     C                   ENDIF
1086 C*
1087 C*****     DPIC2 CALCULATES INTEREST WHERE TOTAL INTEREST OVERRIDE
1088 C*           IS OFF.
1089 C*
1090 C     DPIC2         TAG                                                    ** DPIC2 TAG **
      *                                                                   CAC001
      ** Calculate COF Accrued not yet Posted                             CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Get effective Funding Rate                                       CAC001
      *                                                                   CAC001
     C                   SELECT                                                                CAC00
     C     FSGN          WHENEQ    '+'                                                         CAC00
     C     INTR          ADD       FSRP          WEFFR            11 7                         CAC00
     C     FSGN          WHENEQ    '-'                                                         CAC00
     C     INTR          SUB       FSRP          WEFFR                                         CAC00
     C     FSGN          WHENEQ    ' '                                                         CAC00
     C                   Z-ADD     FSRP          WEFFR                                         CAC00
     C                   ENDSL                                                                 CAC00
      *                                                                   CAC001
     C                   Z-ADD     FCTD          ZIBEG                                         CAC00
     C                   Z-ADD     MDAT          ZIEND                                         CAC00
     C                   Z-ADD     PAMT          ZIAMT                                         CAC00
     C                   Z-ADD     ICBS          ZICALC                                        CAC00
     C                   Z-ADD     WEFFR         ZIRATE                            CALCULATED  CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C     WKINT         ADD       ACDA          WORKTD                                        CAC00
     C                   ADD       ACAP          WORKTD                                        CAC00
     C                   ADD       ACAN          WORKTD                                        CAC00
     C     WORKTD        SUB       ACPD          WRKTP            13 0                         CAC00
     C     WORKTD        SUB       COFD          WRKD             13 0                         CAC00
     C                   SUB       CFCD          WRKD                                          CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
     C*                                                                   062321
     C** Negate TOTI if Negative Interest Indicator is ON.                062321
     C*                                                                   062321
      *                                                                                       221673
      ** TOTI is always positive on DEALSDC                                                   221673
      *                                                                                       221673
     C**********         TESTB     '1'           DSTI                     31           062321 221673
     C     INTR          IFLT      0                                                          221673
     C                   MOVE      '1'           *IN31                                        221673
     C                   ELSE                                                                 221673
     C                   MOVE      '0'           *IN31                                        221673
     C                   ENDIF                                                                221673
      *                                                                                       221673
     C     *IN31         IFEQ      '1'                                                         06232
     C                   Z-SUB     TOTI          TOTI                                          06232
     C     CAS005        IFEQ      'Y'
     C                   Z-SUB     FSTOTN        FSTOTN
     C                   ENDIF
     C                   END                                                                   06232
     C*                                                                   062321
1091 C  N53TOTI          SUB       IPRD          WORKD
1092 C  N53WORKD         SUB       ICTD          WORKD                            INT. DUE
1093 C  N53TOTI          SUB       AIPD          WORKTP                           INT.TO POST.
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     *IN53         ANDEQ     *OFF
     C     FSTOTN        SUB       FSIPRN        WKNTR
     C     WKNTR         SUB       FSICTN        WKNTR
     C     FSTOTN        SUB       FSAIPN        WKNTRP
     C                   ENDIF
     C*                                                                   062321
     C** Return original value of TOTI.                                   062321
     C*                                                                   062321
     C     *IN31         IFEQ      '1'                                                         06232
     C                   Z-SUB     TOTI          TOTI                                          06232
     C     CAS005        IFEQ      'Y'
     C                   Z-SUB     FSTOTN        FSTOTN
     C                   ENDIF
     C                   END                                                                   06232
     C/COPY WNCPYSRC,DL0280C162                                           S01408
     C*                                                                   S01383
     C* IF DEPOSIT TAKEN (IT,CD,TD) AND DEAL IS TAXABLE                   S01383
     C*                                                                   S01383
     C                   Z-ADD     0             TAXA                                          S0138
     C     *IN21         IFEQ      '1'                                          B 001          S0138
     C     *IN23         ANDEQ     '1'                                          B 001          S0138
     C*                                                                   S01383
     C/COPY WNCPYSRC,DL0280C523
     C** IF BRT SAR IS INSTALLED                                          S01383
     C*                                                                   S01383
     C     S01383        IFEQ      'Y'                                          B 002          S0138
     C*                                                                   S01383
     C** CALCULATE TAX AMOUNT TAXA USING BRT RATES                        S01383
     C*                                                                   S01383
     C/COPY WNCPYSRC,DL0280C031
     C                   Z-ADD     MDAT          WKMDAT            5 0                         S0138
     C                   EXSR      CALBRT                                                      S0138
     C   U8              GOTO      EOJ                                                         S0138
     C/COPY WNCPYSRC,DL0280C032
     C*                                                                   S01383
     C** ELSE BRT SAR IS NOT INSTALLED                                    S01383
     C*                                                                   S01383
     C                   ELSE                                                   X 002          S0138
     C*                                                                   S01383
     C** CALCULATE TAX AMOUNT TAXA USING HK INTEREST RATE                 S01383
     C*                                                                   S01383
     C/COPY WNCPYSRC,DL0280CP17                                           S01408
     C*                                                                   S01408
     C* ROUND DOWN                                                        S01392
     C     JRDFC         IFEQ      'Y'                                          B 003          S0139
1097 C     WORKD         MULT      BNHKTR        TAXA                                          S0139
1098 C     TAXA          DIV       100           TAXA                                          S0139
     C                   ELSE                                                                  S0139
1097 C     WORKD         MULT(H)   BNHKTR        TAXA                                          S0138
1098 C     TAXA          DIV(H)    100           TAXA                                          S0138
     C                   END                                                    E 003          S0139
     C     CDL013        IFEQ      '1'                                                        CDL013
     C                   SELECT                                                               CDL013
     C     TAXI          WHENEQ    '0'                                                        CDL013
     C                   Z-ADD     0             WRATE             5 2                        CDL013
     C     TAXI          WHENEQ    '1'                                                        CDL013
     C                   Z-ADD     ETXR1         WRATE                                        CDL013
     C     TAXI          WHENEQ    '2'                                                        CDL013
     C                   Z-ADD     ETXR2         WRATE                                        CDL013
     C     TAXI          WHENEQ    '3'                                                        CDL013
     C                   Z-ADD     ETXR3         WRATE                                        CDL013
     C     TAXI          WHENEQ    '4'                                                        CDL013
     C                   Z-ADD     ETXR4         WRATE                                        CDL013
     C     TAXI          WHENEQ    '5'                                                        CDL013
     C                   Z-ADD     ETXR5         WRATE                                        CDL013
     C     TAXI          WHENEQ    '6'                                                        CDL013
     C                   Z-ADD     ETXR6         WRATE                                        CDL013
     C     TAXI          WHENEQ    '7'                                                        CDL013
     C                   Z-ADD     ETXR7         WRATE                                        CDL013
     C     TAXI          WHENEQ    '8'                                                        CDL013
     C                   Z-ADD     ETXR8         WRATE                                        CDL013
     C     TAXI          WHENEQ    '9'                                                        CDL013
     C                   Z-ADD     ETXR9         WRATE                                        CDL013
     C                   ENDSL                                                                CDL013
     C     WRATE         IFEQ      0                                                          CDL013
     C                   Z-ADD     0             TAXA                                         CDL013
     C                   ELSE                                                                 CDL013
     C                   Z-ADD     MDAT          WEVTDT            5 0                        CDL013
     C/COPY WNCPYSRC,DLH00097
     C                   EXSR      #UTWHT                                                     CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280CP19                                           S01408
     C     CGL165        IFEQ      'Y'                                                        CGL165
     C     TAXI          ANDEQ     'Y'                                                        CGL165
      *                                                                                       CGL165
     C                   Z-ADD     WORKD         PINTA                                        CGL165
     C                   MOVEL     DLNO          PACNO                                        CGL165
     C                   CALL      'GL024000'                                                 CGL165
     C                   PARM                    PRCOD1            1                          CGL165
     C                   PARM      'DL0280'      PCPGM             6                          CGL165
     C                   PARM      BRCA          PBRCA             3                          CGL165
     C                   PARM      CNUM          PCNUM             6                          CGL165
     C                   PARM                    PACNO            10                          CGL165
     C                   PARM                    PCCY              3                          CGL165
     C                   PARM                    PINTA            15 0                        CGL165
     C                   PARM      TXC1          PTXC1             2                          CGL165
     C                   PARM      TXC2          PTXC2             2                          CGL165
     C                   PARM      EVCD          PCPDT             5 0                        CGL165
     C                   PARM      VDAT          PVDAT             5 0                        CGL165
     C                   PARM      MDAT          PMDAT             5 0                        CGL165
     C                   PARM      INTR          PINRT            11 7                        CGL165
     C                   PARM      DTYP          PDTYP             2                          CGL165
     C                   PARM      PAMT          PPCPL            15 0                        CGL165
     C                   PARM      *BLANKS       PACOD            10                          CGL165
     C                   PARM      *ZEROS        PACSQ             2 0                        CGL165
     C                   PARM                    PWTXA            15 0                        CGL165
     C                   PARM                    PSTXA            15 0                        CGL165
      *                                                                                       CGL165
     C     PWTXA         ADD       PSTXA         TAXA                                         CGL165
     C                   ENDIF                                                                CGL165
     C                   END                                                    E 002          S0138
     C                   END                                                    E 001          S0138
     C/COPY WNCPYSRC,DL0280C163                                           S01408
1099 C*
1100 C*****     GENERATE MATURITY DATE ACCOUNT KEYS
1101 C*
1102 C                   Z-ADD     INTR          NARRAT
1103 C                   MOVE      'M'           AKY(3)
1104 C                   MOVEA     DLST          AKY(4)
1105 C                   MOVEA     '    '        AKY(6)
1106 C                   Z-ADD     MDAT          KYDAT
1107 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
1108 C                   Z-ADD     MDST          KYSETL
1109 C                   MOVE      OMDA          KYOSTL
     C/COPY WNCPYSRC,DLH00070
     C* FOR A DEPOSIT ACCEPTED THE PAY BRANCH IS EQUIVALENT TO         d
     C* MATURITY DATE BRANCH                                            pay
     C     DTYP          IFEQ      'IP'                                                        BHF85
     C     DTYP          OREQ      'TI'                                                        BHF85
     C     DTYP          OREQ      'LN'                                                        BHF85
     C     DTYP          OREQ      'CL'                                                        BHF85
     C     DTYP          OREQ      'DL'                                                        BHF85
     C     DTYP          OREQ      'IL'                                                        S0135
0962 C                   MOVE      ROBR          KYSTBR                                        BHF85
0962 C                   ELSE                                                                  BHF85
0962 C                   MOVE      POBR          KYSTBR                                        S0111
0962 C                   END                                                                   BHF85
1109 C                   MOVE      PRFC          OPPRFC                                        S0111
1110 C*
1111 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1112 C*
1113 C                   EXSR      FEDAT
1114 C*
1115 C     PAMT          COMP      0                                      53
1116 C                   Z-ADD     PAMT          KYAMT
     C/COPY WNCPYSRC,DL0280C452
      *                                                                                       221703
      ** DEALSDC Maturity Reversals                                                           221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     CAS001        OREQ      'Y'
     C                   Z-ADD     MDAT          KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
     C*                                                                   080603
     C**  Generate Maturity Date Accounting                               080603
     C*                                                                   080603
     C     PAMT          IFNE      *ZERO                                                       08060
     C     PAMT          OREQ      *ZERO                                                       12805
     C     WORKD         ANDNE     *ZERO                                                       12805
     C/COPY WNCPYSRC,DL0280C242
     C                   EXSR      MADAT                                                       08060
     C/COPY WNCPYSRC,DL0280C004
     C   U8              GOTO      EOJ                                                         08060
     C                   END                                                                   08060
     C/COPY WNCPYSRC,DL0280C437
1163 C     DPIC3         TAG                                                    ** DPIC3 TAG **
     C*                                                                   S01383
     C* IF BRT SAR IS INSTALLED, AND DL0280 IS BEING RUN DURING           S01383
     C* THE CLOSE OF BUSINESS (IE NOT INPUT CYCLE INITIATION)             S01383
     C*                                                                   S01383
     C/COPY WNCPYSRC,DL0280C453
     C     *IN21         IFEQ      *ON                                          B 000          08060
     C/COPY WNCPYSRC,DL0280C454
     C     S01383        IFEQ      'Y'                                          B 001          S0138
     C     *INU1         ANDEQ     '1'                                                         S0138
     C     TAXI          ANDNE     'X'
     C*                                                                   S01383
     C**  If the New A/C Signal on DEALSDC is blank, change this to 'Y'.  S01383
     C*                                                                   S01383
     C     DNACSG        IFEQ      ' '                                                         S0138
     C                   MOVE      'Y'           DNACSG                                        S0138
     C                   END                                                                   S0138
     C*                                                                   S01383
     C** WRITE A RECORD TO INTEREST HISTORY FILE                          S01383
     C*                                                                   S01383
     C                   MOVE      DNACSG        NACSG                                         S0138
     C                   Z-ADD     ACSQ          ACSQSV            2 0                         05207
     C                   EXSR      WRIINT                                                      S0138
     C                   EXSR      WRISEQ                                                      S0138
     C                   Z-ADD     ACSQSV        ACSQ                                          05207
     C   U8              GOTO      EOJ                                                         S0138
     C*                                                                   S01383
     C                   END                                                    E 001          S0138
1164 C*
1165 C*    EXCEPTION OUTPUT TO S/MINTN FILE
     C   21
1166 CAN U1              Z-ADD     IACD          SLIDD             5 0
     C   21
1167 CAN U1              EXSR      EXCPTN
     C/COPY WNCPYSRC,DL0280C455
     C                   END                                                    E 000          08060
     C/COPY WNCPYSRC,DL0280C456
1168 C*
1169 C*****    DPMAT2 IS A ROUTINE TO UPDATE THE DEAL RECORD
1170 C*
1171 C     DPMAT2        TAG                                                    ** DPMAT2 TAG *
     C/COPY WNCPYSRC,DL0280C011
1172 C                   BITON     '2'           ACEI
1173 C                   MOVE      'M'           RECR
      *                                                                   CPB001
      **  If Replication Processing required.                             CPB001
     C     REPLIC        IFEQ      'Y'                                          Begin REPLIC   CPB00
     C                   EXSR      SRREPI                                                      CPB00
      *                                                                   CPB001
      ** If any error occurred while executing subroutine REPLIC.         CPB001
     C     *INU8         IFEQ      *ON                                          Begin *INU8    CPB00
     C                   GOTO      EOJ                                                         CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End *INU8      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End REPLIC     CPB00
     C/COPY WNCPYSRC,DL0280C025
     C*                                                                   032104
     C     ORED          IFLT      BJRDNB                                                      03210
     C                   Z-ADD     AIPD          TOTI                                          E1043
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSAIPN        FSTOTN
     C                   ENDIF
     C                   END                                                                   03210
     C/COPY WNCPYSRC,DL0280C078
     C*                                                                   032104
     C                   Z-ADD     0             AIPD                                          E1043
     C                   Z-ADD     0             AITC                                          E1043
     C                   Z-ADD     0             AIAN                                          E1043
     C                   Z-ADD     0             AIAP                                          E1043
     C                   BITOFF    '2'           DNSI                                          E1043
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     0             FSAIPN
     C                   Z-ADD     0             FSAITN
     C                   Z-ADD     0             FSAINN
     C                   Z-ADD     0             FSAIAN
     C                   ENDIF
     C*                                                                   AUS003
     C     IPFR          IFNE      'N'                                          FREQ<>N        AUS00
1175 C     IPRD          ADD       WORKD         IPRD
     C/COPY WNCPYSRC,DL0280C563
1176 C     IPRM          ADD       WORKD         IPRM
     C/COPY WNCPYSRC,DL0280C172                                           S01408
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *          FSAIAN    ADD  FSAINN    FSAIAN                                              CAS005
     C     FSIPRN        ADD       WKNTR         FSIPRN
     C     FSIPMN        ADD       WKNTR         FSIPMN
     C                   ENDIF
     C                   END                                                                   AUS00
     C/COPY WNCPYSRC,DL0280C492
     C*                                                                   AUS003
      ** Update COF fields                                                CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C     ORED          IFLT      BJRDNB                                                      CAC00
     C                   Z-ADD     ACPD          TCOF                                          CAC00
     C                   ENDIF                                                                 CAC00
     C                   Z-ADD     0             ACPD                                          CAC00
     C                   Z-ADD     0             ACDA                                          CAC00
     C                   Z-ADD     0             ACAN                                          CAC00
     C                   Z-ADD     0             ACAP                                          CAC00
     C     IPFR          IFNE      'N'                                          FREQ<>N        CAC00
     C                   ADD       ACAN          ACAP                                          CAC00
     C                   ADD       WRKD          COFD                                          CAC00
     C                   ADD       WRKD          COFM                                          CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C/COPY WNCPYSRC,DL0280C529
     C   21
1177 CAN 23TAXD          ADD       TAXA          TAXD
     C   21
1178 CAN 23TAXM          ADD       TAXA          TAXM
     C/COPY WNCPYSRC,DL0280C062
     C     *IN21         IFEQ      '1'                                                     BUG26576A
     C     TAXI          ANDEQ     'T'                                                     BUG26576A
     C     TAXD          ADD       TAXA          TAXD                                      BUG26576A
     C     TAXM          ADD       TAXA          TAXM                                      BUG26576A
     C                   ENDIF                                                             BUG26576A
1179 C   21              Z-ADD     0             TAXA
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
     C/COPY WNCPYSRC,DL0280C538
1180 C                   GOTO      EOJ
1181 C*
1182 C*****    DPACCR IS A ROUTINE TO HANDLE ACCRUAL DATE PROCESSING FOR
1183 C*          DEPOSITS
1184 C*
1185 C     DPACCR        TAG                                                    ** DPACCR TAG *
1186 C     RECR          COMP      'M'                                    53
1187 C   53              GOTO      EOJ
     C/COPY WNCPYSRC,DL0280C708
      *                                                                                       CDL033
      ** For CF deals and if this is not a reversal, process                                  CDL033
      ** the following if they were not yet processed before                                  CDL033
      ** in this run: short term rate, rate fix date                                          CDL033
      ** and/or rate change date.                                                             CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
      *                                                                                       CDL033
     C     WFLAGS        IFEQ      *BLANK                                                     CDL033
     C     WFLAGF        OREQ      *BLANK                                                     CDL033
     C     WFLAGR        OREQ      *BLANK                                                     CDL033
     C                   Z-ADD     99999         WCFDAT                                       CDL033
     C                   EXSR      SRFRC2                                                     CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
1188 C     IACD          COMP      EVCD                               53
1189 C   53              GOTO      EOJ
1190 C  N52              GOTO      EOJ
1191 C                   Z-ADD     IACD          ZIBEG                            DATE
1192 C                   Z-ADD     EVCD          ZIEND
     C*                                                                   S01392
     C* ADD 1 TO END DATE IF NOT FIRST & LAST DAY INTEREST                S01392
     C* AND IF NOT LAST DAY ACCRUALS                                      S01392
     C*                                                                   S01392
     C     JFLID         IFNE      'Y'                                                         S0139
1193 C  N29ZIEND         ADD       1             ZIEND                          INCLUSIVE
     C                   END                                                                   S0139
1194 C                   Z-ADD     PAMT          ZIAMT
1195 C                   Z-ADD     ICBS          ZICALC                           INTEREST
1196 C                   Z-ADD     INTR          ZIRATE                            CALCULATED
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP22                                           S01408
      *                                                                   S01408
1197 C                   EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP23                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C/COPY WNCPYSRC,DL0280C243
     C*                                                                   066550
1198 C     WKINT         ADD       AITC          WORKTD
1199 C     WORKTD        ADD       AIAP          WORKTD                            ACCRUED TO
1200 C     WORKTD        ADD       AIAN          WORKTD                              DATE
1201 C     WORKTD        SUB       AIPD          WORKTP                           INT.TO POST
      **********                                                                   MD031283 MD031631
      ***If*'UseHistRateforBVDeal'*is*Y*and*multiple*base*rate*change              MD031283 MD031631
      ***detected*then*recalculate*Total*interest*for*backdated*MM*deals           MD031283 MD031631
      **********                                                                   MD031283 MD031631
     C**********         IF        HSTRAT = 'Y' AND                                MD031283 MD031631
     C**********                   CtrBV  > 0                                      MD031283 MD031631
2238 C**********         EVAL      TOTI = WORKTP                                   MD031283 MD031631
2238 C**********         ENDIF                                                     MD031283 MD031631
     C/COPY WNCPYSRC,DL0280C493
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C                   Z-ADD     INTR          WRKINT
     C                   EXSR      SRNTR
      *                                                                                       CAS005
     C                   Z-ADD     IACD          ZIBEG
     C                   Z-ADD     EVCD          ZIEND
      *                                                                                       CAS005
      ** Add 1 to end date if not first & last day interest                                   CAS005
      ** and if not last day accruals                                                         CAS005
      *                                                                                       CAS005
     C     JFLID         IFNE      'Y'
     C     *IN29         ANDEQ     *OFF
     C     ZIEND         ADD       1             ZIEND
     C                   ENDIF
     C                   Z-ADD     FSPAMT        ZIAMT
     C                   Z-ADD     ICBS          ZICALC
     C                   Z-ADD     WKINTR        ZIRATE
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
     C     WINTST        ADD       FSAITN        WKNTRD
     C     WKNTRD        ADD       FSAIAN        WKNTRD
     C     WKNTRD        ADD       FSAINN        WKNTRD
     C     WKNTRD        SUB       FSAIPN        WKNTRP
     C                   ENDIF
1202 C*
1203 C*****    GENERATE ACCRUAL DATE ACCOUNT KEY.
1204 C*
1205 C                   Z-ADD     INTR          NARRAT
1206 C                   MOVEL     NEV(6)        NARREV
     C                   SETON                                        38                       04853
1207 C                   MOVE      'A'           AKY(3)
1208 C                   MOVEA     DLST          AKY(4)
1209 C                   MOVEA     '    '        AKY(6)
1210 C                   MOVE      'A'           AKY(10)
1211 C                   Z-ADD     WORKTP        KYAMT
1212 C                   Z-ADD     EVCD          KYDAT
1213 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
1214 C                   Z-ADD     MDST          KYSETL
1215 C                   MOVE      OMDA          KYOSTL
     C* FOR A DEPOSIT ACCEPTED THE PAY BRANCH IS EQUIVALENT TO         d
     C* MATURITY DATE BRANCH                                            pay
     C     DTYP          IFEQ      'IP'                                                        BHF85
     C     DTYP          OREQ      'TI'                                                        BHF85
     C     DTYP          OREQ      'LN'                                                        BHF85
     C     DTYP          OREQ      'CL'                                                        BHF85
     C     DTYP          OREQ      'DL'                                                        BHF85
     C     DTYP          OREQ      'IL'                                                        S0135
0962 C                   MOVE      ROBR          KYSTBR                                        BHF85
0962 C                   ELSE                                                                  BHF85
     C*
0962 C                   MOVE      POBR          KYSTBR                                        S0111
0962 C                   END                                                                   BHF85
     C*                                                                   S01117
     C                   MOVE      PRFC          OPPRFC                                        S0112
1216 C*
1217 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1218 C*
1219 C                   EXSR      FEDAT
1220 C*
1221 C                   Z-ADD     PAMT          NRRPUR                                        E4372
1221 C                   Z-ADD     KYAMT         NRRSAL                                        E4372
1222 C                   SETON                                        71
1223 C                   EXSR      EXCP
     C                   SETOFF                                       38                       04853
1224 C     AIAP          ADD       AIAN          AIAP
     C/COPY WNCPYSRC,DL0280C494
1225 C     AIPD          ADD       WORKTP        AIPD
1226 C                   Z-ADD     0             AIAN
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     FSAIAN        ADD       FSAINN        FSAIAN
     C     FSAIPN        ADD       WKNTRP        FSAIPN
     C                   Z-ADD     0             FSAINN
     C                   ENDIF
      *                                                                   CDL006
      ** If Feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Accrued Commission.                                           CDL006
      *                                                                   CDL006
     C     BNACCO        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Commission due on Fiduciary Fixed term deposit.               CDL006
      *                                                                   CDL006
     C     WUFIDE        IFEQ      'D'                                                         CDL00
     C     DTYP          ANDEQ     'FT'                                                        CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
     C     WUFIDE        OREQ      'L'                                                         CDL00
     C     DTYP          ANDEQ     'FT'                                                        CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** Build Accrued commission Account Key.                            CDL006
      *                                                                   CDL006
     C                   MOVE      'A'           AKY(3)                                        CDL00
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
     C                   MOVE      'C'           AKY(10)                                       CDL00
      *                                                                   CDL006
      **  Calculate accrued commission amount not yet posted.             CDL006
      *                                                                   CDL006
      **      FCMA                                                        CDL006
      **  (-----------)  x  (EVCD - IACD) + FACTC - FACPD                 CDL006
      **   MDAT - VDAT                                                    CDL006
      *                                                                   CDL006
     C                   Z-ADD     IACD          WUDBEG                                        CDL00
     C                   Z-ADD     EVCD          WUDEND                                        CDL00
     C                   EXSR      COMCAL                                                      CDL00
     C     WUACSC        ADD       FACTC         KYAMT                                         CDL00
     C                   SUB       FACPD         KYAMT                                         CDL00
      *                                                                   CDL006
      ** Generate Accrued commission Account Key.                         CDL006
      *                                                                   CDL006
     C                   EXSR      EXCP                                                        CDL00
      *                                                                   CDL006
      ** Update field FACPD ("Accrued Commission posted to date").        CDL006
      *                                                                   CDL006
     C                   ADD       KYAMT         FACPD                                         CDL00
     C                   MOVE      'Y'           WUDXUP                                        CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C194                                           S01408
      *                                                                   CAC001
      ** Calculate COF Accrued not yet Posted                             CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Get effective Funding Rate                                       CAC001
      *                                                                   CAC001
     C                   SELECT                                                                CAC00
     C     FSGN          WHENEQ    '+'                                                         CAC00
     C     INTR          ADD       FSRP          WEFFR                                         CAC00
     C     FSGN          WHENEQ    '-'                                                         CAC00
     C     INTR          SUB       FSRP          WEFFR                                         CAC00
     C     FSGN          WHENEQ    ' '                                                         CAC00
     C                   Z-ADD     FSRP          WEFFR                                         CAC00
     C                   ENDSL                                                                 CAC00
      *                                                                   CAC001
     C                   Z-ADD     FCTD          ZIBEG                                         CAC00
     C                   Z-ADD     WEFFR         ZIRATE                            CALCULATED  CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C     WKINT         ADD       ACDA          WORKTD                                        CAC00
     C                   ADD       ACAP          WORKTD                                        CAC00
     C                   ADD       ACAN          WORKTD                                        CAC00
     C     WORKTD        SUB       ACPD          WORKTP                                        CAC00
      *                                                                   CAC001
      ** Generate the following Accrual Date Account keys.                CAC001
      *                                                                   CAC001
      ** Cost of Fund not yet posted - Transaction Profit Centre          CAC001
      *                                                                   CAC001
     C                   MOVE      'A'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   Z-ADD     WORKTP        KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Fund not yet posted - Funding Profit Centre              CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
      ** Update Deals file                                                CAC001
      *                                                                   CAC001
     C                   ADD       ACAN          ACAP                                          CAC00
     C                   ADD       WORKTP        ACPD                                          CAC00
     C                   Z-ADD     0             ACAN                                          CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST=Y      CAC00
      *                                                                   CAC001
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1227 C                   GOTO      EOJ
1228 C*
     C/COPY WNCPYSRC,DL0280C567
1229 C********************************************************************
1231 C*****    NEGSLD IS THE FIRST TAG IN THE SECTION THAT HANDLES
1232 C*          NEG.ASSETS SOLD PROCESSING.
1233 C*
1234 C     NEGSLD        TAG                                                    ** NEGSLD TAG *
     C/COPY WNCPYSRC,DL0280C590
1235 C                   Z-ADD     INTR          NARRAT
     C/COPY WNCPYSRC,DL0280C591
1237 C   47              TESTB     '0'           ACEI                 53
     C   47
1238 CAN 53              GOTO      EOJ                                           REVERSAL
1239 C  N47DDAT          COMP      EVCD                               53
     C  N47
1240 CAN 53              GOTO      EOJ
1241 C  N47              TESTB     '0'           ACEI                     53
     C  N47
1242 CAN 53              GOTO      NEGVD
1243 C*
1244 C*****    DEAL DATE PROCESSING REQUIRED
1245 C*
1246 C                   MOVEL     NEV(1)        NARREV
1247 C                   MOVE      'D'           AKY(3)
1248 C                   MOVEA     DLST          AKY(4)
1249 C                   MOVEA     '    '        AKY(6)
1250 C                   MOVE      'A'           AKY(10)
1251 C                   Z-ADD     PAMT          KYAMT
1252 C                   Z-ADD     DDAT          KYDAT
1253 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
1254 C                   Z-ADD     SETPDL        KYSETL
1255 C                   MOVE      OSACDL        KYOSTL
1255 C                   MOVE      ROBR          KYSTBR                                        S0111
1255 C                   MOVE      PRFC          OPPRFC                                        S0111
1256 C*
1257 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1258 C*
1259 C                   EXSR      FEDAT
1260 C*
1261 C                   Z-ADD     KYAMT         NRRPUR
1262 C                   SETON                                        71
1263 C                   EXSR      EXCP
1264 C                   BITON     '0'           ACEI
1265 C   47              GOTO      EOJ                                           REVERSAL
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1266 C*
1267 C*****    NEGVD IS A ROUTINE TO HANDLE VALUE DATE PROCESSING.
1268 C*              FOR NEG.ASS. SOLD
1269 C*
1270 C     NEGVD         TAG                                                    **  NEGVD TAG *
1272 C                   TESTB     '1'           ACEI                     53      VDATE
1273 C  N53VDAT          COMP      EVCD                               53         PROCESSING NOT
1274 C   53              GOTO      EOJ                                           REQUIRED
1275 C                   MOVEL     NEV(2)        NARREV
1276 C                   MOVE      'V'           AKY(3)
1277 C                   MOVEA     DLST          AKY(4)
1278 C                   MOVEA     '    '        AKY(6)
1279 C                   MOVE      'A'           AKY(10)
1280 C                   Z-ADD     PAMT          KYAMT
1281 C                   Z-ADD     VDAT          KYDAT
1282 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
1283 C                   Z-ADD     SETPDL        KYSETL
1284 C                   MOVE      OSACDL        KYOSTL
1255 C                   MOVE      ROBR          KYSTBR                                        S0111
1255 C                   MOVE      PRFC          OPPRFC                                        S0111
1285 C*
1286 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1287 C*
1288 C                   EXSR      FEDAT
1289 C*
1290 C                   Z-ADD     KYAMT         NRRPUR
1291 C                   SETON                                        71
1292 C                   EXSR      EXCP
      *                                                                                       CAS009
     C                   MOVE      'SAMT'        WCFTP             4                          CAS009
     C                   EXSR      SRMMCF                                                     CAS009
      *                                                                                       CAS009
1293 C                   BITON     '1'           ACEI
1294 C                   MOVE      'M'           RECR
     C                   Z-ADD     AIPD          TOTI                                          E1043
     C                   Z-ADD     0             AIPD                                          E1043
     C                   Z-ADD     0             AITC                                          E1043
     C                   Z-ADD     0             AIAN                                          E1043
     C                   Z-ADD     0             AIAP                                          E1043
     C                   BITOFF    '2'           DNSI                                          E1043
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
     C/COPY WNCPYSRC,DL0280C539
1295 C                   GOTO      EOJ
1296 C*
1297 C********************************************************************
1299 C*****    NAPUR IS THE FIRST TAG IN THE SECTION THAT HANDLES
1300 C*          NEG.ASSETS PURCHASED PROCESSING.
1301 C*
1302 C     NAPUR         TAG                                                    ** NAPUR TAG **
 302 C*
1302 C**  CHECK IF ANY INTEREST HAS BEEN PAID - IF SO THEN PURCHASED INT.
1302 C**  WILL BE ZERO
1302 C     IPRD          COMP      0                                  5353
1302 C                   Z-ADD     PINT          REPINT           13 0
1302 C   53              Z-ADD     0             PINT
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     FSIPRN        COMP      0                                  5353
     C                   Z-ADD     FSPINN        WWPINN           13 0
     C     *IN53         IFEQ      *ON
     C                   Z-ADD     0             FSPINN
     C                   ENDIF
     C                   ENDIF
 302 C*
     C** If NA is parcelled, setup parcel size of the NA purchased        S01378
     C     PCLI          IFEQ      'P'                                                         S0137
     C                   Z-ADD     PPSZ          NARPSZ                                        S0137
     C     *LIKE         DEFINE    PPSZ          NARPSZ                                        S0137
     C                   END                                                                   S0137
     C/COPY WNCPYSRC,DL0280C592
1303 C   48              Z-ADD     INTR          NARRAT
1304 C   49              Z-ADD     0             NARRAT
1304 C                   Z-ADD     PAMT          NRRPUR
1305 C                   EXSR      ASSPDV                                        DEAL/VALUE DAT
     C/COPY WNCPYSRC,DL0280C593
     C     PAMT          SUB       FVAL          PINTR            13 0
     C     PINTR         ADD       DISA          PINTR
1306 C   77
1307 COR 78              GOTO      EOJ
1308 C  N47VDAT          COMP      EVCD                               53
     C  N47
1309 CAN 53              GOTO      EOJ
     C  N47
1310 CAN 48              GOTO      NPINT                                         INT.BEARING
     C  N47
1311 CAN 49              GOTO      NPNISL                                       NON-INT.BEARING
1312 C*
1313 C*****     THIS SECTION HANDLES THE INTEREST PROCESSING
1314 C*          FOR REVERSALS. - NEG.ASSETS PURCHASED INT.BEARING
1315 C*
1317 C                   Z-ADD     MDST          KYSETL
1318 C                   MOVE      OMDA          KYOSTL
1255 C***********          MOVE ROBR      KYSTBR                    S01117E33737
1255 C                   MOVE      POBR          KYSTBR                                        E3373
1255 C                   MOVE      PRFC          OPPRFC                                        S0111
      *                                                                                       221703
      ** DEALSDD Transaction Deletion Reversals                                               221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     CAS001        OREQ      'Y'
     C                   Z-ADD     BJRDNB        KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
      *                                                                                       221703
1319 C   49              GOTO      NPREV2                                       NON-INT.BEARING
     C                   SETON                                        71
     C                   Z-ADD     AIPD          NRRSAL
1346 C**
1347 C**   KEY FOR ACCRUED INTEREST POSTED
1348 C**
1349 C     AIPD          COMP      0                                  16
1350 C   16              MOVE      'A'           AKY(3)
     C  N28
1351 CAN 16              MOVE      'A'           AKY(10)
     C   28
1352 CAN 16              MOVE      'I'           AKY(10)
1353 C   16              Z-ADD     AIPD          KYAMT
     C*    ACCRUAL REVERSALS SHOULD BE VALUED ON RUN DATE
     C                   Z-ADD     BJRDNB        KYDAT                                         S0119
1328 C                   EXSR      FEDAT
1329 C   16              EXSR      EXCP
     C   28
1361 CANN26DPTD          COMP      0                                  1616
     C   28
     CAN 16
1362 CANN26              MOVE      'A'           AKY(3)
     C   28
     CANN27
1363 CAN 16
1364 CANN26              MOVE      'D'           AKY(10)
     C   28
     CANN27
1365 CAN 16
1366 CANN26              Z-ADD     DPTD          KYAMT
     C   28
     CAN 27
1367 CAN 16
1368 CANN26              MOVE      'C'           AKY(10)
     C   28
     CAN 27
1369 CAN 16
1370 CANN26              Z-SUB     DPTD          KYAMT
     C   28                                                                                   CAS009
     CAN 16                                                                                   CAS009
1371 CANN26              MOVE      'Y'           SPRIND                                       CAS009
     C   28
     CAN 16
1371 CANN26              EXSR      EXCP
1372 C     IPRD          COMP      0                                  53
1373 C   53              Z-ADD     IPRD          KYAMT
1374 C   53              MOVE      'I'           AKY(3)
1375 C   53              MOVE      'I'           AKY(10)
1376 C   53              Z-ADD     SLID          KYDAT
 377 C*
 378 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
 379 C*
1380 C   53              EXSR      FEDAT
1381 C   53              EXSR      EXCP
     C   28
1382 CAN 53              MOVE      'R'           AKY(10)
     C   28
1383 CAN 53IPRD          SUB       PINTR         KYAMT
     C   28
1384 CAN 53              EXSR      EXCP
1384 C**
1384 C**    GENERATE KEY FOR REVERSAL OF PURCHASED INTEREST
1384 C**
     C   28
1384 CAN 53              MOVE      'P'           AKY(10)                                       E4326
     C   28
1384 CAN 53              Z-ADD     REPINT        KYAMT                                         E4326
     C   28
1384 CAN 53              EXSR      EXCP                                                        E4326
     C*                                                                   CAC001
     C** If Analytical Accounting module is available, generate the       CAC001
     C** following keys for the reversal of Negotiable Assets Purchased.  CAC001
     C*                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C*                                                                   CAC001
     C     ACPD          IFGT      0                                                           CAC00
      *                                                                   CAC001
      ** Accrued Cost of Fund Posted - Transaction Profit Center          CAC001
      *                                                                   CAC001
     C                   MOVE      'A'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN28         IFEQ      '0'                                                         CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   ELSE                                                                  CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     ACPD          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Accrued Cost of Fund Posted - Funding Profit Center              CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C*                                                                   CAC001
     C                   ENDIF                                                  - ACPD > 0     CAC00
     C*                                                                   CAC001
     C     COFD          IFGT      0                                                           CAC00
      *                                                                   CAC001
      ** Cost of Fund Paid/Received to date - Transaction Profit Centre   CAC001
      *                                                                   CAC001
     C                   MOVE      'I'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     COFD          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Fund Paid/Received to date - Funding Profit Centre       CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C*                                                                   CAC001
     C                   ENDIF                                                  - COFD > 0     CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C*                                                                   CAC001
     C                   ENDIF                                                  - BGN0ST=Y     CAC00
1384 C**
1343 C                   GOTO      EOJ
1344 C*
1345 C*****     NPREV2 IS A ROUTINE TO HANDLE INTEREST REVERSAL FOR
1346 C*          NEG.ASSETS PURCHASED - NON-INTEREST BEARING.
1347 C*
1348 C     NPREV2        TAG                                                    ** NPREV2 TAG *
1349 C     DPTD          COMP      0                                      53                   E4361
1350 C   53              GOTO      EOJ                                                         E4361
     C                   SETON                                        71
1352 C                   MOVE      'A'           AKY(3)
1353 C                   MOVE      'D'           AKY(10)                        DISCOUNT
1354 C                   Z-ADD     DPTD          KYAMT
     C*    ACCRUAL REVERSALS SHOULD BE VALUED ON RUN DATE
     C                   Z-ADD     BJRDNB        KYDAT                                         S0119
1356 C*
1357 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1358 C*
1359 C                   EXSR      FEDAT
1360 C*
1361 C                   Z-ADD     KYAMT         NRRSAL
1362 C                   SETON                                        71
     C                   MOVE      'Y'           SPRIND                                       CAS009
1363 C                   EXSR      EXCP
1364 C                   GOTO      EOJ
1365 C*
1366 C*****    NPINT IS A ROUTINE TO HANDLE NEXT INT.DATE PROCESSING
1367 C*         FOR NEG.ASSETS PURCHASED -  INT. BEARING
1368 C*
1369 C     NPINT         TAG                                                    ** NPINT TAG **
1370 C   41              Z-ADD     NIDT          PARDAT
     C   41              SUB       1             PARDAT                                        S0137
1371 C   41              EXSR      DLAMND
     C   U8              GOTO      EOJ                                                         S0138
     C/COPY WNCPYSRC,DL0280C656
1374 C                   MOVEL     NEV(3)        NARREV
1375 C     NIDT          COMP      SLID                               53
1376 C   53NIDT          COMP      EVCD                                 5353
1377 C  N53              GOTO      NPISL
     C**                                                                  E47186
     C** SKIP INT CALC IF SALE DATE = INT DATE                            E47186
     C     NIDT          COMP      SADT                               53  53                   E4718
     C   53SADT          COMP      0                                  5353                     E4718
     C   53              GOTO      SADTIN                                                      E4718
     C**                                                                  E47186
1378 C                   Z-ADD     NIDT          NIPAR
1379 C                   EXSR      NIDPA
     C/COPY WNCPYSRC,DL0280C594
     C**                                                                  E47186
     C     SADTIN        TAG                                                    *** SADTIN *** E4718
     C**                                                                  E47186
1380 C     IPFR          COMP      ' '                                5353        CHECK FOR
     C     CDL012        IFEQ      'Y'
     C  N53              Z-ADD     NIDT          UGNIDT
     C                   ENDIF
1381 C  N53              Z-ADD     0             NIDT
1382 C  N53              GOTO      NPISL                                        FURTHER INT.
1383 C                   Z-ADD     IBDT          ZDAYNO                           DATES
1384 C                   MOVE      IPFR          ZFREQ
1385 C                   MOVE      PCCY          ZCCY
     C     CEU003        IFEQ      'Y'                                                         CEU00
     C     STCY          ANDNE     *BLANKS                                                     CEU00
     C                   MOVE      STCY          ZCCY                                          CEU00
     C                   ENDIF                                                                 CEU00
1386 C                   Z-ADD     INTF          ZMDAY
     C                   MOVE      BJSLCD        ZLOC                                          S0119
1387 C                   EXSR      ZFREQC                                                      S0119
1388 C                   Z-ADD     ZDAYNO        FREQDN
     C**  ZFREQ MAY RETURN A NON-WORKING DAY FOR FREQ W,F,S,R AND L       S01093
     C**  CHECK WITH ZDATE5 AND GET NEXT WORKING DAY                      S01093
     C     ZFREQ         LOOKUP    FRQ                                    50                   S0109
     C     *IN50         IFEQ      '1'                                          ** IF  001     S0109
     C                   Z-ADD     0             ZNRDYS                                        S0119
     C                   MOVE      BJSLCD        ZLOC                                          S0119
1390 C                   EXSR      ZFWDT                                                       S0119
     C                   ELSE                                                   ** ELS 001     S0109
     C                   Z-ADD     ZDAYNO        ZDYNBR                                        S0109
     C                   END                                                    ** END 001     S0109
1391 C     ZDAYNO        COMP      MDAT                                 53
     C     ZDYNBR        IFNE      *ZERO                                                      255705
     C     ZDYNBR        ANDLE     NIDT                                                       255705
     C                   MOVE      '0'           *IN53                                        255705
     C                   ENDIF                                                                255705
1392 C   53              Z-ADD     FREQDN        IBDT
     C     CDL012        IFEQ      'Y'
     C   53              Z-ADD     NIDT          UGNIDT
     C                   ENDIF
1393 C   53              Z-ADD     ZDYNBR        NIDT                                          S0109
1394 C   53              GOTO      NPINT
1395 C                   Z-ADD     0             IBDT
     C     CDL012        IFEQ      'Y'
     C                   Z-ADD     NIDT          UGNIDT
     C                   ENDIF
1396 C                   Z-ADD     0             NIDT
     C                   Z-ADD     0             INTF                           INT. DAY NUMBER
1397 C                   MOVE      ' '           IPFR
1398 C*
1399 C*****    NPISL IS A ROUTINE TO HANDLE SALE DATE PROCESSING FOR
1400 C*         NEG.ASSETS PURCHASED - INT.BEARING.
1401 C*
1402 C     NPISL         TAG                                                    ** NPISL TAG **
1404 C   41              Z-ADD     SADT          PARDAT
1405 C   41              EXSR      DLAMND
     C   U8              GOTO      EOJ                                                         S0138
1408 C                   TESTB     '3'           ACEI                     53     SALE DATE
1409 C  N53SADT          COMP      0                                      53
1410 C  N53SADT          COMP      EVCD                               53          PROCESSING
1411 C   53              GOTO      NPMAT                                          NOT REQUIRED
1453 C                   SETON                                        71
1454 C                   MOVEL     NEV(5)        NARREV
1455 C**
1456 C**   ACCRUED INTEREST TO POST
1457 C**
1458 C  N28SAPR          ADD       IPRD          WORKTP
1459 C  N28WORKTP        SUB       PAMT          WORKTP
1460 C  N28WORKTP        SUB       AIPD          WORKTP                         ACCRUED TO POST
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     *IN28         ANDEQ     *OFF
     C     SAPR          ADD       FSIPRN        WKNTRP
     C     WKNTRP        SUB       FSPAMT        WKNTRP
     C     WKNTRP        SUB       FSAIPN        WKNTRP
     C                   ENDIF
      *                                                                   CAC001
      ** If Analytical Accounting Module is available, do the following.  CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Calculate COF Accrued not yet posted                             CAC001
      *                                                                   CAC001
     C     *IN28         IFEQ      '0'                                                         CAC00
     C     SAPR          ADD       COFD          WRKTP            13 0                         CAC00
     C                   SUB       PAMT          WRKTP                                         CAC00
     C                   SUB       ACPD          WRKTP                                         CAC00
     C                   ENDIF                                                  -*IN28=0       CAC00
      *                                                                   CAC001
      ** Calculate Cost of Fund Due                                       CAC001
      *                                                                   CAC001
     C     *IN28         IFEQ      '1'                                                         CAC00
      *                                                                   CAC001
     C                   Z-ADD     PAMT          ZIAMT                          INTEREST INCOMECAC00
     C/COPY WNCPYSRC,DL0280C595
     C                   Z-ADD     VDAT          ZIBEG                                         CAC00
     C/COPY WNCPYSRC,DL0280C596
     C                   Z-ADD     SLID          ZIEND                                         CAC00
     C                   Z-ADD     ICBS          ZICALC                                        CAC00
     C                   Z-ADD     FSRP          ZIRATE                                        CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C                   Z-ADD     WKINT         WORKID           13 0                         CAC00
     C                   Z-ADD     SADT          ZIEND                                         CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
     C*                                                                   CAC001
     C** Following lines to calculate accrued interest receivable         CAC001
     C** on sale of interest bearing N.A. when no interest date           CAC001
     C** passed since purchase.                                           CAC001
     C/COPY WNCPYSRC,DL0280C597
     C*                                                                   CAC001
     C     VDAT          COMP      SLID                                 31                     CAC00
     C/COPY WNCPYSRC,DL0280C598
     C     *IN31         IFEQ      '0'                                                         CAC00
     C                   Z-ADD     WKINT         WCOFD            13 0                         CAC00
     C                   ELSE                                                                  CAC00
     C     WKINT         SUB       WORKID        WCOFD                                         CAC00
     C                   ENDIF                                                                 CAC00
     C                   SETOFF                                       31                       CAC00
     C/COPY WNCPYSRC,DL0280C599
      *                                                                   CAC001
     C                   ELSE                                                   -*IN28=0       CAC00
      *                                                                   CAC001
     C                   Z-ADD     SLID          ZIBEG                          POSTED TO DATE CAC00
     C                   Z-ADD     SADT          ZIEND                                         CAC00
     C                   Z-ADD     ICBS          ZICALC                                        CAC00
     C                   Z-ADD     PAMT          ZIAMT                                         CAC00
     C                   Z-ADD     FSRP          ZIRATE                                        CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C                   Z-ADD     WKINT         WCOFD                                         CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -*IN28         CAC00
      *                                                                   CAC001
      ** Generate the following Sale Date Account Keys                    CAC001
      *                                                                   CAC001
      ** Cost of Fund Accrued not yet posted - Transaction Profit Centre  CAC001
      *                                                                   CAC001
     C                   MOVE      'A'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN28         IFEQ      '0'                                                         CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   Z-ADD     WRKTP         KYAMT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C     WKINT         SUB       ACPD          KYAMT                                         CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Fund Accrued not yet posted - Funding Profit Centre      CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST=Y      CAC00
1461 C**
1462 C**   INTEREST INCOME - AIR
1463 C**
1464 C   28              Z-ADD     FVAL          ZIAMT                          INTEREST INCOME
     C/COPY WNCPYSRC,DL0280C600
1465 C   28              Z-ADD     VDAT          ZIBEG
     C/COPY WNCPYSRC,DL0280C601
1466 C   28              Z-ADD     SLID          ZIEND
1467 C   28              Z-ADD     ICBS          ZICALC
1468 C   28              Z-ADD     INTR          ZIRATE
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP78                                           S01408
      *                                                                   S01408
1469 C   28              EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP79                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN28         IFEQ      '1'                                                         06655
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C                   END                                                                   06655
     C*                                                                   066550
1470 C   28              Z-ADD     WKINT         WORKID           13 0
1471 C   28              Z-ADD     SADT          ZIEND
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP80                                           S01408
      *                                                                   S01408
1472 C   28              EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP81                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN28         IFEQ      '1'                                                         06655
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C                   END                                                                   06655
     C*                                                                   066550
 473 C***  FOLLOWING LINES TO CALCULATE ACCRUED INTEREST RECEIVABLE
 474 C***  ON SALE OF INTEREST BEARING N.A. WHEN NO INTEREST DATE
 475 C***  PASSED SINCE PURCHASE.
     C/COPY WNCPYSRC,DL0280C602
1476 C   28VDAT          COMP      SLID                                 31
     C/COPY WNCPYSRC,DL0280C603
     C   28
1477 CANN31              Z-ADD     WKINT         AIR
     C   28
1478 CAN 31WKINT         SUB       WORKID        AIR              13 0
     C                   SETOFF                                       31                       E1012
     C/COPY WNCPYSRC,DL0280C604
1479 C**
1480 C**   N.A.= 'N', ACCRUED YIELD TO DATE - FOR REVERSE ACCRUAL
1481 C**
1482 C  N28              Z-ADD     PAMT          ZIAMT                          ACCRUED YIELD
1483 C  N28              Z-ADD     SLID          ZIBEG                          POSTED TO DATE
1484 C  N28              Z-ADD     SADT          ZIEND
1485 C  N28              Z-ADD     ICBS          ZICALC
1486 C  N28              Z-ADD     YRAT          ZIRATE
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP84                                           S01408
      *                                                                   S01408
1487 C  N28              EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP85                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN28         IFEQ      '0'                                                         06655
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C                   END                                                                   06655
     C*                                                                   066550
1488 C  N28              Z-ADD     WKINT         AYTD             13 0
1489 C  N28              Z-ADD     FVAL          ZIAMT
1490 C  N28              Z-ADD     INTR          ZIRATE
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP86                                           S01408
      *                                                                   S01408
1491 C  N28              EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP87                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN28         IFEQ      '0'                                                         06655
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C                   END                                                                   06655
     C*                                                                   066550
1492 C  N28              Z-ADD     WKINT         AIR
1493 C                   Z-ADD     AIR           NRRSAL
     C                   IF        CAS009 = 'Y' AND FSAMRM = 'N' AND                          CAS009
     C                             FSACAI = 'Y'                                               CAS009
     C                   ELSE                                                                 CAS009
1494 C     DISA          SUB       DPTD          DTP              13 0          DISC. TO POST
     C                   ENDIF                                                                CAS009
1415 C*
1416 C*****    GENERATE SALE DATE ACCOUNT KEYS
 497 C*-------------------------------------------------------------------
1499 C**   THESE APPLY TO ACCUAL DATE - EVENT CODE A, AMOUNT CODES A OR I
1500 C**
1502 C**  FOR NA = 'N', ACCR. INT. TO POST, A/C KEY WITH CODES 'A' & 'A'
1503 C**  FOR NA ='Y', ACCR. INT. TO POST, A/C KEY WITH CODES 'A' & 'I'
1504 C**
1419 C                   MOVE      'A'           AKY(3)
1420 C                   MOVEA     '    '        AKY(6)
1421 C                   MOVEA     DLST          AKY(4)
1508 C  N28              MOVE      'A'           AKY(10)
1509 C   28              MOVE      'I'           AKY(10)
1510 C  N28              Z-ADD     WORKTP        KYAMT
1511 C   28WKINT         SUB       AIPD          KYAMT                          ACCRUED
1424 C                   Z-ADD     SADT          KYDAT                             TO POST
1425 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
1426 C                   Z-ADD     MDST          KYSETL
1427 C                   MOVE      OMDA          KYOSTL
1255 C                   MOVE      ROBR          KYSTBR                                        S0111
1255 C                   MOVE      PRFC          OPPRFC                                        S0111
1428 C*
1429 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1430 C*
1431 C                   EXSR      FEDAT
1432 C*
1433 C                   EXSR      EXCP
1522 C**
1523 C**   NA='Y',ACCR. DATE A/C KEYS EVENT CODE A, AMOUNT CODES C OR D
1524 C**
     C   28
1525 CANN26              Z-ADD     SADT          NPADAT            5 0
     C   28
1526 CANN26              EXSR      NPACCR
1527 C**
 528 C**------------------------------------------------------------------
1529 C**
1530 C**   SALE DATE KEYS
1531 C**   PURCHASE PRICE
1434 C                   MOVE      'S'           AKY(3)
1534 C                   MOVE      'A'           AKY(10)
1435 C                   Z-ADD     PAMT          KYAMT                           PURCHASE PRICE
1536 C  N28
     COR 28
1537 CANN26              EXSR      EXCP
1539 C**
     C   28
1541 CANN26              MOVE      'P'           AKY(10)
     C   28
1542 CANN26              Z-ADD     PINT          KYAMT
     C   28                                                                                   CAS009
1542 CANN26              MOVE      'Y'           SPRIND                                       CAS009
     C   28
1543 CANN26              EXSR      EXCP
1544 C**
1545 C**   INTEREST INCOME APPLIES TO NA ACC. IND = 'N' AND 'Y'
1546 C**
1547 C                   MOVE      'I'           AKY(10)
1548 C                   Z-ADD     AIR           KYAMT
      *                                                                   S01378
      ** If the NA accruals indicator is set to 'Y' then store amount     S01378
      ** and interest rate                                                S01378
     C   28              Z-ADD     KYAMT         NRRSAL                                        S0137
     C   28              Z-ADD     INTR          NARRAT                                        S0137
     C   28              SETON                                        71                       S0137
1549 C                   EXSR      EXCP
      *                                                                   CAC001
      ** Set-up the following Sale Date account keys for Transaction      CAC001
      ** profit centre and Funding profit centre.                         CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Purchase Price - Transaction Profit Centre                       CAC001
      *                                                                   CAC001
     C                   MOVE      'S'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     PAMT          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Purchase Price - Funding Profit Centre                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Funds Due - Transaction Profit Centre                    CAC001
      *                                                                   CAC001
     C                   MOVE      'S'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     WCOFD         KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Funds Due - Funding Profit Centre                        CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST=Y      CAC00
1550 C**
1551 C**   FACE VALUE - NA ACC. IND = 'Y'
1552 C**
1553 C   28              MOVE      'F'           AKY(10)
1554 C   28              Z-ADD     FVAL          KYAMT
1555 C   28              EXSR      EXCP
1556 C**
1557 C**   SALE PROFIT/LOSS
1558 C**
1559 C   28SAPR          SUB       FVAL          NPL              13 0
1560 C   28NPL           SUB       PINT          NPL
1561 C   28NPL           SUB       AIR           NPL
1562 C   28NPL           ADD       DTP           KYAMT                16
     C   28
1563 CANN16              Z-SUB     KYAMT         KYAMT
     C   28
1564 CAN 16              MOVE      'R'           AKY(10)
     C   28
1565 CANN16              MOVE      'L'           AKY(10)
     C   28              MOVE      'Y'           SPRIND                                       CAS009
1566 C   28              EXSR      EXCP
1567 C   28              Z-ADD     0             PINT
     C     CAS005        IFEQ      'Y'
     C     *IN28         ANDEQ     '1'
     C                   Z-ADD     0             FSPINN
     C                   ENDIF
1569 C**   ALSO ZEROISE SAVED VERSION OF PURCHASED INTEREST
     C**   for non parcelled NA's only                                    S01378
1567 C***28****************Z-ADD0         REPINT                          S01378
     C   28
     CANN89              Z-ADD     0             REPINT                                        S0137
     C     CAS005        IFEQ      'Y'
     C     *IN28         ANDEQ     '1'
     C     *IN89         ANDEQ     '0'
     C                   Z-ADD     0             WWPINN
     C                   ENDIF
1568 C**
1569 C**   DISCOUNT/PREMIUM AMOUNT
1570 C**
     C   28
     CANN27
1571 CANN26              MOVE      'E'           AKY(10)                        DISCOUNT
     C   28
     CAN 27
1572 CANN26              MOVE      'C'           AKY(10)                        PREMIUM
     C   28
     CANN27
1573 CANN26              Z-ADD     DISA          KYAMT
     C   28
     CAN 27
1574 CANN26              Z-SUB     DISA          KYAMT
     C   28
1575 CANN26              EXSR      EXCP
1576 C**
1577 C**   REVERSAL
1578 C**
     C   28
1579 CANN26              MOVE      'R'           AKY(3)
     C   28
1580 CANN26              Z-ADD     DTP           KYAMT                  53
     C   28
     CANN53
1581 CANN26              MOVE      'D'           AKY(10)
     C   28
     CAN 53
1582 CANN26              MOVE      'C'           AKY(10)
     C   28
     CAN 53
1583 CANN26              Z-SUB     KYAMT         KYAMT
     C   28                                                                                   CAS009
1584 CANN26              MOVE      'Y'           SPRIND                                       CAS009
     C   28
1584 CANN26              EXSR      EXCP
1585 C**
1586 C**   NET SALE PROFIT/LOSS, EVENT CODE 'R', AMOUNT CODE 'B'
1587 C**
1588 C  N28SAPR          SUB       PAMT          NPL              13 0
1589 C  N28NPL           SUB       AIR           KYAMT                                   S0176
1590 C  N28              MOVE      'R'           AKY(3)
1591 C  N28              MOVE      'B'           AKY(10)
1592 C  N28              EXSR      EXCP
1593 C  N28AIPD          COMP      0                                  53
1594 C**
1595 C**   REVERSE ACCRUAL
     C  N28
1596 CAN 53              MOVE      'R'           AKY(3)
     C  N28
1597 CAN 53              MOVE      'A'           AKY(10)
     C  N28
1598 CAN 53IPRD          SUB       AYTD          KYAMT
     C  N28
1599 CAN 53              EXSR      EXCP
1443 C                   BITON     '3'           ACEI
1444 C                   MOVE      'M'           RECR
     C                   Z-ADD     AIPD          TOTI                                          E1043
     C                   Z-ADD     0             AIPD                                          E1043
     C                   Z-ADD     0             AITC                                          E1043
     C                   Z-ADD     0             AIAN                                          E1043
     C                   Z-ADD     0             AIAP                                          E1043
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSAIPN        FSTOTN
     C                   Z-ADD     0             FSAIPN
     C                   Z-ADD     0             FSAITN
     C                   Z-ADD     0             FSAINN
     C                   Z-ADD     0             FSAIAN
     C                   ENDIF
      *                                                                                       221703
      ** DEALSDD Maturity Reversals - NAP Interest Bearing SOLD                               221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     CAS001        OREQ      'Y'
     C                   Z-ADD     SADT          KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
      *                                                                   CAC001
      **  Update DEALS file                                               CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C                   Z-ADD     ACPD          TCOF                                          CAC00
     C                   Z-ADD     0             ACPD                                          CAC00
     C                   Z-ADD     0             ACDA                                          CAC00
     C                   Z-ADD     0             ACAN                                          CAC00
     C                   Z-ADD     0             ACAP                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   BITOFF    '2'           DNSI                                          E1043
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
     C/COPY WNCPYSRC,DL0280C540
1445 C                   GOTO      NPMAT
1446 C*
1447 C*****    NPNISL IS A ROUTINE TO HANDLE SALE DATE PROCESSING FOR
1448 C*          NEG.ASSETS PURCHASED - NON-INT.BEARING
1449 C*
1450 C     NPNISL        TAG                                                    NPNISL
1452 C   41              Z-ADD     SADT          PARDAT
1453 C   41              EXSR      DLAMND
     C   U8              GOTO      EOJ                                                         S0138
1456 C                   TESTB     '3'           ACEI                     53     SALE DATE
1457 C  N53SADT          COMP      0                                      53
1458 C  N53SADT          COMP      EVCD                               53        PROCESSING NOT
1459 C   53              GOTO      NPNMAT                                       REQUIRED
     C                   SETON                                        71
     C                   MOVEL     NEV(5)        NARREV
1460 C*
1461 C*****    GENERATE SALE DATE ACCOUNT KEYS
1462 C*
1466 C                   Z-ADD     SADT          KYDAT
1467 C*
1468 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1469 C*
1470 C                   EXSR      FEDAT
1471 C*
1627 C**
1628 C**   PURCHASE PRICE, EVENT CODE 'S',AMOUNT CODE 'A'
1629 C**
1472 C                   Z-ADD     PAMT          KYAMT                          PURCHASE PRICE
1473 C                   MOVE      'S'           AKY(3)
1474 C                   MOVE      'A'           AKY(10)
1475 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
1476 C                   Z-ADD     MDST          KYSETL
1477 C                   MOVE      OMDA          KYOSTL
1255 C                   MOVE      ROBR          KYSTBR                                        S0111
1255 C                   MOVE      PRFC          OPPRFC                                        S0111
1636 C*
1637 C** CALCULATE 'NRRSAL' FOR REPORT
1638 C*
1639 C     MDAT          SUB       VDAT          DLDAYS
1640 C     SADT          SUB       VDAT          DYSTD
1641 C     DISA          MULT      DYSTD         WORK15
1642 C     WORK15        DIV(H)    DLDAYS        NRRSAL
1479 C                   EXSR      EXCP
      *                                                                   CAC001
      ** Generate the following Sale Date Account Keys for                CAC001
      ** N.A. Purchases non-interest bearing.                             CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Purchase Price - Transaction Profit Centre                       CAC001
      *                                                                   CAC001
     C                   MOVE      'S'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     PAMT          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Purchase Price - Funding Profit Centre                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST=Y      CAC00
      *                                                                   CAC001
1644 C**   FACE VALUE, NA IND = 'Y'
1645 C                   MOVE      'F'           AKY(10)
1646 C                   Z-ADD     FVAL          KYAMT
1647 C                   EXSR      EXCP
1648 C**   ACCRUAL DATE
1649 C                   Z-ADD     SADT          NPADAT            5 0
1650 C                   EXSR      NPACCR
1651 C**   DISCOUNT ACCRUED TO DATE
1652 C                   Z-ADD     DPTD          KYAMT
1653 C                   MOVE      'S'           AKY(3)
1481 C                   MOVE      'D'           AKY(10)
1484 C                   EXSR      EXCP
1656 C**   OUTSTANDING AMOUNT
1657 C     DISA          SUB       DPTD          KYAMT
1658 C                   MOVE      'R'           AKY(3)
1659 C                   MOVE      'C'           AKY(10)
     C                   MOVE      'Y'           SPRIND                                       CAS009
1660 C                   EXSR      EXCP
1661 C     KYAMT         ADD       SAPR          PL               13 0
1662 C     PL            SUB       FVAL          PL                   16
1663 C   16              MOVE      'P'           AKY(10)
1664 C  N16              MOVE      'L'           AKY(10)
1665 C                   MOVE      'S'           AKY(3)
1666 C   16              Z-ADD     PL            KYAMT
1667 C  N16              Z-SUB     PL            KYAMT
     C                   MOVE      'Y'           SPRIND                                       CAS009
1668 C                   EXSR      EXCP
1488 C                   BITON     '3'           ACEI
1489 C                   MOVE      'M'           RECR
     C                   Z-ADD     AIPD          TOTI                                          E1043
     C                   Z-ADD     0             AIPD                                          E1043
     C                   Z-ADD     0             AITC                                          E1043
     C                   Z-ADD     0             AIAN                                          E1043
     C                   Z-ADD     0             AIAP                                          E1043
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSAIPN        FSTOTN
     C                   Z-ADD     0             FSAIPN
     C                   Z-ADD     0             FSAITN
     C                   Z-ADD     0             FSAINN
     C                   Z-ADD     0             FSAIAN
     C                   ENDIF
      *                                                                                       221703
      ** DEALSDD Maturity Reversals - NAP Non-Interest Bearing SOLD                           221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     CAS001        OREQ      'Y'
     C                   Z-ADD     SADT          KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
      *                                                                   CAC001
      **  Update DEALS file                                               CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C                   Z-ADD     ACPD          TCOF                                          CAC00
     C                   Z-ADD     0             ACPD                                          CAC00
     C                   Z-ADD     0             ACDA                                          CAC00
     C                   Z-ADD     0             ACAN                                          CAC00
     C                   Z-ADD     0             ACAP                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   BITOFF    '2'           DNSI                                          E1043
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
     C/COPY WNCPYSRC,DL0280C541
1490 C                   GOTO      NPNMAT
1491 C*
1492 C*****    NPMAT IS A ROUTINE TO HANDLE MATURITY DATE PROCESSING
1493 C*          FOR NEG.ASSETS PURCHASED - INT. BEARING
1494 C*
1495 C     NPMAT         TAG                                                    ** NPMAT TAG **
1496 C     RECR          COMP      'M'                                    53
1497 C   53              GOTO      EOJ
1498 C   41              Z-ADD     MDAT          PARDAT
1499 C   41              EXSR      DLAMND                                       DEAL
     C   U8              GOTO      EOJ                                            AMENDMENTS   S0138
1502 C                   TESTB     '2'           ACEI                     53     MAT.PROCESSING
1503 C  N53MDAT          COMP      EVCD                               53          NOT REQUIRED
1504 C   53              GOTO      NPIACR
1686 C                   SETON                                        71
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1687 C**
1688 C**   INTEREST FROM VALUE DATE TO MATURITY DATE
1505 C                   Z-ADD     FVAL          ZIAMT
     C/COPY WNCPYSRC,DL0280C605
1690 C   28              Z-ADD     VDAT          ZIBEG
     C/COPY WNCPYSRC,DL0280C606
1507 C                   Z-ADD     MDAT          ZIEND
1508 C                   Z-ADD     ICBS          ZICALC
1509 C                   Z-ADD     INTR          ZIRATE                          INTEREST DUE
1694 C**   ACCRUED INTEREST TO POST
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP82                                           S01408
      *                                                                   S01408
1695 C   28              EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP83                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN28         IFEQ      '1'                                                         06655
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C                   END                                                                   06655
     C/COPY WNCPYSRC,DL0280C607
     C*                                                                   066550
1696 C   28              Z-ADD     WKINT         WORKID
1697 C   28WORKID        SUB       AIPD          AITP             13 0
     C                   Z-ADD     SLID          ZIBEG
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP24                                           S01408
      *                                                                   S01408
1510 C                   EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP25                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
1700 C  N28FVAL          ADD       IPRD          WORKTP                         ACCRUED
1701 C  N28WORKTP        ADD       WKINT         WORKTP                         TO POST
1702 C  N28WORKTP        SUB       PAMT          WORKTP
1703 C  N28WORKTP        SUB       AIPD          WORKTP
     C**   CALCULATE INTEREST DUE AT MATURITY INCLUDING ADJUSTMENTS       E11369
     C                   Z-ADD     IACD          ZIBEG                                         E1136
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP26                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      E1136
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP27                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C     WKINT         ADD       AITC          WKINT                                         E1136
     C                   ADD       AIAN          WKINT                                         E1136
     C                   ADD       AIAP          WKINT                                         E1136
     C                   SUB       IPRD          WKINT                                         E1136
     C                   ADD       SPINT         WKINT                                         E1136
     C**
     C**   INCLUDE MANUAL ADJUSTMENTS TO ACCRUED INTEREST
     C**   TO ACCRUED INTEREST TO POST
     C     AITP          ADD       AIAN          AITP
     C     AITP          ADD       AIAP          AITP
     C     WORKTP        ADD       AIAN          WORKTP
     C     WORKTP        ADD       AIAP          WORKTP
     C     AIAP          ADD       AIAN          AIAP
     C                   Z-ADD     0             AIAN
     C**
1704 C   28WKINT         SUB       PINT          AID              13 0          INT.DUE        E1136
     C                   IF        CAS009 = 'Y' AND FSAMRM = 'N' AND                          CAS009
     C                             FSACAI = 'Y'                                               CAS009
     C                   ELSE                                                                 CAS009
1705 C   28DISA          SUB       DPTD          ADTP             13 0          DISA TO POST
     C                   ENDIF                                                                CAS009
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C                   Z-ADD     INTR          WRKINT
     C                   EXSR      SRNTR
      *                                                                                       CAS005
     C                   Z-ADD     FVAL          ZIAMT
     C                   Z-ADD     SLID          ZIBEG
     C                   Z-ADD     MDAT          ZIEND
     C                   Z-ADD     ICBS          ZICALC
     C                   Z-ADD     WKINTR        ZIRATE
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
     C     *IN28         IFEQ      *ON
     C     FVAL          ADD       FSIPRN        WKNTRP
     C     WKNTRP        ADD       WINTST        WKNTRP
     C     WKNTRP        SUB       PAMT          WKNTRP
     C     WKNTRP        SUB       FSAIPN        WKNTRP
     C                   ENDIF
      *                                                                                       CAS005
      ** Calculate Interest due at Maturity including adjustments                             CAS005
      *                                                                                       CAS005
     C                   Z-ADD     IACD          ZIBEG
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
     C     WINTST        ADD       FSAITN        WINTST
     C                   ADD       FSAINN        WINTST
     C                   ADD       FSAIAN        WINTST
     C                   SUB       FSIPRN        WINTST
     C                   ADD       SPINT         WINTST
      *                                                                                       CAS005
     C     WKNTRP        ADD       FSAINN        WKNTRP
     C     WKNTRP        ADD       FSAIAN        WKNTRP
     C     FSAIAN        ADD       FSAINN        FSAIAN
     C                   Z-ADD     0             FSAINN
      *                                                                                       CAS005
     C     *IN28         IFEQ      *ON
     C     WINTST        SUB       FSPINN        WAID             13 0
     C                   ENDIF
     C                   ENDIF
1515 C*
1516 C*****     GENERATE MATURITY DATE ACCOUNT KEYS.
1517 C*
1519 C                   MOVEL     NEV(4)        NARREV
1520 C                   MOVE      'M'           AKY(3)
1521 C                   Z-ADD     MDAT          KYDAT
1522 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
1523 C                   Z-ADD     MDST          KYSETL
1524 C                   MOVE      OMDA          KYOSTL
1255 C                   MOVE      ROBR          KYSTBR                                        S0111
1255 C                   MOVE      PRFC          OPPRFC                                        S0111
1525 C*
1526 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1527 C*
1528 C                   EXSR      FEDAT
1529 C*
1530 C                   Z-ADD     PAMT          KYAMT                           PURCHASE AMT.
1531 C                   MOVE      'A'           AKY(10)
1532 C                   MOVEA     '    '        AKY(6)
1533 C                   MOVEA     DLST          AKY(4)
1534 C                   Z-ADD     FVAL          NRRPUR
1725 C  N28              Z-ADD     WKINT         NRRSAL
     C   28
1726 CANN26              Z-ADD     AID           NRRSAL
     C   28
1727 CAN 26TOTI          SUB       IPRD          NRRSAL
     C  N28                                                                                    S0137
     COR 28
     CANN26              EXSR      EXCP                                                        S0137
1730 C**   INTEREST TO POST
1731 C  N28WKINT         ADD       FVAL          KYAMT                                         E1136
     C   28
1732 CANN26WKINT         ADD       FVAL          KYAMT                                         E1136
     C   28
1733 CAN 26TOTI          SUB       IPRD          KYAMT
     C   28
1734 CAN 26KYAMT         ADD       FVAL          KYAMT
1537 C                   MOVE      'B'           AKY(10)                         INT.DUE
1538 C                   EXSR      EXCP
      *                                                                                       CAS009
     C                   MOVE      'MAMT'        WCFTP             4                          CAS009
     C                   EXSR      SRMMCF                                                     CAS009
      *                                                                                       CAS009
1539 C                   MOVE      'I'           AKY(10)
1738 C  N28              Z-ADD     WKINT         KYAMT                            INTEREST DUE E1136
     C   28
1739 CANN26              Z-ADD     AID           KYAMT
     C   28
1740 CAN 26TOTI          SUB       IPRD          KYAMT
1544 C                   EXSR      EXCP
1742 C**   FACE VALUE MINUS PUR. PRICE
1743 C  N28FVAL          SUB       PAMT          KYAMT
1744 C  N28              MOVE      'D'           AKY(10)
1745 C  N28              EXSR      EXCP
1746 C**   FACE VALUE
1747 C   28              MOVE      'F'           AKY(10)
1748 C   28              Z-ADD     FVAL          KYAMT
1749 C   28              EXSR      EXCP
1750 C**   PURCHASED INTEREST - EXCEPT 'C1'
     C   28
1751 CANN26              MOVE      'P'           AKY(10)
     C   28
1752 CANN26              Z-ADD     PINT          KYAMT
     C   28
1753 CANN26              EXSR      EXCP
1754 C   28              Z-ADD     0             PINT
     C     CAS005        IFEQ      'Y'
     C     *IN28         ANDEQ     '1'
     C                   Z-ADD     0             FSPINN
     C                   ENDIF
     C   28
     CANN27
1755 CANN26              MOVE      'E'           AKY(10)
     C   28
     CAN 27
1756 CANN26              MOVE      'C'           AKY(10)
     C   28
     CANN27
1757 CANN26              Z-ADD     DISA          KYAMT
     C   28
     CAN 27
1758 CANN26              Z-SUB     DISA          KYAMT
     C   28
1759 CANN26              EXSR      EXCP
1760 C**   ACCRUAL DATE - ACCRUED TO POST
1548 C                   MOVE      'A'           AKY(3)                          ACCRUAL
1762 C  N28              MOVE      'A'           AKY(10)                             DATE
1763 C   28              MOVE      'I'           AKY(10)
1764 C  N28              Z-ADD     WORKTP        KYAMT
     C   28
1765 CANN26              Z-ADD     AITP          KYAMT                          INTEREST
     C   28
1766 CAN 26TOTI          SUB       AIPD          KYAMT                          TO POST
1551 C                   EXSR      EXCP
     C/COPY WNCPYSRC,DL0280C537
     C   28
1768 CANN26              MOVE      'A'           AKY(3)
     C   28
1769 CANN26              Z-ADD     ADTP          KYAMT                  16
     C   28
     CAN 16
1770 CANN26              Z-SUB     KYAMT         KYAMT
     C   28
     CAN 27
1771 CANN26              MOVE      'C'           AKY(10)
     C   28
     CANN27
1772 CANN26              MOVE      'D'           AKY(10)
     C   28                                                                                   CAS009
1773 CANN26              MOVE      'Y'           SPRIND                                       CAS009
     C   28
1773 CANN26              EXSR      EXCP
1552 C                   BITON     '2'           ACEI
1553 C                   MOVE      'M'           RECR
     C                   Z-ADD     AIPD          TOTI                                          E1043
     C                   Z-ADD     0             AIPD                                          E1043
     C                   Z-ADD     0             AITC                                          E1043
     C                   Z-ADD     0             AIAN                                          E1043
     C                   Z-ADD     0             AIAP                                          E1043
     C                   BITOFF    '2'           DNSI                                          E1043
1776 C  N28IPRD          ADD       WKINT         IPRD
1777 C  N28IPRM          ADD       WKINT         IPRM
     C   28
1778 CANN26IPRD          ADD       AID           IPRD
     C   28
1779 CANN26IPRM          ADD       AID           IPRM
     C   28
1780 CAN 26IPRM          ADD       TOTI          IPRM
     C   28
1781 CAN 26IPRM          SUB       IPRD          IPRM
     C   28
1782 CAN 26              Z-ADD     TOTI          IPRD
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSAIPN        FSTOTN
     C                   Z-ADD     0             FSAIPN
     C                   Z-ADD     0             FSAITN
     C                   Z-ADD     0             FSAINN
     C                   Z-ADD     0             FSAIAN
     C     *IN28         IFEQ      *OFF
     C     FSIPRN        ADD       WINTST        FSIPRN
     C     FSIPMN        ADD       WINTST        FSIPMN
     C                   ENDIF
     C     *IN28         IFEQ      *ON
     C     *IN26         ANDEQ     *OFF
     C     FSIPRN        ADD       WAID          FSIPRN
     C     FSIPMN        ADD       WAID          FSIPMN
     C                   ENDIF
     C     *IN28         IFEQ      *ON
     C     *IN26         ANDEQ     *ON
     C     FSIPMN        ADD       FSTOTN        FSIPMN
     C     FSIPMN        SUB       FSIPRN        FSIPMN
     C                   Z-ADD     FSTOTN        FSIPRN
     C                   ENDIF
     C                   ENDIF
      *                                                                                       221703
      ** DEALSDD Maturity Reversals - NAP Interest Bearing                                    221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     CAS001        OREQ      'Y'
     C                   Z-ADD     MDAT          KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
      *                                                                   CAC001
      ** Calculate COF Accrued not yet posted                             CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Interest from value date to maturity date                        CAC001
      *                                                                   CAC001
     C                   Z-ADD     PAMT          ZIAMT                                         CAC00
     C     *IN28         IFEQ      '1'                                                         CAC00
     C/COPY WNCPYSRC,DL0280C608
     C                   Z-ADD     VDAT          ZIBEG                                         CAC00
     C/COPY WNCPYSRC,DL0280C609
     C                   ENDIF                                                                 CAC00
     C                   Z-ADD     MDAT          ZIEND                                         CAC00
     C                   Z-ADD     ICBS          ZICALC                                        CAC00
     C                   Z-ADD     FSRP          ZIRATE                                        CAC00
      *                                                                   CAC001
      ** Accrued COF to Post                                              CAC001
      *                                                                   CAC001
     C     *IN28         IFEQ      '1'                                                         CAC00
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   ENDIF                                                                 CAC00
     C/COPY WNCPYSRC,DL0280C610
      *                                                                   CAC001
     C                   Z-ADD     WKINT         WORKID                                        CAC00
     C     WORKID        SUB       ACPD          ACTP             13 0                         CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  *IN28='1'      CAC00
      *                                                                   CAC001
     C                   Z-ADD     SLID          ZIBEG                                         CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C     *IN28         IFEQ      '0'                                                         CAC00
     C     FVAL          ADD       COFD          WRKTP                                         CAC00
     C                   ADD       WKINT         WRKTP                                         CAC00
     C                   SUB       PAMT          WRKTP                                         CAC00
     C                   SUB       ACPD          WRKTP                                         CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      ** Calculate COF interest due at maturity including adjustments     CAC001
      *                                                                   CAC001
     C                   Z-ADD     IACD          ZIBEG                                         CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C                   ADD       ACDA          WKINT                                         CAC00
     C                   ADD       ACAN          WKINT                                         CAC00
     C                   ADD       ACAP          WKINT                                         CAC00
     C                   SUB       COFD          WKINT                                         CAC00
     C                   ADD       SPINT         WKINT                                         CAC00
      *                                                                   CAC001
      ** Include manual adjustments to accrued COF interest               CAC001
      ** to accrued COF interest to post.                                 CAC001
      *                                                                   CAC001
     C                   ADD       ACAN          ACTP                                          CAC00
     C                   ADD       ACAP          ACTP                                          CAC00
     C                   ADD       ACAN          WRKTP                                         CAC00
     C                   ADD       ACAP          WRKTP                                         CAC00
     C                   ADD       ACAN          ACAP                                          CAC00
     C                   Z-ADD     0             ACAN                                          CAC00
      *                                                                   CAC001
     C     *IN28         IFEQ      '1'                                                         CAC00
     C     WKINT         SUB       PINT          CAID             13 0                         CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      ** Set-up the following maturity date account keys                  CAC001
      *                                                                   CAC001
     C     FPRC          IFNE      *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Cost of Fund Accrued not yet posted - Transaction Profit Centre  CAC001
      *                                                                   CAC001
     C                   MOVE      'A'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN28         IFEQ      '0'                                                         CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   Z-ADD     WORKTP        KYAMT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C     *IN26         IFEQ      '0'                                                         CAC00
     C                   Z-ADD     ACTP          KYAMT                                         CAC00
     C                   ELSE                                                                  CAC00
     C     TCOF          SUB       ACPD          KYAMT                                         CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Fund Accrued not yet posted - Funding Profit Centre      CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Purchase Price - Transaction Profit Centre                       CAC001
      *                                                                   CAC001
     C                   MOVE      'M'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     PAMT          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Purchase Price - Funding Profit Centre                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Funds Due - Transaction Profit Centre                    CAC001
      *                                                                   CAC001
     C                   MOVE      'M'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C     *IN28         IFEQ      '0'                                                         CAC00
     C                   Z-ADD     WKINT         KYAMT                                         CAC00
     C                   ELSE                                                                  CAC00
     C     *IN26         IFEQ      '0'                                                         CAC00
     C                   Z-ADD     CAID          KYAMT                                         CAC00
     C                   ELSE                                                                  CAC00
     C     TCOF          SUB       COFD          KYAMT                                         CAC00
     C                   ENDIF                                                  *IN26          CAC00
     C                   ENDIF                                                  *IN28          CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Funds Due - Funding Profit Centre                        CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Update Deals file                                                CAC001
      *                                                                   CAC001
     C                   Z-ADD     ACPD          TCOF                                          CAC00
     C                   Z-ADD     0             ACPD                                          CAC00
     C                   Z-ADD     0             ACDA                                          CAC00
     C                   Z-ADD     0             ACAN                                          CAC00
     C                   Z-ADD     0             ACAP                                          CAC00
     C     *IN28         IFEQ      '0'                                                         CAC00
     C                   ADD       WKINT         COFD                                          CAC00
     C                   ADD       WKINT         COFM                                          CAC00
     C                   ELSE                                                                  CAC00
     C     *IN26         IFEQ      '0'                                                         CAC00
     C                   ADD       CAID          COFD                                          CAC00
     C                   ADD       CAID          COFM                                          CAC00
     C                   ELSE                                                                  CAC00
     C                   ADD       TCOF          COFM                                          CAC00
     C                   SUB       COFD          COFM                                          CAC00
     C                   Z-ADD     TCOF          COFD                                          CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -FPRC          CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST        CAC00
      *                                                                   CAC001
     C/COPY WNCPYSRC,DL0280C542
1556 C                   GOTO      NPIACR
1557 C*
1558 C*****    NPNMAT IS A ROUTINE TO HANDLE MATURITY DATE PROCESSING
1559 C*         FOR NEG.ASSETS PURCHASED - NON-INT. BEARING.
1560 C*
1561 C     NPNMAT        TAG                                                    ** NPNMAT TAG *
1562 C     RECR          COMP      'M'                                    53
1563 C   53              GOTO      EOJ
1564 C   41              Z-ADD     MDAT          PARDAT                          DEAL
1565 C   41              EXSR      DLAMND                                          AMENDMENTS
     C   U8              GOTO      EOJ                                                         S0138
1568 C                   TESTB     '2'           ACEI                     53     MAT.PROCESSING
1569 C  N53MDAT          COMP      EVCD                               53         NOT REQUIRED
1570 C   53              GOTO      NPNIAC
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1571 C*
1572 C*****     GENERATE MATURITY DATE ACCOUNT KEYS
1573 C*
     C                   SETON                                        71
1575 C                   MOVEL     NEV(4)        NARREV
1576 C                   MOVE      'M'           AKY(3)
1577 C                   MOVEA     '    '        AKY(6)
1578 C                   MOVEA     DLST          AKY(4)
1579 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
1580 C                   Z-ADD     MDST          KYSETL
1581 C                   MOVE      OMDA          KYOSTL
1255 C                   MOVE      ROBR          KYSTBR                                        S0111
1255 C                   MOVE      PRFC          OPPRFC                                        S0111
1582 C                   Z-ADD     MDAT          KYDAT
1583 C*
1584 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1585 C*
1586 C                   EXSR      FEDAT
1587 C*
1588 C                   MOVE      'A'           AKY(10)                         PURCHASE
1589 C                   Z-ADD     PAMT          KYAMT                             PRICE
1590 C                   Z-ADD     FVAL          NRRPUR
     C                   Z-ADD     DISA          NRRSAL
1592 C                   EXSR      EXCP
1593 C                   MOVE      'F'           AKY(10)                         FACE          E1055
1594 C                   Z-ADD     FVAL          KYAMT                           VALUE
1595 C                   EXSR      EXCP
      *                                                                                       CAS009
     C                   MOVE      'MAMT'        WCFTP             4                          CAS009
     C                   EXSR      SRMMCF                                                     CAS009
      *                                                                                       CAS009
1596 C                   MOVE      'D'           AKY(10)                        FACE VALUE LESS
1597 C     FVAL          SUB       PAMT          KYAMT                           PURCHASE PRICE
1598 C                   EXSR      EXCP
1599 C                   MOVE      'A'           AKY(3)                         DISCOUNT LESS
1600 C                   MOVE      'D'           AKY(10)                         DISCOUNT POSTE
1601 C     DISA          SUB       DPTD          KYAMT                           TO DATE
     C                   MOVE      'Y'           SPRIND                                       CAS009
1602 C                   EXSR      EXCP
      *                                                                                       221703
      ** DEALSDD Maturity Reversals - NAP Non-Interest Bearing                                221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     CAS001        OREQ      'Y'
     C                   Z-ADD     MDAT          KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
      *                                                                   CAC001
      ** Generate the following Maturity Date Account Keys for            CAC001
      ** N.A. Purchases non-interest bearing.                             CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Purchase Price - Transaction Profit Centre                       CAC001
      *                                                                   CAC001
     C                   MOVE      'M'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     PAMT          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Purchase Price - Funding Profit Centre                           CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
      ** Update Deals file                                                CAC001
      *                                                                   CAC001
     C                   Z-ADD     ACPD          TCOF                                          CAC00
     C                   Z-ADD     0             ACPD                                          CAC00
     C                   Z-ADD     0             ACDA                                          CAC00
     C                   Z-ADD     0             ACAN                                          CAC00
     C                   Z-ADD     0             ACAP                                          CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST=Y      CAC00
      *                                                                   CAC001
1603 C                   BITON     '2'           ACEI
1604 C                   MOVE      'M'           RECR
     C                   Z-ADD     AIPD          TOTI                                          E1043
     C                   Z-ADD     0             AIPD                                          E1043
     C                   Z-ADD     0             AITC                                          E1043
     C                   Z-ADD     0             AIAN                                          E1043
     C                   Z-ADD     0             AIAP                                          E1043
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSAIPN        FSTOTN
     C                   Z-ADD     0             FSAIPN
     C                   Z-ADD     0             FSAITN
     C                   Z-ADD     0             FSAINN
     C                   Z-ADD     0             FSAIAN
     C                   ENDIF
      *                                                                                       CAS005
     C                   BITOFF    '2'           DNSI                                          E1043
     C/COPY WNCPYSRC,DL0280C543
1605 C                   GOTO      NPNIAC
1606 C*
1607 C*****    NPIACR IS A ROUTINE TO HANDLE ACCRUAL DATE PROCESSING
1608 C*         FOR NEG.ASSETS PURCHASED - INT.BEARING.
1609 C*
1610 C     NPIACR        TAG                                                    **  NPIACR TAG
1611 C  N52              GOTO      EOJ
1612 C     RECR          COMP      'M'                                    53
1613 C   53              GOTO      EOJ
1614 C     IACD          COMP      EVCD                               53
1615 C   53              GOTO      EOJ
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1616 C                   MOVEL     NEV(6)        NARREV
     C                   SETON                                        71
1618 C                   Z-ADD     IACD          ZIBEG
1619 C                   Z-ADD     EVCD          ZIEND
1620 C  N29ZIEND         ADD       1             ZIEND
1848 C  N28              Z-ADD     PAMT          ZIAMT
1849 C  N28              Z-ADD     YRAT          ZIRATE
1850 C   28              Z-ADD     FVAL          ZIAMT
1851 C   28              Z-ADD     INTR          ZIRATE                         INTEREST
1623 C                   Z-ADD     ICBS          ZICALC                           CALCULATED
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP28                                           S01408
      *                                                                   S01408
1624 C                   EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP29                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
1625 C     WKINT         ADD       AITC          WORKTD                         INT. TO DATE
1855 C**
1856 C**   INCLUDE MANUAL ADJUSTMENTS
1857 C     WORKTD        ADD       AIAN          WORKTD
1858 C     WORKTD        ADD       AIAP          WORKTD
1859 C**
1626 C     WORKTD        SUB       AIPD          WORKTP                         INT. TO POST
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     *IN28         IFEQ      *OFF
     C                   Z-ADD     YRAT          WRKINT
     C                   Z-ADD     PAMT          ZIAMT
     C                   ELSE
     C                   Z-ADD     INTR          WRKINT
     C                   Z-ADD     FVAL          ZIAMT
     C                   ENDIF
     C                   EXSR      SRNTR
     C                   Z-ADD     IACD          ZIBEG
     C                   Z-ADD     EVCD          ZIEND
     C     *IN29         IFEQ      *OFF
     C     ZIEND         ADD       1             ZIEND
     C                   ENDIF
     C                   Z-ADD     ICBS          ZICALC
     C                   Z-ADD     WKINTR        ZIRATE
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
     C     WINTST        ADD       FSAITN        WKNTRD
     C     WKNTRD        ADD       FSAINN        WKNTRD
     C     WKNTRD        ADD       FSAIAN        WKNTRD
     C     WKNTRD        SUB       FSAIPN        WKNTRP
     C                   ENDIF
1627 C*
1628 C*****    GENERATE ACCRUAL DATE ACCOUNT KEY.
1629 C*
     C** Check NA accruals flag                                           S01378
1630 C  N28              Z-ADD     YRAT          NARRAT
     C   28              Z-ADD     INTR          NARRAT                                        S0137
1631 C                   MOVE      'A'           AKY(3)
1632 C                   MOVEA     '    '        AKY(6)
1633 C                   MOVEA     DLST          AKY(4)
1868 C  N28              MOVE      'A'           AKY(10)
1869 C   28              MOVE      'I'           AKY(10)
1735 C                   Z-ADD     WORKTP        KYAMT
1636 C                   Z-ADD     EVCD          KYDAT
1637 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
1638 C                   Z-ADD     MDST          KYSETL
1639 C                   MOVE      OMDA          KYOSTL
1255 C                   MOVE      ROBR          KYSTBR                                        S0111
1255 C                   MOVE      PRFC          OPPRFC                                        S0111
1640 C*
1641 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1642 C*
1643 C                   EXSR      FEDAT
1644 C*
1645 C                   Z-ADD     KYAMT         NRRSAL
     C                   Z-ADD     PAMT          NRRPUR
1647 C                   EXSR      EXCP
1883 C**
1884 C**   ADJUST INTEREST ADJUSTMENT POSTED & NOT POSTED
1885 C     AIAP          ADD       AIAN          AIAP
1886 C                   Z-ADD     0             AIAN
1887 C**
1648 C     AIPD          ADD       WORKTP        AIPD
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     FSAIAN        ADD       FSAINN        FSAIAN
     C                   Z-ADD     0             FSAINN
     C     FSAIPN        ADD       WKNTRP        FSAIPN
     C                   ENDIF
      *                                                                                       CAS005
     C   28
1889 CANN26              Z-ADD     EVCD          NPADAT            5 0
     C   28
1890 CANN26              SETON                                        17
     C   28
1891 CANN26              EXSR      NPACCR                                       ACCRUAL DATE
     C   28
1892 CANN26              SETOFF                                       17        PROCESSING
      *                                                                   CAC001
      ** For Negotiable Assets Purchased - Interest Bearing, do the       CAC001
      ** following calculations.                                          CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
     C                   Z-ADD     IACD          ZIBEG                                         CAC00
     C                   Z-ADD     EVCD          ZIEND                                         CAC00
     C     *IN29         IFEQ      '0'                                                         CAC00
     C     ZIEND         ADD       1             ZIEND                                         CAC00
     C                   ENDIF                                                                 CAC00
     C                   Z-ADD     FSRP          ZIRATE                                        CAC00
     C                   Z-ADD     PAMT          ZIAMT                                         CAC00
     C                   Z-ADD     ICBS          ZICALC                           CALCULATED   CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C     WKINT         ADD       ACDA          WORKTD                         INT. TO DATE   CAC00
      *                                                                   CAC001
      ** Include Manual Adjustments                                       CAC001
      *                                                                   CAC001
     C                   ADD       ACAN          WORKTD                                        CAC00
     C                   ADD       ACAP          WORKTD                                        CAC00
      *                                                                   CAC001
     C     WORKTD        SUB       ACPD          WORKTP                         INT. TO POST   CAC00
      *                                                                   CAC001
      ** Generate the following account keys.                             CAC001
      *                                                                   CAC001
      ** Cost of Fund Accrued not yet posted - Transaction Profit Centre  CAC001
      *                                                                   CAC001
     C                   MOVE      'A'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN28         IFEQ      '0'                                                         CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   ELSE                                                                  CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     WORKTP        KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Fund Accrued not yet posted - Funding Profit Centre      CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
      ** Update Accrued COF adjustment posted and not posted              CAC001
      *                                                                   CAC001
     C                   ADD       ACAN          ACAP                                          CAC00
     C                   Z-ADD     0             ACAN                                          CAC00
      *                                                                   CAC001
      ** Update Accrued COF Posted to Date                                CAC001
      *                                                                   CAC001
     C                   ADD       WORKTP        ACPD                                          CAC00
     C/COPY WNCPYSRC,DL0280C611
     C*                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST='Y'    CAC00
1649 C                   GOTO      EOJ
1650 C*
1651 C*****    NPNIAC IS A ROUTINE TO HANDLE ACCRUAL DATE PROCESSING
1652 C*          FOR NEG.ASSETS PURCHASED - NON-INT.BEARING
1653 C*
1654 C     NPNIAC        TAG
1655 C     RECR          COMP      'M'                                    53
1656 C   53              GOTO      EOJ
1657 C     VDAT          COMP      EVCD                               53
1658 C   53              GOTO      EOJ
     C                   SETON                                        71
1659 C                   MOVEL     NEV(6)        NARREV
     C                   Z-ADD     PAMT          NRRPUR
1660 C                   Z-ADD     EVCD          NPADAT            5 0
     C   52              SETON                                        17
1661 C   52              EXSR      NPACCR                                       ACCRUAL DATE
     C   52              SETOFF                                       17
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C   52              MOVE      '1'           *IN15                                         S0109
1662 C                   GOTO      EOJ                                          INDICATOR ON
1663 C*
1664 C********************************************************************
1665 C*
1666 C****     FXOUTR IS THE FIRST TAG IN THE SECTION THAT HANDLES
1667 C*          PROCESSING OF F/X OUTRIGHTS AND OPTIONS.
     C**         AND NOSTRO TRANSFERS                                     S01108
1668 C*
1669 C     FXOUTR        TAG                                                    ** FXOUTR TAG *
1670 C*
1671 C*****    DEAL DATE PROCESSING
     C**       ALL FX DEAL TYPES EXCEPT NOSTRO TRANSFERS                  S01108
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CCP6                                           S01408
     C*                                                                   S01408
      ** DEALSDB Deletion Reversals (FP,FS,PI,SI,CX,OP,OT,NX)                                 221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     *IN47         ANDEQ     '1'
     C                   MOVE      *IN71         WIN71             1
     C     DTYP          IFEQ      'CX'
     C     LNKDN         CHAIN     DLDLHBL0                           71
     C     *IN71         IFEQ      '0'
     C     BLNKDN        CHAIN     DLDLHCL0                           71
     C     *IN71         IFEQ      '0'
     C                   MOVEL     CCCY          KYCCY
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   Z-ADD     BJRDNB        KYDAT
     C                   EXSR      SRUREL
     C                   MOVE      WIN71         *IN71
     C                   ENDIF
      *                                                                                       221703
     C     DTYP          IFNE      'NX'                                         ** IF  001     S0110
1672 C*
1673 C     PCCY          COMP      BJCYCD                                 65                   S0119
1674 C     SLCY          COMP      BJCYCD                                 66                   S0119
1675 C                   Z-ADD     EXRT          NARRAT
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CCP2                                           S01408
     C*                                                                   S01408
1676 C     DTYP          COMP      'OT'                                   53
1677 C   53              GOTO      FXOUTV
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CCP3                                           S01408
     C*                                                                   S01408
1678 C   47              TESTB     '0'           ACEI                 53
     C/COPY WNCPYSRC,DL0280C012
     C   47
1679 CAN 53              GOTO      FXOUTA                                                      S0144
1680 C  N47DDAT          COMP      EVCD                               53
     C/COPY WNCPYSRC,DL0280C013
     C  N47
1681 CAN 53              GOTO      EOJ
1682 C  N47              TESTB     '0'           ACEI                     53
     C/COPY WNCPYSRC,DL0280C014
     C  N47
1683 CAN 53              GOTO      FXOUTA                                                      S0144
1684 C                   MOVE      'D'           AKY(3)
1685 C                   MOVEL     NEV(1)        NARREV
1686 C                   Z-ADD     DDAT          KYDAT
     C/COPY WNCPYSRC,DL0280C047
1687 C                   EXSR      FXDV
1688 C                   BITON     '0'           ACEI
     C                   ELSE                                                                  E1522
     C                   Z-ADD     1             NARRAT                                        E1552
     C                   END                                                    ** END 001     S0110
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
     C/COPY WNCPYSRC,DL0280C015
      *                                                                   S01440
      ** FXOUTA is a routine to handle PI and SI accrual date processing  S01440
      *                                                                   S01440
     C     FXOUTA        TAG                                                    ** FXOUTA TAG *S0144
      *                                                                   S01440
      ** If the accruals on interest outrights flag on the dealing        S01440
      ** I.C.D. is on,                                                    S01440
      *                                                                   S01440
     C     BNAOIO        IFEQ      'Y'                                                         S0144
     C/COPY WNCPYSRC,DL0280C564
      *                                                                   S01440
      ** If the accrual date processing is not required and the           S01440
      ** deal is not a reversal, then skip to value date processing       S01440
      *                                                                   S01440
     C     ACRIND        IFNE      'Y'                                                         S0144
     C     *IN47         ANDNE     '1'                                                         S0144
     C                   GOTO      FXOUTV                                                      S0144
     C                   END                                                                   S0144
      *                                                                   S01440
      ** If the run date is greater than or equal to the deal date        S01440
      ** and less than or equal to the value date and the deal type       S01440
      ** is 'PI' or 'SI'                                                  S01440
      *                                                                   S01440
     C     BJRDNB        IFGE      DDAT                                                        S0144
     C     BJRDNB        ANDLE     VDAT                                                        S0144
     C/COPY WNCPYSRC,DL0280C565
     C     DTYP          IFEQ      'PI'                                                        S0144
     C     DTYP          OREQ      'SI'                                                        S0144
     C                   MOVE      'A'           AKY(3)                                        S0144
     C                   MOVEL     NEV(6)        NARREV                                        S0144
      *                                                                   S01440
      ** If the value date is greater than the event control date         S01440
      ** set the event date on PF/DKEYSDP to the event control date       S01440
      ** otherwise set to value date                                      S01440
      *                                                                   S01440
     C     VDAT          IFGT      EVCD                                                        S0144
     C                   Z-ADD     EVCD          KYDAT                                         S0144
     C                   ELSE                                                                  S0144
     C                   Z-ADD     VDAT          KYDAT                                         S0144
     C                   END                                                                   S0144
      *                                                                   S01440
      ** If deal is a reversal                                            S01440
      *                                                                   S01440
     C     *IN47         IFEQ      '1'                                                         S0144
     C                   EXSR      GNPISI                                                      S0144
     C                   MOVE      '1'           *IN71                                         S0144
     C                   Z-ADD     KYAMT         NRRPUR                                        S0144
     C                   Z-ADD     KYOTH         NRRSAL                                        S0144
     C                   MOVEL     PCCY          SAVCCY            3                           S0144
     C                   MOVEL     KYCCY         PCCY                                          S0144
     C                   MOVEL     RSCY          SAVSCY            3                           CEU00
     C                   MOVEL     KYSCY         RSCY                                          CEU00
     C                   EXSR      EXCP                                                        S0144
     C                   MOVEL     SAVSCY        RSCY                                          CEU00
     C                   MOVEL     SAVCCY        PCCY                                          S0144
     C*                                                                   S01440
     C     VDAT          IFGT      EVCD                                                        S0144
     C                   GOTO      EOJ                                                         S0144
     C                   END                                                                   S0144
     C*                                                                   S01440
     C                   ELSE                                                                  S0144
     C                   EXSR      CALCCP                                                      S0144
      *                                                                   S01440
      ** Set on deal update flag, generate value date account keys        S01440
      ** and output DKEYS record                                          S01440
      *                                                                   S01440
     C                   MOVE      '1'           *IN15                                         S0144
     C                   EXSR      GNPISI                                                      S0144
     C                   MOVE      '1'           *IN71                                         S0144
     C                   Z-ADD     KYAMT         NRRPUR                                        S0144
     C                   Z-ADD     KYOTH         NRRSAL                                        S0144
     C                   MOVEL     PCCY          SAVCCY                                        S0144
     C                   MOVEL     KYCCY         PCCY                                          S0144
     C                   MOVEL     RSCY          SAVSCY            3                           CEU00
     C                   MOVEL     KYSCY         RSCY                                          CEU00
     C                   EXSR      EXCP                                                        S0144
     C                   MOVEL     SAVSCY        RSCY                                          CEU00
     C                   MOVEL     SAVCCY        PCCY                                          S0144
     C*                                                                   S01440
     C     VDAT          IFGT      EVCD                                                        S0144
     C                   GOTO      EOJ                                                         S0144
     C                   END                                                                   S0144
     C*                                                                   S01440
     C                   END                                                                   S0144
     C*                                                                   S01440
     C                   END                                                                   S0144
     C                   END                                                                   S0144
     C                   END                                                                   S0144
     C*                                                                   S01440
1689 C*                                                                   S01440
     C/COPY WNCPYSRC,DL0280C671
1689 C*
1690 C*****    FXOUTV IS A ROUTINE TO HANDLE VALUE DATE PROCESSING
1691 C*          FOR FX OUTRIGHTS AND OPTIONS
1692 C*
1693 C     FXOUTV        TAG                                                    ** FXOUTV TAG *
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C127                                           S01408
      *                                                                                       CDL099
     C     CDL099        IFEQ      'Y'                                                        CDL099
      *                                                                                       CDL099
     C******IN47         IFEQ      '1'                                               CDL099 MD053800
     C**********         GOTO      EOJ                                               CDL099 MD053800
     C**********         ENDIF                                                       CDL099 MD053800
      *                                                                                       CDL099
     C                   MOVEL     NEV(2)        NARREV                                       CDL099
     C     DTYP          COMP      'OP'                                   53                  CDL099
     C   53              GOTO      FXOPMT                                                     CDL099
      *                                                                                       CDL099
     C                   TESTB     '1'           ACEI                     53                  CDL099
     C  N53                                                                                   CDL099
     CANN47VDAT          COMP      EVCD                               53                      CDL099
     C   47                                                                                   CDL099
     CANN53                                                                                   CDL099
     COR 53                                                                                   CDL099
     CANN47              GOTO      #BFXOS                                                     CDL099
      *                                                                                       CDL099
     C                   MOVE      'V'           AKY(3)                                       CDL099
     C                   Z-ADD     VDAT          KYDAT                                        CDL099
      *                                                                                       CDL099
      ** Generate Purchase Value Date Keys.                                                   CDL099
      *                                                                                       CDL099
     C     DTYP          IFEQ      'NX'                                                       CDL099
     C                   EXSR      FXDV                                                       CDL099
     C                   BITON     '1'           ACEI                                         CDL099
     C                   MOVE      'M'           RECR                                         CDL099
     C                   GOTO      EOJ                                                        CDL099
     C                   ELSE                                                                 CDL099
     C                   EXSR      #BFXPV                                                     CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   BITON     '1'           ACEI                                         CDL099
     C                   TESTB     '4'           ACEI                     53                  CDL099
     C   53                                                                                   CDL099
     CANN47              MOVE      'M'           RECR                                         CDL099
      *                                                                                       CDL099
      ** Generate Sale Value Date Keys.                                                       CDL099
      *                                                                                       CDL099
     C     #BFXOS        TAG                                                                  CDL099
      *                                                                                       CDL099
      ** Nostro transfers do not have split value date so skip this                           CDL099
      *                                                                                       CDL099
     C     DTYP          IFEQ      'NX'                                                       CDL099
     C                   GOTO      EOJ                                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   TESTB     '4'           ACEI                     53                  CDL099
     C  N53                                                                                   CDL099
     CANN47BSDT2         COMP      EVCD                               53                      CDL099
     C   47                                                                                   CDL099
     CANN53                                                                                   CDL099
     COR 53                                                                                   CDL099
     CANN47              GOTO      EOJ                                                        CDL099
      *                                                                                       CDL099
     C                   MOVE      'V'           AKY(3)                                       CDL099
     C                   Z-ADD     BSDT2         KYDAT                                        CDL099
     C                   EXSR      #BFXSV                                                     CDL099
      *                                                                                       CDL099
     C                   BITON     '4'           ACEI                                         CDL099
     C                   TESTB     '1'           ACEI                     53                  CDL099
     C   53                                                                                   CDL099
     CANN47              MOVE      'M'           RECR                                         CDL099
     C                   GOTO      #BTAG1                                                     CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
     C*                                                                   S01408
1694 C   47              GOTO      EOJ
1695 C                   MOVEL     NEV(2)        NARREV
1696 C     DTYP          COMP      'OP'                                   53
1697 C   53              GOTO      FXOPMT
1698 C                   TESTB     '1'           ACEI                     53
1699 C  N53VDAT          COMP      EVCD                               53
     C/COPY WNCPYSRC,DL0280C048
1700 C   53              GOTO      EOJ
      *                                                                   S01440
      ** If 'accruals on interest outrights flag' on the dealing          S01440
      ** I.C.D. is on, and the deal type is a 'PI' or 'SI'                S01440
      *                                                                   S01440
     C     BNAOIO        IFEQ      'Y'                                                         S0144
     C     DTYP          IFEQ      'PI'                                                        S0144
     C     DTYP          OREQ      'SI'                                                        S0144
1701 C                   MOVE      'A'           AKY(3)                                        S0144
0949 C                   MOVEL     NEV(2)        NARREV                                        S0144
1702 C                   Z-ADD     VDAT          KYDAT                                         S0144
      *                                                                   S01440
      ** If the deal is a reversal, generate value date account keys      S01440
      *                                                                   S01440
     C     *IN47         IFEQ      '1'                                                         S0144
     C                   EXSR      GNPISI                                                      S0144
     C                   MOVE      '1'           *IN71                                         S0144
     C                   Z-ADD     KYAMT         NRRPUR                                        S0144
     C                   Z-ADD     KYOTH         NRRSAL                                        S0144
     C                   MOVEL     PCCY          SAVCCY                                        S0144
     C                   MOVEL     KYCCY         PCCY                                          S0144
     C                   MOVEL     RSCY          SAVSCY            3                           CEU00
     C                   MOVEL     KYSCY         RSCY                                          CEU00
     C                   EXSR      EXCP                                                        S0144
     C                   MOVEL     SAVSCY        RSCY                                          CEU00
     C                   MOVEL     SAVCCY        PCCY                                          S0144
     C                   ELSE                                                                  S0144
      *                                                                   S01440
      ** If the deal is not a reversal calculate GCSCAP and GCPCAP        S01440
      *                                                                   S01440
     C                   EXSR      CALCCP                                                      S0144
      *                                                                   S01440
      ** Set on deal update flag, generate value date account keys        S01440
      ** and output DKEYS record                                          S01440
      *                                                                   S01440
     C                   MOVE      '1'           *IN15                                         S0144
     C                   EXSR      GNPISI                                                      S0144
     C                   MOVE      '1'           *IN71                                         S0144
     C                   Z-ADD     KYAMT         NRRPUR                                        S0144
     C                   Z-ADD     KYOTH         NRRSAL                                        S0144
     C                   MOVEL     PCCY          SAVCCY                                        S0144
     C                   MOVEL     KYCCY         PCCY                                          S0144
     C                   MOVEL     RSCY          SAVSCY            3                           CEU00
     C                   MOVEL     KYSCY         RSCY                                          CEU00
     C                   EXSR      EXCP                                                        S0144
     C                   MOVEL     SAVSCY        RSCY                                          CEU00
     C                   MOVEL     SAVCCY        PCCY                                          S0144
     C                   END                                                                   S0144
     C                   END                                                                   S0144
     C                   END                                                                   S0144
     C*
     C/COPY WNCPYSRC,DL0280C672
1701 C                   MOVE      'V'           AKY(3)
1702 C                   Z-ADD     VDAT          KYDAT
     C/COPY WNCPYSRC,DL0280C049
1703 C                   EXSR      FXDV
     C/COPY WNCPYSRC,DL0280C050
1704 C                   BITON     '1'           ACEI
1705 C                   MOVE      'M'           RECR
      *                                                                                       CAS005
      ** DEALSDB - Value Date (Maturity) Reversals                                            CAS005
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     VDAT          KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C128                                           S01408
     C     #BTAG1        TAG                                                                  CDL099
     C*                                                                   S01408
     C                   Z-ADD     AIPD          TOTI                                          E1043
     C                   Z-ADD     0             AIPD                                          E1043
     C                   Z-ADD     0             AITC                                          E1043
     C                   Z-ADD     0             AIAN                                          E1043
     C                   Z-ADD     0             AIAP                                          E1043
     C                   BITOFF    '2'           DNSI                                          E1043
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
      *                                                                   CPB001
      **  If Replication Processing required.                             CPB001
     C     REPLIC        IFEQ      'Y'                                          Begin REPLIC   CPB00
     C                   EXSR      SRREPI                                                      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End REPLIC     CPB00
     C/COPY WNCPYSRC,DL0280C026
1706 C                   GOTO      EOJ
1707 C*
1708 C*****    FXOPMT IS A    ROUTINE TO HANDLE THE OPTION MATURITY
1709 C*          DATE PROCESSING FOR OPTION DEALS.
1710 C*
1711 C     FXOPMT        TAG                                                    ** FXOPMT TAG *
1712 C                   TESTB     '2'           ACEI                     53
1713 C**N53***** OTDT      COMP EVCD                 53                                       221703
1713 C  N53OTDT          COMP      EVCD                               53
1714 C   53              GOTO      EOJ
      *                                                                                       CAS005
      ** DEALSDB - Option Date (Maturity) Reversals                                           CAS005
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     OTDT          KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
      *                                                                                       CAS005
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1715 C     PAMT          COMP      0                                      53
1716 C   53SLAM          COMP      0                                      53
1717 C   53              BITON     '2'           ACEI
1718 C   53              MOVE      'M'           RECR
     C   53              Z-ADD     AIPD          TOTI                                          E1043
     C   53              Z-ADD     0             AIPD                                          E1043
     C   53              Z-ADD     0             AITC                                          E1043
     C   53              Z-ADD     0             AIAN                                          E1043
     C   53              Z-ADD     0             AIAP                                          E1043
     C   53              BITOFF    '2'           DNSI                                          E1043
     C/COPY WNCPYSRC,DL0280C544
1719 C   53              GOTO      EOJ
1720 C                   MOVEL     NEV(2)        NARREV
1721 C                   Z-ADD     OTDT          KYDAT
1722 C                   MOVE      'V'           AKY(3)
1723 C                   SETON                                        72
1724 C                   EXSR      FXDV
1725 C                   SETOFF                                       72
1726 C                   BITON     '2'           ACEI
1727 C                   MOVE      'M'           RECR
     C                   Z-ADD     AIPD          TOTI                                          E1043
     C                   Z-ADD     0             AIPD                                          E1043
     C                   Z-ADD     0             AITC                                          E1043
     C                   Z-ADD     0             AIAN                                          E1043
     C                   Z-ADD     0             AIAP                                          E1043
     C                   BITOFF    '2'           DNSI                                          E1043
      *                                                                   CPB001
      **  If Replication Processing required.                             CPB001
     C     REPLIC        IFEQ      'Y'                                          Begin REPLIC   CPB00
     C                   EXSR      SRREPI                                                      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End REPLIC     CPB00
     C/COPY WNCPYSRC,DL0280C027
1728 C                   GOTO      EOJ
1729 C*
1730 C********************************************************************
1731 C*
1732 C*****    FXSWAP IS THE FIRST TAG IN THE SECTION THAT HANDLES
1733 C*          THE PROCESSING FOR F/X SWAPS AND POSITION SWAPS
1734 C*
1735 C     FXSWAP        TAG                                                    ** FXSWAP TAG *
      *                                                                                       221703
      ** DEALSDB Deletion Reversals (PS,SW)                                                   221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     *IN47         ANDEQ     '1'
     C                   MOVE      *IN71         WIN71             1
     C     DTYP          IFEQ      'PS'
     C     LNKDN         CHAIN     DLDLHCL0                           71
     C     *IN71         IFEQ      '0'
     C                   MOVEL     CCCY          KYCCY
     C                   ENDIF
     C                   ENDIF
     C                   Z-ADD     BJRDNB        KYDAT
     C                   EXSR      SRUREL
     C                   MOVE      WIN71         *IN71
     C                   ENDIF
1736 C*
1737 C*****     DEAL DATE PROCESSING
1738 C*
1739 C                   MOVEL     NEV(1)        NARREV
1740 C                   Z-ADD     EXRT          NARRAT
1741 C     PCCY          COMP      BJCYCD                                 65    CHECK FOR BASE S0119
1742 C     SLCY          COMP      BJCYCD                                 66     ON PURCHASE   S0119
1743 C   47              TESTB     '0'           ACEI                 53          OR SALE CCY
     C/COPY WNCPYSRC,DL0280C016
     C   47
1744 CAN 53              GOTO      FXSWPV
1745 C  N47DDAT          COMP      EVCD                               53
     C  N47
1746 CAN 53              GOTO      EOJ
1747 C  N47              TESTB     '0'           ACEI                     53
     C/COPY WNCPYSRC,DL0280C017
     C  N47
1748 CAN 53              GOTO      FXSWPV
1749 C                   Z-ADD     DDAT          KYDAT
1750 C                   MOVE      'D'           AKY(3)
1751 C                   EXSR      FXDV
     C/COPY WNCPYSRC,DL0280C051
1752 C                   BITON     '0'           ACEI
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1753 C     FSLI          COMP      2                                      53
1754 C     SPLA          COMP      0                                  6768            KEY
     C/COPY WNCPYSRC,DL0280C018
     C  N67
1755 CANN68              GOTO      FXSWPV
     C/COPY WNCPYSRC,DL0280C019
1756 C   51
1757 CORN53              GOTO      FXSWPV
1758 C                   MOVEA     '   '         AKY(6)
1759 C                   MOVE      ' '           AKY(9)
1760 C   67              MOVE      'H'           AKY(10)
1761 C   68              MOVE      'L'           AKY(10)
1762 C   68              Z-SUB     SPLA          KYAMT
1763 C   67              Z-ADD     SPLA          KYAMT
1764 C                   MOVE      SPLC          KYCCY
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
1765 C     SPLC          COMP      PCCY                                   67     SWAP CCY =
     C                   MOVE      PRFC          OPPRFC                                        S0111
1766 C   67              Z-ADD     PCST          KYSETL                          PURCHASE CCY
1767 C   67              MOVE      OPCA          KYOSTL
     C   67              MOVE      ROBR          KYSTBR                                        S0111
1768 C  N67              Z-ADD     SCST          KYSETL
1769 C  N67              MOVE      OSCA          KYOSTL
     C  N67              MOVE      POBR          KYSTBR                                        S0111
1770 C                   MOVE      '   '         KYOCCY
1771 C                   Z-ADD     0             KYOTH
1772 C*
1773 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1774 C*
1775 C                   EXSR      FEDAT
1776 C*
1777 C*     67 61
1778 C                   SETON                                        30
1779 C                   EXSR      EXCP
1780 C                   SETOFF                                       30
     C/COPY WNCPYSRC,DL0280C020
1781 C*
1782 C*****    FXSWPV IS A ROUTINE TO HANDLE FIRST LEG VALUE DATE
1783 C*          PROCESSING FOR SWAPS.
1784 C*
1785 C     FXSWPV        TAG                                                    ** FXSWPV TAG *
1786 C     FSLI          COMP      1                                      53     FIRST LEG
1787 C  N53              GOTO      FXSWP2                                          ONLY
1788 C                   MOVEL     NEV(2)        NARREV
1789 C                   TESTB     '1'           ACEI                     53
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C129                                           S01408
      *                                                                                       CDL099
     C     CDL099        IFEQ      'Y'                                                        CDL099
      *                                                                                       CDL099
     C   47                                                                                   CDL099
     CANN53              GOTO      #BFX1S                                                     CDL099
     C  N47                                                                                   CDL099
     CANN53VDAT          COMP      EVCD                               53                      CDL099
     C  N47                                                                                   CDL099
     CAN 53              GOTO      #BFX1S                                                     CDL099
      *                                                                                       CDL099
      ** Set deals file update indicator                                                      CDL099
      *                                                                                       CDL099
     C                   MOVE      '1'           *IN15                                        CDL099
     C                   Z-ADD     VDAT          KYDAT                                        CDL099
     C                   MOVE      'S'           AKY(3)                                       CDL099
      *                                                                                       CDL099
      ** Generate 1st leg purchase value date keys                                            CDL099
      *                                                                                       CDL099
     C                   EXSR      #BFXPV                                                     CDL099
     C   51              MOVEA     '   '         AKY(6)                                       CDL099
     C   51              MOVE      'L'           AKY(9)                                       CDL099
     C   51              MOVE      'G'           AKY(10)                                      CDL099
     C   51              Z-ADD     PAMT          KYAMT                                        CDL099
     C   51              MOVE      PCCY          KYCCY                                        CDL099
     C   51              MOVE      RSCY          KYSCY                                        CDL099
     C   51              MOVE      ROBR          KYSTBR                                       CDL099
     C   51              SETON                                        30                      CDL099
     C   51              EXSR      EXCP                                                       CDL099
     C   51              SETOFF                                       30                      CDL099
     C                   BITON     '1'           ACEI                                         CDL099
     C                   TESTB     '4'           ACEI                     53                  CDL099
     C   53                                                                                   CDL099
     CANN47              MOVE      'E'           RECR                                         CDL099
      *                                                                                       CDL099
      ** Generate 1st leg sale value date keys                                                CDL099
      *                                                                                       CDL099
     C     #BFX1S        TAG                                                                  CDL099
     C                   TESTB     '4'           ACEI                     53                  CDL099
     C   47                                                                                   CDL099
     CANN53              GOTO      FXSWP2                                                     CDL099
     C  N47                                                                                   CDL099
     CANN53BSDT2         COMP      EVCD                               53                      CDL099
     C  N47                                                                                   CDL099
     CAN 53              GOTO      FXSWP2                                                     CDL099
     C                   Z-ADD     BSDT2         KYDAT                                        CDL099
     C                   MOVE      'S'           AKY(3)                                       CDL099
     C                   EXSR      #BFXSV                                                     CDL099
     C                   TESTB     '1'           ACEI                     53                  CDL099
     C  N47                                                                                   CDL099
     CAN 53              MOVE      'E'           RECR                                         CDL099
     C  N47              BITON     '4'           ACEI                                         CDL099
     C  N47                                                                                   CDL099
     CAN 53              MOVE      '1'           *IN84                                        CDL099
      *                                                                                       CDL099
      ** Update file controls                                                                 CDL099
      *                                                                                       CDL099
     C  N47*IN53         IFEQ      '1'                                                        CDL099
     C  N47TOTNDM        ADD       1             TOTNDM                                       CDL099
     C  N47              Z-ADD     TOTIM         ZZTOTI                                       CDL099
     C  N47              Z-ADD     TOTDM         ZZTOTD                                       CDL099
     C  N47PAMT          DIV       1000          ZZAMT                                        CDL099
     C  N47              EXSR      GLZADD                                                     CDL099
     C  N47              Z-ADD     ZZTOTI        TOTIM            15 0                        CDL099
     C  N47              Z-ADD     ZZTOTD        TOTDM             3 0                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C  N51              GOTO      FXSWP2                                                     CDL099
     C                   MOVEA     '   '         AKY(6)                                       CDL099
     C                   MOVE      'D'           AKY(9)                                       CDL099
     C                   MOVE      'F'           AKY(10)                                      CDL099
     C                   Z-ADD     SLAM          KYAMT                                        CDL099
     C                   MOVE      SLCY          KYCCY                                        CDL099
     C                   MOVE      PSCY          KYSCY                                        CDL099
     C                   MOVE      POBR          KYSTBR                                       CDL099
     C                   SETON                                        30                      CDL099
     C                   EXSR      EXCP                                                       CDL099
     C                   GOTO      #BTAG2                                                     CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
     C*                                                                   S01408
     C   47
1790 CANN53              GOTO      FXSWP2
1791 C**N47N53** VDAT      COMP EVCD                 53                                       221703
     C  N47
     CANN53VDAT          COMP      EVCD                               53
     C/COPY WNCPYSRC,DL0280C052
     C  N47
1792 CAN 53              GOTO      EOJ
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     VDAT          KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1793 C                   Z-ADD     VDAT          KYDAT
1794 C                   MOVE      'S'           AKY(3)
     C/COPY WNCPYSRC,DL0280C053
1795 C                   EXSR      FXDV                                         SHARED ROUTINE
     C/COPY WNCPYSRC,DL0280C054
1796 C                   BITON     '1'           ACEI
      *                                                                   CPB001
      **  If Replication Processing required.                             CPB001
     C     REPLIC        IFEQ      'Y'                                          Begin REPLIC   CPB00
     C                   EXSR      SRREPI                                                      CPB00
      *                                                                   CPB001
      ** If any error occurred while executing subroutine REPLIC.         CPB001
     C     *INU8         IFEQ      *ON                                          Begin *INU8    CPB00
     C                   GOTO      EOJ                                                         CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End *INU8      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End REPLIC     CPB00
     C/COPY WNCPYSRC,DL0280C028
1797 C  N47              MOVE      'E'           RECR
     C  N47              MOVE      '1'           *IN84                                         E1075
     C*     UPDATE FILE CONTROLS                                          E10165
     C  N47TOTNDM        ADD       1             TOTNDM                                        E1162
2051 C  N47              Z-ADD     TOTIM         ZZTOTI                                        E1016
2052 C  N47              Z-ADD     TOTDM         ZZTOTD                                        E1016
2055 C  N47PAMT          DIV       1000          ZZAMT                                         E1016
2056 C  N47              EXSR      GLZADD                                                      E1016
2057 C  N47              Z-ADD     ZZTOTI        TOTIM            15 0                         E1016
2058 C  N47              Z-ADD     ZZTOTD        TOTDM             3 0                         E1016
     C*                                                                   E10165
1798 C  N51              GOTO      FXSWP2
1799 C                   MOVEA     '   '         AKY(6)
1800 C                   MOVE      'D'           AKY(9)
1801 C                   MOVE      'F'           AKY(10)
1802 C                   Z-ADD     SLAM          KYAMT
1803 C                   MOVE      SLCY          KYCCY
     C                   MOVE      PSCY          KYSCY                                         CEU00
1804 C                   SETON                                        30
1805 C                   EXSR      EXCP
1806 C                   MOVE      'L'           AKY(9)
1807 C                   MOVE      'G'           AKY(10)
1808 C                   Z-ADD     PAMT          KYAMT
1809 C                   MOVE      PCCY          KYCCY
     C                   MOVE      RSCY          KYSCY                                         CEU00
1810 C                   SETON                                        30
1811 C                   EXSR      EXCP
     C/COPY WNCPYSRC,DL0280C130                                           S01408
     C     #BTAG2        TAG                                                                  CDL099
1812 C*
1813 C*****    FXSWP2 IS A ROUTINE TO HANDLE SECOND LEG VALUE DATE
1814 C*          PROCESSING FOR SWAPS.
1815 C*
1816 C     FXSWP2        TAG                                                    ** FXSWP2 TAG *
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C131                                           S01408
      *                                                                                       CDL099
     C     CDL099        IFEQ      'Y'                                                        CDL099
      *                                                                                       CDL099
      ** Initialise 2nd Leg Purchase and Sale Value Processed Inds.                           CDL099
      *                                                                                       CDL099
     C                   MOVE      ' '           SWMATP            1                          CDL099
     C                   MOVE      ' '           SWMATS            1                          CDL099
      *                                                                                       CDL099
      ** LDAT is latest of 2nd Leg Value Dates.                                               CDL099
      *                                                                                       CDL099
     C     OTDT          COMP      BRSD2                              53                      CDL099
     C   53              Z-ADD     OTDT          LDAT              6 0                        CDL099
     C  N53              Z-ADD     BRSD2         LDAT                                         CDL099
     C     FSLI          COMP      1                                      53                  CDL099
     C   53LDAT          COMP      EVCD                                 5353                  CDL099
     C   53              TESTB     '3'           ACEI                 53                      CDL099
     C  N47                                                                                   CDL099
     CAN 53              BITON     '3'           ACEI                                         CDL099
     C  N47                                                                                   CDL099
     CAN 53              MOVE      'M'           RECR                                         CDL099
     C  N47                                                                                   CDL099
     CAN 53              Z-ADD     AIPD          TOTI                                         CDL099
     C  N47                                                                                   CDL099
     CAN 53              Z-ADD     0             AIPD                                         CDL099
     C  N47                                                                                   CDL099
     CAN 53              Z-ADD     0             AITC                                         CDL099
     C  N47                                                                                   CDL099
     CAN 53              Z-ADD     0             AIAN                                         CDL099
     C  N47                                                                                   CDL099
     CAN 53              Z-ADD     0             AIAP                                         CDL099
     C  N47                                                                                   CDL099
     CAN 53              BITOFF    '2'           DNSI                                         CDL099
      *                                                                                       CDL099
      ** Set Deals File Update Indicator.                                                     CDL099
      *                                                                                       CDL099
     C  N47                                                                                   CDL099
     CAN 53              MOVE      '1'           *IN15                                        CDL099
     C  N47                                                                                   CDL099
     CAN 53              GOTO      EOJ                                                        CDL099
     C     FSLI          COMP      2                                      53                  CDL099
     C   47                                                                                   CDL099
     CANN53              GOTO      EOJ                                                        CDL099
     C  N53              GOTO      FXSWAC                                                     CDL099
     C                   TESTB     '1'           ACEI                     53                  CDL099
     C   47                                                                                   CDL099
     CANN53              GOTO      #BFX2S                                                     CDL099
     C  N47                                                                                   CDL099
     CANN53VDAT          COMP      EVCD                               53                      CDL099
     C  N47                                                                                   CDL099
     CAN 53              GOTO      #BFX2S                                                     CDL099
     C  N47              TESTB     '1'           ACEI                     53                  CDL099
     C  N47                                                                                   CDL099
     CAN 53              GOTO      #BFX2S                                                     CDL099
     C                   MOVEL     NEV(2)        NARREV                                       CDL099
     C                   Z-ADD     VDAT          KYDAT                                        CDL099
     C                   MOVE      'M'           AKY(3)                                       CDL099
      *                                                                                       CDL099
      ** Generate 2nd Leg Purchase Value Date Keys.                                           CDL099
      *                                                                                       CDL099
     C                   EXSR      #BFXPV                                                     CDL099
     C                   MOVE      'P'           SWMATP                                       CDL099
     C                   BITON     '1'           ACEI                                         CDL099
     C                   TESTB     '4'           ACEI                     53                  CDL099
     C   53                                                                                   CDL099
     CANN47              MOVE      'M'           RECR                                         CDL099
      *                                                                                       CDL099
      ** Generate 2nd Leg Sale Value Date Keys.                                               CDL099
      *                                                                                       CDL099
     C     #BFX2S        TAG                                                                  CDL099
     C                   TESTB     '4'           ACEI                     53                  CDL099
     C   47                                                                                   CDL099
     CANN53              GOTO      #BFPPL                                                     CDL099
     C  N47                                                                                   CDL099
     CANN53BSDT2         COMP      EVCD                               53                      CDL099
     C  N47                                                                                   CDL099
     CAN 53              GOTO      #BFPPL                                                     CDL099
     C                   Z-ADD     BSDT2         KYDAT                                        CDL099
     C                   MOVE      'M'           AKY(3)                                       CDL099
     C                   MOVE      'S'           SWMATS                                       CDL099
     C                   EXSR      #BFXSV                                                     CDL099
     C                   BITON     '4'           ACEI                                         CDL099
     C                   TESTB     '1'           ACEI                     53                  CDL099
      *                                                                                       CDL099
      ** Set Deals File Update Indicator.                                                     CDL099
      *                                                                                       CDL099
     C                   MOVE      '1'           *IN15                                        CDL099
     C  N47                                                                                   CDL099
     CAN 53              MOVE      'M'           RECR                                         CDL099
     C  N47              Z-ADD     AIPD          TOTI                                         CDL099
     C  N47              Z-ADD     0             AIPD                                         CDL099
     C  N47              Z-ADD     0             AITC                                         CDL099
     C  N47              Z-ADD     0             AIAN                                         CDL099
     C  N47              Z-ADD     0             AIAP                                         CDL099
     C  N47              BITOFF    '2'           DNSI                                         CDL099
     C   51              GOTO      PSINT                                                      CDL099
     C     SPLA          COMP      0                                  676853                  CDL099
     C   53              GOTO      FXSWAC                                                     CDL099
      *                                                                                       CDL099
      ** If Purchase Keys have beeb Generated abive and Purchase                              CDL099
      ** Currency is P/L Currency then Generate P/L Keys Below.                               CDL099
      *                                                                                       CDL099
     C     #BFPPL        TAG                                                                  CDL099
     C   51              GOTO      PSINT                                                      CDL099
      *                                                                                       CDL099
     C     SWMATP        IFEQ      'P'                                                        CDL099
     C     SPLC          ANDEQ     PCCY                                                       CDL099
     C                   Z-ADD     VDAT          KYDAT                                        CDL099
     C                   GOTO      #BFSPL                                                     CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
      ** If Sale Keys have been Generated above and Sale Currency is                          CDL099
      ** P/L Currency then Generate Keys below.                                               CDL099
      *                                                                                       CDL099
     C     SWMATS        IFEQ      'S'                                                        CDL099
     C     SPLC          ANDEQ     SLCY                                                       CDL099
     C                   Z-ADD     BSDT2         KYDAT                                        CDL099
     C                   ELSE                                                                 CDL099
     C                   GOTO      FXSWAC                                                     CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C     #BFSPL        TAG                                                                  CDL099
     C     SPLA          COMP      0                                  676853                  CDL099
     C   53              GOTO      PSINT                                                      CDL099
     C                   GOTO      #BTAG3                                                     CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
     C*                                                                   S01408
1817 C     FSLI          COMP      1                                      53
1818 C   53OTDT          COMP      EVCD                                 5353
1819 C   53              TESTB     '3'           ACEI                 53
     C  N47
1820 CAN 53              BITON     '3'           ACEI
     C  N47
1821 CAN 53              MOVE      'M'           RECR
     C  N47
     CAN 53              Z-ADD     AIPD          TOTI                                          E1043
     C  N47
     CAN 53              Z-ADD     0             AIPD                                          E1043
     C  N47
     CAN 53              Z-ADD     0             AITC                                          E1043
     C  N47
     CAN 53              Z-ADD     0             AIAN                                          E1043
     C  N47
     CAN 53              Z-ADD     0             AIAP                                          E1043
     C  N47
     CAN 53              BITOFF    '2'           DNSI                                          E1043
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C  N47
     CAN 53              MOVE      '1'           *IN15                                         S0109
     C/COPY WNCPYSRC,DL0280C488
     C  N47
1822 CAN 53              GOTO      EOJ
1823 C     FSLI          COMP      2                                      53
     C   47
1824 CANN53              GOTO      EOJ
1825 C  N53              GOTO      FXSWAC
1826 C                   TESTB     '1'           ACEI                     53
     C   47
1827 CANN53              GOTO      FXSWAC
1828 C  N47VDAT          COMP      EVCD                               53
     C  N47
1829 CAN 53              GOTO      FXSWAC
1830 C  N47              TESTB     '1'           ACEI                     53
     C  N47
1831 CAN 53              GOTO      FXSWAC
      *                                                                                       230813
      ** DEALSDB - Value Date (Maturity) Reversals (PS,SW)                                    230813
      *                                                                                       230813
     C     CAS005        IFEQ      'Y'                                                        230813
     C                   Z-ADD     VDAT          KYDAT                                        230813
     C                   EXSR      SRUREL                                                     230813
     C                   ENDIF                                                                230813
      *                                                                                       230813
1832 C                   MOVEL     NEV(2)        NARREV
1833 C                   Z-ADD     VDAT          KYDAT
1834 C                   MOVE      'M'           AKY(3)
1835 C                   EXSR      FXDV
      **********                                                                       CAS005 230813
      ***DEALSDB - Value Date (Maturity) Reversals (PS,SW)                             CAS005 230813
      **********                                                                       CAS005 230813
     C*****CAS005        IFEQ      'Y'                                                 CAS005 230813
     C**********         Z-ADD     VDAT          KYDAT                                 CAS005 230813
     C**********         EXSR      SRUREL                                              CAS005 230813
     C**********         ENDIF                                                         CAS005 230813
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0280C571
1836 C                   BITON     '1'           ACEI
      *                                                                   CPB001
      **  If Replication Processing required.                             CPB001
     C     REPLIC        IFEQ      'Y'                                          Begin REPLIC   CPB00
     C                   EXSR      SRREPI                                                      CPB00
      *                                                                   CPB001
      ** If any error occurred while executing subroutine REPLIC.         CPB001
     C     *INU8         IFEQ      *ON                                          Begin *INU8    CPB00
     C                   GOTO      EOJ                                                         CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End *INU8      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End REPLIC     CPB00
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CCP7                                           S01408
     C*                                                                   S01408
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1837 C  N47              MOVE      'M'           RECR
     C  N47              Z-ADD     AIPD          TOTI                                          E1043
     C  N47              Z-ADD     0             AIPD                                          E1043
     C  N47              Z-ADD     0             AITC                                          E1043
     C  N47              Z-ADD     0             AIAN                                          E1043
     C  N47              Z-ADD     0             AIAP                                          E1043
     C  N47              BITOFF    '2'           DNSI                                          E1043
     C/COPY WNCPYSRC,DL0280C545
1838 C   51              GOTO      PSINT
1839 C     SPLA          COMP      0                                  676853     PROFIT
1840 C   53              GOTO      FXSWAC                                         / LOSS
     C/COPY WNCPYSRC,DL0280C132                                           S01408
     C     #BTAG3        TAG                                                                  CDL099
1841 C                   MOVEA     '   '         AKY(6)                                  KEY
1842 C                   MOVEA     DLST          AKY(4)
1843 C                   MOVE      ' '           AKY(9)
1844 C   67              MOVE      'H'           AKY(10)
1845 C   68              MOVE      'L'           AKY(10)
1846 C   68              Z-SUB     SPLA          KYAMT
1847 C   67              Z-ADD     SPLA          KYAMT
1848 C                   MOVE      SPLC          KYCCY
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
1849 C     SPLC          COMP      PCCY                                   53     SWAP CCY =
     C                   MOVE      PRFC          OPPRFC                                        S0111
1850 C   53              Z-ADD     PCST          KYSETL                          PURCHASE CCY
1851 C   53              MOVE      OPCA          KYOSTL
     C   53              MOVE      ROBR          KYSTBR                                        S0111
1852 C  N53              Z-ADD     SCST          KYSETL
1853 C  N53              MOVE      OSCA          KYOSTL
     C  N53              MOVE      POBR          KYSTBR                                        S0111
1854 C                   MOVE      '   '         KYOCCY
1855 C                   Z-ADD     0             KYOTH
1856 C*
1857 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1858 C*
1859 C                   EXSR      FEDAT
1861 C*  53 61
1862 C                   EXSR      EXCP
1863 C*
1864 C*    REMAINING SWAP PROFIT/LOSS
1865 C     SPLA          SUB       SPPD          WORKD                676853
1866 C                   Z-ADD     SPLA          SPPD
1867 C   67              MOVE      'P'           AKY(3)
1868 C   68              MOVE      'L'           AKY(3)
1869 C   67              MOVE      'H'           AKY(10)
1870 C   68              MOVE      'L'           AKY(10)
1871 C                   MOVE      ' '           AKY(9)
1872 C   68              Z-SUB     WORKD         KYAMT
1873 C   67              Z-ADD     WORKD         KYAMT
1874 C                   MOVE      SPLC          KYCCY
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
1875 C  N53              EXSR      EXCP
1876 C  N51              GOTO      FXSWAC
1877 C     PSINT         TAG                                                    ** PSINT TAG **
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C133                                           S01408
      *                                                                                       CDL099
     C     CDL099        IFEQ      'Y'                                                        CDL099
      *                                                                                       CDL099
      ** If Purchase Processing Performed above then Output Keys below                        CDL099
      *                                                                                       CDL099
     C     SWMATP        CABNE     'P'           #BFSAK                                       CDL099
      *                                                                                       CDL099
     C                   Z-ADD     VDAT          KYDAT                                        CDL099
     C                   MOVE      'M'           AKY(3)                                       CDL099
     C                   MOVEA     '   '         AKY(6)                                       CDL099
     C                   MOVE      'D'           AKY(9)                                       CDL099
     C                   MOVE      'F'           AKY(10)                                      CDL099
     C                   Z-ADD     IDAM          KYAMT                                        CDL099
     C                   MOVE      IDCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
     C                   MOVE      'D'           AKY(9)                                       CDL099
     C                   MOVE      'I'           AKY(10)                                      CDL099
     C                   Z-ADD     IDIA          KYAMT                                        CDL099
     C                   MOVE      IDCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
     C                   MOVE      'D'           AKY(9)                                       CDL099
     C                   MOVE      'B'           AKY(10)                                      CDL099
     C     IDAM          ADD       IDIA          KYAMT                                        CDL099
     C                   MOVE      IDCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
      ** Remaining Deposit Interest                                                           CDL099
      *                                                                                       CDL099
     C     IDIA          SUB       DIPD          KYAMT                                        CDL099
     C                   Z-ADD     IDIA          DIPD                                         CDL099
     C                   MOVE      'D'           AKY(9)                                       CDL099
     C                   MOVE      'A'           AKY(3)                                       CDL099
     C                   MOVE      'A'           AKY(10)                                      CDL099
     C                   MOVE      IDCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   Z-ADD     KYAMT         NRRSAL                                       CDL099
     C                   MOVE      KYCCY         SALCY                                        CDL099
     C                   SETON                                        3071                    CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
     C                   SETOFF                                       3071                    CDL099
     C                   MOVE      'Y'           @DACCF                                       CDL099
      *                                                                                       CDL099
     C     #BFSAK        TAG                                                                  CDL099
      *                                                                                       CDL099
      ** If Sale Currency Processed Above then Output Keys below                              CDL099
      *                                                                                       CDL099
     C     SWMATS        CABNE     'S'           FXSWAC                                       CDL099
     C                   Z-ADD     BSDT2         KYDAT                                        CDL099
     C                   MOVEA     '   '         AKY(6)                                       CDL099
     C                   MOVE      'M'           AKY(3)                                       CDL099
     C                   MOVE      'L'           AKY(9)                                       CDL099
     C                   MOVE      'G'           AKY(10)                                      CDL099
     C                   Z-ADD     ILAM          KYAMT                                        CDL099
     C                   MOVE      ILCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
     C                   MOVE      'L'           AKY(9)                                       CDL099
     C                   MOVE      'I'           AKY(10)                                      CDL099
     C                   Z-ADD     ILIA          KYAMT                                        CDL099
     C                   MOVE      ILCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
     C                   MOVE      'L'           AKY(9)                                       CDL099
     C                   MOVE      'B'           AKY(10)                                      CDL099
     C     ILAM          ADD       ILIA          KYAMT                                        CDL099
     C                   MOVE      ILCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
      ** Remaining Loan Interest                                                              CDL099
      *                                                                                       CDL099
     C     ILIA          SUB       LIPD          KYAMT                                        CDL099
     C                   Z-ADD     ILIA          LIPD                                         CDL099
     C                   MOVE      'A'           AKY(3)                                       CDL099
     C                   MOVE      'A'           AKY(10)                                      CDL099
     C                   MOVE      'L'           AKY(9)                                       CDL099
     C                   MOVE      ILCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   Z-ADD     KYAMT         NRRSAL                                       CDL099
     C                   MOVE      KYCCY         SALCY                                        CDL099
     C                   SETON                                        3071                    CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
     C                   SETOFF                                       3071                    CDL099
     C                   MOVE      'Y'           @LACCF                                       CDL099
     C                   GOTO      #BTAG4                                                     CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
     C*                                                                   S01408
1878 C                   MOVE      'M'           AKY(3)
1879 C                   MOVEA     '   '         AKY(6)
1880 C                   MOVE      'D'           AKY(9)                          INTERNAL
1881 C                   MOVE      'F'           AKY(10)                          CONTRACT
1882 C                   Z-ADD     IDAM          KYAMT                             PROCESSING
1883 C                   MOVE      IDCY          KYCCY
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
1883 C                   MOVE      PRFC          OPPRFC                                        S0111
1898 C                   EXSR      EXCP
      *                                                                                     MD051605
     C     CDL099        IFEQ      'N'                                                      MD051605
     C                   MOVE      'L'           AKY(9)                                     MD051605
     C                   MOVE      'G'           AKY(10)                                    MD051605
     C                   Z-ADD     ILAM          KYAMT                                      MD051605
     C                   MOVE      ILCY          KYCCY                                      MD051605
     C                   MOVE      *BLANKS       KYSCY                                      MD051605
     C                   MOVE      PRFC          OPPRFC                                     MD051605
     C                   EXSR      EXCP                                                     MD051605
      *                                                                                     MD051605
     C                   MOVE      'D'           AKY(9)                                     MD051605
     C                   MOVE      'I'           AKY(10)                                    MD051605
     C                   Z-ADD     IDIA          KYAMT                                      MD051605
     C                   MOVE      IDCY          KYCCY                                      MD051605
     C                   MOVE      *BLANKS       KYSCY                                      MD051605
     C                   MOVE      PRFC          OPPRFC                                     MD051605
     C                   EXSR      EXCP                                                     MD051605
      *                                                                                     MD051605
     C                   MOVE      'L'           AKY(9)                                     MD051605
     C                   Z-ADD     ILIA          KYAMT                                      MD051605
     C                   MOVE      ILCY          KYCCY                                      MD051605
     C                   MOVE      *BLANKS       KYSCY                                      MD051605
     C                   MOVE      PRFC          OPPRFC                                     MD051605
     C                   EXSR      EXCP                                                     MD051605
     C                   ENDIF                                                              MD051605
      *                                                                                     MD051605
1899 C                   MOVE      'D'           AKY(9)
1900 C                   MOVE      'B'           AKY(10)
1901 C     IDAM          ADD       IDIA          KYAMT
1902 C                   MOVE      IDCY          KYCCY
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
1883 C                   MOVE      PRFC          OPPRFC                                        S0111
1903 C                   EXSR      EXCP
1904 C                   MOVE      'L'           AKY(9)
1905 C     ILAM          ADD       ILIA          KYAMT
1906 C                   MOVE      ILCY          KYCCY
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
1883 C                   MOVE      PRFC          OPPRFC                                        S0111
1907 C                   EXSR      EXCP
1908 C*
1909 C*    REMAINING LOAN INTEREST
1910 C     ILIA          SUB       LIPD          KYAMT
1911 C                   Z-ADD     ILIA          LIPD
1912 C                   MOVE      'A'           AKY(3)
1913 C                   MOVE      'A'           AKY(10)
1914 C                   MOVE      'L'           AKY(9)
1915 C                   MOVE      ILCY          KYCCY
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
1883 C                   MOVE      PRFC          OPPRFC                                        S0111
1916 C                   EXSR      EXCP
1917 C*
1918 C*    REMAINING DEP. INTEREST
1919 C     IDIA          SUB       DIPD          KYAMT
1920 C                   Z-ADD     IDIA          DIPD
1921 C                   MOVE      'D'           AKY(9)
1922 C                   MOVE      IDCY          KYCCY
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
1883 C                   MOVE      PRFC          OPPRFC                                        S0111
1923 C                   EXSR      EXCP
1924 C                   GOTO      EOJ
     C/COPY WNCPYSRC,DL0280C134                                           S01408
     C     #BTAG4        TAG                                                                  CDL099
1925 C*
1926 C*****    FXSWAC IS A ROUTINE TO HANDLE ACCRUAL DATE PROCESSING
1927 C*          FOR F/X SWAPS.
1928 C*
1929 C     FXSWAC        TAG                                                    ** FXSWAC TAG *
1930 C*  47
     C  N52
1931 CANN47              GOTO      EOJ
     C  N51
1932 CAN 47              GOTO      GENKEY
1933 C                   MOVEL     NEV(6)        NARREV
1934 C     FSLI          COMP      2                                      53
1935 C  N53              GOTO      EOJ
1936 C     OTDT          COMP      EVCD                               53
1937 C   53              GOTO      EOJ
1938 C   51              GOTO      INTCAL
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C135                                           S01408
      *                                                                                       CDL099
     C     CDL099        IFEQ      'Y'                                                        CDL099
      *                                                                                       CDL099
     C     TDAT          SUB       OTDT          SWPDYS            5 0                        CDL099
      *                                                                                       CDL099
      ** If Swap Accrual 'END' Date is Less than Event Date then Accrue                       CDL099
      ** to Swap 'END' Date                                                                   CDL099
      *                                                                                       CDL099
     C     EVCD          IFLT      TDAT                                                       CDL099
     C     EVCD          SUB       OTDT          SWPTD             5 0                        CDL099
     C                   Z-ADD     EVCD          KYDAT                                        CDL099
     C                   ELSE                                                                 CDL099
     C     TDAT          SUB       OTDT          SWPTD             5 0                        CDL099
     C                   Z-ADD     TDAT          KYDAT                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   GOTO      #BTAG5                                                     CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
     C*                                                                   S01408
1939 C     VDAT          SUB       OTDT          SWPDYS            5 0          SWAP PERIOD
1940 C     EVCD          SUB       OTDT          SWPTD             5 0          PERIOD TO DATE
     C/COPY WNCPYSRC,DL0280C136                                           S01408
     C     #BTAG5        TAG                                                                  CDL099
1941 C     SWPTD         COMP      0                                    53
1942 C   53              GOTO      EOJ
1943 C     SWPTD         COMP      SWPDYS                             53  53
1944 C   53              GOTO      EOJ
1945 C  N29SWPTD         ADD       1             SWPTD
1946 C*****SPLA****      MULT      SWPTD         WORKTD                         ACCRUED SWAP  145043
     C*****WORKTD**      DIV(H)    SWPDYS        WORKTD                         PROFIT/LOSS   145043
1946 C     SPLA          MULT      SWPTD         WORKDE           15 0          ACCRUED SWAP  145043
     C     WORKDE        DIV(H)    SWPDYS        WORKTD                         PROFIT/LOSS   145043
1948 C     WORKTD        SUB       SPPD          WORKTP               6768      ACC.P/L TO POST
1949 C                   Z-ADD     WORKTD        SPPD
1950 C**
1951 C     GENKEY        TAG                                                    * GENKEY  TAG *
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
1952 C**
1953 C*    FOR REVERSAL OF SWAP MUST REVERSE AMOUNT ALREDY POSTED
1954 C**
1955 C   47              Z-ADD     SPPD          WORKTP               6768
     C   47
     CANN67
1956 CANN68              GOTO      EOJ
1957 C   47              MOVEL     NEV(7)        NARREV
1958 C*
1959 C*****    GENERATE ACCRUAL DATE PROFIT/LOSS ACCOUNT KEY.
1960 C*
1961 C                   MOVEA     '   '         AKY(6)
1962 C                   MOVEA     DLST          AKY(4)
1963 C                   MOVE      ' '           AKY(9)
     C/COPY WNCPYSRC,DL0280C137                                           S01408
     C     CDL099        IFNE      'Y'                                                        CDL099
1964 C                   Z-ADD     EVCD          KYDAT
     C                   ENDIF                                                                CDL099
     C/COPY WNCPYSRC,DL0280C138                                           S01408
1965 C   67              Z-ADD     WORKTP        KYAMT
1966 C   67              MOVE      'P'           AKY(3)
1967 C   67              MOVE      'H'           AKY(10)
1968 C   68              Z-SUB     WORKTP        KYAMT
1969 C   68              MOVE      'L'           AKY(3)
1970 C   68              MOVE      'L'           AKY(10)
1971 C                   MOVE      SPLC          KYCCY
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
1972 C     SPLC          COMP      PCCY                                   53     SWAP CCY
1883 C                   MOVE      PRFC          OPPRFC                                        S0111
1973 C   53              Z-ADD     PCST          KYSETL                           = PURCHASE
1974 C   53              MOVE      OPCA          KYOSTL                               CCY
1974 C   53              MOVE      ROBR          KYSTBR                                        S0111
1975 C  N53              Z-ADD     SCST          KYSETL
1976 C  N53              MOVE      OSCA          KYOSTL
1976 C  N53              MOVE      POBR          KYSTBR                                        S0111
1977 C                   MOVE      '   '         KYOCCY            3
1978 C                   Z-ADD     0             KYOTH            13 0
1979 C*
1980 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
1981 C*
1982 C                   EXSR      FEDAT
1983 C*
1984 C*  53 61
1985 C  N53              MOVE      KYCCY         SALCY             3
1986 C  N53              Z-ADD     KYAMT         NRRSAL
     C  N67
1987 CANN68              GOTO      LDINT
1988 C                   SETON                                        71
1989 C   53              Z-ADD     KYAMT         NRRPUR
1990 C                   EXSR      EXCP
1991 C   47              GOTO      EOJ
1992 C     INTCAL        TAG                                                    ** INTCAL TAG *
     C/COPY WNCPYSRC,DL0280C139                                           S01408
      *                                                                                       CDL099
     C     CDL099        IFEQ      'Y'                                                        CDL099
      *                                                                                       CDL099
      ** Set up Loan Beginning and End Dates for Accrual.                                     CDL099
      *                                                                                       CDL099
     C                   Z-ADD     OTDT          ZIBEG                                        CDL099
      *                                                                                       CDL099
      ** If Loan End Date is Earlier than EVCD then Accrue to Loan End                        CDL099
      ** Date.                                                                                CDL099
      *                                                                                       CDL099
     C     BSDT2         IFLT      EVCD                                                       CDL099
     C                   Z-ADD     BSDT2         ZIEND                                        CDL099
     C                   Z-ADD     BSDT2         KYDAT                                        CDL099
     C                   ELSE                                                                 CDL099
     C                   Z-ADD     EVCD          ZIEND                                        CDL099
     C                   Z-ADD     EVCD          KYDAT                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C  N29ZIEND         ADD       1             ZIEND                                        CDL099
     C                   Z-ADD     ILAM          ZIAMT                                        CDL099
     C                   Z-ADD     ILCM          ZICALC                                       CDL099
     C                   Z-ADD     ILIR          ZIRATE                                       CDL099
     C                   MOVEL     JLRDF         ZIRDFC            1                          CDL099
     C                   EXSR      GLINTC                                                     CDL099
      *                                                                                       CDL099
      * To replace a line removed from the internally described GLINTC                        CDL099
      *                                                                                       CDL099
     C     *IN02         IFEQ      '1'                                                        CDL099
     C     ZIRDFC        ANDEQ     'Y'                                                        CDL099
     C     *IN03         OREQ      '1'                                                        CDL099
     C     JRDFC         ANDEQ     'Y'                                                        CDL099
     C     *IN04         OREQ      '1'                                                        CDL099
     C     JRDFC         ANDEQ     'Y'                                                        CDL099
     C                   Z-ADD     ZINTR         WKINT                                        CDL099
     C                   ELSE                                                                 CDL099
     C                   Z-ADD(H)  ZINTR         WKINT                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   Z-ADD     WKINT         LITD             13 0                        CDL099
      *                                                                                       CDL099
      ** Set Up Deposit Beginning and End Dates for Accrual.                                  CDL099
      *                                                                                       CDL099
     C                   Z-ADD     BRSD2         ZIBEG                                        CDL099
      *                                                                                       CDL099
      ** If Deposit End Date is Earlier than EVCD then Accrue to                              CDL099
      ** Deposit End Date.                                                                    CDL099
      *                                                                                       CDL099
     C     VDAT          IFLT      EVCD                                                       CDL099
     C                   Z-ADD     VDAT          ZIEND                                        CDL099
     C                   Z-ADD     VDAT          KYDAT                                        CDL099
     C                   ELSE                                                                 CDL099
     C                   Z-ADD     EVCD          ZIEND                                        CDL099
     C                   Z-ADD     EVCD          KYDAT                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C  N29ZIEND         ADD       1             ZIEND                                        CDL099
      *                                                                                       CDL099
     C                   Z-ADD     IDAM          ZIAMT                                        CDL099
     C                   Z-ADD     IDCM          ZICALC                                       CDL099
     C                   Z-ADD     IDIR          ZIRATE                                       CDL099
     C                   MOVEL     JDRDF         ZIRDFC                                       CDL099
      *                                                                                       CDL099
     C                   GOTO      #BTAG7                                                     CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
1993 C                   Z-ADD     OTDT          ZIBEG
1994 C                   Z-ADD     EVCD          ZIEND
1995 C  N29ZIEND         ADD       1             ZIEND
1996 C                   Z-ADD     ILAM          ZIAMT
1997 C                   Z-ADD     ILCM          ZICALC
      *                                                                                       262186
      ** Check first if Negative Interest                                                     262186
      *                                                                                       262186
     C                   TESTB     '5'           DSTI                     53                  262186
     C     *IN53         IFEQ      '0'                                                        262186
1998 C                   Z-ADD     ILIR          ZIRATE
     C                   ELSE                                                                 262186
     C                   Z-SUB     ILIR          ZIRATE                                       262186
     C                   ENDIF                                                                262186
      *                                                                                       262186
     C                   MOVEL     JLRDF         ZIRDFC            1                           06655
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP30                                           S01408
      *                                                                   S01408
1999 C                   EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP31                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
2000 C                   Z-ADD     WKINT         LITD             13 0
2001 C                   Z-ADD     IDAM          ZIAMT
2002 C                   Z-ADD     IDCM          ZICALC
      *                                                                                       262186
      ** Check first if Negative Interest                                                     262186
      *                                                                                       262186
     C                   TESTB     '6'           DSTI                     53                  262186
     C     *IN53         IFEQ      '0'                                                        262186
2003 C                   Z-ADD     IDIR          ZIRATE
     C                   ELSE                                                                 262186
     C                   Z-SUB     IDIR          ZIRATE                                       262186
     C                   ENDIF                                                                262186
      *                                                                                       262186
     C                   MOVEL     JDRDF         ZIRDFC                                        S0139
     C/COPY WNCPYSRC,DL0280CP32                                           S01408
     C     #BTAG7        TAG                                                                  CDL099
2004 C                   EXSR      GLINTC
     C/COPY WNCPYSRC,DL0280CP33                                           S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
2005 C                   Z-ADD     WKINT         DITD             13 0
2006 C     LITD          SUB       LIPD          LITP             13 0
2007 C     DITD          SUB       DIPD          DITP             13 0
2008 C*
2009 C     LDINT         TAG                                                    ** LDINT TAG **
2010 C  N51              GOTO      EOJ
2011 C   47LIPD          COMP      0                                      53
     C   47
2012 CAN 53DIPD          COMP      0                                      53
     C   47
2013 CAN 53              GOTO      EOJ
2014 C                   MOVEA     '   '         AKY(6)
2015 C                   MOVEA     DLST          AKY(4)
2016 C                   MOVE      'A'           AKY(3)
2017 C                   MOVE      'D'           AKY(9)
2018 C                   MOVE      'A'           AKY(10)
     C/COPY WNCPYSRC,DL0280C140                                           S01408
      *                                                                                       CDL099
     C     CDL099        IFEQ      'Y'                                                        CDL099
      *                                                                                       CDL099
     C                   Z-ADD     DITP          KYAMT                                        CDL099
     C   47              Z-ADD     DIPD          KYAMT                                        CDL099
     C                   Z-ADD     IDIR          NRRT                                         CDL099
     C                   MOVE      IDCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   Z-ADD     KYAMT         NRRSAL                                       CDL099
     C                   MOVE      KYCCY         SALCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   Z-ADD     NRRT          ICIR             11 7                        CDL099
      *                                                                                       CDL099
     C     OTDT          IFLE      EVCD                                                       CDL099
     C     @DACCF        ANDNE     'Y'                                                        CDL099
     C                   SETON                                        3071                    CDL099
     C                   EXSR      EXCP                                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   MOVE      'L'           AKY(9)                                       CDL099
     C                   Z-ADD     LITP          KYAMT                                        CDL099
     C   47              Z-ADD     LIPD          KYAMT                                        CDL099
     C                   Z-ADD     ILIR          NRRT                                         CDL099
     C                   MOVE      ILCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVE      KYCCY         SALCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   Z-ADD     KYAMT         NRRSAL                                       CDL099
     C                   Z-ADD     NRRT          ICIR                                         CDL099
      *                                                                                       CDL099
     C     OTDT          IFLE      EVCD                                                       CDL099
     C     @LACCF        ANDNE     'Y'                                                        CDL099
     C                   SETON                                        3071                    CDL099
     C                   EXSR      EXCP                                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   GOTO      #BTAG8                                                     CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
2019 C                   Z-ADD     EVCD          KYDAT
2020 C                   Z-ADD     DITP          KYAMT
2021 C   47              Z-ADD     DIPD          KYAMT
2022 C                   Z-ADD     IDIR          NRRT
2023 C                   MOVE      IDCY          KYCCY
2024 C                   Z-ADD     KYAMT         NRRSAL
     C                   MOVE      KYCCY         SALCY
1883 C                   MOVE      PRFC          OPPRFC                                        S0111
2025 C                   Z-ADD     NRRT          ICIR             11 7
2026 C                   SETON                                        3071
2027 C                   EXSR      EXCP
2028 C                   MOVE      'L'           AKY(9)
2029 C                   Z-ADD     LITP          KYAMT
2030 C   47              Z-ADD     LIPD          KYAMT
2031 C                   Z-ADD     ILIR          NRRT
2032 C                   MOVE      ILCY          KYCCY
2033 C                   MOVE      KYCCY         SALCY
1883 C                   MOVE      PRFC          OPPRFC                                        S0111
2034 C                   Z-ADD     KYAMT         NRRSAL
2035 C                   Z-ADD     NRRT          ICIR
2036 C                   SETON                                        3071
2037 C                   EXSR      EXCP
     C/COPY WNCPYSRC,DL0280C141                                           S01408
     C     #BTAG8        TAG                                                                  CDL099
2038 C  N47LIPD          ADD       LITP          LIPD
2039 C  N47DIPD          ADD       DITP          DIPD
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
     C                   GOTO      EOJ                                                         S0111
     C*                                                                   S01119
     C*******     FRA/IRS DEAL TYPES                                      S01119
     C*                                                                   S01119
     C     FRAIRS        TAG                                                    *** FRAIRS *** S0111
     C/COPY WNCPYSRC,DL0280C478
     C*                                                                   S01119
     C* CLEAR ACCOUNT KEY                                                 S01119
     C                   MOVEA     *BLANK        AKY                                           S0111
     C                   Z-ADD     UPFE          KYAMT2           13 0
     C                   MOVE      UPPR          UPPR2             1
     C                   MOVE      UPVD          UPVD2             5 0
     C*                                                                   S01119
     C* SET INDICATOR TO PRINT TAX AMOUNT                                 S01119
     C* N.B. THIS MAY BE CHANGED DURING PROCESSING OF DEAL                S01119
     C     TAXI          COMP      'Y'                                    33                   S0111
     C*                                                                   S01119
     C                   MOVE      ' '           FLRT              1                        AR887940
     C     *IN47         CASEQ     '1'           FRARVS                                        S0111
     C     DTYP          CASEQ     'FR'          FRSUBR                                        S0111
     C/COPY WNCPYSRC,DL0280C079
     C     DTYP          CASEQ     'RS'          RSSUBR                                        S0111
     C/COPY WNCPYSRC,DL0280C080
     C     DTYP          CASEQ     'RX'          RXSUBR                                        S0111
     C     DTYP          CASEQ     'RR'          RLSUBR                                        S0115
     C     DTYP          CASEQ     'RP'          RLSUBR                                        S0115
     C     DTYP          CASEQ     'RF'          RLSUBR                                        S0115
     C                   END                                                                   S0111
     C                   EXSR      UPFAMD
     C/COPY WNCPYSRC,DL0280C030
2041 C*
2042 C********************************************************************
2043 C*****    EOJ IS THE END OF DETAIL PROCESSING TAG
2044 C*
2045 C     EOJ           TAG                                                    ** EOJ TAG   **
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP11                                           S01408
     C*                                                                   S01408
      *                                                                                       CDL033
      ** Perform final processing for CF deals.                                               CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
     C                   EXSR      SRFRC8                                                     CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
2046 C                   SETOFF                                       30
2295 C   04              SETOFF                                       71
2296 C   04              Z-ADD     0             NRRPUR
2297 C   04              Z-ADD     0             NRRSAL
     C/COPY WNCPYSRC,DL0280C719
     C**  MATURE EXPIRED 1ST LEG OF SWAP                                  S01093
     C     RECR          IFEQ      'E'                                          ** IF  001     S0109
     C     OTDT          IFLE      EVCD                                         ** IF  002     S0109
     C                   MOVE      'M'           RECR                                          S0109
     C                   MOVE      '1'           *IN15                                         S0109
     C                   Z-ADD     AIPD          TOTI                                          E1043
     C                   Z-ADD     0             AIPD                                          E1043
     C                   Z-ADD     0             AITC                                          E1043
     C                   Z-ADD     0             AIAN                                          E1043
     C                   Z-ADD     0             AIAP                                          E1043
     C                   BITOFF    '2'           DNSI                                          E1043
     C/COPY WNCPYSRC,DL0280C546
     C                   END                                                    ** END 002     S0109
     C*   BYPASS FILE CONTROLS                                            S01093
     C                   GOTO      EOJ2                                                        S0109
     C                   END                                                    ** END 001     S0109
     C*   BYPASS FILE CONTROLS IF RECORD FLAGGED FOR DELETION             E10165
     C     RECR          IFEQ      '*'                                                         E1016
     C                   GOTO      EOJ2                                                        E1016
     C                   END                                                                   E1016
     C**  RESET INDICATOR FOR DEALS FILE UPDATE & DELETE IF REVERSAL      S01093
     C     *IN47         IFEQ      '1'                                          ** IF  001     S0109
      *                                                                   S01444
      ** Write a record to the historic deals file, according to deal     S01444
      ** type                                                             S01444
      *                                                                   S01444
     C/COPY WNCPYSRC,DL0280C211                                           S01408
     C*                                                                   S01408
     C     *IN02         IFEQ      '1'                                                         S0144
     C                   MOVEL     BJRDNB        LCD                                           S0144
     C                   EXCEPT    DLBHIS                                                      S0144
     C/COPY WNCPYSRC,DL0280C676
     C                   END                                                                   S0144
     C*                                                                   S01444
     C     *IN03         IFEQ      '1'                                                         S0144
     C                   MOVEL     BJRDNB        LCD                                           S0144
     C                   IF        WTAXI = 'A'                                                CER069
     C                   EVAL      TAXI = 'A'                                                 CER069
     C                   ENDIF                                                                CER069
     C                   EXCEPT    DLCHIS                                                      S0144
     C                   END                                                                   S0144
     C*                                                                   S01444
     C     *IN04         IFEQ      '1'                                                         S0144
     C/COPY WNCPYSRC,DL0280C612
     C                   MOVEL     BJRDNB        LCD                                           S0144
     C                   EXCEPT    DLDHIS                                                      S0144
     C                   END                                                                   S0144
     C*                                                                   S01444
     C     *IN05         IFEQ      '1'                                                         S0144
     C                   MOVEL     BJRDNB        LCD                                           S0144
     C                   EXCEPT    DLEHIS                                                      S0144
     C                   END                                                                   S0144
     C/COPY WNCPYSRC,DL0280C212                                           S01408
     C     *IN10         IFEQ      '1'                                                         S0144
     C                   MOVEL     BJRDNB        LCD                                           S0144
     C                   EXCEPT    DLGHIS                                                      S0144
     C                   END                                                                   S0144
     C*                                                                   S01444
     C                   MOVE      '0'           *IN15                                         S0109
     C     CDL012        IFEQ      'Y'
      *                                                                                       CDL012
     C                   MOVE      *IN16         IND16             1
      *                                                                                       CDL012
     C                   OPEN      DLTCSTV0
      *                                                                                       CDL012
     C     STMTKY        KLIST
     C                   KFLD                    DLNOKY            6 0
     C                   KFLD                    OREDKY            5 0
      *                                                                                       CDL012
     C                   Z-ADD     DLNO          DLNOKY
     C                   Z-ADD     ORED          OREDKY
      *                                                                                       CDL012
     C     STMTKY        CHAIN     DLTCSTV0                           16
      *                                                                                       CDL012
     C     *IN16         DOWEQ     *OFF
      *                                                                                       CDL012
     C                   DELETE    DLTCSTP1
      *                                                                                       CDL012
     C     STMTKY        READE     DLTCSTV0                               16
      *                                                                                       CDL012
     C                   ENDDO
      *                                                                                       CDL012
     C                   OPEN      DLTCSTV2
      *                                                                                       CDL012
     C     STMTKY        CHAIN     DLTCSTV2                           16
      * This extra check introduced to ensure that the previous deal                          CDL012
      * is treated as matured when the present deal has been reversed                         CDL012
      * before a statement is generated to DLTCSTPD.                                          CDL012
     C     *IN16         IFEQ      *ON
     C     RODN          CHAIN     DEALDCV0                           16
      *                                                                                       CDL012
     C     *IN16         IFEQ      *OFF
      *                                                                                       CDL012
     C                   Z-ADD     DLNO2         DLNOKY
     C                   Z-ADD     ORED2         OREDKY
      *                                                                                       CDL012
     C     STMTKY        CHAIN     DLTCSTV0                           16
      *                                                                                       CDL012
     C     *IN16         DOWEQ     *OFF
      *                                                                                       CDL012
     C                   Z-ADD     0             GRBDN
     C                   Z-ADD     0             GRBOR
     C                   MOVE      ' '           GROLI
      *                                                                                       CDL012
     C                   UPDATE    DLTCSTP1
     C     STMTKY        READE     DLTCSTV0                               16
      *                                                                                       CDL012
     C                   ENDDO
      *                                                                                       CDL012
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CDL012
     C     *IN16         DOWEQ     *OFF
      *                                                                                       CDL012
     C                   Z-ADD     0             GRBDN
     C                   Z-ADD     0             GRBOR
     C                   MOVE      ' '           GROLI
      *                                                                                       CDL012
     C                   UPDATE    DLTCSTP3
     C     STMTKY        READE     DLTCSTV2                               16
      *                                                                                       CDL012
     C                   ENDDO
     C                   CLOSE     DLTCSTV2
      *                                                                                       CDL012
     C                   CLOSE     DLTCSTV0
      *                                                                                       CDL012
     C                   MOVE      IND16         *IN16
     C                   ENDIF
      *                                                                                       CDL012
     C                   DELETE    DEALSL1                                                     S0111
      *                                                                                      BUG3937
     C*****CLE025        IFEQ      'Y'                                                      AR970738
     C**********         MOVE      DLNO          KDLNO             6                        AR970738
     C*****KDLNO         CHAIN     DLDEALL5                           89                    AR970738
     C******IN89         IFEQ      *OFF                                                     AR970738
     C**********         DELETE    DLDEALL5                                                 AR970738
     C**********         ENDIF                                                              AR970738
     C**********         ENDIF                                                              AR970738
     C/COPY WNCPYSRC,DL0280C195                                           S01408
     C                   ADD       1             NREV              5 0                         S0109
     C/COPY WNCPYSRC,DL0280C021
      *                                                                   E29588
      ** E29588 - Call MG5002 to increment the first character            E29588
      ** of the sequence part of the TRN for any messages relating to     E29588
      ** the dropped deal. nb. MG5002 can be disabled by switching on     E29588
      ** U3. If this is done please instruct the users not to insert      E29588
      ** a deal using the dropped number until all related messages       E29588
      ** have been dropped.                                               E29588
     C     *INU3         IFEQ      '0'                                                         E2958
      *                                                                   E29588
     C                   MOVEL     'DL'          MGMODI                                        E2958
     C                   MOVEL     DLNO          MGTRAN                                        E2958
      *                                                                   E29588
     C                   CALL      'MG5002'                                                    E2958
     C                   PARM                    MGMODI            2                           E2958
     C                   PARM                    MGTRAN            6                           E2958
     C                   PARM      *BLANKS       MGRTCD            1                           E2958
      *                                                                   E29588
      ** If MG5002 ends in error perform database error processing        E29588
     C     MGRTCD        IFNE      *BLANKS                                                     E2958
     C                   MOVEL     'Msg_file'    DBFILE           10             ************* E2958
     C                   MOVEL     '09'          DBASE             3             *DBERROR 009* E2958
     C                   MOVEL     DLNO          DBKEY                           ************* E2958
     C                   SETON                                        U7U8                     E2958
     C                   EXSR      *PSSR                                                       E2958
     C                   END                                                                   E2958
     C                   END                                                                   E2958
      *                                                                   E29588
     C                   END                                                    ** END 001     S0109
2047 C   47              GOTO      EOJ2
2048 C     RECR          COMP      'D'                                    53
     C  N53
2049 CANN84TOTNDM        ADD       1             TOTNDM            5 0                         E1075
2050 C   53TOTNDL        ADD       1             TOTNDL            5 0
2051 C   53              Z-ADD     TOTIL         ZZTOTI                          ACCUM NEWDL
2052 C   53              Z-ADD     TOTDL         ZZTOTD                          CONTROLS FOR
     C  N53
2053 CANN84              Z-ADD     TOTIM         ZZTOTI                         LIVE AND DELTD E1075
     C  N53
2054 CANN84              Z-ADD     TOTDM         ZZTOTD                          RECORDS.      E1075
2055 C     PAMT          DIV       1000          ZZAMT
2055 C   10UPAMT         DIV       1000          ZZAMT                                         S0111
2056 C                   EXSR      GLZADD
2057 C   53              Z-ADD     ZZTOTI        TOTIL            15 0
2058 C   53              Z-ADD     ZZTOTD        TOTDL             3 0
     C  N53
2059 CANN84              Z-ADD     ZZTOTI        TOTIM            15 0                         E1075
     C  N53
2060 CANN84              Z-ADD     ZZTOTD        TOTDM             3 0                         E1075
     C*                                                                   E10753
2062 C*****   EOJ2 IS A TAG TO SKIP CONTROL
2063 C*         ACCUMULATIONS FOR ASTERISKED DEALS
2064 C*
2065 C     EOJ2          TAG                                                    ** EOJ2 TAG **
     C/COPY WNCPYSRC,DL0280C613
     C* *IN84 WAS NOT BEING RESET IN TIME FOR NEXT DEAL                   E13170
     C   84              MOVE      '0'           *IN84                                         E1317
2066 C*
     C* TRAILER IS ALWAYS UPDATED IN NON SHADOW POST RUN                  S01117
     C     *IN06         IFEQ      '1'                                                         S0111
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01117
     C**  RESET INDICATOR FOR DEALS FILE UPDATE IF SHADOW POSTING RUN     S01093
     C     *INU1         IFEQ      '0'                                          ** IF  001     S0109
     C                   MOVE      '0'           *IN15                                         S0109
     C                   END                                                    ** END 001     S0109
     C/COPY WNCPYSRC,DL0280C521
     C**  TRAILER - UPDATE FILE CONTROLS FOR REVERSED DEALS               S01093
     C   06              SUB       NREV          NORD                                          S0109
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Charges/commission on Fiduciary Call or Time deposits and     CDL006
      ** MM Deals record to be updated. No update during shadow posting.  CDL006
      *                                                                   CDL006
     C     WUCHCO        IFEQ      'Y'                                                         CDL00
     C     WUFIDE        ANDEQ     'D'                                                         CDL00
     C     WUDXUP        ANDEQ     'Y'                                                         CDL00
     C     *INU1         ANDEQ     '1'                                                         CDL00
     C     WUCHCO        OREQ      'Y'                                                         CDL00
     C     WUFIDE        ANDEQ     'L'                                                         CDL00
     C     WUDXUP        ANDEQ     'Y'                                                         CDL00
     C     *INU1         ANDEQ     '1'                                                         CDL00
      *                                                                   CDL006
      ** Update MM Deals record DEALSDC.                                  CDL006
      *                                                                   CDL006
     C                   MOVE      '1'           *IN15                                         CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** Set up Fiduciary Deposit flag to 'N'.                            CDL006
      *                                                                   CDL006
     C                   MOVE      'N'           WUFIDE                                        CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C197                                           S01408
      *                                                                                       CDL012
     C     CDL012        IFEQ      'Y'
     C     *IN03         IFEQ      *ON
     C     *IN15         ANDEQ     *ON
      *                                                                                       CDL012
     C     DTYP          IFEQ      'TD'
     C     DTYP          OREQ      'CD'
      ** IPFR = ' '=> NIDT = 0,                                                               CDL012
     C     IPFR          IFEQ      ' '
     C                   Z-ADD     MDAT          UGNIDT
     C                   ENDIF
      *                                                                                       CDL012
     C     UGNIDT        IFEQ      0
     C     NIDT          ANDNE     0
     C                   Z-ADD     NIDT          UGNIDT
     C                   ENDIF
      *                                                                                       CDL012
     C     MDAT          IFLE      EVCD
     C     RECR          ANDEQ     'M'
     C     IPFR          ANDNE     'N'
     C     UGNIDT        ANDNE     MDAT
     C                   Z-ADD     MDAT          UGNIDT
     C                   ENDIF
      *                                                                                       CDL012
     C     UGNIDT        IFEQ      0
     C                   Z-ADD     MDAT          UGNIDT
     C                   ENDIF
      *                                                                                       CDL012
     C     EXIST         KLIST
     C                   KFLD                    DLNO
     C                   KFLD                    ORED
     C                   KFLD                    UGNIDT
      *                                                                                       CDL012
     C                   MOVE      *IN16         IND16
      *                                                                                       CDL012
     C     EXIST         CHAIN     DLTCSTV4                           16
      *                                                                                       CDL012
     C     *IN16         IFEQ      *OFF
     C                   SETOFF                                       U4
     C                   GOTO      NOADD
     C                   ENDIF
      *                                                                                       CDL012
     C     DTYP          IFEQ      'CD'
      *                                                                                       CDL012
     C     MDAT          IFLE      EVCD
     C     MDAT          ANDNE     0
     C     RECR          ANDEQ     'M'
     C     IPFR          ANDNE     'N'
      *                                                                                       CDL012
     C     UGNIDT        ORLE      EVCD
     C     RECR          ANDEQ     'M'
     C     IPFR          ANDEQ     'N'
      *                                                                                       CDL012
     C     UGNIDT        ORLE      EVCD
     C     MDAT          ANDEQ     0
     C     RECR          ANDEQ     'D'
      *                                                                                       CDL012
     C                   SETON                                        U4
      *                                                                                       CDL012
     C                   ENDIF
      *                                                                                       CDL012
     C                   ENDIF
      *                                                                                       CDL012
     C     DTYP          IFEQ      'TD'
      *                                                                                       CDL012
     C     MDAT          IFLE      EVCD
     C     RECR          ANDEQ     'M'
     C     IPFR          ANDNE     'N'
      *                                                                                       CDL012
     C     UGNIDT        ORLE      EVCD
     C     RECR          ANDEQ     'M'
     C     IPFR          ANDEQ     'N'
      *                                                                                       CDL012
     C     UGNIDT        ORLE      EVCD
     C     UGNIDT        ANDNE     0
     C     RECR          ANDEQ     'D'
     C     IPFR          ANDNE     ' '
      *                                                                                       CDL012
     C                   SETON                                        U4
      *                                                                                       CDL012
     C                   ENDIF
      *                                                                                       CDL012
     C                   ENDIF
      *                                                                                       CDL012
     C   U4              EXSR      #GOUT
      *                                                                                       CDL012
     C     NOADD         TAG
      *                                                                                       CDL012
     C                   MOVE      IND16         *IN16
      *                                                                                       CDL012
     C                   ENDIF
      *                                                                                       CDL012
     C                   ENDIF
      *                                                                                       CDL012
     C                   ENDIF
2067 C*
     C* IF THE OVERFLOW INDICATOR HAS BEEN SET ON THEN SET IT OFF         LN0884
     C* SINCE PAGE LENGTH/OVERFLOW OUTPUT HANDLED IN SR. EXCP             LN0884
     C                   MOVE      '0'           *INOF                                         LN088
     CL1                 MOVE      '0'           *INOF                                         LN088
     C*                                                                   LN0884
     C/COPY WNCPYSRC,DL0280C657
     CL1 OF              SETON                                        87                       S0111
     C/COPY WNCPYSRC,DL0280C658
     C*
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             S01194
     CLRN40              CALL      'AOBANKR0'                                                  S0119
     C                   PARM      '*MSG    '    @RTCD             7                           S0119
     C                   PARM      '*FIRST  '    @OPTN             7                           S0119
     C     @BANK         PARM      @BANK         DSFDY                                         S0119
     C*                                                                   S01194
     CLRN40@RTCD         IFNE      *BLANK                                                      S0119
     CLRN40              MOVEL     'SDBANKPD'    DBFILE           10             ************* S0119
     CLRN40              MOVEL     '08'          DBASE             3             *DBERROR 008* S0119
     CLRN40              MOVEL     @OPTN         DBOPTN            7             ************* S0119
     CLRN40              SETON                                        U7U8                     S0119
     CLRN40              EXSR      *PSSR                                                       S0119
     CLR                 END                                                                   S0119
     C/COPY WNCPYSRC,DL0280C022
     C*
2069 CLR                 SETOFF                                       6369
      *                                                                                       CAS005
      ** Generate summarised acrrual account key                                              CAS005
      *                                                                                       CAS005
     CLR   CAS004        IFEQ      'Y'
     CLR                 EXSR      SRASUM
     CLR                 ENDIF
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0280C081
     CLR   CDL012        IFEQ      'Y'
     CLR                 SETOFF                                       U4
     CLR                 ENDIF
     C**                                                                  BHF641
     C** IF NO TRAILER WAS READ (1ST CYCLE) THEN READ BOTH NOW.           BHF641
     C**                                                                  BHF641
     CLRN35*HIVAL        SETLL     DAMSX                                                       BHF64
     CLR   TOTTAG        TAG                                                    * TOTTAG TAG *
     C*
     CLR   *IN35         IFEQ      '1'
     C*
     CLR   TOTNRD        ADD       NORDAM        TOTNRD            5 0
     CLR   TOTNRA        ADD       NLRADM        TOTNRA            5 0
     CLR   *IN17         IFEQ      '0'
     CLR                 Z-ADD     TOTALI        ZZTOTI
     CLR                 Z-ADD     TOTALD        ZZTOTD
     CLR                 Z-ADD     VLAFDM        ZZAMTI
     CLR                 Z-ADD     VLALDM        ZZAMTD
     C*
     CLR                 EXSR      GLZSUM
     C*
     CLR                 Z-ADD     ZZTOTI        TOTALI           15 0
     CLR                 Z-ADD     ZZTOTD        TOTALD            3 0
     CLR                 END
     C*
     CLR                 END
     C*
     CLR                 SETOFF                                       0942
     CLR                 READ      DAMSX                                  42                   BHF64
2080 CLRN42              ADD       1             TOTDMS                                        BHF64
     C*
     CLR 09              SETON                                        35
     CLR 35
     CANN42              GOTO      TOTTAG
     C*
2075 CLR   NLRA          COMP      TOTDTD                             8383
2076 CLR 83              SETON                                        U8
2077 CLR   VLAFD         COMP      TOTDLI                                 53
2078 CLR 53VLALD         COMP      TOTDLD                                 53
2079 CLRN53              SETON                                        82U8
     C**                                                                  BHF641
     C** SUB 1 FROM TOTAL RECORDS AS HEADER DAMBRDH IS NOT IN LF/DAMSX.   BHF641
     C** IF SHADOW POSTING: ALSO,                                         LN0802
     C** SUB 2 FROM TOTAL RECORDS AS TRAILER DAMBRDJ IS NOT IN LF/DAMSX   LN0802
     C** Sub 3 from total records as Header DAPCLH (NA parcels extract)   S01378
     C** is not in LF/DAMSX                                               S01378
     C**                                                                  LN0802
     CLR U1TOTNRD        SUB       2             TOTNRD                                        S0137
     CLRNU1TOTNRD        SUB       3             TOTNRD                                        S0137
2081 CLR   TOTNRD        COMP      TOTDMS                             3737
2082 CLR 37              SETON                                        U8
2083 CLR   TOTDMD        COMP      TOTNRA                             5353
2084 CLRN53TOTDHI        COMP      TOTALI                             5353
2085 CLRN53TOTDHD        COMP      TOTALD                             5353
2086 CLR 53              SETON                                        81U8
2088 CLR   TOTNDM        ADD       TOTNDL        WORK5             5 0
2089 CLR   TOTMM         ADD       NLRA          WERK5             5 0
2090 CLR   WORK5         COMP      WERK5                                  53
     C/COPY WNCPYSRC,DL0280C082
     CLRN53              SETON                                        69U8
     C/COPY WNCPYSRC,DL0280C083
2091 C*
2092 CLR 53              Z-ADD     TOTIM         ZZAMTI
2093 CLR 53              Z-ADD     TOTDM         ZZAMTD
2094 CLR 53              Z-ADD     TOTIL         ZZTOTI
2095 CLR 53              Z-ADD     TOTDL         ZZTOTD
2096 CLR 53              EXSR      GLZSUM
2097 CLR 53              Z-ADD     ZZTOTI        WORK15           15 0
2098 CLR 53              Z-ADD     ZZTOTD        WORK3             3 0
2099 CLR 53              Z-ADD     TOTMI         ZZAMTI                                        E1046
2100 CLR 53              Z-ADD     TOTMD         ZZAMTD                                        E1046
2101 CLR 53              Z-ADD     VLAFD         ZZTOTI                                        E1016
2102 CLR 53              Z-ADD     VLALD         ZZTOTD                                        E1016
2103 CLR 53              EXSR      GLZSUM                                                      E1046
2104 CLR 53              Z-ADD     TOTNTI        ZZAMTI                                        E1049
2105 CLR 53              Z-ADD     TOTNTD        ZZAMTD                                        E1049
2106 CLR 53              EXSR      GLZSUM                                                      E1049
2107 CLR 53              Z-ADD     NETCII        ZZAMTI                                        E1016
2108 CLR 53              Z-ADD     NETCID        ZZAMTD                                        E1016
2109 CLR 53              EXSR      GLZSUM                                                      E1016
2110 CLR 53ZZTOTI        COMP      WORK15                                 53                   E1016
2111 CLR 53ZZTOTD        COMP      WORK3                                  53                   E1016
2112 CLRN53              SETON                                        63U8
2114 CLR   DKREC         ADD       1             DKREC
2115 CLR 19TNREC         ADD       1             TNREC
2116 C*
     C/COPY WNCPYSRC,DL0280C196                                           S01408
2116 C* OUTPUT MODULUS VALUE OF DEAL AMENDS - REV SIGN IF NEGATIVE        E26940
2116 CLR   TOTNTI        IFLT      0                                                           E2694
2116 CLR   0             SUB       TOTNTI        TOTNTI                                        E2694
2116 CLR                 END                                                                   E2694
2116 CLR   TOTNTD        IFLT      0                                                           E2694
2116 CLR   0             SUB       TOTNTD        TOTNTD                                        E2694
2116 CLR                 END                                                                   E2694
2116 C*                                                                   E26940
     C* TOTALS SPOOL FILE RECORDED BY RCF                                 S01117
     CLR                 Z-ADD     SFNUMU        ZSNUMU            6 0                         S0111
     CLR                 CALL      'ZSFILE'                                                    S0111
     CLR                 PARM                    SEQ                                           LN071
     CLR                 PARM      *BLANKS       @PARM             3                           S0111
     CLR                 PARM                    SFILEU                                        S0111
     CLR                 PARM                    ZSNUMU                                        S0111
     CLR                 PARM                    ZSERR             1                           S0111
     C*                                                                   S01117
     CLR   ZSERR         IFEQ      'Y'                                                         S0111
     CLR                 SETON                                        U7U8LR                   S0111
     CLR                 RETURN                                                                S0111
     CLR                 END                                                                   S0111
0509 C*                                                                   S01117
     C/COPY WNCPYSRC,DL0280C554
0179 C/EJECT                                                              S01117
2117 C********************************************************************
2118 C*
2119 C*****    EXCP IS A SUBROUTINE TO OUTPUT DKEYS  RECORDS BY
2120 C*          EXCEPTION, AND REPORT THE EVENT ACTIONED ON THE
2121 C*          PRINTER FILE.
2122 C*          FILE CONTROLS ARE ALSO MAINTAINED FOR S/DKEYS.
2123 C*
2124 C     EXCP          BEGSR                                                  *** EXCP    ***
     C***/COPY*WNCPYSRC,DL0280C572***                                                         CFC006
     C/COPY WNCPYSRC,DL0280C572                                                             MD020563
      *                                                                                       CFC006
      ** Disable indicator(s) used in printing the report                                     CFC006
      *                                                                                       CFC006
     C                   IF        SUPFLG = 'Y'                                               CFC006
     C                   EVAL      *IN11 = *OFF                                               CFC006
     C                   ENDIF                                                                CFC006
      *                                                                                       CAS009
     C                   IF        CAS009 = 'Y' AND SPRIND = 'Y' AND                          CAS009
     C                             FSAMRM = 'N' AND FSACAI = 'Y'                              CAS009
     C                   GOTO      ENDEX                                                      CAS009
     C                   ENDIF                                                                CAS009
      *                                                                                       CDL018
      ** If CDL018 is switched on, deal is a fixed deposit/loan                               CDL018
      ** and account key is a settlement account key                                          CDL018
      *                                                                                       CDL018
     C     CDL018        IFEQ      'Y'
     C     FIXDEP        ANDEQ     'Y'
     C     AKY(10)       ANDEQ     'B'
      *                                                                                       CDL018
      **  Check if multiple-settlement account keys to be produced                            CDL018
      *                                                                                       CDL018
     C                   EXSR      CHKSET
      *                                                                                       CDL018
      ** Produce multiple settlement account keys if requried                                 CDL018
      *                                                                                       CDL018
     C     MULTIF        IFEQ      'Y'
     C                   EXSR      MLTKEY
     C                   GOTO      ENDEX
     C                   ENDIF
      *                                                                                       CDL018
     C                   ENDIF
      *                                                                                       CDL018
 376 C***  CHECK NO A/C KEYS PRODUCED FOR ZERO AMOUNTS.
     C*   IF NOT IN PRINT ONLY MODE                                       S01119
     C     PRONLY        IFNE      'Y'                                                         S0111
2377 C     KYAMT         COMP      0                                  7070
2378 C  N70              GOTO      ENDEX
     C                   END                                                                   S0111
     C*   SET OFF A/C KEY GENERATION IND IF PRINT ONLY                    S01119
     C     PRONLY        IFEQ      'Y'                                                         S0111
     C                   SETOFF                                       70                       S0111
     C                   END                                                                   S0111
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
      *                                                                                       CGL020
     C     KYOSTL        IFEQ      *BLANKS
     C                   MOVE      *BLANKS       F1RACT
     C                   MOVE      *BLANKS       F1RCTY
     C                   MOVE      *BLANKS       F1RBNK
     C                   MOVE      *BLANKS       F1RCDE
     C                   MOVE      *BLANKS       F1PACT
     C                   MOVE      *BLANKS       F1PCTY
     C                   MOVE      *BLANKS       F1PBNK
     C                   MOVE      *BLANKS       F1PCDE
     C                   MOVE      *BLANKS       F1DACT
     C                   MOVE      *BLANKS       F1DCTY
     C                   MOVE      *BLANKS       F1DBNK
     C                   Z-ADD     0             F1SDAT
     C                   ELSE
      *                                                                                       CGL020
     C                   SELECT
      *                                                                                       CGL020
     C     STINFO        WHENEQ    *BLANKS
     C                   MOVE      ROCN          WWROCN
     C                   MOVE      ROBN          WWROBN
     C                   MOVE      POCN          WWPOCN
     C                   MOVE      POBN          WWPOBN
     C                   MOVE      BENN          WWBENN            8
     C                   MOVE      AWBN          WWAWBN            8
     C                   MOVE      AWBA          WWAWBA           35
     C                   MOVE      BENA          WWBENA           35
      *                                                                                       CGL020
     C     STINFO        WHENEQ    'DA'
     C                   MOVE      RROCN         WWROCN
     C                   MOVE      RROBN         WWROBN
     C**********           MOVE RPOCN     WWPOCN                                       CGL020 CDL017
     C**********           MOVE RPOBN     WWPOBN                                       CGL020 CDL017
     C**********           MOVE RBENN     WWBENN                                       CGL020 CDL017
     C**********           MOVE RAWBN     WWAWBN                                       CGL020 CDL017
     C**********           MOVE RAWBA     WWAWBA                                       CGL020 CDL017
     C**********           MOVE RBENA     WWBENA                                       CGL020 CDL017
     C                   MOVE      POCNDM        WWPOCN
     C                   MOVE      POBNDM        WWPOBN
     C                   MOVE      BENNDM        WWBENN
     C                   MOVE      AWBNDM        WWAWBN
     C                   MOVE      AWBADM        WWAWBA
     C                   MOVE      BENADM        WWBENA
      *                                                                                       CGL020
     C     STINFO        WHENEQ    'RD'
     C                   MOVE      WROCN         WWROCN
     C                   MOVE      WROBN         WWROBN
     C                   MOVE      WPOCN         WWPOCN
     C                   MOVE      WPOBN         WWPOBN
     C                   MOVE      WBENN         WWBENN
     C                   MOVE      WAWBN         WWAWBN
     C                   MOVE      WAWBA         WWAWBA
     C                   MOVE      WBENA         WWBENA
      *                                                                                       CGL020
     C     STINFO        WHENEQ    'RX'
     C                   MOVE      RXROCN        WWROCN
     C                   MOVE      RXROBN        WWROBN
     C                   MOVE      RXPOCN        WWPOCN
     C                   MOVE      RXPOBN        WWPOBN
     C                   MOVE      RXBENN        WWBENN
     C                   MOVE      RXAWBN        WWAWBN
     C                   MOVE      RXAWBA        WWAWBA
     C                   MOVE      RXBENA        WWBENA
      *                                                                                       CGL020
     C                   ENDSL
      *                                                                                       CGL020
     C                   CALL      ZAAML
     C                   PARM                    WWROCN
     C                   PARM                    WWROBN
     C                   PARM                    WWPOCN
     C                   PARM                    WWPOBN
     C                   PARM                    WWBENN
     C                   PARM                    WWBENA
     C                   PARM                    WWAWBN
     C                   PARM                    WWAWBA
     C                   PARM                    F1RACT
     C                   PARM                    F1RCTY
     C                   PARM                    F1RBNK
     C                   PARM                    F1RCDE
     C                   PARM                    F1PACT
     C                   PARM                    F1PCTY
     C                   PARM                    F1PBNK
     C                   PARM                    F1PCDE
     C                   PARM                    F1DACT
     C                   PARM                    F1DCTY
     C                   PARM                    F1DBNK
      *                                                                                       CGL020
     C     *IN02         IFEQ      *ON
     C     *IN05         OREQ      *ON
     C                   MOVE      VDAT          F1SDAT
     C                   ELSE
     C                   MOVE      MDAT          F1SDAT
     C                   ENDIF
      *                                                                                       CGL020
     C                   ENDIF
      *                                                                                       CGL020
     C                   ENDIF
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CCP5                                           S01408
2126 C*
2127 C*****  SET AMOUNT EDIT INDS FOR NON FX
2128 C*
     C   43
2129 CANN02              SETON                                        73
     C   44
2130 CANN02              SETON                                        74
     C   45
2131 CANN02              SETON                                        75
     C   46
2132 CANN02              SETON                                        76
2133 C*
     C** Do not output the Sale Currency field if deal is not FX.         E26172
     C     *IN02         IFEQ      '0'                                                         E2617
     C                   MOVE      *BLANKS       SALCY                                         E2617
     C                   END                                                                   E2617
     C*                                                                   E26172
2134 C   03                                                                                    E1140
2135 COR 04                                                                                    E1140
2136 COR 05              Z-ADD     NARRAT        NRRT             11 7                         E1140
2137 C*
     C   47
2138 CAN 71              MOVEL     NEV(7)        NARREV
2139 C   71              Z-ADD     KYDAT         ZDAYNO
2140 C   71              EXSR      ZDATE2
2141 C   71              MOVE      ZADATE        NARDTE            7
     C     PRONLY        IFNE      'Y'                                                         S0111
     C/COPY WNCPYSRC,DL0280C659
     C     KYAMT         DIV       1000          ZZAMT                                         13462
     C     ZZAMT         IFLT      0                                                           13462
     C                   Z-SUB     ZZAMT         ZZAMT                                         13462
     C                   ENDIF                                                                 13462
     C/COPY WNCPYSRC,DL0280C660
2144 C                   Z-ADD     TOTDKI        ZZTOTI                              CONTROLS
2145 C                   Z-ADD     TOTDKD        ZZTOTD
     C                   EXSR      GLZADD
2147 C                   Z-ADD     ZZTOTI        TOTDKI           15 0
2148 C                   Z-ADD     ZZTOTD        TOTDKD            3 0
     C                   END                                                                   S0111
2149 C   71TAXA          COMP      0                                  2424      TAX AMT NOT 0
     C/COPY WNCPYSRC,DL0280C173                                           S01408
      *                                                                                       CDL033
      ** Report old effective rate for CF deal if this is                                     CDL033
      ** not a reversal and event date is equal to rate                                       CDL033
      ** change date.                                                                         CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     *IN03         ANDEQ     *ON                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
     C     KYDAT         ANDEQ     DLRC                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     *IN03         ANDEQ     *ON                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
     C     *IN47         ANDEQ     *OFF                                                       CDL033
     C     KYDAT         ANDEQ     DLRC                                                       CDL033
     C                   Z-ADD     WCFRAT        NRRT                                         CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C     RPAGE1        IFEQ      1                                                           S0111
     C     *IN71         ANDEQ     '1'                                                         S0111
     C/COPY WNCPYSRC,DL0280C662
     C     *IN87         OREQ      '1'                                                         S0111
     C/COPY WNCPYSRC,DL0280C661
     C                   SETON                                        OF                       S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C667
     C*
     C   87              SETOFF                                       87                       E1012
     C/COPY WNCPYSRC,DL0280C668
     C*
     C                   SETOFF                                       OF                       S0111
     C*                                                                   S01117
     C**     IF THE CURRENT RECORD IS TO BE PRINTED, THENCHECK THE        S01117
     C**     NUMBER OF LINES THAT WILL HAVE BEEN PRINTED AND SET THE      S01117
     C**     OVERFLOW INDICATOR IF NECESSARY                              S01117
     C*                                                                   S01117
     C   71PLINES        IFGE      60                                           OVERFLOW LINE  LN088
     C**                                                                  LN0884
     C*  Z-ADD 13 IF MULTIBRANCHED ELSE Z-ADD 11 (BRANCH HEADINGS TAKE    LN0884
     C*  UP TWO LINES IF MULTIBRANCHED)                                   LN0884
     C     BGMBIN        IFEQ      'Y'                                                         LN088
     C   71              Z-ADD     13            PLINES            2 0                         LN088
     C                   ELSE                                                                  LN088
     C   71              Z-ADD     11            PLINES            2 0                         S0111
     C                   END                                                                   LN088
     C**                                                                  LN0884
     C                   END                                                                   S0111
     C** IF MULTIBRANCHED AND PLINES = 13 OR NOT MB AND PLINES = 11       LN0884
     C** THEN SET ON OVERFLOW INDICATOR TO OUTPUT NEW PAGE                LN0884
     C     BGMBIN        IFEQ      'Y'                                                         LN088
     C     PLINES        ANDEQ     13                                                          LN088
     C     BGMBIN        ORNE      'Y'                                                         LN088
     C     PLINES        ANDEQ     11                                                          LN088
     C   71              SETON                                        OF                       S0111
     C                   ELSE                                                                  S0111
     C   71              SETOFF                                       OF                       S0111
     C                   END                                                                   S0111
     C   71              ADD       1             PLINES
     C   71              SETON                                            12                   LN071
     C/COPY WNCPYSRC,DL0280C714
     C*
2150 C                   EXCEPT
     C                   SETOFF                                       OF                       S0111
     C                   Z-ADD     0             RPAGE1                                        S0111
     C   04              SETOFF                                       71
     C     PRONLY        IFNE      'Y'                                                         S0111
2151 C     DKREC         ADD       1             DKREC             5 0
2152 C     DKRECD        ADD       1             DKRECD            5 0
     C                   END                                                                   S0111
2407 C     ENDEX         TAG                                                    ** ENDEX TAG **
2408 C  N04              Z-ADD     0             NRRPUR
2409 C  N04              Z-ADD     0             NRRSAL
2410 C                   SETOFF                                       70
2411 C  N04              SETOFF                                       71
2156 C  N02              SETOFF                                       737475
2157 C  N02              SETOFF                                       76
     C                   MOVE      ' '           PRONLY            1                           S0111
     C                   MOVE      *BLANK        SPRIND            1                          CAS009
     C/COPY WNCPYSRC,DL0280C530
2158 C                   ENDSR
2159 C*
     C/COPY DLCPYSRC,DL0280GNPI                                                              BUG6293
     C/COPY WNCPYSRC,DL0280C673
     C********************************************************************S01440
     C*                                                                   S01440
     C*  SR/CALCCP - calculate GCSCAP and GCPCAP                          S01440
     C*                                                                   S01440
     C********************************************************************S01440
     C*                                                                   S01440
     C     CALCCP        BEGSR                                                                 S0144
      *                                                                   S01440
      ** Save old values of GCPCAP and GCSCAP                             S01440
      *                                                                   S01440
     C                   Z-ADD     GCPCAP        OLPCAP           13 0                         S0144
     C                   Z-ADD     GCSCAP        OLSCAP           13 0                         S0144
      *                                                                   S01440
      ** Life of deal = value date minus deal date                        S01440
      *                                                                   S01440
     C     VDAT          SUB       DDAT          UXLIFO            5 0                         S0144
     C     UXLIFO        IFEQ      0                                                           S0144
     C                   ADD       1             UXLIFO                                        S0144
     C                   END                                                                   S0144
      *                                                                   S01440
      ** Calculate 'life elapsed'                                         S01440
      *                                                                   S01440
     C     VDAT          IFGT      EVCD                                                        S0144
     C     EVCD          SUB       DDAT          UXLIFE            5 0                         S0144
     C                   ELSE                                                                  s0144
     C     VDAT          SUB       DDAT          UXLIFE                                        S0144
     C                   END                                                                   S0144
      *                                                                   S01440
      ** If 1st day accruals add 1 day to the 'life elapsed'              S01440
      *                                                                   S01440
     C     *IN29         IFEQ      '0'                                                         S0144
     C     VDAT          ANDGT     EVCD                                                        10448
     C                   ADD       1             UXLIFE                                        S0144
     C                   END                                                                   S0144
     C/COPY WNCPYSRC,DL0280C566
      *                                                                   S01440
      ** New GCPCAP = 'life elapsed' x PAMT / life of deal                S01440
      *                                                                   S01440
     C     UXLIFE        MULT(H)   PAMT          UXWRK1           18 0                         S0144
     C     UXWRK1        DIV(H)    UXLIFO        GCPCAP                                        S0144
      *                                                                   S01440
      ** 'Purchase currency amount to post' = new GCPCAP minus the        S01440
      ** old GCPCAP                                                       S01440
      *                                                                   S01440
     C     GCPCAP        SUB(H)    OLPCAP        PCAPOT           13 0                         S0144
      *                                                                   S01440
      ** New SCAP = 'life elapsed' x SLAM / life of deal                  S01440
      *                                                                   S01440
     C     UXLIFE        MULT(H)   SLAM          UXWRK2           18 0                         S0144
     C     UXWRK2        DIV(H)    UXLIFO        GCSCAP                                        S0144
      *                                                                   S01440
      ** 'Sell currency amount to post' = new GCSCAP minus the old        S01440
      ** GCSCAP                                                           S01440
      *                                                                   S01440
     C     GCSCAP        SUB(H)    OLSCAP        SCAPOT           13 0                         S0144
     C*                                                                   S01440
     C                   ENDSR                                                                 S0144
2161 C********************************************************************
     C/COPY WNCPYSRC,DL0280C457
     C********************************************************************080603
     C*                                                                   080603
     C** SR/INTREV  - Reverse Interest Paid/Capitalised Todate and Taxes  080603
     C*                                                                   080603
     C********************************************************************080603
     C*                                                                   080603
     C     INTREV        BEGSR                                                                 08060
     C/COPY WNCPYSRC,DL0280C185                                           S01408
     C*                                                                   080603
     C     INTRVT        IFEQ      'P'                                                         11703
     C                   Z-ADD     WORKD         KYAMT                             TO DATE     08060
     C                   ELSE                                                                  11703
     C     WORKD         SUB       TAXA          KYAMT                             TO DATE     11703
     C                   END                                                                   11703
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C216                                           S01408
     C*                                                                   S01408
2781 C     RECR          IFNE      'M'                                          B 001          08060
     C     INTRVT        ANDEQ     'C'                                                         11703
2781 C                   MOVE      'C'           AKY(10)                                       08060
2781 C                   ELSE                                                                  08060
     C/COPY WNCPYSRC,DL0280C515
2781 C                   MOVE      'I'           AKY(10)                                       08060
2781 C                   END                                                    E 001          08060
     C/COPY WNCPYSRC,DL0280C217                                           S01408
     C*                                                                   080603
     C**   IF INTEREST IS TO BE POSTED SEPARATELY, USE THE INTEREST       080603
     C**   SETTLEMENT INSTRUCTIONS (IF PRESENT) INSTEAD OF MATURITY       080603
     C**   INSTRUCTIONS                                                   080603
     C*                                                                   080603
     C     IPDS          IFEQ      'Y'                                          B 001          08060
     C***  IMET          ANDNE     *BLANKS                                              08060 237562
     C     IMET          IFNE      *BLANKS                                                    237562
     C     IMET          ANDNE     *ZEROS                                                      08060
     C                   MOVE      IMET          KYSETL                                        08060
     C                   MOVEL     INSA          KYOSTL                                        08060
     C                   ENDIF                                                  E 001          08060
      *                                                                                       237562
      ** Save the original value of settlement branch.                                        237562
      *                                                                                       237562
     C                   MOVE      KYSTBR        @STBR             3                          237562
     C                   EXSR      INTACC                                                     237562
     C                   ENDIF                                                                237562
      *                                                                   CAC001
     C     WORKD         IFNE      0                                                           CAC00
2781 C*                                                                   080603
2723 C                   Z-ADD     KYAMT         NRRSAL                                        08060
     C/COPY WNCPYSRC,DL0280C186                                           S01408
     C     INTRVT        IFEQ      'P'                                                         11703
2724 C     KYAMT         SUB       TAXA          NRRSAL                                        08060
     C                   END                                                                   11703
     C/COPY WNCPYSRC,DL0280C187                                           S01408
2725 C                   Z-ADD     NRRSAL        ARW1             13 0                         08060
2726 C                   SETON                                        71                       08060
     C*                                                                   080603
     C*    Check Taxable Key required                                     080603
     C*                                                                   080603
     C     S01460        IFEQ      'Y'                                          B 001          08060
     C     *IN23         ANDEQ     *ON                                                         08060
     C     CGL165        OREQ      'Y'                                                        CGL165
     C     *IN23         ANDEQ     *ON                                                        CGL165
     C                   MOVE      'T'           AKY(9)                                        08060
     C                   ENDIF                                                  E 001          08060
     C*                                                                   S01408
     C     CDL013        IFEQ      '1'                                                        CDL013
     C     BBCSTY        IFEQ      'C'                                                        CDL013
     C     S01460        ANDEQ     'Y'                                                      AR809735
     C     *IN23         ANDEQ     *ON                                                      AR809735
     C                   MOVE      'C'           AKY(6)                                       CDL013
     C                   ELSE                                                                 CDL013
     C                   MOVE      ' '           AKY(6)                                       CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280C112                                           S01408
     C*                                                                   080603
0974 C                   EXSR      EXCP                                                        08060
     C/COPY WNCPYSRC,DLH00071
      *                                                                                       237562
      ** Return the previous value of settlement branch.                                      237562
      *                                                                                       237562
     C     IPDS          IFEQ      'Y'                                                        237562
     C                   MOVE      @STBR         KYSTBR                                       237562
     C                   END                                                                  237562
      *                                                                                       237562
     C/COPY WNCPYSRC,DL0280C516
0977 C                   MOVE      ' '           AKY(9)                                        08060
     C     CDL013        IFEQ      '1'                                                      AR950258
     C                   MOVE      ' '           AKY(6)                                     AR950258
     C                   ENDIF                                                              AR950258
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Fiduciary Deposits with Commission paid/received to date.     CDL006
      *                                                                   CDL006
     C     WUFIDE        IFEQ      'D'                                                         CDL00
     C     FCPRD         ANDNE     0                                                           CDL00
     C     WUFIDE        OREQ      'L'                                                         CDL00
     C     FCPRD         ANDNE     0                                                           CDL00
      *                                                                   CDL006
      ** Initialize Commission and Tax on commission used to              CDL006
      ** calculate Net amount to be settled.                              CDL006
      *                                                                   CDL006
     C                   Z-ADD     0             W0FCMA           13 0                         CDL00
      *                                                                   CDL006
      ** Build Commission paid/received to date Account Key.              CDL006
      *                                                                   CDL006
     C                   MOVE      'I'           AKY(3)                                        CDL00
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
     C                   MOVEA     'OC'          AKY(9)                                        CDL00
      *                                                                   CDL006
     C                   Z-ADD     FCPRD         KYAMT                                         CDL00
     C                   Z-ADD     FCPRD         W0FCMA                                        CDL00
      *                                                                   CDL006
      ** Generate Commission paid/received to date Account Key.           CDL006
      *                                                                   CDL006
     C                   EXSR      EXCP                                                        CDL00
     C                   MOVE      ' '           AKY(9)                                        CDL00
      *                                                                   CDL006
      ** If Commission due to agent.                                      CDL006
      *                                                                   CDL006
     C     BBAGNT        IFNE      *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** Build Commission paid/received to date x Agent's                 CDL006
      ** percentage Account Key.                                          CDL006
      *                                                                   CDL006
     C                   MOVE      'I'           AKY(3)                                        CDL00
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
     C                   MOVEA     'AC'          AKY(9)                                        CDL00
      *                                                                   CDL006
     C     FCPRD         MULT      BBAGNP        W018D3           18 3                         CDL00
     C     W018D3        DIV       100           KYAMT                                         CDL00
      *                                                                   CDL006
      ** Generate Commission paid/received to date x Agent's              CDL006
      ** percentage Account Key.                                          CDL006
      *                                                                   CDL006
     C                   EXSR      EXCP                                                        CDL00
     C                   MOVE      ' '           AKY(9)                                        CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C     CDL013        IFEQ      '1'                                                        CDL013
     C                   MOVE      ' '           AKY(6)                                       CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280C113                                           S01408
     C*                                                                   080603
     C* If the deal is Taxable                                            080603
     C*                                                                   080603
     C     *IN25         IFEQ      *ON                                          B 001          08060
      *                                                                   CDL006
      ** Or feature CDL006 installed.                                     CDL006
      *                                                                   CDL006
     C     CDL006        OREQ      'Y'                                                         CDL00
      *                                                                   CDL006
      **  If the deal is Taxable.                                         CDL006
      *                                                                   CDL006
     C     *IN25         IFEQ      '1'                                                         CDL00
     C/COPY WNCPYSRC,DL0280C188                                           S01408
     C*                                                                   080603
     C* IF BRT SAR IS INSTALLED,                                          080603
     C*                                                                   080603
     C     S01383        IFEQ      'Y'                                          B 002          08060
     C*                                                                   080603
     C     PCCY          IFEQ      BLCYCD                                                      11703
     C                   MOVE      'B'           AKY(9)                                        11703
     C                   END                                                                   11703
     C                   MOVE      'I'           AKY(3)                                        11703
     C                   MOVE      'T'           AKY(10)                                       11703
     C                   Z-ADD     TAXA          KYAMT                                         11703
     C                   EXSR      EXCP                                                        11703
     C                   MOVE      ' '           AKY(9)                                        11703
     C*                                                                   117032
     C     PCCY          IFNE      BLCYCD                                                      11703
1160 C                   Z-ADD     TAXA          CYBRAM                                        08060
     C                   EXSR      GENBRT                                                      11703
2781 C   U8              GOTO      ENDIRV                                                      08060
2781 C                   END                                                    E 003          08060
2781 C*                                                                   080603
     C                   ELSE                                                                  11703
0975 C*                                                                   080603
0976 C**   Generate a Tax amount                                          080603
0975 C*                                                                   080603
2741 C                   MOVE      'I'           AKY(3)                                        08060
0977 C                   MOVE      'T'           AKY(10)                                       08060
0978 C                   Z-ADD     TAXA          KYAMT                                         08060
     C*                                                                   S01408
     C     CDL013        IFEQ      '1'                                                        CDL013
     C     BBCSTY        IFEQ      'C'                                                        CDL013
     C                   MOVE      'C'           AKY(6)                                       CDL013
     C                   ELSE                                                                 CDL013
     C                   MOVE      ' '           AKY(6)                                       CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280C114                                           S01408
     C*                                                                   S01408
0979 C                   EXSR      EXCP                                                        08060
     C     CDL013        IFEQ      '1'                                                      AR950258
     C                   MOVE      ' '           AKY(6)                                     AR950258
     C                   ENDIF                                                              AR950258
     C                   END                                                                   11703
0980 C*                                                                   080603
0981 C**  Generate Net Interest Key                                       080603
     C*                                                                   S01408
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C218                                           S01408
      *                                                                                       237562
      ** If interest is to be posted separately, use the Interest                             237562
      ** settlement instructions (if present) instead of Maturity                             237562
      ** settlement instructions.                                                             237562
      *                                                                                       237562
     C     IPDS          IFEQ      'Y'                                                        237562
     C     IMET          IFNE      *BLANKS                                                    237562
     C     IMET          ANDNE     *ZEROS                                                     237562
     C                   MOVE      IMET          KYSETL                                       237562
     C                   MOVEL     INSA          KYOSTL                                       237562
     C                   ENDIF                                                                237562
      *                                                                                       237562
      ** Save the original value of settlement branch.                                        237562
      *                                                                                       237562
     C                   MOVE      KYSTBR        @STBR             3                          237562
     C                   EXSR      INTACC                                                     237562
     C                   ENDIF                                                                237562
     C*                                                                   S01408
2781 C     RECR          IFNE      'M'                                          B 002          08060
     C     AMTP          ANDEQ     'CI'                                                        10198
     C     RECR          ORNE      'M'                                                         13160
     C     INTC          ANDEQ     'Y'                                                         13160
2781 C                   MOVE      'C'           AKY(10)                                       08060
2781 C                   ELSE                                                                  08060
2781 C                   MOVE      'N'           AKY(10)                                       08060
2781 C                   END                                                    E 002          08060
2781 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C189                                           S01408
     C                   Z-ADD     WORKD         KYAMT                                         CDL00
      *                                                                   CDL006
      ** If the Deal is taxable.                                          CDL006
      *                                                                   CDL006
     C     *IN25         IFEQ      '1'                                                         CDL00
     C                   SUB       TAXA          KYAMT                                         CDL00
     C                   END                                                                   CDL00
      *                                                                   CDL006
      ** If feature CDL006 installed.                                     CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Fiduciary Deposit with Commission paid/received to date.      CDL006
      *                                                                   CDL006
     C     WUFIDE        IFEQ      'D'                                                         CDL00
     C     FCPRD         ANDNE     0                                                           CDL00
     C     WUFIDE        OREQ      'L'                                                         CDL00
     C     FCPRD         ANDNE     0                                                           CDL00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C     AKY(10)       ANDEQ     'N'
     C                   MOVE      'N'           F1FFLG
     C                   Z-ADD     W0FCMA        F1FVAL
     C                   Z-ADD     0             WKAMT
     C     KYAMT         IFNE      0
     C     W0FCMA        DIV(H)    KYAMT         WKAMT
     C     WKAMT         MULT      100           F1FPCT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CGL020
     C                   SUB       W0FCMA        KYAMT                                         CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C190                                           S01408
2751 C                   EXSR      EXCP                                                        08060
      *                                                                                       237562
      ** Return the previous value of settlement branch.                                      237562
      *                                                                                       237562
     C     IPDS          IFEQ      'Y'                                                        237562
     C                   MOVE      @STBR         KYSTBR                                       237562
     C                   END                                                                  237562
     C     CDL013        IFEQ      '1'                                                        CDL013
     C                   MOVE      ' '           AKY(6)                                       CDL013
     C     DLPOST        IFEQ      'Y'                                                        CDL013
     C                   MOVE      'Y'           WREVIN            1                          CDL013
     C                   Z-ADD     KYDAT         WEVTDT                                       CDL013
     C                   EXSR      #UHEXP                                                     CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C115                                           S01408
     C*                                                                   S01408
2781 C                   ENDIF                                                  E 001          08060
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
      ** Generate Interest Reversal keys for Loans/Deposits               CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C     WRKD          ANDNE     0                                                           CAC00
      *                                                                   CAC001
     C                   Z-ADD     WRKD          KYAMT                                         CAC00
      *                                                                   CAC001
      ** Interim COF Due - Transaction Profit Centre                      CAC001
      *                                                                   CAC001
     C                   MOVE      'I'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Interim COF Due - Funding Profit Centre                          CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                                 CAC00
      *                                                                                       233324
      ** EU a/c key generation for Money Market & Loans                                       233324
      *                                                                                       233324
     C     CGL031        IFEQ      'Y'                                                        233324
      *                                                                                       233565
     C     DTYP          IFEQ      'CD'                                                       233565
     C     DTYP          OREQ      'TD'                                                       233565
     C     DTYP          OREQ      'DT'                                                       233565
     C     CDL006        ANDEQ     'Y'                                                        233565
     C     DTYP          OREQ      'DP'                                                       233565
     C     CDL006        ANDEQ     'Y'                                                        233565
     C                   EXSR      SREADC                                                     233324
     C                   ENDIF                                                                233565
      *                                                                                       233565
     C                   ENDIF                                                                233324
      *                                                                                       233324
0975 C*                                                                   080603
     C**   Restore Maturity Instructions                                  080603
     C*                                                                   080603
     C                   Z-ADD     MDST          KYSETL                                        08060
     C                   MOVE      OMDA          KYOSTL                                        08060
     C/COPY WNCPYSRC,DL0280C207                                           S01408
     C     ENDIRV        ENDSR                                                                 08060
2190 C********************************************************************080603
     C/COPY WNCPYSRC,DL0280C458
2190 C********************************************************************S01383
2191 C*                                                                   S01383
2192 C*  SR/CALBRT - CALCULATE BRT TAX AMOUNT                             S01383
     C*                                                                   S01383
2190 C********************************************************************S01383
     C*                                                                   S01383
     C     CALBRT        BEGSR                                                                 S0138
     C*                                                                   S01383
     C** CALCULATE TAX AMOUNT USING BRT RATES                             S01383
     C*                                                                   S01383
     C** CHAIN TO SDCBRTL1 FOR TAX INDICATOR                              S01383
     C*                                                                   S01383
     C     CNUM          CHAIN     SDCBRTL1                           18                       S0138
     C***18*****         SETON                                        88LRU8          S0138 AR547995
     C   18              SETON                                        88LRU7                AR547995
     C***18****          Z-ADD     CNUM          XKEY              6 0                  S0138 CSD027
     C   18              MOVE      CNUM          XKEY              6                          CSD027
     C   18              GOTO      CALBR9                                                      S0138
     C*                                                                   S01383
     C** IF THE EVENT DATE IS GREATER THAN OR EQUAL TO THE EFFECTIVE DATE,S01383
     C** USE THE BRT RATE ELSE USE THE PREVIOUS RATE                      S01383
     C*                                                                   S01383
     C/COPY WNCPYSRC,DL0280CP18                                           S01408
     C*                                                                   S01408
     C     WKMDAT        IFGE      DEFF                                                        S0138
     C     TAXIND        ANDEQ     'L'                                                         S0138
     C     WORKD         MULT(H)   BRTR          TAXA                                          S0138
1098 C     TAXA          DIV(H)    100           TAXA                                          S0138
     C                   END                                                                   S0138
     C*                                                                   S01383
     C     WKMDAT        IFGE      DEFF                                                        S0138
     C     TAXIND        ANDEQ     'P'                                                         S0138
     C     WORKD         MULT(H)   WBRTR         TAXA                                          S0138
1098 C     TAXA          DIV(H)    100           TAXA                                          S0138
     C                   END                                                                   S0138
     C*                                                                   S01383
     C     WKMDAT        IFLT      DEFF                                                        S0138
     C     TAXIND        ANDEQ     'L'                                                         S0138
     C     WORKD         MULT(H)   PBRTR         TAXA                                          S0138
1098 C     TAXA          DIV(H)    100           TAXA                                          S0138
     C                   END                                                                   S0138
     C*                                                                   S01383
     C     WKMDAT        IFLT      DEFF                                                        S0138
     C     TAXIND        ANDEQ     'P'                                                         S0138
     C     WORKD         MULT(H)   WPBRTR        TAXA                                          S0138
1098 C     TAXA          DIV(H)    100           TAXA                                          S0138
     C                   END                                                                   S0138
     C*                                                                   S01383
     C/COPY WNCPYSRC,DL0280C108                                           S01408
     C*                                                                   S01408
     C*                                                                   S01383
     C     CALBR9        ENDSR                                                                 S0138
     C/EJECT                                                              S01383
     C/COPY DLCPYSRC,DL0280CNVB                                                              BUG6293
     C/COPY DLCPYSRC,DL0280GENB                                                              BUG6293
     C/COPY WNCPYSRC,DL0280C459
     C/COPY DLCPYSRC,DL0280CNVE                                                               CDL033
     C*                                                                   S01383
     C/EJECT                                                              S01383
     C*                                                                   S01383
     C/COPY DLCPYSRC,DL0280IINT                                                              BUG6293
     C/COPY WNCPYSRC,DL0280C174                                           S01408
      *                                                                                       CIR007
     C/COPY DLCPYSRC,DL0280SREX                                                              BUG6293
     C/EJECT                                                                                  CIR007
     C/COPY DLCPYSRC,DL0280ZA09                                                               CDL033
     C*****************************************************************   S01383
     C/EJECT                                                              S01383
     C/COPY DLCPYSRC,DL0280WRIS                                                               CDL033
     C/EJECT                                                              S01383
     C/COPY DLCPYSRC,DL0280EXCP                                                               CDL033
2188 C*
2190 C********************************************************************
2191 C*
2192 C*****     DLAMND IS A SUBROUTINE TO PROCESS DEAL AMENDMENTS
2193 C*          FOR EACH PARTICULAR DEAL, IN CHRONOLOGICAL EVENT
2194 C*          DATE SEQUENCE. THE EVENT DATE CURRENTLY BEING
2195 C*          PROCESSED IS SUPPLIED BY THE PARAMETER'PARDAT'. IF
2196 C*          THERE ARE NO MORE DEAL AMENDMENTS FOR A PARTICULAR
2197 C*          DEAL, THE DEAL AMEND.INDICATOR 41 IS SWITCHED OFF.
2198 C*
2199 C     DLAMND        BEGSR                                                  *** DLAMND  ***
2200 C     DLMTAG        TAG                                                    **  DLMTAG TAG
2201 C                   SETON                                            60
     C**********         IF        AMTP <> 'BC'                                    AR853123 MD023042
     C**********         EVAL      *IN36 = '0'                                     AR853123 MD023042
     C**********         ENDIF                                                     AR853123 MD023042
2202 C*
2203 C*    SKIP PROCESSING FOR CONTROL RECORD
2204 C     AMTP          COMP      'CO'                                   53
2205 C   53              GOTO      GETDM
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     AMTP          ANDEQ     'FI'                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
     C     AMTP          ANDEQ     'FI'                                                       CDL033
     C                   MOVE      '1'           *IN53                                        CDL033
     C                   GOTO      GETDM                                                      CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
2206 C     VDATDM        COMP      PARDAT                             53
     C**  BASE RATE CHANGE APPLIED TO A FORWARD VALUED DEAL MUST BE
     C**  ACTIONED.SUCH A BASE RATE CH. WILL HAVE A VALUE DATE SET EQ TO
     C**  THE IACD FOR DEAL (AS OTHERS FOR WHICH THE V DATE OF THE BASE
     C**  RATE CHANGE IS , IACD).FOR A FWD VALUED DEAL THIS WILL ALSO EQ
     C**  THE VALUE DATE OF DEAL.NB BASE RATE CH V DATES SET IN DL0250
     C  N53AMTP          COMP      'BR'                                   55
     C  N53VDATDM        COMP      VDAT                                   55
     C  N53
     CANN55VDATDM        COMP      EVCD                               53         NOT WANTED
      *                                                                                     AR866124
      ** If a base rate change occurs for a deal, re-compute                                AR866124
      ** for the total interest field.                                                      AR866124
      *                                                                                     AR866124
     C                   EXSR      RCALTOTI                                                 AR866124
      *                                                                                     AR866124
2208 C   53              GOTO      ENDLM
      *                                                                   CPB001
      **  If Replication Processing required.                             CPB001
     C     REPLIC        IFEQ      'Y'                                          Begin REPLIC   CPB00
      *                                                                   CPB001
      **  If Amendment Type is Base Rate Change.                          CPB001
     C     AMTP          IFEQ      'BR'                                         Begin 'BR'     CPB00
     C                   EXSR      SRREPI                                                      CPB00
      *                                                                   CPB001
      ** If any error occurred while executing subroutine REPLIC.         CPB001
     C     *INU8         IFEQ      *ON                                          Begin *INU8    CPB00
     C                   GOTO      ENDLM                                                       CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End *INU8      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End 'BR'       CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End REPLIC     CPB00
     C/COPY WNCPYSRC,DL0280C503
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
2209 C*
2210 C*****     DETERMINE AMENDMENT TYPE
2211 C*
2212 C*********************SETOF                     5859                 S01119
     C                   SETOFF                                       58                       S0111
     C** Check for parcelled nostro sale, 'NS',                           S01378
     C     AMTP          COMP      'NS'                                   53                   S0137
     C   53              GOTO      NSTYP                                                       S0137
2214 C     AMTP          COMP      'BR'                                   55
     C  N55AMTP          COMP      'BC'                                   55
2215 C     AMTP          COMP      'PI'                                   56
2216 C     AMTP          COMP      'PD'                                   57
     C*                                                                   S01486
     C** IF PM INSTALLED, CALCULATE FX RATE                               S01486
     C     BGPFMG        IFEQ      'Y'                                                         S0148
     C     *IN57         ANDEQ     '1'                                                         S0148
     C     PTFR          ANDNE     *BLANKS                                                     S0148
     C                   EXSR      P02                                                         S0148
     C     WWERRF        CABEQ     'Y'           EOJ                                           S0148
     C                   END                                                                   S0148
      *                                                                                       CDL017
      ** Process EM - Early Maturity amendment type                                           CDL017
      *                                                                                       CDL017
     C     AMTP          IFEQ      'EM'
     C                   EXSR      SREMAT
     C                   GOTO      GETDM
     C                   ENDIF
      *                                                                                       CDL017
2218 C   55                                                                                    S0111
2219 COR 56
2220 COR 57              GOTO      SCTYP
2213 C     AMTP          IFNE      'SC'                                                        S0111
2221 C     AMTP          COMP      'SI'                                   58
2222 C   58              GOTO      SITYP
     C/COPY WNCPYSRC,DL0280C460
     C     AMTP          COMP      'CI'                                   58                   08060
     C   58              GOTO      SITYP                                                       08060
     C/COPY WNCPYSRC,DL0280C461
2225 C**********         SETON                                        U8LR78                AR547995
     C                   SETON                                        U7LR78                AR547995
2226 C                   GOTO      ENDLM
2213 C                   END                                                                   S0111
2227 C*
2228 C*****     SCTYP IS A ROUTINE TO HANDLE INITIAL PROCESSING OF
2229 C*          AMENDMENT TYPES SC,BR,PI,PD.
2230 C*
2231 C     SCTYP         TAG                                                    ** SCTYP TAG **
     C/COPY WNCPYSRC,DL0280C043
      *                                                                   CAC001
      ** GLINTC calculation and update of IACD should not be done         CAC001
      ** if Interest Rate Change Flag is <> 'Y'  for SC amendment.        CAC001
      *                                                                   CAC001
     C     AMTP          IFNE      'SC'                                                        CAC00
     C     AMTP          OREQ      'SC'                                                        CAC00
     C     IRCF          ANDEQ     'Y'                                                         CAC00
     C     BGN0ST        ANDEQ     'Y'                                                         CAC00
     C     BGN0ST        OREQ      'N'                                                         CAC00
      *                                                                   CAC001
     C********** CDL020    IFEQ 'Y'                                                  BUG3620 BUG7944
     C********** AMTP      ANDEQ'SC'                                                 BUG3620 BUG7944
     C**N04***** BRTEDM    ADD  RTSPDM    INTR                                       BUG3620 BUG7944
     C**********           ENDIF                                                     BUG3620 BUG7944
      *                                                                              BUG3620 BUG7944
2232 C  N04              Z-ADD     INTR          NARRAT
2233 C                   Z-ADD     IACD          ZIBEG
2234 C                   Z-ADD     VDATDM        ZIEND
2235 C                   Z-ADD     PAMT          ZIAMT
2236 C                   Z-ADD     ICBS          ZICALC
2237 C                   Z-ADD     INTR          ZIRATE
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP34                                           S01408
      *                                                                   S01408
      ** If 'UseHistRateforBVDeal' is Y and multiple base rate change                       MD031283
      ** detected then use the historic base rate for backdated MM deals                    MD031283
      *                                                                                     MD031283
     C                   IF        HSTRAT = 'Y' AND                                         MD031283
     C                             CtrBV  > 0                                               MD031283
2238 C                   EXSR      DLBRCP                                                   MD031283
2238 C                   ELSE                                                               MD031283
2238  *                                                                                     MD031283
2238 C                   EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP35                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
      *                                                                                     MD031283
2238 C                   ENDIF                                                              MD031283
     C*                                                                   066550
     C/COPY WNCPYSRC,DL0280C416
2239 C     AITC          ADD       WKINT         AITC
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C                   Z-ADD     INTR          WRKINT
     C                   EXSR      SRNTR
      *                                                                                       CAS005
     C                   Z-ADD     IACD          ZIBEG
     C                   Z-ADD     VDATDM        ZIEND
     C                   Z-ADD     FSPAMT        ZIAMT
     C                   Z-ADD     ICBS          ZICALC
     C                   Z-ADD     WKINTR        ZIRATE
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
     C     FSAITN        ADD       WINTST        FSAITN
      *                                                                                       CAS005
     C                   ENDIF
      *                                                                                       CAS005
2240 C                   Z-ADD     VDATDM        IACD
     C/COPY WNCPYSRC,DL0280C417
     C                   ENDIF                                                                 CAC00
      *                                                                                       CDL034
      ** Save accrued interest for Deal Interest Rate History                                 CDL034
      *                                                                                       CDL034
     C     CDL034        IFEQ      'Y'                                                        CDL034
     C     BRTT          IFNE      0                                                          CDL034
     C                   Z-ADD     WKINT         WKAINP           13 0                        CDL034
     C**********         Z-ADD     VDATDM        WKIACD            5 0               CDL034 MD027681
     C                   ENDIF                                                                CDL034
     C                   ENDIF                                                                CDL034
2241 C*
2242 C*****     BUILD START DATE ACCOUNT KEY FOR 'PI',OR MATURITY FOR'PD'.
2243 C*
2244 C                   MOVEA     '    '        AKY(6)
2245 C                   MOVEA     DLST          AKY(4)
2246 C                   MOVE      'A'           AKY(10)
2247 C   56              MOVE      'I'           AKY(9)
2248 C   57              MOVE      'D'           AKY(9)
2249 C   56              MOVE      'V'           AKY(3)
2250 C   57              MOVE      'M'           AKY(3)
2251 C   56              MOVEL     NEV(2)        NARREV
2252 C   57              MOVEL     NEV(4)        NARREV
2253 C                   Z-ADD     DAAM          KYAMT            13 0
2254 C                   Z-ADD     VDATDM        KYDAT             5 0
2255 C                   MOVE      PCCY          KYCCY             3
     C                   MOVE      STCYM         KYSCY                                         CEU00
2256 C                   Z-ADD     SETP          KYSETL            2 0
2257 C**********           MOVE OSAC      KYOSTL 12                                           CGL029
     C                   MOVE      OSAC          KYOSTL
2257 C                   MOVE      OSBR          KYSTBR                                        S0111
2257 C                   MOVE      PRFC          OPPRFC                                        S0111
      *                                                                                       232928
     C     *IN56         IFEQ      *ON                                                        232928
     C                   MOVE      'PINC'        WCFTP             4                          232928
     C                   EXSR      SRMMCF                                                     232928
     C                   ENDIF                                                                232928
     C     *IN57         IFEQ      *ON                                                        232928
     C                   MOVE      'PDEC'        WCFTP                                        232928
     C                   EXSR      SRMMCF                                                     232928
     C                   ENDIF                                                                232928
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'DA'          STINFO
     C                   ENDIF
     C*                                                                   S01486
     C** IF PM INSTALLED, CALCULATE FX RATE                               S01486
     C     BGPFMG        IFEQ      'Y'                                                         S0148
     C     *IN56         ANDEQ     '1'                                                         S0148
     C     PTFR          ANDNE     *BLANKS                                                     S0148
     C                   EXSR      P02                                                         S0148
     C     WWERRF        CABEQ     'Y'           EOJ                                           S0148
     C                   END                                                                   S0148
2258 C*
2259 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
2260 C*
2261 C                   EXSR      FEDAT
2262 C*
2263 C  N04              Z-ADD     KYAMT         NRRPUR
2264 C                   SETOFF                                       53
2265 C   56
2266 COR 57              SETON                                        53
2267 C   53              Z-ADD     TOTNTI        ZZTOTI
2268 C   53              Z-ADD     TOTNTD        ZZTOTD
2269 C   53DAAM          DIV       1000          ZZAMT
     C   53
2270 CAN 57              Z-SUB     ZZAMT         ZZAMT
2271 C   53              EXSR      GLZADD
2272 C   53              Z-ADD     ZZTOTI        TOTNTI           15 0
2273 C   53              Z-ADD     ZZTOTD        TOTNTD            3 0
2274 C                   SETOFF                                       53
     C/COPY WNCPYSRC,DL0280C677
2275 C   56
2276 COR 57              EXSR      EXCP
     C/COPY WNCPYSRC,DL0280C678
      *                                                                   CDL006
      ** If Feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Fiduciary Call or Time deposits.                              CDL006
      *                                                                   CDL006
     C     WUFIDE        IFEQ      'D'                                                         CDL00
     C     WUFIDE        OREQ      'L'                                                         CDL00
      *                                                                   CDL006
      ** Deal type is a Fiduciary Deposit taken or Loan Call taken.       CDL006
      *                                                                   CDL006
     C     DTYP          IFEQ      'DT'                                                        CDL00
     C     DTYP          OREQ      'LT'                                                        CDL00
      *                                                                   CDL006
      ** If Charges on Principal Changes.                                 CDL006
      *                                                                   CDL006
     C     BNCHPC        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** Transaction is Principal Increase or Principal Decrease          CDL006
      *                                                                   CDL006
     C     *IN56         IFEQ      '1'                                                         CDL00
     C     *IN57         OREQ      '1'                                                         CDL00
      *                                                                   CDL006
      ** Initialize Charge and Tax on charge amounts used to              CDL006
      ** calculate Net amount to be settled.                              CDL006
      *                                                                   CDL006
     C                   Z-ADD     0             W0FCGA                                        CDL00
      *                                                                   CDL006
      ** If Charge due on the amendment                                   CDL006
      *                                                                   CDL006
     C     FCGC          IFNE      *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** Build account keys for Charge on Principal.                      CDL006
      *                                                                   CDL006
     C     *IN56         IFEQ      '1'                                                         CDL00
     C                   MOVE      'V'           AKY(3)                                        CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C     *IN57         IFEQ      '1'                                                         CDL00
     C                   MOVE      'M'           AKY(3)                                        CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
     C                   MOVE      'X'           AKY(10)                                       CDL00
     C                   Z-ADD     FCGA          KYAMT                                         CDL00
     C                   Z-ADD     FCGA          W0FCGA                                        CDL00
      *                                                                   CDL006
      ** Generate Account key for Charge on Principal.                    CDL006
     C                   EXSR      EXCP                                                        CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** Build account keys for Net Amount to be settled.                 CDL006
      *                                                                   CDL006
     C     *IN56         IFEQ      '1'                                                         CDL00
     C                   MOVE      'V'           AKY(3)                                        CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C     *IN57         IFEQ      '1'                                                         CDL00
     C                   MOVE      'M'           AKY(3)                                        CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
      *                                                                   CDL006
     C     *IN56         IFEQ      '1'                                                         CDL00
     C                   MOVEA     'IN'          AKY(09)                                       CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C     *IN57         IFEQ      '1'                                                         CDL00
     C                   MOVEA     'DN'          AKY(09)                                       CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
      *                                                                                       CGL020
     C     *IN56         IFEQ      *ON
     C     *IN57         OREQ      *ON
      *                                                                                       CGL020
     C                   MOVE      'N'           F1FFLG
     C                   Z-ADD     W0FCGA        F1FVAL
     C                   Z-ADD     0             WKAMT
      *                                                                                       CGL020
     C     DAAM          IFNE      0
     C     W0FCGA        DIV(H)    DAAM          WKAMT
     C     WKAMT         MULT      100           F1FPCT
     C                   ENDIF
      *                                                                                       CGL020
     C                   ENDIF
      *                                                                                       CGL020
     C                   ENDIF
      *                                                                   CDL006
     C     *IN56         IFEQ      '1'                                                         CDL00
     C     DAAM          ADD       W0FCGA        KYAMT                                         CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C     *IN57         IFEQ      '1'                                                         CDL00
     C     DAAM          SUB       W0FCGA        KYAMT                                         CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** Generate Account key for Net amount to be settled.               CDL006
      *                                                                   CDL006
     C                   EXSR      EXCP                                                        CDL00
     C                   MOVEA     ' '           AKY(09)                                       CDL00
      *                                                                   CDL006
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
      *                                                                                       CGL020
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** If Commissions to be calculated.                                 CDL006
      *                                                                   CDL006
     C     BNCOTK        IFEQ      'Y'                                                         CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
     C     BNACCO        OREQ      'Y'                                                         CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** As the commission calculation is based on the Interest           CDL006
      ** accrual control date (IACD), the Commission amount must          CDL006
      ** be calculated each time the Interest Accrual Control date is     CDL006
      ** updated; the result must be added to the field Accrued           CDL006
      ** commission to control date FACTC.                                CDL006
      *                                                                   CDL006
     C     IACD          IFNE      WUIACD                                                      CDL00
     C                   Z-ADD     WUIACD        WUDBEG                                        CDL00
     C                   Z-ADD     IACD          WUDEND                                        CDL00
     C                   EXSR      COMCAL                                                      CDL00
     C                   ADD       WUACSC        FACTC                                         CDL00
     C                   MOVE      'Y'           WUDXUP                                        CDL00
     C                   Z-ADD     IACD          WUIACD                                        CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
     C/COPY WNCPYSRC,DL0280C044
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Calculate Accrued COF to Control Date.                           CAC001
      *                                                                   CAC001
      ** Get effective Funding Rate                                       CAC001
      *                                                                   CAC001
     C                   SELECT                                                                CAC00
     C     FSGN          WHENEQ    '+'                                                         CAC00
     C     INTR          ADD       FSRP          WEFFR                                         CAC00
     C     FSGN          WHENEQ    '-'                                                         CAC00
     C     INTR          SUB       FSRP          WEFFR                                         CAC00
     C     FSGN          WHENEQ    ' '                                                         CAC00
     C                   Z-ADD     FSRP          WEFFR                                         CAC00
     C                   ENDSL                                                                 CAC00
      *                                                                   CAC001
     C                   Z-ADD     FCTD          ZIBEG                                         CAC00
     C                   Z-ADD     VDATDM        ZIEND                                         CAC00
     C                   Z-ADD     PAMT          ZIAMT                                         CAC00
     C                   Z-ADD     ICBS          ZICALC                                        CAC00
     C                   Z-ADD     WEFFR         ZIRATE                                        CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C                   ADD       WKINT         ACDA                                          CAC00
     C                   Z-ADD     VDATDM        FCTD                                          CAC00
      *                                                                   CAC001
      ** For amendment type PI or PD, new balance change date keys        CAC001
      ** will be generated as follows:                                    CAC001
      *                                                                   CAC001
     C     AMTP          IFEQ      'PI'                                                        CAC00
      *                                                                   CAC001
      ** Principal Increase - Transaction Profit Centre                   CAC001
      *                                                                   CAC001
     C                   MOVE      'V'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'I'           AKY(9)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   Z-ADD     DAAM          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C/COPY WNCPYSRC,DL0280C679
     C                   EXSR      EXCP                                                        CAC00
     C/COPY WNCPYSRC,DL0280C680
      *                                                                   CAC001
      ** Principal Increase - Funding Profit Centre                       CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      'I'           AKY(9)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C/COPY WNCPYSRC,DL0280C681
     C                   EXSR      EXCP                                                        CAC00
      *                                                                                       CAS009
     C**********           MOVE 'PINC'    WCFTP   4                                    CAS009 232928
     C**********           EXSR SRMMCF                                                 CAS009 232928
     C/COPY WNCPYSRC,DL0280C682
      *                                                                   CAC001
     C                   ENDIF                                                  -AMTP=PI       CAC00
      *                                                                   CAC001
     C     AMTP          IFEQ      'PD'                                                        CAC00
      *                                                                   CAC001
      ** Principal Decrease - Transaction Profit Centre                   CAC001
      *                                                                   CAC001
     C                   MOVE      'M'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'D'           AKY(9)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   Z-ADD     DAAM          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C/COPY WNCPYSRC,DL0280C683
     C                   EXSR      EXCP                                                        CAC00
      *                                                                                       CAS009
     C**********           MOVE 'PDEC'    WCFTP   4                                    CAS009 232928
     C**********           EXSR SRMMCF                                                 CAS009 232928
     C/COPY WNCPYSRC,DL0280C684
      *                                                                   CAC001
      ** Principal Decrease - Funding Profit Centre                       CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      'D'           AKY(9)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C/COPY WNCPYSRC,DL0280C685
     C                   EXSR      EXCP                                                        CAC00
     C/COPY WNCPYSRC,DL0280C686
      *                                                                   CAC001
     C                   ENDIF                                                  -AMTP=PD       CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST=Y      CAC00
      *                                                                   CAC001
2277 C   56DAAM          ADD       PAMT          PAMT
2278 C   57PAMT          SUB       DAAM          PAMT
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     *IN56         IFEQ      *ON
     C     DAAM          ADD       FSPAMT        FSPAMT
     C                   ENDIF
     C     *IN57         IFEQ      *ON
     C     FSPAMT        SUB       DAAM          FSPAMT
     C                   ENDIF
     C                   ENDIF
2279 C   56
2280 COR 57              GOTO      GETDM
     C**
     C**   SET OFF INTEREST AND MATURITY CONF. INDICATORS
     C**
     C                   BITOFF    '12'          CNFI
2281 C*
2282 C*****     ADDITIONAL PROCESSING FOR SC TYPE ONLY.
2283 C*
     C/COPY WNCPYSRC,DL0280C152                                           S01408
2284 C                   BITON     '2'           DNSI
2285 C                   Z-ADD     VDATDM        DLRC
      *                                                                                     AR866124
     C     AMTP          IFEQ      'SC'                                                     AR866124
     C                   Z-ADD     RTSPDM        RTSP                                       AR866124
     C     BRTE          ADD       RTSP          INTR                                       AR866124
     C                   ENDIF                                                              AR866124
      *                                                                                       CDL022
      **  Process deal amendment type 'BC'                                                    CDL022
      *                                                                                       CDL022
     C     AMTP          IFEQ      'BC'
     C     AMTP          OREQ      'BR'                                                     AR874927
     C     CRE073        ANDEQ     'Y'                                                      AR874927
      *                                                                                     AR874927
     C                   EVAL      *IN36 = '1'                                              MD023042
     C     AMTP          IFEQ      'BR'                                                     AR874927
     C                   EVAL      BRTEDM  = RTSPDM                                         AR874927
     C                   EVAL      CNSPDM  = CNSP                                           AR874927
     C                   EVAL      CNSGDM  = '+'                                            AR874927
     C                   EVAL      RDMTDM  = RDMT                                           AR874927
     C                   EVAL      RDFDDM  = RDFD                                           AR874927
     C                   ENDIF                                                              AR874927
      *** Code Stripped ***                                                                 AR937392
      /COPY DLCPYSRC,DL0280DLA1                                                             AR937392
      *                                                                                       CDL020
     C                   Z-ADD     BRTTDM        BRTT
     C                   Z-ADD     BRTEDM        BRTE
     C                   IF        CRE073 = 'Y'                                               CRE073
     C                   EVAL      *IN36 = '1'                                              AR853123
     C                   EVAL      PNWSP = 0                                                  CRE073
     C                   EVAL      PFRAT = 0                                                AR847249
     C                   CALL      'ZACALCSPRT'                                               CRE073
     C                   PARM      *BLANKS       PRTCD                                        CRE073
     C                   PARM      BRTEDM        PBSRT                                        CRE073
     C                   PARM      CNSPDM        PCNSP                                        CRE073
     C                   PARM      CNSGDM        PCNSG                                        CRE073
     C                   PARM      RDMTDM        PRDMT                                        CRE073
     C                   PARM      RDFDDM        PRDFD                                        CRE073
     C                   PARM                    PNWSP                                        CRE073
     C                   PARM                    PFRAT                                      AR847249
      *                                                                                       CRE073
     C**********         IF        PRTCD <> *BLANK                                   CRE073 AR847249
     C**********         IF        PRTCD <> *BLANKS OR                             AR847249 AR947093
     C**********                   (PFRAT <= 0 AND                                 AR847249 AR947093
     C**********                   RDMTDM <> *BLANKS)                              AR847249 AR947093
     C                   IF        PRTCD <> *BLANK                                          AR947093
     C                   EVAL      DBFILE = 'ZACALCSPRT'                                      CRE073
     C                   EVAL      DBASE  = '050'                                             CRE073
     C                   EVAL      DBKEY  = '*CALL'                                           CRE073
     C                   EVAL      *INU7  = *ON                                               CRE073
     C                   EVAL      *INU8  = *ON                                               CRE073
     C                   EVAL      *INLR  = *ON                                               CRE073
     C                   EXSR      *PSSR                                                      CRE073
     C                   ENDIF                                                                CRE073
      *                                                                                       CRE073
     C                   EVAL      RTSP = PNWSP                                               CRE073
     C                   EVAL      INTR = PNWSP + BRTE                                        CRE073
     C                   ELSE                                                                 CRE073
      *                                                                                     AR866124
      ** Move only the spread rate into spread rate field in DEALSDC if                     AR866124
      ** it is not equal to zero.                                                           AR866124
      *                                                                                     AR866124
     C     RTSPDM        IFNE      0                                                        AR866124
     C                   Z-ADD     RTSPDM        RTSP
     C                   ENDIF                                                              AR866124
     C********** BRTE      ADD  BRTE      INTR                                         CDL022BUG3620
     C*****BRTE*         ADD       BRTE          INTR                               BUG7944 AR866124
     C     BRTE          ADD       RTSP          INTR                                       AR866124
     C********** BRTE      ADD  RTSP      INTR                                       BUG3620 BUG7944
     C                   ENDIF                                                                CRE073
     C                   GOTO      GETDM
     C                   ENDIF
      *                                                                                       CDL022
2286 C   55              GOTO      BRTYP
      *                                                                                       221673
      ** Reverse the existing spread rate from RTSP                                           221673
      *                                                                                       221673
     C     BRTT          IFEQ      00                                                         221673
     C     INTR          IFLT      0                                                          221673
     C                   Z-SUB     INTR          INTR                                         221673
     C                   ENDIF                                                                221673
     C     RTSP          IFLT      0                                                          221673
     C                   Z-SUB     RTSP          RTSP                                         221673
     C                   ENDIF                                                                221673
     C                   ENDIF                                                                221673
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'N'                                                         CAC00
     C     BGN0ST        OREQ      'Y'                                                         CAC00
     C     IRCF          ANDEQ     'Y'                                                         CAC00
      *                                                                                      BUG7944
      ** Reverse succeeding BUG7944 code changes                                     BUG7944 BUG7944
      ***Do*next*processing*only*if*INTR*has*not*been*previously updated             BUG7944 BUG7944
      *                                                                                      BUG7944
     C********** CDL020    IFEQ 'N'                                                  BUG7944 BUG7944
2287 C     INTR          SUB       RTSP          INTR
2288 C     INTR          ADD       RTSPDM        INTR
2289 C                   Z-ADD     RTSPDM        RTSP
     C                   IF        CRE073 = 'Y'                                            AR1006306
     C                   EVAL      CNSP   = CNSPDM                                         AR1006306
     C                   EVAL      CNSG   = CNSGDM                                         AR1006306
     C                   EVAL      RDMT   = RDMTDM                                         AR1006306
     C                   EVAL      RDFD   = RDFDDM                                         AR1006306
     C                   ENDIF                                                             AR1006306
     C**********         ENDIF                                                       BUG7944 BUG7944
      *                                                                                      BUG7944
     C                   ENDIF                                                                 CAC00
      *                                                                                       221673
      ** The Negative Interest indicator on DSTI is the effective interest                    221673
      ** rate (field INTR) and NOT the sign of the spread rate.                               221673
      ** This part can be made as core fix.                                                   221673
      *                                                                                       221673
     C     INTR          IFLT      0                                                          221673
     C                   BITON     '1'           DSTI                                         221673
     C                   ELSE                                                                 221673
     C                   BITOFF    '1'           DSTI                                         221673
     C                   ENDIF                                                                221673
      *                                                                   CAC001
      ** Adjust new funding rate                                          CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FRCF          ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     FSRPDM        FSRP                                          CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                                       232928
      ** Write to History File                                                                232928
      *                                                                                       232928
     C     AMTP          IFEQ      'SC'                                                       232928
     C     CAS009        ANDEQ     'Y'                                                        232928
     C     BGN0ST        ANDEQ     'Y'                                                        232928
     C     IRCF          ANDEQ     'Y'                                                        232928
     C                   EXSR      SRHSTQ                                                     232928
     C                   ENDIF                                                                232928
      *                                                                   CAC001
2290 C                   GOTO      GETDM
     C*                                                                   S01378
     C***************************************************************     S01378
     C*                                                                   S01378
     C** NSTYP is a routine for parcelled NA's only, type 'NS'            S01378
     C** (A parcelled NA has Parcelling flag set to 'P'. This denotes     S01378
     C** that it may be sold by one or more NA sale transactions.)        S01378
     C** An extract record is added to DAPCLI (by DL4040) for each        S01378
     C** live parcelled NA sold trade as it reaches value date.           S01378
     C** The DLNO is the DLNO of the negotiable asset purchased,          S01378
     C** the related deal number, RDLN, is of the NA sold.                S01378
     C** The parcel size, PSZEDM, gives the number of parcels sold        S01378
     C** by the NA sold transaction. This extract rcd is processed with   S01378
     C** the NA purchased details from the deals file, DEALSL1, (NA       S01378
     C** parcels extract keyed by NA purchased deal no.)                  S01378
     C*                                                                   S01378
     C***************************************************************     S01378
     C     NSTYP         TAG                                                    ** NSTYP TAG **S0137
     C*                                                                   S01378
     C                   MOVEL     NEV(5)        NARREV                                        S0137
     C                   Z-ADD     PSZEDM        NARPSZ                                        S0137
     C*                                                                   S01378
     C** Obtain face value/purchase price for each sale rcd on DAPCLI     S01378
     C** by dividing purchased price/face value by purchased no. of       S01378
     C** parcels to get amounts per parcel, then multiplying these        S01378
     C** amounts by no. of parcels sold.                                  S01378
     C** PSZEDM is number of parcels being sold, PAMT is the full         S01378
     C** amount purchased (obtained from deals file, DEALSL1), PPSZ is    S01378
     C** the total no. parcels purchased (from DEALSL1).                  S01378
     C     PAMT          DIV       PPSZ          WORKA            21 9
     C     WORKA         MULT(H)   PSZEDM        PAMTSD           13 0                         S0137
     C     FVAL          DIV       PPSZ          WORKB            21 9
     C     WORKB         MULT(H)   PSZEDM        FVALSD           13 0                         S0137
     C     DISA          DIV       PPSZ          WORKC            21 9
     C     WORKC         MULT(H)   PSZEDM        DISASD           13 0                         S0137
     C                   IF        CAS009 = 'Y' AND FSAMRM = 'N' AND                          CAS009
     C                             FSACAI = 'Y'                                               CAS009
     C                   ELSE                                                                 CAS009
     C     DPTD          DIV       PPSZ          WORK4            21 9
     C     WORK4         MULT(H)   PSZEDM        DPTDSD           13 0                         S0137
     C* subtract from discount posted to date recorded on NA purchase
     C     DPTD          SUB       DPTDSD        DPTD                                          S0137
     C                   ENDIF                                                                CAS009
     C*                                                                   S01378
     C** If non interest bearing NA (*IN49 seton)                         S01378
     C   49              GOTO      NOTINT                                                      S0137
     C*                                                                   S01378
     C**  This sub-section handles the sale of parcels of interest        S01378
     C**  bearing negotiable assets.                                      S01378
     C** Obtain face accrued interest etc for each sale rcd on DAPCLI     S01378
     C** by dividing accrued interest etc by purchased no. of             S01378
     C** parcels to get amounts per parcel, then multiplying these        S01378
     C** amounts by no. of parcels sold.                                  S01378
     C*                                                                   S01378
     C*****AITC*****     DIV       PPSZ          WORKE            15 3                  S0137 169350
     C     AITC          DIV       PPSZ          WORKE            21 9                        169350
     C     WORKE         MULT(H)   PSZEDM        AITCSD           13 0                         S0137
     C*****AIPD*****     DIV       PPSZ          WORKF            15 3                  S0137 169350
     C     AIPD          DIV       PPSZ          WORKF            21 9                        169350
     C     WORKF         MULT(H)   PSZEDM        AIPDSD           13 0                         S0137
     C*****IPRD*****     DIV       PPSZ          WORKG            15 3                  S0137 169350
     C     IPRD          DIV       PPSZ          WORKG            21 9                        169350
     C     WORKG         MULT(H)   PSZEDM        IPRDSD           13 0                         S0137
     C*****PINT*****     DIV       PPSZ          WORKH            15 3                  S0137 169350
     C     PINT          DIV       PPSZ          WORKH            21 9                        169350
     C     WORKH         MULT(H)   PSZEDM        PINTSD           13 0                         S0137
     C*                                                                   S01378
     C** Check NA accrued interest flag                                   S01378
     C     *IN28         IFEQ      '0'                                          B001           S0137
     C     DAAM          ADD       IPRDSD        WORKTP                                        S0137
     C     WORKTP        SUB       PAMTSD        WORKTP                                        S0137
     C     WORKTP        SUB       AIPDSD        WORKTP                         ACCRUED TO POSTS0137
     C                   END                                                    E001           S0137
     C*                                                                   S01378
     C     *IN28         IFEQ      '1'                                          B001           S0137
     C* Calculate interest for the sold portion                           S01378
     C                   Z-ADD     FVALSD        ZIAMT                          INTEREST INCOMES0137
     C                   Z-ADD     IACD          ZIBEG                                         S0137
     C                   Z-ADD     SLID          ZIEND                                         S0137
     C                   Z-ADD     ICBS          ZICALC                                        S0137
     C                   Z-ADD     INTR          ZIRATE                                        S0137
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP98                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0137
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP99                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C                   Z-ADD     WKINT         WORKID           13 0                         S0137
     C                   Z-ADD     VDATDM        ZIEND                                         S0137
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280C100                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0137
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280C101                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C                   END                                                    E001           S0137
     C     IACD          COMP      SLID                                 23                     S0137
     C   28
     CANN23              Z-ADD     WKINT         AIR                                           S0137
     C   28
     CAN 23WKINT         SUB       WORKID        AIR              13 0                         S0137
     C   28              ADD       AITCSD        WKINT                                         S0137
     C*                                                                   S01378
     C**    GENERATE SALE DATE ACCOUNT KEYS                               S01378
     C*                                                                   S01378
     C* ACCRUED INTEREST OR ACCRUED YIELD NOT POSTED KEYS                 S01378
     C                   Z-ADD     INTR          NARRAT                                        S0137
     C                   MOVE      'A'           AKY(3)                                        S0137
     C                   MOVEA     '    '        AKY(6)                                        S0137
     C                   MOVEA     DLST          AKY(4)                                        S0137
     C  N28              MOVE      'A'           AKY(10)                                       S0137
     C   28              MOVE      'I'           AKY(10)                                       S0137
     C  N28              Z-ADD     WORKTP        KYAMT                                         S0137
     C   28WKINT         SUB       AIPDSD        KYAMT                          ACCRUED        S0137
     C                   Z-ADD     VDATDM        KYDAT                             TO POST     S0137
     C                   MOVE      PCCY          KYCCY                                         S0137
     C                   MOVE      STCY          KYSCY                                         CEU00
     C                   Z-ADD     MDST          KYSETL                                        S0137
     C                   MOVE      OMDA          KYOSTL                                        S0137
     C*                                                                   S01378
     C     *IN28         IFEQ      '0'                                          B001           S0137
     C                   Z-ADD     PAMTSD        ZIAMT                          ACCRUED YIELD  S0137
     C                   Z-ADD     IACD          ZIBEG                          TO DATE        S0137
     C                   Z-ADD     VDATDM        ZIEND                                         S0137
     C                   Z-ADD     ICBS          ZICALC                                        S0137
     C                   Z-ADD     YRAT          ZIRATE                                        S0137
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280C102                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0137
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280C103                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C     WKINT         SUB       AITCSD        AYTDSD           13 0                         S0137
     C                   Z-ADD     FVALSD        ZIAMT                                         S0137
     C                   Z-ADD     INTR          ZIRATE                                        S0137
     C/COPY WNCPYSRC,DL0280C104                                           S01408
     C                   EXSR      GLINTC                                                      S0137
     C/COPY WNCPYSRC,DL0280C105                                           S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C                   Z-ADD     WKINT         AIR              13 0                         S0137
     C*                                                                   S01378
     C                   END                                                    E001           S0137
     C*                                                                   S01378
     C*   CALCULATE THE FEDERAL FUND VALUE DATE                           S01378
     C*                                                                   S01378
     C                   EXSR      FEDAT                                                       S0137
     C*                                                                   S01378
     C                   EXSR      EXCP                                                        S0137
     C* ACCRUED DISCOUNT/PREMIUM KEY                                      S01378
     C     DISASD        COMP      0                                      53                   S0137
     C   28
     CANN53              Z-ADD     VDATDM        NPADAT            5 0                         S0137
     C   28
     CANN53              EXSR      NPACRP                                                      S0137
     C                   SETOFF                                       53                       S0137
     C* PURCHASE PRICE KEY                                                S01378
     C     DTYP          COMP      'C1'                                   53                   S0137
     C   53TOTI          DIV       PPSZ          WORKI            15 3                         S0137
     C   53WORKI         MULT(H)   PSZEDM        TOTISD           13 0                         S0137
     C   53TOTI          SUB       TOTISD        TOTI                                          S0137
     C                   MOVE      'S'           AKY(3)                                        S0137
     C                   MOVE      'A'           AKY(10)                                       S0137
     C                   Z-ADD     PAMTSD        KYAMT                           PURCHASE PRICES0137
     C  N53              Z-ADD     KYAMT         NRRPUR                                        S0137
     C  N53              EXSR      EXCP                                                        S0137
     C*                                                                   S01378
     C*(NET ACCRUED YIELD BASIS) ?                                        S01378
     C     *IN28         IFEQ      '0'                                           B001          S0137
     C                   MOVE      'D'           AKY(10)                                       S0137
     C     DAAM          SUB       PAMTSD        KYAMT                                         S0137
     C                   Z-ADD     KYAMT         NRRSAL                                        S0137
     C                   SETON                                        71                       S0137
     C                   EXSR      EXCP                                                        S0137
     C                   END                                                     E001          S0137
     C*                                                                   S01378
     C* PURCHASED INTEREST KEY                                            S01378
     C   28
     CANN53              MOVE      'P'           AKY(10)                                       S0137
     C   28
     CANN53              Z-ADD     PINTSD        KYAMT                                         S0137
     C   28
     CANN53              EXSR      EXCP                                                        S0137
     C* ACCRUED INTEREST RECEIVABLE KEY                                   S01378
     C                   MOVE      'I'           AKY(10)                                       S0137
     C                   Z-ADD     AIR           KYAMT                                         S0137
     C   28              Z-ADD     KYAMT         NRRSAL                                        S0137
     C   28              Z-ADD     INTR          NARRAT                                        S0137
     C   28              SETON                                        71                       S0137
     C                   EXSR      EXCP                                                        S0137
     C     *IN28         IFEQ      '1'                                           B001          S0137
     C* FACE VALUE KEY                                                    S01378
     C                   MOVE      'F'           AKY(10)                                       S0137
     C                   Z-ADD     FVALSD        KYAMT                                         S0137
     C                   EXSR      EXCP                                                        S0137
     C* SALE PROFIT/LOSS KEY                                              S01378
     C                   SETOFF                                       24                       S0137
     C     DAAM          SUB       FVALSD        NPL              13 0                         S0137
     C     NPL           SUB       PINTSD        NPL                                           S0137
     C     NPL           SUB       AIR           NPL                                           S0137
     C                   IF        CAS009 = 'Y' AND FSAMRM = 'N' AND                          CAS009
     C                             FSACAI = 'Y'                                               CAS009
     C                   ELSE                                                                 CAS009
     C     DISASD        SUB       DPTDSD        DTP              13 0                         S0137
     C                   ENDIF                                                                CAS009
     C     NPL           ADD       DTP           KYAMT                24                       S0137
     C  N24              Z-SUB     KYAMT         KYAMT                                         S0137
     C   24              MOVE      'R'           AKY(10)                                       S0137
     C  N24              MOVE      'L'           AKY(10)                                       S0137
     C                   EXSR      EXCP                                                        S0137
     C* TOTAL DISCOUNT OR PREMIUM KEY                                     S01378
     C  N27
     CANN53              MOVE      'E'           AKY(10)                                       S0137
     C   27
     CANN53              MOVE      'C'           AKY(10)                                       S0137
     C  N27
     CANN53              Z-ADD     DISASD        KYAMT                                         S0137
     C   27
     CANN53              Z-SUB     DISASD        KYAMT                                         S0137
     C  N53              EXSR      EXCP                                                        S0137
     C* OUTSTANDING DISCOUNT OR PREMIUM KEY                               S01378
     C  N53              MOVE      'R'           AKY(3)                                        S0137
     C  N27
     CANN53              MOVE      'D'           AKY(10)                                       S0137
     C   27
     CANN53              MOVE      'C'           AKY(10)                                       S0137
     C  N53DISASD        SUB       DPTDSD        KYAMT                                         S0137
     C   27
     CANN53              Z-SUB     KYAMT         KYAMT                                         S0137
     C  N53              MOVE      'Y'           SPRIND                                       CAS009
     C  N53              EXSR      EXCP                                                        S0137
     C                   END                                                    E001           S0137
     C     *IN28         IFEQ      '0'                                          B001           S0137
     C* DEALING PROFIT/LOSS KEY (NET ACCRUED YIELD BASIS)                 S01378
     C     DAAM          SUB       PAMTSD        NPL              13 0                         S0137
     C     NPL           SUB       AIR           KYAMT                                         S0137
     C                   MOVE      'B'           AKY(10)                                       S0137
     C                   EXSR      EXCP                                                        S0137
     C* DISCOUNT PREMIUM KEY (NET ACCRUED YIELD BASIS)                    S01378
     C     AIPDSD        IFGT      0                                            B002           S0137
     C                   MOVE      'R'           AKY(3)                                        S0137
     C                   MOVE      'A'           AKY(10)                                       S0137
     C     IPRDSD        SUB       AYTDSD        KYAMT                                         S0137
     C                   EXSR      EXCP                                                        S0137
     C                   END                                                    E002           S0137
     C                   END                                                    E001           S0137
     C**                                                                  S01378
     C     AIPD          SUB       AIPDSD        AIPD                                          S0137
     C     AITC          SUB       AITCSD        AITC                                          S0137
     C     PINT          SUB       PINTSD        PINT                                          S0137
     C                   Z-ADD     PINT          REPINT                                        S0137
     C     IPRD          SUB       IPRDSD        IPRD                                          S0137
     C                   GOTO      NPEND                                                       S0137
     C*                                                                   S01378
     C*    THIS SUB-SECTION HANDLES THE SALE OF PARCELS OF                S01378
     C*    NON-INTEREST BEARING N.A.'S                                    S01378
     C*                                                                   S01378
     C     NOTINT        TAG                                                    ** NOTINT TAG *S0137
     C*                                                                   S01378
     C*    GENERATE SALE DATE ACCOUNT KEYS                                S01378
     C*                                                                   S01378
     C                   Z-ADD     0             NARRAT                                        S0137
     C     PAMTSD        ADD       DPTDSD        WORK15                         DISCOUNT       S0137
     C     DAAM          SUB       WORK15        WORK15                         TO POST        S0137
     C                   Z-ADD     VDATDM        KYDAT                                         S0137
     C*                                                                   S01378
     C**   CALCULATE THE FEDERAL FUND VALUE DATE                          S01378
     C                   EXSR      FEDAT                                                       S0137
     C*                                                                   S01378
     C*  PURCHASE PRICE KEY                                               S01378
     C                   Z-ADD     PAMTSD        KYAMT                          PURCHASE PRICE S0137
     C                   MOVE      'S'           AKY(3)                                        S0137
     C                   MOVE      'A'           AKY(10)                                       S0137
     C                   MOVE      PCCY          KYCCY                                         S0137
     C                   Z-ADD     MDST          KYSETL                                        S0137
     C                   MOVE      OMDA          KYOSTL                                        S0137
     C                   Z-ADD     KYAMT         NRRPUR                                        S0137
     C                   EXSR      EXCP                                                        S0137
     C* FACE VALUE KEY                                                    S01378
     C                   MOVE      'F'           AKY(10)                                       S0137
     C                   Z-ADD     FVALSD        KYAMT                                         S0137
     C                   Z-ADD     KYAMT         NRRPUR                                        S0137
     C                   SETON                                        71                       S0137
     C                   EXSR      EXCP                                                        S0137
     C* ACCRUED DISCOUNT TO POST KEY (ACCRUALS KEY)                       S01378
     C                   Z-ADD     VDATDM        NPADAT            5 0                         S0137
     C                   EXSR      NPACRP                                                      S0137
     C* DISCOUNT ACCRUED TO DATE KEY (SALE KEY)                           S01378
     C                   Z-ADD     DPTDSD        KYAMT                                         S0137
     C                   MOVE      'S'           AKY(3)                                        S0137
     C                   MOVE      'D'           AKY(10)                                       S0137
     C                   EXSR      EXCP                                                        S0137
     C* OUTSTANDING DISCOUNT KEY                                          S01378
     C     DISASD        SUB       DPTDSD        KYAMT                                         S0137
     C                   MOVE      'R'           AKY(3)                                        S0137
     C                   MOVE      'C'           AKY(10)                                       S0137
     C* PROFIT OR LOSS KEY                                                S01378
     C                   MOVE      'Y'           SPRIND                                       CAS009
     C                   EXSR      EXCP                                                        S0137
     C                   SETOFF                                       24                       S0137
     C     KYAMT         ADD       DAAM          PL               13 0                         S0137
     C     PL            SUB       FVALSD        PL                   24                       S0137
     C                   MOVE      'S'           AKY(3)                                        S0137
     C   24              MOVE      'P'           AKY(10)                                       S0137
     C  N24              MOVE      'L'           AKY(10)                                       S0137
     C   24              Z-ADD     PL            KYAMT                                         S0137
     C  N24              Z-SUB     PL            KYAMT                                         S0137
     C                   EXSR      EXCP                                                        S0137
     C*                                                                   S01378
     C     NPEND         TAG                                                    ** NPEND TAG **S0137
     C*                                                                   S01378
     C** Reduce the Purchase amount, Face value, Discount amount to       S01378
     C** reflect the number of parcels sold in this trade, also amend     S01378
     C** the parcel size to reflect the number of remaining parcels.      S01378
     C** If the remaining parcel size is zero (*IN53 seton) then          S01378
     C** set the record id field on the NA purchased to Matured.          S01378
     C** Note that No. parcels not sold is updated when NA sale           S01378
     C** is entered so no need to change here. However NSLD , no. sold,   S01378
     C** is reduced to remove NA's sold from it. This means that          S01378
     C** validation in MM0027 (NA sold) is correct (both NSLD and PSZE    S01378
     C** are reduced in DL0280 by the number of parcels sold). (The       S01378
     C** validation in MM0027 is to ensure that short selling is not      S01378
     C** allowed - ie. selling more parcels than purchased.)              S01378
     C** Note that this reduction only happens as the sales reach         S01378
     C** their value date (or event control date - see DL4040).           S01378
     C     PPSZ          SUB       PSZEDM        PPSZ                     53                   S0137
     C   53              BITON     '3'           ACEI                                          S0137
     C   53              MOVE      'M'           RECR                                          S0137
     C*                                                                   S01378
     C     NSLD          SUB       PSZEDM        NSLD                                          DL028
     C     PAMT          SUB       PAMTSD        PAMT                                          S0137
     C     FVAL          SUB       FVALSD        FVAL                                          S0137
     C     DISA          SUB       DISASD        DISA                                          S0137
     C                   Z-ADD     PPSZ          NARPSZ                                        S0137
     C*                                                                   S01378
     C** Must correct the hash totals to reflect this partial sale.       S01378
     C                   Z-ADD     TOTNTI        ZZTOTI                                        S0137
     C                   Z-ADD     TOTNTD        ZZTOTD                                        S0137
     C     PAMTSD        DIV       1000          ZZAMT                                         S0137
     C                   Z-SUB     ZZAMT         ZZAMT                                         S0137
     C                   EXSR      GLZADD                                                      S0137
     C                   Z-ADD     ZZTOTI        TOTNTI                                        S0137
     C                   Z-ADD     ZZTOTD        TOTNTD                                        S0137
     C/COPY WNCPYSRC,DL0280C547
     C*                                                                   S01378
     C                   GOTO      GETDM                                                       S0137
2291 C*
2292 C*****     ADDITIONAL PROCESSING FOR BR TYPE ONLY.
2293 C*
2294 C     BRTYP         TAG                                                    **  BRTYP TAG *
     C/COPY WNCPYSRC,DL0280C715
      *                                                                                       CDL033
     C     INTR          IFEQ      *ZEROS                                       If Interes=0  CDL033
     C     RTSP          ANDLT     *ZEROS                                        & neg spread CDL033
     C     CDL033        ANDEQ     'Y'                                           SAR is "ON"  CDL033
     C     RTSPDM        ADD       RTSP          INTR                           NEW+SPR=INTR  CDL033
     C                   Z-ADD     RTSPDM        BRTE                            refresh BSRT CDL033
      *                                                                                       CDL033
     C                   ELSE                                                                 CDL033
      *                                                                                       CDL033
      ***Do*not*update*Interest*rate*or*Current*Base*Rate*if*Fixed*type             229360 AR1045065
      **********                                                                    229360 AR1045065
     C*****DTYP*         IFNE      'IP'                                             229360 AR1045065
     C*****DTYP*         ANDNE     'IT'                                             229360 AR1045065
     C*****DTYP*         ANDNE     'TD'                                             229360 AR1045065
     C*****DTYP*         ANDNE     'TI'                                             229360 AR1045065
     C*****DTYP*         ANDNE     'CI'                                             229360 AR1045065
2295 C*****INTR*         SUB       BRTE          INTR                                       AR324671
     C*****BRTT*         IFEQ      BRTTDM                                         MD031123 MD031123A
     C     RTSPDM        ADD       RTSP          INTR                                       AR324671
2296 C                   Z-ADD     RTSPDM        BRTE
     C**********         ELSE                                                     MD031123 MD031123A
     C*****BRTEDM        ADD       RTSP          INTR                             MD031123 MD031123A
2296 C**********         Z-ADD     BRTEDM        BRTE                             MD031123 MD031123A
     C**********         ENDIF                                                    MD031123 MD031123A
2297 C*****INTR*         ADD       BRTE          INTR                                       AR324671
     C**********         ENDIF                                                      229360 AR1045065
     C/COPY WNCPYSRC,DL0280C716
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C     INTR          IFLT      *ZEROS                                       If interes=0  CDL033
     C     RTSP          ANDLT     *ZEROS                                       & neg spread  CDL033
     C     CDL033        ANDEQ     'Y'                                           SAR is "ON"  CDL033
     C                   Z-ADD     *ZEROS        INTR                           0 to interest CDL033
     C                   ENDIF                                                 of interest=0  CDL033
      *                                                                                       CDL033
2298 C                   GOTO      GETDM
2299 C*
2300 C*****     SITYP IS A ROUTINE TO PROCESS AMENDMENT TYPE SI.
2301 C*
2302 C     SITYP         TAG                                                    ** SITYP TAG **
2303 C                   MOVEL     NEV(3)        NARREV
2304 C                   Z-ADD     VDATDM        NIPAR             5 0
     C/COPY WNCPYSRC,DL0280C535
2305 C   03              EXSR      NIDAT                                          DEPOSIT/LOAN
     C/COPY WNCPYSRC,DL0280C536
     C   U8              GOTO      ENDLM                                                       S0138
     C   04
2306 CAN 48              EXSR      NIDPA                                         NEG.ASS.PUR.
     C     CDL012        IFEQ      'Y'
     C                   Z-ADD     NIDT          UGNIDT
     C                   ENDIF
2307 C                   Z-ADD     0             NIDT
2308 C                   GOTO      GETDM
     C/COPY WNCPYSRC,DL0280C462
2414 C*
2415 C*****     GETDM  IS A ROUTINE TO READ NEXT DEAL AMENDMENT
2416 C*          RECORD AND ASCERTAIN WHAT FURTHER PROCESSING IS NEEDED.
2417 C*
2418 C     GETDM         TAG                                                    ** GETDM TAG **
      *                                                                                       CDL034
      ** Write Interest Rate History record for deal amendment                                CDL034
      *                                                                                       CDL034
     C     CDL034        IFEQ      'Y'                                                        CDL034
     C     AMTP          ANDNE     'CO'                                                     MD027681
     C     BRTT          IFNE      0                                                          CDL034
     C                   Z-ADD     VDATDM        KDATE                                        CDL034
     C                   EXSR      UPDIRH                                                     CDL034
     C                   ENDIF                                                                CDL034
     C                   ENDIF                                                                CDL034
     C/COPY WNCPYSRC,DL0280C568
2420 C                   MOVE      AMTP          STAMND            2
2421 C                   Z-ADD     VDATDM        STVDAT            5 0
2422 C                   Z-ADD     DASNDM        STDASN            3 0
     C/COPY WNCPYSRC,DL0280C614
2423 C                   SETOFF                                       070809
     C/COPY WNCPYSRC,DL0280C615
2424 C                   READ      DAMSX                                  42                   BHF64
2425 C***42*****         SETON                                        77LRU8                AR547995
     C   42              SETON                                        77LRU7                AR547995
2426 C   42              GOTO      ENDLM
2428 C  N09DLNODM        COMP      DLNO                                   53
     C  N09
2429 CAN 53TOTDMD        ADD       1             TOTDMD                                        BHF64
     C  N09
2430 CAN 53TOTDMS        ADD       1             TOTDMS                                        BHF64
     C  N09
2431 CAN 53              Z-ADD     TOTDHI        ZZTOTI                                        BHF64
     C  N09
2432 CAN 53              Z-ADD     TOTDHD        ZZTOTD                                        BHF64
     C  N09
2433 CAN 53DAAM          DIV       1000          ZZAMT                                         BHF64
     C  N09
2434 CAN 53              EXSR      GLZADD                                                      BHF64
     C  N09
2435 CAN 53              Z-ADD     ZZTOTI        TOTDHI                                        BHF64
     C  N09
2436 CAN 53              Z-ADD     ZZTOTD        TOTDHD                                        BHF64
     C  N09
2437 CAN 53PSEQ          COMP      5                                  3434
      *                                                                   S01378
      ** PSEQ is set to '7' for Parcelled NA's sold (DAPCLI record)       S01378
     C  N09
     CAN 53
     CAN 34PSEQ          COMP      7                                  3434                     S0137
     C  N09
2438 CAN 53              GOTO      DLMTAG
2439 C                   SETOFF                                       41
2440 C     STAMND        COMP      'CO'                                   53
     C     *IN53         IFEQ      '1'                                                         18505
     C     STAMND        OREQ      'BR'                                                     MD031134
     C     DLNODM        ANDNE     DLNO                                                     MD031134
     C                   MOVEL     STAMND        AMTP                                          18505
     C                   ENDIF                                                                 18505
2441 C   53              Z-ADD     STVDAT        DAVD
2442 C   53              Z-ADD     STDASN        DASN
2276 C   53DAVD          COMP      99999                                  99
     C   53
2277 CAN 99              Z-ADD     0             DAVD
     C  N53
2443 CAN 34              Z-ADD     0             DAVD
     C  N53
2444 CAN 34              Z-ADD     0             DASN
2445 C                   MOVE      '  '          STAMND
2446 C*
2447 C*****     END OF DLMND SUBROUTINE
2448 C*
2449 C     ENDLM         TAG                                                    ** ENDLM TAG **
2450 C                   SETOFF                                       60
      *                                                                   094711
      *** Restore the branch and the original entry date of the deal      094711
      *                                                                   094711
     C                   MOVE      WSBRCA        BRCA                                          09471
     C                   MOVE      WSORED        ORED                                          09471
      *                                                                   094711
2451 C                   ENDSR
2452 C*
2453 C********************************************************************
     C/COPY DLCPYSRC,DL0280FEDA                                                               CDL033
2506 C********************************************************************
2507 C*
2508 C*****    FXDV IS A SUBROUTINE TO GENERATE ACCOUNT KEYS FOR
2509 C*         DEAL AND VALUE DATE FOR F/X OUTRIGHTS AND OPTIONS
2510 C*
2511 C     FXDV          BEGSR                                                  *** FXDV    ***
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CCP9                                           S01408
     C*                                                                   S01408
2512 C     DTYP          COMP      'OP'                                   53
2513 C                   MOVEA     DLST          AKY(4)
2514 C                   MOVEA     '   '         AKY(6)
2515 C   65              MOVE      'B'           AKY(9)
2516 C                   MOVE      'B'           AKY(10)
2517 C                   Z-ADD     PAMT          KYAMT
     C  N47
     CAN 53
2518 CANN72              Z-ADD     ORPA          KYAMT
2519 C                   MOVE      PCCY          KYCCY                            PURCHASE
     C                   MOVE      RSCY          KYSCY                                         CEU00
2520 C                   Z-ADD     PCST          KYSETL
2521 C                   MOVE      OPCA          KYOSTL                              CCY
2257 C                   MOVE      ROBR          KYSTBR                                        S0111
2257 C                   MOVE      PRFC          OPPRFC                                        S0111
2522 C                   Z-ADD     SLAM          KYOTH
     C   53
     CANN72
     CANN47              Z-ADD     ORSA          KYOTH
2523 C                   MOVE      SLCY          KYOCCY
     C*                                                                   S01486
     C** IF PM INSTALLED, CALCULATE FX RATE                               S01486
     C     BGPFMG        IFEQ      'Y'                                                         S0148
     C     PTFR          ANDNE     *BLANKS                                                     S0148
     C                   EXSR      P02                                                         S0148
     C     WWERRF        CABEQ     'Y'           EOJ                                           S0148
     C                   END                                                                   S0148
2524 C*
2525 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
2526 C*
2527 C                   EXSR      FEDAT
2528 C*
2529 C  N65              MOVE      'F'           AKY(9)
     C**  FORMAT NOSTRO XFER KEY                                          S01108
     C     DTYP          IFEQ      'NX'                                                        S0110
     C                   MOVE      'D'           AKY(9)                                        S0110
     C                   MOVE      'B'           AKY(10)                                       S0110
     C                   END                                                                   S0110
     C/COPY WNCPYSRC,DL0280C055
2530 C                   EXSR      EXCP
     C/COPY WNCPYSRC,DL0280C056
2531 C                   Z-ADD     KYAMT         NRRPUR
2532 C   66              MOVE      'B'           AKY(9)
2533 C  N66              MOVE      'F'           AKY(9)                           SALE
2534 C                   MOVE      'C'           AKY(10)
     C**  FORMAT NOSTRO XFER KEY                                          S01108
     C     DTYP          IFEQ      'NX'                                                        S0110
     C                   MOVE      'C'           AKY(9)                                        S0110
     C                   MOVE      'B'           AKY(10)                                       S0110
     C                   END                                                                   S0110
2535 C                   Z-ADD     SLAM          KYAMT
2536 C**53 IS SET ON IN FEDAT. IS RESET AGAIN
2537 C     DTYP          COMP      'OP'                                   53
     C  N47
     CAN 53
2538 CANN72              Z-ADD     ORSA          KYAMT
2539 C                   MOVE      SLCY          KYCCY                               CCY
     C                   MOVE      PSCY          KYSCY                                         CEU00
2540 C                   Z-ADD     SCST          KYSETL
2541 C                   MOVE      OSCA          KYOSTL
2257 C                   MOVE      POBR          KYSTBR                                        S0111
2257 C                   MOVE      PRFC          OPPRFC                                        S0111
2542 C                   Z-ADD     PAMT          KYOTH
     C   53
     CANN72
     CANN47              Z-ADD     ORPA          KYOTH
2543 C                   MOVE      PCCY          KYOCCY
2544 C*
2545 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
2546 C*
2547 C                   EXSR      FEDAT
2548 C*
2549 C                   SETON                                        71
2550 C                   Z-ADD     KYAMT         NRRSAL
2551 C                   MOVE      KYCCY         SALCY
     C/COPY WNCPYSRC,DL0280C057
2552 C                   EXSR      EXCP
     C/COPY WNCPYSRC,DL0280C058
     C**  NO FURTHER PROCESSING FOR NOSTRO TRANSFERS                      S01108
     C     DTYP          COMP      'NX'                                   53                   S0110
     C   53              GOTO      ENDFX                                                       S0110
2553 C                   MOVEA     PCCY          AKY(6)                          BASE
2554 C                   MOVE      ' '           AKY(9)                               CCY
2555 C                   MOVE      'P'           AKY(10)
2556 C                   Z-ADD     BCEQ          KYAMT                             PURCHASE
     C/COPY WNCPYSRC,DL0280C675
2557 C** RESET 53 AGAIN.
2558 C     DTYP          COMP      'OP'                                   53
     C  N47
     CAN 53
2559 CANN72              Z-ADD     OBCE          KYAMT
2560 C                   MOVE      BJCYCD        KYCCY                                         S0119
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
2561 C                   Z-ADD     PCST          KYSETL
2562 C                   MOVE      OPCA          KYOSTL
2257 C                   MOVE      ROBR          KYSTBR                                        S0111
2257 C                   MOVE      PRFC          OPPRFC                                        S0111
2563 C                   MOVE      SLCY          KYOCCY
2564 C                   Z-ADD     SLAM          KYOTH
     C   53
     CANN72
     CANN47              Z-ADD     ORSA          KYOTH
2565 C*
2566 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
2567 C*
2568 C                   EXSR      FEDAT
     C*                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     MGCY          ANDEQ     SLCY                                                        CAC00
     C     MGCY          ANDEQ     BJCYCD                                                      CAC00
     C                   ADD       MGAM          KYAMT                                         CAC00
     C                   ENDIF                                                                 CAC00
     C*                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     MGCY          ANDEQ     PCCY                                                        CAC00
     C     MGCY          ANDEQ     BJCYCD                                                      CAC00
     C                   SUB       MGAM          KYAMT                                         CAC00
     C                   ENDIF                                                                 CAC00
     C*                                                                   CAC001
     C/COPY WNCPYSRC,DL0280C059
2571 C                   EXSR      EXCP
     C/COPY WNCPYSRC,DL0280C060
2573 C                   MOVEA     SLCY          AKY(6)                          BASE
2574 C                   MOVE      'S'           AKY(10)                              CCY
2575 C                   Z-ADD     SCST          KYSETL
2576 C                   MOVE      OSCA          KYOSTL                             SOLD
2257 C                   MOVE      POBR          KYSTBR                                        S0111
2257 C                   MOVE      PRFC          OPPRFC                                        S0111
2577 C                   Z-ADD     PAMT          KYOTH
     C   53
     CANN72
     CANN47              Z-ADD     ORPA          KYOTH
2578 C                   MOVE      PCCY          KYOCCY
2579 C                   Z-ADD     KYDAT         KYFED
     C/COPY WNCPYSRC,DL0280C061
2581 C                   EXSR      EXCP
     C*                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C*                                                                   CAC001
     C** If Analytical Accounting module is available, set-up account     CAC001
     C** key for the transaction profit centre.                           CAC001
     C*                                                                   CAC001
     C     MGCY          IFEQ      BJCYCD                                                      CAC00
     C                   MOVE      'B'           AKY(9)                                        CAC00
     C                   ELSE                                                                  CAC00
     C                   MOVE      'F'           AKY(9)                                        CAC00
     C                   ENDIF                                                                 CAC00
     C*                                                                   CAC001
     C                   MOVEA     '   '         AKY(6)                                        CAC00
     C                   MOVE      'M'           AKY(10)                                       CAC00
     C                   MOVE      MGCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     MGAM          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C*                                                                   CAC001
     C                   MOVE      ' '           AKY(9)                                        CAC00
     C*                                                                   CAC001
     C                   ENDIF                                                  - BGN0ST       CAC00
     C*                                                                   CAC001
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP10                                           S01408
     C*                                                                   S01408
2583 C     ENDFX         ENDSR                                                  ** ENDFX TAG **
2584 C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C142                                           S01408
      *                                                                                       CDL099
      ********************************************************************                    CDL099
      ** #BFXPV IS A SUBROUTINE TO GENERATE ACCOUNT KEYS FOR PURCHASE    *                    CDL099
      **        VALUE DATE FOR F/X OUTRIGHTS AND OPTIONS.                *                    CDL099
      ********************************************************************                    CDL099
      *                                                                                       CDL099
     C     #BFXPV        BEGSR                                                                CDL099
      *                                                                                       CDL099
     C                   MOVE      ' '           SPLIT             1                          CDL099
     C     BSDT2         COMP      VDAT                                 53                    CDL099
     C   53              MOVE      'S'           SPLIT                                        CDL099
     C     VDAT          COMP      BSDT2                                53                    CDL099
     C   53              MOVE      'P'           SPLIT                                        CDL099
     C     DTYP          COMP      'OP'                                   53                  CDL099
     C                   MOVEA     DLST          AKY(4)                                       CDL099
     C                   MOVEA     '   '         AKY(6)                                       CDL099
     C   65              MOVE      'B'           AKY(9)                                       CDL099
     C                   MOVE      'B'           AKY(10)                                      CDL099
     C                   MOVEL     BBE(2)        NARREV                                       CDL099
     C                   Z-ADD     PAMT          KYAMT                                        CDL099
     C  N47                                                                                   CDL099
     CAN 53                                                                                   CDL099
     CANN72              Z-ADD     ORPA          KYAMT                                        CDL099
     C                   MOVE      PCCY          KYCCY                                        CDL099
     C                   MOVE      RSCY          KYSCY                                        CDL099
     C                   MOVE      ROBR          KYSTBR                                       CDL099
     C                   Z-ADD     PCST          KYSETL                                       CDL099
     C                   MOVE      OPCA          KYOSTL                                       CDL099
     C                   Z-ADD     SLAM          KYOTH                                        CDL099
     C                   MOVE      SLCY          KYOCCY                                       CDL099
      *                                                                                       CDL099
      ** Calculate the Federal Fund Value date                                                CDL099
      *                                                                                       CDL099
     C                   EXSR      FEDAT                                                      CDL099
     C  N65              MOVE      'F'           AKY(9)                                       CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
     C                   Z-ADD     KYAMT         NRRPUR                                       CDL099
     C                   MOVEA     PCCY          AKY(6)                                       CDL099
     C                   MOVEA     ' '           AKY(9)                                       CDL099
     C   11              MOVE      SPLIT         AKY(9)                                       CDL099
     C                   MOVE      'P'           AKY(10)                                      CDL099
     C                   Z-ADD     BCEQ          KYAMT                                        CDL099
      *                                                                                       CDL099
      ** Reset 53 again                                                                       CDL099
      *                                                                                       CDL099
     C     DTYP          COMP      'OP'                                   53                  CDL099
     C  N47                                                                                   CDL099
     CAN 53                                                                                   CDL099
     CANN72              Z-ADD     OBCE          KYAMT                                        CDL099
     C                   MOVE      BJCYCD        KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   Z-ADD     PCST          KYSETL                                       CDL099
     C                   MOVE      OPCA          KYOSTL                                       CDL099
     C                   MOVE      SLCY          KYOCCY                                       CDL099
     C                   MOVE      SLCY          SALCY                                        CDL099
     C                   Z-ADD     SLAM          KYOTH                                        CDL099
      *                                                                                       CDL099
      ** Calculate the Federal Fund Value date                                                CDL099
      *                                                                                       CDL099
     C                   EXSR      FEDAT                                                      CDL099
     C                   SETON                                        3871                    CDL099
      *                                                                                       CDL099
     C     BGN0ST        IFEQ      'Y'                                                        CDL099
     C     MGCY          ANDEQ     SLCY                                                       CDL099
     C     MGCY          ANDEQ     BJCYCD                                                     CDL099
     C                   ADD       MGAM          KYAMT                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C     BGN0ST        IFEQ      'Y'                                                        CDL099
     C     MGCY          ANDEQ     PCCY                                                       CDL099
     C     MGCY          ANDEQ     BJCYCD                                                     CDL099
     C                   SUB       MGAM          KYAMT                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
     C                   SETOFF                                       3871                    CDL099
      *                                                                                       CDL099
     C     BGN0ST        IFEQ      'Y'                                                        CDL099
     C     MGCY          ANDEQ     PCCY                                                       CDL099
      *                                                                                       CDL099
      ** If Analytical Accounting module is available, set-up account                         CDL099
      ** key for the transaction profit centre.                                               CDL099
      *                                                                                       CDL099
     C     MGCY          IFEQ      BJCYCD                                                     CDL099
     C                   MOVE      'B'           AKY(9)                                       CDL099
     C                   ELSE                                                                 CDL099
     C                   MOVE      'F'           AKY(9)                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   MOVEA     '   '         AKY(6)                                       CDL099
     C                   MOVE      'M'           AKY(10)                                      CDL099
     C                   MOVE      MGCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   Z-ADD     MGAM          KYAMT                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
     C                   MOVE      ' '           AKY(9)                                       CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   MOVE      '1'           *IN15                                        CDL099
      *                                                                                       CDL099
     C                   ENDSR                                                                CDL099
      *                                                                                       CDL099
      *******************************************************************                     CDL099
      *  #BFXSV IS A SUBROUTINE TO GENERATE ACCOUNT KEYS FOR SALE VALUE *                     CDL099
      *         DATE FOR F/X OUTRIGHTS AND OPTIONS.                     *                     CDL099
      *******************************************************************                     CDL099
      *                                                                                       CDL099
     C     #BFXSV        BEGSR                                                                CDL099
      *                                                                                       CDL099
     C                   MOVE      ' '           SPLIT             1                          CDL099
     C     BSDT2         COMP      VDAT                                 53                    CDL099
     C   53              MOVE      'S'           SPLIT                                        CDL099
     C     VDAT          COMP      BSDT2                                53                    CDL099
     C   53              MOVE      'P'           SPLIT                                        CDL099
     C                   MOVEA     DLST          AKY(4)                                       CDL099
     C                   MOVEA     '   '         AKY(6)                                       CDL099
     C   66              MOVE      'B'           AKY(9)                                       CDL099
     C  N66              MOVE      'F'           AKY(9)                                       CDL099
     C                   MOVE      'C'           AKY(10)                                      CDL099
     C                   MOVEL     BBE(1)        NARREV                                       CDL099
     C                   Z-ADD     SLAM          KYAMT                                        CDL099
      *                                                                                       CDL099
      ** Reset 53 again                                                                       CDL099
      *                                                                                       CDL099
     C     DTYP          COMP      'OP'                                   53                  CDL099
     C  N47                                                                                   CDL099
     CAN 53                                                                                   CDL099
     CANN72              Z-ADD     ORSA          KYAMT                                        CDL099
     C                   MOVE      SLCY          KYCCY                                        CDL099
     C                   MOVE      PSCY          KYSCY                                        CDL099
     C                   MOVE      POBR          KYSTBR                                       CDL099
     C                   Z-ADD     SCST          KYSETL                                       CDL099
     C                   MOVE      OSCA          KYOSTL                                       CDL099
     C                   Z-ADD     PAMT          KYOTH                                        CDL099
     C                   MOVE      PCCY          KYOCCY                                       CDL099
      *                                                                                       CDL099
      ** Calculate the Federal Fund Value date                                                CDL099
      *                                                                                       CDL099
     C                   EXSR      FEDAT                                                      CDL099
     C                   SETON                                        71                      CDL099
     C                   Z-ADD     KYAMT         NRRSAL                                       CDL099
     C                   MOVE      KYCCY         SALCY                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
     C                   Z-ADD     BCEQ          KYAMT                                        CDL099
     C     DTYP          COMP      'OP'                                   53                  CDL099
     C  N47                                                                                   CDL099
     CAN 53                                                                                   CDL099
     CANN72              Z-ADD     OBCE          KYAMT                                        CDL099
     C                   MOVE      BJCYCD        KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   MOVEA     SLCY          AKY(6)                                       CDL099
     C                   MOVE      'S'           AKY(10)                                      CDL099
     C                   MOVEA     ' '           AKY(9)                                       CDL099
     C   11              MOVE      SPLIT         AKY(9)                                       CDL099
     C                   Z-ADD     SCST          KYSETL                                       CDL099
     C                   MOVE      OSCA          KYOSTL                                       CDL099
     C                   Z-ADD     PAMT          KYOTH                                        CDL099
     C                   MOVE      PCCY          KYOCCY                                       CDL099
     C                   Z-ADD     KYDAT         KYFED                                        CDL099
     C                   SETON                                        38                      CDL099
      *                                                                                       CDL099
     C     BGN0ST        IFEQ      'Y'                                                        CDL099
     C     MGCY          ANDEQ     SLCY                                                       CDL099
     C     MGCY          ANDEQ     BJCYCD                                                     CDL099
     C                   ADD       MGAM          KYAMT                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C     BGN0ST        IFEQ      'Y'                                                        CDL099
     C     MGCY          ANDEQ     PCCY                                                       CDL099
     C     MGCY          ANDEQ     BJCYCD                                                     CDL099
     C                   SUB       MGAM          KYAMT                                        CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
     C                   SETOFF                                       38                      CDL099
      *                                                                                       CDL099
     C     BGN0ST        IFEQ      'Y'                                                        CDL099
     C     MGCY          ANDEQ     SLCY                                                       CDL099
      *                                                                                       CDL099
      ** If Analytical Accounting module is available, set-up account                         CDL099
      ** key for the transaction profit centre.                                               CDL099
      *                                                                                       CDL099
     C     MGCY          IFEQ      BJCYCD                                                     CDL099
     C                   MOVE      'B'           AKY(9)                                       CDL099
     C                   ELSE                                                                 CDL099
     C                   MOVE      'F'           AKY(9)                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   MOVEA     '   '         AKY(6)                                       CDL099
     C                   MOVE      'M'           AKY(10)                                      CDL099
     C                   MOVE      MGCY          KYCCY                                        CDL099
     C                   MOVE      *BLANKS       KYSCY                                        CDL099
     C                   Z-ADD     MGAM          KYAMT                                        CDL099
     C                   MOVE      PRFC          OPPRFC                                       CDL099
     C                   EXSR      EXCP                                                       CDL099
      *                                                                                       CDL099
     C                   MOVE      ' '           AKY(9)                                       CDL099
      *                                                                                       CDL099
     C                   ENDIF                                                                CDL099
      *                                                                                       CDL099
     C                   MOVE      '1'           *IN15                                        CDL099
      *                                                                                       CDL099
     C                   ENDSR                                                                CDL099
      *                                                                                       CDL099
     C*                                                                   S01408
2585 C********************************************************************
2586 C*
2587 C*****    ASSPDV IS A SHARED ROUTINE THAT CHECKS IF DEAL AND
2588 C*         VALUE DATE PROCESSING IS REQUIRED FOR NEG.ASSETS
2589 C*         PURCHASED (INTEREST AND NON-INTEREST BEARING),INCLUDING
2590 C*         REVERSALS,AND PROCESSES THEM ACCORDINGLY.
2591 C*
2592 C*
2593 C     ASSPDV        BEGSR                                                  *** ASSPDV  ***
2594 C*
2595 C*****    CHECK IF DEAL DATE PROCESSING REQUIRED.
2596 C*
     C   U8              GOTO      ENDASS                                                      S0138
2601 C                   MOVEA     '    '        AKY(6)
2602 C                   MOVEA     DLST          AKY(4)
2603 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
2604 C                   Z-ADD     SDST          KYSETL
2605 C                   MOVE      OSDA          KYOSTL
2257 C                   MOVE      POBR          KYSTBR                                        S0111
2257 C                   MOVE      PRFC          OPPRFC                                        S0111
2888 C                   Z-ADD     0             NRRSAL
2606 C                   TESTB     '0'           ACEI                     53
     C  N47
2607 CAN 53
     COR 47
2608 CANN53              GOTO      ASSPV
2609 C  N47DDAT          COMP      EVCD                               53
     C  N47
2610 CAN 53              GOTO      ENDASS
     C/COPY WNCPYSRC,DL0280C616
2611 C*
2612 C*****     GENERATE DEAL DATE ACCOUNT KEY
2613 C*
     C                   SETON                                        71
2614 C                   MOVEL     NEV(1)        NARREV
2615 C                   MOVE      'D'           AKY(3)
2616 C                   MOVE      'A'           AKY(10)
2617 C                   Z-ADD     PAMT          KYAMT
2618 C                   Z-ADD     DDAT          KYDAT
2619 C*
2620 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
2621 C*
2622 C                   EXSR      FEDAT
2623 C*
     C  N28
     COR 28
     CANN26              EXSR      EXCP
     C   49
     CAN 28
     COR 48
     CAN 28              MOVE      'F'           AKY(10)
     C   49
     CAN 28
     COR 48
     CAN 28              Z-ADD     FVAL          KYAMT
     C   49
     CAN 28
     COR 48
     CAN 28              EXSR      EXCP
2627 C                   BITON     '0'           ACEI
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
2628 C*
2629 C*****    ASSPV IS A ROUTINE TO CHECK IF VALUE DATE PROCESSING
2630 C*         IS REQUIRED.
2631 C*
2632 C     ASSPV         TAG                                                    ** ASSPV TAG **
     C   U8              GOTO      ENDASS                                                      S0138
2637 C                   TESTB     '1'           ACEI                     53
     C  N47
2638 CAN 53
     COR 47
2639 CANN53              GOTO      ENDASS
2640 C  N47VDAT          COMP      EVCD                               53
     C  N47
2641 CAN 53              GOTO      ENDASS
     C/COPY WNCPYSRC,DL0280C617
2642 C*
2643 C*****     GENERATE VALUE DATE ACCOUNT KEY
2644 C*
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
     C                   SETON                                        71
2645 C                   MOVEL     NEV(2)        NARREV
2646 C                   MOVE      'V'           AKY(3)
2647 C                   MOVE      'A'           AKY(10)
2648 C                   Z-ADD     PAMT          KYAMT
2649 C                   Z-ADD     VDAT          KYDAT
2650 C*
2651 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
2652 C*
2653 C                   EXSR      FEDAT
2654 C*
     C  N28
     COR 28
     CANN26              EXSR      EXCP
      *                                                                                       CAS009
     C  N28                                                                                   CAS009
     COR 28                                                                                   CAS009
     CANN26              MOVE      'SAMT'        WCFTP             4                          CAS009
     C  N28                                                                                   CAS009
     COR 28                                                                                   CAS009
     CANN26              EXSR      SRMMCF                                                     CAS009
     C*                                                                   CAC001
     C** If Analytical Accounting is available, for NA Purchased, set-up  CAC001
     C** the following value date account keys.                           CAC001
     C*                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C*                                                                   CAC001
     C** Purchase Price - Transaction Profit Centre                       CAC001
     C*                                                                   CAC001
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   Z-ADD     PAMT          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C*                                                                   CAC001
     C** Purchase Price - Funding Profit Centre                           CAC001
     C*                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C*                                                                   CAC001
     C                   ENDIF                                                  - BGN0ST       CAC00
     C*                                                                   CAC001
2658 C                   BITON     '1'           ACEI
     C   28
     CAN 48
     CANN26              MOVE      'P'           AKY(10)
     C   28
     CAN 48
     CANN26              Z-ADD     PINT          KYAMT
     C**  FOR REVERSAL THE PURCHASED INTEREST IS NOW SAVED
     C   28
     CAN 48
     CANN26              Z-ADD     REPINT        KYAMT
     C**
     C   28
     CAN 48
     CANN26              EXSR      EXCP
     C*
     C  N28              GOTO      ENDASS
     C   49
     COR 48              MOVE      'F'           AKY(10)                        FACE VALUE
     C   49
     COR 48              Z-ADD     FVAL          KYAMT
     C   49
     COR 48              EXSR      EXCP
     C   26              GOTO      ENDAS1                                        DEAL TYPE = C1S0137
     C   49
     COR 48
     CANN27              MOVE      'D'           AKY(10)                         DISCOUNT
     C   49
     COR 48
     CANN27              Z-ADD     DISA          KYAMT
     C   49
     COR 48
     CANN27              EXSR      EXCP
     C   48
     CAN 27              MOVE      'C'           AKY(10)
     C   48
     CAN 27              Z-SUB     DISA          KYAMT
     C   48
     CAN 27              EXSR      EXCP
     C*                                                                   S01378
     C     ENDAS1        TAG                                                    ** ENDAS1 TAG *S0137
     C*                                                                   S01378
     C   41              Z-ADD     VDAT          PARDAT                                        S0137
     C   41              EXSR      DLAMND                                                      S0137
2659 C*
2660 C*****    END OF ASSPDV SUBROUTINE
2661 C*
2662 C     ENDASS        ENDSR
2663 C*
2664 C********************************************************************
     C/COPY WNCPYSRC,DL0280C463
2664 C********************************************************************
2665 C*                                                                   080603
2666 C** SR/NIDAT    Process Next Interest Date and SI Deal Amendments    080603
2669 C*                                                                   080603
2664 C********************************************************************080603
2781 C*                                                                   080603
2670 C     NIDAT         BEGSR                                                  *** NIDAT   ***08060
2781 C*                                                                   080603
2781 C                   Z-ADD     PAMT          PAMT1            13 0                         08060
2781 C* FOR MATURED FREQ.='N' DO NOT ACCRUAL INTEREST AS IT WOULD         080603
2781 C* HAVE ALREADY BEEN CALCULATED AT MATURITY DATE.                    080603
2781 C     IPFR          IFEQ      'N'                                                         08060
2781 C     RECR          ANDEQ     'M'                                                         08060
2781 C                   Z-ADD     AITC          WORKTD                                        08060
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSAITN        WKNTRD
     C                   ENDIF
2781 C                   ELSE                                                                  08060
2671 C                   Z-ADD     IACD          ZIBEG                                         08060
2672 C                   Z-ADD     NIPAR         ZIEND                                         08060
     C/COPY WNCPYSRC,DL0280C149                                           S01408
2673 C                   Z-ADD     PAMT          ZIAMT                           INT.          08060
2674 C                   Z-ADD     ICBS          ZICALC                            CALCULATED  08060
2675 C                   Z-ADD     INTR          ZIRATE                                        08060
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP36                                           S01408
      *                                                                   S01408
2676 C                   EXSR      GLINTC                                                      08060
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP37                                           S01408
2781 C*                                                                   080603
2781 C*                                                                   080603
2781 C     *IN02         IFEQ      '1'                                                         08060
2781 C     ZIRDFC        ANDEQ     'Y'                                                         08060
2781 C     *IN03         OREQ      '1'                                                         08060
2781 C     JRDFC         ANDEQ     'Y'                                                         08060
2781 C     *IN04         OREQ      '1'                                                         08060
2781 C     JRDFC         ANDEQ     'Y'                                                         08060
2781 C                   Z-ADD     ZINTR         WKINT                                         08060
2781 C                   ELSE                                                                  08060
2781 C                   Z-ADD(H)  ZINTR         WKINT                                         08060
2781 C                   END                                                                   08060
      *                                                                                     MD031631
      ** If 'UseHistRateforBVDeal' is Y and multiple base rate change                       MD031631
      ** detected then use the historic base rate for backdated MM deals                    MD031631
      *                                                                                     MD031631
     C                   IF        HSTRAT = 'Y' AND                                         MD031631
     C                             NIDATF = 'Y' AND                                         MD031631
     C                             CtrBV  > 0                                               MD031631
2238 C                   EXSR      DLBRCP                                                   MD031631
2238 C                   ENDIF                                                              MD031631
     C                   EVAL      NIDATF= 'N'                                              MD031631
2781 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C089
      *                                                                                       CDL034
      ** Calculate accrued interest from Deal Interest Rate History file                      CDL034
      *                                                                                       CDL034
     C     CDL034        IFEQ      'Y'                                                        CDL034
     C     BRTT          IFNE      0                                                          CDL034
     C                   MOVE      'I'           INTMAT                                       CDL034
     C                   Z-ADD     IACD          WKIACD                                     MD027681
     C                   EXSR      DLINT                                                      CDL034
     C                   ENDIF                                                                CDL034
     C                   ENDIF                                                                CDL034
2677 C     WKINT         ADD       AITC          WORKTD           13 0                         08060
     C     CDL034        IFEQ      'Y'                                                        CDL034
     C     BRTT          IFNE      0                                                          CDL034
     C                   ADD       IRHADJ        WORKTD                                       CDL034
     C                   ENDIF                                                                CDL034
     C                   ENDIF                                                                CDL034
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C                   Z-ADD     INTR          WRKINT
     C                   EXSR      SRNTR
      *                                                                                       CAS005
     C                   Z-ADD     IACD          ZIBEG
     C                   Z-ADD     NIPAR         ZIEND
     C                   Z-ADD     FSPAMT        ZIAMT
     C                   Z-ADD     ICBS          ZICALC
     C                   Z-ADD     WKINTR        ZIRATE
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
     C     WINTST        ADD       FSAITN        WKNTRD
      *                                                                                       CAS005
     C                   ENDIF
2781 C                   END                                                                   08060
2781 C*                                                                   080603
2781 C**  CHECK TO BACK VALUATIONS AND PREVENT ACCRUAL REVERSALS          080603
2781 C*                                                                   080603
2781 C     *IN03         IFEQ      *ON                                                         08060
2781 C     INTR          IFGE      0                                                           08060
2781 C     WORKTD        ADD       AIAP          WORKXX           13 0                         08060
2781 C     WORKXX        SUB       AIPD          WORKYY           13 0  53                     08060
2781 C   53WORKXX        COMP      0                                  53  53                   08060
2781 C                   ELSE                                                                  08060
2781 C**  Negative Interest                                               080603
2781 C*                                                                   080603
2781 C     WORKTD        ADD       AIAP          WORKXX                                        08060
2781 C     WORKXX        SUB       AIPD          WORKYY               53                       08060
2781 C   53WORKXX        COMP      0                                    5353                   08060
2781 C                   ENDIF                                                                 08060
2781 C                   ENDIF                                                                 08060
2781 C*                                                                   080603
2781 C     ACCRB         TAG                                                     ** ACCRB TAG *08060
2781 C     WORKTD        ADD       AIAN          WORKTD                          ACCRUED       08060
2781 C     WORKTD        ADD       AIAP          WORKTD                             TO DATE.   08060
2781 C     WORKTD        SUB       AIPD          WORKTP           13 0           INT. TO POST. 08060
     C   53
2781 CAN 03              Z-ADD     AIAN          WORKTP                                        08060
2781 C                   SETOFF                                       53                       08060
2781 C     WORKTD        SUB       IPRD          WORKD            13 0                         08060
2781 C     WORKD         SUB       ICTD          WORKD                           INT. DUE      08060
     C/COPY WNCPYSRC,DL0280C175                                           S01408
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     WKNTRD        ADD       FSAINN        WKNTRD
     C     WKNTRD        ADD       FSAIAN        WKNTRD
     C     WKNTRD        SUB       FSAIPN        WKNTRP
     C     *IN53         IFEQ      *ON
     C     *IN03         ANDEQ     *ON
     C                   Z-ADD     FSAINN        WKNTRP
     C                   ENDIF
     C     WKNTRD        SUB       FSIPRN        WKNTR
     C     WKNTR         SUB       FSICTN        WKNTR
     C                   ENDIF
2781 C*                                                                   080603
2781 C* IF DEAL IS TAXABLE                                                080603
2781 C*                                                                   080603
2781 C                   Z-ADD     0             TAXA                                          08060
2781 C     *IN23         IFEQ      *ON                                          B 001          08060
     C     *IN25         ANDEQ     *ON                                                         11702
2781 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C524
2781 C** IF BRT SAR IS INSTALLED                                          080603
2781 C*                                                                   080603
2781 C     S01383        IFEQ      'Y'                                          B 002          08060
2781 C*                                                                   080603
2781 C** CALCULATE TAX AMOUNT TAXA USING BRT RATES                        080603
2781 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C033
2781 C                   Z-ADD     NIPAR         WKMDAT                                        08060
2781 C                   EXSR      CALBRT                                                      08060
2781 C   U8              GOTO      ENDNID                                                      08060
     C/COPY WNCPYSRC,DL0280C034
2781 C*                                                                   080603
2781 C** ELSE BRT SAR IS NOT INSTALLED                                    080603
2781 C*                                                                   080603
2781 C                   ELSE                                                   X 002          08060
2781 C*                                                                   080603
2781 C** CALCULATE TAX AMOUNT USING HK INTEREST RATE                      080603
2781 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C525
2781 C* ROUND DOWN                                                        080603
2781 C     JRDFC         IFEQ      'Y'                                          B 003          08060
1097 C     WORKD         MULT      BNHKTR        TAXA                                          08060
2781 C     TAXA          DIV       100           TAXA                                          08060
2781 C                   ELSE                                                                  08060
2781 C     WORKD         MULT(H)   BNHKTR        TAXA                                          08060
2781 C     TAXA          DIV(H)    100           TAXA                                          08060
2781 C                   END                                                    E 003          08060
     C/COPY WNCPYSRC,DL0280C526
2781 C                   END                                                    E 002          08060
     C*                                                                   S01408
     C     CDL013        IFEQ      '1'                                                        CDL013
     C                   SELECT                                                               CDL013
     C     TAXI          WHENEQ    '0'                                                        CDL013
     C                   Z-ADD     0             WRATE                                        CDL013
     C     TAXI          WHENEQ    '1'                                                        CDL013
     C                   Z-ADD     ETXR1         WRATE                                        CDL013
     C     TAXI          WHENEQ    '2'                                                        CDL013
     C                   Z-ADD     ETXR2         WRATE                                        CDL013
     C     TAXI          WHENEQ    '3'                                                        CDL013
     C                   Z-ADD     ETXR3         WRATE                                        CDL013
     C     TAXI          WHENEQ    '4'                                                        CDL013
     C                   Z-ADD     ETXR4         WRATE                                        CDL013
     C     TAXI          WHENEQ    '5'                                                        CDL013
     C                   Z-ADD     ETXR5         WRATE                                        CDL013
     C     TAXI          WHENEQ    '6'                                                        CDL013
     C                   Z-ADD     ETXR6         WRATE                                        CDL013
     C     TAXI          WHENEQ    '7'                                                        CDL013
     C                   Z-ADD     ETXR7         WRATE                                        CDL013
     C     TAXI          WHENEQ    '8'                                                        CDL013
     C                   Z-ADD     ETXR8         WRATE                                        CDL013
     C     TAXI          WHENEQ    '9'                                                        CDL013
     C                   Z-ADD     ETXR9         WRATE                                        CDL013
     C                   ENDSL                                                                CDL013
     C     WRATE         IFEQ      0                                                          CDL013
     C                   Z-ADD     0             TAXA                                         CDL013
     C                   ELSE                                                                 CDL013
     C                   Z-ADD     NIPAR         WEVTDT                                       CDL013
     C     MATURE        IFEQ      'XX'                                                       CDL013
     C                   ADD       1             WEVTDT                                       CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DLH00103
     C                   EXSR      #UTWHT                                                     CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280C116                                           S01408
     C*                                                                   S01408
     C     CGL165        IFEQ      'Y'                                                        CGL165
     C     TAXI          ANDEQ     'Y'                                                        CGL165
      *                                                                                       CGL165
     C                   Z-ADD     WORKD         PINTA                                        CGL165
     C                   MOVEL     DLNO          PACNO                                        CGL165
     C                   CALL      'GL024000'                                                 CGL165
     C                   PARM                    PRCOD1            1                          CGL165
     C                   PARM      'DL0280'      PCPGM             6                          CGL165
     C                   PARM      BRCA          PBRCA             3                          CGL165
     C                   PARM      CNUM          PCNUM             6                          CGL165
     C                   PARM                    PACNO            10                          CGL165
     C                   PARM                    PCCY              3                          CGL165
     C                   PARM                    PINTA            15 0                        CGL165
     C                   PARM      TXC1          PTXC1             2                          CGL165
     C                   PARM      TXC2          PTXC2             2                          CGL165
     C                   PARM      EVCD          PCPDT             5 0                        CGL165
     C                   PARM      VDAT          PVDAT             5 0                        CGL165
     C                   PARM      MDAT          PMDAT             5 0                        CGL165
     C                   PARM      INTR          PINRT            11 7                        CGL165
     C                   PARM      DTYP          PDTYP             2                          CGL165
     C                   PARM      PAMT          PPCPL            15 0                        CGL165
     C                   PARM      *BLANKS       PACOD            10                          CGL165
     C                   PARM      *ZEROS        PACSQ             2 0                        CGL165
     C                   PARM                    PWTXA            15 0                        CGL165
     C                   PARM                    PSTXA            15 0                        CGL165
      *                                                                                       CGL165
     C     PWTXA         ADD       PSTXA         TAXA                                         CGL165
     C                   ENDIF                                                                CGL165
2781 C                   END                                                    E 001          08060
     C/COPY WNCPYSRC,DL0280C176                                           S01408
2781 C*                                                                   080603
2781 C* INTEREST CAN NOT BE CAPITALISED TO PRINCIPAL IF MDAT HAS PASSED   080603
2781 C*                                                                   080603
     C                   MOVE      'N'           WINTC             1                          234403
      *                                                                                       234403
2781 C     RECR          IFNE      'M'                                                         08060
     C     AMTP          ANDEQ     'CI'                                                        10198
2781 C     *IN25         ANDEQ     *OFF                                                        08060
     C     RECR          ORNE      'M'                                                         13160
     C     INTC          ANDEQ     'Y'                                                         13160
     C     *IN25         ANDEQ     *OFF                                                        13160
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C219                                           S01408
     C*                                                                   S01408
     C                   MOVE      'Y'           WINTC                                        234403
2781 C                   MOVE      'C'           AKY(10)                                       08060
2781 C                   ELSE                                                                  08060
2781 C                   MOVE      'I'           AKY(10)                                       08060
2781 C                   END                                                                   08060
2781 C*                                                                   080603
2781 C*****    GENERATE ACCOUNT KEY FOR INTEREST DUE.                     080603
2781 C*                                                                   080603
2781 C                   Z-ADD     INTR          NARRAT                                        08060
2781 C                   MOVE      'I'           AKY(3)                                        08060
2781 C                   MOVEA     '    '        AKY(6)                                        08060
2781 C                   MOVEA     DLST          AKY(4)                                        08060
     C/COPY WNCPYSRC,DL0280C177                                           S01408
2711 C                   Z-ADD     NIPAR         KYDAT                                         08060
      *                                                                                       CDL096
      * If Amount Convention is Actual then NIPAR will have been updated                      CDL096
      * to be value of Interest Base date for interest calculation so                         CDL096
      * use saved value for output of value date on A/C Key output                            CDL096
     C     CDL096        IFEQ      'Y'                                                        CDL096
     C     IPFR          ANDNE     *BLANKS                                                    CDL096
     C     AMTC          ANDEQ     'A '                                                       CDL096
     C                   Z-ADD     WNIPAR        KYDAT                                        CDL096
     C                   ENDIF                                                                CDL096
      *                                                                                       CDL096
2781 C     MATURE        IFEQ      'XX'                                                        08060
2781 C                   ADD       1             KYDAT                                         08060
2781 C                   MOVE      *BLANK        MATURE                                        08060
     C/COPY WNCPYSRC,DL0280C531
2781 C                   END                                                                   08060
2712 C                   Z-ADD     WORKD         KYAMT                                         08060
     C/COPY WNCPYSRC,DL0280C517
2713 C                   MOVE      PCCY          KYCCY                                         08060
     C     *IN60         IFEQ      *ON                                                         CEU00
     C                   MOVE      STCYM         KYSCY                                         CEU00
     C                   ELSE                                                                  CEU00
     C     IPDS          IFEQ      'Y'                                                         CEU00
     C                   MOVE      ISCY          KYSCY                                         CEU00
     C                   ELSE                                                                  CEU00
     C                   MOVE      STCY          KYSCY                                         CEU00
     C                   ENDIF                                                                 CEU00
     C                   ENDIF                                                                 CEU00
2713 C                   MOVE      PRFC          OPPRFC                                        08060
2714 C   60              Z-ADD     SETP          KYSETL                                        08060
2715 C   60              MOVE      OSAC          KYOSTL                                        08060
2715 C   60              MOVE      OSBR          KYSTBR                                        08060
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C     *IN60         ANDEQ     *ON
     C                   MOVE      'DA'          STINFO
     C                   ENDIF
      *                                                                                       CGL020
2716 C  N60              Z-ADD     MDST          KYSETL                                        08060
2717 C  N60              MOVE      OMDA          KYOSTL                                        08060
2781 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C107                                           S01408
      *                                                                   S01408
2781 C     *IN60         IFEQ      '0'                                                         08060
2781 C**   IF INTEREST IS TO BE POSTED SEPARATELY, USE THE INTEREST       080603
2781 C**   SETTLEMENT INSTRUCTIONS (IF PRESENT) INSTEAD OF MATURITY       080603
2781 C**   INSTRUCTIONS                                                   080603
2781 C*                                                                   080603
2781 C     IPDS          IFEQ      'Y'                                                         08060
2781 C     IMET          ANDNE     *BLANKS                                                     08060
2781 C     IMET          ANDNE     *ZEROS                                                      08060
2781 C                   MOVE      IMET          KYSETL                                        08060
2781 C                   MOVEL     INSA          KYOSTL                                        08060
2781 C                   ENDIF                                                                 08060
2781 C*                                                                   080603
2781 C** IS MATURITY DATE A PAY OR RECEIVE PROCESS (IE DEPOSIT/LOAN PLACED080603
     C     DTYP          IFEQ      'IP'                                                        11894
     C     DTYP          OREQ      'TI'                                                        11894
     C     DTYP          OREQ      'LN'                                                        11894
     C     DTYP          OREQ      'CL'                                                        11894
     C     DTYP          OREQ      'DL'                                                        11894
     C     DTYP          OREQ      'IL'                                                        11894
0962 C                   MOVE      ROBR          KYSTBR                                        08060
2781 C                   ELSE                                                                  08060
0962 C                   MOVE      POBR          KYSTBR                                        08060
2781 C                   END                                                                   08060
     C**********         ENDIF                                                                237562
2781 C                   END                                                                   08060
2718 C*                                                                   080603
2719 C*****    CALCULATE THE FEDERAL FUND VALUE DATE                      080603
2720 C*                                                                   080603
2721 C                   EXSR      FEDAT                                                       08060
     C/COPY WNCPYSRC,DL0280C178                                           S01408
2722 C*                                                                   080603
2724 C     KYAMT         SUB       TAXA          NRRSAL                                        08060
     C/COPY WNCPYSRC,DL0280C179                                           S01408
2726 C                   SETON                                        71                       08060
2781 C*                                                                   080603
2781 C** If Taxable Interest key required                                 080603
2781 C*                                                                   080603
2781 C     S01460        IFEQ      'Y'                                                         08060
2781 C     *IN23         ANDEQ     *ON                                                         08060
2781 C     CGL165        OREQ      'Y'                                                        CGL165
2781 C     *IN23         ANDEQ     *ON                                                        CGL165
2781 C                   MOVE      'T'           AKY(9)                                        08060
2781 C                   END                                                                   08060
     C*                                                                   S01408
     C     CDL013        IFEQ      '1'                                                        CDL013
     C     BBCSTY        IFEQ      'C'                                                        CDL013
     C     S01460        ANDEQ     'Y'                                                      AR809735
     C     *IN23         ANDEQ     *ON                                                      AR809735
     C                   MOVE      'C'           AKY(6)                                       CDL013
     C                   ELSE                                                                 CDL013
     C                   MOVE      ' '           AKY(6)                                       CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280C117                                           S01408
2781 C*                                                                   080603
2727 C                   EXSR      EXCP                                                        08060
      *                                                                                       237562
      ** Return the previous value of settlement branch.                                      237562
      *                                                                                       237562
     C     *IN60         IFEQ      '0'                                                        237562
     C     IPDS          IFEQ      'Y'                                                        237562
     C                   MOVE      @STBR         KYSTBR                                       237562
     C                   END                                                                  237562
     C                   END                                                                  237562
      *                                                                                       237562
2781 C                   MOVE      ' '           AKY(9)                                        08060
     C     CDL013        IFEQ      '1'                                                      AR809735
     C                   MOVE      ' '           AKY(6)                                     AR809735
     C                   ENDIF                                                              AR809735
     C*                                                                   S01408
      ***If*feature*CDL018*is*installed*generate*additional*account*key              CDL018 AR992570
      ***if*interest*is*not*paid*separately****************************              CDL018 AR992570
      *****************************************************************              CDL018 AR992570
     C*****CDL018        IFEQ      'Y'                                                      AR992570
     C*****IPDS*         ANDNE     'Y'                                                      AR992570
     C*****FIXDEP        IFEQ      'Y'                                                      AR992570
     C**********         MOVE      'B'           AKY(10)                                    AR992570
     C**********         EXSR      EXCP                                                     AR992570
     C**********         ENDIF                                                              AR992570
     C**********         ENDIF                                                              AR992570
      *                                                                                    AR992570A
      ** Generate xxIxx___B account key for loan deals only.                               AR992570A
      ** Generate xxIxx___B for loan deals without interest                                AR992570B
      ** capitalisation only.                                                              AR992570B
      *                                                                                    AR992570A
     C     CDL018        IFEQ      'Y'                                                     AR992570A
     C     FIXDEP        ANDEQ     'Y'                                                     AR992570A
     C     AKY(3)        ANDEQ     'I'                                                     AR992570A
     C     *IN21         ANDEQ     '0'                                                     AR992570A
     C     WINTC         ANDEQ     'N'                                                     AR992570B
     C                   MOVE      'B'           AKY(10)                                   AR992570A
     C                   EXSR      EXCP                                                    AR992570A
     C                   ENDIF                                                             AR992570A
      *                                                                                       CDL018
     C*****CDL013        IFEQ      '1'                                               CDL013 AR809735
     C**********         MOVE      ' '           AKY(6)                              CDL013 AR809735
     C**********         ENDIF                                                       CDL013 AR809735
     C/COPY WNCPYSRC,DL0280C118                                           S01408
      *                                                                   CDL006
      ** If Feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Fiduciary Deposits.                                           CDL006
      *                                                                   CDL006
     C     WUFIDE        IFEQ      'D'                                                         CDL00
     C     WUFIDE        OREQ      'L'                                                         CDL00
      *                                                                   CDL006
      ** Save Interest amount previously calculated.                      CDL006
      *                                                                   CDL006
     C                   Z-ADD     WORKD         WUINTA           13 0                         CDL00
      *                                                                   CDL006
      ** If Commission is accrued (Not for Call deposits).                CDL006
      *                                                                   CDL006
     C     BNACCO        IFEQ      'Y'                                                         CDL00
     C     DTYP          ANDNE     'DT'                                                        CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
     C     BNACCO        OREQ      'Y'                                                         CDL00
     C     DTYP          ANDNE     'LT'                                                        CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** Build Accrued commission Account Key.                            CDL006
      *                                                                   CDL006
     C                   MOVE      'A'           AKY(3)                                        CDL00
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
     C                   MOVE      'C'           AKY(10)                                       CDL00
      *                                                                   CDL006
      **  Calculate commission amount not yet posted.                     CDL006
      *                                                                   CDL006
      **      FCMA                                                        CDL006
      **  (-----------)  x  (NIDT - IACD) + FACTC - FACPD                 CDL006
      **   MDAT - VDAT                                                    CDL006
      *                                                                   CDL006
     C                   Z-ADD     IACD          WUDBEG                                        CDL00
     C                   Z-ADD     NIDT          WUDEND                                        CDL00
     C                   EXSR      COMCAL                                                      CDL00
     C     WUACSC        ADD       FACTC         WORKTD                                        CDL00
     C     WORKTD        SUB       FACPD         WORKD                                         CDL00
     C                   Z-ADD     WORKD         KYAMT                                         CDL00
      *                                                                   CDL006
      ** Generate Accrued commission Account Key.                         CDL006
      *                                                                   CDL006
     C                   EXSR      EXCP                                                        CDL00
      *                                                                   CDL006
      ** Update field FACPD ("Accrued Commission posted to date").        CDL006
      *                                                                   CDL006
     C                   ADD       KYAMT         FACPD                                         CDL00
     C                   MOVE      'Y'           WUDXUP                                        CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** Initialize Commission and Tax on commission used to              CDL006
      ** calculate Net amount to be settled.                              CDL006
      *                                                                   CDL006
     C                   Z-ADD     0             W0FCMA                                        CDL00
      *                                                                   CDL006
      ** If commission due on the deal.                                   CDL006
      *                                                                   CDL006
     C     BNCOTK        IFEQ      'Y'                                                         CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** Build Commission Account Key.                                    CDL006
      *                                                                   CDL006
     C                   MOVE      'I'           AKY(3)                                        CDL00
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
     C                   MOVEA     'OC'          AKY(9)                                        CDL00
      *                                                                   CDL006
      **  Calculate commission amount due.                                CDL006
      *                                                                   CDL006
      **  If Call Deposit :                                               CDL006
      *                                                                   CDL006
      **       PAMT                                                       CDL006
      **  (------------) X (NIDT - IACD) x (% current range) + FACTC      CDL006
      **   Days of year                                      - FCPRD      CDL006
      *                                                                   CDL006
      *                                                                   CDL006
      **  If Fixed Term deposit :                                         CDL006
      *                                                                   CDL006
      **      FCMA                                                        CDL006
      **  (-----------)  x  (NIDT - IACD) + FACTC - FCPRD                 CDL006
      **   MDAT - VDAT                                                    CDL006
      *                                                                   CDL006
     C                   Z-ADD     0             KYAMT                                         CDL00
     C                   Z-ADD     IACD          WUDBEG                                        CDL00
     C                   Z-ADD     NIDT          WUDEND                                        CDL00
     C                   EXSR      COMCAL                                                      CDL00
     C     WUACSC        ADD       FACTC         WORKTD                                        CDL00
     C     WORKTD        SUB       FCPRD         WORKD                                         CDL00
     C                   Z-ADD     WORKD         KYAMT                                         CDL00
     C                   Z-ADD     WORKD         W0FCMA                                        CDL00
      *                                                                   CDL006
      ** Generate Commission Account Key.                                 CDL006
      *                                                                   CDL006
     C                   EXSR      EXCP                                                        CDL00
     C                   MOVE      ' '           AKY(9)                                        CDL00
      *                                                                   CDL006
      ** Update field FCPRD ("Commission paid/received to date").         CDL006
      *                                                                   CDL006
     C                   ADD       KYAMT         FCPRD                                         CDL00
     C                   MOVE      'Y'           WUDXUP                                        CDL00
      *                                                                   CDL006
      ** If Commission due to agent.                                      CDL006
      *                                                                   CDL006
     C     BBAGNT        IFNE      *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** Build account key for "Commission due to agent".                 CDL006
     C                   MOVE      'I'           AKY(3)                                        CDL00
     C                   MOVEA     DLST          AKY(4)                                        CDL00
     C                   MOVEA     '    '        AKY(6)                                        CDL00
     C                   MOVEA     'AC'          AKY(9)                                        CDL00
      *                                                                   CDL006
     C     W0FCMA        MULT      BBAGNP        W018D3                                        CDL00
     C     W018D3        DIV       100           KYAMT                                         CDL00
      *                                                                   CDL006
      ** Generate Commission due to agent Account key.                    CDL006
     C                   EXSR      EXCP                                                        CDL00
     C                   MOVE      ' '           AKY(9)                                        CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** Restore Interest amount previously calculated.                   CDL006
      *                                                                   CDL006
     C                   Z-ADD     WUINTA        WORKD                                         CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C180                                           S01408
2781 C*                                                                   080603
2781 C* IF DEPOSIT TAKEN (IT,CD,TD) AND DEAL IS TAXABLE                   080603
2781 C*                                                                   080603
2781 C     *IN23         IFEQ      *ON                                          B 001          08060
2781 C*                                                                   080603
2781 C** IF BRT SAR IS INSTALLED                                          080603
2781 C*                                                                   080603
2781 C     S01383        IFEQ      'Y'                                          B 002          08060
     C*                                                                   117028
     C     PCCY          IFEQ      BLCYCD                                                      11702
     C                   MOVE      'B'           AKY(9)                                        11702
     C                   END                                                                   11702
     C*                                                                   117028
     C                   MOVE      'I'           AKY(3)                                        11702
     C                   MOVE      'T'           AKY(10)                                       11702
     C                   Z-ADD     TAXA          KYAMT                                         11702
     C                   EXSR      EXCP                                                        11702
     C                   MOVE      ' '           AKY(9)                                        11702
     C*                                                                   117028
     C     PCCY          IFNE      BLCYCD                                                      11702
     C                   Z-ADD     TAXA          CYBRAM                                        11702
     C                   EXSR      GENBRT                                                      11702
     C   U8              GOTO      ENDNID                                                      11702
     C                   END                                                                   11702
2739 C*                                                                   080603
2740 C*    Generate Base Ccy Equivalent Entries                           080603
1162 C*                                                                   080603
2781 C     BJCYCD        IFNE      BLCYCD                                                      08060
1160 C                   Z-ADD     TAXA          CYBRAM           13 0                         08060
2781 C                   EXSR      CNVBRT                                                      08060
2781 C   U8              GOTO      ENDNID                                                      08060
2781 C                   END                                                                   08060
2781 C*                                                                   080603
2781 C                   ELSE                                                                  11702
2781 C*                                                                   080603
2740 C**   Generate Tax Amount in Currency                                080603
2781 C*                                                                   080603
2741 C                   MOVE      'I'           AKY(3)                                        08060
2742 C                   MOVE      'T'           AKY(10)                                       08060
2743 C                   Z-ADD     TAXA          KYAMT                                         08060
     C*                                                                   S01408
     C     CDL013        IFEQ      '1'                                                        CDL013
     C     BBCSTY        IFEQ      'C'                                                        CDL013
     C                   MOVE      'C'           AKY(6)                                       CDL013
     C                   ELSE                                                                 CDL013
     C                   MOVE      ' '           AKY(6)                                       CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280CP13                                           S01408
     C*                                                                   S01408
      * If Dual Withholding Tax feature installed set Main                                    CGL165
      * WHT amount to key amount for Main Tax key                                             CGL165
     C     CGL165        IFEQ      'Y'                                                        CGL165
     C                   Z-ADD     PWTXA         KYAMT                                        CGL165
     C                   ENDIF                                                                CGL165
2744 C                   EXSR      EXCP                                                        08060
      * If Dual Withholding Tax feature installed also output                                 CGL165
      * Secondary Tax Account key                                                             CGL165
     C     CGL165        IFEQ      'Y'                                                        CGL165
     C     PSTXA         ANDNE     0                                                          CGL165
     C                   MOVE      '2'           AKY(9)                                       CGL165
     C                   Z-ADD     PSTXA         KYAMT                                        CGL165
     C                   EXSR      EXCP                                                       CGL165
     C                   MOVE      ' '           AKY(9)                                       CGL165
     C                   ENDIF                                                                CGL165
2781 C                   END                                                                   11702
                                                                                              CRE105
      ** Extract interest and tax if CRE105 is swithced on                                    CRE105
                                                                                              CRE105
     C                   IF        CRE105 = 'Y'                                               CRE105
     C                             AND *INU1 = *ON                                            CRE105
     C                   EXSR      SRRTVSEC                                                   CRE105
     C                   EVAL      DLBRCA = WBRCH                                             CRE105
     C                   EVAL      DLCNUM = WCUST                                             CRE105
     C                   EVAL      DLCCY  = KYCCY                                             CRE105
     C                   EVAL      DLDLNO = DLNO                                              CRE105
     C                   EVAL      DLSETL = KYSETL                                            CRE105
     C                   EVAL      DLOSTL = KYOSTL                                            CRE105
     C                   EVAL      DLINTA = WORKD                                             CRE105
     C                   EVAL      DLTAXA = TAXA                                              CRE105
     C                   EVAL      DLPSTD = BJRDNB                                            CRE105
     C                   EVAL      DLVALD = KYDAT                                             CRE105
     C                   WRITE     DLIWHTD0                                                   CRE105
     C                   ENDIF                                                                CRE105
     C*                                                                   S01408
     C     CDL013        IFEQ      '1'                                                        CDL013
     C                   MOVE      ' '           AKY(6)                                       CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280C119                                           S01408
     C*                                                                   S01408
2753 C   U1              Z-ADD     IACD          SLIDD                                         08060
2754 C   U1              EXSR      EXCPTN                                                      08060
     C/COPY WNCPYSRC,DL0280C063
2781 C                   END                                                    E 001          08060
      *                                                                                       233277
      ** Calculate EU Tax Amount                                                              233277
      *                                                                                       233277
     C     CGL031        IFEQ      'Y'                                                        233277
     C     CGL032        OREQ      'Y'                                                        233277
      *                                                                                    MD024874A
     C     DTYP          IFEQ      'CD'                                                    MD024874A
     C     DTYP          OREQ      'TD'                                                    MD024874A
     C     DTYP          OREQ      'DT'                                                    MD024874A
     C     CDL006        ANDEQ     'Y'                                                     MD024874A
     C     DTYP          OREQ      'FT'                                                    MD024874A
     C     CDL006        ANDEQ     'Y'                                                     MD024874A
      *                                                                                    MD024874A
     C     WORKD         IFGT      *ZERO                                                      233277
     C                   MOVE      'INT'         WTYP              3                          233277
     C                   EXSR      SREUTX                                                     233277
      *                                                                                       233324
      ** Run Money Market & Loans processing if necessary.                                    233324
      *                                                                                       233324
     C     *IN03         IFEQ      *ON                                                        233324
     C     WNTAMT        ANDNE     *ZERO                                                      233324
     C                   Z-ADD     @@ENDD        WEVDAT                                    MD024874A
     C                   EXSR      SRETDC                                                     233324
     C                   ENDIF                                                                233324
     C                   ENDIF                                                                233277
     C                   ENDIF                                                             MD024874A
     C                   ENDIF                                                                233277
      *****************************************************************                CGL031 233565
      ***Generate*EU*Withholding*Tax*Account*Keys*at*interest**********                CGL031 233565
      ***payment*date.*************************************************                CGL031 233565
      *                                                                                CGL031 233565
     C*****CGL031        IFEQ      'Y'                                                 CGL031 233565
     C******IN21         ANDEQ     *ON                                                 CGL031 233565
     C**********         EXSR      SEUICT                                              CGL031 233565
     C*****WEUTXI        IFEQ      'Y'                                                 CGL031 233316
     C**********         EXSR      SEUIGK                                              CGL031 233565
     C**********         ENDIF                                                         CGL031 233316
     C**********         ENDIF                                                         CGL031 233565
     C                   Z-ADD     *ZERO         WZAMT            13 0                        233565
     C**********         MOVE      'N'           WINTC             1                235126 MD024874A
2781 C*                                                                   080603
2781 C* If Deposit Taken (IT,CD,TD) and System is Taxable                 080603
2781 C*                                                                   080603
2781 C     *IN25         IFEQ      *ON                                          B 001          08060
      *                                                                   CDL006
      ** Or feature CDL006 installed.                                     CDL006
      *                                                                   CDL006
     C     CDL006        OREQ      'Y'                                                         CDL00
     C/COPY WNCPYSRC,DL0280C181                                           S01408
     C                   MOVE      'N'           WINTC             1                       MD024874A
     C     *IN60         IFEQ      *ON                                          B 001         237562
      *                                                                                       237562
      ** If interest is to be posted separately, use the Interest                             237562
      ** settlement instructions (if present) instead of Maturity                             237562
      ** settlement instructions.                                                             237562
      *                                                                                       237562
     C     IPDS          IFEQ      'Y'                                                        237562
     C     IMET          ANDNE     *BLANKS                                                    237562
     C     IMET          ANDNE     *ZEROS                                                     237562
     C                   MOVE      IMET          KYSETL                                       237562
     C                   MOVEL     INSA          KYOSTL                                       237562
     C                   ENDIF                                                                237562
     C                   MOVE      POBR          KYSTBR                                       237562
     C     IPDS          IFEQ      'Y'                                                        237562
     C                   MOVE      KYSTBR        @STBR             3                          237562
     C                   EXSR      INTACC                                                     237562
     C                   ENDIF                                                                237562
     C                   ENDIF                                                                237562
2745 C*                                                                   080603
2746 C**   Generate Net Interest Key                                      080603
2781 C*                                                                   080603
2781 C     RECR          IFNE      'M'                                                         08060
     C     AMTP          ANDEQ     'CI'                                                        10198
     C     RECR          ORNE      'M'                                                         13160
     C     INTC          ANDEQ     'Y'                                                         13160
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C220                                           S01408
     C*                                                                   S01408
     C                   MOVE      'Y'           WINTC                                        235126
2781 C                   MOVE      'C'           AKY(10)                                       08060
     C                   MOVE      'CINT'        WCFTP             4                          CAS009
2781 C                   ELSE                                                                  08060
     C                   Z-ADD     WORKD         WZAMT                                        235265
2781 C                   MOVE      'N'           AKY(10)                                       08060
     C                   MOVE      'INTP'        WCFTP                                        CAS009
      *                                                                                     AR992570
      ** If feature CDL018=Y, use xxIxx___B. This replaces xxIxx___N                        AR992570
      ** account key.                                                                       AR992570
      *                                                                                     AR992570
     C     CDL018        IFEQ      'Y'                                                      AR992570
     C     FIXDEP        ANDEQ     'Y'                                                      AR992570
     C                   MOVE      'B'           AKY(10)                                    AR992570
     C                   ENDIF                                                              AR992570
2781 C                   END                                                                   08060
2781 C*                                                                   080603
     C*****CDL013        IFEQ      '1'                                               CDL013 AR809735
     C*****BBCSTY        IFEQ      'C'                                               CDL013 AR809735
     C**********         MOVE      'C'           AKY(6)                              CDL013 AR809735
     C**********         ELSE                                                        CDL013 AR809735
     C**********         MOVE      ' '           AKY(6)                              CDL013 AR809735
     C**********         ENDIF                                                       CDL013 AR809735
     C**********         ENDIF                                                       CDL013 AR809735
     C/COPY WNCPYSRC,DL0280C120                                           S01408
     C*                                                                   S01408
     C                   Z-ADD     WORKD         KYAMT                                         CDL00
      *                                                                                       CAS009
     C                   EXSR      SRMMCF                                                     CAS009
      *                                                                   CDL006
      ** If Deposit Taken (FT,DT,LT) and System is Taxable.               CDL006
      *                                                                   CDL006
     C     *IN25         IFEQ      '1'                                                         CDL00
     C                   SUB       TAXA          KYAMT                                         CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** If feature CDL006 installed.                                     CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Fiduciary Deposit.                                            CDL006
      *                                                                   CDL006
     C     WUFIDE        IFEQ      'D'                                                         CDL00
     C     WUFIDE        OREQ      'L'                                                         CDL00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C     AKY(10)       ANDEQ     'N'
     C                   MOVE      'N'           F1FFLG
     C                   Z-ADD     W0FCMA        F1FVAL
     C                   Z-ADD     0             WKAMT
     C     KYAMT         IFNE      0
     C     W0FCMA        DIV(H)    KYAMT         WKAMT
     C     WKAMT         MULT      100           F1FPCT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CGL020
     C                   SUB       W0FCMA        KYAMT                                         CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C198                                           S01408
     C                   Z-ADD     KYAMT         WZAMT                                        233565
2751 C                   EXSR      EXCP                                                        08060
      *                                                                                       237562
      ** Return the previous value of settlement branch.                                      237562
      *                                                                                       237562
     C     *IN60         IFEQ      '0'                                                        237562
     C     IPDS          IFEQ      'Y'                                                        237562
     C                   MOVE      @STBR         KYSTBR                                       237562
     C                   END                                                                  237562
     C                   END                                                                  237562
      *                                                                                       237562
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
     C*                                                                   S01408
     C     CDL013        IFEQ      '1'                                                        CDL013
     C                   MOVE      ' '           AKY(6)                                       CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DL0280C121                                           S01408
     C*                                                                   S01408
2781 C                   ENDIF                                                  E 001          08060
     C/COPY WNCPYSRC,DL0280C182                                           S01408
      *                                                                                       233565
      ** Generate EU Withholding Tax Account Keys at interest                                 233565
      ** payment date.                                                                        233565
      *                                                                                       233565
     C     CGL031        IFEQ      'Y'                                                        233565
      *                                                                                     MD025036
     C     WZAMT         IFEQ      0                                                        MD025036
     C                   Z-ADD     WORKD         WZAMT                                      MD025036
     C                   ENDIF                                                              MD025036
      *                                                                                       233565
     C     DTYP          IFEQ      'CD'                                                       233565
     C     DTYP          OREQ      'TD'                                                       233565
     C                   EXSR      SEUICT                                                     233565
     C                   EXSR      SEUIGK                                                     233565
     C                   ENDIF                                                                233565
      *                                                                                       233565
     C     CDL006        IFEQ      'Y'                                                        233565
     C     DTYP          IFEQ      'DT'                                                       233565
     C     DTYP          OREQ      'FT'                                                       233565
     C                   EXSR      SEUICT                                                     233565
     C                   EXSR      SEUIGK                                                     233565
     C                   ENDIF                                                                233565
     C                   ENDIF                                                                233565
      *                                                                                       233565
     C                   ENDIF                                                                233565
2728 C*                                                                   080603
2729 C**        GENERATE ACCOUNT KEY FOR ACCRUED INTEREST TO POST.        080603
2781 C**        (NOT FOR FREQ=N MATURED DEAL)                             080603
2730 C*                                                                   080603
2781 C     IPFR          IFNE      'N'                                                         08060
2781 C     IPFR          OREQ      'N'                                                         08060
2781 C     RECR          ANDNE     'M'                                                         08060
2731 C                   MOVE      'A'           AKY(3)                                        08060
2732 C                   MOVE      'A'           AKY(10)                                       08060
     C                   MOVE      PCCY          KYCCY                                        234278
2733 C                   Z-ADD     WORKTP        KYAMT                                         08060
     C/COPY WNCPYSRC,DL0280C635
2734 C                   EXSR      EXCP                                                        08060
2781 C                   END                                                                   08060
     C/COPY WNCPYSRC,DL0280C495
2735 C*                                                                   080603
2755 C*                                                                   080603
2756 C     NIDAT1        TAG                                                    ** NIDAT1 TAG *08060
2781 C*                                                                   080603
2781 C* IF BRT SAR IS INSTALLED, AND DL0280 IS BEING RUN DURING           080603
2781 C* THE CLOSE OF BUSINESS (IE NOT INPUT CYCLE INITIATION)             080603
2781 C*                                                                   080603
2781 C     S01383        IFEQ      'Y'                                          B 001          08060
2781 C     *INU1         ANDEQ     '1'                                                         08060
     C     TAXI          ANDNE     'X'
2781 C*                                                                   080603
2781 C** WRITE A RECORD TO INTEREST HISTORY FILE IF DEAL IS A DEP.TAKEN   080603
2781 C*                                                                   080603
2781 C     *IN25         IFEQ      '1'                                          B 002          08060
2781 C*                                                                   080603
2781 C**  If the New A/C Signal on DEALSDC is blank, change this to 'Y'.  080603
2781 C*                                                                   080603
2781 C     DNACSG        IFEQ      ' '                                          B 003          08060
2781 C                   MOVE      'Y'           DNACSG                                        08060
2781 C                   END                                                    E 003          08060
2781 C*                                                                   080603
2781 C                   MOVE      DNACSG        NACSG                                         08060
2781 C                   Z-ADD     ACSQ          ACSQSV                                        08060
2781 C                   EXSR      WRIINT                                                      08060
2781 C                   Z-ADD     ACSQSV        ACSQ                                          08060
2781 C   U8              GOTO      ENDNID                                                      08060
2781 C                   END                                                    E 002          08060
2781 C                   END                                                    E 001          08060
2781 C*                                                                   080603
2758 C**     UPDATE DEALS RECORD                                          080603
2759 C*                                                                   080603
2762 C     AIAN          ADD       AIAP          AIAP                                          08060
     C/COPY WNCPYSRC,DL0280C496
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     FSAINN        ADD       FSAIAN        FSAIAN
     C                   ENDIF
2781 C*                                                                   080603
2781 C     RECR          IFNE      'M'                                                         08060
     C     AMTP          ANDEQ     'CI'                                                        10198
     C     RECR          ORNE      'M'                                                         13160
     C     INTC          ANDEQ     'Y'                                                         13160
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C221                                           S01408
     C*                                                                   S01408
2763 C     WORKD         ADD       ICTD          ICTD                                          08060
     C     CAS005        IFEQ      'Y'
     C     WKNTR         ADD       FSICTN        FSICTN
     C                   ENDIF
2781 C                   ELSE                                                                  08060
2781 C     WORKD         ADD       IPRD          IPRD                                          08060
     C     CAS005        IFEQ      'Y'
     C     WKNTR         ADD       FSIPRN        FSIPRN
     C                   ENDIF
2781 C                   END                                                                   08060
2781 C*                                                                   080603
2765 C     WORKD         ADD       IPRM          IPRM                                          08060
     C/COPY WNCPYSRC,DL0280C532
2766 C     TAXD          ADD       TAXA          TAXD                                          08060
2767 C     TAXM          ADD       TAXA          TAXM                                          08060
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     WKNTR         ADD       FSIPMN        FSIPMN
     C     FSAIPN        ADD       WKNTRP        FSAIPN
     C                   ENDIF
2769 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C064
2770 C     AIPD          ADD       WORKTP        AIPD                                          08060
     C/COPY WNCPYSRC,DL0280C183                                           S01408
2781 C                   Z-ADD     NIPAR         SLID                                          08060
2781 C*                                                                   080603
2781 C** Capitalise Net Interest to Principal                             080603
2781 C*                                                                   080603
2781 C     RECR          IFNE      'M'                                                         08060
     C     AMTP          ANDEQ     'CI'                                                        10198
     C     RECR          ORNE      'M'                                                         13160
     C     INTC          ANDEQ     'Y'                                                         13160
     C     CDL093        OREQ      'Y'                                                        CDL093
     C     ICBS          ANDEQ     9                                                          CDL093
     C     RECR          ANDNE     'M'                                                        CDL093
2781 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C165                                           S01408
     C     AMTP          IFEQ      'CI'                                                       CDL093
     C     INTC          OREQ      'Y'                                                        CDL093
2772 C     PAMT          ADD       WORKD         PAMT                                          08060
     C/COPY WNCPYSRC,DLH00072
2773 C                   SUB       TAXA          PAMT                                          08060
     C                   ENDIF                                                                CDL093
     C/COPY WNCPYSRC,DL0280C166                                           S01408
      *                                                                                       CDL033
      ** For CF deals, prevent update of accrued interest                                     CDL033
      ** to control date and interest accrual control                                         CDL033
      ** date at this point.  It will be done below.                                          CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      *BLANK                                                     CDL033
     C     DTYP          ORNE      'CF'                                                       CDL033
      *                                                                                       CDL033
2776 C     AITC          ADD       WKINT         AITC                                          08060
2777 C                   Z-ADD     SLID          IACD                                          08060
      *                                                                                       CAS005
     C     AMTP          IFEQ      'CI'                                                       CDL093
     C     INTC          OREQ      'Y'                                                        CDL093
     C     CAS005        IFEQ      'Y'
     C     FSPAMT        ADD       WKNTR         FSPAMT
     C                   SUB       TAXA          FSPAMT
     C     FSAITN        ADD       WINTST        FSAITN
     C                   ENDIF
     C                   ENDIF                                                                CDL093
2781 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C029
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
2781 C                   END                                                                   08060
     C/COPY WNCPYSRC,DL0280C709
      *                                                                                       CDL033
      ** For CF deals, always update accrued interest to                                      CDL033
      ** control date and interest accrual control                                            CDL033
      ** date on every interest payment date.                                                 CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
      *                                                                                       CDL033
     C     AITC          ADD       WKINT         AITC                                         CDL033
     C                   Z-ADD     SLID          IACD                                         CDL033
      *                                                                                       CDL033
      ** Reset accrued interest since last interest payment                                   CDL033
      ** date / last rate change date to zero.                                                CDL033
      *                                                                                       CDL033
     C                   Z-ADD     *ZERO         XKAILC                                       CDL033
      *                                                                                       CDL033
      ** Set off interest advice indicator for the next                                       CDL033
      ** interest period.                                                                     CDL033
      *                                                                                       CDL033
     C                   BITOFF    '0'           XKFRCI                                       CDL033
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C     CDL006        IFEQ      'Y'                                                         CDL00
      *                                                                   CDL006
      ** If Fiduciary Call or Time deposits.                              CDL006
      *                                                                   CDL006
     C     WUFIDE        IFEQ      'D'                                                         CDL00
     C     WUFIDE        OREQ      'L'                                                         CDL00
      *                                                                   CDL006
      ** If Commissions to be calculated.                                 CDL006
      *                                                                   CDL006
     C     BNCOTK        IFEQ      'Y'                                                         CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
     C     BNACCO        OREQ      'Y'                                                         CDL00
     C     FCMC          ANDNE     *BLANKS                                                     CDL00
      *                                                                   CDL006
      ** As the commission calculation is based on the Interest           CDL006
      ** accrual control date (IACD), the Commission amount must          CDL006
      ** be calculated each time the Interest Accrual Control date is     CDL006
      ** updated; the result must be added to the field Accrued           CDL006
      ** commission to control date FACTC.                                CDL006
      *                                                                   CDL006
     C     IACD          IFNE      WUIACD                                                      CDL00
     C                   Z-ADD     WUIACD        WUDBEG                                        CDL00
     C                   Z-ADD     IACD          WUDEND                                        CDL00
     C                   EXSR      COMCAL                                                      CDL00
     C                   ADD       WUACSC        FACTC                                         CDL00
     C                   MOVE      'Y'           WUDXUP                                        CDL00
     C                   Z-ADD     IACD          WUIACD                                        CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
     C/COPY WNCPYSRC,DL0280C150                                           S01408
2781 C                   Z-ADD     0             TAXA                                          08060
2781 C                   Z-ADD     0             AIAN                                          08060
      *                                                                   CAC001
      ** Do the following calculations for COF processing.                CAC001
      *                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** For matured freq.='N', do not compute accrual interest as        CAC001
      ** it would have already been calculated at maturity date.          CAC001
      *                                                                   CAC001
     C     IPFR          IFEQ      'N'                                                         CAC00
     C     RECR          ANDEQ     'M'                                                         CAC00
     C                   Z-ADD     ACDA          WORKTD                                        CAC00
     C                   ELSE                                                                  CAC00
      *                                                                   CAC001
      ** Get effective Funding Rate                                       CAC001
      *                                                                   CAC001
     C                   SELECT                                                                CAC00
     C     FSGN          WHENEQ    '+'                                                         CAC00
     C     INTR          ADD       FSRP          WEFFR                                         CAC00
     C     FSGN          WHENEQ    '-'                                                         CAC00
     C     INTR          SUB       FSRP          WEFFR                                         CAC00
     C     FSGN          WHENEQ    ' '                                                         CAC00
     C                   Z-ADD     FSRP          WEFFR                                         CAC00
     C                   ENDSL                                                                 CAC00
      *                                                                   CAC001
     C                   Z-ADD     FCTD          ZIBEG                                         CAC00
     C                   Z-ADD     NIPAR         ZIEND                                         CAC00
     C                   Z-ADD     PAMT          ZIAMT                                         CAC00
     C                   Z-ADD     ICBS          ZICALC                                        CAC00
     C                   Z-ADD     WEFFR         ZIRATE                                        CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
     C     WKINT         ADD       ACDA          WORKTD                                        CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
      ** Check to back valuations and prevent accrual reversals           CAC001
      *                                                                   CAC001
     C     *IN03         IFEQ      *ON                                                         CAC00
     C     WEFFR         IFGE      0                                                           CAC00
     C     WORKTD        ADD       ACAP          WRKXX            13 0                         CAC00
     C     WRKXX         SUB       ACPD          WRKYY            13 0  53                     CAC00
     C   53WRKXX         COMP      0                                  53  53                   CAC00
     C                   ELSE                                                                  CAC00
      *                                                                   CAC001
      **  Negative Interest                                               CAC001
      *                                                                   CAC001
     C     WORKTD        ADD       ACAP          WRKXX                                         CAC00
     C     WRKXX         SUB       ACPD          WRKYY                53                       CAC00
     C   53WRKXX         COMP      0                                    5353                   CAC00
     C                   ENDIF                                                                 CAC00
     C                   ENDIF                                                                 CAC00
      *                                                                   CAC001
     C                   ADD       ACAN          WORKTD                                        CAC00
     C                   ADD       ACAP          WORKTD                                        CAC00
     C     WORKTD        SUB       ACPD          WRKTP                                         CAC00
     C     *IN53         IFEQ      '1'                                                         CAC00
     C     *IN03         ANDEQ     '1'                                                         CAC00
     C                   Z-ADD     ACAN          WRKTP                                         CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVE      '0'           *IN53                                         CAC00
     C     WORKTD        SUB       COFD          WRKD                                          CAC00
     C                   SUB       CFCD          WRKD                                          CAC00
      *                                                                   CAC001
      ** Set-up the following Interest Due and Accrued Interest           CAC001
      ** to Post account keys.                                            CAC001
      *                                                                   CAC001
      ** Cost of Fund not yet posted - Transaction Profit Centre          CAC001
      *                                                                   CAC001
     C                   MOVE      'A'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   Z-ADD     WRKTP         KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Fund not yet posted - Funding Profit Centre              CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Interest cannot be capitalised to Principal if MDAT has passed.  CAC001
      *                                                                   CAC001
     C     RECR          IFNE      'M'                                                         CAC00
     C     AMTP          ANDEQ     'CI'                                                        10198
     C     RECR          ORNE      'M'                                                         13160
     C     INTC          ANDEQ     'Y'                                                         13160
     C     *IN25         ANDEQ     *OFF                                                        CAC00
     C                   MOVE      'C'           AKY(10)                                       CAC00
     C                   ELSE                                                                  CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
      ** Interim COF Due or to be capitalised - Transaction Profit Centre CAC001
      *                                                                   CAC001
     C                   MOVE      'I'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   Z-ADD     WRKD          KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Interim COF Due or to be capitalised - Funding Profit Centre     CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
      ** Update deals file                                                CAC001
      *                                                                   CAC001
     C                   ADD       ACAN          ACAP                                          CAC00
     C*                                                                   CAC001
     C     RECR          IFNE      'M'                                                         CAC00
     C     AMTP          ANDEQ     'CI'                                                        10198
     C     RECR          ORNE      'M'                                                         13160
     C     INTC          ANDEQ     'Y'                                                         13160
     C                   ADD       WRKD          CFCD                                          CAC00
     C                   ELSE                                                                  CAC00
     C                   ADD       WRKD          COFD                                          CAC00
     C                   END                                                                   CAC00
     C*                                                                   CAC001
     C                   ADD       WRKD          COFM                                          CAC00
     C                   ADD       WRKTP         ACPD                                          CAC00
     C*                                                                   CAC001
     C** Capitalise Net Interest to Principal                             CAC001
     C*                                                                   CAC001
     C     RECR          IFNE      'M'                                                         CAC00
     C     AMTP          ANDEQ     'CI'                                                        10198
     C     RECR          ORNE      'M'                                                         13160
     C     INTC          ANDEQ     'Y'                                                         13160
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
     C/COPY WNCPYSRC,DL0280C710
      *                                                                                       CDL033
      ** For CF deals, prevent update of accrued COF to                                       CDL033
      ** control date and funding accrual control                                             CDL033
      ** date at this point.  It will be done below.                                          CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      *BLANK                                                     CDL033
     C     DTYP          ORNE      'CF'                                                       CDL033
      *                                                                                       CDL033
     C                   ADD       WKINT         ACDA                                          CAC00
     C                   Z-ADD     SLID          FCTD                                          CAC00
     C/COPY WNCPYSRC,DL0280C711
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C                   END                                                                   CAC00
     C/COPY WNCPYSRC,DL0280C712
      *                                                                                       CDL033
      ** For CF deals, always update accrued COF to                                           CDL033
      ** control date and funding accrual control                                             CDL033
      ** date on every interest payment date.                                                 CDL033
      *                                                                                       CDL033
     C     CDL033        IFEQ      'Y'                                                        CDL033
     C     DTYP          ANDEQ     'CF'                                                       CDL033
     C     CDL033        OREQ      'Y'                                                        CDL033
     C     FLRDEL        ANDEQ     'Y'                                                        CDL033
      *                                                                                       CDL033
     C     ACDA          ADD       WKINT         ACDA                                         CDL033
     C                   Z-ADD     SLID          FCTD                                         CDL033
      *                                                                                       CDL033
      ** Reset accrued COF since last interest payment                                        CDL033
      ** date / last rate change date to zero.                                                CDL033
      *                                                                                       CDL033
     C                   Z-ADD     *ZERO         XKACDA                                       CDL033
      *                                                                                       CDL033
     C                   ENDIF                                                                CDL033
      *                                                                                       CDL033
     C*                                                                   CAC001
     C                   Z-ADD     0             ACAN                                          CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  -BGN0ST='Y'    CAC00
2781 C                   BITOFF    '2'           CNFI                                          08060
2781 C                   BITOFF    '2'           TLXI                                          08060
2781 C**  SET DEALS FILE UPDATE INDICATOR                                 080603
2781 C                   MOVE      '1'           *IN15                                         08060
2781 C*                                                                   080603
2781 C*****     HASH TOTALLING FOR CAPITALISATIONS                        080603
2781 C*                                                                   080603
2781 C* ADD CORRECT AMOUNT TO INTEREST CAP. HASH TOTALS                   080603
2781 C     RECR          IFNE      'M'                                                         08060
     C     AMTP          ANDEQ     'CI'                                                        10198
     C     RECR          ORNE      'M'                                                         13160
     C     INTC          ANDEQ     'Y'                                                         13160
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C222                                           S01408
     C*                                                                   S01408
2781 C     PAMT          SUB       PAMT1         R1               13 0                         08060
2781 C     R1            DIV       1000          ZZAMT                                         08060
2781 C                   Z-ADD     NETCII        ZZTOTI                                        08060
2781 C                   Z-ADD     NETCID        ZZTOTD                                        08060
2781 C                   EXSR      GLZADD                                                      08060
2781 C                   Z-ADD     ZZTOTI        NETCII           15 0                         08060
2781 C                   Z-ADD     ZZTOTD        NETCID            3 0                         08060
2781 C                   END                                                                   08060
2781 C*                                                                   080603
     C**   Restore Maturity Instructions                                  080603
     C*                                                                   080603
     C                   Z-ADD     MDST          KYSETL                                        08060
     C                   MOVE      OMDA          KYOSTL                                        08060
      *                                                                                       239550
      ** Return the previous value of settlement branch.                                      239550
      *                                                                                       239550
     C                   MOVE      @STBR         KYSTBR                                       239550
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280C208                                           S01408
      *                                                                   S01408
0980 C*                                                                   080603
2781 C     ENDNID        TAG                                                                   08060
2781 C*                                                                   080603
2780 C                   ENDSR                                                                 08060
     C/COPY WNCPYSRC,DLH00073
2781 C*                                                                   080603
2664 C********************************************************************080603
     C*                                                                   080603
     C***SR/MADAT****Process*Maturity*Date                                           080603 AR746445
     C*                                                                   080603
     C********************************************************************080603
     C*                                                                   080603
     C*****MADAT         BEGSR                                         *** MADAT   ***08060 AR746445
     C***/COPY*WNCPYSRC,DL0280C497                                                          AR746445
     C*                                                                   080603
     C***Accrual*at*Maturity*to*Post                                                 080603 AR746445
     C*                                                                   080603
     C**********         Z-ADD     WORKTP        KYAMT                                08060 AR746445
     C**********         MOVE      'A'           AKY(3)                               08060 AR746445
     C**********         MOVE      'A'           AKY(10)                              08060 AR746445
      *                                                                   CEU015
      **Mat-Rollover-Prin-A/c-Key-set*workfield                                      CEU015 AR746445
     C**********         MOVE      *BLANKS       @MRPAK            1                  CEU01 AR746445
      *                                                                   CEU015
     C**********         EXSR      EXCP                                               08060 AR746445
     C*                                                                   080603
     C**********         ADD       WORKTP        AIPD                                 08060 AR746445
      *                                                                                       CAS005
     C*****CAS005        IFEQ      'Y'                                                      AR746445
     C**********         ADD       WKNTRP        FSAIPN                                     AR746445
     C**********         ENDIF                                                              AR746445
     C*                                                                   080603
     C***Set*Maturity*Report*details                                                 080603 AR746445
     C*                                                                   080603
     C**********         MOVE      '1'           *IN71                                08060 AR746445
     C**********         Z-ADD     PAMT          NRRPUR                               08060 AR746445
     C**********         Z-ADD     *ZERO         NRRSAL                               08060 AR746445
     C***/COPY*WNCPYSRC,DL0280C035                                                          AR746445
     C*                                                                   080603
     C****Gross*Interest*Due*at*Maturity                                             080603 AR746445
     C*                                                                   080603
     C*****IPFR*         IFNE      'N'                                          B 001 08060 AR746445
     C*****FUID*         ANDNE     'Y'                                                08060 AR746445
      *                                                                                       237602
     C*****IPDS*         IFNE      'Y'                                               237602 AR746445
      *                                                                                       237602
     C**********         Z-ADD     WORKD         KYAMT                                08060 AR746445
     C**********         MOVE      'M'           AKY(3)                               08060 AR746445
     C**********         MOVE      'I'           AKY(10)                              08060 AR746445
     C***/COPY*WNCPYSRC,DL0280C720                                                          AR746445
     C*                                                                   080603
     C***If*Taxable,*modify*key                                                      080603 AR746445
     C*                                                                   080603
     C*****S01460        IFEQ      'Y'                                          B 002 08060 AR746445
     C******IN23         ANDEQ     *ON                                                08060 AR746445
     C**********         MOVE      'T'           AKY(9)                               08060 AR746445
     C**********         ENDIF                                                  E 002 08060 AR746445
     C*                                                                   080603
     C*****CDL013        IFEQ      '1'                                               CDL013 AR746445
     C*****BBCSTY        IFEQ      'C'                                               CDL013 AR746445
     C**********         MOVE      'C'           AKY(6)                              CDL013 AR746445
     C**********         ELSE                                                        CDL013 AR746445
     C**********         MOVE      ' '           AKY(6)                              CDL013 AR746445
     C**********         ENDIF                                                       CDL013 AR746445
     C**********         ENDIF                                                       CDL013 AR746445
     C***/COPY*WNCPYSRC,DL0280C122                                                   S01408 AR746445
     C*                                                                   S01408
     C*****WORKD         SUB       TAXA          NRRSAL                               08060 AR746445
     C***/COPY*WNCPYSRC,DL0280C164                                                   S01408 AR746445
     C**********         EXSR      EXCP                                               08060 AR746445
     C**********         MOVE      ' '           AKY(9)                               08060 AR746445
      *                                                                                       237602
     C**********         ENDIF                                                       237602 AR746445
     C*                                                                   080603
     C*****CDL013        IFEQ      '1'                                               CDL013 AR746445
     C**********         MOVE      ' '           AKY(6)                              CDL013 AR746445
     C**********         ENDIF                                                       CDL013 AR746445
     C***/COPY*WNCPYSRC,DL0280C123                                                   S01408 AR746445
     C*                                                                   S01408
     C****Settlement*Net*Interest,*if*Interest*Paid*Separately                       080603 AR746445
     C*                                                                   080603
     C*****IPDS          IFEQ      'Y'                                          B 002 08060 AR746445
     C***/COPY*WNCPYSRC,DL0280C167                                                   S01408 AR746445
     C*****WORKD         SUB       TAXA          KYAMT                                08060 AR746445
     C***/COPY*WNCPYSRC,DL0280C168                                                   S01408 AR746445
     C**********         MOVE      'R'           AKY(3)                               08060 AR746445
     C**********         MOVE      'I'           AKY(10)                              08060 AR746445
     C*                                                                   080603
     C***Use*Interest*Settlement*Instructions                                        080603 AR746445
     C*                                                                   080603
     C*****IMET*         IFNE      *BLANKS                                      B 003 08060 AR746445
     C*****IMET*         ANDNE     *ZEROS                                             08060 AR746445
     C**********         MOVE      IMET          KYSETL                               08060 AR746445
     C**********         MOVEL     INSA          KYOSTL                               08060 AR746445
     C**********         ENDIF                                                  E 003 08060 AR746445
      *                                                                   145116
      ****If*Interest*Settlement*Currency*is*defined,*pass*this*currency             145116 AR746445
      ****as*settlement*currency*for*this*account*key.*(but*first,                   145116 AR746445
      ****save*currently**defined*settlement*currency.                               145116 AR746445
      *                                                                   145116
     C**********         MOVE      *BLANKS       SVCCY             3                  14511 AR746445
     C*****CEU003        IFEQ      'Y'                                                14511 AR746445
     C*****ISCY*         ANDNE     *BLANKS                                            14511 AR746445
     C**********         MOVE      KYSCY         SVCCY             3                  14511 AR746445
     C**********         MOVE      ISCY          KYSCY                                14511 AR746445
     C**********         ENDIF                                                        14511 AR746445
      *                                                                   S01408
     C***/COPY*WNCPYSRC,DL0280C209                                                   S01408 AR746445
      *                                                                   148100
      ***Save*the*original*value*of*settlement*branch.                               148100 AR746445
      *                                                                   148100
     C**********         MOVE      KYSTBR        @STBR             3                  14810 AR746445
      *                                                                   148100
      ****Determine*Settlement*method*to*get*the*appropriate                         148100 AR746445
      ****settlement*branch.                                                         148100 AR746445
      *                                                                   148100
     C*****IMET*         IFEQ      '01'                                               14810 AR746445
     C*****IMET*         OREQ      '02'                                               14810 AR746445
     C*****IMET*         OREQ      '07'                                               14810 AR746445
     C*****IMET*         OREQ      '08'                                               14810 AR746445
     C*****IMET*         OREQ      '12'                                               14810 AR746445
     C**********         MOVE      KYCCY         @KEYB                                14810 AR746445
      *                                                                   148100
      ***Read*Nostro*Details*via*access*program.                                     148100 AR746445
      *                                                                   148100
     C**********         CALL      'AONOSTR0'                                         14810 AR746445
     C**********         PARM      '*MSG   '     @RTCD                                14810 AR746445
     C**********         PARM      '*KEY    '    @OPTN                                14810 AR746445
     C**********         PARM      *BLANK        @KEYA             6                  14810 AR746445
     C**********         PARM                    @KEYB             3                  14810 AR746445
     C**********           PARM *BLANK    @KEYC   4                                    148100 CGL029
     C**********         PARM      *BLANK        @KEYC            10                        AR746445
     C**********         PARM      *BLANK        @KEYD             2                  14810 AR746445
     C**********         PARM      INSA          @KEYE             2                  14810 AR746445
     C**********         PARM                    @BRCD             3   I:Branch Code  14810 AR746445
     C**********         PARM                    @CSSN            10   I:Cust ShortN  14810 AR746445
     C**********         PARM                    @PNOI             1   I:Prime Nost In14810 AR746445
     C*****SDNOST        PARM      SDNOST        DSFDY                                14810 AR746445
     C*****@RTCD         IFNE      *BLANK                                             14810 AR746445
     C**********         SETON                                        U7U8LR          14810 AR746445
     C**********         EXSR      *PSSR                                              14810 AR746445
     C**********         GOTO      EOJ                                                14810 AR746445
     C**********         ELSE                                                         14810 AR746445
     C**********         MOVE      A7BRCD        KYSTBR                               14810 AR746445
     C**********         ENDIF                                                        14810 AR746445
     C**********         ENDIF                                                        14810 AR746445
      *                                                                   148100
      ***For*settlement*types*00,*04,*&*06,*these*are*settled                        148100 AR746445
      ***through*the*booking*branch.**This*is*being*done*in                          148100 AR746445
      ***DL0295.**For*05,*this*is*already*taken*cared*of*and                         148100 AR746445
      ***determined*in*the*previous*processing*where*POBR*and                        148100 AR746445
      ***ROBR*are*used*but*it*depends*if*the*deal*is*a*loan                          148100 AR746445
      ***or*a*deposit.**For*03,*since*POBR*&*ROBR*are*blanked                        148100 AR746445
      ***out*when*deal*is*input,*DL0295*uses*the*booking*branch                      148100 AR746445
      ***too.**So,*no*processing*needed*for*these*methods.                           148100 AR746445
      *                                                                   148100
     C*****IMET*         IFEQ      '14'                                               14810 AR746445
      *                                                                   148100
      ***Access*the*Account*Details*using*the*Retail*account*key.                    148100 AR746445
      *                                                                   148100
     C**********         CALL      'AOACCTR0'                                         14810 AR746445
     C**********         PARM      *BLANKS       @RTCD                                14810 AR746445
     C**********         PARM      '*KEY   '     @OPTN                                14810 AR746445
     C**********         PARM      INSA          @RETL            10                  14810 AR746445
     C**********         PARM      *BLANKS       @CNUM             6                  14810 AR746445
     C**********         PARM      *BLANKS       @CUCD             3                  14810 AR746445
     C**********           PARM *BLANKS   @ACCD   4                                    148100 CGL029
     C**********         PARM      *BLANKS       @ACCD            10                        AR746445
     C**********         PARM      *BLANKS       @ACSQ             2                  14810 AR746445
     C**********         PARM      *BLANKS       @BRCA             3                  14810 AR746445
     C*****SDACCT        PARM      SDACCT        DSSDY                                14810 AR746445
      *                                                                   148100
     C*****@RTCD         IFNE      *BLANKS                                            14810 AR746445
     C**********         SETON                                        U7U8LR          14810 AR746445
     C**********         EXSR      *PSSR                                              14810 AR746445
     C**********         GOTO      EOJ                                                14810 AR746445
     C**********         ELSE                                                         14810 AR746445
     C**********         MOVE      @BRCA         KYSTBR                                148100 239550
     C**********         MOVE      ABRCA         KYSTBR                              239550 AR746445
     C**********         ENDIF                                                        14810 AR746445
     C**********         ENDIF                                                        14810 AR746445
      *                                                                   148100
     C**********         EXSR      EXCP                                               08060 AR746445
      *                                                                   148100
      ***Return*the*previous*value*of*settlement*branch.                             148100 AR746445
      *                                                                   148100
     C**********         MOVE      @STBR         KYSTBR                               14810 AR746445
      *                                                                   145116
      ****Bring*back*saved*settlement*currency                                       145116 AR746445
      *                                                                   145116
     C*****CEU003        IFEQ      'Y'                                                14511 AR746445
     C*****ISCY*         ANDNE     *BLANKS                                            14511 AR746445
     C**********         MOVE      SVCCY         KYSCY                                14511 AR746445
     C**********         ENDIF                                                        14511 AR746445
      *                                                                   145116
     C**********         ENDIF                                                  E 002 08060 AR746445
     C**********         ENDIF                                                  E 001 08060 AR746445
     C***/COPY*WNCPYSRC,DL0280C498                                                          AR746445
     C*                                                                   080603
     C****Maturing*Principal                                                         080603 AR746445
     C*                                                                   080603
     C**********         Z-ADD     MDST          KYSETL                               08060 AR746445
     C**********         MOVE      OMDA          KYOSTL                               08060 AR746445
     C**********         Z-ADD     PAMT          KYAMT                                08060 AR746445
      *                                                                   S01408
     C***/COPY* WNCPYSRC,DL0280C210                                                  S01408 AR746445
      *                                                                   S01408
     C*****S01434        IFNE      'Y'                                          B 001 08060 AR746445
     C*****RBDN*         OREQ      *ZERO                                              08060 AR746445
     C*****FUID*         OREQ      'Y'                                                08060 AR746445
     C**********         MOVE      'M'           AKY(3)                               08060 AR746445
     C**********         MOVE      'A'           AKY(10)                              08060 AR746445
     C**********         ELSE                                                   X 001 08060 AR746445
     C**********         MOVE      'R'           AKY(3)                               08060 AR746445
     C**********         MOVE      'A'           AKY(10)                              08060 AR746445
      *                                                                   CEU015
     C*****CEU015        IFEQ      'Y'                                                CEU01 AR746445
     C*****RTFC*         ANDNE     *BLANKS                                            CEU01 AR746445
     C**********         MOVE      'X'           AKY(9)                               CEU01 AR746445
     C**********         MOVE      'Y'           @MRPAK                               CEU01 AR746445
     C**********         ENDIF                                                        CEU01 AR746445
      *                                                                   CEU015
     C**********         ENDIF                                                  E 001 08060 AR746445
     C*                                                                   080603
     C**********         EXSR      EXCP                                               08060 AR746445
     C*                                                                   CEU015
     C**********         MOVE      ' '           AKY(9)                               CEU01 AR746445
     C*                                                                   080603
     C****Rollover*Processing                                                        080603 AR746445
     C*                                                                   080603
      **Convert*RBDA*to*deal*currency*equivalent                                     CEU015 AR746445
     C******LIKE         DEFINE    RBDA          @RBDA                                CEU01 AR746445
     C**********         Z-ADD     RBDA          @RBDA                                CEU01 AR746445
      *                                                                   CEU015
     C*****RBDN          IFNE      *ZERO                                        B 001 08060 AR746445
      *                                                                   CEU015
     C*****CEU015        IFEQ      'Y'                                                CEU01 AR746445
     C*****RTFC*         ANDNE     *BLANKS                                            CEU01 AR746445
      *                                                                   CEU015
     C***Output*Rollover*To/From*Currency*to*GEDLPD*record.**This*will               CEU015 AR746445
     C***trigger*spot*trade*accounting*entries*to*be*produced*for                    CEU015 AR746445
     C***maturing*deals*rolled*over*from*an*'In'*currency*to*Euros.                  CEU015 AR746445
     C**********         MOVEL     RTFC          @RTFC             3                  CEU01 AR746445
      *                                                                   CEU015
     C**********         ENDIF                                                        CEU01 AR746445
     C*                                                                   080603
     C****New*Principal/Settlement                                                   080603 AR746445
     C*                                                                   080603
     C**********         Z-ADD     @RBDA         KYAMT                                CEU01 AR746445
     C**********         MOVE      'M'           AKY(3)                               08060 AR746445
     C**********         MOVE      'R'           AKY(10)                              08060 AR746445
     C*                                                                   080603
     C***For*Up*front*interest,*Rollover*is*Principal*Less*Interest                  080603 AR746445
     C*                                                                   080603
     C*****FUID*         IFEQ      'Y'                                          B 002 08060 AR746445
     C*                                                                   080603
     C*****RBDN*         CHAIN     DEALS                              32              13462 AR746445
     C*****RECR2         IFNE      'D'                                          B 003 08060 AR746445
     C*****RECR2         ANDNE     'E'                                                08060 AR746445
     C*****RECR2         ANDNE     'M'                                                08060 AR746445
     C*****RECR2         ANDNE     'R'                                                08060 AR746445
     C******IN32         OREQ      *ON                                                13462 AR746445
     C**********         SETON                                        LRU7U8          08060 AR746445
     C**********         GOTO      ENDMAD                                             08060 AR746445
     C**********         END                                                    E 003 08060 AR746445
     C*                                                                   080603
     C*****CEU015        IFEQ      'Y'                                                CEU01 AR746445
     C*****RTFC*         ANDNE     *BLANKS                                            CEU01 AR746445
      *                                                                   CEU015
     C**********         CALL      'EU0200'                                           CEU01 AR746445
     C**********         PARM      *BLANKS       P@RTCD            7   RETURN CODE    CEU01 AR746445
     C**********         PARM      TOTI2         P@FRAM           18 3 TRANS AMT      CEU01 AR746445
     C**********         PARM      RTFC          P@FRCY            3   FROM CCY       CEU01 AR746445
     C**********         PARM      PCCY          P@TOCY            3   TO   CCY       CEU01 AR746445
     C**********         PARM                    P@OUTA           15 0 AMOUNT         CEU01 AR746445
     C**********         PARM                    P@INTA           18 3 INT SET AMT    CEU01 AR746445
     C**********         PARM                    P@EXRT           15 9 EXCH RATE      CEU01 AR746445
     C**********         PARM                    P@MDIN            1   M/D IND        CEU01 AR746445
      *                                                                   CEU015
     C*****P@RTCD        IFEQ      '*ERROR*'                                          CEU01 AR746445
     C**********         MOVEL     'EU0200'      DBFILE           10    ************* CEU01 AR746445
     C**********         MOVEL     '20'          DBASE             3    *DBERROR 020* CEU01 AR746445
     C**********         MOVE      *BLANKS       DBOPTN            7    ************* CEU01 AR746445
     C**********         MOVEL     RTFC          DBKEY                                CEU01 AR746445
     C**********         SETON                                        U7U8            CEU01 AR746445
     C**********         EXSR      *PSSR                                              CEU01 AR746445
     C**********         ELSE                                                         CEU01 AR746445
     C**********         SUB       P@OUTA        KYAMT                                CEU01 AR746445
     C**********         ENDIF                                                        CEU01 AR746445
     C**********         ELSE                                                         CEU01 AR746445
     C**********         SUB       TOTI2         KYAMT                                08060 AR746445
     C**********         ENDIF                                                        CEU01 AR746445
     C**********         END                                                    E 002 08060 AR746445
     C*                                                                   080603
     C**********         EXSR      EXCP                                               08060 AR746445
      **********                                                                       233319 234421
      ***Calculate EU Tax Amount                                                       233319 234421
      **********                                                                       233319 234421
     C*****CGL031        IFEQ      'Y'                                                 233319 234421
     C*****CGL032        OREQ      'Y'                                                 233319 234421
     C**********         MOVE      'ROL'         WTYP              3                   233319 234421
     C**********         EXSR      SREUTX                                              233319 234421
      **********                                                                       233324 234421
      ***Run*Money Market & Loans processing if necessary.                             233324 234421
      **********                                                                       233324 234421
     C******IN03         IFEQ      *ON                                                 233324 234421
     C*****WNTAMT        ANDNE     *ZERO                                               233324 234421
     C**********         EXSR      SRETDC                                              233324 234421
     C**********         ENDIF                                                         233324 234421
     C**********         ENDIF                                                         233319 234421
      **********                                                                       233319 234421
      ***Generate EU Withholding Tax Account Keys at rollover date                     233319 234421
      **********                                                                       233319 234421
     C*****CGL031        IFEQ      'Y'                                                 233319 234421
     C******IN21         ANDEQ     *ON                                                 233319 234421
     C**********         EXSR      SEUMCT                                              233319 234421
     C**********         EXSR      SEUMGK                                              233319 234421
     C**********         ENDIF                                                         233319 234421
     C*                                                                   CEU015
     C****Blank*out*@RTFC*as*this*is*meant*to*be*output*only*for*a/c                 CEU015 AR746445
     C****key**..M.....R.                                                            CEU015 AR746445
     C**********         MOVE      *BLANKS       @RTFC                                CEU01 AR746445
     C*                                                                   080603
     C****Principal*Difference                                                       080603 AR746445
     C*                                                                   080603
     C*****PAMT*         SUB       @RBDA         KYAMT                                CEU01 AR746445
     C**********         Z-ADD     DLNO          DLNO1             6 0                08060 AR746445
     C*                                                                   080603
     C***If*Principal*Decrease,*for*Enhanced*Rollover*Processing                     080603 AR746445
     C*                                                                   080603
     C*****S01434        IFEQ      'Y'                                          B 002 08060 AR746445
     C*****FUID*         ANDNE     'Y'                                                08060 AR746445
     C*****@MRPAK        ANDNE     'Y'                                                CEU01 AR746445
     C*                                                                   080603
     C*****KYAMT         IFGE      0                                            B 003 08060 AR746445
     C**********         MOVE      'R'           AKY(3)                               08060 AR746445
     C**********         MOVE      'C'           AKY(10)                              08060 AR746445
     C*                                                                   080603
     C**********         ELSE                                                   X 003 08060 AR746445
     C** Otherwise Principal Increase, Use Start Date Instructions        080603
     C*                                                                   080603
     C*****RBDN*         CHAIN     DEALS                              32              13462 AR746445
     C*****RECR2         IFNE      'D'                                          B 004 08060 AR746445
     C*****RECR2         ANDNE     'E'                                                08060 AR746445
     C*****RECR2         ANDNE     'M'                                                08060 AR746445
     C*****RECR2         ANDNE     'R'                                                08060 AR746445
     C******IN32         OREQ      *ON                                                13462 AR746445
     C**********         SETON                                        LRU7U8          08060 AR746445
     C**********         GOTO      ENDMAD                                             08060 AR746445
     C**********         END                                                    E 004 08060 AR746445
     C*                                                                   080603
     C**********         MOVE      'R'           AKY(3)                               08060 AR746445
     C**********         MOVE      'B'           AKY(10)                              08060 AR746445
     C**********         Z-SUB     KYAMT         KYAMT                                08060 AR746445
     C**********         END                                                    E 003 08060 AR746445
     C*                                                                   080603
     C**********         EXSR      EXCP                                               08060 AR746445
     C**********         ENDIF                                                  E 002 08060 AR746445
     C**********         ENDIF                                                  E 001 08060 AR746445
      *                                                                   CDL006
      ***If*Feature*CDL006*is*installed.                                             CDL006 AR746445
      *                                                                   CDL006
     C*****CDL006        IFEQ      'Y'                                                CDL00 AR746445
      *                                                                   CDL006
      ***If*Fiduciary*Deposits.                                                      CDL006 AR746445
      *                                                                   CDL006
     C*****WUFIDE        IFEQ      'D'                                                CDL00 AR746445
     C*****WUFIDE        OREQ      'L'                                                CDL00 AR746445
      *                                                                   CDL006
      ***Save*Interest*amount*previously*calculated.                                 CDL006 AR746445
      *                                                                   CDL006
     C**********         Z-ADD     WORKD         WUINTA                               CDL00 AR746445
      *                                                                   CDL006
      ***If*Commission*is*accrued*(Only*for*Time*deposits).                          CDL006 AR746445
      *                                                                   CDL006
     C*****BNACCO        IFEQ      'Y'                                                CDL00 AR746445
     C*****DTYP*         ANDEQ     'FT'                                               CDL00 AR746445
     C*****FCMC*         ANDNE     *BLANKS                                            CDL00 AR746445
      *                                                                   CDL006
      ***Build*Accrued*commission*Account*Key.                                       CDL006 AR746445
      *                                                                   CDL006
     C**********         MOVE      'A'           AKY(3)                               CDL00 AR746445
     C**********         MOVEA     DLST          AKY(4)                               CDL00 AR746445
     C**********         MOVEA     '    '        AKY(6)                               CDL00 AR746445
     C**********         MOVE      'C'           AKY(10)                              CDL00 AR746445
      *                                                                   CDL006
      ****Calculate*accrued*commission*to post*:*FCMA*-*FACPD.                       CDL006 AR746445
      *                                                                   CDL006
     C*****FCMA*         SUB       FACPD         KYAMT                                CDL00 AR746445
      *                                                                   CDL006
      ***Generate*Accrued*commission*Account*Key.                                    CDL006 AR746445
      *                                                                   CDL006
     C**********         EXSR      EXCP                                               CDL00 AR746445
      *                                                                   CDL006
      ***Update*"Accrued*Commission*posted*to*date".                                 CDL006 AR746445
      *                                                                   CDL006
     C**********         Z-ADD     FCMA          FACPD                                CDL00 AR746445
     C**********         MOVE      'Y'           WUDXUP                               CDL00 AR746445
     C**********         ENDIF                                                        CDL00 AR746445
      *                                                                   CDL006
      ***Initialize*Commission*on*commission*used*to                                 CDL006 AR746445
      ***calculate*Net*amount*to*be*settled.                                         CDL006 AR746445
      *                                                                   CDL006
     C**********         Z-ADD     0             W0FCMA                               CDL00 AR746445
      *                                                                   CDL006
      ***If*Commission*due*on*the Deal.                                              CDL006 AR746445
      *                                                                   CDL006
     C*****BNCOTK        IFEQ      'Y'                                                CDL00 AR746445
     C*****FCMC*         ANDNE     *BLANKS                                            CDL00 AR746445
      *                                                                   CDL006
      ***Build*Commission*Account*Key.                                               CDL006 AR746445
      *                                                                   CDL006
     C**********         MOVE      'M'           AKY(3)                               CDL00 AR746445
     C**********         MOVEA     DLST          AKY(4)                               CDL00 AR746445
     C**********         MOVEA     '    '        AKY(6)                               CDL00 AR746445
     C**********         MOVEA     'OC'          AKY(9)                               CDL00 AR746445
      *                                                                   CDL006
      ***If*Call*Deposit.                                                            CDL006 AR746445
      *                                                                   CDL006
     C*****DTYP*         IFEQ      'DT'                                               CDL00 AR746445
     C*****DTYP*         OREQ      'LT'                                               CDL00 AR746445
      *                                                                   CDL006
      ****Calculate*Commission*amount*due.                                           CDL006 AR746445
      *                                                                   CDL006
      **********PAMT                                                                 CDL006 AR746445
      ****(------------)*x*(MDAT*-*IACD)*x*(%*current*range)*+*FACTC                 CDL006 AR746445
      *****Days of year****************************************FCPRD                 CDL006 AR746445
      *                                                                   CDL006
     C**********         Z-ADD     IACD          WUDBEG                               CDL00 AR746445
     C**********         Z-ADD     MDAT          WUDEND                               CDL00 AR746445
      *                                                                   CDL006
     C**********         EXSR      COMCAL                                             CDL00 AR746445
      *                                                                   CDL006
     C*****WUACSC        ADD       FACTC         WORKTD                               CDL00 AR746445
      *                                                                   CDL006
      ***If*Original*entry*date*less*than*Run*date,*update                           CDL006 AR746445
      ***"Commission*amount"*held*on*Deals*file.                                     CDL006 AR746445
      *                                                                   CDL006
     C*****ORED          IFLT      BJRDNB                                             CDL00 AR746445
     C**********         Z-ADD     WORKTD        FCMA                                 CDL00 AR746445
     C**********         MOVE      'Y'           WUDXUP                               CDL00 AR746445
     C**********         ENDIF                                                        CDL00 AR746445
     C**********         ENDIF                                                        CDL00 AR746445
      *                                                                   CDL006
      ***If*Fixed*term*deposit.                                                      CDL006 AR746445
      *                                                                   CDL006
     C*****DTYP*         IFEQ      'FT'                                               CDL00 AR746445
      *                                                                   CDL006
      ****Calculate*Commission*amount*due*:*FCMA*-*FCPRD.                            CDL006 AR746445
      *                                                                   CDL006
     C**********         Z-ADD     FCMA          WORKTD                               CDL00 AR746445
      *                                                                   CDL006
     C**********         ENDIF                                                        CDL00 AR746445
      *                                                                   CDL006
     C*****WORKTD        SUB       FCPRD         WORKD                                CDL00 AR746445
     C**********         Z-ADD     WORKD         KYAMT                                CDL00 AR746445
     C**********         Z-ADD     WORKD         W0FCMA                               CDL00 AR746445
      *                                                                   CDL006
      ***Generate*Commission*Account*Key.                                            CDL006 AR746445
      *                                                                   CDL006
     C**********         EXSR      EXCP                                               CDL00 AR746445
     C**********         MOVEA     ' '           AKY(9)                               CDL00 AR746445
      *                                                                   CDL006
      ***Update*"Commission*paid/received*to*date".                                  CDL006 AR746445
      *                                                                   CDL006
     C**********         Z-ADD     WORKTD        FCPRD                                CDL00 AR746445
     C**********         MOVE      'Y'           WUDXUP                               CDL00 AR746445
      *                                                                   CDL006
      ***If*commission*due*to*agent.                                                 CDL006 AR746445
      *                                                                   CDL006
     C*****BBAGNT        IFNE      *BLANKS                                            CDL00 AR746445
      *                                                                   CDL006
      ***Build*account*key*for*"Commission*due*to*agent".                            CDL006 AR746445
     C**********         MOVE      'M'           AKY(3)                               CDL00 AR746445
     C**********         MOVEA     DLST          AKY(4)                               CDL00 AR746445
     C**********         MOVEA     '    '        AKY(6)                               CDL00 AR746445
     C**********         MOVEA     'AC'          AKY(9)                               CDL00 AR746445
      *                                                                   CDL006
     C*****W0FCMA        MULT      BBAGNP        W018D3                               CDL00 AR746445
     C*****W018D3        DIV       100           KYAMT                                CDL00 AR746445
      *                                                                   CDL006
      ***Generate*Commission*due*to*agent*Account*Key.                               CDL006 AR746445
      *                                                                   CDL006
     C**********         EXSR      EXCP                                               CDL00 AR746445
     C**********         MOVEA     ' '           AKY(9)                               CDL00 AR746445
      *                                                                   CDL006
     C**********         ENDIF                                                        CDL00 AR746445
      *                                                                   CDL006
     C**********         ENDIF                                                        CDL00 AR746445
      *                                                                   CDL006
      ***Restore*Interest*amount*previously*calculated.                              CDL006 AR746445
      *                                                                   CDL006
     C**********         Z-ADD     WUINTA        WORKD                                CDL00 AR746445
      *                                                                   CDL006
     C**********         ENDIF                                                        CDL00 AR746445
     C**********         ENDIF                                                        CDL00 AR746445
     C***/COPY*WNCPYSRC,DL0280C045                                                          AR746445
     C*                                                                   080603
     C***Settlement*Amount                                                           080603 AR746445
     C*                                                                   080603
     C**********         MOVE      'M'           AKY(3)                               08060 AR746445
     C**********         MOVE      'B'           AKY(10)                              08060 AR746445
     C*                                                                   080603
     C*****PAMT*         SUB       @RBDA         KYAMT                                CEU01 AR746445
     C**********         Z-ADD     DLNO          DLNO1             6 0                08060 AR746445
     C*                                                                   080603
     C*****FUID *        IFEQ      'Y'                                          B 001 08060 AR746445
     C*****RBDN*         ANDNE     *ZERO                                              08060 AR746445
     C**********         ADD       TOTI2         KYAMT                                08060 AR746445
     C**********         END                                                    E 001 08060 AR746445
     C*                                                                   080603
     C*****IPDS*         IFEQ      'Y'                                          B 001 08060 AR746445
     C*****IPFR*         OREQ      'N'                                                08060 AR746445
     C*****FUID*         OREQ      'Y'                                                08060 AR746445
     C*                                                                   080603
     C**********         ELSE                                                   X 001 08060 AR746445
     C*                                                                   080603
     C**********         ADD       WORKD         KYAMT                 + Interest     08060 AR746445
     C*/COPY*WNCPYSRC,DL0280C169                                                     S01408 AR746455
     C**********         SUB       TAXA          KYAMT                 - TAX          08060 AR746445
     C*/COPY*WNCPYSRC,DL0280C170                                                     S01408 AR746445
      **********                                                                       234421 234765
     C*****GL031         IFEQ      'Y'                                                 234421 234765
     C**********         SUB       WNTAMT        KYAMT                                 234421 234765
     C**********         ENDIF                                                         234421 234765
      **********                                                                       234421 234765
     C**********         ENDIF                                                  E 001 08060 AR746445
      *                                                                   CDL006
      ***If*feature*CDL006*is*installed.                                             CDL006 AR746445
      *                                                                   CDL006
     C*****CDL006        IFEQ      'Y'                                                CDL00 AR746445
      *                                                                   CDL006
      ***If*Fiduciary*Deposit.                                                       CDL006 AR746445
     C*****WUFIDE        IFEQ      'D'                                                CDL00 AR746445
     C*****WUFIDE        OREQ      'L'                                                CDL00 AR746445
      *                                                                                       CGL020
     C*****CGL020        IFEQ      'Y'                                                      AR746445
     C**********         MOVE      'N'           F1FFLG                                     AR746445
     C**********         Z-ADD     W0FCMA        F1FVAL                                     AR746445
     C**********         Z-ADD     0             WKAMT                                      AR746445
     C*****KYAMT         IFNE      0                                                        AR746445
     C*****W0FCMA        DIV(H)    KYAMT         WKAMT                                      AR746445
     C*****WKAMT         MULT      100           F1FPCT                                     AR746445
     C**********         ENDIF                                                              AR746445
     C**********         ENDIF                                                              AR746445
      *                                                                                       CGL020
     C**********         SUB       W0FCMA        KYAMT                                CDL00 AR746445
     C**********         ENDIF                                                        CDL00 AR746445
      *                                                                   CDL006
     C**********         ENDIF                                                        CDL00 AR746445
     C***/COPY*WNCPYSRC,DL0280C046                                                  BUG4426 AR746445
      *                                                                   BUG4426
      ***If*a*penalty*fee*has*been*charged*due*to*early*maturity                    BUG4426 AR746445
      ***then*include*penalty*fee*in*net*settlement*amount.                         BUG4426 AR746445
     C*****PENA          IFNE      *ZERO                                              BUG44 AR746445
     C*****FSCAND        ANDNE     *ZERO                                              BUG44 AR746445
     C*****FSPNPR        IFEQ      'P'                                                BUG44 AR746445
     C**********         ADD       PENA          KYAMT                                BUG44 AR746445
     C**********         ELSE                                                         BUG44 AR746445
     C**********         SUB       PENA          KYAMT                                BUG44 AR746445
     C**********         ENDIF                                                        BUG44 AR746445
     C**********         ENDIF                                                        BUG44 AR746445
     C*                                                                   080603
     C*****KYAMT         IFLT      *ZERO                                        B 001 08060 AR746445
     C*****RBDN*         ANDNE     *ZERO                                              08060 AR746445
     C**********         Z-ADD     RBDN          DLNO                                 08060 AR746445
     C**********         MOVE      SDST2         KYSETL                               08060 AR746445
     C**********         MOVE      OSDA2         KYOSTL                               08060 AR746445
      *                                                                                       CGL020
     C*****CGL020        IFEQ      'Y'                                                      AR746445
     C**********         MOVE      'RD'          STINFO                                     AR746445
     C**********         ENDIF                                                              AR746445
      *                                                                                       CGL020
     C**********         END                                                    E 001 08060 AR746445
     C*                                                                   080603
     C**********         Z-ADD     KYAMT         WZAMT                               233565 AR746445
      *****************************************************************                235040 240667
     C*****RBDN          IFEQ      *ZERO                                               235040 240667
     C**********         EXSR      EXCP                                               08060 AR746445
     C**********         ENDIF                                                         235040 240667
      *                                                                                       CAS009
     C**********         MOVE      'MAMT'        WCFTP                               CAS009 AR746445
     C**********         EXSR      SRMMCF                                            CAS009 AR746445
     C***/COPY*WNCPYSRC,DL0280C199                                                   S01408 AR746445
      *                                                                                       CGL020
     C*****CGL020        IFEQ      'Y'                                                      AR746445
     C**********         MOVE      *BLANKS       F1FFLG                                     AR746445
     C**********         Z-ADD     0             F1FVAL                                     AR746445
     C**********         Z-ADD     0             F1FPCT                                     AR746445
     C**********         ENDIF                                                              AR746445
      *                                                                                       CGL020
     C**********         Z-ADD     DLNO1         DLNO                                 08060 AR746445
     C*                                                                   080603
     C***If*Deal*and*System*is*Taxable                                               080603 AR746445
     C*                                                                   080603
     C***/COPY*WNCPYSRC,DL0280C479                                                          AR746445
     C******IN19         IFEQ      *ON                                          B 001 08060 AR746445
     C******IN21         ANDEQ     *ON                                                11703 AR746445
     C******IN23         ANDEQ     *ON                                                08060 AR746445
     C*****IPFR*         ANDNE     'N'                                                08060 AR746445
     C*****IPDS*         ANDNE     'Y'                                               237602 AR746445
     C***/COPY*WNCPYSRC,DL0280C674                                                          AR746445
     C*                                                                   080603
     C***Convert*BRT*AMOUNT                                                          080603 AR746445
     C*                                                                   080603
     C*****S01383        IFEQ      'Y'                                          B 002 08060 AR746445
     C*                                                                   117033
     C*****PCCY*         IFEQ      BLCYCD                                             11703 AR746445
     C**********         MOVE      'B'           AKY(9)                               11703 AR746445
     C**********         END                                                          11703 AR746445
     C**********         Z-ADD     TAXA          KYAMT                                11703 AR746445
     C**********         MOVE      'M'           AKY(3)                               11703 AR746445
     C**********         MOVE      'T'           AKY(10)                              11703 AR746445
     C**********         EXSR      EXCP                                               11703 AR746445
     C**********         MOVE      ' '           AKY(9)                               11703 AR746445
     C*                                                                   117033
     C*****PCCY*         IFNE      BLCYCD                                             11703 AR746445
     C**********         Z-ADD     TAXA          CYBRAM                               11703 AR746445
     C**********         EXSR      GENBRT                                             11703 AR746445
     C***U8*****         GOTO      ENDMAD                                             11703 AR746445
     C**********         END                                                          11703 AR746445
     C*                                                                   117033
     C*****BJCYCD        IFNE      BLCYCD                                             11703 AR746445
     C**********         Z-ADD     TAXA          CYBRAM                               08060 AR746445
     C**********         EXSR      CNVBRT                                             08060 AR746445
     C***U8*****         GOTO      ENDMAD                                             08060 AR746445
     C**********         END                                                    E 002 08060 AR746445
     C**********         ELSE                                                         11703 AR746445
     C*                                                                   080603
     C*****Generate*Tax*Amount*Key                                                   080603 AR746445
     C*                                                                   080603
     C**********         MOVE      'M'           AKY(3)                               08060 AR746445
     C**********         MOVE      'T'           AKY(10)                              08060 AR746445
     C***/COPY*WNCPYSRC,DL0280C171                                                   S01408 AR746445
     C**********         Z-ADD     TAXA          KYAMT                                08060 AR746445
     C*                                                                   S01408
     C*****CDL013        IFEQ      '1'                                               CDL013 AR746445
     C*****BBCSTY        IFEQ      'C'                                               CDL013 AR746445
     C**********         MOVE      'C'           AKY(6)                              CDL013 AR746445
     C**********         ELSE                                                        CDL013 AR746445
     C**********         MOVE      ' '           AKY(6)                              CDL013 AR746445
     C**********         ENDIF                                                       CDL013 AR746445
     C**********         ENDIF                                                       CDL013 AR746445
     C***/COPY*WNCPYSRC,DL0280CP12                                                   S01408 AR746445
     C*                                                                   S01408
     C**********         EXSR      EXCP                                               08060 AR746445
     C/COPY WNCPYSRC,DLH00074
     C**********         END                                                          11703 AR746445
     C*                                                                   S01408
     C*****CDL013        IFEQ      '1'                                               CDL013 AR746445
     C**********         MOVE      ' '           AKY(6)                              CDL013 AR746445
     C**********         ENDIF                                                       CDL013 AR746445
     C***/COPY*WNCPYSRC,DL0280C124                                                   S01408 AR746445
     C*                                                                   S01408
     C**********         END                                                    E 001          08060
      *                                                                                       233277
      ***Calculate*EU*Tax*Amount                                                     233277 AR746445
      *                                                                                       233277
     C*****CGL031        IFEQ      'Y'                                               233277 AR746445
     C*****CGL032        OREQ      'Y'                                               233277 AR746445
     C*****WORKD         IFGT      *ZERO                                             233277 AR746445
     C**********         MOVE      'MAT'         WTYP                                233277 AR746445
     C**********         EXSR      SREUTX                                            233277 AR746445
      *                                                                                       233324
      ***Run*Money*Market*&*Loans*processing*if*necessary.                           233324 AR746445
      *                                                                                       233324
     C******IN03         IFEQ      *ON                                               233324 AR746445
     C*****WNTAMT        ANDNE     *ZERO                                             233324 AR746445
     C**********         EXSR      SRETDC                                            233324 AR746445
     C**********         ENDIF                                                       233324 AR746445
     C**********         ENDIF                                                       233277 AR746445
     C**********         ENDIF                                                       233277 AR746445
      *                                                                                       CGL031
      ***Generate*EU*Withholding*Tax*Account*Keys*at*maturity*date.                  CGL031 AR746445
      *                                                                                       CGL031
     C*****CGL031        IFEQ      'Y'                                               CGL031 AR746445
      *                                                                                       233565
     C*****DTYP*         IFEQ      'CD'                                              233565 AR746445
     C*****DTYP*         OREQ      'TD'                                              233565 AR746445
     C**********         EXSR      SEUMCT                                            233565 AR746445
     C**********         EXSR      SEUMGK                                            233565 AR746445
     C**********         ENDIF                                                       233565 AR746445
      *                                                                                       233565
     C*****CDL006        IFEQ      'Y'                                               233565 AR746445
     C*****DTYP*         IFEQ      'DT'                                              233565 AR746445
     C*****DTYP*         OREQ      'FT'                                              233565 AR746445
     C**********         EXSR      SEUMCT                                            233565 AR746445
     C**********         EXSR      SEUMGK                                            233565 AR746445
     C**********         ENDIF                                                       233565 AR746445
     C**********         ENDIF                                                       233565 AR746445
      *                                                                                       233565
     C******IN21         ANDEQ     *ON                                                 CGL031 233565
     C**********         EXSR      SEUMCT                                              CGL031 233565
     C*****WEUTXM        IFEQ      'Y'                                                 CGL031 233316
     C**********         EXSR      SEUMGK                                              CGL031 233565
     C**********         ENDIF                                                         CGL031 233316
     C**********         ENDIF                                                       CGL031 AR746445
      *                                                                                       CGL031
     C***/COPY*WNCPYSRC,DL0280C480                                                          AR746445
      *                                                                   CAC001
      ***Generate*Maturity*Date*Account*Keys*for*Loans/Deposits                      CAC001 AR746445
      *                                                                   CAC001
     C*****BGN0ST        IFEQ      'Y'                                                CAC00 AR746445
     C*****FPRC*         ANDNE     *BLANKS                                            CAC00 AR746445
      *                                                                   CAC001
      ***Update*Accrued*COF*Posted*to*date                                           CAC001 AR746445
      *                                                                   CAC001
     C**********         ADD       WRKTP         ACPD                                 CAC00 AR746445
      *                                                                   CAC001
      ***Cost of*Fund*Accrued*not*yet*posted*-*Transaction*Profit*Centre             CAC001 AR746445
      *                                                                   CAC001
     C**********         MOVE      'A'           AKY(3)                               CAC00 AR746445
     C**********         MOVEA     'T   '        AKY(6)                               CAC00 AR746445
     C**********         MOVE      'A'           AKY(10)                              CAC00 AR746445
     C**********         Z-ADD     WRKTP         KYAMT                                CAC00 AR746445
     C**********         MOVE      PRFC          OPPRFC                               CAC00 AR746445
     C**********         EXSR      EXCP                                               CAC00 AR746445
      *                                                                   CAC001
      ***Cost*of*Fund*Accrued*not*yet*posted*-*Funding*Profit*Centre                 CAC001 AR746445
      *                                                                   CAC001
     C**********         MOVEA     'F   '        AKY(6)                               CAC00 AR746445
     C**********         MOVE      FPRC          OPPRFC                               CAC00 AR746445
     C**********         EXSR      EXCP                                               CAC00 AR746445
      *                                                                   CAC001
      ***Principal*-*Transaction*Profit*Centre                                       CAC001 AR746445
      *                                                                   CAC001
     C**********         MOVE      'M'           AKY(3)                               CAC00 AR746445
     C**********         MOVEA     'T   '        AKY(6)                               CAC00 AR746445
     C**********         MOVE      'A'           AKY(10)                              CAC00 AR746445
     C**********         Z-ADD     PAMT          KYAMT                                CAC00 AR746445
     C**********         MOVE      PRFC          OPPRFC                               CAC00 AR746445
     C**********         EXSR      EXCP                                               CAC00 AR746445
      *                                                                   CAC001
      ***Principal*-*Funding*Profit*Centre                                           CAC001 AR746445
      *                                                                   CAC001
     C**********         MOVEA     'F   '        AKY(6)                               CAC00 AR746445
     C**********         MOVE      FPRC          OPPRFC                               CAC00 AR746445
     C**********         EXSR      EXCP                                               CAC00 AR746445
      *                                                                   CAC001
      ***Cost*of*Funds*Due*at*Maturity*-*Transaction*Profit*Centre                   CAC001 AR746445
      *                                                                   CAC001
     C**********         MOVE      'M'           AKY(3)                               CAC00 AR746445
     C**********         MOVEA     'T   '        AKY(6)                               CAC00 AR746445
     C**********         MOVE      'I'           AKY(10)                              CAC00 AR746445
     C**********         Z-ADD     WRKD          KYAMT                                CAC00 AR746445
     C**********         MOVE      PRFC          OPPRFC                               CAC00 AR746445
     C**********         EXSR      EXCP                                               CAC00 AR746445
      *                                                                   CAC001
      ***Cost*of*Funds*Due*at*Maturity*-*Funding*Profit*Centre                       CAC001 AR746445
      *                                                                   CAC001
     C**********         MOVEA     'F   '        AKY(6)                               CAC00 AR746445
     C**********         MOVE      FPRC          OPPRFC                               CAC00 AR746445
     C**********         EXSR      EXCP                                               CAC00 AR746445
     C**********         MOVEA     '    '        AKY(6)                               CAC00 AR746445
     C**********         MOVE      PRFC          OPPRFC                               CAC00 AR746445
      *                                                                   CAC001
     C**********         ENDIF                                         -BGN0ST=Y      CAC00 AR746445
     C***/COPY*WNCPYSRC,DL0280C570                                                          AR746445
     C*                                                                   080603
     C*****CGL020        IFEQ      'Y'                                                      AR746445
     C**********         MOVE      *BLANKS       STINFO                                     AR746445
     C**********         ENDIF                                                              AR746445
      *                                                                   BUG4426
      ***If*a*penalty*fee*has*been*charged*due*to*early*maturity                    BUG4426 AR746445
      ***then*generate*additional*account*key*for*penalty*fee                       BUG4426 AR746445
     C*****PENA*         IFNE      *ZERO                                              BUG44 AR746445
     C*****FSCAND        ANDNE     *ZERO                                              BUG44 AR746445
      *                                                                   BUG4426
      ****Get*settlement*instructions*from*deal*amendment                           BUG4426 AR746445
     C*****DLNO*         CHAIN     DLEMDAPD                           90              BUG44 AR746445
     C******IN90         IFEQ      *OFF                                               BUG44 AR746445
     C**********         Z-ADD     SETP          KYSETL                               BUG44 AR746445
     C**********         MOVE      OSAC          KYOSTL                               BUG44 AR746445
     C**********         MOVE      OSBR          KYSTBR                               BUG44 AR746445
     C**********         MOVE      PRFC          OPPRFC                               BUG44 AR746445
     C***U1*****         DELETE    DLEMDAD0                                           BUG44 AR746445
     C**NU1*****         UNLOCK    DLEMDAPD                                           BUG44 AR746445
     C**********         ENDIF                                                        BUG44 AR746445
      *                                                                   BUG4426
      ****Output*account*key                                                        BUG4426 AR746445
     C**********         MOVE      'M'           AKY(3)                               BUG44 AR746445
     C**********         MOVEA     '    '        AKY(6)                               BUG44 AR746445
     C**********         MOVE      FSPNPR        AKY(8)                               BUG44 AR746445
     C**********         MOVE      'P'           AKY(9)                               BUG44 AR746445
     C**********         MOVE      'A'           AKY(10)                              BUG44 AR746445
     C**********         Z-ADD     PENA          KYAMT                                BUG44 AR746445
     C**********         EXSR      EXCP                                               BUG44 AR746445
      *                                                                   BUG4426
     C**********         ENDIF                                                        BUG44 AR746445
      *                                                                   BUG4426             CGL020
     C*****ENDMAD        ENDSR                                                        08060 AR746445
     C/COPY DLCPYSRC,DL0280MADT                                                             AR746445
1162 C*                                                                   080603
     C/COPY WNCPYSRC,DL0280C464
2782 C********************************************************************
2783 C*
2784 C*****     NIDPA IS A SUBROUTINE TO PROVIDE PROCESSING FOR
2785 C*          NEXT INT.PAY DATE, ALSO FOR DEAL AMENDMENT TYPE
2786 C*          SI.  - NEG ASSETS PURCHASED ONLY.
2787 C*
2788 C     NIDPA         BEGSR
2789 C                   Z-ADD     IACD          ZIBEG
     C/COPY WNCPYSRC,DL0280C618
2790 C                   Z-ADD     NIPAR         ZIEND
2791 C  N28              Z-ADD     PAMT          ZIAMT
2792 C  N28              Z-ADD     YRAT          ZIRATE                          INT.
2791 C   28              Z-ADD     FVAL          ZIAMT
     C/COPY WNCPYSRC,DL0280C619
2792 C   28              Z-ADD     INTR          ZIRATE                          INT.
     C/COPY WNCPYSRC,DL0280C620
2793 C                   Z-ADD     ICBS          ZICALC                            CALCULATED
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP38                                           S01408
      *                                                                   S01408
2794 C                   EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP39                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
2795 C     WKINT         ADD       AITC          WORKTD                         ACCRUED TO DATE
     C     WORKTD        ADD       AIAN          WORKTD
     C     WORKTD        ADD       AIAP          WORKTD
2796 C     WORKTD        SUB       AIPD          WORKTP                         ACCRUED TO POST
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C     *IN28         IFEQ      *ON
     C                   Z-ADD     INTR          WRKINT
     C                   Z-ADD     FVAL          ZIAMT
     C                   ELSE
     C                   Z-ADD     YRAT          WRKINT
     C                   Z-ADD     PAMT          ZIAMT
     C                   ENDIF
     C                   EXSR      SRNTR
      *                                                                                       CAS005
     C                   Z-ADD     WKINTR        ZIRATE
     C                   Z-ADD     IACD          ZIBEG
     C                   Z-ADD     NIPAR         ZIEND
     C                   Z-ADD     ICBS          ZICALC
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
     C     WINTST        ADD       FSAITN        WKNTRD
     C     WKNTRD        ADD       FSAINN        WKNTRD
     C     WKNTRD        ADD       FSAIAN        WKNTRD
     C     WKNTRD        SUB       FSAIPN        WKNTRP
     C                   ENDIF
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0280C621
2797 C                   Z-ADD     FVAL          ZIAMT
     C/COPY WNCPYSRC,DL0280C622
2799 C                   Z-ADD     INTR          ZIRATE                          INTEREST DUE
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP40                                           S01408
      *                                                                   S01408
2800 C                   EXSR      GLINTC
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP41                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C     WKINT         ADD       AITC          WRKTD            13 0                         E1051
     C     WRKTD         ADD       AIAN          WRKTD                                         E1051
     C     WRKTD         ADD       AIAP          WRKTD                                         E1051
     C     WRKTD         SUB       IPRD          WRKTD                                         E1051
     C/COPY WNCPYSRC,DL0280C623
     C     WRKTD         ADD       SPINT         WRKTD                                         E1136
     C/COPY WNCPYSRC,DL0280C624
     C   28WRKTD         SUB       PINT          WORKLI           13 0          INT.DUE LESS   E1051
     C***                                                  PURCH. INT.
     C/COPY WNCPYSRC,DL0280C625
     C   48              Z-ADD     INTR          NARRAT                                        S0137
     C/COPY WNCPYSRC,DL0280C626
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C                   Z-ADD     INTR          WRKINT
     C                   EXSR      SRNTR
      *                                                                                       CAS005
     C                   Z-ADD     FVAL          ZIAMT
     C                   Z-ADD     WKINTR        ZIRATE
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
     C     WINTST        ADD       FSAITN        WNTRD            13 0
     C     WNTRD         ADD       FSAINN        WNTRD
     C     WNTRD         ADD       FSAIAN        WNTRD
     C     WNTRD         SUB       FSIPRN        WNTRD
     C     WNTRD         ADD       SPINT         WNTRD
     C                   ENDIF
2801 C*
2802 C*****     GENERATE INTEREST DATE ACCOUNT KEY
2803 C*
2804 C                   MOVE      'I'           AKY(3)
2805 C                   MOVEA     DLST          AKY(4)
2806 C                   MOVEA     '    '        AKY(6)
2807 C                   MOVE      'I'           AKY(10)
2808 C                   Z-ADD     NIPAR         KYDAT
2809 C                   Z-ADD     WRKTD         KYAMT                                         E1051
2810 C                   MOVE      PCCY          KYCCY
     C     *IN60         IFEQ      *ON                                                         CEU00
     C                   MOVE      STCYM         KYSCY                                         CEU00
     C                   ELSE                                                                  CEU00
     C                   MOVE      STCY          KYSCY                                         CEU00
     C                   ENDIF                                                                 CEU00
2713 C                   MOVE      PRFC          OPPRFC                                        S0111
2811 C   60              Z-ADD     SETP          KYSETL
2812 C   60              MOVE      OSAC          KYOSTL
2812 C   60              MOVE      OSBR          KYSTBR                                        S0111
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C     *IN60         ANDEQ     *ON
     C                   MOVE      'DA'          STINFO
     C                   ENDIF
      *                                                                                       CGL020
2813 C  N60              Z-ADD     MDST          KYSETL
2814 C  N60              MOVE      OMDA          KYOSTL
2812 C  N60              MOVE      ROBR          KYSTBR                                        S0111
2815 C*
2816 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
2817 C*
2818 C                   EXSR      FEDAT
2819 C*
2820 C                   Z-ADD     KYAMT         NRRSAL
2821 C                   SETON                                        71
2822 C                   EXSR      EXCP
      *                                                                                       CAS009
     C                   MOVE      'INTP'        WCFTP                                        CAS009
     C                   EXSR      SRMMCF                                                     CAS009
3166 C**
3167 C**   PURCHASED INTEREST KEY
3168 C**
3169 C   28              MOVE      'P'           AKY(10)
3170 C   28              Z-ADD     PINT          KYAMT
3171 C   28              EXSR      EXCP
3172 C**
3173 C**   INTEREST LESS PURCHASED PRICE
3174 C**
3175 C   28              MOVE      'R'           AKY(10)
3176 C   28              Z-ADD     WORKLI        KYAMT
3177 C   28              EXSR      EXCP
3178 C   28              Z-ADD     0             PINT
     C     CAS005        IFEQ      'Y'
     C     *IN28         ANDEQ     '1'
     C                   Z-ADD     0             FSPINN
     C                   ENDIF
2823 C*
2824 C*****     GENERATE ACCRUAL DATE ACCOUNT KEY.
2825 C*
2826 C                   MOVE      'A'           AKY(3)
2827 C  N28              MOVE      'A'           AKY(10)
     C   28              MOVE      'I'           AKY(10)
2828 C                   Z-ADD     WORKTP        KYAMT
2829 C                   EXSR      EXCP
2830 C*
2831 C*****     UPDATE DEALS RECORD
2832 C*
2833 C     IPRD          ADD       WRKTD         IPRD                                          E1051
2834 C     IPRM          ADD       WRKTD         IPRM                                          E1051
2835 C     AIPD          ADD       WORKTP        AIPD
3193 C     AIAP          ADD       AIAN          AIAP
3194 C                   Z-ADD     0             AIAN
     C   28
3195 CANN26              Z-ADD     NIPAR         NPADAT            5 0
     C   28
3196 CANN26              EXSR      NPACCR
2836 C                   Z-ADD     NIPAR         SLID
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     FSIPRN        ADD       WNTRD         FSIPRN
     C     FSIPMN        ADD       WNTRD         FSIPMN
     C     FSAIPN        ADD       WKNTRP        FSAIPN
     C     FSAIAN        ADD       FSAINN        FSAIAN
     C                   Z-ADD     0             FSAINN
     C                   ENDIF
     C*                                                                   CAC001
     C** If Analytical Accounting module is available, perform the        CAC001
     C** following calculations.                                          CAC001
     C*                                                                   CAC001
     C     BGN0ST        IFEQ      'Y'                                                         CAC00
     C     FPRC          ANDNE     *BLANKS                                                     CAC00
      *                                                                   CAC001
      ** Calculate COF Accrued not yet posted                             CAC001
      *                                                                   CAC001
     C                   Z-ADD     IACD          ZIBEG                                         CAC00
     C                   Z-ADD     NIPAR         ZIEND                                         CAC00
     C/COPY WNCPYSRC,DL0280C627
     C                   Z-ADD     FSRP          ZIRATE                         INT.           CAC00
     C/COPY WNCPYSRC,DL0280C628
     C                   Z-ADD     PAMT          ZIAMT                                         CAC00
     C                   Z-ADD     ICBS          ZICALC                         CALCULATED     CAC00
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C     WKINT         ADD       ACDA          WORKTD                         ACCRUED TO DATECAC00
     C                   ADD       ACAN          WORKTD                                        CAC00
     C                   ADD       ACAP          WORKTD                                        CAC00
     C     WORKTD        SUB       ACPD          WORKTP                         ACCRUED TO POSTCAC00
      *                                                                   CAC001
      ** Calculate Interim Interest Due                                   CAC001
      *                                                                   CAC001
     C                   Z-ADD     PAMT          ZIAMT                                         CAC00
     C/COPY WNCPYSRC,DL0280C629
     C                   Z-ADD     FSRP          ZIRATE                          INTEREST DUE  CAC00
     C/COPY WNCPYSRC,DL0280C630
      *                                                                   CAC001
     C                   EXSR      GLINTC                                                      CAC00
      *                                                                   CAC001
      ** To replace a line removed from the internally described GLINTC   CAC001
      *                                                                   CAC001
     C     *IN02         IFEQ      '1'                                                         CAC00
     C     ZIRDFC        ANDEQ     'Y'                                                         CAC00
     C     *IN03         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C     *IN04         OREQ      '1'                                                         CAC00
     C     JRDFC         ANDEQ     'Y'                                                         CAC00
     C                   Z-ADD     ZINTR         WKINT                                         CAC00
     C                   ELSE                                                                  CAC00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CAC00
     C                   END                                                                   CAC00
      *                                                                   CAC001
     C     WKINT         ADD       ACDA          WRKTD            13 0                         CAC00
     C                   ADD       ACAN          WRKTD                                         CAC00
     C                   ADD       ACAP          WRKTD                                         CAC00
     C                   SUB       COFD          WRKTD                                         CAC00
     C                   ADD       SPINT         WRKTD                                         CAC00
      *                                                                   CAC001
      ** For Negotiable Assets Purchased, set-up the following Interest   CAC001
      ** Due account keys using the new amounts.                          CAC001
      *                                                                   CAC001
      ** Cost of Fund Accrued not yet posted - Transaction Profit Centre  CAC001
      *                                                                   CAC001
     C                   MOVE      'A'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C     *IN28         IFEQ      '0'                                                         CAC00
     C                   MOVE      'A'           AKY(10)                                       CAC00
     C                   ELSE                                                                  CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   ENDIF                                                                 CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     WORKTP        KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Cost of Fund Accrued not yet posted - Funding Profit Centre      CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Interim Cost of Funds Due - Transaction Profit Centre            CAC001
      *                                                                   CAC001
     C                   MOVE      'I'           AKY(3)                                        CAC00
     C                   MOVEA     'T   '        AKY(6)                                        CAC00
     C                   MOVE      'I'           AKY(10)                                       CAC00
     C                   MOVE      PCCY          KYCCY                                         CAC00
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
     C                   Z-ADD     WRKTD         KYAMT                                         CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
      *                                                                   CAC001
      ** Interim Cost of Funds Due - Funding Profit Centre                CAC001
      *                                                                   CAC001
     C                   MOVEA     'F   '        AKY(6)                                        CAC00
     C                   MOVE      FPRC          OPPRFC                                        CAC00
     C                   EXSR      EXCP                                                        CAC00
     C                   MOVEA     '    '        AKY(6)                                        CAC00
     C                   MOVE      PRFC          OPPRFC                                        CAC00
      *                                                                   CAC001
      ** Update Deals File                                                CAC001
      *                                                                   CAC001
     C                   ADD       WRKTD         COFD                                          CAC00
     C                   ADD       WRKTD         COFM                                          CAC00
     C                   ADD       WORKTP        ACPD                                          CAC00
     C                   ADD       ACAN          ACAP                                          CAC00
     C                   Z-ADD     0             ACAN                                          CAC00
      *                                                                   CAC001
     C                   ENDIF                                                  - BGN0ST=Y     CAC00
2837 C                   BITOFF    '2'           CNFI
2838 C                   BITOFF    '2'           TLXI
     C/COPY WNCPYSRC,DL0280C631
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01093
     C                   MOVE      '1'           *IN15                                         S0109
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
2839 C                   ENDSR
2840 C*
2841 C********************************************************************
2842 C*
2843 C*****    NPACCR IS A SUBROUTINE TO HANDLE ACCRUAL DATE
     C*     PROCESSING FOR NEG.ASSETS PURCH. - NON-INT & INT.BEARING.
2845 C*
2846 C     NPACCR        BEGSR                                                  *** NPACCR ****
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP15                                           S01408
     C*                                                                   S01408
2847 C     MDAT          SUB       VDAT          DLDAYS            5 0           DEAL PERIOD
2848 C     NPADAT        SUB       VDAT          DYSTD             5 0           PERIOD
     C  N29
2849 CAN 17DYSTD         ADD       1             DYSTD                          TO DATE
2850 C     DISA          MULT      DYSTD         WORK15                          ACCRUED
2851 C     WORK15        DIV(H)    DLDAYS        WORK15
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP16                                           S01408
     C*                                                                   S01408
2852 C     WORK15        SUB       DPTD          WORKTP                          DISC.TO POST
     C                   IF        CAS009 = 'Y' AND FSAMRM = 'N' AND                          CAS009
     C                             FSACAI = 'Y'                                               CAS009
     C                   ELSE                                                                 CAS009
2853 C                   Z-ADD     WORK15        DPTD
     C     DISA          SUB       DPTD          DTP
     C                   ENDIF                                                                CAS009
2854 C*
2855 C*****    GENERATE AN ACCRUAL DATE ACCOUNT KEY.
2856 C*
2858 C                   MOVE      'A'           AKY(3)
2859 C                   MOVEA     DLST          AKY(4)
2860 C                   MOVEA     '    '        AKY(6)
2861 C                   MOVE      'D'           AKY(10)
     C   27
     CAN 28
     CAN 48              MOVE      'C'           AKY(10)
2862 C                   Z-ADD     WORKTP        KYAMT
     C   27
     CAN 28
     CAN 48              Z-SUB     WORKTP        KYAMT
2863 C                   Z-ADD     NPADAT        KYDAT
2864 C                   MOVE      PCCY          KYCCY
     C                   MOVE      STCY          KYSCY                                         CEU00
2865 C                   Z-ADD     MDST          KYSETL
2866 C                   MOVE      OMDA          KYOSTL
2812 C                   MOVE      ROBR          KYSTBR                                        S0111
2812 C                   MOVE      PRFC          OPPRFC                                        S0111
2867 C*
2868 C*****    CALCULATE THE FEDERAL FUND VALUE DATE
2869 C*
2870 C                   EXSR      FEDAT
2871 C*
     C   49
2872 CAN 17              Z-ADD     KYAMT         NRRSAL
     C                   MOVE      'Y'           SPRIND                                       CAS009
2874 C                   EXSR      EXCP
2875 C                   ENDSR
2876 C*
2877 C********************************************************************
     C/EJECT                                                              S01119
2877 C********************************************************************S01119
     C* S/R FRARVS                                                        S01119
     C* CALLED FROM MAIN PROCESSING                                       S01119
     C* CALLS EXCP; EXCPTN                                                S01119
     C*                                                                   S01119
     C* TO PROCESS FRA/IRS DEAL REVERSALS                                 S01119
     C*                                                                   S01119
2877 C********************************************************************S01119
     C*                                                                   S01119
     C     FRARVS        BEGSR                                                  ** FRARVS BSR *S0111
      *                                                                                       229628
      ** Check rate fix indicator                                                             229628
      *                                                                                       229628
     C     CSW005        IFEQ      'Y'                                                        229628
     C     CSW011        OREQ      'Y'                                                        229628
     C     UINFD         IFGE      EVCD                                                       229628
     C     UBRTT         ANDNE     0                                                          229628
     C     URFIN         ANDNE     *BLANK                                                     229628
     C                   MOVE      *BLANK        URFIN                                        229628
     C                   MOVE      '1'           *IN15                                        229628
     C                   ENDIF                                                                229628
     C     TINFD         IFGE      EVCD                                                       229628
     C     TBRTT         ANDNE     0                                                          229628
     C     TRFIN         ANDNE     *BLANK                                                     229628
     C                   MOVE      *BLANK        TRFIN                                        229628
     C                   MOVE      '1'           *IN15                                        229628
     C                   ENDIF                                                                229628
     C                   ENDIF                                                                229628
     C*                                                                   S01119
     C* SET UP PROFIT CENTRE REGARDLESS OF EVENT TYPE                     LN0711
     C                   MOVEL     PRFC          OPPRFC                                        LN071
     C*                                                                   LN0711
     C****  DEAL DATE                                                     S01119
     C*                                                                   S01119
     C**RL*DEAL*TYPE*OUTPUT*FIELDS*FOR*REPORT*********                    S01119
     C* RR, RF AND RP DEAL TYPES OUTPUT FIELDS FOR REPORT                 S01119
     C*                                                                   S01119
     C     DTYP          IFEQ      'RR'                                                        S0115
     C     DTYP          OREQ      'RP'                                                        S0115
     C     DTYP          OREQ      'RF'                                                        S0115
     C                   MOVE      ' '           AVERRT            1                           S0111
     C                   MOVE      ' '           USRST             1                           S0111
     C                   MOVE      ' '           FLRRTF            1                           S0111
     C* FLOOR RATE                                                        S01119
     C                   TESTB     '4'           UDSTI                    31                   S0111
     C   31              MOVE      'Y'           FLRRTF                                        S0111
     C                   TESTB     '4'           TDSTI                    31                   S0111
     C   31              MOVE      'Y'           FLRRTF                                        S0111
     C* STATUS OF USER/AVERAGE RATE                                       S01119
     C     UBRTT         IFNE      0                                                           S0111
     C                   TESTB     '3'           UDSTI                    31                   S0111
     C   31              MOVE      'Y'           AVERRT                                        S0111
     C   31              Z-ADD     AACRT         RLRT                                          S0111
     C                   MOVE      'P'           USRST                                         S0111
     C                   MOVE      UBRTT         RLBRT             2                           S0111
     C  N31              Z-ADD     UEINR         RLRT             11 7                         S0111
     C                   ELSE                                                                  S0111
     C                   TESTB     '3'           TDSTI                    31                   S0111
     C   31              MOVE      'Y'           AVERRT                                        S0111
     C   31              Z-ADD     AACRT         RLRT                                          S0111
     C                   MOVE      'T'           USRST                                         S0111
     C                   MOVE      TBRTT         RLBRT                                         S0111
     C  N31              Z-ADD     TEINR         RLRT                                          S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   TESTB     '0'           ACEI                     31                   S0111
     C     *IN31         IFEQ      '1'                                                         S0111
     C                   Z-ADD     DDAT          KYDAT                                         S0111
     C                   Z-ADD     DDAT          KYFED                                         S0111
     C     DTYP          IFEQ      'RX'                                                        S0111
     C*                                                                   S01119
     C*****    DEAL DATE RX REVERSAL, OUR PRINCIPAL                       S01119
     C*                                                                   S01119
     C                   TESTB     '2'           UDSTI                    61                   S0111
     C                   MOVEA     'RXD'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   OA'       AKY(6)                                        S0111
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
0764 C                   SETOFF                                       4546                     S0111
0765 C     UDECP         COMP      1                                    4344                   S0111
     C  N43
0766 CANN44UDECP         COMP      3                                    4546                   S0111
     C                   SETON                                        71                       S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C*****    DEAL DATE RX REVERSAL, THEIR PRINCIPAL                     S01119
     C*                                                                   S01119
     C                   TESTB     '2'           TDSTI                    61                   S0111
     C                   MOVE      'T'           AKY(9)                                        S0111
     C                   Z-ADD     TPAMT         KYAMT                                         S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     TPAMT         NRRPUR                                        S0111
0764 C                   SETOFF                                       4546                     S0111
0765 C     TDECP         COMP      1                                    4344                   S0111
     C  N43
0766 CANN44TDECP         COMP      3                                    4546                   S0111
     C                   EXCEPT    RXTHRS                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C*****    DEAL DATE RX REVERSAL, THEIR EXPOSURE                      S01119
     C*                                                                   S01119
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   Z-ADD     TAEXA         KYAMT                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C*****    DEAL DATE RX REVERSAL, OUR EXPOSURE                        S01119
     C*                                                                   S01119
     C                   MOVE      'O'           AKY(9)                                        S0111
     C                   Z-ADD     UAEXA         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C*****    OTHER DEAL TYPES, OUR PRINCIPAL                            S01119
     C*                                                                   S01119
     C                   ELSE                                                                  S0111
     C/COPY WNCPYSRC,DL0280C084
     C                   MOVE      DTYP          AKY(1)                                        S0111
     C                   MOVE      'D'           AKY(3)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    A'       AKY(6)                                        S0111
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C*                                                                   S01119
     C*********REPORT*LINE*SETUP**-**RL*REQUIRES*THREE*LINES*OF*DA S01119 S01157
     C*****  REPORT LINE SETUP - RR/RP/RF REQUIRES THREE LINES OF DATA    S01157
     C*                                                                   S01119
     C     DTYP          IFEQ      'RR'                                                        S0115
     C     DTYP          OREQ      'RP'                                                        S0115
     C     DTYP          OREQ      'RF'                                                        S0115
     C                   EXSR      EXCP                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   Z-ADD     CLRAT         FINTR                                         S0111
     C                   Z-ADD     CLRAT         NRRT                                          S0111
     C*                                                                   S01157
     C** IF FLOOR THEN SET *IN31 ON TO SUPPRESS CEILING RATE              S01157
     C*                                                                   S01157
     C     DTYP          IFEQ      'RF'                                                        S0115
     C                   SETON                                        31                       S0115
     C                   ELSE                                                                  S0115
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0115
     C*                                                                   S01157
     C                   Z-ADD     UPAMT         NRRPUR                                        S0111
     C                   MOVE      'Y'           PRONLY                                        S0111
     C                   SETON                                        71                       S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     RLRT          NRRT                                          S0111
     C                   MOVE      RLBRT         NRBRTT                                        S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C     DTYP          OREQ      'RF'                                                        S0115
     C                   EXCEPT    FLOOR                                                       S0111
     C                   ADD       1             PLINES                                        LN088
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C* NON-RR/RP/RF                                                      S01157
     C*                                                                   S01119
     C                   TESTB     '0'           UDNSI                31                       S0111
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   SETON                                        71                       S0111
     C                   EXSR      EXCP                                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*****    OTHER DEAL TYPES, OUR EXPOSURE                             S01119
     C*                                                                   S01119
     C                   MOVEA     '    E'       AKY(6)                                        S0111
     C                   Z-ADD     UAEXA         KYAMT                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C/COPY WNCPYSRC,DL0280C085
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C**  DEAL DATE UP-FRONT FEE/PREMIUM REVERSAL                         CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UPVD          ANDNE     0                                                           CIR00
     C*                                                                   CIR001
     C     DTYP          IFEQ      'RS'                                                        CIR00
     C     DTYP          OREQ      'RX'                                                        CIR00
     C     DTYP          OREQ      'RR'                                                        CIR00
     C     DTYP          OREQ      'RP'                                                        CIR00
     C     DTYP          OREQ      'RF'                                                        CIR00
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'D'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVEA     UPPR          AKY(9)                                        CIR00
     C                   Z-ADD     UPFE          KYAMT                                         CIR00
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C086
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C087
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C088
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C066
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C067
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** WRITE REVERSAL ACCOUNT KEY FOR UP-FRONT FEE/PREMIUM              CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C** DEAL DATE BUY-OUT REVERSAL                                       CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '4'           ACEI                     31                   CIR00
     C     *IN31         IFEQ      '1'                                                         CIR00
     C*                                                                   CIR001
     C     DTYP          IFEQ      'RS'                                                        CIR00
     C     DTYP          OREQ      'RX'                                                        CIR00
     C     DTYP          OREQ      'RP'                                                        CIR00
     C     CIR006        ANDEQ     'Y'                                                         CIR00
     C     DTYP          OREQ      'RR'                                                        CIR00
     C     CIR006        ANDEQ     'Y'                                                         CIR00
     C     DTYP          OREQ      'RF'                                                        CIR00
     C     CIR006        ANDEQ     'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   Z-ADD     BODD          KYDAT                                         CIR00
     C                   Z-ADD     BODD          KYFED                                         CIR00
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'D'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    B'       AKY(6)                                        CIR00
     C                   MOVEA     BAPR          AKY(9)                                        CIR00
     C                   Z-ADD     BOAM          KYAMT                                         CIR00
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C068
     C     BAPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C069
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C070
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C     BAPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C071
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C072
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** WRITE ACCOUNT KEY FOR DEAL DATE BUY-OUT REVERSAL                 CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*****    DEAL TYPE FR - VALUE DATE ENTRIES TO BE CHECKED            S01119
     C*                                                                   S01119
     C     DTYP          IFEQ      'FR'                                                        S0111
     C                   TESTB     '1'           ACEI                     31                   S0111
     C     *IN31         IFEQ      '1'                                                         S0111
     C                   Z-ADD     VDAT          KYDAT                                         S0111
     C                   Z-ADD     VDAT          KYFED                                         S0111
     C*                                                                   S01119
     C*****    VALUE DATE REVERSAL, FR - PRINCIPAL                        S01119
     C*                                                                   S01119
     C                   MOVEA     'FRV'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    A'       AKY(6)                                        S0111
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C*                                                                   S01119
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C*****    VALUE DATE REVERSAL, FR - EXPOSURE                         S01119
     C*                                                                   S01119
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   Z-ADD     UAEXA         KYAMT                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C481
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RX'                                                        CIR00
     C     VDEI          ANDEQ     'Y'                                                       BUG7688
      *                                                                   CIR003
     C                   TESTB     '1'           ACEI                     31                   CIR00
      *                                                                   CIR003
     C     *IN31         IFEQ      '1'                                                         CIR00
      *                                                                                      BUG7312
     C                   MOVEL     'VAL'         KEDCD             3                         BUG7312
     C                   MOVE      *IN87         WIN87                                       BUG7312
     C     WDLKEY        CHAIN     DLGXSTL0                           87        BUG7312
     C     *IN87         IFEQ      '1'                                                       BUG7312
     C                   MOVEL     DLNO          WKEY              9                         BUG7312
     C                   MOVE      KEDCD         WKEY                                        BUG7312
     C                   MOVEL     'DLGXSTL0'    DBFILE                                      BUG7312
     C                   MOVEL     '3?'          DBASE                                       BUG7312
     C                   MOVEL     WKEY          DBKEY                                       BUG7312
     C                   SETON                                        U7U8LR                 BUG7312
     C                   EXSR      *PSSR                                                     BUG7312
     C                   GOTO      EOJ                                                       BUG7312
     C                   ENDIF                                                               BUG7312
     C                   MOVEL     UFRDKY        FRDKY                                       BUG7688
     C                   MOVE      WIN87         *IN87                                       BUG7312
     C                   MOVEL     UCUCY         KYCCY                                       BUG7312
     C                   Z-ADD     RXRSTM        KYSETL                                      BUG7312
     C                   MOVEL     RXRONS        KYOSTL                                      BUG7312
     C                   MOVEL     RXROBR        KYSTBR                                      BUG7312
     C                   MOVEL     RXRSCY        KYSCY                                       BUG7312
      *                                                                   CIR003
     C                   Z-ADD     VDAT          KYDAT                                         CIR00
     C                   Z-ADD     VDAT          KYFED                                         CIR00
      *                                                                   CIR003
      ** Principal key for OUR side                                       CIR003
      *                                                                   CIR003
     C                   TESTB     '2'           UDSTI                    61                   CIR00
     C                   MOVEA     'RXV'         AKY(1)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '   OA'       AKY(6)                                        CIR00
      *                                                                   CIR003
     C     UCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   MOVE      'B'           AKY(8)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   Z-ADD     UPAMT         KYAMT                                         CIR00
     C**********         MOVEL     UFRDKY        FRDKY                               BUG7045 BUG7688
     C                   TESTB     '0'           UDNSI                    31                   CIR00
     C     NRBRTT        IFEQ      '00'                                                        CIR00
     C                   MOVE      *BLANKS       NRBRTT                                        CIR00
     C                   MOVE      '0'           *IN31                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   MOVEA     '0000'        *IN(43)                                       CIR00
      *                                                                   CIR003
     C                   SELECT                                                                CIR00
     C     UDECP         WHENEQ    0                                                           CIR00
     C                   MOVE      '1'           *IN43                                         CIR00
     C     UDECP         WHENEQ    1                                                           CIR00
     C                   MOVE      '1'           *IN44                                         CIR00
     C     UDECP         WHENEQ    2                                                           CIR00
     C                   MOVE      '1'           *IN45                                         CIR00
     C     UDECP         WHENEQ    3                                                           CIR00
     C                   MOVE      '1'           *IN46                                         CIR00
     C                   ENDSL                                                                 CIR00
     C                   MOVE      '1'           *IN71                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   MOVE      *BLANK        AKY(8)                                        CIR00
      *                                                                   CIR003
      ** Principal key for OUR side (Base Currency Equivalent)            CIR003
      *                                                                   CIR003
     C     UCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   Z-ADD     UPAMT         KYAMT                                         CIR00
     C                   ELSE                                                                  CIR00
      *                                                                   CIR003
     C                   MOVE      *IN87         WIN87                                         CIR00
     C                   Z-ADD     1             I                                             CIR00
     C     UCUCY         LOOKUP    CY(I)                                  87                   CIR00
     C     *IN87         IFEQ      '0'                                                         CIR00
     C                   MOVEL     'TABTG30 '    DBFILE                          ************  CIR00
     C                   MOVEL     '28'          DBASE                           *DBERROR 28*  CIR00
     C                   MOVEL     UCUCY         DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     CYD(I)        CYDDS                                         CIR00
     C                   Z-ADD     UPAMT         ZAMTCI                                        CIR00
     C                   Z-ADD     UBCXR         ZEXCH                                         CIR00
     C                   Z-ADD     UDECP         ZCDPI                                         CIR00
     C                   Z-ADD     BCDP          ZCDPO                                         CIR00
      *                                                                   CIR003
     C     MDIN          IFEQ      1                                                           CIR00
     C                   MOVE      'M'           ZMD
     C                   ELSE                                                                  CIR00
     C                   MOVE      'D'           ZMD
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      ZCONV                                                       CIR00
     C                   Z-ADD     ZAMTCO        KYAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVEA     UCUCY         AKY(6)                                        CIR00
     C                   MOVEL     BJCYCD        KYCCY                                       BUG7045
     C                   Z-ADD     0             KYSETL                                      BUG7688
     C                   MOVEL     *BLANKS       KYOSTL                                      BUG7688
     C                   MOVE      '1'           *IN71                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   MOVEA     *BLANKS       AKY(6)                                        CIR00
      *                                                                   CIR003
      ** Principal key for THEIR side                                     CIR003
      *                                                                   CIR003
     C                   TESTB     '2'           TDSTI                    61                   CIR00
     C                   MOVE      'T'           AKY(9)                                        CIR00
     C                   MOVE      'A'           AKY(10)
     C     TCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   MOVE      'B'           AKY(8)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   Z-ADD     TPAMT         KYAMT                                         CIR00
     C                   MOVEL     TFRDKY        FRDKY                                         CIR00
     C                   MOVEL     TCUCY         KYCCY                                       BUG7312
     C                   Z-ADD     RXPSTM        KYSETL                                      BUG7312
     C                   MOVEL     RXPONS        KYOSTL                                      BUG7312
     C                   MOVEL     RXPOBR        KYSTBR                                      BUG7312
     C                   MOVEL     RXPSCY        KYSCY                                       BUG7312
      *                                                                                      BUG7312
     C                   TESTB     '0'           TDNSI                31                       CIR00
      *                                                                   CIR003
     C     NRBRTT        IFEQ      '00'                                                        CIR00
     C                   MOVEL     *BLANKS       NRBRTT                                        CIR00
     C                   MOVE      '0'           *IN31                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVEA     '0000'        *IN(43)                                       CIR00
      *                                                                   CIR003
     C                   SELECT                                                                CIR00
     C     TDECP         WHENEQ    0                                                           CIR00
     C                   MOVE      '1'           *IN43                                         CIR00
     C     TDECP         WHENEQ    1                                                           CIR00
     C                   MOVE      '1'           *IN44                                         CIR00
     C     TDECP         WHENEQ    2                                                           CIR00
     C                   MOVE      '1'           *IN45                                         CIR00
     C     TDECP         WHENEQ    3                                                           CIR00
     C                   MOVE      '1'           *IN46                                         CIR00
     C                   ENDSL                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      '1'           *IN71                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   Z-ADD     TPAMT         NRRPUR                                        CIR00
     C                   EXCEPT    RXTHRS                                                      CIR00
     C                   ADD       1             PLINES                                        CIR00
      *                                                                   CIR003
      ** Principal key for THEIR side (Base Currency Equivalent)          CIR003
      *                                                                   CIR003
     C     TCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   Z-ADD     TPAMT         KYAMT                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      *IN87         WIN87             1                           CIR00
     C                   Z-ADD     1             I                                             CIR00
     C     TCUCY         LOOKUP    CY(I)                                  87                   CIR00
     C     *IN87         IFEQ      '0'                                                         CIR00
     C                   MOVEL     'TABTG30 '    DBFILE                          ************  CIR00
     C                   MOVEL     '29'          DBASE                           *DBERROR 29*  CIR00
     C                   MOVEL     TCUCY         DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     CYD(I)        CYDDS                                         CIR00
     C                   Z-ADD     TPAMT         ZAMTCI                                        CIR00
     C                   Z-ADD     TBCXR         ZEXCH                                         CIR00
     C                   Z-ADD     TDECP         ZCDPI                                         CIR00
     C                   Z-ADD     BCDP          ZCDPO                                         CIR00
      *                                                                   CIR003
     C     MDIN          IFEQ      1                                                           CIR00
     C                   MOVE      'M'           ZMD
     C                   ELSE                                                                  CIR00
     C                   MOVE      'D'           ZMD
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      ZCONV                                                       CIR00
     C                   Z-ADD     ZAMTCO        KYAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   MOVEA     TCUCY         AKY(6)                                        CIR00
     C                   MOVEL     BJCYCD        KYCCY                                       BUG7045
     C                   Z-ADD     0             KYSETL                                      BUG7688
     C                   MOVEL     *BLANKS       KYOSTL                                      BUG7688
     C                   MOVE      '1'           *IN71                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   MOVEA     *BLANKS       AKY(1)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C** VALUE DATE UP-FRONT FEE/PREMIUM REVERSAL                         CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '3'           ACEI                     31                   CIR00
     C*                                                                   CIR001
     C     *IN31         IFEQ      *ON                                                         CIR00
     C*                                                                   CIR001
     C     DTYP          IFEQ      'RS'                                                        CIR00
     C     DTYP          OREQ      'RX'                                                        CIR00
     C     DTYP          OREQ      'RR'                                                        CIR00
     C     DTYP          OREQ      'RP'                                                        CIR00
     C     DTYP          OREQ      'RF'                                                        CIR00
     C*                                                                   CIR001
     C                   Z-ADD     UPVD          KYDAT                                         CIR00
     C                   Z-ADD     UPVD          KYFED                                         CIR00
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'V'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVEA     UPPR          AKY(9)                                        CIR00
     C*                                                                   CIR001
     C                   Z-ADD     UPFE          KYAMT                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'F'           F1FFLG
     C                   Z-ADD     UPFE          F1FVAL
     C                   Z-ADD     100           F1FPCT
     C                   ENDIF
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C073
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C074
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C075
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C076
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C077
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C* SETUP REPORT FIELDS                                               CIR001
     C                   Z-ADD     UPFE          NRRPUR                                        CIR00
     C                   MOVE      '  '          NRBRTT                                        CIR00
     C* WRITE UP-FRONT FEE/PREMIUM REVERSAL ACCOUNT KEY                   CIR001
     C                   SETON                                        7131                     CIR00
     C                   EXSR      EXCP                                                        CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*****    INTEREST KEYS - OURS                                       S01119
     C*                                                                   S01119
     C     UIPRD         IFNE      0                                                           S0111
     C                   MOVEA     DTYP          AKY(1)                                        S0111
     C     DTYP          IFNE      'FR'                                                        S0111
     C                   Z-ADD     USLIP         KYDAT                                         S0111
     C                   Z-ADD     USLIP         KYFED                                         S0111
     C                   MOVE      'I'           AKY(3)                                        S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     VDAT          KYDAT                                         S0111
     C                   Z-ADD     VDAT          KYFED                                         S0111
     C                   MOVE      'V'           AKY(3)                                        S0111
     C                   END                                                                   S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   PI'       AKY(6)                                        S0111
     C*                                                                   CIR001
     C** Use key "xxIyy___zC" if interest is capitalised.                 CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RS'                                                        CIR00
     C     UINPM         ANDEQ     'C'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RX'                                                        CIR00
     C     UINPM         ANDEQ     'C'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RP'                                                        CIR00
     C     UINPM         ANDEQ     'C'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RR'                                                        CIR00
     C     UINPM         ANDEQ     'C'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RF'                                                        CIR00
     C     UINPM         ANDEQ     'C'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RS'                                                        CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RX'                                                        CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RP'                                                        CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RR'                                                        CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RF'                                                        CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C                   MOVEA     '   PC'       AKY(6)                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** Do not produce interest key if processing method = "K"           CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RS'                                                        CIR00
     C     UINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RX'                                                        CIR00
     C     UINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDNE     'RS'                                                        CIR00
     C     DTYP          ANDNE     'RX'                                                        CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RS'                                                        CIR00
     C     UINPM         ANDNE     'I'                                                         CIR00
     C     UINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RX'                                                        CIR00
     C     UINPM         ANDNE     'I'                                                         CIR00
     C     UINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RP'                                                        CIR00
     C     UINPM         ANDNE     'I'                                                         CIR00
     C     UINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RR'                                                        CIR00
     C     UINPM         ANDNE     'I'                                                         CIR00
     C     UINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RF'                                                        CIR00
     C     UINPM         ANDNE     'I'                                                         CIR00
     C     UINPM         ANDNE     'K'                                                         CIR00
     C     CIR001        OREQ      'N'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C*                                                                   CIR001
     C                   Z-ADD     UIPRD         KYAMT                                         S0111
     C                   Z-ADD     UIPRD         SAL              13 0                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*****    TAX KEY                                                    S01119
     C*                                                                   S01119
     C     UTAXD         IFNE      0                                                           S0111
     C/COPY WNCPYSRC,DL0280C465
     C     *IN19         ANDEQ     *ON                                                         08060
     C/COPY WNCPYSRC,DL0280C466
     C     TAXI          ANDEQ     'Y'                                                         03187
     C                   MOVE      'T'           AKY(10)                                       S0111
     C                   Z-ADD     UTAXD         KYAMT                                         S0111
     C                   Z-ADD     UTAXD         TAXA                                          S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     UIPRD         WORKD                                         S0111
     C                   Z-ADD     USLIP         SLIDD                                         S0111
     C                   EXSR      EXCPTN                                                      S0111
     C*                                                                   S01119
     C*****    NET SETTLEMENT KEYS - RX,FR                                S01119
     C*                                                                   S01119
     C     DTYP          IFEQ      'RX'                                                        S0111
     C     DTYP          OREQ      'FR'                                                        S0111
     C     UIPRD         SUB       UTAXD         KYAMT                                         S0111
     C                   Z-ADD     KYAMT         SAL                                           S0111
     C                   MOVE      'N'           AKY(10)                                       03187
     C                   EXSR      EXCP                                                        03187
     C                   END                                                                   03187
     C*                                                                   031872
     C                   END                                                                   03187
     C*                                                                   S01119
     C*****    NET SETTLEMENT KEYS - RR,RP,RF,RS                          S01157
     C*                                                                   S01119
     C     DTYP          IFEQ      'RS'                                                        03187
     C     DTYP          OREQ      'RP'                                                        03187
     C     DTYP          OREQ      'RR'                                                        03187
     C     DTYP          OREQ      'RF'                                                        03187
     C                   Z-ADD     UNSAM         KYAMT                                         S0111
     C     UIPRD         SUB       UTAXD         SAL                                           S0111
     C                   MOVE      'N'           AKY(10)                                       S0111
     C                   EXSR      EXCP                                                        S0111
     C                   END                                                                   03187
     C*                                                                   031872
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* PRINT REPORT LINE                                                 S01119
     C*                                                                   S01119
     C     UIPRD         IFNE      0                                                           S0111
     C     DTYP          OREQ      'FR'                                                        S0111
     C     DTYP          OREQ      'RR'                                                        S0115
     C     TIPRD         ANDNE     0                                                           S0111
     C     DTYP          OREQ      'RP'                                                        S0115
     C     TIPRD         ANDNE     0                                                           S0115
     C     DTYP          OREQ      'RF'                                                        S0115
     C     TIPRD         ANDNE     0                                                           S0115
     C                   TESTB     '0'           UDNSI                31                       S0111
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   Z-ADD     SAL           NRRSAL                                        S0111
     C                   Z-ADD     UPAMT         NRRPUR                                        S0111
0764 C                   SETOFF                                       4546                     S0111
0765 C     UDECP         COMP      1                                    4344                   S0111
     C  N43
0766 CANN44UDECP         COMP      3                                    4546                   S0111
     C*                                                                   S01119
     C***IF*DEAL*TYPE**IS*RL,*THEIR*INTEREST*MAY*BE*PRINTED*ON*FIR S01119 S01157
     C* IF DTYP IS RR/RP/RF THEIR INTEREST MAY BE PRINTED ON FIRST LINE   S01157
     C*                                                                   S01119
     C     DTYP          IFEQ      'RR'                                                        S0115
     C     DTYP          OREQ      'RP'                                                        S0115
     C     DTYP          OREQ      'RF'                                                        S0115
     C                   Z-ADD     CLRAT         FINTR                                         S0111
     C                   Z-ADD     CLRAT         NRRT                                          S0111
     C                   SETOFF                                       31                       S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C     UBRTT         IFNE      0                                                           S0111
     C                   Z-ADD     USLIP         KYDAT                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TSLIP         KYDAT                                         S0111
     C                   END                                                                   S0111
     C     USRST         IFEQ      'T'                                                         S0111
     C                   Z-ADD     TIPRD         NRRSAL                                        S0111
     C                   Z-ADD     TTAXD         TAXA                                          S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     UIPRD         NRRSAL                                        S0111
     C                   Z-ADD     UTAXD         TAXA                                          S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C                   SETON                                        71                       S0111
     C                   MOVE      'Y'           PRONLY                                        S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     0             TAXA                                          S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  RR/RP/RF MIDDLE LINE                                             S01157
     C*                                                                   S01119
     C     DTYP          IFEQ      'RR'                                                        S0115
     C     DTYP          OREQ      'RP'                                                        S0115
     C     DTYP          OREQ      'RF'                                                        S0115
     C     UIPRD         IFNE      0                                                           S0111
     C     TIPRD         ORNE      0                                                           S0111
     C                   MOVE      RLBRT         NRBRTT                                        S0111
     C                   Z-ADD     RLRT          NRRT                                          S0111
     C                   SETOFF                                       31                       S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*****    INTEREST KEYS - THEIRS                                     S01119
     C*                                                                   S01119
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C     TIPRD         IFNE      0                                                           S0111
     C                   MOVEA     DTYP          AKY(1)                                        S0111
     C     DTYP          IFNE      'FR'                                                        S0111
     C                   Z-ADD     TSLIP         KYDAT                                         S0111
     C                   Z-ADD     TSLIP         KYFED                                         S0111
     C                   MOVE      'I'           AKY(3)                                        S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     VDAT          KYDAT                                         S0111
     C                   Z-ADD     VDAT          KYFED                                         S0111
     C                   MOVE      'V'           AKY(3)                                        S0111
     C                   END                                                                   S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   RI'       AKY(6)                                        S0111
     C*                                                                   CIR001
     C** Use key "xxIyy___zC" if interest is capitalised.                 CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RS'                                                        CIR00
     C     TINPM         ANDEQ     'C'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RX'                                                        CIR00
     C     TINPM         ANDEQ     'C'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RP'                                                        CIR00
     C     TINPM         ANDEQ     'C'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RR'                                                        CIR00
     C     TINPM         ANDEQ     'C'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RF'                                                        CIR00
     C     TINPM         ANDEQ     'C'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RS'                                                        CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RX'                                                        CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RP'                                                        CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RR'                                                        CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RF'                                                        CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C                   MOVEA     '   PC'       AKY(6)                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** Do not produce interest key if processing method = "K"           CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RS'                                                        CIR00
     C     TINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RX'                                                        CIR00
     C     TINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDNE     'RS'                                                        CIR00
     C     DTYP          ANDNE     'RX'                                                        CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RS'                                                        CIR00
     C     TINPM         ANDNE     'I'                                                         CIR00
     C     TINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RX'                                                        CIR00
     C     TINPM         ANDNE     'I'                                                         CIR00
     C     TINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RP'                                                        CIR00
     C     TINPM         ANDNE     'I'                                                         CIR00
     C     TINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RR'                                                        CIR00
     C     TINPM         ANDNE     'I'                                                         CIR00
     C     TINPM         ANDNE     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     DTYP          ANDEQ     'RF'                                                        CIR00
     C     TINPM         ANDNE     'I'                                                         CIR00
     C     TINPM         ANDNE     'K'                                                         CIR00
     C     CIR001        OREQ      'N'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C*                                                                   CIR001
     C                   Z-ADD     TIPRD         KYAMT                                         S0111
     C                   Z-ADD     TIPRD         SAL                                           S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C**       NET SETTLEMENT KEYS - RS,RR,RP,RF                          S01157
     C*                                                                   S01119
     C     DTYP          IFEQ      'RS'                                                        S0111
     C     DTYP          OREQ      'RR'                                                        S0115
     C     DTYP          OREQ      'RP'                                                        S0115
     C     DTYP          OREQ      'RF'                                                        S0115
     C                   MOVE      'N'           AKY(10)                                       S0111
     C                   Z-ADD     TNSAM         KYAMT                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* PRINT REPORT LINE                                                 S01119
     C*                                                                   S01119
     C     TIPRD         IFNE      0                                                           S0111
     C     DTYP          OREQ      'FR'                                                        S0111
     C     DTYP          OREQ      'RR'                                                        S0115
     C     UIPRD         ANDNE     0                                                           S0115
     C     DTYP          OREQ      'RP'                                                        S0115
     C     UIPRD         ANDNE     0                                                           S0115
     C     DTYP          OREQ      'RF'                                                        S0115
     C     UIPRD         ANDNE     0                                                           S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   Z-ADD     TPAMT         NRRPUR                                        S0111
     C                   Z-ADD     SAL           NRRSAL                                        S0111
     C     DTYP          IFNE      'RR'                                                        S0115
     C     DTYP          ANDNE     'RP'                                                        S0115
     C     DTYP          ANDNE     'RF'                                                        S0115
     C*                                                                   S01119
     C     DTYP          IFEQ      'FR'                                                        S0111
     C     AKY(9)        IFEQ      'P'                                          **             S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C                   ELSE                                                                  S0111
     C   43              SETON                                        73                       S0111
     C   44              SETON                                        74                       S0111
     C   45              SETON                                        75                       S0111
     C   46              SETON                                        76                       S0111
     C                   EXCEPT    FITHR2                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C                   MOVEA     '0000'        *IN(73)                                       S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
0764 C                   SETOFF                                       4546                     S0111
0765 C     TDECP         COMP      1                                    4344                   S0111
     C  N43
0766 CANN44TDECP         COMP      3                                    4546                   S0111
     C                   SETON                                        71                       S0111
     C                   MOVE      'Y'           PRONLY                                        S0111
     C                   EXSR      EXCP                                                        S0111
     C                   END                                                                   S0111
     C                   END                                                    *              S0111
     C*                                                                   S01119
     C*  IF DTYP IS RR/RP/RF OUR INTEREST MAY BE PRINTED ON LAST LINE     S01157
     C*                                                                   S01119
     C     DTYP          IFEQ      'RR'                                                        S0115
     C     FLRRTF        ANDEQ     'Y'                                                         S0111
     C     DTYP          OREQ      'RP'                                                        S0115
     C     FLRRTF        ANDEQ     'Y'                                                         S0115
     C     DTYP          OREQ      'RF'                                                        S0115
     C                   Z-ADD     FLRAT         NRRT                                          S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C     USRST         IFEQ      'P'                                                         E2340
     C                   Z-ADD     TIPRD         NRRSAL                                        S0111
     C                   Z-ADD     TTAXD         TAXA                                          S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     UIPRD         NRRSAL                                        S0111
     C                   Z-ADD     UTAXD         TAXA                                          S0111
     C                   END                                                                   S0111
     C                   SETOFF                                       31                       S0111
     C                   EXCEPT    FITHR2                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C                   Z-ADD     0             TAXA                                          S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C******   ACCRUAL KEYS - OURS                                        S01119
     C*                                                                   S01119
     C     UAIPD         IFNE      0                                                           S0111
     C                   Z-ADD     BKAPDT        KYDAT                                         07778
     C                   Z-ADD     BJRDNB        KYFED                                         S0119
     C                   MOVEA     DTYP          AKY(1)                                        S0111
     C                   MOVE      'A'           AKY(3)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   PA'       AKY(6)                                        S0111
     C                   Z-ADD     UAIPD         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C******   ACCRUAL KEYS THEIRS                                        S01119
     C*                                                                   S01119
     C     TAIPD         IFNE      0                                                           S0111
     C                   Z-ADD     BKAPDT        KYDAT                                         07778
     C                   Z-ADD     BJRDNB        KYFED                                         S0119
     C                   MOVEA     DTYP          AKY(1)                                        S0111
     C                   MOVE      'A'           AKY(3)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   RA'       AKY(6)                                        S0111
     C                   Z-ADD     TAIPD         KYAMT                                         S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C                   END                                                                   S0111
     C                   Z-ADD     0             NRRPUR                                        S0111
     C                   Z-ADD     0             NRRSAL                                        S0111
     C*                                                                   CIR001
     C** ACCRUAL KEYS - UP-FRONT FESS/PREMIUMS                            CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UPAD          ANDNE     *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVE      UPPR          AKY(9)                                        CIR00
     C                   Z-ADD     UPAD          KYAMT                                         CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C090
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C091
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C092
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C093
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   Z-ADD     *ZEROS        KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
     C*                                                                   CIR001
     C** WRITE REVERSAL ACCRUAL KEY                                       CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01328
     C** IF UNREALIZED PROFIT/LOSS POSTED IS NOT ZERO, THEN REVERSE IT    S01328
     C*                                                                   S01328
     C     UNRLP         IFNE      *ZERO                                                       S0132
     C*                                                                   S01328
     C** SET THE UNREALIZED P/L TO ZERO (REVERSAL POSTING ONLY REQUIRED)  S01328
     C*                                                                   S01328
     C     CAS004        IFEQ      'N'
     C                   Z-ADD     *ZERO         UNRL                                          S0132
     C*                                                                   S01328
     C** GENERATE UNREALIZED P/L A/C KEYS                                 S01328
     C*                                                                   S01328
     C                   EXSR      UNREAL                                                      S0132
     C                   ENDIF
     C                   END                                                                   S0132
      *                                                                                       221703
      ** FRA/IRS Deletion Reversals                                                           221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C                   Z-ADD     BJRDNB        KYDAT
     C                   EXSR      SRUREL
     C                   ENDIF
     C*                                                                   S01328
     C     FRVEND        ENDSR                                                  ** FRVEND ESR *S0111
2877 C********************************************************************S01119
     C/EJECT                                                              S01119
2877 C********************************************************************S01119
     C* S/R FRSUBR                                                        S01119
     C* CALLED FROM MAIN PROCESSING                                       S01119
     C* CALLS EXCP; EXCPTN                                                S01119
     C*                                                                   S01119
     C* TO PROCESS FRA/IRS DEAL TYPE FR                                   S01119
     C*                                                                   S01119
2877 C********************************************************************S01119
     C*                                                                   S01119
     C     FRSUBR        BEGSR                                                  ** FRSUBR BSR *S0111
      *                                                                   CSW005
      ** IF CSW005 = 'Y' and Our Rate Fixing Ind (URFIN) = 'F'            CSW005
      **    THEN set UFRIN to 'X'                                         CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     URFIN         ANDEQ     'F'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     URFIN         ANDEQ     'F'                                                         CSW01
     C                   MOVE      'X'           URFIN                                         CSW00
     C                   MOVE      '1'           *IN15                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
      ** IF CSW005 = 'Y' and Their Rate Fixing Ind (TRFIN) = 'F'          CSW005
      **    THEN set TFRIN to 'X'                                         CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     TRFIN         ANDEQ     'F'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     TRFIN         ANDEQ     'F'                                                         CSW01
     C                   MOVE      'X'           TRFIN                                         CSW00
     C                   MOVE      '1'           *IN15                                         CSW00
     C                   ENDIF                                                                 CSW00
     C*                                                                   S01119
     C* SET UP PROFIT CENTRE REGARDLESS OF EVENT TYPE                     LN0711
     C                   MOVEL     PRFC          OPPRFC                                        LN071
     C*                                                                   LN0711
     C                   BITOFF    '3'           UDNSI                                         S0111
     C                   BITOFF    '3'           TDNSI                                         S0111
     C*                                                                   S01119
     C*** SHADOW POST                                                     S01119
     C*                                                                   S01119
     C  NU1              GOTO      FRSHAD                                                      S0111
     C*                                                                   S01119
     C*****   DEAL DATE                                                   S01119
     C*                                                                   S01119
     C                   TESTB     '0'           ACEI                 31                       S0111
     C     DDAT          IFLE      EVCD                                                        S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
     C                   Z-ADD     DDAT          KYDAT                                         S0111
     C                   Z-ADD     DDAT          KYFED                                         S0111
     C*                                                                   S01119
     C*****   PRINCIPAL KEY & PRINT                                       S01119
     C*                                                                   S01119
     C                   MOVEA     'FRD'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    A'       AKY(6)                                        S0111
     C                   MOVEL     NEV(1)        NARREV                                        06014
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C     UBRTT         IFEQ      0                                                           S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   ELSE                                                                  S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C                   END                                                                   S0111
     C                   SETON                                        71                       S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C* PRINT THEIRS                                                      S01119
     C*                                                                   S01119
     C     TBRTT         IFEQ      0                                                           S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   ELSE                                                                  S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C                   MOVE      TBRTT         NRBRTT                                        S0111
     C                   END                                                                   S0111
     C                   Z-ADD     TEINR         NRRT                                          S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C*****   EXPOSURE KEY -  FR GENERATES BETWEEN DEAL & VALUE DATE      S01119
     C*                                                                   S01119
     C                   MOVE      DTYP          RRDT                                          S0111
     C                   Z-ADD     UPAMT         RRPA                                          S0111
     C                   Z-ADD     DDAT          RRSD                                          S0111
     C                   Z-ADD     VDAT          RRED                                          S0111
     C                   EXSR      DLRREX                                                      S0111
     C                   Z-ADD     RREA          KYAMT                                         S0111
     C                   Z-ADD     RREA          UAEXA                                         S0111
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   EXSR      EXCP                                                        S0111
     C                   BITON     '0'           ACEI                                          S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C******  DEAL AMENDMENT: OURS                                        S01119
     C*                                                                   S01119
     C*  PROCESS IF BASE RATE TYPE NON-ZERO AND INITIAL RATE SET          S01119
     C*  INDICATOR OFF: DATABASE ERROR IF NO AMENDMENT RECORD UNDER THESE S01119
     C*  CIRCUMSTANCES                                                    S01119
     C*                                                                   S01119
     C     UBRTT         IFNE      0                                                           S0111
     C                   TESTB     '0'           UDNSI                    31                   S0111
     C     *IN31         IFEQ      '0'                                                         S0111
     C     UINFD         ANDLE     EVCD                                                        S0111
     C*                                                                   S01119
     C* DB ERR                                                            S01119
     C*                                                                   S01119
     C     *IN41         IFEQ      '0'                                                         S0111
     C**********         SETON                                        U7U8LR          S0111 AR547995
     C                   SETON                                        U5U7LR                AR547995
     C**********         EXCEPT    ERROR                                              S0111 AR547995
     C**********         GOTO      FRSEND                                             S0111 AR547995
     C                   GOTO      EOJ                                                      AR547995
     C                   END                                                                   S0111
      *                                                                   CSW005
      ** If CSW005 is switched on then                                    CSW005
      **    Set Our Rate Fixing Indicator to 'X'                          CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C                   MOVE      'X'           URFIN                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C                   Z-ADD     RTSPDM        UBRTE                                         S0111
     C*  HAVING UPDATED BASE RATE,APPLY SPREAD IN LINE WITH SPREAD        S01119
     C*  INDICATOR : ADD,SUB AND ADD PERCENTAGE                           S01119
     C     USPIN         IFEQ      'A'                                                         S0111
     C     UBRTE         ADD       URTSP         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     UBRTE         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      'S'                                                         S0111
     C     UBRTE         SUB       URTSP         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      'P'                                                         S0111
     C     UBRTE         DIV       100           EINR             13 9                         S0111
     C     EINR          MULT(H)   URTSP         UEINR                                         S0111
     C                   ADD       UBRTE         UEINR                                         S0111
     C                   END                                                                   S0111
     C*
     C*  SETON INDICATOR TO IDENTIFY RATE HAS BEEN SET                    S01119
     C                   BITON     '0'           UDNSI                                         S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C******  DEAL AMENDMENT: THEIRS                                      S01119
     C*                                                                   S01119
     C*  PROCESS IF BASE RATE TYPE NON-ZERO AND INITIAL RATE SET          S01119
     C*  INDICATOR OFF: DATABASE ERROR IF NO AMENDMENT RECORD UNDER THESE S01119
     C*  CIRCUMSTANCES                                                    S01119
     C*                                                                   S01119
     C     TBRTT         IFNE      0                                                           S0111
     C                   TESTB     '0'           TDNSI                    31                   S0111
     C     *IN31         IFEQ      '0'                                                         S0111
     C     TINFD         ANDLE     EVCD                                                        S0111
     C*                                                                   S01119
     C* DB ERR                                                            S01119
     C*                                                                   S01119
     C     *IN41         IFEQ      '0'                                                         S0111
     C**********         SETON                                        U7U8LR          S0111 AR547995
     C                   SETON                                        U5U7LR                AR547995
     C**********         EXCEPT    ERROR                                              S0111 AR547995
     C**********         GOTO      FRSEND                                             S0111 AR547995
     C                   GOTO      EOJ                                                      AR547995
     C                   END                                                                   S0111
      *                                                                   CSW005
      ** If CSW005 is switched on then                                    CSW005
      **    Set Their Rate Fixing Indicator to 'X'                        CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C                   MOVE      'X'           TRFIN                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C                   Z-ADD     RTSPDM        TBRTE                                         S0111
     C*  HAVING UPDATED BASE RATE,APPLY SPREAD IN LINE WITH SPREAD        S01119
     C*  INDICATOR : ADD,SUB AND ADD PERCENTAGE                           S01119
     C     TSPIN         IFEQ      'A'                                                         S0111
     C     TBRTE         ADD       TRTSP         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     TBRTE         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      'S'                                                         S0111
     C     TBRTE         SUB       TRTSP         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      'P'                                                         S0111
     C     TBRTE         DIV       100           EINR             13 9                         S0111
     C     EINR          MULT(H)   TRTSP         TEINR                                         S0111
     C                   ADD       TBRTE         TEINR                                         S0111
     C                   END                                                                   S0111
     C*
     C*  SETON INDICATOR TO IDENTIFY RATE HAS BEEN SET                    S01119
     C                   BITON     '0'           TDNSI                                         S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C******  VALUE DATE                                                  S01119
     C*                                                                   S01119
     C     FRSHAD        TAG                                                    *** FRSHAD *** S0111
     C*  VALUE DATE PROCESSING IS ONLY EVENT PROCESSED DURING SHADOW      S01119
     C*  POST.ONLY ACTION IF FLOATING RATE SET.                           S01119
     C                   TESTB     '1'           ACEI                 31                       S0111
     C     VDAT          IFLE      EVCD                                         *              S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
     C                   Z-ADD     VDAT          KYDAT                                         S0111
     C                   Z-ADD     VDAT          KYFED                                         S0111
     C*                                                                   S01119
     C******  IF VALUE DATE VALID FOR ACTION, CHECK FLOATING RATE/SHADOW  S01119
     C******  COMBINATIONS                                                S01119
     C*                                                                   S01119
     C* OUR FLOATING RATE                                                 S01119
     C     UBRTT         IFNE      0                                            **             S0111
     C                   TESTB     '0'           UDNSI                    31                   S0111
     C  NU1
     CANN31              GOTO      FRSEND                                         RATE NOT SET S0111
     C                   END                                                    *              S0111
     C* THEIR FOATING RATE                                                S01119
     C     TBRTT         IFNE      0                                            **             S0111
     C                   TESTB     '0'           TDNSI                    31                   S0111
     C  NU1
     CANN31              GOTO      FRSEND                                         RATE NOT SET S0111
     C                   END                                                    *              S0111
     C*                                                                   S01119
     C****** VALUE DATE A/C KEYS                                          S01119
     C*                                                                   S01119
     C******   PRINCIPAL KEY                                              S01119
     C*                                                                   S01119
     C                   MOVEA     'FRV'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   '         AKY(6)                                        S0111
     C                   MOVEA     ' A'          AKY(9)                                        S0111
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C******   EXPOSURE KEY                                               S01119
     C*                                                                   S01119
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   Z-ADD     UAEXA         KYAMT                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C                   Z-ADD     UEINR         UWEINR           11 7                         E2340
     C                   Z-ADD     TEINR         TWEINR           11 7                         E2340
     C*                                                                   S01119
     C****** DIRECTION AND NET ACCRUED INTEREST CALCULATIONS              S01119
     C*                                                                   S01119
     C     UEINR         IFGE      TEINR                                        **             S0111
     C                   MOVE      'P'           AKY(9)                                        S0111
     C     UAIAN         SUB       TAIAN         WNAIAN           13 0                         S0111
     C     CAS006        IFEQ      'Y'
     C     FSUINB        SUB       FSTINB        WKAIAN           13 0
     C                   ENDIF
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   ELSE                                                                  S0111
     C                   MOVE      'R'           AKY(9)                                        S0111
     C     TAIAN         SUB       UAIAN         WNAIAN           13 0                         S0111
     C     CAS006        IFEQ      'Y'
     C     FSTINB        SUB       FSUINB        WKAIAN
     C                   ENDIF
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   END                                                    *              S0111
     C                   MOVE      UCUCY         KYCCY                                         S0111
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C                   Z-ADD     UPAMT         NRRPUR                                        S0111
     C     UBRTT         IFEQ      0                                            **             S0111
      *                                                                   S01119
      * DLRADS (THEIRS IS FLOATING)                                       S01119
      *                                                                   S01119
     C                   Z-ADD     UWEINR        SZFIX            11 7                         S0111
     C                   Z-ADD     TWEINR        SZFLT            11 7                         S0111
     C                   Z-ADD     VDAT          SZVDAT            5 0                         S0111
     C                   Z-ADD     MDAT          SZMDAT                                        S0111
     C                   Z-ADD     UPAMT         SZPPL                                         S0111
     C                   Z-ADD     UICBS         SZICB             1 0                         S0111
     C                   Z-ADD     WNAIAN        SZIANP                                        S0111
     C                   EXSR      DLRADS                                                      S0111
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C                   Z-ADD     UWEINR        WZFIX            11 7
     C                   Z-ADD     TWEINR        WZFLT            11 7
     C                   Z-ADD     VDAT          WZVDAT            5 0
     C                   Z-ADD     MDAT          WZMDAT
     C                   Z-ADD     UPAMT         WZPPL
     C                   Z-ADD     UICBS         WZICB             1 0
     C                   Z-ADD     WKAIAN        WZIANP
     C                   EXSR      SRFRAC
     C                   ENDIF
      *                                                                                       CAS006
     C                   ELSE                                                                  S0111
      *        (OURS IS FLOATING)                                         S01119
     C                   Z-ADD     TWEINR        SZFIX                                         S0111
     C                   Z-ADD     UWEINR        SZFLT                                         S0111
     C                   Z-ADD     VDAT          SZVDAT                                        S0111
     C                   Z-ADD     MDAT          SZMDAT                                        S0111
     C                   Z-ADD     UPAMT         SZPPL                                         S0111
     C                   Z-ADD     UICBS         SZICB                                         S0111
     C                   Z-ADD     WNAIAN        SZIANP                                        S0111
     C                   EXSR      DLRADS                                                      S0111
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C                   Z-ADD     TWEINR        WZFIX
     C                   Z-ADD     UWEINR        WZFLT
     C                   Z-ADD     VDAT          WZVDAT
     C                   Z-ADD     MDAT          WZMDAT
     C                   Z-ADD     UPAMT         WZPPL
     C                   Z-ADD     UICBS         WZICB
     C                   Z-ADD     WKAIAN        WZIANP
     C                   EXSR      SRFRAC
     C                   ENDIF
      *                                                                                       CAS006
     C                   END                                                    *              S0111
     C*                                                                   S01119
     C****** GENERATE A/C KEY                                             S01119
     C*                                                                   S01119
     C                   MOVEA     'FRV'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   '         AKY(6)                                        S0111
     C                   MOVE      'I'           AKY(10)                                       S0111
     C                   Z-ADD     SZDSA         KYAMT                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     SZDSA         NRRSAL                                        S0111
     C*                                                                   S01119
     C******   CALCULATE TAX OR ZEROISE AS APPROPRIATE                    S01119
     C*   TAX KEYS FOR PAYMENTS ON TAXABLE DEALS           **             S01119
     C*   NET KEYS IN TAXABLE SYSTEM                       **             S01119
     C                   Z-ADD     0             TAXA                                          S0111
     C/COPY WNCPYSRC,DL0280C467
     C     *IN19         IFEQ      *ON                                                         08060
     C/COPY WNCPYSRC,DL0280C468
     C     AKY(9)        IFEQ      'P'                                                         S0111
     C     TAXI          IFEQ      'Y'                                                         S0111
     C     SZDSA         DIV       100           W152             15 2                         S0111
     C     W152          MULT(H)   BNHKTR        TAXA             13 0                         S0119
     C                   Z-ADD     TAXA          KYAMT                                         S0111
     C*                                                                   S01119
     C******   TAX KEY                                                    S01119
     C*                                                                   S01119
     C                   MOVE      'T'           AKY(10)                                       S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     SZDSA         WORKD                                         S0111
     C                   Z-ADD     VDAT          SLIDD                                         S0111
     C                   EXSR      EXCPTN                                                      S0111
     C*                                                                   S01119
     C******   NET KEY                                                    S01119
     C*                                                                   S01119
     C     SZDSA         SUB       TAXA          WNTAXA           13 0                         S0111
     C                   MOVE      'N'           AKY(10)                                       S0111
     C                   Z-ADD     WNTAXA        KYAMT                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     WNTAXA        NRRSAL                                        S0111
     C                   END                                                                   02869
     C                   END                                                    *              S0111
     C                   END                                                    *              S0111
     C*                                                                   S01119
     C***** FORMAT PRINT LINE                                             S01119
     C*                                                                   S01119
     C*  OURS                                                             S01119
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                         **             S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                    *              S0111
     C                   SETON                                        71                       S0111
     C                   MOVEL     NEV(2)        NARREV                                        06014
     C                   MOVE      'Y'           PRONLY                                        S0111
     C*                                                                   S01119
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C                   SETOFF                                       59                       S0111
     C*   THEIRS                                                          S01119
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   MOVE      UCUCY         KYCCY                                         S0111
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C                   Z-ADD     UPAMT         NRRPUR                                        S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                         **             S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                    *              S0111
     C*                                                                   S01119
     C     AKY(9)        IFEQ      'P'                                          **             S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C   43              SETON                                        73                       S0111
     C   44              SETON                                        74                       S0111
     C   45              SETON                                        75                       S0111
     C   46              SETON                                        76                       S0111
     C                   EXCEPT    FITHR2                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C                   MOVEA     '0000'        *IN(73)                                       S0111
     C                   Z-ADD     0             NRRSAL                                        S0111
     C                   END                                                    *              S0111
     C*                                                                   S01119
     C****** UPDATES                                                      S01119
     C*                                                                   S01119
     C     AKY(9)        IFEQ      'P'                                          **             S0111
     C     UIPRD         ADD       SZDSA         UIPRD                                         S0111
     C     UIPRM         ADD       SZDSA         UIPRM                                         S0111
     C                   Z-ADD     WNAIAN        UAIAP                                         S0111
     C     UTAXD         ADD       TAXA          UTAXD                                         S0111
     C     UTAXM         ADD       TAXA          UTAXM                                         S0111
      *                                                                                       CAS006
      ** Populate new interest fields for Hedge Accounting                                    CAS006
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C     FSUPRB        ADD       WZDSA         FSUPRB
     C     FSUPMB        ADD       WZDSA         FSUPMB
     C                   Z-ADD     WKAIAN        FSUIAB
     C                   ENDIF
     C                   ELSE                                                                  S0111
     C     TIPRD         ADD       SZDSA         TIPRD                                         S0111
     C     TIPRM         ADD       SZDSA         TIPRM                                         S0111
     C                   Z-ADD     WNAIAN        TAIAP                                         S0111
      *                                                                                       CAS006
      ** Populate new interest fields for Hedge Accounting                                    CAS006
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C     FSTPRB        ADD       WZDSA         FSTPRB
     C     FSTPMB        ADD       WZDSA         FSTPMB
     C                   Z-ADD     WKAIAN        FSTIAB
     C                   ENDIF
     C                   END                                                    *              S0111
     C                   Z-ADD     0             UAIAN                                         S0111
     C                   Z-ADD     0             TAIAN                                         S0111
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C                   Z-ADD     0             FSUINB
     C                   Z-ADD     0             FSTINB
     C                   ENDIF
     C*                                                                   046560
     C** If Unrealized Profit/Loss Posted is not zero, reverse it.        046560
     C*                                                                   046560
     C     UNRLP         IFNE      0                                                           04656
      *                                                                                       CAS004
     C     CAS004        IFEQ      'N'
     C*                                                                   046560
     C** Set Unrealized P/L to zero (Reversal Posting only required).     046560
     C*                                                                   046560
     C                   Z-ADD     0             UNRL                                          04656
     C*                                                                   046560
     C** Generate Unrealized Profit/Loss Account Keys.                    046560
     C*                                                                   046560
     C                   EXSR      UNREAL                                                      04656
     C                   ENDIF
     C                   END                                                                   04656
     C                   BITON     '1'           ACEI                                          S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C  NU1              GOTO      FRSEND                                                      S0111
      *                                                                                       221703
      ** FRA - Value Date (Maturity) Reversals                                                221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     VDAT          ANDLE     EVCD
     C                   Z-ADD     VDAT          KYDAT
     C                   EXSR      SRUREL
     C                   MOVE      '1'           *IN15
     C                   END
      *                                                                                       221703
     C                   Z-ADD     0             TAXA                                          S0111
      *                                                                                       CAS006
      ** Check Percentage of Ineffective/Effective Linkages present                           CAS006
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C     HEDIN         ANDEQ     'Y'
     C                   MOVE      'DL'          KMOD
     C                   MOVE      'N'           WHDGFL
     C                   Z-ADD     *ZEROS        WEFPTG
     C                   MOVE      *IN87         WIN87             1
     C                   MOVE      *IN71         WIN71             1
     C                   MOVEL     DLNO          DLNOA                                        CLE148
     C     KHDGKY        SETLL     ASHTRNLA
     C     KHDGKY        READE     ASHTRNLA                               87
     C     *IN87         DOWEQ     '0'
     C     FSHTID        IFEQ      'D'
     C     FSHEDI        CHAIN     ASHGLKL1                           71
     C     *IN71         IFEQ      '0'
     C     FSRECI        ANDEQ     'D'
     C                   MOVE      'Y'           WHDGFL            1
     C                   ADD       FSPCTG        WEFPTG            6 2
     C                   ENDIF
     C                   ENDIF
     C     KHDGKY        READE     ASHTRNLA                               87
     C                   ENDDO
     C                   MOVE      WIN87         *IN87
     C                   MOVE      WIN71         *IN71
     C     WEFPTG        DIV       100           WEFPTG
     C                   ENDIF
      *                                                                                       245308
      ** Check value of Hedge Indicator field on SDBOOKPD                                     245308
      *                                                                                       245308
     C                   MOVE      'N'           WNHDGL            1                          245308
     C     FRAACCHDG     IFEQ      'Y'                                                        245308
     C     CAS006        ANDEQ     'Y'                                                        245308
     C     HEDIN         ANDEQ     'Y'                                                        245308
     C     WHDGFL        ANDEQ     'N'                                                        245308
      *                                                                                       245308
     C                   CALL      'AOBOOKR0'                                                 245308
     C                   PARM      *BLANKS       PRTCD                                        245308
     C                   PARM      '*KEY   '     POPTN                                        245308
     C                   PARM      BOKC          WKBOKC            2                          245308
     C     SDBOOK        PARM      SDBOOK        DSFDY                                        245308
                                                                                              245308
      ** If return code is not blank, database error                                          245308
                                                                                              245308
     C                   IF        PRTCD <> *BLANK                                            245308
     C                   EVAL      DBKEY = BOKC                                               245308
     C                   EVAL      DBFILE = 'SDBOOKPD'                                        245308
     C                   EVAL      DBASE = '056'                                              245308
     C                   EXSR      *PSSR                                                      245308
     C                   ENDIF                                                                245308
                                                                                              245308
     C                   IF        BDHGIN = 'Y'                                               245308
     C                   MOVE      'Y'           WNHDGL                                       245308
     C                   ENDIF                                                                245308
                                                                                              245308
     C                   ENDIF                                                                245308
     C*                                                                   S01119
     C***** MATURITY DATE                                                 S01119
     C*                                                                   S01119
     C                   TESTB     '2'           ACEI                 31                       S0111
     C     MDAT          IFLE      EVCD                                                        S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
     C                   Z-ADD     MDAT          KYDAT                                         S0111
     C                   Z-ADD     MDAT          KYFED                                         S0111
     C*                                                                   S01119
     C**  ACCRUAL PROCESSING                                              S01119
     C*                                                                   S01119
     C     HEDIN         IFEQ      'Y'                                                         S0111
     C     BQHFRA        ANDEQ     'Y'                                                         S0119
      *                                                                                       CAS006
      ** Check the switchable feature CAS006 and the Effectiveness                            CAS006
      ** of its Hedge Linkages                                                                CAS006
      *                                                                                       CAS006
     C     CAS006        IFEQ      'N'
     C     CAS006        OREQ      'Y'
     C     WHDGFL        ANDEQ     'Y'
     C     WNHDGL        OREQ      'Y'                                                        245308
     C*                                                                   S01119
     C******   PRINCIPAL KEY                                              S01119
     C*                                                                   S01119
     C                   MOVEA     'FRM'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   '         AKY(6)                                        S0111
     C                   MOVEA     ' A'          AKY(9)                                        S0111
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
      *                                                                                       CAS006
      ** Output the Effectively hedged percentage of the transaction                          CAS006
      ** when CAS006 is switched on                                                           CAS006
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C     HEDIN         ANDEQ     'Y'
     C     WNHDGL        ANDNE     'Y'                                                        245308
     C     KYAMT         MULT      WEFPTG        KYAMT
     C                   ENDIF
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C******   EXPOSURE KEY                                               S01119
     C*                                                                   S01119
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   Z-ADD     UAEXA         KYAMT                                         S0111
      *                                                                                       CAS006
      ** Output the Effectively hedged percentage of the transaction                          CAS006
      ** when CAS006 is switched on                                                           CAS006
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C     HEDIN         ANDEQ     'Y'
     C     WNHDGL        ANDNE     'Y'                                                        245308
     C     KYAMT         MULT      WEFPTG        KYAMT
     C                   ENDIF
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C                   Z-ADD     UEINR         UWEINR                                        S0111
     C                   Z-ADD     TEINR         TWEINR                                        S0111
     C*                                                                   S01119
     C****** DIRECTION AND NET ACCRUED INTEREST CALCULATIONS              S01119
     C****   POST LAST ACCRUAL AMOUNT                                     S01119
     C*                                                                   S01119
     C     UWEINR        IFGE      TWEINR                                                      S0111
     C                   MOVE      'P'           AKY(9)                                        S0111
     C     UIPRD         SUB       UAIPD         WNAIPD           13 0                         S0111
     C                   ELSE                                                                  S0111
     C                   MOVE      'R'           AKY(9)                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C     TIPRD         SUB       TAIPD         WNAIPD           13 0                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   MOVE      'A'           AKY(10)                                       S0111
     C                   MOVE      'A'           AKY(3)                                        S0111
     C                   Z-ADD     WNAIPD        KYAMT                                         S0111
      *                                                                                       CAS006
      ** Output the Effectively hedged percentage of the transaction                          CAS006
      ** when CAS006 is switched on                                                           CAS006
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C     HEDIN         ANDEQ     'Y'
     C     WNHDGL        ANDNE     'Y'                                                        245308
     C     KYAMT         MULT      WEFPTG        KYAMT
     C                   ENDIF
      *                                                                                       CAS006
      ** Check and summarise account key if required                                          CAS006
      *                                                                                       CAS006
     C                   MOVE      *BLANK        WSUMAK
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C     BKAKSI        ANDEQ     'Y'
     C                   EXSR      SRATOT
     C                   ENDIF
      *                                                                                       CAS006
     C     WSUMAK        IFNE      'Y'
     C                   EXSR      EXCP                                                        S0111
     C                   ENDIF
     C                   ENDIF
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*** REPORT EVENT & UPDATES                                          S01119
     C*                                                                   S01119
     C* OUR PRINT DETAILS                                                 S01119
     C                   Z-ADD     UPAMT         NRRPUR                                        S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C     UBRTT         IFEQ      0                                                           S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   ELSE                                                                  S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C                   END                                                                   S0111
     C                   MOVEL     NEV(4)        NARREV                                        06014
     C                   SETON                                        71                       S0111
     C                   MOVE      'Y'           PRONLY                                        S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C* THEIR PRINT DETAILS                                               S01119
     C*                                                                   S01119
     C     TBRTT         IFEQ      0                                                           S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   ELSE                                                                  S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C                   MOVE      TBRTT         NRBRTT                                        S0111
     C                   END                                                                   S0111
     C                   Z-ADD     TEINR         NRRT                                          S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C*  RECORD UPDATE                                                    S01119
     C*                                                                   S01119
     C                   MOVE      'M'           RECR                                          S0111
      *                                                                                       CIR008
      ** Set Deal Authorisation Status to 'M' if CIR008 is installed                          CIR008
      *                                                                                       CIR008
     C     CIR008        IFEQ      'Y'
     C                   MOVE      'M'           FIDSTS
     C                   ENDIF
      *                                                                                       CIR008
     C                   BITON     '2'           ACEI                                          S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C/COPY WNCPYSRC,DL0280C548
     C                   END                                                                   S0111
     C*                                                                   S01119
     C***** ACCRUAL DATE FOR HEDGED DEALS PAST VALUE DATE                 S01119
     C*                                                                   S01119
     C     *IN52         IFEQ      '1'                                                         S0111
     C     VDAT          ANDLE     EVCD                                                        S0111
     C     MDAT          ANDGT     EVCD                                                        S0111
     C*                                                                   S01119
     C**  ACCRUAL PROCESSING                                              S01119
     C*                                                                   S01119
     C     HEDIN         ANDEQ     'Y'                                                         S0111
     C     BQHFRA        ANDEQ     'Y'                                                         S0119
     C                   Z-ADD     BKAPDT        KYDAT                                         07778
     C                   Z-ADD     BJRDNB        KYFED                                         S0119
      *                                                                                       CAS006
      ** Check the switchable feature CAS006 and the Effectiveness                            CAS006
      ** of its Hedge Linkages                                                                CAS006
      *                                                                                       CAS006
     C     CAS006        IFEQ      'N'
     C     CAS006        OREQ      'Y'
     C     WHDGFL        ANDEQ     'Y'
     C     WNHDGL        OREQ      'Y'                                                        245308
      *                                                                                       CAS006
     C*                                                                   S01119
     C* OUR INTEREST DETAILS                                              S01119
     C*                                                                   S01119
     C                   MOVEA     'FRA'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   '         AKY(6)                                        S0111
     C                   MOVEA     ' A'          AKY(9)                                        S0111
     C*                                                                   S01119
     C*  AMOUNT CALCULATIONS                                              S01119
     C*     ACCRUAL AMOUNTS CALCULATED ON STRAIGHT LINE BASIS BETWEEN     S01119
     C*     VALUE DATE AND MATURITY DATE                                  S01119
     C*                                                                   S01119
     C     MDAT          SUB       VDAT          PER1              5 0            LIFE OF DEAL S0111
     C                   Z-ADD     *ZERO         DACCR                                         04078
     C*                                                                   S01119
     C*  OURS                                                             S01119
     C*                                                                   S01119
     C     UIPRD         IFNE      0                                                           S0111
     C                   MOVE      'P'           AKY(9)                                        S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C     UIPRD         DIV       PER1          DACCR            15 5           DAILY ACCRUAL S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* THEIRS                                                            S01119
     C*                                                                   S01119
     C     TIPRD         IFNE      0                                                           S0111
     C                   MOVE      'R'           AKY(9)                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C     TIPRD         DIV       PER1          DACCR            15 5                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  GENERAL                                                          S01119
     C*                                                                   S01119
     C     EVCD          SUB       VDAT          PER2              5 0          PERIOD EXPIRED S0111
     C  N29              ADD       1             PER2                                          S0111
     C     DACCR         MULT(H)   PER2          IAMT             13 0                         S0111
     C*                                                                   S01119
     C*  A/C KEY GENERATION AND FILE UPDATE                               S01119
     C*                                                                   S01119
     C                   Z-ADD     0             KYAMT                                         E2395
     C     AKY(9)        IFEQ      'P'                                                         S0111
     C     IAMT          SUB       UAIPD         KYAMT                                         S0111
     C     UAIPD         ADD       KYAMT         UAIPD                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   END                                                                   E2395
     C     AKY(9)        IFEQ      'R'                                                         E2395
     C     IAMT          SUB       TAIPD         KYAMT                                         S0111
     C     TAIPD         ADD       KYAMT         TAIPD                                         S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   END                                                                   S0111
      *                                                                                       CAS006
      ** Output the Effectively hedged percentage of the transaction                          CAS006
      ** when CAS006 is switched on                                                           CAS006
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C     HEDIN         ANDEQ     'Y'
     C     WNHDGL        ANDNE     'Y'                                                        245308
     C     KYAMT         MULT      WEFPTG        KYAMT
     C                   ENDIF
      *                                                                                       CAS006
     C                   Z-ADD     KYAMT         NRRSAL                                        E2496
     C                   SETON                                        71                       E1119
1206 C                   MOVEL     NEV(6)        NARREV                                        E1119
     C*                                                                   003457
     C** Set Base Rate Type (NRBRTT) to blanks; set the rate (NRRT) to    003457
     C** the Yield rate (i.e. the FRA rate with discounting included);    003457
     C** set *IN31 off to ensure the Yield rate is output.                003457
     C*                                                                   003457
     C     IAMT          IFNE      0                                                           09337
     C                   MOVE      '  '          NRBRTT                                        00345
     C                   MOVE      '0'           *IN31                                         00345
      *                                                                                       CIR013
      * Check whether the period contains a 29th February                                     CIR013
     C     UICBS         IFEQ      9                                                          CIR013
      * Convert start date to YYYYMMDD format                                                 CIR013
     C                   Z-ADD     VDAT          @@DAYN            5 0                        CIR013
     C                   EXSR      ZDATE9                                                     CIR013
     C                   Z-ADD     @@VDT         ZZDATA                                       CIR013
      * Convert end date to YYYYMMDD format                                                   CIR013
     C                   Z-ADD     EVCD          @@DAYN                                       CIR013
     C                   EXSR      ZDATE9                                                     CIR013
     C                   Z-ADD     @@VDT         ZZDATB                                       CIR013
      *                                                                                       CIR013
     C                   Eval      ZZStartDate = ZZDATA                                       CIR013
     C                   Eval      ZZEndDate = ZZDATB                                         CIR013
     C                   EXSR      #FEB29                                                     CIR013
     C                   ENDIF                                                                CIR013
     C*                                                                   003457
     C** ...calculate yield rate :                                        003457
     C**                  Yield x No of Accrual Days x Principal          003457
     C** Accrual Amount = --------------------------------------          003457
     C**                           100 x Days in Year                     003457
     C**                                                                  003457
     C**                     Accrual Amount x Days in Year x 100          003457
     C** therefore, Yield =  -----------------------------------          003457
     C**                       Principal x No of Accrual Days             003457
     C**                                                                  003457
     C** (where Days in Year depends on the Calculation Basis).           003457
     C*                                                                   003457
     C     UICBS         IFEQ      1                                                           00345
     C     UICBS         OREQ      4                                                           00345
     C     UICBS         OREQ      9                                                          CIR013
     C     #29FEB        ANDEQ     'N'                                                        CIR013
     C                   Z-ADD     365           WDIY              3 0                         00345
     C                   END                                                                   00345
     C     UICBS         IFEQ      2                                                           00345
     C     UICBS         OREQ      3                                                           00345
     C     UICBS         OREQ      5                                                           00345
     C     UICBS         OREQ      7                                                           CIR00
     C     CIR004        ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     360           WDIY                                          00345
     C                   END                                                                   00345
     C     UICBS         IFEQ      6                                                           00345
     C     UICBS         OREQ      9                                                          CIR013
     C     #29FEB        ANDEQ     'Y'                                                        CIR013
     C                   Z-ADD     366           WDIY                                          00345
     C                   END                                                                   00345
     C*                                                                   003457
     C     WDIY          MULT      100           WYIELD           26 9                         00345
     C     WYIELD        DIV(H)    PER2          WYIELD                                        00345
     C     WYIELD        MULT      IAMT          WYIELD                                        00345
     C     WYIELD        DIV(H)    UPAMT         WYIELD                                        00345
     C                   Z-ADD(H)  WYIELD        NRRT                                          00345
     C*                                                                   093378
     C*  .. else, if interest amount is zero, set yield to 0              093378
     C                   ELSE                                                                  09337
     C                   Z-ADD(H)  0             NRRT                                          09337
     C                   END                                                                   09337
     C*                                                                   003457
      *                                                                                       CAS006
      ** Check and summarise account key if required                                          CAS006
      *                                                                                       CAS006
     C                   MOVE      *BLANK        WSUMAK            1
      *                                                                                       CAS006
     C     CAS006        IFEQ      'Y'
     C     BKAKSI        ANDEQ     'Y'
     C                   EXSR      SRATOT
     C                   ENDIF
      *
     C     WSUMAK        IFNE      'Y'
     C                   EXSR      EXCP                                                        S0111
     C                   ENDIF
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   ENDIF
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     0             NRRPUR                                        S0111
     C                   Z-ADD     0             NRRSAL                                        S0111
     C*                                                                   S01328
     C** IF ACCRUAL DATE PROCESSING IS REQUIRED (*IN52 IS ON) AND THE     S01328
     C** VALUE DATE OF THE DEAL IS GREATER THAN THE EVENT CONTROL DATE    S01328
     C*                                                                   S01328
     C     *IN52         IFEQ      '1'                                                         S0132
     C     VDAT          ANDGT     EVCD                                                        S0132
     C*                                                                   S01328
     C** IF UNREALIZED PROFIT/LOSS IS NOT ZERO,                           S01328
     C** OR UNREALIZED PROFIT/LOSS POSTED IS NOT ZERO,                    S01328
     C*                                                                   S01328
     C     UNRL          IFNE      *ZERO                                                       S0132
     C     UNRLP         ORNE      *ZERO                                                       S0132
      *                                                                                       CAS004
     C     CAS004        IFEQ      'N'
     C*                                                                   S01328
     C** GENERATE UNREALIZED P/L A/C KEYS                                 S01328
     C*                                                                   S01328
     C                   EXSR      UNREAL                                                      S0132
     C*                                                                   S01328
     C** SET ON DEALS FILE UPDATE INDICATOR (*IN15)                       S01328
     C*                                                                   S01328
     C                   MOVE      '1'           *IN15                                         S0132
     C                   ENDIF
     C                   END                                                                   S0132
     C                   END                                                                   S0132
     C*                                                                   S01328
     C     FRSEND        ENDSR                                                  ** FRSEND ESR* S0111
2877 C********************************************************************S01119
     C/EJECT                                                              S01119
2877 C********************************************************************S01119
     C* S/R RSSUBR                                                        S01119
     C* CALLED FROM MAIN PROCESSING                                       S01119
     C* CALLS EXCP; EXCPTN                                                S01119
     C*                                                                   S01119
     C* TO PROCESS FRA/IRS DEAL TYPE RS                                   S01119
     C*                                                                   S01119
2877 C********************************************************************S01119
     C*                                                                   S01119
     C     RSSUBR        BEGSR                                                  ** RSSUBR **** S0111
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C                   MOVE      *BLANKS       BLKUF                                         CSW00
     C                   MOVE      *BLANKS       BLKTF                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
      ** IF CSW005 = 'Y' and Our Rate Fixing Ind (LF/DEALSL1/URFIN='F')   CSW005
      **    THEN set UFRIN to 'X'                                         CSW005
      *                                                                   CSW005
      ** If URFIN is 'B' or 'C', base rate was picked up in I/C                               227642
      *                                                                                       227642
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     URFIN         ANDEQ     'F'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     URFIN         ANDEQ     'F'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'B'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'B'                                                        227642
     C     CSW005        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'C'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'C'                                                        227642
     C                   MOVE      'X'           URFIN                                         CSW00
     C                   MOVE      '1'           *IN15                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
      ** IF CSW005='Y' and Their Rate Fixing Ind (LF/DEALSL1/TRFIN='F')   CSW005
      **    THEN set TFRIN to 'X'                                         CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     TRFIN         ANDEQ     'F'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     TRFIN         ANDEQ     'F'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                      227642
     C     TRFIN         ANDEQ     'B'                                                      227642
     C     CSW011        OREQ      'Y'                                                      227642
     C     TRFIN         ANDEQ     'B'                                                      227642
     C     CSW005        OREQ      'Y'                                                      227642
     C     TRFIN         ANDEQ     'C'                                                      227642
     C     CSW011        OREQ      'Y'                                                      227642
     C     TRFIN         ANDEQ     'C'                                                      227642
     C                   MOVE      'X'           TRFIN                                         CSW00
     C                   MOVE      '1'           *IN15                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                                       229628
      ** Check rate fix indicator                                                             229628
      *                                                                                       229628
     C     CSW005        IFEQ      'Y'                                                        229628
     C     CSW011        OREQ      'Y'                                                        229628
     C     UINFD         IFGE      EVCD                                                       229628
     C     UINFD         ANDLE     UNICD                                                      229628
     C     URFIN         ANDNE     *BLANK                                                     229628
     C                   MOVE      *BLANK        URFIN                                        229628
     C                   MOVE      '1'           *IN15                                        229628
     C                   ENDIF                                                                229628
     C     TINFD         IFGE      EVCD                                                       229628
     C     TINFD         ANDLE     TNICD                                                      229628
     C     TRFIN         ANDNE     *BLANK                                                     229628
     C                   MOVE      *BLANK        TRFIN                                        229628
     C                   MOVE      '1'           *IN15                                        229628
     C                   ENDIF                                                                229628
     C                   ENDIF                                                                229628
     C*                                                                   CIR001
     C** If a buy-out is due, set the maturity date to the buy-out        CIR001
     C** value date.                                                      CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     BOVD          IFLE      EVCD                                                        CIR00
     C     BOVD          ANDNE     *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C094
     C     UNIPD         IFEQ      0                                                           CIR00
     C                   Z-ADD     MDAT          UNIPD                                         CIR00
     C                   END                                                                   CIR00
     C     TNIPD         IFEQ      0                                                           CIR00
     C                   Z-ADD     MDAT          TNIPD                                         CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     BOVD          MDAT                                          CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* SET UP PROFIT CENTRE REGARDLESS OF EVENT TYPE                     LN0711
     C                   MOVEL     PRFC          OPPRFC                                        LN071
      *                                                                                       CAS005
      ** Setup Ours/Theirs Principal Amount for Net-Treasury-Rate                             CAS005
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UPAMT         FSUPAM
     C                   Z-ADD     TPAMT         FSTPAM
     C                   ENDIF
     C*                                                                   S01119
     C*  NON-SHADOW POST PROCESSING                                       S01119
     C*                                                                   S01119
     C     *INU1         IFEQ      '1'                                                         S0111
     C*                                                                   S01119
     C*  OUR SHORT TERM RATE PROCESSING                                   S01119
     C*                                                                   S01119
     C     UBRTT         IFNE      0                                                           S0111
     C                   TESTB     '2'           UDNSI                    31                   S0111
     C*  IF SHORT TERM RATE BIT IS ON AND DEAL IS PAST VALUE DATE         S01119
     C*  IT IS NECESSARY TO RECALCULATE ACCRUALS USING NEW RATE           S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     VDAT          ANDLT     BJRDNB                                                      S0119
     C*                                                                   CIR001
     C** IF OUR INTEREST IS UP FRONT (METHOD 'D' OR 'Y')                  CIR001
     C** RECALCULATE INTEREST TO THE INTEREST ACCRUAL CONTROL DATE (THIS  CIR001
     C** IS THE NEXT INTEREST PAYMENT DATE AND IT WILL STAY THIS DATE).   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'D'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     ULPCD         ZIBEG                                         CIR00
     C                   Z-ADD     UIACD         ZIEND                                         CIR00
     C                   Z-ADD     UEINR         ZIRATE                                        CIR00
     C                   Z-ADD     UICBS         ZICALC                                        CIR00
     C                   Z-ADD     UPAMT         ZIAMT                                         CIR00
     C                   EXSR      GLINTC                                                      CIR00
     C     UINPM         IFEQ      'Y'                                                         CIR00
     C                   EXSR      #LCIYD                                                      CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C                   END                                                                   CIR00
     C                   SUB       UIALC         UAITC                                         CIR00
     C                   ADD       WKINT         UAITC                                         CIR00
     C                   Z-ADD     WKINT         UIALC                                         CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
      *                                                                                       CAS005
     C                   Z-ADD     ULPCD         ZIBEG
     C                   Z-ADD     UIACD         ZIEND
     C                   Z-ADD     UICBS         ZICALC
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   Z-ADD     FSUPAM        ZIAMT
     C                   EXSR      GLINTC
     C     UINPM         IFEQ      'Y'
     C                   EXSR      #LCIYD
     C                   Z-ADD(H)  WKINT         WINTST
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   ENDIF
     C                   SUB       FSUALB        FSUITB
     C                   ADD       WINTST        FSUITB
     C                   Z-ADD     WINTST        FSUALB
     C                   ENDIF
      *                                                                                       CAS005
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     ULPCD         ZIBEG                                         S0111
     C                   Z-ADD     BJRDNB        ZIEND                                         S0119
     C                   Z-ADD     UEINR         ZIRATE                                        S0111
     C                   Z-ADD     UICBS         ZICALC                                        S0111
     C                   Z-ADD     UPAMT         ZIAMT                                         S0111
     C*                                                                   CIR002
     C** If CIR001 is switched on, add our unsettled interest and         CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C638
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP42                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP43                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C*  REMOVE OLD ACCRUAL AMOUNT AND ADD NEW AMOUNT IF PREVIOUS         S01119
     C*  SHORT TERM RATE HAS BEEN ENTERED I.E. IF IACD NE LPCD            S01119
     C*  RESET ACCRUAL SINCE LAST CHANGE AND INT.ACCRUAL CONTROL DATE     S01119
     C     UIACD         IFNE      ULPCD                                                       S0111
     C     UAITC         SUB       UIALC         UAITC                                         S0111
     C                   END                                                                   S0111
     C     UAITC         ADD       WKINT         UAITC                                         S0111
     C                   Z-ADD     WKINT         UIALC                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   Z-ADD     FSUPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR001 is switched on, add our unsettled interest and                             CAS005
      ** adjustment to our principal.                                                         CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'L'
     C                   ADD       OUSI          ZIAMT
     C                   ADD       OUSA          ZIAMT
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
      ** Remove old accrual amount and add new amount if previous                             CAS005
      ** short term rate has been entered i.e. if IACD ne LPCD                                CAS005
      ** reset accrual since last change and int. accrual control date                        CAS005
      *                                                                                       CAS005
     C     UIACD         IFNE      ULPCD
     C     FSUITB        SUB       FSUALB        FSUITB
     C                   ENDIF
      *                                                                                       CAS005
     C     FSUITB        ADD       WINTST        FSUITB
     C                   Z-ADD     WINTST        FSUALB
     C                   ENDIF
     C                   Z-ADD     BJRDNB        UIACD                                         S0119
     C*                                                                   CIR002
     C** Maintain the unsettled interest amount as well.                  CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C639
     C                   ADD       WKINT         OUSI                                          CIR00
     C/COPY WNCPYSRC,DL0280C687
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
     C                   END                                                                   S0111
     C*  SETOFF SHORT TERM RATE BIT                                       S01119
     C                   BITOFF    '2'           UDNSI                                         S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* THEIR SHORT TERM RATE PROCESSING                                  S01119
     C*                                                                   S01119
     C     TBRTT         IFNE      0                                                           S0111
     C                   TESTB     '2'           TDNSI                    31                   S0111
     C*  IF SHORT TERM RATE BIT IS ON AND DEAL IS PAST VALUE DATE         S01119
     C*  IT IS NECESSARY TO RECALCULATE ACCRUALS USING NEW RATE           S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     VDAT          ANDLT     BJRDNB                                                      S0119
     C*                                                                   CIR001
     C** IF THEIR INTEREST IS UP FRONT (METHOD 'D' OR 'Y')                CIR001
     C** RECALCULATE INTEREST TO THE INTEREST ACCRUAL CONTROL DATE (THIS  CIR001
     C** IS THE NEXT INTEREST PAYMENT DATE AND IT WILL STAY THIS DATE).   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'D'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     TLPCD         ZIBEG                                         CIR00
     C                   Z-ADD     TIACD         ZIEND                                         CIR00
     C                   Z-ADD     TEINR         ZIRATE                                        CIR00
     C                   Z-ADD     TICBS         ZICALC                                        CIR00
     C                   Z-ADD     TPAMT         ZIAMT                                         CIR00
     C                   EXSR      GLINTC                                                      CIR00
     C     TINPM         IFEQ      'Y'                                                         CIR00
     C                   EXSR      #LCIYD                                                      CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C                   END                                                                   CIR00
     C                   SUB       TIALC         TAITC                                         CIR00
     C                   ADD       WKINT         TAITC                                         CIR00
     C                   Z-ADD     WKINT         TIALC                                         CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   Z-ADD     FSTPAM        ZIAMT
     C                   EXSR      GLINTC
     C     TINPM         IFEQ      'Y'
     C                   EXSR      #LCIYD
     C                   Z-ADD(H)  WKINT         WINTST
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   ENDIF
     C                   SUB       FSTALB        FSTITB
     C                   ADD       WINTST        FSTITB
     C                   Z-ADD     WINTST        FSTALB
     C                   ENDIF
      *                                                                                       CAS005
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     TLPCD         ZIBEG                                         S0111
     C                   Z-ADD     BJRDNB        ZIEND                                         S0119
     C                   Z-ADD     TEINR         ZIRATE                                        S0111
     C                   Z-ADD     TICBS         ZICALC                                        S0111
     C                   Z-ADD     TPAMT         ZIAMT                                         S0111
     C*                                                                   CIR002
     C** If CIR001 is switched on, add their unsettled interest and       CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C640
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP50                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP51                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C*  REMOVE OLD ACCRUAL AMOUNT AND ADD NEW AMOUNT IF PREVIOUS         S01119
     C*  SHORT TERM RATE HAS BEEN ENTERED I.E. IF IACD NE LPCD            S01119
     C*  RESET ACCRUAL SINCE LAST CHANGE AND INT.ACCRUAL CONTROL DATE     S01119
     C     TIACD         IFNE      TLPCD                                                       S0111
     C     TAITC         SUB       TIALC         TAITC                                         S0111
     C                   END                                                                   S0111
     C     TAITC         ADD       WKINT         TAITC                                         S0111
     C                   Z-ADD     WKINT         TIALC                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TLPCD         ZIBEG
     C                   Z-ADD     BJRDNB        ZIEND
     C                   Z-ADD     TICBS         ZICALC
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   Z-ADD     FSTPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR001 is switched on, add their unsettled interest and                           CAS005
      ** adjustment to their principal.                                                       CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'L'
     C/COPY WNCPYSRC,DL0280C640                                                               CAS005
     C                   ADD       TUSI          ZIAMT
     C                   ADD       TUSA          ZIAMT
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXSR      SRDLIN
      *                                                                                       CAS005
      ** Remove old accrual amount and add new amount if previous                             CAS005
      ** short term rate has been entered i.e. if IACD ne LPCD                                CAS005
      ** reset accrual since last chande and int. accrual control date                        CAS005
      *                                                                                       CAS005
     C     TIACD         IFNE      TLPCD
     C     FSTITB        SUB       FSTALB        FSTITB
     C                   ENDIF
     C     FSTITB        ADD       WINTST        FSTITB
     C                   Z-ADD     WINTST        FSTALB
      *                                                                                       CAS005
     C                   ENDIF
     C                   Z-ADD     BJRDNB        TIACD                                         S0119
     C*                                                                   CIR002
     C** Maintain the unsettled interest amount as well.                  CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C641
     C                   ADD       WKINT         TUSI                                          CIR00
     C/COPY WNCPYSRC,DL0280C688
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
     C                   END                                                                   S0111
     C*  SETOFF SHORT TERM RATE BIT                                       S01119
     C                   BITOFF    '2'           TDNSI                                         S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*                                                                   S01119
     C*****   DEAL DATE                                                   S01119
     C*                                                                   S01119
     C                   TESTB     '0'           ACEI                 31                       S0111
     C     DDAT          IFLE      EVCD                                                        S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
     C                   Z-ADD     DDAT          KYDAT                                         S0111
     C                   Z-ADD     DDAT          KYFED                                         S0111
     C*                                                                   S01119
     C*****   PRINCIPAL KEY                                               S01119
     C*                                                                   S01119
     C                   MOVEA     'RSD'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    A'       AKY(6)                                        S0111
     C                   MOVEL     NEV(1)        NARREV                                        06014
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   SETON                                        71                       S0111
     C                   EXSR      EXCP                                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   EXCEPT    FITHR2                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C*****   EXPOSURE KEY                                                S01119
     C***   OUR EXPOSURE AMOUNT CALCULATED BETWEEN VALUE AND MATURITY     S01119
     C*                                                                   S01119
     C                   MOVE      DTYP          RRDT                                          S0111
     C                   Z-ADD     UPAMT         RRPA                                          S0111
     C                   Z-ADD     VDAT          RRSD                                          S0111
     C                   Z-ADD     MDAT          RRED                                          S0111
     C                   EXSR      DLRREX                                                      S0111
     C                   Z-ADD     RREA          KYAMT                                         S0111
     C                   Z-ADD     RREA          UAEXA                                         S0111
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   CIR001
     C**  UP-FRONT FEE/PREMIUM                                            CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     UPVD          IFNE      *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C                   MOVEA     'RSD'         AKY(1)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVEA     UPPR          AKY(9)                                        CIR00
     C                   Z-ADD     UPFE          KYAMT                                         CIR00
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C095
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C096
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C097
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C     UPPR          IFEQ      'R'                                                         CIR00
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C/COPY WNCPYSRC,DL0280C098
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C/COPY WNCPYSRC,DL0280C099
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** WRITE ACCOUNT KEY FOR FEE/PREMIUM                                CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   BITON     '0'           ACEI                                          S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C** BUY-OUTS                                                         CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '4'           ACEI                 31                       CIR00
     C*                                                                   CIR001
     C     BODD          IFLE      EVCD                                                        CIR00
     C     BODD          ANDNE     *ZEROS                                                      CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C*                                                                   CIR001
     C                   Z-ADD     BODD          KYDAT                                         CIR00
     C                   Z-ADD     BODD          KYFED                                         CIR00
     C*                                                                   CIR001
     C                   MOVEA     'RSD'         AKY(1)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    B'       AKY(6)                                        CIR00
     C                   MOVEA     BAPR          AKY(9)                                        CIR00
     C                   Z-ADD     BOAM          KYAMT                                         CIR00
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C223
     C     BAPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C224
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C225
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C     BAPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C226
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C227
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** WRITE ACCOUNT KEY FOR BUY-OUTS                                   CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C                   BITON     '4'           ACEI                                          CIR00
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 CIR001
     C*                                                                   CIR001
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C** VALUE DATE UP-FRONT FEE/PREMIUM                                  CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '3'           ACEI                 31                       CIR00
     C*                                                                   CIR001
     C     UPVD          IFLE      EVCD                                                        CIR00
     C     UPVD          ANDNE     *ZEROS                                                      CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C*                                                                   CIR001
     C                   Z-ADD     UPVD          KYDAT                                         CIR00
     C                   Z-ADD     UPVD          KYFED                                         CIR00
     C*                                                                   CIR001
     C                   MOVEA     'RSV'         AKY(1)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVEA     UPPR          AKY(9)                                        CIR00
     C                   MOVEL     NEV(11)       NARREV                                        CIR00
     C                   Z-ADD     UPFE          KYAMT                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'F'           F1FFLG
     C                   Z-ADD     UPFE          F1FVAL
     C                   Z-ADD     100           F1FPCT
     C                   ENDIF
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C228
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C229
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C230
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
      *                                                                                       199825
     C                   MOVE      POBR          KYSTBR
      *                                                                                       199825
     C                   END                                                                   CIR00
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C231
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C232
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
      *                                                                                       199825
     C                   MOVE      ROBR          KYSTBR
      *                                                                                       199825
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** SETUP REPORT FIELDS                                              CIR001
     C*                                                                   CIR001
     C                   Z-ADD     UPFE          NRRPUR                                        CIR00
     C                   MOVE      '  '          NRBRTT                                        CIR00
     C                   SETON                                        7131                     CIR00
     C*                                                                   CIR001
     C** WRITE ACCOUNT KEY FOR UP-FRONT FEES/PREMIUM                      CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C                   BITON     '3'           ACEI                                          CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 CIR001
     C*                                                                   CIR001
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C**  VALUE DATE PROCESSING                                           CIR001
     C*                                                                   CIR001
     C                   TESTB     '1'           ACEI                 31                       CIR00
     C     VDAT          IFLE      EVCD                                                        CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C*                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     UINFD         IFLE      VDAT                                                        CSW00
     C     UINFD         ORGT      BJRDNB                                                      CSW00
     C                   MOVE      'Y'           BLKUF             1                           CSW00
     C                   ENDIF                                                                 CSW00
     C     TINFD         IFLE      VDAT                                                        CSW00
     C     TINFD         ORGT      BJRDNB                                                      CSW00
     C                   MOVE      'Y'           BLKTF             1                           CSW00
     C                   ENDIF                                                                 CSW00
     C                   ENDIF                                                                 CSW00
     C*                                                                   CIR001
     C**  IF THEIR INTEREST IS UP FRONT (DISCOUNT OR YIELD)               CIR001
     C**  THEIR FIRST INTEREST PAYMENT DATE IS VALUE DATE                 CIR001
     C*                                                                   CIR001
     C     TINPM         IFEQ      'D'                                                         CIR00
     C     TINPM         OREQ      'Y'                                                         CIR00
     C                   Z-ADD     VDAT          TNIPD                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C**  IF OUR INTEREST IS UP FRONT (DISCOUNT OR YIELD)                 CIR001
     C**  OUR FIRST INTEREST PAYMENT DATE IS VALUE DATE                   CIR001
     C*                                                                   CIR001
     C     UINPM         IFEQ      'D'                                                         CIR00
     C     UINPM         OREQ      'Y'                                                         CIR00
     C                   Z-ADD     VDAT          UNIPD                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C**  SET ON VALUE DATE BIT                                           CIR001
     C*                                                                   CIR001
     C                   BITON     '1'           ACEI                                          CIR00
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 CIR001
     C*                                                                   CIR001
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                 230171
      *                                                                                       230171
      ** If CIR001 is not installed, blank out URFIN and TRFIN for                            230171
      ** value date processing.                                                               230171
      *                                                                                       230171
     C                   TESTB     '1'           ACEI                 31                      230171
     C     VDAT          IFLE      EVCD                                                       230171
     C     *IN31         ANDEQ     '1'                                                        230171
      *                                                                                       230171
     C     CSW005        IFEQ      'Y'                                                        230171
     C     CSW011        OREQ      'Y'                                                        230171
      *                                                                                       230171
     C     UINFD         IFLE      VDAT                                                       230171
     C     UINFD         ORGT      BJRDNB                                                     230171
     C                   MOVE      'Y'           BLKUF             1                          230171
     C                   END                                                                  230171
      *                                                                                       230171
     C     TINFD         IFLE      VDAT                                                       230171
     C     TINFD         ORGT      BJRDNB                                                     230171
     C                   MOVE      'Y'           BLKTF             1                          230171
     C                   END                                                                  230171
      *                                                                                       230171
     C                   END                                                                  230171
      *                                                                                       230171
     C                   END                                                                  230171
      *                                                                                       230171
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* INTEREST DATE PROCESSING                                          S01119
     C*                                                                   S01119
     C*   THEIR WORK FIELD                                                S01119
     C*   IF INTEREST PAYMENT DATE IS ZERO,USE INTEREST CHANGE DATE       S01119
     C*   UNLESS IT IS ALSO ZERO.IN THIS CASE INTEREST PAYMENT IS         S01119
     C*   ON MATURITY DATE                                                S01119
     C     TNIPD         IFEQ      0                                                           S0111
     C     TNICD         IFNE      0                                                           S0111
     C                   Z-ADD     TNICD         WNIPDT            5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPDT                                        S0111
      *                                                                   188689
      ** If Maturity Date equals previously processed  Interest           188689
      ** Payment, set Start/Last Interest payment date to zero            188689
      ** to process Interest Accrual entry reversal.                      188689
      *                                                                   188689
     C                   TESTB     '2'           ACEI                 31                       18868
     C     WNIPDT        IFEQ      TSLIP                                                       18868
     C     *IN31         ANDEQ     '1'                                                         18868
     C                   Z-ADD     0             TSLIP                                         18868
     C                   END                                                                   18868
      *                                                                   188689
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TNIPD         WNIPDT                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*   OUR WORK FIELD                                                  S01119
     C*   IF INTEREST PAYMENT DATE IS ZERO,USE INTEREST CHANGE DATE       S01119
     C*   UNLESS IT IS ALSO ZERO.IN THIS CASE INTEREST PAYMENT IS         S01119
     C*   ON MATURITY DATE                                                S01119
     C*                                                                   S01119
     C     UNIPD         IFEQ      0                                                           S0111
     C     UNICD         IFNE      0                                                           S0111
     C                   Z-ADD     UNICD         WNIPDU            5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPDU                                        S0111
      *                                                                   188689
      ** If Maturity Date equals previously processed  Interest           188689
      ** Payment, set Start/Last Interest payment date to zero            188689
      ** to process Interest Accrual entry reversal.                      188689
      *                                                                   188689
     C                   TESTB     '2'           ACEI                 31                       18868
     C     WNIPDU        IFEQ      USLIP                                                       18868
     C     *IN31         ANDEQ     '1'                                                         18868
     C                   Z-ADD     0             USLIP                                         18868
     C                   END                                                                   18868
      *                                                                   188689
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     UNIPD         WNIPDU                                        S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C412
     C*                                                                   CIR001
     C** IF INTEREST IS UP FRONT (DISCOUNT OR YIELD)                      CIR001
     C** DETERMINE INTEREST PAYMENT DATE AFTER NEXT INTEREST PAYMENT      CIR001
     C** DATE (TERMED THE NEXT INTEREST END DATE)                         CIR001
     C** ELSE THIS DATE IS THE SAME AS THE NEXT INTEREST PAYMENT DATE     CIR001
     C** THEIRS:                                                          CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     TINPM         IFEQ      'D'                                                         CIR00
     C     TINPM         OREQ      'Y'                                                         CIR00
     C                   MOVEL     'T'           OTIN                                          CIR00
     C                   MOVEL     'P'           RCIP                                          CIR00
     C                   Z-ADD     WNIPDT        ZDAYNO                                        CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        WNIEDT            5 0                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     WNIPDT        WNIEDT                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** OURS:                                                            CIR001
     C*                                                                   CIR001
     C     UINPM         IFEQ      'D'                                                         CIR00
     C     UINPM         OREQ      'Y'                                                         CIR00
     C                   MOVEL     'U'           OTIN                                          CIR00
     C                   MOVEL     'P'           RCIP                                          CIR00
     C                   Z-ADD     WNIPDU        ZDAYNO                                        CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        WNIEDU            5 0                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     WNIPDU        WNIEDU                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C** SET OFF FLAGS                                                    S01119
     C*                                                                   S01119
     C                   MOVE      ' '           THR               1                           S0111
     C                   MOVE      ' '           OUR               1                           S0111
     C                   MOVE      ' '           TFX               1                         BUG7531
     C                   MOVE      ' '           OFX               1                         BUG7531
      *                                                                                       204923
      ** If CIR007 is on, retrieve Rate Fix Days Adjustment for deal ccy.                     204923
      *                                                                                       204923
     C                   Z-ADD     WNIPDU        WUNIPD            5 0
     C                   Z-ADD     WNIPDT        WTNIPD            5 0
      *                                                                                       204923
     C     CIR007        IFEQ      'Y'
      *                                                                                       204923
     C                   CALL      'AOCURRR0'
     C                   PARM      *BLANKS       PRTCD
     C                   PARM      '*KEY   '     POPTN
     C                   PARM      UCUCY         PCURCY
     C     SDCURR        PARM      SDCURR        DSSDY
      *                                                                                       204923
     C     PRTCD         IFNE      *BLANK
     C                   MOVEL     'SDCURRPD'    DBFILE
     C                   MOVE      '040'         DBASE
     C                   MOVEL     PCURCY        DBKEY
     C                   SETON                                        U7U8LR
     C                   EXSR      *PSSR
     C                   ELSE
     C                   Z-ADD     A6FXDY        WFXDY             1 0
     C                   ENDIF
      *                                                                                       204923
      ** If not 0, adjust the Next Int Payment dates by the Rate Fix Days                     204923
      ** Adjustment for sides which are OIS.                                                  204923
      *                                                                                       204923
     C     WFXDY         IFNE      0
      *                                                                                       204923
      ** OURS                                                                                 204923
      *                                                                                       204923
     C     UICFR         IFEQ      'O'
     C                   Z-ADD     WNIPDU        ZDAYNO
     C                   Z-ADD     1             ZNRDYS
     C                   MOVE      BJLCCY        ZCCY
     C                   EXSR      ZFWDT
     C                   MOVE      ZDYNBR        WUNIPD
     C                   ENDIF
      *                                                                                       204923
      ** THEIRS                                                                               204923
      *                                                                                       204923
     C     TICFR         IFEQ      'O'
     C                   Z-ADD     WNIPDT        ZDAYNO
     C                   Z-ADD     1             ZNRDYS
     C                   MOVE      BJLCCY        ZCCY
     C                   EXSR      ZFWDT
     C                   MOVE      ZDYNBR        WTNIPD
     C                   ENDIF
      *                                                                                       204923
     C                   ENDIF
     C                   ENDIF
     C*                                                                   S01119
     C** SHADOW POST                                                      S01119
     C*                                                                   S01119
     C     *INU1         IFNE      '1'                                                         S0111
     C     WTNIPD        CABLE     EVCD          RSHAD1
     C     WUNIPD        CABLE     EVCD          RSHAD2
     C*                                                                   CIR001
     C** If no interest payments are due, go to tag RSMDAT to             CIR001
     C** process buy-out payment                                          CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   GOTO      RSMDAT                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   GOTO      RSSEND                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  DATE PROCESSING                                                  S01119
     C*                                                                   S01119
     C     RSDATE        TAG                                                    ** RSDATE TAG**S0111
      *                                                                                       204923
     C                   Z-ADD     WNIPDU        WUNIPD            5 0
     C                   Z-ADD     WNIEDU        WUNIED            5 0
     C                   Z-ADD     UINFD         WUINFD            5 0
     C                   Z-ADD     WNIPDT        WTNIPD            5 0
     C                   Z-ADD     WNIEDT        WTNIED            5 0
     C                   Z-ADD     TINFD         WTINFD            5 0
      *                                                                                       204923
     C     CIR007        IFEQ      'Y'
     C     WFXDY         ANDNE     0
      *                                                                                       204923
      ** OURS                                                                                 204923
      *                                                                                       204923
     C     UICFR         IFEQ      'O'
     C                   Z-ADD     WNIPDU        ZDAYNO
     C                   Z-ADD     1             ZNRDYS
     C                   MOVE      BJLCCY        ZCCY
     C                   EXSR      ZFWDT
     C                   MOVE      ZDYNBR        WUNIPD
      *                                                                                       204923
     C     MDAT          IFNE      USLIP
     C                   Z-ADD     WNIEDU        ZDAYNO
     C                   Z-ADD     1             ZNRDYS
     C                   MOVE      BJLCCY        ZCCY
     C                   EXSR      ZFWDT
     C                   MOVE      ZDYNBR        WUNIED
     C                   ENDIF
      *                                                                                       204923
     C     UINFD         IFGT      0
     C                   Z-ADD     UINFD         ZDAYNO
     C                   Z-ADD     1             ZNRDYS
     C                   MOVE      BJLCCY        ZCCY
     C                   EXSR      ZFWDT
     C                   MOVE      ZDYNBR        WUINFD
     C                   ENDIF
     C                   ENDIF
      *                                                                                       204923
      ** THEIRS                                                                               204923
      *                                                                                       204923
     C     TICFR         IFEQ      'O'
     C                   Z-ADD     WNIPDT        ZDAYNO
     C                   Z-ADD     1             ZNRDYS
     C                   MOVE      BJLCCY        ZCCY
     C                   EXSR      ZFWDT
     C                   MOVE      ZDYNBR        WTNIPD
      *                                                                                       204923
     C     MDAT          IFNE      TSLIP
     C                   Z-ADD     WNIEDT        ZDAYNO
     C                   Z-ADD     1             ZNRDYS
     C                   MOVE      BJLCCY        ZCCY
     C                   EXSR      ZFWDT
     C                   MOVE      ZDYNBR        WTNIED
     C                   ENDIF
      *                                                                                       204923
     C     TINFD         IFGT      0
     C                   Z-ADD     TINFD         ZDAYNO
     C                   Z-ADD     1             ZNRDYS
     C                   MOVE      BJLCCY        ZCCY
     C                   EXSR      ZFWDT
     C                   MOVE      ZDYNBR        WTINFD
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C*                                                                   CIR001
     C**  PRINCIPAL CHANGE DUE                                            CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     UNPCD         IFLE      EVCD                                                        CIR00
     C     UNPCD         ANDNE     *ZERO                                                       CIR00
     C*                                                                   CIR001
     C**  AND NO OTHER EVENTS PRIOR TO THE PRINCIPAL CHANGE               CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C233
     C     WNIPDT        IFLE      UNPCD                                                       CIR00
     C/COPY WNCPYSRC,DL0280C234
     C     WNIPDT        ANDNE     *ZERO                                                       CIR00
     C/COPY WNCPYSRC,DL0280C418
     C     WNIPDU        ORLE      UNPCD                                                       CIR00
     C     WNIPDU        ANDNE     *ZERO                                                       CIR00
     C/COPY WNCPYSRC,DL0280C235
     C     TINFD         ORLE      UNPCD                                                       CIR00
     C/COPY WNCPYSRC,DL0280C236
     C     TINFD         ANDNE     *ZERO                                                       CIR00
     C     TFX           ANDNE     ' '                                                       BUG7531
     C     UINFD         ORLE      UNPCD                                                       CIR00
     C     UINFD         ANDNE     *ZERO                                                       CIR00
     C     OFX           ANDNE     ' '                                                       BUG7531
     C/COPY WNCPYSRC,DL0280C237
     C     TNICD         ORLE      UNPCD                                                       CIR00
     C/COPY WNCPYSRC,DL0280C238
     C     TNICD         ANDNE     *ZERO                                                       CIR00
     C     UNICD         ORLE      UNPCD                                                       CIR00
     C     UNICD         ANDNE     *ZERO                                                       CIR00
     C                   ELSE                                                                  CIR00
     C                   GOTO      RSPRCH                                                      CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** THEIR INTEREST PAYMENT DATE TO BE PROCESSED                      CIR001
     C*                                                                   CIR001
     C     WTNIPD        IFLE      EVCD
     C     WTNIED        ANDGT     TSLIP
     C                   GOTO      RSPROC                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** OUR INTEREST PAYMENT DATE TO BE PROCESSED                        CIR001
     C*                                                                   CIR001
     C     WUNIPD        IFLE      EVCD
     C     WUNIED        ANDGT     USLIP
     C                   GOTO      RSPROC                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   S01119
     C*  THEIR INTEREST PAYMENT DATE TO BE PROCESSED                      S01119
     C     WTNIPD        IFLE      EVCD
     C     WTNIPD        ANDGT     TSLIP
     C                   GOTO      RSPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*    OUR INTEREST PAYMENT DATE TO BE PROCESSED                      S01119
     C     WUNIPD        IFLE      EVCD
     C     WUNIPD        ANDGT     USLIP
     C                   GOTO      RSPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*  THEIR INTEREST FIX DATE TO BE PROCESSED                          S01119
     C     WTINFD        IFGT      0
     C     WTINFD        ANDLE     EVCD
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  OUR INTEREST FIX DATE TO BE PROCESSED                            S01119
     C     WUINFD        IFGT      0
     C     WUINFD        ANDLE     EVCD
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  THEIR INTEREST CHANGE DATE TO BE PROCESSED                       S01119
     C     TNICD         IFGT      0                                                           S0111
     C     TNICD         ANDLE     EVCD                                                        S0111
     C                   GOTO      RSPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*    OUR INTEREST CHANGE DATE TO BE PROCESSED                       S01119
     C     UNICD         IFGT      0                                                           S0111
     C     UNICD         ANDLE     EVCD                                                        S0111
     C                   GOTO      RSPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  OTHERWISE NO REPEATING EVENT DATES TO BE PROCESSED.              S01119
     C                   GOTO      RSMDAT                                                      S0111
     C*                                                                   CIR001
     C** PRINCIPAL CHANGE DUE                                             CIR001
     C*                                                                   CIR001
     C     RSPRCH        TAG                                                                   CIR00
     C*                                                                   CIR001
     C** CALCULATE INTEREST TO BRING ACCRUALS UP TO PRINCIPAL CHANGE DATE CIR001
     C** PRIOR TO UPDATE OF PRINCIPAL                                     CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C** THEIRS                                                           CIR001
     C*                                                                   CIR001
     C                   Z-ADD     TEINR         ZIRATE                                        CIR00
     C                   Z-ADD     TPAMT         ZIAMT                                         CIR00
     C                   Z-ADD     TICBS         ZICALC                                        CIR00
     C                   Z-ADD     TIACD         ZIBEG                                         CIR00
     C                   Z-ADD     TNPCD         ZIEND                                         CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add their unsettled interest and    t  CIR002
     C**    adjustment to their principal.                                CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C642
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   EXSR      GLINTC                                                      CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C*                                                                   CIR001
     C** UPDATES                                                          CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C419
     C                   Z-ADD     0             TIALC                                         CIR00
     C                   ADD       WKINT         TAITC                                         CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TICBS         ZICALC
     C                   Z-ADD     TIACD         ZIBEG
     C                   Z-ADD     TNPCD         ZIEND
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   Z-ADD     TPAMT         ZIAMT
      *                                                                                       CAS005
      ** If CIR002 is switched on, add their unsettled interest and                           CAS005
      ** adjustment to their principal.                                                       CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'L'
     C                   ADD       TUSI          ZIAMT
     C                   ADD       TUSA          ZIAMT
     C                   ENDIF
     C                   EXSR      GLINTC
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   Z-ADD     0             FSTALB
     C                   ADD       WINTST        FSTITB
     C                   ENDIF
     C                   Z-ADD     TNPCD         TIACD                                         CIR00
     C/COPY WNCPYSRC,DL0280C420
     C*                                                                   CIR001
     C** OURS                                                             CIR001
     C*                                                                   CIR001
     C                   Z-ADD     UEINR         ZIRATE                                        CIR00
     C                   Z-ADD     UPAMT         ZIAMT                                         CIR00
     C                   Z-ADD     UICBS         ZICALC                                        CIR00
     C                   Z-ADD     UIACD         ZIBEG                                         CIR00
     C                   Z-ADD     UNPCD         ZIEND                                         CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add our unsettled interest and      t  CIR002
     C**    adjustment to our principal.                                  CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C643
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   EXSR      GLINTC                                                      CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C*                                                                   CIR001
     C** UPDATES                                                          CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C421
     C                   Z-ADD     0             UIALC                                         CIR00
     C                   ADD       WKINT         UAITC                                         CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UICBS         ZICALC
     C                   Z-ADD     UIACD         ZIBEG
     C                   Z-ADD     UNPCD         ZIEND
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   Z-ADD     FSUPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR002 is switched on, add our unsettled interest and                             CAS005
      ** adjustment to our principal.                                                         CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'L'
     C                   ADD       OUSI          ZIAMT
     C                   ADD       OUSA          ZIAMT
     C                   ENDIF
     C                   EXSR      GLINTC
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   Z-ADD     0             FSUALB
     C                   ADD       WINTST        FSUITB
     C                   ENDIF
     C                   Z-ADD     UNPCD         UIACD                                         CIR00
     C/COPY WNCPYSRC,DL0280C422
     C*                                                                   CIR001
     C** GET PRINCIPAL CHANGE AMOUNT AND 'NEXT' PRINCIPAL CHANGE DATE     CIR001
     C*                                                                   CIR001
     C** PRINCIPAL KEY                                                    CIR001
     C                   MOVEA     'RSD'         AKY(1)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '   IA'       AKY(6)                                        14578
     C                   MOVEL     NEV(8)        NARREV                                        CIR00
     C                   MOVE      UFRDKY        FRDKY                                         CIR00
     C                   Z-ADD     UNPCD         KYDAT                                         CIR00
     C                   Z-ADD     UNPCD         KYFED                                         CIR00
     C                   TESTB     '0'           UDNSI                31                       CIR00
     C*                                                                   CIR001
     C** SUPPRESS PRINT OF ZERO BASE RATE                                 CIR001
     C*                                                                   CIR001
     C     NRBRTT        IFEQ      '00'                                                        CIR00
     C                   MOVE      '  '          NRBRTT                                        CIR00
     C                   SETOFF                                       31                       CIR00
     C                   END                                                                   CIR00
     C                   MOVE      *BLANK        PORTH                                         CIR00
     C                   EXSR      #LPRCH                                                      CIR00
     C*                                                                   CIR001
     C** Compute the difference between the new principal amount          CIR001
     C** and the old principal amount.  If the result is negative,        CIR001
     C** then it is a principal DECREASE. Else, if positive, then         CIR001
     C** its a principal INCREASE.                                        CIR001
     C*                                                                   CIR001
     C                   Z-ADD     0             WPDIF            15 0                         CIR00
     C                   MOVE      ' '           WPIOD             1                           CIR00
     C     WPAMT         IFNE      0                                                           CIR00
     C/COPY WNCPYSRC,DL0280C265
     C     WPAMT         SUB       UPAMT         WPDIF                                         CIR00
     C     WPDIF         IFLT      0                                                           CIR00
     C                   MOVE      'D'           WPIOD                                         CIR00
     C                   Z-SUB     WPDIF         WPDIF                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'I'           WPIOD                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C266
     C                   Z-ADD     WPAMT         NRRPUR                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   Z-ADD     WPDIF         KYAMT                                         CIR00
     C*                                                                   CIR001
     C     WPIOD         IFEQ      'D'                                                         CIR00
     C                   MOVE      'M'           AKY(3)                                        CIR00
     C                   MOVE      'D'           AKY(9)                                        11225
     C                   MOVEL     NEV(9)        NARREV                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   SETON                                        71                       CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   MOVE      TFRDKY        FRDKY                                         CIR00
     C                   TESTB     '0'           TDNSI                31                       CIR00
     C*                                                                   CIR001
     C** SUPPRESS PRINT OF ZERO BASE RATE                                 CIR001
     C*                                                                   CIR001
     C     NRBRTT        IFEQ      '00'                                                        CIR00
     C                   MOVE      '  '          NRBRTT                                        CIR00
     C                   SETOFF                                       31                       CIR00
     C                   END                                                                   CIR00
     C                   EXCEPT    FITHR2                                                      CIR00
     C*                                                                   CIR001
     C**  EXPOSURE KEY                                                    CIR001
     C**  OUR EXPOSURE AMOUNT CALCULATED BETWEEN PRINCIPAL CHANGE AND     CIR001
     C**  MATURITY                                                        CIR001
     C*                                                                   CIR001
     C                   MOVE      DTYP          RRDT                                          CIR00
     C                   Z-ADD     KYAMT         RRPA                                          CIR00
     C                   Z-ADD     KYDAT         RRSD                                          CIR00
     C                   Z-ADD     MDAT          RRED                                          CIR00
     C                   EXSR      DLRREX                                                      CIR00
     C                   Z-ADD     RREA          KYAMT                                         CIR00
     C     WPIOD         IFEQ      'D'                                                         CIR00
     C                   SUB       RREA          UAEXA                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   ADD       RREA          UAEXA                                         CIR00
     C                   END                                                                   CIR00
     C                   MOVE      'E'           AKY(10)                                       CIR00
     C                   MOVE      UFRDKY        FRDKY                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C     WPDIF         IFNE      0                                                           CIR00
     C/COPY WNCPYSRC,DL0280C267
     C     WPAMT         SUB       UPAMT         WDIFF            13 0                         CIR00
     C                   Z-ADD     WPAMT         UPAMT                                         CIR00
     C/COPY WNCPYSRC,DL0280C268
     C*                                                                   CIR001
     C**  UPDATE 'VALUE OF CAPITALIZATIONS' FOR AUDIT CONTROL             CIR001
     C*                                                                   CIR001
     C     WDIFF         DIV       1000          ZZAMT                                         CIR00
     C                   Z-ADD     NETCII        ZZTOTI                                        CIR00
     C                   Z-ADD     NETCID        ZZTOTD                                        CIR00
     C                   EXSR      GLZADD                                                      CIR00
     C                   Z-ADD     ZZTOTI        NETCII                                        CIR00
     C                   Z-ADD     ZZTOTD        NETCID                                        CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     UPAMT         TPAMT                                         CIR00
     C*                                                                   CIR001
     C                   MOVE      ' '           AKY(9)                                        11225
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 CIR001
     C*                                                                   CIR001
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   GOTO      RSDATE                                                      CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* THEIR INTEREST PAY DATE                                           S01119
     C*                                                                   S01119
     C     RSPROC        TAG                                                    ** RSPROC TAG**S0111
     C*                                                                   S01119
     C*  IN ORDER TO CONTINUE WITH THEIR NEXT INTEREST DATE IT MUST BE:   S01119
     C*  1) GREATER THAN THEIR START LAST INTEREST PAYMENT DATE           S01119
     C*  2) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  3) LESS THAN OR EQUAL TO OUR NEXT INTEREST PAYMENT DATE          S01119
     C*     AND OUR START/LAST INTEREST PAYMENT DATE                      S01119
     C*  4) LESS THAN OR EQUAL TO THEIR NEXT INTEREST FIX DATE            S01119
     C*     IF THEIR NEXT INTEREST FIX DATE IS NON ZERO                   S01119
     C*  5) LESS THAN OR EQUAL TO OUR NEXT INTEREST FIX DATE              S01119
     C*     IF OUR NEXT INTEREST FIX DATE IS NON ZERO                     S01119
     C*  6) LESS THAN OR EQUAL TO THEIR NEXT INTEREST CHANGE DATE         S01119
     C*     IF THEIR NEXT INTEREST CHANGE DATE IS NON ZERO                S01119
     C*  7) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO OUR INTEREST PAYMENT DATE CHECK                  S01119
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C504
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     WTNIED        IFLE      TSLIP
     C                   GOTO      RSUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C                   ELSE                                                                  CIR00
     C     WTNIPD        IFLE      TSLIP
     C                   GOTO      RSUIPD                                                      S0111
     C                   END                                                                   S0111
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C     WTNIPD        IFGT      EVCD
     C                   GOTO      RSUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     WTNIPD        IFGT      WUNIPD
     C     WUNIED        ANDGT     USLIP
     C                   GOTO      RSUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WTNIED        IFGT      WTINFD
     C     WTINFD        ANDLE     EVCD
     C     WTINFD        ANDGT     0
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WTNIED        IFGT      WUINFD
     C     WUINFD        ANDLE     EVCD
     C     WUINFD        ANDGT     0
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WTNIED        IFGT      TNICD
     C     TNICD         ANDLE     EVCD                                                        CIR00
     C     TNICD         ANDGT     0                                                           CIR00
     C                   GOTO      RSUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WTNIED        IFGT      UNICD
     C     UNICD         ANDLE     EVCD                                                        CIR00
     C     UNICD         ANDGT     0                                                           CIR00
     C                   GOTO      RSUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C     WTNIPD        IFGT      WUNIPD
     C     WUNIPD        ANDGT     USLIP
     C                   GOTO      RSUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WTNIPD        IFGT      WTINFD
     C     WTINFD        ANDGT     0
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WTNIPD        IFGT      WUINFD
     C     WUINFD        ANDGT     0
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WTNIPD        IFGT      TNICD
     C     TNICD         ANDGT     0                                                           S0111
     C                   GOTO      RSUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WTNIPD        IFGT      UNICD
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RSUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** IF THEIR SIDE DONE ALREADY, THEN BYPASS                          CIR001
     C*                                                                   CIR001
     C     THR           IFNE      *BLANK                                                      CIR00
     C     CIR001        ANDEQ     'Y'                                                         CIR00
     C                   GOTO      RSUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     RSHAD1        TAG                                                    ** RSHAD1 TAG**S0111
     C*                                                                   S01119
     C                   MOVEA     'RSI'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    I'       AKY(6)                                        S0111
     C                   MOVE      'R'           AKY(9)                                        S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
     C                   Z-ADD     WNIPDT        KYDAT                                         S0111
     C                   Z-ADD     WNIPDT        KYFED                                         S0111
      *                                                                   S01119
      * DLRSIN                                                            S01119
      *                                                                   S01119
      *        (THEIRS)                                                   S01119
     C                   Z-ADD     TIACD         SZIACD            5 0                         S0111
     C                   Z-ADD     WNIPDT        SZEDAT            5 0                         S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     WNIEDT        SZEDAT                                        CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     TEINR         SZINR            11 7                         S0111
     C                   Z-ADD     TPAMT         SZPPL            13 0                         S0111
     C                   MOVE      TCUCY         SZCCY             3                           S0111
     C                   MOVE      RSCY          SZECY             3                           13479
     C                   Z-ADD     BNHKTR        SZITR            11 7                         S0119
     C                   Z-ADD     TAIPD         SZIPTD           13 0                         S0111
     C                   Z-ADD     TAIAP         SZAIAP           13 0                         S0111
     C                   Z-ADD     TAIAN         SZIANP           13 0                         S0111
     C                   Z-ADD     TAITC         SZAICD           13 0                         S0111
     C                   Z-ADD     TIPRM         SZIPRM           13 0                         S0111
     C                   Z-ADD     TIPRD         SZIPRD           13 0                         S0111
     C                   Z-ADD     TTAXD         SZTPTD           13 0                         S0111
     C                   Z-ADD     TTAXM         SZTPTM           13 0                         S0111
     C                   Z-ADD     TICBS         SZCBS             1 0                         S0111
     C                   MOVE      'I'           SZETYP            1                           S0111
     C                   MOVE      TIPFR         SZIPFC            1                           S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   MOVE      TINPM         SZINPM            1                           CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     TIPFD         SZIPD             2 0                         S0111
     C                   Z-ADD     MDAT          SZMDAT            5 0                         S0111
     C                   Z-ADD     TIPBD         SZIPBD            5 0                         S0111
     C                   MOVE      'N'           SZRLPI            1                           S0111
     C                   Z-ADD     TIALC         SZLICD           13 0                         S0111
     C                   Z-ADD     TLPCD         SZSLID            5 0                         S0111
     C                   MOVE      CNFI          SZCNFI            1                           S0111
     C                   MOVE      TLXI          SZTLXI            1                           S0111
     C                   MOVE      AKY(9)        SZDIR             1                           S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TIACD         TZIACD            5 0
     C                   Z-ADD     WNIPDT        TZEDAT            5 0
     C                   Z-ADD     FSTPAM        TZPPL            13 0
     C                   MOVE      TCUCY         TZCCY             3
     C                   MOVE      RSCY          TZECY             3
     C                   Z-ADD     TTAXD         TZTPTD           13 0
     C                   Z-ADD     TTAXM         TZTPTM           13 0
     C                   Z-ADD     TICBS         TZCBS             1 0
     C                   MOVE      'I'           TZETYP            1
     C                   MOVE      TIPFR         TZIPFC            1
     C                   Z-ADD     TIPFD         TZIPD             2 0
     C                   Z-ADD     MDAT          TZMDAT            5 0
     C                   Z-ADD     TIPBD         TZIPBD            5 0
     C                   MOVE      'N'           TZRLPI            1
     C                   Z-ADD     TLPCD         TZSLID            5 0
     C                   Z-ADD     FSTIPB        TZIPTD           13 0
     C                   Z-ADD     FSTIAB        TZAIAP           13 0
     C                   Z-ADD     FSTINB        TZIANP           13 0
     C                   Z-ADD     FSTITB        TZAICD           13 0
     C                   Z-ADD     FSTPMB        TZIPRM           13 0
     C                   Z-ADD     FSTPRB        TZIPRD           13 0
     C                   Z-ADD     FSTALB        TZLICD           13 0
     C                   ENDIF
     C*                                                                   CIR002
     C** If their interest is NOT up-front, add Their Unsettled Interest  CIR002
     C** Amount (TUSI) and Their Unsettled Interest Adjustment (TUSA)     CIR002
     C** to amount parameter (SZPPL)                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C644
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     TINPM         ANDNE     'D'                                                         CIR00
     C     TINPM         ANDNE     'Y'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          SZPPL                                         CIR00
     C                   ADD       TUSA          SZPPL                                         CIR00
     C     CAS005        IFEQ      'Y'
     C                   ADD       TUSI          TZPPL
     C                   ADD       TUSA          TZPPL
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
      *                                                                   CSW097
      ** Set up Receipt - Settlement Method and Nostro parameter          CSW097
     C                   Z-ADD     RSTM          SZSETM            2 0                         CSW09
     C                   MOVE      RONS          SZNOST            2                           CSW09
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     RSTM          TZSETM            2 0
     C                   MOVE      RONS          TZNOST            2
     C                   ENDIF
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'D'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'Y'                                                         CIR00
     C                   EXSR      #LRSIU                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSIU
     C                   ENDIF
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C244
     C                   EXSR      DLRSIN                                                      S0111
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSIN
     C                   ENDIF
     C                   END                                                                   CIR00
      *        (RESULT)                                                   S01119
     C/COPY WNCPYSRC,DL0280C391
     C                   Z-ADD     SZAICD        TAITC                                         S0111
     C                   Z-ADD     SZIPTD        TAIPD                                         S0111
     C                   Z-ADD     SZAIAP        TAIAP                                         S0111
     C                   Z-ADD     SZIANP        TAIAN                                         S0111
     C                   Z-ADD     SZIPRM        TIPRM                                         S0111
     C                   Z-ADD     SZIPRD        TIPRD                                         S0111
     C                   Z-ADD     SZTPTD        TTAXD                                         S0111
     C                   Z-ADD     SZTPTM        TTAXM                                         S0111
     C                   MOVE      SZIPFC        TIPFR                                         S0111
     C                   Z-ADD     SZIPD         TIPFD                                         S0111
     C                   Z-ADD     SZLICD        TIALC                                         S0111
     C     TBRTT         IFNE      0                                                           S0111
     C                   Z-ADD     SZSLID        TLPCD                                         S0111
     C                   END                                                                   S0111
     C                   MOVE      SZCNFI        CNFI                                          S0111
     C                   MOVE      SZTLXI        TLXI                                          S0111
     C*  SET FIELD FOR NET INTEREST CALCULATION CHECK/KEY GENERATION      S01119
     C                   Z-ADD     SZINOT        WINOTT           13 0                         S0111
     C                   Z-ADD     SZSLID        TSLIP                                         S0111
     C                   Z-ADD     SZIPBD        TIPBD                                         S0111
     C                   Z-ADD     SZIACD        TIACD                                         S0111
     C* IN ORDER TO ALLOW DATE DEFAULT ABOVE TO TAKE EFFECT ONLY UPDATE   S01119
     C*     NEXT INTEREST PAYMENT DATE IF IT WAS NOT ORIGINALLY ZERO      S01119
     C     TNIPD         IFNE      0                                                           S0111
     C                   Z-ADD     SZNIPD        TNIPD                                         S0111
     C                   END                                                                   S0111
     C*     SET INDICATOR TO SHOW THAT THEIR DATE HAS BEEN ACTIONED       S01119
     C                   MOVE      'Y'           THR                                           S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TZAICD        FSTITB
     C                   Z-ADD     TZIPTD        FSTIPB
     C                   Z-ADD     TZAIAP        FSTIAB
     C                   Z-ADD     TZIANP        FSTINB
     C                   Z-ADD     TZIPRM        FSTPMB
     C                   Z-ADD     TZIPRD        FSTPRB
     C                   Z-ADD     TZLICD        FSTALB
     C                   ENDIF
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0280C392
     C*                                                                   CIR001
     C** If capitalised, set THR to 'N'                                   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'C'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'I'                                                         CIR00
     C                   MOVE      'N'           THR                                           CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   CIR002
     C** Reset Their Unsettled Interest Amount (TUSI) and                 CIR002
     C** Their Unsettled Interest Amount Adjustment (TUSA)                CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C645
     C                   Z-ADD     0             TUSI                                          CIR00
     C                   Z-ADD     0             TUSA                                          CIR00
     C                   END                                                                   CIR00
      *                                                                   186412
     C                   ADD       TAIAP         TAITC                                         18641
     C                   Z-ADD     *ZEROS        TAIAP                                         18641
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   ADD       FSTIAB        FSTITB
     C                   Z-ADD     *ZEROS        FSTIAB
     C                   ENDIF
     C*                                                                   S01119
     C* IF BOTH WORK INTERST PAYMENT DATES ARE EQUAL,THERE IS A           S01119
     C*  MATCHED PAYMENT SO PROCESS OUR DATE.OTHERWISE SKIP TO UPDATE     S01119
     C     WTNIPD        CABNE     WUNIPD        RSUNIP
     C*                                                                   S01119
     C     RSUIPD        TAG                                                    ** RSUIPD TAG**S0111
     C/COPY WNCPYSRC,DL0280C505
     C  NU1              GOTO      RSHAD2                                                      S0111
     C*                                                                   S01119
     C*  OUR INTEREST PAY DATE                                            S01119
     C*                                                                   S01119
     C*  IN ORDER TO CONTINUE WITH OUR NEXT INTEREST DATE IT MUST BE:     S01119
     C*  1) GREATER THAN OUR START LAST INTEREST PAYMENT DATE             S01119
     C*  2) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  3) LESS THAN OR EQUAL TO THEIR NEXT INTEREST FIX DATE            S01119
     C*     IF THEIR NEXT INTEREST FIX DATE IS NON ZERO                   S01119
     C*  4) LESS THAN OR EQUAL TO OUR NEXT INTEREST FIX DATE              S01119
     C*     IF OUR NEXT INTEREST FIX DATE IS NON ZERO                     S01119
     C*  5) LESS THAN OR EQUAL TO THEIR NEXT INTEREST CHANGE DATE         S01119
     C*     IF THEIR NEXT INTEREST CHANGE DATE IS NON ZERO                S01119
     C*  6) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO THEIR INTEREST FIX DATE CHECK                    S01119
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     WUNIED        IFLE      USLIP
     C                   GOTO      RSTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C                   ELSE                                                                  CIR00
     C     WUNIPD        IFLE      USLIP
     C                   GOTO      RSTIFD                                                      S0111
     C                   END                                                                   S0111
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C     WUNIPD        IFGT      EVCD
     C/COPY WNCPYSRC,DL0280C555
     C                   GOTO      RSTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     WUNIED        IFGT      WTINFD
     C     WTINFD        ANDLE     EVCD
     C     WTINFD        ANDGT     0
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WUNIED        IFGT      WUINFD
     C     WUINFD        ANDLE     EVCD
     C     WUINFD        ANDGT     0
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WUNIED        IFGT      TNICD
     C     TNICD         ANDLE     EVCD                                                        CIR00
     C     TNICD         ANDGT     0                                                           CIR00
     C                   GOTO      RSTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WUNIED        IFGT      UNICD
     C     UNICD         ANDLE     EVCD                                                        CIR00
     C     UNICD         ANDGT     0                                                           CIR00
     C                   GOTO      RSTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C     WUNIPD        IFGT      WTINFD
     C     WTINFD        ANDGT     0
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WUNIPD        IFGT      WUINFD
     C     WUINFD        ANDGT     0
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RSTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WUNIPD        IFGT      TNICD
     C     TNICD         ANDGT     0                                                           S0111
     C                   GOTO      RSTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WUNIPD        IFGT      UNICD
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RSTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** IF OUR SIDE DONE ALREADY, THEN BYPASS                            CIR001
     C*                                                                   CIR001
     C     OUR           IFNE      *BLANK                                                      CIR00
     C     CIR001        ANDEQ     'Y'                                                         CIR00
     C                   GOTO      RSTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C     RSHAD2        TAG                                                    ** RSHAD2 TAG**S0111
     C                   MOVEA     'RSI'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    I'       AKY(6)                                        S0111
     C                   MOVE      'P'           AKY(9)                                        S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
     C                   Z-ADD     WNIPDU        KYDAT                                         S0111
     C                   Z-ADD     WNIPDU        KYFED                                         S0111
      *                                                                   S01119
      * DLRSIN                                                            S01119
      *                                                                   S01119
      *        (OUR)                                                      S01119
     C                   Z-ADD     UIACD         SZIACD                                        S0111
     C                   Z-ADD     WNIPDU        SZEDAT                                        S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     WNIEDU        SZEDAT                                        CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     UEINR         SZINR                                         S0111
     C                   Z-ADD     UPAMT         SZPPL                                         S0111
     C                   MOVE      UCUCY         SZCCY                                         S0111
     C                   MOVE      PSCY          SZECY                                         13479
     C                   Z-ADD     BNHKTR        SZITR                                         S0119
     C                   Z-ADD     UAIPD         SZIPTD                                        S0111
     C                   Z-ADD     UAIAP         SZAIAP                                        S0111
     C                   Z-ADD     UAIAN         SZIANP                                        S0111
     C                   Z-ADD     UAITC         SZAICD                                        S0111
     C                   Z-ADD     UIPRM         SZIPRM                                        S0111
     C                   Z-ADD     UIPRD         SZIPRD                                        S0111
     C                   Z-ADD     UTAXD         SZTPTD                                        S0111
     C                   Z-ADD     UTAXM         SZTPTM                                        S0111
     C                   Z-ADD     UICBS         SZCBS                                         S0111
     C                   MOVE      'I'           SZETYP                                        S0111
     C                   MOVE      UIPFR         SZIPFC                                        S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   MOVE      UINPM         SZINPM                                        CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     UIPFD         SZIPD                                         S0111
     C                   Z-ADD     MDAT          SZMDAT                                        S0111
     C                   Z-ADD     UIPBD         SZIPBD                                        S0111
     C                   MOVE      'N'           SZRLPI                                        S0111
     C                   Z-ADD     UIALC         SZLICD                                        S0111
     C                   Z-ADD     ULPCD         SZSLID                                        S0111
     C                   MOVE      CNFI          SZCNFI                                        S0111
     C                   MOVE      TLXI          SZTLXI                                        S0111
     C                   MOVE      AKY(9)        SZDIR                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UIACD         TZIACD
     C                   Z-ADD     WNIPDU        TZEDAT
     C     CIR001        IFEQ      'Y'
     C                   Z-ADD     WNIEDU        TZEDAT
     C                   ENDIF
     C                   Z-ADD     FSUPAM        TZPPL
     C                   MOVE      UCUCY         TZCCY
     C                   MOVE      PSCY          TZECY
     C                   Z-ADD     UTAXD         TZTPTD
     C                   Z-ADD     UTAXM         TZTPTM
     C                   Z-ADD     UICBS         TZCBS
     C                   MOVE      'I'           TZETYP
     C                   MOVE      UIPFR         TZIPFC
     C                   Z-ADD     UIPFD         TZIPD
     C                   Z-ADD     MDAT          TZMDAT
     C                   Z-ADD     UIPBD         TZIPBD
     C                   MOVE      'N'           TZRLPI
     C                   Z-ADD     ULPCD         TZSLID
     C                   Z-ADD     FSUIPB        TZIPTD
     C                   Z-ADD     FSUIAB        TZAIAP
     C                   Z-ADD     FSUINB        TZIANP
     C                   Z-ADD     FSUITB        TZAICD
     C                   Z-ADD     FSUPMB        TZIPRM
     C                   Z-ADD     FSUPRB        TZIPRD
     C                   Z-ADD     FSUALB        TZLICD
     C                   ENDIF
     C*                                                                   CIR002
     C** If our interest is NOT up-front, add Our Unsettled Interest      CIR002
     C** Amount (OUSI) and Our Unsettled Interest Adjustment (OUSA)       CIR002
     C** to amount parameter (SZPPL)                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C646
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UINPM         ANDNE     'D'                                                         CIR00
     C     UINPM         ANDNE     'Y'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          SZPPL                                         CIR00
     C                   ADD       OUSA          SZPPL                                         CIR00
     C     CAS005        IFEQ      'Y'
     C                   ADD       OUSI          TZPPL
     C                   ADD       OUSA          TZPPL
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
      *                                                                   CSW097
      ** Set up Pay - Settlement Method and Nostro parameter              CSW097
     C                   Z-ADD     PSTM          SZSETM                                        CSW09
     C                   MOVE      PONS          SZNOST                                        CSW09
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     PSTM          SZSETM
     C                   MOVE      PONS          SZNOST
     C                   ENDIF
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'D'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'Y'                                                         CIR00
     C                   EXSR      #LRSIU                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSIU
     C                   ENDIF
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C245
     C                   EXSR      DLRSIN                                                      S0111
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSIN
     C                   ENDIF
     C                   END                                                                   CIR00
      *        (RESULT)                                                   S01119
     C/COPY WNCPYSRC,DL0280C393
     C                   Z-ADD     SZAICD        UAITC                                         S0111
     C                   Z-ADD     SZIPTD        UAIPD                                         S0111
     C                   Z-ADD     SZAIAP        UAIAP                                         S0111
     C                   Z-ADD     SZIANP        UAIAN                                         S0111
     C                   Z-ADD     SZIPRM        UIPRM                                         S0111
     C                   Z-ADD     SZIPRD        UIPRD                                         S0111
     C                   Z-ADD     SZTPTD        UTAXD                                         S0111
     C                   Z-ADD     SZTPTM        UTAXM                                         S0111
     C                   MOVE      SZIPFC        UIPFR                                         S0111
     C                   Z-ADD     SZIPD         UIPFD                                         S0111
     C                   Z-ADD     SZLICD        UIALC                                         S0111
     C     UBRTT         IFNE      0                                                           S0111
     C                   Z-ADD     SZSLID        ULPCD                                         S0111
     C                   END                                                                   S0111
     C                   MOVE      SZCNFI        CNFI                                          S0111
     C                   MOVE      SZTLXI        TLXI                                          S0111
     C*  SET FIELD FOR NET INTEREST CALCULATION CHECK/KEY GENERATION      S01119
     C                   Z-ADD     SZINOT        WINOTU           13 0                         S0111
     C                   Z-ADD     SZSLID        USLIP                                         S0111
     C                   Z-ADD     SZIPBD        UIPBD                                         S0111
     C                   Z-ADD     SZIACD        UIACD                                         S0111
     C* IN ORDER TO ALLOW DATE DEFAULT ABOVE TO TAKE EFFECT ONLY UPDATE   S01119
     C*     NEXT INTEREST PAYMENT DATE IF IT WAS NOT ORIGINALLY ZERO      S01119
     C     UNIPD         IFNE      0                                                           S0111
     C                   Z-ADD     SZNIPD        UNIPD                                         S0111
     C                   END                                                                   S0111
     C*     SET INDICATOR TO SHOW THAT OUR DATE HAS BEEN ACTIONED         S01119
     C                   MOVE      'Y'           OUR                                           S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TZAICD        FSUITB
     C                   Z-ADD     TZIPTD        FSUIPB
     C                   Z-ADD     TZAIAP        FSUIAB
     C                   Z-ADD     TZIANP        FSUINB
     C                   Z-ADD     TZIPRM        FSUPMB
     C                   Z-ADD     TZIPRD        FSUPRB
     C                   Z-ADD     TZLICD        FSUALB
     C                   ENDIF
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0280C394
     C*                                                                   CIR001
     C** If capitalised, set OUR to 'N'                                   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'C'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'K'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'I'                                                         CIR00
     C                   MOVE      'N'           OUR                                           CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   CIR002
     C** Reset Our Unsettled Interest Amount (OUSI) and                   CIR002
     C** Our Unsettled Interest Amount Adjustment (OUSA)                  CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C647
     C                   Z-ADD     0             OUSI                                          CIR00
     C                   Z-ADD     0             OUSA                                          CIR00
     C                   END                                                                   CIR00
      *                                                                   186412
     C                   ADD       UAIAP         UAITC                                         18641
     C                   Z-ADD     *ZEROS        UAIAP                                         18641
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   ADD       FSUIAB        FSUITB
     C                   Z-ADD     *ZEROS        FSUIAB
     C                   ENDIF
     C*                                                                   S01119
     C*  AS INTEREST PAYMENT DATE HAS BEEN PROCESSED SKIP TO UPDATE/NET   S01119
     C*  KEY GENERATION-THIS PREVENTS DATES BEING PROCESSED OUT OF        S01119
     C*  ORDER IF PROCESSING CONTINUES.E.G. IF PAYMENTS QUARTERLY AND     S01119
     C*  CHANGES MONTHLY EACH PAYMENT SHOULD BE FOLLOWED BY 3 CHANGES     S01119
     C                   GOTO      RSUNIP                                                      S0111
     C*                                                                   S01119
     C*  THEIR INTEREST FIX DATE                                          S01119
     C*                                                                   S01119
     C*  IN ORDER TO CONTINUE WITH THEIR INTEREST FIX DATE IT MUST BE:    S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*  3) LESS THAN OR EQUAL TO OUR NEXT INTEREST FIX DATE              S01119
     C*     IF OUR NEXT INTEREST FIX DATE IS NON ZERO                     S01119
     C*  4) LESS THAN OR EQUAL TO THEIR NEXT INTEREST CHANGE DATE         S01119
     C*     IF THEIR NEXT INTEREST CHANGE DATE IS NON ZERO                S01119
     C*  5) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*  6) RELATING TO A NON-ZERO BASE RATE                              S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO OUR INTEREST FIX DATE CHECK                      S01119
     C     RSTIFD        TAG                                                    ** RSTIFD TAG**S0111
     C*                                                                   S01119
     C     TFX           IFNE      *BLANK                                                    BUG7531
     C                   GOTO      RSUIFD                                                    BUG7531
     C                   ENDIF                                                               BUG7531
      *                                                                                      BUG7531
     C     WTINFD        IFGT      EVCD
     C                   GOTO      RSUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WTINFD        IFEQ      0
     C                   GOTO      RSUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WTINFD        IFGT      WUINFD
     C     WUINFD        ANDGT     0
     C                   GOTO      RSUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WTINFD        IFGT      TNICD
     C     TNICD         ANDGT     0                                                           S0111
     C                   GOTO      RSUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WTINFD        IFGT      UNICD
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RSUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TBRTT         IFEQ      0                                                           S0111
     C                   GOTO      RSUIFD                                                      S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C499
     C*                                                                   S01119
     C*  PROCESS DTRSX RECORD FOR THEIR DETAILS                           S01119
     C*                                                                   S01119
     C                   MOVE      'T'           DTLUT             1                           S0111
      *                                                                   CSW005
      ** If CSW005 is switched off OR                                     CSW005
      **    CSW005 is switched on  AND                                    CSW005
      **    Their Rate Fixing Indicator is BLANK                          CSW005
      **    OR Their Rate Fixing Indicator is 'A'                                             227642
      *                                                                   CSW005
     C     CSW005        IFEQ      'N'                                                         CSW00
     C     CSW011        ANDEQ     'N'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                         CSW00
     C     TRFIN         ANDEQ     ' '                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     TRFIN         ANDEQ     ' '                                                         CSW01
     C     CSW005        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'A'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'A'                                                        227642
     C                   MOVE      'Y'           WREAD             1
     C     CIR007        IFEQ      'Y'
     C     VDAT          ANDEQ     BJRDNB
     C     TICFR         ANDEQ     'O'
     C     WFXDY         ANDNE     0
     C                   MOVE      *BLANK        WREAD
     C                   ENDIF
     C*                                                                   S01119
     C     DASNDM        IFEQ      2                                                           S0111
     C     WREAD         ANDEQ     'Y'
     C     DLNODM        ORNE      DLNO                                                     MD036601
     C     WREAD         ANDEQ     'Y'                                                      MD036601
     C*                                                                   S01119
     C*  ACCESS AMENDMENT RECORD FOR DEAL IF NOT RECORD ALREADY FOUND     S01119
     C*                                                                   S01119
2424 C                   READ      DAMSX                                  31                   BHF64
     C*                                                                   CIR001
     C** IF SEQUENCE NUMBER IS '999', => TRAILER, HENCE IGNORE            CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     DASNDM        ANDEQ     999                                                         CIR00
     C                   GOTO      RSSEND                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* DATABASE ERROR IF NO RECORD FOUND                                 S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     DLNO          ORNE      DLNODM                                                      S0111
     C     TBRTT         ORNE      BRTTDM                                                      S0111
     C     TCUCY         ORNE      CCY                                                         S0111
     C**********         SETON                                        U7U8LR          S0111 AR547995
     C                   SETON                                        U5U7LR                AR547995
     C**********         EXCEPT    ERROR                                              S0111 AR547995
     C                   GOTO      EOJ                                                      AR547995
     C                   ELSE                                                                  S0111
0728 C     TOTDMD        ADD       1             TOTDMD            5 0                         S0111
0729 C     TOTDMS        ADD       1             TOTDMS                                        S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C   LR              GOTO      RSSEND                                                      S0111
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C                   EXSR      IRSAMD                                                      S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   MOVE      'Y'           TFX                                         BUG7531
     C*                                                                   S01119
     C*  AS INTEREST FIX DATE HAS BEEN PROCESSED SKIP TO UPDATE           S01119
     C*  THIS PREVENTS DATES BEING PROCESSED OUT OF ORDER                 S01119
     C                   GOTO      RSUNIP                                                      S0111
     C*                                                                   S01119
     C* OUR INTEREST FIX DATE                                             S01119
     C*                                                                   S01119
     C     RSUIFD        TAG                                                    ** RSUIFD TAG**S0111
     C*                                                                   S01119
     C*  IN ORDER TO CONTINUE WITH OUR INTEREST FIX DATE IT MUST BE:      S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*  3) LESS THAN OR EQUAL TO THEIR NEXT INTEREST CHANGE DATE         S01119
     C*     IF THEIR NEXT INTEREST CHANGE DATE IS NON ZERO                S01119
     C*  4) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*  5) RELATING TO A NON-ZERO BASE RATE                              S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO THEIR INTEREST CHANGE DATE CHECK                 S01119
     C     OFX           IFNE      *BLANK                                                    BUG7531
     C                   GOTO      RSTICD                                                    BUG7531
     C                   ENDIF                                                               BUG7531
      *                                                                                      BUG7531
     C     WUINFD        IFGT      EVCD
     C                   GOTO      RSTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WUINFD        IFEQ      0
     C                   GOTO      RSTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WUINFD        IFGT      TNICD
     C     TNICD         ANDGT     0                                                           S0111
     C                   GOTO      RSTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WUINFD        IFGT      UNICD
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RSTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     UBRTT         IFEQ      0                                                           S0111
     C                   GOTO      RSTICD                                                      S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C500
     C*                                                                   S01119
     C*  PROCESS DTRSX RECORD FOR OUR DETAILS                             S01119
     C*                                                                   S01119
     C                   MOVE      'U'           DTLUT             1                           S0111
      *                                                                   CSW005
      ** If CSW005 is switched off OR                                     CSW005
      **    CSW005 is switched on  AND                                    CSW005
      **    Our Rate Fixing Indicator is BLANK                            CSW005
      **    OR Our Rate Fixing Indicator is 'A'                                               227642
      *                                                                   CSW005
     C     CSW005        IFEQ      'N'                                                         CSW00
     C     CSW011        ANDEQ     'N'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                         CSW00
     C     URFIN         ANDEQ     ' '                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     URFIN         ANDEQ     ' '                                                         CSW01
     C     CSW005        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'A'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'A'                                                        227642
      *                                                                                       204923
     C                   MOVE      'Y'           WREAD
     C     CIR007        IFEQ      'Y'
     C     VDAT          ANDEQ     BJRDNB
     C     UICFR         ANDEQ     'O'
     C     WFXDY         ANDNE     0
     C                   MOVE      *BLANK        WREAD
     C                   ENDIF
     C*                                                                   S01119
     C     DASNDM        IFEQ      1                                                           S0111
     C     WREAD         ANDEQ     'Y'
     C     DLNODM        ORNE      DLNO                                                     MD036601
     C     WREAD         ANDEQ     'Y'                                                      MD036601
     C*                                                                   S01119
     C*  ACCESS AMENDMENT RECORD FOR DEAL IF NOT RECORD ALREADY FOUND     S01119
     C*                                                                   S01119
2424 C                   READ      DAMSX                                  31                   BHF64
     C*                                                                   CIR001
     C** IF SEQUENCE NUMBER IS '999', => TRAILER, HENCE IGNORE            CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     DASNDM        ANDEQ     999                                                         CIR00
     C                   GOTO      RSSEND                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* DATABASE ERROR IF NO RECORD FOUND                                 S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     DLNO          ORNE      DLNODM                                                      S0111
     C     UBRTT         ORNE      BRTTDM                                                      S0111
     C     UCUCY         ORNE      CCY                                                         S0111
     C**********         SETON                                        U7U8LR          S0111 AR547995
     C                   SETON                                        U5U7LR                AR547995
     C**********         EXCEPT    ERROR                                              S0111 AR547995
     C                   GOTO      EOJ                                                      AR547995
     C                   ELSE                                                                  S0111
0728 C     TOTDMD        ADD       1             TOTDMD            5 0                         S0111
0729 C     TOTDMS        ADD       1             TOTDMS                                        S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C   LR              GOTO      RSSEND                                                      S0111
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C                   EXSR      IRSAMD                                                      S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   MOVE      'Y'           OFX                                         BUG7531
     C*                                                                   S01119
     C*  AS INTEREST FIX DATE HAS BEEN PROCESSED SKIP TO UPDATE           S01119
     C*  THIS PREVENTS DATES BEING PROCESSED OUT OF ORDER                 S01119
     C                   GOTO      RSUNIP                                                      S0111
     C*                                                                   S01119
     C* THEIR INTEREST CHANGE DATE                                        S01119
     C*                                                                   S01119
     C     RSTICD        TAG                                                    ** RSTICD TAG**S0111
     C*  IN ORDER TO CONTINUE WITH THEIR INTEREST CHANGE DATE IT MUST BE: S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*  3) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*  4) RELATING TO A NON-ZERO BASE RATE                              S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO OUR INTEREST CHANGE DATE CHECK                   S01119
     C*                                                                   S01119
     C     TNICD         IFGT      EVCD                                                        S0111
     C                   GOTO      RSUICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TNICD         IFGT      UNICD                                                       S0111
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RSUICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TNICD         IFEQ      0                                                           S0111
     C                   GOTO      RSUICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TBRTT         IFEQ      0                                                           S0111
     C/COPY WNCPYSRC,DL0280C403
     C                   GOTO      RSUICD                                                      S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C506
      *                                                                   CSW005
      ** If CSW005 is switched on                                         CSW005
      **    Set Their Rate Fixing Indicator to BLANK                      CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C                   MOVE      *BLANK        TRFIN                                         CSW00
     C                   BITOFF    '5'           CNFI                                          CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C*                                                                   S01119
     C* CALCULATE INTEREST TO BRING ACCRUAL FIGURES UP TO DATE            S01119
     C*                                                                   S01119
     C** If their interest is Up-Front, set the interest calculated       CIR001
     C** to 0 and do not execute SR/GLINTC                                CIR001
     C*                                                                   CIR001
     C                   Z-ADD     *ZERO         WKINT                                         CIR00
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     TINPM         ANDNE     'D'                                                         CIR00
     C     TINPM         ANDNE     'Y'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C*                                                                   S01119
     C                   Z-ADD     TEINR         ZIRATE                                        S0111
     C                   Z-ADD     TPAMT         ZIAMT                                         S0111
     C                   Z-ADD     TICBS         ZICALC                                        S0111
     C                   Z-ADD     TIACD         ZIBEG                                         S0111
     C                   Z-ADD     TNICD         ZIEND                                         S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add their unsettled interest and    t  CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C648
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP54                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP55                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     *ZERO         WINTST
     C                   Z-ADD     TICBS         ZICALC
     C                   Z-ADD     TIACD         ZIBEG
     C                   Z-ADD     TNICD         ZIEND
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   Z-ADD     FSTPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR002 is switched on, add their unsettled interest and                           CAS005
      ** adjustment to their principal.                                                       CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'L'
     C                   ADD       TUSI          ZIAMT
     C                   ADD       TUSA          ZIAMT
     C                   ENDIF
     C                   EXSR      SRDLIN
     C                   Z-ADD     0             FSTALB
     C                   ADD       WINTST        FSTITB
     C                   ENDIF
     C*                                                                   066550
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add the interest calculated to      t  CIR002
     C**   their unsettled interest.                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C649
     C                   ADD       WKINT         TUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C*                                                                   S01119
     C*  HAVING UPDATED BASE RATE DURING RATE FIX PROCESSING APPLY        S01119
     C*  SPREAD IN LINE WITH INDICATOR : ADD,SUB AND ADD PERCENTAGE       S01119
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TBRTE         FSTEFR
     C                   ENDIF
      *                                                                                       CIR018
      * If Daily Frequency, only add new base rate if value date                              CIR018
      * of change matches interest change date                                                CIR018
     C     CIR018        IFEQ      'Y'                                                        CIR018
     C     TICFR         ANDEQ     'D'                                                        CIR018
     C     TNICD         ANDLT     VDATDM                                                     CIR018
     C                   GOTO      TDYRCU                                                     CIR018
     C                   ENDIF                                                                CIR018
      *                                                                                       CIR018
      *                                                                                       CAS005
     C     TSPIN         IFEQ      'A'                                                         S0111
     C     TBRTE         ADD       TRTSP         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     TBRTE         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      'S'                                                         S0111
     C     TBRTE         SUB       TRTSP         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      'P'                                                         S0111
     C     TBRTE         DIV       100           EINR                                          S0111
     C     EINR          MULT(H)   TRTSP         TEINR                                         S0111
     C                   ADD       TBRTE         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TDYRCU        TAG                                                                  CIR018
     C*                                                                   S01119
     C****** UPDATES                                                      S01119
     C*                                                                   S01119
     C                   Z-ADD     0             TIALC                                         S0111
     C                   ADD       WKINT         TAITC                                         S0111
     C/COPY WNCPYSRC,DL0280C689
     C                   Z-ADD     TNICD         TIACD                                         S0111
     C                   Z-ADD     TNICD         TLPCD                                         S0111
      *                                                                   CPL002
      ** If Midas-Plato Module is ON and this is a floating leg,          CPL002
      ** then maintain Their Last Rate Change Date field (PLTLRC)         CPL002
      *                                                                   CPL002
     C     BGN2ST        IFEQ      'Y'                                                         CPL00
     C     TBRTT         ANDNE     0                                                           CPL00
     C                   Z-ADD     TNICD         PLTLRC                                        CPL00
     C                   ENDIF                                                                 CPL00
      *                                                                   CPL002
     C**  UPDATE DATES IF FREQUENCY NON BLANK                             S01119
     C     TICFR         IFNE      ' '                                                         S0111
     C                   MOVE      TICFR         ZFREQ                                         S0111
     C                   Z-ADD     TICBD         ZDAYNO                                        S0111
     C                   Z-ADD     TICFD         ZMDAY                                         S0111
     C                   MOVE      TCUCY         ZCCY                                          S0111
     C                   MOVE      BJSLCD        ZLOC                                          S0119
      *                                                                                       CIR018
      ** If Daily Rate Change Frequency then simply add 1 to next                             CIR018
      ** change date                                                                          CIR018
     C     CIR018        IFEQ      'Y'                                                        CIR018
     C     ZFREQ         ANDEQ     'D'                                                        CIR018
     C     TNICD         ADD       1             ZDYNBR                                       CIR018
     C     TNICD         ADD       1             ZDAYNO                                       CIR018
     C                   ELSE                                                                 CIR018
     C*                                                                   CIR001
     C** If CIR001 is on and Their Interest Frequency is Not 'Z',         CIR001
     C** perform processing as at present using SR/ZFREQC, otherwise      CIR001
     C** use #LDNDT.                                                      CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     ZFREQ         ANDNE     'Z'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     CIR005        IFEQ      'N'                                                         CIR00
     C     L1CYP1        OREQ      *BLANKS                                                     CIR00
     C                   EXSR      ZFREQC                                                      S0119
     C                   Z-ADD     0             ZNRDYS                                        S0119
     C                   MOVE      BJSLCD        ZLOC                                          S0119
     C                   EXSR      ZFWDT                                                       S0119
      *                                                                   CIR005
     C                   ELSE                                                                  CIR00
     C                   EXSR      ZFRQB3                                                      CIR00
     C                   IF        CIR017 <> 'Y'                                              CIR017
     C                   MOVE      L1PDCN        PPDCN                                        CIR017
     C                   ELSE                                                                 CIR017
     C                   MOVE      L2PDCN        PPDCN                                        CIR017
     C                   ENDIF                                                                CIR017
      *                                                                   CIR005
     C                   CALL      'DLZIRP'                                                    CIR00
     C                   PARM                    ZDAYNO                                        CIR00
     C                   PARM      CCYPY1        PCURR            30                           CIR00
     C**********         PARM      L1PDCN        PPDCN             2                   CIR005 CIR017
     C                   PARM                    PPDCN             2                          CIR017
     C                   PARM                    ZLOC                                          CIR00
     C                   PARM                    BJDFIN                                        CIR00
     C                   PARM      *ZEROS        PAJDT             5 0                         CIR00
     C                   PARM      *ZEROS        PBSDT             5 0                         CIR00
     C                   Z-ADD     PAJDT         ZDYNBR                                        CIR00
     C                   Z-ADD     PBSDT         ZDAYNO                                        CIR00
      *                                                                   CIR005
      ** Do not return adjusted date if it is equal to or earlier than    CIR005
      ** previous date (only happens for 'previous' date calculations);   CIR005
      ** instead use the base date                                        CIR005
      *                                                                   CIR005
     C     TICBD         IFGE      ZDYNBR                                                      CIR00
     C                   Z-ADD     PBSDT         ZDYNBR                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C** IF FREQUENCY IS 'Z' DETEMINE NEXT DATE FROM DATE SCHEDULE FILE   CIR001
     C*                                                                   CIR001
     C                   MOVEL     'T'           OTIN                           * THEIRS       CIR00
     C                   MOVEL     'R'           RCIP                           * RATE CHANGE  CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        ZDYNBR                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ENDIF                                                                CIR018
     C*                                                                                       CIR018
     C     ZDYNBR        IFLT      MDAT                                                        S0111
     C                   Z-ADD     ZDAYNO        TICBD                                         S0111
     C                   Z-ADD     ZDYNBR        TNICD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             TICBD                                         S0111
     C                   Z-ADD     0             TNICD                                         S0111
     C                   MOVE      ' '           TICFR                                         S0111
     C                   Z-ADD     0             TICFD                                         S0111
     C                   Z-ADD     0             TINFD                                         18281
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             TICBD                                         S0111
     C                   Z-ADD     0             TNICD                                         S0111
     C                   Z-ADD     0             TINFD                                         18281
     C                   END                                                                   S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C*  AS INTEREST CHANGE DATE HAS BEEN PROCESSED SKIP TO UPDATE        S01119
     C*  THIS PREVENTS DATES BEING PROCESSED OUT OF ORDER                 S01119
     C                   GOTO      RSUNIP                                                      S0111
     C*                                                                   S01119
     C* OUR INTEREST CHANGE DATE                                          S01119
     C*                                                                   S01119
     C     RSUICD        TAG                                                    ** RSUICD TAG**S0111
     C*  IN ORDER TO CONTINUE WITH OUR   INTEREST CHANGE DATE IT MUST BE: S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*  3) RELATING TO A NON-ZERO BASE RATE                              S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO RS UPDATE SECTION                                S01119
     C*                                                                   S01119
     C     UNICD         IFGT      EVCD                                                        S0111
     C                   GOTO      RSUNIP                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     UNICD         IFEQ      0                                                           S0111
     C                   GOTO      RSUNIP                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     UBRTT         IFEQ      0                                                           S0111
     C/COPY WNCPYSRC,DL0280C404
     C                   GOTO      RSUNIP                                                      S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C507
      *                                                                   CSW005
      ** If CSW005 is switched on                                         CSW005
      **    Set Our Rate Fixing Indicator to BLANK                        CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C                   MOVE      *BLANK        URFIN                                         CSW00
     C                   BITOFF    '4'           CNFI                                          CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C*   CALCULATE INTEREST TO BRING ACCRUAL FIGURES UP TO DATE          S01119
     C*                                                                   S01119
     C** If our interest is Up-Front, set the interest calculated         CIR001
     C** to 0 and do not execute SR/GLINTC                                CIR001
     C*                                                                   CIR001
     C                   Z-ADD     *ZERO         WKINT                                         CIR00
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UINPM         ANDNE     'D'                                                         CIR00
     C     UINPM         ANDNE     'Y'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C                   Z-ADD     UEINR         ZIRATE                                        S0111
     C                   Z-ADD     UPAMT         ZIAMT                                         S0111
     C                   Z-ADD     UICBS         ZICALC                                        S0111
     C                   Z-ADD     UIACD         ZIBEG                                         S0111
     C                   Z-ADD     UNICD         ZIEND                                         S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add our unsettled interest and      t  CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C650
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP56                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP57                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     *ZERO         WINTST
     C                   Z-ADD     UICBS         ZICALC
     C                   Z-ADD     UIACD         ZIBEG
     C                   Z-ADD     UNICD         ZIEND
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   Z-ADD     FSUPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR002 is switched on, add our unsettled interest and                             CAS005
      ** adjustment to our principal.                                                         CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'L'
     C                   ADD       OUSI          ZIAMT
     C                   ADD       OUSA          ZIAMT
     C                   ENDIF
     C                   EXSR      SRDLIN
     C                   Z-ADD     0             FSUALB
     C                   ADD       WINTST        FSUITB
     C                   ENDIF
      *                                                                                       CAS005
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add the interest calculated to      t  CIR002
     C**   our unsettled interest.                                        CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C651
     C                   ADD       WKINT         OUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*  HAVING UPDATED BASE RATE DURING RATE FIX PROCESSING APPLY        S01119
     C*  SPREAD IN LINE WITH INDICATOR : ADD,SUB AND ADD PERCENTAGE       S01119
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UBRTE         FSUEFR
     C                   ENDIF
      *                                                                                       CAS005
      * If Daily Frequency, only add new base rate if value date                              CIR018
      * of change matches interest change date                                                CIR018
     C     CIR018        IFEQ      'Y'                                                        CIR018
     C     UICFR         ANDEQ     'D'                                                        CIR018
     C     UNICD         ANDLT     VDATDM                                                     CIR018
     C                   GOTO      UDYRCU                                                     CIR018
     C                   ENDIF                                                                CIR018
      *                                                                                       CIR018
     C     USPIN         IFEQ      'A'                                                         S0111
     C     UBRTE         ADD       URTSP         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     UBRTE         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      'S'                                                         S0111
     C     UBRTE         SUB       URTSP         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      'P'                                                         S0111
     C     UBRTE         DIV       100           EINR                                          S0111
     C     EINR          MULT(H)   URTSP         UEINR                                         S0111
     C                   ADD       UBRTE         UEINR                                         S0111
     C                   END                                                                   S0111
     C     UDYRCU        TAG                                                                  CIR018
     C*                                                                   S01119
     C****** UPDATES                                                      S01119
     C*                                                                   S01119
     C                   Z-ADD     0             UIALC                                         S0111
     C                   ADD       WKINT         UAITC                                         S0111
     C/COPY WNCPYSRC,DL0280C690
     C                   Z-ADD     UNICD         UIACD                                         S0111
     C                   Z-ADD     UNICD         ULPCD                                         S0111
      *                                                                   CPL002
      ** If Midas-Plato Module is ON and this is a floating leg,          CPL002
      ** then maintain Our Last Rate Change Date field (PLULRC)           CPL002
      *                                                                   CPL002
     C     BGN2ST        IFEQ      'Y'                                                         CPL00
     C     UBRTT         ANDNE     0                                                           CPL00
     C                   Z-ADD     UNICD         PLULRC                                        CPL00
     C                   ENDIF                                                                 CPL00
      *                                                                   CPL002
     C**  UPDATE DATES IF FREQUENCY NON BLANK                             S01119
     C     UICFR         IFNE      ' '                                                         S0111
     C                   MOVE      UICFR         ZFREQ                                         S0111
     C                   Z-ADD     UICBD         ZDAYNO                                        S0111
     C                   Z-ADD     UICFD         ZMDAY                                         S0111
     C                   MOVE      UCUCY         ZCCY                                          S0111
     C                   MOVE      BJSLCD        ZLOC                                          S0119
      ** If Daily Rate Change Frequency then simply add 1 to next                             CIR018
      ** change date                                                                          CIR018
     C     CIR018        IFEQ      'Y'                                                        CIR018
     C     ZFREQ         ANDEQ     'D'                                                        CIR018
     C     UNICD         ADD       1             ZDYNBR                                       CIR018
     C     UNICD         ADD       1             ZDAYNO                                       CIR018
     C                   ELSE                                                                 CIR018
      *                                                                                       CIR018
     C*                                                                   CIR001
     C** If CIR001 is on and Our Interest Frequency is Not 'Z',           CIR001
     C** perform processing as at present using SR/ZFREQC, otherwise      CIR001
     C** use #LDNDT.                                                      CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     ZFREQ         ANDNE     'Z'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     CIR005        IFEQ      'N'                                                         CIR00
     C     L1CYP1        OREQ      *BLANKS                                                     CIR00
     C                   EXSR      ZFREQC                                                      S0119
     C                   Z-ADD     0             ZNRDYS                                        S0119
     C                   MOVE      BJSLCD        ZLOC                                          S0119
     C                   EXSR      ZFWDT                                                       S0119
      *                                                                   CIR005
     C                   ELSE                                                                  CIR00
     C                   EXSR      ZFRQB3                                                      CIR00
      *                                                                   CIR005
     C                   CALL      'DLZIRP'                                                    CIR00
     C                   PARM                    ZDAYNO                                        CIR00
     C                   PARM      CCYPY1        PCURR                                         CIR00
     C                   PARM      L1PDCN        PPDCN                                         CIR00
     C                   PARM                    ZLOC                                          CIR00
     C                   PARM                    BJDFIN                                        CIR00
     C                   PARM      *ZEROS        PAJDT                                         CIR00
     C                   PARM      *ZEROS        PBSDT                                         CIR00
     C                   Z-ADD     PAJDT         ZDYNBR                                        CIR00
     C                   Z-ADD     PBSDT         ZDAYNO                                        CIR00
      *                                                                   CIR005
      ** Do not return adjusted date if it is equal to or earlier than    CIR005
      ** previous date (only happens for 'previous' date calculations);   CIR005
      ** instead use the base date                                        CIR005
      *                                                                   CIR005
     C     UICBD         IFGE      ZDYNBR                                                      CIR00
     C                   Z-ADD     PBSDT         ZDYNBR                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C** IF FREQUENCY IS 'Z' DETEMINE NEXT DATE FROM DATE SCHEDULE FILE   CIR001
     C*                                                                   CIR001
     C                   MOVEL     'U'           OTIN                           * THEIRS       CIR00
     C                   MOVEL     'R'           RCIP                           * RATE CHANGE  CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        ZDYNBR                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ENDIF                                                                CIR018
      *                                                                                       CIR018
     C     ZDYNBR        IFLT      MDAT                                                        S0111
     C                   Z-ADD     ZDAYNO        UICBD                                         S0111
     C                   Z-ADD     ZDYNBR        UNICD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             UICBD                                         S0111
     C                   Z-ADD     0             UNICD                                         S0111
     C                   MOVE      ' '           UICFR                                         S0111
     C                   Z-ADD     0             UICFD                                         S0111
     C                   Z-ADD     0             UINFD                                         18281
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             UICBD                                         S0111
     C                   Z-ADD     0             UNICD                                         S0111
     C                   Z-ADD     0             UINFD                                         18281
     C                   END                                                                   S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C     RSUNIP        TAG                                                    ** RSUNIP TAG**S0111
     C*                                                                   CIR001
     C** IF OUR PAY DATE = THEIR PAY DATE, BUT BOTH DATES HAVEN'T BEEN    CIR001
     C** PROCESSED YET (AS INTEREST IS UP FRONT ON ONE LEG), THEN RE-DO.  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C508
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     WUNIPD        ANDEQ     WTNIPD
     C*                                                                   CIR001
     C     OUR           IFEQ      *BLANK                                                      CIR00
     C     THR           OREQ      *BLANK                                                      CIR00
     C                   GOTO      RSDATE                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C509
     C*                                                                   S01119
     C** UPDATES AND NET KEYS                                             S01119
     C*                                                                   S01119
     C* OUR DETAILS ONLY                                                  S01119
     C*                                                                   S01119
     C     OUR           IFEQ      'Y'                                                         S0111
     C     THR           ANDNE     'Y'                                                         S0111
     C                   MOVEA     'PN'          AKY(9)                                        S0111
     C                   Z-ADD     WNIPDU        KYDAT                                         S0111
     C                   Z-ADD     WNIPDU        KYFED                                         S0111
     C                   Z-ADD     WINOTU        KYAMT                                         S0111
     C                   Z-ADD     WINOTU        NRRSAL                                        S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
     C                   SETON                                        71                       S0111
     C/COPY WNCPYSRC,DL0280C573
      *                                                                                       CIR007
      ** Net Interest Key. Our Side Only.                                                     CIR007
      *                                                                                       CIR007
      ** If our side of the deal is not an OIS, do standard processing.                       CIR007
      *                                                                                       CIR007
     C     CIR007        IFEQ      'Y'
      *                                                                                       CIR007
     C     UICFR         IFNE      'O'
     C                   GOTO      C573E
     C                   ENDIF
      *                                                                                       CIR007
      ** If our side of the deal is an OIS, but there is no advance                           CIR007
      ** dating, do standard processing.                                                      CIR007
      *                                                                                       CIR007
     C     WADATE        IFEQ      'N'
     C                   GOTO      C573E
     C                   ENDIF
      *                                                                                       CIR007
      ** If our side of the deal is an OIS, and there is advance dating,                      CIR007
      ** in the dealing run we write the key to DLOPOSPD, not DKEYSDP,                        CIR007
      ** and in the shadow posting run, we write no key at all.                               CIR007
      *                                                                                       CIR007
     C     WADATE        IFEQ      'Y'
     C     *INU1         ANDEQ     *OFF
     C                   GOTO      OI574
     C                   ENDIF
      *                                                                                       CIR007
      ** Code to write our side only net key to DLOPOSPD, not DKEYSDP.                        CIR007
      *                                                                                       CIR007
     C                   EXSR      SREXCP
     C                   GOTO      OI574
      *                                                                                       CIR007
     C                   ENDIF
      *                                                                                       CIR007
     C     C573E         TAG
      *                                                                                       CIR007
     C                   EXSR      EXCP                                                        S0111
     C/COPY WNCPYSRC,DL0280C574
      *                                                                                       CIR007
     C     OI574         TAG
      *                                                                                       CIR007
     C     UNSAM         ADD       WINOTU        UNSAM                                         S0111
     C                   Z-ADD     0             TAXA                                          S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     FSUSAB        ADD       WINOTU        FSUSAB
     C                   ENDIF
      *                                                                                       CAS005
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* THEIR DETAILS ONLY                                                S01119
     C*                                                                   S01119
     C     THR           IFEQ      'Y'                                                         S0111
     C     OUR           ANDNE     'Y'                                                         S0111
     C                   MOVEA     'RN'          AKY(9)                                        S0111
     C                   Z-ADD     WNIPDT        KYDAT                                         S0111
     C                   Z-ADD     WNIPDT        KYFED                                         S0111
     C                   Z-ADD     WINOTT        KYAMT                                         S0111
     C                   Z-ADD     WINOTT        NRRSAL                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
     C                   SETON                                        71                       S0111
     C*                                                                   S01119
     C*  SUPPRESS PRINT OF TAX AMOUNT AS IT IS NOT APPLICABLE             S01119
     C                   SETOFF                                       33                       S0111
     C/COPY WNCPYSRC,DL0280C575
      *                                                                                       CIR007
      ** Net Interest Key. Their Side Only.                                                   CIR007
      *                                                                                       CIR007
      ** If thr side of the deal is not an OIS, do standard processing.                       CIR007
      *                                                                                       CIR007
     C     CIR007        IFEQ      'Y'
      *                                                                                       CIR007
     C     TICFR         IFNE      'O'
     C                   GOTO      C575E
     C                   ENDIF
      *                                                                                       CIR007
      ** If their side of the deal is an OIS, but there is no advance                         CIR007
      ** dating, do standard processing.                                                      CIR007
      *                                                                                       CIR007
     C     WADATE        IFEQ      'N'
     C                   GOTO      C575E
     C                   ENDIF
      *                                                                                       CIR007
      ** If thr side of the deal is an OIS, and there is advance dating,                      CIR007
      ** in the dealing run we write the key to DLOPOSPD, not DKEYSDP,                        CIR007
      ** and in the shadow posting run, we write no key at all.                               CIR007
      *                                                                                       CIR007
     C     WADATE        IFEQ      'Y'
     C     *INU1         ANDEQ     *OFF
     C                   GOTO      OI576
     C                   ENDIF
      *                                                                                       CIR007
      ** Code to write our side only net key to DLOPOSPD, not DKEYSDP.                        CIR007
      *                                                                                       CIR007
     C                   EXSR      SREXCP
     C                   GOTO      OI576
      *                                                                                       CIR007
     C                   ENDIF
      *                                                                                       CIR007
     C     C575E         TAG
      *                                                                                       CIR007
     C                   EXSR      EXCP                                                        S0111
     C/COPY WNCPYSRC,DL0280C576
      *                                                                                       CIR007
     C     OI576         TAG
      *                                                                                       CIR007
     C*                                                                   S01119
     C*  RESET IND. TO PRINT TAX AMOUNT                                   S01119
     C     TAXI          COMP      'Y'                                    33                   S0111
     C*                                                                   S01119
     C     TNSAM         ADD       WINOTT        TNSAM                                         S0111
     C     CAS005        IFEQ      'Y'
     C     FSTSAB        ADD       WINOTT        FSTSAB
     C                   ENDIF
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* BOTH SETS OF DETAILS                                              S01119
     C*                                                                   S01119
     C     THR           IFEQ      'Y'                                                         S0111
     C     OUR           ANDEQ     'Y'                                                         S0111
     C                   Z-ADD     WNIPDU        KYDAT                                         S0111
     C                   Z-ADD     WNIPDU        KYFED                                         S0111
     C* CALCULATE NET SETTLEMENT AMOUNT IF OURS GREATER                   S01119
     C     WINOTU        IFGE      WINOTT                                                      S0111
     C     WINOTU        SUB       WINOTT        KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   MOVEA     'PN'          AKY(9)                                        S0111
     C/COPY WNCPYSRC,DL0280C577
      *                                                                                       CIR007
      ** Net Interest Key. Both Sides Settling. Our Side Greater.                             CIR007
      *                                                                                       CIR007
      ** If neither side of this deal is an OIS, do standard processing.                      CIR007
      *                                                                                       CIR007
     C     CIR007        IFEQ      'Y'
      *                                                                                       CIR007
     C     UICFR         IFNE      'O'
     C     TICFR         ANDNE     'O'
     C                   GOTO      C577E
     C                   ENDIF
      *                                                                                       CIR007
      ** If one or both sides of this deal is an OIS, and there is no                         CIR007
      ** advance dating, do standard processing.                                              CIR007
      *                                                                                       CIR007
     C     WADATE        IFEQ      'N'
     C                   GOTO      C577E
     C                   ENDIF
      *                                                                                       CIR007
      ** If one or both sides of this deal is an OIS, and there is                            CIR007
      ** advance dating, in the dealing run we write the key to DLOPOSPD                      CIR007
      ** not DKEYSDP, and in the shadow posting run we write no key.                          CIR007
      *                                                                                       CIR007
     C     WADATE        IFEQ      'Y'
     C     *INU1         ANDEQ     *OFF
     C                   GOTO      OI578
     C                   ENDIF
      *                                                                                       CIR007
      ** Code to write net pay key to DLOPOSPD not DKEYSDP.                                   CIR007
      *                                                                                       CIR007
     C                   EXSR      SREXCP
     C                   GOTO      OI578
      *                                                                                       CIR007
     C                   ENDIF
      *                                                                                       CIR007
     C     C577E         TAG
      *                                                                                       CIR007
     C                   EXSR      EXCP                                                        S0111
     C/COPY WNCPYSRC,DL0280C578
      *                                                                                       CIR007
     C     OI578         TAG
      *                                                                                       CIR007
     C     UNSAM         ADD       KYAMT         UNSAM                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     FSUSAB        ADD       KYAMT         FSUSAB
     C                   ENDIF
      *                                                                                       CAS005
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* PRINT LINE - OURS GROSS                                           S01119
     C*                                                                   S01119
     C                   Z-ADD     WINOTU        NRRSAL                                        S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   SETON                                        71                       S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
     C                   MOVE      'Y'           PRONLY                                        S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     0             TAXA                                          S0111
     C*                                                                   S01119
     C* CALCULATE NET SETTLEMENT AMOUNT IF THEIRS GREATER                 S01119
     C     WINOTU        IFLT      WINOTT                                                      S0111
     C     WINOTT        SUB       WINOTU        KYAMT                                         S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   MOVEA     'RN'          AKY(9)                                        S0111
     C/COPY WNCPYSRC,DL0280C579
      *                                                                                       CIR007
      ** Net Interest Key. Both Sides Settling. Their Side Greater.                           CIR007
      *                                                                                       CIR007
      ** If neither side of this deal is an OIS, do standard processing.                      CIR007
      *                                                                                       CIR007
     C     CIR007        IFEQ      'Y'
      *                                                                                       CIR007
     C     UICFR         IFNE      'O'
     C     TICFR         ANDNE     'O'
     C                   GOTO      C579E
     C                   ENDIF
      *                                                                                       CIR007
      ** If one or both sides of this deal is an OIS, and there is no                         CIR007
      ** advance dating, do standard processing.                                              CIR007
      *                                                                                       CIR007
     C     WADATE        IFEQ      'N'
     C                   GOTO      C579E
     C                   ENDIF
      *                                                                                       CIR007
      ** If one or both sides of this deal is an OIS, and there is                            CIR007
      ** advance dating, in the dealing run we write the key to DLOPOSPD                      CIR007
      ** not DKEYSDP, and in the shadow posting run we write no key.                          CIR007
      *                                                                                       CIR007
     C     WADATE        IFEQ      'Y'
     C     *INU1         ANDEQ     *OFF
     C                   GOTO      OI580
     C                   ENDIF
      *                                                                                       CIR007
      ** Code to write net pay key to DLOPOSPD not DKEYSDP.                                   CIR007
      *                                                                                       CIR007
     C                   EXSR      SREXCP
     C                   GOTO      OI580
      *                                                                                       CIR007
     C                   ENDIF
      *                                                                                       CIR007
     C     C579E         TAG
      *                                                                                       CIR007
     C                   EXSR      EXCP                                                        S0111
     C/COPY WNCPYSRC,DL0280C580
      *                                                                                       CIR007
     C     OI580         TAG
      *                                                                                       CIR007
     C     TNSAM         ADD       KYAMT         TNSAM                                         S0111
     C     CAS005        IFEQ      'Y'
     C     FSTSAB        ADD       KYAMT         FSTSAB
     C                   ENDIF
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* PRINT LINE - THEIRS  GROSS                                        S01119
     C*                                                                   S01119
     C                   Z-ADD     WINOTT        NRRSAL                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   EXCEPT    FITHR2                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C* PRINT LINE FOR MATCH                                              S01119
     C*                                                                   S01119
     C     WINOTT        SUB       WINOTU        NRRSAL                 31                     S0111
     C   31              Z-SUB     NRRSAL        NRRSAL                                        S0111
     C                   EXCEPT    MATCH#                                                      12683
     C                   ADD       1             PLINES                                        LN088
     C                   MOVEA     '0000'        *IN(73)                                       S0111
     C                   Z-ADD     0             NRRSAL                                        S0111
     C                   END                                                                   S0111
     C                   MOVE      ' '           OUR                                           S0111
     C                   MOVE      ' '           THR                                           S0111
     C                   Z-ADD     0             TAXA                                          S0111
     C*                                                                   S01119
     C*   NEXT INTEREST PAYMENT DATE WORK FIELDS SHOULD BE UPDATED        S01119
     C*    TO REFLECT CHANGES ARISING FROM EVENT DATE PROCESSING          S01119
     C*       E.G. IF DEFAULTING TO CHANGE DATES WHICH HAVE BEEN          S01119
     C*                    INCREMENTED                                    S01119
     C*   THEIR WORK FIELD                                                S01119
     C     TNIPD         IFEQ      0                                                           S0111
     C     TNICD         IFNE      0                                                           S0111
     C                   Z-ADD     TNICD         WNIPDT            5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPDT                                        S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TNIPD         WNIPDT                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*   OUR WORK FILED                                                  S01119
     C*                                                                   S01119
     C     UNIPD         IFEQ      0                                                           S0111
     C     UNICD         IFNE      0                                                           S0111
     C                   Z-ADD     UNICD         WNIPDU            5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPDU                                        S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     UNIPD         WNIPDU                                        S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C423
     C*                                                                   CIR001
     C** IF INTEREST IS UP FRONT (DISCOUNT OR YIELD)                      CIR001
     C** DETERMINE INTEREST PAYMENT DATE AFTER NEXT INTEREST PAYMENT      CIR001
     C** DATE (TERMED THE NEXT INTEREST END DATE)                         CIR001
     C** ELSE THIS DATE IS THE SAME AS THE NEXT INTEREST PAYMENT DATE     CIR001
     C** THEIRS:                                                          CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     TINPM         IFEQ      'D'                                                         CIR00
     C     TINPM         OREQ      'Y'                                                         CIR00
     C                   MOVEL     'T'           OTIN                                          CIR00
     C                   MOVEL     'P'           RCIP                                          CIR00
     C                   Z-ADD     WNIPDT        ZDAYNO                                        CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        WNIEDT                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     WNIPDT        WNIEDT                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** OURS:                                                            CIR001
     C*                                                                   CIR001
     C     UINPM         IFEQ      'D'                                                         CIR00
     C     UINPM         OREQ      'Y'                                                         CIR00
     C                   MOVEL     'U'           OTIN                                          CIR00
     C                   MOVEL     'P'           RCIP                                          CIR00
     C                   Z-ADD     WNIPDU        ZDAYNO                                        CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        WNIEDU                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     WNIPDU        WNIEDU                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C** SET OFF FLAGS & RETURN TO NON-SHADOW POST DATE PROCESSING        S01119
     C*         IN ORDER TO PROCESS NEXT EVENT DATE IN SEQUENCE           S01119
     C   U1              GOTO      RSDATE                                                      S0111
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   GOTO      RSMDAT                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C  NU1              GOTO      RSSEND                                                      S0111
     C*                                                                   S01119
     C     RSMDAT        TAG                                                    ** RSMDAT TAG**S0111
     C/COPY WNCPYSRC,DL0280C415
     C*                                                                   S01119
     C* MATURITY DATE PROCESSING                                          S01119
     C*                                                                   S01119
      *                                                                                       204923
      ** Adjust the Maturity Date by the Rate Fix Days Adjustment if                          204923
      ** CIR007 is on and one or both side/s is/are OIS.                                      204923
      *                                                                                       204923
     C                   Z-ADD     MDAT          WMATDT            5 0
     C     CIR007        IFEQ      'Y'
     C     WFXDY         ANDNE     0
     C     UICFR         IFEQ      'O'
     C     TICFR         OREQ      'O'
     C                   Z-ADD     MDAT          ZDAYNO
     C                   Z-ADD     1             ZNRDYS
     C                   MOVE      BJLCCY        ZCCY
     C                   EXSR      ZFWDT
     C                   MOVE      ZDYNBR        WMATDT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       204923
     C                   TESTB     '2'           ACEI                 31                       S0111
     C     WMATDT        IFLE      EVCD
     C     *IN31         ANDEQ     '1'                                                         S0111
     C*                                                                   CIR001
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     BOVD          ANDLE     EVCD                                                        CIR00
     C     BOVD          ANDNE     *ZEROS                                                      CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     BOVD          ANDNE     *ZEROS                                                      CIR00
     C                   Z-ADD     BOVD          KYDAT                                         CIR00
     C                   Z-ADD     BOVD          KYFED                                         CIR00
     C                   MOVEL     NEV(10)       NARREV                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     MDAT          KYDAT                                         S0111
     C                   Z-ADD     MDAT          KYFED                                         S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   MOVEL     NEV(4)        NARREV                                        CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** BUY-OUT VALUE DATE KEY                                           CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     BOVD          IFNE      *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C                   MOVEA     'RS'          AKY(1)                                        CIR00
     C                   MOVE      'V'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    B'       AKY(6)                                        CIR00
     C                   MOVEA     BAPR          AKY(9)                                        CIR00
     C                   Z-ADD     BOAM          KYAMT                                         CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C269
     C     BAPR          IFEQ      'P'                                                         CIR00
     C                   ADD       BOAM          UIPRD                                         CIR00
     C                   ADD       BOAM          UIPRM                                         CIR00
     C/COPY WNCPYSRC,DL0280C270
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         13479
     C/COPY WNCPYSRC,DL0280C271
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     BAPR          IFEQ      'R'                                                         CIR00
     C                   ADD       BOAM          TIPRD                                         CIR00
     C                   ADD       BOAM          TIPRM                                         CIR00
     C/COPY WNCPYSRC,DL0280C272
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         13479
     C/COPY WNCPYSRC,DL0280C273
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** Do not produce any more maturity date keys if shadow post mode   CIR001
     C*                                                                   CIR001
     C  NU1              GOTO      RSSEND                                                      CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   MOVEA     'RSM'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C* PRINCIPAL KEY                                                     S01119
     C                   MOVEA     '    A'       AKY(6)                                        S0111
     C***********          MOVE NEV,4     NARREV                   S01119 060147
     C     CIR001        IFNE      'Y'                                                         CIR00
     C                   MOVEL     NEV(4)        NARREV                                        06014
     C                   END                                                                   CIR00
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C/COPY WNCPYSRC,DL0280C556
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C/COPY WNCPYSRC,DL0280C557
     C                   TESTB     '0'           UDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   SETON                                        71                       S0111
     C                   EXSR      EXCP                                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C* EXPOSURE KEY                                                      S01119
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   Z-ADD     UAEXA         KYAMT                                         S0111
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01328
     C** IF UNREALIZED PROFIT/LOSS POSTED IS NOT ZERO, THEN REVERSE IT    S01328
     C*                                                                   S01328
     C     UNRLP         IFNE      *ZERO                                                       S0132
      *                                                                                       CAS004
     C     CAS004        IFEQ      'N'
     C*                                                                   S01328
     C** SET THE UNREALIZED P/L TO ZERO (REVERSAL POSTING ONLY REQUIRED)  S01328
     C*                                                                   S01328
     C                   Z-ADD     *ZERO         UNRL                                          S0132
     C*                                                                   S01328
     C** GENERATE UNREALIZED P/L A/C KEYS                                 S01328
     C*                                                                   S01328
     C                   EXSR      UNREAL                                                      S0132
     C                   ENDIF
     C                   END                                                                   S0132
      *                                                                                       221703
      ** RS Maturity Reversals                                                                221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     MDAT          ANDLE     EVCD
     C                   Z-ADD     MDAT          KYDAT
     C                   EXSR      SRUREL
     C                   MOVE      '1'           *IN15
     C                   ENDIF
     C*                                                                   CIR001
     C** UP-FRONT FEE ACCRUAL KEY FOR THE UNAMORTISED FEE                 CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UPVD          ANDNE     *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C     UPVD          IFLE      EVCD                                                        CIR00
     C*                                                                   CIR001
     C     BOVD          IFNE      *ZEROS                                                      CIR00
     C                   Z-ADD     BOVD          KYDAT                                         CIR00
     C                   Z-ADD     BOVD          KYFED                                         CIR00
     C                   MOVEL     NEV(10)       NARREV                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     MDAT          KYDAT                                         CIR00
     C                   Z-ADD     MDAT          KYFED                                         CIR00
     C                   MOVEL     NEV(4)        NARREV                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     UPVD          IFNE      *ZEROS                                                      CIR00
     C                   MOVEA     'RS'          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVE      UPPR          AKY(9)                                        CIR00
     C*                                                                   CIR001
     C     UPFE          SUB       UPAD          KYAMT                                         CIR00
     C                   Z-ADD     UPFE          UPAD                                          CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C274
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C275
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         13479
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C276
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C277
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         13479
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   Z-ADD     *ZEROS        KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C** If an up-front fee has been entered and it has NOT been          CIR001
     C** reached (UPVD > EVCD), the up-front fee deal date entries must   CIR001
     C** be reversed by generating up-front fee deal date key             CIR001
     C** "xxDyy   zF" with the full fee amount as a negative amount and   CIR001
     C** the remaining parameters setup as above.                         CIR001
     C*                                                                   CIR001
     C     BOVD          IFNE      *ZEROS                                                      CIR00
     C                   Z-ADD     BOVD          KYDAT                                         CIR00
     C                   Z-ADD     BOVD          KYFED                                         CIR00
     C                   MOVEL     NEV(10)       NARREV                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     MDAT          KYDAT                                         CIR00
     C                   Z-ADD     MDAT          KYFED                                         CIR00
     C                   MOVEL     NEV(4)        NARREV                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     UPVD          IFNE      *ZEROS                                                      CIR00
     C                   MOVEA     'RS'          AKY(1)                                        CIR00
     C                   MOVE      'D'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVE      UPPR          AKY(9)                                        CIR00
     C*                                                                   CIR001
     C                   Z-SUB     UPFE          KYAMT                                         CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C278
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C279
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         13479
     C/COPY WNCPYSRC,DL0280C280
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C281
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         13479
     C/COPY WNCPYSRC,DL0280C282
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** Accrual posted to date on both our and their sides must          CIR001
     C** be reversed out.                                                 CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     BOVD          ANDNE     *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C* Our:                                                              CIR001
     C     BAPR          IFEQ      'P'                                                         CIR00
     C     UIPRD         SUB       BOAM          WIPRD            13 0                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     UIPRD         WIPRD                                         CIR00
     C                   END                                                                   CIR00
     C     UAIPD         SUB       WIPRD         WACCP            13 0                         CIR00
     C     WACCP         IFNE      0                                                           CIR00
     C                   MOVEA     'RS'          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '   PA'       AKY(6)                                        CIR00
     C                   Z-SUB     WACCP         KYAMT                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C* Their:                                                            CIR001
     C     BAPR          IFEQ      'R'                                                         CIR00
     C     TIPRD         SUB       BOAM          WIPRD            13 0                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     TIPRD         WIPRD                                         CIR00
     C                   END                                                                   CIR00
     C     TAIPD         SUB       WIPRD         WACCP                                         CIR00
     C     WACCP         IFNE      0                                                           CIR00
     C                   MOVEA     'RS'          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '   RA'       AKY(6)                                        CIR00
     C                   Z-SUB     WACCP         KYAMT                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01328
     C* UPDATE FIELDS                                                     S01119
     C                   BITON     '2'           ACEI                                          S0111
     C                   MOVE      'M'           RECR                                          S0111
      *                                                                                       CIR008
      ** Set Deal Authorisation Status to 'M' if CIR008 is installed                          CIR008
      *                                                                                       CIR008
     C     CIR008        IFEQ      'Y'
     C                   MOVE      'M'           FIDSTS
     C                   ENDIF
      *                                                                                       CIR008
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C/COPY WNCPYSRC,DL0280C549
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* ACCRUAL DATE IF REQUIRED                                          S01119
     C*                                                                   S01119
     C     *IN52         IFEQ      '1'                                                         S0111
     C     VDAT          ANDLE     EVCD                                                        S0111
     C     MDAT          ANDGT     EVCD                                                        S0111
     C/COPY WNCPYSRC,DL0280C512
     C*                                                                   S01119
     C                   Z-ADD     BKAPDT        KYDAT                                         07778
     C                   Z-ADD     BJRDNB        KYFED                                         S0111
     C*                                                                   S01119
      * DLRSAC (OURS NON-AVE)                                             S01119
     C*                                                                   S01119
     C*   ONLY IF NOT ALSO A PAYMENT DATE OR FIRST DAY ACCRUAL            E36008
     C     USLIP         IFNE      EVCD                                                        S0111
     C     USLIP         OREQ      EVCD                                         DATE 1ST SET   S0111
     C     USLIP         ANDEQ     VDAT                                         *EQ VDAT       S0111
     C     BKALDI        OREQ      'N'                                          1ST DAY ACCRUALE3600
     C                   Z-ADD     UIACD         SZIACD                                        S0111
     C                   Z-ADD     ULPCD         SZLPCD                                        S0111
     C                   MOVE      BKALDI        SZLDA             1                           S0119
     C                   Z-ADD     EVCD          SZECD             5 0                         S0111
     C                   Z-ADD     UEINR         SZINTR           11 7                         S0111
     C                   Z-ADD     UPAMT         SZPPL                                         S0111
     C                   Z-ADD     UAITC         SZAICD                                        S0111
     C                   Z-ADD     UAIAP         SZAIAP                                        S0111
     C                   Z-ADD     UAIAN         SZIANP                                        S0111
     C                   Z-ADD     UAIPD         SZIPTD                                        S0111
     C                   MOVE      'N'           SZAVRM            1                           S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   Z-ADD     UICBS         SZCBS                                         S0111
     C                   MOVEA     'P'           AKY(9)                                        S0111
     C*                                                                   003457
     C/COPY WNCPYSRC,DL0280CP92                                           S01408
      *                                                                                       CIR007
     C     CIR007        IFEQ      'Y'
     C                   Z-ADD     UIPRD         SZIPRD
     C                   ENDIF
      *                                                                   S01408
     C** Set off *IN31 to ensure Effective Rate (UEINR) output            003457
     C*                                                                   003457
     C                   MOVE      '0'           *IN31                                         00345
     C*                                                                   CIR002
     C** If our interest is NOT up-front, add Our Unsettled Interest      CIR002
     C** Amount (OUSI) and Our Unsettled Interest Adjustment (OUSA)       CIR002
     C** to amount parameter (SZPPL)                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C652
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UINPM         ANDNE     'D'                                                         CIR00
     C     UINPM         ANDNE     'Y'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          SZPPL                                         CIR00
     C                   ADD       OUSA          SZPPL                                         CIR00
     C     CAS005        IFEQ      'Y'
     C                   ADD       OUSI          TZPPL
     C                   ADD       OUSA          TZPPL
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UIACD         TZIACD
     C                   Z-ADD     ULPCD         TZLPCD
     C                   MOVE      BKALDI        TZLDA             1
     C                   Z-ADD     EVCD          TZECD             5 0
     C                   Z-ADD     FSUPAM        TZPPL
     C                   Z-ADD     FSUITB        TZAICD
     C                   Z-ADD     FSUIAB        TZAIAP
     C                   Z-ADD     FSUINB        TZIANP
     C                   Z-ADD     FSUIPB        TZIPTD
     C                   MOVE      'N'           TZAVRM            1
     C                   Z-ADD     UICBS         TZCBS
      *                                                                                       CAS005
     C     CIR007        IFEQ      'Y'
     C                   Z-ADD     FSUPRB        TZIPRD
     C                   ENDIF
      *                                                                                       CAS005
      ** If our interest is NOT up-front, add Our Unsettled Interest                          CAS005
      ** Amount (OUSI) and Our Unsettled Interest Adjustment (OUSA)                           CAS005
      ** to amount parameter (TZPPL)                                                          CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
      *                                                                                       CAS005
     C     CIR001        IFEQ      'Y'
     C     UINPM         ANDNE     'D'
     C     UINPM         ANDNE     'Y'
     C     CIR006        ANDEQ     'N'
     C     CIR001        ORNE      'Y'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'L'
     C                   ADD       OUSI          TZPPL
     C                   ADD       OUSA          TZPPL
     C                   ENDIF
      *                                                                                       CAS005
     C                   ENDIF
     C                   ENDIF
     C*                                                                   003457
     C** Set interest processing method parameter to our interest         CIR001
     C** method.  If interest is up-front, use SR/#LRSAU, otherwise       CIR001
     C** use SR/DLRSAC.                                                   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   MOVE      UINPM         SZINPM                                        CIR00
     C                   Z-ADD     USLIP         SZSLID                                        CIR00
     C                   Z-ADD     UNIPD         SZNIPD                                        CIR00
     C                   MOVE      UIPFR         SZIPFC                                        CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     USLIP         TZSLID
     C                   Z-ADD     UNIPD         TZNIPD            5 0
     C                   MOVE      UIPFR         TZIPFC
     C                   MOVE      UICBS         TZCBS
     C                   ENDIF
      *                                                                   100289
      ** Set-up calculation basis.                                        100289
      *                                                                   100289
     C                   MOVE      UICBS         SZCBS                                         10028
      *                                                                   100289
     C     SZINPM        IFEQ      'D'                                                         CIR00
     C     SZINPM        OREQ      'Y'                                                         CIR00
     C                   EXSR      #LRSAU                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSAU
     C                   ENDIF
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C246
     C                   EXSR      DLRSAC                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSAC
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C247
     C                   EXSR      DLRSAC                                                      S0111
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSAC
     C                   ENDIF
     C                   END                                                                   CIR00
      *        (RESULT)                                                   S01119
     C                   Z-ADD     SZIPTD        UAIPD                                         S0111
     C                   Z-ADD     SZIANP        UAIAN                                         S0111
     C                   Z-ADD     SZAIAP        UAIAP                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TZIPTD        FSUIPB
     C                   Z-ADD     TZIANP        FSUINB
     C                   Z-ADD     TZAIAP        FSUIAB
     C                   ENDIF
      *                                                                                       CAS005
     C                   END                                                                   S0111
      *                                                                   S01119
      * DLRSAC                                                            S01119
      *                                                                   S01119
      *        (THEIRS NON-AVE)                                           S01119
     C*   ONLY IF NOT ALSO A PAYMENT DATE OR FIRST DAY ACCRUAL            E36008
     C     TSLIP         IFNE      EVCD                                                        S0111
     C     TSLIP         OREQ      EVCD                                         DATE 1ST SET   S0111
     C     TSLIP         ANDEQ     VDAT                                         *EQ VDAT       S0111
     C     BKALDI        OREQ      'N'                                          1ST DAY ACCRUALE3600
     C                   Z-ADD     TIACD         SZIACD                                        S0111
     C                   Z-ADD     TLPCD         SZLPCD                                        S0111
     C                   MOVE      BKALDI        SZLDA                                         S0119
     C                   Z-ADD     EVCD          SZECD                                         S0111
     C                   Z-ADD     TEINR         SZINTR                                        S0111
     C                   Z-ADD     TPAMT         SZPPL                                         S0111
     C                   Z-ADD     TAITC         SZAICD                                        S0111
     C                   Z-ADD     TAIAP         SZAIAP                                        S0111
     C                   Z-ADD     TAIAN         SZIANP                                        S0111
     C                   Z-ADD     TAIPD         SZIPTD                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   MOVE      'N'           SZAVRM                                        S0111
     C                   Z-ADD     TICBS         SZCBS                                         S0111
     C                   MOVEA     'R'           AKY(9)                                        S0111
      *                                                                                       204923
      ** Reset value of KYDAT just in case it was changed in "OUR" side processing.           204923
      *                                                                                       204923
     C                   Z-ADD     BKAPDT        KYDAT
     C/COPY WNCPYSRC,DL0280CP94                                           S01408
     C     CIR007        IFEQ      'Y'
     C                   Z-ADD     TIPRD         SZIPRD
     C                   ENDIF
      *                                                                   S01408
     C** Set off *IN31 to ensure Effective Rate (TEINR) output            003457
     C*                                                                   003457
     C                   MOVE      '0'           *IN31                                         00345
     C*                                                                   CIR002
     C** If their interest is NOT up-front, add Their Unsettled Interest  CIR002
     C** Amount (TUSI) and Their Unsettled Interest Adjustment (TUSA)     CIR002
     C** to amount parameter (SZPPL)                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C653
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     TINPM         ANDNE     'D'                                                         CIR00
     C     TINPM         ANDNE     'Y'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          SZPPL                                         CIR00
     C                   ADD       TUSA          SZPPL                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TIACD         TZIACD
     C                   Z-ADD     TLPCD         TZLPCD
     C                   MOVE      BKALDI        TZLDA
     C                   Z-ADD     EVCD          TZECD
     C                   Z-ADD     FSTPAM        TZPPL
     C                   Z-ADD     FSTITB        TZAICD
     C                   Z-ADD     FSTIAB        TZAIAP
     C                   Z-ADD     FSTINB        TZIANP
     C                   Z-ADD     FSTIPB        TZIPTD
     C                   MOVE      'N'           TZAVRM
     C                   Z-ADD     TICBS         TZCBS
      *                                                                                       CAS005
     C     CIR007        IFEQ      'Y'
     C                   Z-ADD     FSTPRB        TZIPRD
     C                   ENDIF
      *                                                                                       CAS005
      ** If their interest is NOT up-front, add Their Unsettled Interest                      CAS005
      ** Amount (TUSI) and Their Unsettled Interest Adjustment (TUSA)                         CAS005
      ** to amount parameter (TZPPL)                                                          CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     CIR001        IFEQ      'Y'
     C     TINPM         ANDNE     'D'
     C     TINPM         ANDNE     'Y'
     C     CIR006        ANDEQ     'N'
     C     CIR001        ORNE      'Y'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'L'
     C                   ADD       TUSI          TZPPL
     C                   ADD       TUSA          TZPPL
     C                   ENDIF
      *                                                                                       CAS005
     C                   ENDIF
     C                   ENDIF
     C*                                                                   003457
     C*                                                                   003457
     C** Set interest processing method parameter to our interest         CIR001
     C** method.  If interest is up-front, use SR/#LRSAU, otherwise       CIR001
     C** use SR/DLRSAC.                                                   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   MOVE      TINPM         SZINPM                                        CIR00
     C                   Z-ADD     TSLIP         SZSLID                                        CIR00
     C                   Z-ADD     TNIPD         SZNIPD                                        CIR00
     C                   MOVE      TIPFR         SZIPFC                                        CIR00
      *                                                                   100289
      ** Set-up calculation basis.                                        100289
      *                                                                   100289
     C                   MOVE      TICBS         SZCBS                                         10028
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TSLIP         TZSLID
     C                   Z-ADD     TNIPD         TZNIPD
     C                   MOVE      TIPFR         TZIPFC
     C                   MOVE      TICBS         TZCBS
     C                   ENDIF
      *                                                                   100289
     C     SZINPM        IFEQ      'D'                                                         CIR00
     C     SZINPM        OREQ      'Y'                                                         CIR00
     C                   EXSR      #LRSAU                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSAU
     C                   ENDIF
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C248
     C                   EXSR      DLRSAC                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSAC
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C249
     C                   EXSR      DLRSAC                                                      S0111
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSAC
     C                   ENDIF
     C                   END                                                                   CIR00
      *        (RESULT)                                                   S01119
     C                   Z-ADD     SZIPTD        TAIPD                                         S0111
     C                   Z-ADD     SZIANP        TAIAN                                         S0111
     C                   Z-ADD     SZAIAP        TAIAP                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TZIPTD        FSTIPB
     C                   Z-ADD     TZIANP        FSTINB
     C                   Z-ADD     TZAIAP        FSTIAB
     C                   ENDIF
      *                                                                                       CAS005
     C                   END                                                                   S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  ACCRUE UP-FRONT FEES                                            CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '2'           ACEI                 31                       CIR00
     C*                                                                   CIR001
     C     *IN52         IFEQ      *ON                                                         CIR00
     C     UPVD          ANDLE     EVCD                                                        CIR00
     C     UPVD          ANDNE     0                                                           CIR00
     C     *IN31         ANDEQ     *ON                                                         CIR00
     C*                                                                   CIR001
     C                   MOVEA     'RS'          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVE      UPPR          AKY(9)                                        CIR00
     C* CALCULATE AMORTISATION TOTAL PERIOD                               CIR001
     C     MDAT          SUB       UPVD          PER1                                          CIR00
     C* CALCULATE AMORTISATION PASSED PERIOD                              CIR001
     C     UPFE          DIV       PER1          DACCR                                         CIR00
     C     EVCD          SUB       UPVD          PER2                                          CIR00
     C* IF LAST DAY ACCRUALS, ADD 1 TO AMORTISATION PASSED PERIOD         CIR001
     C     *IN29         IFEQ      *OFF                                                        CIR00
     C                   ADD       1             PER2                                          CIR00
     C                   END                                                                   CIR00
     C* CALCULATE TOTAL FEE AMORTISED                                     CIR001
     C     DACCR         MULT(H)   PER2          IAMT                                          CIR00
     C*                                                                   CIR001
     C     IAMT          SUB       UPAD          KYAMT                                         CIR00
     C                   ADD       KYAMT         UPAD                                          CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C283
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C284
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   ELSE                                                                  CIR00
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   Z-ADD     *ZEROS        KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   Z-ADD     0             NRRPUR                                        S0111
     C                   Z-ADD     0             NRRSAL                                        S0111
     C*                                                                   S01328
     C** IF ACCRUAL DATE PROCESSING IS REQUIRED (*IN52 IS ON) AND THE     E26577
     C** MATURITY DATE IS GREATER THAN THE EVENT CONTROL DATE             E26577
     C*                                                                   S01328
     C     *IN52         IFEQ      '1'                                                         S0132
     C     MDAT          ANDGT     EVCD                                                        S0132
     C*                                                                   S01328
     C** IF UNREALIZED PROFIT/LOSS IS NOT ZERO,                           S01328
     C** OR UNREALIZED PROFIT/LOSS POSTED IS NOT ZERO,                    S01328
     C*                                                                   S01328
     C     UNRL          IFNE      *ZERO                                                       S0132
     C     UNRLP         ORNE      *ZERO                                                       S0132
      *                                                                                       CAS004
     C     CAS004        IFEQ      'N'
     C*                                                                   S01328
     C** GENERATE UNREALIZED P/L A/C KEYS                                 S01328
     C*                                                                   S01328
     C                   EXSR      UNREAL                                                      S0132
     C*                                                                   S01328
     C** SET ON DEALS FILE UPDATE INDICATOR (*IN15)                       S01328
     C*                                                                   S01328
     C                   MOVE      '1'           *IN15                                         S0132
     C                   ENDIF
     C                   END                                                                   S0132
     C                   END                                                                   S0132
     C*                                                                   S01328
     C/COPY WNCPYSRC,DL0280C285
     C     RSSEND        TAG                                                    ** RSSEND TAG**CSW00
     C/COPY WNCPYSRC,DL0280C286
     C*                                                                   CSW005
     C     BLKUF         IFEQ      'Y'                                                         CSW00
     C                   MOVE      *BLANKS       URFIN                                         CSW00
     C                   ENDIF                                                                 CSW00
     C     BLKTF         IFEQ      'Y'                                                         CSW00
     C                   MOVE      *BLANKS       TRFIN                                         CSW00
     C                   ENDIF                                                                 CSW00
     C*                                                                   CSW005
     C                   ENDSR                                                                 CSW00
2877 C********************************************************************S01119
     C/EJECT                                                              S01119
2877 C********************************************************************S01119
     C* S/R RXSUBR                                                        S01119
     C* CALLED FROM MAIN PROCESSING                                       S01119
     C* CALLS EXCP; EXCPTN                                                S01119
     C*                                                                   S01119
     C* TO PROCESS FRA/IRS DEAL TYPE RX                                   S01119
     C*                                                                   S01119
2877 C********************************************************************S01119
     C*                                                                   S01119
     C     RXSUBR        BEGSR                                                  ** RXSUBR **** S0111
      *                                                                                       CIR014
     C                   IF        CIR014 = 'Y'                                               CIR014
     C                   EVAL      WCAPIT = *BLANK                                            CIR014
     C**********         MOVE      DLNO          KDLNO                               CIR014 AR970738
     C                   MOVE      DLNO          KDLNO             6                        AR970738
     C     KDLNO         CHAIN     DLDLDGD0                                                   CIR014
     C                   ENDIF                                                                CIR014
      *                                                                                       CIR014
     C/COPY WNCPYSRC,DL0280C287
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C                   MOVE      *BLANKS       BLKUF                                         CSW00
     C                   MOVE      *BLANKS       BLKTF                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
      ** IF CSW005 = 'Y' and Our Rate Fixing Ind (URFIN) = 'F'            CSW005
      **    THEN set UFRIN to 'X'                                         CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     URFIN         ANDEQ     'F'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     URFIN         ANDEQ     'F'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'B'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'B'                                                        227642
     C     CSW005        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'C'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'C'                                                        227642
     C                   MOVE      'X'           URFIN                                         CSW00
     C                   MOVE      '1'           *IN15                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
      ** IF CSW005 = 'Y' and Their Rate Fixing Ind (TRFIN) = 'F'          CSW005
      **    THEN set TFRIN to 'X'                                         CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     TRFIN         ANDEQ     'F'                                                         CSW00
     C     CSW005        OREQ      'Y'                                                         CSW01
     C     TRFIN         ANDEQ     'F'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'B'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'B'                                                        227642
     C     CSW005        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'C'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'C'                                                        227642
     C                   MOVE      'X'           TRFIN                                         CSW00
     C                   MOVE      '1'           *IN15                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                                       229628
      ** Check rate fix indicator                                                             229628
      *                                                                                       229628
     C     CSW005        IFEQ      'Y'                                                        229628
     C     CSW011        OREQ      'Y'                                                        229628
     C     UINFD         IFGE      EVCD                                                       229628
     C     UINFD         ANDLE     UNICD                                                      229628
     C     URFIN         ANDNE     *BLANK                                                     229628
     C                   MOVE      *BLANK        URFIN                                        229628
     C                   MOVE      '1'           *IN15                                        229628
     C                   ENDIF                                                                229628
     C     TINFD         IFGE      EVCD                                                       229628
     C     TINFD         ANDLE     TNICD                                                      229628
     C     TRFIN         ANDNE     *BLANK                                                     229628
     C                   MOVE      *BLANK        TRFIN                                        229628
     C                   MOVE      '1'           *IN15                                        229628
     C                   ENDIF                                                                229628
     C                   ENDIF                                                                229628
     C*                                                                   CIR001
     C** If a buy-out is due, set the maturity date to the buy-out        CIR001
     C** value date.                                                      CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     BOVD          IFLE      EVCD                                                        CIR00
     C     BOVD          ANDNE     *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C288
     C     UNIPD         IFEQ      0                                                           CIR00
     C                   Z-ADD     MDAT          UNIPD                                         CIR00
     C                   END                                                                   CIR00
     C     TNIPD         IFEQ      0                                                           CIR00
     C                   Z-ADD     MDAT          TNIPD                                         CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     BOVD          MDAT                                          CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
      *                                                                                       CIR014
     C                   EVAL      W_UNIPD = UNIPD                                            CIR014
     C                   EVAL      W_TNIPD = TNIPD                                            CIR014
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* SET UP PROFIT CENTRE REGARDLESS OF EVENT TYPE                     LN0711
     C                   MOVEL     PRFC          OPPRFC                                        LN071
      *                                                                                       CAS005
      ** Setup Ours/Theirs Principal Amount for Net-Treasury-Rate                             CAS005
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UPAMT         FSUPAM
     C                   Z-ADD     TPAMT         FSTPAM
     C                   ENDIF
     C*                                                                   S01119
     C*  NON-SHADOW POST PROCESSING                                       S01119
     C*                                                                   S01119
     C     *INU1         IFEQ      '1'                                                         S0111
     C*                                                                   S01119
     C*  OUR SHORT TERM RATE PROCESSING                                   S01119
     C*                                                                   S01119
     C     UBRTT         IFNE      0                                                           S0111
     C                   TESTB     '2'           UDNSI                    31                   S0111
     C*  IF SHORT TERM RATE BIT IS ON AND DEAL IS PAST VALUE DATE         S01119
     C*  IT IS NECESSARY TO RECALCULATE ACCRUALS USING NEW RATE           S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     VDAT          ANDLT     BJRDNB                                                      S0119
     C*                                                                   CIR001
     C** IF OUR INTEREST IS UP FRONT (METHOD 'D' OR 'Y')                  CIR001
     C** RECALCULATE INTEREST TO THE INTEREST ACCRUAL CONTROL DATE(THIS   CIR001
     C** IS THE NEXT INTEREST PAYMENT DATE AND IT WILL STAY THIS DATE).   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'D'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     ULPCD         ZIBEG                                         CIR00
     C                   Z-ADD     UIACD         ZIEND                                         CIR00
     C                   Z-ADD     UEINR         ZIRATE                                        CIR00
     C                   Z-ADD     UICBS         ZICALC                                        CIR00
     C                   Z-ADD     UPAMT         ZIAMT                                         CIR00
     C                   EXSR      GLINTC                                                      CIR00
     C     UINPM         IFEQ      'Y'                                                         CIR00
     C                   EXSR      #LCIYD                                                      CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C                   END                                                                   CIR00
     C                   SUB       UIALC         UAITC                                         CIR00
     C                   ADD       WKINT         UAITC                                         CIR00
     C                   Z-ADD     WKINT         UIALC                                         CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     ULPCD         ZIBEG
     C                   Z-ADD     UIACD         ZIEND
     C                   Z-ADD     UICBS         ZICALC
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   Z-ADD     FSUPAM        ZIAMT
     C                   EXSR      GLINTC
     C     UINPM         IFEQ      'Y'
     C                   EXSR      #LCIYD
     C                   Z-ADD(H)  WKINT         WINTST
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   END
     C                   SUB       FSUALB        FSUITB
     C                   ADD       WINTST        FSUITB
     C                   Z-ADD     WINTST        FSUALB
     C                   ENDIF
      *                                                                                       CAS005
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     ULPCD         ZIBEG                                         S0111
     C                   Z-ADD     BJRDNB        ZIEND                                         S0119
     C                   Z-ADD     UEINR         ZIRATE                                        S0111
     C                   Z-ADD     UICBS         ZICALC                                        S0111
     C                   Z-ADD     UPAMT         ZIAMT                                         S0111
     C*                                                                   CIR002
     C** If CIR001 is switched on, add our unsettled interest and         CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280CP44                                           S01408
     C                   EXSR      GLINTC                                                      S0111
     C/COPY WNCPYSRC,DL0280CP45                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C*  REMOVE OLD ACCRUAL AMOUNT AND ADD NEW AMOUNT IF PREVIOUS         S01119
     C*  SHORT TERM RATE HAS BEEN ENTERED I.E. IF IACD NE LPCD            S01119
     C*  RESET ACCRUAL SINCE LAST CHANGE AND INT.ACCRUAL CONTROL DATE     S01119
     C     UIACD         IFNE      ULPCD                                                       S0111
     C     UAITC         SUB       UIALC         UAITC                                         S0111
     C                   END                                                                   S0111
     C     UAITC         ADD       WKINT         UAITC                                         S0111
     C                   Z-ADD     WKINT         UIALC                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     ULPCD         ZIBEG
     C                   Z-ADD     BJRDNB        ZIEND
     C                   Z-ADD     UICBS         ZICALC
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   Z-ADD     FSUPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR001 is switched on, add our unsettled interest and                             CAS005
      ** adjustment to our principal.                                                         CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'L'
     C                   ADD       OUSI          ZIAMT
     C                   ADD       OUSA          ZIAMT
     C                   ENDIF
     C                   EXSR      SRDLIN
     C     UIACD         IFNE      ULPCD
     C     FSUITB        SUB       FSUALB        FSUITB
     C                   ENDIF
      *                                                                                       CAS005
     C     FSUITB        ADD       WKINT         FSUITB
     C                   Z-ADD     WINTST        FSUALB
     C                   ENDIF
     C                   Z-ADD     BJRDNB        UIACD                                         S0119
     C*                                                                   CIR002
     C** Maintain the unsettled interest amount as well.                  CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         OUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
     C                   END                                                                   S0111
     C*  SETOFF SHORT TERM RATE BIT                                       S01119
     C                   BITOFF    '2'           UDNSI                                         S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* THEIR SHORT TERM RATE PROCESSING                                  S01119
     C*                                                                   S01119
     C     TBRTT         IFNE      0                                                           S0111
     C                   TESTB     '2'           TDNSI                    31                   S0111
     C*  IF SHORT TERM RATE BIT IS ON AND DEAL IS PAST VALUE DATE         S01119
     C*  IT IS NECESSARY TO RECALCULATE ACCRUALS USING NEW RATE           S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     VDAT          ANDLT     BJRDNB                                                      S0119
     C*                                                                   CIR001
     C** IF THEIR INTEREST IS UP FRONT (METHOD 'D' OR 'Y')                CIR001
     C** RECALCULATE INTEREST TO THE INTEREST ACCRUAL CONTROL DATE (THIS  CIR001
     C** IS THE NEXT INTEREST PAYMENT DATE AND IT WILL STAY THIS DATE).   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'D'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     TLPCD         ZIBEG                                         CIR00
     C                   Z-ADD     TIACD         ZIEND                                         CIR00
     C                   Z-ADD     TEINR         ZIRATE                                        CIR00
     C                   Z-ADD     TICBS         ZICALC                                        CIR00
     C                   Z-ADD     TPAMT         ZIAMT                                         CIR00
     C                   EXSR      GLINTC                                                      CIR00
     C     TINPM         IFEQ      'Y'                                                         CIR00
     C                   EXSR      #LCIYD                                                      CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C                   END                                                                   CIR00
     C                   SUB       TIALC         TAITC                                         CIR00
     C                   ADD       WKINT         TAITC                                         CIR00
     C                   Z-ADD     WKINT         TIALC                                         CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TLPCD         ZIBEG
     C                   Z-ADD     TIACD         ZIEND
     C                   Z-ADD     TICBS         ZICALC
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   Z-ADD     FSTPAM        ZIAMT
     C                   EXSR      GLINTC
     C     TINPM         IFEQ      'Y'
     C                   EXSR      #LCIYD
     C                   Z-ADD(H)  WKINT         WINTST
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   ENDIF
     C                   SUB       FSTALB        FSTITB
     C                   ADD       WINTST        FSTITB
     C                   Z-ADD     WINTST        FSTALB
     C                   ENDIF
      *                                                                                       CAS005
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C                   Z-ADD     TLPCD         ZIBEG                                         S0111
     C                   Z-ADD     BJRDNB        ZIEND                                         S0119
     C                   Z-ADD     TEINR         ZIRATE                                        S0111
     C                   Z-ADD     TICBS         ZICALC                                        S0111
     C                   Z-ADD     TPAMT         ZIAMT                                         S0111
     C*                                                                   CIR002
     C** If CIR001 is switched on, add their unsettled interest and       CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280CP52                                           S01408
     C                   EXSR      GLINTC                                                      S0111
     C/COPY WNCPYSRC,DL0280CP53                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C*  REMOVE OLD ACCRUAL AMOUNT AND ADD NEW AMOUNT IF PREVIOUS         S01119
     C*  SHORT TERM RATE HAS BEEN ENTERED I.E. IF IACD NE LPCD            S01119
     C*  RESET ACCRUAL SINCE LAST CHANGE AND INT.ACCRUAL CONTROL DATE     S01119
     C     TIACD         IFNE      TLPCD                                                       S0111
     C     TAITC         SUB       TIALC         TAITC                                         S0111
     C                   END                                                                   S0111
     C     TAITC         ADD       WKINT         TAITC                                         S0111
     C                   Z-ADD     WKINT         TIALC                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TLPCD         ZIBEG
     C                   Z-ADD     BJRDNB        ZIEND
     C                   Z-ADD     TICBS         ZICALC
     C                   Z-ADD     FSTPAM        ZIAMT
     C                   Z-ADD     FSTEFR        ZIRATE
      *                                                                                       CAS005
      ** If CIR001 is switched on, add their unsettled interest and                           CAS005
      ** adjustment to their principal.                                                       CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'L'
     C                   ADD       TUSI          ZIAMT
     C                   ADD       TUSA          ZIAMT
     C                   ENDIF
     C                   EXSR      SRDLIN
     C     TIACD         IFNE      TLPCD
     C     FSTITB        SUB       FSTALB        FSTITB
     C                   ENDIF
     C     FSTITB        ADD       WINTST        FSTITB
     C                   Z-ADD     WINTST        FSTALB
     C                   ENDIF
     C                   Z-ADD     BJRDNB        TIACD                                         S0119
     C*                                                                   CIR002
     C** Maintain the unsettled interest amount as well.                  CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         TUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
     C                   END                                                                   S0111
     C*  SETOFF SHORT TERM RATE BIT                                       S01119
     C                   BITOFF    '2'           TDNSI                                         S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*****   DEAL DATE                                                   S01119
     C*                                                                   S01119
     C                   TESTB     '0'           ACEI                 31                       S0111
     C     DDAT          IFLE      EVCD                                                        S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
     C                   Z-ADD     DDAT          KYDAT                                         S0111
     C                   Z-ADD     DDAT          KYFED                                         S0111
     C*                                                                   S01119
     C*****   PRINCIPAL KEY - OURS                                        S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0280C289
     C                   MOVEA     'RXD'         AKY(1)                                        S0111
     C/COPY WNCPYSRC,DL0280C290
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   OA'       AKY(6)                                        S0111
     C                   MOVEL     NEV(1)        NARREV                                        06014
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   TESTB     '0'           UDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
0764 C                   SETOFF                                       4546                     S0111
0765 C     UDECP         COMP      1                                    4344                   S0111
     C  N43
0766 CANN44UDECP         COMP      3                                    4546                   S0111
     C                   SETON                                        71                       S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C*****   EXPOSURE KEY - OURS                                         S01119
     C***   OUR EXPOSURE AMOUNT CALCULATED BETWEEN VALUE AND MATURITY     S01119
     C*                                                                   S01119
     C                   MOVE      DTYP          RRDT                                          S0111
     C                   Z-ADD     UPAMT         RRPA                                          S0111
     C                   Z-ADD     VDAT          RRSD                                          S0111
     C                   Z-ADD     MDAT          RRED                                          S0111
     C                   EXSR      DLRREX                                                      S0111
     C                   Z-ADD     RREA          KYAMT                                         S0111
     C                   Z-ADD     RREA          UAEXA                                         S0111
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C*****   PRINCIPAL KEY - THEIRS                                      S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0280C291
     C                   MOVEA     'RXD'         AKY(1)                                        S0111
     C/COPY WNCPYSRC,DL0280C292
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   TA'       AKY(6)                                        S0111
     C                   MOVEL     NEV(1)        NARREV                                        06014
     C                   Z-ADD     TPAMT         KYAMT                                         S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   TESTB     '0'           TDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     TPAMT         NRRPUR                                        S0111
0764 C                   SETOFF                                       4546                     S0111
0765 C     TDECP         COMP      1                                    4344                   S0111
     C  N43
0766 CANN44TDECP         COMP      3                                    4546                   S0111
     C                   EXCEPT    RXTHRS                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C*****   EXPOSURE KEY - THEIRS                                       S01119
     C*** THEIR EXPOSURE AMOUNT CALCULATED BETWEEN VALUE AND MATURITY     S01119
     C*                                                                   S01119
     C                   MOVE      DTYP          RRDT                                          S0111
     C                   Z-ADD     TPAMT         RRPA                                          S0111
     C                   Z-ADD     VDAT          RRSD                                          S0111
     C                   Z-ADD     MDAT          RRED                                          S0111
     C                   EXSR      DLRREX                                                      S0111
     C                   Z-ADD     RREA          KYAMT                                         S0111
     C                   Z-ADD     RREA          TAEXA                                         S0111
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   CIR001
     C**  UP-FRONT FEE/PREMIUM DEAL DATE ACCOUNT KEY                      CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UPVD          ANDNE     *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C     DTYP          IFEQ      'RX'                                                        CIR00
     C                   MOVEA     'RXD'         AKY(1)                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVEA     'RSD'         AKY(1)                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVEA     UPPR          AKY(9)                                        CIR00
     C*                                                                   CIR001
     C                   Z-ADD     UPFE          KYAMT                                         CIR00
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C293
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C294
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C295
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   END                                                                   CIR00
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C296
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C297
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** WRITE ACCOUNT KEY FOR UP-FRONT FEE/PREMIUM                       CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   BITON     '0'           ACEI                                          S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C**  BUY-OUT DEAL DATE ACCOUNT KEY                                   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '4'           ACEI                 31                       CIR00
     C*                                                                   CIR001
     C     BODD          IFLE      EVCD                                                        CIR00
     C     BODD          ANDNE     *ZEROS                                                      CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C*                                                                   CIR001
     C                   Z-ADD     BODD          KYDAT                                         CIR00
     C                   Z-ADD     BODD          KYFED                                         CIR00
     C*                                                                   CIR001
     C     DTYP          IFEQ      'RX'                                                        CIR00
     C                   MOVEA     'RXD'         AKY(1)                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVEA     'RSD'         AKY(1)                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    B'       AKY(6)                                        CIR00
     C                   MOVEA     BAPR          AKY(9)                                        CIR00
     C                   Z-ADD     BOAM          KYAMT                                         CIR00
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT METHOD                   CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C298
     C     BAPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C299
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C300
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   END                                                                   CIR00
     C     BAPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C301
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C302
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** WRITE ACCOUNT KEY FOR BUY-OUT                                    CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C                   BITON     '4'           ACEI                                          CIR00
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 CIR001
     C*                                                                   CIR001
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C** VALUE DATE PROCESSING                                            CIR001
     C*                                                                   CIR001
     C** UP-FRONT FEES/PREMIUM                                            CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '3'           ACEI                 31                       CIR00
     C*                                                                   CIR001
     C     UPVD          IFLE      EVCD                                                        CIR00
     C     UPVD          ANDNE     *ZEROS                                                      CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C*                                                                   CIR001
     C                   Z-ADD     UPVD          KYDAT                                         CIR00
     C                   Z-ADD     UPVD          KYFED                                         CIR00
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'V'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVEA     UPPR          AKY(9)                                        CIR00
     C                   MOVEL     NEV(11)       NARREV                                        CIR00
     C                   Z-ADD     UPFE          KYAMT                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'F'           F1FFLG
     C                   Z-ADD     UPFE          F1FVAL
     C                   Z-ADD     100           F1FPCT
     C                   ENDIF
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C303
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C304
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C305
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       199825
     C                   MOVE      POBR          KYSTBR
      *                                                                                       199825
     C                   END                                                                   CIR00
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C306
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C307
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       199825
     C                   MOVE      ROBR          KYSTBR
      *                                                                                       199825
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** SETUP REPORT FIELDS                                              CIR001
     C*                                                                   CIR001
     C                   Z-ADD     UPFE          NRRPUR                                        CIR00
     C                   MOVE      '  '          NRBRTT                                        CIR00
     C                   SETON                                        7131                     CIR00
     C*                                                                   CIR001
     C** WRITE ACCOUNT KEY FOR UP-FRONT FEES/PREMIUM                      CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
      *                                                                                       CGL020
     C                   BITON     '3'           ACEI                                          CIR00
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 CIR001
     C*                                                                   CIR001
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C**  VALUE DATE PROCESSING                                           CIR001
     C*                                                                   CIR001
     C                   TESTB     '1'           ACEI                 31                       CIR00
     C     VDAT          IFLE      EVCD                                                        CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C*                                                                   CIR001
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     UINFD         IFLE      VDAT                                                        CSW00
     C     UINFD         ORGT      BJRDNB                                                      CSW00
     C                   MOVE      'Y'           BLKUF                                         CSW00
     C                   ENDIF                                                                 CSW00
     C     TINFD         IFLE      VDAT                                                        CSW00
     C     TINFD         ORGT      BJRDNB                                                      CSW00
     C                   MOVE      'Y'           BLKTF                                         CSW00
     C                   ENDIF                                                                 CSW00
     C                   ENDIF                                                                 CSW00
     C** IF THEIR INTEREST IS UP FRONT (DISCOUNT OR YIELD)                CIR001
     C** THEIR FIRST INTEREST PAYMENT DATE IS VALUE DATE                  CIR001
     C*                                                                   CIR001
     C     TINPM         IFEQ      'D'                                                         CIR00
     C     TINPM         OREQ      'Y'                                                         CIR00
     C                   Z-ADD     VDAT          TNIPD                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** IF OUR INTEREST IS UP FRONT (DISCOUNT OR YIELD)                  CIR001
     C** OUR FIRST INTEREST PAYMENT DATE IS VALUE DATE                    CIR001
     C*                                                                   CIR001
     C     UINPM         IFEQ      'D'                                                         CIR00
     C     UINPM         OREQ      'Y'                                                         CIR00
     C                   Z-ADD     VDAT          UNIPD                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C482
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     VDEI          ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     VDAT          KYDAT                                         CIR00
     C                   Z-ADD     VDAT          KYFED                                         CIR00
      *                                                                   CIR003
      ** Principal key for OUR side                                       CIR003
      *                                                                   CIR003
     C                   MOVEA     'RXV'         AKY(1)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '   OA'       AKY(6)                                        CIR00
      *                                                                   CIR003
     C     UCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   MOVE      'B'           AKY(8)                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVEA     NEV(2)        NARREV                                        CIR00
     C                   Z-ADD     UPAMT         KYAMT                                         CIR00
     C**********         MOVEL     TFRDKY        FRDKY                                CIR003 BUG8118
     C                   MOVEL     UFRDKY        FRDKY                                       BUG8118
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                   CIR003
     C                   MOVEL     'VAL'         KEDCD             3                           CIR00
     C                   MOVE      *IN87         WIN87                                         CIR00
     C     WDLKEY        CHAIN     DLGXSTL0                           87                       CIR00
      *                                                                   CIR003
     C     *IN87         IFEQ      '1'                                                         CIR00
     C                   MOVEL     DLNO          WKEY              9                           CIR00
     C                   MOVE      KEDCD         WKEY                                          CIR00
     C                   MOVEL     'DLGXSTL0'    DBFILE                          ************  CIR00
     C                   MOVEL     '30'          DBASE                           *DBERROR 30*  CIR00
     C                   MOVEL     WKEY          DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   Z-ADD     RXRSTM        KYSETL                                        CIR00
     C                   MOVEL     RXRONS        KYOSTL                                        CIR00
     C                   MOVEL     RXROBR        KYSTBR                                        CIR00
     C                   MOVEL     RXRSCY        KYSCY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'RX'          STINFO
     C                   ENDIF
      *                                                                   CIR003
     C                   TESTB     '0'           UDNSI                    31                   CIR00
     C     NRBRTT        IFEQ      '00'                                                        CIR00
     C                   MOVE      *BLANKS       NRBRTT                                        CIR00
     C                   MOVE      '0'           *IN31                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   MOVEA     '0000'        *IN(43)                                       CIR00
      *                                                                   CIR003
     C                   SELECT                                                                CIR00
     C     UDECP         WHENEQ    0                                                           CIR00
     C                   MOVE      '1'           *IN43                                         CIR00
     C     UDECP         WHENEQ    1                                                           CIR00
     C                   MOVE      '1'           *IN44                                         CIR00
     C     UDECP         WHENEQ    2                                                           CIR00
     C                   MOVE      '1'           *IN45                                         CIR00
     C     UDECP         WHENEQ    3                                                           CIR00
     C                   MOVE      '1'           *IN46                                         CIR00
     C                   ENDSL                                                                 CIR00
     C                   MOVE      '1'           *IN71                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
      *                                                                   CIR003
      ** Principal key for OUR side (Base Currency Equivalent)            CIR003
      *                                                                   CIR003
     C                   MOVEA     UCUCY         AKY(6)                                        CIR00
     C                   MOVEL     BJCYCD        KYCCY                                         CIR00
     C                   Z-ADD     0             KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
      *                                                                   CIR003
     C     UCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   Z-ADD     UPAMT         KYAMT                                         CIR00
     C                   ELSE                                                                  CIR00
      *                                                                   CIR003
     C                   MOVE      *IN87         WIN87                                         CIR00
     C                   Z-ADD     1             I                                             CIR00
     C     UCUCY         LOOKUP    CY(I)                                  87                   CIR00
     C     *IN87         IFEQ      '0'                                                         CIR00
     C                   MOVEL     'TABTG30 '    DBFILE                          ************  CIR00
     C                   MOVEL     '31'          DBASE                           *DBERROR 31*  CIR00
     C                   MOVEL     UCUCY         DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     CYD(I)        CYDDS                                         CIR00
     C                   Z-ADD     UPAMT         ZAMTCI                                        CIR00
     C                   Z-ADD     UBCXR         ZEXCH                                         CIR00
     C                   Z-ADD     UDECP         ZCDPI                                         CIR00
     C                   Z-ADD     BCDP          ZCDPO                                         CIR00
      *                                                                   CIR003
     C     MDIN          IFEQ      1                                                           CIR00
     C                   MOVE      'M'           ZMD
     C                   ELSE                                                                  CIR00
     C                   MOVE      'D'           ZMD
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      ZCONV                                                       CIR00
     C                   Z-ADD     ZAMTCO        KYAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   EXSR      EXCP                                                        CIR00
      *                                                                   CIR003
      ** Principal key for THEIR side                                     CIR003
      *                                                                   CIR003
     C                   MOVEA     '   T'        AKY(6)                                        19815
     C     TCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   MOVE      'B'           AKY(8)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   MOVEL     NEV(2)        NARREV                                        CIR00
     C                   Z-ADD     TPAMT         KYAMT                                         CIR00
     C                   MOVEL     TFRDKY        FRDKY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   Z-ADD     RXPSTM        KYSETL                                        CIR00
     C                   MOVEL     RXPONS        KYOSTL                                        CIR00
     C                   MOVEL     RXPOBR        KYSTBR                                        CIR00
     C                   MOVEL     RXPSCY        KYSCY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'RX'          STINFO
     C                   ENDIF
      *                                                                   CIR003
     C                   TESTB     '0'           TDNSI                    31                   CIR00
     C     NRBRTT        IFEQ      '00'                                                        CIR00
     C                   MOVE      *BLANKS       NRBRTT                                        CIR00
     C                   MOVE      '0'           *IN31                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   MOVEA     '0000'        *IN(43)                                       CIR00
      *                                                                   CIR003
     C                   SELECT                                                                CIR00
     C     TDECP         WHENEQ    0                                                           CIR00
     C                   MOVE      '1'           *IN43                                         CIR00
     C     TDECP         WHENEQ    1                                                           CIR00
     C                   MOVE      '1'           *IN44                                         CIR00
     C     TDECP         WHENEQ    2                                                           CIR00
     C                   MOVE      '1'           *IN45                                         CIR00
     C     TDECP         WHENEQ    3                                                           CIR00
     C                   MOVE      '1'           *IN46                                         CIR00
     C                   ENDSL                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      EXCP                                                        CIR00
     C                   Z-ADD     TPAMT         NRRPUR                                        CIR00
     C                   EXCEPT    RXTHRS                                                      CIR00
     C                   ADD       1             PLINES                                        CIR00
      *                                                                   CIR003
      ** Principal key for THEIR side (Base Currency Equivalent)          CIR003
      *                                                                   CIR003
     C                   MOVEA     TCUCY         AKY(6)                                        CIR00
     C                   MOVEL     BJCYCD        KYCCY                                         CIR00
     C                   Z-ADD     0             KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
      *                                                                   CIR003
     C     TCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   Z-ADD     TPAMT         KYAMT                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      *IN87         WIN87             1                           CIR00
     C                   Z-ADD     1             I                                             CIR00
     C     TCUCY         LOOKUP    CY(I)                                  87                   CIR00
     C     *IN87         IFEQ      '0'                                                         CIR00
     C                   MOVEL     'TABTG30 '    DBFILE                          ************  CIR00
     C                   MOVEL     '32'          DBASE                           *DBERROR 32*  CIR00
     C                   MOVEL     TCUCY         DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     CYD(I)        CYDDS                                         CIR00
     C                   Z-ADD     TPAMT         ZAMTCI                                        CIR00
     C                   Z-ADD     TBCXR         ZEXCH                                         CIR00
     C                   Z-ADD     TDECP         ZCDPI                                         CIR00
     C                   Z-ADD     BCDP          ZCDPO                                         CIR00
      *                                                                   CIR003
     C     MDIN          IFEQ      1                                                           CIR00
     C                   MOVE      'M'           ZMD
     C                   ELSE                                                                  CIR00
     C                   MOVE      'D'           ZMD
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      ZCONV                                                       CIR00
     C                   Z-ADD     ZAMTCO        KYAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C**  SET ON VALUE DATE BIT                                           CIR001
     C*                                                                   CIR001
     C                   BITON     '1'           ACEI                                          CIR00
     C*                                                                   CIR001
     C** SET DEALS FILE UPDATE INDICATOR                                  CIR001
     C*                                                                   CIR001
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                 230171
      *                                                                                       230171
      ** If CIR001 is not installed, blank out URFIN and TRFIN for                            230171
      ** value date processing.                                                               230171
      *                                                                                       230171
     C                   TESTB     '1'           ACEI                 31                      230171
     C     VDAT          IFLE      EVCD                                                       230171
     C     *IN31         ANDEQ     '1'                                                        230171
      *                                                                                       230171
     C     CSW005        IFEQ      'Y'                                                        230171
     C     CSW011        OREQ      'Y'                                                        230171
      *                                                                                       230171
     C     UINFD         IFLE      VDAT                                                       230171
     C     UINFD         ORGT      BJRDNB                                                     230171
     C                   MOVE      'Y'           BLKUF             1                          230171
     C                   END                                                                  230171
      *                                                                                       230171
     C     TINFD         IFLE      VDAT                                                       230171
     C     TINFD         ORGT      BJRDNB                                                     230171
     C                   MOVE      'Y'           BLKTF             1                          230171
     C                   END                                                                  230171
      *                                                                                       230171
     C                   END                                                                  230171
      *                                                                                       230171
     C                   END                                                                  230171
      *                                                                                       230171
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* INTEREST DATE PROCESSING                                          S01119
     C*                                                                   S01119
     C*   THEIR WORK FIELD                                                S01119
     C*   IF INTEREST PAYMENT DATE IS ZERO,USE INTEREST CHANGE DATE       S01119
     C*   UNLESS IT IS ALSO ZERO.IN THIS CASE INTEREST PAYMENT IS         S01119
     C*   ON MATURITY DATE                                                S01119
     C     TNIPD         IFEQ      0                                                           S0111
     C     TNICD         IFNE      0                                                           S0111
     C                   Z-ADD     TNICD         WNIPDT            5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPDT                                        S0111
      *                                                                   188689
      ** If Maturity Date equals previously processed  Interest           188689
      ** Payment, set Start/Last Interest payment date to zero            188689
      ** to process Interest Accrual entry reversal.                      188689
      *                                                                   188689
     C                   TESTB     '2'           ACEI                 31                       18868
     C     WNIPDT        IFEQ      TSLIP                                                       18868
     C     *IN31         ANDEQ     '1'                                                         18868
     C                   Z-ADD     0             TSLIP                                         18868
     C                   END                                                                   18868
      *                                                                   188689
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TNIPD         WNIPDT                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*   OUR WORK FIELD                                                  S01119
     C*   IF INTEREST PAYMENT DATE IS ZERO,USE INTEREST CHANGE DATE       S01119
     C*   UNLESS IT IS ALSO ZERO.IN THIS CASE INTEREST PAYMENT IS         S01119
     C*   ON MATURITY DATE                                                S01119
     C*                                                                   S01119
     C     UNIPD         IFEQ      0                                                           S0111
     C     UNICD         IFNE      0                                                           S0111
     C                   Z-ADD     UNICD         WNIPDU            5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPDU                                        S0111
      *                                                                   188689
      ** If Maturity Date equals previously processed  Interest           188689
      ** Payment, set Start/Last Interest payment date to zero            188689
      ** to process Interest Accrual entry reversal.                      188689
      *                                                                   188689
     C                   TESTB     '2'           ACEI                 31                       18868
     C     WNIPDU        IFEQ      USLIP                                                       18868
     C     *IN31         ANDEQ     '1'                                                         18868
     C                   Z-ADD     0             USLIP                                         18868
     C                   END                                                                   18868
      *                                                                   188689
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     UNIPD         WNIPDU                                        S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C413
     C*                                                                   CIR001
     C** IF INTEREST IS UP FRONT (DISCOUNT OR YIELD)                      CIR001
     C** DETERMINE INTEREST PAYMENT DATE AFTER NEXT INTEREST PAYMENT      CIR001
     C** DATE (TERMED THE NEXT INTEREST END DATE)                         CIR001
     C** ELSE THIS DATE IS THE SAME AS THE NEXT INTEREST PAYMENT DATE     CIR001
     C*                                                                   CIR001
     C** THEIRS:                                                          CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     TINPM         IFEQ      'D'                                                         CIR00
     C     TINPM         OREQ      'Y'                                                         CIR00
     C                   MOVEL     'T'           OTIN                                          CIR00
     C                   MOVEL     'P'           RCIP                                          CIR00
     C                   Z-ADD     WNIPDT        ZDAYNO                                        CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        WNIEDT            5 0                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     WNIPDT        WNIEDT                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** OURS:                                                            CIR001
     C*                                                                   CIR001
     C     UINPM         IFEQ      'D'                                                         CIR00
     C     UINPM         OREQ      'Y'                                                         CIR00
     C                   MOVEL     'U'           OTIN                                          CIR00
     C                   MOVEL     'P'           RCIP                                          CIR00
     C                   Z-ADD     WNIPDU        ZDAYNO                                        CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        WNIEDU            5 0                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     WNIPDU        WNIEDU                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** SET OFF FLAGS                                                    CIR001
     C*                                                                   CIR001
     C                   MOVE      ' '           THR               1                           CIR00
     C                   MOVE      ' '           OUR               1                           CIR00
     C**********         MOVE      ' '           TFX                                BUG7531 BUG12679
     C**********         MOVE      ' '           OFX                                BUG7531 BUG12679
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C                   MOVE      ' '           TFX                                        BUG12679
     C                   MOVE      ' '           OFX                                        BUG12679
     C*                                                                   S01119
     C** SHADOW POST                                                      S01119
     C*                                                                   S01119
     C     *INU1         IFNE      '1'                                                         S0111
     C/COPY WNCPYSRC,DL0280C483
      *                                                                                       235079
     C     CIR001        IFEQ      'Y'                                                        235079
     C     TNPCD         IFNE      0                                                          235079
     C                   GOTO      RXPRCT                                                     235079
     C                   ELSE                                                                 235079
     C     UNPCD         IFNE      0                                                          235079
     C                   GOTO      RXPRCU                                                     235079
     C                   ENDIF                                                                235079
     C                   ENDIF                                                                235079
     C                   END                                                                  235079
      *                                                                                       235079
     C     WNIPDT        CABLE     EVCD          RXSHD1                                        S0111
     C     WNIPDU        CABLE     EVCD          RXSHD2                                        S0111
     C*                                                                   CIR001
     C** If no interest payments are due, go to tag RXMDAT to             CIR001
     C** process the buy-out payment                                      CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   GOTO      RXMDAT                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   GOTO      RXSEND                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  DATE PROCESSING                                                  S01119
     C*                                                                   S01119
     C     RXDATE        TAG                                                    ** RXDATE TAG**S0111
     C*                                                                   CIR001
     C** PRINCIPAL CHANGE DUE                                             CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     TNPCD         IFLE      EVCD                                                        18490
     C     TNPCD         ANDNE     *ZERO                                                       CIR00
     C*                                                                   CIR001
     C** AND NO OTHER EVENTS PRIOR TO THE PRINCIPAL CHANGE                CIR001
     C*                                                                   CIR001
     C     WNIPDT        IFLE      TNPCD                                                       CIR00
     C     WNIPDT        ANDNE     *ZERO                                                       CIR00
     C/COPY WNCPYSRC,DL0280C424
     C/COPY WNCPYSRC,DL0280C425
     C     TINFD         ORLE      TNPCD                                                       CIR00
     C     TINFD         ANDNE     *ZERO                                                       CIR00
     C     TFX           ANDNE     ' '                                                       BUG7531
     C     TNICD         ORLE      TNPCD                                                       CIR00
     C     TNICD         ANDNE     *ZERO                                                       CIR00
     C                   ELSE                                                                  CIR00
     C                   GOTO      RXPRCT                                                      18490
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
      *                                                                   184906
      ** Check OUR side                                                   184906
      *                                                                   184906
     C     UNPCD         IFLE      EVCD                                                        18490
     C     UNPCD         ANDNE     *ZERO                                                       18490
      *                                                                   184906
     C     WNIPDU        IFLE      UNPCD                                                       18490
     C     WNIPDU        ANDNE     *ZERO                                                       18490
     C     UINFD         ORLE      UNPCD                                                       18490
     C     UINFD         ANDNE     *ZERO                                                       18490
     C     OFX           ANDNE     ' '                                                       BUG7531
     C     UNICD         ORLE      UNPCD                                                       18490
     C     UNICD         ANDNE     *ZERO                                                       18490
     C                   ELSE                                                                  18490
     C                   GOTO      RXPRCU                                                      18490
     C                   END                                                                   18490
     C                   END                                                                   18490
     C*                                                                   CIR001
     C** THEIR INTEREST PAYMENT DATE TO BE PROCESSED                      CIR001
     C*                                                                   CIR001
     C     WNIPDT        IFLE      EVCD                                                        CIR00
     C     WNIEDT        ANDGT     TSLIP                                                       CIR00
     C                   GOTO      RXPROC                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** OUR INTEREST PAYMENT DATE TO BE PROCESSED                        CIR001
     C*                                                                   CIR001
     C     WNIPDU        IFLE      EVCD                                                        CIR00
     C     WNIEDU        ANDGT     USLIP                                                       CIR00
     C                   GOTO      RXPROC                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   S01119
     C*  THEIR INTEREST PAYMENT DATE TO BE PROCESSED                      S01119
     C     WNIPDT        IFLE      EVCD                                                        S0111
     C     WNIPDT        ANDGT     TSLIP                                                       S0111
     C                   GOTO      RXPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*    OUR INTEREST PAYMENT DATE TO BE PROCESSED                      S01119
     C     WNIPDU        IFLE      EVCD                                                        S0111
     C     WNIPDU        ANDGT     USLIP                                                       S0111
     C                   GOTO      RXPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*  THEIR INTEREST FIX DATE TO BE PROCESSED                          S01119
     C     TINFD         IFGT      0                                                           S0111
     C     TINFD         ANDLE     EVCD                                                        S0111
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  OUR INTEREST FIX DATE TO BE PROCESSED                            S01119
     C     UINFD         IFGT      0                                                           S0111
     C     UINFD         ANDLE     EVCD                                                        S0111
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  THEIR INTEREST CHANGE DATE TO BE PROCESSED                       S01119
     C     TNICD         IFGT      0                                                           S0111
     C     TNICD         ANDLE     EVCD                                                        S0111
     C                   GOTO      RXPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*    OUR INTEREST CHANGE DATE TO BE PROCESSED                       S01119
     C     UNICD         IFGT      0                                                           S0111
     C     UNICD         ANDLE     EVCD                                                        S0111
     C                   GOTO      RXPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  OTHERWISE NO REPEATING EVENT DATES TO BE PROCESSED.              S01119
     C                   GOTO      RXMDAT                                                      S0111
     C*                                                                   CIR001
     C** PRINCIPAL CHANGE DUE                                             CIR001
     C*                                                                   CIR001
     C     RXPRCT        TAG                                                                   18490
     C*                                                                   CIR001
     C** THEIRS                                                           CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     TNPCD         ANDLE     EVCD                                                        CIR00
     C     TNPCD         ANDNE     *ZERO                                                       CIR00
     C*                                                                   CIR001
     C                   Z-ADD     TEINR         ZIRATE                                        CIR00
     C                   Z-ADD     TPAMT         ZIAMT                                         CIR00
     C                   Z-ADD     TICBS         ZICALC                                        CIR00
     C                   Z-ADD     TIACD         ZIBEG                                         CIR00
     C                   Z-ADD     TNPCD         ZIEND                                         CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add their unsettled interest and    t  CIR002
     C**    adjustment to their principal.                                CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   EXSR      GLINTC                                                      CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C*                                                                   CIR001
     C** UPDATES                                                          CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C426
     C                   Z-ADD     0             TIALC                                         CIR00
     C                   ADD       WKINT         TAITC                                         CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TICBS         ZICALC
     C                   Z-ADD     TIACD         ZIBEG
     C                   Z-ADD     TNPCD         ZIEND
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   Z-ADD     FSTPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR002 is switched on, add their unsettled interest and                           CAS005
      ** adjustment to their principal.                                                       CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'L'
     C                   ADD       TUSI          ZIAMT
     C                   ADD       TUSA          ZIAMT
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXSR      GLINTC
     C                   Z-ADD(H)  ZINTR         WINTST
      *                                                                                       CAS005
     C                   Z-ADD     0             FSTALB
     C                   ADD       WINTST        FSTITB
     C                   ENDIF
     C                   Z-ADD     TNPCD         TIACD                                         CIR00
     C*                                                                   CIR001
     C** PRINCIPAL KEY - THEIRS                                           CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C308
     C                   MOVEA     'RXD'         AKY(1)                                        CIR00
     C/COPY WNCPYSRC,DL0280C309
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '  ITA'       AKY(6)                                        CIR00
     C                   MOVEL     NEV(8)        NARREV                                        CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   MOVE      TFRDKY        FRDKY                                         CIR00
     C                   Z-ADD     TNPCD         KYDAT                                         CIR00
     C                   Z-ADD     TNPCD         KYFED                                         CIR00
     C                   TESTB     '0'           TDNSI                31                       CIR00
     C*                                                                   CIR001
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              CIR001
     C*                                                                   CIR001
     C     NRBRTT        IFEQ      '00'                                                        CIR00
     C                   MOVE      '  '          NRBRTT                                        CIR00
     C                   SETOFF                                       31                       CIR00
     C                   END                                                                   CIR00
     C                   MOVE      'T'           PORTH                                         CIR00
     C                   EXSR      #LPRCH                                                      CIR00
     C*                                                                   CIR001
     C** Compute the difference between the new principal amount          CIR001
     C** and the old principal amount.  If the result is negative,        CIR001
     C** then it is a principal DECREASE. Else, if positive, then         CIR001
     C** its a principal INCREASE.                                        CIR001
     C*                                                                   CIR001
     C                   Z-ADD     0             WPDIF                                         CIR00
     C                   MOVE      ' '           WPIOD                                         CIR00
     C     WPAMT         IFNE      0                                                           CIR00
     C/COPY WNCPYSRC,DL0280C310
     C     WPAMT         SUB       TPAMT         WPDIF                                         CIR00
     C     WPDIF         IFLT      0                                                           CIR00
     C                   MOVE      'D'           WPIOD                                         CIR00
     C                   Z-SUB     WPDIF         WPDIF                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'I'           WPIOD                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C311
     C                   Z-ADD     WPAMT         NRRPUR                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C312
     C                   Z-ADD     WPDIF         KYAMT                                         CIR00
     C/COPY WNCPYSRC,DL0280C313
     C*                                                                   CIR001
     C     WPIOD         IFEQ      'D'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C314
     C                   MOVE      'M'           AKY(3)                                        CIR00
     C/COPY WNCPYSRC,DL0280C315
     C                   MOVE      'D'           AKY(8)                                        14578
     C                   MOVEL     NEV(9)        NARREV                                        CIR00
     C/COPY WNCPYSRC,DL0280C316
     C                   END                                                                   CIR00
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     PDEI          ANDEQ     'Y'                                                         CIR00
      *                                                                   CIR003
     C     TCUCY         IFEQ      BJCYCD                                                      CIR00
     C**********         MOVE      'B'           AKY(8)                               CIR003 BUG7045
     C                   MOVE      'B'           AKY(7)                                      BUG7045
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C     WPIOD         IFEQ      'I'                                                         CIR00
     C                   MOVE      'VAL'         KEDCD                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'MAT'         KEDCD                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   MOVE      *IN87         WIN87                                         CIR00
     C     WDLKEY        CHAIN     DLGXSTL0                           87                       CIR00
      *                                                                   CIR003
     C     *IN87         IFEQ      '1'                                                         CIR00
     C                   MOVEL     DLNO          WKEY              9                           CIR00
     C                   MOVE      KEDCD         WKEY                                          CIR00
     C                   MOVEL     'DLGXSTL0'    DBFILE                          ************  CIR00
     C                   MOVEL     '33'          DBASE                           *DBERROR 33*  CIR00
     C                   MOVEL     WKEY          DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C     KEDCD         IFEQ      'VAL'                                                       CIR00
     C                   Z-ADD     RXPSTM        KYSETL                                        CIR00
     C                   MOVEL     RXPONS        KYOSTL                                        CIR00
     C                   MOVEL     RXPOBR        KYSTBR                                        CIR00
     C                   MOVEL     RXPSCY        KYSCY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'RX'          STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     RXRSTM        KYSETL                                        CIR00
     C                   MOVEL     RXRONS        KYOSTL                                        CIR00
     C                   MOVEL     RXROBR        KYSTBR                                        CIR00
     C                   MOVEL     RXRSCY        KYSCY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'RX'          STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C     TDECP         COMP      1                                    4344                   CIR00
     C     TDECP         COMP      2                                  46  45                   CIR00
     C                   SETON                                        71                       CIR00
     C                   EXSR      EXCP                                                        CIR00
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     PDEI          ANDEQ     'Y'                                                         CIR00
     C                   MOVE      *BLANKS       AKY(7)                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                                      BUG7045
     C     CIR003        IFEQ      'Y'                                                       BUG7045
     C     PDEI          ANDEQ     'Y'                                                       BUG7045
     C     TCUCY         ANDEQ     BJCYCD                                                    BUG7045
     C                   MOVE      ' '           AKY(8)                                      BUG7045
     C                   ENDIF                                                               BUG7045
      *                                                                                      BUG7045
     C*                                                                   CIR001
     C**   EXPOSURE KEY - THEIRS                                          CIR001
     C**   THEIR EXPOSURE AMOUNT CALCULATED BETWEEN PRINCIPAL CHANGE      CIR001
     C**   AND MATURITY                                                   CIR001
     C                   MOVE      DTYP          RRDT                                          CIR00
     C/COPY WNCPYSRC,DL0280C317
     C                   Z-ADD     KYAMT         RRPA                                          CIR00
     C/COPY WNCPYSRC,DL0280C318
     C                   Z-ADD     KYDAT         RRSD                                          CIR00
     C                   Z-ADD     MDAT          RRED                                          CIR00
     C                   EXSR      DLRREX                                                      CIR00
     C                   Z-ADD     RREA          KYAMT                                         CIR00
     C/COPY WNCPYSRC,DL0280C319
     C     WPIOD         IFEQ      'D'                                                         CIR00
     C                   SUB       RREA          TAEXA                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   ADD       RREA          TAEXA                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C320
     C                   MOVE      'E'           AKY(10)                                       CIR00
     C                   EXSR      EXCP                                                        CIR00
     C/COPY WNCPYSRC,DL0280C484
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     PDEI          ANDEQ     'Y'                                                         CIR00
     C                   MOVEA     TCUCY         AKY(6)                                        CIR00
     C                   MOVE      'A'           AKY(10)                                       CIR00
     C     WPIOD         IFEQ      'I'                                                         CIR00
     C                   MOVE      'V'           AKY(3)                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'M'           AKY(3)                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVEL     BJCYCD        KYCCY                                         CIR00
     C                   Z-ADD     0             KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
      *                                                                   CIR003
     C     TCUCY         IFEQ      BJCYCD                                                      CIR00
     C**********         Z-ADD     TPAMT         KYAMT                                CIR003 BUG7045
     C                   Z-ADD     WPDIF         KYAMT                                       BUG7045
     C                   ELSE                                                                  CIR00
     C                   MOVE      *IN87         WIN87             1                           CIR00
     C                   Z-ADD     1             I                                             CIR00
     C     TCUCY         LOOKUP    CY(I)                                  87                   CIR00
     C     *IN87         IFEQ      '0'                                                         CIR00
     C                   MOVEL     'TABTG30 '    DBFILE                          ************  CIR00
     C                   MOVEL     '34'          DBASE                           *DBERROR 34*  CIR00
     C                   MOVEL     TCUCY         DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     CYD(I)        CYDDS                                         CIR00
     C                   Z-ADD     WPDIF         ZAMTCI                                        CIR00
     C                   Z-ADD     TBCXR         ZEXCH                                         CIR00
     C                   Z-ADD     TDECP         ZCDPI                                         CIR00
     C                   Z-ADD     BCDP          ZCDPO                                         CIR00
      *                                                                   CIR003
     C     MDIN          IFEQ      1                                                           CIR00
     C                   MOVE      'M'           ZMD
     C                   ELSE                                                                  CIR00
     C                   MOVE      'D'           ZMD
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      ZCONV                                                       CIR00
     C                   Z-ADD     ZAMTCO        KYAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      EXCP                                                        CIR00
     C                   MOVE      *BLANKS       AKY(6)                                        CIR00
     C                   MOVE      *BLANKS       AKY(7)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C     WPDIF         IFNE      0                                                           CIR00
     C/COPY WNCPYSRC,DL0280C321
     C                   Z-ADD     WPAMT         TPAMT                                         CIR00
     C/COPY WNCPYSRC,DL0280C322
     C                   END                                                                   CIR00
     C                   MOVE      ' '           AKY(8)                                        14578
     C                   END                                                                   CIR00
      *                                                                                       235079
     C     *INU1         IFNE      '1'                                                        235079
      *                                                                                       235079
     C     CIR001        IFEQ      'Y'                                                        235079
     C     UNPCD         ANDNE     0                                                          235079
     C                   GOTO      RXPRCU                                                     235079
     C                   ENDIF                                                                235079
      *                                                                                       235079
     C     WNIPDT        CABLE     EVCD          RXSHD1                                       235079
     C     WNIPDU        CABLE     EVCD          RXSHD2                                       235079
      *                                                                                       235079
      ** If no interest payments are due, go to tag RXMDAT to                                 235079
      ** process the buy-out payment                                                          235079
      *                                                                                       235079
     C     CIR001        IFEQ      'Y'                                                        235079
     C                   GOTO      RXMDAT                                                     235079
     C                   END                                                                  235079
      *                                                                                       235079
     C                   GOTO      RXSEND                                                     235079
     C                   END                                                                  235079
      *                                                                   184906
      ** Set deals file update indicator                                  184906
      *                                                                   184906
     C                   MOVE      '1'           *IN15                                         18490
     C                   GOTO      RXDATE                                                      18490
     C*                                                                   CIR001
     C** OURS                                                             CIR001
     C*                                                                   CIR001
     C     RXPRCU        TAG                                                                   18490
      *                                                                   184906
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UNPCD         ANDLE     EVCD                                                        CIR00
     C     UNPCD         ANDNE     *ZERO                                                       CIR00
     C*                                                                   CIR001
     C** OURS                                                             CIR001
     C*                                                                   CIR001
     C                   Z-ADD     UEINR         ZIRATE                                        CIR00
     C                   Z-ADD     UPAMT         ZIAMT                                         CIR00
     C                   Z-ADD     UICBS         ZICALC                                        CIR00
     C                   Z-ADD     UIACD         ZIBEG                                         CIR00
     C                   Z-ADD     UNPCD         ZIEND                                         CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add our unsettled interest and      t  CIR002
     C**    adjustment to our principal.                                  CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   EXSR      GLINTC                                                      CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C*                                                                   CIR001
     C** UPDATES                                                          CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C427
     C                   Z-ADD     0             UIALC                                         CIR00
     C                   ADD       WKINT         UAITC                                         CIR00
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UICBS         ZICALC
     C                   Z-ADD     UIACD         ZIBEG
     C                   Z-ADD     UNPCD         ZIEND
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   Z-ADD     FSUPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR002 is switched on, add our unsettled interest and                             CAS005
      ** adjustment to our principal.                                                         CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'L'
     C                   ADD       OUSI          ZIAMT
     C                   ADD       OUSA          ZIAMT
     C                   ENDIF
     C                   EXSR      GLINTC
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   Z-ADD     0             FSUALB
     C                   ADD       WINTST        FSUITB
     C                   ENDIF
     C                   Z-ADD     UNPCD         UIACD                                         CIR00
     C*                                                                   CIR001
     C** GET PRINCIPAL CHANGE AMOUNT AND 'NEXT' PRINCIPAL CHANGE DATE     CIR001
     C*                                                                   CIR001
     C** PRINCIPAL KEY - OURS                                             CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C323
     C                   MOVEA     'RXD'         AKY(1)                                        CIR00
     C/COPY WNCPYSRC,DL0280C324
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '  IOA'       AKY(6)                                        CIR00
     C                   MOVEL     NEV(8)        NARREV                                        CIR00
     C                   MOVE      UFRDKY        FRDKY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   Z-ADD     UNPCD         KYDAT                                         CIR00
     C                   Z-ADD     UNPCD         KYFED                                         CIR00
     C                   TESTB     '0'           UDNSI                31                       CIR00
     C*                                                                   CIR001
     C** SUPPRESS PRINT OF ZERO BASE RATE                                 CIR001
     C*                                                                   CIR001
     C     NRBRTT        IFEQ      '00'                                                        CIR00
     C                   MOVE      '  '          NRBRTT                                        CIR00
     C                   SETOFF                                       31                       CIR00
     C                   END                                                                   CIR00
     C                   MOVE      'U'           PORTH                                         CIR00
     C                   EXSR      #LPRCH                                                      CIR00
     C*                                                                   CIR001
     C** Compute the difference between the new principal amount          CIR001
     C** and the old principal amount.  If the result is negative,        CIR001
     C** then it is a principal DECREASE. Else, if positive, then         CIR001
     C** its a principal INCREASE.                                        CIR001
     C*                                                                   CIR001
     C                   Z-ADD     0             WPDIF                                         CIR00
     C                   MOVE      ' '           WPIOD                                         CIR00
     C     WPAMT         IFNE      0                                                           CIR00
     C/COPY WNCPYSRC,DL0280C325
     C     WPAMT         SUB       UPAMT         WPDIF                                         CIR00
     C     WPDIF         IFLT      0                                                           CIR00
     C                   MOVE      'D'           WPIOD                                         CIR00
     C                   Z-SUB     WPDIF         WPDIF                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'I'           WPIOD                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C326
     C                   Z-ADD     WPAMT         NRRPUR                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C327
     C                   Z-ADD     WPDIF         KYAMT                                         CIR00
     C/COPY WNCPYSRC,DL0280C328
     C*                                                                   CIR001
     C     WPIOD         IFEQ      'D'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C329
     C                   MOVE      'M'           AKY(3)                                        CIR00
     C/COPY WNCPYSRC,DL0280C330
     C                   MOVE      'D'           AKY(8)                                        14578
     C                   MOVEL     NEV(9)        NARREV                                        CIR00
     C/COPY WNCPYSRC,DL0280C331
     C                   END                                                                   CIR00
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     PDEI          ANDEQ     'Y'                                                         CIR00
     C     UCUCY         IFEQ      BJCYCD                                                      CIR00
     C**********         MOVE      'B'           AKY(8)                               CIR003 BUG7045
     C                   MOVE      'B'           AKY(7)                                      BUG7045
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C     WPIOD         IFEQ      'I'                                                         CIR00
     C                   MOVE      'VAL'         KEDCD                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'MAT'         KEDCD                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   MOVE      *IN87         WIN87                                         CIR00
     C     WDLKEY        CHAIN     DLGXSTL0                           87                       CIR00
      *                                                                   CIR003
     C     *IN87         IFEQ      '1'                                                         CIR00
     C                   MOVEL     DLNO          WKEY                                          CIR00
     C                   MOVE      KEDCD         WKEY                                          CIR00
     C                   MOVEL     'DLGXSTL0'    DBFILE                          ************  CIR00
     C                   MOVEL     '35'          DBASE                           *DBERROR 35*  CIR00
     C                   MOVEL     WKEY          DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C     KEDCD         IFEQ      'VAL'                                                       CIR00
     C                   Z-ADD     RXRSTM        KYSETL                                        CIR00
     C                   MOVEL     RXRONS        KYOSTL                                        CIR00
     C                   MOVEL     RXROBR        KYSTBR                                        CIR00
     C                   MOVEL     RXRSCY        KYSCY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'RX'          STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     RXPSTM        KYSETL                                        CIR00
     C                   MOVEL     RXPONS        KYOSTL                                        CIR00
     C                   MOVEL     RXPOBR        KYSTBR                                        CIR00
     C                   MOVEL     RXPSCY        KYSCY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'RX'          STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C     UDECP         COMP      1                                    4344                   CIR00
     C     UDECP         COMP      2                                  46  45                   CIR00
     C                   SETON                                        71                       CIR00
     C                   EXSR      EXCP                                                        CIR00
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     PDEI          ANDEQ     'Y'                                                         CIR00
     C                   MOVE      *BLANKS       AKY(7)                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                                      BUG7045
     C     CIR003        IFEQ      'Y'                                                       BUG7045
     C     PDEI          ANDEQ     'Y'                                                       BUG7045
     C     UCUCY         ANDEQ     BJCYCD                                                    BUG7045
     C                   MOVE      ' '           AKY(8)                                      BUG7045
     C                   ENDIF                                                               BUG7045
      *                                                                                      BUG7045
     C*                                                                   CIR001
     C** EXPOSURE KEY - OURS                                              CIR001
     C** OUR EXPOSURE AMOUNT CALCULATED BETWEEN PRINCIPAL CHANGE AND      CIR001
     C** MATURITY                                                         CIR001
     C*                                                                   CIR001
     C                   MOVE      DTYP          RRDT                                          CIR00
     C/COPY WNCPYSRC,DL0280C332
     C                   Z-ADD     KYAMT         RRPA                                          CIR00
     C/COPY WNCPYSRC,DL0280C333
     C                   Z-ADD     KYDAT         RRSD                                          CIR00
     C                   Z-ADD     MDAT          RRED                                          CIR00
     C                   EXSR      DLRREX                                                      CIR00
     C                   Z-ADD     RREA          KYAMT                                         CIR00
     C/COPY WNCPYSRC,DL0280C334
     C     WPIOD         IFEQ      'D'                                                         CIR00
     C                   SUB       RREA          UAEXA                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   ADD       RREA          UAEXA                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C335
     C                   MOVE      'E'           AKY(10)                                       CIR00
     C                   EXSR      EXCP                                                        CIR00
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     PDEI          ANDEQ     'Y'                                                         CIR00
     C                   MOVEA     UCUCY         AKY(6)                                        CIR00
     C                   MOVE      'A'           AKY(10)                                     BUG7045
     C     WPIOD         IFEQ      'I'                                                         CIR00
     C                   MOVE      'V'           AKY(3)                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'M'           AKY(3)                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVEL     BJCYCD        KYCCY                                         CIR00
     C                   Z-ADD     0             KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
      *                                                                   CIR003
     C     UCUCY         IFEQ      BJCYCD                                                      CIR00
     C**********         Z-ADD     UPAMT         KYAMT                                CIR003 BUG7045
     C                   Z-ADD     WPDIF         KYAMT                                       BUG7045
     C                   ELSE                                                                  CIR00
     C                   MOVE      *IN87         WIN87             1                           CIR00
     C                   Z-ADD     1             I                                             CIR00
     C     UCUCY         LOOKUP    CY(I)                                  87                   CIR00
     C     *IN87         IFEQ      '0'                                                         CIR00
     C                   MOVEL     'TABTG30 '    DBFILE                          ************  CIR00
     C                   MOVEL     '35'          DBASE                           *DBERROR 35*  CIR00
     C                   MOVEL     UCUCY         DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     CYD(I)        CYDDS                                         CIR00
     C                   Z-ADD     WPDIF         ZAMTCI                                        CIR00
     C                   Z-ADD     UBCXR         ZEXCH                                         CIR00
     C                   Z-ADD     UDECP         ZCDPI                                         CIR00
     C                   Z-ADD     BCDP          ZCDPO                                         CIR00
      *                                                                   CIR003
     C     MDIN          IFEQ      1                                                           CIR00
     C                   MOVE      'M'           ZMD
     C                   ELSE                                                                  CIR00
     C                   MOVE      'D'           ZMD
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      ZCONV                                                       CIR00
     C                   Z-ADD     ZAMTCO        KYAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      EXCP                                                        CIR00
     C                   MOVE      *BLANKS       AKY(6)                                        CIR00
     C                   MOVE      *BLANKS       AKY(7)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C336
     C     WPDIF         IFNE      0                                                           CIR00
     C/COPY WNCPYSRC,DL0280C337
     C     WPAMT         SUB       UPAMT         WDIFF                                         CIR00
     C                   Z-ADD     WPAMT         UPAMT                                         CIR00
     C/COPY WNCPYSRC,DL0280C338
     C*                                                                   CIR001
     C** UPDATE 'VALUE OF CAPITALIZATIONS' FOR AUDIT CONTROL              CIR001
     C*                                                                   CIR001
     C     WDIFF         DIV       1000          ZZAMT                                         CIR00
     C                   Z-ADD     NETCII        ZZTOTI                                        CIR00
     C                   Z-ADD     NETCID        ZZTOTD                                        CIR00
     C                   EXSR      GLZADD                                                      CIR00
     C                   Z-ADD     ZZTOTI        NETCII                                        CIR00
     C                   Z-ADD     ZZTOTD        NETCID                                        CIR00
     C                   END                                                                   CIR00
     C                   MOVE      ' '           AKY(8)                                        14578
     C                   END                                                                   CIR00
      *                                                                                       235079
     C     *INU1         IFNE      '1'                                                        235079
     C     WNIPDT        CABLE     EVCD          RXSHD1                                       235079
     C     WNIPDU        CABLE     EVCD          RXSHD2                                       235079
      *                                                                                       235079
      ** If no interest payments are due, go to tag RXMDAT to                                 235079
      ** process the buy-out payment                                                          235079
      *                                                                                       235079
     C     CIR001        IFEQ      'Y'                                                        235079
     C                   GOTO      RXMDAT                                                     235079
     C                   ENDIF                                                                235079
      *                                                                                       235079
     C                   GOTO      RXSEND                                                     235079
     C                   ENDIF                                                                235079
     C*                                                                   CIR001
     C** SET DEALS FILE UPDATE INDICATOR                                  CIR001
     C*                                                                   CIR001
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   GOTO      RXDATE                                                      CIR00
     C*                                                                   S01119
     C* THEIR INTEREST PAY DATE                                           S01119
     C*                                                                   S01119
     C     RXPROC        TAG                                                    ** RXPROC TAG**S0111
     C*                                                                   S01119
     C*  IN ORDER TO CONTINUE WITH THEIR NEXT INTEREST DATE IT MUST BE:   S01119
     C*  1) GREATER THAN THEIR START LAST INTEREST PAYMENT DATE           S01119
     C*  2) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  3) LESS THAN OR EQUAL TO OUR NEXT INTEREST PAYMENT DATE          S01119
     C*     AND OUR START/LAST INTEREST PAYMENT DATE                      S01119
     C*  4) LESS THAN OR EQUAL TO THEIR NEXT INTEREST FIX DATE            S01119
     C*     IF THEIR NEXT INTEREST FIX DATE IS NON ZERO                   S01119
     C*  5) LESS THAN OR EQUAL TO OUR NEXT INTEREST FIX DATE              S01119
     C*     IF OUR NEXT INTEREST FIX DATE IS NON ZERO                     S01119
     C*  6) LESS THAN OR EQUAL TO THEIR NEXT INTEREST CHANGE DATE         S01119
     C*     IF THEIR NEXT INTEREST CHANGE DATE IS NON ZERO                S01119
     C*  7) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO OUR INTEREST PAYMENT DATE CHECK                  S01119
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     WNIEDT        IFLE      TSLIP                                                       CIR00
     C                   GOTO      RXUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C                   ELSE                                                                  CIR00
     C     WNIPDT        IFLE      TSLIP                                                       S0111
     C                   GOTO      RXUIPD                                                      S0111
     C                   END                                                                   S0111
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C     WNIPDT        IFGT      EVCD                                                        S0111
     C                   GOTO      RXUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     WNIPDT        IFGT      WNIPDU                                                      CIR00
     C     WNIEDU        ANDGT     USLIP                                                       CIR00
     C                   GOTO      RXUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WNIEDT        IFGT      TINFD                                                       CIR00
     C     TINFD         ANDLE     EVCD                                                        CIR00
     C     TINFD         ANDGT     0                                                           CIR00
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WNIEDT        IFGT      UINFD                                                       CIR00
     C     UINFD         ANDLE     EVCD                                                        CIR00
     C     UINFD         ANDGT     0                                                           CIR00
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WNIEDT        IFGT      TNICD                                                       CIR00
     C     TNICD         ANDLE     EVCD                                                        CIR00
     C     TNICD         ANDGT     0                                                           CIR00
     C                   GOTO      RXUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WNIEDT        IFGT      UNICD                                                       CIR00
     C     UNICD         ANDLE     EVCD                                                        CIR00
     C     UNICD         ANDGT     0                                                           CIR00
     C                   GOTO      RXUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C     WNIPDT        IFGT      WNIPDU                                                      S0111
     C     WNIPDU        ANDGT     USLIP                                                       S0111
     C                   GOTO      RXUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPDT        IFGT      TINFD                                                       S0111
     C     TINFD         ANDGT     0                                                           S0111
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPDT        IFGT      UINFD                                                       S0111
     C     UINFD         ANDGT     0                                                           S0111
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPDT        IFGT      TNICD                                                       S0111
     C     TNICD         ANDGT     0                                                           S0111
     C                   GOTO      RXUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPDT        IFGT      UNICD                                                       S0111
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RXUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C*                                                                   CIR001
     C** IF THEIR SIDE DONE ALREADY, THEN BYPASS                          CIR001
     C*                                                                   CIR001
     C     THR           IFNE      *BLANK                                                      CIR00
     C     CIR001        ANDEQ     'Y'                                                         CIR00
     C                   GOTO      RXUIPD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     RXSHD1        TAG                                                    ** RXSHD1 TAG**S0111
     C/COPY WNCPYSRC,DL0280C339
     C                   MOVEA     'RXI'         AKY(1)                                        S0111
     C/COPY WNCPYSRC,DL0280C340
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    I'       AKY(6)                                        S0111
     C                   MOVE      'R'           AKY(9)                                        S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
     C                   Z-ADD     WNIPDT        KYDAT                                         S0111
     C                   Z-ADD     WNIPDT        KYFED                                         S0111
      *                                                                   S01119
      * DLRSIN                                                            S01119
      *                                                                   S01119
      *        (THEIRS)                                                   S01119
     C                   EVAL      W_PRVI = 'T'                                               CIR014
     C                   Z-ADD     TIACD         SZIACD            5 0                         S0111
     C                   Z-ADD     WNIPDT        SZEDAT            5 0                         S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     WNIEDT        SZEDAT            5 0                         CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     TEINR         SZINR            11 7                         S0111
     C                   Z-ADD     TPAMT         SZPPL            13 0                         S0111
     C                   MOVE      TCUCY         SZCCY             3                           S0111
     C                   MOVE      RSCY          SZECY             3                           CEU00
     C                   MOVE      PSCY          X2ECY             3                           CEU00
     C                   Z-ADD     BNHKTR        SZITR            11 7                         S0119
     C                   Z-ADD     TAIPD         SZIPTD           13 0                         S0111
     C                   Z-ADD     TAIAP         SZAIAP           13 0                         S0111
     C                   Z-ADD     TAIAN         SZIANP           13 0                         S0111
     C                   Z-ADD     TAITC         SZAICD           13 0                         S0111
     C                   Z-ADD     TIPRM         SZIPRM           13 0                         S0111
     C                   Z-ADD     TIPRD         SZIPRD           13 0                         S0111
     C                   Z-ADD     TTAXD         SZTPTD           13 0                         S0111
     C                   Z-ADD     TTAXM         SZTPTM           13 0                         S0111
     C                   Z-ADD     TICBS         SZCBS             1 0                         S0111
     C                   MOVE      'I'           SZETYP            1                           S0111
     C                   MOVE      TIPFR         SZIPFC            1                           S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   MOVE      TINPM         SZINPM                                        CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     TIPFD         SZIPD             2 0                         S0111
     C                   Z-ADD     MDAT          SZMDAT            5 0                         S0111
     C                   Z-ADD     TIPBD         SZIPBD            5 0                         S0111
     C                   MOVE      'N'           SZRLPI            1                           S0111
     C                   Z-ADD     TIALC         SZLICD           13 0                         S0111
     C                   Z-ADD     TLPCD         SZSLID            5 0                         S0111
     C                   MOVE      CNFI          SZCNFI            1                           S0111
     C                   MOVE      TLXI          SZTLXI            1                           S0111
     C                   MOVE      AKY(9)        SZDIR                                         S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TIACD         TZIACD
     C                   Z-ADD     WNIPDT        TZEDAT
     C     CIR001        IFEQ      'Y'
     C                   Z-ADD     WNIEDT        TZEDAT
     C                   ENDIF
     C                   Z-ADD     FSTPAM        TZPPL
     C                   MOVE      TCUCY         TZCCY
     C                   MOVE      RSCY          TZECY
     C                   MOVE      PSCY          T2ECY             3
     C                   Z-ADD     TTAXD         TZTPTD
     C                   Z-ADD     TTAXM         TZTPTM
     C                   Z-ADD     TICBS         TZCBS
     C                   MOVE      'I'           TZETYP
     C                   MOVE      TIPFR         TZIPFC
     C                   Z-ADD     TIPFD         TZIPD
     C                   Z-ADD     MDAT          TZMDAT
     C                   Z-ADD     TIPBD         TZIPBD
     C                   MOVE      'N'           TZRLPI
     C                   Z-ADD     FSTIPB        TZIPTD
     C                   Z-ADD     FSTIAB        TZAIAP
     C                   Z-ADD     FSTINB        TZIANP
     C                   Z-ADD     FSTITB        TZAICD
     C                   Z-ADD     FSTPMB        TZIPRM
     C                   Z-ADD     FSTPRB        TZIPRD
     C                   Z-ADD     FSTALB        TZLICD
     C                   ENDIF
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
     C*                                                                   044994
     C** Set up Our details into alternative fields for use in            044994
     C** determining the matching payment dates                           044994
     C*                                                                   044994
     C                   Z-ADD     UIPBD         X2IPBD                                        04499
     C                   MOVEL     UIPFR         X2IPFC                                        04499
     C                   Z-ADD     UIPFD         X2IPD                                         04499
     C                   MOVEL     UCUCY         X2CCY                                         04499
     C                   MOVE      'P'           X2DIR                                         CIR00
      *                                                                   E21662
      ** Find out how many decimal places for their currency (Interest)   E21662
     C                   MOVEA     '0000'        *IN(43)                                       E2166
     C     TDECP         COMP      1                                    4344                   E2166
     C  N43
     CANN44TDECP         COMP      3                                    4546                   E2166
     C*                                                                   CIR002
     C** If their interest is NOT up-front, add Their Unsettled Interest  CIR002
     C** Amount (TUSI) and Their Unsettled Interest Adjustment (TUSA)     CIR002
     C** to amount parameter (SZPPL)                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     TINPM         ANDNE     'D'                                                         CIR00
     C     TINPM         ANDNE     'Y'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          SZPPL                                         CIR00
     C                   ADD       TUSA          SZPPL                                         CIR00
     C     CAS005        IFEQ      'Y'
     C                   ADD       TUSI          TZPPL
     C                   ADD       TUSA          TZPPL
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
      *                                                                   CSW097
      ** Set up Receipt - Settlement Method and Nostro parameter          CSW097
     C                   Z-ADD     RSTM          SZSETM            2 0                         CSW09
     C                   MOVE      RONS          SZNOST            2                           CSW09
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     RSTM          TZSETM
     C                   MOVE      RONS          TZNOST
     C                   ENDIF
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'D'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'Y'                                                         CIR00
     C                   EXSR      #LRSIU                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSIU
     C                   ENDIF
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C250
     C                   EXSR      DLRSIN                                                      S0111
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSIN
     C                   ENDIF
     C                   END                                                                   CIR00
      *        (RESULT)                                                   S01119
     C/COPY WNCPYSRC,DL0280C395
     C                   Z-ADD     SZAICD        TAITC                                         S0111
     C                   Z-ADD     SZIPTD        TAIPD                                         S0111
     C                   Z-ADD     SZAIAP        TAIAP                                         S0111
     C                   Z-ADD     SZIANP        TAIAN                                         S0111
     C                   Z-ADD     SZIPRM        TIPRM                                         S0111
     C                   Z-ADD     SZIPRD        TIPRD                                         S0111
     C                   Z-ADD     SZTPTD        TTAXD                                         S0111
     C                   Z-ADD     SZTPTM        TTAXM                                         S0111
     C                   MOVE      SZIPFC        TIPFR                                         S0111
     C                   Z-ADD     SZIPD         TIPFD                                         S0111
     C                   Z-ADD     SZLICD        TIALC                                         S0111
     C     TBRTT         IFNE      0                                                           S0111
     C                   Z-ADD     SZSLID        TLPCD                                         S0111
     C                   END                                                                   S0111
     C                   MOVE      SZCNFI        CNFI                                          S0111
     C                   MOVE      SZTLXI        TLXI                                          S0111
     C                   Z-ADD     SZINOT        WINOTT           13 0                         S0111
     C                   Z-ADD     SZSLID        TSLIP                                         S0111
     C                   Z-ADD     SZIPBD        TIPBD                                         S0111
     C                   Z-ADD     SZIACD        TIACD                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TZAICD        FSTITB
     C                   Z-ADD     TZIPTD        FSTIPB
     C                   Z-ADD     TZAIAP        FSTIAB
     C                   Z-ADD     TZIANP        FSTINB
     C                   Z-ADD     TZIPRM        FSTPMB
     C                   Z-ADD     TZIPRD        FSTPRB
     C                   Z-ADD     TZLICD        FSTALB
     C                   ENDIF
     C* IN ORDER TO ALLOW DATE DEFAULT ABOVE TO TAKE EFFECT ONLY UPDATE   S01119
     C*     NEXT INTEREST PAYMENT DATE IF IT WAS NOT ORIGINALLY ZERO      S01119
     C     TNIPD         IFNE      0                                                           S0111
     C                   Z-ADD     SZNIPD        TNIPD                                         S0111
     C                   END                                                                   S0111
     C                   Z-ADD     0             TAXA                                          S0111
     C*                                                                   CIR001
     C** If interest processing method is not capitalised, set            CIR001
     C** flag THR to "Y", otherwise set flag THR to "N"                   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     SZINPM        IFNE      'C'                                                         CIR00
     C     SZINPM        ANDNE     'K'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDNE     'C'                                                         CIR00
     C     SZINPM        ANDNE     'K'                                                         CIR00
     C     SZINPM        ANDNE     'A'                                                         CIR00
     C     SZINPM        ANDNE     'I'                                                         CIR00
     C                   MOVE      'Y'           THR                                           CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'N'           THR                                           CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C396
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   CIR002
     C** Reset Their Unsettled Interest Amount (TUSI) and                 CIR002
     C** Their Unsettled Interest Amount Adjustment (TUSA)                CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C                   Z-ADD     0             TUSI                                          CIR00
     C                   Z-ADD     0             TUSA                                          CIR00
     C                   END                                                                   CIR00
      *                                                                   186412
     C                   ADD       TAIAP         TAITC                                         18641
     C                   Z-ADD     *ZEROS        TAIAP                                         18641
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   ADD       FSTIAB        FSTITB
     C                   Z-ADD     *ZEROS        FSTIAB
     C                   ENDIF
     C*                                                                   S01119
     C     WNIPDT        CABNE     WNIPDU        RXUNIP                                        S0111
     C*                                                                   S01119
     C*  OUR INTEREST PAY DATE                                            S01119
     C*                                                                   S01119
     C     RXUIPD        TAG                                                    ** RXUIPD TAG**S0111
     C  NU1              MOVE      'Y'           OFX                                         BUG7531
     C  NU1              MOVE      'Y'           TFX                                         BUG7531
     C  NU1              GOTO      RXSHD2                                                      S0111
     C*                                                                   S01119
     C*  IN ORDER TO CONTINUE WITH OUR NEXT INTEREST DATE IT MUST BE:     S01119
     C*  1) GREATER THAN OUR START LAST INTEREST PAYMENT DATE             S01119
     C*  2) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  3) LESS THAN OR EQUAL TO THEIR NEXT INTEREST FIX DATE            S01119
     C*     IF THEIR NEXT INTEREST FIX DATE IS NON ZERO                   S01119
     C*  4) LESS THAN OR EQUAL TO OUR NEXT INTEREST FIX DATE              S01119
     C*     IF OUR NEXT INTEREST FIX DATE IS NON ZERO                     S01119
     C*  5) LESS THAN OR EQUAL TO THEIR NEXT INTEREST CHANGE DATE         S01119
     C*     IF THEIR NEXT INTEREST CHANGE DATE IS NON ZERO                S01119
     C*  6) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO THEIR INTEREST FIX DATE CHECK                    S01119
     C*                                                                   S01119
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     WNIEDU        IFLE      USLIP                                                       CIR00
     C                   GOTO      RXTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C                   ELSE                                                                  CIR00
     C     WNIPDU        IFLE      USLIP                                                       S0111
     C                   GOTO      RXTIFD                                                      S0111
     C                   END                                                                   S0111
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C     WNIPDU        IFGT      EVCD                                                        S0111
     C                   GOTO      RXTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     WNIEDU        IFGT      TINFD                                                       CIR00
     C     TINFD         ANDLE     EVCD                                                        CIR00
     C     TINFD         ANDGT     0                                                           CIR00
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WNIEDU        IFGT      UINFD                                                       CIR00
     C     UINFD         ANDLE     EVCD                                                        CIR00
     C     UINFD         ANDGT     0                                                           CIR00
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WNIEDU        IFGT      TNICD                                                       CIR00
     C     TNICD         ANDLE     EVCD                                                        CIR00
     C     TNICD         ANDGT     0                                                           CIR00
     C                   GOTO      RXTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     WNIEDU        IFGT      UNICD                                                       CIR00
     C     UNICD         ANDLE     EVCD                                                        CIR00
     C     UNICD         ANDGT     0                                                           CIR00
     C                   GOTO      RXTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C     WNIPDU        IFGT      TINFD                                                       S0111
     C     TINFD         ANDGT     0                                                           S0111
     C     TFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPDU        IFGT      UINFD                                                       S0111
     C     UINFD         ANDGT     0                                                           S0111
     C     OFX           ANDEQ     ' '                                                       BUG7531
     C                   GOTO      RXTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPDU        IFGT      TNICD                                                       S0111
     C     TNICD         ANDGT     0                                                           S0111
     C                   GOTO      RXTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPDU        IFGT      UNICD                                                       S0111
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RXTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** IF OUR SIDE DONE ALREADY, THEN BYPASS                            CIR001
     C*                                                                   CIR001
     C     OUR           IFNE      *BLANK                                                      CIR00
     C     CIR001        ANDEQ     'Y'                                                         CIR00
     C                   GOTO      RXTIFD                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C     RXSHD2        TAG                                                    ** RXSHD2 TAG**S0111
     C/COPY WNCPYSRC,DL0280C341
     C                   MOVEA     'RXI'         AKY(1)                                        S0111
     C/COPY WNCPYSRC,DL0280C342
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    I'       AKY(6)                                        S0111
     C                   MOVE      'P'           AKY(9)                                        S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
     C                   Z-ADD     WNIPDU        KYDAT                                         S0111
     C                   Z-ADD     WNIPDU        KYFED                                         S0111
      *                                                                   S01119
      * DLRSIN                                                            S01119
      *                                                                   S01119
      *        (OUR)                                                      S01119
     C                   EVAL      W_PRVI = 'O'                                               CIR014
     C                   Z-ADD     UIACD         SZIACD                                        S0111
     C                   Z-ADD     WNIPDU        SZEDAT                                        S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     WNIEDU        SZEDAT                                        CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     UEINR         SZINR                                         S0111
     C                   Z-ADD     UPAMT         SZPPL                                         S0111
     C                   MOVE      UCUCY         SZCCY                                         S0111
     C                   MOVE      PSCY          SZECY                                         CEU00
     C                   MOVE      RSCY          X2ECY                                         CEU00
     C                   Z-ADD     BNHKTR        SZITR                                         S0119
     C                   Z-ADD     UAIPD         SZIPTD                                        S0111
     C                   Z-ADD     UAIAP         SZAIAP                                        S0111
     C                   Z-ADD     UAIAN         SZIANP                                        S0111
     C                   Z-ADD     UAITC         SZAICD                                        S0111
     C                   Z-ADD     UIPRM         SZIPRM                                        S0111
     C                   Z-ADD     UIPRD         SZIPRD                                        S0111
     C                   Z-ADD     UTAXD         SZTPTD                                        S0111
     C                   Z-ADD     UTAXM         SZTPTM                                        S0111
     C                   Z-ADD     UICBS         SZCBS                                         S0111
     C                   MOVE      'I'           SZETYP                                        S0111
     C                   MOVE      UIPFR         SZIPFC                                        S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   MOVE      UINPM         SZINPM                                        CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     UIPFD         SZIPD                                         S0111
     C                   Z-ADD     MDAT          SZMDAT                                        S0111
     C                   Z-ADD     UIPBD         SZIPBD                                        S0111
     C                   MOVE      'N'           SZRLPI                                        S0111
     C                   Z-ADD     UIALC         SZLICD                                        S0111
     C                   Z-ADD     ULPCD         SZSLID                                        S0111
     C                   MOVE      CNFI          SZCNFI                                        S0111
     C                   MOVE      TLXI          SZTLXI                                        S0111
     C                   MOVE      AKY(9)        SZDIR                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UIACD         TZIACD
     C                   Z-ADD     WNIPDU        TZEDAT
     C     CIR001        IFEQ      'Y'
     C                   Z-ADD     WNIEDU        TZEDAT
     C                   ENDIF
     C                   Z-ADD     FSUPAM        TZPPL
     C                   MOVE      UCUCY         TZCCY
     C                   MOVE      PSCY          TZECY
     C                   MOVE      RSCY          T2ECY
     C                   Z-ADD     BNHKTR        TZITR            11 7
     C                   Z-ADD     FSUIPB        TZIPTD
     C                   Z-ADD     FSUIAB        TZAIAP
     C                   Z-ADD     FSUINB        TZIANP
     C                   Z-ADD     FSUITB        TZAICD
     C                   Z-ADD     FSUPMB        TZIPRM
     C                   Z-ADD     FSUPRB        TZIPRD
     C                   Z-ADD     FSUALB        TZLICD
     C                   Z-ADD     UTAXD         TZTPTD
     C                   Z-ADD     UTAXM         TZTPTM
     C                   Z-ADD     UICBS         TZCBS
     C                   MOVE      'I'           TZETYP
     C                   MOVE      UIPFR         TZIPFC
     C                   Z-ADD     UIPFD         TZIPD
     C                   Z-ADD     MDAT          TZMDAT
     C                   Z-ADD     UIPBD         TZIPBD
     C                   MOVE      'N'           TZRLPI
     C                   Z-ADD     ULPCD         TZSLID
     C                   MOVE      TLXI          TZTLXI            1
     C                   ENDIF
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
     C*                                                                   044994
     C** Set up Their details into alternative fields for use in          044994
     C** determining the matching payment dates                           044994
     C*                                                                   044994
     C                   Z-ADD     TIPBD         X2IPBD                                        04499
     C                   MOVEL     TIPFR         X2IPFC                                        04499
     C                   Z-ADD     TIPFD         X2IPD                                         04499
     C                   MOVEL     TCUCY         X2CCY                                         04499
     C                   MOVE      'R'           X2DIR                                         CIR00
      *                                                                   E21662
      ** Find out how many decimal places for our currency (Interest)     E21662
     C                   MOVEA     '0000'        *IN(43)                                       E2166
     C     UDECP         COMP      1                                    4344                   E2166
     C  N43
     CANN44UDECP         COMP      3                                    4546                   E2166
     C*                                                                   CIR002
     C** If our interest is NOT up-front, add Our Unsettled Interest      CIR002
     C** Amount (OUSI) and Our Unsettled Interest Adjustment (OUSA)       CIR002
     C** to amount parameter (SZPPL)                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UINPM         ANDNE     'D'                                                         CIR00
     C     UINPM         ANDNE     'Y'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          SZPPL                                         CIR00
     C                   ADD       OUSA          SZPPL                                         CIR00
     C     CAS005        IFEQ      'Y'
     C                   ADD       OUSI          TZPPL
     C                   ADD       OUSA          TZPPL
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
      *                                                                   CSW097
      ** Set up Pay - Settlement Method and Nostro parameter              CSW097
     C                   Z-ADD     PSTM          SZSETM                                        CSW09
     C                   MOVE      PONS          SZNOST                                        CSW09
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     PSTM          TZSETM
     C                   MOVE      PONS          TZNOST
     C                   ENDIF
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'D'                                                         CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     SZINPM        ANDEQ     'Y'                                                         CIR00
     C                   EXSR      #LRSIU                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSIU
     C                   ENDIF
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C251
     C                   EXSR      DLRSIN                                                      S0111
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSIN
     C                   ENDIF
     C                   END                                                                   CIR00
      *        (RESULT)                                                   S01119
     C/COPY WNCPYSRC,DL0280C397
     C                   Z-ADD     SZAICD        UAITC                                         S0111
     C                   Z-ADD     SZIPTD        UAIPD                                         S0111
     C                   Z-ADD     SZAIAP        UAIAP                                         S0111
     C                   Z-ADD     SZIANP        UAIAN                                         S0111
     C                   Z-ADD     SZIPRM        UIPRM                                         S0111
     C                   Z-ADD     SZIPRD        UIPRD                                         S0111
     C                   Z-ADD     SZTPTD        UTAXD                                         S0111
     C                   Z-ADD     SZTPTM        UTAXM                                         S0111
     C                   MOVE      SZIPFC        UIPFR                                         S0111
     C                   Z-ADD     SZIPD         UIPFD                                         S0111
     C                   Z-ADD     SZLICD        UIALC                                         S0111
     C     UBRTT         IFNE      0                                                           S0111
     C                   Z-ADD     SZSLID        ULPCD                                         S0111
     C                   END                                                                   S0111
     C                   MOVE      SZCNFI        CNFI                                          S0111
     C                   MOVE      SZTLXI        TLXI                                          S0111
     C                   Z-ADD     SZINOT        WINOTU           13 0                         S0111
     C                   Z-ADD     SZSLID        USLIP                                         S0111
     C                   Z-ADD     SZIPBD        UIPBD                                         S0111
     C                   Z-ADD     SZIACD        UIACD                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TZAICD        FSUITB
     C                   Z-ADD     TZIPTD        FSUIPB
     C                   Z-ADD     TZAIAP        FSUIAB
     C                   Z-ADD     TZIANP        FSUINB
     C                   Z-ADD     TZIPRM        FSUPMB
     C                   Z-ADD     TZIPRD        FSUPRB
     C                   Z-ADD     TZLICD        FSUALB
     C                   ENDIF
     C* IN ORDER TO ALLOW DATE DEFAULT ABOVE TO TAKE EFFECT ONLY UPDATE   S01119
     C*     NEXT INTEREST PAYMENT DATE IF IT WAS NOT ORIGINALLY ZERO      S01119
     C     UNIPD         IFNE      0                                                           S0111
     C                   Z-ADD     SZNIPD        UNIPD                                         S0111
     C                   END                                                                   S0111
     C                   Z-ADD     0             TAXA                                          S0111
     C*                                                                   CIR001
     C** If the interest was paid and not capitalised                     CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     SZINPM        IFNE      'C'                                                         CIR00
     C     SZINPM        ANDNE     'K'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR006        ANDEQ     'Y'                                                         CIR00
     C     SZINPM        ANDNE     'C'                                                         CIR00
     C     SZINPM        ANDNE     'K'                                                         CIR00
     C     SZINPM        ANDNE     'A'                                                         CIR00
     C     SZINPM        ANDNE     'I'                                                         CIR00
     C                   MOVE      'Y'           OUR                                           CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVE      'N'           OUR                                           CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C398
     C*                                                                   CIR001
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C** Reset Our Unsettled Interest Amount (OUSI) and                   CIR002
     C** Our Unsettled Interest Amount Adjustment (OUSA)                  CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C                   Z-ADD     0             OUSI                                          CIR00
     C                   Z-ADD     0             OUSA                                          CIR00
     C                   END                                                                   CIR00
      *                                                                   186412
     C                   ADD       UAIAP         UAITC                                         18641
     C                   Z-ADD     *ZEROS        UAIAP                                         18641
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   ADD       FSUIAB        FSUITB
     C                   Z-ADD     *ZEROS        FSUIAB
     C                   ENDIF
     C*                                                                   S01119
     C*  AS INTEREST PAYMENT DATE HAS BEEN PROCESSED SKIP TO UPDATE       S01119
     C*  THIS PREVENTS DATES BEING PROCESSED OUT OF ORDER IF              S01119
     C*  PROCESSING CONTINUES.E.G. IF PAYMENTS QUARTERLY AND CHANGES      S01119
     C*  MONTHLY EACH PAYMENT SHOULD BE FOLLOWED BY 3 CHANGES             S01119
     C                   GOTO      RXUNIP                                                      S0111
     C*                                                                   S01119
     C*  THEIR INTEREST FIX DATE                                          S01119
     C*                                                                   S01119
     C*  IN ORDER TO CONTINUE WITH THEIR INTEREST FIX DATE IT MUST BE:    S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*  3) LESS THAN OR EQUAL TO OUR NEXT INTEREST FIX DATE              S01119
     C*     IF OUR NEXT INTEREST FIX DATE IS NON ZERO                     S01119
     C*  4) LESS THAN OR EQUAL TO THEIR NEXT INTEREST CHANGE DATE         S01119
     C*     IF THEIR NEXT INTEREST CHANGE DATE IS NON ZERO                S01119
     C*  5) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*  6) RELATING TO A NON-ZERO BASE RATE                              S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO OUR INTEREST FIX DATE CHECK                      S01119
     C     RXTIFD        TAG                                                    ** RXTIFD TAG**S0111
      *                                                                                      BUG7531
     C     TFX           IFNE      *BLANK                                                    BUG7531
     C                   GOTO      RXUIFD                                                    BUG7531
     C                   ENDIF                                                               BUG7531
     C*                                                                   S01119
     C     TINFD         IFGT      EVCD                                                        S0111
     C                   GOTO      RXUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TINFD         IFEQ      0                                                           S0111
     C                   GOTO      RXUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TINFD         IFGT      UINFD                                                       S0111
     C     UINFD         ANDGT     0                                                           S0111
     C                   GOTO      RXUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TINFD         IFGT      TNICD                                                       S0111
     C     TNICD         ANDGT     0                                                           S0111
     C                   GOTO      RXUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TINFD         IFGT      UNICD                                                       S0111
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RXUIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TBRTT         IFEQ      0                                                           S0111
     C                   GOTO      RXUIFD                                                      S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C501
     C*                                                                   S01119
     C* PROCESS DAMSX RECORD FOR THEIRS                                   S01119
     C*                                                                   S01119
     C                   MOVE      'T'           DTLUT             1                           S0111
      *                                                                   CSW005
      ** If CSW005 is switched off OR                                     CSW005
      **    CSW005 is switched on  AND                                    CSW005
      **    Their Rate Fixing Indicator is BLANK                          CSW005
      **    OR Their Rate Fixing Indicator is 'A'                                             227642
      *                                                                   CSW005
     C     CSW005        IFEQ      'N'                                                         CSW00
     C     CSW011        ANDEQ     'N'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                         CSW00
     C     TRFIN         ANDEQ     ' '                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     TRFIN         ANDEQ     ' '                                                         CSW01
     C     CSW005        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'A'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'A'                                                        227642
     C*                                                                   S01119
     C     DASNDM        IFEQ      2                                                           S0111
     C*                                                                   S01119
     C*  ACCESS AMENDMENT RECORD FOR DEAL IF NOT RECORD ALREADY FOUND     S01119
     C*                                                                   S01119
2424 C                   READ      DAMSX                                  31                   BHF64
     C*                                                                   CIR001
     C** IF SEQUENCE NUMBER IS '999', => TRAILER, HENCE IGNORE            CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     DASNDM        ANDEQ     999                                                         CIR00
     C                   GOTO      RXSEND                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* DATABASE ERROR IF NO RECORD FOUND                                 S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     DLNO          ORNE      DLNODM                                                      S0111
     C     TBRTT         ORNE      BRTTDM                                                      S0111
     C     TCUCY         ORNE      CCY                                                         S0111
     C**********         SETON                                        U7U8LR          S0111 AR547995
     C                   SETON                                        U5U7LR                AR547995
     C**********         EXCEPT    ERROR                                              S0111 AR547995
     C                   GOTO      EOJ                                                      AR547995
     C                   ELSE                                                                  S0111
0728 C     TOTDMD        ADD       1             TOTDMD            5 0                         S0111
0729 C     TOTDMS        ADD       1             TOTDMS                                        S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C   LR              GOTO      RXSEND                                                      S0111
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C                   EXSR      IRSAMD                                                      S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C                   MOVE      'Y'           TFX                                         BUG7531
      *                                                                                      BUG7531
     C*  AS INTEREST FIX DATE HAS BEEN PROCESSED SKIP TO UPDATE           S01119
     C*  THIS PREVENTS DATES BEING PROCESSED OUT OF ORDER                 S01119
     C                   GOTO      RXUNIP                                                      S0111
     C*                                                                   S01119
     C*  OUR INTEREST FIX DATE                                            S01119
     C*                                                                   S01119
     C     RXUIFD        TAG                                                    ** RXUIFD TAG**S0111
     C*                                                                   S01119
     C*  IN ORDER TO CONTINUE WITH OUR INTEREST FIX DATE IT MUST BE:      S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*  3) LESS THAN OR EQUAL TO THEIR NEXT INTEREST CHANGE DATE         S01119
     C*     IF THEIR NEXT INTEREST CHANGE DATE IS NON ZERO                S01119
     C*  4) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*  5) RELATING TO A NON-ZERO BASE RATE                              S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO THEIR INTEREST CHANGE DATE CHECK                 S01119
      *                                                                                      BUG7531
     C     OFX           IFNE      *BLANK                                                    BUG7531
     C                   GOTO      RXTICD                                                    BUG7531
     C                   ENDIF                                                               BUG7531
     C*                                                                   S01119
     C     UINFD         IFGT      EVCD                                                        S0111
     C                   GOTO      RXTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     UINFD         IFEQ      0                                                           S0111
     C                   GOTO      RXTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     UINFD         IFGT      TNICD                                                       S0111
     C     TNICD         ANDGT     0                                                           S0111
     C                   GOTO      RXTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     UINFD         IFGT      UNICD                                                       S0111
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RXTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     UBRTT         IFEQ      0                                                           S0111
     C                   GOTO      RXTICD                                                      S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C502
     C*                                                                   S01119
     C*  PROCESS DAMSX RECORD FOR OURS                                    S01119
     C*                                                                   S01119
     C                   MOVE      'U'           DTLUT             1                           S0111
      *                                                                   CSW005
      ** If CSW005 is switched off OR                                     CSW005
      **    CSW005 is switched on  AND                                    CSW005
      **    Our Rate Fixing Indicator is BLANK                            CSW005
      **    OR OUr Rate Fixing Indicator is 'A'                                               227642
      *                                                                   CSW005
     C     CSW005        IFEQ      'N'                                                         CSW00
     C     CSW011        ANDEQ     'N'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                         CSW00
     C     URFIN         ANDEQ     ' '                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     URFIN         ANDEQ     ' '                                                         CSW01
     C     CSW005        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'A'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'A'                                                        227642
     C     DASNDM        IFEQ      1                                                           S0111
     C*                                                                   S01119
     C*  ACCESS AMENDMENT RECORD FOR DEAL IF NOT RECORD ALREADY FOUND     S01119
     C*                                                                   S01119
     C                   READ      DAMSX                                  31                   BHF64
     C*                                                                   CIR001
     C** IF SEQUENCE NUMBER IS '999', => TRAILER, HENCE IGNORE            CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     DASNDM        ANDEQ     999                                                         CIR00
     C                   GOTO      RXSEND                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* DATABASE ERROR IF NO RECORD FOUND                                 S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     DLNO          ORNE      DLNODM                                                      S0111
     C     UBRTT         ORNE      BRTTDM                                                      S0111
     C     UCUCY         ORNE      CCY                                                         S0111
     C**********         SETON                                        U7U8LR          S0111 AR547995
     C                   SETON                                        U5U7LR                AR547995
     C**********         EXCEPT    ERROR                                              S0111 AR547995
     C                   GOTO      EOJ                                                      AR547995
     C                   ELSE                                                                  S0111
0728 C     TOTDMD        ADD       1             TOTDMD            5 0                         S0111
0729 C     TOTDMS        ADD       1             TOTDMS                                        S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C   LR              GOTO      RXSEND                                                      S0111
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C                   EXSR      IRSAMD                                                      S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C                   MOVE      'Y'           OFX                                         BUG7531
      *                                                                                      BUG7531
     C*  AS INTEREST FIX DATE HAS BEEN PROCESSED SKIP TO UPDATE           S01119
     C*  THIS PREVENTS DATES BEING PROCESSED OUT OF ORDER                 S01119
     C                   GOTO      RXUNIP                                                      S0111
     C*                                                                   S01119
     C*  THEIR INTEREST CHANGE DATE                                       S01119
     C*                                                                   S01119
     C     RXTICD        TAG                                                    ** RXTICD TAG**S0111
     C*  IN ORDER TO CONTINUE WITH THEIR INTEREST CHANGE DATE IT MUST BE: S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*  3) LESS THAN OR EQUAL TO OUR NEXT INTEREST CHANGE DATE           S01119
     C*     IF OUR NEXT INTEREST CHANGE DATE IS NON ZERO                  S01119
     C*  4) RELATING TO A NON-ZERO BASE RATE                              S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO OUR INTEREST CHANGE DATE CHECK                   S01119
     C*                                                                   S01119
     C     TNICD         IFGT      EVCD                                                        S0111
     C                   GOTO      RXUICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TNICD         IFGT      UNICD                                                       S0111
     C     UNICD         ANDGT     0                                                           S0111
     C                   GOTO      RXUICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TNICD         IFEQ      0                                                           S0111
     C                   GOTO      RXUICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     TBRTT         IFEQ      0                                                           S0111
     C/COPY WNCPYSRC,DL0280C405
     C                   GOTO      RXUICD                                                      S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C510
      *                                                                   CSW005
      ** If CSW005 is switched on                                         CSW005
      **    Set Their Rate Fixing Indicator to BLANK                      CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C                   MOVE      *BLANK        TRFIN                                         CSW00
     C                   BITOFF    '5'           CNFI                                          CSW00
     C                   ENDIF                                                                 CSW00
     C*                                                                   S01119
     C* CALCULATE INTEREST TO BRING ACCRUAL FIGURES UP TO DATE            S01119
     C*                                                                   S01119
     C** If their interest is Up-Front, set the interest calculated       CIR001
     C** to 0 and do not execute SR/GLINTC                                CIR001
     C*                                                                   CIR001
     C                   Z-ADD     *ZERO         WKINT                                         CIR00
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     TINPM         ANDNE     'D'                                                         CIR00
     C     TINPM         ANDNE     'Y'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C                   Z-ADD     TEINR         ZIRATE                                        S0111
     C                   Z-ADD     TPAMT         ZIAMT                                         S0111
     C                   Z-ADD     TICBS         ZICALC                                        S0111
     C                   Z-ADD     TIACD         ZIBEG                                         S0111
     C                   Z-ADD     TNICD         ZIEND                                         S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add their unsettled interest and    t  CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280CP46                                           S01408
     C                   EXSR      GLINTC                                                      S0111
     C/COPY WNCPYSRC,DL0280CP47                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add the interest calculated to      t  CIR002
     C**   their unsettled interest.                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         TUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*  HAVING UPDATED BASE RATE DURING RATE FIX PROCESSING APPLY        S01119
     C*  SPREAD IN LINE WITH INDICATOR : ADD,SUB AND ADD PERCENTAGE       S01119
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TBRTE         FSTEFR
     C                   ENDIF
      *                                                                                       CAS005
     C     TSPIN         IFEQ      'A'                                                         S0111
     C     TBRTE         ADD       TRTSP         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     TBRTE         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      'S'                                                         S0111
     C     TBRTE         SUB       TRTSP         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      'P'                                                         S0111
     C     TBRTE         DIV       100           EINR                                          S0111
     C     EINR          MULT(H)   TRTSP         TEINR                                         S0111
     C                   ADD       TBRTE         TEINR                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C****** UPDATES                                                      S01119
     C*                                                                   S01119
     C                   Z-ADD     0             TIALC                                         S0111
     C                   ADD       WKINT         TAITC                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     *ZERO         WINTST
     C                   Z-ADD     TICBS         ZICALC
     C                   Z-ADD     TIACD         ZIBEG
     C                   Z-ADD     TNICD         ZIEND
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   Z-ADD     FSTPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR002 is switched on, add their unsettled interest and                           CAS005
      ** adjustment to their principal.                                                       CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     TINPM         ANDEQ     'L'
     C                   ADD       TUSI          ZIAMT
     C                   ADD       TUSA          ZIAMT
     C                   ENDIF
     C                   EXSR      SRDLIN
     C                   Z-ADD     0             FSTALB
     C                   ADD       WINTST        FSTITB
     C                   ENDIF
     C                   Z-ADD     TNICD         TIACD                                         S0111
     C                   Z-ADD     TNICD         TLPCD                                         S0111
      *                                                                   CPL002
      ** If Midas-Plato Module is ON and this is a floating leg,          CPL002
      ** then maintain Their Last Rate Change Date field (PLTLRC)         CPL002
      *                                                                   CPL002
     C     BGN2ST        IFEQ      'Y'                                                         CPL00
     C     TBRTT         ANDNE     0                                                           CPL00
     C                   Z-ADD     TNICD         PLTLRC                                        CPL00
     C                   ENDIF                                                                 CPL00
      *                                                                   CPL002
     C**  UPDATE DATES IF FREQUENCY NON BLANK                             S01119
     C     TICFR         IFNE      ' '                                                         S0111
     C                   MOVE      TICFR         ZFREQ                                         S0111
     C                   Z-ADD     TICBD         ZDAYNO                                        S0111
     C                   Z-ADD     TICFD         ZMDAY                                         S0111
     C                   MOVE      TCUCY         ZCCY                                          S0111
     C                   MOVE      BJSLCD        ZLOC                                          S0119
     C*                                                                   CIR001
     C** If CIR001 is on and Their Interest Frequency is Not 'Z',         CIR001
     C** perform processing as at present using SR/ZFREQC, otherwise      CIR001
     C** use #LDNDT.                                                      CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     ZFREQ         ANDNE     'Z'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     CIR005        IFEQ      'N'                                                         CIR00
     C     L2CYP1        OREQ      *BLANKS                                                     CIR00
     C                   EXSR      ZFREQC                                                      S0111
     C                   Z-ADD     0             ZNRDYS                                        S0119
     C                   MOVE      BJSLCD        ZLOC                                          S0119
     C                   EXSR      ZFWDT                                                       S0119
      *                                                                   CIR005
     C                   ELSE                                                                  CIR00
     C                   EXSR      ZFRQB3                                                      CIR00
      *                                                                   CIR005
     C                   CALL      'DLZIRP'                                                    CIR00
     C                   PARM                    ZDAYNO                                        CIR00
     C                   PARM      CCYPY2        PCURR                                         CIR00
     C                   PARM      L2PDCN        PPDCN                                         CIR00
     C                   PARM                    ZLOC                                          CIR00
     C                   PARM                    BJDFIN                                        CIR00
     C                   PARM      *ZEROS        PAJDT                                         CIR00
     C                   PARM      *ZEROS        PBSDT                                         CIR00
     C                   Z-ADD     PAJDT         ZDYNBR                                        CIR00
     C                   Z-ADD     PBSDT         ZDAYNO                                        CIR00
      *                                                                   CIR005
      ** Do not return adjusted date if it is equal to or earlier than    CIR005
      ** previous date (only happens for 'previous' date calculations);   CIR005
      ** instead use the base date                                        CIR005
      *                                                                   CIR005
     C     TICBD         IFGE      ZDYNBR                                                      CIR00
     C                   Z-ADD     PBSDT         ZDYNBR                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C** IF FREQUENCY IS 'Z' DETEMINE NEXT DATE FROM DATE SCHEDULE FILE   CIR001
     C*                                                                   CIR001
     C                   MOVEL     'T'           OTIN                           * THEIRS       CIR00
     C                   MOVEL     'R'           RCIP                           * RATE CHANGE  CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        ZDYNBR                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     ZDYNBR        IFLT      MDAT                                                        S0111
     C                   Z-ADD     ZDAYNO        TICBD                                         S0111
     C                   Z-ADD     ZDYNBR        TNICD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             TICBD                                         S0111
     C                   Z-ADD     0             TNICD                                         S0111
     C                   MOVE      ' '           TICFR                                         S0111
     C                   Z-ADD     0             TICFD                                         S0111
     C                   Z-ADD     0             TINFD                                         18281
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             TICBD                                         S0111
     C                   Z-ADD     0             TNICD                                         S0111
     C                   Z-ADD     0             TINFD                                         18281
     C                   END                                                                   S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C*  AS INTEREST CHANGE DATE HAS BEEN PROCESSED SKIP TO UPDATE        S01119
     C*  THIS PREVENTS DATES BEING PROCESSED OUT OF ORDER                 S01119
     C                   GOTO      RXUNIP                                                      S0111
     C*                                                                   S01119
     C* OUR INTEREST CHANGE DATE                                          S01119
     C*                                                                   S01119
     C     RXUICD        TAG                                                    ** RXUICD TAG**S0111
     C*  IN ORDER TO CONTINUE WITH OUR   INTEREST CHANGE DATE IT MUST BE: S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*  3) RELATING TO A NON-ZERO BASE RATE                              S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO RS UPDATE SECTION                                S01119
     C*                                                                   S01119
     C     UNICD         IFGT      EVCD                                                        S0111
     C                   GOTO      RXUNIP                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     UNICD         IFEQ      0                                                           S0111
     C                   GOTO      RXUNIP                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     UBRTT         IFEQ      0                                                           S0111
     C/COPY WNCPYSRC,DL0280C406
     C                   GOTO      RXUNIP                                                      S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C511
      *                                                                   CSW005
      ** If CSW005 is switched on                                         CSW005
      **    Set Our Rate Fixing Indicator to BLANK                        CSW005
      *                                                                   CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C                   MOVE      *BLANK        URFIN                                         CSW00
     C                   BITOFF    '4'           CNFI                                          CSW00
     C                   ENDIF                                                                 CSW00
     C*                                                                   S01119
     C*   CALCULATE INTEREST TO BRING ACCRUAL FIGURES UP TO DATE          S01119
     C*                                                                   S01119
     C** If our interest is Up-Front, set the interest calculated         CIR001
     C** to 0 and do not execute SR/GLINTC                                CIR001
     C*                                                                   CIR001
     C                   Z-ADD     *ZERO         WKINT                                         CIR00
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UINPM         ANDNE     'D'                                                         CIR00
     C     UINPM         ANDNE     'Y'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C                   Z-ADD     UEINR         ZIRATE                                        S0111
     C                   Z-ADD     UPAMT         ZIAMT                                         S0111
     C                   Z-ADD     UICBS         ZICALC                                        S0111
     C                   Z-ADD     UIACD         ZIBEG                                         S0111
     C                   Z-ADD     UNICD         ZIEND                                         S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add our unsettled interest and      t  CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280CP48                                           S01408
     C                   EXSR      GLINTC                                                      S0111
     C/COPY WNCPYSRC,DL0280CP49                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add the interest calculated to      t  CIR002
     C**   our unsettled interest.                                        CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         OUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*  HAVING UPDATED BASE RATE DURING RATE FIX PROCESSING APPLY        S01119
     C*  SPREAD IN LINE WITH INDICATOR : ADD,SUB AND ADD PERCENTAGE       S01119
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UBRTE         FSUEFR
     C                   ENDIF
      *                                                                                       CAS005
     C     USPIN         IFEQ      'A'                                                         S0111
     C     UBRTE         ADD       URTSP         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     UBRTE         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      'S'                                                         S0111
     C     UBRTE         SUB       URTSP         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      'P'                                                         S0111
     C     UBRTE         DIV       100           EINR                                          S0111
     C     EINR          MULT(H)   URTSP         UEINR                                         S0111
     C                   ADD       UBRTE         UEINR                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C****** UPDATES                                                      S01119
     C*                                                                   S01119
     C                   Z-ADD     0             UIALC                                         S0111
     C                   ADD       WKINT         UAITC                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     *ZERO         WINTST
     C                   Z-ADD     UICBS         ZICALC
     C                   Z-ADD     UIACD         ZIBEG
     C                   Z-ADD     UNICD         ZIEND
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   Z-ADD     FSUPAM        ZIAMT
      *                                                                                       CAS005
      ** If CIR002 is switched on, add our unsettled interest and                             CAS005
      ** adjustment to our principal.                                                         CAS005
      *                                                                                       CAS005
     C     CIR002        IFEQ      'Y'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'A'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'I'
     C     CIR006        OREQ      'Y'
     C     UINPM         ANDEQ     'L'
     C                   ADD       OUSI          ZIAMT
     C                   ADD       OUSA          ZIAMT
     C                   ENDIF
     C                   EXSR      SRDLIN
     C                   Z-ADD     0             FSUALB
     C                   ADD       WINTST        FSUITB
     C                   ENDIF
     C                   Z-ADD     UNICD         UIACD                                         S0111
     C                   Z-ADD     UNICD         ULPCD                                         S0111
      *                                                                   CPL002
      ** If Midas-Plato Module is ON and this is a floating leg,          CPL002
      ** then maintain Our Last Rate Change Date field (PLULRC)           CPL002
      *                                                                   CPL002
     C     BGN2ST        IFEQ      'Y'                                                         CPL00
     C     UBRTT         ANDNE     0                                                           CPL00
     C                   Z-ADD     UNICD         PLULRC                                        CPL00
     C                   ENDIF                                                                 CPL00
      *                                                                   CPL002
     C**  UPDATE DATES IF FREQUENCY NON BLANK                             S01119
     C     UICFR         IFNE      ' '                                                         S0111
     C                   MOVE      UICFR         ZFREQ                                         S0111
     C                   Z-ADD     UICBD         ZDAYNO                                        S0111
     C                   Z-ADD     UICFD         ZMDAY                                         S0111
     C                   MOVE      UCUCY         ZCCY                                          S0111
     C                   MOVE      BJSLCD        ZLOC                                          S0119
     C*                                                                   CIR001
     C** If CIR001 is on and Our Interest Frequency is Not 'Z',           CIR001
     C** perform processing as at present using SR/ZFREQC, otherwise      CIR001
     C** use #LDNDT.                                                      CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     ZFREQ         ANDNE     'Z'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     CIR005        IFEQ      'N'                                                         CIR00
     C     L1CYP1        OREQ      *BLANKS                                                     CIR00
     C                   EXSR      ZFREQC                                                      S0119
     C                   Z-ADD     0             ZNRDYS                                        S0119
     C                   MOVE      BJSLCD        ZLOC                                          S0119
     C                   EXSR      ZFWDT                                                       S0119
      *                                                                   CIR005
     C                   ELSE                                                                  CIR00
     C                   EXSR      ZFRQB3                                                      CIR00
      *                                                                   CIR005
     C                   CALL      'DLZIRP'                                                    CIR00
     C                   PARM                    ZDAYNO                                        CIR00
     C                   PARM      CCYPY1        PCURR                                         CIR00
     C                   PARM      L1PDCN        PPDCN                                         CIR00
     C                   PARM                    ZLOC                                          CIR00
     C                   PARM                    BJDFIN                                        CIR00
     C                   PARM      *ZEROS        PAJDT                                         CIR00
     C                   PARM      *ZEROS        PBSDT                                         CIR00
     C                   Z-ADD     PAJDT         ZDYNBR                                        CIR00
     C                   Z-ADD     PBSDT         ZDAYNO                                        CIR00
      *                                                                   CIR005
      ** Do not return adjusted date if it is equal to or earlier than    CIR005
      ** previous date (only happens for 'previous' date calculations);   CIR005
      ** instead use the base date                                        CIR005
      *                                                                   CIR005
     C     UICBD         IFGE      ZDYNBR                                                      CIR00
     C                   Z-ADD     PBSDT         ZDYNBR                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C** IF FREQUENCY IS 'Z' DETEMINE NEXT DATE FROM DATE SCHEDULE FILE   CIR001
     C*                                                                   CIR001
     C                   MOVEL     'U'           OTIN                           * THEIRS       CIR00
     C                   MOVEL     'R'           RCIP                           * RATE CHANGE  CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        ZDYNBR                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     ZDYNBR        IFLT      MDAT                                                        S0111
     C                   Z-ADD     ZDAYNO        UICBD                                         S0111
     C                   Z-ADD     ZDYNBR        UNICD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             UICBD                                         S0111
     C                   Z-ADD     0             UNICD                                         S0111
     C                   MOVE      ' '           UICFR                                         S0111
     C                   Z-ADD     0             UICFD                                         S0111
     C                   Z-ADD     0             UINFD                                         18281
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             UICBD                                         S0111
     C                   Z-ADD     0             UNICD                                         S0111
     C                   Z-ADD     0             UINFD                                         18281
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C     RXUNIP        TAG                                                    ** RXUNIP TAG**S0111
     C/COPY WNCPYSRC,DL0280C343
     C*                                                                   CIR001
     C** IF OUR PAY DATE = THEIR PAY DATE, BUT BOTH DATES HAVEN'T BEEN    CIR001
     C** PROCESSED YET (AS INTEREST IS UP FRONT ON ONE LEG), THEN RE-DO.  CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     WNIPDU        IFEQ      WNIPDT                                                      CIR00
     C/COPY WNCPYSRC,DL0280C344
     C     OUR           IFEQ      *BLANK                                                      CIR00
     C     THR           OREQ      *BLANK                                                      CIR00
     C                   GOTO      RXDATE                                                      CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C345
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C*   RESET 'OUR' 'THR' FLAGS.                                        CIR001
     C                   MOVE      ' '           THR                                           CIR00
     C                   MOVE      ' '           OUR                                           CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*                                                                   S01119
     C*   NEXT INTEREST PAYMENT DATE WORK FIELDS SHOULD BE UPDATED        S01119
     C*    TO REFLECT CHANGES ARISING FROM EVENT DATE PROCESSING          S01119
     C*       E.G. IF DEFAULTING TO CHANGE DATES WHICH HAVE BEEN          S01119
     C*                    INCREMENTED                                    S01119
     C*   UPDATE THEIR WORK FIELD                                         S01119
     C*                                                                   S01119
     C     TNIPD         IFEQ      0                                                           S0111
     C     TNICD         IFNE      0                                                           S0111
     C                   Z-ADD     TNICD         WNIPDT            5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPDT                                        S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TNIPD         WNIPDT                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*   UPDATE OUR WORK FIELD                                           S01119
     C*                                                                   S01119
     C     UNIPD         IFEQ      0                                                           S0111
     C     UNICD         IFNE      0                                                           S0111
     C                   Z-ADD     UNICD         WNIPDU            5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPDU                                        S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     UNIPD         WNIPDU                                        S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C428
     C*                                                                   CIR001
     C** IF INTEREST IS UP FRONT (DISCOUNT OR YIELD)                      CIR001
     C** DETERMINE INTEREST PAYMENT DATE AFTER NEXT INTEREST PAYMENT      CIR001
     C** DATE (TERMED THE NEXT INTEREST END DATE)                         CIR001
     C** ELSE THIS DATE IS THE SAME AS THE NEXT INTEREST PAYMENT DATE     CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C** THEIRS:                                                          CIR001
     C*                                                                   CIR001
     C     TINPM         IFEQ      'D'                                                         CIR00
     C     TINPM         OREQ      'Y'                                                         CIR00
     C                   MOVEL     'T'           OTIN                                          CIR00
     C                   MOVEL     'P'           RCIP                                          CIR00
     C                   Z-ADD     WNIPDT        ZDAYNO                                        CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        WNIEDT                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     WNIPDT        WNIEDT                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** OURS:                                                            CIR001
     C*                                                                   CIR001
     C     UINPM         IFEQ      'D'                                                         CIR00
     C     UINPM         OREQ      'Y'                                                         CIR00
     C                   MOVEL     'U'           OTIN                                          CIR00
     C                   MOVEL     'P'           RCIP                                          CIR00
     C                   Z-ADD     WNIPDU        ZDAYNO                                        CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        WNIEDU                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     WNIPDU        WNIEDU                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C** RETURN TO NON-SHADOW POST DATE PROCESSING                        S01119
     C*         IN ORDER TO PROCESS NEXT EVENT DATE IN SEQUENCE           S01119
     C*                                                                   S01119
     C   U1              GOTO      RXDATE                                                      S0111
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   GOTO      RXMDAT                                                      CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C  NU1              GOTO      RXSEND                                                      S0111
     C*                                                                   S01119
     C     RXMDAT        TAG                                                    ** RXMDAT TAG**S0111
     C/COPY WNCPYSRC,DL0280C429
     C*                                                                   S01119
     C* MATURITY DATE PROCESSING                                          S01119
     C*                                                                   S01119
     C                   TESTB     '2'           ACEI                 31                       S0111
     C     MDAT          IFLE      EVCD                                                        S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
     C*                                                                   CIR001
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     BOVD          ANDLE     EVCD                                                        CIR00
     C     BOVD          ANDNE     *ZEROS                                                      CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     BOVD          ANDNE     *ZEROS                                                      CIR00
     C                   Z-ADD     BOVD          KYDAT                                         CIR00
     C                   Z-ADD     BOVD          KYFED                                         CIR00
     C                   MOVEL     NEV(10)       NARREV                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     MDAT          KYDAT                                         S0111
     C                   Z-ADD     MDAT          KYFED                                         S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   MOVEL     NEV(4)        NARREV                                        CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** Produce Buy-Out value date key.                                  CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C     BOVD          IFNE      *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'V'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    B'       AKY(6)                                        CIR00
     C                   MOVE      BAPR          AKY(9)                                        CIR00
     C                   Z-ADD     BOAM          KYAMT                                         CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C346
     C     BAPR          IFEQ      'P'                                                         CIR00
     C                   ADD       BOAM          UIPRD                                         CIR00
     C                   ADD       BOAM          UIPRM                                         CIR00
     C/COPY WNCPYSRC,DL0280C347
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C348
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   END                                                                   CIR00
     C     BAPR          IFEQ      'R'                                                         CIR00
     C                   ADD       BOAM          TIPRD                                         CIR00
     C                   ADD       BOAM          TIPRM                                         CIR00
     C/COPY WNCPYSRC,DL0280C349
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C350
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C485
     C** Do not produce any more maturity date keys if shadow post mode   CIR001
      ** Unless Principal Exchange at Maturity Date is "Y".                                   235079
     C*                                                                   CIR001
     C     CIR003        IFEQ      'Y'                                                        235079
     C     MDEI          ANDEQ     'Y'                                                        235079
     C     *INU1         ANDEQ     '0'                                                        235079
     C                   ELSE                                                                 235079
     C  NU1              GOTO      RXSEND                                                      CIR00
     C                   ENDIF                                                                235079
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C* OUR PRINCIPAL                                                     S01119
     C/COPY WNCPYSRC,DL0280C351
     C                   MOVEA     'RXM'         AKY(1)                                        S0111
     C/COPY WNCPYSRC,DL0280C352
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '   OA'       AKY(6)                                        S0111
     C     CIR001        IFNE      'Y'                                                         CIR00
     C                   MOVEL     NEV(4)        NARREV                                        06014
     C                   END                                                                   CIR00
     C                   MOVE      UFRDKY        FRDKY                                         S0111
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C/COPY WNCPYSRC,DL0280C558
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     MDEI          ANDEQ     'Y'                                                         CIR00
      *                                                                   CIR003
     C     UCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   MOVE      'B'           AKY(8)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   MOVEL     'MAT'         KEDCD             3                           CIR00
     C                   MOVE      *IN87         WIN87                                         CIR00
     C     WDLKEY        CHAIN     DLGXSTL0                           87                       CIR00
      *                                                                   CIR003
     C     *IN87         IFEQ      '1'                                                         CIR00
     C                   MOVEL     DLNO          WKEY              9                           CIR00
     C                   MOVE      KEDCD         WKEY                                          CIR00
     C                   MOVEL     'DLGXSTL0'    DBFILE                          ************  CIR00
     C                   MOVEL     '35'          DBASE                           *DBERROR 35*  CIR00
     C                   MOVEL     WKEY          DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   Z-ADD     RXPSTM        KYSETL                                        CIR00
     C                   MOVEL     RXPONS        KYOSTL                                        CIR00
     C                   MOVEL     RXPOBR        KYSTBR                                        CIR00
     C                   MOVEL     RXPSCY        KYSCY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'RX'          STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   ENDIF                                                                 CIR00
     C/COPY WNCPYSRC,DL0280C559
     C                   TESTB     '0'           UDNSI                31                       S0111
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
0764 C                   SETOFF                                       4546                     S0111
0765 C     UDECP         COMP      1                                    4344                   S0111
     C  N43
0766 CANN44UDECP         COMP      3                                    4546                   S0111
     C                   SETON                                        71                       S0111
     C                   EXSR      EXCP                                                        S0111
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     MDEI          ANDEQ     'Y'                                                         CIR00
     C                   MOVE      *BLANKS       AKY(8)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C* OUR EXPOSURE                                                      S01119
      ** Only generate exposure and base currency equivalent account                          235079
      ** keys if non-shadow postings mode.                                                    235079
      *                                                                                       235079
     C     *INU1         IFEQ      '1'                                                        235079
     C                   Z-ADD     UAEXA         KYAMT                                         S0111
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   EXSR      EXCP                                                        S0111
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     MDEI          ANDEQ     'Y'                                                         CIR00
     C                   MOVEA     UCUCY         AKY(6)                                        CIR00
     C                   MOVEA     'A'           AKY(10)                                       CIR00
     C                   MOVEL     BJCYCD        KYCCY                                         CIR00
     C                   Z-ADD     0             KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
      *                                                                   CIR003
     C     UCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   Z-ADD     UPAMT         KYAMT                                         CIR00
     C                   ELSE                                                                  CIR00
      *                                                                   CIR003
     C                   MOVE      *IN87         WIN87                                         CIR00
     C                   Z-ADD     1             I                                             CIR00
     C     UCUCY         LOOKUP    CY(I)                                  87                   CIR00
     C     *IN87         IFEQ      '0'                                                         CIR00
     C                   MOVEL     'TABTG30 '    DBFILE                          ************  CIR00
     C                   MOVEL     '36'          DBASE                           *DBERROR 36*  CIR00
     C                   MOVEL     UCUCY         DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     CYD(I)        CYDDS                                         CIR00
     C                   Z-ADD     UPAMT         ZAMTCI                                        CIR00
     C                   Z-ADD     UBCXR         ZEXCH                                         CIR00
     C                   Z-ADD     UDECP         ZCDPI                                         CIR00
     C                   Z-ADD     BCDP          ZCDPO                                         CIR00
      *                                                                   CIR003
     C     MDIN          IFEQ      1                                                           CIR00
     C                   MOVE      'M'           ZMD
     C                   ELSE                                                                  CIR00
     C                   MOVE      'D'           ZMD
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      ZCONV                                                       CIR00
     C                   Z-ADD     ZAMTCO        KYAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   MOVEA     *BLANKS       AKY(8)                                        CIR00
     C                   MOVEA     '  '          AKY(6)                                        19815
     C                   ENDIF                                                                 CIR00
      *                                                                                       235079
     C                   ENDIF                                                                235079
      *                                                                   CIR003
     C* THEIR PRINCIPAL                                                   S01119
     C                   MOVEA     'TA'          AKY(9)                                        S0111
     C                   MOVEL     NEV(4)        NARREV                                        06014
     C                   MOVE      TFRDKY        FRDKY                                         S0111
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C/COPY WNCPYSRC,DL0280C560
     C                   Z-ADD     TPAMT         KYAMT                                         S0111
     C/COPY WNCPYSRC,DL0280C561
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'
     C     MDEI          ANDEQ     'Y'
     C     TCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   MOVE      'B'           AKY(8)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   Z-ADD     RXRSTM        KYSETL                                        CIR00
     C                   MOVEL     RXRONS        KYOSTL                                        CIR00
     C                   MOVEL     RXROBR        KYSTBR                                        CIR00
     C                   MOVEL     RXRSCY        KYSCY                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'RX'          STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   TESTB     '0'           TDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
0764 C                   SETOFF                                       4546                     S0111
0765 C     TDECP         COMP      1                                    4344                   S0111
     C  N43
0766 CANN44TDECP         COMP      3                                    4546                   S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     TPAMT         NRRPUR                                        S0111
     C                   EXCEPT    RXTHRS                                                      S0111
     C                   ADD       1             PLINES                                        LN088
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     MDEI          ANDEQ     'Y'                                                         CIR00
     C                   MOVE      *BLANKS       AKY(8)                                        CIR00
     C                   ENDIF                                                                 CIR00
     C* THEIR EXPOSURE                                                    S01119
      ** Only generate exposure and base currency equivalent account                          235079
      ** keys if non-shadow postings mode.                                                    235079
      *                                                                                       235079
     C     *INU1         IFEQ      '1'                                                        235079
     C                   Z-ADD     TAEXA         KYAMT                                         S0111
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   EXSR      EXCP                                                        S0111
      *                                                                   CIR003
     C     CIR003        IFEQ      'Y'                                                         CIR00
     C     MDEI          ANDEQ     'Y'                                                         CIR00
     C                   MOVEA     TCUCY         AKY(6)                                        CIR00
     C                   MOVEA     'A'           AKY(10)                                       CIR00
     C                   MOVEL     BJCYCD        KYCCY                                         CIR00
     C                   Z-ADD     0             KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
      *                                                                   CIR003
     C     TCUCY         IFEQ      BJCYCD                                                      CIR00
     C                   Z-ADD     TPAMT         KYAMT                                         CIR00
     C                   ELSE                                                                  CIR00
      *                                                                   CIR003
     C                   MOVE      *IN87         WIN87                                         CIR00
     C                   Z-ADD     1             I                                             CIR00
     C     TCUCY         LOOKUP    CY(I)                                  87                   CIR00
     C     *IN87         IFEQ      '0'                                                         CIR00
     C                   MOVEL     'TABTG30 '    DBFILE                          ************  CIR00
     C                   MOVEL     '37'          DBASE                           *DBERROR 37*  CIR00
     C                   MOVEL     UCUCY         DBKEY                           ************  CIR00
     C                   SETON                                        U7U8LR                   CIR00
     C                   EXSR      *PSSR                                                       CIR00
     C                   GOTO      EOJ                                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   MOVE      WIN87         *IN87                                         CIR00
     C                   MOVEL     CYD(I)        CYDDS                                         CIR00
     C                   Z-ADD     TPAMT         ZAMTCI                                        CIR00
     C                   Z-ADD     TBCXR         ZEXCH                                         CIR00
     C                   Z-ADD     TDECP         ZCDPI                                         CIR00
     C                   Z-ADD     BCDP          ZCDPO                                         CIR00
      *                                                                   CIR003
     C     MDIN          IFEQ      1                                                           CIR00
     C                   MOVE      'M'           ZMD
     C                   ELSE                                                                  CIR00
     C                   MOVE      'D'           ZMD
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR003
     C                   EXSR      ZCONV                                                       CIR00
     C                   Z-ADD     ZAMTCO        KYAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   MOVEA     '   '         AKY(6)                                        19815
     C                   ENDIF                                                                 CIR00
      *                                                                                       235079
     C                   ENDIF                                                                235079
      *                                                                                       235079
      ** Do not produce any more maturity date keys if shadow post                            235079
      ** mode.                                                                                235079
      *                                                                                       235079
     C     *INU1         IFEQ      '0'                                                        235079
     C                   GOTO      RXSEND                                                     235079
     C                   ENDIF                                                                235079
     C*                                                                   S01328
     C/COPY WNCPYSRC,DL0280C486
     C** IF UNREALIZED PROFIT/LOSS POSTED IS NOT ZERO, THEN REVERSE IT    S01328
     C*                                                                   S01328
     C     UNRLP         IFNE      *ZERO                                                       S0132
      *                                                                                       CAS004
     C     CAS004        IFEQ      'N'
     C*                                                                   S01328
     C** SET THE UNREALIZED P/L TO ZERO (REVERSAL POSTING ONLY REQUIRED)  S01328
     C*                                                                   S01328
     C                   Z-ADD     *ZERO         UNRL                                          S0132
     C*                                                                   S01328
     C** GENERATE UNREALIZED P/L A/C KEYS                                 S01328
     C*                                                                   S01328
     C                   EXSR      UNREAL                                                      S0132
     C                   ENDIF
     C                   END                                                                   S0132
      *                                                                                       221703
      ** RX Maturity Reversals                                                                221703
      *                                                                                       221703
     C     CAS004        IFEQ      'Y'
     C     MDAT          ANDLE     EVCD
     C                   Z-ADD     MDAT          KYDAT
     C                   EXSR      SRUREL
     C                   MOVE      '1'           *IN15
     C                   ENDIF
     C*                                                                   CIR001
     C** If up-front fee value date is not 0 and is less than or equal    CIR001
     C** to event control date, the unamortised fee must be posted        CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UPVD          ANDNE     *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C     UPVD          IFLE      EVCD                                                        CIR00
     C*                                                                   CIR001
     C     BOVD          IFNE      *ZEROS                                                      CIR00
     C                   Z-ADD     BOVD          KYDAT                                         CIR00
     C                   Z-ADD     BOVD          KYFED                                         CIR00
     C                   MOVEL     NEV(10)       NARREV                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     MDAT          KYDAT                                         CIR00
     C                   Z-ADD     MDAT          KYFED                                         CIR00
     C                   MOVEL     NEV(4)        NARREV                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     UPVD          IFNE      *ZEROS                                                      CIR00
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVE      UPPR          AKY(9)                                        CIR00
     C     UPFE          SUB       UPAD          KYAMT                                         CIR00
     C                   Z-ADD     UPFE          UPAD                                          CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C353
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C354
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C355
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C356
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   Z-ADD     *ZEROS        KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C** If an up-front fee has been entered and it has NOT been          CIR001
     C** reached (UPVD > EVCD), the up-front fee deal date entries must   CIR001
     C** be reversed by generating up-front fee deal date key             CIR001
     C** "xxDyy   zF" with the full fee amount as a negative amount       CIR001
     C** and the remaining parameters setup as above.                     CIR001
     C*                                                                   CIR001
     C     BOVD          IFNE      *ZEROS                                                      CIR00
     C                   Z-ADD     BOVD          KYDAT                                         CIR00
     C                   Z-ADD     BOVD          KYFED                                         CIR00
     C                   MOVEL     NEV(10)       NARREV                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     MDAT          KYDAT                                         CIR00
     C                   Z-ADD     MDAT          KYFED                                         CIR00
     C                   MOVEL     NEV(4)        NARREV                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     UPVD          IFNE      *ZEROS                                                      CIR00
     C                   MOVEA     'RS'          AKY(1)                                        CIR00
     C                   MOVE      'D'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVE      UPPR          AKY(9)                                        CIR00
     C*                                                                   CIR001
     C                   Z-SUB     UPFE          KYAMT                                         CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C357
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C358
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C359
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C360
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C361
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** Accrual posted to date on both our and their sides must          CIR001
     C** be reversed out.                                                 CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     BOVD          ANDNE     *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C* Our:                                                              CIR001
     C     BAPR          IFEQ      'P'                                                         CIR00
     C     UIPRD         SUB       BOAM          WIPRD                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     UIPRD         WIPRD                                         CIR00
     C                   END                                                                   CIR00
     C     UAIPD         SUB       WIPRD         WACCP            13 0                         CIR00
     C     WACCP         IFNE      0                                                           CIR00
     C                   MOVEA     'RS'          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '   PA'       AKY(6)                                        CIR00
     C                   Z-SUB     WACCP         KYAMT                                         CIR00
     C                   MOVE      UCUCY         KYCCY                                       BUG7937
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C* Their:                                                            CIR001
     C     BAPR          IFEQ      'R'                                                         CIR00
     C     TIPRD         SUB       BOAM          WIPRD                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     TIPRD         WIPRD                                         CIR00
     C                   END                                                                   CIR00
     C     TAIPD         SUB       WIPRD         WACCP                                         CIR00
     C     WACCP         IFNE      0                                                           CIR00
     C                   MOVEA     'RS'          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '   RA'       AKY(6)                                        CIR00
     C                   Z-SUB     WACCP         KYAMT                                         CIR00
     C                   MOVE      TCUCY         KYCCY                                       BUG7937
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01328
     C* UPDATE FIELDS                                                     S01119
     C                   BITON     '2'           ACEI                                          S0111
     C                   MOVE      'M'           RECR                                          S0111
      *                                                                                       CIR008
      ** Set Deal Authorisation Status to 'M' if CIR008 is installed                          CIR008
      *                                                                                       CIR008
     C     CIR008        IFEQ      'Y'
     C                   MOVE      'M'           FIDSTS
     C                   ENDIF
      *                                                                                       CIR008
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C/COPY WNCPYSRC,DL0280C550
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* ACCRUAL DATE                                                      S01119
     C*                                                                   S01119
     C     *IN52         IFEQ      '1'                                                         S0111
     C     VDAT          ANDLE     EVCD                                                        S0111
     C     MDAT          ANDGT     EVCD                                                        S0111
     C/COPY WNCPYSRC,DL0280C513
     C                   Z-ADD     BKAPDT        KYDAT                                         07778
     C                   Z-ADD     BJRDNB        KYFED                                         S0119
     C*                                                                   S01119
      * DLRSAC (OURS NON-AVE)                                             S01119
     C*                                                                   S01119
     C*   ONLY IF NOT ALSO A PAYMENT DATE OR FIRST DATE ACCRUAL           E36008
     C     USLIP         IFNE      EVCD                                                        S0111
     C     USLIP         OREQ      EVCD                                         DATE 1ST SET   S0111
     C     USLIP         ANDEQ     VDAT                                         *EQ VDAT       S0111
     C     BKALDI        OREQ      'N'                                          1ST DAY ACCRUALE3600
     C                   Z-ADD     UIACD         SZIACD                                        S0111
     C                   Z-ADD     ULPCD         SZLPCD            5 0                         S0111
     C                   MOVE      BKALDI        SZLDA             1                           S0119
     C                   Z-ADD     EVCD          SZECD             5 0                         S0111
     C                   Z-ADD     UEINR         SZINTR           11 7                         S0111
     C                   Z-ADD     UPAMT         SZPPL                                         S0111
     C                   Z-ADD     UAITC         SZAICD                                        S0111
     C                   Z-ADD     UAIAP         SZAIAP                                        S0111
     C                   Z-ADD     UAIAN         SZIANP                                        S0111
     C                   Z-ADD     UAIPD         SZIPTD                                        S0111
     C                   MOVE      'N'           SZAVRM            1                           S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   Z-ADD     UICBS         SZCBS                                         S0111
     C                   MOVEA     'P'           AKY(9)                                        S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     UIACD         TZIACD
     C                   Z-ADD     ULPCD         TZLPCD            5 0
     C                   MOVE      BKALDI        TZLDA
     C                   Z-ADD     EVCD          TZECD
     C                   Z-ADD     FSUPAM        TZPPL
     C                   Z-ADD     FSUITB        TZAICD
     C                   Z-ADD     FSUIAB        TZAIAP
     C                   Z-ADD     FSUINB        TZIANP
     C                   Z-ADD     FSUIPB        TZIPTD
     C                   MOVE      'N'           TZAVRM
     C                   Z-ADD     UICBS         TZCBS
     C                   ENDIF
     C*                                                                   003457
     C/COPY WNCPYSRC,DL0280CP93                                           S01408
      *                                                                   S01408
     C** Set off *IN31 to ensure Effective Rate (UEINR) output            003457
     C*                                                                   003457
     C                   MOVE      '0'           *IN31                                         00345
      *                                                                   E21662
      ** Find out how many decimal places for our currency (Accruals)     E21662
     C                   MOVEA     '0000'        *IN(43)                                       E2166
     C     UDECP         COMP      1                                    4344                   E2166
     C  N43
     CANN44UDECP         COMP      3                                    4546                   E2166
     C*                                                                   CIR002
     C** If our interest is NOT up-front, add Our Unsettled Interest      CIR002
     C** Amount (OUSI) and Our Unsettled Interest Adjustment (OUSA)       CIR002
     C** to amount parameter (SZPPL)                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UINPM         ANDNE     'D'                                                         CIR00
     C     UINPM         ANDNE     'Y'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          SZPPL                                         CIR00
     C                   ADD       OUSA          SZPPL                                         CIR00
     C     CAS005        IFEQ      'Y'
     C                   ADD       OUSI          TZPPL
     C                   ADD       OUSA          TZPPL
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C** Set interest processing method parameter to our interest         CIR001
     C** method.  If interest is up-front, use SR/#LRSAU, otherwise       CIR001
     C** use SR/DLRSAC.                                                   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   MOVE      UINPM         SZINPM                                        CIR00
     C                   Z-ADD     USLIP         SZSLID                                        CIR00
     C                   Z-ADD     UNIPD         SZNIPD                                        CIR00
     C                   MOVE      UIPFR         SZIPFC                                        CIR00
      *                                                                   100289
      ** Set-up calculation basis.                                        100289
      *                                                                   100289
     C                   MOVE      UICBS         SZCBS                                         10028
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     USLIP         TZSLID
     C                   Z-ADD     UNIPD         TZNIPD
     C                   MOVE      UIPFR         TZIPFC
     C                   MOVE      UICBS         TZCBS
     C                   ENDIF
      *                                                                   100289
     C     SZINPM        IFEQ      'D'                                                         CIR00
     C     SZINPM        OREQ      'Y'                                                         CIR00
     C                   EXSR      #LRSAU                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSAU
     C                   ENDIF
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C252
     C                   EXSR      DLRSAC                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSAC
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C253
     C                   EXSR      DLRSAC                                                      S0111
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSUEFR        ZIRATE
     C                   EXSR      SRRSAC
     C                   ENDIF
     C                   END                                                                   CIR00
      *        (RESULT)                                                   S01119
     C                   Z-ADD     SZIPTD        UAIPD                                         S0111
     C                   Z-ADD     SZIANP        UAIAN                                         S0111
     C                   Z-ADD     SZAIAP        UAIAP                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TZIPTD        FSUIPB
     C                   Z-ADD     TZIANP        FSUINB
     C                   Z-ADD     TZAIAP        FSUIAB
     C                   ENDIF
      *                                                                                       CAS005
     C                   END                                                                   S0111
      *                                                                   S01119
      * DLRSAC                                                            S01119
      *                                                                   S01119
      *        (THEIRS NON-AVE)                                           S01119
     C*   ONLY IF NOT ALSO A PAYMENT DATE OR FIRST DAY ACCRUAL            E36008
     C     TSLIP         IFNE      EVCD                                                        S0111
     C     TSLIP         OREQ      EVCD                                         DATE 1ST SET   S0111
     C     TSLIP         ANDEQ     VDAT                                         *EQ VDAT       S0111
     C     BKALDI        OREQ      'N'                                          1ST DAY ACCRUALE3600
     C                   Z-ADD     TIACD         SZIACD                                        S0111
     C                   Z-ADD     TLPCD         SZLPCD                                        S0111
     C                   MOVE      BKALDI        SZLDA                                         S0119
     C                   Z-ADD     EVCD          SZECD                                         S0111
     C                   Z-ADD     TEINR         SZINTR                                        S0111
     C                   Z-ADD     TPAMT         SZPPL                                         S0111
     C                   Z-ADD     TAITC         SZAICD                                        S0111
     C                   Z-ADD     TAIAP         SZAIAP                                        S0111
     C                   Z-ADD     TAIAN         SZIANP                                        S0111
     C                   Z-ADD     TAIPD         SZIPTD                                        S0111
     C                   MOVE      'N'           SZAVRM                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       STINFO
     C                   ENDIF
      *                                                                                       CGL020
     C                   Z-ADD     TICBS         SZCBS                                         S0111
     C                   MOVEA     'R'           AKY(9)                                        S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TIACD         TZIACD
     C                   Z-ADD     TLPCD         TZLPCD
     C                   Z-ADD     FSTPAM        TZPPL
     C                   MOVE      BKALDI        TZLDA
     C                   Z-ADD     EVCD          TZECD
     C                   Z-ADD     FSTITB        TZAICD
     C                   Z-ADD     FSTIAB        TZAIAP
     C                   Z-ADD     FSTINB        TZIANP
     C                   Z-ADD     FSTIPB        TZIPTD
     C                   MOVE      'N'           TZAVRM
     C                   Z-ADD     TICBS         TZCBS
     C                   ENDIF
     C*                                                                   003457
     C/COPY WNCPYSRC,DL0280CP95                                           S01408
      *                                                                   S01408
     C** Set off *IN31 to ensure Effective Rate (UEINR) output            003457
     C*                                                                   003457
     C                   MOVE      '0'           *IN31                                         00345
      *                                                                   E21662
      ** Find out how many decimal places for their currency (Accruals)   E21662
     C                   MOVEA     '0000'        *IN(43)                                       E2166
     C     TDECP         COMP      1                                    4344                   E2166
     C  N43
     CANN44TDECP         COMP      3                                    4546                   E2166
     C*                                                                   CIR002
     C** If their interest is NOT up-front, add Their Unsettled Interest  CIR002
     C** Amount (TUSI) and Their Unsettled Interest Adjustment (TUSA)     CIR002
     C** to amount parameter (SZPPL)                                      CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     TINPM         ANDNE     'D'                                                         CIR00
     C     TINPM         ANDNE     'Y'                                                         CIR00
     C     CIR006        ANDEQ     'N'                                                         CIR00
     C     CIR001        ORNE      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          SZPPL                                         CIR00
     C                   ADD       TUSA          SZPPL                                         CIR00
     C     CAS005        IFEQ      'Y'
     C                   ADD       TUSI          TZPPL
     C                   ADD       TUSA          TZPPL
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C** Set interest processing method parameter to our interest         CIR001
     C** method.  If interest is up-front, use SR/#LRSAU, otherwise       CIR001
     C** use SR/DLRSAC.                                                   CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   MOVE      TINPM         SZINPM                                        CIR00
     C                   Z-ADD     TSLIP         SZSLID                                        CIR00
     C                   Z-ADD     TNIPD         SZNIPD                                        CIR00
     C                   MOVE      TIPFR         SZIPFC                                        CIR00
      *                                                                   100289
      ** Set-up calculation basis.                                        100289
      *                                                                   100289
     C                   MOVE      TICBS         SZCBS                                         10028
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TSLIP         TZSLID
     C                   Z-ADD     TNIPD         TZNIPD
     C                   MOVE      TIPFR         TZIPFC
     C                   MOVE      TICBS         TZCBS
     C                   ENDIF
      *                                                                   100289
     C     SZINPM        IFEQ      'D'                                                         CIR00
     C     SZINPM        OREQ      'Y'                                                         CIR00
     C                   EXSR      #LRSAU                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSAU
     C                   ENDIF
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C254
     C                   EXSR      DLRSAC                                                      CIR00
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSAC
     C                   ENDIF
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C/COPY WNCPYSRC,DL0280C255
     C                   EXSR      DLRSAC                                                      S0111
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     FSTEFR        ZIRATE
     C                   EXSR      SRRSAC
     C                   ENDIF
     C                   END                                                                   CIR00
      *        (RESULT)                                                   S01119
     C                   Z-ADD     SZIPTD        TAIPD                                         S0111
     C                   Z-ADD     SZIANP        TAIAN                                         S0111
     C                   Z-ADD     SZAIAP        TAIAP                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C                   Z-ADD     TZIPTD        FSTIPB
     C                   Z-ADD     TZIANP        FSTINB
     C                   Z-ADD     TZAIAP        FSTIAB
     C                   ENDIF
      *                                                                                       CAS005
     C                   END                                                                   S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C** On accrual date, if the maturity date processing has not         CIR001
     C** been performed and the up-front fee value date is less than      CIR001
     C** the event control date, a key ("xxAyy   zF") should be           CIR001
     C** generated for the fee amortization.                              CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '2'           ACEI                 31                       CIR00
     C     *IN52         IFEQ      *ON                                                         CIR00
     C     UPVD          ANDLE     EVCD                                                        CIR00
     C     UPVD          ANDNE     0                                                           CIR00
     C     *IN31         ANDEQ     *ON                                                         CIR00
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVE      UPPR          AKY(9)                                        CIR00
     C     MDAT          SUB       UPVD          PER1                                          CIR00
     C     UPFE          DIV       PER1          DACCR                                         CIR00
     C     EVCD          SUB       UPVD          PER2                                          CIR00
     C     *IN29         IFEQ      *OFF                                                        CIR00
     C                   ADD       1             PER2                                          CIR00
     C                   END                                                                   CIR00
     C     DACCR         MULT(H)   PER2          IAMT                                          CIR00
     C     IAMT          SUB       UPAD          KYAMT                                         CIR00
     C                   ADD       KYAMT         UPAD                                          CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C362
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C363
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C364
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C365
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C                   Z-ADD     *ZEROS        KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C                   Z-ADD     0             NRRPUR                                        S0111
     C                   Z-ADD     0             NRRSAL                                        S0111
     C*                                                                   S01328
     C** IF ACCRUAL DATE PROCESSING IS REQUIRED (*IN52 IS ON) AND THE     E26577
     C** MATURITY DATE IS GREATER THAN THE EVENT CONTROL DATE             E26577
     C*                                                                   S01328
     C     *IN52         IFEQ      '1'                                                         S0132
     C     MDAT          ANDGT     EVCD                                                        S0132
     C*                                                                   S01328
     C** IF UNREALIZED PROFIT/LOSS IS NOT ZERO,                           S01328
     C** OR UNREALIZED PROFIT/LOSS POSTED IS NOT ZERO,                    S01328
     C*                                                                   S01328
     C     UNRL          IFNE      *ZERO                                                       S0132
     C     UNRLP         ORNE      *ZERO                                                       S0132
      *                                                                                       CAS004
     C     CAS004        IFEQ      'N'
     C*                                                                   S01328
     C** GENERATE UNREALIZED P/L A/C KEYS                                 S01328
     C*                                                                   S01328
     C                   EXSR      UNREAL                                                      S0132
     C*                                                                   S01328
     C** SET ON DEALS FILE UPDATE INDICATOR (*IN15)                       S01328
     C*                                                                   S01328
     C                   MOVE      '1'           *IN15                                         S0132
     C                   ENDIF
     C                   END                                                                   S0132
     C                   END                                                                   S0132
     C*                                                                   S01328
     C/COPY WNCPYSRC,DL0280C366
     C     RXSEND        TAG                                                    ** RXSEND TAG**CSW00
     C*                                                                   CSW005
     C     BLKUF         IFEQ      'Y'                                                         CSW00
     C                   MOVE      *BLANKS       URFIN                                         CSW00
     C                   ENDIF                                                                 CSW00
     C     BLKTF         IFEQ      'Y'                                                         CSW00
     C                   MOVE      *BLANKS       TRFIN                                         CSW00
     C                   ENDIF                                                                 CSW00
     C*                                                                   CSW005
     C/COPY DLCPYSRC,DL0280C723                                                               CIR014
     C                   ENDSR                                                                 CSW00
     C/COPY WNCPYSRC,DL0280C367
      ** Re-introduced SR/UPFAMD                                                              CPK023
      **Externalisation*of*SR/UPFAMD******                                            BUG7724 CPK023
     C*/COPY*DLCPYSRC,DL0280FAMD**********                                            BUG7724 CPK023
     C*/C*PY*DLCPYSRC,DL0280FAMD******************************************            BUG7724BUG6293
      ********************************************************************                    185064
      *                                                                  *                    185064
      *  S/R UPFAMD - Process amended FRA/IRS Up-front fields            *                    185064
      *                                                                  *                    185064
      *                                                                  *                    185064
      ********************************************************************                    185064
     C     UPFAMD        BEGSR
      *                                                                                       185064
     C     CIR001        IFEQ      'Y'
     C     UPVD          ANDNE     0
      *                                                                                       185064
     C     DTYP          IFEQ      'RS'
     C     DTYP          OREQ      'RX'
      *                                                                                       185064
     C     CHTP          IFEQ      'A'
     C     RECR          ANDEQ     'D'
     C                   MOVE      '0'           *IN90
     C                   MOVE      DLNO          DDLNO             6 0
     C     DDLNO         CHAIN     DLDGUPL1                           90
      *                                                                                       185064
     C     *IN90         IFEQ      '0'
     C     KYAMT2        IFNE      UPFE
     C     KYAMT2        ANDNE     *ZERO
      *                                                                                       185064
     C                   TESTB     '0'           ACEI                     31
     C     *IN31         IFEQ      *ON
     C                   Z-ADD     UPVD          KYDAT
      *                                                                                       185064
     C     DTYP          IFEQ      'RS'
     C     DTYP          OREQ      'RX'
      *                                                                                       185064
     C                   MOVEA     DTYP          AKY(1)
     C                   MOVE      'D'           AKY(3)
     C                   MOVEA     DLST          AKY(4)
     C                   MOVEA     '    F'       AKY(6)
     C                   MOVEA     UPPR          AKY(9)
     C                   Z-SUB     UPFE          KYAMT
      *                                                                                       185064
      ** Currency details and settlement account details.                                     185064
      *                                                                                       185064
     C/COPY WNCPYSRC,DL0280C086                                                               185064
     C     UPPR          IFEQ      'P'
     C/COPY WNCPYSRC,DL0280C087                                                               185064
     C                   MOVEL     UCUCY         KYCCY
     C                   MOVE      PSCY          KYSCY
     C/COPY WNCPYSRC,DL0280C088                                                               185064
     C                   Z-ADD     PSETM         KYSETL
     C                   MOVEL     UPACC         KYOSTL
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END
     C*                                                                                       185064
     C     UPPR          IFEQ      'R'
     C/COPY WNCPYSRC,DL0280C066                                                               185064
     C                   MOVEL     TCUCY         KYCCY
     C                   MOVE      RSCY          KYSCY
     C/COPY WNCPYSRC,DL0280C067                                                               185064
     C                   Z-ADD     RSETM         KYSETL
     C                   MOVEL     URACC         KYOSTL
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END
      *                                                                                       185064
      ** Write reversal account key for Up-Front Fee/Premium                                  185064
      *                                                                                       185064
     C                   EXSR      EXCP
     C                   MOVE      KYAMT2        UPFE
     C                   MOVE      '1'           UPREV             1
      *                                                                                       185064
     C                   END
     C                   END
     C                   END
     C     UPPR2         IFNE      UPPR
     C     UPVD2         ORNE      UPVD
     C                   MOVE      UPPR2         UPPR
     C                   MOVE      UPVD2         UPVD
     C                   END
     C                   UPDATE    DLDGREF
     C                   END
      *                                                                                       185064
     C                   END
      *                                                                                       185064
      **  Write Up-front deal date account key after the deal date                            185064
      **  reversal                                                                            185064
      *                                                                                       185064
     C     UPREV         IFEQ      '1'
     C                   MOVEA     DTYP          AKY(1)
     C                   MOVE      'D'           AKY(3)
     C                   MOVEA     DLST          AKY(4)
     C                   MOVEA     '    F'       AKY(6)
     C                   MOVEA     UPPR2         AKY(9)
     C                   Z-ADD     KYAMT2        KYAMT
     C                   Z-ADD     UPVD2         KYDAT
      *                                                                                       185064
      ** Currency details and settlement account details.                                     185064
      *                                                                                       185064
     C/COPY WNCPYSRC,DL0280C086                                                               185064
     C     UPPR          IFEQ      'P'
     C/COPY WNCPYSRC,DL0280C087                                                               185064
     C                   MOVEL     UCUCY         KYCCY
     C                   MOVE      PSCY          KYSCY
     C/COPY WNCPYSRC,DL0280C088                                                               185064
     C                   Z-ADD     PSETM         KYSETL
     C                   MOVEL     UPACC         KYOSTL
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END
     C*                                                                                       185064
     C     UPPR          IFEQ      'R'
     C/COPY WNCPYSRC,DL0280C066                                                               185064
     C                   MOVEL     TCUCY         KYCCY
     C                   MOVE      RSCY          KYSCY
     C/COPY WNCPYSRC,DL0280C067                                                               185064
     C                   Z-ADD     RSETM         KYSETL
     C                   MOVEL     URACC         KYOSTL
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END
     C                   MOVE      ' '           UPREV
      *                                                                                       185064
      ** Write account key for Up-Front Fee/Premium                                           185064
      *                                                                                       185064
     C                   EXSR      EXCP
     C                   END
      *                                                                                       185064
     C     RECR          IFNE      'D'
     C                   MOVE      '0'           *IN90
     C                   MOVE      DLNO          DDLNO             6 0
     C     DDLNO         CHAIN     DLDGUPL1                           90
     C     *IN90         IFEQ      '0'
     C                   DELETE    DLDGUPL1
     C                   END
     C                   END
      *                                                                                       185064
     C                   END
     C                   END
     C                   ENDSR
     C/EJECT                                                              S01119
2877 C********************************************************************S01119
     C* S/R IRSAMD                                                        S01119
     C* CALLED FROM RSSUBR, RXSUBR, RLSUBR                                S01119
     C* CALLS ZFREQ ,DLBACK                                               S01119
     C*                                                                   S01119
     C**TO*PROCESS*DEAL*AMENDMENTS*FOR*RS,*RX,*RL*NON-AVE*         S01119 S01157
     C* TO PROCESS DEAL AMENDMENTS FOR RS, RX, RR/RP/RF NON-AVE           S01157
     C*                                                                   S01119
2877 C********************************************************************S01119
     C*                                                                   S01119
     C     IRSAMD        BEGSR                                                  ** IRSAMD **** S0111
     C*                                                                   S01119
     C* OURS/THEIRS                                                       S01119
     C*                                                                   S01119
     C     DTLUT         IFEQ      'U'                                                         S0111
     C                   Z-ADD     UBRTT         WBRTT             2 0                         S0111
     C                   Z-ADD     UNICD         WNICD             5 0                         S0111
     C                   Z-ADD     UINFD         WINFD             5 0                         S0111
     C                   Z-ADD     UICBD         WICBD             5 0                         S0111
     C                   MOVE      UICFR         WICFR             1                           S0111
     C                   MOVE      UCUCY         WCUCY             3                           S0111
     C                   Z-ADD     UICFD         WICFD             5 0                         S0111
     C                   Z-ADD     UEINR         WEINR            11 7                         S0111
     C                   MOVE      USPIN         WSPIN             1                           S0111
     C                   Z-ADD     URTSP         WRTSP            11 7                         S0111
     C                   Z-ADD     UBRTE         WBRTE            11 7                         S0111
     C                   MOVE      UDNSI         WDNSI             1                           S0111
     C                   Z-ADD     ULPCD         WLPCD             5 0                         S0111
     C                   Z-ADD     UFRFD         WFRFD             2 0                         S0111
      * Original Base Rate                                                CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C                   Z-ADD     UOBRT         WOBRT            11 7                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TFRFD         WFRFD             2 0                         S0111
     C                   Z-ADD     TBRTT         WBRTT             2 0                         S0111
     C                   Z-ADD     TNICD         WNICD             5 0                         S0111
     C                   Z-ADD     TINFD         WINFD             5 0                         S0111
     C                   Z-ADD     TICBD         WICBD             5 0                         S0111
     C                   MOVE      TICFR         WICFR             1                           S0111
     C                   MOVE      TCUCY         WCUCY             3                           S0111
     C                   Z-ADD     TICFD         WICFD             5 0                         S0111
     C                   Z-ADD     TEINR         WEINR            11 7                         S0111
     C                   MOVE      TSPIN         WSPIN             1                           S0111
     C                   Z-ADD     TRTSP         WRTSP            11 7                         S0111
     C                   Z-ADD     TBRTE         WBRTE            11 7                         S0111
     C                   MOVE      TDNSI         WDNSI             1                           S0111
     C                   Z-ADD     TLPCD         WLPCD             5 0                         S0111
      * Original Base Rate                                                CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C                   Z-ADD     TOBRT         WOBRT            11 7                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C                   END                                                                   S0111
      *                                                                   CIR005
     C     CIR005        IFEQ      'Y'                                                         CIR00
     C     DTYP          IFEQ      'RX'                                                        CIR00
     C     DTLUT         ANDEQ     'T'                                                         CIR00
     C                   MOVEL     L2PDCN        WPDCN             2                           CIR00
     C                   MOVEL     CCYPY2        WCCYPY                                        CIR00
     C                   MOVEL     CCYRT2        WCCYRT                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVEL     L1PDCN        WPDCN                                         CIR00
     C                   MOVEL     CCYPY1        WCCYPY                                        CIR00
     C                   MOVEL     CCYRT1        WCCYRT                                        CIR00
     C                   ENDIF                                                                 CIR00
     C     CIR017        IFEQ      'Y'                                                        CIR017
     C     DTYP          ANDEQ     'RS'                                                       CIR017
     C     DTLUT         ANDEQ     'T'                                                        CIR017
     C                   MOVEL     L2PDCN        WPDCN                                        CIR017
     C                   MOVEL     CCYPY2        WCCYPY                                       CIR017
     C                   MOVEL     CCYRT2        WCCYRT                                       CIR017
     C                   ENDIF                                                                CIR017
     C                   ENDIF                                                                 CIR00
      *                                                                   CSW005
      ** Set Original Base Rate to Base Rate just fixed (w/o Spread)      CSW005
      ** If the ff. conditions are true:                                  CSW005
      **    - CSW005 is switched on (CSW005='Y')                          CSW005
      **    - The initial rate for this side has not been set             CSW005
      **        (BIT 0 of non-static indicators is OFF)  (*IN31='1')      CSW005
      **    - Original Base Rate is ZERO  (WOBRT = *ZERO)                 CSW005
      *                                                                   CSW005
     C                   TESTB     '0'           WDNSI                    31                   CSW00
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     *IN31         ANDEQ     '0'                                                         CSW00
     C     WOBRT         ANDEQ     *ZERO                                                       CSW00
     C                   Z-ADD     WBRTE         WOBRT                                         CSW00
     C                   ENDIF                                                                 CSW00
     C*                                                                   S01119
     C                   Z-ADD     RTSPDM        WBRTE                                         S0111
     C*                                                                   S01119
     C*  IF INITIAL RATE SET BIT ON,ONLY UPDATE BASE RATE                 S01119
     C*  CALCULATE NEXT RATE FIX BY DETERMINING NEXT CHANGE DATE          S01119
     C*                                                                   S01119
     C                   TESTB     '0'           WDNSI                    31                   S0111
     C     *IN31         IFEQ      '1'                                                         S0111
     C     WNICD         ANDNE     0                                                           S0111
     C     WICFR         ANDNE     ' '                                                         S0111
     C                   Z-ADD     WICBD         ZDAYNO                                        S0111
     C                   MOVE      WICFR         ZFREQ                                         S0111
     C                   MOVE      WCUCY         ZCCY                                          S0111
     C                   Z-ADD     WICFD         ZMDAY                                         S0111
     C                   MOVE      BJSLCD        ZLOC                                          S0119
      *                                                                   CIR005
     C     CIR005        IFEQ      'N'                                                         CIR00
     C     WCYP1         OREQ      *BLANKS                                                     CIR00
     C     CIR001        OREQ      'Y'                                                         CIR00
     C     ZFREQ         ANDEQ     'Z'                                                         CIR00
      *                                                                   CIR005
     C     CIR001        IFNE      'Y'                                                         CIR00
     C                   EXSR      ZFREQC                                                      S0119
      *                                                                   096447
      **  When Next Rate Fix Date is equal to Current Rate Change         096447
      **  Date, compute the Next Rate Change Date as the basis            096447
      **  for Next Rate Fix Date.                                         096447
      *                                                                   096447
     C     WINFD         IFEQ      WNICD                                                       09644
     C     WFRFD         ANDNE     0                                                           09644
     C                   Z-ADD     ZDAYNO        ZDAYNO                                        09644
     C                   MOVE      WICFR         ZFREQ                                         09644
     C                   MOVE      WCUCY         ZCCY                                          09644
     C                   Z-ADD     WICFD         ZMDAY                                         09644
     C                   MOVE      BJSLCD        ZLOC                                          09644
     C                   EXSR      ZFREQC                                                      09644
     C                   END                                                                   09644
      *                                                                   096447
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C** IF FREQ.IS NOT 'Z' FOR DATE SCHEDULE USE ZFREQB TO CALC NEXT  TE CIR001
     C** DATE                                                             CIR001
     C*                                                                   CIR001
     C     ZFREQ         IFNE      'Z'                                                         CIR00
      *                                                                                     BUG5771R
      ** If Value Date had not yet been reached and rate is already                         BUG5771R
      ** fixed, calculate the next rate fix date using the current                          BUG5771R
      ** rate change date.                                                                  BUG5771R
      *                                                                                     BUG5771R
     C     VDAT          IFGE      BJRDNB                                                   BUG5771R
     C     WINFD         ANDLE     VDAT                                                     BUG5771R
     C                   Z-ADD     WNICD         ZDAYNO                                     BUG5771R
     C                   ELSE                                                               BUG5771R
     C                   EXSR      ZFREQC                                                      CIR00
     C                   Z-ADD     0             ZNRDYS                                        CIR00
     C                   MOVE      BJSLCD        ZLOC                                          CIR00
     C                   EXSR      ZFWDT                                                       CIR00
     C                   ENDIF                                                              BUG5771R
     C*                                                                   CIR001
     C** IF FREQUENCY IS 'Z' DETERMINE NEXT DATE FROM DATE SCHEDULE FILE  CIR001
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
      *                                                                                     BUG5771R
      ** If Value Date had not yet been reached and rate is already                         BUG5771R
      ** fixed, calculate the next rate fix date using the current                          BUG5771R
      ** rate change date.                                                                  BUG5771R
      *                                                                                     BUG5771R
     C     VDAT          IFGE      BJRDNB                                                   BUG5771R
     C     WINFD         ANDLE     VDAT                                                     BUG5771R
     C                   Z-ADD     WNICD         ZDAYNO                                     BUG5771R
     C                   ELSE                                                               BUG5771R
     C                   MOVEL     DTLUT         OTIN                           * OURS/THEIRS  CIR00
     C                   MOVEL     'R'           RCIP                           * RATE CHANGE  CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   ENDIF                                                              BUG5771R
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
      *                                                                   CIR005
     C                   ELSE                                                                  CIR00
     C                   EXSR      ZFRQB3                                                      CIR00
      *                                                                   CIR005
     C                   CALL      'DLZIRP'                                                    CIR00
     C                   PARM                    ZDAYNO                                        CIR00
     C                   PARM      WCCYPY        PCURR                                         CIR00
     C                   PARM      WPDCN         PPDCN                                         CIR00
     C                   PARM                    ZLOC                                          CIR00
     C                   PARM                    BJDFIN                                        CIR00
     C                   PARM      *ZEROS        PAJDT                                         CIR00
     C                   PARM      *ZEROS        PBSDT                                         CIR00
     C                   Z-ADD     PAJDT         ZDAYNO                                        CIR00
      *                                                                   CIR005
      ** Do not return adjusted date if it is equal to or earlier than    CIR005
      ** previous date (only happens for 'previous' date calculations);   CIR005
      ** instead use the base date                                        CIR005
      *                                                                   CIR005
     C     WICBD         IFGE      ZDAYNO                                                      CIR00
     C                   Z-ADD     PBSDT         ZDAYNO                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   039124
     C** If next rate change date is greater than or equal to             039124
     C** maturity date then no more rate fix processing required          039124
     C*                                                                   039124
     C     ZDAYNO        IFGE      MDAT                                                        03912
     C                   Z-ADD     *ZERO         WINFD                                         03912
     C                   ELSE                                                                  03912
      *                                                                   CIR005
     C     CIR005        IFEQ      'N'                                                         CIR00
     C     WCYR1         OREQ      *BLANKS                                                     CIR00
      *                                                                   CIR005
     C                   Z-ADD     ZDAYNO        ZINDT                                         S0111
      *                                                                   108624
      ** If 'currency for rate fix holiday' flag from FRA/IRS I.C.D.      108624
      ** is 'F', 'L' or 'D', set currency code to 'sterling code',        108624
      ** 'local currency code' or 'screen currency code' respectively     108624
      *                                                                   108624
     C     BQCRFH        IFEQ      'F'                                                         10862
     C                   MOVE      BLCYCD        ZCCY                                          10862
     C                   ENDIF                                                                 10862
      *                                                                   108624
     C     BQCRFH        IFEQ      'L'                                                         10862
     C                   MOVE      BJLCCY        ZCCY                                          10862
     C                   ENDIF                                                                 10862
      *                                                                   108624
     C     BQCRFH        IFEQ      'D'                                                         10862
     C     BQCRFH        OREQ      ' '                                                         10862
     C                   MOVE      WCUCY         ZCCY                                          S0111
     C                   ENDIF                                                                 10862
     C*                                                                   108624
     C                   Z-ADD     WFRFD         ZRFDY                                         S0111
     C                   EXSR      DLBACK                                                      S0111
      *                                                                   CIR005
     C                   ELSE                                                                  CIR00
     C                   CALL      IRRTFX                                                      CIR00
     C                   PARM                    ZDAYNO                                        CIR00
     C                   PARM      WFRFD         PRFDY             2 0                         CIR00
     C                   PARM      BJSLCD        ZLOC                                          CIR00
     C                   PARM      WCCYRT        PCURR                                         CIR00
     C                   PARM      *ZEROS        PRFXD             5 0                         CIR00
     C                   Z-ADD     PRFXD         ZRFDT                                         CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   S01119
     C*  IF DATE IS LESS THAN ORIGINAL CHANGE DATE SET TO DNWD            S01119
     C*  IF DATE AFTER MATURITY IT SHOULD BE ZEROISED                     S01119
     C*                                                                   S01119
     C     ZRFDT         IFLE      WICBD                                                       S0111
      *                                                                                     BUG5771R
      ** If initial rate set, and value date had not yet been                               BUG5771R
      ** reached, next rate fix date can be equal to the original                           BUG5771R
      ** rate change date.                                                                  BUG5771R
      *                                                                                     BUG5771R
     C     VDAT          IFGE      BJRDNB                                                   BUG5771R
     C     WINFD         ANDLE     VDAT                                                     BUG5771R
     C                   Z-ADD     ZRFDT         WINFD                                      BUG5771R
     C                   ELSE                                                               BUG5771R
     C                   Z-ADD     BJDNWD        WINFD                                         S0119
     C                   ENDIF                                                              BUG5771R
     C                   ELSE                                                                  S0111
     C                   Z-ADD     ZRFDT         WINFD                                         S0111
     C                   END                                                                   S0111
     C     WINFD         IFGT      MDAT                                                        S0111
     C                   Z-ADD     0             WINFD                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   03912
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     *IN31         IFEQ      '0'                                                         S0111
     C     WEINR         ANDEQ     0                                                           S0111
     C*                                                                   S01119
     C*  IF INITIAL RATE SET BIT OFF,UPDATE BASE RATE                     S01119
     C*  AND EFFECTIVE INTEREST RATE BY APPLYING SPREAD                   S01119
     C*                                                                   S01119
     C     WSPIN         IFEQ      'A'                                                         S0111
     C     WRTSP         ADD       WBRTE         WEINR                                         S0111
     C                   END                                                                   S0111
     C     WSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     WBRTE         WEINR                                         S0111
     C                   END                                                                   S0111
     C     WSPIN         IFEQ      'S'                                                         S0111
     C     WBRTE         SUB       WRTSP         WEINR                                         S0111
     C                   END                                                                   S0111
     C     WSPIN         IFEQ      'P'                                                         S0111
     C     WRTSP         MULT      WBRTE         EINR                                          S0111
     C     EINR          DIV(H)    100           WEINR                                         S0111
     C                   ADD       WBRTE         WEINR                                         S0111
     C                   END                                                                   S0111
     C*  CALCULATE NEXT RATE FIX USING NEXT CHANGE DATE ON FILE           S01119
     C     WICBD         IFNE      0                                                           S0111
      *                                                                   CIR005
     C     CIR005        IFEQ      'N'                                                         CIR00
     C     WCYR1         OREQ      *BLANKS                                                     CIR00
      *                                                                   CIR005
     C                   Z-ADD     WICBD         ZINDT                                         S0111
      *                                                                   108624
      ** If 'currency for rate fix holiday' flag from FRA/IRS I.C.D.      108624
      ** is 'F', 'L' or 'D', set currency code to 'sterling code',        108624
      ** 'local currency code' or 'screen currency code' respectively     108624
      *                                                                   108624
     C     BQCRFH        IFEQ      'F'                                                         10862
     C                   MOVE      BLCYCD        ZCCY                                          10862
     C                   ENDIF                                                                 10862
      *                                                                   108624
     C     BQCRFH        IFEQ      'L'                                                         10862
     C                   MOVE      BJLCCY        ZCCY                                          10862
     C                   ENDIF                                                                 10862
      *                                                                   108624
     C     BQCRFH        IFEQ      'D'                                                         10862
     C     BQCRFH        OREQ      ' '                                                         10862
     C                   MOVE      WCUCY         ZCCY                                          S0111
     C                   ENDIF                                                                 10862
     C*                                                                   108624
     C                   Z-ADD     WFRFD         ZRFDY                                         S0111
      /COPY WNCPYSRC,DL0280C213                                           S01408
     C                   EXSR      DLBACK                                                      S0111
      *                                                                   CIR005
     C                   ELSE                                                                  CIR00
     C                   CALL      IRRTFX                                                      CIR00
     C                   PARM                    WICBD                                         CIR00
     C                   PARM      WFRFD         PRFDY                                         CIR00
     C                   PARM      BJSLCD        ZLOC                                          CIR00
     C                   PARM      WCCYRT        PCURR                                         CIR00
     C                   PARM      *ZEROS        PRFXD                                         CIR00
     C                   Z-ADD     PRFXD         ZRFDT                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR005
     C*  IF DATE AFTER MATURITY IT SHOULD BE ZEROISED                     S01119
     C     ZRFDT         IFGT      MDAT                                                        S0111
     C                   Z-ADD     0             WINFD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     ZRFDT         WINFD                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*  IF DATE BEFORE VALUE DATE,SET TO LATER OF VALUE DATE & DNWD      S01119
     C     ZRFDT         IFLT      VDAT                                                        S0111
     C     VDAT          IFLT      BJDNWD                                                      S0119
     C                   Z-ADD     BJDNWD        WINFD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     VDAT          WINFD                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C                   BITON     '0'           WDNSI                                         S0111
     C                   Z-ADD     VDAT          WLPCD                                         S0111
     C                   END                                                                   S0111
     C*                                                                   027266
     C** If the Change Base Date is blank then there are no more Fix      027266
     C** Dates; if the Frequency is blank then only if the rate has       027266
     C** already been set at least once will there be no more Fix         027266
     C** Dates. (ie. if the rate has not yet been fixed then there may    027266
     C** be a single Rate Change Date entered (ie. no Frequency/Day       027266
     C** entered) which will need an associated Fix Date).                027266
     C*                                                                   027266
     C     WICBD         IFEQ      0                                                           S0111
     C     WICFR         OREQ      ' '                                                         S0111
     C     *IN31         ANDEQ     '1'                                                         02726
     C                   Z-ADD     0             WINFD                                         S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C407
     C*                                                                   S01119
     C****** UPDATES                                                      S01119
     C*                                                                   S01119
     C     DTLUT         IFEQ      'U'                                                         S0111
     C*                                                                   CSW005
     C     CIR018        IFEQ      'Y'                                                        CIR018
     C     ZFREQ         ANDEQ     'D'                                                        CIR018
     C     VDAT          ANDLT     BJRDNB                                                     CIR018
     C                   Z-ADD     UNICD         ZDAYNO                                       CIR018
     C                   Z-ADD     1             ZNRDYS                                       CIR018
     C                   MOVE      BJLCCY        ZCCY                                         CIR018
     C                   EXSR      ZFWDT                                                      CIR018
     C                   MOVE      ZDYNBR        UINFD                                        CIR018
     C                   ELSE                                                                 CIR018
     C                   Z-ADD     WINFD         UINFD                                         S0111
     C                   ENDIF                                                                CIR018
     C*                                                                   CSW005
     C     CSW005        IFEQ      'N'                                                         CSW00
     C     CSW011        ANDEQ     'N'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                         CSW00
     C     URFIN         ANDEQ     *BLANKS                                                     CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     URFIN         ANDEQ     *BLANKS                                                     CSW01
     C     CSW005        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'A'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     URFIN         ANDEQ     'A'                                                        227642
     C                   Z-ADD     WEINR         UEINR                                         S0111
     C                   Z-ADD     WBRTE         UBRTE                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     DTYP          IFEQ      'RS'
     C     DTYP          OREQ      'RX'
     C                   Z-ADD     WBRTE         FSUEFR
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS005
     C                   MOVE      WDNSI         UDNSI                                         S0111
     C                   Z-ADD     WOBRT         UOBRT                                         CSW00
     C                   ENDIF                                                                 CSW00
     C*                                                                   CSW005
     C                   Z-ADD     WLPCD         ULPCD                                         S0111
     C*                                                                   CSW005
     C                   ELSE                                                                  S0111
      *                                                                   CSW005
     C     CIR018        IFEQ      'Y'                                                        CIR018
     C     ZFREQ         ANDEQ     'D'                                                        CIR018
     C     VDAT          ANDLT     BJRDNB                                                     CIR018
     C                   Z-ADD     TNICD         ZDAYNO                                       CIR018
     C                   Z-ADD     1             ZNRDYS                                       CIR018
     C                   MOVE      BJLCCY        ZCCY                                         CIR018
     C                   EXSR      ZFWDT                                                      CIR018
     C                   MOVE      ZDYNBR        TINFD                                        CIR018
     C                   ELSE                                                                 CIR018
     C                   Z-ADD     WINFD         TINFD                                         S0111
     C                   ENDIF                                                                CIR018
      *                                                                   CSW005
     C     CSW005        IFEQ      'N'                                                         CSW00
     C     CSW011        ANDEQ     'N'                                                         CSW01
     C     CSW005        OREQ      'Y'                                                         CSW00
     C     TRFIN         ANDEQ     *BLANKS                                                     CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     TRFIN         ANDEQ     *BLANKS                                                     CSW01
     C     CSW005        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'A'                                                        227642
     C     CSW011        OREQ      'Y'                                                        227642
     C     TRFIN         ANDEQ     'A'                                                        227642
     C                   Z-ADD     WEINR         TEINR                                         S0111
     C                   Z-ADD     WBRTE         TBRTE                                         S0111
      *                                                                                       CAS005
     C     CAS005        IFEQ      'Y'
     C     DTYP          IFEQ      'RS'
     C     DTYP          OREQ      'RX'
     C                   Z-ADD     WBRTE         FSTEFR
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS005
     C                   MOVE      WDNSI         TDNSI                                         S0111
     C                   Z-ADD     WOBRT         TOBRT                                         CSW00
     C                   ENDIF                                                                 CSW00
      *                                                                   CSW005
     C                   Z-ADD     WLPCD         TLPCD                                         S0111
      *                                                                   CSW005
     C                   END                                                                   S0111
      *                                                                   CSW005
      * Set Our/Their Rate Fixing Indicator to 'X' if CSW005 = 'Y'        CSW005
     C     CSW005        IFEQ      'Y'                                                         CSW00
     C     CSW011        OREQ      'Y'                                                         CSW01
     C     DTLUT         IFEQ      'U'                                                         CSW00
     C                   MOVE      'X'           URFIN                                         CSW00
     C                   ELSE                                                                  CSW00
     C                   MOVE      'X'           TRFIN                                         CSW00
     C                   ENDIF                                                                 CSW00
     C                   ENDIF                                                                 CSW00
     C*                                                                   S01119
     C     IRSEND        ENDSR                                                                 S0111
2877 C********************************************************************S01119
     C/EJECT                                                              S01119
2877 C********************************************************************S01119
     C* S/R RLSUBR                                                        S01119
     C* CALLED FROM MAIN PROCESSING                                       S01119
     C* CALLS EXCP; EXCPTN                                                S01119
     C*                                                                   S01119
     C**TO*PROCESS*FRA/IRS*DEAL*TYPE*RL*                           S01119 S01157
     C* TO PROCESS FRA/IRS DEAL TYPES RR/RP/RF                            S01157
     C*                                                                   S01119
2877 C********************************************************************S01119
     C*                                                                   S01119
     C     RLSUBR        BEGSR                                                  ** RLSUBR **** S0111
     C*                                                                   S01119
     C* SET UP PROFIT CENTRE REGARDLESS OF EVENT TYPE                     LN0711
     C                   MOVEL     PRFC          OPPRFC                                        LN071
     C*                                                                   LN0711
     C*  BLANK FIELDS CONDITIONING PROCESSING                             S01119
     C                   MOVE      ' '           AVERRT            1                           S0111
     C                   MOVE      ' '           USRST             1                           S0111
     C                   MOVE      ' '           FLRRTF            1                           S0111
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C                   MOVE      'Y'           ULSDCR            1                           CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                                      BUG7724
      ** Save interest payment base dates as they will be used later in SR/DLRSIN            BUG7724
      *                                                                                      BUG7724
     C                   Z-ADD     TIPBD         WTPBD             5 0                       BUG7724
     C                   Z-ADD     UIPBD         WUPBD             5 0                       BUG7724
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C202                                           S01408
     C*                                                                   S01408
     C* FLOOR RATE                                                        S01119
     C                   TESTB     '4'           UDSTI                    31                   S0111
     C   31              MOVE      'Y'           FLRRTF                                        S0111
     C                   TESTB     '4'           TDSTI                    31                   S0111
     C   31              MOVE      'Y'           FLRRTF                                        S0111
     C* STATUS OF USER/AVERAGE RATE : USER HAS NON-ZERO BASE RATE         S01119
     C     UBRTT         IFNE      0                                                           S0111
     C                   TESTB     '3'           UDSTI                    31                   S0111
     C   31              MOVE      'Y'           AVERRT                                        S0111
     C                   MOVE      'P'           USRST                                         S0111
     C                   ELSE                                                                  S0111
     C                   TESTB     '3'           TDSTI                    31                   S0111
     C   31              MOVE      'Y'           AVERRT                                        S0111
     C                   MOVE      'T'           USRST                                         S0111
     C                   END                                                                   S0111
      *                                                                   CIR006
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C     BOVD          IFLE      EVCD                                                        CIR00
     C     BOVD          ANDNE     0                                                           CIR00
     C     UNIPD         IFEQ      0                                                           CIR00
     C     USRST         ANDEQ     'P'                                                         CIR00
     C                   Z-ADD     MDAT          UNIPD                                         CIR00
     C                   ENDIF                                                                 CIR00
     C     TNIPD         IFEQ      0                                                           CIR00
     C     USRST         ANDEQ     'T'                                                         CIR00
     C                   Z-ADD     MDAT          TNIPD                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   Z-ADD     BOVD          MDAT                                          CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   S01119
     C*  SHADOW POST - ONLY PAY DATES REQUIRED, UNLESS AVERAGE RATE       S01119
     C*                                                                   S01119
     C     *INU1         IFEQ      '0'                                                         S0111
     C     AVERRT        CABEQ     'Y'           RLSEND                                        S0111
     C                   GOTO      RLDATX                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  NON-SHADOW POST PROCESSING                                       S01119
     C*                                                                   S01119
     C     AVERRT        IFEQ      'Y'                                          B              S0111
     C     USRST         IFEQ      'P'                                          * B            S0111
     C*  OUR AVERAGE RATE PROCESSING-SETUP WORK FIELDS                    S01119
     C                   Z-ADD     UEINR         WEINR                          * *            S0111
     C                   Z-ADD     UBRTE         WBRTE                          * *            S0111
     C                   Z-ADD     URTSP         WRTSP                          * *            S0111
     C                   Z-ADD     UINFD         WINFD                          * *            S0111
     C                   MOVE      UDNSI         WDNSI                          * *            S0111
     C                   MOVE      USPIN         WSPIN                          * *            S0111
     C                   ELSE                                                   * X            S0111
     C*  THEIR AVERAGE RATE PROCESSING-SETUP WORK FIELDS                  S01119
     C                   Z-ADD     TEINR         WEINR                          * *            S0111
     C                   Z-ADD     TBRTE         WBRTE                          * *            S0111
     C                   Z-ADD     TRTSP         WRTSP                          * *            S0111
     C                   Z-ADD     TINFD         WINFD                          * *            S0111
     C                   MOVE      TDNSI         WDNSI                          * *            S0111
     C                   MOVE      TSPIN         WSPIN                          * *            S0111
     C                   END                                                    * E            S0111
     C*                                                                   S01119
     C*  DECIDE TYPE OF PROCESSING DEPENDANT ON WHETHER AMEND AACRT ON    S01119
     C*                                                                   S01119
     C                   TESTB     '1'           WDNSI                    31    *              S0111
     C     *IN31         IFEQ      '1'                                          * B            S0111
     C*                                                                   S01119
     C* ACTUAL AVERAGE CALCULATED RATE AMENDED - AMEND TOTAL FIELDS       S01119
     C*  UP TO TODAY                                                      S01119
     C     BJRDNB        SUB       WINFD         WK5               5 0          * *            S0119
     C                   ADD       WK5           AVPER                          * *            S0111
     C     AACRT         MULT      AVPER         TIRAT                          * *            S0111
     C                   Z-ADD     BJRDNB        WINFD                          * *            S0119
     C*                                                                   S01119
     C* APPLY SPREAD                                                      S01119
     C*                                                                   S01119
     C     WSPIN         IFEQ      'A'                                          * * B          S0111
     C     WBRTE         ADD       WRTSP         WEINR                          * * *          S0111
     C                   END                                                    * * E          S0111
     C     WSPIN         IFEQ      ' '                                          * * B          S0111
     C                   Z-ADD     WBRTE         WEINR                          * * *          S0111
     C                   END                                                    * * E          S0111
     C     WSPIN         IFEQ      'S'                                          * * B          S0111
     C     WBRTE         SUB       WRTSP         WEINR                          * * *          S0111
     C                   END                                                    * * E          S0111
     C     WSPIN         IFEQ      'P'                                          * * B          S0111
     C     WBRTE         DIV       100           EINR             13 9          * * *          S0111
     C     EINR          MULT(H)   WRTSP         WEINR                          * * *          S0111
     C                   ADD       WBRTE         WEINR                          * * *          S0111
     C                   END                                                    * * E          S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C* UPDATE EFFECTIVE INTEREST RATE IN LINE WITH SPREAD CHANGE         S01119
     C*                                                                   S01119
     C                   ELSE                                                   * X            S0111
     C*                                                                   S01119
     C* DO NOT READJUST EFFECTIVE INTEREST RATE IF A BACK-VALUED DEAL     S01119
     C* AMENDMENT EXISTS, OR IF INITIAL RATE HAS NOT YET BEEN SET         S01119
     C*                                                                   S01119
     C                   TESTB     '0'           WDNSI                    31    * *            S0111
     C     *IN41         IFEQ      '1'                                          * * *          S0111
     C     VDATDM        ANDLT     BJRDNB                                       * * *          S0119
     C     *IN31         OREQ      '0'                                          * * B          S0111
     C                   GOTO      RLDDAT                                       * * *          S0111
     C                   END                                                    * * E          S0111
     C*                                                                   S01119
     C* APPLY SPREAD TO BASE RATE TO CHECK IF SPREAD HAS BEEN CHANGED     S01119
     C*                                                                   S01119
     C     WSPIN         IFEQ      'A'                                          * * B          S0111
     C     WBRTE         ADD       WRTSP         EINR                           * * *          S0111
     C                   END                                                    * * E          S0111
     C     WSPIN         IFEQ      ' '                                          * * B          S0111
     C                   Z-ADD     WBRTE         EINR                           * * *          S0111
     C                   END                                                    * * E          S0111
     C     WSPIN         IFEQ      'S'                                          * * B          S0111
     C     WBRTE         SUB       WRTSP         EINR                           * * *          S0111
     C                   END                                                    * * E          S0111
     C     WSPIN         IFEQ      'P'                                          * * B          S0111
     C     WBRTE         DIV       100           EINR             13 9          * * *          S0111
     C     EINR          MULT(H)   WRTSP         WK139            13 9          * * *          S0111
     C     WK139         ADD       WBRTE         EINR                           * * *          S0111
     C                   END                                                    * * E          S0111
     C*                                                                   S01119
     C* IF RESULTANT RATE IS NOT CURRENT RATE, UPDATE CURRENT RATE FIELDS S01119
     C*                                                                   S01119
     C     EINR          IFNE      WEINR                                        * * B          S0111
     C     BJRDNB        SUB       WINFD         WK5               5 0          * * *          S0119
     C                   ADD       WK5           AVPER                          * * *          S0111
     C     WK5           MULT      WEINR         WK158            15 8          * * *          S0111
     C                   ADD       WK158         TIRAT                          * * *          S0111
     C                   Z-ADD     BJRDNB        WINFD                          * * *          S0119
     C                   Z-ADD     EINR          WEINR                          * * *          S0111
     C**  SET DEALS FILE UPDATE INDICATOR                  * * *          S01119
     C                   MOVE      '1'           *IN15                          * * *          S0111
     C                   END                                                    * * E          S0111
     C                   END                                                    * E            S0111
     C*                                                                   S01119
     C* UPDATE RESPECTIVE FIELDS                                          S01119
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                          * B            S0111
     C                   Z-ADD     WEINR         UEINR                          * *            S0111
     C                   Z-ADD     WINFD         UINFD                          * *            S0111
     C                   ELSE                                                   * X            S0111
     C                   Z-ADD     WEINR         TEINR                          * *            S0111
     C                   Z-ADD     WINFD         TINFD                          * *            S0111
     C                   END                                                    * E            S0111
     C*                                                                   S01119
     C* NON-AVERAGE RATE PROCESSING                                       S01119
     C*                                                                   S01119
     C                   ELSE                                                   X NON-AVE      S0111
     C*                                                                   S01119
     C* USER IS PROVIDER - OUR SHORT TERM RATE TO BE TESTED               S01119
     C*                                                                   S01119
     C                   TESTB     '2'           UDNSI                    31                   S0111
     C     USRST         IFEQ      'P'                                                         S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
     C     VDAT          ANDLT     BJRDNB                                                      S0119
     C*                                                                   S01119
     C* REIMBURSEMENT/TOPPING UP RATE PROCESSING                          S01119
     C*                                                                   S01119
     C     UEINR         SUB       CLRAT         REIMRT           11 7  31                     S0111
     C   31              Z-ADD     0             REIMRT                                        S0111
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C     FLRAT         SUB       UEINR         TPUPRT           11 7  31                     S0111
     C   31              Z-ADD     0             TPUPRT                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* AMEND ACCRUAL PROCESSING                                          S01119
     C*                                                                   S01119
     C* USE REIMBURSEMENT RATE FOR USER(PROVIDER)                         E23400
     C                   Z-ADD     ULPCD         ZIBEG                                         S0111
     C                   Z-ADD     BJRDNB        ZIEND                                         S0119
     C                   Z-ADD     UPAMT         ZIAMT                                         S0111
     C                   Z-ADD     REIMRT        ZIRATE                                        S0111
     C                   Z-ADD     UICBS         ZICALC                                        S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add our unsettled interest and         CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP58                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP59                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   CIR002
     C** Maintain the unsettled interest amount as well.                  CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         OUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C*                                                                   066550
     C*  REMOVE OLD ACCRUAL AMOUNT AND ADD NEW AMOUNT IF PREVIOUS         S01119
     C*  SHORT TERM RATE HAS BEEN ENTERED I.E. IF IACD NE LPCD            S01119
     C*  RESET ACCRUAL SINCE LAST CHANGE AND INT.ACCRUAL CONTROL DATE     S01119
     C     UIACD         IFNE      ULPCD                                                       S0111
     C     UAITC         SUB       UIALC         UAITC                                         S0111
     C                   END                                                                   S0111
     C                   ADD       WKINT         UAITC                                         S0111
     C                   Z-ADD     WKINT         UIALC                                         S0111
     C                   Z-ADD     BJRDNB        UIACD                                         S0119
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C* NOT NEG INT - USE TOPPING UP RATE FOR C'PARTY(TAKER)              S01119
     C                   Z-ADD     ULPCD         ZIBEG                                         09460
     C                   Z-ADD     BJRDNB        ZIEND                                         S0119
     C                   Z-ADD     UPAMT         ZIAMT                                         09460
     C                   Z-ADD     TPUPRT        ZIRATE                                        S0111
     C                   Z-ADD     UICBS         ZICALC                                        09460
     C*                                                                   CIR002
     C** If CIR002 is switched on, add our unsettled interest and         CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
      *                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP60                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP61                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   CIR002
     C** Add the interest amount computed to their unsettled interest     CIR002
     C** amount.                                                          CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         TUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   066550
     C*  REMOVE OLD ACCRUAL AMOUNT AND ADD NEW AMOUNT IF PREVIOUS         S01119
     C*  SHORT TERM RATE HAS BEEN ENTERED I.E. IF IACD NE LPCD            S01119
     C*  RESET ACCRUAL SINCE LAST CHANGE AND INT.ACCRUAL CONTROL DATE     S01119
     C     TIACD         IFNE      TLPCD                                                       S0111
     C     TAITC         SUB       TIALC         TAITC                                         S0111
     C                   END                                                                   S0111
     C                   ADD       WKINT         TAITC                                         S0111
     C                   Z-ADD     WKINT         TIALC                                         S0111
     C                   Z-ADD     BJRDNB        TIACD                                         S0119
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* USER IS TAKER - THEIR SHORT TERM RATE TO BE TESTED                S01119
     C*                                                                   S01119
     C                   TESTB     '2'           TDNSI                    31                   S0111
     C     USRST         IFEQ      'T'                                                         S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
     C     VDAT          ANDLT     BJRDNB                                                      S0119
     C* CALCULATE SETTLEMENT RATE(S)                                      S01119
     C     TEINR         SUB       CLRAT         REIMRT           11 7  31                     S0111
     C   31              Z-ADD     0             REIMRT                                        S0111
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C     FLRAT         SUB       TEINR         TPUPRT           11 7  31                     S0111
     C   31              Z-ADD     0             TPUPRT                                        S0111
     C                   END                                                                   S0111
     C* USE REIMBURSEMENT RATE FOR C'PARTY(PROVIDER)                      E23400
     C                   Z-ADD     TLPCD         ZIBEG                                         S0111
     C                   Z-ADD     BJRDNB        ZIEND                                         S0119
     C                   Z-ADD     TPAMT         ZIAMT                                         S0111
     C                   Z-ADD     REIMRT        ZIRATE                                        S0111
     C                   Z-ADD     TICBS         ZICALC                                        S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add their unsettled interest and       CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP62                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP63                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   CIR002
     C** Add the interest amount computed to their unsettled interest     CIR002
     C** amount.                                                          CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         TUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   066550
     C*  REMOVE OLD ACCRUAL AMOUNT AND ADD NEW AMOUNT IF PREVIOUS         S01119
     C*  SHORT TERM RATE HAS BEEN ENTERED I.E. IF IACD NE LPCD            S01119
     C*  RESET ACCRUAL SINCE LAST CHANGE AND INT.ACCRUAL CONTROL DATE     S01119
     C     TIACD         IFNE      TLPCD                                                       S0111
     C     TAITC         SUB       TIALC         TAITC                                         S0111
     C                   END                                                                   S0111
     C                   ADD       WKINT         TAITC                                         S0111
     C                   Z-ADD     WKINT         TIALC                                         S0111
     C                   Z-ADD     BJRDNB        TIACD                                         S0119
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C* NOT NEG INT - USE TOPPING UP RATE FOR USER(TAKER)                 S01119
     C                   Z-ADD     TLPCD         ZIBEG                                         09460
     C                   Z-ADD     BJRDNB        ZIEND                                         S0119
     C                   Z-ADD     TPAMT         ZIAMT                                         09460
     C                   Z-ADD     TPUPRT        ZIRATE                                        S0111
     C                   Z-ADD     TICBS         ZICALC                                        09460
     C*                                                                   CIR002
     C** If CIR002 is switched on, add their unsettled interest and       CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP64                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP65                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   CIR002
     C** Add the interest amount computed to our unsettled interest       CIR002
     C** amount.                                                          CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         OUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   066550
     C*  REMOVE OLD ACCRUAL AMOUNT AND ADD NEW AMOUNT IF PREVIOUS         S01119
     C*  SHORT TERM RATE HAS BEEN ENTERED I.E. IF IACD NE LPCD            S01119
     C*  RESET ACCRUAL SINCE LAST CHANGE AND INT.ACCRUAL CONTROL DATE     S01119
     C     UIACD         IFNE      ULPCD                                                       S0111
     C     UAITC         SUB       UIALC         UAITC                                         S0111
     C                   END                                                                   S0111
     C                   ADD       WKINT         UAITC                                         S0111
     C                   Z-ADD     WKINT         UIALC                                         S0111
     C                   Z-ADD     BJRDNB        UIACD                                         S0119
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C* END OF DAILY PROCESSING- CHECK EVENT DATES                        S01119
     C*                                                                   S01119
     C*****   DEAL DATE                                                   S01119
     C*                                                                   S01119
     C     RLDDAT        TAG                                                    ** RLDDAT TAG**S0111
     C                   TESTB     '0'           ACEI                 31                       S0111
     C                   MOVE      *IN31         W#DDAT            1                         BUG7726
     C     DDAT          IFLE      EVCD                                                        S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
     C                   Z-ADD     DDAT          KYDAT                                         S0111
     C                   Z-ADD     DDAT          KYFED                                         S0111
     C*                                                                   S01119
     C*****   PRINCIPAL KEY                                               S01119
     C*                                                                   S01119
     C                   MOVEA     'RLD'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    A'       AKY(6)                                        S0111
     C                   MOVEL     NEV(1)        NARREV                                        06014
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C                   Z-ADD     UPAMT         NRRPUR                                        S0111
     C*                                                                   S01119
     C* PRINT LINE                                                        S01119
     C*                                                                   S01119
     C*  SET UP INDICATOR TO PRINT TAX AMOUNT                             S01119
     C                   SETOFF                                       33                       S0111
     C     USRST         IFEQ      'P'                                                         S0111
     C     TAXI          COMP      'Y'                                    33                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     CLRAT         NRRT                                          S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETON                                        71                       S0111
     C*                                                                   E22910
     C** IF FLOOR SET ON *IN31 TO SUPPRESS CEILING RATE                   E22910
     C*                                                                   E22910
     C     DTYP          IFEQ      'RF'                                                        E2291
     C                   SETON                                        31                       E2291
     C                   ELSE                                                                  E2291
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   E2291
     C*                                                                   E22910
     C                   MOVE      'Y'           PRONLY                                        S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C                   Z-ADD     UEINR         NRRT                                          S0111
     C                   MOVE      UBRTT         NRBRTT                                        S0111
     C                   ELSE                                                                  S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C                   Z-ADD     TEINR         NRRT                                          S0111
     C                   MOVE      TBRTT         NRBRTT                                        S0111
     C                   END                                                                   S0111
     C* IF AVERAGE RATE, 1) IF DEAL BACKVALUED, PRINT THE                 S01119
     C*                      ACTUAL AVERAGE CALCULATED RATE               S01119
     C*                  2) OTHERWISE DO NOT PRINT THE RATE FIELD         S01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C     VDAT          IFLT      BJRDNB                                                      S0119
     C                   Z-ADD     AACRT         NRRT                                          S0111
     C                   SETOFF                                       31                       S0111
     C                   ELSE                                                                  S0111
     C                   SETON                                        31                       S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C*  PRINT FLOOR IF REQUIRED                                          S01119
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C*                                                                   S01119
     C*  SET UP INDICATOR TO PRINT TAX AMOUNT                             S01119
     C                   SETOFF                                       33                       S0111
     C     USRST         IFEQ      'T'                                                         E2340
     C     TAXI          COMP      'Y'                                    33                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   EXCEPT    FLOOR                                                       S0111
     C                   ADD       1             PLINES                                        LN088
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*****   EXPOSURE KEY                                                S01119
     C*                                                                   S01119
     C                   MOVE      DTYP          RRDT                                          S0111
     C                   Z-ADD     UPAMT         RRPA                                          S0111
     C                   Z-ADD     VDAT          RRSD                                          S0111
     C                   Z-ADD     MDAT          RRED                                          S0111
     C                   EXSR      DLRREX                                                      S0111
     C                   Z-ADD     RREA          KYAMT                                         S0111
     C                   Z-ADD     RREA          UAEXA                                         S0111
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   CIR001
     C** UP-FRONT FEE/PREMIUM                                             CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UPVD          ANDNE     *ZEROS                                                      CIR00
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVEA     'D'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVEA     UPPR          AKY(9)                                        CIR00
     C                   Z-ADD     UPFE          KYAMT                                         CIR00
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C368
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C369
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C370
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C371
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C372
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** WRITE ACCOUNT KEY FOR FEE/PREMIUM                                CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   BITON     '0'           ACEI                                          S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
      *                                                                   CIR006
      ** Buy-outs on deal date                                            CIR006
      *                                                                   CIR006
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C                   TESTB     '4'           ACEI                 31                       CIR00
     C     BODD          IFLT      EVCD                                                        CIR00
     C     BODD          ANDNE     0                                                           CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C                   CLEAR                   AKY                                           CIR00
     C                   Z-ADD     BODD          KYDAT                                         CIR00
     C                   Z-ADD     BODD          KYFED                                         CIR00
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'D'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVE      BAPR          AKY(9)                                        CIR00
     C                   MOVE      'B'           AKY(10)                                       CIR00
     C                   Z-ADD     BOAM          KYAMT                                         CIR00
      *                                                                   CIR006
     C     BAPR          IFEQ      'P'                                                         CIR00
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVEL     PSCY          KYSCY                                         CIR00
     C                   MOVEL     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C     BAPR          IFEQ      'R'                                                         CIR00
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVEL     RSCY          KYSCY                                         CIR00
     C                   MOVEL     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   EXSR      EXCP                                                        CIR00
     C                   BITON     '4'           ACEI                                          CIR00
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   S01119
     C* INTEREST DATE PROCESSING                                          S01119
     C*                                                                   S01119
     C     RLDATX        TAG                                                    ** RLDATX TAG**S0111
     C*                                                                   CIR001
     C** VALUE DATE UP-FRONT FEE/PREMIUM                                  CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '3'           ACEI                 31                       CIR00
     C     UPVD          IFLE      EVCD                                                        CIR00
     C     UPVD          ANDNE     *ZEROS                                                      CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
     C*                                                                   CIR001
     C                   Z-ADD     UPVD          KYDAT                                         CIR00
     C                   Z-ADD     UPVD          KYFED                                         CIR00
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'V'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVEA     UPPR          AKY(9)                                        CIR00
     C                   MOVEL     NEV(12)       NARREV                                        CIR00
     C                   Z-ADD     UPFE          KYAMT                                         CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      'F'           F1FFLG
     C                   Z-ADD     UPFE          F1FVAL
     C                   Z-ADD     100           F1FPCT
     C                   ENDIF
     C*                                                                   CIR001
     C** CURRENCY DETAILS AND SETTLEMENT ACCOUNT DETAILS                  CIR001
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C373
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C374
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C375
     C                   Z-ADD     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
      *                                                                                       199825
     C                   MOVE      POBR          KYSTBR
      *                                                                                       199825
     C                   END                                                                   CIR00
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C376
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C/COPY WNCPYSRC,DL0280C377
     C                   Z-ADD     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
      *                                                                                       199825
     C                   MOVE      ROBR          KYSTBR
      *                                                                                       199825
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** SETUP FIELDS FOR REPORT                                          CIR001
     C*                                                                   CIR001
     C                   Z-ADD     UPFE          NRRPUR                                        CIR00
     C                   MOVE      '  '          NRBRTT                                        CIR00
     C                   SETON                                        7131                     CIR00
     C*                                                                   CIR001
     C** WRITE ACCOUNT KEY FOR UP-FRONT FEES/PREMIUM                      CIR001
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
      *                                                                                       CGL020
     C     CGL020        IFEQ      'Y'
     C                   MOVE      *BLANKS       F1FFLG
     C                   Z-ADD     0             F1FVAL
     C                   Z-ADD     0             F1FPCT
     C                   ENDIF
      *                                                                                       CGL020
     C                   BITON     '3'           ACEI                                          CIR00
     C*                                                                   CIR001
     C** SET DEALS FILE UPDATE INDICATOR                                  CIR001
     C*                                                                   CIR001
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*   THEIR WORK FIELD                                                S01119
     C*                                                                   S01119
     C*   IF INTEREST PAYMENT DATE IS ZERO,USE INTEREST CHANGE DATE       S01119
     C*   UNLESS IT IS ALSO ZERO.IN THIS CASE INTEREST PAYMENT IS         S01119
     C*   ON MATURITY DATE                                                S01119
     C     USRST         IFEQ      'T'                                                         S0111
     C     TNIPD         IFEQ      0                                                           S0111
     C     TNICD         IFNE      0                                                           S0111
     C                   Z-ADD     TNICD         WNIPD             5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPD                                         S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TNIPD         WNIPD                                         S0111
     C                   END                                                                   S0111
     C                   Z-ADD     TINFD         WINFD             5 0                         S0111
     C                   Z-ADD     TNICD         WINCD             5 0                         S0111
     C                   Z-ADD     TSLIP         WSLIP             5 0                         S0111
     C                   Z-ADD     TIPBD         WIPBD             5 0                         S0111
     C                   Z-ADD     TLPCD         WLPCD             5 0                         S0111
     C                   Z-ADD     TIPFD         WIPFD             2 0                         S0111
     C                   MOVE      TIPFR         WIPFR             1                           S0111
     C                   MOVE      TIACD         WIACD             5 0                         S0111
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C*   OUR WORK FIELD                                                  S01119
     C*   IF INTEREST PAYMENT DATE IS ZERO,USE INTEREST CHANGE DATE       S01119
     C*   UNLESS IT IS ALSO ZERO.IN THIS CASE INTEREST PAYMENT IS         S01119
     C*   ON MATURITY DATE                                                S01119
     C*                                                                   S01119
     C     UNIPD         IFEQ      0                                                           S0111
     C     UNICD         IFNE      0                                                           S0111
     C                   Z-ADD     UNICD         WNIPD             5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPD                                         S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     UNIPD         WNIPD                                         S0111
     C                   END                                                                   S0111
     C                   Z-ADD     UINFD         WINFD                                         S0111
     C                   Z-ADD     UNICD         WINCD                                         S0111
     C                   Z-ADD     USLIP         WSLIP                                         S0111
     C                   Z-ADD     UIPBD         WIPBD                                         S0111
     C                   Z-ADD     ULPCD         WLPCD                                         S0111
     C                   Z-ADD     UIPFD         WIPFD                                         S0111
     C                   MOVE      UIPFR         WIPFR                                         S0111
     C                   MOVE      UIACD         WIACD             5 0                         S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C414
      *                                                                                       229628
      ** Check rate fix indicator                                                             229628
      *                                                                                       229628
     C     USRST         IFEQ      'P'                                                        229628
     C                   MOVE      URFIN         WRFIN             1                          229628
     C                   Z-ADD     UFRFD         WFRFD                                        229628
     C                   ELSE                                                                 229628
     C                   MOVE      TRFIN         WRFIN                                        229628
     C                   Z-ADD     TFRFD         WFRFD                                        229628
     C                   ENDIF                                                                229628
      *                                                                                       229628
     C     WINFD         IFGE      EVCD                                                       229628
     C     WINFD         ANDLE     WINCD                                                      229628
     C     WRFIN         ANDNE     *BLANK                                                     229628
     C     CSW005        IFEQ      'Y'                                                        229628
     C     CSW011        OREQ      'Y'                                                        229628
     C     USRST         IFEQ      'P'                                                        229628
     C                   MOVE      *BLANK        URFIN                                        229628
     C                   ELSE                                                                 229628
     C                   MOVE      *BLANK        TRFIN                                        229628
     C                   ENDIF                                                                229628
     C                   ENDIF                                                                229628
     C                   ENDIF                                                                229628
     C*                                                                   S01119
     C** RESET WORK FIELDS                                                S01119
     C*                                                                   S01119
     C                   Z-ADD     0             WINOTT                                        S0111
     C                   Z-ADD     0             WINOTU                                        S0111
     C                   Z-ADD     0             REIMRT                                        S0111
     C                   Z-ADD     0             TPUPRT                                        S0111
     C** INDICATOR TO SHOW RATE FIX HAS BEEN APPLIED                      S01119
     C                   MOVE      ' '           FIXFLG            1                           S0111
     C** ONLY PROCESS INTEREST PAYMENT DATE DURING SHADOW POST            S01119
     C     WNIPD         IFLE      EVCD                                                        S0111
     C     *INU1         CABNE     '1'           RLSHAD                                        S0111
     C                   END                                                                   S0111
     C  NU1              GOTO      RLSEND                                                      S0111
     C*                                                                   S01119
     C*  NON-SHADOW POST PROCESSING                                       S01119
     C*                                                                   S01119
     C     RLDATE        TAG                                                    ** RLDATE TAG**S0111
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C200                                           S01408
     C*                                                                   S01408
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C     UNPCD         IFLE      EVCD                                                        CIR00
     C     UNPCD         ANDNE     0                                                           CIR00
      *                                                                   CIR006
     C     WNIPD         IFLE      UNPCD                                                       CIR00
     C     WNIPD         ANDNE     0                                                           CIR00
     C     AVERRT        OREQ      'Y'                                                         CIR00
     C     FIXFLG        ANDNE     'Y'                                                         CIR00
     C     WINFD         ANDLE     UNPCD                                                       CIR00
     C     WINFD         ANDNE     0                                                           CIR00
     C     WINCD         ORLE      UNPCD                                                       CIR00
     C     WINCD         ANDNE     0                                                           CIR00
     C                   ELSE                                                                  CIR00
     C                   GOTO      RLPRCH                                                      CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   S01119
     C*  PROVIDER'S INTEREST PAYMENT DATE TO BE PROCESSED                 S01119
     C     WNIPD         IFLE      EVCD                                                        S0111
     C     WNIPD         ANDGT     WSLIP                                                       S0111
     C                   GOTO      RLPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  AVERAGE RATE FIX DATE STILL TO BE PROCESSED                      S01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C     *IN41         ANDEQ     '1'                                                         S0111
     C     FIXFLG        ANDNE     'Y'                                                         S0111
     C                   GOTO      RLPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  NON AVERAGE PROVIDER'S RATE FIX DATE TO BE PROCESSED             S01119
     C     AVERRT        IFNE      'Y'                                                         S0111
     C     WINFD         ANDLE     EVCD                                                        S0111
     C     WINFD         ANDGT     0                                                           S0111
     C                   GOTO      RLPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  PROVIDER'S RATE CHANGE DATE TO BE PROCESSED                      S01119
     C     WINCD         IFGT      0                                                           S0111
     C     WINCD         ANDLE     EVCD                                                        S0111
     C                   GOTO      RLPROC                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  OTHERWISE NO REPEATING EVENT DATES TO BE PROCESSED.              S01119
     C                   GOTO      RLMDAT                                                      S0111
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C201                                           S01408
     C*                                                                   S01408
     C     RLPRCH        TAG                                                                   CIR00
      *                                                                   CIR006
      ** Calculate interest to bring accruals up to principal change date CIR006
      ** prior to update of principal                                     CIR006
      *                                                                   CIR006
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C     AVERRT        IFEQ      'Y'                                                         CIR00
      *                                                                   CIR006
      ** Average rate calculation for case where principal change date    CIR006
      ** falls after RUND but before DNWD                                 CIR006
      *                                                                   CIR006
     C     UNPCD         IFGT      BJRDNB                                                      CIR00
      *                                                                   CIR006
     C     USRST         IFEQ      'P'                                                         CIR00
     C     UNPCD         SUB       UINFD         WK5                                           CIR00
     C     UEINR         MULT      WK5           WK158                                         CIR00
     C                   ELSE                                                                  CIR00
     C     UNPCD         SUB       TINFD         WK5                                           CIR00
     C     TEINR         MULT      WK5           WK158                                         CIR00
     C                   ENDIF                                                                 CIR00
     C     AVPER         MULT      WK5           WK5                                           CIR00
     C                   ADD       TIRAT         WK158                                         CIR00
      *                                                                   CIR006
     C     WK5           IFNE      0                                                           CIR00
     C     WK158         DIV(H)    WK5           AACRT                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   Z-ADD     AACRT         EINR                                          CIR00
     C                   ELSE                                                                  CIR00
      *                                                                   CIR006
     C     USRST         IFEQ      'P'                                                         CIR00
     C                   Z-ADD     UEINR         EINR                                          CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     TEINR         EINR                                          CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C     EINR          SUB       CLRAT         REIMRT           11 7                         CIR00
     C     REIMRT        IFLT      0                                                           CIR00
     C                   Z-ADD     0             REIMRT                                        CIR00
     C                   ENDIF                                                                 CIR00
     C     FLRRTF        IFEQ      'Y'                                                         CIR00
     C     FLRAT         SUB       EINR          TPUPRT           11 7                         CIR00
     C     TPUPRT        IFLT      0                                                           CIR00
     C                   Z-ADD     0             TPUPRT                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
      ** Theirs                                                           CIR006
      *                                                                   CIR006
     C                   Z-ADD     0             ZIRATE                                        CIR00
     C     USRST         IFEQ      'P'                                                         CIR00
     C     FLRRTF        ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     TPUPRT        ZIRATE                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C     USRST         IFEQ      'T'                                                         CIR00
     C                   Z-ADD     REIMRT        ZIRATE                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C     AVERRT        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     SDCAR         ZIBEG                                         CIR00
     C                   ELSE                                                                  CIR00
     C     USRST         IFEQ      'T'                                                         CIR00
     C                   Z-ADD     TIACD         ZIBEG                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     UIACD         ZIBEG                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   Z-ADD     TPAMT         ZIAMT                                         CIR00
     C                   Z-ADD     TICBS         ZICALC                                        CIR00
     C                   Z-ADD     TNPCD         ZIEND                                         CIR00
      *                                                                   CIR006
      ** Add their unsettled interst and adjustment to their principal    CIR006
      *                                                                   CIR006
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   EXSR      GLINTC                                                      CIR00
      *                                                                   CIR006
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C                   Z-ADD     0             TIALC                                         CIR00
     C                   ADD       WKINT         TAITC                                         CIR00
      *                                                                   CIR006
      ** Ours                                                             CIR006
      *                                                                   CIR006
     C                   Z-ADD     0             ZIRATE                                        CIR00
     C     USRST         IFEQ      'T'                                                         CIR00
     C     FLRRTF        ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     TPUPRT        ZIRATE                                        CIR00
     C                   ENDIF                                                                 CIR00
     C     USRST         IFEQ      'P'                                                         CIR00
     C                   Z-ADD     REIMRT        ZIRATE                                        CIR00
     C                   ENDIF                                                                 CIR00
     C     AVERRT        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     SDCAR         ZIBEG                                         CIR00
     C                   ELSE                                                                  CIR00
     C     USRST         IFEQ      'T'                                                         CIR00
     C                   Z-ADD     TIACD         ZIBEG                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     UIACD         ZIBEG                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   Z-ADD     UPAMT         ZIAMT                                         CIR00
     C                   Z-ADD     UICBS         ZICALC                                        CIR00
     C                   Z-ADD     UNPCD         ZIEND                                         CIR00
      *                                                                   CIR006
      ** Add our unsettled interest and adjustment to our principal       CIR006
      *                                                                   CIR006
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   EXSR      GLINTC                                                      CIR00
      *                                                                   CIR006
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C                   Z-ADD     0             UIALC                                         CIR00
     C                   ADD       WKINT         UAITC                                         CIR00
     C                   Z-ADD     UNPCD         UIACD                                         CIR00
     C                   Z-ADD     TNPCD         TIACD                                         CIR00
      *                                                                   CIR006
     C     USRST         IFEQ      'T'                                                         CIR00
     C                   Z-ADD     TIACD         WIACD                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     UIACD         WIACD                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C     AVERRT        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     WIACD         SDCAR                                         CIR00
     C                   MOVE      'Y'           ULSDCR                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
      ** Principal Key                                                    CIR006
      *                                                                   CIR006
     C                   CLEAR                   AKY                                           CIR00
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     'A'           AKY(10)                                       CIR00
     C                   MOVEL     UFRDKY        FRDKY                                         CIR00
     C                   Z-ADD     UNPCD         KYDAT                                         CIR00
     C                   Z-ADD     UNPCD         KYFED                                         CIR00
     C                   MOVEL     *BLANKS       PORTH                                         CIR00
      *                                                                   CIR006
     C                   EXSR      #LPRCH                                                      CIR00
      *                                                                   CIR006
      ** Compute the difference between the new principal amount          CIR006
      ** and the old principal amount.  If the result is negative,        CIR006
      ** then it is a principal DECREASE. Else, if positive, then         CIR006
      ** its a principal INCREASE.                                        CIR006
      *                                                                   CIR006
     C                   Z-ADD     0             WPDIF            15 0                         CIR00
     C                   MOVE      'I'           WPIOD             1                           CIR00
     C     WPAMT         IFNE      0                                                           CIR00
     C     WPAMT         SUB       UPAMT         WPDIF                                         CIR00
     C     WPDIF         IFLT      0                                                           CIR00
     C                   MOVEL     'D'           WPIOD                                         CIR00
     C                   Z-SUB     WPDIF         WPDIF                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVEL     'I'           WPIOD                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   Z-ADD     WPAMT         NRRPUR                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   Z-ADD     WPDIF         KYAMT                                         CIR00
     C     WPIOD         IFEQ      'D'                                                         CIR00
     C                   MOVEA     'M'           AKY(3)                                        CIR00
     C                   MOVEA     'D'           AKY(9)                                        CIR00
     C                   MOVEL     NEV(9)        NARREV                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVEA     'D'           AKY(3)                                        CIR00
     C                   MOVEA     'I'           AKY(9)                                        CIR00
     C                   MOVEL     NEV(8)        NARREV                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   Z-ADD     CLRAT         NRRT                                          CIR00
     C                   MOVEL     *BLANKS       NRBRTT                                        CIR00
     C                   Z-ADD     0             NRRSAL                                        CIR00
     C                   MOVE      '1'           *IN71                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   MOVEL     TFRDKY        FRDKY                                         CIR00
      *                                                                   CIR006
      ** Setup rates for second print line                                CIR006
      *                                                                   CIR006
     C     USRST         IFEQ      'P'                                                         CIR00
     C                   Z-ADD     UEINR         NRRT                                          CIR00
     C                   MOVE      UBRTT         NRBRTT                                        CIR00
     C                   TESTB     '0'           UDNSI                31                       CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     TEINR         NRRT                                          CIR00
     C                   MOVE      TBRTT         NRBRTT                                        CIR00
     C                   TESTB     '0'           TDNSI                31                       CIR00
     C                   ENDIF                                                                 CIR00
     C     AVERRT        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     AACRT         NRRT                                          CIR00
     C                   MOVE      '0'           *IN31                                         CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   EXCEPT    FITHR1                                                      CIR00
     C                   ADD       1             PLINES                                        CIR00
      *                                                                   CIR006
     C     FLRRTF        IFEQ      'Y'                                                         CIR00
     C                   MOVE      '0'           *IN33                                         CIR00
     C     USRST         IFEQ      'T'                                                         CIR00
     C     TAXI          ANDEQ     'Y'                                                         CIR00
     C                   MOVE      '1'           *IN33                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   EXCEPT    FLOOR                                                       CIR00
     C                   ADD       1             PLINES                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
      ** Exposure Key                                                     CIR006
      *                                                                   CIR006
     C                   MOVE      DTYP          RRDT                                          CIR00
     C                   Z-ADD     KYAMT         RRPA                                          CIR00
     C                   Z-ADD     KYDAT         RRSD                                          CIR00
     C                   Z-ADD     MDAT          RRED                                          CIR00
     C                   EXSR      DLRREX                                                      CIR00
     C                   Z-ADD     RREA          KYAMT                                         CIR00
     C     WPIOD         IFEQ      'D'                                                         CIR00
     C                   SUB       RREA          UAEXA                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   ADD       RREA          UAEXA                                         CIR00
     C                   ENDIF                                                                 CIR00
     C                   MOVEA     'E'           AKY(10)                                       CIR00
     C                   MOVEL     UFRDKY        FRDKY                                         CIR00
     C                   EXSR      EXCP                                                        CIR00
      *                                                                   CIR006
     C     WPDIF         IFNE      0                                                           CIR00
     C     WPAMT         SUB       UPAMT         WDIFF                                         CIR00
     C                   Z-ADD     WPAMT         UPAMT                                         CIR00
      *                                                                   CIR006
      ** Update Value of Capitalisations for audit control                CIR006
      *                                                                   CIR006
     C     WDIFF         DIV       1000          ZZAMT                                         CIR00
     C                   Z-ADD     NETCII        ZZTOTI                                        CIR00
     C                   Z-ADD     NETCID        ZZTOTD                                        CIR00
     C                   EXSR      GLZADD                                                      CIR00
     C                   Z-ADD     ZZTOTI        NETCII                                        CIR00
     C                   Z-ADD     ZZTOTD        NETCID                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   Z-ADD     UPAMT         TPAMT                                         CIR00
     C                   MOVE      *BLANKS       AKY(9)                                        CIR00
     C                   MOVE      '1'           *IN15                                         CIR00
     C                   GOTO      RLDATE                                                      CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   S01119
     C*  INTEREST PAY DATE                                                S01119
     C*                                                                   S01119
     C     RLPROC        TAG                                                    ** RLPROC TAG**S0111
     C*  IN ORDER TO CONTINUE WITH NEXT INTEREST DATE IT MUST BE:         S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE AND NON-ZERO         S01119
     C*  2) GREATER THAN WORK START LAST INTEREST PAYMENT DATE            S01119
     C*  3) FOR NON AVERAGE DEALS:LESS THAN OR EQUAL TO WORK              S01119
     C*     INTEREST FIX DATE,UNLESS FIX DATE IS ZERO             OR      S01119
     C*     FOR  AVERAGE DEALS:LESS THAN OR EQUAL TO VALUE DATE           S01119
     C*     OF UNPROCESSED DEAL AMENDMENT RECORD                          S01119
     C*  4) LESS THAN OR EQUAL TO WORK NEXT INTEREST CHANGE DATE          S01119
     C*     IF WORK NEXT INTEREST CHANGE DATE IS NON ZERO                 S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO WORK INTEREST FIX DATE CHECK                     S01119
     C*                                                                   S01119
     C     WNIPD         IFGT      EVCD                                                        S0111
     C                   GOTO      RLTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPD         IFEQ      0                                                           S0111
     C                   GOTO      RLTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPD         IFLE      WSLIP                                                       S0111
     C                   GOTO      RLTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     AVERRT        IFNE      'Y'                                                         S0111
     C     WNIPD         ANDGT     WINFD                                                       S0111
     C     WINFD         ANDGT     0                                                           S0111
     C                   GOTO      RLTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C     WNIPD         ANDGT     VDATDM                                                      S0111
     C     FIXFLG        ANDNE     'Y'                                                         S0111
     C                   GOTO      RLTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WNIPD         IFGT      WINCD                                                       S0111
     C     WINCD         ANDGT     0                                                           S0111
     C                   GOTO      RLTIFD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     RLSHAD        TAG                                                    ** RLSHAD TAG**S0111
     C*                                                                   S01119
     C* REIMBURSEMENT/TOPPING UP RATE CALCULATIONS                        S01119
     C*                                                                   S01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C* AVERAGE RATE CALCULATION FOR CASE WHERE PAYMENT DATE              S01119
     C*    FALLS AFTER RUND BUT BEFORE DNWD                               S01119
     C     WNIPD         IFGT      BJRDNB                                                      S0119
     C     USRST         IFEQ      'P'                                                         S0111
     C     WNIPD         SUB       UINFD         WK5                                           S0111
     C     UEINR         MULT      WK5           WK158                                         S0111
     C                   ELSE                                                                  S0111
     C     WNIPD         SUB       TINFD         WK5                                           S0111
     C     TEINR         MULT      WK5           WK158                                         S0111
     C                   END                                                                   S0111
     C     AVPER         ADD       WK5           WK5                                           S0111
     C     WK158         ADD       TIRAT         WK158                                         S0111
     C*                                                                   S01119
     C     WK5           IFNE      0                                                           S0111
     C     WK158         DIV(H)    WK5           AACRT                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     AACRT         EINR                                          S0111
     C*                                                                   S01119
     C                   ELSE                                                                  S0111
     C/COPY WNCPYSRC,DL0280C408
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     UEINR         EINR                                          S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TEINR         EINR                                          S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* IF RATE BETWEEN FLOOR AND CEILING,SET TO ZERO                     S01119
     C     EINR          SUB       CLRAT         REIMRT           11 7  31                     S0111
     C   31              Z-ADD     0             REIMRT                                        S0111
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C     FLRAT         SUB       EINR          TPUPRT           11 7  31                     S0111
     C   31              Z-ADD     0             TPUPRT                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  A/C KEY GENERATION                                               S01119
     C*                                                                   S01119
     C                   MOVEA     'RLI'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    I'       AKY(6)                                        S0111
     C                   MOVE      'R'           AKY(9)                                        S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
     C                   Z-ADD     WNIPD         KYDAT                                         S0111
     C                   Z-ADD     WNIPD         KYFED                                         S0111
      *                                                                   S01119
      * DLRSIN                                                            S01119
      *                                                                   S01119
      *        (THEIRS)                                                   S01119
     C                   SETOFF                                       31                       S0111
     C*****USRST         IFEQ      'P'                                               S01119 AR812349
     C     USRST         IFEQ      'T'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                         S0111
     C     DTYP          ANDEQ     'RF'                                                     AR812349
     C* USE TOPPING UP RATE FOR C'PARTY(TAKER)                            E23400
     C                   Z-ADD     TPUPRT        SZINR                31  31                   S0111
     C                   MOVE      'P'           AKY(9)                                     AR812349
     C                   END                                                                   S0111
     C     USRST         IFEQ      'T'                                                         S0111
     C     FLRRTF        ANDNE     'Y'                                                      AR812349
     C* USE REIMBURSEMENT RATE FOR C'PARTY(PROVIDER)                      E23400
     C                   Z-ADD     REIMRT        SZINR                31  31                   S0111
     C                   END                                                                   S0111
     C     USRST         IFEQ      'T'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                      AR812349
     C     DTYP          ANDEQ     'RR'                                                     AR812349
     C                   Z-ADD     REIMRT        SZINR                31  31                AR812349
     C     TPUPRT        IFNE      0                                                        AR812349
     C                   Z-ADD     TPUPRT        SZINR                31  31                AR812349
     C                   MOVE      'P'           AKY(9)                                     AR812349
     C                   ENDIF                                                              AR812349
     C                   ENDIF                                                              AR812349
     C*                                                                   S01119
     C* *IN31 ON IF THEIR DETAILS ARE TO BE PROCESSED                     S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C                   Z-ADD     WIACD         SZIACD                                        S0111
     C                   Z-ADD     WNIPD         SZEDAT                                        S0111
     C                   Z-ADD     TPAMT         SZPPL                                         S0111
     C                   MOVE      TCUCY         SZCCY                                         S0111
     C                   MOVE      RSCY          SZECY                                         CEU00
     C                   Z-ADD     BNHKTR        SZITR                                         S0119
     C                   Z-ADD     TAIPD         SZIPTD                                        S0111
     C                   Z-ADD     TAIAP         SZAIAP                                        S0111
     C                   Z-ADD     TAIAN         SZIANP                                        S0111
     C                   Z-ADD     TAITC         SZAICD                                        S0111
     C                   Z-ADD     TIPRM         SZIPRM                                        S0111
     C                   Z-ADD     TIPRD         SZIPRD                                        S0111
     C                   Z-ADD     TTAXD         SZTPTD                                        S0111
     C                   Z-ADD     TTAXM         SZTPTM                                        S0111
     C                   Z-ADD     TICBS         SZCBS                                         S0111
     C                   MOVE      'I'           SZETYP                                        S0111
     C                   MOVE      WIPFR         SZIPFC                                        S0111
     C                   Z-ADD     WIPFD         SZIPD                                         S0111
     C                   Z-ADD     MDAT          SZMDAT                                        S0111
     C                   Z-ADD     WIPBD         SZIPBD                                        S0111
     C                   MOVE      'N'           SZRLPI                                        S0111
     C                   Z-ADD     TIALC         SZLICD                                        S0111
     C                   MOVE      CNFI          SZCNFI                                        S0111
     C                   MOVE      TLXI          SZTLXI                                        S0111
     C                   MOVE      AKY(9)        SZDIR                                         S0111
     C                   Z-ADD     SDCAR         SZSDCR            5 0                         S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C     USRST         IFEQ      'T'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                      AR812349
     C     AKY(9)        ANDEQ     'P'                                                      AR812349
     C                   MOVE      UFRDKY        FRDKY                                      AR812349
     C                   MOVE      'Y'           FLRT                                       AR887940
     C                   ENDIF                                                              AR812349
     C                   MOVE      AVERRT        SZAVRM                                        S0111
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C                   MOVE      TINPM         SZINPM                                        CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add their unsettled interest and       CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          SZPPL                                         CIR00
     C                   ADD       TUSA          SZPPL                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280C256
     C                   EXSR      DLRSIN                                                      S0111
     C                   MOVE      ' '           FLRT                                       AR887940
     C                   MOVE      ' '           SZAVRM                                        S0111
      *        (RESULT)                                                   S01119
     C                   Z-ADD     SZAICD        TAITC                                         S0111
     C                   Z-ADD     SZIPTD        TAIPD                                         S0111
     C                   Z-ADD     SZAIAP        TAIAP                                         S0111
     C                   Z-ADD     SZIANP        TAIAN                                         S0111
     C                   Z-ADD     SZIPRM        TIPRM                                         S0111
     C                   Z-ADD     SZIPRD        TIPRD                                         S0111
     C                   Z-ADD     SZTPTD        TTAXD                                         S0111
     C                   Z-ADD     SZTPTM        TTAXM                                         S0111
     C                   Z-ADD     SZLICD        TIALC                                         S0111
     C                   MOVE      SZCNFI        CNFI                                          S0111
     C                   MOVE      SZTLXI        TLXI                                          S0111
     C*  SET FIELD FOR NET INTEREST CALCULATION CHECK/KEY GENERATION      S01119
     C                   Z-ADD     SZINOT        WINOTT           13 0                         S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   CIR002
     C** Reset Their Unsettled Interest Amount and                        CIR002
     C** Their Unsettled Interest Adjustment to 0                         CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C                   Z-ADD     0             TUSI                                          CIR00
     C                   Z-ADD     0             TUSA                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0280C399
     C*                                                                   S01119
     C* UPDATE PROVIDER'S DATES - WORK DATES SHOULD BE LEFT FOR OUR CALCS S01119
     C     USRST         IFEQ      'T'                                                         S0111
     C* USER TAKER                                                        S01119
     C                   Z-ADD     SZSLID        TLPCD                                         S0111
     C                   MOVE      SZIPFC        TIPFR                                         S0111
     C                   Z-ADD     SZIPD         TIPFD                                         S0111
     C                   Z-ADD     SZSLID        TSLIP                                         S0111
     C                   Z-ADD     SZIPBD        TIPBD                                         S0111
     C                   Z-ADD     SZIPBD        WTPBD                                        248300
     C                   Z-ADD     SZIACD        TIACD                                         S0111
     C* IN ORDER TO ALLOW DATE DEFAULT ABOVE TO TAKE EFFECT ONLY UPDATE   S01119
     C*     NEXT INTEREST PAYMENT DATE IF IT WAS NOT ORIGINALLY ZERO      S01119
     C     TNIPD         IFNE      0                                                           S0111
     C                   Z-ADD     SZNIPD        TNIPD                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   ELSE                                                                  S0111
     C* USER PROVIDER                                                     S01119
     C     SZIPFC        IFEQ      ' '                                                         CIR00
     C     UNIPD         ANDNE     *ZEROS                                                      CIR00
     C                   Z-ADD     SZMDAT        SZIPBD                                        CIR00
     C                   Z-ADD     SZMDAT        SZNIPD                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR005
     C                   Z-ADD     SZSLID        ULPCD                                         S0111
     C                   MOVE      SZIPFC        UIPFR                                         S0111
     C                   Z-ADD     SZIPD         UIPFD                                         S0111
     C                   Z-ADD     SZSLID        USLIP                                         S0111
     C                   Z-ADD     SZIPBD        UIPBD                                         S0111
     C                   Z-ADD     SZIPBD        WUPBD                                        248300
     C                   Z-ADD     SZIACD        UIACD                                         S0111
     C* IN ORDER TO ALLOW DATE DEFAULT ABOVE TO TAKE EFFECT ONLY UPDATE   S01119
     C*     NEXT INTEREST PAYMENT DATE IF IT WAS NOT ORIGINALLY ZERO      S01119
     C     UNIPD         IFNE      0                                                           S0111
     C                   Z-ADD     SZNIPD        UNIPD                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C400
     C                   MOVE      'Y'           SZRLPI                                        S0111
     C                   MOVE      'Y'           PRINT             1                           S0111
     C*                                                                   S01119
     C* ELSE DO NOT PROCESS THEIR DETAILS (*IN31 OFF) - SET IND TO UPDATE S01119
     C* DATES                                                             S01119
     C                   ELSE                                                                  S0111
     C                   MOVE      'N'           SZRLPI                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C** OURS                                                             S01119
     C*                                                                   S01119
     C                   MOVEA     'RLI'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     '    I'       AKY(6)                                        S0111
     C                   MOVE      'P'           AKY(9)                                        S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
      *                                                                   S01119
      * DLRSIN                                                            S01119
      *                                                                   S01119
      *        (OURS)                                                     S01119
     C                   SETOFF                                       31                       S0111
     C*****USRST         IFEQ      'T'                                               S01119 AR812349
     C     USRST         IFEQ      'P'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                         S0111
     C     DTYP          ANDEQ     'RF'                                                     AR812349
     C**NOT*NEG*INT*-*USE*TOPPING*UP*RATE FOR USER(TAKER)           S01119E23400
     C* USE TOPPING UP RATE FOR USER(TAKER)                               E23400
     C                   Z-ADD     TPUPRT        SZINR                31  31                   S0111
     C                   MOVE      'R'           AKY(9)                                     AR812349
     C                   END                                                                   S0111
     C     USRST         IFEQ      'P'                                                         S0111
     C     FLRRTF        ANDNE     'Y'                                                      AR812349
     C* USE REIMBURSEMENT RATE FOR USER(PROVIDER)                         E23400
     C                   Z-ADD     REIMRT        SZINR                31  31                   S0111
     C                   END                                                                   S0111
     C     USRST         IFEQ      'P'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                      AR812349
     C     DTYP          ANDEQ     'RR'                                                     AR812349
     C                   Z-ADD     REIMRT        SZINR                31  31                AR812349
     C     TPUPRT        IFNE      0                                                        AR812349
     C                   Z-ADD     TPUPRT        SZINR                31  31                AR812349
     C                   MOVE      'R'           AKY(9)                                     AR812349
     C                   ENDIF                                                              AR812349
     C                   ENDIF                                                              AR812349
     C* OUR DETAILS TO BE PROCESSED                                       S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C                   MOVE      'Y'           PRINT             1                           S0111
     C                   Z-ADD     WIACD         SZIACD                                        S0111
     C                   Z-ADD     WNIPD         SZEDAT                                        S0111
     C                   Z-ADD     UPAMT         SZPPL                                         S0111
     C                   MOVE      UCUCY         SZCCY                                         S0111
     C                   MOVE      PSCY          SZECY                                         CEU00
     C                   Z-ADD     BNHKTR        SZITR                                         S0119
     C                   Z-ADD     UAIPD         SZIPTD                                        S0111
     C                   Z-ADD     UAIAP         SZAIAP                                        S0111
     C                   Z-ADD     UAIAN         SZIANP                                        S0111
     C                   Z-ADD     UAITC         SZAICD                                        S0111
     C                   Z-ADD     UIPRM         SZIPRM                                        S0111
     C                   Z-ADD     UIPRD         SZIPRD                                        S0111
     C                   Z-ADD     UTAXD         SZTPTD                                        S0111
     C                   Z-ADD     UTAXM         SZTPTM                                        S0111
     C                   Z-ADD     UICBS         SZCBS                                         S0111
     C                   MOVE      'I'           SZETYP                                        S0111
     C                   MOVE      WIPFR         SZIPFC                                        S0111
     C                   Z-ADD     WIPFD         SZIPD                                         S0111
     C                   Z-ADD     MDAT          SZMDAT                                        S0111
     C                   Z-ADD     WIPBD         SZIPBD                                        S0111
     C                   Z-ADD     UIALC         SZLICD                                        S0111
     C                   MOVE      CNFI          SZCNFI                                        S0111
     C                   MOVE      TLXI          SZTLXI                                        S0111
     C                   MOVE      AKY(9)        SZDIR                                         S0111
     C                   Z-ADD     SDCAR         SZSDCR            5 0                         S0111
     C                   MOVE      AVERRT        SZAVRM                                        S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C     USRST         IFEQ      'P'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                      AR812349
     C     AKY(9)        ANDEQ     'R'                                                      AR812349
     C                   MOVE      TFRDKY        FRDKY                                      AR812349
     C                   MOVE      'Y'           FLRT                                       AR887940
     C                   ENDIF                                                              AR812349
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C                   MOVE      UINPM         SZINPM                                        CIR00
     C                   ENDIF                                                                 CIR00
     C*                                                                   CIR002
     C** If CIR002 is switched on, add our unsettled interest and         CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          SZPPL                                         CIR00
     C                   ADD       OUSA          SZPPL                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280C257
     C                   EXSR      DLRSIN                                                      S0111
     C                   MOVE      ' '           FLRT                                       AR887940
     C                   MOVE      ' '           SZAVRM                                        S0111
      *        (RESULT)                                                   S01119
     C                   Z-ADD     SZAICD        UAITC                                         S0111
     C                   Z-ADD     SZIPTD        UAIPD                                         S0111
     C                   Z-ADD     SZAIAP        UAIAP                                         S0111
     C                   Z-ADD     SZIANP        UAIAN                                         S0111
     C                   Z-ADD     SZIPRM        UIPRM                                         S0111
     C                   Z-ADD     SZIPRD        UIPRD                                         S0111
     C                   Z-ADD     SZTPTD        UTAXD                                         S0111
     C                   Z-ADD     SZTPTM        UTAXM                                         S0111
     C                   Z-ADD     SZLICD        UIALC                                         S0111
     C                   MOVE      SZCNFI        CNFI                                          S0111
     C                   MOVE      SZTLXI        TLXI                                          S0111
     C*  SET FIELD FOR NET INTEREST CALCULATION CHECK/KEY GENERATION      S01119
     C                   Z-ADD     SZINOT        WINOTU           13 0                         S0111
     C                   Z-ADD     SZTAXC        TAXA                                          S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   CIR002
     C** Reset Our Unsettled Interest Amount and                          CIR002
     C** Our Unsettled Interest Adjustment to 0                           CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C                   Z-ADD     0             OUSI                                          CIR00
     C                   Z-ADD     0             OUSA                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C* UPDATE PROVIDER'S DATES - IF THEIR DETAILS NOT PROCESSED          S01119
     C     SZRLPI        IFEQ      'N'                                                         S0111
     C/COPY WNCPYSRC,DL0280C401
     C     USRST         IFEQ      'T'                                                         S0111
     C* USER TAKER                                                        S01119
     C                   Z-ADD     SZSLID        TLPCD                                         S0111
     C                   MOVE      SZIPFC        TIPFR                                         S0111
     C                   Z-ADD     SZIPD         TIPFD                                         S0111
     C                   Z-ADD     SZSLID        TSLIP                                         S0111
     C                   Z-ADD     SZIPBD        TIPBD                                         S0111
     C                   Z-ADD     SZIPBD        WTPBD                                        248300
     C                   Z-ADD     SZIACD        TIACD                                         S0111
     C* IN ORDER TO ALLOW DATE DEFAULT ABOVE TO TAKE EFFECT ONLY UPDATE   S01119
     C*     NEXT INTEREST PAYMENT DATE IF IT WAS NOT ORIGINALLY ZERO      S01119
     C     TNIPD         IFNE      0                                                           S0111
     C                   Z-ADD     SZNIPD        TNIPD                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   ELSE                                                                  S0111
     C* USER PROVIDER                                                     S01119
     C                   Z-ADD     SZSLID        ULPCD                                         S0111
     C                   MOVE      SZIPFC        UIPFR                                         S0111
     C                   Z-ADD     SZIPD         UIPFD                                         S0111
     C                   Z-ADD     SZSLID        USLIP                                         S0111
     C                   Z-ADD     SZIPBD        UIPBD                                         S0111
     C                   Z-ADD     SZIPBD        WUPBD                                        248300
     C                   Z-ADD     SZIACD        UIACD                                         S0111
     C* IN ORDER TO ALLOW DATE DEFAULT ABOVE TO TAKE EFFECT ONLY UPDATE   S01119
     C*     NEXT INTEREST PAYMENT DATE IF IT WAS NOT ORIGINALLY ZERO      S01119
     C     UNIPD         IFNE      0                                                           S0111
     C                   Z-ADD     SZNIPD        UNIPD                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C402
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  AS INTEREST PAYMENT DATE HAS BEEN PROCESSED SKIP TO UPDATE/NET   S01119
     C*  KEY GENERATION-THIS PREVENTS DATES BEING PROCESSED OUT OF        S01119
     C*  ORDER IF PROCESSING CONTINUES.E.G. IF PAYMENTS QUARTERLY AND     S01119
     C*  CHANGES MONTHLY EACH PAYMENT SHOULD BE FOLLOWED BY 3 CHANGES     S01119
     C                   GOTO      RLUIPD                                                      S0111
     C*                                                                   S01119
     C*   WORK INTEREST FIX DATE                                          S01119
     C*                                                                   S01119
     C     RLTIFD        TAG                                                    ** RLTIFD TAG**S0111
     C*                                                                   S01119
     C* NON-AVERAGE RATE                                                  S01119
     C*                                                                   S01119
     C     AVERRT        IFNE      'Y'                                                         S0111
     C*  IN ORDER TO CONTINUE WITH INTEREST FIX DATE IT MUST BE:          S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*  3) LESS THAN OR EQUAL TO NEXT INTEREST CHANGE DATE               S01119
     C*     IF NEXT INTEREST CHANGE DATE IS NON ZERO                      S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO INTEREST CHANGE DATE CHECK                       S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C     WINFD         IFGT      EVCD                                                        S0111
     C                   GOTO      RLTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WINFD         IFEQ      0                                                           S0111
     C                   GOTO      RLTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WINFD         IFGT      WINCD                                                       S0111
     C     WINCD         ANDGT     0                                                           S0111
     C                   GOTO      RLTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* PROVIDERS DAMSX RECORD TO BE PROCESSED                            S01119
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   MOVE      'U'           DTLUT                                         S0111
     C                   ELSE                                                                  S0111
     C                   MOVE      'T'           DTLUT                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* DATABASE ERROR IF NO RECORD PRESENT                               S01119
     C*                                                                   S01119
     C     *IN41         IFEQ      '0'                                                         S0111
     C**********         SETON                                        U7U8LR          S0111 AR547995
     C                   SETON                                        U5U7LR                AR547995
     C**********         EXCEPT    ERROR                                              S0111 AR547995
     C                   GOTO      EOJ                                                      AR547995
     C                   END                                                                   S0111
     C   LR              GOTO      RLSEND                                                      S0111
     C                   EXSR      IRSAMD                                                      S0111
      *                                                                                      BUG7726
      ** XRFIN should be blank after deal date processing.                                   BUG7726
      *                                                                                      BUG7726
     C     W#DDAT        IFEQ      '1'                                                       BUG7726
     C     CSW005        IFEQ      'Y'                                                       BUG7726
     C     CSW011        OREQ      'Y'                                                       BUG7726
     C     USRST         IFEQ      'P'                                                       BUG7726
     C                   MOVE      *BLANK        URFIN                                       BUG7726
     C                   ELSE                                                                BUG7726
     C                   MOVE      *BLANK        TRFIN                                       BUG7726
     C                   ENDIF                                                               BUG7726
     C                   ENDIF                                                               BUG7726
     C                   ENDIF                                                               BUG7726
      *                                                                                      BUG7726
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   GOTO      RLUIPD                                                      S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* AVERAGE RATE METHOD - PROCESS IF DEAL AMEND EXISTS                S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C*  IN ORDER TO CONTINUE WITH DEAL AMENDMENT RECORD THERE MUST BE:   S01119
     C*  1) A VALUE DATE LESS THAN OR EQUAL TO A NON-ZERO CHANGE DATE     S01119
     C*  2) IT MUST NOT ALREADY HAVE BEEN PROCESSED                       S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO INTEREST CHANGE DATE CHECK                       S01119
     C*                                                                   S01119
     C     WINCD         IFNE      0                                                           S0111
     C     VDATDM        ANDGT     WINCD                                                       S0111
     C                   GOTO      RLTICD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     FIXFLG        CABEQ     'Y'           RLTICD                                        S0111
     C*                                                                   S01119
     C*  FLAG THAT PROCESSING HAS TAKEN PLACE                             S01119
     C*                                                                   S01119
     C                   MOVE      'Y'           FIXFLG                                        S0111
     C*                                                                   S01119
     C* PROCESS PROVIDERS DETAILS                                         S01119
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     UBRTE         WBRTE                                         S0111
     C                   Z-ADD     URTSP         WRTSP                                         S0111
     C                   Z-ADD     UINFD         WINFD                                         S0111
     C                   MOVE      USPIN         WSPIN                                         S0111
     C                   Z-ADD     UEINR         WEINR                                         S0111
     C                   MOVE      UDNSI         WDNSI                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TBRTE         WBRTE                                         S0111
     C                   Z-ADD     TRTSP         WRTSP                                         S0111
     C                   Z-ADD     TINFD         WINFD                                         S0111
     C                   MOVE      TSPIN         WSPIN                                         S0111
     C                   Z-ADD     TEINR         WEINR                                         S0111
     C                   MOVE      TDNSI         WDNSI                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* DATABASE ERROR IF NO RECORD, AND IRS FLAG OFF, VDAT<=EVCD         S01119
     C* I.E. IF INITIAL RATE HAS NOT BEEN SET                             S01119
     C                   TESTB     '0'           WDNSI                    31                   S0111
     C     VDAT          IFLE      EVCD                                                        S0111
     C     *IN31         ANDEQ     '0'                                                         S0111
     C     *IN41         ANDNE     '1'                                                         S0111
     C**********         SETON                                        U7U8LR          S0111 AR547995
     C                   SETON                                        U5U7LR                AR547995
     C**********         EXCEPT    ERROR                                              S0111 AR547995
     C**********         GOTO      RLSEND                                             S0111 AR547995
     C                   GOTO      EOJ                                                      AR547995
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* NO RATE CHANGE PRESENT-SKIP TO CHANGE DATE                        S01119
     C     *IN41         CABEQ     '0'           RLTICD                                        S0111
     C*                                                                   S01119
     C                   TESTB     '1'           WDNSI                    31                   S0111
     C*                                                                   S01119
     C* AMEND AVERAGE CALCULATED RATE OFF                                 S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '0'                                          B              S0111
     C*                                                                   S01119
     C* BACK VALUED DEAL AMENDMENT - AACRT WILL NEED TO BE RESET          S01119
     C*                                                                   S01119
     C     VDATDM        IFLT      BJRDNB                                       * B            S0119
     C                   Z-ADD     0             WK5                            * *            S0111
     C                   TESTB     '0'           WDNSI                    31    * *            S0111
     C*                                                                   S01119
     C     WINFD         IFGT      0                                            * * B          S0111
     C     *IN31         OREQ      '1'                                          * * *          S0111
     C     VDATDM        SUB       WINFD         WK5                            * * *          S0111
     C                   END                                                    * * E          S0111
     C                   ADD       WK5           AVPER                          * *            S0111
     C     WK5           MULT      WEINR         WK158                          * *            S0111
     C                   ADD       WK158         TIRAT                          * *            S0111
     C                   Z-ADD     VDATDM        WINFD                          * *            S0111
     C*                                                                   S01119
     C* IF THIS IS THE FIRST RATE FIX, SET SDCAR AND SKIP TO UPDATE RATE  S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '0'                                          * * B          S0111
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C203                                           S01408
     C*                                                                   S01408
     C*****CIR006*****   IFEQ      'N'                                                CIR006 BUG7217
     C*****CIR006*****   OREQ      'Y'                                                CIR006 BUG7217
     C*****ULSDCR*****   ANDEQ     'N'                                                CIR006 BUG7217
     C     CIR006        IFEQ      'Y'                                                       BUG7217
     C     SDCAR         ANDEQ     0                                                         BUG7217
     C                   Z-ADD     VDAT          SDCAR                          * * *          S0111
     C                   ENDIF                                                                 CIR00
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C204                                           S01408
     C*                                                                   S01408
     C                   GOTO      RLINTR                                       * * *          S0111
     C                   END                                                    * * E          S0111
     C*                                                                   S01119
     C*  CHECK IF SPREAD HAS BEEN AMENDED TODAY                           S01119
     C*   I.E. DOES SPREAD APPLIED TO BASE RATE(ON DEAL) EQUAL            S01119
     C*   EFFECTIVE INTEREST RATE ON DEAL                                 S01119
     C     WSPIN         IFEQ      'A'                                          * * B          S0111
     C     WRTSP         ADD       WBRTE         EINR                           * * *          S0111
     C                   END                                                    * * E          S0111
     C     WSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     WBRTE         EINR                                          S0111
     C                   END                                                                   S0111
     C     WSPIN         IFEQ      'S'                                          * * B          S0111
     C     WBRTE         SUB       WRTSP         EINR                           * * *          S0111
     C                   END                                                    * * E          S0111
     C     WSPIN         IFEQ      'P'                                          * * B          S0111
     C     WRTSP         MULT      WBRTE         EINR                           * * *          S0111
     C     EINR          DIV(H)    100           WK139                          * * *          S0111
     C     WK139         ADD       WBRTE         EINR                           * * *          S0111
     C                   END                                                    * * E          S0111
     C*                                                                   S01119
     C*  IF RATE FOUND ABOVE IS DIFFERENT,FIND OLD SPREAD AND             S01119
     C*  CALCULATE OLD EFFECTIVE INTEREST RATE                            S01119
     C*                                                                   S01119
     C     EINR          IFNE      WEINR                                        * * B          S0111
     C     WSPIN         IFEQ      'A'                                          * * * B        S0111
     C     WEINR         SUB       WBRTE         ORTSP            11 7          * * * *        S0111
     C     ORTSP         ADD       RTSPDM        EINR                           * * * *        S0111
     C                   END                                                    * * * E        S0111
     C     WSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     RTSPDM        EINR                                          S0111
     C                   END                                                                   S0111
     C     WSPIN         IFEQ      'S'                                          * * * B        S0111
     C     WBRTE         SUB       WEINR         ORTSP                          * * * *        S0111
     C     RTSPDM        SUB       ORTSP         EINR                           * * * *        S0111
     C                   END                                                    * * * E        S0111
     C     WSPIN         IFEQ      'P'                                          * * * B        S0111
     C     WEINR         SUB       WBRTE         ORTSP                          * * * *        S0111
     C     100           DIV       WBRTE         EINR                           * * * *        S0111
     C     ORTSP         MULT(H)   EINR          ORTSP                          * * * *        S0111
     C*                                                                   S01119
     C     ORTSP         MULT      RTSPDM        EINR                           * * * *        S0111
     C     EINR          DIV(H)    100           WK139                          * * * *        S0111
     C     WK139         ADD       RTSPDM        EINR                           * * * *        S0111
     C                   END                                                    * * * E        S0111
     C*                                                                   S01119
     C     BJRDNB        SUB       WINFD         WK5                            * * *          S0119
     C     EINR          MULT      WK5           WK158                          * * *          S0111
     C                   ADD       WK5           AVPER                          * * *          S0111
     C                   ADD       WK158         TIRAT                          * * *          S0111
     C                   Z-ADD     BJRDNB        WINFD                          * * *          S0119
     C                   END                                                    * * E          S0111
     C*                                                                   S01119
     C* AMEND EFFECTIVE INTEREST RATE                                     S01119
     C*                                                                   S01119
     C     RLINTR        TAG                                                     ** RLINTR TAG*S0111
     C*                                                                   S01119
     C                   Z-ADD     RTSPDM        WBRTE                                         S0111
     C     WSPIN         IFEQ      'A'                                          B              S0111
     C     WRTSP         ADD       WBRTE         WEINR                          *              S0111
     C                   END                                                    E              S0111
     C     WSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     WBRTE         WEINR                                         S0111
     C                   END                                                                   S0111
     C     WSPIN         IFEQ      'S'                                          B              S0111
     C     WBRTE         SUB       WRTSP         WEINR                                         S0111
     C                   END                                                    E              S0111
     C     WSPIN         IFEQ      'P'                                          B              S0111
     C     WRTSP         MULT      WBRTE         EINR                           *              S0111
     C     EINR          DIV(H)    100           WK139                          *              S0111
     C     WK139         ADD       WBRTE         WEINR                          *              S0111
     C                   END                                                    E              S0111
     C*                                                                   S01119
     C*  CALCULATE AVERAGE RATE APPLICABLE TODAY                          S01119
     C*                                                                   S01119
     C     BJRDNB        SUB       WINFD         WK5                                           S0119
     C     WK5           MULT      WEINR         WK158                                         S0111
     C     AVPER         ADD       WK5           WK5                                           S0111
     C     TIRAT         ADD       WK158         WK158                                         S0111
     C     WK5           IFNE      0                                                           S0111
     C     WK158         DIV(H)    WK5           AACRT                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* IF VALUED TODAY, AMEND TOTAL INTEREST RATE                        S01119
     C*                                                                   S01119
     C     VDATDM        IFEQ      BJRDNB                                                      S0119
     C                   Z-ADD     0             WK5                                           S0111
     C                   TESTB     '0'           WDNSI                    31                   S0111
     C*                                                                   S01119
     C* SET SDCAR IF THIS IS FIRST RATE FIX                               S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '0'                                          * * B          S0111
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C205                                           S01408
     C*                                                                   S01408
     C*****CIR006*****   IFEQ      'N'                                                CIR006 BUG7217
     C*****CIR006*****   OREQ      'Y'                                                CIR006 BUG7217
     C*****ULSDCR*****   ANDEQ     'N'                                                CIR006 BUG7217
     C     CIR006        IFEQ      'Y'                                                       BUG7217
     C     SDCAR         ANDEQ     0                                                         BUG7217
     C                   Z-ADD     VDAT          SDCAR                          * * *          S0111
     C                   ENDIF                                                                 CIR00
     C                   END                                                    * * E          S0111
     C*                                                                   S01119
     C     WINFD         IFGT      0                                                           S0111
     C     *IN31         OREQ      '1'                                                         S0111
     C     VDATDM        SUB       WINFD         WK5                                           S0111
     C                   END                                                                   S0111
     C                   ADD       WK5           AVPER                                         S0111
     C     WK5           MULT      WEINR         WK158                                         S0111
     C                   ADD       WK158         TIRAT                                         S0111
     C                   Z-ADD     BJRDNB        WINFD                                         S0119
     C     AVPER         IFNE      0                                                           S0111
     C     TIRAT         DIV       AVPER         AACRT                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             AACRT                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* APPLY DEAL AMENDMENT TO RECORD GIVING EFFECTIVE INTEREST RATE     S01119
     C*                                                                   S01119
     C                   Z-ADD     RTSPDM        WBRTE                                         S0111
     C     WSPIN         IFEQ      'A'                                          B              S0111
     C     WRTSP         ADD       WBRTE         WEINR                          *              S0111
     C                   END                                                    E              S0111
     C     WSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     WBRTE         WEINR                                         S0111
     C                   END                                                                   S0111
     C     WSPIN         IFEQ      'S'                                          B              S0111
     C     WBRTE         SUB       WRTSP         WEINR                          *              S0111
     C                   END                                                    E              S0111
     C     WSPIN         IFEQ      'P'                                          B              S0111
     C     WRTSP         MULT      WBRTE         EINR                           *              S0111
     C     EINR          DIV(H)    100           WK139                          *              S0111
     C     WK139         ADD       WBRTE         WEINR                          *              S0111
     C                   END                                                    E              S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*    AMEND ACTUAL AVERAGE CALCULATED RATE IND IS ON                 S01119
     C*                                                                   S01119
     C                   ELSE                                                   X              S0111
     C*                                                                   S01119
     C* SET SDCAR IF THIS IS FIRST RATE FIX                               S01119
     C*                                                                   S01119
     C                   TESTB     '0'           WDNSI                    31    *              S0111
     C     *IN31         IFEQ      '0'                                          * B            S0111
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C206                                           S01408
     C*                                                                   S01408
     C                   Z-ADD     VDAT          SDCAR                          * *            S0111
     C                   END                                                    * E            S0111
     C*                                                                   S01119
     C*                                                                   S01119
     C* APPLY DEAL AMENDMENT TO RECORD GIVING EFFECTIVE INTEREST RATE     S01119
     C*                                                                   S01119
     C                   Z-ADD     RTSPDM        WBRTE                                         S0111
     C     WSPIN         IFEQ      'A'                                          B              S0111
     C     WRTSP         ADD       WBRTE         WEINR                          *              S0111
     C                   END                                                    E              S0111
     C     WSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     WBRTE         WEINR                                         S0111
     C                   END                                                                   S0111
     C     WSPIN         IFEQ      'S'                                          B              S0111
     C     WBRTE         SUB       WRTSP         WEINR                          *              S0111
     C                   END                                                    E              S0111
     C     WSPIN         IFEQ      'P'                                          B              S0111
     C     WRTSP         MULT      WBRTE         EINR                           *              S0111
     C     EINR          DIV(H)    100           WK139                          *              S0111
     C     WK139         ADD       WBRTE         WEINR                          *              S0111
     C                   END                                                    E              S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*   UPDATE PROVIDER'S FIELDS BASED ON TAKER/PROVIDER INDICATOR      S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     WEINR         UEINR                                         S0111
     C                   Z-ADD     WBRTE         UBRTE                                         S0111
     C                   Z-ADD     WINFD         UINFD                                         S0111
     C                   BITON     '0'           UDNSI                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     WEINR         TEINR                                         S0111
     C                   Z-ADD     WBRTE         TBRTE                                         S0111
     C                   Z-ADD     WINFD         TINFD                                         S0111
     C                   BITON     '0'           TDNSI                                         S0111
     C                   END                                                                   S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C                   GOTO      RLUIPD                                                      S0111
     C*                                                                   S01119
     C*  CHANGE DATE PROCESSING                                           S01119
     C*                                                                   S01119
     C     RLTICD        TAG                                                    ** RLTICD TAG**S0111
     C*  IN ORDER TO CONTINUE WITH INTEREST CHANGE DATE IT MUST BE:       S01119
     C*  1) LESS THAN OR EQUAL TO EVENT CONTROL DATE                      S01119
     C*  2) NOT ZERO                                                      S01119
     C*         IF ANY OF THESE CONDITIONS IS NOT FULFILLED SKIP          S01119
     C*               TO RR/RP/RF UPDATE SECTION                          S01157
     C*                                                                   S01119
     C*                                                                   S01119
     C     WINCD         IFGT      EVCD                                                        S0111
     C                   GOTO      RLUIPD                                                      S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     WINCD         IFEQ      0                                                           S0111
     C                   GOTO      RLUIPD                                                      S0111
     C                   END                                                                   S0111
      *                                                                                      BUG7726
      ** If CSW005 is switched on set rate fixing indicator to blanks                        BUG7726
      *                                                                                      BUG7726
     C     CSW005        IFEQ      'Y'                                                       BUG7726
     C     CSW011        OREQ      'Y'                                                       BUG7726
     C     USRST         IFEQ      'P'                                                       BUG7726
     C                   MOVE      *BLANK        URFIN                                       BUG7726
     C                   BITOFF    '4'           CNFI                                        BUG7726
     C                   ELSE                                                       BUG7726
     C                   MOVE      *BLANK        TRFIN                                       BUG7726
     C                   BITOFF    '5'           CNFI                                        BUG7726
     C                   ENDIF                                                               BUG7726
     C                   ENDIF                                                               BUG7726
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     UNICD         WNICD                                         S0111
     C                   Z-ADD     USLIP         WSLIP                                         S0111
     C                   Z-ADD     UIACD         WIACD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TSLIP         WSLIP                                         S0111
     C                   Z-ADD     TIACD         WIACD                                         S0111
     C                   Z-ADD     TNICD         WNICD                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  REIMBURSEMENT/TOPPING UP RATE CALCULATION                        S01119
     C*                                                                   S01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C* AVERAGE RATE CALCULATION FOR CASE WHERE CHANGE DATE               S01119
     C*    FALLS AFTER RUND BUT BEFORE DNWD                               S01119
     C     WINCD         IFGT      BJRDNB                                                      S0119
     C     USRST         IFEQ      'P'                                                         S0111
     C     WINCD         SUB       UINFD         WK5                                           S0111
     C     UEINR         MULT      WK5           WK158                                         S0111
     C                   ELSE                                                                  S0111
     C     WINCD         SUB       TINFD         WK5                                           S0111
     C     TEINR         MULT      WK5           WK158                                         S0111
     C                   END                                                                   S0111
     C     AVPER         ADD       WK5           WK5                                           S0111
     C     WK158         ADD       TIRAT         WK158                                         S0111
     C*                                                                   S01119
     C     WK5           IFNE      0                                                           S0111
     C     WK158         DIV(H)    WK5           AACRT                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C                   Z-ADD     AACRT         EINR                                          S0111
     C                   ELSE                                                                  S0111
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     UEINR         EINR                                          S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TEINR         EINR                                          S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     EINR          SUB       CLRAT         REIMRT           11 7  31                     S0111
     C   31              Z-ADD     0             REIMRT                                        S0111
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C     FLRAT         SUB       EINR          TPUPRT           11 7  31                     S0111
     C   31              Z-ADD     0             TPUPRT                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* SET APPROPRIATE INTEREST RATE IN ORDER TO BRING ACCRUAL           S01119
     C* FIGURES UP TO DATE OF RATE CHANGE                                 S01119
     C*                                                                   S01119
     C                   SETOFF                                         31                     S0111
     C*  THEIR DETAILS                                                    S01119
     C     USRST         IFEQ      'P'                                                         E2340
     C     FLRRTF        ANDEQ     'Y'                                                         S0111
     C* USE TOPPING UP RATE FOR C'PARTY(TAKER)                            E23400
     C                   Z-ADD     TPUPRT        ZIRATE               31  31                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     USRST         IFEQ      'T'                                                         E2340
     C     FLRRTF        ANDNE     'Y'                                                         09460
     C* USE REIMBURSEMENT RATE FOR C'PARTY(PROVIDER)                      E23400
     C                   Z-ADD     REIMRT        ZIRATE               31  31                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  PROCESS THEIR DETAILS IF REQUIRED                                S01119
     C*                                                                   S01119
     C  N31              GOTO      RL1                                                         S0111
     C*                                                                   S01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C*  ONLY CALCULATE INTEREST FOR AVERAGE IF NOT A PAYMENT DATE        S01119
     C     WNICD         IFNE      WSLIP                                                       S0111
     C                   Z-ADD     SDCAR         ZIBEG                                         S0111
     C                   Z-ADD     WNICD         ZIEND                                         S0111
     C                   Z-ADD     TICBS         ZICALC                                        S0111
     C                   Z-ADD     TPAMT         ZIAMT                                         S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add their unsettled interest and    t  CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP66                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP67                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             WKINT                                         S0111
     C                   END                                                                   S0111
     C*  INITIALISE FIELDS FOR AVERAGE RATE                               S01119
     C                   Z-ADD     0             AVPER                                         S0111
     C                   Z-ADD     0             TIRAT                                         S0111
     C                   Z-ADD     WNICD         WINFD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     WIACD         ZIBEG                                         S0111
     C                   Z-ADD     WNICD         ZIEND                                         S0111
     C                   Z-ADD     TICBS         ZICALC                                        S0111
     C                   Z-ADD     TPAMT         ZIAMT                                         S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add their unsettled interest and    t  CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          ZIAMT                                         CIR00
     C                   ADD       TUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C*                                                                   S01119
     C*  CALCULATE INTEREST                                               S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0280CP68                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP69                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C                   Z-ADD     WNICD         WLPCD                                         S0111
     C                   END                                                                   S0111
     C*  INITIALISE FIELDS FOR NON AVERAGE DEALS                          S01119
     C                   ADD       WKINT         TAITC                                         S0111
     C                   Z-ADD     0             TIALC                                         S0111
     C                   Z-ADD     WNICD         WIACD                                         S0111
     C*                                                                   CIR002
     C** Add the interest amount computed to their unsettled interest     CIR002
     C** amount.                                                          CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         TUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C*  SET RATE FOR OUR DETAILS                                         S01119
     C*                                                                   S01119
     C     RL1           TAG                                                      *** RL1 TAG**S0111
     C                   SETOFF                                         31                     S0111
     C     USRST         IFEQ      'T'                                                         E2340
     C     FLRRTF        ANDEQ     'Y'                                                         S0111
     C* USE TOPPING UP RATE FOR USER(TAKER)                               E23400
     C                   Z-ADD     TPUPRT        ZIRATE               31  31                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         E2340
     C     FLRRTF        ANDNE     'Y'                                                         09460
     C* USE REIMBURSEMENT RATE FOR USER(PROVIDER)                         E23400
     C                   Z-ADD     REIMRT        ZIRATE               31  31                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* PROCESS OUR DETAILS IF REQURIED                                   S01119
     C*                                                                   S01119
     C  N31              GOTO      RL2                                                         S0111
     C*                                                                   S01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C*  ONLY CALCULATE INTEREST FOR AVERAGE IF NOT A PAYMENT DATE        S01119
     C     WNICD         IFNE      WSLIP                                                       S0111
     C                   Z-ADD     SDCAR         ZIBEG                                         S0111
     C                   Z-ADD     WNICD         ZIEND                                         S0111
     C                   Z-ADD     UICBS         ZICALC                                        S0111
     C                   Z-ADD     UPAMT         ZIAMT                                         S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add our unsettled interest and      t  CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP70                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP71                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             WKINT                                         S0111
     C                   END                                                                   S0111
     C*  INITIALISE FIELDS FOR AVERAGE RATE                               S01119
     C                   Z-ADD     0             AVPER                                         S0111
     C                   Z-ADD     0             TIRAT                                         S0111
     C                   Z-ADD     WNICD         WINFD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     WIACD         ZIBEG                                         S0111
     C                   Z-ADD     WNICD         ZIEND                                         S0111
     C                   Z-ADD     UICBS         ZICALC                                        S0111
     C                   Z-ADD     UPAMT         ZIAMT                                         S0111
     C*                                                                   CIR002
     C** If CIR002 is switched on, add our unsettled interest and      t  CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          ZIAMT                                         CIR00
     C                   ADD       OUSA          ZIAMT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0280CP72                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP73                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C*                                                                   S01119
     C* UPDATE DATES                                                      S01119
     C*                                                                   S01119
     C                   Z-ADD     WNICD         WLPCD                                         S0111
     C                   END                                                                   S0111
     C*  INITIALISE FIELDS FOR NON AVERAGE RATE DEALS                     S01119
     C                   ADD       WKINT         UAITC                                         S0111
     C                   Z-ADD     0             UIALC                                         S0111
     C                   Z-ADD     WNICD         WIACD                                         S0111
     C*                                                                   CIR002
     C** Add the interest amount computed to our unsettled interest       CIR002
     C** amount.                                                          CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       WKINT         OUSI                                          CIR00
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C     RL2           TAG                                                    *** RL2 TAG ***S0111
     C*                                                                   S01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C*  UPDATE SDCAR HERE AS IT MAY HAVE HAD TO BE USED IN BOTH          S01119
     C*  INTEREST CALCULATIONS ABOVE                                      S01119
     C                   Z-ADD     WNICD         SDCAR                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  UPDATE PROVIDER'S FIELDS                                         S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C*                                                                   S01119
     C                   Z-ADD     WNICD         UNICD                                         S0111
     C                   Z-ADD     WIACD         UIACD                                         S0111
     C                   Z-ADD     WINFD         UINFD                                         S0111
     C                   Z-ADD     WLPCD         ULPCD                                         S0111
     C*                                                                   S01119
     C*  HAVING UPDATED BASE RATE DURING RATE FIX PROCESSING APPLY        S01119
     C*  SPREAD IN LINE WITH INDICATOR : ADD,SUB AND ADD PERCENTAGE       S01119
     C     USPIN         IFEQ      'A'                                                         S0111
     C     URTSP         ADD       UBRTE         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     UBRTE         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      'S'                                                         S0111
     C     UBRTE         SUB       URTSP         UEINR                                         S0111
     C                   END                                                                   S0111
     C     USPIN         IFEQ      'P'                                                         S0111
     C     URTSP         MULT      UBRTE         EINR                                          S0111
     C     EINR          DIV(H)    100           UEINR                                         S0111
     C     UEINR         ADD       UBRTE         UEINR                                         S0111
     C                   END                                                                   S0111
     C**  UPDATE DATES IF FREQUENCY NON BLANK                             S01119
     C     UICFR         IFNE      ' '                                                         S0111
     C                   MOVE      UICFR         ZFREQ                                         S0111
     C                   Z-ADD     UICBD         ZDAYNO                                        S0111
     C                   Z-ADD     UICFD         ZMDAY                                         S0111
     C                   MOVE      UCUCY         ZCCY                                          S0111
     C                   MOVE      BJSLCD        ZLOC                                          S0119
      *                                                                   CIR005
     C     CIR005        IFEQ      'N'                                                         CIR00
     C     L1CYP1        OREQ      *BLANKS                                                     CIR00
      *                                                                   CIR005
     C                   EXSR      ZFREQC                                                      S0119
     C                   Z-ADD     0             ZNRDYS                                        S0119
     C                   MOVE      BJSLCD        ZLOC                                          S0119
     C                   EXSR      ZFWDT                                                       S0119
      *                                                                   CIR005
     C                   ELSE                                                                  CIR00
     C                   EXSR      ZFRQB3                                                      CIR00
      *                                                                   CIR005
     C                   CALL      'DLZIRP'                                                    CIR00
     C                   PARM                    ZDAYNO                                        CIR00
     C                   PARM      CCYPY1        PCURR                                         CIR00
     C                   PARM      L1PDCN        PPDCN                                         CIR00
     C                   PARM                    ZLOC                                          CIR00
     C                   PARM                    BJDFIN                                        CIR00
     C                   PARM      *ZEROS        PAJDT                                         CIR00
     C                   PARM      *ZEROS        PBSDT                                         CIR00
     C                   Z-ADD     PAJDT         ZDYNBR                                        CIR00
     C                   Z-ADD     PBSDT         ZDAYNO                                        CIR00
      *                                                                   CIR005
      ** Do not return adjusted date if it is equal to or earlier than    CIR005
      ** previous date (only happens for 'previous' date calculations);   CIR005
      ** instead use the base date                                        CIR005
      *                                                                   CIR005
     C     UICBD         IFGE      ZDYNBR                                                      CIR00
     C                   Z-ADD     PBSDT         ZDYNBR                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR005
     C     ZDYNBR        IFLT      MDAT                                                        S0111
     C                   Z-ADD     ZDAYNO        UICBD                                         S0111
     C                   Z-ADD     ZDYNBR        UNICD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             UICBD                                         S0111
     C                   Z-ADD     0             UNICD                                         S0111
     C                   MOVE      ' '           UICFR                                         S0111
     C                   Z-ADD     0             UICFD                                         S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             UICBD                                         S0111
     C                   Z-ADD     0             UNICD                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C*                                                                   S01119
     C*  HAVING UPDATED BASE RATE DURING RATE FIX PROCESSING APPLY        S01119
     C*  SPREAD IN LINE WITH INDICATOR : ADD,SUB AND ADD PERCENTAGE       S01119
     C                   Z-ADD     WIACD         TIACD                                         S0111
     C                   Z-ADD     WNICD         TNICD                                         S0111
     C                   Z-ADD     WINFD         TINFD                                         S0111
     C                   Z-ADD     WLPCD         TLPCD                                         S0111
     C*                                                                   S01119
     C*                                                                   S01119
     C*  HAVING UPDATED BASE RATE DURING RATE FIX PROCESSING APPLY        S01119
     C*  SPREAD IN LINE WITH INDICATOR : ADD,SUB AND ADD PERCENTAGE       S01119
     C     TSPIN         IFEQ      'A'                                                         S0111
     C     TRTSP         ADD       TBRTE         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      ' '                                                         S0111
     C                   Z-ADD     TBRTE         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      'S'                                                         S0111
     C     TBRTE         SUB       TRTSP         TEINR                                         S0111
     C                   END                                                                   S0111
     C     TSPIN         IFEQ      'P'                                                         S0111
     C     TRTSP         MULT      TBRTE         EINR                                          S0111
     C     EINR          DIV(H)    100           TEINR                                         S0111
     C     TEINR         ADD       TBRTE         TEINR                                         S0111
     C                   END                                                                   S0111
     C**  UPDATE DATES IF FREQUENCY NON BLANK                             S01119
     C     TICFR         IFNE      ' '                                                         S0111
     C                   MOVE      TICFR         ZFREQ                                         S0111
     C                   Z-ADD     TICBD         ZDAYNO                                        S0111
     C                   Z-ADD     TICFD         ZMDAY                                         S0111
     C                   MOVE      TCUCY         ZCCY                                          S0111
     C                   MOVE      BJSLCD        ZLOC                                          S0119
      *                                                                   CIR005
     C     CIR005        IFEQ      'N'                                                         CIR00
     C     L1CYP1        OREQ      *BLANKS                                                     CIR00
      *                                                                   CIR005
     C                   EXSR      ZFREQC                                                      S0119
     C                   Z-ADD     0             ZNRDYS                                        S0119
     C                   MOVE      BJSLCD        ZLOC                                          S0119
     C                   EXSR      ZFWDT                                                       S0119
      *                                                                   CIR005
     C                   ELSE                                                                  CIR00
     C                   EXSR      ZFRQB3                                                      CIR00
      *                                                                   CIR005
     C                   CALL      'DLZIRP'                                                    CIR00
     C                   PARM                    ZDAYNO                                        CIR00
     C                   PARM      CCYPY1        PCURR                                         CIR00
     C                   PARM      L1PDCN        PPDCN                                         CIR00
     C                   PARM                    ZLOC                                          CIR00
     C                   PARM                    BJDFIN                                        CIR00
     C                   PARM      *ZEROS        PAJDT                                         CIR00
     C                   PARM      *ZEROS        PBSDT                                         CIR00
     C                   Z-ADD     PAJDT         ZDYNBR                                        CIR00
     C                   Z-ADD     PBSDT         ZDAYNO                                        CIR00
      *                                                                   CIR005
      ** Do not return adjusted date if it is equal to or earlier than    CIR005
      ** previous date (only happens for 'previous' date calculations);   CIR005
      ** instead use the base date                                        CIR005
      *                                                                   CIR005
     C     TICBD         IFGE      ZDYNBR                                                      CIR00
     C                   Z-ADD     PBSDT         ZDYNBR                                        CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR005
     C     ZDYNBR        IFLT      MDAT                                                        S0111
     C                   Z-ADD     ZDAYNO        TICBD                                         S0111
     C                   Z-ADD     ZDYNBR        TNICD                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             TICBD                                         S0111
     C                   Z-ADD     0             TNICD                                         S0111
     C                   MOVE      ' '           TICFR                                         S0111
     C                   Z-ADD     0             TICFD                                         S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     0             TICBD                                         S0111
     C                   Z-ADD     0             TNICD                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C** UPDATES AND NET KEYS                                             S01119
     C*                                                                   S01119
     C     RLUIPD        TAG                                                    ** RLUIPD TAG**S0111
     C*                                                                   S01119
     C     PRINT         IFEQ      'Y'                                                         S0111
     C*                                                                   S01119
     C* BOTH SETS OF DETAILS                                              S01119
     C*                                                                   S01119
     C     WINOTT        IFNE      0                                                           S0111
     C     WINOTU        ANDNE     0                                                           S0111
     C*                                                                   S01119
     C* CALCULATE NET SETTLEMENT AMOUNT IF OURS GREATER                   S01119
     C*                                                                   061873
     C     WINOTU        IFGE      WINOTT                                                      S0111
     C/COPY WNCPYSRC,DL0280C469
     C     *IN19         ANDEQ     *ON                                                         08060
     C/COPY WNCPYSRC,DL0280C470
     C     WINOTU        SUB       WINOTT        KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   MOVEA     'PN'          AKY(9)                                        S0111
     C                   EXSR      EXCP                                                        S0111
     C     UNSAM         ADD       KYAMT         UNSAM                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* CALCULATE NET SETTLEMENT AMOUNT IF THEIRS GREATER                 S01119
     C*                                                                   061873
     C     WINOTT        IFGT      WINOTU                                                      S0111
     C/COPY WNCPYSRC,DL0280C471
     C     *IN19         ANDEQ     *ON                                                         08060
     C/COPY WNCPYSRC,DL0280C472
     C     WINOTT        SUB       WINOTU        KYAMT                                         S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   MOVEA     'RN'          AKY(9)                                        S0111
     C                   EXSR      EXCP                                                        S0111
     C     TNSAM         ADD       KYAMT         TNSAM                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C* OUR DETAILS ONLY                                                  S01119
     C*                                                                   S01119
     C     WINOTT        IFEQ      0                                                           S0111
     C     WINOTU        ANDNE     0                                                           S0111
     C/COPY WNCPYSRC,DL0280C473
     C     *IN19         ANDEQ     *ON                                                         08060
     C/COPY WNCPYSRC,DL0280C474
     C                   Z-ADD     WINOTU        KYAMT                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   MOVEA     'PN'          AKY(9)                                        S0111
     C     USRST         IFEQ      'P'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                      AR812349
     C     DTYP          ANDEQ     'RF'                                                     AR812349
     C     USRST         OREQ      'P'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                      AR812349
     C     DTYP          ANDEQ     'RR'                                                     AR812349
     C     TPUPRT        ANDNE     0                                                        AR812349
     C                   MOVE      'R'           AKY(9)                                     AR812349
     C                   MOVE      TFRDKY        FRDKY                                      AR812349
     C                   ENDIF                                                              AR812349
     C                   EXSR      EXCP                                                        S0111
     C     UNSAM         ADD       KYAMT         UNSAM                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* THEIR DETAILS ONLY                                                S01119
     C*                                                                   S01119
     C     WINOTU        IFEQ      0                                                           S0111
     C     WINOTT        ANDNE     0                                                           S0111
     C/COPY WNCPYSRC,DL0280C475
     C     *IN19         ANDEQ     *ON                                                         08060
     C/COPY WNCPYSRC,DL0280C476
     C                   Z-ADD     WINOTT        KYAMT                                         S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C                   MOVEA     'RN'          AKY(9)                                        S0111
     C     USRST         IFEQ      'T'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                      AR812349
     C     DTYP          ANDEQ     'RF'                                                     AR812349
     C     USRST         OREQ      'T'                                                      AR812349
     C     FLRRTF        ANDEQ     'Y'                                                      AR812349
     C     DTYP          ANDEQ     'RR'                                                     AR812349
     C     TPUPRT        ANDNE     0                                                        AR812349
     C                   MOVE      UFRDKY        FRDKY                                      AR812349
     C                   MOVE      'P'           AKY(9)                                     AR812349
     C                   ENDIF                                                              AR812349
     C                   EXSR      EXCP                                                        S0111
     C     TNSAM         ADD       KYAMT         TNSAM                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* CLEAR INDICATOR FOR PRINT OF TAX AMOUNT                           S01119
     C                   SETOFF                                       33                       S0111
     C*                                                                   S01119
     C* PRINT LINE - CEILING                                              S01119
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     WINOTU        NRRSAL                                        S0111
     C*                                                                   S01119
     C* SET INDICATOR FOR PRINT OF TAXABLE AMOUNT:                        S01119
     C**1)*IF*USER*IS*PROVIDER,*****NEG. INT. *NE Y AND DEAL IS TAXAS01119E23400
     C**2)*IF*USER*IS*NOT*PROVIDER,*NEG. INT. *EQ Y AND DEAL IS TAXAS01119E23400
     C*                                                                   S01119
     C     TAXI          IFEQ      'Y'                                                         S0111
     C                   SETON                                        33                       S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     USRST         IFEQ      'T'                                                         E2340
     C                   Z-ADD     WINOTT        NRRSAL                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   Z-ADD     CLRAT         NRRT                                          S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   SETON                                        71                       S0111
     C                   MOVEL     NEV(3)        NARREV                                        06014
     C                   MOVE      'Y'           PRONLY                                        S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C                   SETOFF                                       33        TAXA PRT IND.  S0111
     C*                                                                   S01119
     C* PRINT LINE - CALCULATED RATE                                      S01119
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     UEINR         NRRT                                          S0111
     C                   MOVE      UBRTT         NRBRTT                                        S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TEINR         NRRT                                          S0111
     C                   MOVE      TBRTT         NRBRTT                                        S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C                   END                                                                   S0111
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C                   Z-ADD     AACRT         NRRT                                          S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C* PRINT LINE - FLOOR                                                S01119
     C*                                                                   S01119
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     WINOTT        NRRSAL                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     USRST         IFEQ      'T'                                                         E2340
     C                   Z-ADD     WINOTU        NRRSAL                                        S0111
     C*                                                                   S01119
     C* SET INDICATOR TO PRINT TAXABLE AMOUNT:                            S01119
     C*                                                                   S01119
     C     TAXI          IFEQ      'Y'                                                         S0111
     C                   SETON                                        33                       S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   EXCEPT    FLOOR                                                       S0111
     C                   ADD       1             PLINES                                        LN088
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* CLEAR TAX AMOUNT                                                  S01119
     C                   Z-ADD     0             TAXA                                          S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*                                                                   S01119
     C*   NEXT INTEREST PAYMENT DATE WORK FIELDS SHOULD BE UPDATED        S01119
     C*    TO REFLECT CHANGES ARISING FROM EVENT DATE PROCESSING          S01119
     C*       E.G. IF DEFAULTING TO CHANGE DATES WHICH HAVE BEEN          S01119
     C*                    INCREMENTED                                    S01119
     C*   THEIR WORK FIELD                                                S01119
     C     USRST         IFEQ      'T'                                                         S0111
     C     TNIPD         IFEQ      0                                                           S0111
     C     TNICD         IFNE      0                                                           S0111
     C                   Z-ADD     TNICD         WNIPD             5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPD                                         S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TNIPD         WNIPD                                         S0111
     C                   END                                                                   S0111
     C                   Z-ADD     TINFD         WINFD             5 0                         S0111
     C                   Z-ADD     TIACD         WIACD             5 0                         S0111
     C                   Z-ADD     TNICD         WINCD             5 0                         S0111
     C                   Z-ADD     TSLIP         WSLIP             5 0                         S0111
     C                   Z-ADD     TIPBD         WIPBD             5 0                         S0111
     C                   Z-ADD     TLPCD         WLPCD             5 0                         S0111
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C*   OUR WORK FIELD                                                  S01119
     C*                                                                   S01119
     C     UNIPD         IFEQ      0                                                           S0111
     C     UNICD         IFNE      0                                                           S0111
     C                   Z-ADD     UNICD         WNIPD             5 0                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     MDAT          WNIPD                                         S0111
     C                   END                                                                   S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     UNIPD         WNIPD                                         S0111
     C                   END                                                                   S0111
     C                   Z-ADD     UINFD         WINFD                                         S0111
     C                   Z-ADD     UIACD         WIACD             5 0                         S0111
     C                   Z-ADD     UNICD         WINCD                                         S0111
     C                   Z-ADD     USLIP         WSLIP                                         S0111
     C                   Z-ADD     UIPBD         WIPBD                                         S0111
     C                   Z-ADD     ULPCD         WLPCD                                         S0111
     C                   END                                                                   S0111
     C/COPY WNCPYSRC,DL0280C430
     C*                                                                   S01119
     C** RESET WORK FIELDS                                                S01119
     C*                                                                   S01119
     C                   MOVE      ' '           PRINT                                         S0111
     C                   Z-ADD     0             WINOTT                                        S0111
     C                   Z-ADD     0             WINOTU                                        S0111
     C                   Z-ADD     0             REIMRT                                        S0111
     C                   Z-ADD     0             TPUPRT                                        S0111
     C*                                                                   S01119
     C** SET OFF FLAGS & RETURN TO NON-SHADOW POST DATE PROCESSING        S01119
     C*         IN ORDER TO PROCESS NEXT EVENT DATE IN SEQUENCE           S01119
     C   U1              GOTO      RLDATE                                                      S0111
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C                   GOTO      RLMDAT                                                      CIR00
     C                   ENDIF                                                                 CIR00
     C  NU1              GOTO      RLSEND                                                      S0111
     C*                                                                   S01119
     C     RLMDAT        TAG                                                    ** RLMDAT TAG**S0111
     C/COPY WNCPYSRC,DL0280C431
     C*                                                                   S01119
     C* MATURITY DATE PROCESSING                                          S01119
     C*                                                                   S01119
     C                   TESTB     '2'           ACEI                 31                       S0111
     C     MDAT          IFLE      EVCD                                                        S0111
     C     *IN31         ANDEQ     '1'                                                         S0111
      *                                                                   CIR006
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     BOVD          ANDLE     EVCD                                                        CIR00
     C     BOVD          ANDNE     0                                                           CIR00
     C     *IN31         ANDEQ     '1'                                                         CIR00
      *                                                                   CIR006
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C     BOVD          ANDNE     0                                                           CIR00
     C                   Z-ADD     BOVD          KYDAT                                         CIR00
     C                   Z-ADD     BOVD          KYFED                                         CIR00
     C                   MOVEL     NEV(10)       NARREV                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     MDAT          KYDAT                                         CIR00
     C                   Z-ADD     MDAT          KYFED                                         CIR00
     C                   MOVEL     NEV(4)        NARREV                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C     CIR006        IFEQ      'Y'                                                         CIR00
     C     BOVD          IFNE      0                                                           CIR00
     C                   CLEAR                   AKY                                           CIR00
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVEA     'V'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     BAPR          AKY(9)                                        CIR00
     C                   MOVEA     'B'           AKY(10)                                       CIR00
     C                   Z-ADD     BOAM          KYAMT                                         CIR00
     C     BAPR          IFEQ      'P'                                                         CIR00
     C                   ADD       BOAM          UIPRD                                         CIR00
     C                   ADD       BOAM          UIPRM                                         CIR00
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVEL     PSCY          KYSCY                                         CIR00
     C                   MOVEL     PSETM         KYSETL                                        CIR00
     C                   MOVEL     UPACC         KYOSTL                                        CIR00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   ENDIF                                                                 CIR00
     C     BAPR          IFEQ      'R'                                                         CIR00
     C                   ADD       BOAM          TIPRD                                         CIR00
     C                   ADD       BOAM          TIPRM                                         CIR00
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVEL     RSCY          KYSCY                                         CIR00
     C                   MOVEL     RSETM         KYSETL                                        CIR00
     C                   MOVEL     URACC         KYOSTL                                        CIR00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   EXSR      EXCP                                                        CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C     *INU1         IFEQ      '0'                                                         CIR00
     C                   GOTO      RLSEND                                                      CIR00
     C                   ENDIF                                                                 CIR00
     C                   ENDIF                                                                 CIR00
      *                                                                   CIR006
     C                   Z-ADD     MDAT          KYDAT                                         S0111
     C                   Z-ADD     MDAT          KYFED                                         S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C                   Z-ADD     UPAMT         KYAMT                                         S0111
     C                   MOVEA     'RLM'         AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C* PRINCIPAL KEY                                                     S01119
     C                   MOVEA     '    A'       AKY(6)                                        S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C***   SUPPRESS PRINT OF ZERO BASE RATE                              S01119
     C     NRBRTT        IFEQ      '00'                                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   EXSR      EXCP                                                        S0111
     C* EXPOSURE KEY                                                      S01119
     C                   MOVE      'E'           AKY(10)                                       S0111
     C                   Z-ADD     UAEXA         KYAMT                                         S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C* PRINT LINE                                                        S01119
     C*                                                                   S01119
     C*  SET UP INDICATOR TO PRINT TAX AMOUNT                             S01119
     C                   SETOFF                                       33                       S0111
     C     USRST         IFEQ      'P'                                                         S0111
     C     TAXI          COMP      'Y'                                    33                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     CLRAT         NRRT                                          S0111
     C                   Z-ADD     UPAMT         NRRPUR                                        S0111
     C                   MOVE      '  '          NRBRTT                                        S0111
     C                   SETON                                        71                       S0111
     C                   SETOFF                                       31                       S0111
     C                   MOVE      'Y'           PRONLY                                        S0111
     C                   EXSR      EXCP                                                        S0111
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         S0111
     C                   TESTB     '0'           UDNSI                31                       S0111
     C                   Z-ADD     UEINR         NRRT                                          S0111
     C                   MOVE      UBRTT         NRBRTT                                        S0111
     C                   ELSE                                                                  S0111
     C                   TESTB     '0'           TDNSI                31                       S0111
     C                   Z-ADD     TEINR         NRRT                                          S0111
     C                   MOVE      TBRTT         NRBRTT                                        S0111
     C                   END                                                                   S0111
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C                   Z-ADD     AACRT         NRRT                                          S0111
     C                   SETOFF                                       31                       S0111
     C                   END                                                                   S0111
     C                   EXCEPT    FITHR1                                                      S0111
     C                   ADD       1             PLINES                                        LN088
     C*                                                                   S01119
     C*  PRINT FLOOR IF REQUIRED                                          S01119
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C*                                                                   S01119
     C*  SET UP INDICATOR TO PRINT TAX AMOUNT                             S01119
     C                   SETOFF                                       33                       S0111
     C     USRST         IFEQ      'T'                                                         E2340
     C     TAXI          COMP      'Y'                                    33                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   EXCEPT    FLOOR                                                       S0111
     C                   ADD       1             PLINES                                        LN088
     C                   END                                                                   S0111
     C*                                                                   CIR001
     C** UP-FRONT FEE ACCRUAL KEY FOR THE UNAMORTISED FEE                 CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     UPVD          ANDNE     *ZEROS                                                      CIR00
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVE      UPPR          AKY(9)                                        CIR00
     C*                                                                   CIR001
     C     UPFE          SUB       UPAD          KYAMT                                         CIR00
     C                   Z-ADD     UPFE          UPAD                                          CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C378
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C379
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C380
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C381
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   Z-ADD     *ZEROS        KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
     C*                                                                   CIR001
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C* UPDATE FIELDS                                                     S01119
     C                   BITON     '2'           ACEI                                          S0111
     C                   MOVE      'M'           RECR                                          S0111
      *                                                                                       CIR008
      ** Set Deal Authorisation Status to 'M' if CIR008 is installed                          CIR008
      *                                                                                       CIR008
     C     CIR008        IFEQ      'Y'
     C                   MOVE      'M'           FIDSTS
     C                   ENDIF
      *                                                                                       CIR008
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C/COPY WNCPYSRC,DL0280C551
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* DAILY PROCESSING                                                  S01119
     C*                                                                   S01119
     C                   BITOFF    '2'           UDNSI                                         S0111
     C                   BITOFF    '2'           TDNSI                                         S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C*                                                                   S01119
     C* AVERAGE RATE CALCULATION FOR NEXT DAY'S DISPLAY                   S01119
     C*    TOTAL RATE AND PERIOD ARE ONLY WORK FIELDS                     S01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C     USRST         IFEQ      'P'                                                         S0111
     C                   BITOFF    '1'           UDNSI                                         S0111
     C     BJDNWD        SUB       UINFD         WK5                                           S0119
     C     UEINR         MULT      WK5           WK158                                         S0111
     C                   ELSE                                                                  S0111
     C                   BITOFF    '1'           TDNSI                                         S0111
     C     BJDNWD        SUB       TINFD         WK5                                           S0119
     C     TEINR         MULT      WK5           WK158                                         S0111
     C                   END                                                                   S0111
     C     AVPER         ADD       WK5           WK5                                           S0111
     C     WK158         ADD       TIRAT         WK158                                         S0111
     C*                                                                   S01119
     C* SAVE OLD AVERAGE RATE FOR ACCRUALS                                S01119
     C*                                                                   S01119
     C                   Z-ADD     AACRT         EINR                                          S0111
     C*                                                                   S01119
     C     WK5           IFNE      0                                                           S0111
     C     WK158         DIV(H)    WK5           AACRT                                         S0111
     C                   END                                                                   S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C*  ACCRUAL DATE                                                     S01119
     C*                                                                   S01119
     C     *IN52         IFEQ      '1'                                                         S0111
     C     VDAT          ANDLE     EVCD                                                        S0111
     C     MDAT          ANDGT     EVCD                                                        S0111
     C/COPY WNCPYSRC,DL0280C514
     C                   Z-ADD     BKAPDT        KYDAT                                         07778
     C                   Z-ADD     BJRDNB        KYFED                                  S01119 S0119
     C*   ONLY IF NOT ALSO A PAYMENT DATE OR FIRST DATE ACCRUAL           E36008
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     USLIP         WSLIP                                         S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TSLIP         WSLIP                                         S0111
     C                   END                                                                   S0111
     C     WSLIP         IFNE      EVCD                                                        S0111
     C     WSLIP         OREQ      EVCD                                         DATE 1ST SET   S0111
     C     WSLIP         ANDEQ     VDAT                                         *EQ VDAT       S0111
     C     BKALDI        OREQ      'N'                                          1ST DAY ACCRUALE3600
     C*                                                                   S01119
     C*  DETERMINE RATE                                                   S01119
     C*                                                                   S01119
     C* AVERAGE RATE, TODAY'S OR YESTERDAY'S DEPENDING OF LAST DAY ACCRUALS01119
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C     BKALDI        IFNE      'Y'                                                         S0119
     C                   Z-ADD     AACRT         EINR                                          S0111
     C                   END                                                                   S0111
     C*  NON-AVE, PROVIDERS RATE                                          S01119
     C                   ELSE                                                                  S0111
     C/COPY WNCPYSRC,DL0280C409
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     UEINR         EINR                                          S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TEINR         EINR                                          S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C* REIMBURSEMENT RATE/TOPPING UP RATE CALCULATIONS                   S01119
     C*                                                                   S01119
     C     FLRRTF        IFEQ      'Y'                                                         S0111
     C     FLRAT         SUB       EINR          TPUPRT                 31                     S0111
     C   31              Z-ADD     0             TPUPRT                                        S0111
     C                   END                                                                   S0111
     C     EINR          SUB       CLRAT         REIMRT                 31                     S0111
     C   31              Z-ADD     0             REIMRT                                        S0111
     C*                                                                   S01119
     C* FIND CORRECT RATE FOR THEIR DETAILS                               S01119
     C*                                                                   S01119
     C                   SETOFF                                         31                     S0111
     C     USRST         IFEQ      'P'                                                         E2340
     C     FLRRTF        ANDEQ     'Y'                                                         S0111
     C* USE TOPPING UP RATE FOR C'PARTY(TAKER)                            E23400
     C                   Z-ADD     TPUPRT        SZINTR               31  31                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     USRST         IFEQ      'T'                                                         E2340
     C* USE REIMBURSEMENT RATE FOR C'PARTY(PROVIDER)                      E23400
     C                   Z-ADD     REIMRT        SZINTR               31  31                   S0111
     C                   END                                                                   S0111
      *                                                                   S01119
      * DLRSAC                                                            S01119
      *                                                                   S01119
      *        (THEIRS)                                                   S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     UIACD         SZIACD                                        S0111
     C                   Z-ADD     ULPCD         SZLPCD                                        S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TIACD         SZIACD                                        S0111
     C                   Z-ADD     TLPCD         SZLPCD                                        S0111
     C                   END                                                                   S0111
     C                   MOVE      BKALDI        SZLDA                                         S0119
     C                   Z-ADD     EVCD          SZECD                                         S0111
     C                   Z-ADD     TPAMT         SZPPL                                         S0111
     C                   Z-ADD     TAITC         SZAICD                                        S0111
     C                   Z-ADD     TAIAP         SZAIAP                                        S0111
     C                   Z-ADD     TAIAN         SZIANP                                        S0111
     C                   Z-ADD     TAIPD         SZIPTD                                        S0111
     C                   MOVE      'N'           SZAVRM                                        S0111
     C                   MOVE      TFRDKY        FRDKY                                         S0111
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C                   MOVE      'Y'           SZAVRM                                        S0111
     C                   Z-ADD     SDCAR         SZSDCR                                        S0111
     C                   END                                                                   S0111
     C                   Z-ADD     TICBS         SZCBS                                         S0111
     C                   MOVEA     'R'           AKY(9)                                        S0111
     C*                                                                   003457
     C** Set output rate (NRRT) to differential (SZINTR) and set off      003457
     C** *IN31 to ensure output to report.Set Base Rate Type to blanks.   003457
     C*                                                                   003457
     C                   Z-ADD     SZINTR        NRRT                                          00345
     C                   MOVE      '0'           *IN31                                         00345
     C                   MOVE      '  '          NRBRTT                                        00345
     C*                                                                   003457
     C** If CIR002 is switched on, add their unsettled interest and       CIR002
     C**   adjustment to their principal.                                 CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     TINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       TUSI          SZPPL                                         CIR00
     C                   ADD       TUSA          SZPPL                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     TSLIP         SZSLID                                        CIR00
     C                   Z-ADD     TNIPD         SZNIPD                                        CIR00
     C                   MOVE      TIPFR         SZIPFC                                        CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C258
     C                   EXSR      DLRSAC                                                      S0111
      *        (RESULT)                                                   S01119
     C                   Z-ADD     SZIPTD        TAIPD                                         S0111
     C                   Z-ADD     SZIANP        TAIAN                                         S0111
     C                   Z-ADD     SZAIAP        TAIAP                                         S0111
     C                   END                                                                   S0111
     C                   SETOFF                                         31                     S0111
     C*                                                                   S01119
     C* FIND CORRECT RATE FOR OUR DETAILS                                 S01119
     C*                                                                   S01119
     C     USRST         IFEQ      'T'                                                         E2340
     C     FLRRTF        ANDEQ     'Y'                                                         S0111
     C* USE TOPPING UP RATE FOR USER(TAKER)                               E23400
     C                   Z-ADD     TPUPRT        SZINTR               31  31                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     USRST         IFEQ      'P'                                                         E2340
     C* USE REIMBURSEMENT RATE FOR USER(PROVIDER)                         E23400
     C                   Z-ADD     REIMRT        SZINTR               31  31                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
      * DLRSAC (OURS)                                                     S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '1'                                                         S0111
     C     USRST         IFEQ      'P'                                                         S0111
     C                   Z-ADD     UIACD         SZIACD                                        S0111
     C                   Z-ADD     ULPCD         SZLPCD                                        S0111
     C                   ELSE                                                                  S0111
     C                   Z-ADD     TIACD         SZIACD                                        S0111
     C                   Z-ADD     TLPCD         SZLPCD                                        S0111
     C                   END                                                                   S0111
     C                   MOVE      BKALDI        SZLDA                                         S0119
     C                   Z-ADD     EVCD          SZECD                                         S0111
     C                   Z-ADD     UPAMT         SZPPL                                         S0111
     C                   Z-ADD     UAITC         SZAICD                                        S0111
     C                   Z-ADD     UAIAP         SZAIAP                                        S0111
     C                   Z-ADD     UAIAN         SZIANP                                        S0111
     C                   Z-ADD     UAIPD         SZIPTD                                        S0111
     C                   MOVE      'N'           SZAVRM                                        S0111
     C                   MOVE      UFRDKY        FRDKY                                         S0111
     C     AVERRT        IFEQ      'Y'                                                         S0111
     C                   MOVE      'Y'           SZAVRM                                        S0111
     C                   Z-ADD     SDCAR         SZSDCR                                        S0111
     C                   END                                                                   S0111
     C                   Z-ADD     UICBS         SZCBS                                         S0111
     C                   MOVEA     'P'           AKY(9)                                        S0111
     C*                                                                   003457
     C** Set output rate (NRRT) to differential (SZINTR) and set off      003457
     C** *IN31 to ensure output to report.Set Base Rate Type to blanks.   003457
     C*                                                                   003457
     C                   Z-ADD     SZINTR        NRRT                                          00345
     C                   MOVE      '0'           *IN31                                         00345
     C                   MOVE      '  '          NRBRTT                                        00345
     C*                                                                   003457
     C** If CIR002 is switched on, add our unsettled interest and         CIR002
     C**   adjustment to our principal.                                   CIR002
     C*                                                                   CIR002
     C     CIR002        IFEQ      'Y'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'A'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'I'                                                         CIR00
     C     CIR006        OREQ      'Y'                                                         CIR00
     C     UINPM         ANDEQ     'L'                                                         CIR00
     C                   ADD       OUSI          SZPPL                                         CIR00
     C                   ADD       OUSA          SZPPL                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR002
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     USLIP         SZSLID                                        CIR00
     C                   Z-ADD     UNIPD         SZNIPD                                        CIR00
     C                   MOVE      UIPFR         SZIPFC                                        CIR00
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C259
     C                   EXSR      DLRSAC                                                      S0111
      *        (RESULT)                                                   S01119
     C                   Z-ADD     SZIPTD        UAIPD                                         S0111
     C                   Z-ADD     SZIANP        UAIAN                                         S0111
     C                   Z-ADD     SZAIAP        UAIAP                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C**  SET DEALS FILE UPDATE INDICATOR                                 S01119
     C                   MOVE      '1'           *IN15                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     0             NRRPUR                                        S0111
     C                   Z-ADD     0             NRRSAL                                        S0111
     C*                                                                   CIR001
     C** If it is an accrual date and an up-front fee or premium          CIR001
     C** was entered with the deal, a key ("xxAyy   zF") must be          CIR001
     C** generated for the amortized premium.                             CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C*                                                                   CIR001
     C                   TESTB     '2'           ACEI                 31                       CIR00
     C     *IN52         IFEQ      *ON                                                         CIR00
     C     UPVD          ANDLE     EVCD                                                        CIR00
     C     UPVD          ANDNE     0                                                           CIR00
     C     *IN31         ANDEQ     *ON                                                         CIR00
     C*                                                                   CIR001
     C** ACCRUE UP-FRONT FESS                                             CIR001
     C*                                                                   CIR001
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVE      'A'           AKY(3)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     '    F'       AKY(6)                                        CIR00
     C                   MOVE      UPPR          AKY(9)                                        CIR00
     C     MDAT          SUB       UPVD          PER1                                          CIR00
     C     UPFE          DIV       PER1          DACCR                                         CIR00
     C     EVCD          SUB       UPVD          PER2                                          CIR00
     C     *IN29         IFEQ      *OFF                                                        CIR00
     C                   ADD       1             PER2                                          CIR00
     C                   END                                                                   CIR00
     C     DACCR         MULT(H)   PER2          IAMT                                          CIR00
     C     IAMT          SUB       UPAD          KYAMT                                         CIR00
     C                   ADD       KYAMT         UPAD                                          CIR00
     C*                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C382
     C     UPPR          IFEQ      'P'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C383
     C                   MOVEL     UCUCY         KYCCY                                         CIR00
     C                   MOVE      PSCY          KYSCY                                         CEU00
     C                   MOVE      POBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C/COPY WNCPYSRC,DL0280C384
     C     UPPR          IFEQ      'R'                                                         CIR00
     C/COPY WNCPYSRC,DL0280C385
     C                   MOVEL     TCUCY         KYCCY                                         CIR00
     C                   MOVE      RSCY          KYSCY                                         CEU00
     C                   MOVE      ROBR          KYSTBR                                       231196
     C                   END                                                                   CIR00
     C                   Z-ADD     *ZEROS        KYSETL                                        CIR00
     C                   MOVEL     *BLANKS       KYOSTL                                        CIR00
     C                   EXSR      EXCP                                                        CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     RLSEND        ENDSR                                                                 S0111
2877 C********************************************************************S01119
     C/EJECT                                                              S01119
     C********************************************************************S01119
     C**                                                                  S01119
     C** S/R DLRREX                                                       S01119
     C** PROCEDURE TO CALCULATE EXPOSURE AMOUNTS OF FRA/IRS               S01119
     C**                                                                  S01119
     C** INPUT:  START DATE                                          RRSD S01119
     C**         END DATE(VALUE DATE FOR FRA, MATURITY DATE FOR IRS) RRED S01119
     C**                 MIDAS DAY NUMBERS(5,0)                           S01119
     C**         PRINCIPAL AMOUNT 13,0                               RRPA S01119
     C**         DEAL TYPE 2A                                        RRDT S01119
     C**                                                                  S01119
     C** OUTPUT: EXPOSURE AMOUNT 13,0                                RREA S01119
     C**                                                                  S01119
     C     DLRREX        BEGSR                                                                 S0111
     C**                                                                  S01119
     C** DEFINE FIELDS                                                    S01119
     C                   Z-ADD     RRPA          RRPA             13 0                         S0111
     C                   Z-ADD     RRSD          RRSD              5 0                         S0111
     C                   Z-ADD     RRED          RRED              5 0                         S0111
     C                   Z-ADD     0             RREA             13 0                         S0111
     C                   MOVE      RRDT          RRDT              2                           S0111
     C**                                                                  S01119
     C** IF PRINCIPAL IS ZERO, DO NOT PROCESS                             S01119
     C     RRPA          CABEQ     0             RRXEND                                        S0111
     C**                                                                  S01119
     C** DETERMINE FRA/IRS AND SET UP APPROPRIATE PERCENTAGES/PERIODS     S01119
     C** DEAL TYPE 'FR' IS FRA, ALL OTHERS ARE IRS                        S01119
     C     RRDT          IFEQ      'FR'                                                        S0111
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,DL0280CVSF                                           S01408
     C                   Z-ADD     BQFLPC        RRLPC             7 4                         S0119
     C                   Z-ADD     BQFLPD        RRLPD             4 0                         S0119
     C                   Z-ADD     BQFUPC        RRUPC             7 4                         S0119
     C                   Z-ADD     BQFUPD        RRUPD             4 0                         S0119
     C                   ELSE                                                                  S0111
     C                   Z-ADD     BQILPC        RRLPC             7 4                         S0119
     C                   Z-ADD     BQILEP        RRLPD             4 0                         S0119
     C                   Z-ADD     BQIUPC        RRUPC             7 4                         S0119
     C                   Z-ADD     BQIUEP        RRUPD             4 0                         S0119
     C                   END                                                                   S0111
     C**                                                                  S01119
     C** IF UPPER END PERIOD IS ZERO, CALCULATE EXPOSURE AMOUNT BY        S01119
     C** OBTAINING LOWER END % OF PRINCIPAL                               S01119
     C     RRUPD         IFEQ      0                                                           S0111
     C     RRPA          DIV       100           RRAMT            15 2                         S0111
     C     RRAMT         MULT(H)   RRLPC         RREA                                          S0111
     C                   GOTO      RRXEND                                                      S0111
     C                   END                                                                   S0111
     C**                                                                  S01119
     C** IF UPPER END PERIOD IS NOT ZERO AND LOWER END PERIOD             S01119
     C** WHEN ADDED TO START DATE, IS GREATER THAN END DATE               S01119
     C** CALCULATE EXPOSURE AMOUNT BY OBTAINING LOWER END % OF PRINCIPAL  S01119
     C     RRSD          ADD       RRLPD         RRCHK             5 0                         S0111
     C     RRCHK         IFGE      RRED                                                        02900
     C     RRPA          DIV       100           RRAMT                                         S0111
     C     RRAMT         MULT(H)   RRLPC         RREA                                          S0111
     C                   GOTO      RRXEND                                                      S0111
     C                   END                                                                   S0111
     C**                                                                  S01119
     C** OTHERWISE, ADD THE UPPER END PERIOD TO THE START DATE            S01119
     C** AND IF THE RESULT IS LESS THAN THE END DATE, CALCULATE           S01119
     C** EXPOSURE AMOUNT BY OBTAINING UPPER END % OF PRINCIPAL            S01119
     C     RRSD          ADD       RRUPD         RRCHK                                         S0111
     C     RRCHK         IFLE      RRED                                                        02900
     C     RRPA          DIV       100           RRAMT                                         S0111
     C     RRAMT         MULT(H)   RRUPC         RREA                                          S0111
     C                   GOTO      RRXEND                                                      S0111
     C                   END                                                                   S0111
     C**                                                                  S01119
     C** FINALLY, IF NONE OF THESE CASES WAS SATISFIED, THE EXPOSURE      S01119
     C** AMOUNT IS CALCULATED USING THE FOLLOWING % OF THE PRINCIPAL      S01119
     C**                                                                  S01119
     C**   LPC  +  ( (ED - (SD + LPD)) X (UPC - LPC) )  |   A             S01119
     C**           ( ------------------------------- )  |   -             S01119
     C**           (            UPD - LPD            )  |   B             S01119
     C**                                                                  S01119
     C     RRSD          ADD       RRLPD         RRCHK                          SD + LPD       S0111
     C     RRED          SUB       RRCHK         RRA1              5 0          ED - (SD + LPD)S0111
     C**                                                                  S01119
     C     RRUPC         SUB       RRLPC         RRA2              7 4          UPC - LPC      S0111
     C     RRA1          MULT      RRA2          RRA              15 8          RRPC = A       S0111
     C**                                                                  S01119
     C     RRUPD         SUB       RRLPD         RRB               5 0          UPD - LPD = B  S0111
     C**                                                                  S01119
     C     RRA           DIV(H)    RRB           RRADB            15 8          A/B            S0111
     C     RRLPC         ADD       RRADB         RRPC             15 8          LPC + A/B      S0111
     C**                                                                  S01119
     C     RRPA          DIV       100           RRAMT                          PERCENTAGE     S0111
     C     RRAMT         MULT(H)   RRPC          RREA                           CALCULATION    S0111
     C**                                                                  S01119
     C     RRXEND        ENDSR                                                                 S0111
     C********************************************************************S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*   SR: DLRADS - TO CALCULATE DISCOUNTED SETTLED AMOUNT FOR FRA *   S01119
     C*                                                               *   S01119
     C*   CALLED FROM :-                                              *   S01119
     C*   CALLS       :- ZDATE1,ZDATE2                                *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C     DLRADS        BEGSR                                                  ** DLRADS **   S0111
     C*                                                                   S01119
     C                   Z-ADD     SZVDAT        SZVDAT            5 0                         S0111
     C                   Z-ADD     SZMDAT        SZMDAT            5 0                         S0111
     C                   Z-ADD     SZPPL         SZPPL            13 0                         S0111
     C                   Z-ADD     SZFIX         SZFIX            11 7                         S0111
     C                   Z-ADD     SZFLT         SZFLT            11 7                         S0111
     C                   Z-ADD     SZICB         SZICB             1 0                         S0111
     C                   Z-ADD     SZIANP        SZIANP           13 0                         S0111
     C                   Z-ADD     0             SZICVL            3 0                         S0111
     C                   Z-ADD     0             SZSDAT            5 0                         S0111
     C                   Z-ADD     0             SZEDAT            5 0                         S0111
     C                   Z-ADD     0             SZPER             5 0                         S0111
     C                   Z-ADD     0             SPPER             5 0                      MD051152
     C                   Z-ADD     0             STYR              2 0                         S0111
     C                   Z-ADD     0             STWRK             4 0                         S0111
     C                   Z-ADD     0             STDAY             2 0                         S0111
     C                   Z-ADD     0             STMTH             2 0                         S0111
     C                   Z-ADD     0             ENDYR             2 0                         S0111
     C                   Z-ADD     0             ENDWRK            4 0                         S0111
     C                   Z-ADD     0             ENDDAY            2 0                         S0111
     C                   Z-ADD     0             ENDMTH            2 0                         S0111
     C                   Z-ADD     0             YEAR1             4 0                         S0111
     C                   Z-ADD     0             STORE             4 0                         S0111
     C                   Z-ADD     0             CHK               1 0                         S0111
     C                   Z-ADD     0             YEAR2             4 0                         S0111
     C                   Z-ADD     0             DAY1              2 0                         S0111
     C                   Z-ADD     0             MTHS              2 0                         S0111
     C                   Z-ADD     0             MTHS2             4 0                         S0111
     C                   Z-ADD     0             SZWRK1           11 7                         S0111
     C                   Z-ADD     0             SZWRK2           20 7                  S01119 04330
     C                   Z-ADD     0             SZWRK3            5 0                         S0111
     C                   Z-ADD     0             SZWRK4           14 7                         S0111
     C                   Z-ADD     0             SZWRK5           14 7                         S0111
     C                   Z-ADD     0             SZWRK6           15 0                         E3598
     C                   Z-ADD     0             SZWRK7           12 9                         S0111
     C                   Z-ADD     0             SZWRK8           15 0                         AUS02
     C                   Z-ADD     0             SZWRK9           15 7                         AUS02
     C                   Z-ADD     0             SZSETL           18 0                         05137
     C                   Z-ADD     0             SZRDF            11 7                         S0111
     C                   Z-ADD     0             SZRSA            15 0                         S0111
     C                   Z-ADD     0             SZRDS            13 0                         S0111
     C                   Z-ADD     0             SZDISC           11 7                         S0111
     C                   Z-ADD     0             SZDSA            15 0                         S0111
     C                   Z-ADD     0             DATST             6 0                         S0111
     C                   Z-ADD     0             DATEND            6 0                         S0111
     C                   Z-ADD     0             SLEAP             5 0                         S0111
     C                   Z-ADD     0             ELEAP             5 0                         S0111
     C                   Z-ADD     0             CHK2              1 0                         S0111
     C                   SETOFF                                       31                       S0111
     C*                                                                   AUS021
     C**  CHECK IF AUSTRALIA FORMULA REQUIRED                             AUS021
     C*                                                                   AUS021
     C     SETF          IFEQ      'A'                                                         AUS02
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT USING AUSTRALIAN         AUS021
     C*   FORMULA                                                         AUS021
     C*                                                                   AUS021
     C**  CALCULATE DAYS TO MATURITY                                      AUS021
     C*                                                                   AUS021
     C     SZMDAT        SUB       SZVDAT        SZWRK3                                        AUS02
     C*                                                                   AUS021
     C**  MULTIPLY FACE VALUE BY (DAYS IN YEAR x 100)                     AUS021
     C*                                                                   AUS021
     C     SZPPL         MULT      36500         SZSETL                                        AUS02
     C*                                                                   AUS021
     C**  CALCULATE PROCEEDS FROM FLOATING RATE                           AUS021
     C*                                                                   AUS021
     C     SZWRK3        MULT      SZFLT         SZWRK2                                        AUS02
     C                   ADD       36500         SZWRK2                                        AUS02
     C     SZWRK2        IFNE      *ZEROS                                                      AUS02
     C     SZSETL        DIV(H)    SZWRK2        SZRSA                                         AUS02
     C                   ELSE                                                                  AUS02
     C                   Z-ADD     *ZEROS        SZRSA                                         AUS02
     C                   END                                                                   AUS02
     C*                                                                   AUS021
     C**  CALCULATE PROCEEDS FROM FIXED AMOUNT                            AUS021
     C*                                                                   AUS021
     C     SZWRK3        MULT      SZFIX         SZWRK2                                        AUS02
     C                   ADD       36500         SZWRK2                                        AUS02
     C     SZWRK2        IFNE      *ZEROS                                                      AUS02
     C     SZSETL        DIV(H)    SZWRK2        SZWRK8                                        AUS02
     C                   ELSE                                                                  AUS02
     C                   Z-ADD     *ZEROS        SZWRK8                                        AUS02
     C                   END                                                                   AUS02
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT                          AUS021
     C*                                                                   AUS021
     C     SZRSA         IFGT      SZWRK8                                                      04031
     C     SZRSA         SUB       SZWRK8        SZRDS                                         AUS02
     C                   ELSE                                                                  04031
     C     SZWRK8        SUB       SZRSA         SZRDS                                         04031
     C                   END                                                                   04031
     C*                                                                   AUS021
     C                   ELSE                                                                  AUS02
     C*                                                                   AUS021
     C**  CHECK IF U.S.A FORMULA REQUIRED                                 AUS021
     C*                                                                   AUS021
     C     SETF          IFEQ      'U'                                                         AUS02
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT USING U.S.A FORMULA      AUS021
     C*                                                                   AUS021
     C**  CALCULATE DAYS TO MATURITY                                      AUS021
     C*                                                                   AUS021
     C     SZMDAT        SUB       SZVDAT        SZWRK3                                        AUS02
     C*                                                                   AUS021
     C*                                                                   AUS021
     C**  CALCULATE DIFFERENCE in RATES                                   AUS021
     C*                                                                   AUS021
     C     SZFLT         IFGT      SZFIX                                                       AUS02
     C     SZFLT         SUB       SZFIX         WXWRK1            7 4                         AUS02
     C                   ELSE                                                                  AUS02
     C     SZFIX         SUB       SZFLT         WXWRK1                                        AUS02
     C                   END                                                                   AUS02
     C*                                                                   AUS021
     C**  MULTIPLY DIFFERENCE IN RATES BY DAYS TO MATURITY AND            AUS021
     C**  CONTRACT AMOUNT AND DIVIDE RESULT BY 36000                      AUS021
     C*                                                                   AUS021
     C     WXWRK1        MULT      SZWRK3        WXWRK2           15 5                         AUS02
     C     WXWRK2        MULT      SZPPL         WXWRK3           15 0                         AUS02
     C     WXWRK3        DIV(H)    36000         WXWRK4           15 3                         AUS02
     C*                                                                   AUS021
     C**  MULTIPLY INTEREST SETTLEMENT RATE BY DAYS TO MATURITY           AUS021
     C**  AND DIVIDE RESULT BY 36000                                      AUS021
     C*                                                                   AUS021
     C     SZFLT         MULT      SZWRK3        WXWRK5           13 4                         AUS02
     C     WXWRK5        DIV(H)    36000         WXWRK6           15 9                         AUS02
     C*                                                                   AUS021
     C**  TAKE THIS RESULT AND ADD 1 AND THEN TAKE RECIPROCAL             AUS021
     C*                                                                   AUS021
     C                   ADD       1             WXWRK6                                        AUS02
     C     WXWRK6        IFNE      *ZEROS                                                      AUS02
     C     1             DIV(H)    WXWRK6        WXWRK7           11 9                         AUS02
     C                   ELSE                                                                  AUS02
     C                   Z-ADD     *ZEROS        WXWRK7                                        AUS02
     C                   END                                                                   AUS02
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT                          AUS021
     C*                                                                   AUS021
     C     WXWRK4        MULT(H)   WXWRK7        SZRDS                                         AUS02
     C*                                                                   AUS021
     C*                                                                   AUS021
     C                   ELSE                                                                  AUS02
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT USING U.K. FORMULA       AUS021
     C*                                                                   S01119
     C**  DETERMINE VALUE ASSOCIATED WITH INTEREST CALCULATION BASIS      S01119
     C*                                                                   S01119
     C     SZICB         IFEQ      2                                                           S0111
     C     SZICB         OREQ      3                                                           S0111
     C     SZICB         OREQ      5                                                           S0111
     C     SZICB         OREQ      7                                                           CIR00
     C     CIR004        ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     360           SZICVL                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     SZICB         IFEQ      1                                                           S0111
     C     SZICB         OREQ      4                                                           S0111
     C                   Z-ADD     365           SZICVL                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     SZICB         IFEQ      6                                                           S0111
     C                   Z-ADD     366           SZICVL                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  SET START DATE EQUAL TO VALUE DATE                              S01119
     C*                                                                   S01119
     C                   Z-ADD     SZVDAT        SZSDAT                                        S0111
     C*                                                                   S01119
     C**  PROCESS UNTIL END DATE IS GREATER THAN MATURITY DATE            S01119
     C*                                                                   S01119
     C     *IN31         DOUEQ     '1'                                                         S0111
     C*                                                                   S01119
     C**  EXECUTE SUB-ROUTINE ZDATE2                                      S01119
     C*                                                                   S01119
     C                   Z-ADD     SZSDAT        ZDAYNO                                        S0111
     C*                                                                   S01119
     C                   EXSR      ZDATE2                                                      S0111
     C*                                                                   S01119
     C**  INCREMENT YEAR BY 1                                             S01119
     C*                                                                   S01119
     C                   ADD       1             ZYEAR                                         S0111
     C                   MOVE      ZYEAR         ZDATE                                         S0111
     C*                                                                   100140
     C* 29th February does not exist in a non-leap year.                  100140
     C*                                                                   100140
     C     ZMTH          IFEQ      02                                                          10014
     C     ZDAY          ANDEQ     29                                                          10014
     C                   Z-ADD     28            ZDAY                                          10014
     C     *IN98         IFEQ      '0'                                                         15695
     C                   MOVEL     ZDAY          ZDATE                                         10014
     C                   ELSE                                                                  15695
     C                   MOVE(P)   ZDAY          W@MDY             4 0                         15695
     C                   MOVEL     ZMTH          W@MDY                                         15695
     C                   MOVEL     W@MDY         ZDATE                                         15695
     C                   END                                                                   15695
     C                   END                                                                   10014
     C*                                                                   S01119
     C**  EXECUTE SUB-ROUTINE ZDATE1                                      S01119
     C*                                                                   S01119
     C                   EXSR      ZDATE1                                                      S0111
     C                   Z-ADD     ZDAYNO        SZEDAT                                        S0111
     C/COPY WNCPYSRC,DL0280C001
     C*                                                                   031967
     C**  CHECK TO SEE IF MATURITY DATE FALLS BETWEEN PERIOD END DATE     031967
     C**  AND PERIOD END DATE + 10 (THIS WILL ONLY HAPPEN IF AN FRA 031967060995
     C**  WAS ENTERED WITH AN INCREASED MATURITY DATE DUE TO THE          031967
     C**  ACTUAL MATURITY DATE FALLING ON A NON-WORKING DAY).             031967
     C**  IF IT DOES DO THE LATER DISCOUNTED SETTLEMENT AMOUNT            031967
     C**  CALCULATION UPTO MATURITY DATE OTHERWISE UPTO THE PERIOD        031967
     C**  END DATE. THE NUMBER 5 WAS CHOSEN AS THIS IS THE WORST          031967
     C**  POSIBLE CASE OF NON-WORKING DAYS IN A ROW (EASTER).             031967
     C*                                                                   031967
     C     SZEDAT        ADD       10            #EDAT             5 0                   03196706099
     C*                                                                   S01119
     C**  IF END DATE IS GREATER THAN THE MATURITY DATE                   S01119
     C**  THEN REPLACE END DATE  BY MATURITY DATE                         S01119
     C*                                                                   S01119
     C     SZEDAT        IFGE      SZMDAT                                                      S0111
     C     SZEDAT        ORLT      SZMDAT                                                      03196
     C     #EDAT         ANDGE     SZMDAT                                                      03196
     C                   SETON                                        31                       S0111
     C                   Z-ADD     SZMDAT        SZEDAT                                        S0111
     C                   END                                                                   S0111
      *                                                                                       CIR013
      **Check*whether*the*period*contains*a*29th*February********************        CIR013 MD051152
     C     SZICB         IFEQ      9                                                          CIR013
     C     SZICB         OREQ      6                                                        MD051152
      * Convert start date to YYYYMMDD format                                                 CIR013
     C                   Z-ADD     SZSDAT        @@DAYN            5 0                        CIR013
     C                   EXSR      ZDATE9                                                     CIR013
     C                   Z-ADD     @@VDT         ZZDATA                                       CIR013
      * Convert end date to YYYYMMDD format                                                   CIR013
     C                   Z-ADD     SZEDAT        @@DAYN                                       CIR013
     C                   EXSR      ZDATE9                                                     CIR013
     C                   Z-ADD     @@VDT         ZZDATB                                       CIR013
     C                   ENDIF                                                              MD051152     
      *                                                                                       CIR013
      ** Check whether the period contains a 29th February                                  MD051152
      *                                                                                     MD051152
     C     SZICB         IFEQ      9                                                        MD051152
     C                   Eval      ZZStartDate = ZZDATA                                       CIR013
     C                   Eval      ZZEndDate = ZZDATB                                         CIR013
     C                   EXSR      #FEB29                                                     CIR013
      *                                                                                       CIR013
     C     #29FEB        IFEQ      'N'                                                        CIR013
     C                   Z-ADD     365           SZICVL                                       CIR013
     C                   ELSE                                                                 CIR013
     C                   Z-ADD     366           SZICVL                                       CIR013
     C                   ENDIF                                                                CIR013
     C                   ENDIF                                                                CIR013
     C*                                                                   S01119
     C**  CALCULATE THE PERIOD BETWEEN START DATE AND END DATE            S01119
     C*                                                                   S01119
     C     SZICB         IFEQ      1                                                           S0111
     C     SZICB         OREQ      2                                                           S0111
     C     SZICB         OREQ      6                                                           S0111
     C     SZICB         OREQ      9                                                          CIR013
     C     #29FEB        ANDEQ     'Y'                                                        CIR013
     C     SZEDAT        SUB       SZSDAT        SZPER                                         S0111
     C                   END                                                                   S0111
      ** Perform no. of days calculation for method 6                                       MD051152
     C     SZICB         IFEQ      6                                                        MD051152
      *                                                                                     MD051152
      ** If start and end date are in the same year, check if the                           MD051152
      ** year is a leap year and add no. of interest days to the                            MD051152
      ** relevant total                                                                     MD051152
     C     ZZYY1         IFEQ      ZZYY2                                                    MD051152
     C     ZZYY1         DIV       4             ZZWN5                                      MD051152
     C                   MVR                     ZZWN5                                      MD051152
     C     ZZWN5         IFNE      0                                                        MD051152
     C                   Z-ADD     365           SZICVL                                     MD051152
     C                   ELSE                                                               MD051152
     C                   Z-ADD     366           SZICVL                                     MD051152
     C                   ENDIF                                                              MD051152
     C                   Z-ADD     SZPER         SPPER                                      MD051152
      *                                                                                     MD051152
      ** Calculate Settlement Amount                                                        MD051152
     C                   EXSR      FRASR                                                    MD051152
      *                                                                                     MD051152
      ** else must break down the interest period into leap years                           MD051152
      ** and non-leap years                                                                 MD051152
     C                   ELSE                                                               MD051152
      ** Add 1 to starting year number                                                      MD051152
     C     ZZYY1         ADD       1             ZZYY2                                      MD051152
      * Get Midas day number for 1st Jan of year after start date                           MD051152
     C                   MOVE      '01'          ZZMM2                                      MD051152
     C                   MOVE      '01'          ZZDD2                                      MD051152
     C                   MOVE      ZZDATB        ZZDTIN                                     MD051152
     C                   EXSR      ZDAT10                                                   MD051152
     C                   Z-ADD     ZZMDNO        ZZENDW            5 0                      MD051152
     C     ZZENDW        SUB       SZSDAT        SPPER                                      MD051152
      *                                                                                     MD051152
      ** Check if current year is a leap year                                               MD051152
     C     ZZYY1         DIV       4             ZZWN5                                      MD051152
     C                   MVR                     ZZWN5                                      MD051152
     C     ZZWN5         IFNE      0                                                        MD051152
     C                   Z-ADD     365           SZICVL                                     MD051152
     C                   ELSE                                                               MD051152
     C                   Z-ADD     366           SZICVL                                     MD051152
     C                   ENDIF                                                              MD051152
      *                                                                                     MD051152
      ** Calculate Settlement Amount                                                        MD051152
     C                   EXSR      FRASR                                                    MD051152
      *                                                                                     MD051152
      * Finally calculate the days for the last part-year up                                MD051152
      * to the end date                                                                     MD051152
      *                                                                                     MD051152
      * Get Midas day number for 1st Jan of current year                                    MD051152
     C                   MOVE      '01'          ZZMM2                                      MD051152
     C                   MOVE      '01'          ZZDD2                                      MD051152
     C                   MOVE      ZZDATB        ZZDTIN                                     MD051152
     C                   EXSR      ZDAT10                                                   MD051152
     C                   Z-ADD     ZZMDNO        ZZBEG             5 0                      MD051152
     C     SZEDAT        SUB       ZZBEG         SPPER                                      MD051152
      *                                                                                     MD051152
      ** Check if year is a leap year                                                       MD051152
     C     ZZYY2         DIV       4             ZZWN5                                      MD051152
     C                   MVR                     ZZWN5                                      MD051152
     C     ZZWN5         IFNE      0                                                        MD051152
     C                   Z-ADD     365           SZICVL                                     MD051152
     C                   ELSE                                                               MD051152
     C                   Z-ADD     366           SZICVL                                     MD051152
     C                   ENDIF                                                              MD051152
      *                                                                                     MD051152
      ** Calculate Settlement Amount                                                        MD051152
     C                   EXSR      FRASR                                                    MD051152
      *                                                                                     MD051152
     C                   ENDIF                                                              MD051152
     C                   ENDIF                                                              MD051152
     C*                                                                   S01119
     C**  IF THE END DATE IS LESS THAN OR EQUAL TO THE MATURITY DATE      S01119
     C*                                                                   S01119
     C     *IN31         IFEQ      '0'                                                         S0111
     C*                                                                   S01119
     C     SZICB         IFEQ      3                                                           S0111
     C     SZICB         OREQ      4                                                           S0111
     C     SZICB         OREQ      7                                                           CIR00
     C     CIR004        ANDEQ     'Y'                                                         CIR00
     C     SZICB         OREQ      9                                                          CIR013
     C     #29FEB        ANDEQ     'N'                                                        CIR013
     C                   Z-ADD     SZICVL        SZPER                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     SZICB         IFEQ      5                                                           S0111
     C                   Z-ADD     365           SZPER                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C**  THE END DATE WAS REPLACED BY THE MATURITY DATE                  S01119
     C*                                                                   S01119
     C     SZICB         IFEQ      4                                                           S0111
     C     SZICB         OREQ      5                                                           S0111
     C     SZICB         OREQ      9                                                          CIR013
     C     #29FEB        ANDEQ     'N'                                                        CIR013
     C     SZEDAT        SUB       SZSDAT        SZPER                                         S0111
     C*                                                                   S01119
     C**  CONVERT BOTH START AND END DAY NUMBERS TO DATES                 S01119
     C*                                                                   S01119
     C                   Z-ADD     SZSDAT        ZDAYNO                                        S0111
     C                   EXSR      ZDATE2                                                      S0111
     C                   Z-ADD     ZDATE         DATST                                         S0111
     C*                                                                   S01119
     C                   Z-ADD     SZEDAT        ZDAYNO                                        S0111
     C                   EXSR      ZDATE2                                                      S0111
     C                   Z-ADD     ZDATE         DATEND                                        S0111
     C*                                                                   S01119
     C**  ATTEMPT TO CALCULATE THE DAY NUMBER FOR 29 FEB IN THE YEAR      S01119
     C*                                                                   S01119
     C     *IN98         IFEQ      '0'                                                         S0111
     C                   MOVEL     '2902'        DATST                                         S0111
     C                   MOVEL     '2902'        DATEND                                        S0111
     C                   ELSE                                                                  S0111
     C                   MOVEL     '0229'        DATST                                         S0111
     C                   MOVEL     '0229'        DATEND                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     DATST         ZDATE                                         S0111
     C                   EXSR      ZDATE1                                                      S0111
     C                   Z-ADD     ZDAYNO        SLEAP                                         S0111
     C*                                                                   S01119
     C**  IF A DAY NUMBER IS FOUND CHECK IF IT LIES BETWEEN START DATE    S01119
     C**  AND END DATE                                                    S01119
     C*                                                                   S01119
     C     *IN99         IFEQ      '0'                                                         S0111
     C*                                                                   S01119
     C     SLEAP         IFGE      SZSDAT                                                      S0111
     C     SLEAP         ANDLE     SZEDAT                                                      S0111
     C     SZPER         SUB       1             SZPER                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     DATEND        ZDATE                                         S0111
     C                   EXSR      ZDATE1                                                      S0111
     C                   Z-ADD     ZDAYNO        ELEAP                                         S0111
     C*                                                                   S01119
     C     *IN99         IFEQ      '0'                                                         S0111
     C*                                                                   S01119
     C     ELEAP         IFGE      SZSDAT                                                      S0111
     C     ELEAP         ANDLE     SZEDAT                                                      S0111
     C     SZPER         SUB       1             SZPER                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  FOR METHOD 3 SPLIT BOTH START AND END DATES INTO THEIR          S01119
     C**  RESPECTIVE DAY,MONTH AND YEAR PORTIONS                          S01119
     C*                                                                   S01119
     C     SZICB         IFEQ      3                                                           S0111
     C     SZICB         OREQ      7                                                           CIR00
     C     CIR004        ANDEQ     'Y'                                                         CIR00
     C*                                                                   S01119
     C                   Z-ADD     0             SZPER                                         S0111
     C*                                                                   S01119
     C                   Z-ADD     SZSDAT        ZDAYNO                                        S0111
     C                   EXSR      ZDATE2                                                      S0111
     C                   Z-ADD     ZDATE         DATST                                         S0111
     C*                                                                   S01119
     C                   MOVE      DATST         STYR                                          S0111
     C                   MOVE      DATST         STWRK                                         S0111
     C     *IN98         IFEQ      '0'                                                         S0111
     C                   MOVEL     DATST         STDAY                                         S0111
     C                   MOVEL     STWRK         STMTH                                         S0111
     C                   ELSE                                                                  S0111
     C                   MOVEL     DATST         STMTH                                         S0111
     C                   MOVEL     STWRK         STDAY                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     SZEDAT        ZDAYNO                                        S0111
     C                   EXSR      ZDATE2                                                      S0111
     C                   Z-ADD     ZDATE         DATEND                                        S0111
     C*                                                                   S01119
     C                   MOVE      DATEND        ENDYR                                         S0111
     C                   MOVE      DATEND        ENDWRK                                        S0111
     C     *IN98         IFEQ      '0'                                                         S0111
     C                   MOVEL     DATEND        ENDDAY                                        S0111
     C                   MOVEL     ENDWRK        ENDMTH                                        S0111
     C                   ELSE                                                                  S0111
     C                   MOVEL     DATEND        ENDMTH                                        S0111
     C                   MOVEL     ENDWRK        ENDDAY                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  CHECK START DATE FOR LEAP YEAR                                  S01119
     C*                                                                   S01119
     C     STYR          ADD       1900          YEAR1                                         S0111
     C     YEAR1         DIV       4             STORE                                         S0111
     C                   MVR                     CHK                                           S0111
     C*                                                                   S01119
     C**  CHECK END DATE FOR LEAP YEAR ALLOWING FOR CHANGE IN CENTURY     S01119
     C*                                                                   S01119
     C     ENDYR         ADD       1900          YEAR2                                         S0111
     C     YEAR2         IFLT      YEAR1                                                       S0111
     C                   ADD       100           YEAR2                                         S0111
     C                   END                                                                   S0111
     C     YEAR2         DIV       4             STORE                                         S0111
     C                   MVR                     CHK2                                          S0111
     C*                                                                   S01119
     C**  IF START MONTH DOES NOT EQUAL 2 SUBTRACT DAY PORTION FROM 30    S01119
     C**  SETTING NEGATIVE RESULT TO ZERO FOR ACTUAL DAYS IN MONTH        S01119
     C*                                                                   S01119
     C     STMTH         IFNE      2                                                           S0111
     C     30            SUB       STDAY         SZPER                                         S0111
     C     SZPER         IFLT      0                                                           S0111
     C                   Z-ADD     0             SZPER                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  IF MONTH DOES EQUAL 2                                           S01119
     C*                                                                   S01119
     C     STMTH         IFEQ      2                                                           S0111
     C*                                                                   S01119
     C**  IF IT IS NOT A LEAP YEAR SUBTRACT DAY PORTION FROM 28           S01119
     C*                                                                   S01119
     C     CHK           IFNE      0                                                           S0111
     C     28            SUB       STDAY         SZPER                                         S0111
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C**  IF IT IS A LEAP YEAR SUBTRACT DAY PORTION FROM 29               S01119
     C*                                                                   S01119
     C     29            SUB       STDAY         SZPER                                         S0111
     C                   END                                                                   S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  ADJUST START MONTH & YEAR TO CATER FOR YEAR END                 S01119
     C*                                                                   S01119
     C     STMTH         IFEQ      12                                                          S0111
     C                   Z-ADD     0             STMTH                                         S0111
     C                   ADD       1             YEAR1                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  IF END MONTH IS NOT EQUAL TO 2 AND END DAY IS 31; OR MONTH      S01119
     C**  EQUALS 2 AND IT IS NOT A LEAP YEAR AND END DAY EQUALS 28;       S01119
     C**  OR MONTH EQUALS 2 AND IT IS A LEAP YEAR AND END DAY             S01119
     C**  EQUALS 29 THEN ADD 30 TO PERIOD COUNT                           S01119
     C*                                                                   S01119
     C     ENDMTH        IFNE      2                                                           S0111
     C     ENDDAY        ANDEQ     31                                                          S0111
     C     ENDMTH        OREQ      2                                                           S0111
     C     CHK2          ANDNE     0                                                           S0111
     C     ENDDAY        ANDEQ     28                                                          S0111
     C     SZICB         ANDEQ     3                                                           CIR00
     C     ENDMTH        OREQ      2                                                           S0111
     C     CHK2          ANDEQ     0                                                           S0111
     C     ENDDAY        ANDEQ     29                                                          S0111
     C     SZICB         ANDEQ     3                                                           CIR00
     C*                                                                   S01119
     C                   ADD       30            SZPER                                         S0111
     C*                                                                   S01119
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C**  ADD DAY NUMBER PORTION TO PERIOD COUNT                          S01119
     C*                                                                   S01119
     C                   ADD       ENDDAY        SZPER                                         S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  SUBTRACT 1 FROM END MONTH                                       S01119
     C*                                                                   S01119
     C                   SUB       1             ENDMTH                                        S0111
     C*                                                                   S01119
     C**  IF START YEAR AND END YEAR ARE THE SAME SUBTRACT START          S01119
     C**  MONTH FROM END MONTH                                            S01119
     C*                                                                   S01119
     C     YEAR1         IFEQ      YEAR2                                                       S0111
     C     ENDMTH        SUB       STMTH         MTHS                                          S0111
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C**  ADD END MTH TO THE RESULT OF SUBTRACTING START MONTH FROM 12    S01119
     C*                                                                   S01119
     C     12            SUB       STMTH         MTHS                                          S0111
     C     ENDMTH        ADD       MTHS          MTHS                                          S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  MULTIPLY THE NUMBER OF MONTHS BY 30 AND ADD TO THE PERIOD       S01119
     C*                                                                   S01119
     C     MTHS          MULT      30            MTHS2                                         S0111
     C                   ADD       MTHS2         SZPER                                         S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  CALCULATE THIS PERIOD'S DISCOUNTED SETTLEMENT AMOUNT USING      S01119
     C**  THIS EQUATION WHERE SS = SETTLEMENT AMOUNT                      S01119
     C**                       D = PERIOD                                 S01119
     C**                                                                  S01119
     C**        SS = (BASE RATE - FIXED RATE) x D x PRINCIPAL             S01119
     C**             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~       S01119
     C**             (INTEREST CALC BASIS x 100) + (BASE RATE x D)        S01119
     C*                                                                   S01119
     C     SZICB         IFNE      6                                                        MD051152
      *                                                                                     MD051152
     C     SZFLT         IFGE      SZFIX                                                       S0111
     C*                                                                   S01119
     C     SZFLT         SUB       SZFIX         SZWRK1                                        S0111
     C*                                                                   S01119
     C                   ELSE                                                                  S0111
     C*                                                                   S01119
     C     SZFIX         SUB       SZFLT         SZWRK1                                        S0111
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C     SZWRK1        MULT      SZPER         SZWRK2                                        S0111
      *                                                                   E35983
      * Multiply now by principal to get larger value for dividing        E35983
      * and avoid errors due to half-adjusting small numbers later        E35983
     C     SZWRK2        MULT      SZPPL         SZWRK6                                        E3598
      *                                                                   E35983
     C     SZICVL        MULT      100           SZWRK3                                        S0111
     C     SZFLT         MULT      SZPER         SZWRK4                                        S0111
     C     SZWRK3        ADD       SZWRK4        SZWRK5                                        S0111
     C     SZWRK6        DIV(H)    SZWRK5        SZSETL                                        E3598
      *                                                                                     MD051152
     C                   ENDIF                                                              MD051152
     C*                                                                   S01119
     C**  IF VALUE DATE = START DATE THEN FIRST PERIOD SO INITIALISE      S01119
     C**  RUNNING DISCOUNT FACTOR TO 1                                    S01119
     C*                                                                   S01119
     C     SZVDAT        IFEQ      SZSDAT                                                      S0111
     C*                                                                   S01119
     C                   Z-ADD     1             SZRDF                                         S0111
     C                   Z-ADD     SZSETL        SZRDS                                         S0111
     C                   ELSE                                                                  S0111
     C*                                                                   E22610
     C**  DIVIDE THE DISCOUNTED SETTLEMENT AMOUNT BY THE RUNNING          E22610
     C**  DISCOUNT FACTOR TO REDISCOUNT THIS PERIOD'S SETTLEMENT AMOUNT   E22610
     C**  BACK TO START DATE                                              E22610
     C*                                                                   E22610
     C     SZSETL        DIV(H)    SZRDF         SZRSA                                         E2261
     C*                                                                   E22610
     C**  ADD THE REDISCOUNTED SETTLEMENT AMOUNT TO THE RUNNING           E22610
     C**  DISCOUNTED  SETTLEMENT TOTAL                                    E22610
     C*                                                                   E22610
     C     SZRSA         ADD       SZRDS         SZRDS                                         E2261
     C*                                                                   E22610
     C                   END                                                                   E2261
      *                                                                                     MD051152
     C                   Z-ADD     0             SZSETL                                     MD051152
     C*                                                                   S01119
     C**  CALCULATE THIS PERIOD'S DISCOUNT FACTOR USING THE EQUATION      S01119
     C**                                                                  S01119
     C**    FACTOR = 1 +     (D x BASE RATE)                              S01119
     C**                 ~~~~~~~~~~~~~~~~~~~~~~~~~~                       S01119
     C**                 (INTEREST CALC BASIS x 100)                      S01119
     C*                                                                   S01119
     C     SZWRK4        DIV(H)    SZWRK3        SZWRK7                                        S0111
     C     1             ADD(H)    SZWRK7        SZDISC                                        S0111
     C*                                                                   S01119
     C**  MULTIPLY THE DISCOUNT FACTOR BY THE RUNNING DISCOUNT FACTOR     S01119
     C**  TO OBTAIN THE NEW RUNNING DISCOUNT FACTOR FOR REDISCOUNTING     S01119
     C**  SETTLEMENT AMOUNTS BACK TO START DATE                           S01119
     C*                                                                   S01119
     C     SZDISC        MULT(H)   SZRDF         SZRDF                                         S0111
     C*                                                                   S01119
     C*                                                                   S01119
     C**  SET THE START DATE TO THE END DATE                              S01119
     C*                                                                   S01119
     C                   Z-ADD     SZEDAT        SZSDAT                                        S0111
     C                   END                                                                   S0111
     C*                                                                   AUS021
     C                   END                                                                   AUS02
     C*                                                                   AUS021
     C                   END                                                                   AUS02
     C*                                                                   S01119
     C**  ADD THE NET ACCRUED INTEREST ADJUSTMENTS NOT POSTED TO THE      S01119
     C**  RUNNING DISCOUNTED SETTLEMENT TOTAL TO GIVE THE DISCOUNTED      S01119
     C**  SETTLEMENT AMOUNT TOTAL                                         S01119
     C*                                                                   S01119
     C     SZIANP        ADD       SZRDS         SZDSA                                         S0111
     C*                                                                   S01119
     C                   ENDSR                                                                 S0111
     C**************************************************************************            MD051152
     C/EJECT                                                                                MD051152
     C**************************************************************************            MD051152
     C     FRASR         BEGSR                                                              MD051152
                                                                                            MD051152
      *                                                                                     MD051152
      **  Calculate this period's discounted settlement amount using                        MD051152
      **  this equation where SS = Settlement amount                                        MD051152
      **                                                                                    MD051152
      **                       D = PERIOD                                                   MD051152
      **                                                                                    MD051152
      **        SS = (BASE RATE - FIXED RATE) x D x PRINCIPAL                               MD051152
      **             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                         MD051152
      **             (INTEREST CALC BASIS x 100) + (BASE RATE x D)                          MD051152
      *                                                                                     MD051152
     C     SZFLT         IFGE      SZFIX                                                    MD051152
      *                                                                                     MD051152
     C     SZFLT         SUB       SZFIX         SZWRK1                                     MD051152
      *                                                                                     MD051152
     C                   ELSE                                                               MD051152
      *                                                                                     MD051152
     C     SZFIX         SUB       SZFLT         SZWRK1                                     MD051152
      *                                                                                     MD051152
     C                   END                                                                MD051152
      *                                                                                     MD051152
     C     SZWRK1        MULT      SPPER         SZWRK2                                     MD051152
      *                                                                                     MD051152
      * Multiply now by principal to get larger value for dividing                          MD051152
      * and avoid errors due to half-adjusting small numbers later                          MD051152
     C     SZWRK2        MULT      SZPPL         SZWRK6                                     MD051152
      *                                                                                     MD051152
     C     SZICVL        MULT      100           SZWRK3                                     MD051152
     C     SZFLT         MULT      SZPER         SZWRK4                                     MD051152
     C     SZWRK3        ADD       SZWRK4        SZWRK5                                     MD051152
     C     SZWRK6        DIV(H)    SZWRK5        W#SET6           18 0                      MD051152
      *                                                                                     MD051152
     C     W#SET6        ADD       SZSETL        SZSETL                                     MD051152
      *                                                                                     MD051152
     C                   ENDSR                                                              MD051152
      *****************************************************************                       CAS006
     C/EJECT                                                                                  CAS006
      *****************************************************************                       CAS006
      *                                                               *                       CAS006
      *  SRFRAC - To calculate discounted settled amount for FRA      *                       CAS006
      *           with Risk Value Factor                              *                       CAS006
      *                                                               *                       CAS006
      *****************************************************************                       CAS006
      *                                                                                       CAS006
      /COPY DLCPYSRC,DL0280SRFR                                                               CPK022
     C********************************************************************S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*   SR: DLRSAC - TO CALCULATE ACCRUAL AMOUNTS FOR IRS AND       *   S01119
     C*                GENERATE KEYS                                  *   S01119
     C*                                                               *   S01119
     C*   CALLED FROM :- RSSUBR,RXSUBR,RLSUBR                         *   S01119
     C*   CALLS       :- GLINTC                                       *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C     DLRSAC        BEGSR                                                  ** DLRSAC **   S0111
     C*                                                                   S01119
     C**  IF DEAL TYPE = RS,RX OR (RR/RP/RF + AVE.RATE METHOD = N) CALC   S01157
     C**  INTEREST FROM  AND INCLUDING INTEREST ACCRUAL CONTROL DATE      S01119
     C*                                                                   S01119
     C     DTYP          IFNE      'RR'                                                        S0115
     C     DTYP          ANDNE     'RP'                                                        S0115
     C     DTYP          ANDNE     'RF'                                                        S0115
     C     SZAVRM        ORNE      'Y'                                                         S0111
     C*                                                                   CIR001
     C** IF CASH FLOW SCHEDULE, DETERMINE PROPORTION OF CASH FLOW ACCRUED CIR001
     C*                                                                   CIR001
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C     SZIPFC        ANDEQ     'C'                                                         CIR00
      *                                                                   100289
      ** Use SR/ZINTDY to determine the number of days from the last      100289
      **   pay date to the event control date.                            100289
      *                                                                   100289
     C                   Z-ADD     SZSLID        ZZBEG                                         10028
     C                   Z-ADD     SZECD         ZZEND                                         10028
     C                   MOVEL     SZCBS         ZZCALC                                        10028
      *                                                                   100289
     C     SZLDA         IFNE      'Y'                                                         10028
     C     ZZEND         ADD       1             ZZEND                                         10028
     C                   END                                                                   10028
      *                                                                   100289
     C                   EXSR      ZINTDY                                                      10028
      *                                                                   100289
      * For calculation Method '6'  use new field INT6DY  introduced by   163136
      * core  #126017  in  ZINTDY .                                       163136
      *                                                                   163136
     C     ZZCALC        IFEQ      '6'                                                         16313
     C     ZZCALC        OREQ      '9'                                                        CIR013
     C     #29FEB        ANDEQ     'Y'                                                        CIR013
     C                   Z-ADD     INT6DY        ZPARPD                                        16313
     C                   ELSE                                                                  16313
     C                   Z-ADD     ZZINDY        ZPARPD            5 0                         10028
     C                   END                                                                   16313
      *                                                                   100289
      ** Use SR/ZINTDY to determine the number of days from the last      100289
      **   pay date to the next payment date.                             100289
      *                                                                   100289
     C                   Z-ADD     SZSLID        ZZBEG                                         10028
     C                   Z-ADD     SZNIPD        ZZEND                                         10028
     C                   MOVEL     SZCBS         ZZCALC                                        10028
      *                                                                   100289
     C                   EXSR      ZINTDY                                                      10028
      *                                                                   163136
      * For calculation Method '6'  use new field INT6DY  introduced by   163136
      * core  #126017  in  ZINTDY .                                       163136
      *                                                                   163136
     C     ZZCALC        IFEQ      '6'                                                         16313
     C     ZZCALC        OREQ      '9'                                                        CIR013
     C     #29FEB        ANDEQ     'Y'                                                        CIR013
     C                   Z-ADD     INT6DY        ZFULPD                                        16313
     C                   ELSE                                                                  16313
      *                                                                   100289
     C                   Z-ADD     ZZINDY        ZFULPD            5 0                         10028
     C                   END                                                                   16313
      *                                                                   100289
      ** Also set up ZIEND as this is used by #LDNCF to get the           100289
      **   cash-flow amount on the next payment date.                     100289
      *                                                                   100289
     C                   Z-ADD     SZNIPD        ZIEND                                         10028
     C*                                                                   CIR001
     C** DETERMINE PAYMENT DUE ON NEXT DATE (ZIEND) FROM CASH FLOW        CIR001
     C** SCHEDULE                                                         CIR001
     C*                                                                   CIR001
     C     AKY(9)        IFEQ      'P'                                                         CIR00
     C                   MOVEL     'U'           OTIN                           * OURS         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVEL     'T'           OTIN                           * THEIRS       CIR00
     C                   END                                                                   CIR00
     C                   EXSR      #LDNCF                                                      CIR00
     C*                                                                   CIR001
     C** PRO-RATA THE PAYMENT AMOUNT IN THIS ACCRUAL PERIOD               CIR001
     C*                                                                   CIR001
     C     CFLA          MULT      ZPARPD        WKINT                                         CIR00
     C     ZFULPD        IFNE      *ZERO                                                       CIR00
     C                   DIV(H)    ZFULPD        WKINT                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     *ZERO         WKINT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C*                                                                   S01119
     C                   Z-ADD     SZIACD        ZIBEG                                         S0111
     C                   Z-ADD     SZECD         ZIEND                                         S0111
     C*                                                                   S01119
     C**  IF LAST DAY ACCRUAL IND. = Y CALC INTEREST UP TO BUT            S01119
     C**  EXCLUDING THE EVENT CONTROL DATE OTHERWISE CALC UP TO           S01119
     C**  AND INCLUDING EVENT CONTROL DATE                                S01119
     C*                                                                   S01119
     C     SZLDA         IFNE      'Y'                                                         S0111
     C     ZIEND         ADD       1             ZIEND                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     SZPPL         ZIAMT                                         S0111
     C                   Z-ADD     SZINTR        ZIRATE                                        S0111
     C                   Z-ADD     SZCBS         ZICALC                                        S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP74                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP75                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C/COPY WNCPYSRC,DL0280C260
     C                   END                                                                   CIR00
     C*                                                                   S01119
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  ELSE IF DEAL TYPE = RR/RP/RF + AVE. RATE METHOD = Y. CALC       S01157
     C**  INT. FROM AND INCLUDING START DATE CURRENT AVE. RATE PERIOD     S01119
     C*                                                                   S01119
     C     DTYP          IFEQ      'RR'                                                        S0115
     C     SZAVRM        ANDEQ     'Y'                                                         S0111
     C     DTYP          OREQ      'RF'                                                        S0115
     C     SZAVRM        ANDEQ     'Y'                                                         S0115
     C     DTYP          OREQ      'RP'                                                        S0115
     C     SZAVRM        ANDEQ     'Y'                                                         S0115
     C                   Z-ADD     SZSDCR        ZIBEG                                         S0111
     C                   Z-ADD     SZECD         ZIEND                                         S0111
     C*                                                                   S01119
     C**  IF LAST DAY ACCRUAL IND. = Y CALC INTEREST UP TO BUT            S01119
     C**  EXCLUDING THE EVENT CONTROL DATE OTHERWISE CALC UP TO           S01119
     C**  AND INCLUDING EVENT CONTROL DATE                                S01119
     C*                                                                   S01119
     C     SZLDA         IFNE      'Y'                                                         S0111
     C     ZIEND         ADD       1             ZIEND                                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C                   Z-ADD     SZPPL         ZIAMT                                         S0111
     C                   Z-ADD     SZINTR        ZIRATE                                        S0111
     C                   Z-ADD     SZCBS         ZICALC                                        S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP90                                           S01408
      *                                                                   S01408
     C                   EXSR      GLINTC                                                      S0111
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280CP91                                           S01408
      *                                                                   S01408
     C* To replace a line removed from the internally described GLINTC    066550
     C*                                                                   066550
     C     *IN02         IFEQ      '1'                                                         06655
     C     ZIRDFC        ANDEQ     'Y'                                                         06655
     C     *IN03         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C     *IN04         OREQ      '1'                                                         06655
     C     JRDFC         ANDEQ     'Y'                                                         06655
     C                   Z-ADD     ZINTR         WKINT                                         06655
     C                   ELSE                                                                  06655
     C                   Z-ADD(H)  ZINTR         WKINT                                         06655
     C                   END                                                                   06655
     C*                                                                   066550
     C                   Z-ADD     WKINT         SZIWRK           13 0                         S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  ADD INTEREST CALCULATED,INTEREST ACCRUED TO CONTROL DATE,       S01119
     C**  ACCRUED INTEREST ADJUSTMENTS NOT POSTED AND ACCRUED INT         S01119
     C**  ADJUSTMENTS POSTED = ACCRUED INTEREST TO DATE                   S01119
     C*                                                                   S01119
     C     WKINT         ADD       SZAICD        SZAITD           13 0                         S0111
     C     SZAITD        ADD       SZIANP        SZAITD                                        S0111
     C     SZAITD        ADD       SZAIAP        SZAITD                                        S0111
     C*                                                                   S01119
     C**  CALCULATE ACCRUED INTEREST TO POST                              S01119
     C*                                                                   S01119
     C     SZAITD        SUB       SZIPTD        SZAITP           13 0                         S0111
     C/COPY WNCPYSRC,DL0280C581
      *                                                                                       CIR007
      ** If our side of the deal and our side of the deal is an OIS or                        CIR007
      ** their side of the deal and their side of the deal is an OIS                          CIR007
      ** call DL1651.                                                                         CIR007
      *                                                                                       CIR007
     C     CIR007        IFEQ      'Y'
      *                                                                                       CIR007
     C     AKY(9)        IFEQ      'P'
     C     UICFR         ANDEQ     'O'
     C     AKY(9)        OREQ      'R'
     C     TICFR         ANDEQ     'O'
      *                                                                                       CIR007
     C     AKY(9)        IFEQ      'P'
     C                   MOVE      'O'           PSIDE
     C                   ELSE
     C                   MOVE      'T'           PSIDE
     C                   ENDIF
      *                                                                                       CIR007
      ** If First Day Accruals, subtract 1 from ZIEND as ZIEND increased                      CIR007
      ** by 1 in core code for First Day Accruals.                                            CIR007
      *                                                                                       CIR007
     C     SZLDA         IFNE      'Y'
     C     ZIEND         SUB       1             PTODT
     C                   Z-ADD     SZSLID        PFRDT
     C                   ENDIF
      *                                                                                       CIR007
      ** If Last Day Accruals, add 1 to the from date to give the                             CIR007
      ** correct number of days.                                                              CIR007
      *                                                                                       CIR007
     C     SZLDA         IFEQ      'Y'
     C     WFXDY         IFNE      0
     C                   Z-ADD     SZSLID        PFRDT
     C                   ELSE
     C     SZSLID        ADD       1             PFRDT
     C                   ENDIF
     C                   Z-ADD     ZIEND         PTODT
     C                   ENDIF
      *                                                                                       CIR007
     C                   CALL      'DL1651'
     C                   PARM      DLNO          PDLNO             6 0
     C                   PARM                    PSIDE             1
     C                   PARM                    PFRDT             5 0
     C                   PARM                    PTODT             5 0
     C     PAMNT         PARM      *ZERO         PAMNT            13 0
     C                   PARM      *BLANK        PRTRN             1
     C                   PARM      *BLANK        PTOAC             1
      *                                                                                       204923
     C     WFXDY         IFNE      0
     C                   Z-ADD     PTODT         ZIEND
     C                   Z-ADD     PTODT         KYDAT
     C                   ENDIF
      *                                                                                       CIR007
      ** Add Accrued Interest Adjusted not Posted,and Accrued Interest                        CIR007
      ** Adjusted and Posted to the Amount returned from DL1651.                              CIR007
      ** Add Interest Paid/Received to date to get a figure for the                           CIR007
      ** total amount of interest accrued for this deal from the start.                       CIR007
      *                                                                                       CIR007
     C     PAMNT         ADD       SZIANP        SZAITD
     C     SZAITD        ADD       SZAIAP        SZAITD
     C     SZAITD        ADD       SZIPRD        SZAITD
      *                                                                                       CIR007
      ** Subtract total amount of interest accrued for this deal from                         CIR007
      ** the start to arrive at the accrual amount to post today.                             CIR007
      *                                                                                       CIR007
     C     SZAITD        SUB       SZIPTD        SZAITP
      *                                                                                       CIR007
     C                   ENDIF
      *                                                                                       CIR007
     C                   ENDIF
     C*                                                                   S01119
     C**  GENERATE AN ACCRUAL DATE ACCOUNT KEY RECORD FOR THE             S01119
     C**  ACCRUED INTEREST TO POST                                        S01119
     C*                                                                   S01119
     C     SZAITP        IFNE      0                                                           S0111
     C                   Z-ADD     SZAITP        KYAMT                                         S0111
     C     CIR001        IFEQ      'Y'                                                         CIR00
     C                   Z-ADD     SZAITP        NRRSAL                                        CIR00
     C                   END                                                                   CIR00
     C                   MOVEA     DTYP          AKY(1)                                        S0111
     C                   MOVEA     DLST          AKY(4)                                        S0111
     C                   MOVEA     'A'           AKY(10)                                       S0111
     C                   MOVEA     'A'           AKY(3)                                        S0111
     C                   MOVEA     '   '         AKY(6)                                        19815
1206 C                   MOVEL     NEV(6)        NARREV                                        E1119
     C     NRBRTT        IFEQ      '00'                                                        E2269
     C                   MOVE      '  '          NRBRTT                                        E2269
     C                   SETOFF                                       31                       E2269
     C                   END                                                                   E2269
     C                   SETON                                        71                       E1119
     C                   EXSR      EXCP                                                        S0111
     C                   END                                                                   S0111
     C*                                                                   S01119
     C**  ADD THE ACCRUED INTEREST ADJUSTMENTS NOT POSTED TO              S01119
     C**  ACCRUED INTEREST ADJUSTMENTS POSTED                             S01119
     C*                                                                   S01119
     C     SZIANP        ADD       SZAIAP        SZAIAP                                        S0111
     C*                                                                   S01119
     C**  ADD ACCRUED INTEREST TO POST TO ACCRUED INTEREST POSTED         S01119
     C**  TO DATE                                                         S01119
     C*                                                                   S01119
     C     SZAITP        ADD       SZIPTD        SZIPTD                                        S0111
     C*                                                                   S01119
     C**  ADD THE INTEREST CALCULATED TO INTEREST ACCRUED TO              S01119
     C**  CONTROL DATE                                                    S01119
     C*                                                                   S01119
     C     WKINT         ADD       SZAICD        SZAICD                                        S0111
     C*                                                                   S01119
     C**  ZEROISE ACCRUED INTEREST ADJUSTMENTS NOT POSTED                 S01119
     C*                                                                   S01119
     C                   Z-ADD     0             SZIANP                                        S0111
     C*                                                                   S01119
     C**  UPDATE THE INTEREST ACCRUAL CONTROL DATE TO THE END DATE        S01119
     C*   USED BY P/GLINTC                                                S01119
     C*                                                                   S01119
     C                   Z-ADD     ZIEND         SZIACD                                        S0111
     C*                                                                   S01119
     C                   ENDSR                                                                 S0111
2922 C********************************************************************S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*   SR: DLRSIN - TO CALCULATE INTEREST AMOUNTS FOR IRS AND      *   S01119
     C*                GENERATE KEYS                                  *   S01119
     C*                                                               *   S01119
     C*   CALLED FROM :- RSSUBR,RXSUBR,RLSUBR                         *   S01119
     C*   CALLS       :- GLINTC,ZDATE5,ZFREQ                          *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
      *Externalisation of SR/DLRSIN                                                           CIR017
     C/COPY DLCPYSRC,DL028DLRSN                                                 ** DLRSIN **  CIR017
2585 C*****************************************************************   S01119
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *Externalisation of SR/SRRSAC                                                           CPK024
     C/COPY DLCPYSRC,DL0280RSAC

      /EJECT                                                                                  CAS005
      *Externalisation of SR/SRRSIN                                                           CPK021
     C/COPY DLCPYSRC,DL0280RSIN
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
     C/COPY WNCPYSRC,DLH00099
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRDLIN - Call GLINTC to calculate interest amounts for       *                       CAS005
      *           Loans/Deposits and Neg. Assets Purchased            *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C     SRDLIN        BEGSR
      *                                                                                       CAS005
     C                   EXSR      GLINTC
      *                                                                                       CAS005
      ** To replace a line removed from the internally described GLINTC                       CAS005
      *                                                                                       CAS005
     C     *IN02         IFEQ      *ON
     C     ZIRDFC        ANDEQ     'Y'
     C     *IN03         OREQ      *ON
     C     JRDFC         ANDEQ     'Y'
     C     *IN04         OREQ      *ON
     C     JRDFC         ANDEQ     'Y'
     C                   Z-ADD     ZINTR         WINTST
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WINTST           13 0
     C                   ENDIF
      *                                                                                       CAS005
     C                   ENDSR
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRNTR - Get Net-Treasury-Rate                                *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C     SRNTR         BEGSR
      *                                                                                       CAS005
     C                   SELECT
     C     FSLQPS        WHENEQ    '+'
     C     WRKINT        ADD       FSLQPR        WKINTR           11 7
     C     FSLQPS        WHENEQ    '-'
     C     WRKINT        SUB       FSLQPR        WKINTR
     C     FSLQPS        WHENEQ    ' '
     C                   Z-ADD     WRKINT        WKINTR
     C                   ENDSL
      *                                                                                       CAS005
     C                   ENDSR
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *                                                                                       CAS005
      /COPY DLCPYSRC,DL0280TOTI
      *
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRRTOT - Get TOTI for Net-Treasury-Rate for REPOS            *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C     SRRTOT        BEGSR
      *                                                                                       CAS005
     C     DTYP          IFEQ      'CD'
     C     MDAT          ANDEQ     0
     C     DTYP          OREQ      'CL'
     C     MDAT          ANDEQ     0
     C     NOTD          IFEQ      0
     C     ZIBEG         ADD       1             ZIEND
     C                   ELSE
     C     NOTD          IFNE      -999
     C     ZIBEG         ADD       NOTD          ZIEND
     C                   ELSE
     C                   Z-ADD     MDAT          ZIEND
     C                   ENDIF
     C                   ENDIF
     C                   ELSE
      *                                                                                       CAS005
      ** If first & last day interest, calculate to maturity date + 1                         CAS005
      *                                                                                       CAS005
     C     JFLID         IFEQ      'Y'
     C     MDAT          ADD       1             ZIEND
     C                   ELSE
     C                   Z-ADD     MDAT          ZIEND
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXSR      GLINTC
      *                                                                                       CAS005
      ** To replace a line removed from the internally described GLINTC                       CAS005
      *                                                                                       CAS005
     C     *IN02         IFEQ      *ON
     C     ZIRDFC        ANDEQ     'Y'
     C     *IN03         OREQ      *ON
     C     JRDFC         ANDEQ     'Y'
     C     *IN04         OREQ      *ON
     C     JRDFC         ANDEQ     'Y'
     C                   Z-ADD     ZINTR         FSTOTN
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         FSTOTN
     C                   ENDIF
      *                                                                                       CAS005
     C                   ENDSR
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0280C184                                           S01408
     C/EJECT                                                              S01328
      *                                                               *   S01486
     C/COPY DLCPYSRC,DL0280P01                                            S01408
      *                                                               *   S01486
     C/EJECT                                                              S01486
      *                                                               *   S01486
     C/COPY DLCPYSRC,DL0280P02                                            S01408
     C********************************************************************S01486
     C/EJECT                                                              S01486
     C*****************************************************************   S01486
     C*                                                               *   S01486
     C*   SR: P03    - OBTAIN PORTFOLIO CURRENCY                      *   S01486
     C*                                                               *   S01486
     C*   CALLED FROM :- P01, P02                                     *   S01486
     C*   CALLS       :-                                              *   S01486
     C*                                                               *   S01486
     C*****************************************************************   S01486
     C     P03           BEGSR                                                  ** P03    **   S0148
      *                                                                   CPM004
      * If bank portfolios then use Branch Customer Number                CPM004
      *                                                                   CPM004
     C     FCPORS        IFEQ      'B'                                                         CPM00
     C                   MOVEL     A8BICN        ##CNUM                                        CPM00
     C                   ELSE                                                                  CPM00
     C**********         Z-ADD     CNUM          ##CNUM                                 CPM00 CSD027
     C                   EVAL      ##CNUM = CNUM                                              CSD027
     C                   ENDIF                                                                 CPM00
     C*                                                                   S01486
     C     ##CNUM        IFNE      WWCNUM                                                      CPM00
     C     PTFR          ORNE      WWPTFR                                                      S0148
     C*                                                                   S01486
     C**********         Z-ADD     ##CNUM        WWCNUM                                 CPM00 CSD027
     C                   EVAL      WWCNUM = ##CNUM                                            CSD027
     C                   MOVE      PTFR          WWPTFR            4                           S0148
     C*                                                                   S01486
     C     PTFR          IFEQ      '9997'                                                      S0148
     C                   CALL      'AOPLCSR0'                                                  S0148
     C                   PARM                    @RTCD             7                           10956
     C                   PARM      '*KEY   '     @OPTN             7                           S0148
     C                   PARM      WWCUST        @KEY1            10                           S0148
     C     SDPLCS        PARM      SDPLCS        DSSDY                                         S0148
     C*                                                                   S01486
     C** DATABASE ERROR                                                   S01486
     C     @RTCD         IFNE      *BLANK                                                      S0148
     C                   SETON                                        U7U8LR                   S0148
     C                   MOVEL     '14'          DBASE             3             **DBERR 1**   S0148
     C**********         EXCEPT    ERROR                                              S0148 AR547995
     C                   MOVE      'Y'           WWERRF                                        S0148
     C                   GOTO      P03END                                                      S0148
     C                   END                                                                   S0148
     C*                                                                   S01486
     C                   MOVE      QBCSBY        WWPCCY                                        S0148
     C                   ELSE                                                                  S0148
     C     PMPOKY        CHAIN     PMPORTPD                           18                       S0148
     C*                                                                   S01486
     C** DATABASE ERROR                                                   S01486
     C     *IN18         IFEQ      '1'                                                         S0148
     C                   SETON                                        U7U8LR                   S0148
     C                   MOVEL     '15'          DBASE             3             **DBERR15**   S0148
     C                   MOVEL     'PMPORTPD'    DBFILE                                        09562
     C                   MOVEL     ##CNUM        @PMPKY           10                           CPM00
     C                   MOVE      PTFR          @PMPKY                                        09562
     C                   MOVEL     @PMPKY        DBKEY                                         09562
     C**********         EXCEPT    ERROR                                              S0148 AR547995
     C                   MOVE      'Y'           WWERRF                                        S0148
     C                   EXSR      *PSSR                                                       09562
     C                   GOTO      P03END                                                      S0148
     C                   END                                                                   S0148
     C*                                                                   S01486
     C                   MOVE      PNPTCY        WWPCCY            3                           S0148
     C                   END                                                                   S0148
     C                   END                                                                   S0148
     C*                                                                   S01486
     C     P03END        ENDSR                                                  ** P03 END *   S0148
     C********************************************************************S01486
     C**                                                                  S01328
     C** S/R UNREAL                                                       S01328
     C** DESCRIPTION:TO GENERATE UNREALIZED PROFIT/LOSS ACCOUNT KEYS      S01328
     C**             ON THE FOLLOWING OCCASIONS;                          S01328
     C**             ACCRUAL DATE  (LIVE FRA/IRSs)                        S01328
     C**             VALUE DATE    (LIVE FRAs)                            S01328
     C**             MATURITY DATE (LIVE IRSs)                            S01328
     C**             DELETION DATE (DELETED FRA/IRSs)                     S01328
     C**                                                                  S01328
     C     UNREAL        BEGSR                                                                 S0132
     C**                                                                  S01328
     C** DEFINE ACCOUNT KEY: DEAL TYPE_A_DEAL SUB-TYPE                    S01328
     C**                                                                  S01328
0874 C                   MOVE      *BLANK        AKY                                           S0132
0875 C                   MOVEA     DTYP          AKY(1)                                        S0132
0877 C                   MOVE      'A'           AKY(3)                                        S0132
0875 C                   MOVEA     DLST          AKY(4)                                        S0132
     C**                                                                  S01328
     C** SET EVENT DATE & FED. FUNDS DATE EQUAL TO RUN DATE               S01328
     C**                                                                  S01328
0878 C                   Z-ADD     BJRDNB        KYDAT                                         S0132
0878 C                   Z-ADD     BJRDNB        KYFED                                         S0132
     C**                                                                  S01328
     C** SET EVENT CURRENCY EQUAL TO BASE CURRENCY IF CROSS CURRENCY IRS  S01328
     C** ELSE SET EVENT CURRENCY EQUAL TO OUR PAY/RECEIVE CURRENCY        S01328
     C**                                                                  S01328
0881 C     DTYP          IFEQ      'RX'                                                        S0132
0881 C                   MOVE      BJCYCD        KYCCY                                         S0132
     C                   MOVE      *BLANKS       KYSCY                                         CEU00
0881 C                   ELSE                                                                  S0132
0881 C                   MOVE      UCUCY         KYCCY                                         S0132
     C                   MOVE      PSCY          KYSCY                                         CEU00
0881 C                   END                                                                   S0132
     C**                                                                  S01328
     C** RESET SETTLEMENT METHOD,ACCOUNT,BRANCH                           S01328
     C**                                                                  S01328
0882 C                   Z-ADD     *ZERO         KYSETL                                        S0132
0883 C                   MOVE      *BLANK        KYOSTL                                        S0132
0962 C                   MOVE      BRCA          KYSTBR                                        S0132
     C*                                                                   S01328
     C** REVERSE UNREALIZED PROFIT/LOSS POSTED IF:                        S01328
     C** 1. UNREALIZED P/L POSTED <> 0    AND UNREALIZED P/L = 0          S01328
     C** 2. UNREALIZED P/L POSTED >  0    AND UNREALIZED P/L < 0          S01328
     C** 3. UNREALIZED P/L POSTED <  0    AND UNREALIZED P/L > 0          S01328
     C*                                                                   S01328
     C     UNRLP         IFNE      *ZERO                                                       S0132
     C     UNRL          ANDEQ     *ZERO                                                       S0132
     C     UNRLP         ORGT      *ZERO                                                       S0132
     C     UNRL          ANDLT     *ZERO                                                       S0132
     C     UNRLP         ORLT      *ZERO                                                       S0132
     C     UNRL          ANDGT     *ZERO                                                       S0132
     C*                                                                   S01328
     C** IF UNREALIZED P/L POSTED > ZERO RECORD THE POSTING AS A PROFIT   S01328
     C*                                                                   S01328
     C     UNRLP         IFGT      *ZERO                                                       S0132
0875 C                   MOVEA     'UP'          AKY(9)                                        S0132
     C*                                                                   S01328
     C** IF DEAL NOT REVERSED, THE AMOUNT MUST BE NEGATIVE                S01328
     C** (IF DEAL IS REVERSED THE REVERSAL INDICATOR WILL DO THIS)        S01328
     C*                                                                   S01328
     C     *IN47         IFEQ      '0'                                                         S0132
     C                   Z-SUB     UNRLP         KYAMT                                         S0132
     C                   Z-SUB     UNRLP         NRRSAL                                        04697
     C                   ELSE                                                                  S0132
     C                   Z-ADD     UNRLP         KYAMT                                         S0132
     C                   Z-SUB     UNRLP         NRRSAL                                        04697
     C                   END                                                                   S0132
     C*                                                                   S01328
     C** IF UNREALIZED P/L IS < ZERO RECORD THE POSTING AS A LOSS         S01328
     C*                                                                   S01328
     C                   ELSE                                                                  S0132
0875 C                   MOVEA     'UL'          AKY(9)                                        S0132
     C*                                                                   S01328
     C** IF DEAL NOT REVERSED, THE AMOUNT MUST BE NEGATIVE                S01328
     C*                                                                   S01328
     C     *IN47         IFEQ      '0'                                                         S0132
     C                   Z-ADD     UNRLP         KYAMT                                         S0132
     C                   Z-ADD     UNRLP         NRRPUR                                        04697
     C                   ELSE                                                                  S0132
     C                   Z-SUB     UNRLP         KYAMT                                         S0132
     C                   Z-SUB     UNRLP         NRRPUR                                        04697
     C                   END                                                                   S0132
     C                   END                                                                   S0132
     C*                                                                   S01328
     C** WRITE KEY TO DKEYSDP (EVENT NOT PRINTED AS *IN17 IS NOT SET ON)  S01328
     C*                                                                   S01328
     C*                                                                   046978
     C** Set on *IN71 to include this entry in DL0280 report              046978
     C*                                                                   046978
     C                   SETON                                        71                       04697
     C                   EXSR      EXCP                                                        S0132
     C*                                                                   S01328
     C** SET UNREALIZED PROFIT/LOSS POSTED EQUAL TO ZERO                  S01328
     C*                                                                   S01328
     C                   Z-ADD     *ZERO         UNRLP                                         S0132
     C                   END                                                                   S0132
     C*                                                                   S01328
     C** POST UNREALIZED PROFIT/LOSS IF IT IS NOT ZERO                    S01328
     C*                                                                   S01328
     C     UNRL          IFNE      *ZERO                                                       S0132
     C*                                                                   S01328
     C** AMOUNT TO POST = UNREALIZED P/L MINUS UNREALIZED P/L POSTED      S01328
     C*                                                                   S01328
     C     UNRL          SUB       UNRLP         KYAMT                                         S0132
     C*                                                                   S01328
     C** IF UNREALIZED P/L IS > ZERO RECORD THE POSTING AS A PROFIT       S01328
     C** ELSE                        RECORD THE POSTING AS A LOSS         S01328
     C*                                                                   S01328
     C     UNRL          IFGT      *ZERO                                                       S0132
0875 C                   MOVEA     'UP'          AKY(9)                                        S0132
     C                   Z-ADD     KYAMT         NRRSAL                                        04697
     C                   ELSE                                                                  S0132
0875 C                   MOVEA     'UL'          AKY(9)                                        S0132
     C                   Z-SUB     KYAMT         KYAMT                                         S0132
     C                   Z-ADD     KYAMT         NRRPUR                                        04697
     C                   END                                                                   S0132
     C*                                                                   S01328
     C** WRITE KEY TO DKEYSDP (EVENT NOT PRINTED AS *IN17 IS NOT SET ON)  S01328
     C*                                                                   S01328
     C*                                                                   046978
     C** Set on *IN71 to include this entry in DL0280 report              046978
     C*                                                                   046978
     C                   SETON                                        71                       04697
     C                   EXSR      EXCP                                                        S0132
     C*                                                                   S01328
     C** SET UNREALIZED PROFIT/LOSS POSTED EQUAL TO UNREALIZED PROFIT/LOSSS01328
     C*                                                                   S01328
     C                   Z-ADD     UNRL          UNRLP                                         S0132
     C                   END                                                                   S0132
     C                   ENDSR                                                                 S0132
     C*****************************************************************   S01328
     C/COPY DLCPYSRC,DL0280RSIU
     C/EJECT                                                              CIR001
     C*****************************************************************   CIR001
     C*                                                               *   CIR001
     C*  #LRSAU - To calculate accrual amounts for IRS and            *   CIR001
     C*           generate keys if interest is Up-front.              *   CIR001
     C*                                                               *   CIR001
     C*  Called by  : RSSUBR - To process FRA/IRS deal type RS        *   CIR001
     C*               RXSUBR - To process FRA/IRS deal type RX        *   CIR001
     C*                                                               *   CIR001
     C*  Calls      : EXCP   - Output DKEYS records by exception, and *   CIR001
     C*                        report the event actioned on the       *   CIR001
     C*                        printer file.                          *   CIR001
     C*               GLINTC - Calculate interest between any two day *   CIR001
     C*                        numbers.                               *   CIR001
     C*               #LCIYD - Calculate interest on discount/yield   *   CIR001
     C*                        basis.                                 *   CIR001
     C*****************************************************************   CIR001
     C     #LRSAU        BEGSR                                                  ** #LRSAU **   CIR00
     C*                                                                   CIR001
     C**  CALCULATE INTEREST FROM THE LAST INTEREST PAYMENT DATE          CIR001
     C**  TO THE NEXT INTEREST PAYMENT DATE                               CIR001
     C**  (OR THE MATURITY DATE IF NO MORE INTEREST PAYMENTS ARE DUE)     CIR001
     C*                                                                   CIR001
     C                   Z-ADD     SZSLID        ZIBEG                                         CIR00
     C     SZNIPD        IFNE      *ZERO                                                       CIR00
     C                   Z-ADD     SZNIPD        ZIEND                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     MDAT          ZIEND                                         CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     ZIEND         SZIEND            5 0                         CIR00
     C                   Z-ADD     SZPPL         ZIAMT                                         CIR00
     C                   Z-ADD     SZINTR        ZIRATE                                        CIR00
     C                   Z-ADD     SZCBS         ZICALC                                        CIR00
     C                   EXSR      GLINTC                                                      CIR00
     C*                                                                   CIR001
     C** IF INTEREST IS YIELD BASED (METHOD IS 'Y') CALCULATE IT          CIR001
     C** (USING INFORMATION PROVIDED BY GLINTC)                           CIR001
     C*                                                                   CIR001
     C     SZINPM        IFEQ      'Y'                                                         CIR00
     C                   EXSR      #LCIYD                                                      CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C**  SUBTRACT THIS INTEREST FROM THE INTEREST ACCRUED TO CONTROL     CIR001
     C**  DATE AND ADD THE ACCRUED INTEREST ADJUSTMENTS POSTED TO         CIR001
     C**  OBTAIN THE INTEREST ACCRUED TO THE LAST PAYMENT DATE            CIR001
     C*                                                                   CIR001
     C     SZAICD        SUB       WKINT         SZAITD                                        CIR00
     C                   ADD       SZAIAP        SZAITD                                        CIR00
     C                   Z-ADD     WKINT         SWKINT           13 0                         CIR00
     C*                                                                   CIR001
     C**  CALCULATE INTEREST FROM THE LAST INTEREST PAYMENT DATE          CIR001
     C**  TO THE EVENT CONTROL DATE                                       CIR001
     C*                                                                   CIR001
     C                   Z-ADD     SZSLID        ZIBEG                                         CIR00
     C                   Z-ADD     SZECD         ZIEND                                         CIR00
     C*                                                                   CIR001
     C**  IF LAST DAY ACCRUAL IND. = Y CALC INTEREST UP TO BUT            CIR001
     C**  EXCLUDING THE EVENT CONTROL DATE OTHERWISE CALC UP TO           CIR001
     C**  AND INCLUDING EVENT CONTROL DATE                                CIR001
     C*                                                                   CIR001
     C     SZLDA         IFNE      'Y'                                                         CIR00
     C     ZIEND         ADD       1             ZIEND                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C                   Z-ADD     SZPPL         ZIAMT                                         CIR00
     C                   Z-ADD     SZINTR        ZIRATE                                        CIR00
     C                   Z-ADD     SZCBS         ZICALC                                        CIR00
     C                   EXSR      GLINTC                                                      CIR00
     C*                                                                   CIR001
     C** IF INTEREST IS YIELD BASED (METHOD IS 'Y') CALCULATE IT          CIR001
     C** (USING INFORMATION PROVIDED BY GLINTC)                           CIR001
     C*                                                                   CIR001
     C     SZINPM        IFEQ      'Y'                                                         CIR00
     C     SZIEND        SUB       ZIEND         ZZINDY                                        CIR00
     C                   EXSR      #LCIYD                                                      CIR00
     C     SWKINT        SUB       WKINT         WKINT                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD(H)  ZINTR         WKINT                                         CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C**  ADD INTEREST CALCULATED TO INTEREST ACCRUED TO CONTROL DATE     CIR001
     C*                                                                   CIR001
     C                   ADD       WKINT         SZAITD                                        CIR00
     C*                                                                   CIR001
     C**  CALCULATE ACCRUED INTEREST TO POST                              CIR001
     C*                                                                   CIR001
     C     SZAITD        SUB       SZIPTD        SZAITP                                        CIR00
     C*                                                                   CIR001
     C**  GENERATE AN ACCRUAL DATE ACCOUNT KEY RECORD FOR THE             CIR001
     C**  ACCRUED INTEREST TO POST                                        CIR001
     C*                                                                   CIR001
     C     SZAITP        IFNE      0                                                           CIR00
     C                   Z-ADD     SZAITP        KYAMT                                         CIR00
     C                   Z-ADD     SZAITP        NRRSAL                                        CIR00
     C                   MOVEA     DTYP          AKY(1)                                        CIR00
     C                   MOVEA     DLST          AKY(4)                                        CIR00
     C                   MOVEA     'A'           AKY(10)                                       CIR00
     C                   MOVEA     'A'           AKY(3)                                        CIR00
1206 C                   MOVEL     NEV(6)        NARREV                                        CIR00
     C                   SETON                                        71                       CIR00
     C                   EXSR      EXCP                                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C**  ADD ACCRUED INTEREST TO POST TO ACCRUED INTEREST POSTED         CIR001
     C**  TO DATE                                                         CIR001
     C*                                                                   CIR001
     C                   ADD       SZAITP        SZIPTD                                        CIR00
     C*                                                                   CIR001
     C                   ENDSR                                                                 CIR00
     C*                                                                   CIR001
2922 C*****************************************************************   CIR001
2922 C/EJECT                                                              CIR001
     C*****************************************************************   CIR001
     C*                                                               *   CIR001
     C*  #LCIYD - To calculate interest on Discount/Yield basis.      *   CIR001
     C*                                                               *   CIR001
     C*  Called by  : RSSUBR - To process FRA/IRS deal type RS        *   CIR001
     C*               RXSUBR - To process FRA/IRS deal type RX        *   CIR001
     C*               #LRSIU - Calculate interest amounts for up-front*   CIR001
     C*                        interest.                              *   CIR001
     C*               #LRSAU - Calculate accrual amounts for up-front *   CIR001
     C*                        interest.                              *   CIR001
     C*                                                               *   CIR001
     C*  Calls      : None.                                           *   CIR001
     C*                                                               *   CIR001
     C*****************************************************************   CIR001
     C     #LCIYD        BEGSR                                                                 CIR00
     C*                                                                   CIR001
     C** INTEREST = PRINCIPAL ( 1 - 1 / ( 1 + RATE X NUMBER OF DAYS/360)) CIR001
     C**       I.E. PRINCIPAL ( 1 - 360 / ( 360 + RATE X NUMBER OF DAYS)) CIR001
     C*                                                                   CIR001
     C     ZICALC        IFEQ      2                                                           CIR00
     C     ZICALC        OREQ      3                                                           CIR00
     C     ZICALC        OREQ      5                                                           CIR00
     C     ZICALC        OREQ      7                                                           CIR00
     C     CIR004        ANDEQ     'Y'                                                         CIR00
     C                   Z-ADD     36000         ZIWRK3            5 0                         CIR00
     C                   ELSE                                                                  CIR00
     C     ZICALC        IFEQ      1                                                           CIR00
     C     ZICALC        OREQ      4                                                           CIR00
     C     ZICALC        OREQ      9                                                          CIR013
     C     #29FEB        ANDEQ     'N'                                                        CIR013
     C                   Z-ADD     36500         ZIWRK3                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     36600         ZIWRK3                                        CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C     ZICALC        IFEQ      9                                                          CIR013
     C     #29FEB        ANDEQ     'Y'                                                        CIR013
     C     INT6DY        MULT      ZIRATE        ZIWRK4           15 7                        CIR013
     C                   ELSE                                                                 CIR013
     C     ZZINDY        MULT      ZIRATE        ZIWRK4           15 7                         CIR00
     C                   ENDIF                                                                CIR013
     C                   ADD       ZIWRK3        ZIWRK4                                        CIR00
     C*                                                                   CIR001
     C     ZIWRK3        DIV(H)    ZIWRK4        ZIWRK5           15 9                         CIR00
     C     1             SUB       ZIWRK5        ZIWRK5                                        CIR00
     C     ZIAMT         MULT(H)   ZIWRK5        WKINT                                         CIR00
     C                   ENDSR                                                                 CIR00
2896 C*****************************************************************   CIR001
2922 C/EJECT                                                              CIR001
2896 C*****************************************************************   CIR001
     C*                                                               *   CIR001
     C*  #LDNDT - To determine next rate change/payment date from     *   CIR001
     C*            date schedule file.                                *   CIR001
     C*                                                               *   CIR001
     C*  Called by  : RSSUBR - To process FRA/IRS deal type RS        *   CIR001
     C*               RXSUBR - To process FRA/IRS deal type RX        *   CIR001
     C*               IRSAMD - To process deal amendments for RS, RX, *   CIR001
     C*                        RR/RP/RF NON-AVE.                      *   CIR001
     C*               DLRSIN - To calculate interest amounts for IRS  *   CIR001
     C*                        and generate keys.                     *   CIR001
     C*                                                               *   CIR001
     C*  Calls      : None.                                           *   CIR001
     C*                                                               *   CIR001
     C*****************************************************************   CIR001
     C     #LDNDT        BEGSR                                                                 CIR00
     C                   Z-ADD     ZDAYNO        PRDT                                          CIR00
     C     KDTSL         SETGT     DLDTSCPD                                                    CIR00
     C     KDTSP         READE     DLDTSCPD                               99    *              CIR00
     C     *IN99         IFEQ      '0'                                                         CIR00
     C                   Z-ADD     PRDT          ZDAYNO                                        CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     MDAT          ZDAYNO                                        CIR00
     C                   END                                                                   CIR00
     C                   ENDSR                                                                 CIR00
     C*****************************************************************   CIR001
     C/EJECT                                                              CIR001
     C*****************************************************************   CIR001
     C*                                                               *   CIR001
     C*  #LDNCF - To determine next cash flow.                        *   CIR001
     C*                                                               *   CIR001
     C*  Called by  : DLRSAC - To calculate accrual amounts for IRS.  *   CIR001
     C*               DLRSIN - To calculate interest amounts for IRS. *   CIR001
     C*                                                               *   CIR001
     C*  Calls      : None.                                           *   CIR001
     C*                                                               *   CIR001
     C*****************************************************************   CIR001
     C     #LDNCF        BEGSR                                                                 CIR00
     C                   Z-ADD     ZIEND         PRDT                                          CIR00
     C     KCFSL         CHAIN     DLCFSCPD                           99        *              CIR00
     C     *IN99         IFEQ      '0'                                                         CIR00
     C                   Z-ADD     ULCFLA        CFLA             13 0                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     *ZERO         CFLA                                          CIR00
     C                   END                                                                   CIR00
     C     KCFSL         SETGT     DLCFSCPD                                                    CIR00
     C     KCFSP         READE     DLCFSCPD                               99    *              CIR00
     C     *IN99         IFEQ      '1'                                                         CIR00
     C                   Z-ADD     MDAT          PRDT                                          CIR00
     C                   END                                                                   CIR00
     C                   ENDSR                                                                 CIR00
     C*****************************************************************   CIR001
     C/EJECT                                                              CIR001
     C*****************************************************************   CIR001
     C*                                                               *   CIR001
     C*  #LPRCH - Process principal change due.                       *   CIR001
     C*                                                               *   CIR001
     C*  Called by  : RSSUBR - To process FRA/IRS deal type RS        *   CIR001
     C*               RXSUBR - To process FRA/IRS deal type RX        *   CIR001
     C*                                                               *   CIR001
     C*  Calls      : None.                                           *   CIR001
     C*                                                               *   CIR001
     C*****************************************************************   CIR001
     C     #LPRCH        BEGSR                                                                 CIR00
      *                                                                   CIR001
      ** If our/their indicator = *BLANK, our and their next change       CIR001
      **   dates will be equal and either can be used.                    CIR001
      *                                                                   CIR001
     C     PORTH         IFEQ      *BLANK                                                      CIR00
     C     PORTH         OREQ      'U'                                                         CIR00
     C                   Z-ADD     UNPCD         PRDT                                          CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     TNPCD         PRDT                                          CIR00
     C                   END                                                                   CIR00
      *                                                                   CIR001
     C     KPCSL         CHAIN     DLPCSCPD                           99        *              CIR00
     C     *IN99         IFEQ      '0'                                                         CIR00
     C                   Z-ADD     ULPAMT        WPAMT            15 0                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     *ZERO         WPAMT                                         CIR00
     C                   END                                                                   CIR00
      *                                                                   CIR001
     C/COPY WNCPYSRC,DL0280C434
     C     KPCSL         SETGT     DLPCSCPD                                                    CIR00
     C     KPCSP         READE     DLPCSCPD                               99    *              CIR00
      *                                                                   CIR001
      ** If no record is found and our/their indicator = *BLANK,          CIR001
      **   both our and their next principal change dates should be       CIR001
      **   set to zero.                                                   CIR001
      *                                                                   CIR001
     C     *IN99         IFEQ      '1'                                                         CIR00
      *                                                                   CIR001
     C     PORTH         IFEQ      *BLANK                                                      CIR00
     C                   Z-ADD     *ZERO         UNPCD                                         CIR00
     C                   Z-ADD     *ZERO         TNPCD                                         CIR00
     C                   ELSE                                                                  CIR00
     C     PORTH         IFEQ      'U'                                                         CIR00
     C                   Z-ADD     *ZERO         UNPCD                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     *ZERO         TNPCD                                         CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
      *                                                                   CIR001
     C                   ELSE                                                                  CIR00
      *                                                                   CIR001
      ** If record is found and our/their indicator = *BLANK,             CIR001
      **   both our and their next principal change dates should be       CIR001
      **   updated.                                                       CIR001
      *                                                                   CIR001
     C     PORTH         IFEQ      *BLANK                                                      CIR00
     C                   Z-ADD     PRDT          UNPCD                                         CIR00
     C                   Z-ADD     PRDT          TNPCD                                         CIR00
     C                   ELSE                                                                  CIR00
     C     PORTH         IFEQ      'U'                                                         CIR00
     C                   Z-ADD     PRDT          UNPCD                                         CIR00
     C                   ELSE                                                                  CIR00
     C                   Z-ADD     PRDT          TNPCD                                         CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
      *                                                                   CIR001
     C                   END                                                                   CIR00
      *                                                                   CIR001
     C                   ENDSR                                                                 CIR00
3885  *
     C/COPY DLCPYSRC,DL0280INT
3885  *
     C*****************************************************************   CIR001
     C/EJECT                                                              S01328
3031 C********************************************************************
     C/COPY WNCPYSRC,DLH00100
3032 C**
3033 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS
3034 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.
3035 C**
3036 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS
3037 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.
3038 C**
3039 C     ZSAVE         BEGSR                                                  *** ZSAVE ***
3040 C**
3041 C                   BITOFF    '01234567'    ZBITS             1
3042 C   90              BITON     '0'           ZBITS
3043 C   91              BITON     '1'           ZBITS
3044 C   92              BITON     '2'           ZBITS
3045 C   93              BITON     '3'           ZBITS
3046 C   94              BITON     '4'           ZBITS
3047 C   95              BITON     '5'           ZBITS
3048 C   96              BITON     '6'           ZBITS
3049 C   97              BITON     '7'           ZBITS
3050 C**
3051 C                   SETOFF                                       909192
3052 C                   SETOFF                                       939495
3053 C                   SETOFF                                       9697
3054 C**
3055 C                   ENDSR
3057 C**
3058 C********************************************************************
3059 C**
3060 C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS
3061 C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.
3062 C**
3063 C     ZRSTOR        BEGSR                                                  *** ZRSTOR ***
3064 C**
3065 C                   TESTB     '0'           ZBITS                    90
3066 C                   TESTB     '1'           ZBITS                    91
3067 C                   TESTB     '2'           ZBITS                    92
3068 C                   TESTB     '3'           ZBITS                    93
3069 C                   TESTB     '4'           ZBITS                    94
3070 C                   TESTB     '5'           ZBITS                    95
3071 C                   TESTB     '6'           ZBITS                    96
3072 C                   TESTB     '7'           ZBITS                    97
3073 C**
3074 C                   ENDSR
3076 C**
3077 C********************************************************************
3078 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
3079 C*   IND '99' IS SET BY AN OVERFLOW ERROR
3080 C*
3081 C     GLZADD        BEGSR                                                  *** GLZADD ****
3082 C*
3083 C                   Z-ADD     ZZAMT         ZZAMT            15 3    91    -DEFINE ZZAMT
3084 C   91              GOTO      ZZAEND                                       AMT = 0.BYPASS
3085 C*
3086 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
3087 C                   Z-ADD     ZZAMT         ZZAMTI           15 0          INTEGER FIELD
3088 C                   MOVE      ZZAMT         ZZAMTD            3 0          DECIMAL FIELD
3089 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
3090 C*
3091 C                   EXSR      GLZSUM
3092 C     ZZAEND        ENDSR                                                  ** ZZAEND TAG *
3093 C*
3094 C********************************************************************
3095 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
3096 C*                        GLZADD, GLZSUB, GLZCMP.
3097 C*          PARAMETERS PASSED -
3098 C*                     I/P ZZAMTI ZZAMTD
3099 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
3100 C*
3101 C     GLZSUM        BEGSR                                                  *** GLZSUM ****
3102 C*
3103 C                   Z-ADD     ZZTOTI        ZZTOTI           15 0          DEFINE ZZTOTI
3104 C                   Z-ADD     ZZTOTD        ZZTOTD            3 0          DEFINE ZZTOTD
3105 C                   SETOFF                                       919293
3106 C                   SETOFF                                       949599
3107 C*
3108 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
3109 C     ZZAMTI        COMP      0                                    9293
3110 C   93ZZAMTD        COMP      0                                    9293
3111 C   93              GOTO      ZZSEND                                       ZERO BYPASS
3112 C*
3113 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
3114 C     ZZTOTI        COMP      0                                    9193
3115 C   93ZZTOTD        COMP      0                                    9193
3116 C*
3117 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
3118 C   93              Z-ADD     ZZAMTI        ZZTOTI
3119 C   93              Z-ADD     ZZAMTD        ZZTOTD
3120 C   93              GOTO      ZZSEND                                       ZERO BYPASS
3121 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91
3122 CANN92
     CORN91
3123 CAN 92              GOTO      ZZOFPS
3124 C*
3125 C     ZZAMTD        ADD       ZZTOTD        ZZWK2             4 0
3126 C     ZZWK2         COMP      999                                93        '93' = CARRY
3127 C  N93ZZWK2         COMP      -999                                 93        INTO INTEGER.
3128 C*
     C   93
3129 CANN92ZZAMTI        ADD       1             ZZWK3            15 0          ADD 'CARRY' +VE
     C   93
3130 CAN 92ZZAMTI        SUB       1             ZZWK3                          SUB 'CARRY' -VE
3131 C   93ZZTOTI        ADD       ZZWK3         ZZWK3
3132 C  N93ZZTOTI        ADD       ZZAMTI        ZZWK3
3133 C*
3134 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
3135 C  N92ZZWK3         COMP      ZZTOTI                               99      -92 MEANS NOS.
3136 C   92ZZWK3         COMP      ZZTOTI                             99         NEGATIVE
3137 C  N99              Z-ADD     ZZWK2         ZZTOTD
3138 C  N99              Z-ADD     ZZWK3         ZZTOTI
3139 C*
3140 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
3141 C   99              Z-ADD     0             ZZAMT            15 3
3142 C                   GOTO      ZZSEND
3143 C*
3144 C* THE 'SIGNS' ARE DIFFERENT
3145 C     ZZOFPS        TAG                                                    ** ZZOFPS TAG**
3146 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
3147 C*
3148 C   92              Z-SUB     ZZAMTI        ZZAMTI           15 0
3149 C   92              Z-SUB     ZZAMTD        ZZAMTD            3 0
3150 C*
3151 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
3152 C*
3153 C   91              Z-SUB     ZZTOTI        ZZTOTI
3154 C   91              Z-SUB     ZZTOTD        ZZTOTD
3155 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
3156 C*
3157 C     ZZTOTI        COMP      ZZAMTI                             93  95
3158 C   95ZZTOTD        COMP      ZZAMTD                             93  95
3159 C*
3160 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
3161 C   95              Z-ADD     0             ZZTOTI
3162 C   95              Z-ADD     0             ZZTOTD
3163 C   95              GOTO      ZZSEND
3164 C*
3165 C* IF ZZTOT GT. ZZAMT.
3166 C   93ZZAMTD        COMP      ZZTOTD                             94
     C   93
3167 CAN 94ZZTOTI        SUB       1             ZZTOTI
     C   93
3168 CAN 94ZZTOTD        ADD       1000          ZZWK2
3169 C   93ZZTOTI        SUB       ZZAMTI        ZZTOTI
     C   93
3170 CAN 94ZZWK2         SUB       ZZAMTD        ZZTOTD
     C   93
3171 CANN94ZZTOTD        SUB       ZZAMTD        ZZTOTD
3172 C*
3173 C*
3174 C* IF ZZAMT GT. ZZTOT.
3175 C  N93ZZTOTD        COMP      ZZAMTD                             94
     C  N93
3176 CAN 94ZZAMTI        SUB       1             ZZWK3            15 0
     C  N93
3177 CAN 94ZZAMTD        ADD       1000          ZZWK2
     C  N93
3178 CAN 94ZZWK3         SUB       ZZTOTI        ZZTOTI
     C  N93
3179 CANN94ZZAMTI        SUB       ZZTOTI        ZZTOTI
     C  N93
3180 CAN 94ZZWK2         SUB       ZZTOTD        ZZTOTD
     C  N93
3181 CANN94ZZAMTD        SUB       ZZTOTD        ZZTOTD
3182 C*
3183 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
3184 C                   SETOFF                                       94
     C   93
3185 CAN 91
     CORN93
3186 CAN 92              SETON                                        94
3187 C   94              Z-SUB     ZZTOTI        ZZTOTI
3188 C   94              Z-SUB     ZZTOTD        ZZTOTD
3189 C**
3190 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
3191 C   92              Z-SUB     ZZAMTI        ZZAMTI
3192 C   92              Z-SUB     ZZAMTD        ZZAMTD
3193 C     ZZSEND        TAG                                                    ** ZZSEND TAG *
3194 C**
3195 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
3196 C                   SETOFF                                       96
3197 C     ZZTOTD        COMP      0                                      91
3198 C   91ZZTOTI        COMP      0                                    96
3199 C   96              MOVE      '.000-'       ZZNEGD            5
3200 C                   ENDSR                                                    ** ENDSR **
3201 C********************************************************************
3202 C**
3204 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
3205 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
3206 C**   AND STORE SPOT RATES.
3207 C**   SUBROUTINE CCYARR REMOVED                                      S01093
3250 C********************************************************************
3251 C**
3252 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
3253 C**   SUBROUTINE CCYDEP REMOVED                                      S01093
3270 C********************************************************************
3271 C**
3272 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
3273 C**
3274 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
3275 C**
3276 C     ZDATE2        BEGSR                                                  *** ZDATE2 ***
3277 C**
3278 C**   CLEAR DATE FIELDS.
3279 C                   Z-ADD     0             ZDATE             6 0
3280 C                   MOVEL     '       '     ZADATE            7
3281 C**
3282 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
3283 C                   Z-ADD     ZDAYNO        ZDAYNO            5 0
3284 C**
3285 C**   DETERMINE YEAR NUMBER.
3287 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
3288 C     ZDAYNO        SUB       1             ZDAYN1            5 0  99
3289 C   99              GOTO      ZDEND2
3290 C**
3291 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
3292 C     ZDAYN1        DIV       1461          ZLYR              2 0
3293 C                   MVR                     ZDAYN1                         SAVE REMAINING
3294 C**                                                   DAYS
3295 C**   CALCULATE NUMBER OF REMAINING YEARS.
3296 C                   Z-ADD     1             ZWRK2             2 0
3297 C     ZDTAG1        TAG                                                    ** ZDTAG1 TAG *
3298 C     ZDAYN1        COMP      ZYDY(ZWRK2)                          90
3299 C  N90ZWRK2         ADD       1             ZWRK2
3300 C  N90              GOTO      ZDTAG1
3301 C     ZWRK2         SUB       1             ZWRK2                    91    LEAP YR, 91 ON
3302 C**
3303 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
3304 C  N91ZDAYN1        SUB       ZYDY(ZWRK2)   ZDAYN1
3305 C**
3306 C**   CALCULATE ACTUAL YEAR NUMBER.
3307 C     ZLYR          MULT      4             ZWRK3             3 0
3308 C     ZWRK3         ADD       72            ZWRK3                          BASE IS 1972
3309 C                   Z-ADD     ZWRK3         ZYEAR             2 0
3310 C     ZYEAR         ADD       ZWRK2         ZYEAR                          YEAR
3311 C**
3312 C**   DETERMINE MONTH NUMBER.
3314 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
3315 C                   SETOFF                                       9293
3316 C   91ZDAYN1        COMP      59                                   9293
     C   91
3317 CANN92ZDAYN1        SUB       1             ZDAYN1
3318 C**
3319 C**   CALCULATE MONTH NUMBER.
3320 C                   Z-ADD     2             ZWRK2
3321 C     ZDTAG2        TAG                                                    ** ZDTAG2 TAG *
3322 C     ZDAYN1        COMP      ZMDY(ZWRK2)                          94
3323 C  N94ZWRK2         ADD       1             ZWRK2
3324 C  N94              GOTO      ZDTAG2
3325 C     ZWRK2         SUB       1             ZWRK2
3326 C**
3327 C                   Z-ADD     ZWRK2         ZMTH              2 0          MONTH
3328 C**
3329 C**   DETERMINE DAY OF MONTH.
3331 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
3332 C     ZDAYN1        ADD       1             ZDAYN1
3333 C**
3334 C**   CALCULATE DAY OF MONTH.
3335 C     ZDAYN1        SUB       ZMDY(ZWRK2)   ZDAY              2 0          DAY
3336 C**
3337 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
3338 C   93ZDAY          ADD       1             ZDAY
3339 C**
3340 C**   FORMAT DATE, DDMMYY OR MMDDYY.
3341 C  N98              MOVEL     ZDAY          ZWRK4             4 0
3342 C   98              MOVE      ZDAY          ZWRK4
3343 C  N98              MOVE      ZMTH          ZWRK4
3344 C   98              MOVEL     ZMTH          ZWRK4
3345 C                   MOVEL     ZWRK4         ZDATE
3346 C                   MOVE      ZYEAR         ZDATE
3347 C**
3348 C**   FORMAT ALPHA DATE, DDMMMYY.
3349 C     ZDAY          COMP      10                                   95
3350 C                   MOVEL     ZDAY          ZWRK5             5
3351 C   95              MOVEL     ' '           ZWRK5
3352 C                   MOVE      ZMNM(ZMTH)    ZWRK5
3353 C                   MOVEL     ZWRK5         ZADATE
3354 C                   MOVE      ZYEAR         ZADATE
3355 C**
3356 C     ZDEND2        ENDSR                                                  * ZDEND2 ENDSR*
3438 C********************************************************************
3439 C**
3440 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
3441 C**              CONVERT TO A NUMBER OF DAYS.
3442 C**
3443 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
3444 C**
3445 C     ZDATE1        BEGSR                                                  *** ZDATE1 ***
3446 C**
3447 C**   CLEAR DAY NUMBER.
3448 C                   Z-ADD     0             ZDAYNO            5 0
3449 C**
3450 C**   CALCULATION TO DEFINE INPUT DATE FIELD.
3451 C                   Z-ADD     ZDATE         ZDATE             6 0
3452 C**
3453 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
3454 C                   MOVE      ZDATE         ZYEAR             2 0
3455 C  N98              MOVEL     ZDATE         ZDAY              2 0
3456 C   98              MOVEL     ZDATE         ZMTH              2 0
3457 C                   MOVE      ZDATE         ZWRK4             4 0
3458 C  N98              MOVEL     ZWRK4         ZMTH
3459 C   98              MOVEL     ZWRK4         ZDAY
3460 C**
3461 C**   ENSURE MONTH IS VALID.
3462 C     ZMTH          COMP      0                                    9999
3463 C  N99ZMTH          COMP      12                                 99
3464 C   99              GOTO      ZDEND1                                       BYPASS IF ERROR
3465 C**
3466 C**   CHECK FOR 30 DAY MONTHS.
3467 C     ZMTH          COMP      4                                      90    IF 90 ON, 30
3468 C  N90ZMTH          COMP      6                                      90    DAY MONTH.
3469 C  N90ZMTH          COMP      9                                      90
3470 C  N90ZMTH          COMP      11                                     90
3471 C**
3472 C**   ENSURE DAY IS VALID.
3473 C     ZDAY          COMP      0                                    9999
     C   90
3474 CANN99ZDAY          COMP      30                                 99
     C  N90
3475 CANN99ZDAY          COMP      31                                 99
3476 C   99              GOTO      ZDEND1                                       BYPASS IF ERROR
3477 C**
3478 C**   CHECK FOR LEAP YEAR AND FEBRUARY.
3479 C     ZYEAR         ADD       28            ZYEAR
3480 C     ZYEAR         DIV       4             ZLYR              2 0
3481 C                   MVR                     ZLY               1 0    91    LEAP YR, 91 ON
3482 C     ZMTH          COMP      2                                  93  92    FEB., 92 ON
3483 C**                                                   PAST FEB, 93 ON
3484 C**   IF FEBUARY FURTHER VALIDATE DAY.
     C  N91
3485 CAN 92ZDAY          COMP      28                                 99
     C   91
3486 CAN 92ZDAY          COMP      29                                 99
3487 C   99              GOTO      ZDEND1                                       BYPASS IF ERROR
3488 C**
3489 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
3490 C     ZLYR          MULT      1461          ZDAYNO                         X DAYS IN SPAN.
3491 C  N91ZDAYNO        ADD       ZYDY(ZLY)     ZDAYNO                         SINCE LAST L.YR
     C   91
3492 CAN 93ZDAYNO        ADD       1             ZDAYNO                         L.YR.,PAST FEB.
3493 C     ZDAYNO        ADD       ZMDY(ZMTH)    ZDAYNO                         DAYS THIS YEAR
3494 C     ZDAYNO        ADD       ZDAY          ZDAYNO                         DAYS THIS MONTH
3495 C**
3496 C     ZDEND1        ENDSR                                                  * ZDEND1 ENDSR*
3499 C********************************************************************
3500 C*****                                                               S01195
3571 C********************************************************************
3657 C**
3658 C**   ZFREQ -SR. TO INCREMENT A DAY NUMBER DATE BY A
3659 C**             PERIOD VALUE DETERMINED BY A CODE.
3660 C**
3661 C     ZFREQC        BEGSR                                                  *** ZFREQC *** S0119
3662 C**
3663 C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
3664 C                   MOVE      ZFREQ         ZFREQ             1
3665 C                   Z-ADD     ZDAYNO        ZDAYNO            5 0
3666 C                   Z-ADD     ZMDAY         ZMDAY             2 0
3667 C                   MOVE      ZCCY          ZCCY              3
3668 C**
3672 C*            FIELDS USED FOR PERIOD CODES M,T,Q,X,Y
3673 C*
3674 C                   MOVE      '  '          ZINDE             2
3675 C                   Z-ADD     0             ZINTO             2 0
3676 C**
3677 C**   CONVERT DAY NUMBER TO DATE.
3678 C                   EXSR      ZDATE2
3679 C                   SETOFF                                       90
3680 C**
3681 C**   CHECK FOR AND INCREMENT FOR CODE D-DAILY-WORKING DAY.
3682 C     ZFREQ         COMP      'D'                                    91
3683 C   91ZDAYNO        ADD       1             ZDAYNO
3684 C   91              GOTO      ZFHCHK
3685 C**
3686 C**   CHECK FOR AND INCREMENT FOR CODE W-WEEKLY.
3687 C     ZFREQ         COMP      'W'                                    91
3688 C   91ZDAYNO        ADD       7             ZDAYNO
3689 C   91              GOTO      ZFEND
3690 C**
3691 C**   CHECK FOR AND INCREMENT FOR CODE F-FORTNIGHTLY.
3692 C     ZFREQ         COMP      'F'                                    91
3693 C   91ZDAYNO        ADD       14            ZDAYNO
3694 C   91              GOTO      ZFEND
3695 C**
3696 C**   CHECK FOR AND INCREMENT FOR CODE S-SEMI-MONTHLY.
3697 C     ZFREQ         COMP      'S'                                    91
3698 C   91ZDAY          COMP      15                                 939292
     C   91
3699 CAN 92              Z-ADD     31            ZDAY
     C   91
3700 CAN 93              Z-ADD     15            ZDAY
     C   91
3701 CAN 93ZMTH          ADD       1             ZMTH
3702 C   91              GOTO      ZFDATE
3703 C**
3704 C**   CHECK FOR AND INCREMENT FOR CODE M-MONTHLY.
3705 C     ZFREQ         COMP      'M'                                    91
3706 C   91              MOVE      'IN'          ZINDE
3707 C   91              Z-ADD     ZMDAY         ZDAY
3708 C   91ZMTH          ADD       1             ZMTH
3709 C   91              GOTO      ZFDATE
3710 C**
3711 C**   CHECK FOR AND INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTH
3712 C     ZFREQ         COMP      'R'                                    91
3713 C   91              Z-ADD     31            ZDAY
3714 C   91ZMTH          ADD       1             ZMTH
3715 C   91              GOTO      ZFDATE
3716 C**
3717 C**   CHECK FOR AND INCREMENT FOR CODE T-BIMONTHLY.
3718 C     ZFREQ         COMP      'T'                                    91
3719 C   91              MOVE      'IN'          ZINDE
3720 C   91              Z-ADD     ZMDAY         ZDAY
3721 C   91ZMTH          ADD       2             ZMTH
3722 C   91              GOTO      ZFDATE
3723 C**
3724 C**   CHECK FOR AND INCREMENT FOR CODE Q-QUARTERLY.
3725 C     ZFREQ         COMP      'Q'                                    91
3726 C   91              MOVE      'IN'          ZINDE
3727 C   91              Z-ADD     ZMDAY         ZDAY
3728 C   91ZMTH          ADD       3             ZMTH
3729 C   91              GOTO      ZFDATE
3730 C**
3731 C**   CHECK FOR AND INCREMENT FOR CODE X-SIX MONTHLY.
3732 C     ZFREQ         COMP      'X'                                    91
3733 C   91              MOVE      'IN'          ZINDE
3734 C   91              Z-ADD     ZMDAY         ZDAY
3735 C   91ZMTH          ADD       6             ZMTH
3736 C   91              GOTO      ZFDATE
3737 C**
3738 C**   CHECK FOR AND INCREMENT FOR CODE Y-YEARLY.
3739 C     ZFREQ         COMP      'Y'                                    91
3740 C   91              MOVE      'IN'          ZINDE
3734 C   91              Z-ADD     ZMDAY         ZDAY
3741 C   91ZYEAR         ADD       1             ZYEAR
3742 C   91              GOTO      ZFDATE
3743 C**
3744 C**   CHECK FOR AND INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH.
3745 C     ZFREQ         COMP      'L'                                    91
3746 C   91              Z-ADD     31            ZDAY
3747 C   91ZMTH          ADD       1             ZMTH
3748 C   91              GOTO      ZFDATE
3749 C**
3750 C**   CHECK FOR AND INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.
3751 C     ZFREQ         COMP      'B'                                    91
3752 C   91              Z-ADD     31            ZDAY
3753 C   91ZMTH          ADD       1             ZMTH
3754 C   91              GOTO      ZFDATE
3755 C**
3756 C**   CHECK FOR AND INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.
3757 C     ZFREQ         COMP      'A'                                    91
3758 C**                   MOVEL'01    '  ZTABKY
3762 C   91              Z-ADD     BKAPDT        ZDAYNO                                        S0119
3763 C**
3764 C**   BYPASS IF ZFREQ IS 'A' OR ANY OTHER VALUE
3765 C                   GOTO      ZFEND
3766 C**
3767 C**
3768 C**   REFORMAT DATE AND ENSURE VALID.
3769 C     ZFDATE        TAG                                                    ** ZFDATE TAG*
3770 C**
3771 C**   VALIDATE MONTH.
3772 C     ZMTH          COMP      12                                 91
3773 C   91ZMTH          SUB       12            ZMTH
3774 C   91ZYEAR         ADD       1             ZYEAR
3775 C**
3776 C**   CHECK FOR LEAP YEAR.
3777 C     ZYEAR         DIV       4             ZLYR              2 0
3778 C                   MVR                     ZLY               1 0    92    LEAP YEAR-92 ON
3779 C**
3780 C**   VALIDATE DAY NUMBER.
3781 C                   MOVE      ZFMD(ZMTH)    ZWRK2             2 0
3782 C     ZMTH          COMP      2                                      93
     C   92
3783 CAN 93              Z-ADD     29            ZWRK2
3784 C**
3785 C     ZDAY          COMP      ZWRK2                              94
3786 C   94              Z-ADD     ZWRK2         ZDAY
3787 C**
3788 C**   CHECK IF CODE R, TO SUBTRACT 6 DAYS.
3789 C     ZFREQ         COMP      'R'                                    91
3790 C   91ZDAY          SUB       6             ZDAY
3791 C**
3792 C**   REFORMAT DATE, DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.
3793 C                   MOVEL     ZDAY          ZWRK4             4 0
3794 C                   MOVE      ZMTH          ZWRK4
3795 C   98              MOVEL     ZMTH          ZWRK4
3796 C   98              MOVE      ZDAY          ZWRK4
3797 C                   MOVEL     ZWRK4         ZDATE
3798 C                   MOVE      ZYEAR         ZDATE
3799 C                   EXSR      ZDATE1
     C*                                                                   044994
     C** Store the Base Date (ie. before adjustment for holidays)         044994
     C*                                                                   044994
     C                   Z-ADD     ZDAYNO        ZBD               5 0                         04499
     C/COPY WNCPYSRC,DL0280C023
     C**                                                                  AUS003
     C* NO HOLIDAY CHECK FOR FREQ. 'N' (THIS LINE APPLY ONLY TO DL0280)   AUS003
     C     IPFR          CABEQ     'N'           ZFEND                                         AUS00
     C/COPY WNCPYSRC,DL0280C636
3800 C**
3801 C**   CHECK IF CODE B, OR M,T,Q,X,Y TO BE CHECKED FOR HOLIDAY.
3802 C     ZFREQ         COMP      'B'                                    91
3803 C     ZINDE         COMP      'IN'                                   92
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C144                                           S01408
     C*                                                                   S01408
     C   92
3804 CANN99
     COR 91
3805 CANN99              GOTO      ZFHCHK
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0280C145                                           S01408
     C*                                                                   S01408
3807 C                   GOTO      ZFEND
3808 C**
3809 C**   CHECK IF DAY NUMBER IS A HOLIDAY.
3810 C**
3811 C     ZFHCHK        TAG                                                    ** ZFHCHK TAG *
3812 C                   SETOFF                                       94
     C/COPY WNCPYSRC,DL0280C518
3813 C     ZFREQ         COMP      'D'                                    91
3814 C     ZFREQ         COMP      'B'                                    92
3815 C   91
3816 COR 92              GOTO      ZSETK
3817 C*
3818 C*   FOR CODES M,T,Q,X,Y, CHECK ZINDE - 'IN' TO INCREMENT,
3819 C*                                    - 'DE' TO DECREMENT
3820 C*
3821 C     ZINDE         COMP      'IN'                                   90
3822 C     ZINDE         COMP      'IN'                                   91
3823 C     ZINDE         COMP      'DE'                                   92
3824 C******                                                              S01195
3825 C******ET KEY FOR FIRST HOLIDAY RECORD.                              S01195
3826 C     ZSETK         TAG                                                    ** ZSETK TAG **
3849 C*                                                                   S01195
     C                   EXSR      ZCHKH                                                       S0119
     C*                                                                   S01195
3854 C*    CHECK IF CURRENCY ON HOLIDAY.                                  S01195
     C*                                                                   S01195
     C     ZIND          CABEQ     'W'           ZFEND                                         S0119
3856 C**
3857 C**   BYPASS IF NOT HOLIDAY FOR CURRENCY.
3861 C**
3862 C   92              GOTO      ZDECR
3863 C*
3864 C**   INCREMENT OR DECREMENT DAY NUMBER AS REQUIRED.
3865 C   91ZDAYNO        ADD       1             ZDAYNO
3866 C*
3867 C*    ONLY FOR PERIOD CODE = M,T,Q,X OR Y, IF INCREMENTATION
3868 C*    TAKES THE OUTPUT DATE INTO THE FOLLOWING MONTH, RETURN TO
3869 C*    THE INPUT DATE AND DECREMENT - 92 ON.
3870 C*
     C   90
3871 CAN 91ZINTO         ADD       1             ZINTO
     C   90
3872 CAN 91ZINTO         ADD       ZDAY          ZINTOT            2 0
     C   90
3873 CAN 91              MOVE      ZINTOT        ZINTOA            2
     C**TO ALLOW 29 FEB ON LEAP YEARS TO PASS
     C                   SETOFF                                       93
     C   90
     CAN 91ZYEAR         DIV       4             ZLYR
     C   90
     CAN 91              MVR                     ZLY                      92
     C   90
     CAN 91
     CAN 92ZMTH          COMP      2                                      93
     C   93ZINTOA        COMP      '29'                               92
     C   90
     CAN 91
     CANN93ZINTOA        COMP      ZFMD(ZMTH)                         92
     C   90
     CAN 91
3875 CAN 92ZDAYNO        SUB       ZINTO         ZDAYNO
     C   90
     CAN 91
3876 CAN 92              MOVE      'DE'          ZINDE
3877 C**
3878 C     ZDECR         TAG                                                    ** ZDECR TAG **
3880 C   92ZDAYNO        SUB       1             ZDAYNO                                        S0119
3881 C                   GOTO      ZFHCHK
3883 C**
3884 C     ZFEND         ENDSR                                                  * ZFEND ENDSR *
3885 C**
     C/COPY WNCPYSRC,DL0280C669
     C********************************************************************S01378
     C/EJECT                                                              044994
     C*****************************************************************   044994
     C**                                                              *   044994
     C** RXPDTA subroutine calculates next interest payment date for  *   044994
     C** a RX IRS.                                                    *   044994
     C** Purpose: Identify whether payment dates for both currencies  *   044994
     C**          should coincide (via ZFREQC);                       *   044994
     C**          If so calculate next intrerest payment date - such  *   044994
     C**          that it is a working day in both currencies (via    *   044994
     C**          RXPDTB).                                            *   044994
     C**                                                              *   044994
     C** Input:   X1IPDB - Interest Payment Base Date ) for side of   *   044994
     C**          X1IPD  - Interest Payment Month     ) RX IRS being  *   044994
     C**          X1CCY  - Currency                   ) processed     *   044994
     C**                                                              *   044994
     C**          X2IPDB - Interest Payment Base Date ) for the other *   044994
     C**          X2IPD  - Interest Payment Month     ) side of the   *   044994
     C**          X2CCY  - Currency                   ) IRS           *   044994
     C**          X2IPFC - Interest Payment Frequency )               *   044994
     C**                                                              *   044994
     C**          XNIPD  - Next Interest Payment Date                 *   044994
     C**          XINDE  - Increment/Decrement for XNIPD              *   044994
     C**                                                              *   044994
     C** Output:  XNIPD  - Next Interest Payment Date                 *   044994
     C**                                                              *   044994
     C** Called by:  DLRSIN                                           *   044994
     C**                                                              *   044994
     C** Calls:      ZFREQC                                           *   044994
     C**             RXPDTB                                           *   044994
     C**                                                              *   044994
     C     RXPDTA        BEGSR                                                  ** RXPDTA *    04499
     C*                                                                   044994
     C** Define work fields used in RXPDTA and RXPDTB subroutines         044994
     C*                                                                   044994
     C                   Z-ADD     X1IPBD        X1IPBD            5 0                         04499
     C                   Z-ADD     X1IPD         X1IPD             2 0                         04499
     C                   MOVE      X1CCY         X1CCY             3                           04499
     C                   MOVE      X1DIR         X1DIR             1                           CIR00
     C                   Z-ADD     X2IPBD        X2IPBD            5 0                         04499
     C                   Z-ADD     X2IPD         X2IPD             2 0                         04499
     C                   MOVE      X2CCY         X2CCY             3                           04499
     C                   MOVE      X2IPFC        X2IPFC            1                           04499
     C                   MOVE      X2DIR         X2DIR             1                           CIR00
     C                   Z-ADD     XNIPD         XNIPD             5 0                         04499
     C                   MOVE      XINDE         XINDE             2                           04499
     C*                                                                   044994
     C** If the Interest Payment Base Date for the side being processed   044994
     C** is less than the Base Date for the other side then no overlap    044994
     C** can happen for this Payment Date.                                044994
     C*                                                                   044994
     C     X1IPBD        IFGE      X2IPBD                                                      04499
     C*                                                                   044994
     C** If the day-in-month each side are not the same then the          044994
     C** the Payment Dates need not overlap.                              044994
     C*                                                                   044994
     C     X1IPD         IFEQ      X2IPD                                                       04499
     C     X1IPD         ANDNE     0                                                        BUG12652
     C     X2IPFC        OREQ      'C'                                                         CIR00
     C     X2IPFC        OREQ      'Z'                                                         CIR00
     C*                                                                   044994
     C** Identify whether the Interest Payment Base Date for the other    044994
     C** side will ever match the Interest Payment Base Date calculated   044994
     C** for this side.                                                   044994
     C*                                                                   044994
     C                   Z-ADD     X2IPBD        ZDAYNO                                        04499
     C                   MOVE      X2IPFC        ZFREQ                                         04499
     C                   MOVE      X2IPD         ZMDAY                                         04499
     C                   MOVE      X2CCY         ZCCY                                          04499
     C     CEU003        IFEQ      'Y'                                                         CEU00
     C     X2ECY         ANDNE     *BLANKS                                                     CEU00
     C                   MOVE      X2ECY         ZCCY                                          CEU00
     C                   ENDIF                                                                 CEU00
     C*                                                                   044994
     C     X2IPBD        DOWLT     X1IPBD                                                      04499
     C     CIR001        IFNE      'Y'                                                         CIR00
     C                   EXSR      ZFREQC                                                      04499
     C                   Z-ADD     ZBD           X2IPBD                                        04499
     C                   ELSE                                                                  CIR00
     C*                                                                   CIR001
     C** IF FREQ.IS NOT 'Z' FOR DATE SCHEDULE USE ZFREQC TO CALC NEXT     CIR001
     C** DATE                                                             CIR001
     C*                                                                   CIR001
     C     ZFREQ         IFNE      'Z'                                                         CIR00
     C     ZFREQ         IFNE      'C'                                                         CIR00
     C                   EXSR      ZFREQC                                                      CIR00
     C                   Z-ADD     ZBD           X2IPBD                                        CIR00
     C*                                                                   CIR001
     C** IF FREQ.IS 'C' FOR CASH FLOW SCHEDULE USE NEXT DATE FROM #LDNCF  CIR001
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C     X2DIR         IFEQ      'P'                                                         CIR00
     C                   MOVEL     'U'           OTIN                           * OURS         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVEL     'T'           OTIN                           * THEIRS       CIR00
     C                   END                                                                   CIR00
     C                   Z-ADD     X2IPBD        ZIEND                                         CIR00
     C                   EXSR      #LDNCF                                                      CIR00
     C                   Z-ADD     PRDT          X2IPBD                                        CIR00
     C                   END                                                                   CIR00
     C*                                                                   CIR001
     C** IF FREQ.IS 'Z' DETEMINE NEXT DATE FROM DATE SCHEDULE FILE        CIR001
     C*                                                                   CIR001
     C                   ELSE                                                                  CIR00
     C     X2DIR         IFEQ      'P'                                                         CIR00
     C                   MOVEL     'U'           OTIN                           * OURS         CIR00
     C                   ELSE                                                                  CIR00
     C                   MOVEL     'T'           OTIN                           * THEIRS       CIR00
     C                   END                                                                   CIR00
     C                   MOVEL     'P'           RCIP                           * PAYMENT      CIR00
     C                   EXSR      #LDNDT                                                      CIR00
     C                   Z-ADD     ZDAYNO        X2IPBD                                        CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   CIR00
     C                   END                                                                   04499
     C*                                                                   044994
     C** If Interest Payment Base Dates do match then calculate an        044994
     C** Interest Payment Date that is a working day in both currencies   044994
     C*                                                                   044994
     C     X2IPBD        IFEQ      X1IPBD                                                      04499
     C     XINDE         ANDNE     *BLANKS
     C                   EXSR      RXPDTB                                                      04499
     C                   END                                                                   04499
     C*                                                                   044994
     C                   END                                                                   04499
     C                   END                                                                   04499
     C*                                                                   044994
     C     RXPDT9        ENDSR                                                  ** RXDTB9 **   04499
     C*                                                                   044994
     C*****************************************************************   044994
     C/EJECT                                                              044994
     C*****************************************************************   044994
     C**                                                              *   044994
     C** RXPDTB subroutine calculates the next interest payment date  *   044994
     C** for a cross currency IRS.                                    *   044994
     C**                                                              *   044994
     C** Purpose : To increment/decrement the Interest Payment Date   *   044994
     C**           just calculated until a working day is found in    *   044994
     C**           both currencies.                                   *   044994
     C**                                                              *   044994
     C** Input/Output:  Reference RXPDTA                              *   044994
     C**                                                              *   044994
     C** Called by:  RXPDTA                                           *   044994
     C**                                                              *   044994
     C** Calls:      ZDATE2                                           *   044994
     C**             ZCHKH                                            *   044994
     C**                                                              *   044994
     C     RXPDTB        BEGSR                                                  ** RXPDTB *    04499
     C*                                                                   044994
     C** Define 'okay' indicators - used to indicate when the date is     044994
     C** a working day in first ccy (X1OKAY) and second ccy (X2OKAY)      044994
     C** (Payment Date for the first ccy is the one input to the          044994
     C** SR. RXPDTB so starts off okay).                                  044994
     C*                                                                   044994
     C                   MOVEL     'Y'           X1OKAY            1                           04499
     C                   MOVEL     *BLANKS       X2OKAY            1                           04499
     C*                                                                   044994
     C** Convert day number to date                                       044994
     C*                                                                   044994
     C                   Z-ADD     XNIPD         ZDAYNO                                        04499
     C                   EXSR      ZDATE2                                                      04499
     C*                                                                   044994
     C** Do until Payment Date is a working day in both currencies        044994
     C*                                                                   044994
     C     X1OKAY        DOUEQ     'Y'                                                         04499
     C     X2OKAY        ANDEQ     'Y'                                                         04499
     C                   MOVEL     X2CCY         ZCCY                                          04499
     C     CEU003        IFEQ      'Y'                                                         CEU00
     C     X2ECY         ANDNE     *BLANKS                                                     CEU00
     C                   MOVE      X2ECY         ZCCY                                          CEU00
     C                   ENDIF                                                                 CEU00
     C*                                                                   044994
     C** Initialise work fields used in following proccess                044994
     C*                                                                   044994
     C                   Z-ADD     0             XINTO             2 0                         04499
     C                   Z-ADD     0             XINTOT            2 0                         04499
     C                   MOVE      *BLANKS       XINTOA            2                           04499
     C*                                                                   044994
     C** If second indicator (X2OKAY) indicates not Okay then             044994
     C** check if Day Number is a holiday in second currency              044994
     C** - calculate new one if necessary.                                044994
     C*                                                                   044994
     C     X2OKAY        DOUEQ     'Y'                                                         04499
     C*                                                                   044994
     C                   MOVE      ' '           ZIND                                          04499
     C                   EXSR      ZCHKH                                                       04499
     C*                                                                   044994
     C     ZIND          IFEQ      'W'                                                         04499
     C                   MOVEL     'Y'           X2OKAY                                        04499
     C                   ELSE                                                                  04499
     C                   MOVEL     *BLANKS       X1OKAY                                        04499
     C*                                                                   044994
     C** If increment then add one to Day number (first time through      044994
     C** loop XINDE will be as ZINDE output from ZFREQC for this side)    044994
     C*                                                                   044994
     C     XINDE         IFEQ      'IN'                                                        04499
     C     ZDAYNO        ADD       1             ZDAYNO                                        04499
     C*                                                                   044994
     C** If incrementing takes the date into the following month then     044994
     C** return to the original Base Date and decrement                   044994
     C*                                                                   044994
     C     XINTO         ADD       1             XINTO                                         04499
     C     XINTO         ADD       ZDAY          XINTOT                                        04499
     C                   MOVE      XINTOT        XINTOA                                        04499
     C*                                                                   044994
     C** (...if leap year and February and days in month > 92...)         044994
     C*                                                                   044994
     C     ZYEAR         DIV       4             ZLYR                                          04499
     C                   MVR                     ZLY               1 0                         04499
     C     ZLY           IFEQ      *ZERO                                                       04499
     C     ZMTH          ANDEQ     2                                                           04499
     C     XINTOA        ANDGT     '29'                                                        04499
     C                   MOVEL     'DE'          XINDE                                         04499
     C                   ELSE                                                                  04499
     C*                                                                   044994
     C** (...else if days in month greater than expected...)              044994
     C*                                                                   044994
     C     XINTOA        IFGT      ZFMD(ZMTH)                                                  04499
     C                   Z-ADD     X1IPBD        ZDAYNO                                        04499
     C                   MOVEL     'DE'          XINDE                                         04499
     C                   END                                                                   04499
     C                   END                                                                   04499
     C                   END                                                                   04499
     C*                                                                   044994
     C** If decrement then subtract one from Day number                   044994
     C*                                                                   044994
     C     XINDE         IFEQ      'DE'                                                        04499
     C     ZDAYNO        SUB       1             ZDAYNO                                        04499
     C                   END                                                                   04499
     C                   END                                                                   04499
     C                   END                                                                   04499
     C*                                                                   044994
     C** If first indicator (Z1OKAY) indicates not Okay then              044994
     C** check if Day Number is a holiday in first currency               044994
     C** - calculate new one if necessary.                                044994
     C*                                                                   044994
     C                   MOVEL     X1CCY         ZCCY                                          04499
     C*                                                                   044994
     C** Initialise work fields used in following proccess                044994
     C*                                                                   044994
     C                   Z-ADD     0             XINTO             2 0                         04499
     C                   Z-ADD     0             XINTOT            2 0                         04499
     C                   MOVE      *BLANKS       XINTOA            2                           04499
     C*                                                                   044994
     C     X1OKAY        DOUEQ     'Y'                                                         04499
     C*                                                                   044994
     C                   MOVE      ' '           ZIND                                          04499
     C                   EXSR      ZCHKH                                                       04499
     C*                                                                   044994
     C     ZIND          IFEQ      'W'                                                         04499
     C                   MOVEL     'Y'           X1OKAY                                        04499
     C                   ELSE                                                                  04499
     C                   MOVEL     *BLANKS       X2OKAY                                        04499
     C*                                                                   044994
     C** If increment then add one to Day number                          044994
     C*                                                                   044994
     C     XINDE         IFEQ      'IN'                                                        04499
     C     ZDAYNO        ADD       1             ZDAYNO                                        04499
     C*                                                                   044994
     C** If incrementing takes the date into the following month then     044994
     C** return to the original Base Date and decrement                   044994
     C*                                                                   044994
     C     XINTO         ADD       1             XINTO                                         04499
     C     XINTO         ADD       ZDAY          XINTOT                                        04499
     C                   MOVE      ZINTOT        XINTOA                                        04499
     C*                                                                   044994
     C** (...if leap year and February and days in month > 92...)         044994
     C*                                                                   044994
     C     ZYEAR         DIV       4             ZLYR                                          04499
     C                   MVR                     ZLY                                           04499
     C     ZLY           IFEQ      *ZERO                                                       04499
     C     ZMTH          ANDEQ     2                                                           04499
     C     XINTOA        ANDGT     '29'                                                        04499
     C                   MOVEL     'DE'          XINDE                                         04499
     C                   ELSE                                                                  04499
     C*                                                                   044994
     C** (...else if days in month greater than expected...)              044994
     C*                                                                   044994
     C     XINTOA        IFGT      ZFMD(ZMTH)                                                  04499
     C                   Z-ADD     X1IPBD        ZDAYNO                                        04499
     C                   MOVEL     'DE'          XINDE                                         04499
     C                   END                                                                   04499
     C                   END                                                                   04499
     C                   END                                                                   04499
     C*                                                                   044994
     C** If decrement then subtract one from Day number                   044994
     C*                                                                   044994
     C     XINDE         IFEQ      'DE'                                                        04499
     C     ZDAYNO        SUB       1             ZDAYNO                                        04499
     C                   END                                                                   04499
     C                   END                                                                   04499
     C                   END                                                                   04499
     C*                                                                   044994
     C                   END                                                                   04499
     C*                                                                   044994
     C                   Z-ADD     ZDAYNO        XNIPD                                         04499
     C*                                                                   044994
     C     RXPDB9        ENDSR                                                  ** RXPDB9 **   04499
     C*                                                                   044994
     C********************************************************************044994
     C/EJECT
     C********************************************************************044994
     C*                                                                   S01378
     C** NPACRP IS A SUBROUTINE TO HANDLE ACCRUAL DATE KEYS               S01378
     C*         FOR THE PARTIAL SALE OF PARCELS NEGOTIABLE ASSETS.        S01378
     C*                                                                   S01378
     C     NPACRP        BEGSR                                                  *** NPACRP ****S0137
     C*                                                                   S01378
     C     MDAT          SUB       VDAT          DLDAYS            5 0           DEAL PERIOD   S0137
     C     NPADAT        SUB       VDAT          DYSTD             5 0                         S0137
     C  N29
     CAN 25DYSTD         ADD       1             DYSTD                                         S0137
     C     DISASD        MULT      DYSTD         WORK15                          ACCRUED       S0137
     C     WORK15        DIV(H)    DLDAYS        WORK15                                        S0137
     C     WORK15        SUB       DPTDSD        WORKTP                          DISC.TO POST  S0137
     C                   Z-ADD     WORK15        DPTDSD                                        S0137
     C*                                                                   S01378
     C* GENERATE AN ACCRUAL DATE ACCOUNT KEY.                             S01378
     C                   Z-ADD     0             NARRAT                                        S0137
     C                   MOVE      'A'           AKY(3)                                        S0137
     C                   MOVEA     DLST          AKY(4)                                        S0137
     C                   MOVEA     '    '        AKY(6)                                        S0137
     C  N27              MOVE      'D'           AKY(10)                                       S0137
     C   28
     CAN 27
     CAN 48              MOVE      'C'           AKY(10)                                       S0137
     C  N27              Z-ADD     WORKTP        KYAMT                                         S0137
     C   27              Z-SUB     WORKTP        KYAMT                                         S0137
     C                   Z-ADD     NPADAT        KYDAT                                         S0137
     C                   MOVE      PCCY          KYCCY                                         S0137
     C                   MOVE      STCY          KYSCY                                         CEU00
     C                   Z-ADD     MDST          KYSETL                                        S0137
     C                   MOVE      OMDA          KYOSTL                                        S0137
     C*                                                                   S01378
     C**  CALCULATE THE FEDERAL FUND VALUE DATE                           S01378
     C                   EXSR      FEDAT                                                       S0137
     C*                                                                   S01378
     C                   Z-ADD     KYAMT         NRRSAL                                        S0137
     C     NRBRTT        IFEQ      '00'                                                        00345
     C                   MOVE      '  '          NRBRTT                                        00345
     C                   END                                                                   00345
     C                   SETON                                        71                       S0137
     C     *IN27         IFEQ      '0'                                                         15013
     C     *IN28         OREQ      '1'                                                         15013
     C     *IN27         ANDEQ     '1'                                                         15013
     C     *IN48         ANDEQ     '1'                                                         15013
     C                   EXSR      EXCP                                                        S0137
     C                   ENDIF                                                                 15013
     C                   ENDSR                                                                 S0137
     C*                                                                   S01378
0344 C********************************************************************
     C*                                                                   S01194
     C*   *PSSR SR HANDLES DATABASE ERROR IN NEW STANDING DATA FILES      S01194
     C*                                                                   S01194
     C     *PSSR         BEGSR                                                                 S0119
     C     @RUN          IFEQ      *BLANK                                                      S0119
     C                   MOVE      'Y'           @RUN              1                           S0119
     C                   DUMP                                                                  S0119
     C                   MOVE      *ON           *INU7                                        234421
     C                   MOVE      *ON           *INU8                                        234421
     C                   MOVE      *ON           *INLR                                        234421
     C                   RETURN                                                               234421
     C                   END                                                                   S0119
     C                   ENDSR                                                                 S0119
3886 C********************************************************************
     C/EJECT                                                              CPB001
      *****************************************************************   CPB001
      *                                                               *   CPB001
      *  SRREPI - Subroutine to set up Replication Indicator.         *   CPB001
      *                                                               *   CPB001
      *  Called by : Main processing                                  *   CPB001
      *              DLAMND                                           *   CPB001
      *                                                               *   CPB001
      *  Calls     : None                                             *   CPB001
      *                                                               *   CPB001
      *****************************************************************   CPB001
     C     SRREPI        BEGSR                                                  ** SRREPI SR **CPB00
      *                                                                   CPB001
      **  Access Customer Details by using Access Object,                 CPB001
      **  to retrieve Private Banking Customer Indicator.                 CPB001
     C                   MOVE      *BLANKS       @CUST                                         CPB00
     C                   MOVEL     CNUM          @CUST                                         CPB00
     C                   CALL      'AOCUSTR1'                                                  CPB00
     C                   PARM      '*MSG   '     @RTCD             7                           CPB00
     C                   PARM      '*KEY   '     @OPTN             7                           CPB00
     C                   PARM                    @CUST            10                           CPB00
     C                   PARM                    @KYST             7                           CPB00
     C     SDCUST        PARM      SDCUST        DSLDY                                         CPB00
      *                                                                   CPB001
      **  If Customer Details do not exist, handle Database Error.        CPB001
     C     @RTCD         IFEQ      *ON                                          Begin @RTCD    CPB00
     C                   MOVEL     'SDCUSTPD'    DBFILE                         ***************CPB00
     C                   MOVEL     '91'          DBASE                          * DB ERROR 91 *CPB00
     C                   MOVEL     @CUST         DBKEY                          ***************CPB00
     C                   SETON                                        U7U8LR                   CPB00
     C                   EXSR      *PSSR                                                       CPB00
     C                   GOTO      ENDREP                                                      CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End *IN88      CPB00
     C                   MOVEL     *IN90         WIN90             1                          207288
      *                                                                   CPB001
      **  If Customer is a Private Banking Customer, set up               CPB001
      **  Replication Indicator.                                          CPB001
     C     BBPRBA        IFEQ      'Y'                                          Begin BBPRBA   CPB00
      *                                                                                       207288
      **  Do not send Maturity of Spot                                                        207288
     C     *IN02         IFEQ      *ON                                                        207288
      *                                                                                       207288
      ** Get spot indicator.                                                                  207288
     C                   MOVEL     DTYP          TFDTPE                                       207288
     C                   MOVEL     DLST          TFDLST                                       207288
      *                                                                                       207288
     C     KSECU         KLIST                                                                207288
     C                   KFLD                    TFDTPE                                       207288
     C                   KFLD                    TFDLST                                       207288
      *                                                                                       207288
     C     KSECU         CHAIN     FDDTSTD0                           90                      207288
     C     *IN90         IFEQ      '0'                                                        207288
     C     TFSPOT        ANDEQ     'Y'                                                        207288
     C                   GOTO      ENDREP                                                     207288
     C                   ENDIF                                                                207288
      *                                                                                       207288
     C                   ENDIF                                                                207288
      *                                                                   CPB001
      **  Setup to 'B' to inform Tof that Base Rate Change occurs         CPB001
     C     AMTP          IFEQ      'BR'                                                        CPB00
     C     AMTP          OREQ      'BC'
     C                   MOVE      'T'           REPI                                          CPB00
     C                   ELSE                                                                  CPB00
     C                   MOVE      'Y'           REPI                                          CPB00
     C                   ENDIF                                                                 CPB00
      *                                                                   CPB001
     C                   ENDIF                                                  End BBPRBA     CPB00
      *                                                                   CPB001
     C     ENDREP        TAG                                                                   CPB00
     C                   MOVEL     WIN90         *IN90                                        207288
      *                                                                   CPB001
     C                   ENDSR                                                                 CPB00
      *****************************************************************   CPB001
     C*                                                                   S01408
      /EJECT                                                              CDL006
      *****************************************************************   CDL006
      *                                                               *   CDL006
      *  RLACVT - subroutine to convert range limits amounts held on  *   CDL006
      *           DL charges types DLCCGDL0, from base currency to    *   CDL006
      *           deal currency, if Commission tables in base currency*   CDL006
      *                                                               *   CDL006
      *  Called by : - Main processing.                               *   CDL006
      *                                                               *   CDL006
      *  Calls     : none                                             *   CDL006
      *                                                               *   CDL006
      *****************************************************************   CDL006
      *                                                                   CDL006
     C     RLACVT        BEGSR                                                  **  CHACVT  ** CDL00
      *                                                                   CDL006
     C                   Z-ADD     WUDCSR        ZEXCH                                         CDL00
     C     WUDCMD        IFEQ      1                                                           CDL00
     C                   MOVE      'D'           ZMD                                           CDL00
     C                   ELSE                                                                  CDL00
     C                   MOVE      'M'           ZMD                                           CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   Z-ADD     BCDP          ZCDPI                                         CDL00
     C                   Z-ADD     WUDCDP        ZCDPO                                         CDL00
      *                                                                   CDL006
      ** Process all array entries.                                       CDL006
      *                                                                   CDL006
     C     1             DO        14            I                                             CDL00
     C                   Z-ADD     ZRA(I)        ZAMTCI                                        CDL00
      *                                                                   CDL006
      ** Convert range limit amount from Base currency to Deal currency.  CDL006
      *                                                                   CDL006
     C                   EXSR      ZCONVN                                                      CDL00
     C                   Z-ADD     ZAMTCO        ZRA(I)                                        CDL00
     C                   ENDDO                                                                 CDL00
      *                                                                   CDL006
     C                   ENDSR                                                                 CDL00
      *                                                                   CDL006
      *****************************************************************   CDL006
      /EJECT                                                              CDL006
      *****************************************************************   CDL006
      *                                                               *   CDL006
      *  COMCAL - subroutine to calculate accrued commission due      *   CDL006
      *           to work date since interest accrual control date.   *   CDL006
      *                                                               *   CDL006
      *  Called by : - Main processing - DPACCR                       *   CDL006
      *              - DLAMND                                         *   CDL006
      *              - NIDAT                                          *   CDL006
      *              - MADAT                                          *   CDL006
      *                                                               *   CDL006
      *  Calls     : - GLINTC                                         *   CDL006
      *              - ZINTDY                                         *   CDL006
      *                                                               *   CDL006
      *  Input     : - WUDBEG (5 0) : start date of period.           *   CDL006
      *              - WUDEND (5 0) : end date of period.             *   CDL006
      *                                                               *   CDL006
      *  Output    : - WUACSC       : commission amount.              *   CDL006
      *                                                               *   CDL006
      *****************************************************************   CDL006
      *                                                                   CDL006
     C     COMCAL        BEGSR                                                  **  COMCAL  ** CDL00
      *                                                                   CDL006
      ** Work fields definition.                                          CDL006
      *                                                                   CDL006
     C     *LIKE         DEFINE    PAMT          WUACSC                                        CDL00
     C     *LIKE         DEFINE    IACD          WUDBEG                                        CDL00
     C     *LIKE         DEFINE    IACD          WUDEND                                        CDL00
      *                                                                   CDL006
      ** Initialize accrued commission amount.                            CDL006
      *                                                                   CDL006
     C                   Z-ADD     0             WUACSC                                        CDL00
      *                                                                   CDL006
      ** If Call Deposits.                                                CDL006
      *                                                                   CDL006
     C     DTYP          IFEQ      'DT'                                                        CDL00
     C     DTYP          OREQ      'LT'                                                        CDL00
     C/COPY WNCPYSRC,DL0280C721
      *                                                                   CDL006
      **  Commission amount calculation :                                 CDL006
      *                                                                   CDL006
      **    Principal                                                     CDL006
      **  (------------) x (WUDEND - WUDBEG) x (% current range)          CDL006
      **   Days of year                                                   CDL006
      *                                                                   CDL006
      ** Retrieve percentage of current range, only if at least           CDL006
      ** one percentage different from 0.                                 CDL006
      *                                                                   CDL006
     C     ZPE(1)        IFNE      0                                                           CDL00
     C                   Z-ADD     PAMT          ZIAMT                                         CDL00
     C                   Z-ADD     1             I                                             CDL00
      *                                                                   CDL006
     C     ZRA(1)        IFNE      0                                                           CDL00
     C     ZIAMT         LOOKUP    ZRA(I)                             53  53                   CDL00
     C  N53              Z-ADD     15            I                                             CDL00
     C                   END                                                                   CDL00
      *                                                                   CDL006
     C                   Z-ADD     WUDBEG        ZIBEG                                         CDL00
     C                   Z-ADD     WUDEND        ZIEND                                         CDL00
     C                   MOVE      ZPE(I)        WUPERC            7 4                         CDL00
     C                   Z-ADD     WUPERC        ZIRATE                                        CDL00
     C                   EXSR      GLINTC                                                      CDL00
     C                   Z-ADD     ZINTR         WUACSC                                        CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C/COPY WNCPYSRC,DL0280C722
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
      ** If Fixed Term deposit.                                           CDL006
      *                                                                   CDL006
     C     DTYP          IFEQ      'FT'                                                        CDL00
      *                                                                   CDL006
      **      FCMA                                                        CDL006
      **  (-----------)  x  (WUDEND - WUDBEG)                             CDL006
      **   MDAT - VDAT                                                    CDL006
      *                                                                   CDL006
      ** To determine number of days between Value date and               CDL006
      ** Maturity date.                                                   CDL006
      *                                                                   CDL006
     C                   Z-ADD     VDAT          ZZBEG                                         CDL00
     C                   Z-ADD     MDAT          ZZEND                                         CDL00
     C                   EXSR      ZINTDY                                                      CDL00
     C                   Z-ADD     ZZINDY        ZFULPD                                        CDL00
      *                                                                   CDL006
      ** To determine number of days between Interest Accrual             CDL006
      ** control date and Next interest date.                             CDL006
      *                                                                   CDL006
     C                   Z-ADD     WUDBEG        ZZBEG                                         CDL00
     C                   Z-ADD     WUDEND        ZZEND                                         CDL00
     C                   EXSR      ZINTDY                                                      CDL00
     C                   Z-ADD     ZZINDY        ZPARPD                                        CDL00
      *                                                                   CDL006
     C     ZFULPD        IFNE      0                                                           CDL00
     C     FCMA          MULT      ZPARPD        W018D0           18 0                         CDL00
     C     W018D0        DIV       ZFULPD        WUACSC                                        CDL00
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDIF                                                                 CDL00
      *                                                                   CDL006
     C                   ENDSR                                                                 CDL00
      *                                                                   CDL006
      *****************************************************************   CDL006
     C/COPY DLCPYSRC,DL0280UREL                                                               205045
      *****************************************************************                       CAS004
     C/EJECT                                                                                  221703
      *****************************************************************                       221703
      *                                                               *                       221703
      * SRUGEN - Generation of account keys                           *                       221703
      *          for reversed and matured deals                       *                       221703
      *                                                               *                       221703
      *****************************************************************                       221703
     C     SRUGEN        BEGSR
      *                                                                                       CAS005
      ** Check and summarise account key if required                                          CAS005
      *                                                                                       CAS005
     C                   MOVE      *BLANK        WSUMAK            1
      *                                                                                       CAS005
     C     BKAKSI        IFEQ      'Y'
     C                   EXSR      SRATOT
     C                   ENDIF
      *                                                                                       CAS005
      ** Summarise accrual account key not required                                           CAS005
      *                                                                                       CAS005
     C     WSUMAK        IFNE      'Y'
      *                                                                                       221703
     C     KYAMT         IFGE      0
     C                   Z-SUB     KYAMT         NRRSAL
     C     *IN47         IFEQ      *OFF
     C                   Z-SUB     KYAMT         KYAMT
     C                   ENDIF
     C                   ELSE
     C     *IN47         IFEQ      *ON
     C                   Z-SUB     KYAMT         KYAMT
     C                   Z-SUB     KYAMT         NRRPUR
     C                   ELSE
     C                   Z-ADD     KYAMT         NRRPUR
     C                   ENDIF
     C                   ENDIF
     C     KYAMT         IFNE      0
     C                   MOVE      *ON           *IN71
     C                   EXSR      EXCP
     C                   ENDIF
     C                   ENDIF
      *                                                                                       221703
     C                   ENDSR
      *****************************************************************                       221703
     C/EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      * SRATOT - Store totals of summarised account keys              *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C     SRATOT        BEGSR
      *                                                                                       CAS005
     C                   MOVE      *IN28         WIN28             1
     C**********         MOVE      *IN28         WIN88             1
     C                   MOVE      *IN88         WIN88             1                          EMFIX1
     C                   MOVE      *IN11         WIN11             1
     C**********         MOVE      *IN20         WIN20             1                 BUG11100 237793
     C                   MOVE      *BLANK        WBLK18           18
     C                   MOVEA     AKY(3)        WEVCOD            1
     C                   MOVEA     AKY(10)       WEVSUB            1
     C                   MOVEL     WEVCOD        WACRID            2
     C                   MOVE      WEVSUB        WACRID
      *                                                                                       CAS005
      ** Check if accrual account key                                                         CAS005
     C                   Z-ADD     1             X                 3 0
     C     WACRID        LOOKUP    ACR(X)                                 88
     C     *IN88         IFEQ      *ON
     C                   MOVE      'Y'           WSUMAK
     C                   ELSE
     C                   MOVE      *BLANK        WSUMAK
     C                   ENDIF
      *                                                                                       CAS005
      ** Accrual account key summary indicator set to 'Y'                                     CAS005
      ** store totals to array                                                                CAS005
     C     WSUMAK        IFEQ      'Y'
     C                   MOVEA     *BLANK        KEY
     C                   MOVEA     BRCA          KEY(1)
     C     WBCPL         IFEQ      'Y'
     C                   MOVEA     BOKC          KEY(4)
     C                   ENDIF
     C                   MOVEA     KYCCY         KEY(6)
     C                   MOVEA     AKY           KEY(9)
     C                   MOVEA     CLAS          KEY(19)                                      CDL038
     C**********         Z-ADD     1             M                 3 0                        262532
     C                   Z-ADD     1             M                 4 0                        262532
     C**********         MOVEA     KEY           LKEY             18                          CDL038
     C                   MOVEA     KEY           LKEY             22                          CDL038
     C     LKEY          LOOKUP    TKEY(M)                                28
     C     *IN28         IFEQ      *ON
     C                   ADD       KYAMT         TAMT(M)
     C                   ELSE
     C                   ADD       1             C
     C                   MOVEA     LKEY          TKEY(C)
     C                   Z-ADD     KYAMT         TAMT(C)
     C                   ENDIF
      *                                                                                       CAS005
      ** Execute EXCP subroutine but do not output to DL0281P1 and                            CAS005
      ** and DKEYSDP                                                                          CAS005
     C                   MOVE      *OFF          *IN11
     C**********         MOVE      *ON           *IN20                               BUG11100 237793
     C                   MOVE      'Y'           PRONLY
     C                   EXSR      EXCP
     C                   ENDIF
      *                                                                                       CAS005
     C                   MOVE      WIN28         *IN28
     C                   MOVE      WIN88         *IN88
     C                   MOVE      WIN11         *IN11
     C**********         MOVE      WIN20         *IN20                               BUG11100 237793
      *                                                                                       CAS005
     C                   ENDSR
      *****************************************************************                       CAS005
     C/EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      * SRASUM - Generation of summarised account keys                *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C     SRASUM        BEGSR
      *                                                                                       CAS005
     C**********         Z-ADD     1             Y                 3 0                        262532
     C                   Z-ADD     1             Y                 4 0                        262532
     C                   Z-ADD     0             WCOUNT            5 0
      *                                                                                       CAS005
      ** Open files for the first branch reporting                                            CAS005
      *                                                                                       CAS005
     C     C             IFNE      0
     C                   CLOSE     DL0280P2
     C                   OPEN      DL0280P2
      *                                                                                       CAS005
      ** Report spool file generation                                                         CAS005
      *                                                                                       CAS005
     C                   Z-ADD     SFNUM2        ZSNUM
     C                   CALL      'ZSFILE'
     C                   PARM                    SEQ
     C                   PARM      BRCA          @PARM
     C                   PARM                    SFILE2
     C                   PARM                    ZSNUM
     C                   PARM                    ZSERR
      *                                                                                       CAS005
     C     ZSERR         IFEQ      'Y'
     C                   MOVE      *ON           *INU7
     C                   MOVE      *ON           *INU8
     C                   MOVE      *ON           *INLR
     C                   RETURN
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS005
     C     Y             DOWLE     C
      *                                                                                       CAS005
     C     TAMT(Y)       IFNE      0
     C                   MOVE      *BLANK        XXKEY
     C                   MOVE      TKEY(Y)       XXKEY
     C                   MOVEA     XXAKY         AKY(1)
      *                                                                                       CAS005
     C                   MOVE      XXDTYP        DTYP
     C                   Z-ADD     0             DLNO
     C**********         Z-ADD     0             CNUM                                         CSD027
     C                   EVAL      CNUM = *BLANKS                                             CSD027
     C                   Z-ADD     BJRDNB        KYDAT
     C                   Z-ADD     TAMT(Y)       KYAMT
     C                   MOVE      XXCYCD        KYCCY
     C                   MOVE      XXBRCA        BRCA
     C                   MOVE      XXBKCD        BOKC
     C                   MOVE      XXCLAS        CLAS                                         CDL038
     C                   EXCEPT    DKYOUT
      *                                                                                      BUG8781
     C     DKREC         ADD       1             DKREC                                       BUG8781
     C     DKRECD        ADD       1             DKRECD                                      BUG8781
      *                                                                                       CAS005
     C     KYAMT         DIV       1000          ZZAMT
     C     ZZAMT         IFLT      0
     C                   Z-SUB     ZZAMT         ZZAMT
     C                   ENDIF
      *                                                                                       CAS005
     C                   Z-ADD     TOTDKI        ZZTOTI
     C                   Z-ADD     TOTDKD        ZZTOTD
     C                   EXSR      GLZADD
     C                   Z-ADD     ZZTOTI        TOTDKI           15 0
     C                   Z-ADD     ZZTOTD        TOTDKD            3 0
      *                                                                                       CAS005
      ** If the branch changes, end the report for branch and open                            CAS005
      ** a new report for the new branch                                                      CAS005
      *                                                                                       CAS005
     C     BRCA          IFNE      WBRCA
      *                                                                                       CAS005
     C     WBRCA         IFNE      *BLANK
     C                   Z-ADD     WCOUNT        RTOTAL            5 0
     C                   Z-ADD     *ZERO         WCOUNT
      *                                                                                       CAS005
     C     PRTLNE        IFGT      52
     C                   EXCEPT    SMTITL
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXCEPT    TOTAKY
      *                                                                                       CAS005
     C     PRTLNE        IFGT      56
     C                   EXCEPT    SMTITL
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXCEPT    ENDBRC
      *                                                                                       CAS005
      ** Open files for the new branch reporting                                              CAS005
      *                                                                                       CAS005
     C                   CLOSE     DL0280P2
     C                   OPEN      DL0280P2
     C                   ENDIF
      *                                                                                       CAS005
      ** Use access program to read branch codes file                                         CAS005
      *                                                                                       CAS005
     C**********           CALL 'AOBRCHR0'                                             CAS005 CGL029
     C                   CALL      'AOBRCHR1'
     C                   PARM      '*MSG   '     PRTCD             7
     C                   PARM      '*KEY   '     POPTN             7
     C                   PARM      BRCA          PDSNB             3
     C********** @BRCH     PARM @BRCH     DSFDY                                        CAS005 CGL029
     C     @BRCH         PARM      @BRCH         DSSDY
      *                                                                                       CAS005
     C     PRTCD         IFNE      *BLANKS
     C                   MOVEL     BRCA          DBKEY
     C                   MOVEL     'SDBRCHPD'    DBFILE
     C                   MOVEL     45            DBASE
     C                   EXSR      *PSSR
     C                   ELSE
     C                   MOVE      BRCA          WBRCA             3
      *                                                                                       CAS005
      ** Print header line                                                                    CAS005
      *                                                                                       CAS005
     C                   EXCEPT    SMTITL
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CAS005
     C     PRTLNE        IFGT      58
     C                   EXCEPT    SMTITL
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXCEPT    SUMDET
      *                                                                                       CAS005
     C                   ADD       1             WCOUNT
     C                   ENDIF
     C                   ADD       1             Y
     C                   ENDDO
      *                                                                                       CAS005
     C     C             IFGT      0
     C                   Z-ADD     WCOUNT        RTOTAL
     C                   Z-ADD     *ZERO         WCOUNT
      *                                                                                       CAS005
     C     PRTLNE        IFGT      52
     C                   EXCEPT    SMTITL
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXCEPT    TOTAKY
      *                                                                                       CAS005
     C     PRTLNE        IFGT      56
     C                   EXCEPT    SMTITL
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXCEPT    ENDBRC
      *                                                                                       CAS005
     C     PRTLNE        IFGT      59
     C                   EXCEPT    SMTITL
     C                   ENDIF
      *                                                                                       CAS005
     C                   EXCEPT    ENDRPT
     C                   ENDIF
      *                                                                                       CAS005
     C                   ENDSR
      *****************************************************************                       CAS005
     C/EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRRSIU - To calculate interest amounts for IRS and           *                       CAS005
      *           generate keys if interest is Up-front.              *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C     SRRSIU        BEGSR
      *                                                                                       CAS005
      ** Add interest accrued to control date (this will be the interest                      CAS005
      ** calculated to this payment date) to accrued interest adjustment                      CAS005
      ** posted to obtain the accrued interest to date                                        CAS005
      *                                                                                       CAS005
     C     TZAICD        ADD       TZAIAP        TZAITD
      *                                                                                       CAS005
      ** Subtract the accrued interest posted to date from accrued                            CAS005
      ** interest to date to give accrued interest to post                                    CAS005
      *                                                                                       CAS005
     C     TZAITD        SUB       TZIPTD        TZAITP
      *                                                                                       CAS005
      ** Add accrued interest to post to accrued interest posted                              CAS005
      ** to date                                                                              CAS005
      *                                                                                       CAS005
     C                   ADD       TZAITP        TZIPTD
      *                                                                                       CAS005
      ** Add accrued interest adjustments not posted to accrued                               CAS005
      ** interest adjustments posted                                                          CAS005
      *                                                                                       CAS005
     C                   ADD       TZIANP        TZAIAP
      *                                                                                       CAS005
      ** Zeroise accrued interest adjustments not posted and interest                         CAS005
      ** accrued since last interest change date                                              CAS005
      *                                                                                       CAS005
     C                   Z-ADD     *ZERO         TZIANP
     C                   Z-ADD     *ZERO         TZLICD
      *                                                                                       CAS005
      ** Calculate interest from interest accrual control date                                CAS005
      ** to end date (this payment date to next payment date)                                 CAS005
      *                                                                                       CAS005
     C                   Z-ADD     TZIACD        ZIBEG
     C                   Z-ADD     TZEDAT        ZIEND
     C                   Z-ADD     TZPPL         ZIAMT
     C                   Z-ADD     TZCBS         ZICALC
      *                                                                                       CAS005
     C                   EXSR      GLINTC
      *                                                                                       CAS005
      ** If interest is yield based (method is 'Y') calculate it                              CAS005
      ** (using information provided by GLINTC)                                               CAS005
      *                                                                                       CAS005
     C     SZINPM        IFEQ      'Y'
     C                   EXSR      #LCIYD
     C                   Z-ADD     WKINT         WINTST
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   ENDIF
      *                                                                                       CAS005
      ** Add interest accrued to control date, accrued interest                               CAS005
      ** adjustments posted and this interest amount to obtain                                CAS005
      ** the accrued interest to date                                                         CAS005
      *                                                                                       CAS005
     C     TZAICD        ADD       TZAIAP        TZAITD
     C     TZAITD        ADD       WINTST        TZAITD
      *                                                                                       CAS005
      ** Subtract interest paid/received to date from accrued interest                        CAS005
      ** to date to give interest due                                                         CAS005
      *                                                                                       CAS005
     C     TZAITD        SUB       TZIPRD        TZINTD
      *                                                                                       CAS005
      ** If deal is tax payable calculate the tax on the interest due                         CAS005
      ** using the tax rate                                                                   CAS005
      *                                                                                       CAS005
     C     TAXI          IFEQ      'Y'
     C     SZDIR         ANDEQ     'P'
     C     SZITR         ANDNE     0
     C     TZINTD        DIV       100           WK152
     C     WK152         MULT(H)   SZITR         TZTAXC
     C                   ENDIF
      *                                                                                       CAS005
      ** Subtract tax calc from interest due to give int net of tax                           CAS005
      *                                                                                       CAS005
     C     TZINTD        SUB       TZTAXC        TZINOT
      *                                                                                       CAS005
      ** Add tax deducted to the tax paid to date and tax paid this                           CAS005
      ** month                                                                                CAS005
      *                                                                                       CAS005
     C     TZTAXC        ADD       TZTPTD        TZTPTD
     C     TZTAXC        ADD       TZTPTM        TZTPTM
      *                                                                                       CAS005
      ** Add interest due to interest paid/received to date and                               CAS005
      ** interest paid/received this month                                                    CAS005
      *                                                                                       CAS005
     C     TZINTD        ADD       TZIPRD        TZIPRD
     C     TZINTD        ADD       TZIPRM        TZIPRM
      *                                                                                       CAS005
      ** Set interest calculated from last payment date to next                               CAS005
      *                                                                                       CAS005
     C                   Z-ADD     WINTST        TZLICD
      *                                                                                       CAS005
      ** Add interest calculated to interest accrued to control date                          CAS005
      *                                                                                       CAS005
     C                   ADD       WINTST        TZAICD
      *                                                                                       CAS005
      ** Set the start/last interest payment date                                             CAS005
      ** to the interest accrual control date                                                 CAS005
      *                                                                                       CAS005
     C                   Z-ADD     TZIACD        TZSLID
      *                                                                                       CAS005
      ** Set the interest accrual control date                                                CAS005
      ** to the interest end date just processed                                              CAS005
      *                                                                                       CAS005
     C                   Z-ADD     TZEDAT        TZIACD
      *                                                                                       CAS005
      ** The next interest payment date will be the end date just processed                   CAS005
      ** If this date is less than the maturity date, move it into the                        CAS005
      ** next interest payment date and interest payment base date                            CAS005
      *                                                                                       CAS005
     C     TZEDAT        IFLT      TZMDAT
     C                   Z-ADD     TZEDAT        TZIPBD
     C                   Z-ADD     TZEDAT        TZNIPD
     C                   ELSE
      *                                                                                       CAS005
      ** else zeroise the interest payment base date and next interest                        CAS005
      ** payment date and set the interest payment frequency to blank                         CAS005
      *                                                                                       CAS005
     C                   Z-ADD     *ZERO         TZIPBD
     C                   Z-ADD     *ZERO         TZNIPD
     C                   MOVE      *BLANK        TZIPFC
     C                   Z-ADD     0             TZIPD
     C                   ENDIF
      *                                                                                       CAS005
     C                   ENDSR
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRRSAU - To calculate accrual amounts for IRS and            *                       CAS005
      *           generate keys if interest is Up-front.              *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C     SRRSAU        BEGSR
      *                                                                                       CAS005
      ** Calculate interest from the last interest payment date                               CAS005
      ** to the next interest payment date                                                    CAS005
      ** (or the maturity date if no more interest payments are due)                          CAS005
      *                                                                                       CAS005
     C                   Z-ADD     TZSLID        ZIBEG
     C     TZNIPD        IFNE      *ZERO
     C                   Z-ADD     TZNIPD        ZIEND
     C                   ELSE
     C                   Z-ADD     MDAT          ZIEND
     C                   ENDIF
     C                   Z-ADD     ZIEND         SZIEND
     C                   Z-ADD     TZPPL         ZIAMT
     C                   Z-ADD     TZCBS         ZICALC
      *                                                                                       CAS005
     C                   EXSR      GLINTC
      *                                                                                       CAS005
      ** If interest is yield based (method is 'Y') calculate it                              CAS005
      ** (using information provided by GLINTC)                                               CAS005
      *                                                                                       CAS005
     C     SZINPM        IFEQ      'Y'
     C                   EXSR      #LCIYD
     C                   Z-ADD     WKINT         WINTST
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   ENDIF
      *                                                                                       CAS005
      ** Subtract this interest from the interest accrued to control                          CAS005
      ** date and add the accrued interest adjsutments posted to                              CAS005
      ** obtain the interest accrued to the last payment date                                 CAS005
      *                                                                                       CAS005
     C     TZAICD        SUB       WINTST        TZAITD
     C                   ADD       TZAIAP        TZAITD
     C                   Z-ADD     WINTST        TWKINT           13 0
      *                                                                                       CAS005
      ** Calculate interest from the last interest payment date                               CAS005
      ** to the event control date                                                            CAS005
      *                                                                                       CAS005
     C                   Z-ADD     TZSLID        ZIBEG
     C                   Z-ADD     TZECD         ZIEND
      *                                                                                       CAS005
      ** If last day accrual ind. = Y calc interest up to but                                 CAS005
      ** excluding the event control date otherwise calc up to                                CAS005
      ** and including event control date                                                     CAS005
      *                                                                                       CAS005
     C     SZLDA         IFNE      'Y'
     C     ZIEND         ADD       1             ZIEND
     C                   ENDIF
      *                                                                                       CAS005
     C                   Z-ADD     TZPPL         ZIAMT
     C                   Z-ADD     TZCBS         ZICALC
      *                                                                                       CAS005
     C                   EXSR      GLINTC
      *                                                                                       CAS005
      ** If interest is yield based (method is 'Y') calculate it                              CAS005
      ** (using information provided by GLINTC)                                               CAS005
      *                                                                                       CAS005
     C     SZINPM        IFEQ      'Y'
     C     SZIEND        SUB       ZIEND         ZZINDY
     C                   EXSR      #LCIYD
     C                   Z-ADD     WKINT         WINTST
     C     TWKINT        SUB       WINTST        WINTST
     C                   ELSE
     C                   Z-ADD(H)  ZINTR         WINTST
     C                   ENDIF
      *                                                                                       CAS005
      ** Add interest calculated to interest accrued to control date                          CAS005
      *                                                                                       CAS005
     C                   ADD       WINTST        TZAITD
      *                                                                                       CAS005
      ** Calculate accrued interest to post                                                   CAS005
      *                                                                                       CAS005
     C     TZAITD        SUB       TZIPTD        TZAITP
      *                                                                                       CAS005
      ** Add accrued interest to post to accrued interest posted                              CAS005
      ** to date                                                                              CAS005
      *                                                                                       CAS005
     C                   ADD       TZAITP        TZIPTD
      *                                                                                       CAS005
     C                   ENDSR
      *****************************************************************                       CAS005
     C     #GOUT         BEGSR
      *                                                                                       CDL012
     C                   Z-ADD     DLNO          GDLNO
     C                   MOVE      CNUM          GCUST
     C                   MOVE      PCCY          GDCCY
     C                   MOVE      BRCA          GBRCD
      *                                                                                       CDL012
     C**********         CALL      'AOBRCHR0'                                          CDL012 CAS010
     C                   CALL      'AOBRCHR1'                                                 CAS010
     C                   PARM      *BLANKS       @RTCD             7
     C                   PARM      '*KEY   '     @OPTN             7
     C                   PARM      BRCA          @DSNB             3
     C*****@BRCH******** PARM      @BRCH         DSFDY                                 CDL012 CAS010
     C     @BRCH         PARM      @BRCH         DSSDY                                        CAS010
      *                                                                                       CDL012
     C     @RTCD         IFEQ      *BLANKS
     C                   MOVE      A8CMCD        GCMCD
     C                   ELSE
     C                   MOVE      *BLANKS       GCMCD
     C                   ENDIF
      *                                                                                       CDL012
     C                   Z-ADD     UGNIDT        GNIDT
      *                                                                                       CDL012
     C     MDAT          IFEQ      EVCD
     C     RECR          ANDEQ     'M'
     C     IPFR          ANDNE     'N'
     C     UGNIDT        ANDNE     MDAT
     C                   Z-ADD     MDAT          GNIDT
     C                   ENDIF
      *                                                                                       CDL012
     C     MDAT          IFLT      EVCD
     C     RECR          ANDEQ     'M'
     C     ORED          ANDEQ     EVCD
     C     MDAT          ORLT      EVCD
     C     RECR          ANDEQ     'M'
     C     LCD           ANDEQ     EVCD
      *                                                                                       CDL012
     C     UGNIDT        IFNE      0
     C                   Z-ADD     UGNIDT        GNIDT
     C                   ELSE
     C                   Z-ADD     MDAT          GNIDT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CDL012
     C                   Z-ADD     VDAT          GVDAT
     C                   Z-ADD     MDAT          GMDAT
     C                   Z-ADD     PAMT          GPCPL
     C                   Z-ADD     AIPD          GDINT
      *                                                                                       CDL012
     C     RECR          IFEQ      'M'
     C     DTYP          IFEQ      'TD'
     C                   Z-ADD     TOTI          GDINT
     C                   ELSE
     C                   Z-ADD     IPRD          GDINT
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CDL012
     C                   Z-ADD     INTR          GINTR
      *                                                                                       CDL012
     C                   CALL      'AOCURRR0'
     C                   PARM      *BLANKS       @RTCD             7
     C                   PARM      '*KEY   '     @OPTN             7
     C                   PARM      GDCCY         @AJCD             3
     C     SDCURR        PARM      SDCURR        DSSDY
      *                                                                                       CDL012
     C     @RTCD         IFEQ      *BLANK
     C                   Z-ADD     A6PRRT        GEXCR
     C                   ELSE
     C                   Z-ADD     0             GEXCR
     C                   ENDIF
      *                                                                                       CDL012
     C                   MOVE      DTYP          GDTYP
     C                   Z-ADD     ORED          GORED
     C     DTYP          IFEQ      'TD'
      *                                                                                       CDL012
     C                   MOVE      FSROLI        GROLI
      *                                                                                       CDL012
     C     RECR          IFNE      'D'
     C     RECR          ANDNE     'R'
     C     RBDN          ANDNE     0
      *                                                                                       CDL012
     C                   Z-ADD     RBDN          GRBDN
      *                                                                                       CDL012
     C     GRBDN         CHAIN     DEALDCV0                           16
      *                                                                                       CDL012
     C     *IN16         IFEQ      *OFF
     C                   Z-ADD     ORED2         GRBOR
      *                                                                                       CDL012
     C                   ELSE
      *                                                                                       CDL012
     C     GROLI         IFEQ      ' '
     C                   Z-ADD     0             GRBOR
     C                   Z-ADD     0             GRBDN
      *                                                                                       CDL012
     C                   ELSE
      *                                                                                       CDL012
     C                   MOVEL     'DEALDCV0'    DBFILE                          *************
     C                   MOVEL     '51'          DBASE                           *DBERROR 511*
     C                   MOVEL     @OPTN         DBOPTN                          *************
     C                   SETON                                        U7U8LR
     C                   EXSR      *PSSR
     C                   GOTO      EOJ
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CDL012
     C                   Z-ADD     GDLNO         DLNOKY
     C                   Z-ADD     GORED         OREDKY
     C                   Z-ADD     GRBDN         GRBDN2
     C                   Z-ADD     GRBOR         GRBOR2
      *                                                                                       CDL012
     C                   OPEN      DLTCSTV1
      *                                                                                       CDL012
     C     STMTKY        CHAIN     DLTCSTV1                           16
      *                                                                                       CDL012
     C     *IN16         DOWEQ     *OFF
     C                   UPDATE    DLTCSTP2
     C     STMTKY        READE     DLTCSTV1                               16
     C                   ENDDO
      *                                                                                       CDL012
     C                   CLOSE     DLTCSTV1
     C                   MOVE      IND16         *IN16
      *                                                                                       CDL012
     C                   ELSE
      *                                                                                       CDL012
     C                   Z-ADD     0             GRBDN
     C                   Z-ADD     0             GRBOR
     C                   MOVE      ' '           GROLI
      *                                                                                       CDL012
     C                   ENDIF
      *                                                                                       CDL012
     C                   ELSE
      *                                                                                       CDL012
     C                   Z-ADD     0             GRBDN
     C                   Z-ADD     0             GRBOR
     C                   MOVE      ' '           GROLI
     C                   ENDIF
      *                                                                                       CDL012
     C                   ENDSR
      *******************************************************************                     CDL034
      *                                                                                       CDL034
      *  DLINT - Calculate interest by processing Deal Interest Rate                          CDL034
      *          History file.                                                                CDL034
      *                                                                                       CDL034
      *******************************************************************                     CDL034
      *                                                                                       CDL034
     C     DLINT         BEGSR                                                                CDL034
      *                                                                                       CDL034
      ** Calculate interest for this interest period                                          CDL034
      *                                                                                       CDL034
     C                   CALL      'DLINTC'                                                   CDL034
     C                   PARM      DLNO          P@DLNO            6 0                        CDL034
     C                   PARM      WKIACD        ZIBEG                                        CDL034
     C                   PARM                    ZIEND                                        CDL034
     C                   PARM                    INTMAT            1                          CDL034
     C                   PARM      0             IRHINT           13 0                        CDL034
     C                   PARM      0             IRHAIP           13 0                        CDL034
     C                   PARM      PAMT          IRPCPL           13 0                      MD027681
      *                                                                                       CDL034
      ** Calculate adjustment to be included in interest                                      CDL034
      *                                                                                       CDL034
     C     IRHINT        SUB       IRHAIP        IRHADJ           13 0                        CDL034
     C                   IF        IRHADJ <> 0                                             AR1066579
     C     IRHADJ        SUB       WKINT         IRHADJ                                       CDL034
     C                   ENDIF                                                             AR1066579
      *                                                                                       CDL034
     C                   ENDSR                                                                CDL034
      *******************************************************************                     CDL034
     C/COPY DLCPYSRC,DL0280UPDI                                                               CDL034
      *******************************************************************                     CDL034
      *                                                                                       CDL034
      *  WRTIRH - Write Deal Interest Rate History record                                     CDL034
      *                                                                                       CDL034
      *******************************************************************                     CDL034
      *                                                                                       CDL034
     C     WRTIRH        BEGSR                                                                CDL034
      *                                                                                       CDL034
      ** Populate history record from DEALSDC fields                                          CDL034
      *                                                                                       CDL034
     C                   MOVE      'D'           A2RECI                                       CDL034
     C                   MOVE      DLNO          A2DLNO                                       CDL034
     C                   MOVE      CCY           A2CYCD                                       CDL034
     C                   Z-ADD     PAMT          A2PCPL                                       CDL034
     C                   MOVE      BRTT          A2BRT                                        CDL034
     C                   Z-ADD     BRTE          A2CBSR                                       CDL034
     C                   Z-ADD     RTSP          A2RTSP                                       CDL034
     C                   Z-ADD     INTR          A2INTR                                       CDL034
     C                   MOVE      ICBS          A2ICBS                                       CDL034
     C                   Z-ADD     0             A2AID1                                       CDL034
      *                                                                                       CDL034
     C                   WRITE     DLDIRHD0                                                   CDL034
      *                                                                                       CDL034
     C                   ENDSR                                                                CDL034
      *****************************************************************                       CDL012
     C/EJECT                                                                                  CDL013
      *---------------------------------------------------------------*                       CDL013
      *  #UTWHT - Tiered WHT Calculation                              *                       CDL013
      *---------------------------------------------------------------*                       CDL013
     C     #UTWHT        BEGSR                                                                CDL013
     C/COPY WNCPYSRC,DLH00075
     C     PCCY          IFEQ      BJCYCD                                                     CDL013
     C     CDL081        ANDEQ     'N'                                                        CDL081
     C     *IN43         IFEQ      *ON                                                        CDL013
     C                   Z-ADD     1             WADJ              4 0                        CDL013
     C                   ENDIF                                                                CDL013
     C     *IN44         IFEQ      *ON                                                        CDL013
     C                   Z-ADD     10            WADJ                                         CDL013
     C                   ENDIF                                                                CDL013
     C     *IN45         IFEQ      *ON                                                        CDL013
     C                   Z-ADD     100           WADJ                                         CDL013
     C                   ENDIF                                                                CDL013
     C     *IN46         IFEQ      *ON                                                        CDL013
     C                   Z-ADD     1000          WADJ                                         CDL013
     C                   ENDIF                                                                CDL013
     C     WORKD         DIV       WADJ          WINT             15 0                        CDL013
     C                   MULT      WADJ          WINT                                         CDL013
     C     WINT          MULT      WRATE         WWHT             15 0                        CDL013
     C                   DIV       100           WWHT                                         CDL013
     C                   DIV       WADJ          WWHT                                         CDL013
     C     WWHT          MULT      WADJ          TAXA                                         CDL013
     C                   ELSE                                                                 CDL013
     C     WORKD         MULT      WRATE         TAXA                                         CDL013
                                                                                              CDL081
      ** Check if tax amount is to be rounded down                                            CDL081
                                                                                              CDL081
     C     PCCY          IFEQ      BJCYCD                                                     CDL081
     C     CDL081        ANDEQ     'Y'                                                        CDL081
     C     W#BSRD        ANDEQ     'Y'                                                        CDL081
     C     PCCY          ORNE      BJCYCD                                                     CDL081
     C     CDL081        ANDEQ     'Y'                                                        CDL081
     C     W#NBRD        ANDEQ     'Y'                                                        CDL081
     C                   DIV       100           TAXA                                         CDL081
     C                   ELSE                                                                 CDL081
     C                   DIV(H)    100           TAXA                                         CDL013
     C                   ENDIF                                                                CDL081
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DLH00076
     C     DLPOST        IFEQ      'Y'                                                        CDL013
     C                   MOVE      'N'           WREVIN                                       CDL013
     C                   EXSR      #UHEXP                                                     CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDSR                                                                CDL013
      *---------------------------------------------------------------*                       CDL013
     C/EJECT                                                                                  CDL013
      *---------------------------------------------------------------*                       CDL013
      *  #UHECP - WHT History and extract update                      *                       CDL013
      *---------------------------------------------------------------*                       CDL013
     C     #UHEXP        BEGSR                                                                CDL013
     C                   MOVE      CNUM          ECUST                                        CDL013
     C                   MOVE      DLNO          EDLAC                                        CDL013
     C                   MOVE      'D'           EDAIN                                        CDL013
     C     HISKEY        CHAIN     GLWHTCL0                           18                      CDL013
     C/COPY WNCPYSRC,DLH00077
     C     *IN18         IFEQ      '1'                                                        CDL013
     C                   MOVE      BRCA          EBRCA                                        CDL013
     C                   MOVE      PCCY          ECURR                                        CDL013
     C                   Z-ADD     WORKD         ECRTM                                        CDL013
     C                   Z-ADD     TAXA          EWTTM                                        CDL013
     C                   Z-ADD     WORKD         ECRYD                                        CDL013
     C                   Z-ADD     TAXA          EWTYD                                        CDL013
     C                   Z-ADD     WORKD         ECRTO                                        CDL013
     C                   Z-ADD     TAXA          EWTTO                                        CDL013
     C                   Z-ADD     WRATE         EWTRT                                        CDL013
     C                   WRITE     GLWHTCD0                                                   CDL013
     C                   ELSE                                                                 CDL013
     C     WREVIN        IFEQ      'Y'                                                        CDL013
     C                   SUB       WORKD         ECRTM                                        CDL013
     C                   SUB       TAXA          EWTTM                                        CDL013
     C                   SUB       WORKD         ECRYD                                        CDL013
     C                   SUB       TAXA          EWTYD                                        CDL013
     C                   SUB       WORKD         ECRTO                                        CDL013
     C                   SUB       TAXA          EWTTO                                        CDL013
     C                   ELSE                                                                 CDL013
     C                   ADD       WORKD         ECRTM                                        CDL013
     C                   ADD       TAXA          EWTTM                                        CDL013
     C                   ADD       WORKD         ECRYD                                        CDL013
     C                   ADD       TAXA          EWTYD                                        CDL013
     C                   ADD       WORKD         ECRTO                                        CDL013
     C                   ADD       TAXA          EWTTO                                        CDL013
     C                   ENDIF                                                                CDL013
     C                   UPDATE    GLWHTCD0                                                   CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,DLH00096
     C     PCCY          IFNE      BJCYCD                                                     CDL013
     C     WREVIN        ANDNE     'Y'                                                        CDL013
     C                   MOVE      DLNO          EDLAC                                        CDL013
     C                   MOVE      'D'           EDAIN                                        CDL013
     C                   MOVE      BRCA          EBRCA                                        CDL013
     C                   MOVE      PCCY          ECURR                                        CDL013
     C     EXTKEY        CHAIN     GLXTAXL0                           18                      CDL013
     C     *IN18         IFEQ      '0'                                                        CDL013
     C     EVDAT         ANDEQ     WEVTDT                                                     CDL013
     C                   ADD       TAXA          EWTTO                                        CDL013
     C                   UPDATE    GLXTAXD0                                                   CDL013
     C                   ELSE                                                                 CDL013
     C                   MOVE      CNUM          ECUST                                        CDL013
     C                   MOVE      *BLANKS       EACCD                                        CDL013
     C                   Z-ADD     0             EACSQ                                        CDL013
     C                   Z-ADD     TAXA          ETAXA                                        CDL013
     C                   Z-ADD     WEVTDT        EVDAT                                        CDL013
     C                   WRITE     GLXTAXD0                                                   CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
     C                   ENDSR                                                                CDL013
      *****************************************************************                       CDL013
      /EJECT                                                                                  CER069
      *****************************************************************                       CER069
      * SRACTX - Check of EU Tax Value                                *                       CER069
      *****************************************************************                       CER069
     C     SRACTX        BEGSR                                                                CER069
                                                                                              CER069
     C                   CALL      'AOACTXR0'                                                 CER069
     C                   PARM      *BLANKS       @RTCD                                        CER069
     C                   PARM      '*KEY   '     @OPTN                                        CER069
     C                   PARM      CNUM          @CNUMX            6                          CER069
     C                   PARM      BRCA          @BRCDX            3                          CER069
     C     SDACTX        PARM      SDACTX        DSFDY                                        CER069
     C                   IF        @RTCD <> *BLANKS OR @RTCD = *BLANKS                        CER069
     C                             AND (AXETXS = 'S' OR AXETXS = 'E' OR                       CER069
     C                             AXETXS = 'D')                                              CER069
     C                   EVAL      TAXI = 'N'                                                 CER069
     C                   ELSE                                                                 CER069
     C                   EVAL      TAXI = AXETXS                                              CER069
     C                   ENDIF                                                                CER069
                                                                                              CER069
     C                   ENDSR                                                                CER069
      ****************************************************************                        CRE105
      /EJECT                                                                                  CRE105
      ****************************************************************                        CRE105
      *                                                              *                        CRE105
      *    SRRTVSEC - Retrieve Settlement Customer                   *                        CRE105
      *                                                              *                        CRE105
      ****************************************************************                        CRE105
     C     SRRTVSEC      BEGSR                                                                CRE105
                                                                                              CRE105
     C                   EVAL      WCust = *Blanks                                            CRE105
     C                   EVAL      WBRCH = *Blanks                                            CRE105
     C                   EVAL      WCCY  = *Blanks                                            CRE105
                                                                                              CRE105
     C                   SELECT                                                               CRE105
     C                   WHEN      KYSETL = 1                                                 CRE105
     C                             OR KYSETL = 2                                              CRE105
     C                             OR KYSETL = 7                                              CRE105
     C                             OR KYSETL = 8                                              CRE105
     C                             OR KYSETL = 12                                             CRE105
                                                                                              CRE105
     C                   IF        %SUBST(KYOSTL:1:2) <> *BLANKS                              CRE105
     C                   EVAL      WNOSC = %SUBST(KYOSTL:1:2)                                 CRE105
     C                   ELSE                                                                 CRE105
     C                   EVAL      WNOSC = %SUBST(KYOSTL:16:2)                                CRE105
     C                   ENDIF                                                                CRE105
                                                                                              CRE105
     C                   IF        KYSCY <> *BLANKS                                           CRE105
     C                   EVAL      WCCY = KYSCY                                               CRE105
     C                   ELSE                                                                 CRE105
     C                   EVAL      WCCY = KYCCY                                               CRE105
     C                   ENDIF                                                                CRE105
                                                                                              CRE105
     C                   CALL      'AONOSTR0'                                                 CRE105
     C                   PARM      *BLANKS       @RTCD                                        CRE105
     C                   PARM      '*KEY   '     @OPTN                                        CRE105
     C                   PARM      *BLANKS       @KEYA                                        CRE105
     C                   PARM      WCCY          @KEYB                                        CRE105
     C                   PARM      *BLANKS       @KEYC                                        CRE105
     C                   PARM      *BLANKS       @KEYD                                        CRE105
     C                   PARM      WNOSC         @KEYE                                        CRE105
     C                   PARM                    @BRCD                                        CRE105
     C                   PARM                    @CSSN                                        CRE105
     C                   PARM                    @PNOI                                        CRE105
     C     SDNOST        PARM      SDNOST        DSFDY                                        CRE105
                                                                                              CRE105
     C                   IF        @RTCD = *BLANKS                                            CRE105
     C                   EVAL      WCUST = A7CUST                                             CRE105
     C                   ENDIF                                                                CRE105
                                                                                              CRE105
     C                   EVAL      WBRCH = KYSTBR                                             CRE105
     C                                                                                        CRE105
     C                   WHEN      KYSETL = 4                                                 CRE105
     C                   EVAL      WCust = CNUM                                               CRE105
     C                   EVAL      WBRCH = KYSTBR                                             CRE105
     C                                                                                        CRE105
     C                   WHEN      KYSETL = 0                                                 CRE105
     C                             OR KYSETL = 3                                              CRE105
     C                             OR KYSETL = 6                                              CRE105
     C                   CALL      'AOBRCHR1'                                                 CRE105
     C                   PARM      *BLANKS       PRTCD                                        CRE105
     C                   PARM      '*KEY   '     POPTN                                        CRE105
     C                   PARM      BRCA          PDSNB                                        CRE105
     C     @BRCH         PARM      @BRCH         DSSDY                                        CRE105
                                                                                              CRE105
     C                   IF        PRTCD <> *BLANKS                                           CRE105
     C                   EVAL      DBKEY = BRCA                                               CRE105
     C                   EVAL      DBFILE = 'SDBRCHPD'                                        CRE105
     C                   EVAL      DBASE = '101'                                              CRE105
     C                   EXSR      *PSSR                                                      CRE105
     C                   ELSE                                                                 CRE105
     C                   EVAL      WCUST = A8BICN                                             CRE105
     C                   ENDIF                                                                CRE105
     C                   EVAL      WBRCH = BRCA                                               CRE105
     C                                                                                        CRE105
     C                   WHEN      KYSETL = 5                                                 CRE105
     C                   EVAL      WCUST = %SUBST(KYOSTL:1:6)                                 CRE105
     C                   EVAL      WACCD = %SUBST(KYOSTL:7:10)                                CRE105
     C                   EVAL      WASEQ = %SUBST(KYOSTL:17:2)                                CRE105
     C                   EVAL      WBRCH = KYSTBR                                             CRE105
     C                   CALL      'AOACCTR0'                                                 CRE105
     C                   PARM      *BLANKS       @RTCD                                        CRE105
     C                   PARM      '*KEY   '     @OPTN                                        CRE105
     C                   PARM      *BLANKS       @RETL                                        CRE105
     C                   PARM      WCUST         @CNUM                                        CRE105
     C                   PARM      KYCCY         @CUCD                                        CRE105
     C                   PARM      WACCD         @ACCD                                        CRE105
     C                   PARM      WASEQ         @ACSQ                                        CRE105
     C                   PARM      WBRCH         @BRCA                                        CRE105
     C     SDACCT        PARM      SDACCT        DSSDY                                        CRE105
                                                                                              CRE105
     C                   IF        @RTCD <> *BLANKS                                           CRE105
     C                   EVAL      DBFILE = 'ACCNTAB'                                         CRE105
     C                   EVAL      DBKEY  = KYOSTL                                            CRE105
     C                   EVAL      DBASE  = '105'                                             CRE105
     C                   EXSR      *PSSR                                                      CRE105
     C                   ELSE                                                                 CRE105
     C                   EVAL      WCUST = CNUM                                               CRE105
     C                   EVAL      WBRCH = BRCA                                               CRE105
     C                   ENDIF                                                                CRE105
                                                                                              CRE105
     C                   WHEN      KYSETL = 14                                                CRE105
     C                   EVAL      WACNT = %SUBST(KYOSTL:1:10)                                CRE105
     C                   CALL      'AOACCTR0'                                                 CRE105
     C                   PARM      *BLANKS       @RTCD                                        CRE105
     C                   PARM      '*KEY   '     @OPTN                                        CRE105
     C                   PARM      WACNT         @RETL                                        CRE105
     C                   PARM      *BLANKS       @CNUM                                        CRE105
     C                   PARM      *BLANKS       @CUCD                                        CRE105
     C                   PARM      *BLANKS       @ACCD                                        CRE105
     C                   PARM      *BLANKS       @ACSQ                                        CRE105
     C                   PARM      *BLANKS       @BRCA                                        CRE105
     C     SDACCT        PARM      SDACCT        DSSDY                                        CRE105
                                                                                              CRE105
     C                   IF        @RTCD <> *BLANKS                                           CRE105
     C                   EVAL      DBFILE = 'ACCNTAB'                                         CRE105
     C                   EVAL      DBKEY = WACNT                                              CRE105
     C                   EVAL      DBASE = '103'                                              CRE105
     C                   EXSR      *PSSR                                                      CRE105
     C                   ELSE                                                                 CRE105
     C                   EVAL      WCUST = ACNUM                                              CRE105
     C                   ENDIF                                                                CRE105
     C                   EVAL      WBRCH = KYSTBR                                             CRE105
     C                                                                                        CRE105
     C                   ENDSL                                                                CRE105
     C                                                                                        CRE105
     C** Check if the settlement customer is a bank, if yes then use                          CRE105
     C** the dealing customer and branch                                                      CRE105
     C                                                                                        CRE105
     C                   CALL      'AOCUSTR0'                                                 CRE105
     C                   PARM      *BLANKS       PRTCD                                        CRE105
     C                   PARM      '*KEY   '     POPTN                                        CRE105
     C                   PARM      WCUST         PKEY1                                        CRE105
     C                   PARM                    PKEYST                                       CRE105
     C     SDCUST        PARM      SDCUST        DSSDY                                        CRE105
     C                                                                                        CRE105
     C                   IF        PRTCD <> *BLANKS                                           CRE105
     C                   EVAL      DBKEY = WCUST                                              CRE105
     C                   EVAL      DBFILE = 'SDCUSTPD'                                        CRE105
     C                   EVAL      DBASE = '104'                                              CRE105
     C                   ENDIF                                                                CRE105
     C                                                                                        CRE105
     C                   IF        BBBNBI = 'Y'                                               CRE105
     C                   EVAL      WCUST = CNUM                                               CRE105
     C                   EVAL      WBRCH = BRCA                                               CRE105
     C                   ENDIF                                                                CRE105
     C                                                                                        CRE105
     C                   ENDSR                                                                CRE105
      ****************************************************************                        CRE105

     C/COPY DLCPYSRC,DL0280MMCF                                                               CAS009
     C/COPY DLCPYSRC,DL0280HIST                                                               232928
     C/COPY DLCPYSRC,DL0280HSTQ                                                               232928
     C***/COPY*WNCPYSRC,DL0280C713                                                            CDL018
     C*/C*PY*DLCPYSRC,DL0280C713**************************************                CDL018 BUG6293
     C/COPY DLCPYSRC,DL0280CHKS                                                              BUG6293
     C/COPY DLCPYSRC,DL0280MKEY                                                              BUG6293
     C/COPY DLCPYSRC,DL0280RSET                                                              BUG6293
     C/COPY DLCPYSRC,DL0280PSET                                                              BUG6293
     C/COPY DLCPYSRC,DL0280GENM                                                              BUG6293
     C/COPY DLCPYSRC,DL0280GEND                                                              BUG6293
     C/COPY DLCPYSRC,DL0280MEXC                                                              BUG6293
     C/COPY DLCPYSRC,DL0280EMAT                                                              BUG7531
     C/COPY DLCPYSRC,DL0280CSFR                                                               CDL033
     C/COPY DLCPYSRC,DL0280EUTX                                                               233277
     C/COPY DLCPYSRC,DL0280CALJ                                                               233277
     C/COPY DLCPYSRC,DL0280CZJA                                                               233277
     C/COPY DLCPYSRC,DL0280CSIN                                                               233277
     C/COPY DLCPYSRC,DL0280CUST                                                               233277
     C/COPY DLCPYSRC,DL0280CURR                                                               233277
     C/COPY DLCPYSRC,DL0280ETDC                                                               233324
     C/COPY DLCPYSRC,DL0280EADC                                                               233324
     C/COPY DLCPYSRC,DL0280EIUS                                                               235174
     C/COPY DLCPYSRC,DL0280EMUS                                                               235174
     C/COPY DLCPYSRC,DL0280UICT                                                               CGL031
     C/COPY DLCPYSRC,DL0280UIGK                                                               CGL031
     C/COPY DLCPYSRC,DL0280UMCT                                                               CGL031
     C/COPY DLCPYSRC,DL0280UMGK                                                               CGL031
     C/COPY DLCPYSRC,DL0280DBAK                                                             BUG11189
     C/COPY DLCPYSRC,DL0280RCTI                                                             AR866124
     C/COPY DLCPYSRC,DL0280HSRT                                                             MD031283
     C/COPY DLCPYSRC,DL0280BRCP                                                             MD031283
      /EJECT                                                              CDL006
     C**********/COPY ZSRSRC,ZCONVNZ1                                     CDL006             BUG6293
     C/COPY ZSRSRC,ZCONVNZ1LE                                                                BUG6293
     C**********/COPY ZSRSRC,ZCONVZ1                                      CIR003             BUG6293
     C/COPY ZSRSRC,ZCONVZ1ILE                                                                BUG6293
     C/COPY WNCPYSRC,DL0280C125                                           S01408
     C*                                                                   S01408
     C**********/COPY ZSRSRC,ZBAKRT                                       S01486             BUG6293
     C/COPY ZSRSRC,ZBAKRT_ILE                                                                BUG6293
     C**********/COPY ZSRSRC,ZCCYCN                                       S01486             BUG6293
     C/COPY ZSRSRC,ZCCYCN_ILE                                                                BUG6293
     C**********/COPY ZSRSRC,ZCCYXR                                       S01486             BUG6293
     C/COPY ZSRSRC,ZCCYXR_ILE                                                                BUG6293
     C**********/COPY ZSRSRC,ZACCH                                        S01195             BUG6293
     C/COPY ZSRSRC,ZACCHLE                                                                   BUG6293
     C*                                                                   S01195
     C**********/COPY ZSRSRC,ZCHKH                                        S01195             BUG6293
     C/COPY ZSRSRC,ZCHKHLE                                                                   BUG6293
     C*                                                                   S01195
     C**********/COPY ZSRSRC,ZFWDT                                        S01195             BUG6293
     C/COPY ZSRSRC,ZFWDT_ILE                                                                 BUG6293
     C*                                                                   S01195
     C**********/COPY ZSRSRC,ZBKDT                                        S01195             BUG6293
     C/COPY ZSRSRC,ZBKDT_ILE                                                                 BUG6293
      /EJECT                                                              066550
     C**********/COPY ZSRSRC,ZINTDYZ2                                     066550             BUG6293
     C/COPY ZSRSRC,ZINTDYZ2LE                                                                BUG6293
      /EJECT                                                              066550
     C**********/COPY ZSRSRC,ZDATE9Z3                                     066550             BUG6293
     C/COPY ZSRSRC,ZDATE9Z3LE                                                                BUG6293
      /EJECT                                                              066550
     C**********/COPY ZSRSRC,GLINTCZ1                                     066550             BUG6293
     C/COPY ZSRSRC,GLINTCZ1LE                                                                BUG6293
      /EJECT                                                              066550
     C**********/COPY ZSRSRC,ZDAT10Z2                                     126017             BUG6293
     C/COPY ZSRSRC,ZDAT10Z2LE                                                                BUG6293
     C**********/COPY ZSRSRC,ZFRQB3                                       CIR005             BUG6293
     C/COPY ZSRSRC,ZFRQB3_ILE                                                                BUG6293
     C/COPY ZSRSRC,ZFEB29Z2LE                                                                 CIR013
     C/EJECT                                                              126017
3886 C********************************************************************
     C/COPY WNCPYSRC,DL0280C522
3887 C/EJECT
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0280C106                                           S01408
      *                                                                   S01408
     ODL0280P1  H    OF U1 L1               2 03                                S01117
     O         AND   11                                                         LN0884
     O         OR    OF U1NL1                                                   S01117
     O         AND   11                                                         LN0884
3889 O                                           24 'REFERENCE DL0280P1'        S01117
3890 O                       BJURPT              89                             S01194
3891 O                                          104 'DATE'
3892 O                       BJMRDT             112
3893 O                                          122 'PAGE'
3894 O                       PAGE          Z    127
3895 O          H    OF U1 L1               1                                   S01117
     O         AND   11                                                         LN0884
3895 O         OR    OF U1NL1                                                   S01117
     O         AND   11                                                         LN0884
3896 O                                           67 'DAILY DEALS UPDATE'
3897 O                                           74 'REPORT'
3898 O          H    OF U1 L1               2                                   S01117
     O         AND   11                                                         LN0884
3895 O         OR    OF U1NL1                                                   S01117
     O         AND   11                                                         LN0884
3899 O                                           67 '------------------'
3900 O                                           74 '-------'
3898 O          H    OF U1 L1               2                                   S01117
     O         AND   11                                                         LN0884
3895 O         OR    OF U1NL1                                                   S01117
     O         AND   11                                                         LN0884
*    O                                           12 'BRANCH'                    S01117
*    O                       BRCA                16                             S01117
*    O                       A8BRNM              48                             S01117
3908 O          H    OF U1                  1                                   E26468
     O         AND   11                                                         LN0884
     O         AND   L1                                                         S01117
3895 O         OR    OF U1NL1                                                   S01117
     O         AND   11                                                         LN0884
3910 O                                           18 'CUST.   DEAL  DEAL'        E11190
     O**********                                 25 'EVENT'                     S01378        CDL038
     O**********                                 65 'PRIN/PUR.AMT/'             S01378        CDL038
     O**********     13                          69 'BASE'                      S01378        CDL038
     O**********                                 80 'INT/EXCH.'                 S01378        CDL038
     O                                           29 'EVENT'                                   CDL038
     O                                           67 'PRIN/PUR.AMT/'                           CDL038
     O               13                          71 'BASE'                                    CDL038
     O                                           81 'INT/EXCH.'                               CDL038
     O                                           99 'INT/SOLD AMT/'             S01378
     O                                          104 'SALE'                      S01378
     O/COPY WNCPYSRC,DL0280O012
     O                  19                      117 'TAX'                       S01378
     O/COPY WNCPYSRC,DL0280O010
     O                                          132 'PCL'                       S01378
3916 O          H    OF U1 L1               2                                   S01117
     O         AND   11                                                         LN0884
3895 O         OR    OF U1NL1                                                   S01117
     O         AND   11                                                         LN0884
     O                                           18 'NUMBER NUMBER TYPE'        S01378
     O**********                                 33 'DATE    EVENT'                    S01378 CDL038
     O**********                                 45 'CCY'                              S01378 CDL038
     O**********        14                       49 'F/F'                              S01378 CDL038
     O**********                                 61 'SWAP LOSS'                        S01378 CDL038
     O**********     13                          69 'RATE'                             S01378 CDL038
     O**********                                 77 'RATE'                             S01378 CDL038
     O                                           37 'DATE    EVENT'                           CDL038
     O                                           49 'CCY'                                     CDL038
     O                  14                       53 'F/F'                                     CDL038
     O                                           63 'SWAP LOSS'                               CDL038
     O               13                          71 'RATE'                                    CDL038
     O                                           79 'RATE'                                    CDL038
     O                                           99 'SWAP PROFIT'               S01378
     O                                          104 'CCY'                       S01378
     O                  14                      108 'F/F'                       S01378
     O                     19                   122 'AMOUNT'                    S01378
     O                                          132 'SIZE'                      S01378
3954 O          EF   71 U1                  1                                   E11190
     O/COPY WNCPYSRC,DL0280O017
     O         AND   11N38                                                      048530
3955 O                       CNUM                 6
3956 O                       DLNO                13                             E11190
3957 O                       DTYP                16                             E11190
3958 O                                           17 '-'                         E11190
3959 O                       DLST                19                             E11190
     O                       CLAS                23                                           CDL038
     O                  10   BYSL                24                                           CDL038
     O                       NARDTE              31                                           CDL038
     O                       NARREV              45                                           CDL038
     O                       KYCCY               49                                           CDL038
     O                  02N30PCCY                49                                           CDL038
     O                  61                       50 'F'                                       CDL038
     O**********        43   NRRPUR        1     66                                    CDL038 247518
     O**********        44   NRRPUR              65 '   ,   ,   , 0 . '                CDL038 247518
     O**********        45   NRRPUR              66 '  ,   ,   , 0 .  '                CDL038 247518
     O                  43   NRRPUR        1     67                                           247518
     O                  44   NRRPUR              67 '   ,   ,   , 0 . '                       247518
     O                  45   NRRPUR              67 '  ,   ,   , 0 .  '                       247518
     O                  46   NRRPUR              67 ' ,   ,   , 0 .   '                       CDL038
3958 O**********     10      BYSL                20                                    S01157 CDL038
     O**********             NARDTE              27                                    S01378 CDL038
     O**********             NARREV              41                                    S01378 CDL038
     O**********             KYCCY               45                                    S01378 CDL038
     O**********        02N30PCCY                45                                    S01378 CDL038
     O**********        61                       46 'F'                                S01378 CDL038
     O**********        43   NRRPUR        1     64                                    060129 CDL038
     O**********        44   NRRPUR              63 '   ,   ,   , 0 . '                S01378 CDL038
     O**********        45   NRRPUR              64 '  ,   ,   , 0 .  '                S01378 CDL038
     O**********        46   NRRPUR              65 ' ,   ,   , 0 .   '                S01378 CDL038
     O**********        10   NRBRTT              67                                    S01378 CDL038
     O**********        02N30NARRAT              80 '   0 .        '                   S01378 CDL038
     O**********        02 30NRRT                80 '  0 .       -'                    S01378 CDL038
     O**********        03   NRRT                80 '  0 .       -'                    S01378 CDL038
     O**********        04N49NRRT                80 '  0 .       -'                    S01378 CDL038
     O**********        05N51NRRT                80 '  0 .       -'                    S01378 CDL038
     O**********        10N31NRRT                80 '  0 .       -'                    S01378 CDL038
     O/COPY WNCPYSRC,DL0280OOP4                                           S01408
     O               03 23 73TAXA          J    122                             S01378
     O               03 23 74TAXA               124 '   ,   ,   , 0 . -'        S01378
     O               03 23 75TAXA               125 '  ,   ,   , 0 .  -'        S01378
     O               03 23 76TAXA               126 ' ,   ,   , 0 .   -'        S01378
     O/COPY WNCPYSRC,DL0280O013
     O               10 33 73TAXA          J    122                             S01378
     O               10 33 74TAXA               124 '   ,   ,   , 0 . -'        S01378
     O               10 33 75TAXA               125 '  ,   ,   , 0 .  -'        S01378
     O               10 33 76TAXA               126 ' ,   ,   , 0 .   -'        S01378
     O**********        73N19NRRSAL        1     97                                  S01378 AR814519
     O                  73N19NRRSAL        J     97                                         AR814519
     O**********        74N19NRRSAL              99 '   ,   ,   , 0 . '              S01378 AR814519
     O                  74N19NRRSAL              99 '   ,   ,   , 0 . -'                    AR814519
     O**********        75N19NRRSAL             100 '  ,   ,   , 0 .  '              S01378 AR814519
     O                  75N19NRRSAL             100 '  ,   ,   , 0 .  -'                    AR814519
     O**********        76N19NRRSAL             101 ' ,   ,   , 0 .   '              S01378 AR814519
     O                  76N19NRRSAL             101 ' ,   ,   , 0 .   -'                    AR814519
     O               19 73N59NRRSAL        J     97                             S01378
     O               19 74N59NRRSAL              99 '   ,   ,   , 0 . -'        S01378
     O               19 75N59NRRSAL             100 '  ,   ,   , 0 .  -'        S01378
     O               19 76N59NRRSAL             101 ' ,   ,   , 0 .   -'        S01378
     O                  02N30NARRAT              81 '   0 .        '                          CDL038
     O                  02 30NRRT                81 '  0 .       -'                           CDL038
     O                  03   NRRT                81 '  0 .       -'                           CDL038
     O                  04N49NRRT                81 '  0 .       -'                           CDL038
     O                  05N51NRRT                81 '  0 .       -'                           CDL038
     O                  10N31NRRT                81 '  0 .       -'                           CDL038
     O                  10   NRBRTT              69                                           CDL038
     O/COPY WNCPYSRC,DL0280OOP5                                           S01408
     O               03 23 24                    83 'NET'                       S01378
     O               10 33 24                    83 'NET'                       S01378
     O                       SALCY          B   104                             S01378
     O                  62                      106 'F'                         S01378
     O               04 89   NARPSZ        Z    131                             S01378
     O               05 89   PSZE          Z    131                             S01378
3977 O* NRRSAL OVERPRINTS LEADING POSITION OF TAXA                        S01119
     O*     FOLLOWING 4 LINES CHANGED TO CORRECT COLUMN ALLIGNMENT        E21758
     O*     PROBLEM CAUSED BECAUSE THESE FIELDS DO NOT HAVE A SIGN.       E21758
     O*                                                                   048530
     O          EF   71 U1                  1                                   048530
     O         AND   11 38                                                      048530
     O                       CNUM                 6                             048530
     O                       DLNO                13                             048530
     O                       DTYP                16                             048530
     O                                           17 '-'                         048530
     O                       DLST                19                             048530
     O                       CLAS                23                                           CDL038
     O               10      BYSL                24                                           CDL038
     O                       NARDTE              31                                           CDL038
     O                       NARREV              45                                           CDL038
     O**********     10      BYSL                20                                    048530 CDL038
     O**********             NARDTE              27                                    048530 CDL038
     O**********             NARREV              41                                    048530 CDL038
     O/COPY WNCPYSRC,DL0280O023
     O                       KYCCY               49                                           CDL038
     O                  02N30PCCY                49                                           CDL038
     O                  61                       50 'F'                                       CDL038
     O**********        43   NRRPUR        1     66                                    CDL038 247518
     O**********             KYCCY               45                                    048530 CDL038
     O**********        02N30PCCY                45                                    048530 CDL038
     O**********        61                       47 'F'                                048530 CDL038
     O**********        43   NRRPUR        1     64                                    048530 CDL038
     O/COPY WNCPYSRC,DL0280O006
     O**********        44   NRRPUR              65 '   ,   ,   , 0 . '                CDL038 247518
     O**********        45   NRRPUR              66 '  ,   ,   , 0 .  '                CDL038 247518
     O                  43   NRRPUR        1     67                                           247518
     O                  44   NRRPUR              67 '   ,   ,   , 0 . '                       247518
     O                  45   NRRPUR              67 '  ,   ,   , 0 .  '                       247518
     O                  46   NRRPUR              67 ' ,   ,   , 0 .   '                       CDL038
     O**********        44   NRRPUR              63 '   ,   ,   , 0 . '                080603 CDL038
     O**********        45   NRRPUR              64 '  ,   ,   , 0 .  '                080603 CDL038
     O**********        46   NRRPUR              65 ' ,   ,   , 0 .   '                080603 CDL038
     O**********        10   NRBRTT              67                                    080603 CDL038
     O**********        02N30NARRAT              80 '   0 .        '                   080603 CDL038
     O**********        02 30NRRT                80 '  0 .       -'                    080603 CDL038
     O**********        03   NRRT                80 '  0 .       -'                    080603 CDL038
     O**********        04N49NRRT                80 '  0 .       -'                    080603 CDL038
     O**********        05N51NRRT                80 '  0 .       -'                    080603 CDL038
     O**********        10N31NRRT                80 '  0 .       -'                    080603 CDL038
     O               10 33 73TAXA          J    122                             080603
     O               10 33 74TAXA               124 '   ,   ,   , 0 . -'        080603
     O               10 33 75TAXA               125 '  ,   ,   , 0 .  -'        080603
     O               10 33 76TAXA               126 ' ,   ,   , 0 .   -'        080603
     O**********        73N19NRRSAL        1     97                                  080603 AR814519
     O                  73N19NRRSAL        J     97                                         AR814519
     O**********        74N19NRRSAL              99 '   ,   ,   , 0 . '              080603 AR814519
     O                  74N19NRRSAL              99 '   ,   ,   , 0 . -'                    AR814519
     O**********        75N19NRRSAL             100 '  ,   ,   , 0 .  '              080603 AR814519
     O                  75N19NRRSAL             100 '  ,   ,   , 0 .  -'                    AR814519
     O**********        76N19NRRSAL             101 ' ,   ,   , 0 .   '              080603 AR814519
     O                  76N19NRRSAL             101 ' ,   ,   , 0 .   -'                    AR814519
     O               19 73N59NRRSAL        J     97                             080603
     O               19 74N59NRRSAL              99 '   ,   ,   , 0 . -'        080603
     O               19 75N59NRRSAL             100 '  ,   ,   , 0 .  -'        080603
     O               19 76N59NRRSAL             101 ' ,   ,   , 0 .   -'        080603
     O                  02N30NARRAT              81 '   0 .        '                          CDL038
     O                  02 30NRRT                81 '  0 .       -'                           CDL038
     O                  03   NRRT                81 '  0 .       -'                           CDL038
     O                  04N49NRRT                81 '  0 .       -'                           CDL038
     O                  05N51NRRT                81 '  0 .       -'                           CDL038
     O                  10N31NRRT                81 '  0 .       -'                           CDL038
     O                  10   NRBRTT              69                                           CDL038
     O               10 33 24                    86 'NET'                       080603
     O                       SALCY          B   104                             080603
     O                  62                      106 'F'                         080603
     O/COPY WNCPYSRC,DL0280O007
     O*                                                                   S01119
     O* FRA/IRS CONTINUATION LINES                                        S01119
     O*                                                                   S01119
     O          E    U1      RXTHRS         1                                   S01119
3954 O         AND   11                                                         S01117
     O**********             KYCCY               44                                    S01378 CDL038
     O**********        43   NRRPUR        1     61                                    S01378 CDL038
     O**********        44   NRRPUR              63 '   ,   ,   , 0 . '                S01378 CDL038
     O**********        45   NRRPUR              64 '  ,   ,   , 0 .  '                S01378 CDL038
     O**********        46   NRRPUR              65 ' ,   ,   , 0 .   '                S01378 CDL038
     O**********             NRBRTT              67                                    S01378 CDL038
     O**********          N31NRRT                80 '  0 .       -'                    S01378 CDL038
     O                       KYCCY               49                                           CDL038
     O**********        43   NRRPUR        1     66                                    CDL038 247518
     O**********        44   NRRPUR              65 '   ,   ,   , 0 . '                CDL038 247518
     O**********        45   NRRPUR              66 '  ,   ,   , 0 .  '                CDL038 247518
     O                  43   NRRPUR        1     67                                           247518
     O                  44   NRRPUR              67 '   ,   ,   , 0 . '                       247518
     O                  45   NRRPUR              67 '  ,   ,   , 0 .  '                       247518
     O                  46   NRRPUR              67 ' ,   ,   , 0 .   '                       CDL038
     O                  43   NRRSAL        J     97                             S01378
     O                  44   NRRSAL              99 '   ,   ,   , 0 . -'        S01378
     O                  45   NRRSAL             100 '  ,   ,   , 0 .  -'        S01378
     O                  46   NRRSAL             101 ' ,   ,   , 0 .   -'        S01378
     O                  62                      106 'F'                         S01378
     O                    N31NRRT                81 '  0 .       -'                           CDL038
     O                       NRBRTT              69                                           CDL038
     O*                                                                   S01119
     O          E    U1      FITHR1         1                                   S01119
3954 O         AND   11                                                         S01117
     O**********             NRBRTT              70                                    S01378 CDL038
     O**********          N31NRRT                83 '  0 .       -'                    S01378 CDL038
     O                    N31NRRT                81 '  0 .       -'                           CDL038
     O                       NRBRTT              69                                           CDL038
     O*                                                                   S01119
     O          E    U1      FLOOR          1                                   S01119
3954 O         AND   11                                                         S01117
     O**********             FLRAT               80 '  0 .       -'                    S01378 CDL038
     O                  33 43TAXA          J    122                             S01378
     O                  33 44TAXA               124 '   ,   ,   , 0 . -'        S01378
     O                  33 45TAXA               125 '  ,   ,   , 0 .  -'        S01378
     O                  33 46TAXA               126 ' ,   ,   , 0 .   -'        S01378
     O                  43   NRRSAL        J     97                             S01378
     O                  44   NRRSAL              99 '   ,   ,   , 0 . -'        S01378
     O                  45   NRRSAL             100 '  ,   ,   , 0 .  -'        S01378
     O                  46   NRRSAL             101 ' ,   ,   , 0 .   -'        S01378
     O                       FLRAT               81 '  0 .       -'                           CDL038
     O                  33 24                    83 'NET'                       S01378
     O*                                                                   S01119
     O          E    U1      FITHR2         1                                   S01119
3954 O         AND   11                                                         S01117
     O**********             NRBRTT              67                                    S01378 CDL038
     O**********          N31NRRT                80 '  0 .       -'                    S01378 CDL038
     O                  43   NRRSAL        J     97                             S01378
     O                  44   NRRSAL              99 '   ,   ,   , 0 . -'        S01378
     O                  45   NRRSAL             100 '  ,   ,   , 0 .  -'        S01378
     O                  46   NRRSAL             101 ' ,   ,   , 0 .   -'        S01378
     O                    N31NRRT                81 '  0 .       -'                           CDL038
     O                       NRBRTT              69                                           CDL038
     O          E    U1      MATCH#         1                                   126836
3954 O         AND   11                                                         S01117
     O                  43   NRRSAL        J    101                             S01378
     O                  44   NRRSAL             103 '   ,   ,   , 0 . -'        S01378
     O                  45   NRRSAL             104 '  ,   ,   , 0 .  -'        S01378
     O                  46   NRRSAL             105 ' ,   ,   , 0 .   -'        S01378
     O/COPY WNCPYSRC,DL0280O011
     O          T    11 U1 L1            2                                      LN0818
     O         AND   12                                                         LN0710
     O                                           64 '*** END OF REPORT '        LN0780
     O                                           78 'FOR BRANCH ***'            LN0780
     ODL0280AU  TF   LR U1                  1 03                                S01117
     O         OR    LRNU1                  1 03                                S01117
     O                                           24 'REFERENCE DL0280AU'        S01117
     O                       BJURPT              89                             S01194
     O                                          104 'DATE'                      E10126
     O                       BJMRDT             112                             E10126
     O                                          122 'PAGE'                      E10126
     O                       PAGE1         Z    127                             S01117
     O          T    LR                     1                                   E10126
3986 O                                           59 'DEALS FILE UPDATE -'
3987 O                                           83 'PHASE 2 - FILE CONTROLS'
3988 O          T    LR                     2
3989 O                                           60 '--------------------'
3990 O                                           83 '-----------------------'
     O          T    LR 32                  1                                   134627
3992 O                                           32 'ROLLOVER DEAL'             S01392
3993 O                       RBDN                40                             S01392
3993 O                                           51 'NOT FOUND'                 S01392
3993 O                                           65 'RUN ABORTED'               S01392
3991 O          T    LR 85                  1
3992 O                                           39 'NO DEAL AMEND. HEADER'
3993 O                                           60 'RUN ABORTED'
3994 O          T    LR 86                  2
3995 O                                           38 'NO DEAL FILE HEADER'
3996 O                                           60 'RUN ABORTED'
     O          T    LR 88                  2                                   S01383
     O                                           28 'CUSTOMER'                  S01383
     O                       XKEY                35                             S01383
     O                                           57 'NOT FOUND ON SDCBRTL1'     S01383
     O**********T    LR 89                  2                                        S01383 AR547995
     O          T    LR U6                                                                  AR547995
     O                                           28 'CUSTOMER'                  S01383
     O                       XKEY                35                             S01383
     O                                           54 'NOT FOUND ON CLINT'        S01383
4009 O          T    LR 80                  2
4010 O                                           22 'CCY'
4011 O                       XCCY                27
4012 O                                           47 'NOT FOUND IN ARRAY'
4013 O                                           60 'RUN ABORTED'
4014 O          T    LR 79                  2
4015 O                                           36 'INVALID DEAL TYPE'
4016 O                       DTYP                39
4017 O                                           60 'RUN ABORTED'
4018 O          T    LR 78                  2
4019 O                                           37 'INVALID AMEND TYPE'
4020 O                       AMTP                40
4021 O                                           60 'RUN ABORTED'
4022 O          T    LR 77                  2
4023 O                                           40 'NO TRAILER ON S/DAMSX'     BHF641
4024 O                                           60 'RUN ABORTED'
4025 O          T    LR 64                  2
4026 O                                           38 'AMEND POST MATURITY'
4027 O                       AMTP                41
4028 O                       VDATDM              47
4029 O                       DLNODM              53
4030 O                                           66 'RUN ABORTED'
4025 O**********E            ERROR          2                                        S01119 AR547995
     O          T    LR U5                                                                  AR547995
4026 O                                           38 'LF/DAMBR RECORD NOT'       S01119
4027 O                                           44 'FOUND'                     S01119
4027 O                                           57 'FOR DEAL NO.'              S01119
4028 O                       DLNO                64                             S01119
4030 O                                           76 'RUN ABORTED'               S01119
     O/COPY WNCPYSRC,DL0280O001
4031 O**********T    LR                     1                                               AR547995
     O          T    LRN32N64               1                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4033 O                                           28 'S/DEALSL1 - RUN CONTROLS'  S01117
4034 O                                           59 'NUMBER'
4035 O                                           84 'VALUE'
4036 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4037 O                                           13 '---------'                 LN0743
4038 O                                           28 '------------'
4039 O                                           59 'OF RECORDS'
4040 O                                           84 'OF RECORDS'
4049 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4050 O                                           29 'LIVE DEALS - ON FILE '     S01093
4051 O                       NLRA          3     59
4052 O                       VLAFD         Z     81
4053 O                       VLALD               84
4054 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4055 O                                           32 'LIVE DEALS - CALCULATED '  S01093
4057 O                       TOTDTD        3     59
4058 O                       TOTDLI        Z     81
4059 O                       TOTDLD              84
4060 O               82                         111 '***   DIFFERENCE   ***'
4061 O               83                         111 '***   DIFFERENCE   ***'
4107 O**********T    LR                     2                                        S01093 AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4108 O                                           27 'DEALS MATURED TODAY'       S01093
4109 O                       TOTNDM        3     59                             S01093
4110 O                       TOTIM         Z     81                             S01093
4111 O                       TOTDM               84                             S01093
4107 O**********T    LR                     2                                        S01093 AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4108 O                                           28 'DEALS REVERSED TODAY'      S01093
4109 O                       NREV          3     59                             S01093
4110 O                       TOTDDI        Z     81                             E10165
4111 O                       TOTDDD              84                             E10165
4117 O**********T    LR                     2                                        S01093 AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4118 O                                           16 'VALUE OF'                  S01093
4119 O                                           32 'CAPITALISATIONS'           S01093
4120 O                       NETCII        Z     81                             S01093
4121 O                       NETCID              85 '   -'                      CIR001
4112 O**********T    LR                     2                                        S01093 AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4113 O                                           28 'LIVE DEALS REMAINING'      S01093
4114 O                       TOTNDL        3     59                             S01093
4115 O                       TOTIL         Z     81                             S01093
4116 O                       TOTDL               84                             S01093
     O                     63                   111 '***   DIFFERENCE   ***'    E10165
4068 O**********T    LR                  1  1                                               AR547995
     O          T    LRN32N64            1  1                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4069 O                                           28 'S/DAMSX  -  RUN CONTROLS'  BHF641
4070 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4071 O                                           11 '-------'
4072 O                                           28 '------------'
4073 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4074 O                                           31 'TOTAL RECORDS - ON FILE'
4075 O                       TOTNRD        3     59
4076 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4077 O                                           32 'TOTAL RECORDS - CALCULAT'
4078 O                                           34 'ED'
4079 O                       TOTDMS        3     59
4080 O               37                         111 '***   DIFFERENCE   ***'
4081 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4082 O                                           30 'DETAIL RECORDS ON FILE'
4083 O                       TOTNRA        3     59
4084 O                       TOTALI        Z     81
4085 O                       TOTALD              84
4086 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4087 O                                           32 'DETAIL RECORDS CALCULATE'
4088 O                                           33 'D'
4089 O                       TOTDMD        3     59
4090 O                       TOTDHI        Z     81
4091 O                       TOTDHD              84
4092 O               81                         111 '***   DIFFERENCE   ***'
4093 O**********T    LR                     3                                               AR547995
     O          T    LRN32N64               3                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4094 O                                           32 'DETAIL RECORDS CALCULATE'
4095 O                                           39 'D - NET'
4096 O                       TOTNTI        Z     81
4097 O                       TOTNTD              84
4123 O**********T    LR                  1  1                                               AR547995
     O          T    LRN32N64            1  1                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4124 O                                           28 'S/DKEYS  -  RUN CONTROLS'
4125 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4126 O                                           11 '-------'
4127 O                                           28 '------------'
4128 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4129 O                                           28 'TOTAL RECORDS OUTPUT'
4130 O                       DKREC         3     59
4131 O**********T    LR                     2                                               AR547995
     O          T    LRN32N64               2                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU5NU6                                                               AR547995
4132 O                                           29 'DETAIL RECORDS OUTPUT'
4133 O                       DKRECD        3     59
4134 O                       TOTDKI        Z     81
4135 O                       TOTDKD              84
4136 O***
4137 O          T    LR U1 19            1  1
     O         AND  NU5N32N64                                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU6                                                                  AR547995
4138 O                                           28 'S/MINTN  -  RUN CONTROLS'
4139 O          T    LR U1 19               2
     O         AND  NU5N32N64                                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU6                                                                  AR547995
4140 O                                           11 '-------'
4141 O                                           28 '------------'
4142 O          T    LR U1 19               2
     O         AND  NU5N32N64                                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU6                                                                  AR547995
4143 O                                           28 'TOTAL RECORDS OUTPUT'
4144 O                       TNREC         3     59
4145 O          T    LR U1 19               2
     O         AND  NU5N32N64                                                               AR547995
     O         AND  N77N78N79                                                               AR547995
     O         AND  N80N85N86                                                               AR547995
     O         AND  N88NU6                                                                  AR547995
4146 O                                           29 'DETAIL RECORDS OUTPUT'
4147 O                       TNRECD        3     59
4148 O                       TOTTNI        Z     81
4149 O                       TOTTND              84
4150 O***
0746 O**********T    LR U7 U8            3                                           S01194 AR547995
0747 O**********                                 24 'REFERENCE DL0280AU'             S01194 AR547995
0749 O**********                                 61 'PRINT TERMINATED '              S01194 AR547995
     O**********T    LR U7 U8            2                                           S01194 AR547995
     O**********                                 57 'DATABASE ERROR'                 S01194 AR547995
     O**********             DBASE               61                                  S01194 AR547995
     O**********                                 67 'FILE'                           S01194 AR547995
     O**********             DBFILE              78                                  S01194 AR547995
     O**********T    LR U7 U8            1  3                                        S01194 AR547995
     O**********                                 49 'OPTION'                         S01194 AR547995
     O**********             DBOPTN              57                                  S01194 AR547995
     O**********                                 66 'KEY'                            S01194 AR547995
     O**********             DBKEY               96                                  S01194 AR547995
     O/COPY WNCPYSRC,DL0280OOP6                                           S01408
      *                                                                                       CAS005
     ODL0280P2  E            SMTITL           03 05
     O                                           24 'REFERENCE DL0280P2'
     O                       BJURPT              89
     O                                          104 'DATE'
     O                       BJMRDT             112
     O                                          122 'PAGE'
     O                       PAGE2         Z    127
     ODL0280P2  E            SMTITL              06
     O                                           54 'SUMMARISED ACCRUAL'
     O                                           68 'EVENTS REPORT'
     ODL0280P2  E            SMTITL              08
     O                                           55 '-------------------'
     O                                           68 '-------------'
     ODL0280P2  E            SMTITL              10
     O                                           12 'BRANCH'
     O                       BRCA                16
     O                       A8BRNM              48
     ODL0280P2  E            SMTITL              12
     O         OR    28
     O                                           39 'EVENT CURRENCY'
     O                                           60 'ACCOUNT KEY'
     O                                           81 'EVENT AMOUNT'
     ODL0280P2  E            SUMDET         1
     O                       KYCCY               34
     O                       AKY                 60
     O                       CLAS                64                                           CDL038
     O                  43   KYAMT         J     84
     O                  44   KYAMT               84 '   ,   ,   , 0 . -'
     O                  45   KYAMT               84 '  ,   ,   , 0 .  -'
     O                  46   KYAMT               84 ' ,   ,   , 0 .   -'
     ODL0280P2  E            TOTAKY      2  2
     O                                           56 'TOTAL ACCOUNT KEYS'
     O                                           66 'GENERATED'
     O                       RTOTAL              86
     ODL0280P2  E            ENDBRC         3
     O                                           62 '*** END OF REPORT FOR'
     O                                           73 'BRANCH ***'
     ODL0280P2  E            ENDRPT         2
     O                                           67 '*** END OF REPORT ***'
      *                                                                   S01378
      * *IN02 indicates DEALSDB record (foreign exchange)                 S01378
4157 ODEALSL1   D    02 15                                                      S01117
4160 O                       RECR                 1
4161 O                  51   LIPD               219P
4162 O                  51   DIPD               233P
4163 O                       SPPD               247P
4164 O                       ACEI               373
     O                       GCPCAP            1059P                            S01440
     O                       GCSCAP            1066P                            S01440
     O                       MGAM              1077P                            CAC001
     O                       MGCY              1080                             CAC001
     O                       ICPC              1158                             CAC001
     O                       REPI           B  1209                             CPB001
     O                       FSOYLC            1216
     O                       FSTYLC            1221
     O                       FSURPL            1228P
     O                       FSTUPL            1235P
     O                       FSPUPL            1242P
     O                       FSYUPL            1249P
     O                       FSEFUP            1270P
     O                       FSECUP            1277P
     O                       FSXFUP            1284P
     O                       FSXCUP            1291P
     O                       DSR1              1410                                           CSW212
     O                       DSR2              1445                                           CSW212
     O                       DSR3              1480                                           CSW212
     O                       DSR4              1515                                           CSW212
     O                       DSR5              1550                                           CSW212
     O                       DSR6              1585                                           CSW212
     O                       SSR1              1620                                           CSW212
     O                       SSR2              1655                                           CSW212
     O                       SSR3              1690                                           CSW212
     O                       SSR4              1725                                           CSW212
     O                       SSR5              1760                                           CSW212
     O                       SSR6              1795                                           CSW212
     O                       CND1              1830                                           CSW212
     O                       CND2              1865                                           CSW212
     O                       CND3              1900                                           CSW212
     O                       CND4              1935                                           CSW212
     O                       CND5              1970                                           CSW212
     O                       CND6              2005                                           CSW212
     O                       ISDA              2009                                           CSW212
     O                       AGTY              2015                                           CSW212
     O                       AGDT              2021                                           CSW212
     O                       AGVV              2023                                           CSW212
     O                       AGVC              2025                                           CSW212
      *                                                                   S01378
      ** *IN03 indicates DEALSDC record loans/deposits                    S01378
4165 ODEALSL1   D    03 15                                                      S01117
4168 O                       RECR                 1
4169 O                       PAMT                55P
     O**********     36      BRTT                64                                AR853123 MD023042
     O               36      BRTT                64S                                        MD023042
4170 O                       BRTE                70P
4171 O                       INTR                82P
4172 O                       RTSP                76P
     O/COPY WNCPYSRC,DL0280OOP3                                           S01408
4173 O                       IPFR               213
     O                       TOTI               220P                            E10430
4174 O                       NIDT               223P
4175 O                       IBDT               226P
4176 O                       SLID               229P
4177 O                       AIPD               236P
     O/COPY WNCPYSRC,DL0280O024
4178 O                       IACD               242P
4179 O                       AITC               249P
4180 O                       AIAN               256P
4181 O                       AIAP               263P
4182 O                       IPRD               270P
4183 O                       IPRM               277P
4184 O                       ICTD               284P
4185 O                       DAVD               296P
4186 O                       DASN               299
     O                       INTF               346
4187 O                       ZERO13             362P
4188 O                       ZERO13             369P
     O/COPY WNCPYSRC,DL0280O014
4189 O                     19TAXD               362P
     O/COPY WNCPYSRC,DL0280O015
4190 O                     19TAXM               369P
4191 O                       CNFI               372
4192 O                       ACEI               373
4193 O                       TLXI               374
     O                       DNACSG            1071                             S01383
     O                       FXRD              1153P                            S01486
     O                       FSRP              1160P                            CAC001
     O                       FSGN              1161                             CAC001
     O                       FPRC              1165                             CAC001
     O                       TCOF              1172P                            CAC001
     O                       ACPD              1179P                            CAC001
     O                       ACDA              1186P                            CAC001
     O                       ACAP              1193P                            CAC001
     O                       ACAN              1200P                            CAC001
     O                       COFD              1207P                            CAC001
     O                       COFM              1214P                            CAC001
     O                       CFCD              1221P                            CAC001
     O                       FCTD              1224P                            CAC001
     O                       FCMA              1268P                            CDL006
     O**********             FACTC             1475P                                CDL006 AR762808A
     O**********             FACPD             1482P                                CDL006 AR762808A
     O**********             FCPRD             1489P                                CDL006 AR762808A
     O                       FACTC             1555P                                       AR762808A
     O                       FACPD             1562P                                       AR762808A
     O                       FCPRD             1569P                                       AR762808A
     O                       REPI           B  1570                             CPB001
     O                       FSOYLC            1608
     O                       FSURPL            1615P
     O                       FSTUPL            1622P
     O                       FSPUPL            1629P
     O                       FSYUPL            1636P
     O                       FSEFUP            1643P
     O                       FSECUP            1650P
     O                       FSLQPR            1656P
     O                       FSLQPS            1657
     O                       FSAIPN            1664P
     O                       FSIPRN            1671P
     O                       FSAIAN            1678P
     O                       FSAITN            1685P
     O                       FSAINN            1692P
     O                       FSIPMN            1699P
     O                       FSICTN            1706P
     O                       FSTOTN            1713P
     O                       FSPAMT            1720P
     O                       MDAT                32P                                               B
     O                       PENA              1580P                                               B
     O                       FSCAND            1838P                                               B
     O                       FSPNPR            1839                                                B
     O                       XKRCDT            1853P                                        BUG11182
     O                       XKRCFR            1854                                         BUG11182
     O                       XKRCDM            1856                                         BUG11182
     O                       XKSTRF            1857                                         BUG11182
     O                       XKSTRT            1863P                                        BUG11182
     O                       XKAILC            1870P                                        BUG11182
     O                       XKACDA            1877P                                        BUG11182
     O                       XKSTVF            1878                                         BUG11182
     O                       XKBSVF            1879                                         BUG11182
     O                       XKFXDM            1881                                         BUG11182
     O                       XKINFD            1884P                                        BUG11182
     O                       XKINFF            1885                                         BUG11182
     O                       XKBSRF            1891P                                        BUG11182
     O                       XKFRCI            1892                                         BUG11182
     O                       XKFYLD            1897                                         BUG11182
     O                       EUTO              2020P                                          233324
     O                       EUTB              2027P                                          233324
     O                       EUTX              2034P                                          233324
     O                       EUCY              2037                                           233324
     O                       COLC              2039                                           233324
     O                       FSRRAT            2046P                                        AR762808
     O                       ISDT              2049P                                        AR762808
     O                       FMDT              2052P                                        AR762808
     O                       ORDN              2058                                         AR762808
     O                       STXO              2066P                                        AR762808
     O                       STXS              2074P                                        AR762808
     O                       STXT              2082P                                        AR762808
     O                       STXB              2090P                                        AR762808
     O                       TTXO              2098P                                        AR762808
     O                       TTXS              2106P                                        AR762808
     O                       TTXT              2114P                                        AR762808
     O                       TTXB              2122P                                        AR762808
     O**********             ISDT              2042                                BUG23926 BUG24989
     O**********             FMDT              2045                                BUG23926 BUG24989
     O**********             ISDT              2042P                               BUG24989 AR762808
     O**********             FMDT              2045P                               BUG24989 AR762808
     O**********             ORDN              2051                                BUG23926 AR762808
     O**********             STXO              2059                                BUG23926 BUG24989
     O**********             STXS              2067                                BUG23926 BUG24989
     O**********             STXT              2075                                BUG23926 BUG24989
     O**********             STXB              2083                                BUG23926 BUG24989
     O**********             STXO              2059P                               BUG24989 AR762808
     O**********             STXS              2067P                               BUG24989 AR762808
     O**********             STXT              2075P                               BUG24989 AR762808
     O**********             STXB              2083P                               BUG24989 AR762808
      *                                                                                       CDL012
     ODLTCSTPD  DADD 03 15 U4
     O                       GDLNO                6
     O                       GCUST               12
     O                       GCMCD               15
     O                       GBRCD               18
     O                       GDCCY               21
     O                       GNIDT               24P
     O                       GVDAT               27P
     O                       GMDAT               30P
     O                       GPCPL               37P
     O                       GDINT               44P
     O                       GINTR               50P
     O                       GEXCR               58P
      *                                                                                       CDL012
     O                       GDTYP               60
     O                       GORED               63P
     O                       GRBDN               69
     O                       GRBOR               72P
     O                       GROLI               73
      *                                                                   S01378
      ** *IN04 indicates DEALSDD record N/A's purchased                   S01378
4165 ODEALSL1   D    04 15                                                      S01117
4197 O                       RECR                 1
4198 O                       PAMT                55P
4199 O                       RTSP                76P
4200 O                       INTR                82P
     O                       FVAL               123P                            S01378
     O                       DISA               198P                            S01378
4201 O                       DPTD               211P
4202 O                       IPFR               213
     O                       TOTI               220P                                          222986
     O/COPY WNCPYSRC,DL0280O018
4203 O                       NIDT               223P
4204 O                       IBDT               226P
4205 O                       SLID               229P
4206 O                       AIPD               236P
4207 O                       DLRC               239P
4208 O                       IACD               242P
4209 O                       AITC               249P
4210 O                       AIAN               256P
4211 O                       AIAP               263P
4212 O                       IPRD               270P
4213 O                       IPRM               277P
4214 O                       DAVD               296P
4215 O                       DASN               299
     O                       INTF               346
     O                       PINT               354P
     O                       REPINT             354P
4216 O                       DNSI               370
4217 O                       CNFI               372
4218 O                       ACEI               373
4219 O                       TLXI               374
      *                                                                   S01378
      ** Parcelled NA's have the following fields updated to reflect      S01378
      ** sold portions - No sold parcels (reduced by sold parcels so      S01378
      ** ends up back at zero each day), Parcel size (reduced to show     S01378
      ** remaining parcel size), face value, purchase amount,             S01378
      ** discount/premium (reduced to show amounts of remaining asset)    S01378
      *                                                                   S01378
      ** Note that No. not sold, original purchase amount are NOT updated.S01378
     O                       PPSZ              1058P                            S01378
     O                       NSLD              1068P                            S01378
     O                       FSRP              1074P                            CAC001
     O                       FSGN              1075                             CAC001
     O                       FPRC              1079                             CAC001
     O                       TCOF              1086P                            CAC001
     O                       ACPD              1093P                            CAC001
     O                       ACDA              1100P                            CAC001
     O                       ACAP              1107P                            CAC001
     O                       ACAN              1114P                            CAC001
     O                       COFD              1121P                            CAC001
     O                       COFM              1128P                            CAC001
     O                       FSOYLC            1139
     O                       FSURPL            1146P
     O                       FSTUPL            1153P
     O                       FSPUPL            1160P
     O                       FSYUPL            1167P
     O                       FSEFUP            1174P
     O                       FSECUP            1181P
     O                       FSLQPR            1187P
     O                       FSLQPS            1188
     O                       FSAIPN            1195P
     O                       FSIPRN            1202P
     O                       FSAIAN            1209P
     O                       FSAITN            1216P
     O                       FSAINN            1223P
     O                       FSIPMN            1230P
     O                       FSTOTN            1237P
     O                       FSPINN            1244P
     O                       WWPINN            1244P
     O/COPY WNCPYSRC,DL0280O019
      *                                                                   S01378
      ** *IN05 indicates DEALSDE record N/A's sold                        S01378
4165 ODEALSL1   D    05 15                                                      S01117
4223 O                       RECR                 1
4224 O                       ACEI               373
     O*                                                                   S01119
     O*    DEALS FILE - DETAIL - FRA/IRS                                  S01119
     O*                                                                   S01119
4165 ODEALSL1   D    10 15                                                      S01117
     O                       RECR                 1                             S01119
     O/COPY WNCPYSRC,DL0280O002
     O                       UPAMT               63P                            CIR001
     O/COPY WNCPYSRC,DL0280O003
     O                       USTRT               71P                            S01119
     O                       UBRTE               77P                            S01119
     O                       URTSP               83P                            S01119
     O                       UEINR               90P                            S01119
     O                       UFRFD               93                             S01119
     O                       UINFD               96P                            S01119
     O                       USLIP               99P                            S01119
     O                       UNICD              102P                            S01119
     O                       UICBD              105P                            S01119
     O                       UICFR              106                             S01119
     O                       UICFD              108                             S01119
     O                       UNIPD              111P                            S01119
     O                       UIPBD              114P                            S01119
     O                       UIPFR              115                             S01119
     O                       UIPFD              117                             S01119
     O                       UIACD              127P                            S01119
     O                       UIALC              134P                            S01119
     O                       UAITC              141P                            S01119
     O                       UAIPD              148P                            S01119
     O                       UAIAN              155P                            S01119
     O                       UAIAP              162P                            S01119
     O                       UIPRD              169P                            S01119
     O                       UIPRM              176P                            S01119
     O                       UNSAM              183P                            S01119
     O                       UTAXD              190P                            S01119
     O                       UTAXM              197P                            S01119
     O/COPY WNCPYSRC,DL0280O004
     O                       TPAMT              207P                            CIR001
     O/COPY WNCPYSRC,DL0280O005
     O                       TSTRT              215P                            S01119
     O                       TBRTE              221P                            S01119
     O                       TRTSP              227P                            S01119
     O                       TSPIN              228                             S01119
     O                       TEINR              234P                            S01119
     O                       TFRFD              237                             S01119
     O                       TINFD              240P                            S01119
     O                       TSLIP              243P                            S01119
     O                       TNICD              246P                            S01119
     O                       TICBD              249P                            S01119
     O                       TICFR              250                             S01119
     O                       TICFD              252                             S01119
     O                       TNIPD              255P                            S01119
     O                       TIPBD              258P                            S01119
     O                       TIPFR              259                             S01119
     O                       TIPFD              261                             S01119
     O                       TIACD              271P                            S01119
     O                       TIALC              278P                            S01119
     O                       TAITC              285P                            S01119
     O                       TAIPD              292P                            S01119
     O                       TAIAN              299P                            S01119
     O                       TAIAP              306P                            S01119
     O                       TIPRD              313P                            S01119
     O                       TIPRM              320P                            S01119
     O                       TNSAM              327P                            S01119
     O                       TTAXD              334P                            S01119
     O                       TTAXM              341P                            S01119
     O                       AVPER              355P                            S01119
     O                       TIRAT              363P                            S01119
     O                       AACRT              369P                            S01119
     O                       SDCAR              465P                            S01119
     O                       ULPCD              468P                            S01119
     O                       TLPCD              471P                            S01119
     O                       UAEXA              478P                            S01119
     O                       TAEXA              485P                            S01119
     O                       UNRL               493P                            S01328
     O                       UNRLP              501P                            S01328
     O                       UDNSI              570                             S01119
     O                       TDNSI              571                             S01119
     O                       UDSTI              572                             S01119
     O                       TDSTI              573                             S01119
     O                       CNFI               574                             S01119
     O                       ACEI               575                             S01119
     O                       TLXI               576                             S01119
     O                       SETF               577                             AUS021
     O                       UNPCD              619P                            CIR001
     O                       TNPCD              623P                            CIR001
     O                       UPAD               641P                            CIR001
     O                       OUSI               663P                            CIR002
     O                       OUSA               671P                            CIR002
     O                       TUSI               679P                            CIR002
     O                       TUSA               687P                            CIR002
     O                       URFIN              688                             CSW005
     O                       TRFIN              689                             CSW005
     O                       UOBRT              695P                            CSW005
     O                       TOBRT              701P                            CSW005
     O                       PLULRC            2056P                            171698
     O                       PLTLRC            2059P                            171698
     O                       CCYPY1            2092                             CIR005
     O                       L1PDCN            2094                             CIR005
     O                       L1AMCN            2096                             CIR005
     O                       CCYRT1            2126                             CIR005
     O                       CCYPY2            2156                             CIR005
     O                       L2PDCN            2158                             CIR005
     O                       L2AMCN            2160                             CIR005
     O                       CCYRT2            2190                             CIR005
     O                       FSOYLC            2195
     O                       FSTYLC            2200
     O                       FIUSRI            2210
     O                       FIDSTS            2211
     O                       FIAUTH            2212
     O**********               FSEFUP  2219                                           CAS004 BUG4018
     O**********               FSECUP  2226                                           CAS004 BUG4018
     O**********               FSXFUP  2233                                           CAS004 BUG4018
     O**********               FSXCUP  2240                                           CAS004 BUG4018
     O                       FSEFUP            2219P                                               B
     O                       FSECUP            2226P                                               B
     O                       FSXFUP            2233P                                               B
     O                       FSXCUP            2240P                                               B
     O                       FSTRUP            2247P
     O                       FSUIPB            2254P
     O                       FSUPRB            2261P
     O                       FSUIAB            2268P
     O                       FSUALB            2275P
     O                       FSUITB            2282P
     O                       FSUINB            2289P
     O                       FSUPMB            2296P
     O                       FSUSAB            2303P
     O                       FSUPAM            2310P
     O                       FSUURL            2318P
     O                       FSUURP            2326P
     O                       FSTIPB            2333P
     O                       FSTPRB            2340P
     O                       FSTIAB            2347P
     O                       FSTALB            2354P
     O                       FSTITB            2361P
     O                       FSTINB            2368P
     O                       FSTPMB            2375P
     O                       FSTSAB            2382P
     O                       FSTPAM            2389P
     O                       FSTURL            2397P
     O                       FSTURP            2405P
     O                       FSTFUP            2412P
     O                       FSTCUP            2419P
     O                       FSUEFR            2425P
     O                       FSTEFR            2431P
     O                       FSOFYC            2436
     O                       FSTFYC            2441
     O                       FSRKVL            2447P
     O                       FSRKSN            2448
     O                       FIUSRA            2458
     O                       FIUSRX            2468
     O                       FSOFCC            2545                                           CAS008
     O                       FSTFCC            2550                                           CAS008
4225 O*
4165 ODEALSL1   D    06 15                                                      S01117
4229 O                       NORD                19P                            S01093
4230 O                       TOTNDL              25P
4231 O                       ZERO5               28P
4232 O                       ZERO5               31P
4233 O                       TOTNDL              34P
4234 O                       TOTIL               42P
4235 O                       TOTDL               44P
4236 O                       ZERO15              52P
4237 O                       ZERO3               54P
4238 O                       ZERO15              62P
4239 O                       ZERO3               64P
4240 O                       TOTIL               72P
4241 O                       TOTDL               74P
4242 O                       ZERO5              396P
4243 O                                          397 ' '
4244 O                       ZERO5              400P
4245 O*
4246 O**    NEW INTEREST PAYMENTS FILE
4247 OMINTNMH   EADD 40N70N20
4248 O         AND   U1 19
     O         AND  N10                                                         S01119
4249 O                                            1 'H'
4250 O                                           19 '64'
4251 O*
4252 OMINTNMD   EADD 20
4253 O                                            1 'D'
     O                       TAXIM                2                             122828
4255 O                       DTYP                 4
4256 O                       CNUM                10
4257 O                       DLNO                16
4258 O                       TXMN                19
4259 O                       INTR                25P
4307 O                  10   FINTR               25P                            S01119
4260 O                       WORKD               32P
4261 O                       PAMT                39P
4261 O               10      UPAMT               39P                            S01119
4262 O                       SLIDD               42P
4263 O                       KYDAT               45P
4264 O                       TAXA                52P
     O/COPY WNCPYSRC,DL0280O016
4265 O                  47                       53 'R'
4266 O                 N47                       53 ' '
4267 O                       PCCY                56
4268 O                       BRCA                59                             S01117
4269 O*
4270 OMINTNMT   TADD LR U1 19
4271 O                                            1 'T'
4272 O                       TNREC               19P
4273 O                       TNRECD              22P
4274 O                       TOTTNI              30P
4275 O                       TOTTND              32P
4276 O*
4277 O***DKEYSHH   EADD 40N70N20                                                              237793
     O*********AND  N10                                                                S01119 237793
     ODKEYSHH   TADD LR                                                                       237793
     O/COPY WNCPYSRC,DL0280O020
4278 O                                            1 'H'
4279 O*
4280 ODKEYSDP   EADD 70
4281 O                                            1 'D'
4282 O                       AKY                 11
4283 O                       DTYP                 3
4284 O                       DLNO                17
4285 O                       CNUM                23
4286 O                       BRCA                26                             S01117
4287 O                       ACSQ                28
4288 O                  39                       28 '01'
4289 O                       KYDAT               31P
4290 O                       KYAMT               38P
4291 O                       KYCCY               41
4292 O                       KYSETL              43
4293 O**********               KYOSTL    55                                                   CGL029
4294 O                 N47                       56 '0'
4295 O                  47                       56 '1'
     O                       KYOSTL             350
     O/COPY WNCPYSRC,DL0280O021
4296 O                       KYOTH          B    63P
4297 O                       KYOCCY         B    66
4298 O                  02   EXRT                73P
4299 O               02 30   ZERO13              73P
     O                 N02   ZERO13              73P
4301 O                       VDAT                76P
4302 O                 N02   SLID                79P
4303 O                 N02   MDAT                82P
4304 O                 N02   BRTT                84
     O/COPY WNCPYSRC,DL0280O022
4305 O                 N02   BRTE                90P
4306 O                 N02   RTSP                96P
4307 O                 N02N10INTR               102P                            S01119
4307 O                  10   FINTR              102P                            S01119
4308 O                  02 51ICIR               102P
4309 O                       KYFED              105P
4310 O                       YRAT               111P
     O               04 28   INTR               111P
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0280OOP2                                           S01408
     O*                                                                   S01408
     O**********        03   CHNA               118P                                   S05452 CSD027
     O                  03   CHNAX              118                                           CSD027
     O**********       N03   ZERO6              118P                                   S05452 CSD027
     O                  05   BLNK10             128                             S05452
     O                 N05   FACOA              128                             S05452
     O                       OPPRFC             132                             S01117
     O                       KYSTBR             135                             S01117
     O                       BOKC               137                             S01182
     O/COPY WNCPYSRC,DL0280O008
     O                       RBDN               143                             080603
     O              N04N05N10RBDN               143                             126244
     O/COPY WNCPYSRC,DL0280O009
     O                  02   PTFR               147                             085808
     O                  03   PTFR               147                             085808
     O                  04                      147 '    '                      085808
     O                  05                      147 '    '                      085808
     O                  10                      147 '    '                      085808
     O                       KYSCY              150                             CEU003
     O                       @RTFC              153                             CEU015
     O                       F1FFLG             154
     O                       F1FVAL             161P
     O                       F1FPCT             166
     O                       F1RACT             186
     O                       F1RCTY             188
     O                       F1RBNK             208
     O                       F1RCDE             219
     O                       F1PACT             239
     O                       F1PCTY             241
     O                       F1PBNK             261
     O                       F1PCDE             272
     O                       F1DACT             307
     O                       F1DCTY             309
     O                       F1DBNK             329
     O                       F1SDAT             332P
     O*********         03   CHNA               356                                  CSD027 BUG12781
     O*********        N03   BLNK6              356                                  CSD027 BUG12781
     O                       AKY                360                                           CDL038
     O                       DTYP               352                                           CDL038
     O*********              CLAS               364                                    CDL038 CSD027
     O*********              CLAS               370                                  CSD027 BUG12781
     O                       CLAS               364                                         BUG12781
     O                  03   CHNA               370                                         BUG12781
     O                 N03   BLNK6              370                                         BUG12781
4311 ODKEYSZZ   TADD LR
4312 O                                            1 'Z'
4313 O                       DKREC                6
4314 O                       TOTDKI              14P
4315 O                       TOTDKD              16P
     ODKEYSDP   EADD         DKYOUT
     O                                            1 'D'
     O                       AKY                 11
     O                       DTYP                 3
     O                       DLNO                17
     O                       CNUM                23
     O                       BRCA                26
     O                                           28 '01'
     O                       KYDAT               31P
     O                       KYAMT               38P
     O                       KYCCY               41
     O                                           43 '00'
     O                                           56 '0'
     O                       ZERO13         B    63P
     O                       ZERO13              73P
     O                       KYDAT               76P
     O                       ZERO5               79P
     O                       ZERO5               82P
     O                                           84 '00'
     O                       ZER117              90P
     O                       ZER117              96P
     O                       ZER117             102P
     O                       ZERO5              105P
     O                       ZER117             111P
     O                       ZERO6              118P
     O                       BLNK10             128
     O                       BOKC               137
     O                       ZERO6              143
     O                       AKY                360                                           CDL038
     O                       DTYP               352                                           CDL038
     O                       CLAS               364                                           CDL038
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0280OOP7                                           S01408
     O*                                                                   S01408
     ODLBHISPD  EADD         DLBHIS                                             S01444
     O**********               UBDATA  1249                                            CAS001 CAS005
     O**********             UBDATA            1291                                           CDL038
     O**********             UBDATA            1367                                  CDL038 BUG25189
     O**********             UBDATA            1368                                  BUG25189 CSW212
     O                       UBDATA            2025                                           CSW212
     O                       LCD                396P                            S01444
     O*                                                                   S01444
     ODLCHISPD  EADD         DLCHIS                                             S01444
     O**********               UCDATA  1636                                            CAS001 CAS005
     O**********             UCDATA            1720                                           CDL038
     O**********             UCDATA            1901                                    CDL038 CAS009
     O**********             UCDATA            2013                                    CAS009 233324
     O**********             UCDATA            2039                                  233324 BUG24989
     O**********             UCDATA            2083                                BUG24989 AR782597
     O**********             UCDATA            2090                                  AR782597 CRE073
     O                       UCDATA            2139                                           CRE073
     O                       LCD                396P                            S01444
     O*                                                                   S01444
     ODLDHISPD  EADD         DLDHIS                                             S01444
     O**********               UDDATA  1167                                            CAS001 CAS005
     O**********             UDDATA            1244                                           CDL038
     O**********             UDDATA            1320                                    CDL038 CAS009
     O**********             UDDATA            1432                                  CAS009 AR782597
     O                       UDDATA            1445                                         AR782597
     O                       LCD                396P                            S01444
     O*                                                                   S01444
     ODLEHISPD  EADD         DLEHIS                                             S01444
     O**********             UEDATA            1047                                    CEU003 CDL038
     O                       UEDATA            1105                                           CDL038
     O                       LCD                396P                            S01444
     O*                                                                   S01444
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0280OOP8                                           S01408
     O*                                                                   S01408
     ODLGHISPD  EADD         DLGHIS                                             S01444
     O**********               UGDATA  2212                                            CAP056 CAS005
     O**********               UGDATA  2441                                            CAS005 CAS006
     O**********               UGDATA  2448                                            CAS006 217684
     O**********             UGDATA            2468                                    217684 CAS008
     O**********             UGDATA            2550                                    CAS008 CDL038
     O                       UGDATA            2606                                           CDL038
     O                       LCD                596P                            S01444
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0280OOP1                                           S01408
     O*                                                                   S01408
** BBE - ADDITIONAL EVENT TYPES                                                               CDL099
SALE VALUE                                                                                    CDL099
PURCH. VALUE                                                                                  CDL099
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** NEV - EVENT NARRATIVES
DEAL DATE
VALUE DATE
INTEREST DATE
MATURITY DATE
SALE DATE
ACCRUAL DATE
REVERSAL
PRINC INCR                                                                CIR001
PRINC DECR                                                                CIR001
BUY-OUT DATE                                                              CIR001
FEE DATE                                                                  CIR001
PREMIUM DATE                                                              CIR001
     X/COPY WNCPYSRC,DL0280X003
** FRQ - FREQUENCIES REQUIRING NON-WORKING DAY CHECK
FLRSW
** @DTP  ARRAY OF POSSIBLE MIDAS DEAL TYPES   BHF641 LN0854 S01354 089998 CDL006
ITIPTDTICILNCDCLDLC1C2BPBDRSRXFRRPRRRFILIDTBDATAFLDPLPFTDTLTCF
** POWERS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
     X/COPY WNCPYSRC,DL0280X001
** ACR - AKEY Elements that identify dealing accruals                                         CAS005
PH                                                                                            CAS005
LL                                                                                            CAS005
AA                                                                                            CAS005
AI                                                                                            CAS005
AD                                                                                            CAS005
AC                                                                                            CAS005
AP                                                                                            CAS005
AL                                                                                            CAS005
