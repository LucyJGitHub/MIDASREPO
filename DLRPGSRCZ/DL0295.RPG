0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Generate accounting entries')                 *
0002 F*****************************************************************
0004 F*                                                               *
     F*  Midas - Dealing Module
0004 F*                                                               *
0005 F*  DL0295 - DEAL GENERATED A/C OR RETAIL SHADOW POSTINGS        *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. 258482             Date 01Jun20               *
      *  Prev Amend No. 248968             Date 01Jun20               *
      *                 MD053762           Date 16Jun19               *
      *                 MD049950           Date 08Mar18               *
      *                 MD048795           Date 30Jan18               *
      *                 MD048346           Date 20Dec17               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD034609           Date 29Oct15               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 01Sep14               *
      *                 MD023685           Date 21Nov13               *
      *                 MD026977           Date 23May14               *
      *                 CRE098             Date 02Dec13               *
      *                 MD020384           Date 14May13               *
      *                 AR813358A          Date 18Dec12               *
      *                 AR813358           Date 18Dec12               *
      *                 AR784704A          Date 04Oct11               *
      *                 CER049             Date 06Dec10               *
      *                 AR784704           Date 16Jun11               *
      *                 AR671726           Date 11Nov10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG25189           Date 27Jul09               *
      *                 CER030             Date 09Jul08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CDL081             Date 14Dec09               *
      *                 BUG26705           Date 09Nov09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 237485             Date 13Jul07               *
      *                 246505             Date 20Jun07               *
      *                 246620             Date 03May07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 243930             Date 28Nov06               *
      *                 243929             Date 28Nov06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 211436             Date 18Sep06               *
      *                 CGL075             Date 16Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CDL046             Date 30Jan06               *
      *                 CDL049             Date 05Jul06               *
      *                 222171             Date 06Jun06               *
      *                 237485             Date 25May06               *
      *                 239550             Date 11May06               *
      *                 237509             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 233546             Date 18May05               *
      *                 232543             Date 16Mar05               *
      *                 CDL038             Date 10May05               *
      *                 CDL033             Date 10Feb05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 BUG5921            Date 22Mar05               *
      *                 220738             Date 28Aug03               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CRE019             Date 12Jan04               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 CGL020             Date 08Nov02               *
      *                 CRE009             Date 27Aug02               *
      *                 149507             Date 27Aug02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 175219             Date 15Apr02               *
      *                 149954             Date 11Feb02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CPB005             Date 09May02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 192836             Date 28Jun01               *
      *                 151104             Date 14Jun01               *
      *                 189681             Date 17Apr01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 188100             Date 03Apr01               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01Mar99               *
      *                 136321             Date 30Apr99               *
      *                 CTI002             Date 23Sep98               *
      *                 S01408             Date 08Oct98               *
      *                 135074             Date 08Oct98               *
     F*                 145264             Date 21Aug98               *
     F*                 138465             Date 21Aug98               *
     F*                 CEU015             Date 19Jun98               *
     F*                 135224             Date 14May98               *
     F*                 134907             Date 08May98               *
     F*                 133868             Date 23APR98               *
     F*                 CEU003             DATE 28MAR98               *  *
     F*                 123584             DATE 03MAR98               *  *
     F*                 S01408             DATE 28JAN98               *  *
     F*                 097486             DATE 23JAN98               *  *
     F*                 126428             DATE 05JAN98               *
     F*                 109002             DATE 05JAN98               *
     F*                 097278             DATE 08DEC97               *
     F*                 117028             DATE 22NOV97               *
     F*                 125828             DATE 11NOV97               *
     F*                 CDL002             DATE 01MAY97               *
     F*                 105333             DATE 06MAR97               *
     F*                 109482             DATE 25FEB97               *
     F*                 105222             DATE 17FEB97               *
     F*                 097379             DATE 12FEB97               *
     F*                 105140             DATE 18NOV96               *
     F*                 S01408             DATE 28OCT96               *
     F*                 S01408             DATE 04OCT96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 102171             DATE 01JUL96               *
     F*                 S01408             DATE 18JUN96               *
     F*                 S01408             DATE 28MAY96               *
     F*                 S01408             DATE 06MAR96               *
     F*                 S01408             DATE 08JAN96               *
     F*                 095476             DATE 06NOV95               *
     F*                 S01408             DATE 16OCT95               *
     F*                 087870             DATE 19MAY95               *
     F*                 081936             DATE 27APR95               *
     F*                 S01408             DATE 04MAY95               *
     F*                 086125             DATE 16MAR95               *
     F*                 084058             DATE 01MAR95               *
     F*                 083906             DATE 27FEB95               *
     F*                 S01522             DATE 25JAN95               *
     F*                 080603             DATE 12JAN95               *
     F*                 S01408             DATE 20FEB95               *
     F*                 074141             DATE  9AUG94               *
     F*                 047803             DATE 19JAN94               *
     F*                 S01460             DATE 22NOV93               *
     F*                 S01434             DATE 06AUG93               *
     F*                 039248             DATE 23APR93               *
     F*                 050169             DATE 18MAR93               *
     F*                 051153             DATE 18MAR93               *
     F*                 048941             DATE 18MAR93               *
     F*                 047225             DATE 01FEB93               *
     F*                 S10736             DATE 07SEP92               *
     F*                 AUS007             DATE 13JUN92               *
     F*                 E38199             DATE 07APR92               *
     F*                 E36918             DATE 10MAR92               *
     F*                 S01354             DATE 08JAN92               *
     F*                 E28679             DATE 18SEP91               *
     F*                 E26739             DATE 01AUG91               *
     F*                 E26579             DATE 25JUL91               *
     F*                 E26578             DATE 25JUL91               *
     F*                 E24720             DATE 09JUL91               *
     F*                 E25203             DATE 02JUL91               *
     F*                 RT0086             DATE 21MAY91               *
     F*                 BHF879             DATE 30OCT90               *
     F*                 DT0001             DATE 14MAR91               *
     F*                 E18407             DATE 27JUL90               *
     F*                 E16457             DATE 25MAY90               *
     F*                 S01255             DATE 16FEB90               *
     F*                 S01238             DATE 12JAN90               *
     F*                 S01182             DATE 10/10/88              *
     F*                 LN0764             DATE 18SEP90               *
     F*                 BHF043             DATE 10MAY90               *
     F*                 BHF042             DATE 10MAY90               *
     F*                 LN0363             DATE 13JUN90               *
     F*                 LN0343             DATE 08JUN90               *
     F*                 LN0121             DATE 08MAY90               *
     F*                 LN0109             DATE 03MAY90               *
     F*                 LN0101             DATE 03MAY90               *
     F*                 E19921             DATE 27NOV89               *
     F*                 E299               DATE 23MAR90               *
     F*                 E239               DATE 26FEB90               *
     F*                 E00018             DATE 03/11/89              *
     F*                 E16486             DATE 23/10/89              *
0010 F*                 S01194             DATE 14/03/89              *
0010 F*                 S01117             DATE 14/03/89              *
     F*                 E12064             DATE 06/09/88              *
     F*                 E11609             DATE 15/10/87              *
0010 F*                 S05452             DATE 20/08/87              *
0010 F*                 E10367             DATE 03/03/87              *
0010 F*                 S01100             DATE 22/09/86              *
0010 F*                 S01103             DATE 22/09/86              *
0010 F*                 S01094             DATE 22/09/86              *
     F*                 E43407             DATE 13/06/86              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  258482 - Incorrect postings for withholding tax in foreign   *
      *           currency. Debit the tax from the settlement account *
      *           for tax account keys with posting reference '2' and *
      *           do not convert to Base Ccy. Applied fix 241675.     *      
      *  248968 - Make sure that field TRAT is being populated by the *
      *           correct value for TAX postings generated during     *
      *           interest and maturity events.                       *
      *         - Also, move '98100' to TRAT even if CPB005 is *OFF.  *
      *         - Applied fixes 232166 and reopened 232166.           *      
      *  MD053762 - Tiered Withholding Tax System Values              *
      *  MD049950 - No projection was created for FX deal with retail *
      *             settlement.  Check FX netting reference.          *
      *  MD048795 - Original Transasction Type is set to 'NT' when it *
      *            is a record generated from FXNACTPD (it is an FXnet*
      *            transaction). *IN08 is specified at I-spec FXNACTD0*
      *  MD048346 - (deals&fxnet) FX Netting ICD Posting branch to use*
      *             (1) system value FXnetBranch; when blank,         *
      *             (2) settlement branch of FX net; when blank,      *
      *             (3) default to customer branch of FX net.         *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  MD034609 - Witholding tax posted in local currency instead   *
      *             of transaction currency. Don't treat as TAX KEY   *
      *             if event code is I or M.                          *
      *  CGL165 - Dual Withholding Tax                                *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  MD023685 - Incorrect placement of deposits on customer       *
      *             accounts                                          *
      *  MD026977 - CDL002 (FX Netting): Narratives of net settlement *
      *             posting show useless ref (000000)                 *
      *  CRE098 - User-Defined Retail Transaction Types on Postings   *
      *  MD020384 - TRAT for internal accounts should be 00000        *
      *  AR813358A - Data mapping error on member EODPOPD, original   *
      *              fix is incomplete. Initialise fields ACODQQ LTAI *
      *              XRFN and TRAT also added these fields to all the *
      *              EXCP format for GEDLPD. Also apply CGL120 for    *
      *              ORAMT NITMS CHGA fields. (Child: AR813359A)      *
      *  AR813358 - Data mapping error on member EODPOPD, fix is to   *
      *             apply part of fix 133868 (TRAT initialization) to *
      *             other deal types. (Child: AR813359)               *
      *  AR784704A - Set off indicator 40                             *
      *  CER049 - Stamp Tax                                           *
      *  AR784704 - GLC30 failed because of zero account code         *
      *  AR671726 - DLC0606C 00001 failed  (Child: AR671727)          *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG25189 - MARG field on DLCHISPD contains invalid data after*
      *             the close of business                             *
      *  CER030 - Multicash German Feature                            *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (recompiled)                                        *
      *  CDL081 - Tiered withholding tax rounding upgrade             *
      *  BUG26705 - DLC0620 00001, Write operation on a closed file   *
      *             Apply fix 259642.                                 *
      *  237485 - Suspense posting should show original account no.   *
      *  246505 - Ensure settlement account is passed for checking    *
      *           before posting.
      *  246620 - Default value of primary funding profit centre to   *
      *           PRFC of fx netting transactions.                    *
      *  243930 - DB error in GL0600 due to Account Codes set to zero.*
      *           Use DSSDY to retrieve branch details.               *
      *  243929 - Add output for field CHQN to avoid key mapping      *
      *           error.                                              *
      *  211436 - Rolled over by deal nbr incorrectly output on       *
      *           narrative even though DLPNAR is off. 192836 coded   *
      *           incorrectly.                                        *
      *  CGL075 - Detailed Accrual Summary                            *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL046 - Generated Entries for Deal Type CI to post to       *
      *           customer.                                           *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  222171 - Incorrect posting entries generated when the inte-  *
      *           rest is settled separately and branch of the inte-  *
      *           rest settlement account differs from that of the    *
      *           deal.  Applied fixes 218093 and 218452.             *
      *  237485 - Suspense posting should show original account no.   *
      *  239550 - Generate interbranch posting for suspense account.  *
      *  237509 - Error in value dates of accruals. Use Accruals/     *
      *           Profit date instead of system rundate.              *
      *           Apply GEMS 212376.                                  *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  233546 - DLC0606C failed                                     *
      *  232543 - Fix for CGL031                                      *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  BUG5921- Trailer out of balance in GLC30 because posting     *
      *           amount for suspense account is not setup at all.   *
      *  220738 - Dump if customer closed                             *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CRE019 - Cheque Processing and Maintenance                   *
      *         - Initialise CHQN field to zero in GEDLPD             *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  CGL020 - Midas Compliance Watch - Additional A/C Postings    *
      *           Information                                         *
      *  CRE009 - Projected Account Movements for Retail Accounts     *
      *  149507 - Properly output branch code.                        *
      *         - Ensure that branch is defaulted correctly if it is  *
      *           blank. Ensure NTOSBR is cleared for each cycle.      *
     F*  175219 - If Rollover is from 'In' ccy to EUR then the amount *
     F*           needs to be converted. This was done for PREF1 but  *
     F*           not for PREF3. It is now.                           *
      *  149954 - Incomplete narrative for CEU003 entries.            *
      *  CPB005 - US Withholding Tax on Deposits generated during the *
      *           Midas COB + Midas/TOF Interface. Access the switch- *
      *           able feature file to see if CPB005 is on. If yes,   *
      *           before each "generate entry " posting               *
      *           (EXCPT GENENT), test the account key :              *
      *           If position 3 = "I" or "M", and position 10 = "T",  *
      *           move "98100" in transaction type (TRAT)             *
      *  192836 - Rolled over by deal nbr not output in narrative     *
      *           when UDC used and DLPNAR on                         *
      *  151104 - Increase size of branch code & related array so that*
      *           it can hold up to 900 elements.                     *
      *  189681 - Imbalance posting outputs the posting amount with   *
      *           incorrect field length.                             *
      *  188100 - Report DL0295 'Missing Account Keys Report'         *
      *           sometimes not generated for all branches.  Fix is   *
      *           to always generate report for all branches even if  *
      *           there are no details to report.                     *
      *  CGL007 - Account Postings Enquiry                            *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  136321 - Incorrect conversion of withholding tax from USD    *
      *           to ESP.                                             *
      *  CTI002 - Recompiled : File SDEXPMPD changed                  *
     F*  S01408 - Addition of missing hooks for OHARAP SYA            *
     F*           Addition of missing hook DL0295FOH1                 *
     F*           Addition of missing hook DL0295COH1                 *
     F*           Addition of missing hook DL0295COH2                 *
     F*  135074 - Applied fix 129594.                                 *
     F*           Overwritten posting narratives for rolled-over deal.*
     F*  145264 - EMU fix - If event currency is equal to local       *
     F*           currency, Spot Trade and Base Currency Equivalent   *
     F*           Accounts are not posted on  EMU-related postings    *
     F*           because the account code details (Q-affixed)        *
     F*           are not defined at change of currency.  The fix     *
     F*           is to use L-affixed  account code details instead.  *
     F*  138465 - EMU-related entries caused a FCOOB in Daily Journal *
     F*           after a mapping with a preserved retail account.    *
     F*  CEU015 - EMU Enhanced MM Deal Rollover                       *
     F*  135224 - EMU-related entries caused a FCOOB in Daily Journal *
     F*  134907 - Interbranch entries caused a FCOOB in Daily Journal *
     F*  133868 - CRTOT and DRTOT incorrectly updated, causing        *
     F*           incorrect branch/ccy imbalance record being to be   *
     F*           produced, causing daily journal to be out of balance*
     F*  CEU003 - EMU DL Settlement Currency Conversion:              *
     F*           Amended to generate new accounting entries to       *
     F*           GEDLPD if the account key uses posting reference    *
     F*           '2' and the settlement currency is not blank.       *
     F*           Core change to existing error - work fields         *
     F*           ACSCT,ACSCB and ACSCL incorrect size.               *
     F*  123584 - *IN66 is set to on if S01434 is on, nevertheless    *
     F*           narrative code 18/19 is not always used for roll.
     F*           deals and this cause an error in RE0782 as the deal *
     F*           number is not at the right place in the PNAR        *
     F*  S01408 - Addition of core hook DL0295CP20                    *
     F*  097486 - Nostro Account Holder Cust Nbr not saved for 'CI'   *
     F*           deals, causing database error in GL1300 in COB.     *
     F*  126428 - Entry settling through retail account posted to     *
     F*           suspense because settlement branch blank. In this   *
     F*           case use account branch as settlement branch if     *
     F*           the retail account exists and branch code is not    *
     F*           same as either the input settlement branch or the   *
     F*           deal booking branch                                 *
     F*  109002 - Currency out of balance in GL0340 due to posting to *
     F*           suspense account with wrong branch. If posting      *
     F*           cannot be made to an account (e.g. if account is    *
     F*           blocked), amount should be posted to the suspense   *
     F*           account of the settlement branch.                   *
     F*  097278 - Missing account keys report does not show when the  *
     F*           key has a negative amount as when used to reverse   *
     F*           out a previous set of postings.                     *
     F*  117028 - Reverse out the BRT changes made by fix 080603. This*
     F*           fix is wrong and corrupts the BRT enhancements made *
     F*           to DL0280.                                          *
     F*  125828 - Change "SUM MARY" to "SUMMARY"                      *
     F*  CDL002 - FX Netting                                          *
     F*  105333 - Correct user defined posting narratives:            *
     F*            o Rolled-over-by-deal-number should not always be  *
     F*              set up.  Add further check to see if UDC switched*
     F*              on or narrative code is 18 or 19                 *
     F*  109482 - Correction of 102171. Negative posting amount on    *
     F*           other than accrual summary posting: FOOB in GL0340  *
     F*  105222 - Deal/Loan ref in suspens account posting are wrong. *
     F*  097379 - NARRATIVE CODE 24 OUTPUT INTEREST DATE IN WRONG POS.*
     F*  105140 - Apply 092935, applied with new GEMS reference.      *
     F*           If the file SDKEY is empty do not write out a       *
     F*           spurious IMBALANCE record to GEDLPD. This is        *
     F*           achieved by clearing all numeric fields defined in  *
     F*           datastructures within the *INZSR. Additionally the  *
     F*           header record was not being written out to GEDLHH i *
     F*           SDKEY was empty, this has been changed to an EXCPT  *
     F*           which is issued at the end of *INZSR.               *
     F*  S01408 - Addition of core hook DL0295CP19                    *
     F*  S01408 - Addition of core hook DL0295CP18                    *
     F*         - Addition of core hook DL0295CP17                    *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           The transaction profit centre of any posting to a   *
     F*           retail or nostro account will be changed to the     *
     F*           profit centre of that account.  For interbranch     *
     F*           postings the Primary Funding Centre defined in the  *
     F*           PCA ICD will be used as the profit centre.          *
     F*  102171 - Generated entries UP & UL do not always have the    *
     F*           correct sign in DL0295P1 but accounting is correct  *
     F*  S01408 - Addition of core hook DL0295IIP3                    *
     F*           Addition of core hook DL0295IIP4                    *
     F*           Addition of core hook DL0295CP15                    *
     F*           Addition of core hook DL0295CP16                    *
     F*           Addition of core hook DL0295OOP9                    *
     F*  S01408 - Addition of core hook DL0295IIP2                    *
     F*           Addition of core hook DL0295CP14                    *
     F*  S01408 - Addition of core hook DL0295CP12                    *
     F*           Addition of core hook DL0295CP13                    *
     F*  S01408 - Addition of core hook DL0295FFP3                    *
     F*           Addition of core hook DL0295CP10                    *
     F*           Addition of core hook DL0295CP11                    *
     F*           Addition of core hook DL0295OOP8                    *
     F*  095476 - Correct narrative if UDC switched off, deal number  *
     F*           missing.                                            *
     F*         - Dealing imbalance and suspense should be reset      *
     F*           instead of cleared.                                 *
     F*  S01408 - Addition of core hook DL0295EEP1                    *
     F*           Addition of core hook DL0295IIP1                    *
     F*           Addition of core hook DL0295CCP7                    *
     F*           Addition of core hook DL0295CCP8                    *
     F*           Addition of core hook DL0295CCP9                    *
     F*           Addition of core hook DL0295OOP6                    *
     F*           Addition of core hook DL0295OOP7                    *
     F*  087870 - Correct user defined posting narratives:            *
     F*            o Rolled-over-by-deal-number not set up. Dodgy     *
     F*              comment implies *IN67 = rollover, when in        *
     F*              fact it is nothing of the sort.                  *
     F*            o Due-date not set up (except in instances where   *
     F*              two dates appear in the narrative).              *
     F*  081936 - Incorrect hash totalling for internal deals.        *
     F*  S01408 - Addition of core hook DL0295OOPG                    *
     F*           Addition of core hook DL0295OOP1                    *
     F*           Addition of core hook DL0295OOP2                    *
     F*           Addition of core hook DL0295OOP3                    *
     F*           Addition of core hook DL0295OOP4                    *
     F*           Addition of core hook DL0295OOP5                    *
     F*           Addition of core hook DL0295IIPG                    *
     F*           Addition of core hook DL0295FFP1                    *
     F*           Addition of core hook DL0295FFP2                    *
     F*           Addition of core hook DL0295CCP1                    *
     F*           Addition of core hook DL0295CCP2                    *
     F*           Addition of core hook DL0295CCP3                    *
     F*           Addition of core hook DL0295CCP4                    *
     F*           Addition of core hook DL0295CCP5                    *
     F*           Addition of core hook DL0295CCP6                    *
     F*  086125 - Add new parameter to AOPNARR0                       *
     F*  084058 - Ensure Posting narratives for reversals end with '*'*
     F*  083906 - Correct Message IDs for S01522                      *
     F*  S01522 - Call to AOPNARR0 if switchable feature installed    *
     F*           and UDC present                                     *
     F*  080603 - Generate BRT same as S01460 Withholding Tax Feature *
     F*           and rationalise/ Correct S01460 to post in Lccy     *
     F*  S01408 - Addition of core hook DL0295CCPG                    *
     F*           Addition of core hook DL0295FFPG                    *
     F*  074141 - DBERR 013 used twice.                               *
     F*  047803 - Wrong SWIFT Ref on postings due to sloppy fixes     *
     F*           E24720 & E28679.                                    *
     F*  S01460 - To allow the Withholding Tax A/C keys to be         *
     F*           produced.                                           *
     F*  S01434 - Enhanced Rollover Processing                        *
     F*  050169 - DL0295P2 should not duplicate the last missing      *
     F*           A/C key if the last record read on DKEYSDP and      *
     F*           BRKEYDP is a missing A/C key.  'END OF BRANCH       *
     F*           REPORT' must also be shown on DL0295 reports        *
     F*           if there's a change in branch read and at the       *
     F*           same time the first record in BRKEYDP was read      *
     F*  051153 - DL0295P1 should not supress leading zeros for       *
     F*           deal numbers.                                       *
     F*  048941 - Print 'END OF REPORT' in DL0295P1 after last        *
     F*           branch if multibranching.                           *
     F*  047225 - CONDITION CALL TO AORETLR0 ON RETAIL BEING PRESENT  *
     F*  S10736 - MANAGEMENT ACCOUNTING                               *
     F*  AUS007 - AUSTRALIAN BROKERAGE.                               *
     F*  E38199 - Balancing item not generated for Internal Deal      *
     F*  E36918 - Accrual Summary Posting has wrong BRCA Customer     *
     F*  S01354 - Internal Funding Deals                              *
     F*  E28679 - E24720 was installed because Memos said it was      *
     F*           complete; it is not, and causes problems, so it     *
     F*           must be removed.                                    *
     F*  E26739 - Fix to E26578 - Codes to search for in ACR are      *
     F*           actually AP and AL.                                 *
     F*  E26579 - Entries generated for missing A/c Keys              *
     F*  E26578 - Allow Accrual Key Summary for UP and UL             *
     F*           Account Keys (associated with S01328).              *
     F*  E24720 - Build up Swift common referance using counter       *
     F*           party. DEALS is now overridden to a copy            *
     F*  SP0833 - In the case of a reversal entry on file GEDLPD      *
     F*           extra codes are now included with the update of     *
     F*           field RVDL to show the reversal entries RC & RD     *
     F*  RT0086 - DO NOT PRINT 'END OF REPORT'.                       *
     F*  BHF879 - MOVING A6SPAE(SPOT TRADE EQ ACCT) INTO ARRAY        *
     F*           CCYA (CURRENCY ARRAY WHICH IS USED FOR CCY          *
     F*           LOKUP.                                              *
     F*  DT0001 - Dealing Release 10 Re-test error fix:               *
     F*           If a database error had occurred, program was       *
     F*           attempting to write to DL0295P2; this file had      *
     F*           not been opened because there were no records       *
     F*           in SDKEY.  Fix E00018 had remioved indicator 71     *
     F*           from conditioning the output to both this file      *
     F*           and DL0295P1.  Indicator 52 is currently set on     *
     F*           if the files have been opened, so this is now       *
     F*           used to condition output.                           *
     F*  E18407 - IF AN ACCOUNT IS BLOCKED, DIRECT ALL ENTRIES        *
     F*           TO SUSPENSE ACCOUNT.                                *
     F*  E16457 - OUTPUT RUNDATE NOT DATE OF NEXT WORKING DAY         *
     F*           ON SHADOW POSTING RUN.                              *
     F*  S01255 - MIS 1 BD ENHANCEMENTS                               *
     F*  S01238 - MIS INCORPORATION CHANGES                           *
     F*  S01182 - Maintain new account posting fields on              *
     F*           generated entries LF/GEDLPD for MIS.                *
     F*  LN0764 - SEQUENCE SHOULD NOT BE *BLANKS                      *
     F*  BHF043 - SHOULD BE AONOSTR0 WITH 12 PARAMETERS               *
     F*  BHF042 - ONLY USE CHNACH FOR AOCUSTR0 IF DEAL TYPE 'CI'      *
     F*  LN0363 -'END OF REPORT' NOT BEING WRITTEN FOR LAST           *
     F*           BRANCH REPORT                                       *
     F*  LN0343 - UNLOCK DATA AREA LDA TO ALLOCATE IT TO PROGRAM      *
     F*           ZSFILE (FOR 'AU' REPORTS)                           *
     F*  LN0121 - CHAIN FAIL IND NOT BEING SET OFF WHEN A/C KEY IS    *
     F*           MISSING.(CAUSES ERROR WHEN A/C KEY IS FOUND)        *
     F*  LN0109 - WRONG FIELD BEING USED TO CHECK A/C TYPE            *
     F*  LN0101 - LOCK DATA AREA LDA TO ALLOCATE IT TO PROGRAM        *
     F*           THIS PREVENTS ERROR WHEN 'OUT' IS USED.             *
     F*  E19921 - CODE INSERTED TO ENSURE REPORT HEADINGS ARE         *
     F*           PRINTED WHEN PRIMARY FILE (SDKEY) EMPTY.            *
     F*           SUPERCEEDED BY RELEASE 10 S01117                    *
     F*  E299   - 'AU' REPORT SHOULD NOT WRITE 'END OF REPORT'        *
     F*  E239   - WRITE TO UNOPENED P2 FILE WITH NO DETAILS ON FILE   *
     F*  E00018 - MANDATORY PROGRAM SO NO PARAMETERS PASSED -         *
     F*           AVOIDS DUMMY PARAMETERS BEING PASSED                *
     F*  E16486 - SDRAN SHOULD BE NUMERIC FOR CHAIN TO ACNUM          *
     F*  S01194 - NEW STANDING DATA - ADD ACCESS PROGRAMS             *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  E12064 - PASS CONSOLIDATED ACCRUAL POSTINGS ACROSS BICN      *
     F*           AND OUTPUT CORRECT A/C  SEQUENCE NUMBER             *
     F*  E11609 - Account codes on Keys file checked for              *
     F*           blanks and if found treated as zeros.               *
     F*           Causes D/B error on attempt to access Table         *
     F*           file for Key 0000 Account code .                    *
     F*  S05452 - INCLUSION OF AUTO RECONCILIATIONS.                  *
     F*  E10367 - ACCOUNT CAN BECOME INACTIVE EVEN IF DEAL            *
     F*           RECENTLY SETTLED ACCROSS IT                         *
     F*  S01100 - WRITE SUSPENSE ENTRY FOR ANY IMBALANCE BETWEEN      *
     F*           DEBIT AND CREDIT TOTAL PER BRANCH/CURRENCY.         *
     F*  S01103 - PRODUCE CONSOLIDATED ACCRUAL POSTINGS IF            *
     F*           REQUIRED.                                           *
     F*  S01094 - IMPROVE PERFORMANCE. SDKEY NOW IN BRANCH/           *
     F*           CURRENCY/ACCOUNT KEY SEQUENCE: REDUCE I/O,          *
     F*           USE LEVEL BREAKS.                                   *
     F*                                                               *
0011 F*****************************************************************
0012 F***SDKEY***IP**E           K        DISK                            AUS007
     FSDKEYB  IP  E           K        DISK                               AUS007
     FFXNACTL0IS  E           K        DISK                               CDL002
     FFXNETML3IF  E           K        DISK                                                 MD048346
      *  Net Actions file                                                 CDL002
0013 F***ACKEY** IF  F      96 12AI     2 DISK                                                CGL029
     F***ACKEY   IF  F     156 12AI     2 DISK                                        CGL029  CDL038
     F***ACKEY** IF  F     170 14AI     2 DISK                                         CDL038 CER049
     FACKEY   IF  F     227 14AI     2 DISK                                                   CER049
0014 F*******TABLE   IF  F      96 12AI     2 DISK                        S01194
0014 F*******TABBRNC IF  E           K        DISK                  S01117S01194
0015 F**TABLEDIF  F      96 12AI     2 DISK                               S01094
0016 FACNUM   IF  F      40 10AI     2 DISK                           U2
0017 F**CNT   IF  F     400 15AI     2 DISK                               S01117
0017 F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
     FACCNT   IF  F     573 24AI     2 DISK                                                   CGL029
0018 F*******CLINT   IF  F     256  7AI     2 DISK                        S01194
     F*******TABTG30 IT  F      40           EDISK                 S01094 S01194
     F*DEALS**IF**E**         K        DISK                         E24720E28679
     F/COPY WNCPYSRC,DL0295F001
     FSDCURRL1IF  E           K        DISK                               S01194
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0295FFP3                                           S01408
     F*                                                                   S01408
0019 FGEDLHH  O   F     160            DISK                      A
     F*EDLPD  O   F     160            DISK                      A        SO5452
     F*****GEDLPD  O   F     200            DISK                 A  SO5452S01182
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295FFP1                                           S01408
      *                                                                   S01408
     F***GEDLPD**O   F     268            DISK                   A S01182 CGL007
     F*GEDLPD*O***F     331            DISK                      A                     CGL007 CGL020
     F***GEDLPD* O   F     589            DISK                      A                  CGL020 CGL029
     FGEDLPD  O   F     620            DISK                      A                            CGL029
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295FFP2
      *                                                                   S01408
     FGEDLZZ  O   F     160            DISK                      A
     F/COPY WNCPYSRC,DL0295FOH1                                           S01408
     FDEALS   IF  E           K        DISK                               CDL002
     F            DEALSDAF                          KIGNORE               CDL002
     F/COPY WNCPYSRC,DL0295F004
     F            DEALSDCF                          KIGNORE               CDL002
     F/COPY WNCPYSRC,DL0295F005
     F            DEALSDDF                          KIGNORE               CDL002
     F            DEALSDEF                          KIGNORE               CDL002
     F            DEALSDFF                          KIGNORE               CDL002
     F            DEALSDGF                          KIGNORE               CDL002
      *  FX Deals file by deal number                                     CDL002
     FSDSTAXL0IF  E           K        DISK                                                   232543
     F/COPY WNCPYSRC,DL0295F002
0020 F**0295P2O   F     132     OF     PRINTER                  S01124    S01117
0020 FDL0295P2O   F     132     OF     PRINTER      KINFDS SPOOL2     UC  S01117
0020 F**0295AUO   F     132            PRINTER                     S01117 S01117
0020 FDL0295AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
     F**0295P1O   F     132            PRINTER      KPRTCTLPRTDSS01124    S01117
     FDL0295P1O   F     132            PRINTER      KPRTCTLPRTDS      UC  S01117
     F                                              KINFDS OFLOW          S01103
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0295FFPG                                           S01408
     F*                                                                   S01408
0021 F* ID F  C  H  L    FUNCTION OF INDICATORS
0022 F* 01            DEALS GENERATED A/C KEYS - HEADER
0023 F* 02            DEALS GENERATED A/C KEYS - DETAIL
0024 F*       03      PRINT HEADINGS ON OVERFLOW
0025 F* 04            ACCOUNT KEYS - DETAIL
0026 F* 05            RETAIL A/C NUMBERS FILE
0027 F* 06            ACCOUNT MASTER FILE - OPEN OR CLOSED A/C
     F* 07            Post to net Posting Account not Settlement A/c      CDL002
     F* 08            FX Net Actions - DETAIL                             CDL002
0028 F**07****        TABLE FILE - ACCOUNT CODES                          S01194
0029 F**08****                   - NOSTRO NUMBERS                         S01194
0030 F**09****                   - NARRATIVE CODES                        S01194
0031 F**10****                   - BRANCH CODES                           S01117
     F*       09      ONE PASS ONLY TO SR/FRSTBR                          188100
0060 F*       10      WORK                                                S01117
0032 F**11****        CLIENT FILE  DETAIL RECORD                          S01194
     F*       11      INTERNAL FUNDING NOSTRO POSTING                     S01354
0033 F*       12      OUTPUT ALL ENTRIES FOR THIS A/C KEY ENTRY           S01117
0033 F*       13      SETTLEMENT TYPE - 01,02,07,08,12
0034 F*       14                      - 03
0035 F*       15                      - 04
0036 F*       16                      - 05
0037 F*       17                      - 06,00
0038 F*    18         EVENT AMOUNT NEGATIVE
0039 F*    19         REVERSAL INDICATOR 0
0040 F*       20      EVENT CURRENCY HAS 0 D.P.
0041 F*       21                         1 D.P.
0042 F*       22                         2 D.P.
0043 F*       23                         3 D.P.
0044 F*       24      OTHER CURRENCY HAS 0 D.P.
0045 F*       25                         1 D.P.
0046 F*       26                         2 D.P.
0047 F*       27                         3 D.P.
0048 F*       28      SETTLEMENT TYPE - 14
0049 F*       29      POSTING TO SUSPENSE A/C
0050 F*       30      CHAIN FAIL
0051 F*       31      MISSING KEY
0052 F*       32      ALL A/C CODES ON RECORD PROCESSED
0053 F*       33      SETTLEMENT DETAILS BLANK
0054 F*       34      POSTING REFERENCE 1
0055 F*       35      POSTING REFERENCE 2
0056 F*       36      POSTING REFERENCE 3
0057 F*       37      ERROR RETURN FROM SUBROUTINE
0058 F*       38      ACCOUNT IS RETAIL
0059 F*       39      POSTING IS CREDIT.
0060 F*       40      WORK
     F*      N52  P1/P2 NOT OPENED/WRITTEN TO SO 'NO DETAILS TO REPORT'   S01117
     F*       54      Output Primary Funding Profit Centre                CAC001
     F*       56      Output Profit Centre of the Account                 CAC001
     F*       58      Summary accruals postings are being generated       CAC001
     F*       59      LOKUP INDICATOR USED IN P01                         S01460
     F*       60      ON WHEN TAXAC = 1, OFF WHEN TAXAC = 0               S01460
     F********67      ROLLOVER SWITCH                              S01434 080603
     F*       66      ROLLOVER SWITCH                                     080603
0063 F*       70      GENERATE INTERBRANCH A/C ENTRIES                    S01117
0063 F********71******PRTF DL0295P1 & DL0295P2 OPEN                 S01117E00018
0060 F*       72      'INTR' HAS A MINUS VALUE                            SO5452
0063 F*       73      PRTF DL0295P2 CONTAINS AT LEAST 1 DETAIL            S01117
0063 F*       74      PRTF DL0295P1 CONTAINS AT LEAST 1 DETAIL            S01117
0063 F*       75      LEVEL BREAK (BOOKING BRANCH)                        S01117
0060 F*       76      'EXRT' HAS A ZERO  VALUE                            SO5452
0063 F*       77      MULTIBRANCHING INDICATOR = Y                        S01117
0060 F*       78      'CSID' IS BLANK, USE SWIFT REF (TYPE 1) FROM LDA    SO5452
0063 F*       79      FIRST BRANCH HEADING NOT OUTPUT                     S01117
0060 F*       82      DEAL TYPE IS 'CI'                                   SO5452
0060 F*       83      'INTR' HAS A ZERO VALUE                             SO5452
0061 F*    41-86      NARRATIVE CODES (MANY NOW REDUNDENT)                1103
     F*       87      ACCRUAL SUMMARY AMOUNT IS CR
     F*         88    ACCRUAL SUMMARY POSTINGS TO BE GENERATED            1103
0063 F*       89      NEY YORK STATE FEDERAL FUNDS INDICATOR
     F*       96      AOBRCHR0 End of File Indicator                      188100
     F*       97      DL0295P1/P2 OPENED                                  188100
0064 F*          U1   DAILY UPDATE RUN
0065 F*         NU1   SHADOW POSTING RUN
0066 F*          U2   S/ACNUM
0067 F*          U4   AT LEAST ONE MISSING A/C KEY
      *                                                                   S01408
     E/COPY WNCPYSRC,DL0295EEP1
      *                                                                   S01408
     E                    CPY@    1   1 80
0068 E***                 CCYA      150  3                                S01094
0069 E***                 DPA       150  1 0                              S01094
     E****TABTG30         CCYA    1 150  3   CCYDT  37             S01094 S01194
     E                    CCYA      150  3                                S01194
     E                    DPA       150  1 0                              S01194
     E***************     XSPT      150 13 0                       S01460 080603
     E                    XSPT      150 13 8                              080603
     E                    TXCR      150 13 8                                                  CGL165
     E                    XMDN      150  1                                S01460
     E**********          XSPQ      150  4                                             S01460 CGL029
     E                    XSPQ      150 10                                                    CGL029
0070 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0071 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0072 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0073 E**********          ACOD        6  4 0                                                  CGL029
     E                    ACOD        6 10 0                                                  CGL029
0074 E                    NCD         6  2
0075 E                    PREF        6  1 0
     E                    ASQ         6  2                                                    CER049
0076 E******              INT         2 15 0                              AUS007
0077 E******              DEC         2  3 0                              AUS007
     E******              INT         3 15 0                        AUS007CDL002
     E******              DEC         3  3 0                        AUS007CDL002
     E                    INT         4 15 0                              CDL002
     E                    DEC         4  3 0                              CDL002
0078 E                    TABECD  1   4  1   TABEVE  3
     E********************ACR     1   6  2               ACCRUAL IDES01103E26578
     E                    ACR     1   8  2               ACCRUAL IDENT.   E26578
     E**********          ACD       500  4 0 ATY     1   ACODS,ATYPS                   S01094 CGL029
     E                    ACD       500 10 0 ATY     1   ACODS,ATYPS                          CGL029
     E                    ACS       500  2               A/C SECTIONS     S10736
0068 E***********         BCC       100  3               BRANCH CODS01117 151104
     E                    BCC       900  3               BRANCH CODE ARRAY151104
0068 E********************BCT       100 18               BRANCH DETLS01117S10736
0068 E********************BCT       100 22               BRANCH DETLS10736080603
0068 E***********         BCT       100 52               BRANCH DET080603 151104
0068 E**********          BCT       900 52               BRANCH DETL ARRAY             151104 CGL029
     E                    BCT       900 64                                                    CGL029
0074 E                    ARRT       16  1               ** SWCREF SR *   SO5452
     E                    POWER   1   7  7 3             POWER ARRAY      S01460
     E                    FXTY    7   7  2               FX DEAL TYPES    CDL002
     E/COPY WNCPYSRC,DL0295E001
     E*                                                                   S01522
     E* Include subroutine ZSEDIT for amounts editing:                    S01522
     E*                                                                   S01522
     E/COPY ZSRSRC,ZSEDITZ1                                               S01522
     E*                                                                   S01522
0079 I*    DEALS GENERATED ACCOUNT KEYS FILE - HEADER RECORD.
0080 I*
0081 IDKEYSHHF    01
0083 I*
0084 I*
0085 I*    DEALS GENERATED ACCOUNT KEYS FILE - DETAIL RECORD.
0086 I*
0087 IDKEYSDPF    02
     I                                              AKEY  L1              S01100
     I              OSBR                            OSBR                  S01117
     I              ACSQ                            ACSQD
     I*****                                         BRCD  L3        S01100S01117
     I***********                                   BRCA  L3        S01117CDL002
     I***********                                   ECCY  L2        S01100CDL002
     I                                              BRCA  L3M2            CDL002
     I                                              ECCY  L2M1            CDL002
     I              EAMT                            EAMT          18
     I              REVI                            REVI            19
     I              EXRT                            EXRT            76    SO5452
     I              INTR                            INTR          7283    SO5452
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0295IIP2                                           S01408
     I*                                                                   S01408
0117 I*
0119 I*    DEALS GENERATED ACCOUNT KEYS FILE - TRAILER RECORD.
0120 I*
0121 I***DKEYSZZF***                                                      AUS007
     IDKEYSZZF    67                                                      AUS007
     I*                                                                   AUS007
     I** BROKERAGE GENERATED ACCOUNT KEYS FILE - DETAIL RECORD.           AUS007
     I*                                                                   AUS007
     IBRKEYDPF    68                                                      AUS007
     I                                              AKEY  L1              AUS007
     I              ACSQ                            ACSQD                 AUS007
     I***********                                   BRCA  L3        AUS007CDL002
     I***********                                   ECCY  L2        AUS007CDL002
     I                                              BRCA  L3M2            CDL002
     I                                              ECCY  L2M1            CDL002
     I              EAMT                            EAMT          18      AUS007
     I              REVI                            REVI            19    AUS007
     I*                                                                   AUS007
     I** BROKERAGE GENERATED ACCOUNT KEYS FILE - TRAILER RECORD.          AUS007
     I*                                                                   AUS007
     I***BRKEYZZF***                                               AUS007 050169
     IBRKEYZZF    69                                                      050169
     I              NORE                            BNORE                 AUS007
     I              HRWN                            BHRWN                 AUS007
     I              HRDC                            BHRDC                 AUS007
0126 I*
0127 I*    CATCH ALL
0128 I*       NS
     IFXNACTD0    08                                                      CDL002
      *   Net Actions File. Set Field Names Equivalent to DKEY Fields     CDL002
     I              RACNUM                          CNUM                  CDL002
     I              RABRCA                          BRCA  L3M2            CDL002
     I              RAACSQ                          ACSQD                 CDL002
     I              RAEDAT                          EDAT                  CDL002
     I              RAEAMT                          EAMT                  CDL002
     I              RAECCY                          ECCY  L2M1            CDL002
     I              RASETP                          SETP                  CDL002
     I              RAOSAC                          OSAC                  CDL002
     I              RAREVI                          REVI                  CDL002
     I              RAOTHC                          OTHC                  CDL002
     I              RAEXRT                          EXRT                  CDL002
     I              RAVDAT                          VDAT                  CDL002
     I              RASLID                          SLID                  CDL002
     I              RAMDAT                          MDAT                  CDL002
     I              RABRTT                          BRTT                  CDL002
     I              RABRTE                          BRTE                  CDL002
     I              RARTSP                          RTSP                  CDL002
     I              RAINTR                          INTR                  CDL002
     I              RAFFVD                          FFVD                  CDL002
     I              RAYRAT                          YRAT                  CDL002
     I              RAFFIN                          FFIN                  CDL002
     I              RACHNA                          CHNACH                CDL002
     I              RAFACO                          FACO                  CDL002
     I              RAPRFC                          PRFC                  CDL002
     I              RAOSBR                          OSBR                  CDL002
     I              RABOKC                          BOKC                  CDL002
0129 I*********                                                           S01194
0130 I********   TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.         S01194
0131 I********                                                            S01194
0132 I********   TABLE   NS       2 C0   3 C1  12 C1                      S01194
0133 I********   AND      13 C0                                           S01194
0134 I********                                1   1 RECI                  S01194
0135 I********                                2   30RECT                  S01194
0136 I********                               12  130RCDE                  S01194
0137 I********                               14  66 TITL                  S01194
0138 I********                               67  67 DATF                  S01194
0139 I***********                            68  700DFBR                  S01117
0139 I********                               68  70 DFBM                  S01117
0140 I********                               74  74 MODI1                 S01194
0141 I********                               75  75 MODI2                 S01194
0142 I********                               76  76 MODI3                 S01194
0143 I********                            P  77  790RUND                  S01194
0144 I********                               80  86 RUNA                  S01194
0145 I********                               87  870SFLG                  S01194
0146 I********                            P  90  920LCD                   S01194
0147 I********                               93  93 CHTP                  S01194
0148 I********                            P  94  960TNLU                  S01194
 490 I********                                                            S01194
 491 I********                                                            S01194
 492 I******** TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.           S01194
 493 I********                                                            S01194
0494 I******** TABLE   NS       1 CD   2 C0   3 C1                        S01194
0495 I******** AND      12 C1  13 C1                                      S01194
0496 I********                                1   1 RECI                  S01194
0497 I********                                2   30RECT                  S01194
0498 I********                               12  130RCDE                  S01194
0499 I********                               14  16 BCCY                  S01194
0500 I********                               17  19 BCYL                  S01194
0501 I********                               20  22 HOCY                  S01194
0502 I********                               23  280HEAD                  S01194
0503 I********                            P  29  310APDA                  S01194
0504 I********                               35  35 APFQ                  S01194
0505 I********                            P  36  380LOGS                  S01194
0506 I********                               39  40 CUZR                  S01194
0507 I********                            P  41  430DNWD                  S01194
0508 I********                               44  460BVLP                  S01194
0509 I********                               47  49 LOCY                  S01194
0510 I********                               50  510FDAY                  S01194
     I********                               53  53 MBIN                  S01194
0511 I********                               86  86 ISAV                  S01194
0512 I**                                  P  87  890LLOG                  S01103
     I********                               89  89 AKSI                  S01103
0149 I******** TABLE FILE - INSTALLATION CONTROL DATA RECORD 3.           S01194
0150 I********                                                            S01194
0151 I******** TABLE   NS       1 CD   2 C0   3 C1                        S01194
0152 I******** AND      12 C2  13 C0                                      S01194
0153 I********                                1   1 RECI                  S01194
0154 I********                                2   30RECT                  S01194
0155 I********                               12  130RCDE                  S01194
0156 I********                               14  170COMS                  S01194
0157 I********                               18  210CADC                  S01194
0158 I********                            P  22  240MDIC                  S01194
0159 I********                            P  25  270MCIC                  S01194
0160 I********                            P  28  300MDIA                  S01194
0161 I********                            P  31  330MCIA                  S01194
0162 I********                               34  370SRPL                  S01194
0163 I********                               38  410SPAC                  S01194
0164 I********                               42  450SWAC                  S01194
0165 I********                               46  490FTAC                  S01194
0166 I********                               50  530TAC4                  S01194
0167 I********                               54  570TAC5                  S01194
0168 I********                            P  63  650NOBA                  S01194
0169 I********                            P  66  680TSIZ                  S01194
0170 I********                               69  69 RACN                  S01194
0171 I********                               70  700GLSI                  S01194
0172 I********                               71  710RTSI                  S01194
0173 I********                               72  720DLSI                  S01194
0174 I********                               73  730NOSI                  S01194
0175 I********                               74  740CTSI                  S01194
0176 I********                            P  75  770ELAC                  S01194
0177 I********                            P  78  800ECAC                  S01194
0178 I********                            P  90  920LCD                   S01194
0179 I********                               93  93 CHTP                  S01194
0180 I********                            P  94  960TNLU                  S01194
0181 I******** TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.           S01194
0182 I********                                                            S01194
0183 I******** TABLE   NS       1 CD   2 C0   3 C1                        S01194
0184 I******** AND      12 C4  13 C0                                      S01194
0185 I********                                1   1 RECI                  S01194
0186 I********                                2   30RECT                  S01194
0187 I********                               12  130RCDE                  S01194
0188 I********                               18  210CSAC                  S01194
0189 I********                               22  22 TLII                  S01194
0190 I********                               23  23 MCRI                  S01194
0191 I********                            P  24  250MCEP                  S01194
0192 I********                               26  270MCLP                  S01194
0193 I********                               28  28 FRDI                  S01194
0194 I********                               29  29 BRCF                  S01194
0195 I********                               30  350PSCN                  S01194
0196 I***********                            36  380DLBR                  S01117
0196 I********                               36  38 DLBR                  S01117
0197 I********                               39  420FRPA                  S01194
0198 I********                               43  460FRPC                  S01194
0199 I********                               47  49 USCY                  S01194
0200 I********                               50  52 STCY                  S01194
0201 I********                            P  53  553MBGE                  S01194
0202 I********                               57  57 FFNY                  S01194
0203 I********                               58  58 OURC                  S01194
0204 I********                               59  59 BRNC                  S01194
0205 I********                               60  60 LCYN                  S01194
0206 I********                            P  90  920LCD                   S01194
0207 I********                               93  93 CHTP                  S01194
0208 I********                            P  94  960TNLU                  S01194
0209 I*****TABLE FILE - ACCOUNT CODES RECORD 1.                           S01194
0210 I*****                                                               S01194
0211 I*ABLE***NS  07   1 CD   2 C3   3 C0                                 S01194
0212 I*****  AND      13 C1                                               S01194
0213 I*****                                   1   1 RECI                  S01194
0214 I*****                                   2   30RECT                  S01194
0215 I*****                                   9  120ACODE                 S01194
0216 I*****                                  13  130SREC                  S01194
0217 I*****                                  14  38 ACKN                  S01194
0218 I*****                                  39  39 ATYP                  S01194
0219 I*****                               P  40  420SHLC                  S01194
0220 I*****                               P  43  450SHFC                  S01194
0221 I*****                                  48  48 TITO                  S01194
0222 I*****                                  49  520BSDR                  S01194
0223 I*****                                  53  560BSCR                  S01194
0224 I*****                                  57  600PLDR                  S01194
0225 I*****                                  61  640PLCR                  S01194
0226 I*****                                  65  740RPCD                  S01194
0227 I*****                                  75  76 ACCS                  S01194
0228 I*****                                  77  77 STYP                  S01194
0229 I*****                               P  90  920LCD                   S01194
0230 I*****                                  93  93 CHTP                  S01194
0231 I*****                               P  94  960TNLU                  S01194
0232 I********  TABLE FILE - NOSTROS RECORD.                              S01194
0233 I********                                                            S01194
0234 I********  TABLE   NS  08   1 CD   2 C7   3 C0                       S01194
0235 I********                                1   1 RECI                  S01194
0236 I********                                2   30RECT                  S01194
0237 I********                                9  11 CCY                   S01194
0238 I********                               12  130NOSN                  S01194
0239 I********                               16  29 ONAC                  S01194
0240 I********                               30  350NSCNM                 S01194
0241 I********                               36  370NSACS                 S01194
0242 I********                               38  410NSACD                 S01194
0242 I********                               67  69 NSBRCD          S01117S01194
0243 I********                            P  90  920LCD                   S01194
0244 I********                               93  93 CHTP                  S01194
0245 I********                            P  94  960TNLU                  S01194
0246 I********  TABLE FILE - NARRATIVE CODES RECORD.                      S01194
0247 I********                                                            S01194
0248 I******** TABLE   NS  09   1 CD   2 C9   3 C0                        S01194
0249 I********                                1   1 RECI                  S01194
0250 I********                                2   30RECT                  S01194
0251 I********                               12  13 NARC                  S01194
0252 I********                               14  43 NARD                  S01194
0253 I********                            P  90  920LCD                   S01194
0254 I********                               93  93 CHTP                  S01194
0255 I********                            P  94  960TNLU                  S01194
0256 I******** TABLE FILE - BRANCH CODES RECORD.                          S01194
0257 I********                                                            S01194
0258 I**BLE   NS  10   1 CD   2 C1   3 C0                           S01117S01194
0258 I********TABLE   NS       2 C1   3 C0                          S01117S01194
0259 I********                                1   1 RECI                  S01194
0260 I********                                2   30RECT                  S01194
0261 I*****                                  11  130BRCD            S01117S01194
0261 I********                               11  13 BRCA            S01117S01194
0262 I********                               14  43 BRNM                  S01194
0263 I********                               44  490BICN                  S01194
0264 I********                               50  51 LOCC                  S01194
0265 I*****                                  52  53 CMPY                  S01117
0265 I********                               52  54 CMPYM           S01117S01194
     I*****                                  78  790SACS                  S01117
     I*****                                  82  850IBAB                  S01117
     I********                               82  850ADTO            S01117S01194
     I*****                                  86  890IBAH                  S01117
     I********                               86  890ADFR            S01117S01194
0266 I********                            P  90  920LCD                   S01194
0267 I********                               93  93 CHTP                  S01194
0268 I********                            P  94  960TNLU                  S01194
0269 I********                                                            S01194
0270 I******** CATCH ALL                                                  S01194
0271 I********NS                                                          S01194
     I********                                1   1 RECI                  S01194
     I********                                2   30RECT                  S01194
0084 I********                                                     S01117 S01194
0085 I******** TABLE BRANCH CODE RECORD - DETAIL RECORD.           S01117 S01194
0086 I********                                                     S01117 S01194
0087 I******** TABLETRF                                            S01117 S01194
     I********      RECI                            RECIX          S01117 S01194
0272 I*
0273 I*    ACCOUNT KEYS FILE - DETAIL RECORD.
0274 I*
0275 IACKEY   NS  04   1 CD
0276 I                                        1   1 RECI
0277 I****************************************2  11 AKEY                                      CDL038
     I                                        4   4 KEYTP                 S01225
0259 I*                                      14  170ACD1                  E11609
0260 I*                                      18  210ACD2                  E11609
0261 I*                                      22  250ACD3                  E11609
0262 I*                                      26  290ACD4                  E11609
0263 I*                                      30  330ACD5                  E11609
0264 I*                                      34  370ACD6                  E11609
0284 I**********                             14  37 ACOD                                      CGL029
     I                                       14  37 ACO1QQ                                    CGL029
0285 I                                       38  39 NCD1
0286 I                                       40  41 NCD2
0287 I                                       42  43 NCD3
0288 I                                       44  45 NCD4
0289 I                                       46  47 NCD5
0290 I                                       48  49 NCD6
0291 I                                       38  49 NCD
0292 I                                       50  500PRF1
0293 I                                       51  510PRF2
0294 I                                       52  520PRF3
0295 I                                       53  530PRF4
0296 I                                       54  540PRF5
0297 I                                       55  550PRF6
0298 I                                       50  55 PREF
0299 I                                    P  90  920LCD
0300 I                                       93  93 CHTP
0301 I                                    P  94  960TNLU
     I                                       97 156 ACOD                                      CGL029
0277 I                                      157 170 AKEY                                      CDL038
     I                                      216 217 ASQ1                                      CER049
     I                                      218 219 ASQ2                                      CER049
     I                                      220 221 ASQ3                                      CER049
     I                                      222 223 ASQ4                                      CER049
     I                                      224 225 ASQ5                                      CER049
     I                                      226 227 ASQ6                                      CER049
     I                                      216 227 ASQ                                       CER049
0302 I*
0303 I*    CATCH ALL
0304 I        NS
0305 I********                                                            S01194
0306 I******** CLIENT FILE - CUSTOMER STANDING DATA RECORD.               S01194
0307 I********                                                            S01194
0308 I******** CLINT   NS  11   1 CD   8 CA                               S01194
0309 I********                                1   1 RECI                  S01194
0309 I****************************************2   70CNUM                  SO5452
0310 I********                                2   70CNUMC          SO5452 S01194
0311 I********                                8   8 RCDT                  S01194
0312 I********                                9  28 CRNM                  S01194
0313 I********                               29  38 CTWN                  S01194
0314 I********                               39  48 CSNM                  S01194
0315 I********                               49  56 CASK                  S01194
0316 I********                               57  68 TELX                  S01194
0317 I********                               69  80 CSID                  S01194
0318 I********                               81  82 ACOC                  S01194
0319 I********                               83  83 CBSI                  S01194
0320 I********                               84  85 CCTZ                  S01194
0321 I********                               86  87 CLOC                  S01194
0322 I********                               88  930CPAR                  S01194
0323 I********                               97  980LINS                  S01194
0324 I********                               99 1010LIND                  S01194
0325 I********                            P 102 1040DASU                  S01194
0326 I********                            P 105 1070CDIC                  S01194
0327 I********                            P 108 1100DADE                  S01194
0328 I********                              111 111 CMIN                  S01194
0329 I********                              112 112 CTYP                  S01194
0330 I********                              113 124 TELF                  S01194
0331 I********                              125 133 CHID                  S01194
0332 I********                              134 136 CHAB                  S01194
0333 I********                            P 250 2520LCD                   S01194
0334 I********                              253 253 CHTP                  S01194
0335 I********                            P 254 2560TNLU                  S01194
0336 I********                                                            S01194
0337 I******** CATCH ALL                                                  S01194
0338 I********NS                                                          S01194
     I********                                1   1 RECI                  S01194
0339 I*    ACCOUNT MASTER DETAIL RECORD
0340 I**
0341 IACCNT   NS  06   1 CD
0342 I       OR   06   1 CC  26NCR
0343 I                                        1   1 RECI
0344 I                                        2  16 ACMDKY
0345 I**********                              2   70CNUMAC                                    CSD027
0345 I                                        2   7 CNUMAC                                    CSD027
0346 I                                        8  10 CCY
0347 I**********                             11  140ACODE                                     CGL029
     I                                       11  140ACODQQ                                    CGL029
0348 I                                       15  160ACSQ
0349 I*****                                  23  250BRCDA                 S01117
0349 I                                       23  25 BRCDA                 S01117
0350 I                                       26  26 ATYPA
0351 I                                       27  27 STYP
0352 I                                       29  29 ACST
0353 I                                    P  30  320DACO
0354 I                                    P  33  350DACC
0355 I                                       36  55 ANAM
0356 I                                    P  56  630LDBL
0357 I                                    P  64  710CLBL
0358 I                                       72  72 STFQ
0359 I                                       73  740STDY
0360 I                                    P  75  770LSTD
0361 I                                    P  78  800NSTD
0362 I                                    P  81  820LSTP
0363 I                                    P  83  900CFSB
0364 I                                    P  91  930LMVD
0365 I                                    P  94 1010EPLB
0366 I                                    P 102 1090EPCB
0367 I                                    P 110 1170YTDB
0368 I                                      118 118 GLBT
     I                                      127 130 PRFCA                 CAC001
0369 I                                    P 138 1400LIMC
0370 I                                    P 178 1837CDIR
0371 I                                    P 184 1897CCIR
0372 I                                      190 1990ACRAN
0373 I                                      200 200 RETB
0374 I                                      201 201 ODSC
0375 I                                    P 202 2070ODLN
0376 I                                    P 208 2100ODED
0377 I                                    P 211 2120DIOD
0378 I                                      213 2150FACT
0379 I                                      216 2170FCNO
0380 I                                      218 219 EFAC
0381 I                                    P 220 2270HELD
0382 I                                    P 228 2330MINB
0383 I                                    P 234 2360LACD
0384 I                                    P 237 2380LISP
0385 I                                    P 239 2410RRNM
0386 I                                      242 2430DRIB
0387 I                                    P 244 2497DRIS
0388 I                                    P 250 2520DRCD
0389 I                                      253 2530DRIC
0390 I                                      254 254 DRIF
0391 I                                      255 2560DRDY
0392 I                                    P 257 2590NDID
0393 I                                    P 260 2620LDID
0394 I                                    P 263 2690LDIA
0395 I                                      270 270 SDAP
0396 I                                    P 271 2730LPAR
0397 I                                    P 274 2800DIIE
0398 I                                    P 281 2882DAIC
0399 I                                    P 289 2950MADI
0400 I                                    P 296 3020GADI
0401 I                                      303 303 DDIS
0402 I                                    P 304 3060DDIA
0403 I                                      310 3110OLDB
0404 I                                    P 312 3177OLDS
0405 I                                      318 3190CRIB
0406 I                                    P 320 3257CRIS
0407 I                                    P 326 3280CRCD
0408 I                                      329 3290CRIC
0409 I                                      330 330 CRIF
0410 I                                      331 3320CRDY
0411 I                                    P 333 3350NCID
0412 I                                    P 336 3380LCID
0413 I                                    P 339 3450LCIA
0414 I                                      346 346 SCAP
0415 I                                    P 347 3490LPAP
0416 I                                    P 350 3560CIIE
0417 I                                    P 357 3642CAIC
0418 I                                    P 365 3710MACI
0419 I                                    P 372 3780GACI
0420 I                                      379 379 CDIS
0421 I                                    P 380 3820DCIA
0422 I                                      386 3870OLCB
0423 I                                    P 388 3937OLCS
0424 I                                    P 394 3960LCD
0425 I                                      397 397 CHTP
0426 I                                    P 398 4000TNLU
     I                                      554 563 ACODE                                     CGL029
0427 I*
0428 I*    CATCH ALL
0429 I        NS
0430 IACNUM   NS  05   1 CD
0431 I                                        1   1 RECI
0432 I                                        2  110ACNO
0433 I**********                             12  170RACNM                                     CSD027
0433 I                                       12  17 RACNM                                     CSD027
0434 I                                       18  20 CCY
0435 I**********                             21  240RAACD                                     CGL029
0436 I**********                             25  260RAACS                                     CGL029
0437 I**********                             27  27 ACST                                      CGL029
0437 I**********                             29  31 RABRCD                             S01117 CGL029
     I                                       21  300RAACD                                     CGL029
     I                                       31  320RAACS                                     CGL029
     I                                       33  33 ACST                                      CGL029
     I                                       35  37 RABRCD                                    CGL029
0438 I*
0439 I*    CATCH ALL
0440 I        NS
      *                                                                   S01408
     I/COPY WNCPYSRC,DL0295IIP1                                           S01408
      *                                                                   S01408
0441 I*
0084 I*
0085 I*    DEALS GENERATED ACCOUNT KEYS FILE - DETAIL RECORD.
0442 I**   TABLE FILE - CURRENCIES RECORD 1.
0443 I**
0444 I**TABLEDNS       2 C2   3 C0                                        S01094
0445 I**                                      1   1 RECIX                 S01094
0446 I**                                      2   30RECTX                 S01094
0447 I**                                     10  12 CCYX                  S01094
0448 I**                                     13  130SRECX                 S01094
0449 I**                                     38  380CDPX                  S01094
0450 I**
0451 I**      NS                                                          S01094
0452 I**                                      2   30RECTX                 S01094
     I*                                                                   S01100
     I***RENAME*FIELDS*ON*DEALS*FILES*******************************E24720E28679
     I**************************************************************E24720E28679
     I*DEALSDBF*****                                                E24720E28679
     I***********   RECI                            RECR            E24720E28679
     I***********   DLNO                            DLNOD           E24720E28679
     I***********   CNUM                            CNUMD           E24720E28679
     I**************************************************************E24720E28679
     I*DEALSDDF*****                                                E24720E28679
     I***********   RECI                            RECR            E24720E28679
     I***********   DLNO                            DLNOD           E24720E28679
     I***********   CNUM                            CNUMD           E24720E28679
     ISDMMOD    E DSSDMMODPD                                              047225
     I* MMOD DETAILS ACCESSED VIA ACCESS PROGRAM                          047225
     I*                                                                   S01194
     ISDPCAC    E DSSDPCACPD                                              CAC001
     I**  PCA ICD                                                         CAC001
     I*                                                                   CAC001
     ISDPRFC    E DSSDPRFCPD                                              CAC001
     I**  Profit Centre Details                                           CAC001
     I*                                                                   CAC001
     ICGPNAR    E DSCGPNARPD                                              S01522
     I* UDC MULTI-LANGUAGE NARRATIVE DATA STRUCTURE                       S01522
     I*                                                                   S01522
     I##PRM1      DS                                                      086125
      **  Data Structure for Customer and Branch                          086125
      *                                                                   086125
     I                                        1   6 A#CUST                086125
     I                                        7   9 A#BRCA                086125
      *                                                                   086125
     ISDBANK    E DSSDBANKPD                                              S01194
     I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I* BRANCH DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
     I*                                                                   S01194
     ISDACOD    E DSSDACODPD                                              S01194
     I* ACCOUNT CODES ACCESSED VIA ACCESS PROGRAM                         S01194
     I              QQACCD                          QQACC1                                    CGL029
     I              QQFNIC                          QQFNI1                                    CGL029
     I              QQFNAA                          QQFNA1                                    CGL029
     I*                                                                   S01194
     ISDRETL    E DSSDRETLPD                                              S01194
     I* RETAIL DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
     I              QQACCD                          QQACC2                                    CGL029
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I* GENERAL LEDGER DETAILS ACCESSED VIA ACCESS PROGRAM                S01194
     I              QQACCD                          QQACC3                                    CGL029
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I* CUSTOMER DETAILS ACCESSED VIA ACCESS PROGRAM                      S01194
     I              QQDFAC                          QQDFA1                                    CGL029
     I*                                                                   S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
     I* NOSTRO DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
     I              QQACCD                          QQACC4                                    CGL029
     I*                                                                   S01194
     ISDNARR    E DSSDNARRPD                                              S01194
     I* NARRATIVE CODES ACCESSED VIA ACCESS PROGRAM                       S01194
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I* TRADING DETAILS ACCESSED VIA ACCESS PROGRAM                       S01194
     I              QQACCD                          QQACC5                                    CGL029
     I*                                                                   AUS007
     ISCSARD    E DSSCSARDPD                                              AUS007
     I* SAR FILE DETAILS ACCESSED VIA ACCESS PROGRAM  AOSARDR0            AUS007
     I*                                                                   S01194
     ISDDEAL    E DSSDDEALPD                                              CDL002
     I* DEALS DETAILS ACCESSED VIA ACCESS PROGRAM                         CDL002
     I              QQACCD                          QQACC6                                    CGL029
     I*                                                                   CDL002
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSLDY     E DSDSLDY                                                 220738
     I*  THIRD DS FOR ACCESS PROGRAMS, VERY LONG DATA STRUCTURE           220738
     I*                                                                   220738
     IRUNDAT      DS                                                      S01194
     I* DATA STRUCTURE FOR RUNDATE                                        S01194
     I                                       13  13 @MBIN                 S01194
     I*                                                                   S01194
     I*                                                                   S01194
     ILDA        UDS                            256                       S01100
     I*****                                 131 141 DBFILE       S01100   SO5452
     I*****                                 142 170 DBKEY        S01100   SO5452
     I*****                                 171 180 DBPGM        S01100   SO5452
     I*****                                 181 183 DBASE        S01100   SO5452
     I*****                                 134 138 DBFILE         SO5452 S01194
     I*****                                 139 167 DBKEY          SO5452 S01194
     I*****                                 168 175 DBPGM          SO5452 S01194
     I*****                                 176 1770DBASE          SO5452 S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
     I*                                                                   S01103
     IOFLOW       DS                                                      S01103
     I* Overflow line from INFDS                                          S01103
     I* + FILE INFORMATION DATA STRUCTURE 1                               S01117
     I                                       83  92 SFILE1                S01117
     I                                    B 123 1240SFNUM1                S01117
     I                                    B 188 1890OVFLW                 S01103
     I*                                                                   S01103
     IPRTDS       DS                                                      S01103
     I* PRINT CONTROL FOR DL0295P1                                        S01103
     I                                        8   90CURLIN                S01103
     IOSACDS      DS
     I**********                              1  12 OSAC                                      CGL029
     I                                        1  18 OSAC                                      CGL029
     I                                        1   2 NOSC
     I                                        1   6 SDCNM
     I***************************             1  10 SDRAN                 E16486
     I                                        1  100SDRAN                 E16486
     I**********                              7  10 SDACD                                     CGL029
     I**********                             11  12 SDACS                                     CGL029
     I                                        7  16 SDACD                                     CGL029
     I                                       17  18 SDACS                                     CGL029
      *                                                                   E11609
      ** Account codes (from AKEY)                                        E11609
     IACODA       DS                                                      E11609
0259 I**********                              1  24 ACOD                               E11609 CGL029
     I                                        1  60 ACOD                                      CGL029
     I*
0453 I*
0454 I*    A/C MASTER KEY
0455 I            DS
0456 I*****                                   1  15 ACCKEY                S01117
0456 I**********                              1  18 ACCKEY                             S01117 CGL029
0456 I**********                              1  15 ACCK                               S01117 CGL029
     I                                        1  24 ACCKEY                                    CGL029
     I                                        1  21 ACCK                                      CGL029
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0295IIP4                                           S01408
     I*                                                                   S01408
0457 I                                        1   6 ACCNM
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0295IIP3                                           S01408
     I*                                                                   S01408
0458 I                                        7   9 ACCCY
0459 I**********                             10  13 ACACD                                     CGL029
     I**********                             10  130NACACD                             S01094 CGL029
0460 I**********                             14  15 ACACS                                     CGL029
0460 I**********                             16  18 ACBRCD                             S01117 CGL029
     I                                       10  19 ACACD                                     CGL029
     I                                       10  190NACACD                                    CGL029
     I                                       20  21 ACACS                                     CGL029
     I                                       22  24 ACBRCD                                    CGL029
0461 I*
0462 I*    A/C KEY EVENT CODE
0463 I            DS
0464 I****************************************1  10 AKEY                                      CDL038
0464 I                                        1  14 AKEY                                      CDL038
0465 I                                        3   3 EVCOD
     I                                        6   6 AKEY6                 CAC001
     I                                       10  10 EVSUB                 S01103
     I                                       11  11 POS11                 CPB005
     I                                        9  10 WKSTAT                                    232543
     I/COPY WNCPYSRC,DL0295I001
0466 I*                                                                   SO5452
0466 I*    TO EXTRACT DTYP FROM A/C KEY                                   SO5452
0465 I                                        1   2 DTYP                  S05452
0461 I*                                                                   SO5452
0466 I*    TO EXTRACT TRANS SUB-TYPE FROM A/C KEY                         S01182
0465 I****************************************3   4 SUBT            S01182S01238
0465 I                                        4   5 SUBT                  S01238
0461 I*                                                                   S01182
0461 I*                                                                   SO5452
0462 I*    SET UP SWIFT REFERENCE (TYPE 1)                                SO5452
0463 I            DS                                                      SO5452
0464 I                                        1  16 SWCRD                 SO5452
0465 I                                        1   1 DL1                   SO5452
     I                                        2   70DLNO                  SO5452
0466 I*                                                                   SO5452
     I*    SET UP DEAL REFERENCE                                          SO5452
     I            DS                                                      SO5452
     I                                        1   8 DLREF                 SO5452
     I                                        1   1 DL2                   SO5452
     I                                        2   70DLNO2                 S05452
0461 I*                                                                   S01117
0462 I*****S/TABBRNC KEY FIELDS                                    S01117 S01194
0463 I*****       DS                                               S01117 S01194
0464 I*****                                   1  12 KEY            S01117 S01194
0465 I*****                                   1   20RECTX          S01117 S01194
     I                                       10  12 BRCAX                 S01117
0462 I*    BOOKING BRANCH DETAILS DATA STRUCTURE                          S01117
0463 I            DS                                                      S01117
0464 I**********                              1  18 BBCI            S01117S10736
0464 I**********                              1  22 BBCI           S10736 080603
0464 I**********                              1  52 BBCI                               080603 CGL029
     I                                        1  64 BBCI                                      CGL029
0465 I**********                              1   60BBICN                              S01117 CSD027
0465 I                                        1   6 BBICN                                     CSD027
0465 I**********                              7  100BADTO                              S01117 CGL029
0465 I**********                             11  140BADFR                              S01117 CGL029
0465 I**********                             15  15 BTYPTO                             S01117 CGL029
0465 I**********                             16  16 BTYPFR                             S01117 CGL029
0465 I**********                             17  17 BRINTO                             S01117 CGL029
0465 I**********                             18  18 BRINFR                             S01117 CGL029
0465 I**********                             19  20 BACSCO                             S10736 CGL029
0465 I**********                             21  22 BACSCR                             S10736 CGL029
0465 I**********                             23  52 BBRNM                              080603 CGL029
     I                                        7  160BADTO                                     CGL029
     I                                       17  260BADFR                                     CGL029
     I                                       27  27 BTYPTO                                    CGL029
     I                                       28  28 BTYPFR                                    CGL029
     I                                       29  29 BRINTO                                    CGL029
     I                                       30  30 BRINFR                                    CGL029
     I                                       31  32 BACSCO                                    CGL029
     I                                       33  34 BACSCR                                    CGL029
     I                                       35  64 BBRNM                                     CGL029
0462 I*    SETTLEMENT BRANCH DETAILS DATA STRUCTURE                       S01117
0463 I            DS                                                      S01117
0464 I**********                              1  18 OBCI            S01117S10736
0464 I**********                              1  22 OBCI           S10736 080603
0464 I**********                              1  52 OBCI                               080603 CGL029
     I                                        1  64 OBCI                                      CGL029
0465 I**********                              1   60OBICN                              S01117 CSD027
0465 I                                        1   6 OBICN                                     CSD027
0465 I**********                              7  100OADTO                              S01117 CGL029
0465 I**********                             11  140OADFR                              S01117 CGL029
0465 I**********                             15  15 OTYPTO                             S01117 CGL029
0465 I**********                             16  16 OTYPFR                             S01117 CGL029
0465 I**********                             17  17 ORINTO                             S01117 CGL029
0465 I**********                             18  18 ORINFR                             S01117 CGL029
0465 I**********                             19  20 OACSCO                             S10736 CGL029
0465 I**********                             21  22 OACSCR                             S10736 CGL029
0465 I**********                             23  52 OBRNM                              080603 CGL029
     I                                        7  160OADTO                                     CGL029
     I                                       17  260OADFR                                     CGL029
     I                                       27  27 OTYPTO                                    CGL029
     I                                       28  28 OTYPFR                                    CGL029
     I                                       29  29 ORINTO                                    CGL029
     I                                       30  30 ORINFR                                    CGL029
     I                                       31  32 OACSCO                                    CGL029
     I                                       33  34 OACSCR                                    CGL029
     I                                       35  64 OBRNM                                     CGL029
0466 I*
     I*    DEBIT AND CREDIT TOTAL PER BRANCH/CURRENCY, IMBALANCE AMOUNT   S01100
     I            DS                                                      S01100
     I                                        1  150CRTOT                 S01100
     I                                       16  300DRTOT                 S01100
     I**********                             31  450BALSUS         S01100 189681
     I                                       33  450BALSUS                189681
     I*                                                                   S01100
     I*****CURRENCY DETAILS FROM ARRAY CCYDT                       S01100 S01194
     I*****       DS                                               S01100 S01194
     I*****                                   1  37 CCYDET         S01100 S01194
     I*****                                   1   10XDECP          S01100 S01194
     I*                                                                   S01103
     I            DS                                                      S01103
     I*    General purpose array index                                    S01103
     I                                        1   30X                     S01103
     I*    Index of first account code in array ACD (loaded from back     S01094
     I*    to front)                                                      S01094
     I                                        4   60Y                     S01094
     I*                                                                   S01103
     I            DS                                                      S01103
     I*    Accrual running total, summary posting amount, accrual         S01103
     I*    identifier                                                     S01103
     I                                        1  130SUMACR                S01103
     I                                       14  260ACRLSM                S01103
     I                                       27  28 ACRID                 S01103
     I*                                                                   S01094
     I            DS                                                      S01094
     I*    Hash totalling fields                                          S01094
     I                                        1  153ZZAMT                 S01094
     I                                       16  300ZZAMTI                S01094
     I                                       31  330ZZAMTD                S01094
     I                                       34  360ZZTOTD                S01094
     I                                       37  510ZZTOTI                S01094
     I                                       52  520Z                     S01094
     I            DS                                                                          246505
     I                                        1  18 WSACC                                     246505
     I                                        1   2 WSAC1                                     246505
     I                                       16  17 WSAC2                                     246505
     I*                                                                   S01117
0925 I**                                                                  S01117
     ISPOOL2      DS                                                      S01117
0925 I**   FILE INFORMATION DATA STRUCTURE 2                              S01117
     I                                       83  92 SFILE2                S01117
     I                                    B 123 1240SFNUM2                S01117
0925 I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
0925 I**   FILE INFORMATION DATA STRUCTURE 3                              S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   CDL002
      **  Data Structure:  layout of net reference field                  CDL002
     INETFMT      DS                                                      CDL002
     I                                        1   3 WFDLCN                CDL002
     I                                        4   5 WFVDMM                CDL002
     I                                        6   7 WFVDDD                CDL002
     I                                        8  10 WFCCY                 CDL002
     I                                       11  16 WFCUSN                CDL002
     I                                       17  19 WFSEQN                CDL002
     I********************************************************************
     I* Include subroutine ZSEDIT for amounts editing:                    S01522
     I*                                                                   S01522
     I/COPY ZSRSRC,ZSEDITZ2                                               S01522
     I********************************************************************
     I* These data structures are used to format the narratives:          S01522
     I*                                                                   S01522
     I* Type 1 -- suspense:                                               S01522
     I*                                                                   S01522
     I##NDS1      DS                                                      S01522
     I I            'SUS'                     1   3 ##SUS                 S01522
     I**********                              5  19 ##ACCK                             S01522 CGL029
     I                                        5  20 ##OSAC                                    237485
     I                                        5  25 ##ACCK                                    CGL029
     I                                        5  10 ##ZRO1                S01522
     I                                       11  13 ##CCY1                S01522
     I                                       14  19 ##ZRO2                S01522
     I                                       21  26 ##DLN1                S01522
     I                                       28  30 ##EVNT                S01522
     I*                                                                   S01522
     I* Type 2 -- imbalance:                                              S01522
     I*                                                                   S01522
     I##NDS2      DS                                                      S01522
     I I            'DEALING IMBALANCE'       1  17 ##DIM                 S01522
     I                                       19  21 ##BRCD                S01522
     I                                       23  25 ##CCY2                S01522
     I                                       30  30 ##RHS2                S01522
     I*                                                                   S01522
     I* Type 3 -- others:                                                 S01522
     I*                                                                   S01522
     I##NDS3      DS                                                      S01522
     I                                        1  30 ##ALDN                S01522
     I                                        1   6 ##DLN3                S01522
     I                                        8  27 ##CRNM                S01522
     I*                                                                   S01522
     I                                        1   6 ##0649                S01522
     I                                        7  10 ##0453                S01522
     I***********                            13  18 ##0661          S01522086125
     I***********                            16  21 ##0664          S01522086125
     I***********                            17  22 ##0665          S01522086125
     I***********                            20  25 ##0668          S01522086125
     I***********                            21  26 ##0669          S01522086125
     I***********                            22  27 ##0670          S01522086125
     I***********                            23  28 ##0671          S01522086125
     I                                       12  18 ##0761                086125
     I                                       15  21 ##0764                086125
     I                                       16  22 ##0765                086125
     I                                       19  25 ##0768                086125
     I                                       20  26 ##0769                086125
     I                                       21  27 ##0770                086125
     I                                       22  28 ##0771                086125
     I                                       24  29 ##0672                S01522
     I                                       23  29 ##0772                086125
     I***********                            25  30 ##0673          S01522086125
     I***********                            24  30 ##0773          086125097379
     I                                       22  28 ##0773                097379
     I                                       12  28 ##1771                S01522
     I                                       14  30 ##1773                S01522
     I                                       30  30 ##0173                S01522
      *                                                                   CDL002
      **  Data Structure:  layout of net reference field                  CDL002
     IDSPNAR      DS                                                      CDL002
     I                                        1   3 REF                   CDL002
     I                                        4  22 RANETR                CDL002
     I                                       23  27 NET                   CDL002
     I                                       28  30 ECCY                  CDL002
      *                                                                   S01522
     I**************'DEALING ACCRUAL SUM -C         ##DLAS         S01522 125828
     I**************'MARY       '                                  S01522 125828
     I              'DEALING ACCRUAL SUMM-C         ##DLAS                125828
     I              'ARY       '                                          125828
     I              'BasCcyTaxRoundDown'  C         C#BASE                                    CDL081
     I              'SuppressFCCYWHTConv' C         C#SCON                                  MD053762
     I              'FXnetBranch'         C         FXSVAL                                  MD048346
     I**                                                                  S01117
0925 I**                                                                  S01117
     I********************************************************************S01100
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295IIPG
      *                                                                   S01408
      /EJECT                                                              S01100
     C**                                                                  S01117
     C********** *ENTRY    PLIST                                    S01117E00018
     C**********           PARM           SEQ     5                 S01117E00018
     C**********           PARM           BRNCH   3                 S01117E00018
     C**                                                                  S01117
     C   79                SETOF                         79               S01117
     C***31****************SETOF                         31         S01117E26579
     C                     Z-ADD0         ORAMT  130                                       AR813358A
     C                     Z-ADD0         NITMS   50                                       AR813358A
     C                     Z-ADD0         CHGA   130                                       AR813358A
     C                     Z-ADD0         ACODQQ  40                                       AR813358A
     C                     Z-ADD0         LTAI    10                                       AR813358A
     C                     Z-ADD0         XRFN   100                                       AR813358A
     C                     MOVE '00000'   TRAT                                             AR813358A
0470 C  N01                GOTO NOTFC
      *Set KEY List for NET ACTIONS. Use DKEYSDP Fields                   CDL002
     C           NETKEY    KLIST                                          CDL002
     C                     KFLD           BRCA                            CDL002
     C                     KFLD           ECCY                            CDL002
0471 C*
     C** GET MULTI-BRANCH INDICATOR FROM DATA AREA - RUNDAT               S01194
     C*                                                                   S01194
     C           *NAMVAR   DEFN           RUNDAT                          S01194
     C                     IN   RUNDAT                                    S01194
     C*                                                                   S01194
     C           *NAMVAR   DEFN           LDA                             S01194
     C                     IN   LDA                                       S01194
     C*
     C                     Z-ADD0         ZERO15 150                      S01182
     C                     Z-ADD0         ZERO13 130                                          CGL020
     C                     Z-ADD0         ZERO5   52                                          CGL020
     C                     MOVE *BLANKS   BLNK35 35                                           CGL020
     C                     Z-ADD500       Y                               S01094
     C                     Z-ADD0         CHQNZ   80                      S01460
     C                     Z-ADD0         ACUMZ   10                      S01460
     C                     Z-ADD0         CHGAZ  130                      S01460
     C                     Z-ADD0         CRTOT                           S01100
     C                     Z-ADD0         DRTOT                           S01100
     C                     Z-ADD0         BALSUS                          S01100
     C                     Z-ADD0         ACRLSM                          S01100
     C                     Z-ADD0         SUMACR                          S01100
     C                     MOVEL*BLANKS   DBPGM                           047225
     C                     MOVEL'DL0295'  DBPGM                           S01100
     C*****                MOVEL'TABLE'   DBFILE                   S01100 S01194
     C* Page throw check for summary accrual total lines                  S01103
     C           OVFLW     SUB  3         OVFL2   20                      S01103
     C                     SUB  1         OVFLW                           S01103
0472 C*****ACCESS INSTALATION CONTROL DATA.                               S01194
0473 C*****                MOVEL'01'      TABKEY 12                       S01194
0474 C*****                MOVE '10'      TABKEY                          S01194
0475 C*****                EXSR TABCHN                                    S01194
0476 C**N30      RECI      COMP 'D'                  3030                 S01194
     C*****      *IN30     IFEQ '1'                         B001   S01100 S01194
     C*****                MOVELTABKEY    DBKEY                    S01100 S01194
     C****                 MOVEL'001'     DBASE                SO1100     SO5452
     C*****                Z-ADD01        DBASE      **DBERR 1**   SO5452 S01194
0477 C*****                GOTO ERROR                              S01100 S01194
     C*****                END                              E001   S01100 S01194
0478 C*****      DATF      COMP 'M'                      98               S01194
     C*
     C                     MOVEACPY@      BIS@   80
     C*                                                                   047225
     C* USE ACCESS PROGRAM TO READ THE MODULE DETAILS FILE                047225
     C*                                                                   047225
     C                     CALL 'AOMMODR0'                                047225
     C                     PARM '*MSG    '@RTCD                           047225
     C                     PARM '*FIRST  '@OPTN                           047225
     C           SDMMOD    PARM SDMMOD    DSFDY                           047225
     C*                                                                   047225
     C           @RTCD     IFNE *BLANK                                    047225
     C                     MOVE '101'     DBASE            **********     047225
     C                     MOVEL'*FIRST ' DBOPTN           *  101   *     047225
     C                     MOVEL'*FIRST ' DBKEY            **********     047225
     C                     MOVEL'AOMMODPD'DBFILE                          047225
     C                     GOTO ERROR                                     047225
     C                     END                                            047225
      *                                                                   CAC001
      **  If Analytical Accounting is available, retrieve Primary         CAC001
      **  Funding Profit Centre from PF/SDPCACPD.                         CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
      *                                                                   CAC001
     C                     CALL 'AOPCACR0'                                CAC001
     C                     PARM *BLANKS   @RTCD                           CAC001
     C                     PARM '*FIRST ' @OPTN                           CAC001
     C           SDPCAC    PARM SDPCAC    DSFDY                           CAC001
     C           @RTCD     IFNE *BLANKS                                   CAC001
     C                     Z-ADD31        DBASE            ************   CAC001
     C                     MOVEL'*FIRST ' DBOPTN           * DBERR 31 *   CAC001
     C                     MOVEL'*FIRST ' DBKEY            ************   CAC001
     C                     MOVEL'SDPCACPD'DBFILE                          CAC001
     C                     GOTO ERROR                                     CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
      **  Seton indicator 54 to output Primary Funding Profit Centre      CAC001
      **  in the suspense, interbranch, summary accruals (if any), and    CAC001
      **  imbalance entries                                               CAC001
      *                                                                   CAC001
     C                     MOVE *ON       *IN54                           CAC001
      *                                                                   CAC001
     C                     ELSE                                           CAC001
     C                     MOVE *OFF      *IN54                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '001'     DBASE            **********     S01194
     C                     MOVEL'*FIRST ' DBOPTN  7        *  001   *     S01194
     C                     MOVEL'*FIRST ' DBKEY            **********     S01194
     C                     MOVEL'SDBANKPD'DBFILE                          S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0474 C*****                MOVE '11'      TABKEY                          S01194
0475 C*****                EXSR TABCHN                                    S01194
0476 C**N30      RECI      COMP 'D'                  3030                 S01194
     C*****      *IN30     IFEQ '1'                     B001       S01100 S01194
     C*****                MOVELTABKEY    DBKEY         **DBERR02* S01100 S01194
     C****                 MOVEL'002'     DBASE                S01100     SO5452
     C*****                Z-ADD02        DBASE                    SO5452 S01194
0477 C*****                GOTO ERROR                              S01100 S01194
     C*****                END                              E001   S01100 S01194
     C*
     C** READ GENERAL LEDGER DETAILS VIA ACCESS PROGRAM                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '002'     DBASE            **********     S01194
     C                     MOVEL'*FIRST ' DBOPTN  7        *  002   *     S01194
     C                     MOVEL'*FIRST ' DBKEY            **********     S01194
     C                     MOVEL'SDGELRPD'DBFILE                          S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
     C***********AKSI      IFEQ 'Y'                         B001S01100    S01117
     C**Accrual*summary report headings                         S01100    S01117
     C***********          EXCPTSMTITL                          S01100    S01117
     C***********          END                              E001S01100    S01117
     C**
     C*****      MBIN      COMP 'Y'                      77               S01194
     C           @MBIN     COMP 'Y'                      77               S01194
      *                                                                                       222171
      ** Seton main branch indicator if via main branch.  Read Main                           222171
      ** Branch Details via Access Program.                                                   222171
      *                                                                                       222171
     C**********           CALL 'AOBRCHR0'                                              222171243930
     C           BKIEMB    IFEQ 'Y'                                                         AR671726
     C                     CALL 'AOBRCHR1'                                                    243930
     C                     PARM '*MSG   ' @RTCD   7                                           222171
     C                     PARM '*KEY   ' @OPTN   7                                           222171
     C                     PARM BKMABR    @DSNB   3                                           222171
     C********** SDBRCH    PARM SDBRCH    DSFDY                                         222171243930
     C           SDBRCH    PARM SDBRCH    DSSDY                                               243930
      *                                                                                       222171
     C           @RTCD     IFNE *BLANK                                                        222171
     C                     MOVE '103'     DBASE            **********                         222171
     C                     MOVEL'*KEY   ' DBOPTN  7                                           222171
     C                     MOVELBKMABR    DBKEY                                               222171
     C                     MOVEL'SDBRCHPD'DBFILE                                              222171
     C                     GOTO ERROR                                                         222171
     C                     END                                                                222171
      *                                                                                       222171
      ** Store main branch information                                                        222171
      *                                                                                       222171
     C                     MOVE A8DFAC    @@DFAC 100                                          222171
     C                     MOVE A8DTAC    @@DTAC 100                                          222171
     C                     MOVE A8BICN    @@BICN  60                                          222171
     C                     ENDIF                                                            AR671726
     C**
0479 C*****                MOVE '20'      TABKEY                          S01194
0480 C*****                EXSR TABCHN                                    S01194
0481 C**N30      RECI      COMP 'D'                  3030                 S01194
     C*****      *IN30     IFEQ '1'                   B001         S01100 S01194
     C*****                MOVELTABKEY    DBKEY       **DBERR03**  S01100 S01194
     C****                 MOVEL'003'     DBASE               S01100      SO5452
     C*****                Z-ADD03        DBASE                    SO5452 S01194
0482 C*****                GOTO ERROR                              S01100 S01194
     C*****                END                              E001   S01100 S01194
     C*
     C** READ RETAIL DETAILS VIA ACCESS PROGRAM                           S01194
     C           BGRTBN    IFEQ 'Y'                                       047225
     C           BGIOAC    OREQ 'Y'                                       047225
     C                     CALL 'AORETLR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '003'     DBASE            **********     S01194
     C                     MOVEL'*FIRST ' DBOPTN  7        *  003   *     S01194
     C                     MOVEL'*FIRST ' DBKEY            **********     S01194
     C                     MOVEL'SDRETLPD'DBFILE                          S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
     C                     END                                            047225
0483 C*****                MOVE '40'      TABKEY                          S01194
0484 C*****                EXSR TABCHN                                    S01194
0485 C**N30      RECI      COMP 'D'                  3030                 S01194
     C*****      *IN30     IFEQ '1'                  B001          S01100 S01194
     C*****                MOVELTABKEY    DBKEY      **DBERR04**   S01100 S01194
     C****                 MOVEL'004'     DBASE                    S01100 SO5452
     C***30                Z-ADD04        DBASE                    SO5452 S01194
0486 C*****                GOTO ERROR                              S01100 S01194
     C*****                END                              E001   S01100 S01194
      *                                                                   CGL075
      ** Check feature CGL075                                             CGL075
      *                                                                   CGL075
     C                     CALL 'AOSARDR0'                                CGL075
     C                     PARM '       ' @RTCD   7                       CGL075
     C                     PARM '*KEY   ' @OPTN   7                       CGL075
     C                     PARM 'CGL075'  @SARD   6                       CGL075
     C           SCSARD    PARM SCSARD    DSFDY                           CGL075
     C*                                                                   CGL075
     C           @RTCD     IFEQ *BLANKS                                   CGL075
     C                     MOVE 'Y'       CGL075  1                       CGL075
     C                     ELSE                                           CGL075
     C                     MOVE 'N'       CGL075                          CGL075
     C                     ENDIF                                          CGL075
      *                                                                   CGL075
     C           CGL075    IFEQ 'Y'                                       CGL075
     C           *INU3     ANDEQ*ON                                       CGL075
     C                     MOVE 'N'       BKAKSI                          CGL075
     C                     ENDIF                                          CGL075
      *                                                                   CGL075
     C*                                                                   080603
     C**   CHECK 'WITHOLD TAX' SWITCH ON                                  080603
     C*                                                                   080603
     C                     CALL 'AOSARDR0'                                080603
     C                     PARM '       ' @RTCD   7                       080603
     C                     PARM '*KEY   ' @OPTN   7                       080603
     C                     PARM 'S01460'  @SARD   6                       080603
     C           SCSARD    PARM SCSARD    DSFDY                           080603
     C*                                                                   080603
     C           @RTCD     IFEQ *BLANKS                                   080603
     C                     MOVE 'Y'       S01460  1                       080603
     C                     ELSE                                           080603
     C                     MOVE 'N'       S01460                          080603
     C                     ENDIF                                          080603
      ** Check if 'CGL165' is switched 'ON'                                                   CGL165
     C                     CALL 'AOSARDR0'                                                    CGL165
     C                     PARM '       ' PRTCD                                               CGL165
     C                     PARM '*VERIFY' POPTN                                               CGL165
     C                     PARM 'CGL165'  PSARD   6                                           CGL165
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL165
      *                                                                                       CGL165
     C           PRTCD     IFEQ *BLANKS                                                       CGL165
     C                     MOVE 'Y'       CGL165  1                                           CGL165
     C                     ELSE                                                               CGL165
      *                                                                                       CGL165
     C                     MOVE 'N'       CGL165                                              CGL165
     C                     ENDIF                                                              CGL165
      ** Check if 'CDL013' is switched 'ON'                                                 MD053762
     C                     CALL 'AOSARDR0'                                                  MD053762
     C                     PARM '       ' PRTCD                                             MD053762
     C                     PARM '*VERIFY' POPTN                                             MD053762
     C                     PARM 'CDL013'  PSARD   6                                         MD053762
     C           SCSARD    PARM SCSARD    DSFDY                                             MD053762
      *                                                                                     MD053762
     C           PRTCD     IFEQ *BLANKS                                                     MD053762
     C                     MOVE 'Y'       CDL013  1                                         MD053762
     C                     ELSE                                                             MD053762
      *                                                                                     MD053762
     C                     MOVE 'N'       CDL013                                            MD053762
     C                     ENDIF                                                            MD053762
      *                                                                                     MD053762
     C           CDL013    IFEQ 'Y'                                                         MD053762
     C                     CALL 'AOSVALR0'                                                  MD053762
     C                     PARM *BLANKS   PRTCD                                             MD053762
     C                     PARM C#SCON    SVALK1 20                                         MD053762
     C                     PARM           SVAL1 200                                         MD053762
     C                     PARM *BLANK    SVALK2 20                                         MD053762
     C                     PARM           SVAL2 200                                         MD053762
     C                     PARM *BLANK    SVALK3 20                                         MD053762
     C                     PARM           SVAL3 200                                         MD053762
     C                     PARM *BLANK    SVALK4 20                                         MD053762
     C                     PARM           SVAL4 200                                         MD053762
     C                     PARM *BLANK    SVALK5 20                                         MD053762
     C                     PARM           SVAL5 200                                         MD053762
     C                     PARM *BLANK    SVALK6 20                                         MD053762
     C                     PARM           SVAL6 200                                         MD053762
     C                     PARM *BLANK    SVALK7 20                                         MD053762
     C                     PARM           SVAL7 200                                         MD053762
     C                     PARM *BLANK    SVALK8 20                                         MD053762
     C                     PARM           SVAL8 200                                         MD053762
     C                     PARM *BLANK    SVALK9 20                                         MD053762
     C                     PARM           SVAL9 200                                         MD053762
     C                     PARM *BLANK    SVALK0 20                                         MD053762
     C                     PARM           SVAL10200                                         MD053762
      *                                                                                     MD053762
     C           PRTCD     IFNE *BLANKS                                                     MD053762
     C           *LOCK     IN   LDA                                                         MD053762
     C                     MOVEL'201'     DBASE                                             MD053762
     C                     MOVEL'SDSVALPD'DBFILE                                            MD053762
     C                     MOVELSVALK1    DBKEY                                             MD053762
     C                     OUT  LDA                                                         MD053762
     C                     GOTO ERROR                                                       MD053762
     C                     ENDIF                                                            MD053762
      *                                                                                     MD053762
      ** Setup Suppress Conversion indicator                                                MD053762
      *                                                                                     MD053762
     C                     MOVELSVAL1     W#SCON  1                                         MD053762
     C                     ENDIF                                                            MD053762
     C************************************************************ 080603 117028
     C** * CHECK 'BRT' SWITCH ON ********************************* 080603 117028
     C************************************************************ 080603 117028
     C******************** CALL 'AOSARDR0' *********************** 080603 117028
     C******************** PARM '       ' @RTCD * 7 ************** 080603 117028
     C******************** PARM '*KEY   ' @OPTN * 7 ************** 080603 117028
     C******************** PARM 'S01383'  @SARD * 6 ************** 080603 117028
     C********** SCSARD ** PARM SCSARD ** DSFDY ****************** 080603 117028
     C************************************************************ 080603 117028
     C********** @RTCD *** IFEQ *BLANKS ************************** 080603 117028
     C******************** MOVE 'Y' ***** S01460 ***************** 080603 117028
     C******************** ENDIF ********************************* 080603 117028
     C************************************************************ 080603 117028
      *                                                                   CEU003
      ** Access AOSARDR0 to check if CEU003 is installed                  CEU003
      *                                                                   CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM *BLANKS   @RTCD   7                       CEU003
     C                     PARM '*VERIFY' @OPTN   7                       CEU003
     C                     PARM 'CEU003'  @SARD   6                       CEU003
      *                                                                   CEU003
     C           @RTCD     IFEQ *BLANKS                                   CEU003
     C                     MOVE 'Y'       CEU003  1                       CEU003
     C                     ELSE                                           CEU003
     C                     MOVE 'N'       CEU003                          CEU003
     C                     END                                            CEU003
      *                                                                   CEU015
      ** Access AOSARDR0 to check if CEU015 is installed                  CEU015
      *                                                                   CEU015
     C                     CALL 'AOSARDR0'                                CEU015
     C                     PARM *BLANKS   @RTCD   7                       CEU015
     C                     PARM '*VERIFY' @OPTN   7                       CEU015
     C                     PARM 'CEU015'  @SARD   6                       CEU015
      *                                                                   CEU015
     C           @RTCD     IFNE *BLANK                                    CEU015
     C           @RTCD     ANDNE'*NRF   '                                 CEU015
     C                     MOVEL'SCSARDPD'DBFILE            ************* CEU015
     C                     MOVEL'31'      DBASE             *DBERROR 031* CEU015
     C                     MOVEL'CEU015'  DBKEY             ************* CEU015
     C                     GOTO ERROR                                     CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
     C           @RTCD     IFEQ *BLANK                                    CEU015
     C                     MOVE 'Y'       CEU015  1                       CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CRE009
      ** Access AOSARDR0 to check if CRE009 is installed                  CRE009
      *                                                                   CRE009
     C                     MOVE 'N'       CRE009  1                       CRE009
      *                                                                   CRE009
     C                     CALL 'AOSARDR0'                                CRE009
     C                     PARM *BLANKS   @RTCD   7                       CRE009
     C                     PARM '*VERIFY' @OPTN   7                       CRE009
     C                     PARM 'CRE009'  @SARD   6                       CRE009
      *                                                                   CRE009
     C           @RTCD     IFNE *BLANK                                    CRE009
     C           @RTCD     ANDNE'*NRF   '                                 CRE009
     C                     MOVEL'SCSARDPD'DBFILE            ************* CRE009
     C                     MOVEL'31'      DBASE             *DBERROR 031* CRE009
     C                     MOVEL'CRE009'  DBKEY             ************* CRE009
     C                     GOTO ERROR                                     CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           @RTCD     IFEQ *BLANK                                    CRE009
     C                     MOVE 'Y'       CRE009                          CRE009
     C                     ENDIF                                          CRE009
      *
      *                                                                   CEU015
      ** Access AOSARDR0 to check if CPB005 is installed                  CPB005
      *                                                                   CPB005
     C                     CALL 'AOSARDR0'                                CPB005
     C                     PARM *BLANKS   @RTCD                           CPB005
     C                     PARM '*VERIFY' @OPTN                           CPB005
     C                     PARM 'CPB005'  @SARD                           CPB005
      *                                                                   CPB005
     C           @RTCD     IFNE *BLANK                                    CPB005
     C           @RTCD     ANDNE'*NRF   '                                 CPB005
     C                     MOVEL'SCSARDPD'DBFILE            ************* CPB005
     C                     MOVEL'35'      DBASE             *DBERROR 035* CPB005
     C                     MOVEL'CPB005'  DBKEY             ************* CPB005
     C                     GOTO ERROR                                     CPB005
     C                     ENDIF                                          CPB005
      *                                                                   CPB005
     C           @RTCD     IFEQ *BLANK                                    CPB005
     C                     MOVE 'Y'       CPB005  1                       CPB005
     C                     ELSE                                           CPB005
     C                     MOVE 'N'       CPB005                          CPB005
     C                     ENDIF                                          CPB005
      *                                                                                       233546
      ** Check if EU Taxation of Savings Income is installed                                  233546
      *                                                                                       233546
     C                     CALL 'AOSARDR0'                                                    233546
     C                     PARM *BLANKS   PRTCD   7                                           233546
     C                     PARM '*VERIFY' POPTN   7                                           233546
     C                     PARM 'CGL031'  PSARD   6                                           233546
     C           SCSARD    PARM SCSARD    DSFDY                                               233546
      *                                                                                       233546
     C           PRTCD     IFEQ *BLANKS                                                       233546
     C                     MOVE 'Y'       CGL031  1                                           233546
     C                     ELSE                                                               233546
     C                     MOVE 'N'       CGL031                                              233546
     C           PRTCD     IFNE '*NRF   '                                                     233546
     C                     MOVEL'SCSARDPD'DBFILE                                              233546
     C                     MOVEL'CGL031'  DBKEY                                               233546
     C                     Z-ADD41        DBASE                                               233546
     C                     GOTO ERROR                                                         233546
     C                     ENDIF                                                              233546
     C                     ENDIF                                                              233546
     C*                                                                   080603
     C/COPY WNCPYSRC,DL0295C036
      *                                                                                       CER049
      ** Access AOSARDR0 to check if CER049 is installed                                      CER049
      *                                                                                       CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*VERIFY' @OPTN                                               CER049
     C                     PARM 'CER049'  @SARD                                               CER049
      *                                                                                       CER049
     C           @RTCD     IFEQ *BLANK                                                        CER049
     C                     MOVE 'Y'       CER049  1                                           CER049
     C                     ELSE                                                               CER049
     C                     MOVE 'N'       CER049                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
      ** Access AOSARDR0 to check if CDL046 is installed                                      CDL046
      *                                                                                       CDL046
     C                     MOVE 'N'       CDL046  1                                           CDL046
      *                                                                                       CDL046
     C                     CALL 'AOSARDR0'                                                    CDL046
     C                     PARM *BLANKS   @RTCD   7                                           CDL046
     C                     PARM '*VERIFY' @OPTN   7                                           CDL046
     C                     PARM 'CDL046'  @SARD   6                                           CDL046
      *                                                                                       CDL046
     C           @RTCD     IFNE *BLANK                                                        CDL046
     C           @RTCD     ANDNE'*NRF   '                                                     CDL046
     C                     MOVEL'SCSARDPD'DBFILE            *************                     CDL046
     C                     MOVEL'36'      DBASE             *DBERROR 036*                     CDL046
     C                     MOVEL'CDL046'  DBKEY             *************                     CDL046
     C                     GOTO ERROR                                                         CDL046
     C                     ENDIF                                                              CDL046
      *                                                                                       CDL046
     C           @RTCD     IFEQ *BLANK                                                        CDL046
     C                     MOVE 'Y'       CDL046                                              CDL046
     C                     ENDIF                                                              CDL046
     C/COPY WNCPYSRC,DLH00388
     C*
     C** READ TRADING DETAILS VIA ACCESS PROGRAM                          S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '004'     DBASE            **********     S01194
     C                     MOVEL'*FIRST ' DBOPTN  7        *  004   *     S01194
     C                     MOVEL'*FIRST ' DBKEY            **********     S01194
     C                     MOVEL'SDTRADPD'DBFILE                          S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
      *                                                                                       232543
      ** Access Swiss Installation Control Data                                               232543
      *                                                                                       232543
     C           CGL031    IFEQ 'Y'                                                           233546
     C           *LOVAL    SETLLSDSTAXL0                                                      232543
     C                     READ SDSTAXL0                 89                                   232543
      *                                                                                       232543
     C           *IN89     IFEQ *ON                                                           232543
     C                     MOVEL'SDSTAXPD'DBFILE                                              232543
     C                     Z-ADD40        DBASE                                               232543
     C                     MOVEL'*FIRST'  DBKEY                                               232543
     C                     GOTO ERROR                                                         232543
     C                     ENDIF                                                              232543
     C                     ENDIF                                                              233546
     C*                                                                   CDL002
     C** Access SAR Details file to determine if CDL002 installed         CDL002
     C*                                                                   CDL002
     C                     CALL 'AOSARDR0'                                CDL002
     C                     PARM '       ' @RTCD                           CDL002
     C                     PARM '*VERIFY' @OPTN                           CDL002
     C                     PARM 'CDL002'  @SARD                           CDL002
     C           SCSARD    PARM SCSARD    DSFDY                           CDL002
     C           @RTCD     IFNE *BLANK                                    CDL002
     C           @RTCD     ANDNE'*NRF   '                                 CDL002
     C                     MOVEL'SCSARDPD'DBFILE           ************** CDL002
     C                     MOVEL'031'     DBASE            * DBERROR 031  CDL002
     C                     MOVEL@RTCD     DBKEY            ************** CDL002
     C                     GOTO ERROR                                     CDL002
     C                     END                                            CDL002
     C           @RTCD     IFEQ *BLANK                                    CDL002
     C                     MOVE 'Y'       CDL002  1                       CDL002
     C                     MOVE '0'       NETFLG  1                       CDL002
     C                     END                                            CDL002
     C*                                                                   CDL002
     C** Access DEALS file to determine the NET ACCOUNT code              CDL002
     C*                                                                   CDL002
     C**********           CALL 'AODEALR0'                                CDL002              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '       ' @RTCD                           CDL002
     C                     PARM '*FIRST ' @OPTN                           CDL002
     C********** SDDEAL    PARM SDDEAL    DSFDY                           CDL002              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    CDL002
     C                     MOVEL'SDDEALPD'DBFILE           ************** CDL002
     C                     MOVEL'032'     DBASE            * DBERROR 032  CDL002
     C                     MOVEL@RTCD     DBKEY            ************** CDL002
     C                     GOTO ERROR                                     CDL002
     C                     END                                            CDL002
0487 C*
0488 C***  SET UP ARRAYS OF CURRENCIES AND D.P.                           S01094
0489 C***                  EXSR CCYARR                                    S01094
     C*                                                                   S01194
     C           *BLANKS   SETLLSDCURRL1
     C                     Z-ADD0         X       30
     C           *IN99     DOUEQ'1'
     C                     READ SDCURRL1                 99
     C           *IN99     IFEQ '0'
     C                     ADD  1         X
     C**********           MOVE A6SPAE    CCYA,X                          BHF879
     C                     MOVE A6CYCD    CCYA,X                          BHF879
     C                     MOVE A6NBDP    DPA,X
     C           S01460    IFEQ 'Y'                                       S01460
     C           BGN0ST    OREQ 'Y'                                       CAC001
     C           CEU003    OREQ 'Y'                                       CEU003
     C           CGL165    OREQ 'Y'                                                           CGL165
     C/COPY WNCPYSRC,DL0295C037
     C                     MOVE A6SPRT    XSPT,X                          S01460
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0295CCPG                                           S01408
     C*                                                                   S01408
     C                     MOVE A6MDIN    XMDN,X                          S01460
     C                     MOVE A6SPAE    XSPQ,X                          S01460
     C/COPY WNCPYSRC,DL0295C093
      * If CGL165 is ON then store the Tax Conversion Rates                                   CGL165
     C           CGL165    IFEQ 'Y'                                                           CGL165
     C                     MOVE A6TXCR    TXCR,X                                              CGL165
     C                     ENDIF                                                              CGL165
     C                     ENDIF                                          S01460
     C                     END
     C                     END
0487 C*                                                                   S01117
0488 C*    SET UP ARRAY OF BRANCH DETAILS                                 S01117
0496 C                     MOVE '1'       ACK1    5                       S01117
0489 C                     EXSR BCTARR                                    S01117
0490 C*
0491 C*    SET UP FIELDS
0492 C                     Z-ADD0         Z3      30
0493 C                     Z-ADD0         Z5      50
     C                     Z-ADD99999     FLSZ    50
0494 C*****                MOVE 'A'       CLTKEY  7                       LN0109
0495 C                     BITOF'1'       PRIN    1
0496 C*****                MOVE '1'       ACK1    5                       S01117
0496 C                     MOVE 'D'       DL1                             SO5452
     C                     MOVE 'D'       DL2                             SO5452
     C*                                                                   S01460
     C           S01460    IFEQ 'Y'                                       S01460
     C           CEU003    OREQ 'Y'                                       CEU003
     C           CGL165    OREQ 'Y'                                                           CGL165
     C/COPY WNCPYSRC,DL0295C038
     C                     EXSR P01                                       S01460
     C                     ENDIF                                          S01460
0497 C**
0498 C**   ACCESS SUSPENSE A/C CODE.
0499 C*****                MOVEL'30'      TABKEY                          S01194
0500 C*****                MOVELCOMS      ACK1                            S01194
0501 C*****                MOVE ACK1      TABKEY                          S01194
0502 C*****                EXSR TABCHN                                    S01194
     C*****      *IN07     IFEQ '0'                  B001          S01100 S01194
     C*****                MOVELTABKEY    DBKEY     ***DBERR11**   S01100 S01194
     C****                 MOVEL'011'     DBASE                  SO1100   SO5452
     C*****                Z-ADD11        DBASE                    SO5452 S01194
0503 C*****                GOTO ERROR                              S01100 S01194
     C*****                END                       E001          S01100 S01194
     C*
     C** READ ACCOUNT CODE DETAILS VIA ACCESS PROGRAM                     S01194
     C                     CALL 'AOACODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C**********           PARM BKACCD    @AFNB   4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM BKACCD    @AFNB  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '011'     DBASE            **********     S01194
     C                     MOVEL@OPTN     DBOPTN  7        *  011   *     S01194
     C                     MOVEL@AFNB     DBKEY            **********     S01194
     C                     MOVEL'SDACODPD'DBFILE                          S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
0504 C*****                MOVE ATYP      ATYPS   1                       S01194
0504 C*****                MOVE A5ACCD    ATYPS   1                 S01194LN0109
0504 C                     MOVE A5ACTY    ATYPS   1                       LN0109
0504 C                     MOVE A5ACSC    ACSCS   2                       S10736
0505 C           ATYPS     COMP 'R'                      40
0506 C   40                MOVE '1'       RINDS   1
0507 C  N40                MOVE '0'       RINDS
     C*** INITIALISE RECORD TO 1 TO REPRESENT TRAILER RECORD              AUS007
     C                     Z-ADD1         BNREC                           AUS007
     C*                                                                   AUS007
     C** Access SAR details file to determine if Australian Brokerage     AUS007
     C** is switched on                                                   AUS007
     C*                                                                   AUS007
     C                     CALL 'AOSARDR0'                                AUS007
     C                     PARM *BLANKS   @RTCD                           AUS007
     C                     PARM '*VERIFY' @OPTN                           AUS007
     C                     PARM 'AUS007'  @SARD   6                       AUS007
     C           SCSARD    PARM SCSARD    DSFDY                           AUS007
     C           @RTCD     IFNE *BLANKS                                   AUS007
     C           @RTCD     ANDNE'*NRF   '                                 AUS007
     C           *LOCK     IN   LDA                        ***************AUS007
     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 013 *AUS007
     C*******              MOVEL'013'     DBASE            ********AUS007 074141
     C                     MOVEL'021'     DBASE            ***************074141
     C                     MOVEL'AUS007'  DBKEY                           AUS007
     C                     OUT  LDA                                       AUS007
     C                     SETON                     U7U8LR               AUS007
     C                     END                                            AUS007
     C           @RTCD     IFEQ *BLANK                                    AUS007
     C                     SETON                     86                   AUS007
     C                     END                                            AUS007
     C*                                                                   S01434
     C**   CHECK ROLLOVER SWITCH ON                                       S01434
     C*                                                                   S01434
     C                     CALL 'AOSARDR0'                                S01434
     C                     PARM '*MSG   ' @RTCD   7                       S01434
     C                     PARM '*KEY   ' @OPTN   7                       S01434
     C                     PARM 'S01434'  @SARD   6                       S01434
     C           SCSARD    PARM SCSARD    DSFDY                           S01434
     C*                                                                   S01434
     C           @RTCD     IFEQ *BLANKS                                   S01434
     C                     MOVE 'Y'       S01434  1                       S01434
     C                     ELSE                                           S01434
     C                     MOVE 'N'       S01434                          S01434
     C                     ENDIF                                          S01434
     C/COPY WNCPYSRC,DLH00389
     C*                                                                   S01522
     C* If UDC present                                                    S01522
     C*                                                                   S01522
     C                     MOVE 'N'       DLPNAR  1                       S01522
     C           BGN1ST    IFEQ 'Y'                        B1             S01522
     C/COPY WNCPYSRC,DLH00390
     C*                                                                   S01522
     C                     CALL 'AOSARDR0'                  1             S01522
     C                     PARM '       ' @RTCD             1             S01522
     C                     PARM '*VERIFY' @OPTN             1             S01522
     C                     PARM 'DLPNAR'  @SARD   6         1             S01522
     C           SCSARD    PARM SCSARD    DSFDY             1             S01522
     C*                                                                   S01522
     C           @RTCD     IFNE *BLANK                     B2             S01522
     C           @RTCD     ANDNE'*NRF   '                   2             S01522
     C           *LOCK     IN   LDA                         2             S01522
     C                     MOVEL'SCSARDPD'DBFILE            ************* S01522
     C                     MOVEL'089'     DBASE             *DBERROR 089* S01522
     C                     MOVEL@SARD     DBKEY             ************* S01522
     C                     OUT  LDA                         2             S01522
     C                     SETON                     U7U8LR 2             S01522
     C                     ENDIF                           E2             S01522
     C*                                                                   S01522
     C           @RTCD     IFEQ *BLANK                     B2             S01522
     C                     MOVE 'Y'       DLPNAR            2             S01522
     C                     ENDIF                           E2             S01522
     C                     ENDIF                           E1             S01522
     C*                                                                   S01434
     C*****CHECK*'WITHOLD*TAX'*SWITCH*ON*******************        S01460 080603
     C*****************************************************        S01460 080603
     C***********          CALL 'AOSARDR0'                         S01460 080603
     C***********          PARM '*MSG   ' @RTCD   7                S01460 080603
     C***********          PARM '*KEY   ' @OPTN   7                S01460 080603
     C***********          PARM 'S01460'  @SARD   6                S01460 080603
     C***********SCSARD    PARM SCSARD    DSFDY                    S01460 080603
     C***********                                                  S01460 080603
     C***********@RTCD     IFEQ *BLANKS                            S01460 080603
     C***********          MOVE 'Y'       S01460  1                S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********          MOVE 'N'       S01460                   S01460 080603
     C***********          ENDIF                                   S01460 080603
     C***********                                                  S01460 080603
0508 C****************************                                        S01100
0509 C*
0509  *
      /COPY WNCPYSRC,DL0295CCP1
0509  *
      *                                                                                       CDL033
      ** Check if 'CDL033' is switched 'ON'                                                   CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    CDL033  1                                           CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM '       ' @RTCD                                               CDL033
     C                     PARM '*VERIFY' @OPTN                                               CDL033
     C                     PARM 'CDL033'  @SARD   6                                           CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE *BLANK                                                        CDL033
     C           @RTCD     ANDNE'*NRF   '                                                     CDL033
     C           *LOCK     IN   LDA                                                           CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVEL'102'     DBASE                                               CDL033
     C                     MOVEL@SARD     DBKEY                                               CDL033
     C                     OUT  LDA                                                           CDL033
     C                     SETON                     U7U8LR                                   CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           @RTCD     IFEQ *BLANK                                                        CDL033
     C                     MOVE 'Y'       CDL033                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Check if CDL081 is installed                                                         CDL081
      *                                                                                       CDL081
     C                     MOVE 'N'       CDL081  1                                           CDL081
     C                     CALL 'AOSARDR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD   7                                           CDL081
     C                     PARM '*VERIFY' POPTN   7                                           CDL081
     C                     PARM 'CDL081'  PSARD   6                                           CDL081
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C           PRTCD     ANDNE'*NRF   '                                                     CDL081
     C           *LOCK     IN   LDA                                                           CDL081
     C                     MOVEL'075'     DBASE                                               CDL081
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL081
     C                     MOVEL'CDL081'  DBKEY                                               CDL081
     C                     OUT  LDA                                                           CDL081
     C                     GOTO ERROR                                                         CDL081
     C                     END                                                                CDL081
      *                                                                                       CDL081
     C           PRTCD     IFEQ *BLANKS                                                       CDL081
     C                     MOVE 'Y'       CDL081                                              CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Access withholding tax round down system values if CDL081 is on                      CDL081
      *                                                                                       CDL081
     C           CDL081    IFEQ 'Y'                                                           CDL081
     C                     CALL 'AOSVALR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD                                               CDL081
     C                     PARM C#BASE    SVALK1 20                                           CDL081
     C                     PARM           SVAL1 200                                           CDL081
     C                     PARM *BLANK    SVALK2 20                                           CDL081
     C                     PARM           SVAL2 200                                           CDL081
     C                     PARM *BLANK    SVALK3 20                                           CDL081
     C                     PARM           SVAL3 200                                           CDL081
     C                     PARM *BLANK    SVALK4 20                                           CDL081
     C                     PARM           SVAL4 200                                           CDL081
     C                     PARM *BLANK    SVALK5 20                                           CDL081
     C                     PARM           SVAL5 200                                           CDL081
     C                     PARM *BLANK    SVALK6 20                                           CDL081
     C                     PARM           SVAL6 200                                           CDL081
     C                     PARM *BLANK    SVALK7 20                                           CDL081
     C                     PARM           SVAL7 200                                           CDL081
     C                     PARM *BLANK    SVALK8 20                                           CDL081
     C                     PARM           SVAL8 200                                           CDL081
     C                     PARM *BLANK    SVALK9 20                                           CDL081
     C                     PARM           SVAL9 200                                           CDL081
     C                     PARM *BLANK    SVALK0 20                                           CDL081
     C                     PARM           SVAL10200                                           CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C           *LOCK     IN   LDA                                                           CDL081
     C                     MOVEL'076'     DBASE                                               CDL081
     C                     MOVEL'SDSVALPD'DBFILE                                              CDL081
     C                     MOVELSVALK1    DBKEY                                               CDL081
     C                     OUT  LDA                                                           CDL081
     C                     GOTO ERROR                                                         CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Setup tax amount rounding down indicators                                            CDL081
      *                                                                                       CDL081
     C                     MOVELSVAL1     W#BSRD  1                                           CDL081
     C                     ENDIF                                                              CDL081
      ** Check if 'CER030' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM '       ' PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER030'  PSARD   6                                           CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE *BLANKS                                                       CER030
     C           PRTCD     ANDNE'*NRF   '                                                     CER030
     C           *LOCK     IN   LDA                                                           CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     MOVEL'CER030'  DBKEY                                               CER030
     C                     MOVEL'106'     DBASE                                               CER030
     C                     OUT  LDA                                                           CER030
     C                     MOVE *ON       *INU7                                               CER030
     C                     MOVE *ON       *INU8                                               CER030
     C                     MOVE *ON       *INLR                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER030  1                                           CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER030                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CGL013' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM '       ' PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CGL013'  PSARD   6                                           CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE *BLANKS                                                       CER030
     C           PRTCD     ANDNE'*NRF   '                                                     CER030
     C           *LOCK     IN   LDA                                                           CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     MOVEL'CGL013'  DBKEY                                               CER030
     C                     MOVEL'107'     DBASE                                               CER030
     C                     OUT  LDA                                                           CER030
     C                     MOVE *ON       *INU7                                               CER030
     C                     MOVE *ON       *INU8                                               CER030
     C                     MOVE *ON       *INLR                                               CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CGL013  1                                           CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CGL013                                              CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      *                                                                                       CRE098
      ** Check if 'CRE098' is switched 'ON'                                                   CRE098
      *                                                                                       CRE098
     C                     CALL 'AOSARDR0'                                                    CRE098
     C                     PARM '       ' PRTCD                                               CRE098
     C                     PARM '*VERIFY' POPTN                                               CRE098
     C                     PARM 'CRE098'  PSARD   6                                           CRE098
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE098
      *                                                                                       CRE098
     C           PRTCD     IFNE *BLANKS                                                       CRE098
     C           PRTCD     ANDNE'*NRF   '                                                     CRE098
     C           *LOCK     IN   LDA                                                           CRE098
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE098
     C                     MOVEL'CRE098'  DBKEY                                               CRE098
     C                     MOVEL'108'     DBASE                                               CRE098
     C                     OUT  LDA                                                           CRE098
     C                     MOVE *ON       *INU7                                               CRE098
     C                     MOVE *ON       *INU8                                               CRE098
     C                     MOVE *ON       *INLR                                               CRE098
     C                     ENDIF                                                              CRE098
      *                                                                                       CRE098
     C           PRTCD     IFEQ *BLANKS                                                       CRE098
     C                     MOVE 'Y'       CRE098  1                                           CRE098
     C                     ELSE                                                               CRE098
      *                                                                                       CRE098
     C                     MOVE 'N'       CRE098                                              CRE098
     C                     ENDIF                                                              CRE098
      *                                                                                       CRE098
0510 C*    DETAIL CALCULATIONS.
0511 C           NOTFC     TAG                             ** NOTFC TAG **S01100
0512 C*
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP17                                           S01408
      *                                                                   S01408
0513 C*
0514 C*    SETOF THE NEW YORK STATE PROCESSING INDICATOR
0515 C                     SETOF                     89
0516 C*
0517 C*    INCREMENT COUNT OF RECORDS READ
0518 C***********NREC      ADD  1         NREC    50                      AUS007
     C   01                                                               AUS007
     COR 02                                                               AUS007
     COR 67      NREC      ADD  1         NREC    50                      AUS007
     C   68                ADD  1         BNREC   50                      AUS007
     C   08                ADD  1         NNREC   50                      CDL002
0519 C*
0520 C*    PROCESS DETAIL RECORDS ONLY
0521 C**                   SETOF                     31                   S01094
0522 C**N02******          GOTO END                                       AUS007
     C**N02N68***          GOTO END                                 AUS007CDL002
     C                     MOVEL'N'       IGNRCD  1                                           259642
     C           CGL075    IFEQ 'Y'                                       CGL075
     C           *INU3     ANDEQ*ON                                       CGL075
     C                     MOVEL*BLANKS   #ACRID  2                       CGL075
     C                     MOVELEVCOD     #ACRID                          CGL075
     C                     MOVE EVSUB     #ACRID                          CGL075
     C                     MOVE *IN40     SAV40                           CGL075
     C           #ACRID    LOKUPACR                      40               CGL075
     C           *IN40     IFEQ *OFF                                      CGL075
     C                     MOVE SAV40     *IN40                           CGL075
     C**********           GOTO END                                                    CGL075 259642
     C                     MOVEL'Y'       IGNRCD                                              259642
     C                     ENDIF                                          CGL075
     C                     MOVE SAV40     *IN40                           CGL075
     C                     ENDIF                                          CGL075
     C  N02N68N08          GOTO END                                       CDL002
     C/SPACE                                                              S01094
     C***********                                                         S01094
     C*                                                                   E10367
     C**  SET UP CUSTOMER GENERATED BIT SETTING                           E10367
     C*                                                                   E10367
     C                     BITOF'0'       PRIN                            E10367
     C           SETP      IFEQ 04                                        E10367
     C           SETP      OREQ 14                                        E10367
     C                     BITON'0'       PRIN                            E10367
     C                     END                                            E10367
     C*                                                                   S01117
     C*    MULTIBRANCHING OPEN/CLOSE & DATA QUEUE HANDLING                S01117
     C           *INL3     IFEQ '1'                                       S01117
      *                                                                   188100
     C           *IN74     IFEQ '1'                                       188100
     C           BKAKSI    ANDEQ'Y'                                       188100
     C                     EXCPTNODTL1                                    188100
     C                     ENDIF                                          188100
      *                                                                   188100
     C                     CLOSEDL0295P1                                  S01117
     C                     CLOSEDL0295P2                                  S01117
     C***********BRNCH     IFEQ 'ALL'                               S01117E00018
     C***********BRNCH     OREQ BRCA                                S01117E00018
     C***********          SETON                     717973ALLOW OUTS01117E00018
     C                     SETON                     7973  ALLOW OUTPUT   E00018
     C                     SETON                     74                   S01117
     C                     OPEN DL0295P1                                  S01117
     C                     OPEN DL0295P2                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE2                           S01117
     C*                                                                   S01117
     C** IF P1/P2 FILES OPENED THEN SET ON FLAG                           S01117
     C                     MOVE '1'       *IN52                           S01117
     C                     MOVE '1'       *IN97                           188100
     C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF                                S01117
     C                     Z-ADDSFNUM1    ZSNUM   60                      S01117
     C                     OUT  LDA
     C                     CALL 'ZSFILE'                                  S01117
     C***********          PARM           SEQ                       S01117E00018
     C**********           PARM *BLANKS   SEQ     5                 E00018LN0764
     C                     PARM           SEQ     5                       LN0764
     C                     PARM BRCA      @PARM                           S01117
     C                     PARM           SFILE1                          S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *
     C*******              IN   LDA                                       LN0101
     C           *LOCK     IN   LDA                                       LN0101
     C*
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF                                S01117
     C                     Z-ADDSFNUM2    ZSNUM   60                      S01117
     C                     OUT  LDA
     C                     CALL 'ZSFILE'                                  S01117
     C******************** PARM           SEQ                       S01117E00018
     C**********           PARM *BLANKS   SEQ                       E00018LN0764
     C                     PARM           SEQ                             LN0764
     C                     PARM BRCA      @PARM                           S01117
     C                     PARM           SFILE2                          S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C******               IN   LDA                                       LN0101
     C           *LOCK     IN   LDA                                       LN0101
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**                                                                  S01117
     C*********************ELSE                                     S01117E00018
     C*********************SETOF                     717374         S01117E00018
     C*********************END                                      S01117E00018
      *                                                                   188100
      ** Execute SR/BRCVAL to ensure that a report is generated           188100
      ** even if there are no details for that branch.                    188100
      *                                                                   188100
     C                     EXSR BRCVAL                                    188100
     C                     END                                            S01117
     C***********                                                  E10367 080603
     C**Branch*change                                              S01094 080603
     C************INL3     IFEQ '1'                         B001   S01094 080603
     C***********                                                  S01460 080603
     C*****INITIALISE TOTALS IN BASE CURRENCY, CRBAS & DRBAS       S01460 080603
     C***********                                                  S01460 080603
     C***********S01460    IFEQ 'Y'                                S01460 080603
     C***********          Z-ADD0         CRBAS  150               S01460 080603
     C***********          Z-ADD0         DRBAS  150               S01460 080603
     C***********          ENDIF                                   S01460 080603
     C***********                                                  S01460 080603
0552 C*****ACCESS BRANCH CODE TABLE TO OBTAIN BRANCH INTERNAL      S01094 S01194
0553 C*****CUSTOMER NO.                                            S01094 S01194
0554 C*****                MOVEL'10      'TABKEY                   S01094 S01194
0555 C*****                MOVE '    '    TABKEY                   S01094 S01194
0556 C*****                MOVE BRCD      TABKEY                    S01094S01117
0556 C*****                MOVE BRCA      TABKEY                   S01117 S01194
0557 C*****                EXSR TABCHN                             S01094 S01194
0558 C*****      *IN10     IFEQ '0'                         B002    S01094S01117
0558 C*****      *IN30     IFEQ '1'                  B002          S01117 S01194
     C*****      RECI      ORNE 'D'                                S01117 S01194
     C*****                MOVEL'TABLE'   DBFILE                   S01100 S01194
     C*****                MOVELTABKEY    DBKEY      **DBERR05**   S01100 S01194
     C****                 MOVEL'005'     DBASE               S01100      SO5452
     C*****                Z-ADD05        DBASE                    SO5452 S01194
0482 C*****                GOTO ERROR                              S01100 S01194
     C*****                END                              E002   S01100 S01194
     C***********                                                         080603
     C***READ*BRANCH DETAILS VIA ACCESS PROGRAM                    S01194 080603
     C****TO*OBTAIN INTERNAL BRANCH CUSTOMER NO.                   S01194 080603
     C***********          CALL 'AOBRCHR0'                         S01194 080603
     C***********          PARM '*MSG   ' @RTCD   7                S01194 080603
     C***********          PARM '*KEY   ' @OPTN   7                S01194 080603
     C***********          PARM BRCA      @DSNB   3                S01194 080603
     C***********SDBRCH    PARM SDBRCH    DSFDY                    S01194 080603
     C***********@RTCD     IFNE *BLANK                             S01194 080603
     C***********          MOVE '005'     DBASE            **********1194 080603
     C***********          MOVEL@OPTN     DBOPTN  7        *  005   *1194 080603
     C***********          MOVEL@DSNB     DBKEY            **********1194 080603
     C***********          MOVEL'SDBRCHPD'DBFILE                   S01194 080603
     C***********          GOTO ERROR                              S01194 080603
     C***********          END                                     S01194 080603
 822 C***********                                                  S01094 080603
     C************IN77     IFEQ '1'                         B002   S01094 080603
     C***********          MOVE ATYP      SATYP   1                S01094 S01194
     C***********          MOVE A5ACCD    SATYP   1                S01194 LN0109
     C***********          MOVE A5ACTY    SATYP   1                LN0109 080603
     C***********          MOVE A5ACSC    SACSC   2                S10736 080603
 822 C*****ACCESS ACCOUNT CODES TABLE                              S01094 S01194
0823 C*****                MOVE '        'TABKEY                   S01094 S01194
0824 C*****                MOVEL'30'      TABKEY                   S01094 S01194
0825 C*****                MOVELIBAB      ACK1                     S01094 S01117
0825 C*****                MOVELADTO      ACK1                     S01117 S01194
0826 C*****                MOVE ACK1      TABKEY                   S01094 S01194
0827 C*****                EXSR TABCHN                             S01094 S01194
     C*****      *IN07     IFEQ '0'                         B003   S01094 S01194
     C*****                MOVEL'TABLE'   DBFILE                   S01100 S01194
     C*****                MOVELTABKEY    DBKEY      **DBERR06**   S01100 S01194
     C****                 MOVEL'006'     DBASE               SO1100      SO5452
     C*****                Z-ADD06        DBASE                    SO5452 S01194
0482 C*****                GOTO ERROR                              S01100 S01194
     C*****                END                              E003   S01100 S01194
     C***********                                                         080603
     C***READ*ACCOUNT DETAILS VIA ACCESS PROGRAM                   S01194 080603
     C***********          CALL 'AOACODR0'                         S01194 080603
     C***********          PARM '*MSG   ' @RTCD   7                S01194 080603
     C***********          PARM '*KEY   ' @OPTN   7                S01194 080603
     C***********          PARM A8DTAC    @AFNB   4                S01194 080603
     C***********SDACOD    PARM SDACOD    DSFDY                    S01194 080603
     C***********@RTCD     IFNE *BLANK                             S01194 080603
     C***********          MOVE '006'     DBASE            **********1194 080603
     C***********          MOVEL@OPTN     DBOPTN  7        *  006   *1194 080603
     C***********          MOVEL@AFNB     DBKEY            **********1194 080603
     C***********          MOVEL'SDACODPD'DBFILE                   S01194 080603
     C***********          GOTO ERROR                              S01194 080603
     C***********          END                                     S01194 080603
     C***********                                                  S01094 080603
     C***********          MOVE ATYP      BATYP   1                S01094 S01194
     C***********          MOVE A5ACCD    BATYP   1                S01194 LN0109
     C***********          MOVE A5ACTY    BATYP   1                LN0109 080603
     C***********BATYP     COMP 'R'                      32        S01094 080603
     C***32******          MOVE '1'       BRINDA  1                S01094 080603
     C**N32******          MOVE '0'       BRINDA                   S01094 080603
     C***********                                                  S01094 080603
0823 C*****                MOVE '        'TABKEY                          S01094
0824 C*****                MOVEL'30'      TABKEY                          S01094
0825 C*****                MOVELIBAH      ACK1                     S01094 S01117
0825 C*****                MOVELADFR      ACK1                            S01117
0826 C*****                MOVE ACK1      TABKEY                          S01094
0827 C*****                EXSR TABCHN                                    S01094
     C*****      *IN07     IFEQ '0'                         B003          S01094
     C*****                MOVEL'TABLE'   DBFILE                          S01100
     C*****                MOVELTABKEY    DBKEY             **DBERR07**   S01100
     C****                 MOVEL'007'     DBASE               S01100      SO5452
     C*****                Z-ADD07        DBASE                           SO5452
0482 C*****                GOTO ERROR                                     S01100
     C*****                END                              E003          S01100
     C***********                                                         080603
     C***READ*ACCOUNT DETAILS VIA ACCESS PROGRAM                   S01194 080603
     C***********          CALL 'AOACODR0'                         S01194 080603
     C***********          PARM '*MSG   ' @RTCD   7                S01194 080603
     C***********          PARM '*KEY   ' @OPTN   7                S01194 080603
     C***********          PARM A8DFAC    @AFNB   4                S01194 080603
     C***********SDACOD    PARM SDACOD    DSFDY                    S01194 080603
     C***********@RTCD     IFNE *BLANK                             S01194 080603
     C***********          MOVE '007'     DBASE            **********1194 080603
     C***********          MOVEL@OPTN     DBOPTN  7        *  007   *1194 080603
     C***********          MOVEL@AFNB     DBKEY            **********1194 080603
     C***********          MOVEL'SDACODPD'DBFILE                   S01194 080603
     C***********          GOTO ERROR                              S01194 080603
     C***********          END                                     S01194 080603
     C***********                                                         S01094
     C***********          MOVE ATYP      HATYP   1                S01194 S01194
     C***********          MOVE A5ACCD    HATYP   1                S01194 LN0109
     C***********          MOVE A5ACTY    HATYP   1                LN0109 080603
     C***********HATYP     COMP 'R'                      32        S01094 080603
     C***32******          MOVE '1'       HRINDA  1                S01094 080603
     C**N32******          MOVE '0'       HRINDA                   S01094 080603
     C***********                                                         S01094
     C***********          MOVE SATYP     ATYP                     S01094 S01194
     C***********          MOVE SATYP     A5ACCD                   S01194 LN0109
     C***********          MOVE SATYP     A5ACTY                          LN0109
     C***********          MOVE SACSC     A5ACSC                          S10736
     C***********          SETOF                         32        S01094 080603
     C***********                                                  S01094 080603
     C***********          END                              E002   S01094 080603
     C***********          END                              E001   S01094 080603
     C/SPACE                                                              S01100
     C***********                                                         S01100
     C           *INL2     IFEQ '1'                         B001          S01100
     C* Currency and/or branch change                                     S01100
     C*                                                                   S01460
     C           S01460    IFEQ 'Y'                                       S01460
     C           CEU003    OREQ 'Y'                                       CEU003
     C           CGL165    OREQ 'Y'                                                           CGL165
     C/COPY WNCPYSRC,DL0295C039
     C                     EXSR P02                                       S01460
     C                     ENDIF                                          S01460
     C*                                                                   S01460
     C                     Z-ADD0         CRTOT                           S01100
     C                     Z-ADD0         DRTOT                           S01100
     C                     Z-ADD1         X                               S01100
     C           ECCY      LOKUPCCYA,X                   40               S01100
     C*****                MOVE CCYDT,X   CCYDET                   S01100 S01194
0541 C*****      XDECP     COMP 1                      2021        S01100 S01194
0542 C*****      XDECP     COMP 2                    23  22        S01100 S01194
0541 C           DPA,X     COMP 1                      2021               S01194
0542 C           DPA,X     COMP 2                    23  22               S01194
     C                     END                              E001          S01100
     C*
     C** SKIP DETAIL PROCESSING IF RECORD IS TO BE IGNORED                                    259642
     C           IGNRCD    IFEQ 'Y'                                                           259642
     C                     GOTO END                                                           259642
     C                     ENDIF                                                              259642
     C/SPACE                                                              S01094
     C***********                                                         S01094
     C           *INL1     IFEQ '1'                         B001          S01094
     C           *IN08     ANDEQ'0'                                       CDL002
     C* Account key change and/or currency change and/or branch change    S01094
     C***********          MOVE '0'       *IN31                 S01094    S01117
     C                     MOVE '0'       *IN31                           E26579
0532 C*    Access a/c keys record.                                        S01094
0533 C                     SETOF                     04                   S01094
0534 C*********************MOVELAKEY      AKKEY  12                S01094 CDL038
0534 C                     MOVELAKEY      AKKEY  14                       CDL038
0535 C           AKKEY     CHAINACKEY                30                   S01094
     C/COPY WNCPYSRC,DL0295C087
      *                                                                                       CER049
      ** Set sequence numbers to '01' if they are blank                                       CER049
      *                                                                                       CER049
     C           1         DO   6         N                                                   CER049
     C           ASQ,N     IFLT '01'                                                          CER049
     C                     MOVE '01'      ASQ,N                                               CER049
     C                     ENDIF                                                              CER049
     C                     ENDDO                                                              CER049
      *                                                                                       CER049
0536 C  N04                SETON                     31U4                 S01094
     C   31 73             SETOF                     73                   S01117
     C*                                                                   S01103
     C*****      AKSI      IFEQ 'Y'                         B002   S01103 S01194
     C           BKAKSI    IFEQ 'Y'                         B002          S01194
     C*                                                                   E12064
     C**  SET OFF POSTING REFERENCE TYPE INDICATORS                       E12064
     C*                                                                   E12064
     C                     SETOF                     343536               E12064
     C*   Accrual Summary Postings per branch/currency/acc key required   S01103
     C                     MOVE '0'       *IN88                           S01103
     C                     Z-ADD0         SUMACR                          S01103
     C                     Z-ADD0         ACRLSM                          S01103
     C           *IN31     IFNE '1'                         B003          S01103
     C                     MOVELEVCOD     ACRID                           S01103
     C                     MOVE EVSUB     ACRID                           S01103
     C                     Z-ADD1         X                               S01103
     C           ACRID     LOKUPACR,X                    88               S01103
     C                     END                              E003          S01103
     C/COPY WNCPYSRC,DL0295C005
     C                     END                              E002          S01103
     C                     END                              E001          S01094
0523 C***********                                                         S01094
     C***********                                                   E24720E28679
     C** OBTAIN COUNTERPARTY                                              E24725
     C***********                                                   E24720E28679
     C************LIKE     DEFN CNUM      CPTY                      E24720E28679
     C************LIKE     DEFN DTYP      DELTYP                    E24720E28679
     C***********          MOVELAKEY      DELTYP                    E24720E28679
     C***********DELTYP    IFNE 'C2'                                E24720E28679
     C***********DELTYP    ANDNE'BD'                                E24720E28679
     C***********DELTYP    ANDNE'BP'                                E24720E28679
     C***********          MOVE CNUM      CPTY                      E24720E28679
     C***********          ELSE                                     E24720E28679
     C***********DLNO      CHAINDEALS                30             E24720E28679
     C************IN30     IFEQ '1'                                 E24720E28679
     C***********          MOVEL'DEALS'   DBFILE                    E24720E28679
     C***********          MOVELDLNO      DBKEY       **DBERR20**   E24720E28679
     C***********          Z-ADD20        DBASE                     E24720E28679
     C***********          GOTO ERROR                               E24720E28679
     C***********          END                                      E24720E28679
     C***********KEYTP     IFEQ 'I'                                 E24720E28679
     C***********          MOVE ISCN      CPTY                      E24720E28679
     C***********          ELSE                                     E24720E28679
     C***********          MOVE CNUMD     CPTY                      E24720E28679
     C***********          END                                      E24720E28679
     C***********          END                                      E24720E28679
     C***********                                                   E24720E28679
     C***For*Nostro*transfers,*the*counterparty*used*for*NR*must*be*E24720E28679
     C***the*customer*of*the*Nostro*Account:************************E24720E28679
     C***********                                                   E24720E28679
     C***********DELTYP    IFEQ 'NX'                                E24720E28679
     C***********                                                   E24720E28679
     C***READ*NOSTRO*DETAILS*VIA*ACCESS*PROGRAM*********************E24720E28679
     C***********                                                   E24720E28679
     C***********          CALL 'AONOSTR0'                          E24720E28679
     C***********          PARM '*MSG   ' @RTCD                     E24720E28679
     C***********          PARM '*KEY    '@OPTN                     E24720E28679
     C***********          PARM *BLANK    @KEYA                     E24720E28679
     C***********          PARM ECCY      @KEYB                     E24720E28679
     C***********          PARM *BLANK    @KEYC                     E24720E28679
     C***********          PARM *BLANK    @KEYD                     E24720E28679
     C***********          PARM NOSC      @KEYE                     E24720E28679
     C***********          PARM           @BRCD      I:Branch Code  E24720E28679
     C***********          PARM           @CSSN      I:Cust ShortN  E24720E28679
     C***********          PARM           @PNOI      I:Prime Nost InE24720E28679
     C***********SDNOST    PARM SDNOST    DSFDY                     E24720E28679
     C***********                                                   E24720E28679
     C***********@RTCD     IFEQ *BLANK                              E24720E28679
     C***********          MOVE A7CUST    CPTY                      E24720E28679
     C***********          ELSE                                     E24720E28679
     C***********          Z-ADD24        DBASE                     E24720E28679
     C***********          MOVEL'SDNOSTPD'DBFILE                    E24720E28679
     C***********          MOVELECCY      DBKEY                     E24720E28679
     C***********          MOVE NOSC      DBKEY                     E24720E28679
     C***********          GOTO ERROR                               E24720E28679
     C***********          END                                      E24720E28679
     C***********          END                                      E24720E28679
0524 C*    ADD EVENT AMOUNT TO HASH TOTAL                                 S01094
0525 C***********          Z-ADD1         S       10                      AUS007
     C   02                Z-ADD1         S       10                      AUS007
     C   68                Z-ADD3         S                               AUS007
     C   08                Z-ADD4         S                               CDL002
0526 C*****      EAMT      DIV  1000      ZZAMT          40               S01117
1217 C                     Z-ADD0         ZAMT   153                      S01117
0526 C           EAMT      DIV  1000      ZAMT           40               S01117
0526 C                     Z-ADDZAMT      ZZAMT                           S01117
0527 C*
0528 C*    IGNORE RECORDS WITH ZERO POSTING AMOUNT
0529 C   40                GOTO END                                   S
     C                     Z-ADD1         Z                               S01094
0530 C                     EXSR HASH
     C*                                                                   S05452
     C**   SET UP THE DEAL REFERENCE                                      S05452
     C*                                                                   S05452
     C                     MOVE 'D'       DL2                             105222
     C                     MOVE DLNO      DLNO2                           S05452
0551 C*                                                                   E36918
0551 C*    ON CHANGE OF BOOKING BRANCH ACCESS BRANCH CODE ARRAY TO OBTAIN E36918
0552 C*    BRANCH DETAILS                                                 E36918
0551 C*                                                                   E36918
0551 C           BRCA      COMP STBRCD               7575                 E36918
0551 C   75                MOVE BRCA      STBRCD  3                       E36918
0551 C*                                                                   E36918
     C   75                DO                                             E36918
     C                     SETOF                         10               E36918
     C                     Z-ADDSTIX      IX                              E36918
0556 C           BRCA      LOKUPBCC,IX                   10               E36918
0558 C  N10                GOTO ERROR                                     E36918
0556 C                     MOVE BCT,IX    BBCI                            E36918
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0295CCP7                                           S01408
      *                                                                   S01408
     C                     END                                            E36918
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0295CCP8                                           S01408
      *                                                                   S01408
     C*                                                                   CDL002
     C** Process FX Net action records separately                         CDL002
     C*                                                                   CDL002
     C           *IN08     IFEQ '1'                                       CDL002
     C                     EXSR NETPST                                    CDL002
     C                     GOTO END                                       CDL002
     C                     END                                            CDL002
0531 C*
0532 C**   ACCESS A/C KEYS RECORD.                                        S01094
0533 C**                   SETOF                     04                   S01094
0534 C**                   MOVELAKEY      AKKEY  12                       S01094
0535 C**         AKKEY     CHAINACKEY                30                   S01094
0536 C**N04                SETON                     31                   S01094
0537 C*
0538 C**   SET INDICATOR FOR NO. OF D.P. FOR EVENT CURRENCY.              S01100
0539 C**                   MOVE ECCY      XCCY                            S01100
0540 C**                   EXSR CCYDEP                                    S01100
0541 C**         XDECP     COMP 1                      2021               S01100
0542 C**         XDECP     COMP 2                    23  22               S01100
0543 C*    PRINT DETAILS OF A/C KEY IF MISSING FROM FILE
0544 C** 31                SETON                     U4                   S01094
0545 C   31                Z-ADDEDAT      ZDAYNO
0546 C   31                EXSR ZDATE2
0547 C   31                GOTO END
      *                                                                   CAC001
      **  Perform summary accruals processing only if Analytical          CAC001
      **  Accounting is not installed; or if Analytical Accounting        CAC001
      **  is installed and account key is a Midas generated a/c key       CAC001
      *                                                                   CAC001
     C           BGN0ST    IFNE 'Y'                                       CAC001
     C           BGN0ST    OREQ 'Y'                                       CAC001
     C           AKEY6     ANDNE'T'                                       CAC001
     C           AKEY6     ANDNE'F'                                       CAC001
0548 C*
     C           *IN88     IFEQ '1'                          B001         S01103
     C*                                                                   S10736
     C**    On summary accruals, blank out BOKC and zero out CNUM.        S10736
     C*                                                                   S10736
     C/COPY WNCPYSRC,DL0295C006
     C**********           Z-ADD0         CNUM                                         S10736 CSD027
     C                     MOVE *BLANKS   CNUM                                                CSD027
     C                     MOVE *BLANKS   BOKC                            S10736
     C/COPY WNCPYSRC,DL0295C007
     C*     Summary posting to be produced                                S01103
     C           *IN19     IFEQ '1'                          B002         S01103
     C                     ADD  EAMT      SUMACR                          S01103
     C                     ELSE                              X002         S01103
     C                     SUB  EAMT      SUMACR              Reversal    S01103
     C                     END                               E002         S01103
      *                                                                   102171
     C*    CHECK THAT A POSITIVE AMOUNT IS POSTED.                        102171
     C   18                Z-SUBEAMT      EAMT                            102171
      *                                                                   102171
     C           CURLIN    IFGE OVFLW                        B002         S01103
     C           *IN74     OREQ '1'                                       S01117
     C* New page header for accrual summary report                        S01103
     C                     EXCPTSMTITL                                    S01103
     C                     END                               E002         S01103
     C* Detail line                                                       S01103
     C                     EXCPTSUMDET                                    S01103
     C   74                SETOF                     74                   S01117
     C/COPY WNCPYSRC,DL0295C008
     C                     GOTO END                                       S01103
     C/COPY WNCPYSRC,DL0295C009
     C                     END                               E001         S01103
      *                                                                   CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   S01103
0549 C*****CHECK THAT A POSITIVE AMOUNT IS POSTED.                        102171
0550 C***18                Z-SUBEAMT      EAMT                            102171
     C*    CHECK THAT A POSITIVE AMOUNT IS POSTED.                        109482
     C   18                Z-SUBEAMT      EAMT                            109482
     C*                                                                   S01460
     C           S01460    IFEQ 'Y'                                       S01460
     C           CGL165    OREQ 'Y'                                                           CGL165
     C                     EXSR P03                                       S01460
     C                     ENDIF                                          S01460
0551 C*
     C/COPY WNCPYSRC,DL0295C040
     C*                                                                   SO5452
0549 C**   BUILD SWIFT COMMON REFERENCE FOR DEAL                          SO5452
     C*                                                                   SO5452
0550 C                     EXSR SWCREF                                    SO5452
0550 C   30                GOTO ERROR                                     SO5452
0551 C*                                                                   SO5452
0552 C**   ACCESS BRANCH CODE TABLE TO OBTAIN BRANCH INTERNAL             S01094
0553 C**   CUSTOMER NO.                                                   S01094
0554 C**                   MOVEL'10      'TABKEY                          S01094
0555 C**                   MOVE '    '    TABKEY                          S01094
0556 C**                   MOVE BRCD      TABKEY                          S01094
0557 C**                   EXSR TABCHN                                    S01094
0558 C**N10                GOTO ERROR                                     S01094
 822 C**                                                                  S01094
     C** 77                DO                                             S01094
     C**                   MOVE ATYP      SATYP   1                       S01094
 822 C**   ACCESS ACCOUNT CODES TABLE                                     S01094
0823 C**                   MOVE '        'TABKEY                          S01094
0824 C**                   MOVEL'30'      TABKEY                          S01094
0825 C**                   MOVELIBAB      ACK1                            S01094
0826 C**                   MOVE ACK1      TABKEY                          S01094
0827 C**                   EXSR TABCHN                                    S01094
     C**N07                GOTO ERROR                                     S01094
     C**                                                                  S01094
     C**                   MOVE ATYP      BATYP   1                       S01094
     C**         BATYP     COMP 'R'                      32               S01094
     C** 32                MOVE '1'       BRINDA  1                       S01094
     C**N32                MOVE '0'       BRINDA                          S01094
     C**                                                                  S01094
0823 C**                   MOVE '        'TABKEY                          S01094
0824 C**                   MOVEL'30'      TABKEY                          S01094
0825 C**                   MOVELIBAH      ACK1                            S01094
0826 C**                   MOVE ACK1      TABKEY                          S01094
0827 C**                   EXSR TABCHN                                    S01094
     C**N07                GOTO ERROR                                     S01094
     C**                                                                  S01094
     C**                   MOVE ATYP      HATYP   1                       S01094
     C**         HATYP     COMP 'R'                      32               S01094
     C** 32                MOVE '1'       HRINDA  1                       S01094
     C**N32                MOVE '0'       HRINDA                          S01094
     C**                                                                  S01094
     C**                   MOVE SATYP     ATYP                            S01094
     C**                   SETOF                         32               S01094
     C**                                                                  S01094
     C**                   END                                            S01094
0551 C***********                                                  S01117 E36918
0551 C*****ON*CHANGE*OF*BOOKING*BRANCH*ACCESS*BRANCH*CODE*ARRAY*TO*OBTAIN E36918
0552 C*****BRANCH*DETAILS******************************************S01117 E36918
0551 C***********                                                  S01117 E36918
0551 C***********BRCA      COMP STBRCD               7575          S01117 E36918
0551 C***75******          MOVE BRCA      STBRCD  3                S01117 E36918
0551 C***********                                                  S01117 E36918
     C***75******          DO                                      S01117 E36918
     C***********          SETOF                         10        S01117 E36918
     C***********          Z-ADDSTIX      IX                       S01117 E36918
0556 C***********BRCA      LOKUPBCC,IX                   10        S01117 E36918
0558 C**N10******          GOTO ERROR                              S01117 E36918
0556 C***********          MOVE BCT,IX    BBCI                     S01117 E36918
     C***********          END                                     S01117 E36918
      *                                                                   E11609
      ** If account code blank set to 0.                                  E11609
     C           ACODA     IFEQ *BLANKS                                   E11609
     C                     MOVE *ALL'0'   ACODA                           E11609
     C                     END                                            E11609
     C           CDL002    IFEQ 'Y'                                       CDL002
      ** Check for NETTING DEAL if FX. set IND for NARRATIVE and to       CDL002
      ** suppress POSTING reference 2 POSTINGS                            CDL002
     C           DTYP      LOKUPFXTY                     07               CDL002
     C           *IN07     IFEQ '1'                                       CDL002
      ** SETOF NET INDICATOR again to set default of NET NO               CDL002
     C                     MOVE '0'       *IN07                           CDL002
     C           DLNO      CHAINDEALS                40                   CDL002
     C           *IN40     IFEQ '0'                                       CDL002
     C** Preparation for getting FX Net Reference Depending on B/S                          MD048346
     C           SVBRCA    IFEQ *BLANKS                                                     MD048346
     C           *LIKE     DEFN NETBR     FXNETR                                            MD048346
     C                     ENDIF                                                            MD048346
      ** Check NET against last character of ACCOUNT                      CDL002
      ** KEY (Which gives PURCHASE or SALE indication)                    CDL002
     C           EVSUB     IFEQ 'B'                                       CDL002
     C           EVSUB     OREQ 'P'                                       CDL002
      ** PURCHASE KEYS                                                    CDL002
     C********** NETBY     COMP 'Y'                      07                          CDL002 MD049950
     C           NETBY     IFEQ 'Y'                                                         MD049950
     C           NETBR     ANDNE*BLANKS                                                     MD049950
     C                     MOVE '1'       *IN07                                             MD049950
     C                     ENDIF                                                            MD049950
     C           SVBRCA    IFEQ *BLANKS                                                     MD048346
     C                     MOVE NETBR     FXNETR                                            MD048346
     C                     ENDIF                                                            MD048346
     C                     ELSE                                           CDL002
     C           EVSUB     IFEQ 'C'                                       CDL002
     C           EVSUB     OREQ 'S'                                       CDL002
      ** SALE KEYS                                                        CDL002
     C********** NETSL     COMP 'Y'                      07                          CDL002 MD049950
     C           NETSL     IFEQ 'Y'                                                         MD049950
     C           NETSR     ANDNE*BLANKS                                                     MD049950
     C                     MOVE '1'       *IN07                                             MD049950
     C                     ENDIF                                                            MD049950
     C           SVBRCA    IFEQ *BLANKS                                                     MD048346
     C                     MOVE NETSR     FXNETR                                            MD048346
     C                     ENDIF                                                            MD048346
     C                     ELSE                                           CDL002
      ** If not PURCHASE or SALE then check for SWAP PROFIT/LOSS          CDL002
     C           EVSUB     IFEQ 'H'                                       CDL002
     C           EVSUB     OREQ 'L'                                       CDL002
      ** Need to check POSTING currency against NET REFERENCE CCY         CDL002
     C                     MOVELECCY      CHKNCY  3                       CDL002
     C                     MOVE NETBR     NETFMT                          CDL002
     C           CHKNCY    IFEQ WFCCY                                     CDL002
     C                     MOVE '1'       *IN07                           CDL002
     C                     ELSE                                           CDL002
     C                     MOVE NETSR     NETFMT                          CDL002
     C           CHKNCY    IFEQ WFCCY                                     CDL002
     C                     MOVE '1'       *IN07                           CDL002
     C                     END                                            CDL002
     C                     END                                            CDL002
     C                     END                                            CDL002
     C                     END                                            CDL002
     C                     END                                            CDL002
     C                     END                                            CDL002
     C                     END                                            CDL002
     C                     END                                            CDL002
0559 C*
0560 C*    LOOP TO ACCESS A/C CODES FROM A/C KEY RECORD
0561 C                     Z-ADD0         N       10
0562 C           NEXT      TAG                             ** NEXT TAG **
0563 C           N         ADD  1         N
0564 C*
0565 C*    CHECK IF ALL A/C CODE PROCESSED.
0566 C           N         COMP 6                    32
0567 C   32                GOTO END
0568 C*
0569 C*    IGNORE ENTRIES WHERE ACOD & PREF BOTH BLANK.
0570 C           ACOD,N    COMP 0                        32
0571 C   32      PREF,N    COMP 0                        32
0572 C   32                GOTO NEXT
0573 C*
0574 C*    CHECK POSTING REFERENCE.
0575 C           PREF,N    COMP 2                    363435
0576 C*
0577 C*    OBTAIN DATA COMMON TO ALL POSTING TYPES.
0578 C           ACOD,N    COMP 0                        40
     C           PREF,N    IFEQ 1                                                           AR784704
     C           *IN40     ANDEQ'1'                                                         AR784704
     C           PREF,N    OREQ 3                                                           AR784704
     C           *IN40     ANDEQ'1'                                                         AR784704
     C                     MOVE BKACCD    ACOD,N                                            AR784704
     C                     SETOF                         40                                AR784704A
     C                     ENDIF                                                            AR784704
0579 C   40                GOTO NARTAG
0580 C*    ACCESS A/C CODES TABLE.
     C                     Z-ADDY         X                               S01094
     C           ACOD,N    LOKUPACD,X                    40               S01094
     C           *IN40     IFEQ '1'                         B001          S01094
     C*****                MOVELATY,X     ATYP                     S01094 S01194
     C*****                MOVELATY,X     A5ACCD                   S01194 LN0109
     C                     MOVELATY,X     A5ACTY                          LN0109
     C                     MOVE ACS,X     A5ACSC                          S10736
     C                     ELSE                             X001          S01094
0581 C*****                MOVE '        'TABKEY
0582 C*****                MOVEL'30'      TABKEY
0583 C*****                MOVELACOD,N    ACK1
0584 C*****                MOVE ACK1      TABKEY
0585 C*****                EXSR TABCHN
0586 C*****      *IN07     IFEQ '0'                         B002          S01094
     C*****                MOVEL'TABLE'   DBFILE                          S01100
     C*****                MOVELTABKEY    DBKEY             **DBERR08**   S01100
     C****                 MOVEL'008'     DBASE               S01100      SO5452
     C*****                Z-ADD08        DBASE                           SO5452
0482 C*****                GOTO ERROR                                     S01100
     C*****                END                              E002          S01100
     C*
     C** READ ACCOUNT DETAILS VIA ACCESS PROGRAM                          S01194
     C**********           MOVELACOD,N    @AFNB   4                                    S01194 CGL029
     C                     MOVELACOD,N    @AFNB                                               CGL029
     C                     CALL 'AOACODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C**********           PARM           @AFNB   4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM           @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '008'     DBASE            **********     S01194
     C                     MOVEL@OPTN     DBOPTN  7        *  008   *     S01194
     C                     MOVEL@AFNB     DBKEY            **********     S01194
     C                     MOVEL'SDACODPD'DBFILE                          S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
     C           Y         IFGT 1                           B002          S01094
     C                     SUB  1         Y                               S01094
     C                     Z-ADDACOD,N    ACD,Y                           S01094
     C*****                MOVE ATYP      ATY,Y                    S01094 S01194
     C*****                MOVE A5ACCD    ATY,Y                    S01194 LN0109
     C                     MOVE A5ACTY    ATY,Y                           LN0109
     C                     MOVE A5ACSC    ACS,Y                           S10736
     C                     END                              E002          S01094
     C                     END                              E001          S01094
0587 C*
0588 C*    TEST A/C TYPE.
0589 C*****      ATYP      COMP 'R'                      38               S01194
0589 C******     A5ACCD    COMP 'R'                      38        S01194 LN0109
0589 C           A5ACTY    COMP 'R'                      38               LN0109
0590 C*
0591 C*    SET UP NARRATIVE.
0592 C           NARTAG    TAG                             ** NARTAG **
0593 C                     EXSR NARRA
0594 C   37                GOTO ERROR
     C/COPY WNCPYSRC,DLH00134
0595 C*
0596 C*    SET DEBIT/CREDIT INDICATOR
0597 C*****                SETOF                     39                   S01117
0597 C                     SETOF                     3969                 S01117
0598 C   19N18   N         COMP 3                    39
0599 C  N19N18   N         COMP 4                      39
0600 C   19 18   N         COMP 4                      39
0601 C  N19 18   N         COMP 3                    39
     C  N18      N         COMP 3                    69                   S01117
     C   18      N         COMP 4                      69                 S01117
0602 C*                                                                   E25203
0602 C*                                                                   E25203
     C* IF REVERSAL INDICATOR IS '1',                                     E25203
     C* SET REVERSAL DEAL IND TO '1'                                      E25203
     C           *IN19     IFEQ '0'                                       E25203
     C***********          MOVE '1'       RVDL                      E25203S10736
     C                     MOVE 1         VOIN                            S10736
     C                     ELSE                                           S10736
     C                     MOVE 0         VOIN                            S10736
     C                     END                                            E25203
     C*                                                                   E25203
0602 C*
0603 C*    SET OFF SETTLEMENT TYPE INDS.
0604 C                     SETOF                     131415
0605 C                     SETOF                     161728
     C                     MOVE '0'       *IN11                           S01354
0606 C**
0607 C**   ADDITIONAL PROCESSING FOR POSTING REFERENCE 1.
0608 C**
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP10                                           S01408
      ** FIX FOR WITHHOLDING TAX.                                                           MD034609
      ** IF THIS IS A TAX KEY AND THE POSTING REFERENCE IS 2 THEN THE                       MD034609
      ** ACCOUNT KEY IS TRYING TO POST THE TAX TO THE SETTLEMENT                            MD034609
      ** ACCOUNT AND IT SHOULD THEREFORE BE IN EVENT CURRENCY AND NOT                       MD034609
      ** BASE.  THERE IS THEREFORE NO NEED FOR THE ADDITIONAL POSTINGS                      MD034609
      ** TO SPOT AND TRADE EQUIVALENT ACCOUNTS.                                             MD034609
      ** ALL THIS GETS SOLVED IF WE DON'T TREAT THIS KEY AS A TAX KEY.                      MD034609
      *                                                                                     MD034609
     C           EVSUB     IFEQ 'T'                                                         MD034609
     C           EVCOD     ANDEQ'I'                                                         MD034609
     C           ECCY      ANDNEBJLCCY                                                      MD034609
     C           EVSUB     OREQ 'T'                                                         MD034609
     C           EVCOD     ANDEQ'M'                                                         MD034609
     C           ECCY      ANDNEBJLCCY                                                      MD034609
     C           *IN35     IFEQ '1'                                                         MD034609
      *                                                                                     MD053762
      * If system value set-up is to post tax in transaction currency introduce             MD053762
      * similar processing to above fix and don't treat key as a tax key                    MD053762
      *                                                                                     MD053762
     C           *IN34     OREQ '1'                                                         MD053762
     C           CDL013    ANDEQ'Y'                                                         MD053762
     C           W#SCON    ANDEQ'Y'                                                         MD053762
     C           *IN36     OREQ '1'                                                         MD053762
     C           CDL013    ANDEQ'Y'                                                         MD053762
     C           W#SCON    ANDEQ'Y'                                                         MD053762
      *                                                                                     MD053762
     C                     MOVE '0'       *IN60                                             MD034609
     C                     ELSE                                                             MD034609
     C                     MOVE '1'       *IN60                                             MD034609
     C                     ENDIF                                                            MD034609
     C                     ENDIF                                                            MD034609
     C*                                                                   S01408
0609 C   34                EXSR PREF1
     C/COPY WNCPYSRC,DL0295C077
0610 C**
      ** Fix for Withholding Tax.                                                             241675
      ** If this is a tax key and the posting reference is 2 then the                         241675
      ** account key is trying to post the tax to the settlement                              241675
      ** account and it should therefore be in Event currency and not                         241675
      ** Base.  There is therefore no need for the additional postings                        241675
      ** to Spot and Trade Equivalent accounts.                                               241675
      ** All this gets solved if we don't treat this key as a tax key.                        241675
      *                                                                                       241675
     C           *IN60     IFEQ '1'                                                           241675
     C           *IN35     ANDEQ'1'                                                           241675
     C                     MOVE 'Y'       TAXWK   1                                           241675
     C                     MOVE '0'       *IN60                                               241675
     C                     ENDIF                                                              241675
      *                                                                                       241675
0611 C*    ADDITIONAL PROCESSING FOR POSTING REFERENCE 2.
0612 C   35                EXSR PREF2
     C   70 35             EXSR EXTRA
     C  N10 70 35          GOTO ERROR
     C                     SETOF                     10
0613 C**
0614 C**   ADDITIONAL PROCESSING FOR POSTING REFERENCE 3.
0615 C**
0616 C   36                EXSR PREF3
0617 C*
     C/COPY WNCPYSRC,DL0295C002
     C*                                                                   E18407
     C**   IF AN ACCOUNT IS FOUND AND IS RETAIL AND POSTING IS NOT        E18407
     C**   ALREADY BEING SENT TO SUSPENSE.                                E18407
     C           *IN06     IFEQ '1'                                       E18407
     C           *IN38     ANDEQ'1'                                       E18407
     C           *IN29     ANDEQ'0'                                       E18407
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP12                                           S01408
      *                                                                   S01408
     C*                                                                   E18407
     C**   IF DEBITS AND CREDITS ARE BLOCKED SEND POSTING TO SUSPENSE.    E18407
     C           *IN39     IFEQ '0'                                       E18407
     C                     TESTB'2'       RETB           29    DEBITS     E18407
     C                     ELSE                                           E18407
     C                     TESTB'3'       RETB           29    CREDITS    E18407
     C                     END                                            E18407
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP13                                           S01408
      *                                                                   S01408
     C                     END                                            E18407
     C/COPY WNCPYSRC,DL0295C010
     C*                                                                   E18407
0618 C*    INCREMENT COUNT OF POSTINGS GENERATED
0619 C***********NRIT      ADD  1         NRIT    50                      S01354
0619 C  N11      NRIT      ADD  1         NRIT    50                      S01354
0619 C   11 70 35NRIT      ADD  1         NRIT    50                      E38199
     C***70*35***NRIT      ADD  2         NRIT                            E38199
     C   70 35N11NRIT      ADD  2         NRIT                            E38199
0620 C*  29      NRIT      ADD  1         NRIT
0621 C*
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0295CCP9                                           S01408
      *                                                                   S01408
0622 C*    GENERATE ENTRIES - TO SUSPENSE IF NECESSARY.
0623 C                     SETON                     12
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295CCP2
      *                                                                   S01408
0624 C***********          EXCPT                                          S01522
     C*                                                                   S01522
     C* If suspense, generate and output:                                 S01522
     C*                                                                   S01522
     C           *IN29     IFEQ *ON                                       S01522
     C                     Z-ADDEAMT      PSTA                            BUG5921
     C                     EXSR SRSUSP                                    S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* Determine Posting Narrative:                                      S01522
     C                     EXSR SRGENT                                    S01522
      *                                                                   CAC001
      **  If Analytical Accounting module is switched on and the          CAC001
      **  account key is an existing Midas account key                    CAC001
      *                                                                   CAC001
     C                     MOVE *OFF      *IN58                           CAC001
     C                     MOVE *OFF      *IN56                           CAC001
     C                     MOVE *OFF      *IN71                           CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           AKEY6     ANDNE'T'                                       CAC001
     C           AKEY6     ANDNE'F'                                       CAC001
     C           *IN11     ANDEQ*OFF                                      CAC001
      *                                                                   CAC001
      **  If an entry to a retail or a nostro account is being            CAC001
      **  generated, seton indicator 56 to output profit centre of        CAC001
      **  the account from ACCNTAB                                        CAC001
      *                                                                   CAC001
     C           ATYPA     IFEQ 'R'                                       CAC001
     C           ATYPA     OREQ 'N'                                       CAC001
     C                     MOVE *ON       *IN56                           CAC001
     C                     ELSE                                           CAC001
      *                                                                   CAC001
      **  If a/c code is a Spot Trade a/c or a Spot Trade Equiv a/c,      CAC001
      **  determine if Profit Centre can hold FX Position                 CAC001
      *                                                                   CAC001
     C**********           MOVE ACOD,N    WACOD   4                                    CAC001 CGL029
     C                     MOVE ACOD,N    WACOD  10                                           CGL029
     C           WACOD     LOKUPXSPQ,1                   71               CAC001
     C           *IN71     IFEQ *ON                                       CAC001
     C           WACOD     OREQ BLSPTA                                    CAC001
     C                     EXSR SRPRFC                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ENDIF                                          CAC001
     C/COPY WNCPYSRC,DL0295CP20                                           S01408
     C*                                                                   S01522
     C* If a generated entry, output:                                     S01522
     C*                                                                   S01522
     C           *IN11     IFEQ *OFF                                      S01522
     C/COPY WNCPYSRC,DLH00189
     C           BRCDA     IFEQ *BLANKS                                   149507
     C                     MOVE BRCA      BRCDA                           149507
     C                     ENDIF                                          149507
     C           NTOSBR    IFEQ *BLANKS                                   149507
     C                     MOVE BRCA      NTOSBR                          149507
     C                     ENDIF                                          149507
      *                                                                   CPB005
     C********** CPB005    IFEQ 'Y'                                                    CPB005 248968
     C********** EVCOD     ANDEQ'I'                                                    CPB005 248968
     C           EVCOD     IFEQ 'I'                                                           248968
     C           EVSUB     ANDEQ'T'                                       CPB005
     C           POS11     ANDEQ' '                                       CPB005
     C********** CPB005    OREQ 'Y'                                                    CPB005 248968
     C********** EVCOD     ANDEQ'M'                                                    CPB005 248968
     C           EVCOD     OREQ 'M'                                                           248968
     C           EVSUB     ANDEQ'T'                                       CPB005
     C           POS11     ANDEQ' '                                       CPB005
      *                                                                   CPB005
     C                     MOVE '98100'   TRAT                            CPB005
      *                                                                   CPB005
     C                     ENDIF                                          CPB005
     C/COPY WNCPYSRC,DL0295C011
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C           ATYPA     ANDEQ'R'                                                           CER049
      *                                                                                       CER049
     C                     MOVE AKEY      WRK09   9                                           CER049
     C                     MOVELWRK09     WRK05   5                                           CER049
     C           WRK05     IFEQ '   FA'                                                       CER049
     C           WRK05     OREQ '   SA'                                                       CER049
     C           WRK05     OREQ '   FC'                                                       CER049
     C           WRK05     OREQ '   SC'                                                       CER049
     C           WRK05     OREQ '   FI'                                                       CER049
     C           WRK05     OREQ '   AI'                                                       CER049
     C                     MOVE '60001'   TRAT                                                CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT   50                      CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTGENENT                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     EXCPTGENENT                                    S01522
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C/COPY WNCPYSRC,DL0295C012
     C                     ENDIF                                          S01522
     C*                                                                   S01460
     C* If a booking branch posting, output:                              S01522
     C*                                                                   S01522
     C           *IN35     IFEQ *ON                                       S01522
     C           *IN70     ANDEQ*ON                                       S01522
     C           *IN77     ANDEQ*ON                                       S01522
      *                                                                                       222171
      ** Initialize W#IN96 for interbranch entry                                              222171
      *                                                                                       222171
     C           OSBR      IFNE BKMABR                                                        222171
     C           BRCA      ANDNEBKMABR                                                        222171
     C           BKIEMB    ANDEQ'Y'                                                           222171
     C                     MOVE '1'       W#IN96  1                                           222171
     C                     MOVE *BLANKS   W#BICN                                              222171
     C                     MOVE OBICN     W#BICN                                              222171
     C                     MOVE @@BICN    OBICN                                               222171
     C                     ELSE                                                               222171
     C                     MOVE '0'       W#IN96                                              222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
     C/COPY WNCPYSRC,DL0295C013
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTBOOKBR                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
      *                                                                   CRE009
     C                     EXCPTBOOKBR                                    S01522
     C                     ENDIF                                          CRE009
      *                                                                                       222171
     C           W#IN96    IFEQ '1'                                                           222171
     C                     MOVE W#BICN    OBICN                                               222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
      ** If via main branch generate aditional posting                                        222171
      *                                                                                       222171
     C           W#IN96    IFEQ '1'                                                           222171
     C                     EXCPTBOOKMB                                                        222171
      *                                                                                       222171
      ** Add amount to hash totals                                                            222171
      *                                                                                       222171
     C                     ADD  1         NRIT                                                222171
     C                     Z-ADD2         S                                                   222171
     C                     Z-ADD1         Z                                                   222171
     C           PSTA      DIV  1000      ZZAMT                                               222171
     C                     EXSR HASH                                                          222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
     C/COPY WNCPYSRC,DL0295C014
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* If a settlement branch posting, output:                           S01522
     C*                                                                   S01522
     C           *IN35     IFEQ *ON                                       S01522
     C           *IN70     ANDEQ*ON                                       S01522
     C           *IN77     ANDEQ*ON                                       S01522
     C           *IN11     ANDEQ*OFF                                      S01522
     C           OSBR      IFEQ *BLANKS                                   149507
     C                     MOVE BRCA      OSBR                            149507
     C                     ENDIF                                          149507
      *                                                                                       222171
      ** Initialize W#IN96 for interbranch entry                                              222171
      *                                                                                       222171
     C           OSBR      IFNE BKMABR                                                        222171
     C           BRCA      ANDNEBKMABR                                                        222171
     C           BKIEMB    ANDEQ'Y'                                                           222171
     C                     MOVE '1'       W#IN96                                              222171
     C                     MOVE *BLANKS   W#BICN  6                                           222171
     C                     MOVE BBICN     W#BICN                                              222171
     C                     MOVE @@BICN    BBICN                                               222171
     C                     ELSE                                                               222171
     C                     MOVE '0'       W#IN96                                              222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
     C/COPY WNCPYSRC,DL0295C015
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTSETTAC                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
      *                                                                   CRE009
     C                     EXCPTSETTAC                                    S01522
     C                     ENDIF                                          CRE009
      *                                                                                       222171
     C           W#IN96    IFEQ '1'                                                           222171
     C                     MOVE W#BICN    BBICN                                               222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
      ** If via main branch generate aditional posting                                        222171
      *                                                                                       222171
     C           W#IN96    IFEQ '1'                                                           222171
     C                     EXCPTSETTMB                                                        222171
      *                                                                                       222171
      * Add amount to hash totals                                                             222171
      *                                                                                       222171
     C                     ADD  1         NRIT                                                222171
     C                     Z-ADD2         S                                                   222171
     C                     Z-ADD1         Z                                                   222171
     C           PSTA      DIV  1000      ZZAMT                                               222171
     C                     EXSR HASH                                                          222171
      *                                                                                       222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
     C/COPY WNCPYSRC,DL0295C016
     C                     ENDIF                                          S01522
     C*                                                                   CEU003
     C** If SAR CEU003 and Settlement Account Posting and Settlement      CEU003
     C** currency not blank generate Settlement currency entries.         CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           *IN35     ANDEQ*ON                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     EXSR SRSENT                                    CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   S01522
     C*                                                                   S01460
     C** For Foreign Tax Posting, generate Spot Trade & Equivalent A/c    080603
     C**  Entries                                                         080603
     C*                                                                   080603
     C           *IN60     IFEQ '1'                                       080603
     C***********TAXAC     IFEQ '1'                                S01460 080603
     C                     EXSR P04                                       S01460
     C                     ENDIF                                          S01460
      *                                                                   CEU015
      ** Call S/R SREREN to generate spot trade and equivalent            CEU015
      ** accounting entries for deals rolled over from 'In' currency      CEU015
      ** to Euros.                                                        CEU015
      *                                                                   CEU015
     C           CEU015    IFEQ 'Y'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C                     EXSR SREREN                                    CEU015
     C                     ENDIF                                          CEU015
     C/COPY WNCPYSRC,DL0295C041
     C/SPACE                                                              S01100
     C*                                                                   CEU003
     C***********CEU003    IFNE 'Y'                                CEU003 133868
     C************IN35     OREQ *OFF                               CEU003 133868
     C***********STCY      OREQ *BLANKS                            CEU003 133868
     C***********                                                  CEU003 133868
     C*    MAINTAIN DR,CR TOTALS FOR BRANCH/CCY (EXCL.INTERBRANCH ITEMS)  S01100
     C           *IN11     IFEQ '0'                                       E38199
     C           *IN35     OREQ '1'                                       E38199
     C           *IN70     ANDEQ'1'                                       E38199
     C/COPY WNCPYSRC,DL0295C017
     C           *IN39     IFEQ '1'                                       S01100
     C                     ADD  EAMT      CRTOT                           S01100
     C                     ELSE                                           S01100
     C                     ADD  EAMT      DRTOT                           S01100
     C                     END                                            S01100
     C***********          END                                     E38199 080603
     C                     END                                            133868
      *                                                                   133868
     C***********CEU003    IFNE 'Y'                                133868 134907
     C************IN35     OREQ *OFF                               133868 134907
     C***********STCY      OREQ *BLANKS                            133868 134907
0625 C*
     C           *IN11     IFEQ '0'                                       133868
     C           *IN35     OREQ '1'                                       133868
     C           *IN70     ANDEQ'1'                                       133868
      *                                                                   133868
0626 C*    ADD POSTING AMOUNT TO HASH TOTAL
0627 C***29      ZZAMT     ADD  ZZAMT     ZZAMT                           S01117
0627 C                     Z-ADDZAMT      ZZAMT                           S01117
0628 C                     Z-ADD2         S
     C                     Z-ADD1         Z                               S01094
     C************IN11     IFEQ '1'                                S01354 E38199
     C***********          Z-ADD0         Z                        S01354 E38199
     C***********          MOVE '0'       *IN11                    S01354 E38199
     C***********          END                                     S01354 E38199
     C           *IN11     IFEQ '1'                                       081936
     C           *IN35     ANDEQ'0'                                       081936
     C           *IN11     OREQ '1'                                       081936
     C           *IN70     ANDEQ'0'                                       081936
     C                     Z-ADD0         Z                               081936
     C                     END                                            081936
     C           *IN70     IFEQ '1'                                       S01094
     C           *IN35     ANDEQ'1'                                       S01094
     C           *IN11     ANDEQ'0'                                       E38199
     C                     ADD  2         Z                               S01094
     C                     END                                            S01094
     C*                                                                   134907
     C           CEU003    IFEQ 'Y'                                       134907
     C           *IN35     ANDEQ*ON                                       134907
     C           STCY      ANDNE*BLANKS                                   134907
     C           CEU003    OREQ 'Y'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C                     SUB  1         Z                               134907
     C           WSPSTA    DIV  1000      ZAMT                            135224
     C                     Z-ADDZAMT      ZZAMT                           135224
     C                     ELSE                                           135224
     C           EAMT      DIV  1000      ZAMT                            135224
     C                     Z-ADDZAMT      ZZAMT                           135224
     C                     ENDIF                                          134907
     C*                                                                   134907
0629 C                     EXSR HASH
     C/COPY WNCPYSRC,DL0295C018
     C** 70 35             EXSR HASH                                      S01094
     C** 70 35             EXSR HASH                                      S01094
     C                     END                                            080603
     C***********          ENDIF                                   CEU003 134907
0630 C                     SETOF                     122933
0631 C                     SETOF                     37
     C                     SETOF                     70
      *                                                                                       241675
      ** If the key was set to non taxable, reset to its original                             241675
      ** value.                                                                               241675
      *                                                                                       241675
     C           TAXWK     IFEQ 'Y'                                                           241675
     C                     MOVE 'N'       TAXWK                                               241675
     C                     MOVE '1'       *IN60                                               241675
     C                     ENDIF                                                              241675
      *                                                                                       241675     
     C/COPY WNCPYSRC,DL0295C078
     C                     MOVE '0'       *IN11                           E38199
     C*                                                                   E25203
     C*  INIT REVERSAL DEAL IND AFTER RECORD IS OUTPUT                    E25203
     C*                                                                   E25203
     C***********          MOVE *BLANKS   RVDL    1                 E25203S10736
     C                     MOVE *ZERO     VOIN    10                      S10736
     C*                                                                   E25203
0632 C                     GOTO NEXT
0633 C*
0634 C*    SET ERROR INDICATOR.
0635 C           ERROR     TAG                             ** ERROR TAG **
     C                     DUMP                                           E11609
0636 C                     SETON                     LRU7U8
0637 C*
0638 C           END       TAG                             ** END TAG **
     C*                                                                   050169
     C           *IN67     IFEQ '1'                                       050169
     C           *IN69     OREQ '1'                                       050169
     C                     SETOF                     31                   050169
     C                     END                                            050169
0639 C*
0640 C*
0641 C*    TOTAL CALCULATIONS.
0642 C*    CHECK FOR OVERFLOW
0643 CL0 31                SETOF                     03
0644 CL0 OF                SETON                     03
     C/SPACE                                                              S01103
     C*    HANDLE SUMMARY ACCRUAL POSTING IF REQUIRED                     S01103
     CL1         *IN88     IFEQ '1'                                       S01103
     C/COPY WNCPYSRC,DL0295C019
     CL1                   EXSR L1POST                                    S01103
     CL1                   END                                            S01103
     C/SPACE                                                              S01100
     C*    CHECK FOR IMBALANCE FOR BRANCH/CCY                             S01100
     CL2         CRTOT     IFNE DRTOT                       B001          S01100
     CL2         CRTOT     IFLT DRTOT                       B002          S01100
     CL2         DRTOT     SUB  CRTOT     BALSUS                          S01100
     CL2                   SETON                     39                   S01100
     CL2                   ELSE                             X002          S01100
     CL2         CRTOT     SUB  DRTOT     BALSUS                          S01100
     CL2                   SETOF                     39                   S01100
     CL2                   END                              E002          S01100
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295CCP3                                           S01408
      *                                                                   S01408
     C*********** L2                   EXCPTIMBAL                   S01100S01522
     CL2                   EXSR SRIMB                                     S01522
     CL2                   ADD  1         NRIT                            S01100
     CL2         BALSUS    DIV  1000      ZZAMT                           S01100
     CL2                   Z-ADD1         Z                               S01100
     CL2                   Z-ADD2         S                               S01100
     CL2                   EXSR HASH                                      S01100
     CL2                   END                              E001          S01100
     C/SPACE                                                              S01100
     C***********                                                  S01460 080603
     C*****CHANGE OF BRANCH                                        S01460 080603
     C***********                                                  S01460 080603
     C*L3********S01460    IFEQ 'Y'                                S01460 080603
     C*L3********          EXSR P05                                S01460 080603
     C*L3********          ENDIF                                   S01460 080603
     C***********                                                  S01460 080603
     C*R*********AKSI      IFEQ 'Y'                         B001S01100    S01117
     C*R**********INU7     ANDEQ'0'                             S01100    S01117
     C*R*********          EXCPTENDREP                          S01100    S01117
     C*R*********          END                                  S01100    S01117
     C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF                                S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C******************** IN   LDA                                       LN0343
     CLR                   OUT  LDA                                       LN0343
     CLR                   CALL 'ZSFILE'                                  S01117
     C******************** PARM           SEQ                       S01117E00018
     C*R********           PARM *BLANKS   SEQ                       E00018LN0764
     CLR                   PARM           SEQ                             LN0764
     CLR                   PARM *BLANKS   @PARM   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C******************** OUT  LDA                                       LN0343
     CLR         *LOCK     IN   LDA                                       LN0343
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
0645 CLR U7                GOTO FIN
      *                                                                   CGL075
     CLR         CGL075    IFEQ 'Y'                                       CGL075
     CLR         *INU3     ANDEQ*OFF                                      CGL075
     CLR         CGL075    ORNE 'Y'                                       CGL075
      *                                                                   CGL075
0646 CLR         NREC      COMP NORE                 8080
0647 CLR         INT,1     COMP HRWN                 8181
0648 CLRN81      DEC,1     COMP HRDC                 8181
0649 CLR 80
0650 COR 81                SETON                     U8
0651 CLR         NRIT      ADD  2         NRIT
     CLR         *IN86     IFEQ '1'                                       AUS007
     CLR         BNREC     COMP BNORE                8484                 AUS007
     CLR         INT,3     COMP BHRWN                8585                 AUS007
     CLRN85      DEC,3     COMP BHRDC                8585                 AUS007
     CLR 84                                                               AUS007
     COR 85                SETON                     U8                   AUS007
      *                                                                   CGL075
     CLR                   ENDIF                                          CGL075
      *                                                                   CGL075
     CLR                   END                                            AUS007
      *                                                                   188100
      ** Ensures that DL0295P1/P2 is generated until the last branch      188100
      ** even if there are no details to report.                          188100
      *                                                                   188100
     CLR         *IN96     IFEQ '0'                                       188100
     CLR         *IN97     ANDNE'0'                                       188100
     CLR                   EXSR SPLFIL                                    188100
     CLR         BKAKSI    IFEQ 'Y'                                       188100
     CLR         *IN74     ANDEQ'1'                                       188100
     CLR                   EXCPTNODTL1                                    188100
     CLR                   ENDIF                                          188100
     CLR                   EXCPTENDRP2                                    188100
     CLR         BKAKSI    IFEQ 'Y'                                       188100
     CLR                   CLOSEDL0295P1                                  188100
     CLR                   ENDIF                                          188100
     CLR                   CLOSEDL0295P2                                  188100
     CLR                   MOVE '0'       *IN73                           188100
     CLR                   MOVE '0'       *IN02                           188100
     CLR                   MOVE '0'       *IN68                           188100
     CLR                   MOVE '0'       *IN97                           188100
     CLR                   MOVE '1'       *IN79                           188100
     CLR                   ENDIF                                          188100
      *                                                                   188100
     CLR         *IN97     IFEQ '0'                                       188100
     CLR         BRCA      ANDEQ*BLANKS                                   188100
     CLR                   EXSR FRSTBR                                    188100
     CLR                   ELSE                                           188100
     CLR                   EXSR NXTBRC                                    188100
     CLR         *IN96     IFEQ '0'                                       188100
     CLR         BKAKSI    IFEQ 'Y'                                       188100
     CLR                   OPEN DL0295P1                                  188100
     CLR                   ENDIF                                          188100
     CLR                   OPEN DL0295P2                                  188100
     CLR                   Z-ADD0         PAGE                            188100
     CLR                   Z-ADD0         PAGE2                           188100
     CLR                   ENDIF                                          188100
     CLR                   ENDIF                                          188100
      *                                                                   188100
     CLR         *IN96     DOWEQ'0'                                       188100
     CLR                   MOVELA8BRCD    BRCD    3                       188100
     CLR                   MOVELA8BRNM    BRNM   30                       188100
     CLR         *IN96     IFEQ '0'                                       188100
     CLR         *IN79     IFEQ '0'                                       188100
     CLR         BKAKSI    IFEQ 'Y'                                       188100
     CLR                   OPEN DL0295P1                                  188100
     CLR                   ENDIF                                          188100
     CLR                   OPEN DL0295P2                                  188100
     CLR                   Z-ADD0         PAGE                            188100
     CLR                   Z-ADD0         PAGE2                           188100
     CLR                   MOVE '1'       *IN79                           188100
     CLR                   ENDIF                                          188100
     CLR                   EXSR SPLFIL                                    188100
     CLR         BKAKSI    IFEQ 'Y'                                       188100
     CLR                   EXCPTNODTL1                                    188100
     CLR                   ENDIF                                          188100
     CLR                   EXCPTNODTL2                                    188100
     CLR         BKAKSI    IFEQ 'Y'                                       188100
     CLR                   CLOSEDL0295P1                                  188100
     CLR                   ENDIF                                          188100
     CLR                   CLOSEDL0295P2                                  188100
     CLR                   EXSR NXTBRC                                    188100
     CLR         *IN96     IFEQ '0'                                       188100
     CLR                   MOVE '1'       *IN79                           188100
     CLR         BKAKSI    IFEQ 'Y'                                       188100
     CLR                   OPEN DL0295P1                                  188100
     CLR                   ENDIF                                          188100
     CLR                   OPEN DL0295P2                                  188100
     CLR                   Z-ADD0         PAGE                            188100
     CLR                   Z-ADD0         PAGE2                           188100
     CLR                   ENDIF                                          188100
     CLR                   ENDIF                                          188100
     CLR                   ENDDO                                          188100
0652 C*
0653 CLR         FIN       TAG                             ** FIN TAG **
0654 C********************************************************************
     C/EJECT                                                              105140
     C********************************************************************105140
      *****************************************************************   188100
      *                                                               *   188100
      *  SR/BRCVAL - Subroutine to handle the printing of page even   *   188100
      *              if there are no outstanding deals to be reported *   188100
      *              for the branch.                                  *   188100
      *                                                               *   188100
      *  CALLS :     None.                                            *   188100
      *                                                               *   188100
      *****************************************************************   188100
      *                                                                   188100
     C           BRCVAL    BEGSR                                          188100
      *                                                                   188100
     C           *IN09     IFEQ '0'                                       188100
     C                     EXSR FRSTBR                                    188100
     C                     ENDIF                                          188100
     C           A8BRCD    DOUEQBRCA                                      188100
     C           *IN96     OREQ '1'                                       188100
     C           *IN09     IFEQ '1'                                       188100
     C                     EXSR NXTBRC                                    188100
     C                     ENDIF                                          188100
     C                     MOVELA8BRCD    BRCD    3                       188100
     C                     MOVELA8BRNM    BRNM   30                       188100
      *                                                                   188100
     C           BRCA      IFNE BRCD                                      188100
     C           *IN79     IFEQ '0'                                       188100
     C           BKAKSI    IFEQ 'Y'                                       188100
     C                     OPEN DL0295P1                                  188100
     C                     ENDIF                                          188100
     C                     OPEN DL0295P2                                  188100
     C                     Z-ADD0         PAGE                            188100
     C                     Z-ADD0         PAGE2                           188100
     C                     MOVE '1'       *IN79                           188100
     C                     ENDIF                                          188100
     C                     EXSR SPLFIL                                    188100
     C           BKAKSI    IFEQ 'Y'                                       188100
     C                     EXCPTNODTL1                                    188100
     C                     ENDIF                                          188100
     C                     EXCPTNODTL2                                    188100
     C           BKAKSI    IFEQ 'Y'                                       188100
     C                     CLOSEDL0295P1                                  188100
     C                     ENDIF                                          188100
     C                     CLOSEDL0295P2                                  188100
     C                     MOVE '1'       *IN79                           188100
     C           BKAKSI    IFEQ 'Y'                                       188100
     C                     OPEN DL0295P1                                  188100
     C                     ENDIF                                          188100
     C                     OPEN DL0295P2                                  188100
     C                     Z-ADD0         PAGE                            188100
     C                     Z-ADD0         PAGE2                           188100
     C                     ENDIF                                          188100
      *                                                                   188100
     C                     SETON                     09                   188100
     C                     ENDDO                                          188100
      *                                                                   188100
     C           BRCA      IFEQ BRCD                                      188100
     C                     EXSR SPLFIL                                    188100
     C                     ENDIF                                          188100
      *                                                                   188100
     C           BRCVA1    ENDSR                                          188100
      *****************************************************************   188100
      *                                                               *   188100
      *  SR/SPLFIL - Subroutine to ensure that spool file is recorded *   188100
      *              by RCF.                                          *   188100
      *                                                               *   188100
      *  CALLS :     None.                                            *   188100
      *                                                               *   188100
      *****************************************************************   188100
      *                                                                   188100
     C           SPLFIL    BEGSR                                          188100
      *                                                                   188100
     C           BKAKSI    IFEQ 'Y'                                       188100
     C                     Z-ADDSFNUM1    ZSNUM   60                      188100
     C                     OUT  LDA                                       188100
     C                     CALL 'ZSFILE'                                  188100
     C                     PARM           SEQ     5                       188100
     C                     PARM BRCD      @PARM                           188100
     C                     PARM           SFILE1                          188100
     C                     PARM           ZSNUM                           188100
     C                     PARM           ZSERR   1                       188100
      *                                                                   188100
     C           *LOCK     IN   LDA                                       188100
     C           ZSERR     IFEQ 'Y'                                       188100
     C                     SETON                     U7U8LR               188100
     C                     RETRN                                          188100
     C                     END                                            188100
     C                     ENDIF                                          188100
      *                                                                   188100
     C                     Z-ADDSFNUM2    ZSNUM   60                      188100
     C                     OUT  LDA                                       188100
     C                     CALL 'ZSFILE'                                  188100
     C                     PARM           SEQ                             188100
     C                     PARM BRCD      @PARM                           188100
     C                     PARM           SFILE2                          188100
     C                     PARM           ZSNUM                           188100
     C                     PARM           ZSERR   1                       188100
      *                                                                   188100
     C           *LOCK     IN   LDA                                       188100
     C           ZSERR     IFEQ 'Y'                                       188100
     C                     SETON                     U7U8LR               188100
     C                     RETRN                                          188100
     C                     END                                            188100
      *                                                                   188100
     C           SPLFI1    ENDSR                                          188100
      *****************************************************************   188100
      *                                                               *   188100
      *  SR/NXTBRC - Subroutine to get the next branch.               *   188100
      *                                                               *   188100
      *  CALLS :     AOBRCHR0                                         *   188100
      *                                                               *   188100
      *****************************************************************   188100
      *                                                                   188100
     C           NXTBRC    BEGSR                                          188100
     C**********           CALL 'AOBRCHR0'                                188100              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       188100
     C                     PARM '*NEXT  ' @OPTN   7                       188100
     C                     PARM *BLANKS   @BRCD   3                       188100
     C********** SDBRCH    PARM SDBRCH    DSFDY                           188100              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   188100
     C           @RTCD     IFNE *BLANK                                    188100
     C           @RTCD     ANDNE'*EOF   '                                 188100
     C                     MOVEL'SDBRCHPD'DBFILE  8        *************  188100
     C                     MOVE '005'     DBASE            * DBERR 005 *  188100
     C                     MOVEL@OPTN     DBOPTN  7        *************  188100
     C                     MOVEL@OPTN     DBKEY  29                       188100
     C                     MOVE '1'       *INLR                           188100
     C                     MOVE '1'       *INU7                           188100
     C                     MOVE '1'       *INU8                           188100
     C                     ENDIF                                          188100
     C           @RTCD     IFEQ '*EOF   '                                 188100
     C                     MOVE '1'       *IN96                           188100
     C                     ENDIF                                          188100
      *                                                                   188100
     C                     ENDSR                                          188100
      *****************************************************************   188100
      *                                                                   188100
      *  SR/FRSTBR - Subroutine to get the first branch.              *   188100
      *                                                               *   188100
      *  CALLS :     AOBRCHR0                                         *   188100
      *                                                               *   188100
      *****************************************************************   188100
      *                                                                   188100
     C           FRSTBR    BEGSR                                          188100
     C**********           CALL 'AOBRCHR0'                                188100              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       188100
     C                     PARM '*FIRST ' @OPTN   7                       188100
     C                     PARM *BLANKS   @BRCD   3                       188100
     C********** SDBRCH    PARM SDBRCH    DSFDY                           188100              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   188100
     C           @RTCD     IFNE *BLANK                                    188100
     C           @RTCD     ANDNE'*EOF   '                                 188100
     C                     MOVEL'SDBRCHPD'DBFILE  8        *************  188100
     C                     MOVE '006'     DBASE            * DBERR 006 *  188100
     C                     MOVEL@OPTN     DBOPTN  7        *************  188100
     C                     MOVEL'*FIRST ' DBKEY  29                       188100
     C                     MOVE '1'       *INLR                           188100
     C                     MOVE '1'       *INU7                           188100
     C                     MOVE '1'       *INU8                           188100
     C                     ENDIF                                          188100
     C           @RTCD     IFEQ '*EOF   '                                 188100
     C                     MOVE '1'       *IN96                           188100
     C                     ENDIF                                          188100
      *                                                                   188100
     C                     ENDSR                                          188100
     C********************************************************************105140
     C*                                                                   105140
     C***  *INZSR - Initialise all numeric fields that are defined        105140
     C*             within a datastructure and write out the header       105140
     C*             record to GEDLHH.                                     105140
     C*                                                                   105140
     C           *INZSR    BEGSR                           ** *INZSR SR **105140
     C*                                                                   105140
     C                     CLEARSDRAN                                     105140
     C                     CLEARNACACD                                    105140
     C                     CLEARDLNO                                      105140
     C                     CLEARDLNO2                                     105140
     C                     CLEARCRTOT                                     105140
     C                     CLEARDRTOT                                     105140
     C                     CLEARBALSUS                                    105140
     C                     CLEARX                                         105140
     C                     CLEARY                                         105140
     C                     CLEARSUMACR                                    105140
     C                     CLEARACRLSM                                    105140
     C                     CLEARZZAMT                                     105140
     C                     CLEARZZAMTI                                    105140
     C                     CLEARZZAMTD                                    105140
     C                     CLEARZZTOTD                                    105140
     C                     CLEARZZTOTI                                    105140
     C                     CLEARZ                                         105140
     C*                                                                   105140
     C/COPY WNCPYSRC,DL0295C106
     C*  Write out the header record to GEDLHH.                           105140
     C*                                                                   105140
     C                     Z-ADD99999     FLSZ    50                      105140
     C                     EXCPTHEADER                                    105140
     C*                                                                   105140
     C                     CALL 'AOSVALR0'                                                  MD048346
     C                     PARM *BLANKS   PRTCD                                             MD048346
     C                     PARM FXSVAL    SVALK1 20                                         MD048346
     C                     PARM           SVAL1 200                                         MD048346
     C                     PARM *BLANK    SVALK2 20                                         MD048346
     C                     PARM           SVAL2 200                                         MD048346
     C                     PARM *BLANK    SVALK3 20                                         MD048346
     C                     PARM           SVAL3 200                                         MD048346
     C                     PARM *BLANK    SVALK4 20                                         MD048346
     C                     PARM           SVAL4 200                                         MD048346
     C                     PARM *BLANK    SVALK5 20                                         MD048346
     C                     PARM           SVAL5 200                                         MD048346
     C                     PARM *BLANK    SVALK6 20                                         MD048346
     C                     PARM           SVAL6 200                                         MD048346
     C                     PARM *BLANK    SVALK7 20                                         MD048346
     C                     PARM           SVAL7 200                                         MD048346
     C                     PARM *BLANK    SVALK8 20                                         MD048346
     C                     PARM           SVAL8 200                                         MD048346
     C                     PARM *BLANK    SVALK9 20                                         MD048346
     C                     PARM           SVAL9 200                                         MD048346
     C                     PARM *BLANK    SVALK0 20                                         MD048346
     C                     PARM           SVAL10200                                         MD048346
      *                                                                                     MD048346
     C                     MOVELSVAL1     SVBRCA  3                                         MD048346
      *                                                                                     MD048346
     C                     ENDSR                                          105140
     C********************************************************************105140
     C/EJECT                                                              S01522
     C********************************************************************S01522
     C**  Subroutine SRSUSP handles the writing of a suspense entry.   ** S01522
     C********************************************************************S01522
     C           SRSUSP    BEGSR                           * S R S U S P *S01522
      *                                                                   S01522
      **  Initialise message substitution data fields.                    S01522
     C***********          CLEAR##NDS1                              S01522095476
     C                     RESET##NDS1                                    095476
     C                     MOVE *BLANKS   ##CNUM                          S01522
     C                     MOVE *BLANKS   ##TRNO                          S01522
     C                     MOVE *BLANKS   ##SDTE                          S01522
     C                     MOVE *BLANKS   ##DUED                          S01522
     C                     MOVE *BLANKS   ##OAMT                          S01522
     C                     MOVE *BLANKS   ##IRTE                          S01522
     C                     MOVE *BLANKS   ##YRTE                          S01522
     C                     MOVE *BLANKS   ##RODL                          S01522
     C                     MOVE *BLANKS   ##OCCY                          S01522
     C                     MOVE *BLANKS   ##ACNO                          S01522
     C*                                                                   S01522
     C                     MOVE ACCK      ##ACCK                          S01522
     C                     MOVE DLNO      ##DLN1                          S01522
     C                     MOVE EVENT     ##EVNT                          S01522
     C*                                                                   S01522
     C           *IN33     IFEQ *ON                                       S01522
     C                     MOVE '000000'  ##ZRO1                          S01522
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           *IN35     ANDEQ*ON                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      ##CCY1                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE ECCY      ##CCY1                          S01522
     C                     ENDIF                                          CEU003
     C                     MOVE '000000'  ##ZRO2                          S01522
     C           *IN60     IFEQ *ON                                       S01522
     C/COPY WNCPYSRC,DL0295C045
     C                     MOVE BJCYCD    ##CCY1                          S01522
     C                     ENDIF                                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           OSAC      IFNE *BLANKS                                                       237485
     C                     MOVELOSAC      ##OSAC                                              237485
     C                     ENDIF                                                              237485
      *                                                                                       237485
     C                     MOVE ##NDS1    O#PNAR 30                       S01522
     C*                                                                   S01522
     C                     MOVE 'GB00030' ##MGID                          S01522
     C                     MOVE BRCDA     ##BRCA                          S01522
     C                     MOVE CNUMAC    ##CNUM                          S01522
     C                     MOVE CCY       ##CCY                           S01522
     C                     MOVE ACODE     ##ACCD                          S01522
     C                     MOVE ACSQ      ##ACSQ                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
     C*                                                                   S01522
     C/COPY WNCPYSRC,DL0295C020
     C                     EXCPTSUSPEN                                    S01522
     C/COPY WNCPYSRC,DL0295C021
     C*                                                                   S01522
     C                     ENDSR                                          S01522
     C********************************************************************S01522
     C/EJECT                                                              S01522
     C********************************************************************S01522
     C**  Subroutine SRIMB handles the writing of an imbalance entry.  ** S01522
     C********************************************************************S01522
     C           SRIMB     BEGSR                           * S R I M B   *S01522
      *                                                                   S01522
      **  Initialise message substitution data fields.                    S01522
     C***********          CLEAR##NDS2                              S01522095476
     C                     RESET##NDS2                                    095476
     C                     MOVE *BLANKS   ##CNUM                          S01522
     C                     MOVE *BLANKS   ##TRNO                          S01522
     C                     MOVE *BLANKS   ##SDTE                          S01522
     C                     MOVE *BLANKS   ##DUED                          S01522
     C                     MOVE *BLANKS   ##OAMT                          S01522
     C                     MOVE *BLANKS   ##IRTE                          S01522
     C                     MOVE *BLANKS   ##YRTE                          S01522
     C                     MOVE *BLANKS   ##RODL                          S01522
     C                     MOVE *BLANKS   ##OCCY                          S01522
     C                     MOVE *BLANKS   ##ACNO                          S01522
     C*                                                                   S01522
     C                     MOVE BRCA      ##BRCD                          S01522
     C                     MOVE ECCY      ##CCY2                          S01522
     C           *IN60     IFEQ *ON                                       S01522
     C/COPY WNCPYSRC,DL0295C046
     C                     MOVE BJCYCD    ##CCY2                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C                     MOVE ##NDS2    O#PNAR                          S01522
     C                     MOVE 'GB00010' ##MGID                          S01522
     C                     MOVE BRCDA     ##BRCA                          S01522
     C                     MOVE CNUMAC    ##CNUM                          S01522
     C                     MOVE CCY       ##CCY                           S01522
     C                     MOVE ACODE     ##ACCD                          S01522
     C                     MOVE ACSQ      ##ACSQ                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C/COPY WNCPYSRC,DL0295C090
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
     C*                                                                   S01522
     C                     EXCPTIMBAL                                     S01522
     C/COPY WNCPYSRC,DL0295C055
     C*                                                                   S01522
     C                     ENDSR                                          S01522
     C********************************************************************S01522
     C/EJECT                                                              S01522
     C********************************************************************S01522
     C**  Subroutine SRNREC handles the writing of a new record.        **S01522
     C********************************************************************S01522
     C           SRNREC    BEGSR                           * S R N R E C *S01522
      *                                                                   S01522
      **  Initialise message substitution data fields.                    S01522
     C                     CLEAR##NDS3                                    S01522
     C                     MOVE *BLANKS   ##CNUM                          S01522
     C                     MOVE *BLANKS   ##TRNO                          S01522
     C                     MOVE *BLANKS   ##SDTE                          S01522
     C                     MOVE *BLANKS   ##DUED                          S01522
     C                     MOVE *BLANKS   ##OAMT                          S01522
     C                     MOVE *BLANKS   ##IRTE                          S01522
     C                     MOVE *BLANKS   ##YRTE                          S01522
     C                     MOVE *BLANKS   ##RODL                          S01522
     C                     MOVE *BLANKS   ##OCCY                          S01522
     C                     MOVE *BLANKS   ##ACNO                          S01522
      *                                                                   S01522
      **  Set up fields                                                   S01522
     C                     MOVE DLNO      ##DLN3                          S01522
     C                     MOVELDLNO      ##TRNO                          S01522
     C                     MOVELITAXN     ##CRNM                          S01522
     C*                                                                   S01522
     C           *IN19     IFEQ *OFF                                      S01522
     C                     MOVE '*'       ##0173                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C                     MOVE ##NDS3    O#PNAR                          S01522
     C                     MOVEL'GB29000' ##MGID                          S01522
     C/COPY WNCPYSRC,DL0295C059
     C*                                                                   S01522
     C                     MOVE BRCDA     ##BRCA                          S01522
     C                     MOVE CNUMAC    ##CNUM                          S01522
     C                     MOVE CCY       ##CCY                           S01522
     C                     MOVE ACODE     ##ACCD                          S01522
     C                     MOVE ACSQ      ##ACSQ                          S01522
     C                     MOVE CNUM      ##ASOC                          S01522
     C                     EXSR SRPNAR                                    S01522
     C*                                                                   084058
     C           *IN19     IFEQ *OFF                                      084058
     C                     MOVE '*'       O#PNAR                          084058
     C/COPY WNCPYSRC,DL0295C074
     C                     ENDIF                                          084058
      *                                                                   CAC001
      **  If Analytical Accounting module is switched on, check if        CAC001
      **  Profit Centre can hold FX Position.                             CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     EXSR SRPRFC                                    CAC001
     C                     ENDIF                                          CAC001
      *                                                                                       248968
      ** Make sure that '98100' will be written to TRAT for TAX                               248968
      ** postings generated during interest and maturity events.                              248968
      *                                                                                       248968
     C           EVCOD     IFEQ 'I'                                                           248968
     C           EVSUB     ANDEQ'T'                                                           248968
     C           POS11     ANDEQ' '                                                           248968
     C           EVCOD     OREQ 'M'                                                           248968
     C           EVSUB     ANDEQ'T'                                                           248968
     C           POS11     ANDEQ' '                                                           248968
      *                                                                                       248968
     C                     MOVE '98100'   TRAT                                                248968
      *                                                                                       248968
     C                     ENDIF                                                              248968     
     C*                                                                   084058
     C/COPY WNCPYSRC,DL0295C022
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTNEWREC                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     EXCPTNEWREC                                    S01522
     C                     ENDIF                                          CRE009
     C/COPY WNCPYSRC,DL0295C023
     C*                                                                   S01522
     C                     ENDSR                                          S01522
     C********************************************************************S01522
     C/EJECT                                                              S01522
     C********************************************************************S01522
     C**  Subroutine SRGENT handles the writing of a posting entry.     **S01522
     C********************************************************************S01522
     C           SRGENT    BEGSR                           * S R G E N T *S01522
      *                                                                   S01522
      **  Initialise message substitution data fields.                    S01522
     C                     CLEAR##NDS3                                    S01522
     C                     MOVE *BLANKS   ##CNUM                          S01522
     C                     MOVE *BLANKS   ##TRNO                          S01522
     C                     MOVE *BLANKS   ##SDTE                          S01522
     C                     MOVE *BLANKS   ##DUED                          S01522
     C                     MOVE *BLANKS   ##OAMT                          S01522
     C                     MOVE *BLANKS   ##IRTE                          S01522
     C                     MOVE *BLANKS   ##YRTE                          S01522
     C                     MOVE *BLANKS   ##RODL                          S01522
     C                     MOVE *BLANKS   ##OCCY                          S01522
      *                                                                   S01522
      **  Set up fields                                                   S01522
     C***********          MOVE DLNO      ##DLN3                    S01522095476
     C                     MOVELDLNO      ##TRNO                          S01522
     C*                                                                   S01522
     C           *IN41     IFEQ *OFF                                      S01522
     C                     MOVE ALDON     ##ALDN                          S01522
     C                     ELSE                                           S01522
     C                     MOVE BBCRNM    ##CRNM                          S01522
     C                     ENDIF                                          S01522
      *                                                                   095476
      **  Write Deal number over narrative                                095476
     C                     MOVE DLNO      ##DLN3                          095476
     C*                                                                   S01522
     C           *IN42     IFEQ *ON                                       S01522
     C           *IN43     OREQ *ON                                       S01522
     C                     MOVE OTHC      ##0453                          S01522
     C                     MOVE OTHC      ##OCCY                          S01522
     C*                                                                   S01522
     C                     MOVE OTHA      ZFLD15                          S01522
     C   24                MOVE '0'       ZDECS                           S01522
     C   25                MOVE '1'       ZDECS                           S01522
     C   26                MOVE '2'       ZDECS                           S01522
     C   27                MOVE '3'       ZDECS                           S01522
     C                     MOVE 'J'       ZECODE                          S01522
     C                     EXSR ZSEDIT                                    S01522
     C                     MOVE ZOUT21    ##1771                          S01522
     C                     MOVE ZOUT21    ##OAMT                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN44     IFEQ *ON                                       S01522
     C           *IN50     OREQ *ON                                       S01522
     C           *IN53     OREQ *ON                                       S01522
     C           *IN55     OREQ *ON                                       S01522
     C***********          MOVE DATE1     ##0668                    S01522086125
     C                     MOVE DATE1     ##0768                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN45     IFEQ *ON                                       S01522
     C***********          MOVE DATE1     ##0671                    S01522086125
     C                     MOVE DATE1     ##0771                          086125
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN46     IFEQ *ON                                       S01522
     C           *IN61     OREQ *ON                                       S01522
     C           *IN63     OREQ *ON                                       S01522
     C***********          MOVE DATE1     ##0665                    S01522086125
     C                     MOVE DATE1     ##0765                          086125
     C                     ENDIF                                          S01522
     C*...................................................................S01522
     C/EJECT                                                              S01522
     C*...................................................................S01522
     C           *IN48     IFEQ *ON                                       S01522
     C***********          MOVE DATE1     ##0669                    S01522086125
     C                     MOVE DATE1     ##0769                          086125
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN51     IFEQ *ON                                       S01522
     C***********          MOVE DATE1     ##0664                    S01522086125
     C                     MOVE DATE1     ##0764                          086125
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN62     IFEQ *ON                                       S01522
     C***********          MOVE DATE1     ##0672                    S01522086125
     C                     MOVE DATE1     ##0772                          086125
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN47     IFEQ *ON                                       S01522
     C           *IN64     OREQ *ON                                       S01522
     C***********          MOVE DATE1     ##0673                    S01522086125
     C                     MOVE DATE1     ##0773                          086125
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN65     IFEQ *ON                                       S01522
     C***********          MOVE DATE1     ##0670                    S01522086125
     C                     MOVE DATE1     ##0770                          086125
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN44     IFEQ *ON                                       S01522
     C           *IN45     OREQ *ON                                       S01522
     C           *IN46     OREQ *ON                                       S01522
     C           *IN47     OREQ *ON                                       S01522
     C           *IN48     OREQ *ON                                       S01522
     C           *IN50     OREQ *ON                                       S01522
     C           *IN51     OREQ *ON                                       S01522
     C           *IN53     OREQ *ON                                       S01522
     C           *IN55     OREQ *ON                                       S01522
     C           *IN61     OREQ *ON                                       S01522
     C           *IN62     OREQ *ON                                       S01522
     C           *IN63     OREQ *ON                                       S01522
     C           *IN64     OREQ *ON                                       S01522
     C           *IN65     OREQ *ON                                       S01522
     C                     MOVE DATE1     ##SDTE                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN47     IFEQ *ON                                       S01522
     C           *IN64     OREQ *ON                                       S01522
     C***********          MOVE DATE2     ##0661                    S01522086125
     C                     MOVE DATE2     ##0761                          086125
     C                     MOVE DATE2     ##DUED                          S01522
     C                     ELSE                                           087870
     C                     MOVE DATE1     ##DUED                          087870
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN49     IFEQ *ON                                       S01522
     C                     MOVE YRAT      ZFLD15                          S01522
     C                     MOVE '7'       ZDECS                           S01522
     C                     MOVE 'L'       ZECODE                          S01522
     C                     EXSR ZSEDIT                                    S01522
     C                     MOVE ZOUT21    ##1773                          S01522
     C                     MOVE ZOUT21    ##YRTE                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN57     IFEQ *ON                                       S01522
     C                     MOVE INTR      ZFLD15                          S01522
     C                     MOVE '7'       ZDECS                           S01522
     C                     MOVE 'L'       ZECODE                          S01522
     C                     EXSR ZSEDIT                                    S01522
     C                     MOVE ZOUT21    ##1771                          S01522
     C                     MOVE ZOUT21    ##IRTE                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C********** *IN67     IFEQ *ON                                 S01522087870
     C********** RBDN      IFNE 0                                   087870135074
     C********** BGN1ST    ANDEQ'Y'                                 105333135074
     C********** BGN1ST    ORNE 'Y'                                 105333135074
     C********** BGN1ST    IFNE 'Y'                                135074 192836
     C********** BGN1ST    ANDEQ'Y'                                105333 192836
     C********** BGN1ST    ORNE 'Y'                                105333 192836
     C********** DLPNAR    IFNE 'Y'                                192836 211436
     C           BGN1ST    IFEQ 'Y'                                       211436
     C           DLPNAR    ANDEQ'Y'                                       211436
     C           *IN66     ANDEQ*ON                                       105333
     C                     MOVE RBDN      ##0649                          S01522
     C/COPY WNCPYSRC,DL0295C072
     C                     MOVE DLNO      ##0672                          S01522
     C/COPY WNCPYSRC,DL0295C073
     C                     MOVE RBDN      ##RODL                          S01522
     C                     MOVELDLNO      ##TRNO                          S01522
     C           RBDN      IFEQ 0                                         123584
     C                     MOVE DLNO      ##0649                          123584
     C                     ENDIF                                          123584
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* ENSURE 'ROLLED OVER BY DEAL NBR' SET UP FOR UDC                   192836
     C           DLPNAR    IFEQ 'Y'                                       192836
     C           RBDN      ANDNE0                                         192836
     C                     MOVE RBDN      ##RODL                          192836
     C                     ENDIF                                          192836
      *                                                                   192836
     C           *IN19     IFEQ *OFF                                      S01522
     C                     MOVE '*'       ##0173                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C           *IN38     IFEQ *OFF                                      S01522
     C                     MOVE *BLANKS   ##ACNO                          S01522
     C                     ELSE                                           S01522
     C                     MOVE ACRAN     ##ACNO                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C                     MOVE ##NDS3    O#PNAR                          S01522
     C*                                                                   CDL002
     C** Use Netting Narrative if posting produced for net                CDL002
     C*                                                                   CDL002
     C           CDL002    IFEQ 'Y'                                       CDL002
     C           NETFLG    ANDEQ'1'                                       CDL002
     C                     MOVE DSPNAR    O#PNAR                          CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   S01522
     C                     MOVE *ZEROS    ##MGID                          S01522
     C                     MOVE NCDN      ##WK4   4                       S01522
     C                     MOVEL##WK4     ##MGID                          S01522
     C                     MOVEL'GB'      ##MGID                          S01522
      *                                                                   083906
     C********** *IN67     IFEQ *ON                                 083906087870
     C           RBDN      IFNE 0                                         087870
     C           NCDN      ANDEQ'11'                                      087870
     C                     MOVE '1'       ##MGID                          083906
     C                     ENDIF                                          083906
     C/COPY WNCPYSRC,DL0295C024
     C*                                                                   S01522
     C           *IN88     IFEQ *ON                                       S01522
     C                     MOVE 'GB00020' ##MGID                          S01522
     C                     MOVEL##DLAS    O#PNAR    P                     S01522
     C                     ENDIF                                          S01522
     C/COPY WNCPYSRC,DL0295C025
      *                                                                   S01522
     C                     MOVE BRCDA     ##BRCA                          S01522
     C                     MOVE CNUMAC    ##CNUM                          S01522
     C                     MOVE CCY       ##CCY                           S01522
     C                     MOVE ACODE     ##ACCD                          S01522
     C                     MOVE ACSQ      ##ACSQ                          S01522
     C                     MOVE CNUM      ##ASOC                          S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP14                                           S01408
     C*                                                                   S01408
     C           CDL002    IFEQ 'Y'                                                         MD026977
     C           NETFLG    ANDEQ'1'                                                         MD026977
     C                     MOVE DSPNAR    O#PNAR                                            MD026977
     C                     ENDIF                                                            MD026977
     C*                                                                   084058
     C           *IN19     IFEQ *OFF                                      084058
     C                     MOVE '*'       O#PNAR                          084058
     C/COPY WNCPYSRC,DL0295C075
     C                     ENDIF                                          084058
     C*                                                                   S01522
     C                     ENDSR                                          S01522
     C********************************************************************S01522
     C/EJECT                                                              CAC001
     C********************************************************************CAC001
     C**  Subroutine SRPRFC access Profit Centre details                **CAC001
     C********************************************************************CAC001
     C           SRPRFC    BEGSR                           * S R N R E C *CAC001
      *                                                                   CAC001
      **  Access Profit Centre details via access object                  CAC001
      *                                                                   CAC001
     C                     MOVE *OFF      *IN71                           CAC001
     C                     CALL 'AOPRFCR0'                                CAC001
     C                     PARM *BLANKS   WRTCD   7                       CAC001
     C                     PARM '*KEY   ' WOPTN   7                       CAC001
     C                     PARM PRFC      WPRFC   4                       CAC001
     C           SDPRFC    PARM SDPRFC    DSFDY                           CAC001
      *                                                                   CAC001
      **  Database error if not found                                     CAC001
      *                                                                   CAC001
     C           WRTCD     IFNE *BLANKS                                   CAC001
     C                     Z-ADD32        DBASE            ************   CAC001
     C                     MOVEL'*KEY   ' DBOPTN           * DBERR 32 *   CAC001
     C                     MOVELPRFC      DBKEY            ************   CAC001
     C                     MOVEL'SDPRFCPD'DBFILE                          CAC001
     C                     GOTO ERROR                                     CAC001
     C                     ELSE                                           CAC001
      *                                                                   CAC001
      **  Seton indicator 71 if FX Position Profit Centre is to be used   CAC001
      *                                                                   CAC001
     C           DSFPPC    IFNE *BLANK                                    CAC001
     C                     MOVE *ON       *IN71                           CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ENDSR                                          CAC001
     C********************************************************************CAC001
     C/EJECT                                                              CAC001
     C********************************************************************S01522
     C**  Subroutine SRPNAR determines the required narratives.         **S01522
     C********************************************************************S01522
     C           SRPNAR    BEGSR                           * S R P N A R *S01522
     C*                                                                   S01522
     C* Define the data structure parameter:                              S01522
     C*                                                                   S01522
     C           *LIKE     DEFN CGPNAR    ##PNAR                          S01522
     C*                                                                   S01522
     C* Define the work variables:                                        S01522
     C*                                                                   S01522
     C           *LIKE     DEFN MNBRCA    ##BRCA                          S01522
     C           *LIKE     DEFN MNCUST    ##CNUM                          S01522
     C           *LIKE     DEFN MNCYCD    ##CCY                           S01522
     C           *LIKE     DEFN MNACCD    ##ACCD                          S01522
     C           *LIKE     DEFN MNACSQ    ##ACSQ                          S01522
     C           *LIKE     DEFN MNRACN    ##ACNO                          S01522
     C           *LIKE     DEFN MNTRNO    ##TRNO                          S01522
     C           *LIKE     DEFN MNSDTE    ##SDTE                          S01522
     C           *LIKE     DEFN MNDUED    ##DUED                          S01522
     C           *LIKE     DEFN MNOAMT    ##OAMT                          S01522
     C           *LIKE     DEFN MNIRTE    ##IRTE                          S01522
     C           *LIKE     DEFN MNYRTE    ##YRTE                          S01522
     C           *LIKE     DEFN MNRODL    ##RODL                          S01522
     C           *LIKE     DEFN MNOCCY    ##OCCY                          S01522
     C           *LIKE     DEFN MNASOC    ##ASOC                          S01522
     C*                                                                   S01522
     C* If the facility is switched off or unavailable,                   S01522
     C*  or UDC is not installed, exit this subroutine:                   S01522
     C*                                                                   S01522
     C           DLPNAR    IFNE 'Y'                                       S01522
     C                     GOTO EXPNAR                                    S01522
     C                     ENDIF                                          S01522
     C/COPY WNCPYSRC,DL0295C060
     C*                                                                   S01522
     C* Determine the value for the narrative using AOPNARR0:             S01522
     C*                                                                   S01522
     C                     CLEARCGPNAR                                    S01522
     C                     CLEAR##PRM1                                    086125
     C*                                                                   S01522
     C                     MOVE 'DL'      MNMODI                          S01522
     C                     MOVE ##CCY     MNCYCD                          S01522
     C                     MOVE ##ACCD    MNACCD                          S01522
     C                     MOVE ##ACSQ    MNACSQ                          S01522
     C                     MOVE BBCRNM    MNCRNM                          S01522
     C                     MOVE BOKC      MNBOKC                          S01522
     C                     MOVELO#PNAR    MNNARR    P                     S01522
     C                     MOVE ##BRCA    MNBRCA                          S01522
     C                     MOVE ##CNUM    MNCUST                          S01522
     C                     MOVE ##ACNO    MNRACN                          S01522
     C                     MOVE ##TRNO    MNTRNO                          S01522
     C                     MOVE ##SDTE    MNSDTE                          S01522
     C                     MOVE ##DUED    MNDUED                          S01522
     C                     MOVE ##OAMT    MNOAMT                          S01522
     C                     MOVE ##IRTE    MNIRTE                          S01522
     C                     MOVE ##YRTE    MNYRTE                          S01522
     C                     MOVE ##RODL    MNRODL                          S01522
     C                     MOVE ##OCCY    MNOCCY                          S01522
     C                     MOVE ##ASOC    MNASOC                          S01522
     C/COPY WNCPYSRC,DLH00391
     C*...................................................................S01522
     C/EJECT                                                              S01522
     C*...................................................................S01522
     C                     CALL 'AOPNARR0'                                S01522
     C                     PARM           ##RTN   7                       S01522
     C                     PARM           ##MGID  7                       S01522
     C                     PARM           ##PRM1                          086125
     C           CGPNAR    PARM CGPNAR    ##PNAR                          S01522
     C                     PARM           ##NARR 50                       S01522
     C/COPY WNCPYSRC,DLH00392
     C*                                                                   S01522
     C           ##RTN     IFNE *BLANKS                                   S01522
     C                     MOVEL'CGPNARPD'DBFILE             *************S01522
     C                     MOVEL'101'     DBASE              * DBERR 101 *S01522
     C                     MOVELMNCUST    DBKEY              *************S01522
     C                     DUMP                                           S01522
     C                     SETON                     U7U8LR               S01522
     C                     GOTO END                                       S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C                     MOVEL##NARR    O#PNAR    P                     S01522
     C/COPY WNCPYSRC,DL0295C091
     C*                                                                   S01522
     C           EXPNAR    TAG                             < EXPNAR       S01522
     C/COPY WNCPYSRC,DL0295C071
     C*                                                                   S01522
     C                     ENDSR                                          S01522
     C********************************************************************S01522
     C/EJECT                                                              S01103
1556 C********************************************************************SO5452
1557 C*                                                                   SO5452
1558 C***  SWCREF SR TO BUILD THE SWIFT COMMON REFERENCE FOR A DEAL       SO5452
1559 C*    - A SHORTENED VERSION OF 'SWCREF' FROM 'SW0100'                SO5452
1560 C*                                                                   SO5452
1561 C*                                                                   SO5452
1562 C*                                                                   SO5452
1563 C           SWCREF    BEGSR                           ** SWCREF SR **SO5452
1564 C*                                                                   SO5452
1565 C*                                                                   SO5452
     C           DTYP      COMP 'CI'                     82               SO5452
     C/COPY WNCPYSRC,DL0295C105
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C                     MOVE *ON       *IN82                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C**********           MOVELCHNACH    CHNA    60                                   097486 CSD027
     C                     MOVELCHNACH    CHNA    6                                           CSD027
1579 C*                                                                   SO5452
1580 C***  ACCESS BANKS SWIFT ADDRESS ON S/CLINT                          SO5452
1581 C*                                                                   SO5452
1582 C*****                MOVE '       ' CLTKEY  7                 SO5452S01194
1583 C*****                MOVELBICN      CLTKEY                    SO5452S01194
1584 C*****                MOVE 'A'       CLTKEY                    SO5452S01194
1585 C*****                EXSR CLTCHN                              SO5452S01194
1586 C*****                                                         SO5452S01194
1587 C*****CHAIN FAIL                                               SO5452S01194
1588 C*****                                                         SO5452S01194
     C***30                Z-ADD09        DBASE         **DBERR09   SO5452S01194
1590 C***30                MOVELCLTKEY    DBKEY                     SO5452S01194
1591 C***30                MOVEL'CLINT'   DBFILE                    SO5452S01194
1592 C***30                GOTO ENDSR                               SO5452S01194
     C*
     C** READ CUSTOMER DETAILS VIA ACCESS PROGRAM                         S01194
     C                     MOVE *BLANK    @KEY1                           080603
     C                     MOVELBBICN     @KEY1                           080603
     C******               CALL 'AOCUSTR0'                         S01194 220738
     C                     CALL 'AOCUSTR1'                                220738
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C***********          PARM A8BICN    @KEY1  10                S01194 080603
     C                     PARM           @KEY1  10                       080603
     C*****                PARM '*NUMBER' @KYST   7                 S01194LN0109
     C                     PARM *BLANKS   @KYST   7                       LN0109
     C****       SDCUST    PARM SDCUST    DSSDY                    S01194 220738
     C           SDCUST    PARM SDCUST    DSLDY                           220738
     C           @RTCD     IFNE *BLANK                                    S01194
     C           BBCLST    ANDNE'Y'                                       220738
     C******     @KYST     ORNE '*NUMBER'                          S01194 LN0109
     C           @KYST     ORNE '*CNUM'                                   LN0109
     C                     MOVE '1'       *IN30                           S01194
     C                     MOVE '009'     DBASE            **********     S01194
     C                     MOVEL@OPTN     DBOPTN  7        *  009   *     S01194
     C                     MOVEL@KEY1     DBKEY            **********     S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     GOTO ENDSR                                     S01194
     C                     ELSE                                           LN0121
     C                     MOVE '0'       *IN30                           LN0121
     C                     END                                            S01194
1593 C*                                                                   SO5452
1592 C*****      CSID      COMP *BLANKS                  78        SO5452 S01194
1592 C           BBCSID    COMP *BLANKS                  78               S01194
     C/COPY WNCPYSRC,DL0295C067
     C           CDL046    IFEQ 'N'                                                           CDL046
1592 C   78                GOTO ENDSR                                     SO5452
1595 C*                                                                   SO5452
1594 C*****                MOVE CSID      BISWA  12                SO5452 S01194
1594 C                     MOVE BBCSID    BISWA  12                       S01194
     C                     ELSE                                                               CDL046
     C           *IN78     IFEQ '0'                                                           CDL046
     C                     MOVE BBCSID    BISWA  12                                           CDL046
     C                     END                                                                CDL046
     C                     ENDIF                                                              CDL046
     C/COPY WNCPYSRC,DL0295C068
1595 C*                                                                   SO5452
      **************************************************************E24720E28679
1596 C*****ACCESS*SWIFT*ADDRESS*OF*DESTINATION,=CNUM*EXCEPT*FOR*DEALSO5452E24720
1597 C*******TYPE*CI-USE*CURRENT*HOLDER*OF*N.A.                     SO5452E24720
     C*****ACCESS*SWIFT*ADDRESS*OF*COUNTERPARTY*=*CNUMD*EXCEPT*FOR**E24720E28679
     C******************************************************DEAL****E24720E28679
     C*****TYPE*'CI'*USE*CURRENT*HOLDER*OF*N.A.*********************E24720E24720
1598 C*                                                                   SO5452
1600 C*****                MOVE '       ' CLTKEY                   SO5452 S01194
1601 C**N82                MOVELCNUM      CLTKEY                   SO5452 S01194
1602 C***82                MOVELCHNACH    CHNA    60               SO5452 S01194
1602 C***82                MOVELCHNA      CLTKEY                   SO5452 S01194
1603 C*****                MOVE 'A'       CLTKEY                   SO5452 S01194
1604 C*****                EXSR CLTCHN                             SO5452 S01194
1605 C*****                                                        SO5452 S01194
1606 C*****CHAIN FAIL                                              SO5452 S01194
1607 C*****                                                        SO5452 S01194
     C***30                Z-ADD10        DBASE        **DBERR10   SO5452 S01194
1609 C***30                MOVELCLTKEY    DBKEY                    SO5452 S01194
1610 C***30                MOVEL'CLINT'   DBFILE                   SO5452 S01194
1611 C***30                GOTO ENDSR                              SO5452 S01194
     C*
     C**********           MOVELCHNACH    CHNA    60                                   S01194 CSD027
     C                     MOVELCHNACH    CHNA    6                                           CSD027
     C** READ CUSTOMER DETAILS VIA ACCESS PROGRAM                         S01194
     C***********          MOVELCHNACH    @KEY1                     S01194BHF042
     C**N82******          MOVELCNUM      @KEY1                     BHF042E24720
     C**N82******          MOVELCPTY      @KEY1                     E24720E28679
     C/COPY WNCPYSRC,DL0295C069
     C           CDL046    IFEQ 'N'                                                           CDL046
     C   82                MOVELCHNACH    @KEY1                           BHF042
     C  N82                MOVELCNUM      @KEY1                           047803
     C                     ELSE                                                               CDL046
     C                     MOVELCNUM      @KEY1                                               CDL046
     C                     ENDIF                                                              CDL046
     C/COPY WNCPYSRC,DL0295C092
     C******               CALL 'AOCUSTR0'                         S01194 220738
     C                     CALL 'AOCUSTR1'                                220738
     C/COPY WNCPYSRC,DL0295C070
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEY1  10                       S01194
     C******               PARM '*NUMBER' @KYST   7                 S01194LN0109
     C                     PARM *BLANKS   @KYST   7                       LN0109
     C*****      SDCUST    PARM SDCUST    DSSDY                    S01194 220738
     C           SDCUST    PARM SDCUST    DSLDY                           220738
     C           @RTCD     IFNE *BLANK                                    S01194
     C           BBCLST    ANDNE'Y'                                       220738
     C******     @KYST     ORNE '*NUMBER'                          S01194 LN0109
     C           @KYST     ORNE '*CNUM'                                   LN0109
     C                     MOVE '1'       *IN30                           S01194
     C                     MOVE '010'     DBASE            **********     S01194
     C                     MOVEL@OPTN     DBOPTN  7        *  010   *     S01194
     C                     MOVEL@KEY1     DBKEY            **********     S01194
     C                     MOVEL'SDCUSTPD'DBFILE                          S01194
     C                     GOTO ENDSR                                     S01194
     C                     ELSE                                           LN0121
     C                     MOVE '0'       *IN30                           LN0121
     C                     END                                            S01194
1593 C*                                                                   SO5452
1592 C*****      CSID      COMP *BLANKS                  78        SO5452 S01194
1592 C           BBCSID    COMP *BLANKS                  78               S01194
1592 C   78                GOTO ENDSR                                     SO5452
1595 C*                                                                   SO5452
1612 C*                                                                   SO5452
1613 C*****                MOVE CSID      CPSWA  12                SO5452 S01194
1613 C                     MOVE BBCSID    CPSWA  12                       S01194
1616 C*                                                                   SO5452
1616 C*** WHETHER TO USE 'INTR' OR 'EXRT' ?                               SO5452
1616 C*                                                                   SO5452
     C   76 83             SETON                     78    BOTH = 0       SO5452
     C         78          GOTO ENDSR                                     SO5452
1616 C*                                                                   SO5452
1617 C                     MOVEL'00000000'HOLD16 16                       SO5452
     C  N83    76          MOVE INTR      HOLD16                          SO5452
     C      72 76          Z-SUBINTR      INTCH  117       INTR = MINUS   SO5452
     C      72 76          MOVE INTCH     HOLD16                          SO5452
1625 C  N76                MOVE EXRT      HOLD16                          SO5452
1626 C*                                                                   SO5452
1627 C***  DETERMINE LEAST SIGNIFICANT DIGIT                              SO5452
1628 C*                                                                   SO5452
1629 C                     MOVEAHOLD16    ARRT                            SO5452
1630 C                     Z-ADD17        C       20                      SO5452
1631 C           DLSD      TAG                             ** DLSD TAG ** SO5452
1632 C           C         SUB  1         C                               SO5452
1633 C           ARRT,C    COMP '0'                      90               SO5452
1634 C   90      C         COMP 4                    90                   SO5452
1635 C   90                GOTO DLSD                                      SO5452
1636 C*                                                                   SO5452
1637 C***  MOVE 4 LEAST SIGNIFICANT DIGITS INTO A 4 DIGIT FIELD WITH      SO5452
1638 C***        LEADING ZEROS                                            SO5452
1639 C*                                                                   SO5452
1640 C           C         SUB  3         C                               SO5452
1641 C*                                                                   SO5452
1642 C                     MOVEAARRT,C    RTRF    4                       SO5452
1643 C*                                                                   SO5452
1644 C***  DETERMINE ALPHABETIC ORDER OF SWIFT CODES                      SO5452
1645 C                     MOVELBISWA     BISWC   4                       SO5452
1646 C                     MOVELCPSWA     CPSWC   4                       SO5452
1648 C*                                                                   SO5452
1649 C***  EXTRACT LOCATION CODE FROM SWIFT ADDRESS                       SO5452
1650 C*                                                                   SO5452
1651 C                     MOVELBISWA     HOLDB   8                       SO5452
1652 C*                                                                   SO5452
1653 C                     MOVELCPSWA     HOLDC   8                       SO5452
1654 C                     MOVE HOLDB     BISWL   2                       SO5452
1655 C                     MOVE HOLDC     CPSWL   2                       SO5452
1656 C*                                                                   SO5452
1657 C***  COMBINE CODE AND LOCATION FOR EACH BANK                        SO5452
1658 C*                                                                   SO5452
1659 C                     MOVELBISWC     BHOLD   6                       SO5452
1660 C                     MOVE BISWL     BHOLD                           SO5452
1661 C                     MOVELCPSWC     CHOLD   6                       SO5452
1662 C                     MOVE CPSWL     CHOLD                           SO5452
1663 C*                                                                   SO5452
     C*** USE CODE & LOCN. TO DETERMINE ORDEF                             SO5452
     C           BHOLD     COMP CHOLD                  9191               SO5452
     C*                                                                   SO5452
1664 C***  CREATE COMMON REFERENCE FIELD                                  SO5452
1665 C*                                                                   SO5452
1666 C   91                MOVELBHOLD     HOLD10 10                       SO5452
1667 C  N91                MOVELCHOLD     HOLD10                          SO5452
1668 C                     MOVE RTRF      HOLD10                          SO5452
1669 C*                                                                   SO5452
1670 C                     MOVELHOLD10    ZCMREF 16                       SO5452
1671 C   91                MOVE CHOLD     ZCMREF                          SO5452
1672 C  N91                MOVE BHOLD     ZCMREF                          SO5452
1673 C*                                                                   SO5452
1674 C***                                                                 SO5452
1675 C*                                                                   SO5452
1676 C           ENDSR     ENDSR                           ** ENDSR TAG **SO5452
1677 C*                                                                   SO5452
1678 C********************************************************************SO5452
     C/EJECT                                                              S01117
     C*****************************************************************   S01103
     C*     Level break 1 total time routine to set up and write          S01103
     C*     summary accrual postings, if required.                        S01103
     C*                 - called from main routine only if *IN88 = 1      S01103
     C/SPACE 2                                                            S01103
     C           L1POST    BEGSR                                          S01103
0559 C*                                                                   S01103
     C                     MOVE '0'       *IN87                           S01103
      *                                                                   CAC001
      **  If Analytical Accounting module is switched on, seton           CAC001
      **  indicator 58 to output Primary Funding Profit Centre when       CAC001
      **  summary accruals are being generated                            CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE *ON       *IN58                           CAC001
     C                     MOVE *OFF      *IN56                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C* No postings if accruals sum to zero                               S01103
     C           SUMACR    IFLT 0                          B001           S01103
     C                     MOVE '1'       *IN87                           S01103
     C                     Z-SUBSUMACR    ACRLSM                          S01103
     C                     ELSE                            X001           S01103
     C                     Z-ADDSUMACR    ACRLSM                          S01103
     C                     END                             E001           S01103
     C           CURLIN    IFGE OVFL2                      B001           S01103
     C                     EXCPTSMTITL                                    S01103
     C                     END                             E001           S01103
     C                     EXCPTSUMTOT                                    S01103
     C*    Skip postings generation if accruals have summed to zero       S01103
     C           SUMACR    CABEQ0         L1END                           S01103
0560 C*    LOOP TO ACCESS A/C CODES FROM A/C KEY RECORD                   S01103
0561 C                     Z-ADD0         N       10                      S01103
0562 C           L1NEXT    TAG                             ** NEXT TAG ** S01103
0563 C           N         ADD  1         N                               S01103
0564 C*                                                                   S01103
0565 C*    CHECK IF ALL A/C CODE PROCESSED.                               S01103
0566 C           N         COMP 6                    32                   S01103
0567 C           *IN32     CABEQ'1'       L1END                           S01103
0568 C*                                                                   S01103
0569 C*    IGNORE ENTRIES WHERE ACOD & PREF BOTH BLANK.                   S01103
0570 C           ACOD,N    COMP 0                        32               S01103
0571 C   32      PREF,N    COMP 0                        32               S01103
0572 C           *IN32     CABEQ'1'       L1NEXT                          S01103
0573 C*                                                                   S01103
0574 C*    CHECK POSTING REFERENCE.                                       S01103
     C*  N.B. PREF=2 or 3 not  applicable for accruals - database error   S01103
0575 C           PREF,N    IFNE 1                          B001           S01103
     C                     MOVE *BLANKS   DBKEY                           S01103
     C                     MOVEL'ACKEY'   DBFILE                          S01103
     C                     MOVELAKEY      DBKEY             **DBERR15**   S01103
     C****                 MOVEL'015'     DBASE               S01103      SO5452
     C                     Z-ADD15        DBASE                           SO5452
     C                     GOTO L1ERR                                     S01103
     C                     END                             E001           S01103
0576 C*                                                                   S01103
0578 C           ACOD,N    CABEQ0         DRCRIN                          S01103
     C                     MOVE '1'       *IN34                           S01103
0580 C*    ACCESS A/C CODES TABLE.                                        S01103
     C                     Z-ADDY         X                               S01103
     C           ACOD,N    LOKUPACD,X                    40               S01103
     C           *IN40     IFEQ '1'                         B001          S01103
     C*****                MOVELATY,X     ATYP                     S01103 S01194
     C*****                MOVELATY,X     A5ACCD                   S01194 LN0109
     C                     MOVELATY,X     A5ACTY                          LN0109
     C                     MOVE ACS,X     A5ACSC                          S10736
     C                     ELSE                             X001          S01103
0581 C*****                MOVE '        'TABKEY                   S01103 S01194
0582 C*****                MOVEL'30'      TABKEY                   S01103 S01194
0583 C*****                MOVELACOD,N    ACK1                     S01103 S01194
0584 C*****                MOVE ACK1      TABKEY                   S01103 S01194
0585 C*****                EXSR TABCHN                             S01103 S01194
0586 C*****      *IN07     IFEQ '0'                         B001   S01103 S01194
     C*****                MOVEL'TABLE'   DBFILE                   S01103 S01194
     C*****                MOVELTABKEY    DBKEY      **DBERR16**   S01103 S01194
     C****                 MOVEL'016'     DBASE               S01103      SO5452
     C*****                Z-ADD16        DBASE                    SO5452 S01194
     C*****                GOTO L1ERR                              S01103 S01194
     C*****                END                              E002   S01103 S01194
     C*
     C** READ ACCOUNT DETAILS VIA ACCESS PROGRAM                          S01194
     C                     MOVE ACOD,N    @AFNB                           S01194
     C                     CALL 'AOACODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C**********           PARM           @AFNB   4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM           @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '016'     DBASE            **********     S01194
     C                     MOVEL@OPTN     DBOPTN  7        *  016   *     S01194
     C                     MOVEL@AFNB     DBKEY            **********     S01194
     C                     MOVEL'SDACODPD'DBFILE                          S01194
     C                     GOTO L1ERR                                     S01194
     C                     END                                            S01194
     C           Y         IFGT 1                           B002          S01103
     C                     SUB  1         Y                               S01103
     C                     Z-ADDACOD,N    ACD,Y                           S01103
     C*****                MOVE ATYP      ATY,Y                    S01103 S01194
     C*****                MOVE A5ACCD    ATY,Y                    S01194 LN0109
     C                     MOVE A5ACTY    ATY,Y                           LN0109
     C                     MOVE A5ACSC    ACS,Y                           S10736
     C                     END                              E002          S01103
     C                     END                              E001          S01103
0587 C*                                                                   S01103
0588 C*    Test a/c type.                                                 S01103
0589 C*****      ATYP      COMP 'R'                      38        S01103 S01194
0589 C*****      A5ACCD    COMP 'R'                      38        S01194 LN0109
0589 C           A5ACTY    COMP 'R'                      38               LN0109
0590 C*                                                                   S01103
     C           DRCRIN    TAG                             *TAG DRCRIN*   S01103
     C*    Set DR/CR indicator                                            S01103
     C           SUMACR    IFLT 0                           B001          S01103
     C           N         ANDLT4                                         S01103
     C           SUMACR    ORGE 0                                         S01103
     C           N         ANDGT3                                         S01103
     C                     MOVE '1'       *IN39                           S01103
     C                     ELSE                             X001          S01103
     C                     MOVE '0'       *IN39                           S01103
     C                     END                              E001          S01103
0602 C*                                                                   S01103
0607 C**   Additional processing for posting reference 1.                 S01103
0608 C**                                                                  S01103
0609 C                     EXSR PREF1                                     S01103
0613 C**                                                                  S01103
0617 C*                                                                   S01103
0618 C*    Increment count of postings generated                          S01103
0619 C                     ADD  1         NRIT    50                      S01103
0621 C*                                                                   S01103
0622 C*    Generate entries - to suspense if necessary.                   S01103
0623 C                     SETON                     12                   S01103
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295CCP4
      *                                                                   S01408
0624 C***********          EXCPT                                          S01522
     C*                                                                   S01522
     C* If suspense, generate and output separately:                      S01522
     C*                                                                   S01522
     C           *IN29     IFEQ *ON                                       S01522
     C                     EXSR SRSUSP                                    S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* Determine Posting Narrative:                                      S01522
     C                     EXSR SRGENT                                    S01522
     C*                                                                   S01522
     C* If a generated entry, output:                                     S01522
     C*                                                                   S01522
     C           *IN11     IFEQ *OFF                                      S01522
      *                                                                   CPB005
     C********** CPB005    IFEQ 'Y'                                                    CPB005 248968
     C********** EVCOD     ANDEQ'I'                                                    CPB005 248968
     C           EVCOD     IFEQ 'I'                                                           248968
     C           EVSUB     ANDEQ'T'                                       CPB005
     C           POS11     ANDEQ' '                                       CPB005
     C********** CPB005    OREQ 'Y'                                                    CPB005 248968
     C********** EVCOD     ANDEQ'M'                                                    CPB005 248968
     C           EVCOD     OREQ 'M'                                                           248968
     C           EVSUB     ANDEQ'T'                                       CPB005
     C           POS11     ANDEQ' '                                       CPB005
      *                                                                   CPB005
     C                     MOVE '98100'   TRAT                            CPB005
      *                                                                   CPB005
     C                     ENDIF                                          CPB005
     C/COPY WNCPYSRC,DL0295C085
      *                                                                   CPB005
     C           BRCDA     IFEQ *BLANKS                                   149507
     C                     MOVE BRCA      BRCDA                           149507
     C                     ENDIF                                          149507
     C           NTOSBR    IFEQ *BLANKS                                   149507
     C                     MOVE BRCA      NTOSBR                          149507
     C                     ENDIF                                          149507
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTGENENT                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     EXCPTGENENT                                    S01522
     C                     ENDIF                                          CRE009
     C/COPY WNCPYSRC,DL0295C057
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* If a booking branch posting, output:                              S01522
     C*                                                                   S01522
     C           *IN35     IFEQ *ON                                       S01522
     C           *IN70     ANDEQ*ON                                       S01522
     C           *IN77     ANDEQ*ON                                       S01522
      *                                                                                       222171
      ** Initialize W#IN96 for interbranch entry                                              222171
      *                                                                                       222171
     C           OSBR      IFNE BKMABR                                                        222171
     C           BRCA      ANDNEBKMABR                                                        222171
     C           BKIEMB    ANDEQ'Y'                                                           222171
     C                     MOVE '1'       W#IN96                                              222171
     C                     MOVE *BLANKS   W#BICN                                              222171
     C                     MOVE OBICN     W#BICN                                              222171
     C                     MOVE @@BICN    OBICN                                               222171
     C                     ELSE                                                               222171
     C                     MOVE '0'       W#IN96                                              222171
     C                     ENDIF                                                              222171
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTBOOKBR                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     EXCPTBOOKBR                                    S01522
     C                     ENDIF                                          CRE009
      *                                                                                       222171
     C           W#IN96    IFEQ '1'                                                           222171
     C                     MOVE W#BICN    OBICN                                               222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
      ** If via main branch generate aditional posting                                        222171
      *                                                                                       222171
     C           W#IN96    IFEQ '1'                                                           222171
     C                     EXCPTBOOKMB                                                        222171
      *                                                                                       222171
      ** Add amount to hash totals                                                            222171
      *                                                                                       222171
     C                     ADD  1         NRIT                                                222171
     C                     Z-ADD2         S                                                   222171
     C                     Z-ADD1         Z                                                   222171
     C           PSTA      DIV  1000      ZZAMT                                               222171
     C                     EXSR HASH                                                          222171
      *                                                                                       222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
     C/COPY WNCPYSRC,DL0295C056
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* If a settlement branch posting, output:                           S01522
     C*                                                                   S01522
     C           *IN35     IFEQ *ON                                       S01522
     C           *IN70     ANDEQ*ON                                       S01522
     C           *IN77     ANDEQ*ON                                       S01522
     C           *IN11     ANDEQ*OFF                                      S01522
     C           OSBR      IFEQ *BLANKS                                   149507
     C                     MOVE BRCA      OSBR                            149507
     C                     ENDIF                                          149507
      *                                                                                       222171
      ** Initialize W#IN96 for interbranch entry                                              222171
      *                                                                                       222171
     C           OSBR      IFNE BKMABR                                                        222171
     C           BRCA      ANDNEBKMABR                                                        222171
     C           BKIEMB    ANDEQ'Y'                                                           222171
     C                     MOVE '1'       W#IN96                                              222171
     C                     MOVE *BLANKS   W#BICN                                              222171
     C                     MOVE BBICN     W#BICN                                              222171
     C                     MOVE @@BICN    BBICN                                               222171
     C                     ELSE                                                               222171
     C                     MOVE '0'       W#IN96                                              222171
     C                     ENDIF                                                              222171
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTSETTAC                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     EXCPTSETTAC                                    S01522
     C                     ENDIF                                          CRE009
      *                                                                                       222171
     C           W#IN96    IFEQ '1'                                                           222171
     C                     MOVE W#BICN    BBICN                                               222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
      ** If via main branch generate aditional posting                                        222171
      *                                                                                       222171
     C           W#IN96    IFEQ '1'                                                           222171
     C                     EXCPTSETTMB                                                        222171
      *                                                                                       222171
      ** Add amount to hash totals                                                            222171
      *                                                                                       222171
     C                     ADD  1         NRIT                                                222171
     C                     Z-ADD2         S                                                   222171
     C                     Z-ADD1         Z                                                   222171
     C           PSTA      DIV  1000      ZZAMT                                               222171
     C                     EXSR HASH                                                          222171
      *                                                                                       222171
     C                     ENDIF                                                              222171
      *                                                                                       222171
     C/COPY WNCPYSRC,DL0295C058
     C                     ENDIF                                          S01522
     C*                                                                   CEU003
     C** If SAR CEU003 and Settlement Account Posting and Settlement      CEU003
     C** currency not blank generate Settlement currency entries.         CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           *IN35     ANDEQ*ON                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     EXSR SRSENT                                    CEU003
     C                     ENDIF                                          CEU003
     C/SPACE                                                              S01103
     C*    Maintain debit,credit totals for branch/currency (excluding )  S01103
     C*    interbranch postings).                                         S01103
     C           *IN39     IFEQ '1'                                       S01103
     C                     ADD  ACRLSM    CRTOT                           S01103
     C                     ELSE                                           S01103
     C                     ADD  ACRLSM    DRTOT                           S01103
     C                     END                                            S01103
0625 C*                                                                   S01103
0626 C*    Add posting amount to hash total                               S01103
     C           ACRLSM    DIV  1000      ZZAMT                           S01103
0628 C                     Z-ADD2         S                               S01103
     C                     Z-ADD1         Z                               S01094
0629 C                     EXSR HASH                                      S01103
0630 C                     SETOF                     122933               S01103
0631 C                     SETOF                     3437                 S01103
     C                     SETOF                     70                   S01103
0632 C                     GOTO L1NEXT                                    S01103
0633 C*                                                                   S01103
0634 C*    Set error indicator.                                           S01103
0635 C           L1ERR     TAG                             ** ERROR TAG **S01103
0636 C                     SETON                     LRU7U8               S01103
0637 C*                                                                   S01103
     C           L1END     ENDSR                                          S01103
     C/EJECT                                                              CEU003
     C*****************************************************************   CEU003
     C**                                                              *   CEU003
     C**   SRSENT    - GENERATE SETTLEMENT CURRENCY ENTRIES           *   CEU003
     C**                                                              *   CEU003
     C**   CALLS     - SR HASH (5) SR ZCONVN (1) SR SRWSEN (4)        *   CEU003
     C**             - PGM AOACODR0                                   *   CEU003
     C**                                                              *   CEU003
     C**   CALLED BY - SR L1POST (2)                                  *   CEU003
     C**                                                              *   CEU003
     C*****************************************************************   CEU003
     C           SRSENT    BEGSR                                          CEU003
     C*                                                                   135224
     C                     Z-ADDPSTA      WSPSTA 130                      135224
     C*                                                                   CEU003
     C**   Retrieve the Settlement Currency Spot Trade Acount using       CEU003
     C**   the settlement currency and move to temporary field.           CEU003
     C*                                                                   CEU003
     C                     Z-ADD1         X                               CEU003
     C           STCY      LOKUPCCYA,X                   40               CEU003
     C*                                                                   CEU003
     C**********           MOVE XSPQ,X    T#SPEQ  4                                    CEU003 CGL029
     C                     MOVE XSPQ,X    T#SPEQ 10                                           CGL029
     C*                                                                   CEU003
     C** Read Account Code Details VIA Access Program                     CEU003
     C*                                                                   CEU003
     C           T#SPEQ    IFNE '    '                                    CEU003
     C           T#SPEQ    ANDNE'0000'                                    CEU003
     C                     CALL 'AOACODR0'                                CEU003
     C                     PARM '*MSG   ' @RTCD   7                       CEU003
     C                     PARM '*KEY   ' @OPTN   7                       CEU003
     C**********           PARM T#SPEQ    @AFNB   4                                    CEU003 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        CEU003 CGL029
     C                     PARM T#SPEQ    @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CEU003
     C           @RTCD     IFNE *BLANK                                    CEU003
     C                     Z-ADD21        DBASE            **********     CEU003
     C                     MOVEL@OPTN     DBOPTN  7        *  21    *     CEU003
     C                     MOVEL@AFNB     DBKEY            **********     CEU003
     C                     MOVEL'SDACODPD'DBFILE                          CEU003
     C                     GOTO ERROR                                     CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C**   If record found save A5ACTY into T#TYPB                        CEU003
     C**               and save A5ACSC into T#CSCB                        CEU003
     C*                                                                   CEU003
     C                     MOVE A5ACTY    T#TYPB  1                       CEU003
     C                     MOVE A5ACSC    T#CSCB  2                       CEU003
     C*                                                                   CEU003
     C**   If a retail account move 1 into T#INDT                         CEU003
     C*                                                                   CEU003
     C           A5ACTY    IFEQ 'R'                                       CEU003
     C                     MOVE '1'       T#INDT  1                       CEU003
     C                     ELSE                                           CEU003
     C*                                                                   CEU003
     C**   If not a retail account  move 0 into T#INDT                    CEU003
     C*                                                                   CEU003
     C                     MOVE '0'       T#INDT                          CEU003
     C                     ENDIF                                          CEU003
     C                     ENDIF                                          CEU003
      *                                                                   145264
      ** Define Event Currency spot trade equivalent account details      145264
      *  Ideally, this should already be the Q-affixed account code       145264
      ** details but this is not filled up when ECCY = Local Ccy (see     145264
      ** SR/P02) so redefine here.                                        145264
      *                                                                   145264
     C                     SELEC                                          145264
     C           ECCY      WHEQ BJLCCY                                    145264
     C           BJLCCY    ANDNEBJCYCD                                    145264
     C**********           MOVE LSPEQ     Q#SPEQ  4                                    145264 CGL029
     C                     MOVE LSPEQ     Q#SPEQ 10                                           CGL029
     C                     MOVE LSPOT     Q#SPOT 138                      145264
     C                     MOVE LDECP     Q#DECP  10                      145264
     C                     MOVE LMDIN     Q#MDIN  1                       145264
     C                     MOVE ATYPL     Q#ATYP  1                       145264
     C                     MOVE ACSCL     Q#ACSQ  2                       145264
     C                     MOVE RINDL     Q#RIND  1                       145264
     C                     OTHER                                          145264
     C                     MOVE QSPEQ     Q#SPEQ                          145264
     C                     MOVE QSPOT     Q#SPOT                          145264
     C                     MOVE QDECP     Q#DECP                          145264
     C                     MOVE QMDIN     Q#MDIN                          145264
     C                     MOVE ATYPQ     Q#ATYP                          145264
     C                     MOVE ACSCQ     Q#ACSQ                          145264
     C                     MOVE RINDQ     Q#RIND                          145264
     C                     ENDSL                                          145264
     C*                                                                   CEU003
     C**   Add Settlement posting amount (PSTA) to HASH total             CEU003
     C*                                                                   CEU003
     C           PSTA      DIV  1000      ZZAMT                           CEU003
     C                     Z-ADD1         Z                               CEU003
     C                     Z-ADD2         S                               CEU003
     C                     EXSR HASH                                      CEU003
     C*                                                                   CEU003
     C**   Determine Base Currency equivalent of the transaction amount   CEU003
     C*                                                                   CEU003
     C           ECCY      IFEQ BJCYCD                                    CEU003
     C                     Z-ADDEAMT      BEAMT                           CEU003
     C                     ELSE                                           CEU003
     C           STCY      IFEQ BJCYCD                                    CEU003
     C                     Z-ADDPSTA      BEAMT                           CEU003
     C                     ELSE                                           CEU003
     C                     Z-ADDEAMT      ZAMTCI                          CEU003
     C***********          Z-ADDQSPOT     ZEXCH                    CEU003 145264
     C***********          MOVE QMDIN     ZMD                      CEU003 145264
     C***********          Z-ADDQDECP     ZCDPI                    CEU003 145264
     C                     Z-ADDQ#SPOT    ZEXCH                           145264
     C                     MOVE Q#MDIN    ZMD                             145264
     C                     Z-ADDQ#DECP    ZCDPI                           145264
     C                     Z-ADDBDECP     ZCDPO                           CEU003
     C                     EXSR ZCONVN                                    CEU003
     C                     Z-ADDZAMTCO    BEAMT                           CEU003
     C                     ENDIF                                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C**   Build common output data                                       CEU003
     C*                                                                   CEU003
     C                     Z-ADD0         ACRAN                           CEU003
     C***********          MOVE *BLANKS   TRAT                     CEU003 133868
     C                     MOVE '00000'   TRAT                            133868
     C                     Z-ADD0         RRNM                            CEU003
     C                     MOVE BBICN     ACCNM                           CEU003
     C                     MOVE '01'      ACACS                           CEU003
     C                     MOVE BRCA      ACBRCD                          CEU003
     C*                                                                   CEU003
     C           T#SPEQ    IFNE '    '                                    CEU003
     C           T#SPEQ    ANDNE'0000'                                    CEU003
     C*                                                                   CEU003
     C**   Post to Settlement Currency Spot Trade Account                 CEU003
     C*                                                                   CEU003
     C           *IN39     IFEQ *ON                                       CEU003
     C                     MOVE *OFF      *IN39                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE *ON       *IN39                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     MOVE STCY      ACCCY                           CEU003
     C                     MOVE BLSPTA    ACACD                           CEU003
     C                     MOVE ATYPT     ATYPA                           CEU003
     C                     MOVE ACSCT     ACSCA                           CEU003
     C                     MOVE T#INDT    RINDA                           CEU003
     C*                                                                   CEU003
     C**   Write Settlement Entry                                         CEU003
     C*                                                                   CEU003
     C                     EXSR SRWSEN                                    CEU003
     C*                                                                   CEU003
     C**   Add posting amount (PSTA) to HASH total                        CEU003
     C*                                                                   CEU003
     C           PSTA      DIV  1000      ZZAMT                           CEU003
     C                     Z-ADD1         Z                               CEU003
     C                     Z-ADD2         S                               CEU003
     C                     EXSR HASH                                      CEU003
     C*                                                                   CEU003
     C**   Post to Settlement Currency Spot trade Equivalent Account      CEU003
     C*                                                                   CEU003
     C           *IN39     IFEQ *ON                                       CEU003
     C                     MOVE *OFF      *IN39                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE *ON       *IN39                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     MOVE BJCYCD    ACCCY                           CEU003
     C                     Z-ADDBEAMT     PSTA                            CEU003
     C                     MOVE T#SPEQ    ACACD                           CEU003
     C                     MOVE T#TYPB    ATYPA                           CEU003
     C                     MOVE T#CSCB    ACSCA                           CEU003
     C                     MOVE T#INDT    RINDA                           CEU003
     C*                                                                   CEU003
     C**   Write settlement entry                                         CEU003
     C*                                                                   CEU003
     C                     EXSR SRWSEN                                    CEU003
     C*                                                                   CEU003
     C**   Add posting amount (PSTA) to HASH total                        CEU003
     C*                                                                   CEU003
     C           PSTA      DIV  1000      ZZAMT                           CEU003
     C                     Z-ADD1         Z                               CEU003
     C                     Z-ADD2         S                               CEU003
     C                     EXSR HASH                                      CEU003
     C                     ADD  2         NRIT                            CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C***********QSPEQ     IFNE *BLANK                             CEU003 145264
     C***********QSPEQ     ANDNE'0000'                             CEU003 145264
     C           Q#SPEQ    IFNE *BLANK                                    145264
     C           Q#SPEQ    ANDNE'0000'                                    145264
     C*                                                                   CEU003
     C**   Post to Transaction Currency Spot Trade Equivalent Account     CEU003
     C*                                                                   CEU003
     C           *IN39     IFEQ *ON                                       CEU003
     C                     MOVE *OFF      *IN39                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE *ON       *IN39                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     MOVE BJCYCD    ACCCY                           CEU003
     C                     Z-ADDBEAMT     PSTA                            CEU003
     C***********          MOVE QSPEQ     ACACD                    CEU003 145264
     C***********          MOVE ATYPQ     ATYPA                    CEU003 145264
     C***********          MOVE ACSCQ     ACSCA                    CEU003 145264
     C***********          MOVE RINDQ     RINDA                    CEU003 145264
     C                     MOVE Q#SPEQ    ACACD                           145264
     C                     MOVE Q#ATYP    ATYPA                           145264
     C                     MOVE Q#ACSQ    ACSCA                           145264
     C                     MOVE Q#RIND    RINDA                           145264
     C*                                                                   CEU003
     C**   Write Settlement Entry                                         CEU003
     C*                                                                   CEU003
     C                     EXSR SRWSEN                                    CEU003
     C*                                                                   CEU003
     C**   Add posting amount (PSTA) to HASH total                        CEU003
     C*                                                                   CEU003
     C           PSTA      DIV  1000      ZZAMT                           CEU003
     C                     Z-ADD1         Z                               CEU003
     C                     Z-ADD2         S                               CEU003
     C                     EXSR HASH                                      CEU003
     C*                                                                   CEU003
     C**   Post to Transaction Currency Spot Trade Account                CEU003
     C*                                                                   CEU003
     C           *IN39     IFEQ *ON                                       CEU003
     C                     MOVE *OFF      *IN39                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE *ON       *IN39                           CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C                     MOVE ECCY      ACCCY                           CEU003
     C                     Z-ADDEAMT      PSTA                            CEU003
     C                     MOVE BLSPTA    ACACD                           CEU003
     C                     MOVE ATYPT     ATYPA                           CEU003
     C                     MOVE ACSCT     ACSCA                           CEU003
     C                     MOVE RINDT     RINDA                           CEU003
     C*                                                                   CEU003
     C**   Write Settlement Entry                                         CEU003
     C*                                                                   CEU003
     C                     EXSR SRWSEN                                    CEU003
     C*                                                                   CEU003
     C**   Add posting amount (PSTA) to HASH total                        CEU003
     C*                                                                   CEU003
     C           PSTA      DIV  1000      ZZAMT                           CEU003
     C                     Z-ADD1         Z                               CEU003
     C                     Z-ADD2         S                               CEU003
     C                     EXSR HASH                                      CEU003
     C                     ADD  2         NRIT                            CEU003
     C*                                                                   CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C***********EAMT      DIV  1000      ZAMT                     134907 135224
     C*                                                                   134907
     C                     ENDSR                                          CEU003
     C/EJECT                                                              CEU003
     C*****************************************************************   CEU003
     C**                                                              *   CEU003
     C**   SRWSEN    - WRITE SETTLEMENT ENTRY                         *   CEU003
     C**                                                              *   CEU003
     C**   CALLS     - SR SRPNAR (1)                                  *   CEU003
     C**                                                              *   CEU003
     C**   CALLED BY - SR SRSENT (4)                                  *   CEU003
     C**                                                              *   CEU003
     C*****************************************************************   CEU003
     C           SRWSEN    BEGSR                                          CEU003
     C*                                                                   CEU003
     C                     CLEAR##NDS3                                    CEU003
     C                     MOVE *BLANKS   ##CNUM                          CEU003
     C                     MOVE *BLANKS   ##TRNO                          CEU003
     C                     MOVE *BLANKS   ##SDTE                          CEU003
     C                     MOVE *BLANKS   ##DUED                          CEU003
     C                     MOVE *BLANKS   ##OAMT                          CEU003
     C                     MOVE *BLANKS   ##IRTE                          CEU003
     C                     MOVE *BLANKS   ##YRTE                          CEU003
     C                     MOVE *BLANKS   ##RODL                          CEU003
     C                     MOVE *BLANKS   ##OCCY                          CEU003
     C                     MOVE *BLANKS   ##ACNO                          CEU003
     C*                                                                   CEU003
     C                     MOVE DLNO      ##DLN3                          CEU003
     C                     MOVE DLNO      ##TRNO                          CEU003
     C                     MOVE BBCRNM    ##CRNM                          149954
     C*                                                                   CEU003
     C                     MOVE ##NDS3    O#PNAR                          CEU003
     C           WRNAR     IFNE 'Y'                                       CEU015
     C                     MOVE 'GB29000' ##MGID                          CEU003
     C                     ELSE                                           CEU015
     C                     MOVE 'GB51000' ##MGID                          CEU015
     C                     ENDIF                                          CEU015
     C                     MOVE BRCDA     ##BRCA                          CEU003
     C                     MOVE CNUMAC    ##CNUM                          CEU003
     C                     MOVE CCY       ##CCY                           CEU003
     C                     MOVE ACODE     ##ACCD                          CEU003
     C                     MOVE ACSQ      ##ACSQ                          CEU003
     C                     MOVE CNUM      ##ASOC                          CEU003
     C*                                                                   CEU003
     C                     EXSR SRPNAR                                    CEU003
     C*                                                                   CEU003
     C           *IN19     IFEQ *OFF                                      CEU003
     C                     MOVE '*'       O#PNAR                          CEU003
     C/COPY WNCPYSRC,DL0295C076
     C                     ENDIF                                          CEU003
     C*                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTSETCUR                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     EXCPTSETCUR                                    CEU003
     C                     ENDIF                                          CRE009
     C*                                                                   CEU003
     C/COPY WNCPYSRC,DL0295C063
     C*                                                                   CEU003
     C                     ENDSR                                          CEU003
     C*****************************************************************   S01103
     C**                                                                  CDL002
     C*     Level break 2 total time routine to set up and write          CDL002
     C*     net deal postings, if required.                               CDL002
     C*                 - called from main routine only if CDL002= 'Y'    CDL002
     C/SPACE 2                                                            CDL002
     C           NETPST    BEGSR                                          CDL002
     C*                                                                   CDL002
     C*                                                                   CDL002
     C                     MOVE 'RE:'     REF                             CDL002
     C                     MOVE ' NET '   NET                             CDL002
     C                     MOVE '1'       NETFLG                          CDL002
     C                     MOVEA'010'     *IN,34                          CDL002
     C                     Z-ADD0         DLNO                            CDL002
     C                     MOVE *BLANKS   DTYP                            CDL002
     C                     MOVE *BLANKS   SUBT                            CDL002
     C                     MOVE *BLANKS   DLREF                           CDL002
     C*                                                                   CDL002
     C                     MOVELDSPNAR    O#PNAR                          CDL002
      ** Set SWIFT COMMON REFERENCE equal to NET REFERENCE                CDL002
     C                     MOVE '0'       *IN78                           CDL002
     C                     MOVE RANETR    ZCMREF                          CDL002
      *                                                                                       246620
      ** FX netting transactions have no profit centre defined on                             246620
      ** entry to DL0295 as this is not processed on file FXNETMPD.                           246620
      ** Default value of PRFC for FX netting transactions from                               246620
      ** primary funding profit centre.  When the account is                                  246620
      ** retail or nostro, PRFCA will be used given all conditions                            246620
      ** are met.                                                                             246620
      *                                                                                       246620
     C           PRFC      IFEQ *BLANK                                                        246620
     C                     MOVE FTPRFP    PRFC                                                246620
     C                     ENDIF                                                              246620
      *                                                                                       246620
      ** Set DEBIT/CREDIT IND based on BUY/SELL IND                       CDL002
     C           RABSIN    IFEQ 'S'                                       CDL002
     C                     MOVE '1'       *IN39                           CDL002
     C                     MOVE '1'       *IN69                           CDL002
     C                     ELSE                                           CDL002
     C                     MOVE '0'       *IN39                           CDL002
     C                     MOVE '0'       *IN69                           CDL002
     C                     END                                            CDL002
     C                     MOVE '0'       *IN07                           CDL002
     C                     MOVE '1'       *IN35                           CDL002
      ** Following processing should be run twice for each NET,           CDL002
      ** once using settlement instructions and then using NET            CDL002
      ** POSTING ACCOUNT from SDDEALPP, changing DR/CR IND                CDL002
     C           1         DO   2                                         CDL002
     C** Set default value of EVCOD field                                 CDL002
     C                     MOVE 'V'       EVCOD                           CDL002
     C** Postings should be treated as PREF 2                             CDL002
     C                     EXSR PREF2                                     CDL002
     C   70                EXSR EXTRA                                     CDL002
     C           *IN70     IFEQ *ON                                       CDL002
     C           *IN10     ANDEQ*OFF                                      CDL002
     C                     EXSR *PSSR                                     CDL002
     C                     ENDIF                                          CDL002
     C           *IN10     IFEQ *ON                                       CDL002
     C                     MOVE *OFF      *IN10                           CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C** If an account is found and is RETAIL and POSTING is not          CDL002
     C** already being sent to SUSPENSE.                                  CDL002
     C           *IN06     IFEQ '1'                                       CDL002
     C           *IN38     ANDEQ'1'                                       CDL002
     C           *IN29     ANDEQ'0'                                       CDL002
     C*                                                                   CDL002
     C** If DEBITS and CREDITS are blocked send POSTING to SUSPENSE.      CDL002
     C/COPY WNCPYSRC,DLH00393
     C           *IN39     IFEQ '0'                                       CDL002
     C                     TESTB'2'       RETB           29    DEBITS     CDL002
     C                     ELSE                                           CDL002
     C                     TESTB'3'       RETB           29    CREDITS    CDL002
     C                     END                                            CDL002
     C/COPY WNCPYSRC,DLH00394
     C                     END                                            CDL002
     C*                                                                   CDL002
     C** Increment count of POSTINGS generated                            CDL002
     C           NRIT      ADD  1         NRIT    50                      CDL002
     C   70 35   NRIT      ADD  2         NRIT                            CDL002
     C*                                                                   CDL002
     C** Generate entries - to SUSPENSE if necessary.                     CDL002
     C                     SETON                     12                   CDL002
     C*                                                                   CDL002
     C* If suspense, generate and output separately:                      CDL002
     C*                                                                   CDL002
     C           *IN29     IFEQ *ON                                       CDL002
     C                     EXSR SRSUSP                                    CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C* Determine Posting Narrative:                                      CDL002
     C                     EXSR SRGENT                                    CDL002
      *                                                                   CDL002
      **  If Analytical Accounting module is switched on and the          CDL002
      **  account key is an existing Midas account key                    CDL002
      *                                                                   CDL002
     C                     MOVE *OFF      *IN58                           CDL002
     C                     MOVE *OFF      *IN56                           CDL002
     C                     MOVE *OFF      *IN71                           CDL002
     C           BGN0ST    IFEQ 'Y'                                       CDL002
     C           AKEY6     ANDNE'T'                                       CDL002
     C           AKEY6     ANDNE'F'                                       CDL002
     C           *IN11     ANDEQ*OFF                                      CDL002
      *                                                                   CDL002
      **  If an entry to a retail or a nostro account is being            CDL002
      **  generated, seton indicator 56 to output profit centre of        CDL002
      **  the account from ACCNTAB                                        CDL002
      *                                                                   CDL002
     C           ATYPA     IFEQ 'R'                                       CDL002
     C           ATYPA     OREQ 'N'                                       CDL002
     C                     MOVE *ON       *IN56                           CDL002
     C                     ELSE                                           CDL002
      *                                                                   CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C* If a generated entry, output:                                     CDL002
     C*                                                                   CDL002
     C           *IN11     IFEQ *OFF                                      CDL002
     C           BRCDA     IFEQ *BLANKS                                   149507
     C                     MOVE BRCA      BRCDA                           149507
     C                     ENDIF                                          149507
     C           NTOSBR    IFEQ *BLANKS                                   149507
     C                     MOVE BRCA      NTOSBR                          149507
     C                     ENDIF                                          149507
      *                                                                   CPB005
     C********** CPB005    IFEQ 'Y'                                                    CPB005 248968
     C********** EVCOD     ANDEQ'I'                                                    CPB005 248968
     C           EVCOD     IFEQ 'I'                                                           248968
     C           EVSUB     ANDEQ'T'                                       CPB005
     C           POS11     ANDEQ' '                                       CPB005
     C********** CPB005    OREQ 'Y'                                                    CPB005 248968
     C********** EVCOD     ANDEQ'M'                                                    CPB005 248968
     C           EVCOD     OREQ 'M'                                                           248968
     C           EVSUB     ANDEQ'T'                                       CPB005
     C           POS11     ANDEQ' '                                       CPB005
      *                                                                   CPB005
     C                     MOVE '98100'   TRAT                            CPB005
      *                                                                   CPB005
     C                     ENDIF                                          CPB005
     C/COPY WNCPYSRC,DL0295C086
      *                                                                   CPB005
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTGENENT                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     EXCPTGENENT                                    CDL002
     C                     ENDIF                                          CRE009
     C/COPY WNCPYSRC,DL0295C064
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C* If a booking branch posting, output:                              CDL002
     C*                                                                   CDL002
     C           *IN35     IFEQ *ON                                       CDL002
     C           *IN70     ANDEQ*ON                                       CDL002
     C           *IN77     ANDEQ*ON                                       CDL002
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTBOOKBR                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     EXCPTBOOKBR                                    CDL002
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C* If a settlement branch posting, output:                           CDL002
     C*                                                                   CDL002
     C           *IN35     IFEQ *ON                                       CDL002
     C           *IN70     ANDEQ*ON                                       CDL002
     C           *IN77     ANDEQ*ON                                       CDL002
     C           *IN11     ANDEQ*OFF                                      CDL002
     C           OSBR      IFEQ *BLANKS                                   149507
     C                     MOVE BRCA      OSBR                            149507
     C                     ENDIF                                          149507
      *                                                                   CRE009
      ** If CRE009 is ON and pgm is running is Shadow Post,               CRE009
      ** set the Posting Date as Value Date.                              CRE009
      ** If deal is back valued set Posting Date as Run Date.             CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     MOVE *IN40     SAV40   1                       CRE009
     C           DLNO      CHAINDEALSDBF             40                   CRE009
     C           *IN40     IFEQ *OFF                                      CRE009
     C                     Z-ADDVDAT      @EDAT   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDEDAT      @EDAT                           CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV40     *IN40                           CRE009
      *                                                                   CRE009
     C           @EDAT     IFLT BJRDNB                                    CRE009
     C                     Z-ADDBJRDNB    WDATE   50                      CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD@EDAT     WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADDBJRDNB    WDATE                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If in shadow post mode and CRE009 is ON and the event date is    CRE009
      ** greater than the next day and the account is not retail, do not  CRE009
      ** write record to GEDLPD.                                          CRE009
      **                                                                  CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C           *INU1     ANDEQ*OFF                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @EVCD   50                      CRE009
     C           BJDNWD    SUB  1         @EVCD                           CRE009
     C           @EVCD     IFGE BKAPDT                                    CRE009
     C                     Z-ADDBKAPDT    @EVCD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           *IN38     IFEQ *ON                                       CRE009
     C           *IN38     ORNE *ON                                       CRE009
     C           EDAT      ANDLE@EVCD                                     CRE009
     C                     EXCPTSETTAC                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
     C                     EXCPTSETTAC                                    CDL002
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C** For Foreign Tax Posting, generate Spot Trade & Equivalent A/c    CDL002
     C**  Entries                                                         CDL002
     C*                                                                   CDL002
     C           *IN60     IFEQ '1'                                       CDL002
     C                     EXSR P04                                       CDL002
     C                     ENDIF                                          CDL002
     C/SPACE                                                              CDL002
     C** Maintain DR,CR totals for BRANCH/CCY (EXCL.INTERBRANCH ITEMS)    CDL002
     C           *IN39     IFEQ '1'                                       CDL002
     C                     ADD  EAMT      CRTOT                           CDL002
     C                     ELSE                                           CDL002
     C                     ADD  EAMT      DRTOT                           CDL002
     C                     END                                            CDL002
     C*                                                                   CDL002
     C** Add POSTING amount to HASH total                                 CDL002
     C           EAMT      DIV  1000      ZAMT                            CDL002
     C                     Z-ADDZAMT      ZZAMT                           CDL002
     C                     Z-ADD2         S                               CDL002
     C                     Z-ADD1         Z                               CDL002
     C           *IN70     IFEQ '1'                                       CDL002
     C           *IN35     ANDEQ'1'                                       CDL002
     C                     ADD  2         Z                               CDL002
     C                     END                                            CDL002
     C                     EXSR HASH                                      CDL002
     C                     SETOF                     122933               CDL002
     C                     SETOF                     37                   CDL002
     C                     SETOF                     70                   CDL002
      * Set DEBIT/CREDIT IND based on previous status                     CDL002
     C           *IN39     IFEQ '0'                                       CDL002
     C                     MOVE '1'       *IN39                           CDL002
     C                     MOVE '1'       *IN69                           CDL002
     C                     ELSE                                           CDL002
     C                     MOVE '0'       *IN39                           CDL002
     C                     MOVE '0'       *IN69                           CDL002
     C                     END                                            CDL002
     C                     MOVE '1'       *IN07                           CDL002
     C                     END                                            CDL002
     C                     MOVE 'D'       DL2                             CDL002
     C                     MOVE '0'       NETFLG                          CDL002
     C                     ENDSR                                          CDL002
     C/EJECT                                                              CEU015
     C*****************************************************************   CEU015
     C**                                                              *   CEU015
     C**   SREREN    - Generate spot trade and equivalent account     *   CEU015
     C**               entries for deals rolled over from 'In'        *   CEU015
     C**               currency to Euros.                             *   CEU015
     C**                                                              *   CEU015
     C**   CALLS     -                                                *   CEU015
     C**                                                              *   CEU015
     C**   CALLED BY - MAIN ROUTINE                                   *   CEU015
     C**                                                              *   CEU015
     C*****************************************************************   CEU015
      *                                                                   CEU015
     C           SREREN    BEGSR                                          CEU015
      *                                                                   CEU015
      **  Initialise workfield to control spot trade and bccy             CEU015
      **  narrative entries                                               CEU015
      *                                                                   CEU015
     C                     MOVE 'Y'       WRNAR   1                       CEU015
      *                                                                   CEU015
      **  Save current value of PSTA                                      CEU015
      *                                                                   CEU015
     C                     Z-ADDPSTA      WSPSTA                          CEU015
      *                                                                   CEU015
      ** Retrieve the Spot Trade Equivalent Account for the               CEU015
      ** Rolled-Over-To-Currency and move to temporary field.             CEU015
      *                                                                   CEU015
     C                     Z-ADD1         X                               CEU015
     C           RTFC      LOKUPCCYA,X                   40               CEU015
      *                                                                   CEU015
     C**********           MOVE XSPQ,X    @STEA   4                                    CEU015 CGL029
     C                     MOVE XSPQ,X    @STEA  10                                           CGL029
      *                                                                   CEU015
     C           @STEA     IFNE *BLANKS                                   CEU015
     C           @STEA     ANDNE'0000'                                    CEU015
      *                                                                   CEU015
      ** Get account code details for Rolled-Over-To-Currency             CEU015
      ** Spot Trade Equivalent Account.                                   CEU015
      *                                                                   CEU015
     C                     CALL 'AOACODR0'                                CEU015
     C                     PARM '*MSG   ' @RTCD   7                       CEU015
     C                     PARM '*KEY   ' @OPTN   7                       CEU015
     C**********           PARM @STEA     @AFNB   4                                    CEU015 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        CEU015 CGL029
     C                     PARM @STEA     @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                   CEU015
     C           @RTCD     IFNE *BLANK                                    CEU015
     C                     Z-ADD32        DBASE            **********     CEU015
     C                     MOVEL@OPTN     DBOPTN  7        *  32    *     CEU015
     C                     MOVEL@STEA     DBKEY            **********     CEU015
     C                     MOVEL'SDACODPD'DBFILE                          CEU015
     C                     GOTO ERROR                                     CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
      ** If record found save A5ACTY into @ACTY                           CEU015
      **             and save A5ACSC into @ACSC                           CEU015
      *                                                                   CEU015
     C                     MOVE A5ACTY    @ACTY   1                       CEU015
     C                     MOVE A5ACSC    @ACSC   2                       CEU015
      *                                                                   CEU015
      ** If a retail account move 1 into @TRIN                            CEU015
      *                                                                   CEU015
     C           A5ACTY    IFEQ 'R'                                       CEU015
     C                     MOVE '1'       @TRIN   1                       CEU015
     C                     ELSE                                           CEU015
      *                                                                   CEU015
      ** If not a retail account  move 0 into @TRIN                       CEU015
      *                                                                   CEU015
     C                     MOVE '0'       @TRIN                           CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
     C                     ENDIF                                          CEU015
      *                                                                   145264
      ** Define Event Currency spot trade equivalent account details      145264
      ** Ideally, this should already be the Q-affixed account code       145264
      ** details but this is not filled up when ECCY = Local Ccy (see     145264
      ** SR/P02) so redefine here.                                        145264
      *                                                                   145264
     C                     SELEC                                          145264
     C           ECCY      WHEQ BJLCCY                                    145264
     C           BJLCCY    ANDNEBJCYCD                                    145264
     C                     MOVE LSPEQ     Q#SPEQ                          145264
     C                     MOVE LSPOT     Q#SPOT                          145264
     C                     MOVE LDECP     Q#DECP                          145264
     C                     MOVE LMDIN     Q#MDIN                          145264
     C                     MOVE ATYPL     Q#ATYP                          145264
     C                     MOVE ACSCL     Q#ACSQ                          145264
     C                     MOVE RINDL     Q#RIND                          145264
     C                     OTHER                                          145264
     C                     MOVE QSPEQ     Q#SPEQ                          145264
     C                     MOVE QSPOT     Q#SPOT                          145264
     C                     MOVE QDECP     Q#DECP                          145264
     C                     MOVE QMDIN     Q#MDIN                          145264
     C                     MOVE ATYPQ     Q#ATYP                          145264
     C                     MOVE ACSCQ     Q#ACSQ                          145264
     C                     MOVE RINDQ     Q#RIND                          145264
     C                     ENDSL                                          145264
      *                                                                   CEU015
      ** Add Rollover posting amount to HASH total                        CEU015
      *                                                                   CEU015
     C           PSTA      DIV  1000      ZZAMT                           CEU015
     C                     Z-ADD1         Z                               CEU015
     C                     Z-ADD2         S                               CEU015
     C                     EXSR HASH                                      CEU015
      *                                                                   CEU015
      ** Determine Base Currency equivalent of the rollover amount        CEU015
      ** (event amount).                                                  CEU015
      *                                                                   CEU015
     C           ECCY      IFEQ BJCYCD                                    CEU015
     C           *LIKE     DEFN EAMT      @BCAMT                          CEU015
     C                     Z-ADDEAMT      @BCAMT                          CEU015
     C                     ELSE                                           CEU015
      *                                                                   CEU015
     C           RTFC      IFEQ BJCYCD                                    CEU015
     C                     Z-ADDPSTA      @BCAMT                          CEU015
     C                     ELSE                                           CEU015
     C                     Z-ADDEAMT      ZAMTCI                          CEU015
     C***********          Z-ADDQSPOT     ZEXCH                    CEU015 145264
     C***********          MOVE QMDIN     ZMD                      CEU015 145264
     C***********          Z-ADDQDECP     ZCDPI                    CEU015 145264
     C                     Z-ADDQ#SPOT    ZEXCH                           145264
     C                     MOVE Q#MDIN    ZMD                             145264
     C                     Z-ADDQ#DECP    ZCDPI                           145264
     C                     Z-ADDBDECP     ZCDPO                           CEU015
     C                     EXSR ZCONVN                                    CEU015
     C                     Z-ADDZAMTCO    @BCAMT                          CEU015
      *                                                                   CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
      ** Build common output data                                         CEU015
      *                                                                   CEU015
     C                     Z-ADD0         ACRAN                           CEU015
     C**********           MOVE *BLANKS   TRAT                                       CEU015 AR813358
     C                     MOVE '00000'   TRAT                                              AR813358
     C                     Z-ADD0         RRNM                            CEU015
     C                     MOVE BBICN     ACCNM                           CEU015
     C                     MOVE '01'      ACACS                           CEU015
     C                     MOVE BRCA      ACBRCD                          CEU015
      *                                                                   CEU015
      ** If the Rolled-Over-To-Currency Spot Trade Equivalent             CEU015
      ** Account is not blank or '0000' then Post to Rolled-Over-         CEU015
      ** To-Currency Spot Trade Account.                                  CEU015
      *                                                                   CEU015
     C           @STEA     IFNE *BLANK                                    CEU015
     C           @STEA     ANDNE'0000'                                    CEU015
      *                                                                   CEU015
     C           *IN39     IFEQ *ON                                       CEU015
     C                     MOVE *OFF      *IN39                           CEU015
     C                     ELSE                                           CEU015
     C                     MOVE *ON       *IN39                           CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
     C                     MOVE RTFC      ACCCY                           CEU015
     C                     MOVE BLSPTA    ACACD                           CEU015
     C                     MOVE ATYPT     ATYPA                           CEU015
     C                     MOVE ACSCT     ACSCA                           CEU015
     C                     MOVE RINDT     RINDA                           CEU015
      *                                                                   CEU015
     C                     EXSR SRWSEN                                    CEU015
      *                                                                   CEU015
      **   Add posting amount (PSTA) to HASH total                        CEU015
      *                                                                   CEU015
     C           PSTA      DIV  1000      ZZAMT                           CEU015
     C                     Z-ADD1         Z                               CEU015
     C                     Z-ADD2         S                               CEU015
     C                     EXSR HASH                                      CEU015
      *                                                                   CEU015
      ** Post to Rolled-Over-To-Currency Spot Trade Equivalent            CEU015
      ** Account.                                                         CEU015
      *                                                                   CEU015
     C           *IN39     IFEQ *ON                                       CEU015
     C                     MOVE *OFF      *IN39                           CEU015
     C                     ELSE                                           CEU015
     C                     MOVE *ON       *IN39                           CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
     C                     MOVE BJCYCD    ACCCY                           CEU015
     C                     Z-ADD@BCAMT    PSTA                            CEU015
     C                     MOVE @STEA     ACACD                           CEU015
     C                     MOVE @ACTY     ATYPA                           CEU015
     C                     MOVE @ACSC     ACSCA                           CEU015
     C                     MOVE @TRIN     RINDA                           CEU015
      *                                                                   CEU015
     C                     EXSR SRWSEN                                    CEU015
      *                                                                   CEU015
      **   Add posting amount (PSTA) to HASH total                        CEU015
      *                                                                   CEU015
     C           PSTA      DIV  1000      ZZAMT                           CEU015
     C                     Z-ADD1         Z                               CEU015
     C                     Z-ADD2         S                               CEU015
     C                     EXSR HASH                                      CEU015
      *                                                                   CEU015
     C                     ADD  2         NRIT                            CEU015
      *                                                                   CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
      ** If the Event Currency Spot Trade Equivalent Account is           CEU015
      ** not blank or '0000' then Post to Event Currency Spot             CEU015
      ** Trade Equivalent Account.                                        CEU015
      *                                                                   CEU015
     C***********QSPEQ     IFNE *BLANK                             CEU015 145264
     C***********QSPEQ     ANDNE'0000'                             CEU015 145264
     C           Q#SPEQ    IFNE *BLANK                                    145264
     C           Q#SPEQ    ANDNE'0000'                                    145264
      *                                                                   CEU015
     C           *IN39     IFEQ *ON                                       CEU015
     C                     MOVE *OFF      *IN39                           CEU015
     C                     ELSE                                           CEU015
     C                     MOVE *ON       *IN39                           CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
     C                     MOVE BJCYCD    ACCCY                           CEU015
     C                     Z-ADD@BCAMT    PSTA                            CEU015
     C***********          MOVE QSPEQ     ACACD                    CEU015 145264
     C***********          MOVE ATYPQ     ATYPA                    CEU015 145264
     C***********          MOVE ACSCQ     ACSCA                    CEU015 145264
     C***********          MOVE RINDQ     RINDA                    CEU015 145264
     C                     MOVE Q#SPEQ    ACACD                           145264
     C                     MOVE Q#ATYP    ATYPA                           145264
     C                     MOVE Q#ACSQ    ACSCA                           145264
     C                     MOVE Q#RIND    RINDA                           145264
      *                                                                   CEU015
     C                     EXSR SRWSEN                                    CEU015
      *                                                                   CEU015
      **   Add posting amount (PSTA) to HASH total                        CEU015
      *                                                                   CEU015
     C           PSTA      DIV  1000      ZZAMT                           CEU015
     C                     Z-ADD1         Z                               CEU015
     C                     Z-ADD2         S                               CEU015
     C                     EXSR HASH                                      CEU015
      *                                                                   CEU015
      ** Post to Event Currency Spot Trade Account                        CEU015
      *                                                                   CEU015
     C           *IN39     IFEQ *ON                                       CEU015
     C                     MOVE *OFF      *IN39                           CEU015
     C                     ELSE                                           CEU015
     C                     MOVE *ON       *IN39                           CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
     C                     MOVE ECCY      ACCCY                           CEU015
     C                     Z-ADDEAMT      PSTA                            CEU015
     C                     MOVE BLSPTA    ACACD                           CEU015
     C                     MOVE ATYPT     ATYPA                           CEU015
     C                     MOVE ACSCT     ACSCA                           CEU015
     C                     MOVE RINDT     RINDA                           CEU015
      *                                                                   CEU015
     C                     EXSR SRWSEN                                    CEU015
      *                                                                   CEU015
      **   Add posting amount (PSTA) to HASH total                        CEU015
      *                                                                   CEU015
     C           PSTA      DIV  1000      ZZAMT                           CEU015
     C                     Z-ADD1         Z                               CEU015
     C                     Z-ADD2         S                               CEU015
     C                     EXSR HASH                                      CEU015
      *                                                                   CEU015
     C                     ADD  2         NRIT                            CEU015
      *                                                                   CEU015
     C                     ENDIF                                          CEU015
      *                                                                   CEU015
      **  Blank out narrative control workfield                           CEU015
      *                                                                   CEU015
     C                     MOVE *BLANKS   WRNAR                           CEU015
      *                                                                   CEU015
     C                     ENDSR                                          CEU015
      *                                                                   CEU015
     C/EJECT                                                              CEU015
     C*****************************************************************   CDL002
0655 C**
0656 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
0657 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
0658 C**
0659 C**         CCYARR    BEGSR                           *** CCYARR  ***S01094
0660 C**
0661 C**   SET ARRAY INDEX TO ZERO.
0662 C**                   Z-ADD0         X       30                      S01094
0663 C**
0664 C**   SET UP KEY FOR CURRENCY TABLE.
0665 C**                   MOVEL'20      'XCYKEY 12                       S01094
0666 C**                   MOVE '    '    XCYKEY                          S01094
0667 C**
0668 C**   SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.
0669 C**         XCYKEY    SETLLTABLED                                    S01094
0670 C**
0671 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0672 C**         XLOOP     TAG                             ** XLOOP TAG **S01094
0673 C**                   READ TABLED                   99               S01094
0674 C**N99      RECTX     COMP 20                   9999                 S01094
0675 C**
0676 C**   END IF ALL CURRENCY RECORDS PROCESSED
0677 C** 99                GOTO XEND                                      S01094
0678 C**
0679 C**   IGNORE DELETED RECORDS AND NON-SUB-RECORD ONE.
0680 C**         RECIX     COMP 'D'                  9797                 S01094
0681 C** 97                GOTO XLOOP                                     S01094
0682 C**         SRECX     COMP 1                    9797                 S01094
0683 C** 97                GOTO XLOOP                                     S01094
0684 C**
0685 C**   INCREMENT ARRAY INDEX.
0686 C**         X         ADD  1         X                               S01094
0687 C**
0688 C**   MOVE DATA INTO ARRAYS.
0689 C**                   MOVE CCYX      CCYA,X                          S01094
0690 C**                   MOVE CDPX      DPA,X                           S01094
0691 C**
0692 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0693 C**         X         COMP 150                      96               S01094
0694 C**
0695 C**   GO TO READ NEXT RECORD.
0696 C**N96                GOTO XLOOP                                     S01094
0697 C**
0698 C**         XEND      TAG                             ** XEND TAG  **S01094
0699 C**                   ENDSR                                          S01094
0700 C**
0701 C********************************************************************
0702 C**
0703 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
0704 C**
0705 C**         CCYDEP    BEGSR                           *** CCYDEP  ***S01094
0706 C**
0707 C**   SET ARRAY INDEX TO ONE AND RESET ERROR INDICATOR.
0708 C**                   Z-ADD1         X            99                 S01094
0709 C**
0710 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0711 C**                   Z-ADD0         XDECP   10                      S01094
0712 C**                   MOVE XCCY      XCCY    3                       S01094
0713 C**
0714 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0715 C**   99 SETON FOR INVALID CURRENCY.
0716 C**         XCCY      LOKUPCCYA,X                   95               S01094
0717 C** 95                MOVE DPA,X     XDECP                           S01094
0718 C**N95                SETON                     99                   S01094
0719 C**
0720 C**                   ENDSR                                          S01094
0721 C**
0722 C********************************************************************
0700 C/EJECT                                                              S01117
0722 C********************************************************************
0655 C**                                                                  S01117
0656 C**   SR. TO SET UP AN ARRAY OF BRANCH DETAILS FROM THE BRANCH       S01117
0657 C**   CODE TABLE  - LOADED TOP DOWN                                  S01117
0658 C**                                                                  S01117
0659 C           BCTARR    BEGSR                           *** BCTARR  ***S01117
0660 C**                                                                  S01117
0661 C**   SET ARRAY INDEX TO 100.                                        S01117
0662 C***********          Z-ADD101       IX      30               S01117 151104
     C                     Z-ADD901       IX      30                      151104
0663 C**                                                                  S01117
0664 C*****SET UP KEY FOR BRANCH TABLE.                                   S01117
0665 C*****                MOVEL'10      'BCTKEY 12                       S01117
0666 C*****                MOVE '    '    BCTKEY                          S01117
0667 C*****                                                               S01117
0668 C*****SET LOWER LIMIT AND READ BRANCH TABLE HEADER.                  S01117
0669 C*****      BCTKEY    SETLLTABLED                                    S01117
0669 C*****      BCTKEY    SETLLTABBRNC                                   S01117
0670 C*****                                                               S01117
0671 C*****LOOP TO READ BRANCH DETAIL RECORDS.                            S01117
0672 C*****      IXLOOP    TAG                             **IXLOOP TAG **S01117
0673 C*****                READ TABLED                 9999               S01117
0673 C*****                READ TABBRNC                9999               S01117
0674 C**N99      RECTX     COMP 10                   9999                 S01117
0675 C*****                                                               S01117
0676 C*****END IF ALL BRANCH RECORDS PROCESSED                            S01117
0677 C***99                GOTO IXEND                                     S01117
0678 C*****                                                               S01117
0679 C*****IGNORE DELETED RECORDS                                         S01117
0680 C*****      RECIX     COMP 'D'                  9797                 S01117
0681 C***97                GOTO IXLOOP                                    S01117
0684 C*****                                                               S01117
0685 C*****INCREMENT ARRAY INDEX.                                         S01117
0686 C*****      IX        SUB  1         IX                              S01117
0687 C*****                                                               S01117
0688 C*****MOVE DATA INTO ARRAYS.                                         S01117
0689 C*****                MOVE BRCD      BCC,IX                          S01117
0689 C*****                MOVE BRCAX     BCC,IX                          S01117
0689 C*****                MOVE BICN      BBICN                           S01117
0689 C*****                MOVE ADTO      BADTO                           S01117
0689 C*****                MOVE ADFR      BADFR                           S01117
 822 C*****                                                               S01117
0551 C*****ACCESS ACCOUNT CODES TABLE TO OBTAIN ACCOUNT TYPES             S01117
0551 C*****                                                               S01117
0823 C*****                MOVE '        'TABKEY                          S01117
0824 C*****                MOVEL'30'      TABKEY                          S01117
0551 C*****                                                               S01117
0825 C*****                MOVELBADTO     ACK1                            S01117
0826 C*****                MOVE ACK1      TABKEY                          S01117
0827 C*****                EXSR TABCHN                                    S01117
     C**N07                MOVE ' '       BTYPTO                          S01117
     C*****                MOVE ATYP      BTYPTO                          S01117
     C*****      BTYPTO    COMP 'R'                      32               S01117
     C***32                MOVE '1'       BRINTO                          S01117
     C**N32                MOVE '0'       BRINTO                          S01117
     C*****                                                               S01117
0825 C*****                MOVELBADFR     ACK1                            S01117
0826 C*****                MOVE ACK1      TABKEY                          S01117
0827 C*****                EXSR TABCHN                                    S01117
     C**N07                MOVE ' '       BTYPFR                          S01117
     C*****                MOVE ATYP      BTYPFR                          S01117
     C*****      BTYPFR    COMP 'R'                      32               S01117
     C***32                MOVE '1'       BRINFR                          S01117
     C**N32                MOVE '0'       BRINFR                          S01117
     C*****                                                               S01117
0689 C*****                MOVE BBCI      BCT,IX                          S01117
0691 C*****                                                               S01117
0692 C*****CHECK FOR FULL ARRAY. 96 ON IF FULL.                           S01117
0693 C*****      IX        COMP 1                        96               S01117
0694 C*****                                                               S01117
0695 C*****GO TO READ NEXT RECORD.                                        S01117
0696 C**N96                GOTO IXLOOP                                    S01117
0697 C*****                                                               S01117
0698 C*****      IXEND     TAG                             **IXEND TAG  **S01117
0694 C*****                                                               S01117
0695 C*****STORE NO. OF TABLE RECS                                        S01117
0698 C*****                Z-ADDIX        STIX    30                      S01117
0699 C*****                ENDSR                                          S01117
     C*
     C           IX        DOUEQ1
     C***********IX        IFEQ 101                                       151104
     C           IX        IFEQ 901                                       151104
     C*
     C** READ 1ST BRANCH DETAILS VIA ACCESS PROGRAM                       S01194
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     GOTO IXEND                                     S01194
     C                     END                                            S01194
     C                     ELSE
     C** READ NEXT BRANCH DETAILS VIA ACCESS PROGRAM                      S01194
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*NEXT  ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     GOTO IXEND                                     S01194
     C                     END                                            S01194
     C                     END                                            S01194
0686 C           IX        SUB  1         IX                              S01117
     C                     MOVE A8BRCD    BCC,IX                          S01194
     C                     MOVE A8BICN    BBICN                           S01194
     C                     MOVE A8DTAC    BADTO                           S01194
     C                     MOVE A8DFAC    BADFR                           S01194
     C                     MOVE A8BRNM    BBRNM                           080603
     C*                                                                   S01194
     C**   ACCESS ACCOUNT CODES FILE TO OBTAIN ACCOUNT TYPES              S01194
     C*                                                                   S01194
     C** READ ACCOUNT DETAILS VIA ACCESS PROGRAM                          S01194
     C                     MOVELBADTO     @AFNB                           S01194
     C                     CALL 'AOACODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C**********           PARM           @AFNB   4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM           @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE ' '       BTYPTO                          S01194
     C                     END                                            S01194
     C******               MOVE A5ACCD    BTYPTO                   S01194 LN0109
     C                     MOVE A5ACTY    BTYPTO                          LN0109
     C                     MOVE A5ACSC    BACSCO                          S10736
     C           BTYPTO    COMP 'R'                      32               S01117
     C   32                MOVE '1'       BRINTO                          S01117
     C  N32                MOVE '0'       BRINTO                          S01117
     C*                                                                   S01117
     C** READ ACCOUNT DETAILS VIA ACCESS PROGRAM                          S01194
     C                     MOVELBADFR     @AFNB                           S01194
     C                     CALL 'AOACODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C**********           PARM           @AFNB   4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM           @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE ' '       BTYPFR                          S01194
     C                     END                                            S01194
     C*****                MOVE A5ACCD    BTYPFR                   S01194 LN0109
     C                     MOVE A5ACTY    BTYPFR                          LN0109
     C                     MOVE A5ACSC    BACSCR                          S10736
     C           BTYPFR    COMP 'R'                      32               S01117
     C   32                MOVE '1'       BRINFR                          S01117
     C  N32                MOVE '0'       BRINFR                          S01117
     C*                                                                   S01117
0689 C                     MOVE BBCI      BCT,IX                          S01117
0691 C**                                                                  S01117
     C                     END                                            S01194
0697 C**                                                                  S01117
0698 C           IXEND     TAG                             **IXEND TAG  **S01117
0694 C**                                                                  S01117
0695 C**   STORE NO. OF TABLE RECS                                        S01117
0698 C                     Z-ADDIX        STIX    30                      S01117
0699 C                     ENDSR                                          S01117
     C*
0700 C**                                                                  S01117
0723 C********************************************************************
0700 C/EJECT                                                              S01117
0723 C********************************************************************
0724 C*****SR. TO ACCESS TABLE FILE.                                      S01194
0725 C*****      TABCHN    BEGSR                           *** TABCHN *** S01194
0726 C*****                                                               S01194
0727 C*****                SETOF                     070809               S01194
0728 C*****                SETOF                     10                   S01117
0729 C*****      TABKEY    CHAINTABLE                30                   S01194
0730 C*****                                                               S01194
0731 C*****                ENDSR                                          S01194
0732 C*****                                                               S01194
0733 C********************************************************************
0734 C*****SR. TO ACCESS CLIENT FILE.                                     S01194
0735 C*****      CLTCHN    BEGSR                           *** CLTCHN *** S01194
0736 C*****                                                               S01194
0737 C*****                SETOF                     11                   S01194
0738 C*****      CLTKEY    CHAINCLINT                30                   S01194
0739 C*****                                                               S01194
0740 C*****                ENDSR                                          S01194
0741 C*****                                                               S01194
0742 C********************************************************************
0743 C**
0744 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0745 C**
0746 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0747 C**
0748 C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C/COPY WNCPYSRC,DL0295C107
0749 C**
0750 C**   CLEAR DATE FIELDS.
0751 C                     Z-ADD0         ZDATE   60
0752 C                     MOVEL'       ' ZADATE  7
0753 C**
0754 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0755 C                     Z-ADDZDAYNO    ZDAYNO  50
0756 C**
0757 C**   DETERMINE YEAR NUMBER.
0758 C**
0759 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0760 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0761 C   99                GOTO ZDEND2
0762 C**
0763 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0764 C           ZDAYN1    DIV  1461      ZLYR    20
0765 C                     MVR            ZDAYN1           SAVE REMAINING
0766 C**                                                   DAYS
0767 C**   CALCULATE NUMBER OF REMAINING YEARS.
0768 C                     Z-ADD1         ZWRK2   20
0769 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0770 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0771 C  N90      ZWRK2     ADD  1         ZWRK2
0772 C  N90                GOTO ZDTAG1
0773 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0774 C**
0775 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0776 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0777 C**
0778 C**   CALCULATE ACTUAL YEAR NUMBER.
0779 C           ZLYR      MULT 4         ZWRK3   30
0780 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0781 C                     Z-ADDZWRK3     ZYEAR   20
0782 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0783 C**
0784 C**   DETERMINE MONTH NUMBER.
0785 C**
0786 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0787 C                     SETOF                     9293
0788 C   91      ZDAYN1    COMP 59                     9293
0789 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0790 C**
0791 C**   CALCULATE MONTH NUMBER.
0792 C                     Z-ADD2         ZWRK2
0793 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0794 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0795 C  N94      ZWRK2     ADD  1         ZWRK2
0796 C  N94                GOTO ZDTAG2
0797 C           ZWRK2     SUB  1         ZWRK2
0798 C**
0799 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0800 C**
0801 C**   DETERMINE DAY OF MONTH.
0802 C**
0803 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0804 C           ZDAYN1    ADD  1         ZDAYN1
0805 C**
0806 C**   CALCULATE DAY OF MONTH.
0807 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0808 C**
0809 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0810 C   93      ZDAY      ADD  1         ZDAY
0811 C**
0812 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0813 C  N98                MOVELZDAY      ZWRK4   40
0814 C   98                MOVE ZDAY      ZWRK4
0815 C  N98                MOVE ZMTH      ZWRK4
0816 C   98                MOVELZMTH      ZWRK4
0817 C                     MOVELZWRK4     ZDATE
0818 C                     MOVE ZYEAR     ZDATE
0819 C**
0820 C**   FORMAT ALPHA DATE, DDMMMYY.
0821 C           ZDAY      COMP 10                     95
0822 C                     MOVELZDAY      ZWRK5   5
0823 C   95                MOVEL' '       ZWRK5
0824 C                     MOVE ZMNM,ZMTH ZWRK5
0825 C                     MOVELZWRK5     ZADATE
0826 C                     MOVE ZYEAR     ZADATE
0827 C**
     C/COPY WNCPYSRC,DL0295C108
0828 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0829 C********************************************************************
0830 C/SPACE 3
0831 C********************************************************************
0832 C*
0833 C**   SR. TO CHAIN TO THE ACCOUNTS MASTER
0834 C**
0835 C           ACMCHN    BEGSR                           *** ACMCHN ***
0836 C**
0837 C                     SETOF                     06
0838 C**
0839 C           ACCKEY    CHAINACCNT                30
0840 C**
0841 C                     ENDSR
0842 C**
0843 C********************************************************************
0844 C/SPACE 3
0845 C********************************************************************
0846 C*
0847 C**   SR. TO CARRY OUT ADDITIONAL PROCESSING FOR POSTING
0848 C**   REFERENCE 1
0849 C**
0850 C           PREF1     BEGSR                           *** PREF1 ***
0851 C**
0852 C**   SET UP KEY FOR A/C MASTER FILE.
0853 C**
0854 C*****                MOVE BICN      ACCNM                           S01117
0854 C                     MOVE BBICN     ACCNM                           S01117
     C*                                                                   S01460
     C***********TAXAC     IFEQ '1'                                S01460 080603
     C***********          MOVE BJCYCD    ACCCY                    S01460 080603
     C           *IN60     IFEQ '1'                                       080603
     C/COPY WNCPYSRC,DL0295C109
     C                     MOVE BJLCCY    ACCCY                           080603
     C                     Z-ADDLEAMT     PSTA   130                      080603
     C/COPY WNCPYSRC,DL0295C110
     C                     ELSE                                           S01460
     C/COPY WNCPYSRC,DL0295C047
      *                                                                   CEU015
      ** Convert event amount to Rolled-Over-To-Currency Equivalent       CEU015
      ** if this is a rollover from 'In' currency to Euros                CEU015
      *                                                                   CEU015
     C           CEU015    IFEQ 'Y'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C                     CALL 'EU0200'                                  CEU015
     C                     PARM *BLANKS   P@RTCD  7        RETURN CODE    CEU015
     C                     PARM EAMT      P@FRAM 183       TRANS AMT      CEU015
     C                     PARM ECCY      P@FRCY  3        TRANS CCY      CEU015
     C                     PARM RTFC      P@TOCY  3        SETTL CCY      CEU015
     C                     PARM           P@OUTA 150       SETTL AMT      CEU015
     C                     PARM           P@INTA 183       INT SET AMT    CEU015
     C                     PARM           P@EXRT 159       EXCH RATE      CEU015
     C                     PARM           P@MDIN  1        M/D IND        CEU015
      *                                                                   CEU015
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU015
     C                     Z-ADD33        DBASE            **********     CEU015
     C                     MOVE *BLANKS   DBOPTN           *  33    *     CEU015
     C                     MOVELECCY      DBKEY            **********     CEU015
     C                     MOVEL'EU0200'  DBFILE                          CEU015
     C                     GOTO ERROR                                     CEU015
     C                     ELSE                                           CEU015
     C                     Z-ADDP@OUTA    PSTA                            CEU015
     C                     MOVELRTFC      ACCCY                           CEU015
     C                     ENDIF                                          CEU015
     C                     ELSE                                           CEU015
0855 C                     MOVE ECCY      ACCCY
     C                     Z-ADDEAMT      PSTA                            080603
     C                     ENDIF                                          CEU015
     C/COPY WNCPYSRC,DL0295C048
     C                     ENDIF                                          S01460
     C*                                                                   S01460
0856 C                     MOVE ACOD,N    ACACD
     C/COPY WNCPYSRC,DL0295C061
0857 C                     MOVE '01'      ACACS
     C/COPY WNCPYSRC,DL0295C062
0857 C                     MOVE BRCA      ACBRCD                          S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP11                                           S01408
     C*                                                                   S01408
0858 C**
0859 C**   CHAIN TO ACCOUNTS MASTER
0860 C**
0861 C                     EXSR ACMCHN
0862 C**
0863 C**      IF A/C NOT FOUND CANNOT CHECK BRANCH CODE ETC.
0864 C**
0865 C***06**              GOTO P1T40                                     S01117
0865 C   06                GOTO P1T50                                     S01117
     C**
     C                     Z-ADD0         ACRAN
0866 C**
0867 C*****                MOVE ATYP      ATYPA                           S01194
0867 C******               MOVE A5ACCD    ATYPA                     S01194LN0109
0867 C                     MOVE A5ACTY    ATYPA                           LN0109
     C*****                MOVE BRCD      BRCDA                           S01117
0868 C**
0869 C**      IF THE A/C IS RETAIL,IT MUST BE OPEN.
0870 C**
0871 C*****      ATYP      COMP 'R'                      29               S01194
0871 C******     A5ACCD    COMP 'R'                      29        S01194 LN0109
0871 C           A5ACTY    COMP 'R'                      29               LN0109
0876 C**
0877 C**      CHECK BRANCH CODE
0878 C**
0873 C***29*               GOTO P1T50                                     S01117
0874 C*****                                                               S01117
0875 C*****      P1T40     TAG                             ** P1T40 TAG **S01117
0876 C*****                                                               S01117
0877 C*****   CHECK BRANCH CODE                                           S01117
0878 C*****                                                               S01117
0879 C*****      BRCD      COMP BRCDA                2929                 S01117
0880 C*****                                                               S01117
0880 C**
0881 C           P1T50     TAG                             ** P1T50 TAG **
0882 C**
0883 C**      SET UP A/C RETAIL INDICATOR
0884 C**
0885 C           ATYPA     COMP 'R'                      40
0886 C                     MOVE '0'       RINDA   1
0887 C      40             MOVE '1'       RINDA
0886 C**********           MOVE '     '   TRAT    5                                  E43407 AR813358
     C                     MOVE '00000'   TRAT                                              AR813358
0887 C      40             MOVE '92000'   TRAT                            E43407
     C                     MOVE A5ACSC    ACSCA   2                       S10736
      *                                                                                       232543
     C           TRAT      IFEQ '92000'                                                       CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CRE098    OREQ 'Y'                                                           CRE098
      *                                                                                       CER030
     C                     CALL 'AONARRR0'                                                    CER030
     C                     PARM '*MSG   ' PRTCD                                               CER030
     C                     PARM '*KEY   ' POPTN                                               CER030
     C                     PARM NCDN      PCBNB   2                                           CER030
     C           SDNARR    PARM SDNARR    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE *BLANKS                                                       CER030
     C                     MOVEL'SDNARRPD'DBFILE                                              CER030
     C                     MOVELPOPTN     DBOPTN                                              CER030
     C                     MOVELNCDN      DBKEY                                               CER030
     C                     MOVEL'105'     DBASE                                               CER030
     C                     MOVE *ON       *INU7                                               CER030
     C                     MOVE *ON       *INU8                                               CER030
     C                     MOVE *ON       *INLR                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           ALRTTY    IFNE *BLANKS                                                       CER030
     C                     MOVE ALRTTY    TRAT                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CGL031    IFEQ 'Y'                                                           233546
     C           WKSTAT    IFEQ 'UT'                                                          232543
     C           WKSTAT    OREQ 'UD'                                                          232543
     C           WKSTAT    OREQ 'UF'                                                          232543
     C           WKSTAT    OREQ 'UG'                                                          232543
     C           WKSTAT    OREQ 'US'                                                          232543
     C                     MOVE TXTXTT    TRAT                                                232543
     C                     ENDIF                                                              232543
     C                     ENDIF                                                              233546
0888 C**
0889 C           P1END     ENDSR                           ** P1END **
0890 C**
0891 C********************************************************************
0892 C/SPACE 3
0893 C********************************************************************
0894 C*    SR. TO CARRY OUT ADDITIONAL PROCESSING FOR POSTING
0895 C*    REFERENCE 2
0896 C           PREF2     BEGSR                           *** PREF2 ***
0897 C*
0898 C*    CHECK SETTLEMENT TYPE.
     C                     SETOF                     70
0899 C                     SETOF                     131415
0900 C                     SETOF                     161728
      *                                                                   CDL002
      ** If NET POSTING force to NET POSTING account                      CDL002
     C                     MOVE *BLANKS   NTOSBR                          149507
     C           CDL002    IFEQ 'Y'                                       CDL002
     C           *IN07     ANDEQ'1'                                       CDL002
     C                     MOVE 'NT'      O#PNAR                          CDL002
     C           OSBR      IFEQ '   '                                     CDL002
     C                     MOVE BRCA      OSBR                            CDL002
     C                     END                                            CDL002
     C           SVBRCA    IFNE *BLANKS                                                     MD048346
     C                     MOVELSVBRCA    OSBR                                              MD048346
     C                     ELSE                                                             MD048346
     C** Chain on FXNETML3 to get the Settlement Branch of FX netting                       MD048346
     C           FXNETR    CHAINFXNETMD0             30                                     MD048346
     C           *IN30     IFNE '1'                                                         MD048346
     C           AMONOB    IFNE *BLANKS                                                     MD048346
     C                     MOVELAMONOB    OSBR                                              MD048346
     C                     ELSE                                                             MD048346
     C** If there are no settlement details, use the customer branch                        MD048346
     C                     MOVELAMCNUM    @KEY1  10                                         MD048346
     C* Retrieve Customer Branch Code                                                       MD048346
     C                     CALL 'AOCUSTR1'                                                  MD048346
     C                     PARM '*MSG   ' @RTCD   7                                         MD048346
     C                     PARM '*KEY   ' @OPTN   7                                         MD048346
     C                     PARM           @KEY1  10                                         MD048346
     C                     PARM *BLANKS   @KYST   7                                         MD048346
     C           SDCUST    PARM SDCUST    DSLDY                                             MD048346
     C* DB in Error                                                                         MD048346
     C           @RTCD     IFNE *BLANK                                                      MD048346
     C                     MOVE '1'       *IN30                                             MD048346
     C                     MOVE '009'     DBASE            **********                       MD048346
     C                     MOVEL@OPTN     DBOPTN  7        *  009   *                       MD048346
     C                     MOVEL@KEY1     DBKEY            **********                       MD048346
     C                     MOVEL'SDCUSTPD'DBFILE                                            MD048346
     C                     GOTO P2END                                                       MD048346
     C                     ENDIF                                                            MD048346
     C*                                                                                     MD048346
     C           BBBRCD    IFNE *BLANKS                                                     MD048346
     C                     MOVELBBBRCD    OSBR                                              MD048346
     C                     ENDIF                                                            MD048346
     C                     ENDIF                                                            MD048346
     C                     ENDIF                                                            MD048346
     C                     ENDIF                                                            MD048346
     C                     MOVE OSBR      ACBRCD                          CDL002
     C           *LIKE     DEFN OSBR      NTOSBR                          CDL002
     C                     MOVE OSBR      NTOSBR                          CDL002
     C                     EXSR EXTRA                                     CDL002
     C                     MOVE OBICN     ACCNM                           CDL002
     C                     MOVE ECCY      ACCCY                           CDL002
     C                     MOVE BNNEAC    ACACD                           CDL002
     C                     MOVE '01'      ACACS                           CDL002
     C                     GOTO SUSP                                      CDL002
     C                     END                                            CDL002
     C*                                                                   S01117
     C*     SET UP BRANCH CODE FOR ACCNT KEY                              S01117
     C*                                                                   S01117
      * Save the settlement branch for comparison with settlement         126428
      * account branch, settlement method 14                              126428
     C                     MOVELOSBR      #OSBR   3                       126428
     C*                                                                   126428
     C           OSBR      IFNE '   '                                     S01117
     C                     MOVE OSBR      ACBRCD                          S01117
     C                     ELSE                                           S01117
     C*****                MOVE BRCD      ACBRCD                          S01117
     C                     MOVE BRCA      ACBRCD                          S01117
     C*****                MOVE BRCD      OSBR                            S01117
     C                     MOVE BRCA      OSBR                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*** Skip Settlement Processing For Internal Funding Deals           S01354
     C*                                                                   S01354
     C           DTYP      IFEQ 'ID'                                      S01354
     C           DTYP      OREQ 'IL'                                      S01354
     C*                                                                   S01354
     C** For Internal Loans, Multi-branched system, and Settlement        S01354
     C** Branch not Booking branch, flag Inter-branch Entries Required    S01354
     C*                                                                   S01354
     C***********DTYP      IFEQ 'IL'                               S01354 E38199
     C************IN77     ANDEQ'1'                                S01354 E38199
     C           *IN77     IFEQ '1'                                       E38199
     C           BRCA      ANDNEOSBR                                      S01354
     C                     MOVE '1'       *IN70                           S01354
     C                     END                                            S01354
     C*                                                                   S01354
     C                     MOVE '1'       *IN11                           S01354
     C                     MOVE *BLANK    ATYPA                           S01354
     C                     Z-ADD*ZERO     ACRAN                           S01354
     C                     GOTO EVNAM                                     S01354
     C                     END                                            S01354
     C*                                                                   S01354
     C           *IN60     CABEQ'1'       CASE4          17               080603
0901 C           SETP      COMP 01                       13
0902 C  N13      SETP      COMP 02                       13
0903 C  N13      SETP      COMP 07                       13
0904 C  N13      SETP      COMP 08                       13
0905 C  N13      SETP      COMP 12                       13
0906 C   13                GOTO CASE1
0907 C           SETP      COMP 03                       14
0908 C   14                GOTO CASE4
0909 C           SETP      COMP 04                       15
0910 C   15                GOTO CASE2
0911 C           SETP      COMP 05                       16
0912 C   16                GOTO CASE3
0913 C           SETP      COMP 06                       17
0914 C  N17      SETP      COMP 00                       17
0915 C   17                GOTO CASE4
0916 C           SETP      COMP 14                       28
0917 C   28                GOTO CASE5
0918 C*
0919 C*    INVALID SETTLEMENT TYPE.
     C                     Z-ADD14        DBASE            * DB ERROR 14  SO5452
     C                     MOVEL'SETP ='  DBKEY                           SO5452
     C                     MOVE SETP      DBKEY                           SO5452
     C                     MOVEL'SDKEY'   DBFILE                          SO5452
0920 C                     GOTO P2ERR
0921 C*
0922 C*    CASE1. ACCESS NOSTRO TABLE FOR POSTING DETAILS.
0923 C*    IF SETTLEMENT DETAILS BLANK GENERATE ENTRY TO
0924 C*    SUSPENSE A/C.
0925 C           CASE1     TAG                             ** CASE1 TAG **
0926 C           OSAC      COMP ' '                      33
0927 C   33                SETON                     29
0928 C   33                GOTO EVNAM
     C                     MOVE OSAC      WSACC                                               246505
     C           WSAC1     IFNE *BLANKS                                                       246505
     C                     MOVE WSAC1     NOSC                                                246505
     C                     ELSE                                                               246505
     C                     MOVE WSAC2     NOSC                                                246505
     C                     ENDIF                                                              246505
0929 C*
0930 C*****ACCESS NOSTRO TABLE.                                           S01194
0931 C*****                MOVEL'70'      TABKEY                          S01194
0932 C*****                MOVELECCY      WK5     5                       S01194
0933 C*****                MOVE NOSC      WK5                             S01194
0934 C*****                MOVE WK5       TABKEY                          S01194
0935 C*****                EXSR TABCHN                                    S01194
0936 C**N08                SETON                     3329                 S01194
0937 C**N08                GOTO P2END                                     S01194
     C*                                                                   S01460
     C***********TAXAC     IFEQ '1'                                S01460 080603
     C***********          MOVELBJCYCD    @KEYB                    S01460 080603
     C***********          ELSE                                    S01460 080603
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      @KEYB                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVELECCY      @KEYB                           S01460
     C                     ENDIF                                          CEU003
     C***********          END                                     S01460 080603
     C/COPY WNCPYSRC,DL0295C065
     C*                                                                   S01460
     C**   ACCESS NOSTRO FILE.
     C*
     C** READ NOSTRO DETAILS VIA ACCESS PROGRAM                           S01194
     C***********          CALL 'AONOSTRO'                          S01194BHF043
     C                     CALL 'AONOSTR0'                                BHF043
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM *BLANK    @KEYA   6                       S01194
     C***********          PARM ECCY      @KEYB   3                S01194 S01460
     C                     PARM           @KEYB   3                       S01460
     C**********           PARM *BLANK    @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANK    @KEYC  10                                           CGL029
     C                     PARM *BLANK    @KEYD   2                       S01194
     C                     PARM NOSC      @KEYE   2                       S01194
     C                     PARM           @BRCD   3        I:Branch Code  BHF043
     C                     PARM           @CSSN  10        I:Cust ShortN  BHF043
     C                     PARM           @PNOI   1        I:Prime Nost InBHF043
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     3329                 S01194
     C                     GOTO P2END                                     S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,DL0295C066
     C*
0938 C*
0939 C*    SET UP KEY FOR A/C MASTER FILE.
0940 C*****                MOVE NSCNM     ACCNM                           S01194
0940 C                     MOVE A7CUST    ACCNM                           S01194
     C*                                                                   S01460
     C***********TAXAC     IFEQ '1'                                S01460 080603
     C***********          MOVE BJCYCD    ACCCY                    S01460 080603
     C***********          ELSE                                    S01460 080603
0941 C***********          MOVE ECCY      ACCCY                           S01460
     C                     MOVE A7CYCD    ACCCY                           S01460
     C***********          ENDIF                                   S01460 080603
     C*                                                                   S01460
0942 C*****                MOVE NSACD     ACACD                           S01194
0943 C*****                MOVE NSACS     ACACS                           S01194
0942 C                     MOVE A7ACCD    ACACD                           S01194
0943 C                     MOVE A7ACSN    ACACS                           S01194
     C                     MOVE A7BRCD    BRCDA                                               222171
     C                     MOVE A7BRCD    OSBR                                                222171
     C                     MOVE A7BRCD    NTOSBR                                            MD048346
     C                     MOVE A7BRCD    ACBRCD                                              222171
0944 C*
0952 C*
0953 C                     GOTO SUSP
0954 C*
0955 C*    CASE2. SET UP KEY FOR A/C MASTER FILE.
0956 C           CASE2     TAG                             ** CASE2 TAG **
0957 C*
0958 C*
0959 C*    IF THE NEW YORK STATE PROCESSING INDICATOR = Y
0960 C*    THEN SET THE VALUE DATE TO THE FEDERAL FUND VALUE
0961 C*    DATE
0962 C*****      FFNY      COMP 'Y'                      89               S01194
0962 C           BLFFIN    COMP 'Y'                      89               S01194
0963 C                     MOVE CNUM      ACCNM
     C*                                                                   S01460
     C***********TAXAC     IFEQ '1'                                S01460 080603
     C***********          MOVE BJCYCD    ACCCY                    S01460 080603
     C***********          ELSE                                    S01460 080603
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANK                                    CEU003
     C                     MOVE STCY      ACCCY                           CEU003
     C                     ELSE                                           CEU003
0964 C                     MOVE ECCY      ACCCY
     C                     ENDIF                                          CEU003
     C***********          ENDIF                                   S01460 080603
     C*                                                                   S01460
0965 C*****                MOVE CADC      ACACD                           S01194
0965 C                     MOVE BMACCD    ACACD                           S01194
0966 C                     MOVE '01'      ACACS
     C***77**              MOVE SACS      ACACS                           S01117
0967 C                     GOTO SUSP
0968 C*
0969 C*    CASE3. SET UP KEY FOR A/C MASTER FILE.
0970 C           CASE3     TAG                             ** CASE3 TAG **
0971 C                     MOVE SDCNM     ACCNM
     C*                                                                   S01460
     C***********TAXAC     IFEQ '1'                                S01460 080603
     C***********          MOVE BJCYCD    ACCCY                    S01460 080603
     C***********          ELSE                                    S01460 080603
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      ACCCY                           CEU003
     C                     ELSE                                           CEU003
0972 C                     MOVE ECCY      ACCCY
     C                     ENDIF                                          CEU003
     C***********          ENDIF                                   S01460 080603
     C*                                                                   S01460
0973 C                     MOVE SDACD     ACACD
0974 C                     MOVE SDACS     ACACS
0975 C                     GOTO SUSP
0976 C*
0977 C*    CASE4. SET UP KEY FOR A/C MASTER FILE.
0978 C           CASE4     TAG                             ** CASE4 TAG **
0979 C*****                MOVE BICN      ACCNM                           S01117
0979 C                     MOVE BBICN     ACCNM                           S01117
     C                     MOVE BRCA      ACBRCD                          080603
     C                     MOVE BRCA      OSBR                            080603
     C*                                                                   S01460
     C***********TAXAC     IFEQ '1'                                S01460 080603
     C***********          MOVE BJCYCD    ACCCY                    S01460 080603
     C           *IN60     IFEQ '1'                                       080603
     C                     MOVE BJLCCY    ACCCY                           080603
     C                     ELSE                                           S01460
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      ACCCY                           CEU003
     C                     ELSE                                           CEU003
     C/COPY WNCPYSRC,DL0295C049
0980 C                     MOVE ECCY      ACCCY
     C                     ENDIF                                          CEU003
     C/COPY WNCPYSRC,DL0295C050
     C                     ENDIF                                          S01460
     C*                                                                   S01460
0981 C***14                MOVE CSAC      ACACD                           S01460
0981 C   14                MOVE BLACCD    ACACD                           S01460
0982 C***17                MOVE COMS      ACACD                           S01460
0982 C   17                MOVE BKACCD    ACACD                           S01460
0983 C                     MOVE '01'      ACACS
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP18                                           S01408
      *                                                                   S01408
0984 C                     GOTO SUSP
0985 C*
0986 C*    CASE5. ACCESS RETAIL ACCOUNT FILE.
0987 C           CASE5     TAG                             ** CASE5 TAG **
0988 C*
0989 C*
0990 C*    IF THE NEW YORK STATE PROCESSING INDICATOR = Y
0991 C*    THEN SET THE VALUE DATE TO THE FEDERAL FUND VALUE
0992 C*    DATE
0993 C*****      FFNY      COMP 'Y'                      89               S01194
0993 C           BLFFIN    COMP 'Y'                      89               S01194
0994 C                     SETOF                     0533
0995 C           SDRAN     CHAINACNUM                30
      *
      * If the retail account was found but with a currency different     138465
      * from the account key currency, post to suspens acount.            138465
     C           *IN05     IFEQ '1'                                       138465
     C           CCY       ANDNEECCY                                      138465
     C           STCY      ANDEQ*BLANKS                                   138465
     C                     MOVE ECCY      CCY                             138465
     C                     SETOF                     05                   138465
     C                     END                                            138465
      *
0996 C  N05                SETON                     2933
0997 C   05                MOVE RACNM     ACCNM
0998 C   05                MOVE CCY       ACCCY
0999 C   05                MOVE RAACD     ACACD
1000 C   05                MOVE RAACS     ACACS
      *                                                                   126428
      * If the retail account was found then set the settlement           126428
      * branch to be the branch the account is in if this differs         126428
      * from both the booking branch of the deal and the settlement       126428
      * branch on the account key                                         126428
     C           *IN05     IFEQ '1'                                       126428
     C********** RABRCD    IFNE BRCA                                                 126428 MD023685
     C********** RABRCD    ANDNE#OSBR                                                126428 MD023685
     C                     MOVELRABRCD    OSBR                            126428
     C                     MOVELRABRCD    ACBRCD                          126428
     C**********           END                                                       126428 MD023685
     C                     END                                            126428
1002 C*
1003 C*    CHECK THAT SPECIFIED A/C EXISTSON A/C MASTER FILE.
1004 C*    & THAT A/C IS FOR SAME BRANCH.
1005 C           SUSP      TAG                             ** SUSP TAG **
     C*
 945 C*    ACCESS A/C CODE
     C                     Z-ADDY         X                               S01094
     C           NACACD    LOKUPACD,X                    40               S01094
     C           *IN40     IFEQ '1'                                       S01094
     C*****                MOVELATY,X     ATYP                     S01094 S01194
     C*****                MOVELATY,X     A5ACCD                   S01194 LN0109
     C                     MOVELATY,X     A5ACTY                          LN0109
     C                     MOVE ACS,X     A5ACSC                          S10736
     C                     ELSE                                           S01094
0946 C*****                MOVEL'30      'TABKEY                          S01194
0947 C*****                MOVELACACD     WRK5    5                       S01194
0948 C*****                MOVE '1'       WRK5                            S01194
0949 C*****                MOVE WRK5      TABKEY                          S01194
0950 C*****                EXSR TABCHN                                    S01194
     C*
     C**N07                SETON                     29                   S01194
     C**N07                GOTO EVNAM                                     S01194
     C** READ ACCOUNT DETAILS VIA ACCESS PROGRAM                          S01194
     C                     MOVELACACD     @AFNB                           S01194
     C                     CALL 'AOACODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C**********           PARM           @AFNB   4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM           @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *IN29                           S01194
     C                     GOTO EVNAM                                     S01194
     C                     END                                            S01194
     C           Y         IFGT 1                                         S01094
     C                     SUB  1         Y                               S01094
     C                     Z-ADDNACACD    ACD,Y                           S01094
     C*****                MOVELATYP      ATY,Y                    S01094 S01194
     C*****                MOVELA5ACCD    ATY,Y                    S01194 LN0109
     C                     MOVELA5ACTY    ATY,Y                           LN0109
     C                     MOVELA5ACSC    ACS,Y                           S10736
     C                     END                                            S01094
     C                     END                                            S01094
     C*
     C*
1006 C                     EXSR ACMCHN
     C*  ACCOUNT NOT FOUND
     C  N06                DO
     C*****                MOVE ATYP      ATYPA                           S01194
     C*****                MOVE A5ACCD    ATYPA                    S01194 LN0109
     C                     MOVE A5ACTY    ATYPA                           LN0109
     C*****                MOVE BRCD      BRCDA                           S01117
1007 C**
     C*  ACCOUNT NOT FOUND AND ACCOUNT CODE RETAIL THEN SUSPENSE POSTING
     C     N29   ATYPA     COMP 'R'                      29
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP16                                           S01408
     C*                                                                   S01408
1008 C  N06 15
1009 CORN06 16
1010 CORN06 28             SETON                     29
     C/COPY WNCPYSRC,DL0295C001
     C*
1011 C***06N77N29BRCD      COMP BRCDA                2929                 S01117
     C*****                                                               S01117
     C**N29                DO                                             S01117
     C***77                                                               S01117
     C*N*06N14N17BRCD      COMP BRCDA                7070                 S01117
     C***06 77 14                                                         S01117
     C*R*06 77 17BRCD      COMP BRCDA                2929                 S01117
     C*****                END                                            S01117
     C*                                                                   S01117
     C*       SET INTERBRANCH SETTLEMENT INDICATOR                        S01117
     C*                                                                   S01117
     C                     SETOF                     70                   S01117
      *                                                                                       239550
      ** Even if posting to suspense, post to the settlement branch                           239550
      *                                                                                       239550
     C**N29*77** BRCA      COMP OSBR                 7070                              S01117 239550
     C   77      BRCA      COMP OSBR                 7070                                     239550
     C*
1012 C  N29      ATYPA     COMP 'R'                      40
1013 C  N29 40             MOVE '1'       RINDA   1
1014 C  N29N40             MOVE '0'       RINDA
1013 C  N29 40             MOVE '92000'   TRAT    5                       E43407
1014 C**N29N40**           MOVE '     '   TRAT                                       E43407 AR813358
     C  N29N40             MOVE '00000'   TRAT                                              AR813358
      *                                                                                       232543
     C           TRAT      IFEQ '92000'                                                       CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CRE098    OREQ 'Y'                                                           CRE098
      *                                                                                       CER030
     C                     CALL 'AONARRR0'                                                    CER030
     C                     PARM '*MSG   ' PRTCD                                               CER030
     C                     PARM '*KEY   ' POPTN                                               CER030
     C                     PARM NCDN      PCBNB                                               CER030
     C           SDNARR    PARM SDNARR    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE *BLANKS                                                       CER030
     C                     MOVEL'SDNARRPD'DBFILE                                              CER030
     C                     MOVELPOPTN     DBOPTN                                              CER030
     C                     MOVELNCDN      DBKEY                                               CER030
     C                     MOVEL'108'     DBASE                                               CER030
     C                     DUMP                                                             BUG25189
     C                     MOVE *ON       *INU7                                               CER030
     C                     MOVE *ON       *INU8                                               CER030
     C                     MOVE *ON       *INLR                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           ALRTTY    IFNE *BLANKS                                                       CER030
     C                     MOVE ALRTTY    TRAT                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CGL031    IFEQ 'Y'                                                           233546
     C           WKSTAT    IFEQ 'UT'                                                          232543
     C           WKSTAT    OREQ 'UD'                                                          232543
     C           WKSTAT    OREQ 'UF'                                                          232543
     C           WKSTAT    OREQ 'UG'                                                          232543
     C           WKSTAT    OREQ 'US'                                                          232543
     C                     MOVE TXTXTT    TRAT                                                232543
     C                     ENDIF                                                              232543
     C                     ENDIF                                                              233546
1015 C*
1016 C*    GET EVENT NAME.
1017 C           EVNAM     TAG                             ** EVNAM **
     C           *IN60     IFEQ '1'                                       080603
     C/COPY WNCPYSRC,DL0295C111
     C                     Z-ADDLEAMT     PSTA                            080603
     C/COPY WNCPYSRC,DL0295C112
     C                     ELSE                                           080603
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C*                                                                   CEU003
     C* CONVERT TRANSACTION AMOUNT TO SETTLEMENT CURRENCY                 CEU003
     C*                                                                   CEU003
     C                     CALL 'EU0200'                                  CEU003
     C                     PARM *BLANKS   P@RTCD  7        RETURN CODE    CEU003
     C                     PARM EAMT      P@FRAM 183       TRANS AMT      CEU003
     C                     PARM ECCY      P@FRCY  3        TRANS CCY      CEU003
     C                     PARM STCY      P@TOCY  3        SETTL CCY      CEU003
     C                     PARM           P@OUTA 150       SETTL AMT      CEU003
     C                     PARM           P@INTA 183       INT SET AMT    CEU003
     C                     PARM           P@EXRT 159       EXCH RATE      CEU003
     C                     PARM           P@MDIN  1        M/D IND        CEU003
     C*                                                                   CEU003
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU003
     C                     Z-ADD20        DBASE            **********     CEU003
     C                     MOVE *BLANKS   DBOPTN           *  20    *     CEU003
     C                     MOVELECCY      DBKEY            **********     CEU003
     C                     MOVEL'EU0200'  DBFILE                          CEU003
     C                     GOTO ERROR                                     CEU003
     C                     ELSE                                           CEU003
     C                     Z-ADDP@OUTA    PSTA                            CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C/COPY WNCPYSRC,DL0295C051
     C                     Z-ADDEAMT      PSTA                            080603
     C                     ENDIF                                          CEU003
     C/COPY WNCPYSRC,DL0295C052
     C                     ENDIF                                          080603
     C                     MOVE A5ACSC    ACSCA                           080603
     C           ATYPA     COMP 'R'                      38
     C   29                Z-ADD0         ACRAN
1018 C                     MOVE '   '     EVENT   3
1019 C           EVCOD     LOKUPTABECD    TABEVE         30
1020 C   30                MOVE TABEVE    EVENT
1021 C                     GOTO P2END
1022 C*
1023 C*    SET ERROR INDICATOR
1024 C           P2ERR     TAG                             ** P2ERR TAG **
1025 C                     SETON                     37
1026 C*
1027 C           P2END     ENDSR                           ** P2END TAG **
1028 C*
1029 C********************************************************************
1030 C/SPACE 3
1031 C********************************************************************
1032 C*
1033 C**   SR. TO CARRY OUT ADDITIONAL PROCESSING FOR POSTING
1034 C**   REFERENCE 3
1035 C**
1036 C           PREF3     BEGSR                           *** PREF3 ***
1037 C**
1038 C**   SET UP KEY FOR A/C MASTER FILE.
1039 C**
1040 C                     MOVE CNUM      ACCNM
     C*                                                                   S01460
     C***********TAXAC     IFEQ '1'                                S01460 080603
     C***********          MOVE BJCYCD    ACCCY                    S01460 080603
     C           *IN60     IFEQ '1'                                       080603
     C/COPY WNCPYSRC,DL0295C113
     C                     MOVE BJLCCY    ACCCY                           080603
     C                     Z-ADDLEAMT     PSTA                            080603
     C/COPY WNCPYSRC,DL0295C114
     C                     ELSE                                           S01460
     C/COPY WNCPYSRC,DL0295C053
      *                                                                   175219
      ** Convert event amount to Rolled-Over-To-Currency Equivalent       175219
      ** if this is a rollover from 'In' currency to Euros                175219
      *                                                                   175219
     C           CEU015    IFEQ 'Y'                                       175219
     C           RTFC      ANDNE*BLANKS                                   175219
     C                     CALL 'EU0200'                                  175219
     C                     PARM *BLANKS   P@RTCD  7        RETURN CODE    175219
     C                     PARM EAMT      P@FRAM 183       TRANS AMT      175219
     C                     PARM ECCY      P@FRCY  3        TRANS CCY      175219
     C                     PARM RTFC      P@TOCY  3        SETTL CCY      175219
     C                     PARM           P@OUTA 150       SETTL AMT      175219
     C                     PARM           P@INTA 183       INT SET AMT    175219
     C                     PARM           P@EXRT 159       EXCH RATE      175219
     C                     PARM           P@MDIN  1        M/D IND        175219
      *                                                                   175219
     C           P@RTCD    IFEQ '*ERROR*'                                 175219
     C                     Z-ADD34        DBASE            **********     175219
     C                     MOVE *BLANKS   DBOPTN           *  34    *     175219
     C                     MOVELECCY      DBKEY            **********     175219
     C                     MOVEL'EU0200'  DBFILE                          175219
     C                     GOTO ERROR                                     175219
     C                     ELSE                                           175219
     C                     Z-ADDP@OUTA    PSTA                            175219
     C                     MOVELRTFC      ACCCY                           175219
     C                     ENDIF                                          175219
     C                     ELSE                                           175219
1041 C                     MOVE ECCY      ACCCY
     C                     Z-ADDEAMT      PSTA                            080603
     C                     ENDIF                                          175219
     C/COPY WNCPYSRC,DL0295C054
     C                     ENDIF                                          S01460
     C*                                                                   S01460
1042 C                     MOVE ACOD,N    ACACD
     C/COPY WNCPYSRC,DL0295C088
1043 C                     MOVE ACSQD     ACACS
     C/COPY WNCPYSRC,DL0295C089
1043 C                     MOVE BRCA      ACBRCD                          S01117
1044 C**
1045 C**   CHAIN TO ACCOUNTS MASTER
1046 C**
1047 C                     EXSR ACMCHN
1048 C**
1049 C**      IF A/C NOT FOUND CANNOT CHECK BRANCH CODE ETC.
1050 C**
1051 C***06**              GOTO P3T40                                     S01117
1051 C   06                GOTO P3T50                                     S01117
     C**
     C                     Z-ADD0         ACRAN
     C**
1052 C**
1053 C*****                MOVE ATYP      ATYPA                           S01194
1053 C*****                MOVE A5ACCD    ATYPA                    S01194 LN0109
1053 C                     MOVE A5ACTY    ATYPA                           LN0109
     C*****                MOVE BRCD      BRCDA                           S01117
1054 C**
1055 C**      IF THE A/C IS RETAIL,IT MUST BE OPEN.
1056 C**
1057 C*****      ATYP      COMP 'R'                      29               S01194
1057 C*****      A5ACCD    COMP 'R'                      29        S01194 LN0109
1057 C           A5ACTY    COMP 'R'                      29               LN0109
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP15                                           S01408
     C*                                                                   S01408
1058 C*****                                                               S01117
1059 C***29*               GOTO P3T50                                     S01117
1060 C*****                                                               S01117
1061 C*****      P3T40     TAG                             ** P3T40 TAG **S01117
1062 C*****                                                               S01117
1063 C*****   CHECK BRANCH CODE                                           S01117
1064 C*****                                                               S01117
1065 C*****      BRCD      COMP BRCDA                2929                 S01117
1066 C*****                                                               S01117
1067 C           P3T50     TAG                             ** P3T50 TAG **
1068 C**
1069 C**      SET UP A/C RETAIL INDICATOR
1070 C**
1071 C           ATYPA     COMP 'R'                      40
1072 C                     MOVE '0'       RINDA   1
1073 C      40             MOVE '1'       RINDA
1072 C**********           MOVE '     '   TRAT    5                                  E43407 AR813358
     C                     MOVE '00000'   TRAT                                              AR813358
1073 C      40             MOVE '92000'   TRAT                            E43407
1053 C                     MOVE A5ACSC    ACSCA                           S10736
      *                                                                                       232543
     C           TRAT      IFEQ '92000'                                                       CER030
      *                                                                                       CER030
     C           CGL013    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                           CER030
     C           CRE098    OREQ 'Y'                                                           CRE098
      *                                                                                       CER030
     C                     CALL 'AONARRR0'                                                    CER030
     C                     PARM '*MSG   ' PRTCD                                               CER030
     C                     PARM '*KEY   ' POPTN                                               CER030
     C                     PARM NCDN      PCBNB                                               CER030
     C           SDNARR    PARM SDNARR    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE *BLANKS                                                       CER030
     C                     MOVEL'SDNARRPD'DBFILE                                              CER030
     C                     MOVELPOPTN     DBOPTN                                              CER030
     C                     MOVELNCDN      DBKEY                                               CER030
     C                     MOVEL'109'     DBASE                                               CER030
     C                     MOVE *ON       *INU7                                               CER030
     C                     MOVE *ON       *INU8                                               CER030
     C                     MOVE *ON       *INLR                                               CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           ALRTTY    IFNE *BLANKS                                                       CER030
     C                     MOVE ALRTTY    TRAT                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           CGL031    IFEQ 'Y'                                                           233546
     C           WKSTAT    IFEQ 'UT'                                                          232543
     C           WKSTAT    OREQ 'UD'                                                          232543
     C           WKSTAT    OREQ 'UF'                                                          232543
     C           WKSTAT    OREQ 'UG'                                                          232543
     C           WKSTAT    OREQ 'US'                                                          232543
     C                     MOVE TXTXTT    TRAT                                                232543
     C                     ENDIF                                                              232543
     C                     ENDIF                                                              233546
1074 C**
1075 C           P3END     ENDSR                           ** P3END **
1076 C**
1077 C********************************************************************
1078 C/SPACE 3
1079 C********************************************************************
1080 C*    SR. TO SET UP POSTING NARRATIVE.
1081 C           NARRA     BEGSR                           *** NARRA ***
1082 C*
     C/COPY WNCPYSRC,DL0295COH1                                           S01408
1083 C*    SET INDICATOR CORRESPONDING TO NARRATIVE CODE
     C                     MOVE NCD,N     NCDN    2
1085 C           NCDN      COMP '01'                     41
1086 C           NCDN      COMP '02'                     42
1087 C           NCDN      COMP '03'                     43
1088 C           NCDN      COMP '04'                     44
1089 C           NCDN      COMP '05'                     45
1090 C           NCDN      COMP '06'                     46
1091 C           NCDN      COMP '07'                     47
1092 C           NCDN      COMP '08'                     48
1093 C           NCDN      COMP '09'                     49
1094 C           NCDN      COMP '10'                     50
1095 C           NCDN      COMP '11'                     51
1096 C*          NCDN      COMP 12                       52
1097 C           NCDN      COMP '13'                     53
1098 C*          NCDN      COMP 14                       54
1099 C           NCDN      COMP '15'                     55
1100 C*          NCDN      COMP 16                       56
1101 C           NCDN      COMP '17'                     57
1102 C*          NCDN      COMP 18                       58
1103 C*          NCDN      COMP 19                       59
1104 C*          NCDN      COMP 20                       60
1105 C           NCDN      COMP '21'                     61
1106 C           NCDN      COMP '22'                     62
1107 C           NCDN      COMP '23'                     63
1108 C           NCDN      COMP '24'                     64
1109 C           NCDN      COMP '25'                     65
1110 C*          NCDN      COMP 26                       66
1111 C*          NCDN      COMP 27                       67
1112 C*          NCDN      COMP 28                       68
1113 C*          NCDN      COMP 29                       69
1114 C*          NCDN      COMP 30                       70
1115 C*          NCDN      COMP 31                       71
1116 C*          NCDN      COMP 32                       72
1117 C*          NCDN      COMP 33                       73
1118 C*          NCDN      COMP 34                       74
1119 C*          NCDN      COMP 35                       75
1120 C*          NCDN      COMP 36                       76
1121 C*          NCDN      COMP 37                       77
1122 C*          NCDN      COMP 38                       78
1123 C*          NCDN      COMP 39                       74
1124 C*          NCDN      COMP 40                       80
1125 C*          NCDN      COMP 41                       81
1126 C*          NCDN      COMP 42                       82
1127 C*          NCDN      COMP 43                       83
1128 C*          NCDN      COMP 44                       84
1129 C*          NCDN      COMP 45                       85
1130 C*          NCDN      COMP 46                       86
1131 C*          NCDN      COMP 47                       87
1132 C*          NCDN      COMP 48                       88
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0295CP19                                           S01408
     C*                                                                   S01408
     C*                                                                   S01434
     C           S01434    IFEQ 'Y'                                       S01434
     C** 1 - 50 Only Reserved for Non-Client Use                          080603
     C***********NCDN      IFEQ '51'                               S01434 080603
     C***********NCDN      OREQ '52'                               S01434 080603
     C***********          SETON                     67                   S01434
     C           NCDN      IFEQ '18'                                      080603
     C           NCDN      OREQ '19'                                      080603
     C                     MOVE *ON       *IN66                           080603
     C                     ELSE                                           080603
     C                     MOVE *OFF      *IN66                           080603
     C                     ENDIF                                          S01434
     C                     ENDIF                                          S01434
1133 C*
1134 C*    IF NARRATIVE CODE 01 OBTAIN REPORT NAME FROM
1135 C*    CLIENT FILE
     C           *IN41     IFEQ '1'                         B001          S01100
1136 C*****                MOVELCNUM      CLTKEY                   S01100 S01194
1137 C*****                EXSR CLTCHN                             S01100 S01194
     C*****      *IN11     CABEQ'1'       NAEND              Found S01100 S01194
     C*****                MOVEL'CLINT'   DBFILE    ***DBERR12**   S01100 S01194
     C****                 MOVEL'012'     DBASE               S01100      SO5452
     C*****                Z-ADD12        DBASE               SO5452      S01194
     C*****                MOVELCLTKEY    DBKEY                    S01100 S01194
1138 C*****                GOTO NAERR                              S01100 S01194
1139 C***41                GOTO NAEND                                     S01100
     C** READ CUSTOMER DETAILS VIA ACCESS PROGRAM                         S01194
     C                     MOVELCNUM      @KEY1  10                       S01194
     C******               CALL 'AOCUSTR0'                         S01194 220738
     C                     CALL 'AOCUSTR1'                                220738
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEY1  10                       S01194
     C*****                PARM '*NUMBER' @KYST   7                S01194 LN0109
     C                     PARM *BLANKS   @KYST   7                       LN0109
     C****       SDCUST    PARM SDCUST    DSSDY                    S01194 220738
     C           SDCUST    PARM SDCUST    DSLDY                           220738
     C           @RTCD     IFNE *BLANK                                    S01194
     C           BBCLST    ANDNE'Y'                                       220738
     C*****      @KYST     ORNE '*NUMBER'                          S01194 LN0109
     C           @KYST     ORNE '*CNUM'                                   LN0109
     C                     MOVE 'SDCUSTPD'DBFILE                          S01194
     C                     MOVE '012'     DBASE            **********     S01194
     C                     MOVEL@OPTN     DBOPTN  7        *  012   *     S01194
     C                     MOVEL@KEY1     DBKEY            **********     S01194
     C                     GOTO NAERR                                     S01194
     C                     END                                            S01194
     C                     GOTO NAEND                                     S01194
     C                     END                                     E001   S01100
     C/COPY WNCPYSRC,DL0295COH2                                           S01408
1140 C*
1141 C*    OBTAIN NARRATIVE
1142 C*****                MOVEL'90      'TABKEY
1143 C*****                MOVE '    '    TABKEY
1144 C*****                MOVE NCDN      TABKEY
1145 C*****                EXSR TABCHN
     C*****      *IN09     IFEQ '0'                         B001          S01100
     C*****                MOVELTABKEY    DBKEY            ***DBERR13**   S01100
     C****                 MOVEL'013'     DBASE               S01100      SO5452
     C*****                Z-ADD13        DBASE                           SO5452
1146 C*****                GOTO NAERR                                     S01100
     C*****                END                              E001          S01100
     C** READ NARRATIVE DETAILS VIA ACCESS PROGRAM                        S01194
     C                     CALL 'AONARRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM NCDN      @CBNB   2                       S01194
     C           SDNARR    PARM SDNARR    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE 'SDNARRPD'DBFILE                          S01194
     C                     MOVE '013'     DBASE            **********     S01194
     C                     MOVEL@OPTN     DBOPTN  7        *  013   *     S01194
     C                     MOVEL@CBNB     DBKEY            **********     S01194
     C                     GOTO NAERR                                     S01194
     C                     END                                            S01194
1147 C*
1148 C  N42N43             GOTO DATE
1149 C*
1150 C*    SET INDICATOR FOR NO. OF D.P. FOR OTHER CURRENCY.
1151 C**                   MOVE OTHC      XCCY                            S01094
1152 C**                   EXSR CCYDEP                                    S01094
     C                     Z-ADD1         X                               S01094
     C           OTHC      LOKUPCCYA,X                   40               S01094
     C*****                MOVELCCYDT,X   CCYDET                   S01094 S01194
1153 C*****      XDECP     COMP 1                      2425               S01194
1154 C*****      XDECP     COMP 2                    27  26               S01194
1153 C           DPA,X     COMP 1                      2425               S01194
1154 C           DPA,X     COMP 2                    27  26               S01194
1155 C                     GOTO NAEND
1156 C*
1157 C*    CONVERTDATE TO DDMMMYY  FORMAT.
1158 C           DATE      TAG                             ** DATE TAG **
1159 C  N44N45N46
1160 CANN47N48N50
1161 CANN51N53N55
1162 CANN61N62N63
1163 CANN64N65             GOTO NAEND
1164 C*
1165 C   44
1166 COR 61
1167 COR 62
1168 COR 65                Z-ADDMDAT      ZDAYNO
1169 C   45
1170 COR 46
1171 COR 47
1172 COR 48
1173 COR 50
1174 COR 51
1175 COR 63
1176 COR 64                Z-ADDEDAT      ZDAYNO
1177 C*
1178 C   53
1179 COR 55                Z-ADDVDAT      ZDAYNO
1180 C*
1181 C                     EXSR ZDATE2
1182 C                     MOVE ZADATE    DATE1   7
1183 C*
1184 C*    CONVERT SECOND DATE IF NECCESSARY.
1185 C  N47N64             GOTO NAEND
1186 C                     Z-ADDSLID      ZDAYNO
1187 C                     EXSR ZDATE2
1188 C                     MOVE ZADATE    DATE2   7
1189 C                     GOTO NAEND
1190 C*
1191 C*    SET ERROR INDICATOR
1192 C           NAERR     TAG                             ** NAERR TAG **
1193 C                     SETON                     37
1194 C*
1195 C           NAEND     ENDSR                           ** NAEND ENDSR
     C********************************************************************
     C*****                                                               S01117
     C*****      EXTRA     BEGSR                                          S01117
     C*****                MOVE IBAB      SIBAB   40                      S01117
     C*****                MOVE IBAH      SIBAH   40                      S01117
     C*****                MOVE BRCD      SBRCD   30                      S01117
     C*****                MOVE BICN      SBICN   60                      S01117
     C*****                MOVE SACS      SSACS   20                      S01117
     C*****                MOVEL'10      'SKEY12 12                       S01117
     C*****                MOVE BRCDA     SKEY12 12                       S01117
     C*****      SKEY12    CHAINTABLE                30                   S01117
     C*****                                                               S01117
     C*****                MOVE BICN      BICNA   60                      S01117
     C*****                MOVE SIBAB     IBAB                            S01117
     C*****                MOVE SIBAH     IBAH                            S01117
     C*****                MOVE SBRCD     BRCD                            S01117
     C*****                MOVE SBICN     BICN                            S01117
     C*****                MOVE SSACS     SACS                            S01117
     C*****                ENDSR                                          S01117
     C/EJECT                                                              S01117
     C*                                                                   S01117
0551 C*    ACCESS BRANCH CODE ARRAY FOR SETTLEMENT BRANCH TO OBTAIN       S01117
0552 C*    BRANCH INTERNAL CUSTOMER NUMBER                                S01117
     C*                                                                   S01117
     C           EXTRA     BEGSR                           *** EXTRA ***  S01117
     C                     SETOF                         10               S01117
     C                     Z-ADDSTIX      IX                              S01117
0556 C           OSBR      LOKUPBCC,IX                   10               S01117
0556 C   10                MOVE BCT,IX    OBCI                            S01117
     C                     ENDSR                                          S01117
     C/EJECT                                                              S01460
     C*****************************************************************   S01460
     C**                                                              *   S01460
     C**   P01       - THIS SUBROUTINE PERFORMS ADDITIONAL FIRST      *   S01460
     C**               CYCLE PROCESSING                               *   S01460
     C**                                                              *   S01460
     C**   CALLS     -                                                *   S01460
     C**                                                              *   S01460
     C**   CALLED BY -                                                *   S01460
     C**                                                              *   S01460
     C*****************************************************************   S01460
     C*                                                                   S01460
     C           P01       BEGSR                                          S01460
     C*                                                                   S01460
     C*                                                                   S01460
     C** READ ACCOUNT CODE DETAILS VIA ACCESS PROGRAM                     S01460
     C*                                                                   S01460
     C                     CALL 'AOACODR0'                                S01460
     C                     PARM '*MSG   ' @RTCD   7                       S01460
     C                     PARM '*KEY   ' @OPTN   7                       S01460
     C***********          PARM BKACCD    @AFNB   4                S01460 080603
     C**********           PARM BLSPTA    @AFNB   4                                    080603 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01460 CGL029
     C                     PARM BLSPTA    @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01460
     C                     Z-ADD18        DBASE            **********     S01460
     C                     MOVEL@OPTN     DBOPTN  7        *  018   *     S01460
     C                     MOVEL@AFNB     DBKEY            **********     S01460
     C                     MOVEL'SDACODPD'DBFILE                          S01460
     C                     GOTO ERROR                                     S01460
     C                     END                                            S01460
     C*                                                                   S01460
     C**   IF RECORD FOUND SAVE ATYP INTO ATYPT                           S01460
     C                     MOVE A5ACTY    ATYPT   1                       S01460
     C***********          MOVE A5ACSC    ACSCT   1                080603 CEU003
     C                     MOVE A5ACSC    ACSCT   2                       CEU003
     C*                                                                   S01460
     C**   IF ATYPT IS EQUAL TO 'R', MOVE 1 INTO RINDT                    S01460
     C           ATYPT     IFEQ 'R'                                       S01460
     C                     MOVE '1'       RINDT   1                       S01460
     C                     ELSE                                           S01460
     C*                                                                   S01460
     C**   IF ATYPT IS NOT EQUAL TO 'R', MOVE 0 INTO RINDT                S01460
     C                     MOVE '0'       RINDT                           S01460
     C                     END                                            S01460
     C*                                                                   S01460
     C**   RETRIEVE SPOT TRADE EQUIVALENT A/C CODE OF BASE CURRENCY       S01460
     C**   LOKUP ON THE ARRAY CCYA USING BJCYCD AND RETRIEVE CURRENCY     S01460
     C**   DETAILS                                                        S01460
     C                     Z-ADD1         X                               S01460
     C           BJCYCD    LOKUPCCYA,X                   59               S01460
     C*                                                                   S01460
     C**   MOVE XSPEQ INTO BSPEQ, MOVE XDECP INTO BDECP                   S01460
     C**********           MOVE XSPQ,X    BSPEQ   4                                    S01460 CGL029
     C                     MOVE XSPQ,X    BSPEQ  10                                           CGL029
     C                     Z-ADDDPA,X     BDECP   10                      S01460
     C/COPY WNCPYSRC,DL0295C094
     C*                                                                   S01460
     C** READ ACCOUNT CODE DETAILS VIA ACCESS PROGRAM                     S01460
     C*                                                                   S01460
     C           BSPEQ     IFNE '    '                                    080603
     C           BSPEQ     ANDNE'0000'                                    080603
     C                     CALL 'AOACODR0'                                S01460
     C                     PARM '*MSG   ' @RTCD   7                       S01460
     C                     PARM '*KEY   ' @OPTN   7                       S01460
     C***********          PARM BKACCD    @AFNB   4                S01460 080603
     C**********           PARM BSPEQ     @AFNB   4                                    080603 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01460 CGL029
     C                     PARM BSPEQ     @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01460
     C                     Z-ADD19        DBASE            **********     S01460
     C                     MOVEL@OPTN     DBOPTN  7        *  019   *     S01460
     C                     MOVEL@AFNB     DBKEY            **********     S01460
     C                     MOVEL'SDACODPD'DBFILE                          S01460
     C                     GOTO ERROR                                     S01460
     C                     END                                            S01460
     C*                                                                   S01460
     C**   IF RECORD FOUND SAVE A5ACTY INTO ATYPB                         S01460
     C                     MOVE A5ACTY    ATYPB   1                       S01460
     C***********          MOVE A5ACSC    ACSCB   1                080603 CEU003
     C                     MOVE A5ACSC    ACSCB   2                       CEU003
     C*                                                                   S01460
     C**   IF ATYPB IS EQUAL TO 'R', MOVE 1 INTO RINDT                    S01460
     C           ATYPB     IFEQ 'R'                                       S01460
     C                     MOVE '1'       RINDB   1                       S01460
     C                     ELSE                                           S01460
     C*                                                                   S01460
     C**   IF ATYPB IS NOT EQUAL TO 'R', MOVE 0 INTO RINDB                S01460
     C                     MOVE '0'       RINDB                           S01460
     C                     END                                            S01460
     C                     END                                            080603
     C*                                                                   S01460
     C**   Retrieve the SPOT Trade Equivalent A/c of Local Currency       080603
     C*                                                                   080603
     C           BJCYCD    IFNE BJLCCY                                    080603
     C*                                                                   080603
     C                     Z-ADD1         X                               080603
     C           BJLCCY    LOKUPCCYA,X                   59               080603
     C*                                                                   080603
     C** Save Local Currency Equivalent A/c code, Dec pls                 080603
     C*                                                                   080603
     C**********           MOVE XSPQ,X    LSPEQ   4                                    080603 CGL029
     C                     MOVE XSPQ,X    LSPEQ  10                                           CGL029
     C                     Z-ADDDPA,X     LDECP   10                      080603
     C                     Z-ADDXSPT,X    LSPOT  138                      080603
      *                                                                                       CGL165
      * Save Tax Conversion Rate                                                              CGL165
     C           CGL165    IFEQ 'Y'                                                           CGL165
     C                     Z-ADDTXCR,X    LTSPOT 138                                          CGL165
     C                     ENDIF                                                              CGL165
     C                     MOVE XMDN,X    LMDIN   1                       080603
     C/COPY WNCPYSRC,DL0295C095
     C*                                                                   080603
     C** Access Local Ccy A/c code details                                080603
     C*                                                                   080603
     C           LSPEQ     IFNE BSPEQ                                     080603
     C                     CALL 'AOACODR0'                                080603
     C                     PARM '*MSG   ' @RTCD   7                       080603
     C                     PARM '*KEY   ' @OPTN   7                       080603
     C**********           PARM LSPEQ     @AFNB   4                                    080603 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        080603 CGL029
     C                     PARM LSPEQ     @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    080603
     C                     Z-ADD19        DBASE            **********     080603
     C                     MOVEL@OPTN     DBOPTN  7        *  019   *     080603
     C                     MOVEL@AFNB     DBKEY            **********     080603
     C                     MOVEL'SDACODPD'DBFILE                          080603
     C                     GOTO ERROR                                     080603
     C                     END                                            080603
     C                     END                                            080603
     C*                                                                   080603
     C** Save Local Currency Equiv. A/c Type, Section, and Retail Ind.    080603
     C                     MOVE A5ACTY    ATYPL   1                       080603
     C***********          MOVE A5ACSC    ACSCL   1                080603 CEU003
     C                     MOVE A5ACSC    ACSCL   2                       CEU003
     C*                                                                   080603
     C           ATYPL     IFEQ 'R'                                       080603
     C                     MOVE '1'       RINDL   1                       080603
     C                     ELSE                                           080603
     C                     MOVE '0'       RINDL                           080603
     C                     END                                            080603
     C*                                                                   080603
     C                     ELSE                                           080603
     C                     MOVE BSPEQ     LSPEQ                           080603
     C                     MOVE BDECP     LDECP                           080603
     C/COPY WNCPYSRC,DL0295C096
     C                     MOVE ATYPB     ATYPL                           080603
     C                     MOVE ACSCB     ACSCL                           080603
     C                     MOVE RINDB     RINDL                           080603
     C                     END                                            080603
     C/COPY WNCPYSRC,DL0295C042
     C*                                                                   080603
     C** Access Interest Tax Narrative for Spot Trade & Equiv. A/cs       080603
     C*                                                                   080603
     C                     CALL 'AONARRR0'                                080603
     C                     PARM '*MSG   ' @RTCD   7                       080603
     C                     PARM '*KEY   ' @OPTN   7                       080603
     C                     PARM '29'      @CBNB   2                       080603
     C           SDNARR    PARM SDNARR    DSFDY                           080603
     C           @RTCD     IFNE *BLANK                                    080603
     C           '       ' CAT  'INTEREST'ITAXN  30                       080603
     C           ITAXN     CAT  'TAX':1   ITAXN                           080603
     C                     ELSE                                           080603
     C                     MOVELALDON     ITAXN                           080603
     C                     ENDIF                                          080603
     C/COPY WNCPYSRC,DL0295C043
     C*                                                                   080603
     C                     ENDSR                                          S01460
     C*****************************************************************   S01460
     C/EJECT                                                              S01460
     C*****************************************************************   S01460
     C**                                                              *   S01460
     C**   P02       - THIS SUBROUTINE PERFORMS ADDITIONAL PROCESSING *   S01460
     C**               FOR LEVEL BREAK L2                             *   S01460
     C**                                                              *   S01460
     C**   CALLS     -                                                *   S01460
     C**                                                              *   S01460
     C**   CALLED BY -                                                *   S01460
     C**                                                              *   S01460
     C*****************************************************************   S01460
     C           P02       BEGSR                                          S01460
     C*                                                                   080603
     C**   Retrieve the Event Currency Spot Trade Equivalent Account      080603
     C**   Code Details                                                   080603
     C*                                                                   080603
     C           ECCY      IFEQ BJCYCD                                    080603
     C                     MOVE BSPEQ     QSPEQ                           080603
     C                     MOVE BDECP     QDECP                           080603
     C/COPY WNCPYSRC,DL0295C097
     C                     MOVE ATYPB     ATYPQ                           080603
     C                     MOVE ACSCB     ACSCQ                           080603
     C                     MOVE RINDB     RINDQ                           080603
     C                     ELSE                                           080603
     C/COPY WNCPYSRC,DL0295C079
     C*                                                                   080603
     C           ECCY      IFNE BJLCCY                                    080603
     C/COPY WNCPYSRC,DL0295C080
     C                     Z-ADD1         X                               080603
     C           ECCY      LOKUPCCYA,X                   59               080603
     C**********           MOVE XSPQ,X    QSPEQ   4                                    080603 CGL029
     C                     MOVE XSPQ,X    QSPEQ  10                                           CGL029
     C                     Z-ADDDPA,X     QDECP   10                      080603
     C                     Z-ADDXSPT,X    QSPOT  138                      080603
      *                                                                                       CGL165
      * Save Tax Conversion Rate                                                              CGL165
     C           CGL165    IFEQ 'Y'                                                           CGL165
     C                     Z-ADDTXCR,X    QTSPOT 138                                          CGL165
     C                     ENDIF                                                              CGL165
     C                     MOVE XMDN,X    QMDIN   1                       080603
     C/COPY WNCPYSRC,DL0295C098
     C*                                                                   S01460
     C** READ ACCOUNT CODE DETAILS VIA ACCESS PROGRAM                     S01460
     C*                                                                   S01460
     C                     CALL 'AOACODR0'                                S01460
     C                     PARM '*MSG   ' @RTCD   7                       S01460
     C                     PARM '*KEY   ' @OPTN   7                       S01460
     C***********          PARM BKACCD    @AFNB   4                S01460 080603
     C**********           PARM QSPEQ     @AFNB   4                                    080603 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01460 CGL029
     C                     PARM QSPEQ     @AFNB                                               CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01460
     C                     Z-ADD30        DBASE            **********     S01460
     C                     MOVEL@OPTN     DBOPTN  7        *  030   *     S01460
     C                     MOVEL@AFNB     DBKEY            **********     S01460
     C                     MOVEL'SDACODPD'DBFILE                          S01460
     C                     GOTO ERROR                                     S01460
     C                     END                                            S01460
     C*                                                                   S01460
     C**   IF RECORD FOUND SAVE A5ACTY INTO ATYPQ                         S01460
     C                     MOVE A5ACTY    ATYPQ   1                       S01460
     C                     MOVE A5ACSC    ACSCQ   1                       080603
     C*                                                                   S01460
     C**   IF ATYPQ IS EQUAL TO 'R', MOVE 1 INTO RINDQ                    S01460
     C           ATYPQ     IFEQ 'R'                                       S01460
     C                     MOVE '1'       RINDQ   1                       S01460
     C                     ELSE                                           S01460
     C*                                                                   S01460
     C**   IF ATYPQ IS NOT EQUAL TO 'R', MOVE 0 INTO RINDQ                S01460
     C                     MOVE '0'       RINDQ                           S01460
     C                     END                                            S01460
     C/COPY WNCPYSRC,DL0295C081
     C                     END                                            080603
     C/COPY WNCPYSRC,DL0295C082
     C                     END                                            080603
     C*                                                                   S01460
     C                     ENDSR                                          S01460
     C*****************************************************************   S01460
     C*/EJECT****                                                  S01460 080603
     C*****************************************************************60 080603
     C***********                                                     *60 080603
     C*****P03***    - THIS SUBROUTINE CONVERTS EAMT IF TAX POSTINGS  *60 080603
     C***********      TO BE PRODUCED                                 *60 080603
     C***********                                                     *60 080603
     C*****CALLS*    -                                                *60 080603
     C***********                                                     *60 080603
     C*****CALLED BY -                                                *60 080603
     C***********                                                     *60 080603
     C*****************************************************************60 080603
     C***********P03       BEGSR                                   S01460 080603
     C***********                                                  S01460 080603
     C*****IDENTIFY A/C KEY FOR TAXES                              S01460 080603
     C*****IF*EVCOD IS 'I' OR 'M' AND EVSUB IS 'T'                 S01460 080603
     C********MOVE '1' INTO TAXAC                                  S01460 080603
     C*****ELSE**                                                  S01460 080603
     C********MOVE '0' INTO TAXAC                                  S01460 080603
     C***********EVSUB     IFEQ 'T'                                S01460 080603
     C***********EVCOD     ANDEQ'I'                                S01460 080603
     C***********EVSUB     OREQ 'T'                                S01460 080603
     C***********EVCOD     ANDEQ'M'                                S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE '1'       TAXAC   1                S01460 080603
     C***********          MOVE '1'       *IN60                    S01460 080603
     C***********                                                  S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE '0'       TAXAC                    S01460 080603
     C***********          MOVE '0'       *IN60                    S01460 080603
     C***********                                                  S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C*****IF*TAXAC IS 1                                           S01460 080603
     C***********TAXAC     IFEQ '1'                                S01460 080603
     C***********                                                  S01460 080603
     C***IF*ECCY*IS*EQUAL*TO*BJCYCD,*MOVE*'0'*INTO*TAXAC*--*(NO*SPECIAL60 080603
     C*****PROCESSING*IS*REQUIRED*AS*EAMT*AND*ECCY*DO*NOT*NEED*TO*BE01460 080603
     C*****CHANGED*AND*NO*ADDITIONAL*POSTINGS*NEED*TO*BE*CREATED)**S01460 080603
     C***********ECCY      IFEQ BJCYCD                             S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE '0'       TAXAC                    S01460 080603
     C***********          MOVE '0'       *IN60                    S01460 080603
     C***********                                                  S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          Z-ADD1         X                        S01460 080603
     C***********ECCY      LOKUPCCYA,X                   40        S01460 080603
     C***********                                                  S01460 080603
     C*****IF*TAXAC IS '1', CONVERT EAMT INTO BASE CURRENCY (BEAMT)S01460 080603
     C***********          MOVE ECCY      CICCY            CURRENCY IN460 080603
     C***********          MOVE BJCYCD    COCCY            CURRENCY OUT60 080603
     C***********          Z-ADDEAMT      CIAMT            AMOUNT  S01460 080603
     C***********          MOVE XSPT,X    CEXCH            EXCHANGES01460 080603
     C***********          MOVE XMDN,X    CMDI             MULT/DIVS01460 080603
     C***********          Z-ADDDPA,X     CIDEC            DECIMALSS01460 080603
     C***********          Z-ADDBDECP     CODEC            DECIMALSS01460 080603
     C***********                                                  S01460 080603
     C*****EXECUTE SUBROUTINE CONVER                               S01460 080603
     C***********          EXSR CONVER                             S01460 080603
     C***********                                                  S01460 080603
     C*****MOVE*AMOUNT OUT INTO BEAMT                              S01460 080603
     C***********          Z-ADDCOAMT     BEAMT  130               S01460 080603
     C***********                                                  S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          ENDSR                                   S01460 080603
     C*****************************************************************60 080603
     C/EJECT                                                              080603
     C*****************************************************************   080603
     C*                                                               *   080603
     C*    P03       - This Subroutine identifies Foreign Tax keys    *   080603
     C*                and calculated Local and Base Currency         *   080603
     C*                Equivalent Amounts                             *   080603
     C*    CALLS     -                                                *   080603
     C*                                                               *   080603
     C*    CALLED BY - Main Processing                                *   080603
     C*                                                               *   080603
     C*****************************************************************   080603
     C           P03       BEGSR                                          080603
     C*                                                                   080603
     C**   Clear Foreign Tax key Indicator                                080603
     C                     MOVE '0'       *IN60                           080603
     C/COPY WNCPYSRC,DL0295C115
     C*                                                                   080603
     C**   Tax Keys are xxIyy....T and xxMyy....T                         080603
     C**   And Foreign is not Local Currency                              080603
     C*                                                                   080603
     C           EVSUB     IFEQ 'T'                                       080603
     C           EVCOD     ANDEQ'I'                                       080603
     C           ECCY      ANDNEBJLCCY                                    080603
     C           EVSUB     OREQ 'T'                                       080603
     C           EVCOD     ANDEQ'M'                                       080603
     C           ECCY      ANDNEBJLCCY                                    080603
     C*                                                                   080603
     C**   Set Foreign Tax key Indicator                                  080603
     C                     MOVE '1'       *IN60                           080603
     C*                                                                   080603
     C** Calculate Base Currency Equivalent of Tax amount                 080603
     C*                                                                   080603
     C           ECCY      IFNE BJCYCD                                    080603
     C/COPY WNCPYSRC,DL0295C003
     C                     Z-ADDQSPOT     XRATE  158                      080603
      *                                                                                       CGL165
      * Use Tax Conversion Rate if CGL165 is On                                               CGL165
     C           CGL165    IFEQ 'Y'                                                           CGL165
     C                     Z-ADDQTSPOT    XRATE  158                                          CGL165
     C                     ENDIF                                                              CGL165
     C/COPY WNCPYSRC,DL0295C004
      *                                                                                       CDL081
     C           CDL081    IFEQ 'Y'                                                           CDL081
     C           W#BSRD    ANDEQ'Y'                                                           CDL081
      *                                                                                       CDL081
      ** When withholding tax is converted from non-base currency to                          CDL081
      ** base currency, the resulting amount is rounded down to the                           CDL081
      ** nearest cent                                                                         CDL081
      *                                                                                       CDL081
      ** Event ccy dec place to base ccy dec place adjustment                                 CDL081
      *                                                                                       CDL081
     C           BDECP     SUB  QDECP     DP                                                  CDL081
     C                     ADD  4         DP                                                  CDL081
      *                                                                                       CDL081
      ** If multiply/divide indicator is 'M'                                                  CDL081
      *                                                                                       CDL081
     C           QMDIN     IFEQ 'M'                                                           CDL081
      *                                                                                       CDL081
     C           DP        IFLT 4                                                             CDL081
     C           EAMT      MULT XRATE     WSAMT                                               CDL081
     C                     MULT POWER,DP  WSAMT                                               CDL081
     C                     ELSE                                                               CDL081
     C           EAMT      MULT POWER,DP  WSAMT                                               CDL081
     C                     MULT XRATE     WSAMT                                               CDL081
     C                     END                                                                CDL081
      *                                                                                       CDL081
      ** ELSE - multiply/ divide indicator is 'D'                                             CDL081
      *                                                                                       CDL081
     C                     ELSE                                                               CDL081
      *                                                                                       CDL081
     C           DP        IFLT 4                                                             CDL081
     C                     DIV  POWER,DP  XRATE                                               CDL081
     C           EAMT      DIV  XRATE     WSAMT                                               CDL081
     C                     ELSE                                                               CDL081
     C           EAMT      MULT POWER,DP  WSAMT                                               CDL081
     C                     DIV  XRATE     WSAMT                                               CDL081
     C                     END                                                                CDL081
      *                                                                                       CDL081
     C                     END                                                                CDL081
      *                                                                                       CDL081
     C                     ELSE                                                               CDL081
      *                                                                                       CDL081
      ** Otherwise, the rounding method is half adjust                                        CDL081
      *                                                                                       CDL081
     C*                                                                   080603
     C** Event Ccy dec pls to Base Ccy Dec Pls adjustment                 080603
     C*                                                                   080603
     C           BDECP     SUB  QDECP     DP      20                      080603
     C                     ADD  4         DP                              080603
     C*                                                                   080603
     C** If Multiply/ Divide Indicator is 'M'                             080603
     C*                                                                   080603
     C           QMDIN     IFEQ 'M'                                       080603
     C*                                                                   080603
     C           DP        IFLT 4                                         080603
     C**********           DIV  POWER,DP  XRATE                    080603 136321
     C**********           END                                     080603 136321
     C*                                                                   080603
     C           EAMT      MULT XRATE     WSAMT  200H                     080603
     C                     MULT POWER,DP  WSAMT     H                     136321
     C                     ELSE                                           136321
     C           EAMT      MULT POWER,DP  WSAMT     H                     136321
     C                     MULT XRATE     WSAMT     H                     136321
     C                     END                                            136321
     C*                                                                   080603
     C** ELSE - Multiply/ Divide Indicator is 'D'                         080603
     C*                                                                   080603
     C                     ELSE                                           080603
     C*                                                                   080603
     C           DP        IFLT 4                                         080603
     C********** EAMT      DIV  POWER,DP  WSAMT                    080603 136321
     C**********           DIV  XRATE     WSAMT     H              080603 136321
     C                     DIV  POWER,DP  XRATE     H                     136321
     C           EAMT      DIV  XRATE     WSAMT     H                     136321
     C                     ELSE                                           080603
     C           EAMT      MULT POWER,DP  WSAMT     H                     136321
     C********** EAMT      DIV  XRATE     WSAMT     H              080603 136321
     C                     DIV  XRATE     WSAMT     H                     136321
     C                     END                                            080603
     C*                                                                   080603
     C                     END                                            080603
      *                                                                                       CDL081
     C                     END                                                                CDL081
     C*                                                                   080603
     C** Round result                                                     080603
     C*                                                                   080603
     C**********           Z-ADD7         X                        080603 136321
     C********** X         DOWGT4                                  080603 136321
     C********** WSAMT     DIV  POWER,X   W1AMT  200H              080603 136321
     C**********           MULT POWER,X   W1AMT     H              080603 136321
     C*                                                                   080603
     C********** W1AMT     DIV  XRATE     W2AMT  200H              080603 136321
     C********** W1AMT     MULT XRATE     W3AMT  200H              080603 136321
     C*                                                                   080603
     C********** W2AMT     IFEQ EAMT                               080603 136321
     C********** W3AMT     OREQ EAMT                               080603 136321
     C**********           Z-ADDW1AMT     WSAMT                    080603 136321
     C**********           Z-ADD4         X                        080603 136321
     C**********           END                                     080603 136321
     C*                                                                   080603
     C**********           SUB  1         X                        080603 136321
     C**********           END                                     080603 136321
     C*                                                                   080603
     C** Adjust the Amount for Currency Decimal Places                    080603
     C*                                                                   080603
     C********** DP        IFGT 4                                  080603 136321
     C**********           DIV  POWER,DP  WSAMT     H              080603 136321
     C**********           END                                     080603 136321
     C*                                                                   080603
     C                     Z-ADDWSAMT     BEAMT  150                      080603
     C*                                                                   080603
     C** Else - Event Currency is Base Currency                           080603
     C*                                                                   080603
     C                     ELSE                                           080603
     C                     Z-ADDEAMT      BEAMT  150                      080603
     C                     END                                            080603
     C*                                                                   080603
     C** Calculate Local Currency Equivalent of Tax amount                080603
     C*                                                                   080603
     C           BJLCCY    IFNE BJCYCD                                    080603
     C                     Z-ADDLSPOT     XRATE                           080603
      *                                                                                       CGL165
      * Use Tax Conversion Rate if CGL165 is On                                               CGL165
     C           CGL165    IFEQ 'Y'                                                           CGL165
     C                     Z-ADDLTSPOT    XRATE                                               CGL165
     C                     ENDIF                                                              CGL165
     C/COPY WNCPYSRC,DLH00186
     C*                                                                   080603
     C** Base Ccy dec pls to Local Ccy Dec Pls adjustment                 080603
     C*                                                                   080603
     C********** BDECP     SUB  LDECP     DP                       080603 136321
     C           LDECP     SUB  BDECP     DP                              136321
     C                     ADD  4         DP                              080603
     C*                                                                   080603
     C** If Multiply/ Divide Indicator is 'M'                             080603
     C*                                                                   080603
     C           LMDIN     IFEQ 'D'                                       080603
     C*                                                                   080603
     C           DP        IFLT 4                                         080603
     C**********           DIV  POWER,DP  XRATE                    080603 136321
     C**********           END                                     080603 136321
     C*                                                                   080603
     C           BEAMT     MULT XRATE     WSAMT     H                     080603
     C                     MULT POWER,DP  WSAMT     H                     136321
     C                     ELSE                                           136321
     C           BEAMT     MULT POWER,DP  WSAMT     H                     136321
     C                     MULT XRATE     WSAMT     H                     136321
     C                     END                                            136321
     C*                                                                   080603
     C** ELSE - Multiply/ Divide Indicator is 'M'                         080603
     C*                                                                   080603
     C                     ELSE                                           080603
     C*                                                                   080603
     C           DP        IFLT 4                                         080603
     C********** BEAMT     DIV  POWER,DP  WSAMT                    080603 136321
     C**********           DIV  XRATE     WSAMT     H              080603 136321
     C                     DIV  POWER,DP  XRATE     H                     136321
     C           BEAMT     DIV  XRATE     WSAMT     H                     136321
     C                     ELSE                                           080603
     C           BEAMT     MULT POWER,DP  WSAMT     H                     136321
     C********** BEAMT     DIV  XRATE     WSAMT     H              080603 136321
     C                     DIV  XRATE     WSAMT     H                     136321
     C                     END                                            080603
     C*                                                                   080603
     C                     END                                            080603
     C*                                                                   080603
     C** Round result                                                     080603
     C*                                                                   080603
     C**********           Z-ADD7         X                        080603 136321
     C********** X         DOWGT4                                  080603 136321
     C********** WSAMT     DIV  POWER,X   W1AMT     H              080603 136321
     C**********           MULT POWER,X   W1AMT     H              080603 136321
     C*                                                                   080603
     C********** W1AMT     DIV  XRATE     W2AMT     H              080603 136321
     C********** W1AMT     MULT XRATE     W3AMT     H              080603 136321
     C*                                                                   080603
     C********** W2AMT     IFEQ BEAMT                              080603 136321
     C********** W3AMT     OREQ BEAMT                              080603 136321
     C**********           Z-ADDW1AMT     WSAMT                    080603 136321
     C**********           Z-ADD4         X                        080603 136321
     C**********           END                                     080603 136321
     C*                                                                   080603
     C**********           SUB  1         X                        080603 136321
     C**********           END                                     080603 136321
     C*                                                                   080603
     C** Adjust the Amount for Currency Decimal Places                    080603
     C*                                                                   080603
     C********** DP        IFGT 4                                  080603 136321
     C**********           DIV  POWER,DP  WSAMT     H              080603 136321
     C**********           END                                     080603 136321
     C*                                                                   080603
     C                     Z-ADDWSAMT     LEAMT                           080603
     C*                                                                   080603
     C** Else - Local Currency is Base Currency                           080603
     C*                                                                   080603
     C                     ELSE                                           080603
     C                     Z-ADDBEAMT     LEAMT  150                      080603
     C                     END                                            080603
     C                     END                                            080603
     C/COPY WNCPYSRC,DL0295C084
     C*                                                                   080603
     C                     ENDSR                                          080603
     C*****************************************************************   080603
     C/EJECT                                                              080603
     C*****************************************************************   080603
     C*                                                               *   080603
     C*    P04       - Withholding Tax has been Posted in Local Ccy,  *   080603
     C*                and this subroutine generates the Cross Ccy    *   080603
     C*                FX Postings, across the Spot Trade and         *   080603
     C*                Trade Equivalent Accounts.                     *   080603
     C*                                                                   080603
     C*                The Posting Sequence is as follows, but is     *   080603
     C*                conditional upon non Zero Spot Trade *         *   080603
     C*                Equivalent A/c Codes                           *   080603
     C*                                                               *   080603
     C*      DR  Local Currency Equiv.  to   W/H Tax A/c(Already Done)*   080603
     C*      CR  Local Currency Equiv.  to   Lccy SPOT Trade A/c      *   080603
     C*      DR  Base  Currency Equiv.  to   Lccy Spot Equivalent     *   080603
     C*      CR  Base  Currency Equiv.  to   Eccy Spot Equivalent     *   080603
     C*      DR  Event Amount           to   Eccy SPOT Trade A/c      *   080603
     C*                                                                   080603
     C*    CALLS     -                                                *   080603
     C*                                                               *   080603
     C*    CALLED BY - Main Processing                                *   080603
     C*                                                               *   080603
     C*****************************************************************   080603
     C           P04       BEGSR                                          080603
     C*                                                                   080603
     C**   Add W/H Tax Posting Amount to HASH Total                       080603
     C*                                                                   080603
     C/COPY WNCPYSRC,DL0295C026
     C                     Z-ADD2         S                               080603
     C                     Z-ADD1         Z                               080603
     C           PSTA      DIV  1000      ZZAMT                           080603
     C                     EXSR HASH                                      080603
     C/COPY WNCPYSRC,DL0295C027
     C*                                                                   080603
     C** Build Common Output Data                                         080603
     C*                                                                   080603
     C                     Z-ADD*ZERO     ACRAN                           080603
     C**********           MOVE '     '   TRAT                                       080603 AR813358
     C                     MOVE '00000'   TRAT                                              AR813358
     C                     Z-ADD*ZERO     RRNM                            080603
     C                     MOVE BBICN     ACCNM                           080603
     C/COPY WNCPYSRC,DL0295C099
     C                     MOVE '01'      ACACS                           080603
     C/COPY WNCPYSRC,DL0295C100
     C                     MOVE BRCA      ACBRCD                          080603
     C*                                                                   080603
     C** If Local Ccy's Trade Equivalent A/c code is Zero/Blank,          080603
     C*     Local = Base Currency, and there is no Base Ccy               080603
     C*     SPOT TRADE A/c to be updated.                                 080603
     C** Otherwise, Update Local SPOT & Equivalent A/cs                   080603
     C*                                                                   080603
     C           LSPEQ     IFNE '    '                                    080603
     C           LSPEQ     ANDNE'0000'                                    080603
     C/COPY WNCPYSRC,DL0295C116
     C*                                                                   080603
     C** Set DR/CR Indicator                                              080603
     C*                                                                   080603
     C           *IN39     IFEQ '1'                                       080603
     C                     MOVE '0'       *IN39                           080603
     C                     ELSE                                           080603
     C                     MOVE '1'       *IN39                           080603
     C                     END                                            080603
     C*                                                                   080603
     C** Post to Local Currency SPOT TRADE Account                        080603
     C*                                                                   080603
     C                     MOVE BJLCCY    ACCCY                           080603
     C                     Z-ADDLEAMT     PSTA                            080603
     C                     MOVE BLSPTA    ACACD                           080603
     C/COPY WNCPYSRC,DL0295C101
     C                     MOVE ATYPT     ATYPA                           080603
     C                     MOVE ACSCT     ACSCA                           080603
     C                     MOVE RINDT     RINDA                           080603
     C*                                                                   080603
     C***********          EXCPTNEWREC                              S01460S01522
     C                     EXSR SRNREC                                    S01522
     C*                                                                   080603
     C**   Add Posting Amount to HASH Total                               080603
     C*                                                                   080603
     C/COPY WNCPYSRC,DL0295C028
     C           PSTA      DIV  1000      ZZAMT                           080603
     C                     EXSR HASH                                      080603
     C/COPY WNCPYSRC,DL0295C029
     C*                                                                   080603
     C** Set DR/CR Indicator                                              080603
     C*                                                                   080603
     C           *IN39     IFEQ '1'                                       080603
     C                     MOVE '0'       *IN39                           080603
     C                     ELSE                                           080603
     C                     MOVE '1'       *IN39                           080603
     C                     END                                            080603
     C*                                                                   080603
     C** Post to Local Currency Trade Equivalent Account                  080603
     C*                                                                   080603
     C                     MOVE BJCYCD    ACCCY                           080603
     C                     Z-ADDBEAMT     PSTA                            080603
     C                     MOVE LSPEQ     ACACD                           080603
     C/COPY WNCPYSRC,DL0295C102
     C                     MOVE ATYPL     ATYPA                           080603
     C                     MOVE ACSCL     ACSCA                           080603
     C                     MOVE RINDL     RINDA                           080603
     C*                                                                   080603
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295CCP5
      *                                                                   S01408
     C***********          EXCPTNEWREC                              S01460S01522
     C                     EXSR SRNREC                                    S01522
     C*                                                                   080603
     C**   Add Posting Amount to HASH Total                               080603
     C*                                                                   080603
     C/COPY WNCPYSRC,DL0295C030
     C           PSTA      DIV  1000      ZZAMT                           080603
     C                     EXSR HASH                                      080603
     C/COPY WNCPYSRC,DL0295C031
     C*                                                                   080603
     C**   Add Number of records written                                  080603
     C                     ADD  2         NRIT                            080603
     C*                                                                   080603
     C                     ENDIF                                          080603
     C*                                                                   080603
     C** If Event Ccy's Trade Equivalent A/c code is Zero/Blank,          080603
     C*     Event = Base Currency, and there is no Base Ccy               080603
     C*     SPOT TRADE A/c to be updated.                                 080603
     C** Otherwise, Update Event SPOT & Equivalent A/cs                   080603
     C*                                                                   080603
     C           QSPEQ     IFNE '    '                                    080603
     C           QSPEQ     ANDNE'0000'                                    080603
     C/COPY WNCPYSRC,DL0295C083
     C*                                                                   080603
     C** Set DR/CR Indicator                                              080603
     C*                                                                   080603
     C           *IN39     IFEQ '1'                                       080603
     C                     MOVE '0'       *IN39                           080603
     C                     ELSE                                           080603
     C                     MOVE '1'       *IN39                           080603
     C                     END                                            080603
     C*                                                                   080603
     C** Post to Event Currency Trade Equivalent Account                  080603
     C*                                                                   080603
     C                     MOVE BJCYCD    ACCCY                           080603
     C                     Z-ADDBEAMT     PSTA                            080603
     C                     MOVE QSPEQ     ACACD                           080603
     C/COPY WNCPYSRC,DL0295C103
     C                     MOVE ATYPQ     ATYPA   1                       080603
     C                     MOVE ACSCQ     ACSCA                           080603
     C                     MOVE RINDQ     RINDA                           080603
     C*                                                                   080603
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295CCP5                                           S01408
      *                                                                   S01408
     C***********          EXCPTNEWREC                              S01460S01522
     C                     EXSR SRNREC                                    S01522
     C*                                                                   080603
     C**   Add Posting Amount to HASH Total                               080603
     C*                                                                   080603
     C/COPY WNCPYSRC,DL0295C032
     C           PSTA      DIV  1000      ZZAMT                           080603
     C                     EXSR HASH                                      080603
     C/COPY WNCPYSRC,DL0295C033
     C*                                                                   080603
     C** Set DR/CR Indicator                                              080603
     C*                                                                   080603
     C           *IN39     IFEQ '1'                                       080603
     C                     MOVE '0'       *IN39                           080603
     C                     ELSE                                           080603
     C                     MOVE '1'       *IN39                           080603
     C                     END                                            080603
     C*                                                                   080603
     C** Post to Event Currency SPOT TRADE Account                        080603
     C*                                                                   080603
     C                     MOVE ECCY      ACCCY                           080603
     C                     Z-ADDEAMT      PSTA                            080603
     C                     MOVE BLSPTA    ACACD                           080603
     C/COPY WNCPYSRC,DL0295C104
     C                     MOVE ATYPT     ATYPA                           080603
     C                     MOVE ACSCT     ACSCA                           080603
     C                     MOVE RINDT     RINDA                           080603
     C*                                                                   080603
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295CCP5                                           S01408
      *                                                                   S01408
     C***********          EXCPTNEWREC                              S01460S01522
     C                     EXSR SRNREC                                    S01522
     C*                                                                   080603
     C**   Add Number of records written                                  080603
     C/COPY WNCPYSRC,DL0295C034
     C                     ADD  2         NRIT                            080603
     C/COPY WNCPYSRC,DL0295C035
     C*                                                                   080603
     C                     ENDIF                                          080603
     C*                                                                   080603
     C                     ENDSR                                          080603
     C*                                                                   080603
     C*****************************************************************   080603
     C*/EJECT****                                                  S01460 080603
     C*****************************************************************60 080603
     C***********                                                  S01*60 080603
     C*****P04***    - THIS SUBROUTINE CREATES ADDITIONAL POSTINGS S01*60 080603
     C***********                                                  S01*60 080603
     C*****CALLS*    -                                             S01*60 080603
     C***********                                                  S01*60 080603
     C*****CALLED BY -                                             S01*60 080603
     C***********                                                  S01*60 080603
     C*****************************************************************60 080603
     C***********P04       BEGSR                                   S01460 080603
     C***********                                                  S01460 080603
     C*****ACCUMULATE BEAMT EVENT AMOUNT ALREADY OUTPUT IN BASE    S01460 080603
     C*****CURRENCY IN TOTALS FOR BRANCH/BASE CURRENCY             S01460 080603
     C*****IF**IN39 IS 1 (CREDIT), ADD BEAMT INTO CRBAS            S01460 080603
     C*****IF**IN39 IS 0 (DEBIT), ADD BEAMT INTO DRBAS             S01460 080603
     C************IN39     IFEQ '1'                                S01460 080603
     C***********          ADD  BEAMT     CRBAS                    S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********          ADD  BEAMT     DRBAS                    S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C*****CREATE SPOT TRADE A/C POSTING IN BASE CURRENCY          S01460 080603
     C***********          MOVE BLSPTA    ACNTCD  40               S01460 080603
     C***********          Z-ADDBEAMT     PSTAMT 130               S01460 080603
     C***********                                                  S01460 080603
     C************IN39     IFEQ '1'                                S01460 080603
     C***********          MOVE '0'       DEBCRD  1        DEBIT   S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********          MOVE '1'       DEBCRD           CREDIT  S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE BJCYCD    CCYBOE  3                S01460 080603
     C***********          MOVE RINDT     RETIND  1                S01460 080603
     C***********          MOVE ATYPT     ACNTYP  1                S01460 080603
     C***********                                                  S01460 080603
     C***********          EXCPTNEWREC                             S01460 080603
     C***********                                                  S01460 080603
     C*****ACCUMULATE BEAMT EVENT AMOUNT IN BASE CURRENCY IN TOTALSS01460 080603
     C*****FOR*BRANCH/BASE CURRENCY                                S01460 080603
     C*****IF*DEBIT/CREDIT INDICATOR IS 1, ADD BEAMT INTO CRBAS    S01460 080603
     C*****IF*DEBIT/CREDIT INDICATOR IS 0, ADD BEAMT INTO DRBAS    S01460 080603
     C***********DEBCRD    IFEQ '1'                                S01460 080603
     C***********          ADD  BEAMT     CRBAS                    S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********          ADD  BEAMT     DRBAS                    S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C*****CREATE TRADE EQUIVALENT OF BASE CURRENCY POSTING IN BASES01460 080603
     C*****CURRENCY                                                S01460 080603
     C***********          MOVE BSPEQ     ACNTCD                   S01460 080603
     C***********          Z-ADDBEAMT     PSTAMT                   S01460 080603
     C***********                                                  S01460 080603
     C************IN39     IFEQ '1'                                S01460 080603
     C***********          MOVE '1'       DEBCRD           CREDIT  S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********          MOVE '0'       DEBCRD           DEBIT   S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE BJCYCD    CCYBOE                   S01460 080603
     C***********          MOVE RINDB     RETIND                   S01460 080603
     C***********          MOVE ATYPB     ACNTYP                   S01460 080603
     C***********                                                  S01460 080603
     C***********          EXCPTNEWREC                             S01460 080603
     C***********                                                  S01460 080603
     C*****ACCUMULATE BEAMT EVENT AMOUNT IN BASE CURRENCY IN TOTALSS01460 080603
     C*****FOR*BRANCH/BASE CURRENCY                                S01460 080603
     C*****IF*DEBIT/CREDIT INDICATOR IS 1, ADD BEAMT INTO CRBAS    S01460 080603
     C*****IF*DEBIT/CREDIT INDICATOR IS 0, ADD BEAMT INTO DRBAS    S01460 080603
     C***********DEBCRD    IFEQ '1'                                S01460 080603
     C***********          ADD  BEAMT     CRBAS                    S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********          ADD  BEAMT     DRBAS                    S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C*****CREATE TRADE EQUIVALENT OF DEAL CURRENCY POSTING IN BASES01460 080603
     C*****CURRENCY                                                S01460 080603
     C***********          MOVE XSPQ,X    ACNTCD                   S01460 080603
     C***********          Z-ADDBEAMT     PSTAMT                   S01460 080603
     C***********                                                  S01460 080603
     C************IN39     IFEQ '1'                                S01460 080603
     C***********          MOVE '0'       DEBCRD           DEBIT   S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********          MOVE '1'       DEBCRD           CREDIT  S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE BJCYCD    CCYBOE                   S01460 080603
     C***********          MOVE RINDQ     RETIND                   S01460 080603
     C***********          MOVE ATYPQ     ACNTYP                   S01460 080603
     C***********                                                  S01460 080603
     C***********          EXCPTNEWREC                             S01460 080603
     C***********                                                  S01460 080603
     C*****ACCUMULATE BEAMT EVENT AMOUNT IN BASE CURRENCY IN TOTALSS01460 080603
     C*****FOR*BRANCH/BASE CURRENCY                                S01460 080603
     C*****IF*DEBIT/CREDIT INDICATOR IS 1, ADD BEAMT INTO CRBAS    S01460 080603
     C*****IF*DEBIT/CREDIT INDICATOR IS 0, ADD BEAMT INTO DRBAS    S01460 080603
     C***********DEBCRD    IFEQ '1'                                S01460 080603
     C***********          ADD  BEAMT     CRBAS                    S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********          ADD  BEAMT     DRBAS                    S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C*****CREATE SPOT TRADE A/C POSTING IN DEAL CURRENCY          S01460 080603
     C***********          MOVE BLSPTA    ACNTCD                   S01460 080603
     C***********          Z-ADDEAMT      PSTAMT                   S01460 080603
     C***********                                                  S01460 080603
     C************IN39     IFEQ '1'                                S01460 080603
     C***********          MOVE '1'       DEBCRD           CREDIT  S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********          MOVE '0'       DEBCRD           DEBIT   S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE ECCY      CCYBOE                   S01460 080603
     C***********          MOVE RINDT     RETIND                   S01460 080603
     C***********          MOVE ATYPT     ACNTYP                   S01460 080603
     C***********                                                  S01460 080603
     C***********          EXCPTNEWREC                             S01460 080603
     C***********                                                  S01460 080603
     C*****HASH*TOTALS PROCESSING FOR EVENT CCY POSTING            S01460 080603
     C*****SET*S*TO 2 (MEANS HAS TOTALS FOR GEDLPD)                S01460 080603
     C*****SET*Z*TO 1 (ADD 1 TIME THE AMOUNT)                      S01460 080603
     C***********          Z-ADD2         S                        S01460 080603
     C***********          Z-ADD1         Z                        S01460 080603
     C***********EAMT      DIV  1000      ZZAMT                    S01460 080603
     C***********          EXSR HASH                               S01460 080603
     C***********                                                  S01460 080603
     C*****HASH*TOTALS PROCESSING FOR BASE CCY POSTINGS            S01460 080603
     C*****SET*S*TO 2 (MEANS HAS TOTALS FOR GEDLPD)                S01460 080603
     C*****SET*Z*TO 3 (ADD 3 TIMES THE AMOUNT)                     S01460 080603
     C*****SET*ZZAMT TO BEAMT DIV 1000                             S01460 080603
     C***********          Z-ADD2         S                        S01460 080603
     C***********          Z-ADD3         Z                        S01460 080603
     C***********BEAMT     DIV  1000      ZZAMT                    S01460 080603
     C***********          EXSR HASH                               S01460 080603
     C***********                                                  S01460 080603
     C*****ADD*4*TO NUMBER OF RECORDS, NRIT; MOVE '0' TO TAXAC     S01460 080603
     C***********          ADD  4         NRIT                     S01460 080603
     C***********                                                  S01460 080603
     C***********          ENDSR                                   S01460 080603
     C*****************************************************************60 080603
     C*/EJECT****                                                  S01460 080603
     C*****************************************************************60 080603
     C***********                                                  S01*60 080603
     C*****P05*******-*THIS*SUBROUTINE*CHECKS*FOR*IMBALANCE*IN*BASE****60 080603
     C*****************CURRENCY****************************************60 080603
     C***********                                                     *60 080603
     C*****CALLS*    -                                                *60 080603
     C***********                                                     *60 080603
     C*****CALLED BY -                                                *60 080603
     C***********                                                     *60 080603
     C*****************************************************************60 080603
     C***********P05       BEGSR                                   S01460 080603
     C***********                                                  S01460 080603
     C***********CRBAS     IFNE DRBAS                              S01460 080603
     C***********                                                  S01460 080603
     C***********CRBAS     IFLT DRBAS                              S01460 080603
     C***********                                                  S01460 080603
     C***********DRBAS     SUB  CRBAS     BALSUS                   S01460 080603
     C***********          MOVE '1'       *IN39                    S01460 080603
     C***********                                                  S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********                                                  S01460 080603
     C***********CRBAS     SUB  DRBAS     BALSUS                   S01460 080603
     C***********          MOVE '0'       *IN39                    S01460 080603
     C***********                                                  S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE '1'       TAXAC                    S01460 080603
     C***********          MOVE '1'       *IN60                    S01460 080603
     C***********                                                  S01460 080603
     C***********          EXCPTIMBAL                              S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE '0'       TAXAC                    S01460 080603
     C***********          MOVE '0'       *IN60                    S01460 080603
     C***********                                                  S01460 080603
     C***********          ADD  1         NRIT                     S01460 080603
     C***********                                                  S01460 080603
     C***********BALSUS    DIV  1000      ZZAMT                    S01460 080603
     C***********          Z-ADD2         S                        S01460 080603
     C***********          Z-ADD1         Z                        S01460 080603
     C***********          EXSR HASH                               S01460 080603
     C***********                                                  S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          ENDSR                                   S01460 080603
     C*****************************************************************60 080603
     C*/EJECT*****                                                 S01460 080603
     C/COPY WNCPYSRC,DL0295C044
1196 C********************************************************************
1197 C*    SR. TO ADD ZZAMT TO HASH TOTALS IN ARRAYS INT & DEC.
     C*    Z (No. of times to perform) supplied from calling point .      S01094
1198 C           HASH      BEGSR                           *** HASH ***
1199 C*
     C                     DO   Z                           B001          S01094
1200 C**         ZZAMT     COMP 0                      50                 S01094
1201 C** 50                Z-SUBZZAMT     ZZAMT                           S01094
1202 C                     Z-ADDINT,S     ZZTOTI
1203 C                     Z-ADDDEC,S     ZZTOTD
1204 C**                   EXSR GLZADD                                    S01094
     C           ZZAMT     IFLT 0                           B002          S01094
     C                     Z-SUBZZAMT     ZZAMT                           S01094
     C                     END                              E002          S01094
     C                     Z-ADDZZAMT     ZZAMTI                          S01094
     C                     MOVE ZZAMT     ZZAMTD                          S01094
     C                     ADD  ZZAMTD    ZZTOTD                          S01094
     C           ZZTOTD    IFLT ZZAMTD                      B002          S01094
     C                     ADD  1         ZZTOTI                          S01094
     C                     END                              E002          S01094
     C                     ADD  ZZAMTI    ZZTOTI                          S01094
1205 C                     Z-ADDZZTOTI    INT,S                           S01094
1206 C                     Z-ADDZZTOTD    DEC,S                           S01094
     C                     END                              E001          S01094
1207 C*
1208 C                     ENDSR
1209 C*
     C*/EJECT*****                                                 S01460 080603
     C********************************************************************080603
     C***********                                                  S01460 080603
     C*****CONVER - SUBROUTINE TO CONVERT AN  AMOUNT FROM ONE CURRENCY460 080603
     C***********       TO ANOTHER                                 S01460 080603
     C***********                                                  S01460 080603
     C*****INPUT* - CICCY  (3)    IN CURRENCY                      S01460 080603
     C***********   COCCY  (3)    OUT CURRENCY                     S01460 080603
     C***********   CIAMT  (15,0) AMOUNT INPUT                     S01460 080603
     C***********   CEXCH  (13,8) EXCHANGE RATE                    S01460 080603
     C***********   CMDI   (1)    MULTIPLY/DIVIDE INDICATOR        S01460 080603
     C***********   CIDEC  (1,0)  DECIMAL PLACES IN CURRENCY       S01460 080603
     C***********   CODEC  (1,0)  DECIMAL PLACES OUT CURRENCY      S01460 080603
     C***********   POWER   -     COMPILE TIME ARRAY MUST BE INCLUDED1460 080603
     C***********                 IN THE PROGRAM SOURCE            S01460 080603
     C***********                                                  S01460 080603
     C****OUTPUT*-  COAMT  (15,0) AMOUNT OUTPUT                    S01460 080603
     C***********                                                  S01460 080603
     C****CALLS**-  NONE                                           S01460 080603
     C***********                                                  S01460 080603
     C***********                                                  S01460 080603
     C********************************************************************080603
     C***********                                                  S01460 080603
     C***********CONVER    BEGSR                           ** CONVER0**60 080603
     C***********                                                  S01460 080603
     C**DEFINE*INPUT AND OUTPUT FIELDS                             S01460 080603
     C***********                                                  S01460 080603
     C***********          MOVE CICCY     CICCY   3                S01460 080603
     C***********          MOVE COCCY     COCCY   3                S01460 080603
     C***********          Z-ADDCIAMT     CIAMT  150               S01460 080603
     C***********          Z-ADD0         COAMT  150               S01460 080603
     C***********          Z-ADDCEXCH     CEXCH  138               S01460 080603
     C***********          MOVE CMDI      CMDI    1                S01460 080603
     C***********          Z-ADDCIDEC     CIDEC   10               S01460 080603
     C***********          Z-ADDCODEC     CODEC   10               S01460 080603
     C***********                                                  S01460 080603
     C**IF*EXCHANGE RATE IS 0 - OUTPUT CURRENCY AMOUNT AS ZERO     S01460 080603
     C***********                                                  S01460 080603
     C***********CEXCH     IFEQ 0                                  S01460 080603
     C***********          Z-ADD0         COAMT                    S01460 080603
     C***********          GOTO ECONVR                             S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C**IF*DECIMAL PLACES ARE THE SAME FOR BOTH CURRENCIES         S01460 080603
     C***********                                                  S01460 080603
     C***********CIDEC     IFEQ CODEC                              S01460 080603
     C***********                                                  S01460 080603
     C*****CALCULATE OUTPUT CURRENCY AMOUNT BY DIVIDING EXCHANGE RATE1INTO080603
     C****OR*MULTIPLYING EXCHANGE RATE BY CURRENCY AMOUNT INPUT DEPENDING 080603
     C****ON*INDICATOR                                             S01460 080603
     C***********                                                  S01460 080603
     C***********CMDI      IFEQ '0'                                S01460 080603
     C***********CIAMT     DIV  CEXCH     COAMT     H              S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********CIAMT     MULT CEXCH     COAMT     H              S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********                                                  S01460 080603
     C****IF*DECIMAL PLACES DIFFER -                               S01460 080603
     C*********CALCULATE DIFFERENCE IN DECIMAL PLACE TO USE AS POWRSINDEX 080603
     C***********                                                  S01460 080603
     C***********CODEC     SUB  CIDEC     ZPX     10               S01460 080603
     C***********          ADD  4         ZPX                      S01460 080603
     C***********                                                  S01460 080603
     C****CALCULATE CURRENCY AMOUNT OUTPUT BY MULTIPLYING INPUT AMOUNT4BY 080603
     C*****POWER*ARRAY ENTRY AND THEN MULTIPLYING RESULT BY EXCHANGE0RATE 080603
     C*****DEPENDING ON INDICATOR                                  S01460 080603
     C***********                                                  S01460 080603
     C***********POWER,ZPX IFLT 1                          from d.pS*LT60 080603
     C***********CIAMT     MULT POWER,ZPX Z15#3  153        to d.p.S01460 080603
     C***********                                                  S01460 080603
     C***********CMDI      IFEQ '0'                                S01460 080603
     C***********Z15#3     DIV  CEXCH     COAMT     H              S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********Z15#3     MULT CEXCH     COAMT     H              S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          ELSE                            from d.p.0*GT0 080603
     C***********CIAMT     MULT POWER,ZPX CIAMT              to d.p.01460 080603
     C***********                                                  S01460 080603
     C***********CMDI      IFEQ '0'                                S01460 080603
     C***********CIAMT     DIV  CEXCH     COAMT     H              S01460 080603
     C***********          ELSE                                    S01460 080603
     C***********CIAMT     MULT CEXCH     COAMT     H              S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********                                                  S01460 080603
     C***********          END                                     S01460 080603
     C***********                                                  S01460 080603
     C***********ECONVR    ENDSR                           ** ECONVR0**60 080603
     C***********                                                  S01460 080603
     C*****************************************************************60 080603
     C*/EJECT*****                                                 S01460 080603
1210 C********************************************************************
1211 C**
1212 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
1213 C*   IND '99' IS SET BY AN OVERFLOW ERROR
1214 C**                                                                  S01094
1215 C**         GLZADD    BEGSR                           *** GLZADD ****S01094
1216 C**                                                                  S01094
1217 C**                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  S01094
1218 C** 91                GOTO ZZAEND                     AMT = 0.BYPASS S01094
1219 C**                                                                  S01094
1220 C**SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       S01094
1221 C**                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  S01094
1222 C**                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  S01094
1223 C**BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  S01094
1224 C**                                                                  S01094
1225 C**                   EXSR GLZSUM                                    S01094
1226 C**         ZZAEND    ENDSR                           ** ZZAEND TAG *S01094
1227 C**                                                                  S01094
1228 C********************************************************************
1229 C**SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            S01094
1230 C**                       GLZADD, GLZSUB, GLZCMP.                    S01094
1231 C**         PARAMETERS PASSED -                                      S01094
1232 C**                    I/P ZZAMTI ZZAMTD                             S01094
1233 C**                    O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       S01094
1234 C**                                                                  S01094
1235 C**         GLZSUM    BEGSR                           *** GLZSUM ****S01094
1236 C**                                                                  S01094
1237 C**                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  S01094
1238 C**                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  S01094
1239 C**                   SETOF                     919293               S01094
1240 C**                   SETOF                     949599               S01094
1241 C**                                                                  S01094
1242 C**   DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      S01094
1243 C**         ZZAMTI    COMP 0                      9293               S01094
1244 C** 93      ZZAMTD    COMP 0                      9293               S01094
1245 C** 93                GOTO ZZSEND                     ZERO BYPASS    S01094
1246 C**                                                                  S01094
1247 C**   DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       S01094
1248 C**         ZZTOTI    COMP 0                      9193               S01094
1249 C** 93      ZZTOTD    COMP 0                      9193               S01094
1250 C**                                                                  S01094
1251 C**   IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           S01094
1252 C** 93                Z-ADDZZAMTI    ZZTOTI                          S01094
1253 C** 93                Z-ADDZZAMTD    ZZTOTD                          S01094
1254 C** 93                GOTO ZZSEND                     ZERO BYPASS    S01094
1255 C**   IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        S01094
1256 C** 91N92                                                            S01094
1257 C**N91 92             GOTO ZZOFPS                                    S01094
1258 C**                                                                  S01094
1259 C**         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      S01094
1260 C**         ZZWK2     COMP 999                  93    '93' = CARRY   S01094
1261 C**N93      ZZWK2     COMP -999                   93    INTO INTEGER.S01094
1262 C**                                                                  S01094
1263 C** 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VES01094
1264 C**    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VES01094
1265 C** 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           S01094
1266 C**N93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           S01094
1267 C**                                                                  S01094
1268 C**IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    S01094
1269 C**N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. S01094
1270 C** 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      S01094
1271 C**N99                Z-ADDZZWK2     ZZTOTD                          S01094
1272 C**N99                Z-ADDZZWK3     ZZTOTI                          S01094
1273 C**                                                                  S01094
1274 C**IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. S01094
1275 C** 99                Z-ADD0         ZZAMT  153                      S01094
1276 C**                   GOTO ZZSEND                                    S01094
1277 C**                                                                  S01094
1278 C**THE 'SIGNS' ARE DIFFERENT                                         S01094
1279 C**         ZZOFPS    TAG                             ** ZZOFPS TAG**S01094
1280 C**IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            S01094
1281 C**                                                                  S01094
1282 C** 92                Z-SUBZZAMTI    ZZAMTI 150                      S01094
1283 C** 92                Z-SUBZZAMTD    ZZAMTD  30                      S01094
1284 C**                                                                  S01094
1285 C**IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           S01094
1286 C**                                                                  S01094
1287 C** 91                Z-SUBZZTOTI    ZZTOTI                          S01094
1288 C** 91                Z-SUBZZTOTD    ZZTOTD                          S01094
1289 C**BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            S01094
1290 C**                                                                  S01094
1291 C**         ZZTOTI    COMP ZZAMTI               93  95               S01094
1292 C** 95      ZZTOTD    COMP ZZAMTD               93  95               S01094
1293 C**                                                                  S01094
1294 C**IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   S01094
1295 C** 95                Z-ADD0         ZZTOTI                          S01094
1296 C** 95                Z-ADD0         ZZTOTD                          S01094
1297 C** 95                GOTO ZZSEND                                    S01094
1298 C**                                                                  S01094
1299 C**IF ZZTOT GT. ZZAMT.                                               S01094
1300 C** 93      ZZAMTD    COMP ZZTOTD               94                   S01094
1301 C** 93 94   ZZTOTI    SUB  1         ZZTOTI                          S01094
1302 C** 93 94   ZZTOTD    ADD  1000      ZZWK2                           S01094
1303 C** 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          S01094
1304 C** 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          S01094
1305 C** 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          S01094
1306 C*
1307 C*
1308 C* IF ZZAMT GT. ZZTOT.
1309 C**N93      ZZTOTD    COMP ZZAMTD               94                   S01094
1310 C**N93 94   ZZAMTI    SUB  1         ZZWK3  150                      S01094
1311 C**N93 94   ZZAMTD    ADD  1000      ZZWK2                           S01094
1312 C**N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          S01094
1313 C**N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          S01094
1314 C**N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          S01094
1315 C**N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          S01094
1316 C**                                                                  S01094
1317 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          S01094
1318 C**                   SETOF                     94                   S01094
1319 C** 93 91                                                            S01094
1320 C*RN93 92             SETON                     94                   S01094
1321 C** 94                Z-SUBZZTOTI    ZZTOTI                          S01094
1322 C** 94                Z-SUBZZTOTD    ZZTOTD                          S01094
1323 C**                                                                  S01094
1324 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            S01094
1325 C** 92                Z-SUBZZAMTI    ZZAMTI                          S01094
1326 C** 92                Z-SUBZZAMTD    ZZAMTD                          S01094
1327 C**         ZZSEND    TAG                             ** ZZSEND TAG *S01094
1328 C**
1329 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1330 C**                   SETOF                     96                   S01094
1331 C**         ZZTOTD    COMP 0                        91               S01094
1332 C** 91      ZZTOTI    COMP 0                      96                 S01094
1333 C** 96                MOVE '.000-'   ZZNEGD  5                       S01094
1334 C**                   ENDSR                             ** ENDSR **  S01094
      *****************************************************************   CDL002
      *                                                               *   CDL002
      * *PSSR  - Program exception error routine                      *   CDL002
      *          Called automatically if a program error occurs,      *   CDL002
      *          or directly by the program code using EXSR.          *   CDL002
      *          This subroutine DUMPs the program just once.         *   CDL002
      *                                                               *   CDL002
      * Called by: NETPST                                             *   CDL002
      *                                                               *   CDL002
      * Calls: None                                                   *   CDL002
      *                                                               *   CDL002
      *****************************************************************   CDL002
      *                                                                   CDL002
     C           *PSSR     BEGSR                           ** *PSSR SR ** CDL002
      *                                                                   CDL002
     C                     DUMP                                           CDL002
     C                     SETON                     U7U8LR               CDL002
     C                     RETRN                                          CDL002
      *                                                                   CDL002
     C                     ENDSR                                          CDL002
      *                                                                   CDL002
1335 C********************************************************************
     C/EJECT                                                              S01522
     C********************************************************************S01522
     C* Include subroutine ZSEDIT for amounts editing:                    S01522
     C*                                                                   S01522
     C/COPY ZSRSRC,ZSEDITZ3                                               S01522
     C********************************************************************S01522
     O/EJECT                                                              S01522
     O********************************************************************S01522
     C/EJECT                                                              CEU003
     C********************************************************************CEU003
     C* Include subroutine ZCONVN to convert an amount from one           CEU003
     C* currency to another.                                              CEU003
     C*                                                                   CEU003
     C/COPY ZSRSRC,ZCONVNZ1                                               CEU003
     C********************************************************************CEU003
     O/EJECT                                                              CEU003
     O********************************************************************CEU003
      *                                                                   S01408
      /COPY WNCPYSRC,DL0295CCP6
      *                                                                   S01408
1336 O*GEDLHH**HADD*****01                                                105140
     OGEDLHH  EADD             HEADER                                     105140
1337 O                                    1 'H'
1338 O                         FLSZ       4P
1339 O*
1340 O*    GENERATE ENTRY TO SUSPENSE
1341 O***********   GEDLPD  EADD     12 29                 *** SUSPEN *** S01522
1341 OGEDLPD  EADD             SUSPEN                                     S01522
1342 O                                    1 'P'
1343 O*****                    BICN       7                               S01117
1343 O                         BBICN      7                               S01117
     O                 70 35   OBICN      7                               109002
1344 O***********              ECCY      10                               S01460
     O***********      60      BJCYCD    10                        S01460 080603
     O***********     N60      ECCY      10                        S01460 080603
     O                         ACCCY     10                               080603
1345 O*****                    COMS      14                               S01194
1345 O**********               BKACCD    14                                            S01194 CGL029
     O                         BKACCD   599                                                   CGL029
1346 O                                   16 '01'
     O** A COMPUTER SUSPENSE A/C CANNOT BE RETAIL
1348 O*****************U1      RUND      35P                              S01194
1348 O*****************U1      BJRDNB    35P                        S01194E16457
1348 O****************NU1      DNWD      35P                              S01194
1348 O****************NU1      BJDNWD    35P                        S01194E16457
1348 O                         BJRDNB    35P                              E16457
1349 O                         EDAT      38P
1350 O***********                        46 'SUS'                         S01522
1351 O*****                    ACCKEY    62                               S01117
1351 O***********              ACCK      62                         S01117S01522
1352 O***********      33                53 '000000'                      S01522
1353 O***********      33      ECCY      56                               S01460
     O***********      33 60   BJCYCD    56                        S01460 080603
     O***********      33N60   ECCY      56                        S01460 080603
1353 O***********      33      ACCCY     56                        080603 S01522
1354 O***********      33                62 '000000'                      S01522
1355 O***********              DLNO      69                               S01522
1356 O***********              EVENT     73                               S01522
     O***********                                                         S01522
1356 O                         O#PNAR    73                               S01522
     O*                                                                   S01522
1357 O***********              EAMT      80P                              S01460
     O***********      60      BEAMT     80P                       S01460 080603
     O***********     N60      EAMT      80P                       S01460 080603
     O/COPY WNCPYSRC,DLH00135
1357 O                         PSTA      80P                              080603
1358 O                                   81 '0'
1359 O                 39                81 '1'
     O/COPY WNCPYSRC,DL0295O023
     O                         CNUM      87                               S01182
     O/COPY WNCPYSRC,DL0295O024
     O                                   95 '00000000'                                        CRE019
1360 O                                  102 'GE-DL'
1361 O*****                    BRCD     105                               S01117
1361 O                         BRCA     105                               S01117
     O                 70 35   OSBR     105                               109002
1362 O                         RINDS    106
1363 O                         Z3       108P
1364 O                         Z5       114P
1365 O                         ATYPS    124
     O/COPY WNCPYSRC,DL0295O016
1366 O                         PRIN     128
1367 O                                  129 'D'
1367 O                         PRFC     134                               S01117
     O                 54      FTPRFP   134                               CAC001
1367 O                                  140 '235959'                      S10736
1367 O                         VOIN     141                               S10736
1367 O                         ACSCS    146                               S10736
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0295OOP9                                           S01408
     O*                                                                   S01408
1366 O                         ZCMREF   176                               SO5452
1366 O                 78      SWCRD    176                               SO5452
1366 O                         DLREF    184                               SO5452
1366 O                         FACO     194                               SO5452
1366 O                         CNUM     200                               SO5452
     O/COPY WNCPYSRC,DL0295O002
1366 O                 82      CHNA     200                               SO5452
     O/COPY WNCPYSRC,DL0295O003
1366 O**********               DLNO     221                                            S01182 CGL029
1366 O                                  230 '         '                   S01182
1366 O                         SUBT     232                               S01182
1366 O                                  240 '        '                    S01182
1366 O                         DTYP     242                               S01182
1366 O**********               DTYP     242                                          S01182 MD048795
     O                N08      DTYP     242                                                 MD048795
     O                 08               242 'NT'                                            MD048795
1091 O                         ZERO15   258P                              S01182
1091 O                         ZERO15   266P                              S01182
1091 O***                               268 '  '                    S01182S01255
1091 O                         BOKC     268                               S01255
     O                         AKEY     351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                                  384 '                    '                            CGL020
     O                                  386 '  '                                              CGL020
     O                                  406 '                    '                            CGL020
     O                                  417 '           '                                     CGL020
     O                                  437 '                    '                            CGL020
     O                                  439 '  '                                              CGL020
     O                                  459 '                    '                            CGL020
     O                                  470 '           '                                     CGL020
     O                         BLNK35   505                                                   CGL020
     O                                  507 '  '                                              CGL020
     O                                  527 '                    '                            CGL020
     O                         ZERO5    530P                                                  CGL020
     O                                  540 '          '                                      CGL020
     O                                  560 '                    '                            CGL020
     O                         ZERO13   573                                                   CGL020
     O                         DLNO     605                                                   CGL029
     O                                  620 '               '                                 CGL029
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         ACODQQ    14                                                AR813358A
     O                         ACRAN     32                                                AR813358A
     O**********               TRAT      43                                       AR813358A MD020384
     O                                   43 '00000'                                         MD020384
     O                         ACUMZ    130                                                AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
      /COPY WNCPYSRC,DL0295OOPG
     O/SPACE                                                              S01100
     O*    SUSPENSE ENTRY TO CATER FOR IMBALANCE WITHIN BRANCH/CCY        S01100
     O*                                                    *** IMBAL  *** S01522
     OGEDLPD  EADD             IMBAL                                      S01100
     O                                    1 'P'                           S01100
     O*****                    BICN       7                        S01100 S01194
     O***********              A8BICN     7                        S01194 080603
     O                         BBICN      7                               080603
     O***********              ECCY      10                        S01100 S01460
     O***********      60      BJCYCD    10                        S01460 080603
     O***********     N60      ECCY      10                        S01460 080603
     O                         ECCY      10                               080603
     O*****                    COMS      14                        S01100 S01194
     O**********               BKACCD    14                                            S01194 CGL029
     O                         BKACCD   599                                                   CGL029
     O                                   16 '01'                          S01100
     O*****************U1      RUND      35P                       S01100 S01194
     O****************NU1      DNWD      35P                       S01100 S01194
     O*****************        RUND      38P                       S01100 S01194
     O*****************U1      BJRDNB    35P                        S01194E16457
     O****************NU1      BJDNWD    35P                        S01194E16457
     O                         BJRDNB    35P                              E16457
     O                         BJRDNB    38P                              S01194
     O***********                        60 'DEALING IMBALANCE'     S01100S01522
     O*****                    BRCD      64                        S01100 S01117
     O***********              BRCA      64                         S01117S01522
     O***********              ECCY      68                        S01100 S01460
     O***********      60      BJCYCD    68                        S01460 080603
     O***********     N60      ECCY      68                        S01460 080603
     O***********              ECCY      68                         080603S01522
     O*                                                                   S01522
     O                         O#PNAR    73                               S01522
     O*
     O                         BALSUS    80P                              S01100
     O                                   81 '0'                           S01100
     O                 39                81 '1'                           S01100
     O*******************      CNUM      87                         S01182039248
     O                                   87 '000000'                      CAC001
     O                                   95 '00000000'                                        CRE019
     O                                  102 'GE-DL'                       S01100
     O*****                    BRCD     105                        S01100 S01117
     O                         BRCA     105                               S01117
     O                         RINDS    106                               S01100
     O                         Z3       108P                              S01100
     O                         Z5       114P                              S01100
     O                         ATYPS    124                               S01100
     O/COPY WNCPYSRC,DL0295O017
     O                         PRIN     128                               S01100
     O                                  129 'D'                           S01100
1366 O                         PRFC     134                               S01182
     O                 54      FTPRFP   134                               CAC001
1367 O                                  140 '235959'                      S10736
1366 O                         VOIN     141                               S10736
1367 O                         ACSCS    146                               S10736
1366 O                         ZCMREF   176                               SO5452
1366 O                 78      SWCRD    176                               SO5452
1366 O*****                    DLREF    184                        SO5452 105222
1366 O*****                    FACO     194                        SO5452 105222
1366 O*****                    CNUM     200                        SO5452 105222
1366 O                                  200 '000000'                      105222
     O/COPY WNCPYSRC,DL0295O004
1366 O                 82      CHNA     200                               SO5452
     O/COPY WNCPYSRC,DL0295O005
1366 O*****                    DLNO     221                        S01182 105222
1366 O*****                             230 '         '            S01182 105222
1366 O*****                    SUBT     232                        S01182 105222
1366 O*****                             240 '        '             S01182 105222
1366 O*****                    DTYP     242                        S01182 105222
1366 O*****                             250 '        '             S01182 105222
1091 O                         ZERO15   258P                              S01182
1091 O                         ZERO15   266P                              S01182
1091 O                         BOKC     268                               S01182
     O                         AKEY     351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                                  384 '                    '                            CGL020
     O                                  386 '  '                                              CGL020
     O                                  406 '                    '                            CGL020
     O                                  417 '           '                                     CGL020
     O                                  437 '                    '                            CGL020
     O                                  439 '  '                                              CGL020
     O                                  459 '                    '                            CGL020
     O                                  470 '           '                                     CGL020
     O                         BLNK35   505                                                   CGL020
     O                                  507 '  '                                              CGL020
     O                                  527 '                    '                            CGL020
     O                         ZERO5    530P                                                  CGL020
     O                                  540 '          '                                      CGL020
     O                                  560 '                    '                            CGL020
     O                         ZERO13   573                                                   CGL020
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         ACODQQ    14                                                AR813358A
     O                         ACRAN     32                                                AR813358A
     O**********               TRAT      43                                       AR813358A MD020384
     O                                   43 '00000'                                         MD020384
     O                         ACUMZ    130                                                AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
      /COPY WNCPYSRC,DL0295OOP1                                           S01408
1368 O*
     O/SPACE                                                              S01460
     O*                                                                   S01460
     O*    GENERATED ENTRY.                                               S01460
      *************                                                       080603
     O********EADD*            NEWREC                              S01460 080603
     O*************                       1 'P'                    S01460 080603
     O*************            A8BICN     7                        S01460 080603
     O*************            CCYBOE    10                        S01460 080603
     O*************            ACNTCD    14                        S01460 080603
     O*************                      16 '01'                   S01460 080603
     O*************    38      ACRAN     32                        S01460 080603
     O*************            BJRDNB    35P                       S01460 080603
     O*************            EDAT      38P                       S01460 080603
     O*************    35 13   FFVD      38P                       S01460 080603
     O*************    35 15 89FFVD      38P                       S01460 080603
     O*************    35 28 89FFVD      38P                       S01460 080603
     O*************            TRAT      43                        S01460 080603
     O*************    88      BJRDNB    38P                       S01460 080603
     O*************   N41      ALDON     73                        S01460 080603
     O*************            DLNO      49                        S01460 080603
     O*************    41      BBCRNM    70                        S01460 080603
     O*************    42      OTHC      53                        S01460 080603
     O*************    43      OTHC      53                        S01460 080603
     O*************    43 27   OTHA      71 ' ,   ,   , 0 .   '    S01460 080603
     O*************    42 24   OTHA      71 ' ,   ,   ,   , 0 '    S01460 080603
     O*************    43 24   OTHA      71 ' ,   ,   ,   , 0 '    S01460 080603
     O*************    42 25   OTHA      71 '   ,   ,   , 0 . '    S01460 080603
     O*************    43 25   OTHA      71 '   ,   ,   , 0 . '    S01460 080603
     O*************    42 26   OTHA      71 '  ,   ,   , 0 .  '    S01460 080603
     O*************    43 26   OTHA      71 '  ,   ,   , 0 .  '    S01460 080603
     O*************    42 27   OTHA      71 ' ,   ,   , 0 .   '    S01460 080603
     O*************    44      DATE1     68                        S01460 080603
     O*************    45      DATE1     71                        S01460 080603
     O*************    46      DATE1     65                        S01460 080603
     O*************    47      DATE2     61                        S01460 080603
     O*************    47      DATE1     71                        S01460 080603
     O*************    48      DATE1     69                        S01460 080603
     O*************    49      YRAT  3   73                        S01460 080603
     O*************    50      DATE1     68                        S01460 080603
     O*************    51      DATE1     64                        S01460 080603
     O*************    53      DATE1     68                        S01460 080603
     O*************    55      DATE1     68                        S01460 080603
     O*************    57      INTR  3   71                        S01460 080603
     O*************    61      DATE1     65                        S01460 080603
     O*************    62      DATE1     72                        S01460 080603
     O*************    63      DATE1     65                        S01460 080603
     O*************    64      DATE2     61                        S01460 080603
     O*************    64      DATE1     71                        S01460 080603
     O*************    65      DATE1     70                        S01460 080603
     O*************   N19                73 '*'                    S01460 080603
     O*************       88             58 'DEALING ACCRUAL'      S01460 080603
     O*************       88             73 ' SUMMARY       '      S01460 080603
     O*************            PSTAMT    80P                       S01460 080603
     O*************            DEBCRD    81                        S01460 080603
     O*************            CNUM      87                        S01460 080603
     O*************            CHQNZ     95                        S01460 080603
     O*************                     102 'GE-DL'                S01460 080603
     O*************            BRCA     105                        S01460 080603
     O*************            RETIND   106                        S01460 080603
     O*************            Z3       108P                       S01460 080603
     O*************            Z5       114P                       S01460 080603
     O*************   N29      RRNM     114P                       S01460 080603
     O*************            ACNTYP   124                        S01460 080603
     O*************            PRIN     128                        S01460 080603
     O*************                     129 'D'                    S01460 080603
     O*************            ACUMZ    130                        S01460 080603
     O*************            CHGAZ    160P                       S01460 080603
     O*************            PRFC     134                        S01460 080603
     O*************            ZCMREF   176                        S01460 080603
     O*************    78      SWCRD    176                        S01460 080603
     O*************            DLREF    184                        S01460 080603
     O*************            FACO     194                        S01460 080603
     O*************            CNUM     200                        S01460 080603
     O*************    82      CHNA     200                        S01460 080603
     O*************            DLNO     224                        S01460 080603
     O*************                     233 '         '            S01460 080603
     O*************            SUBT     235                        S01460 080603
     O*************                     243 '        '             S01460 080603
     O*************            DTYP     245                        S01460 080603
     O*************                     253 '        '             S01460 080603
     O*************            ZERO15   261P                       S01460 080603
     O*************            ZERO15   269P                       S01460 080603
     O*************            BOKC     271                        S01460 080603
     O*************            DLNO     221                        S01460 080603
     O*************                     230 '         '            S01460 080603
     O*************            SUBT     232                        S01460 080603
     O*************                     240 '        '             S01460 080603
     O*************            DTYP     242                        S01460 080603
     O*************                     250 '        '             S01460 080603
     O*************            ZERO15   258P                       S01460 080603
     O*************            ZERO15   266P                       S01460 080603
     O*************            BOKC     268                        S01460 080603
     O*                                                    *** NEWREC *** S01522
     O        EADD             NEWREC                                     080603
     O                                    1 'P'                           080603
     O**********               ACCK      16                                            080603 CGL029
     O                         ACCNM      7                                                   CGL029
     O                         ACCCY     10                                                   CGL029
     O                         ACACS     16                                                   CGL029
     O                         ACACD    599                                                   CGL029
     O                         ACRAN     32                               080603
     O********                 BJRDNB    35P                              080603 CRE009
     O                         WDATE     35P                                     CRE009
     O                         EDAT      38P                              080603
     O                         TRAT      43                               080603
     O***********              ITAXN     73                         080603S01522
     O***********              DLNO      49                         080603S01522
     O***********     N19                73 '*'                     080603S01522
     O*                                                                   S01522
     O                         O#PNAR    73                               S01522
     O*                                                                   S01522
     O/COPY WNCPYSRC,DLH00136
     O                         PSTA      80P                              080603
     O                N39                81 '0'                           080603
     O                 39                81 '1'                           080603
     O/COPY WNCPYSRC,DL0295O025
     O                         CNUM      87                               080603
     O/COPY WNCPYSRC,DL0295O026
     O                                   95 '00000000'                                        CRE019
     O                                  102 'GE-DL'                       080603
     O                         BRCA     105                               080603
     O                         RINDA    106                               080603
     O                         Z3       108P                              080603
     O                         Z5       114P                              080603
     O                         RRNM     114P                              080603
     O                         ATYPA    124                               080603
     O/COPY WNCPYSRC,DL0295O018
     O                         PRIN     128                               080603
     O                                  129 'D'                           080603
     O                         PRFC     134                               080603
     O                 71      DSFPPC   134                               CAC001
     O                                  140 '235959'                      080603
     O                         VOIN     141                               080603
     O                         ACSCA    146                               080603
     O                         DLREF    184                               080603
     O/COPY WNCPYSRC,DL0295O006
     O                         CNUM     200                               080603
     O/COPY WNCPYSRC,DL0295O007
     O**********               DLNO     221                                            080603 CGL029
     O                                  230 '         '                   080603
     O                         SUBT     232                               080603
     O                                  240 '        '                    080603
     O**********               DTYP     242                                          080603 MD048795
     O                N08      DTYP     242                                                 MD048795
     O                 08               242 'NT'                                            MD048795
     O                                  250 '        '                    080603
     O                         ZERO15   258P                              080603
     O                         ZERO15   266P                              080603
     O                         BOKC     268                               080603
     O                         AKEY     351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                                  384 '                    '                            CGL020
     O                                  386 '  '                                              CGL020
     O                                  406 '                    '                            CGL020
     O                                  417 '           '                                     CGL020
     O                                  437 '                    '                            CGL020
     O                                  439 '  '                                              CGL020
     O                                  459 '                    '                            CGL020
     O                                  470 '           '                                     CGL020
     O                         BLNK35   505                                                   CGL020
     O                                  507 '  '                                              CGL020
     O                                  527 '                    '                            CGL020
     O                         ZERO5    530P                                                  CGL020
     O                                  540 '          '                                      CGL020
     O                                  560 '                    '                            CGL020
     O                         ZERO13   573                                                   CGL020
     O                         DLNO     605                                                   CGL029
     O                                  620 '               '                                 CGL029
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         ACODQQ    14                                                AR813358A
     O                         ACUMZ    130                                                AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
      /COPY WNCPYSRC,DL0295OOP2
1369 O*    GENERATED ENTRY.
1370 O********EADD     12                                                 S01354
1370 O********EADD     12N11                                        S01354S01522
     O        EADD             GENENT                                     S01522
1371 O                                    1 'P'
1372 O                 29                 1 '*'
1373 O*****            35      ACCKEY    16                               S01117
1373 O**********       35      ACCK      16                                            S01117 CGL029
     O                 35      ACCNM      7                                                   CGL029
     O                 35      ACCCY     10                                                   CGL029
     O                 35      ACACS     16                                                   CGL029
     O                 35      ACACD    599                                                   CGL029
1374 O*****            34      BICN       7                               S01117
1374 O                 34      BBICN      7                               S01117
     O/COPY WNCPYSRC,DL0295O008
1375 O                 36      CNUM       7
     O/COPY WNCPYSRC,DL0295O009
1376 O***********              ECCY      10                               S01460
     O***********      60      BJCYCD    10                        S01460 080603
     O***********     N60      ECCY      10                        S01460 080603
     O                         ACCCY     10                               080603
1377 O**********       34      ACOD,N    14                                                   CGL029
1378 O**********       36      ACOD,N    14                                                   CGL029
     O                 34      ACOD,N   599                                                   CGL029
     O                 36      ACOD,N   599                                                   CGL029
     O/COPY WNCPYSRC,DL0295O001
1379 O**********       34                16 '01'                                              CER049
     O                 34      ASQ,N     16                                                   CER049
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0295OOP8                                           S01408
     O*                                                                   S01408
1380 O                 36      ACSQD     16
     O/COPY WNCPYSRC,DL0295O034
1381 O                 35 28   RACNM      7
1382 O**********       35 28   RAACD     14                                                   CGL029
     O                 35 28   RAACD    599                                                   CGL029
1383 O                 35 28   RAACS     16
1384 O                 33                 7 '000000'
1385 O                 33                16 '000000'
     O                                   32 '0000000000'                                   AR813358A
     O                 38      ACRAN     32
1348 O*****            U1      RUND      35P                              S01194
1348 O*****           NU1      DNWD      35P                              S01194
1348 O*****************U1      BJRDNB    35P                        S01194E16457
1348 O****************NU1      BJDNWD    35P                        S01194E16457
1348 O********                 BJRDNB    35P                              E16457 CRE009
1348 O                         WDATE     35P                                     CRE009
1390 O                         EDAT      38P
1391 O                 35 13   FFVD      38P
1392 O                 35 15 89FFVD      38P
1393 O                 35 28 89FFVD      38P
1393 O                         TRAT      43                               E43407
     O*****            88      RUND      38P                       S01103 S01194
     O*****************88      BJRDNB    38P                       S01194 237509
     O                 88      BKAPDT    38P                              237509
     O*                                                                   S01522
1394 O*****           N41      NARD      73
1394 O***********     N41      ALDON     73                               S01522
1395 O***********              DLNO      49                               S01522
1396 O*****            41      CRNM      70                               S01194
1396 O***********      41      BBCRNM    70                               S01194
1397 O***********      42      OTHC      53                               S01522
1398 O***********      43      OTHC      53                               S01522
1399 O***********      43 27   OTHA      71 ' ,   ,   , 0 .   '           S01522
1400 O***********      42 24   OTHA      71 ' ,   ,   ,   , 0 '           S01522
1401 O***********      43 24   OTHA      71 ' ,   ,   ,   , 0 '           S01522
1402 O***********      42 25   OTHA      71 '   ,   ,   , 0 . '           S01522
1403 O***********      43 25   OTHA      71 '   ,   ,   , 0 . '           S01522
1404 O***********      42 26   OTHA      71 '  ,   ,   , 0 .  '           S01522
1405 O***********      43 26   OTHA      71 '  ,   ,   , 0 .  '           S01522
1406 O***********      42 27   OTHA      71 ' ,   ,   , 0 .   '           S01522
1407 O***********      44      DATE1     68                               S01522
1408 O***********      45      DATE1     71                               S01522
1409 O***********      46      DATE1     65                               S01522
1410 O***********      47      DATE2     61                               S01522
1411 O***********      47      DATE1     73                               S01522
1412 O***********      48      DATE1     69                               S01522
1413 O***********      49      YRAT  3   73                               S01522
1414 O***********      50      DATE1     68                               S01522
1415 O***********      51      DATE1     64                               S01522
1416 O***********      53      DATE1     68                               S01522
1417 O***********      55      DATE1     68                               S01522
1418 O***********      57      INTR  3   71                               S01522
1419 O***********      61      DATE1     65                               S01522
1420 O***********      62      DATE1     72                               S01522
1421 O***********      63      DATE1     65                               S01522
1422 O***********      64      DATE2     61                               S01522
1423 O***********      64      DATE1     73                               S01522
1424 O***********      65      DATE1     70                               S01522
     O***********      67      RBDN      49                        S01434 080603
     O***********      67      DLNO      72                        S01434 080603
     O***********      66      RBDN      49                         080603S01522
     O***********      66      DLNO      73                         080603S01522
1425 O***********     N19                73 '*'                           S01522
     O***********         88             58 'DEALING ACCRUAL'       S01103S01522
     O***********         88             73 ' SUMMARY       '       S01103S01522
     O*                                                                   S01522
     O                         O#PNAR    73                               S01522
     O/COPY WNCPYSRC,DLH00154
     O*                                                                   S01522
1426 O***********              EAMT      80P                              S01460
     O***********         60   BEAMT     80P                       S01460 080603
     O***********        N60   EAMT      80P                       S01460 080603
1357 O                         PSTA      80P                              080603
     O                    88   ACRLSM    80P                              S01103
1427 O                                   81 '0'
1428 O                 39                81 '1'
     O/COPY WNCPYSRC,DL0295O027
     O                         CNUM      87                               S01182
     O/COPY WNCPYSRC,DL0295O028
     O                                   95 '00000000'                                        CRE019
1429 O                                  102 'GE-DL'
1430 O*****                    BRCD     105                               S01117
1430 O                         BRCA     105                               S01117
     O                 70 35 12BRCDA    105
     O                 07 35   NTOSBR   105                               CDL002
1431 O                         RINDA    106
1432 O                         Z3       108P
1433 O                         Z5       114P
1434 O                N29      RRNM     114P
1435 O                         ATYPA    124
     O/COPY WNCPYSRC,DL0295O019
1436 O                         PRIN     128
1437 O                                  129 'D'
1367 O                         PRFC     134                               S01117
     O                 56N29   PRFCA    134                               CAC001
     O                N56 58   FTPRFP   134                               CAC001
     O                 71      DSFPPC   134                               CAC001
1367 O                                  140 '235959'                      S10736
     O                         VOIN     141                               S10736
     O                         ACSCA    146                               S10736
     O***********              RVDL     149                         E25203S10736
1366 O                         ZCMREF   176                               SO5452
1366 O                 78      SWCRD    176                               SO5452
1366 O                         DLREF    184                               SO5452
1366 O                         FACO     194                               SO5452
1366 O                         CNUM     200                               SO5452
     O/COPY WNCPYSRC,DL0295O010
1366 O                 82      CHNA     200                               SO5452
     O/COPY WNCPYSRC,DL0295O011
1366 O**********               DLNO     221                                            S01182 CGL029
1366 O                                  230 '         '                   S01182
1366 O                         SUBT     232                               S01182
1366 O                                  240 '        '                    S01182
1366 O**********               DTYP     242                                          S01182 MD048795
     O                N08      DTYP     242                                                 MD048795
     O                 08               242 'NT'                                            MD048795
1366 O                                  250 '        '                    S01182
1091 O                         ZERO15   258P                              S01182
1091 O                         ZERO15   266P                              S01182
1091 O                         BOKC     268                               S01182
     O                         AKEY     351                                                   CGL020
     O                 35      F1FFLG   352                                                   CGL020
     O                 35      F1FVAL   359P                                                  CGL020
     O                 35      F1FPCT   364                                                   CGL020
     O                 35      F1RACT   384                                                   CGL020
     O                 35      F1RCTY   386                                                   CGL020
     O                 35      F1RBNK   406                                                   CGL020
     O                 35      F1RCDE   417                                                   CGL020
     O                 35      F1PACT   437                                                   CGL020
     O                 35      F1PCTY   439                                                   CGL020
     O                 35      F1PBNK   459                                                   CGL020
     O                 35      F1PCDE   470                                                   CGL020
     O                 35      F1DACT   505                                                   CGL020
     O                 35      F1DCTY   507                                                   CGL020
     O                 35      F1DBNK   527                                                   CGL020
     O                 35      F1SDAT   530P                                                  CGL020
     O                N35               352 ' '                                               CGL020
     O                N35      ZERO13   359P                                                  CGL020
     O                N35      ZERO5    364                                                   CGL020
     O                N35               384 '                    '                            CGL020
     O                N35               386 '  '                                              CGL020
     O                N35               406 '                    '                            CGL020
     O                N35               417 '           '                                     CGL020
     O                N35               437 '                    '                            CGL020
     O                N35               439 '  '                                              CGL020
     O                N35               459 '                    '                            CGL020
     O                N35               470 '           '                                     CGL020
     O                N35      BLNK35   505                                                   CGL020
     O                N35               507 '  '                                              CGL020
     O                N35               527 '                    '                            CGL020
     O                N35      ZERO5    530P                                                  CGL020
     O                                  540 '          '                                      CGL020
     O                                  560 '                    '                            CGL020
     O                         ZERO13   573                                                   CGL020
     O                         DLNO     605                                                   CGL029
     O                                  620 '               '                                 CGL029
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         ACODQQ    14                                                AR813358A
     O                         ACUMZ    130                                                AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
      /COPY WNCPYSRC,DL0295OOP3
     O*  BOOKING BRANCH POSTING                                           S01117
     O******* EADD     70 35 12                                           S01522
     O****** AND       77                                                 S01522
     O        EADD             BOOKBR                                     S01522
     O                                    1 'P'
     O*****                    BICN       7                               S01117
     O                         OBICN      7                               S01117
     O***********              ECCY      10                               S01460
     O***********      60      BJCYCD    10                        S01460 080603
     O***********     N60      ECCY      10                        S01460 080603
     O***********              ECCY      10                        080603 CEU003
     O                         ACCCY     10                               CEU003
     O*****                    IBAB      14                               S01117
     O**********       69      BADTO     14                                            S01117 CGL029
     O**********      N69      BADFR     14                                            S01117 CGL029
     O                 69      BADTO    599                                                   CGL029
     O                N69      BADFR    599                                                   CGL029
     O                                   16 '01'
     O                                   32 '0000000000'
     O*****                    RUND      35P                              S01194
     O********                 BJRDNB    35P                              S01194 CRE009
     O                         WDATE     35P                                     CRE009
     O                         EDAT      38P
     O                    35 13FFVD      38P
     O*****           N41      NARD      73                               S01194
     O***********     N41      ALDON     73                         S01194S01522
     O***********              DLNO      49                               S01522
     O*****            41      CRNM      70                               S01194
     O***********      41      BBCRNM    70                               S01194
     O***********      42      OTHC      53                               S01522
     O***********      43      OTHC      53                               S01522
     O***********      43 27   OTHA      71 ' ,   ,   , 0 .   '           S01522
     O***********      42 24   OTHA      71 ' ,   ,   ,   , 0 '           S01522
     O***********      42 24   OTHA      71 ' ,   ,   ,   , 0 '           S01522
     O***********      43 24   OTHA      71 ' ,   ,   ,   , 0 '           S01522
     O***********      42 25   OTHA      71 '   ,   ,   , 0 . '           S01522
     O***********      43 25   OTHA      71 '   ,   ,   , 0 . '           S01522
     O***********      42 26   OTHA      71 '  ,   ,   , 0 .  '           S01522
     O***********      43 26   OTHA      71 '  ,   ,   , 0 .  '           S01522
     O***********      42 27   OTHA      71 ' ,   ,   , 0 .   '           S01522
     O***********      44      DATE1     68                               S01522
     O***********      45      DATE1     71                               S01522
     O***********      46      DATE1     65                               S01522
     O***********      47      DATE2     61                               S01522
     O***********      47      DATE1     73                               S01522
     O***********      48      DATE1     69                               S01522
     O***********      49      YRAT  3   73                               S01522
     O***********      50      DATE1     68                               S01522
     O***********      51      DATE1     64                               S01522
     O***********      53      DATE1     68                               S01522
     O***********      55      DATE1     68                               S01522
     O***********      57      INTR  3   71                               S01522
     O***********      61      DATE1     65                               S01522
     O***********      62      DATE1     72                               S01522
     O***********      63      DATE1     65                               S01522
     O***********      64      DATE2     61                               S01522
     O***********      64      DATE1     73                               S01522
     O***********      65      DATE1     70                               S01522
     O***********      67      RBDN      49                        S01434 080603
     O***********      67      DLNO      72                        S01434 080603
     O***********      66      RBDN      49                         080603S01522
     O***********      66      DLNO      73                         080603S01522
     O***********     N19                73 '*'                           S01522
     O*                                                                   S01522
     O                         O#PNAR    73                               S01522
     O*
     O***********              EAMT      80P                              S01460
     O***********      60      BEAMT     80P                       S01460 080603
     O***********     N60      EAMT      80P                       S01460 080603
     O***********              EAMT      80P                       080603 134907
     O                         PSTA      80P                              134907
     O                                   81 '0'
     O                       39          81 '1'
     O/COPY WNCPYSRC,DL0295O029
     O                         CNUM      87                               S01182
     O/COPY WNCPYSRC,DL0295O030
     O                                   95 '00000000'                                        CRE019
     O                                  102 'GE-DL'
     O*****                    BRCD     105                               S01117
     O                         BRCA     105                               S01117
     O*****                    BRINDA   106                               S01117
     O                 39      BRINTO   106                               S01117
     O                N39      BRINFR   106                               S01117
     O                         Z3       108P
     O                         Z5       114P
     O*****                    BATYP    124                               S01117
     O                 39      BTYPTO   124                               S01117
     O                N39      BTYPFR   124                               S01117
     O/COPY WNCPYSRC,DL0295O020
     O                         PRIN     128
     O                                  129 'D'
1367 O                         PRFC     134                               S01117
     O                 54      FTPRFP   134                               CAC001
1367 O                                  140 '235959'                      S10736
1367 O                         VOIN     141                               S10736
     O                 39      BACSCO   146                               S10736
     O                N39      BACSCR   146                               S10736
1366 O                         ZCMREF   176                               SO5452
1366 O                 78      SWCRD    176                               SO5452
1366 O                         DLREF    184                               SO5452
1366 O                         FACO     194                               SO5452
1366 O                         CNUM     200                               SO5452
     O/COPY WNCPYSRC,DL0295O012
1366 O                 82      CHNA     200                               SO5452
     O/COPY WNCPYSRC,DL0295O013
     O**********               DLNO     221                                            S01182 CGL029
1366 O                                  230 '         '                   S01182
1366 O                         SUBT     232                               S01182
1366 O                                  240 '        '                    S01182
1366 O**********               DTYP     242                                          S01182 MD048795
     O                N08      DTYP     242                                                 MD048795
     O                 08               242 'NT'                                            MD048795
1366 O                                  250 '        '                    S01182
1091 O                         ZERO15   258P                              S01182
1091 O                         ZERO15   266P                              S01182
1091 O                         BOKC     268                               S01182
     O                         AKEY     351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                                  384 '                    '                            CGL020
     O                                  386 '  '                                              CGL020
     O                                  406 '                    '                            CGL020
     O                                  417 '           '                                     CGL020
     O                                  437 '                    '                            CGL020
     O                                  439 '  '                                              CGL020
     O                                  459 '                    '                            CGL020
     O                                  470 '           '                                     CGL020
     O                         BLNK35   505                                                   CGL020
     O                                  507 '  '                                              CGL020
     O                                  527 '                    '                            CGL020
     O                         ZERO5    530P                                                  CGL020
     O                                  540 '          '                                      CGL020
     O                                  560 '                    '                            CGL020
     O                         ZERO13   573                                                   CGL020
     O                         DLNO     605                                                   CGL029
     O                                  620 '               '                                 CGL029
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         ACODQQ    14                                                AR813358A
     O**********               TRAT      43                                       AR813358A MD020384
     O                                   43 '00000'                                         MD020384
     O                         ACUMZ    130                                                AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
      /COPY WNCPYSRC,DL0295OOP4                                           S01408
     O*                                                                                       222171
     O*  BOOKING BRANCH POSTING IF via main branch                                            222171
     O        EADD             BOOKMB                                                         222171
     O                                    1 'P'                                               222171
     O                         BBICN      7                                                   222171
     O                         ACCCY     10                                                   222171
     O                                   16 '01'                                              222171
     O                                   32 '0000000000'                                      222171
     O                         BJRDNB    35P                                                  222171
     O                         EDAT      38P                                                  222171
     O                    35 13FFVD      38P                                                  222171
     O                         O#PNAR    73                                                   222171
     O                         PSTA      80P                                                  222171
     O                       39          81 '0'                                               222171
     O                      N39          81 '1'                                               222171
     O                         CNUM      87                                                   222171
     O                                   95 '00000000'                                        222171
     O                                  102 'GE-DL'                                           222171
     O                         BKMABR   105                                                   222171
     O                 39      BRINTO   106                                                   222171
     O                N39      BRINFR   106                                                   222171
     O                         Z3       108P                                                  222171
     O                         Z5       114P                                                  222171
     O                 39      BTYPTO   124                                                   222171
     O                N39      BTYPFR   124                                                   222171
     O                         PRIN     128                                                   222171
     O                                  129 'D'                                               222171
     O                         PRFC     134                                                   222171
     O                                  140 '235959'                                          222171
     O                         VOIN     141                                                   222171
     O                 39      BACSCO   146                                                   222171
     O                N39      BACSCR   146                                                   222171
     O                         ZCMREF   176                                                   222171
     O                 78      SWCRD    176                                                   222171
     O                         DLREF    184                                                   222171
     O                         FACO     194                                                   222171
     O                         CNUM     200                                                   222171
     O                 82      CHNA     200                                                   222171
     O                         DLNO     221                                                   222171
     O                                  230 '         '                                       222171
     O                         SUBT     232                                                   222171
     O                                  240 '        '                                        222171
     O**********               DTYP     242                                          222171 MD048795
     O                N08      DTYP     242                                                 MD048795
     O                 08               242 'NT'                                            MD048795
     O                                  250 '        '                                        222171
     O                         ZERO15   258P                                                  222171
     O                         ZERO15   266P                                                  222171
     O                         BOKC     268                                                   222171
     O                         AKEY     351                                                   222171
     O                                  352 ' '                                               222171
     O                         ZERO13   359P                                                  222171
     O                         ZERO5    364                                                   222171
     O                                  384 '                    '                            222171
     O                                  386 '  '                                              222171
     O                                  406 '                    '                            222171
     O                                  417 '           '                                     222171
     O                                  437 '                    '                            222171
     O                                  439 '  '                                              222171
     O                                  459 '                    '                            222171
     O                                  470 '           '                                     222171
     O                         BLNK35   505                                                   222171
     O                                  507 '  '                                              222171
     O                                  527 '                    '                            222171
     O                         ZERO5    530P                                                  222171
     O                                  540 '          '                                      222171
     O                                  560 '                    '                            222171
     O                         ZERO13   573                                                   222171
     O                N69      @@DTAC   599                                                   222171
     O                 69      @@DFAC   599                                                   222171
     O                         DLNO     605                                                   222171
     O                                  620 '               '                                 222171
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         ACODQQ    14                                                AR813358A
     O**********               TRAT      43                                       AR813358A MD020384
     O                                   43 '00000'                                         MD020384
     O                         ACUMZ    130                                                AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
     O*
     O*  SETT A/C BRANCH POSTING                                          S01117
     O******* EADD     70 35 12                                           S01522
     O*******AND**     77                                                 E38199
     O****** AND       77N11                                        E38199S01522
     O        EADD             SETTAC                                     S01522
     O                                    1 'P'
     O*****                    BICNA      7                               S01117
     O                         BBICN      7                               S01117
     O***********              ECCY      10                               S01460
     O***********      60      BJCYCD    10                        S01460 080603
     O***********     N60      ECCY      10                        S01460 080603
     O***********              ECCY      10                        080603 CEU003
     O                         ACCCY     10                               CEU003
     O*****                    IBAH      14                               S01117
     O**********       69      OADFR     14                                            S01117 CGL029
     O**********      N69      OADTO     14                                            S01117 CGL029
     O                 69      OADFR    599                                                   CGL029
     O                N69      OADTO    599                                                   CGL029
     O                                   16 '01'
     O                                   32 '0000000000'
     O*****                    RUND      35P                              S01194
     O********                 BJRDNB    35P                              S01194 CRE009
     O                         WDATE     35P                                     CRE009
     O                         EDAT      38P
     O                    35 13FFVD      38P
     O*
     O*****           N41      NARD      73                               S01194
     O***********     N41      ALDON     73                         S01194S01522
     O***********              DLNO      49                               S01522
     O*****            41      CRNM      70                               S01194
     O***********      41      BBCRNM    70                         S01194S01522
     O***********      42      OTHC      53                               S01522
     O***********      43      OTHC      53                               S01522
     O***********      43 27   OTHA      71 ' ,   ,   , 0 .   '           S01522
     O***********      42 24   OTHA      71 ' ,   ,   ,   , 0 '           S01522
     O***********      43 24   OTHA      71 ' ,   ,   ,   , 0 '           S01522
     O***********      42 25   OTHA      71 '   ,   ,   , 0 . '           S01522
     O***********      43 25   OTHA      71 '   ,   ,   , 0 . '           S01522
     O***********      42 26   OTHA      71 '  ,   ,   , 0 .  '           S01522
     O***********      43 26   OTHA      71 '  ,   ,   , 0 .  '           S01522
     O***********      42 27   OTHA      71 ' ,   ,   , 0 .   '           S01522
     O***********      44      DATE1     68                               S01522
     O***********      45      DATE1     71                               S01522
     O***********      46      DATE1     65                               S01522
     O***********      47      DATE2     61                               S01522
     O***********      47      DATE1     73                               S01522
     O***********      48      DATE1     69                               S01522
     O***********      49      YRAT  3   73                               S01522
     O***********      50      DATE1     68                               S01522
     O***********      51      DATE1     64                               S01522
     O***********      53      DATE1     68                               S01522
     O***********      55      DATE1     68                               S01522
     O***********      57      INTR  3   71                               S01522
     O***********      61      DATE1     65                               S01522
     O***********      62      DATE1     72                               S01522
     O***********      63      DATE1     65                               S01522
     O***********      64      DATE2     61                               S01522
     O***********      64      DATE1     73                               S01522
     O***********      65      DATE1     70                               S01522
     O***********      67      RBDN      49                        S01434 080603
     O***********      67      DLNO      72                        S01434 080603
     O***********      66      RBDN      49                         080603S01522
     O***********      66      DLNO      73                         080603S01522
     O***********     N19                73 '*'                           S01522
     O*                                                                   S01522
     O                         O#PNAR    73                               S01522
     O*                                                                   S01522
     O***********              EAMT      80P                              134907
     O                         PSTA      80P                              134907
     O                                   81 '1'
     O                       39          81 '0'
     O/COPY WNCPYSRC,DL0295O031
     O                         CNUM      87                               S01182
     O/COPY WNCPYSRC,DL0295O032
     O                                   95 '00000000'                                        CRE019
     O                                  102 'GE-DL'
     O*****                    BRCDA    105                               S01117
     O                         OSBR     105                               S01117
     O*****                    HRINDA   106                               S01117
     O                 39      ORINFR   106                               S01117
     O                N39      ORINTO   106                               S01117
     O                         Z3       108P
     O                         Z5       114P
     O*****                    HATYP    124                               S01117
     O                 39      OTYPFR   124                               S01117
     O                N39      OTYPTO   124                               S01117
     O/COPY WNCPYSRC,DL0295O021
     O                         PRIN     128
     O                                  129 'D'
1367 O                         PRFC     134                               S01117
     O                 54      FTPRFP   134                               CAC001
1367 O                                  140 '235959'                      S10736
1367 O                         VOIN     141                               S10736
     O                 39      OACSCR   146                               S10736
     O                N39      OACSCO   146                               S10736
1366 O                         ZCMREF   176                               SO5452
1366 O                 78      SWCRD    176                               SO5452
1366 O                         DLREF    184                               SO5452
1366 O                         FACO     194                               SO5452
1366 O                         CNUM     200                               SO5452
     O/COPY WNCPYSRC,DL0295O014
1366 O                 82      CHNA     200                               SO5452
     O/COPY WNCPYSRC,DL0295O015
1366 O**********               DLNO     221                                            S01182 CGL029
1366 O                                  230 '         '                   S01182
1366 O                         SUBT     232                               S01182
1366 O                                  240 '        '                    S01182
1366 O**********               DTYP     242                                          S01182 MD048795
     O                N08      DTYP     242                                                 MD048795
     O                 08               242 'NT'                                            MD048795
1366 O                                  250 '        '                    S01182
1091 O                         ZERO15   258P                              S01182
1091 O                         ZERO15   266P                              S01182
1091 O                         BOKC     268                               S01182
     O                         AKEY     351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                                  384 '                    '                            CGL020
     O                                  386 '  '                                              CGL020
     O                                  406 '                    '                            CGL020
     O                                  417 '           '                                     CGL020
     O                                  437 '                    '                            CGL020
     O                                  439 '  '                                              CGL020
     O                                  459 '                    '                            CGL020
     O                                  470 '           '                                     CGL020
     O                         BLNK35   505                                                   CGL020
     O                                  507 '  '                                              CGL020
     O                                  527 '                    '                            CGL020
     O                         ZERO5    530P                                                  CGL020
     O                                  540 '          '                                      CGL020
     O                                  560 '                    '                            CGL020
     O                         ZERO13   573                                                   CGL020
     O                         DLNO     605                                                   CGL029
     O                                  620 '               '                                 CGL029
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         ACODQQ    14                                                AR813358A
     O**********               TRAT      43                                       AR813358A MD020384
     O                                   43 '00000'                                         MD020384
     O                         ACUMZ    130                                                AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
      *                                                                                       222171
     O*  SETT A/C BRANCH POSTING via main branch                                              222171
     O        EADD             SETTMB                                                         222171
     O                                    1 'P'                                               222171
     O                         OBICN      7                                                   222171
     O                         ACCCY     10                                                   222171
     O                                   16 '01'                                              222171
     O                                   32 '0000000000'                                      222171
     O                         BJRDNB    35P                                                  222171
     O                         EDAT      38P                                                  222171
     O                    35 13FFVD      38P                                                  222171
     O                         O#PNAR    73                                                   222171
     O                         PSTA      80P                                                  222171
     O                       39          81 '1'                                               222171
     O                      N39          81 '0'                                               222171
     O                         CNUM      87                                                   222171
     O                                   95 '00000000'                                        243929
     O                                  102 'GE-DL'                                           222171
     O                         BKMABR   105                                                   222171
     O                 39      ORINFR   106                                                   222171
     O                N39      ORINTO   106                                                   222171
     O                         Z3       108P                                                  222171
     O                         Z5       114P                                                  222171
     O                 39      OTYPFR   124                                                   222171
     O                N39      OTYPTO   124                                                   222171
     O                         PRIN     128                                                   222171
     O                                  129 'D'                                               222171
     O                         PRFC     134                                                   222171
     O                                  140 '235959'                                          222171
     O                         VOIN     141                                                   222171
     O                 39      OACSCR   146                                                   222171
     O                N39      OACSCO   146                                                   222171
     O                         ZCMREF   176                                                   222171
     O                 78      SWCRD    176                                                   222171
     O                         DLREF    184                                                   222171
     O                         FACO     194                                                   222171
     O                         CNUM     200                                                   222171
     O                 82      CHNA     200                                                   222171
     O                         DLNO     221                                                   222171
     O                                  230 '         '                                       222171
     O                         SUBT     232                                                   222171
     O                                  240 '        '                                        222171
     O**********               DTYP     242                                          222171 MD048795
     O                N08      DTYP     242                                                 MD048795
     O                 08               242 'NT'                                            MD048795
     O                                  250 '        '                                        222171
     O                         ZERO15   258P                                                  222171
     O                         ZERO15   266P                                                  222171
     O                         BOKC     268                                                   222171
     O                         AKEY     351                                                   222171
     O                                  352 ' '                                               222171
     O                         ZERO13   359P                                                  222171
     O                         ZERO5    364                                                   222171
     O                                  384 '                    '                            222171
     O                                  386 '  '                                              222171
     O                                  406 '                    '                            222171
     O                                  417 '           '                                     222171
     O                                  437 '                    '                            222171
     O                                  439 '  '                                              222171
     O                                  459 '                    '                            222171
     O                                  470 '           '                                     222171
     O                         BLNK35   505                                                   222171
     O                                  507 '  '                                              222171
     O                                  527 '                    '                            222171
     O                         ZERO5    530P                                                  222171
     O                                  540 '          '                                      222171
     O                                  560 '                    '                            222171
     O                         ZERO13   573                                                   222171
     O                N69      @@DFAC   599                                                   222171
     O                 69      @@DTAC   599                                                   222171
     O                         DLNO     605                                                   222171
     O                                  620 '               '                                 222171
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         ACODQQ    14                                                AR813358A
     O**********               TRAT      43                                       AR813358A MD020384
     O                                   43 '00000'                                         MD020384
     O                         ACUMZ    130                                                AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
      /COPY WNCPYSRC,DL0295OOP5
     OGEDLPD  EADD             SETCUR                                     CEU003
     O                                    1 'P'                           CEU003
     O**********               ACCK      16                                            CEU003 CGL029
     O                         ACCNM      7                                                   CGL029
     O                         ACCCY     10                                                   CGL029
     O                         ACACS     16                                                   CGL029
     O                         ACACD    599                                                   CGL029
     O                         ACRAN     32                               CEU003
     O************************ BJRDNB    35P                        CEU003CRE009
     O                         WDATE     35P                              CRE009
     O                         EDAT      38P                              CEU003
     O                         TRAT      43                               CEU003
     O                         O#PNAR    73                               CEU003
     O                         PSTA      80P                              CEU003
     O                N39                81 '0'                           CEU003
     O                 39                81 '1'                           CEU003
     O                         CNUM      87                               CEU003
     O                                   95 '00000000'                                        CRE019
     O                                  102 'GE-DL'                       CEU003
     O                         BRCA     105                               CEU003
     O                         RINDA    106                               CEU003
     O                         Z3       108P                              CEU003
     O                         RRNM     114P                              CEU003
     O                         ATYPA    124                               CEU003
     O/COPY WNCPYSRC,DL0295O022
     O                         PRIN     128                               CEU003
     O                                  129 'D'                           CEU003
     O                         PRFC     134                               CEU003
     O                                  140 '235959'                      CEU003
     O                         VOIN     141                               CEU003
     O                         ACSCA    146                               CEU003
     O                         DLREF    184                               CEU003
     O                         CNUM     200                               CEU003
     O**********               DLNO     221                                            CEU003 CGL029
     O                                  230 '         '                   CEU003
     O                         SUBT     232                               CEU003
     O                                  240 '        '                    CEU003
     O**********               DTYP     242                                          CEU003 MD048795
     O                N08      DTYP     242                                                 MD048795
     O                 08               242 'NT'                                            MD048795
     O                                  250 '        '                    CEU003
     O                         ZERO15   258P                              CEU003
     O                         ZERO15   266P                              CEU003
     O                         BOKC     268                               CEU003
     O                         AKEY     351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                                  384 '                    '                            CGL020
     O                                  386 '  '                                              CGL020
     O                                  406 '                    '                            CGL020
     O                                  417 '           '                                     CGL020
     O                                  437 '                    '                            CGL020
     O                                  439 '  '                                              CGL020
     O                                  459 '                    '                            CGL020
     O                                  470 '           '                                     CGL020
     O                         BLNK35   505                                                   CGL020
     O                                  507 '  '                                              CGL020
     O                                  527 '                    '                            CGL020
     O                         ZERO5    530P                                                  CGL020
     O                                  540 '          '                                      CGL020
     O                                  560 '                    '                            CGL020
     O                         ZERO13   573                                                   CGL020
     O                         DLNO     605                                                   CGL029
     O                                  620 '               '                                 CGL029
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         ACODQQ    14                                                AR813358A
     O                         ACUMZ    130                                                AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
     O/COPY WNCPYSRC,DL0295O033
1438 O*
1439 O*    TRAILER RECORD.
1440 OGEDLZZ  TADD     LR
1441 O                                    1 'T'
1442 O                         NRIT       6
1443 O                         INT,2     14P
1444 O                         DEC,2     16P
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0295OOP6                                           S01408
      *                                                                   S01408
1445 O**0295P2H**203   01                                                 S01117
1446 O*******OR**203   31 03                                              S01117
1445 O*******DL0295P2H  203   79 71                                 S01117E00018
1446 O*******OR  203   31 03 71                                     S01117E00018
1445 ODL0295P2H  203   79                                                 E00018
1446 O       OR  203   31 03                                              E00018
1447 O***********                        22 'REFERENCE DL0295'            S01117
1447 O                                   24 'REFERENCE DL0295P2'          S01117
1448 O*****                    TITL      89                               S01194
1448 O                         BJURPT    89                               S01194
1449 O                                  104 'DATE'
1450 O*****                    RUNA     112                               S01194
1450 O                         BJMRDT   112                               S01194
1451 O                                  122 'PAGE'
1452 O                         PAGE  Z  127
1453 O********H**1     01                                                 S01117
1454 O*******OR**1     31 03                                              S01117
1453 O********H  1     79 71                                        S01117E00018
1454 O*******OR  1     31 03 71                                     S01117E00018
1453 O        H  1     79                                                 E00018
1454 O       OR  1     31 03                                              E00018
1455 O                                   69 'MISSING ACCOUNT KEYS '
1456 O                                   75 'REPORT'
1457 O                NU1               115 'SHADOW POSTINGS'
1458 O********H**2     01                                                 S01117
1459 O*******OR**2     31 03                                              S01117
1458 O********H  2     79 71                                        S01117E00018
1459 O*******OR  2     31 03 71                                     S01117E00018
1458 O        H  2     79                                                 E00018
1459 O       OR  2     31 03                                              E00018
1460 O                                   72 '------------------------'
1461 O                                   75 '---'
     O********H  2     79 71                                        S01117E00018
     O*******OR        31 03 71                                     S01117E00018
     O        H  2     79                                                 E00018
     O       OR        31 03                                              E00018
     O                                   12 'BRANCH'                      S01117
     O                         BRCA      16                               S01117
     O*****                    BRNM      48                        S01117 S01194
     O***********              A8BRNM    48                        S01194 080603
     O                         BBRNM     48                               080603
1462 O********H**2     01                                                 S01117
1463 O*******OR**2     31 03                                              S01117
1462 O********H  2     79 71                                        S01117E00018
1463 O*******OR  2     31 03 71                                     S01117E00018
1462 O        H  2     79                                                 E00018
1463 O       OR  2     31 03                                              E00018
1464 O                                   30 'ACCOUNT KEY     DEAL '
1465 O                                   53 'NUMBER     CUSTOMER NO.'
1466 O***********                        80 'BRANCH CODE     EVENT'       S01117
1466 O                                   80 '                EVENT'       S01117
1467 O                                   98 ' DATE   EVENT CCY.'
1468 O                                  116 'EVENT AMOUNT'
1469 O********D**1     31                                                 S01117
1469 O********D  1     31 71                                        S01117E00018
1469 O        D  1     31                                                 E00018
1470 O*************************AKEY      19                               CDL038
1470 O                         AKEY      21                               CDL038
1471 O                         DLNO      33
1472 O                         CNUM      50
1473 O*****                    BRCD      65                               S01117
1474 O                         ZADATE    82
1475 O***********              ECCY      94                               S01460
1476 O***********      20      EAMT     116 ' ,   ,   ,   , 0 '           S01460
1477 O***********      21      EAMT     118 '   ,   ,   , 0 . '           S01460
1478 O***********      22      EAMT     119 '  ,   ,   , 0 .  '           S01460
1479 O***********      23      EAMT     120 ' ,   ,   , 0 .   '           S01460
     O***********      60      BJCYCD    94                        S01460 080603
     O***********      20 60   BEAMT    116 ' ,   ,   ,   , 0 '    S01460 080603
     O***********      21 60   BEAMT    118 '   ,   ,   , 0 . '    S01460 080603
     O***********      22 60   BEAMT    119 '  ,   ,   , 0 .  '    S01460 080603
     O***********      23 60   BEAMT    120 ' ,   ,   , 0 .   '    S01460 080603
     O***********     N60      ECCY      94                        S01460 080603
     O***********      20N60   EAMT     116 ' ,   ,   ,   , 0 '    S01460 080603
     O***********      21N60   EAMT     118 '   ,   ,   , 0 . '    S01460 080603
     O***********      22N60   EAMT     119 '  ,   ,   , 0 .  '    S01460 080603
     O***********      23N60   EAMT     120 ' ,   ,   , 0 .   '    S01460 080603
     O                         ECCY      94                               080603
1476 O***********      20      EAMT     116 ' ,   ,   ,   , 0 '    080603 097278
1477 O***********      21      EAMT     118 '   ,   ,   , 0 . '    080603 097278
1478 O***********      22      EAMT     119 '  ,   ,   , 0 .  '    080603 097278
1479 O***********      23      EAMT     120 ' ,   ,   , 0 .   '    080603 097278
     O                 20      EAMT     117 ' ,   ,   ,   , 0 -'          097278
     O                 21      EAMT     119 '   ,   ,   , 0 . -'          097278
     O                 22      EAMT     120 '  ,   ,   , 0 .  -'          097278
     O                 23      EAMT     121 ' ,   ,   , 0 .   -'          097278
1480 O********T** 20   LRNU4                                              S01117
1480 O********T   20   L3 73 71                                     S01117E00018
1480 O        T   20   L3 73                                              E00018
1481 O                                   73 '* NO MISSING ACCOUNT KEY'
1482 O                                   76 'S *'
1538 O********T 3      LR U7 71                                     S01117E00018
     O*                                                                   DT0001
     O** Prevent attempt to write if file has not been opened.            DT0001
1538 O********T 3      LR U7                                        E00018DT0001
1538 O        T 3      LR U7 52                                           DT0001
1539 O                                   22 'REFERENCE DL0295'            S01117
1540 O                                   62 'PRINT TERMINATED, '          S01117
1541 O                                   80 'DATABASE IN ERROR.'          S01117
     O********T 3      L3 71                                        S01117E00018
     O****    T 3      L3                                           E00018E239
     O        T 3      L3 02                                              E239
     O       OR        L3 68                                              050169
     O*******OR**      LR 52                                       LN0363 188100
     O       OR        LR 52 97                                           188100
     O                                   71 '*** END OF BRANCH REPORT'    S01117
     O                                   75 ' ***'                        S01117
      *                                                                   188100
     O        E  203           NODTL2                                     188100
     O                                   24 'REFERENCE DL0295P2'          188100
     O                         BJURPT    89                               188100
     O                                  104 'DATE'                        188100
     O                         BJMRDT   112                               188100
     O                                  122 'PAGE'                        188100
     O                         PAGE  Z  127                               188100
     O        E  1             NODTL2                                     188100
     O                                   69 'MISSING ACCOUNT KEYS '       188100
     O                                   75 'REPORT'                      188100
     O                NU1               115 'SHADOW POSTINGS'             188100
     O        E  2             NODTL2                                     188100
     O                                   72 '------------------------'    188100
     O                                   75 '---'                         188100
     O        E  2             NODTL2                                     188100
     O                                   12 'BRANCH'                      188100
     O                         BRCD      16                               188100
     O                         BRNM      48                               188100
     O        E  2             NODTL2                                     188100
     O                                   30 'ACCOUNT KEY     DEAL '       188100
     O                                   53 'NUMBER     CUSTOMER NO.'     188100
     O                                   80 '                EVENT'       188100
     O                                   98 ' DATE   EVENT CCY.'          188100
     O                                  116 'EVENT AMOUNT'                188100
     O        E   20           NODTL2                                     188100
     O                                   73 '* NO MISSING ACCOUNT KEY'    188100
     O                                   76 'S *'                         188100
     O        E 3              NODTL2                                     188100
     O                                   71 '*** END OF BRANCH REPORT'    188100
     O                                   75 ' ***'                        188100
     O        E   20   L3 73   ENDRP2                                     188100
     O                                   73 '* NO MISSING ACCOUNT KEY'    188100
     O                                   76 'S *'                         188100
     O        E 3              ENDRP2                                     188100
     O                                   71 '*** END OF BRANCH REPORT'    188100
     O                                   75 ' ***'                        188100
      *                                                                   188100
1483 O********T**203   LR                                                 S01117
     ODL0295AUT  203   LR                                                 S01117
1484 O***********                        22 'REFERENCE DL0295'            S01117
1484 O                                   24 'REFERENCE DL0295AU'          S01117
1485 O*****                    TITL      89                               S01194
1485 O                         BJURPT    89                               S01194
1486 O                                  104 'DATE'
1487 O*****                    RUNA     112                               S01194
1487 O                         BJMRDT   112                               S01194
1488 O                                  122 'PAGE'
1489 O***********              PAGE  Z  127                               S01117
1489 O                         PAGE1 Z  127                               S01117
1490 O        T  1     LR
1491 O                                   61 'DEALS GENERATED ACCOUNT '
1492 O                                   83 'POSTINGS FILE CONTROL '
1493 O                                   89 'REPORT'
1494 O                NU1               115 'SHADOW POSTINGS'
1495 O        T  2     LR
1496 O                                   61 '------------------------'
1497 O                                   85 '------------------------'
1498 O                                   89 '----'
1499 O                NU1               115 '---------------'
1500 O        T 21     LRNU7
1501 O                                   33 'S/DKEYS  -  RUN CONTROLS'
1502 O                                   72 'ON FILE'
1503 O                                  102 'IN PROGRAM'
1504 O        T  2     LRNU7
1505 O                                   33 '-------    -------------'
1506 O                                   72 '-------'
1507 O                                  102 '----------'
1508 O        T  2     LRNU7
1509 O                                   42 'TOTAL RECORDS ON FILE'
1510 O                         NORE  3   72
1511 O                         NREC  3  102
1512 O                 80               128 '***   DIFFERENCE   ***'
1513 O        T  2     LRNU7
1514 O                                   31 'HASH TOTAL'
1515 O                         HRWN  Z   69
1516 O                         HRDC      72
1517 O                         INT,1 Z   99
1518 O                         DEC,1    102
1519 O                 81               128 '***   DIFFERENCE   ***'
     O        T  2     LRNU7 86                                           AUS007
     O                                   31 'HASH TOTAL'                  AUS007
     O                         HRWN  Z   69                               AUS007
     O                         HRDC      72                               AUS007
     O                         INT,3 Z   99                               AUS007
     O                         DEC,3    102                               AUS007
     O                 85               128 '***   DIFFERENCE   ***'      AUS007
1520 O        T 31     LRNU7
1521 O                                   33 'S/GEDL   -  RUN CONTROLS'
1522 O                NU1                16 'M'
1523 O                                  102 'FILE CREATE'
1524 O        T  2     LRNU7
1525 O                                   33 '------      ------------'
1527 O                NU1                16 '-'
1528 O                                  102 '-----------'
1529 O        T  2     LRNU7
1530 O                                   42 'TOTAL RECORDS ON FILE'
1531 O                         NRIT  3  102
1532 O        T  2     LRNU7
1533 O                                   31 'HASH TOTAL'
1534 O                         INT,2 Z   99
1535 O                         DEC,2    102
     O*                                                                   S01117
     O        T 3      LRNU7N52                                           S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
1536 O*****   T 2      LRNU7                                              E299
1537 O*****                              77 '*** END OF REPORT ***'       E299
1538 O********T*3      LR U7                                              S01117
1539 O***********************************22 'REFERENCE DL0295'            S01117
1540 O***********************************62 'PRINT TERMINATED, '          S01117
1541 O***********************************80 'DATABASE IN ERROR.'          S01117
     O********T*2      LR U7                                        S01100S01117
     O********                           44 'DATABASE ERROR'        S01100S01117
     O********                 DBASE     48                         S01100S01117
     O********                           60 'IN PROGRAM'            S01100S01117
     O********                 DBPGM     72                         S01100S01117
     O********T*1      LR U7                                        S01100S01117
     O********                           43 'DATABASE FILE'         S01100S01117
     O********                 DBFILE    55                         S01100S01117
     O********                           60 'KEY'                   S01100S01117
     O********                 DBKEY     91                         S01100S01117
1538 O********T 3      LR U7 71                                     S01117E00018
1538 O        T 3      LR U7                                              E00018
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O********T 1      LR U7 71                                     S01117E00018
     O        T 1      LR U7                                              E00018
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    76                               S01117
     O********T 13     LR U7 71                                     S01117E00018
     O        T 13     LR U7                                              E00018
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
     O********                                                            S01103
     O* Accrual Summary Report                                            S01103
     O*L0295P1E** 0305         SMTITL                                     S01117
     O*******DL0295P1E   0305 71      SMTITL                        S01117E00018
     ODL0295P1E   0305         SMTITL                                     E00018
1484 O***********                        22 'REFERENCE DL0295'  S01103    S01117
1484 O                                   24 'REFERENCE DL0295P1'          S01117
1484 O                                   22 'REFERENCE DL0295'            S01103
1485 O*****                    TITL      89                        S01103 S01194
1485 O                         BJURPT    89                               S01194
1486 O                                  104 'DATE'                        S01103
1487 O*****                    RUNA     112                        S01103 S01194
1487 O                         BJMRDT   112                               S01194
1488 O                                  122 'PAGE'                        S01103
1489 O                         PAGE2 Z  127                               S01103
     O*L0295P1E**   06         SMTITL                                     S01117
     O******DL0295P1E     06 71      SMTITL                         S01117E00018
     ODL0295P1E     06         SMTITL                                     E00018
     O                                   54 'SUMMARISED ACCRUAL'          S01103
     O                                   68 'EVENTS REPORT'               S01103
1494 O                NU1               115 'SHADOW POSTINGS'             S01103
     O*L0295P1E**   08         SMTITL                                     S01117
     O******DL0295P1E     08 71      SMTITL                         S01117E00018
     ODL0295P1E     08         SMTITL                                     E00018
     O                                   55 '~~~~~~~~~~~~~~~~~~~'         S01103
     O                                   68 '~~~~~~~~~~~~~'               S01103
     O******DL0295P1E     10 71      SMTITL                         S01117E00018
     ODL0295P1E     10         SMTITL                                     E00018
     O                                   12 'BRANCH'                      S01117
     O                         BRCA      16                               S01117
     O*****                    BRNM      48                        S01117 S01194
     O***********              A8BRNM    48                        S01194 080603
     O                         BBRNM     48                               080603
     O*L0295P1E**   10         SMTITL                                     S01117
     O******DL0295P1E     12 71      SMTITL                         S01117E00018
     ODL0295P1E     12         SMTITL                                     E00018
     O***********                        15 'BRANCH'            S01103    S01117
     O                                   34 'EVENT CURRENCY'              S01103
     O                                   50 'ACCOUNT KEY'                 S01103
     O                                   66 'DEAL NUMBER'                 S01103
     O                                   83 'EVENT AMOUNT'                S01103
     O*L0295P1E**1             SUMDET                                     S01117
     O******DL0295P1E  1     71      SUMDET                         S01117E00018
     ODL0295P1E  1             SUMDET                                     E00018
     O*****                    BRCD      15                     S01103    S01117
     O***********              ECCY      34                        S01103 S01460
     O***********      60      BJCYCD    34                        S01460 080603
     O***********     N60      ECCY      34                        S01460 080603
     O                         ECCY      34                               080603
     O                         AKEY      52                               CDL038
     O***********              AKEY      50                        S01103 CDL038
     O***********              DLNO  Z   66                        S01103 051153
     O                         DLNO      66                               051153
     O***********      20      EAMT      86 ' ,   ,   ,   , 0 '    S01103 S01460
1477 O***********      21      EAMT      86 '   ,   ,   , 0 . '    S01103 S01460
1478 O***********      22      EAMT      86 '  ,   ,   , 0 .  '    S01103 S01460
1479 O***********      23      EAMT      86 ' ,   ,   , 0 .   '    S01103 S01460
     O***********      20 60   BEAMT     86 ' ,   ,   ,   , 0 '    S01460 080603
     O***********      21 60   BEAMT     86 '   ,   ,   , 0 . '    S01460 080603
     O***********      22 60   BEAMT     86 '  ,   ,   , 0 .  '    S01460 080603
     O***********      23 60   BEAMT     86 ' ,   ,   , 0 .   '    S01460 080603
     O***********      20N60   EAMT      86 ' ,   ,   ,   , 0 '    S01460 080603
     O***********      21N60   EAMT      86 '   ,   ,   , 0 . '    S01460 080603
     O***********      22N60   EAMT      86 '  ,   ,   , 0 .  '    S01460 080603
     O***********      23N60   EAMT      86 ' ,   ,   , 0 .   '    S01460 080603
     O                 20      EAMT      86 ' ,   ,   ,   , 0 '           080603
     O                 21      EAMT      86 '   ,   ,   , 0 . '           080603
     O                 22      EAMT      86 '  ,   ,   , 0 .  '           080603
     O                 23      EAMT      86 ' ,   ,   , 0 .   '           080603
     O                    18             90 'CR'                          S01103
     O                   N19             99 'REVERSAL'                    S01103
     O*L0295P1E**1             SUMTOT                                     S01117
     O******DL0295P1E  1     71      SUMTOT                         S01117E00018
     ODL0295P1E  1             SUMTOT                                     E00018
     O                 20                86 '~~~~~~~~~~~~~~~~~'           S01103
     O                 21                86 '~~~~~~~~~~~~~~~~~'           S01103
     O                 22                86 '~~~~~~~~~~~~~~~~~'           S01103
     O                 23                86 '~~~~~~~~~~~~~~~~~'           S01103
     O*L0295P1E**1             SUMTOT                                     S01117
     O******DL0295P1E  1     71      SUMTOT                         S01117E00018
     ODL0295P1E  1             SUMTOT                                     E00018
     O                 20      ACRLSM    86 ' ,   ,   ,   , 0 '           S01103
1477 O                 21      ACRLSM    86 '   ,   ,   , 0 . '           S01103
1478 O                 22      ACRLSM    86 '  ,   ,   , 0 .  '           S01103
1479 O                 23      ACRLSM    86 ' ,   ,   , 0 .   '           S01103
     O                 87                90 'CR'                          S01103
     O*L0295P1E**2             SUMTOT                                     S01117
     O*******DL0295P1E  2     71      SUMTOT                        S01117E00018
     ODL0295P1E  2             SUMTOT                                     E00018
     O                 20                86 '~~~~~~~~~~~~~~~~~'           S01103
     O                 21                86 '~~~~~~~~~~~~~~~~~'           S01103
     O                 22                86 '~~~~~~~~~~~~~~~~~'           S01103
     O                 23                86 '~~~~~~~~~~~~~~~~~'           S01103
1538 O********T 3      LR U7 71                                     S01117E00018
     O*                                                                   DT0001
     O** Prevent attempt to write if file has not been opened.            DT0001
1538 O********T 3      LR U7                                        E00018DT0001
1538 O        T 3      LR U7 52                                           DT0001
1539 O                                   22 'REFERENCE DL0295'            S01117
1540 O                                   62 'PRINT TERMINATED, '          S01117
1541 O                                   80 'DATABASE IN ERROR.'          S01117
     O*********DL0295P1T 3      L3 71N74                            S01117E00018
     O*DL0295P1T*3*****L3N74                                        E00018E239
     ODL0295P1T 3      L3N74 02                                           E239
     O       OR        L3N74 68                                           050169
     O                                   66 '*** END OF BRANCH '          S01117
     O                                   76 'REPORT ***'                  S01117
     O*L0295P1E*2              ENDREP                                     S01117
1537 O***********                        77 '*** END OF REPORT ***'S01103 S01117
1537 O*****                              77 '*** END OF REPORT ***'S01103 RT0086
1537 O***********      LRN77             77 '*** END OF REPORT ***'RT0086 048941
1537 O                 LR                77 '*** END OF REPORT ***'       048941
      *                                                                   18
     O        E   0305         NODTL1                                     18
     O                                   24 'REFERENCE DL0295P1'          18
     O                         BJURPT    89                               18
     O                                  104 'DATE'                        18
     O                         BJMRDT   112                               18
     O                                  122 'PAGE'                        18
     O                         PAGE2 Z  127                               18
     O        E     06         NODTL1                                     18
     O                                   54 'SUMMARISED ACCRUAL'          18
     O                                   68 'EVENTS REPORT'               18
     O                NU1               115 'SHADOW POSTINGS'             18
     O        E     08         NODTL1                                     18
     O                                   55 '~~~~~~~~~~~~~~~~~~~'         18
     O                                   68 '~~~~~~~~~~~~~'               18
     O        E     10         NODTL1                                     18
     O                                   12 'BRANCH'                      18
     O                         BRCD      16                               18
     O                         BRNM      48                               18
     O        E     12         NODTL1                                     18
     O                                   34 'EVENT CURRENCY'              18
     O                                   50 'ACCOUNT KEY'                 18
     O                                   66 'DEAL NUMBER'                 18
     O                                   83 'EVENT AMOUNT'                18
     O        E 3              NODTL1                                     18
     O                                   66 '*** END OF BRANCH '          18
     O                                   76 'REPORT ***'                  18
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0295OOP7
      *                                                                   S01408
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   TABECD/TABEVE  -  EVENT CODE / EVENT NAME
DD/D
IINT
MMAT
VVAL
** ACR - AKEY Elements that identify dealing accruals                     S01103
PH                                                                        S01103
LL                                                                        S01103
AA                                                                        S01103
AI                                                                        S01103
AD                                                                        S01103
AC                                                                        S01103
AP                                                                 E26578 E26739
AL                                                                 E26578 E26739
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                       S01460
0000001                                                                   S01460
0000010                                                                   S01460
0000100                                                                   S01460
0001000                                                                   S01460
0010000                                                                   S01460
0100000                                                                   S01460
1000000                                                                   S01460
** FXTY - FX DEAL TYPES TO BE CHECKED FOR NET                             CDL002
FPFSCXPISIOTSW                                                            CDL002
     X/COPY WNCPYSRC,DL0295X001
