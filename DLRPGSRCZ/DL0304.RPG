0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Pay/receive extract file creation')           *
/*OVRF*: OVRDBF FILE(TRANS) TOFILE(DTRIN)                           : *
0002 F********************************************************************
0004 F*                                                                  *
     F*  Midas - Dealing Module
0004 F*                                                                  *
0005 F*       DL0304  -  CREATE PAY/RECEIVE EXTRACT FILES                *
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD051554           Date 28Sep18               *
      *  Prev Amend No. MD053295           Date 13Apr19               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 AR996895           Date 25Nov12               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CDL081             Date 14Dec09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CDL013             Date 08Jun06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CDL025             Date 27Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 153330             Date 10Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 121768             Date 19Feb98               *
      *                 126017             Date 14Nov97               *
     F*                      097885             DATE 31JAN97               *
     F*                      S01408             DATE 05NOV96
     F*                      CFF004             DATE 02OCT96
     F*                      S01408             DATE 26AUG96
     F*                      S01408             DATE 11APR96
     F*                      095244             DATE 01NOV95
     F*                      095238             DATE 31OCT95
     F*                      066550             DATE 04FEB94             *
     F*                      E49966             DATE  1FEB93             *
     F*                      S01392             DATE 20JUL92             *
     F*                      S01383             DATE 27APR92             *
     F*                      AUS003             DATE 01JUL92             *
     F*                      S01354             DATE 08JAN92             *
     F*                      E22600             DATE 10JUL90             *E22600
     F*                      E21695             DATE 06JUL90             *S01157
     F*                      BHF147             DATE 13JUN90             *
     F*                      LN0135             DATE 23MAY90             *
     F*                      S01194             DATE 07/07/89            *S01194
     F*                      S01117             DATE 02/07/89            *S01117
     F*                      S01157             DATE 02/07/89            *S01157
     F*                      S01147             DATE 10/12/87            *
     F*                      E11193             DATE 13/08/87            *E11193
     F*                      S01119             DATE 15/06/87            *S01119
     F*                      S01108             DATE 24/09/86            *
     F*                      E80945             DATE 24/06/86            *
     F*                                                                  *S01119
0011 F*------------------------------------------------------------------*
     F*                                                                  *
      *  MD051554 - Leap Year Fix for interest calculation basis to   *
      *             be used for 1st Jan should not be present in      *
      *             FRA/IRS module                                    *     
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        * 
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *      
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CDL081 - Tiered withholding tax rounding upgrade             *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL013 - Tiered Withholding Tax                              *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CSD025 - Customer De-Activation                              *
      *  CDL025 - FX Netting Payment Generation (Recompile)           *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  153330 - When negative interest indicator is ON, negate TOTI *
      *           to reflect true interest.  Apply fix 154920.        *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  097885 - Recompiled for wrong calculation of number of day      *
     F*           interest (ZINTDYZ2).                                   *
     F*  S01408 - Hook DL0304CP11 added                                  *
     F*           Hook DL0304CP10 added                                  *
     F*           Hook DL0304CCP9 added                                  *
     F*           Hook DL0304CCP8 added                                  *
     F*  CFF004 - Increase in size of Price Fields,(Recompiled Only)     *
     F*  S01408 - Hook DL0304CCP6 added                                  *
     F*           Hook DL0304CCP7 added                                  *
     F*  S01408 - Hook DL0304FFP1 added                                  *
     F*           Hook DL0304IIP1 added                                  *
     F*           Hook DL0304CCP1 added                                  *
     F*           Hook DL0304CCP2 added                                  *
     F*           Hook DL0304CCP3 added                                  *
     F*           Hook DL0304CCP4 added                                  *
     F*           Hook DL0304CCP5 added                                  *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*    066550 - GLINTC has had historical problems and inaccuracies  *
     F*             and is now externaly descibed and changed to use     *
     F*             ZINTDYZ1. See document atached to error no on GEMS   *
     F*       E49966  -  Incorrect P/R Amount Reported for Call Deals    *
     F*                  with Int. Freq. 'N' , maturing Before EOM       *
     F*       S01392  -  JAP.SUB-MODULE INCORPORATION (CORE)             *
     F*       S01383  -  BASIC RATE TAX INCORPORATION                    *
     F*       AUS003  -  AUSTRALIAN PRODUCT - INTEREST DATED TO          *
     F*                  CALENDAR MONTH END.                             *
     F*       S01354  -  Ignore Internal funding deal types              *
0010 F*       E22600  -  MT203, SELECTION CRITERIA SHOULD INCLUDE        *E22600
0010 F*                  FIELDS 52/53/54.                                *E22600
0011 F*       E21695  -  FRA/IRS INTEREST PAY AND INTEREST RECEIVE       *E21695
0011 F*                  PROCESSING CONFUSES THE COUNTERPARTY RECEIVE    *E21695
0011 F*                  BANK AND COUNTERPARTY PAY BANK('THEIR AGENTS')  *E21695
     F*       BHF147  -  NEEDS TO CALL AOTRADR0 FOR FIELD BLLCTB         *BHF147
     F*       LN0135  -  REMOVE 'END OF REPORT'FROM AUDIT REPORT         *LN0135
     F*       S01194  -  INCORPORATION OF NEW STANDING DATA FILES VIA A/O*S01194
     F*                  N.B FIELD PRID IS RESERVED FOR CHASE MANHAT & IS*S01194
     F*                  NOT SUPPORTED BY NEW SD FILES. HENCE ALL CODING *S01194
     F*                  RELATING TO THIS FIELD HAS BEEN REMOVED         *S01194
     F*                                                                  *S01194
0011 F*       S01194  -  STANDING DATA CHANGES.                          *S01194
     F*                                                                  *S01194
0011 F*       S01117  -  MULTIBRANCHING CHANGES.                         *S01117
     F*                                                                  *S01117
0011 F*       S01157  -  FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL' IN  *S01157
     F*                  TO 'RR' (COLLAR), 'RP' (CAP) AND 'RF' (FLOOR).  *S01157
     F*       S01147  -  RELEASE 22                                      *
     F*       E11193  -  FRA/IRS CHANGES TO DL0279 ALLOWED MORE THAN     *E11193
     F*                  ONE DLIND RECORD TO BE CREATED FOR A DEAL       *E11193
     F*                  THIS PROGRAM WAS CHANGED TH PROCESS THEM        *E11193
0010 F*       S01119  -  FRA/IRS INCORPORATION                           *S01119
     F*       S01108  -  CHANGE PROCESSING OF NOSTRO TRANSFERS           *
0011 F*       E80945  -  INDICATOR 98 SETTING IS SAVED AND RESTORED      *
0011 F*                  WHEN S.R.GLINTC IS PERFORMED.                   *
0008 F*                                                                  *
0010 F********************************************************************
0011 F/EJECT
0012 F* T R A N S A C T I O N    F I L E S
0011 F/SPACE 3
0013 FTRANS   IP  E           K        DISK
0014 FDAINDHH IS  F      40            DISK                           U6
0014 FDAINDDL IS  F      40            DISK                           U6
0014 FDAINDEX IS  F      40            DISK                           U6
0015 F* M A S T E R    F I L E S
0011 F/SPACE 3
0016 F*EALS***IF  F  ***400  6AI     2 DISK ***********************       S01119
0013 F*EALS***IF  F     600  6AI     2 DISK                        S01119 S01177
0013 F*EALS***IF  F    1069  6AI     2 DISK                        S01177 S01392
0013 F***DEALS** IF  F    1074  6AI     2 DISK                                         S01392 CGL029
     FDEALS   IF  F    2325  6AI     2 DISK                                                   CGL029
0013 FDRSDEALSIF  F    1074  6AI     2 DISK                               S01392
0017 F*EAMS***IF  F     200 14AI     2 DISK                               S01177
     F***DEAMS** IF  F     828 14AI     2 DISK                                         S01177 CGL029
     FDEAMS   IF  F     933 14AI     2 DISK                                                   CGL029
0018 F*ABLE***IF  F      96 12AI     2 DISK                       *****   S01194
0019 F*NAME   IF  F     256 10AI    39 DISK                       *****   S01194
0020 F*LINT***IF  F     256  7AI     2 DISK                       *****   S01194
     FSDBRTDL1IF  E           K        DISK                               S01383
     FSDCBRTL1IF  E           K        DISK                               S01383
0021 F* O U T P U T    F I L E S
0011 F/SPACE 3
0022 FPREXHH  O   F     160            DISK                      A
0022 F*PREXPH**O***F*****160************DISK**********************A*      E22600
0022 F***PREXPH* O   F     182            DISK                      A                  E22600 CGL029
     FPREXPH  O   F     230            DISK                      A                            CGL029
0022 FPREXZZ  O   F     160            DISK                      A
0023 F*L0304P1O** F     132            PRINTER                    *****   S01117
0023 FDL0304AUO   F     132            PRINTER                            S01117
     FSDSTAAL1IF  E           K        DISK                                                   CDL013
      * Retail/Dealing WHT ICD extension update                                               CDL013
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0304FFP1                                           S01408
     F*                                                                   S01408
0024 F/EJECT
0025 F* ID F  C  H  L    FUNCTION OF INDICATORS
0026 F*
0027 F* 02            TRANS FILE HEADER
0028 F* 03                       DETAIL
0029 F* 04                       TRAILER
0030 F* 05            DAIND FILE HEADER
0031 F* 06                       DETAIL
0032 F* 07                       TRAILER
0033 F* 08            DEALS,DB
0034 F* 09                 ,DC
0035 F* 10                 ,DD
0036 F* 11                 ,DE
0036 F* 15                 ,DG                                            S01119
0037 F* 12            DEAMS,DI - LIVE
0038 F* 13                     - REVERSED
0039 F*       19      INTEREST TAX RATE ZERO
0040 F*****20         DEFAULT BRANCH NULL                         *****   S01117
0041 F*    21         PAY/RECEIVE IND 1 ON
0042 F*    22                         2
0043 F*    23                         3
0044 F*    25         LOCAL CCY NOSTRO-TELEX OR BANK AUTHORISATION IND OFF
0045 F*       24      DEAL TYPE = 'IT', 'CD' OR 'TD'
0046 F*       26      TAXABLE INDICATOR = 'Y'
     F*       28      Negative Interest Indicator is ON                   153330
     F*       29      DEALING -> CHIPS INTERFACE MODULE EXISTS
     F*       30      DEALING -> SWIFT INTERFACE EXISTS
0047 F*
0048 F*       31      SETUP O/P REC. WITH - START DETAILS
0049 F*       32                          - INTEREST DETAILS
0050 F*       33                          - FINAL DETAILS
0051 F*    34      RECORD OUTPUT
0052 F*
     F*       37      CHAIN FAIL TO DRSDEALS                              S01392
0053 F*       40      1ST CYCLE IND
0054 F*       41      CHAIN FAILURE
0055 F*       42      GENERAL WORK IND.
0056 F*       43      GENERAL WORK IND
0057 F*       44      DEFAULT BRANCH ZERO
0058 F*       45      OUTPUT AMOUNT NEGATIVE
0059 F*****   46      PRODUCT IND. IS ON                                  S01117
0060 F*       47      USE 'RBDA' AS THE AMOUNT
0061 F*       48      SET ROLLOVER/CAPITALISATION IND. TO 3
0062 F*       49      INTEREST CAPITALISATION INDICATOR IS 'Y'
0063 F*       50      INSTRUCTIONS ARE VALID
0068 F*       51      MESSAGE TYPE 09
0069 F*       52                   10
0070 F*       53                   11
0071 F*       54                   12
0072 F*       55      OUT OF BALANCE - DTRIN/DLIND
0073 F*       56                     - DAIND
0074 F*       57      WORK INDICATOR
0075 F*****   59      DATABASE ERROR - NO BRANCH CODE RECORD      *****   S01194
0076 F*****   60                       NO TABLE/I1                *****   S01194
0077 F*****   61                       NO TABLE/I2                *****   S01194
0078 F*****   62                       NO TABLE/I5                *****   S01194
0079 F*****   63                       SINGLE BRANCH RECORD MISSING       S01117
0080 F*****   64                       DEAL RECORD MISSING - PROC1        S01117
0081 F*****   66                       DEAM RECORD MISSING - PROC2        S01117
0082 F*****   67                       DEAL RECORD MISSING - PROC2        S01117
0083 F*****   68                       DEAM RECORD MISSING - INTRES       S01117
0084 F*       70      FOREIGN EXCHANGE
0085 F*       71      LOAN/DEPOSIT PLACED.
0086 F*       72      DEPOSIT ACCEPTED OR C.D. ISSUED
0087 F*       73      INT. BEARING NEG. ASSET PURCHASED
0088 F*       74      NON-INT. BEARING NEG. ASSET PURCHASED
0089 F*       75      NEG. ASSET SOLD
0090 F*       76      DEAL AMD. - DEPOSIT PLACED,INT. BEAR NEG. ASS. PURCH
0091 F*       77                - DEPOSIT ACCEPTED AND TAKINGS
0092 F*       80      MESSAGE TYPE 01 - SWIFT
0036 F*       87      FRA/IRS DEAL TYPE IDENTIFIED                        S01119
0093 F*       89      END OF DAY
0094 F*             U6-END OF DAY RUN
0095 F*             U7-DATABASE ERROR - ON OUTPUT FROM PROGRAM
0096 F*             U7-I/P CYCLE  RUN - ON INPUT TO PROGRAM
0097 F*             U8-OUT OF BALANCE
     E                    CPY@    1   1 80
0098 E                    RIP         5  5 0             NO.RECORDS I/P
0099 E*
0100 E                    IPSET   5   5  2 0             I/P CYC.SET.TYPES
0101 E*****               DTABA   5   5  2       DEPT. DEAL TYPES *****   S01194
0102 E*****               DTABB  11  11  2       DEPT DL.AMD. TYPE*****   S01194
0103 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0104 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0105 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0106 E                    PR          8  1 0
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
      *                                                                   066550
0107 E/EJECT
0108 I*    DEAL TRANSACTIONS INDEX FILE - HEADER RECORD.
0109 I*
0110 IDTRIEHHF    02
0125 I*
0126 I*
0127 I*    DEAL TRANSACTIONS INDEX FILE - DETAIL RECORD.
0128 I*
0129 IDTRIEPHF    03
0134 I              VDAT                            VDATDL
0135 I              DASN                            DASNDL
0142 I                                              PRI1        2121
0143 I                                              PRI2        2222
0144 I                                              PRI3        2323
0147 I*
0148 I*
0149 I*    DEALS INDEX FILE - TRAILER RECORD.
0150 I*
0151 IDTRIEZZF    04
0162 I*
0163 I*    DEAL TRANSACTIONS INDEX FILE - HEADER RECORD.
0164 I*
0165 IDAINDHH NS  05   1 CH
0166 I                                        1   1 RECI
0167 I                                        2   2 RCDT
0168 I                                        3   80DLNO
0169 I                                    P   9  110NORE
0170 I                                    P  12  140FLSZ
0171 I                                    P  15  170RRLC
0172 I                                    P  18  200RRNA
0173 I                                    P  21  230RRLX
0174 I                                    P  24  260RRXP
0175 I                                    P  27  290NDLR
0176 I                                    P  30  320NDAR
0177 I                                       33  330STPI
0178 I                                    P  35  370RRNT
0179 I                                    P  38  400TNLU
0180 I*
0207 I* CATCHALL
0208 I        NS
0181 I*
0182 I*    DEAL TRANSACTIONS INDEX FILE - DETAIL RECORD.
0183 I*
0184 IDAINDDL NS  06   1 CD   2 CA
0185 I                                        1   1 RECI
0186 I                                        2   2 RCDT
0187 I                                        3   80DLNO
0188 I                                        9  130VDATDL
0189 I                                       14  160DASNDL
0190 I                                       17  17 CHTP
0191 I                                       18  18 CNRQ
0192 I                                       19  19 CNPR
0193 I                                       20  20 REPR
0194 I                                       21  250RRLA
0195 I                                       26  26 DADI
0196 I                                       27  270PRI1        2121
0197 I                                       28  280PRI2        2222
0198 I                                       29  290PRI3        2323
0199 I                                    P  35  370RRNT
0200 I                                    P  38  400TNLU
0201 I*
0207 I* CATCHALL
0208 I        NS
0202 I*    DEAL AMENDMENTS INDEX FILE TRAILER RECORD.
0203 I*
0204 IDAINDEX NS  07   1 CT
0205 I                                    P   9  110RIP,2
0206 I*
0207 I* CATCHALL
0208 I        NS
0209 I*
0210 I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
0211 I*
0212 IDEALS   NS  08   8 CB
0213 I                                        1   1 RECI
0214 I                                        2   70DLNODB
0215 I                                        8   8 RCDT
0216 I                                        9  100RCDC
0217 I**********                             11  160CNUM                                      CSD027
0217 I                                       11  16 CNUM                                      CSD027
0218 I*****                                  17  190BRCD                  S01117
0218 I                                       17  19 BRCA                  S01117
0219 I                                       20  21 DTYP
0220 I                                       22  23 DLST
0221 I                                    P  24  260DDAT
0222 I                                    P  27  290VDAT
0223 I                                    P  30  320OTDT
0224 I                                       35  38 BRKC
0225 I                                    P  39  450BAGE
0226 I                                       46  48 PUCY
0227 I                                    P  49  550PUAM
0228 I                                    P  56  628EXRT
0229 I                                       86  88 SLCY
0230 I                                    P  89  950SLAM
0231 I                                    P 117 1230BCEQ
0232 I                                    P 131 1378LCXR
0233 I                                      138 1390PCST
0234 I**********                            140 151 OPCA                                      CGL029
     I                                      140 151 OPCAQQ                                    CGL029
0235 I                                      152 161 TSCN
0236 I                                      162 1630SCST
0237 I**********                            164 175 OSCA                                      CGL029
     I                                      164 175 OSCAQQ                                    CGL029
0238 I                                      176 185 TPCN
0239 I                                    P 192 1980ORPA
0240 I                                    P 205 2110ORSA
0241 I                                      212 2120FSLI
0242 I                                    P 241 2470SPPD
0243 I                                    P 248 2540SPLA
0244 I                                      255 257 SPLC
0245 I                                      285 2900SODN
0246 I                                      300 309 FACO
0247 I                                      310 344 SPI
0248 I                                      370 370 DNSI
0249 I                                      371 371 DSTI
0250 I                                      372 372 CNFI
0251 I                                      373 373 ACEI
0252 I                                      374 374 TLXI
0253 I                                    P 391 3930ORED
0254 I                                    P 394 3960LCD
0255 I                                      397 397 CHTP
0256 I                                    P 398 4000TNLU
     I                                      401 402 BOKC                  S01117
     I                                      403 4080LNKDN                 S01117
     I                                     10371039 ORBR                  S01117
     I                                     10401043 PRFC                  S01117
     I                                     10441046 ROBR                  S01117
     I                                     10471049 POBR                  S01117
     I                                     12921309 OPCA                                      CGL029
     I                                     13101327 OSCA                                      CGL029
0257 I*
0258 I*
0259 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0260 I*
0261 IDEALS   NS  09   8 CC
0262 I                                        1   1 RECI
0263 I                                        2   70DLNODC
0264 I                                        8   8 RCDT
0265 I                                        9  100RCDC
0266 I**********                             11  160CNUM                                      CSD027
0266 I                                       11  16 CNUM                                      CSD027
0267 I*****                                  17  190BRCD                  S01117
0267 I                                       17  19 BRCA                  S01117
0268 I                                       20  21 DTYP
0269 I                                       22  23 DLST
0270 I                                    P  24  260DDAT
0271 I                                    P  27  290VDAT
0272 I                                    P  30  320MDAT
0273 I                                       33  340CDAS
0274 I                                       35  38 BRKC
0275 I                                    P  39  450BAGE
0276 I                                       46  48 CCY
0277 I                                    P  49  550PCPL
0278 I                                       56  56 INTC
0279 I                                       63  640BRTT
0280 I                                    P  65  707BRTE
0281 I                                    P  71  767RTSP
0282 I                                    P  77  827INTR
0283 I                                       83  850NOTD
0284 I                                       86 105 RNNA
0285 I**********                            106 1110CHNA                                      CSD027
0285 I                                      106 111 CHNA                                      CSD027
0286 I                                      112 1140FACT
0287 I                                      115 1160FCNO
0288 I                                    P 117 1230OPAM
0289 I                                    P 124 1308BCXR
0290 I                                    P 131 1378LCXR
0291 I                                      138 1390SDST
0292 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0293 I                                      152 161 TSTN
0294 I                                      162 1630MDST
0295 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0296 I                                      176 185 TMAN
0297 I                                      186 1910RODN
0298 I                                    P 192 1980RODA
0299 I                                      199 2040RBDN
0300 I                                    P 205 2110RBDA
0301 I                                      212 2120ICBS
0302 I                                      213 213 IPFR
0303 I                                    P 214 2200TOTI
0304 I                                    P 221 2230NIDT
0305 I                                    P 224 2260IBDT
0306 I                                    P 227 2290SLID
0307 I                                    P 230 2360AIPD
0308 I                                    P 237 2390DLRC
0309 I                                    P 240 2420IACD
0310 I                                    P 243 2490AITC
0311 I                                    P 250 2560AIAN
0312 I                                    P 257 2630AIAP
0313 I                                    P 264 2700IPRD
0314 I                                    P 271 2770IPRM
0315 I                                    P 278 2840ICTD
0316 I                                    P 294 2960DAVDDC
0317 I                                      297 2990DASNDC
0318 I                                      300 309 FACO
0319 I                                      310 344 SPI
0320 I                                      345 3460INTF
0321 I                                      355 355 TAXI
0322 I                                      370 370 DNSI
0323 I                                      371 371 DSTI
0324 I                                      372 372 CNFI
0325 I                                      373 373 ACEI
0326 I                                      374 374 TLXI
0327 I                                    P 391 3930ORED
0328 I                                    P 394 3960LCD
0329 I                                      397 397 CHTP
0330 I                                    P 398 4000TNLU
     I/COPY WNCPYSRC,DL0304I001
     I                                      421 422 BOKC                  S01117
     I                                      423 4280LNKDN                 S01117
     I                                     10571059 ORBR                  S01117
     I                                     10601063 PRFC                  S01117
     I                                     10641066 ROBR                  S01117
     I                                     10671069 POBR                  S01117
     I                                     10721072 JRDFC                 S01392
     I                                     10741074 FUID                  S01392
     I                                     16721689 OMDA                                      CGL029
     I                                     16901707 OSDA                                      CGL029
0331 I*
     I/COPY WNCPYSRC,DL0304I002
0332 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
0333 I*
0334 IDEALS   NS  10   8 CD
0335 I                                        1   1 RECI
0336 I                                        2   70DLNODD
0337 I                                        8   8 RCDT
0338 I                                        9  100RCDC
0339 I**********                             11  160ISCN                                      CSD027
0339 I                                       11  16 ISCN                                      CSD027
0340 I*****                                  17  190BRCD                  S01117
0340 I                                       17  19 BRCA                  S01117
0341 I                                       20  21 DTYP
0342 I                                       22  23 DLST
0343 I                                    P  24  260DDAT
0344 I                                    P  27  290VDAT
0345 I                                    P  30  320MDAT
0346 I                                       33  340IDAS
0347 I                                       35  38 BRKC
0348 I                                    P  39  450BAGE
0349 I                                       46  48 CCY
0350 I                                    P  49  550PUPR
0351 I                                    P  57  627YRAT
0352 I                                    P  71  767RTSP
0353 I                                    P  77  827INTR
0354 I                                       86 105 RNNA
0355 I**********                            106 1110PCUS                                      CSD027
0355 I                                      106 111 PCUS                                      CSD027
0356 I                                      112 1140FACT
0357 I                                      115 1160FCNO
0358 I                                    P 117 1230FVAL
0359 I                                    P 124 1308BCXR
0360 I                                    P 131 1378LCXR
0361 I                                      138 1390SDST
0362 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0363 I                                      152 161 TSTN
0364 I                                      162 1630MDST
0365 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0366 I                                      176 185 TMAN
0367 I                                    P 192 1980DISA
0368 I                                    P 205 2110DPTD
0369 I                                      212 2120ICBS
0370 I                                      213 213 IPFR
0371 I                                    P 214 2200TOTI
0372 I                                    P 221 2230NIDT
0373 I                                    P 224 2260IBDT
0374 I                                    P 227 2290SLID
0375 I                                    P 230 2360AIPD
0376 I                                    P 237 2390DLRC
0377 I                                    P 240 2420IACD
0378 I                                    P 243 2490AITC
0379 I                                    P 250 2560AIAN
0380 I                                    P 257 2630AIAP
0381 I                                    P 264 2700IPRD
0382 I                                    P 271 2770IPRM
0383 I                                    P 278 2840SAPR
0384 I                                      285 2900ASDN
0385 I                                    P 291 2930SADT
0386 I                                    P 294 2960DAVDDD
0387 I                                      297 2990DASNDD
0388 I                                      300 309 FACO
0389 I                                      310 344 SPI
0390 I                                      345 3460INTF
0391 I                                      370 370 DNSI
0392 I                                      371 371 DSTI
0393 I                                      372 372 CNFI
0394 I                                      373 373 ACEI
0395 I                                      374 374 TLXI
0396 I                                    P 391 3930ORED
0397 I                                    P 394 3960LCD
0398 I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 402 BOKC                  S01117
     I                                      403 4080LNKDN                 S01117
     I                                     10371039 ORBR                  S01117
     I                                     10401043 PRFC                  S01117
     I                                     10441046 POBR                  S01117
     I                                     10471049 ROBR                  S01117
     I                                     10511051 JRDFC                 S01392
     I                                     11821199 OMDA                                      CGL029
     I                                     12001217 OSDA                                      CGL029
0400 I*
0401 I*
0402 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
0403 I*
0404 IDEALS   NS  11   8 CE
0405 I                                        1   1 RECI
0406 I                                        2   70DLNODE
0407 I                                        8   8 RCDT
0408 I                                        9  100RCDC
0409 I**********                             11  160CNUM                                      CSD027
0409 I                                       11  16 CNUM                                      CSD027
0410 I*****                                  17  190BRCD                  S01117
0410 I                                       17  19 BRCA                  S01117
0411 I                                       20  21 DTYP
0412 I                                       22  23 DLST
0413 I                                    P  24  260DDAT
0414 I                                    P  27  290VDAT
0415 I                                       35  38 BRKC
0416 I                                    P  39  450BAGE
0417 I                                       46  48 CCY
0418 I                                    P  49  550SAPR
0419 I                                    P  57  627YRAT
0420 I                                    P  77  827INTR
0421 I                                       86 105 RNNA
0422 I**********                            106 1110ISCN                                      CSD027
0422 I                                      106 111 ISCN                                      CSD027
0423 I                                    P 117 1230FVAL
0424 I                                      138 1390SETP
0425 I**********                            140 151 OSAC                                      CGL029
     I                                      140 151 OSACQQ                                    CGL029
0426 I                                      152 161 TSEN
     I                                      162 164 ORBR                  S01117
     I                                      165 167 OSBR                  S01117
     I                                      168 171 PRFC                  S01117
0427 I                                    P 285 2900RPDN
0428 I                                      370 370 DNSI
0429 I                                      371 371 DSTI
0430 I                                      372 372 CNFI
0431 I                                      373 373 ACEI
0432 I                                      374 374 TLXI
0433 I                                    P 391 3930ORED
0434 I                                    P 394 3960LCD
0435 I                                      397 397 CHTP
0436 I                                    P 398 4000TNLU
     I                                      401 402 BOKC                  S01117
     I                                      403 4080LNKDN                 S01117
     I                                     10481065 OSAC                                      CGL029
0437 I*
     I*                                                                   S01119
     I*    DEALS FILE - DETAIL RECORD - FRA/IRS/CAP & COLLAR.             S01119
     I*                                                                   S01119
     I        NS  15   8 CG                                               S01119
     I                                        1   1 RECI                  S01119
     I                                        2   70DLNO                  S01119
     I                                        8   8 RCDT                  S01119
     I                                        9  100RCDC                  S01119
     I**********                             11  160CNUM                               S01119 CSD027
     I                                       11  16 CNUM                                      CSD027
     I                                       17  190BRCD                  S01119
     I                                       20  21 DTYP                  S01119
     I                                       22  23 DLST                  S01119
     I                                    P  24  260DDAT                  S01119
     I                                    P  27  290VDAT                  S01119
     I                                    P  30  320MDAT                  S01119
     I                                       33  340CDAS                  S01119
     I                                       35  38 BRKC                  S01119
     I                                    P  39  450BAGE                  S01119
     I                                       46  510LNKDN                 S01119
     I                                       52  52 HEDIN                 S01119
     I                                       53  53 TAXI                  S01119
     I                                       54  56 UCUCY                 S01119
     I                                    P  57  630UPAMT                 S01119
     I                                       64  650UBRTT                 S01119
     I                                    P  66  717USTRT                 S01119
     I                                    P  72  777UBRTE                 S01119
     I                                    P  78  837URTSP                 S01119
     I                                       84  84 USPIN                 S01119
     I                                    P  85  907UEINR                 S01119
     I                                       91  910UICBS                 S01119
     I                                       92  930UFRFD                 S01119
     I                                    P  94  960UINFD                 S01119
     I                                    P  97  990USLIP                 S01119
     I                                    P 100 1020UNICD                 S01119
     I                                    P 103 1050UICBD                 S01119
     I                                      106 106 UICFR                 S01119
     I                                      107 1080UICFD                 S01119
     I                                    P 109 1110UNIPD                 S01119
     I                                    P 112 1140UIPBD                 S01119
     I                                      115 115 UIPFR                 S01119
     I                                      116 1170UIPFD                 S01119
     I                                    P 118 1248UBCXR                 S01119
     I                                    P 125 1270UIACD                 S01119
     I                                    P 128 1340UIALC                 S01119
     I                                    P 135 1410UAITC                 S01119
     I                                    P 142 1480UAIPD                 S01119
     I                                    P 149 1550UAIAN                 S01119
     I                                    P 156 1620UAIAP                 S01119
     I                                    P 163 1690UIPRD                 S01119
     I                                    P 170 1760UIPRM                 S01119
     I                                    P 177 1830UNSAM                 S01119
     I                                    P 184 1900UTAXD                 S01119
     I                                    P 191 1970UTAXM                 S01119
     I                                      198 200 TCUCY                 S01119
     I                                    P 201 2070TPAMT                 S01119
     I                                      208 2090TBRTT                 S01119
     I                                    P 210 2157TSTRT                 S01119
     I                                    P 216 2217TBRTE                 S01119
     I                                    P 222 2277TRTSP                 S01119
     I                                      228 228 TSPIN                 S01119
     I                                    P 229 2347TEINR                 S01119
     I                                      235 2350TICBS                 S01119
     I                                      236 2370TFRFD                 S01119
     I                                    P 238 2400TINFD                 S01119
     I                                    P 241 2430TSLIP                 S01119
     I                                    P 244 2460TNICD                 S01119
     I                                    P 247 2490TICBD                 S01119
     I                                      250 250 TICFR                 S01119
     I                                      251 2520TICFD                 S01119
     I                                    P 253 2550TNIPD                 S01119
     I                                    P 256 2580TIPBD                 S01119
     I                                      259 259 TIPFR                 S01119
     I                                      260 2610TIPFD                 S01119
     I                                    P 262 2688TBCXR                 S01119
     I                                    P 269 2710TIACD                 S01119
     I                                    P 272 2780TIALC                 S01119
     I                                    P 279 2850TAITC                 S01119
     I                                    P 286 2920TAIPD                 S01119
     I                                    P 293 2990TAIAN                 S01119
     I                                    P 300 3060TAIAP                 S01119
     I                                    P 307 3130TIPRD                 S01119
     I                                    P 314 3200TIPRM                 S01119
     I                                    P 321 3270TNSAM                 S01119
     I                                    P 328 3340TTAXD                 S01119
     I                                    P 335 3410TTAXM                 S01119
     I                                    P 342 3477CLRAT                 S01119
     I                                    P 348 3537FLRAT                 S01119
     I                                    P 354 3550AVPER                 S01119
     I                                    P 356 3638TIRAT                 S01119
     I                                    P 364 3697AACRT                 S01119
     I                                      370 3710RSETM                 S01119
     I**********                            372 383 URACC                              S01119 CGL029
     I                                      372 383 URACQQ                                    CGL029
     I                                      384 393 CPPBK                 S01119
     I                                      394 3950PSETM                 S01119
     I**********                            396 407 UPACC                              S01119 CGL029
     I                                      396 407 UPACQQ                                    CGL029
     I                                      408 417 CPRBK                 S01119
     I                                      418 427 FACO                  S01119
     I                                      428 462 SPI                   S01119
     I                                    P 463 4650SDCAR                 S01119
     I                                    P 466 4680ULPCD                 S01119
     I                                    P 469 4710TLPCD                 S01119
     I                                    P 472 4780UAEXA                 S01119
     I                                    P 479 4850TAEXA                 S01119
     I                                      570 570 UDNSI                 S01119
     I                                      571 571 TDNSI                 S01119
     I                                      572 572 UDSTI                 S01119
     I                                      573 573 TDSTI                 S01119
     I                                      574 574 CNFI                  S01119
     I                                      575 575 ACEI                  S01119
     I                                      576 576 TLXI                  S01119
     I                                    P 587 5880LSWC                  S01119
     I                                    P 589 5900LSWS                  S01119
     I                                    P 591 5930ORED                  S01119
     I                                    P 594 5960LCD                   S01119
     I                                      597 597 CHTP                  S01119
     I                                    P 598 6000TNLU                  S01119
     I                                     22902307 UPACC                                     CGL029
     I                                     23082325 URACC                                     CGL029
0438 I* CATCHALL
0439 I        NS
0440 I                                        1   1 RECI
0209 I*                                                                   S01392
0210 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS     S01392
0211 I*                                                                   S01392
0212 IDRSDEALSNS                                                          S01392
0212 I                                    P 214 2200TOTI2                 S01392
0441 I*
0442 I*
0443 I*    DEALS AMENDMENT FILE - DETAIL RECORD.
0444 I*
0445 IDEAMS   NS  12   1 CD
0446 I       OR   13   1 CR
0447 I                                        1   1 RECIDI
0448 I                                        2   70DLNODI
0449 I                                        8  120VDATDI
0450 I                                       13  150DASNDI
0451 I                                       16  17 DTYPDI
0452 I                                       18  19 DLSTDI
0453 I                                       20  21 AMTPDI
0454 I                                       22  220PSEQDI
0455 I                                       23  240BRTTDI
0456 I                                    P  25  307RTSPDI
0457 I                                       31  33 CCYDI
0458 I                                    P  34  400DAAMDI
0459 I                                       41  41 MOGIDI
0460 I**********                             42  470CNUMDI                                    CSD027
0460 I                                       42  47 CNUMDI                                    CSD027
0461 I                                       48  490SETPDI
0462 I**********                             50  61 OSACDI                                    CGL029
     I                                       50  61 OSACQQ                                    CGL029
0463 I                                       62  71 TSENDI
0464 I                                       72  81 FACODI
0465 I                                       82 116 SPIDI
     I                                      117 119 OSBR                  S01117
0466 I                                    P 139 1410NAADDI
0467 I                                      142 1440NASNDI
0468 I                                      145 145 DAINDI
0469 I                                    P 191 1930OREDDI
0470 I                                    P 194 1960LCDDI
0471 I                                      197 197 CHTPDI
0472 I                                    P 198 2000TNLU
     I                                      880 897 OSACDI                                    CGL029
0473 I*
0474 I* CATCHALL
0475 I        NS
0476 I                                        2   70DLNODI
0477 I                                    P 139 1410NAADDI
0478 I                                      142 1440NASNDI
0479 I*****                                                       *****   S01194
0480 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.       *****   S01194
0481 I*****                                                       *****   S01194
0482 I*ABLE   NS       2 C0   3 C1  12 C1                         *****   S01194
0483 I*****  AND      13 C0                                       *****   S01194
0484 I*****                                   1   1 RECI          *****   S01194
0485 I*****                                   2   30RECT          *****   S01194
0486 I*****                                  12  130RCDE          *****   S01194
0487 I*****                                  14  66 TITL          *****   S01194
0488 I*****                                  67  67 DATF          *****   S01194
0489 I*****                                  68  700DFBR    20****S01117  S01194
0489 I*****                                  68  70 DFBM    20****S01117  S01194
     I*****                                  72  72 CHIM          *****   S01194
0490 I*****                                  73  73 SWIM          *****   S01194
0491 I*****                                  74  74 MODI1         *****   S01194
0492 I*****                                  75  75 MODI2         *****   S01194
0493 I*****                                  76  76 MODI3         *****   S01194
0494 I*****                               P  77  790RUND          *****   S01194
0495 I*****                                  80  86 RUNA          *****   S01194
0496 I*****                                  87  870SFLG          *****   S01194
0497 I*****                               P  90  920LCD           *****   S01194
0498 I*****                                  93  93 CHTP          *****   S01194
0499 I*****                               P  94  960TNLU          *****   S01194
0500 I*****                                                       *****   S01194
0501 I*****                                                       *****   S01194
0502 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.       *****   S01194
0503 I*****                                                       *****   S01194
0504 I*****   NS              2 C0   3 C1                         *****   S01194
0505 I*****  AND      12 C1  13 C1                                *****   S01194
0506 I*****                                   1   1 RECI          *****   S01194
0507 I*****                                   2   30RECT          *****   S01194
0508 I*****                                  12  130RCDE          *****   S01194
0509 I*****                                  14  16 BCCY          *****   S01194
0510 I*****                                  17  19 BCYL          *****   S01194
0511 I*****                                  20  22 HOCY          *****   S01194
0512 I*****                                  23  280HEAD          *****   S01194
0513 I*****                               P  29  310APDA          *****   S01194
0514 I*****                                  35  35 APFQ          *****   S01194
0515 I*****                               P  36  380LOGS          *****   S01194
0516 I*****                                  39  40 CUZR          *****   S01194
0517 I*****                               P  41  430DNWD          *****   S01194
0518 I*****                                  44  460BVLP          *****   S01194
0519 I*****                                  47  49 LOCY          *****   S01194
0520 I*****                                  50  510FDAY          *****   S01194
0521 I*****                                  52  52 ACLD          *****   S01194
0522 I*****                                  86  86 ISAV          *****   S01194
0523 I*****                               P  87  890LLOG          *****   S01194
0524 I*****                               P  90  920LCD           *****   S01194
0525 I*****                                  93  93 CHTP          *****   S01194
0526 I*****                               P  94  960TNLU          *****   S01194
0527 I*****                                                       *****   S01194
0528 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.       *****   S01194
0529 I*****                                                       *****   S01194
0530 I*ABLE   NS              2 C0   3 C1                         *****   S01194
0531 I*****  AND      12 C4  13 C0                                *****   S01194
0532 I*****                                   1   1 RECI          *****   S01194
0533 I*****                                   2   30RECT          *****   S01194
0534 I*****                                  12  130RCDE          *****   S01194
0535 I*****                                  18  210CSAC          *****   S01194
0536 I*****                                  22  22 TLII          *****   S01194
0537 I*****                                  23  23 MCRI          *****   S01194
0538 I*****                               P  24  250MCEP          *****   S01194
0539 I*****                                  26  270MCLP          *****   S01194
0540 I*****                                  28  28 FRDI          *****   S01194
0541 I*****                                  29  29 BRCF          *****   S01194
0542 I*****                                  30  350PSCN          *****   S01194
0543 I***********                            36  380DLBR          S01117  S01194
0543 I*****                                  36  38 DLBR          S01117  S01194
0544 I*****                                  39  420FRPA          *****   S01194
0545 I*****                                  43  460FRPC          *****   S01194
0546 I*****                                  47  49 USCY          *****   S01194
0547 I*****                                  50  52 STCY          *****   S01194
0548 I*****                               P  53  553MBGE          *****   S01194
0549 I*****                                  56  56 PRID          *****   S01194
0550 I*****                                  57  57 FFNY          *****   S01194
0551 I*****                                  58  58 OURC          *****   S01194
0552 I*****                                  59  59 BRNC          *****   S01194
0553 I*****                                  60  60 LCYN          *****   S01194
0554 I*****                                  78  780PR1           *****   S01194
0555 I*****                                  79  790PR2           *****   S01194
0556 I*****                                  80  800PR3           *****   S01194
0557 I*****                                  81  810PR4           *****   S01194
0558 I*****                                  82  820PR5           *****   S01194
0559 I*****                                  83  830PR6           *****   S01194
0560 I*****                                  84  840PR7           *****   S01194
0561 I*****                                  85  850PR8           *****   S01194
0562 I*****                               P  87  892TAXR          *****   S01194
0563 I*****                               P  90  920LCD           *****   S01194
0564 I*****                                  93  93 CHTP          *****   S01194
0565 I*****                               P  94  960TNLU          *****   S01194
0566 I*****                                                       *****   S01194
0567 I*****TABLE FILE - BRANCH CODES RECORD.                      *****   S01194
0568 I*****                                                       *****   S01194
0569 I*ABLE   NS              2 C1   3 C0                         *****   S01194
0570 I*****                                   1   1 RECI          *****   S01194
0571 I*****                                   2   30RECT          *****   S01194
0572 I*****                                  11  130BRCD          S01117  S01194
0572 I*****                                  11  13 BRCA          S01117  S01194
0573 I*****                                  14  43 BRNM          *****   S01194
0574 I*****                                  44  490BICN          *****   S01194
0575 I*****                                  50  51 LOCC          *****   S01194
0576 I*****                                  52  53 CMPY          S01117  S01194
0576 I*****                                  52  54 CMPYM         S01117  S01194
0577 I*****                               P  90  920LCD           *****   S01194
0578 I*****                                  93  93 CHTP          *****   S01194
0579 I*****                               P  94  960TNLU          *****   S01194
0580 I*****                                                       *****   S01194
0581 I*****                                                       *****   S01194
0582 I*****TABLE FILE - NOSTROS RECORD.                           *****   S01194
0583 I*****                                                       *****   S01194
0584 I*ABLE   NS              2 C7   3 C0                         *****   S01194
0585 I*****                                   1   1 RECI          *****   S01194
0586 I*****                                   2   30RECT          *****   S01194
0587 I*****                                   9  11 CCY           *****   S01194
0588 I*****                                  12  130NOSN          *****   S01194
0589 I*****                                  16  29 ONAC          *****   S01194
0590 I*****                                  30  350CNUMTL        *****   S01194
0591 I*****                                  36  370ACSQ          *****   S01194
0592 I*****                                  38  410ACOD          *****   S01194
0593 I*****                               P  90  920LCD           *****   S01194
0594 I*****                                  93  93 CHTP          *****   S01194
0595 I*****                               P  94  960TNLU          *****   S01194
0596 I*****                                                       *****   S01194
0597 I*****CHALL                                                  *****   S01194
0598 I*****   NS                                                  *****   S01194
0599 I*****                                   1   1 RECI          *****   S01194
0600 I*****                                                       *****   S01194
0601 I*****CUSTOMER SHORTNAMES FILE - DETAIL RECORD.              *****   S01194
0602 I*****                                                       *****   S01194
0603 I**AME   NS       1 CD                                       *****   S01194
0604 I*****                                   1   1 RECI          *****   S01194
0605 I*****                                  39  48 CSNM          *****   S01194
0606 I*****                                   2   70CNUMCD        *****   S01194
0607 I*****                                                       *****   S01194
0608 I***ATCHALL                                                  *****   S01194
0609 I*****   NS  41                                              *****   S01194
0610 I*****                                                       *****   S01194
0610 I*****                                                       *****   S01194
0611 I*****CLIENT FILE - CUSTOMER STANDING DATA RECORD.           *****   S01194
0612 I*****                                                       *****   S01194
0613 I*LINT   NS  14   1 CD   8 CA                                *****   S01194
0614 I*****                                   1   1 RECI          *****   S01194
0615 I*****                                   8   8 RCDTCL        *****   S01194
0616 I*****                                   9  28 CRNM          *****   S01194
0617 I*****                                  29  38 CTWN          *****   S01194
0618 I*****                                  39  48 CSNM          *****   S01194
0619 I*****                                  49  56 CASK          *****   S01194
0620 I*****                                  57  68 TELX          *****   S01194
0621 I*****                                  69  80 CSID          *****   S01194
0622 I*****                                  81  82 ACOC          *****   S01194
0623 I*****                                  83  83 CBSI          *****   S01194
0624 I*****                                  84  85 CCTZ          *****   S01194
0625 I*****                                  86  87 CLOC          *****   S01194
0626 I*****                                  88  930CPAR          *****   S01194
0628 I*****                                  97  980LINS          *****   S01194
0629 I*****                                  99 1010LIND          *****   S01194
0630 I*****                               P 102 1040DASU          *****   S01194
0631 I*****                               P 105 1070CDIC          *****   S01194
0632 I*****                               P 108 1100DADE          *****   S01194
0633 I*****                                 111 111 CMIN          *****   S01194
0634 I*****                                 112 112 CTYP          *****   S01194
0635 I*****                                 113 124 TELF          *****   S01194
0636 I*****                                 125 133 CHID          *****   S01194
0637 I*****                                 134 136 CHAB          *****   S01194
0638 I*****                               P 250 2520LCD           *****   S01194
0639 I*****                                 253 253 CHTP          *****   S01194
0640 I*****                               P 254 2560TNLU          *****   S01194
0641 I*****                                                       *****   S01194
0642 I*****CHALL                                                  *****   S01194
0643 I*****                                                       *****   S01194
     I*****   NS                                                  *****   S01194
0645 I*****                                   1   1 RECI          *****   S01194
0392 ISDBANK    E DSSDBANKPD                                              S01194
0393 I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
0393 I*                                                                   S01194
0392 ISDMMOD    E DSSDMMODPD                                              S01194
0393 I* MODULE DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
0393 I*                                                                   S01194
0392 ISDTRAD    E DSSDTRADPD                                              S01194
0393 I* TRADING DETAILS ACCESSED VIA ACCESS PROGRAM                       S01194
0393 I*                                                                   S01194
0392 ISDDEAL    E DSSDDEALPD                                              S01194
0393 I* DEALING DETAILS ACCESSED VIA ACCESS PROGRAM                       S01194
     I              QQACCD                          QQACCX                                    CGL029
0393 I*                                                                   S01194
0392 ISDBRCH    E DSSDBRCHPD                                              S01194
0393 I* BRANCH DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
0393 I*                                                                   S01194
0392 ISDNOST    E DSSDNOSTPD                                              S01194
0393 I* NOSTRO DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
     I              QQACCD                          QQACCY                                    CGL029
0393 I*                                                                   S01194
0392 ISDCUST    E DSSDCUSTPD                                              S01194
0393 I* CUSTOMER DETAILS ACCESSED VIA ACCESS PROGRAM                      S01194
     I              QQDFAC                          QQDFAX                                    CGL029
     I*                                                                   S01194
     I***SDGELR*   E DSSDGELRPD                                                    MD035545 MD047993
     I**GENERAL*LEDGER*DETAILS*ACCESSED*VIA*ACCESS*PROGRAM*************            MD035545 MD047993
     I**********    QQACCD                          ACCDQQ                         MD035545 MD047993
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
0393 I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                                                  CDL081
0646 I/EJECT
0649 I            DS
0647 I* D A T A   S T R U C T U R E S
0648 I* KEY FIELDS ON TRANS/DAIND FOR DUPLICATE KEY TEST
0650 I                                        1  14 KEY
0651 I                                        1   60DLNO
0652 I                                        7  110VDATDL
0653 I                                       12  140DASNDL
0654 I**LF TABLE KEY                                                      S01194
0655 I*****       DS                                                      S01194
0656 I*****                                   1  12 ZTABKY                S01194
0657 I*****                                   1   20RECT                  S01194
0658 I*****                                   8  10 CCY                   S01194
0659 I*****                                  11  120NOSN                  S01194
0660 I* KEY FROM DEALS,DC TO LF/DEAMS
0661 I            DS
0662 I                                        1  14 KEY2
0663 I                                        1   60DLNODC
0664 I                                        7  110DAVDDC
0665 I                                       12  140DASNDC
0666 I* KEY FROM DEAMS,DI TO LF/DEAMS - NEXT REC IN CHAIN.
0667 I            DS
0668 I                                        1  14 KEY3
0669 I                                        1   60DLNODI
0670 I                                        7  110NAADDI
0671 I                                       12  140NASNDI
0672 I* KEY FROM DEALS,DD TO LF/DEAMS
0673 I            DS
0674 I                                        1  14 KEY4
0675 I                                        1   60DLNODD
0676 I                                        7  110DAVDDD
0677 I                                       12  140DASNDD
0678 I* BLANK AREA FOR INITIALISING
0679 I            DS
0680 I                                        1  35 BLNK35
0681 I                                        1  10 BLNK10
0682 I* THEIR SETTLEMENT A/C   *START/PURCHASE*
0683 I            DS
0684 I                                        1  10 TSET1
0685 I                                        1  10 TSCN
0686 I                                        1  10 TSTN
0687 I                                        1  10 TSEN
0688 I* THEIR SETTLEMENT A/C   *MATURITY/SELL*
0689 I            DS
0690 I                                        1  10 TSET2
0691 I                                        1  10 TPCN
0692 I                                        1  10 TMAN
0693 I* TO CHANGE SHORT-NAME TO CUSTOMER NUMBER IF APPLICABLE
0694 I            DS
0695 I                                        1  10 SNCUST
0696 I**********                              1   60CNUMCD                                    CSD027
0696 I                                        1   6 CNUMCD                                    CSD027
0697 I* SETTLEMENT TYPE AT START/PURCHASE
0698 I            DS
0699 I                                        1   20SET1
0700 I                                        1   20PCST
0701 I                                        1   20SDST
0702 I                                        1   20SETP
0703 I* SETTLEMENT TYPE FOR MATURITY/SALE
0704 I            DS
0705 I                                        1   20SET2
0706 I                                        1   20SCST
0707 I                                        1   20MDST
0708 I/EJECT
0709 I* D A T A   S T R U C T U R E   F O R   O U T P U T   R E C O R D
0710 I            DS
0711 I****************************************1 160 PREX                  E22600
0711 I**********                              1 182 PREX                               E22600 CGL029
     I                                        1 230 PREX                                      CGL029
0712 I                                        1   1 RECIPH
0713 I                                        2   2 PAYREC
0714 I                                        3   40SETTLE
0715 I                                        5   50PRODPH
0716 I                                        6   8 CURREN
0717 I**********                              9  20 OURAG                                     CGL029
     I                                        9  20 OURAQQ                                    CGL029
     I                                       21  23 OURSB                 S01117
0718 I                                       31  310FFIN
0719 I* VALUE DATE WILL BE WRITTEN HERE
0720 I                                       35  44 THRAG
0721 I                                       35  40 IFCUST
0722 I**********                             35  400CUST                                      CSD027
0723 I**********                             55  600CNUMPH                                    CSD027
0722 I                                       35  40 CUST                                      CSD027
0723 I                                       55  60 CNUMPH                                    CSD027
0724 I                                       61  660DLNOPH
0725 I* EVENT AMOUNT WILL BE WRITTEN HERE
0726 I                                       75  75 RCDT
0727 I                                       76  780DASNPH
0728 I                                       79  88 OTFACO
0729 I                                       99 133 OTSPI
0730 I                                      134 136 PINDS
0731 I**********                            137 1420BICN                                      CSD027
0731 I                                      137 142 BICN                                      CSD027
0732 I                                      143 144 DTYP
0733 I                                      145 146 DLST
0734 I*****                                 147 1490BRCD                  S01117
0734 I                                      147 149 BRCA                  S01117
0735 I                                      150 1500RCPI
0736 I                                      151 1560RRDN
0737 I                                      157 158 MTIN
     I                                      213 230 OURAG                                     CGL029
0738 I*
     I* DS FOR DTRIEHH FIELDS
     I            DS
     I                                        1   4 ZZ0034
     I                                    P   2   40RRNT
0147 I            DS                             40
0150 I                                    P  14  160NDLR
0151 I                                    P  17  190NDAR
     I                                        7  40 SPARE
     I* DS FOR PSEUDO I/P PROCESSING
     I            DS                              5
     I                                        1   50RIP1
     I                                        1   50RIP5
     I                                        1   50NORE
     IRUNDAT      DS                                                      S01194
     I*  DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.           S01194
     I                                       13  13 @MBIN                 S01194
     I*                                                                                       CDL013
     I@CURR     E DSSDCURRPD                                                                  CDL013
     I** DUMMY RECORD FORMAT FOR CURRENCY DETAILS                                             CDL013
     I*                                                                                       CDL013
      *                                                                   066550
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
      *                                                                   066550
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0304IIP1                                           S01408
      *                                                                                       CDL081
      ** Named constants                                                                      CDL081
      *                                                                                       CDL081
     I              'BasCcyTaxRoundDown'  C         C#BASE                                    CDL081
     I              'NBasCcyTaxRoundDown' C         C#NBAS                                    CDL081
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I*                                                                   S01408
0744 I/EJECT
     C*                                                                   S01194
     C** GET MULTI BRANCH INDICATOR FROM DATA AREA - RUNDAT               S01194
     C           *NAMVAR   DEFN           RUNDAT                          S01194
     C                     IN   RUNDAT                                    S01194
     C/COPY WNCPYSRC,DL0304C022
     C*                                                                   S01194
     C           @MBIN     IFEQ 'Y'                                       S01194
0747 C                     SETON                     44                   S01194
     C                     END                                            S01194
0745 C* 1 S T   C Y C L E   P R O C E S S I N G
0746 C   40                GOTO START
0747 C                     SETON                     4089
0748 C   U7                SETOF                     89
0749 C                     SETOF                     U7
     C                     MOVEACPY@      BIS@   80
0750 C                     MOVE 'D'       RECIPH
0751 C                     MOVEL'10'      BRKEY  12
0752 C*******              EXSR ZSYSTM                            *****   S01194
0753 C***99**              SETON                     LRU760       *****   S01194
0754 C***20**              SETON                     44           *****   S01194
0755 C*******              MOVE ' 11'     ZTABKY                  *****   S01194
0756 C*******              EXSR TABCHN                            *****   S01194
0757 C***99**              SETON                     LRU761       *****   S01194
0758 C*******              MOVE ' 40'     ZTABKY                  *****   S01194
0759 C*******              EXSR TABCHN                            *****   S01194
0760 C***99**              SETON                     LRU762       *****   S01194
0761 C***U7**              GOTO END                               *****   S01194
0327 C* CALL ACCESS PROG. FOR BANK DETAILS.                               S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'001'     DBASE   3        * DBERR 001 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL'FIRST  ' DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
0327 C* CALL MODULE PROG. FOR MODULE DETAILS.                             S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDMMODPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'002'     DBASE   3        * DBERR 002 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL'FIRST  ' DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   BHF147
     C* CALL ACCESS PROGRAM FOR TRADING DETAILS.                          BHF147
     C                     CALL 'AOTRADR0'                                BHF147
     C                     PARM '*MSG   ' @RTCD   7                       BHF147
     C                     PARM '*FIRST ' @OPTN   7                       BHF147
     C           SDTRAD    PARM SDTRAD    DSFDY                           BHF147
0384 C*                                                                   BHF147
     C           @RTCD     IFNE *BLANK                                    BHF147
     C                     MOVEL'SDTRADPD'DBFILE 10        * * * * * * *  BHF147
     C                     MOVEL'017'     DBASE   3        * DBERR 017 *  BHF147
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  BHF147
     C                     MOVEL'FIRST  ' DBKEY  29                       BHF147
0349 C                     SETON                     U7U8LR               BHF147
     C                     EXSR *PSSR                                     BHF147
0350 C                     GOTO END                                       BHF147
     C                     END                                            BHF147
0384 C*                                                                   S01194
     C/COPY WNCPYSRC,DLH00401
0829 C**   I.E. IND 98 ON IF DATE FORMAT IND = 'M'                        S01194
0829 C           BJDFIN    COMP 'M'                      98               S01194
0384 C*                                                                   S01194
0762 C*****      PRID      COMP 'Y'                      46       *****   S01194
0763 C*****      LCYN      COMP 'B'                      25       *****   S01194
0763 C           BLLCTB    COMP 'B'                      25               S01194
0384 C*                                                                   S01194
0327 C* CALL ACCESS PROGRAM FOR DEALING DETAILS.                          S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
0384 C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDEALPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'003'     DBASE   3        * DBERR 003 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL'FIRST  ' DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
0384 C*                                                                   S01194
0764 C                     MOVE ' '       BLNK6   6
0765 C*****                MOVE PR1       PR,1                    *****   S01194
0766 C*****                MOVE PR2       PR,2                    *****   S01194
0767 C*****                MOVE PR3       PR,3                    *****   S01194
0768 C*****                MOVE PR4       PR,4                    *****   S01194
0769 C*****                MOVE PR5       PR,5                    *****   S01194
0770 C*****                MOVE PR6       PR,6                    *****   S01194
0771 C*****                MOVE PR7       PR,7                    *****   S01194
0772 C*****                MOVE PR8       PR,8                    *****   S01194
0773 C*                                                                   S01194
0764 C                     MOVE BLSWPY    PR,1                            S01194
0764 C                     MOVE BLCHPY    PR,2                            S01194
0764 C                     MOVE BLCPPY    PR,3                            S01194
0764 C                     MOVE BLTXPY    PR,4                            S01194
0764 C                     MOVE BLFDPY    PR,5                            S01194
0764 C                     MOVE BLBAPY    PR,6                            S01194
0764 C                     MOVE *BLANK    PR,7                            S01194
0764 C                     MOVE *BLANK    PR,8                            S01194
     C/COPY WNCPYSRC,DL0304C001
0773 C*                                                                   S01194
0774 C**   TEST SWIFT IND
0775 C*****                TESTB'0'       SWIM           30       *****   S01194
0775 C           BGSWDL    COMP 'Y'                      30               S01194
     C**   TEST FOR CHIPS INTERFACE
     C*****                TESTB'0'       CHIM           29       *****   S01194
     C           BGCHDL    COMP 'Y'                      29               S01194
     C/COPY WNCPYSRC,DL0304C011
     C**                                                                  S01383
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED     S01383
     C**                                                                  S01383
     C                     CALL 'AOSARDR0'                                S01383
     C                     PARM '       ' @RTCD                           S01383
     C                     PARM '*VERIFY' @OPTN                           S01383
     C                     PARM 'S01383'  @SARD   6                       S01383
     C           @RTCD     IFNE *BLANK                                    S01383
     C           @RTCD     ANDNE'*NRF   '                                 S01383
     C                     MOVEL'SCSARDPD'DBFILE            * * * * * * * S01383
     C                     MOVEL'018'     DBASE             *DBERROR 018* S01383
     C                     MOVEL@RTCD     DBKEY             * * * * * * * S01383
     C                     SETON                     U7U8LR               S01383
     C                     EXSR *PSSR                                     S01383
     C                     GOTO END                                       S01383
     C                     END                                            S01383
     C           @RTCD     IFEQ *BLANK                                    S01383
     C                     MOVEL'Y'       S01383  1                       S01383
     C                     MOVEL'1'       *IN19                           S01383
     C                     END                                            S01383
     C*                                                                   S01383
     C** IF BRT SAR INSTALLED, ACCESS BRT INSTALLATION CONTROL DATA       S01383
     C*                                                                   S01383
     C           S01383    IFEQ 'Y'                                       S01383
     C                     MOVE 'D'       KRECI   1                       S01383
     C           KRECI     CHAINSDBRTDD0             41                   S01383
     C           *IN41     IFEQ '1'                                       S01383
     C                     MOVEL'SDBRTDPD'DBFILE            * * * * * * * S01383
     C                     MOVEL'019'     DBASE             *DBERROR 019* S01383
     C                     SETON                     U7U8LR * * * * * * * S01383
     C                     EXSR *PSSR                                     S01383
     C                     GOTO END                                       S01383
     C                     END                                            S01383
     C*                                                                   S01383
     C** ELSE IF BRT SAR NOT INSTALLED, CHECK FOR HK INTEREST TAX         S01383
     C*                                                                   S01383
     C                     ELSE                                           S01383
0793 C           BNHKTR    COMP 0                    1919  TAX RATE NOT 0 S01383
      *                                                                                       CDL013
      ** Check CDL013 is installed.                                                           CDL013
      *                                                                                       CDL013
     C                     CALL 'AOSARDR0'                                                    CDL013
     C                     PARM '       ' @RTCD                                               CDL013
     C                     PARM '*VERIFY' @OPTN                                               CDL013
     C                     PARM 'CDL013'  @SARD   6                                           CDL013
      *                                                                                       CDL013
      ** If program fails perform standard database error processing                          CDL013
      *                                                                                       CDL013
     C           @RTCD     IFNE *BLANK                                                        CDL013
     C           @RTCD     ANDNE'*NRF   '                                                     CDL013
     C                     MOVEL'SCSARDPD'DBFILE            * * * * * * *                     CDL013
     C                     MOVEL'024'     DBASE             *DBERROR 024*                     CDL013
     C                     MOVEL@RTCD     DBKEY             * * * * * * *                     CDL013
     C                     SETON                     U7U8LR                                   CDL013
     C                     EXSR *PSSR                                                         CDL013
     C                     GOTO END                                                           CDL013
     C                     END                                                                CDL013
      *                                                                                       CDL013
      ** If CDL013 is installed.                                                              CDL013
      *                                                                                       CDL013
     C           @RTCD     IFEQ *BLANK                                                        CDL013
     C                     MOVEL'1'       CDL013  1                                           CDL013
     C                     MOVEL'1'       *IN19                                               CDL013
      *                                                                                       CDL013
      ** Access WHT ICD record to determine WHT rate.                                         CDL013
     C                     MOVEL*BLANKS   ULSTAX 10                                           CDL013
     C                     MOVEL'RETAIL'  ULSTAX                                              CDL013
     C           ULSTAX    CHAINSDSTAAL1             41                                       CDL013
      *                                                                                       CDL013
      ** If no record on file perform standard database error                                 CDL013
      ** processing                                                                           CDL013
      *                                                                                       CDL013
     C           *IN41     IFEQ *ON                                                           CDL013
     C                     MOVELULSTAX    DBKEY                                               CDL013
     C                     MOVEL'SDSTAAL1'DBFILE                                              CDL013
     C                     MOVEL'22'      DBASE   3                                           CDL013
     C                     MOVE *ON       *INU7                                               CDL013
     C                     MOVE *ON       *INU8                                               CDL013
     C                     MOVE *ON       *INLR                                               CDL013
     C                     EXSR *PSSR                                                         CDL013
     C                     ENDIF                                                              CDL013
     C                     END                                                                CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0304CCP1                                           S01408
     C*                                                                   S01408
     C                     END                                            S01383
     C/COPY WNCPYSRC,DLH00402
      *                                                                                       CDL081
      ** Check if CDL081 is installed                                                         CDL081
      *                                                                                       CDL081
     C                     MOVE 'N'       CDL081  1                                           CDL081
     C                     CALL 'AOSARDR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD   7                                           CDL081
     C                     PARM '*VERIFY' POPTN   7                                           CDL081
     C                     PARM 'CDL081'  PSARD   6                                           CDL081
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C           PRTCD     ANDNE'*NRF   '                                                     CDL081
     C                     MOVEL'075'     DBASE                                               CDL081
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL081
     C                     MOVEL'CDL081'  DBKEY                                               CDL081
     C                     SETON                     U7U8LR                                   CDL081
     C                     EXSR *PSSR                                                         CDL081
     C                     GOTO END                                                           CDL081
     C                     END                                                                CDL081
      *                                                                                       CDL081
     C           PRTCD     IFEQ *BLANKS                                                       CDL081
     C                     MOVE 'Y'       CDL081                                              CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Access withholding tax round down system values if CDL081 is on                      CDL081
      *                                                                                       CDL081
     C           CDL081    IFEQ 'Y'                                                           CDL081
     C                     CALL 'AOSVALR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD                                               CDL081
     C                     PARM C#BASE    SVALK1 20                                           CDL081
     C                     PARM           SVAL1 200                                           CDL081
     C                     PARM C#NBAS    SVALK2 20                                           CDL081
     C                     PARM           SVAL2 200                                           CDL081
     C                     PARM *BLANK    SVALK3 20                                           CDL081
     C                     PARM           SVAL3 200                                           CDL081
     C                     PARM *BLANK    SVALK4 20                                           CDL081
     C                     PARM           SVAL4 200                                           CDL081
     C                     PARM *BLANK    SVALK5 20                                           CDL081
     C                     PARM           SVAL5 200                                           CDL081
     C                     PARM *BLANK    SVALK6 20                                           CDL081
     C                     PARM           SVAL6 200                                           CDL081
     C                     PARM *BLANK    SVALK7 20                                           CDL081
     C                     PARM           SVAL7 200                                           CDL081
     C                     PARM *BLANK    SVALK8 20                                           CDL081
     C                     PARM           SVAL8 200                                           CDL081
     C                     PARM *BLANK    SVALK9 20                                           CDL081
     C                     PARM           SVAL9 200                                           CDL081
     C                     PARM *BLANK    SVALK0 20                                           CDL081
     C                     PARM           SVAL10200                                           CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C                     MOVEL'076'     DBASE                                               CDL081
     C                     MOVEL'SDSVALPD'DBFILE                                              CDL081
     C           SVAL1     IFEQ '*NRF'                                                        CDL081
     C                     MOVELSVALK1    DBKEY                                               CDL081
     C                     ENDIF                                                              CDL081
     C           SVAL2     IFEQ '*NRF'                                                        CDL081
     C                     MOVELSVALK2    DBKEY                                               CDL081
     C                     ENDIF                                                              CDL081
     C                     SETON                     U7U8LR                                   CDL081
     C                     EXSR *PSSR                                                         CDL081
     C                     GOTO END                                                           CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Setup tax amount rounding down indicators                                            CDL081
      *                                                                                       CDL081
     C                     MOVELSVAL1     W#BSRD  1                                           CDL081
     C                     MOVELSVAL2     W#NBRD  1                                           CDL081
     C                     ENDIF                                                              CDL081
0776 C*****TEST*TAX*RATE                                                  S01383
0777 C*****      TAXR      COMP 0                 ***1919**TAX*RATE*NOT*0 S01194
0777 C***********BNHKTR    COMP 0                    1919  TAX RATES01194 S01383
0778 C* IF SINGLE BRANCH INSTALLATION
0779 C   44                GOTO ENDBNK
0780 C*******              MOVE DFBR      ZTABKY                  S01117  S01194
0780 C*****                MOVE DFBM      ZTABKY              ****S01117  S01194
0780 C*****                MOVE BJEGCD    ZTABKY                  *****   S01194
0781 C*******              MOVEL'10'      ZTABKY                  *****   S01194
078  C**N42**              EXSR TABCHN                            *****   S01194
0783 C***99**              SETON                     LRU763       *****   S01194
0784 C***99**              GOTO END                               *****   S01194
     C           *IN42     IFEQ '0'                                       S01194
0327 C* CALL ACCESS PROG. FOR BRANCH DETAILS                              S01194
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BJSBRC    @BRKEY  3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBRCHPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'004'     DBASE   3        * DBERR 004 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVELBJSBRC    DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
     C                     END                                            S01194
      *****************************************************************            MD035545 MD047993
      ***Call*access*program*for*General*Ledger*details.***************            MD035545 MD047993
      *****************************************************************            MD035545 MD047993
     C**********           CALL 'AOGELRR1'                                         MD035545 MD047993
     C**********           PARM '*MSG   ' @RTCD   7                                MD035545 MD047993
     C**********           PARM '*FIRST ' @OPTN   7                                MD035545 MD047993
     C********** SDGELR    PARM SDGELR    DSSDY                                    MD035545 MD047993
      *                                                                                     MD035545
     C********** @RTCD     IFNE *BLANK                                             MD035545 MD047993
     C**********           MOVEL'SDGELRPD'DBFILE                                   MD035545 MD047993
     C**********           MOVEL'062'     DBASE                                    MD035545 MD047993
     C**********           MOVEL@OPTN     DBKEY                                    MD035545 MD047993
     C**********           EXSR *PSSR                                              MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
      *                                                                                     MD035545
      ** Retrieve system value setting                                                      MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   W0RTCD  7                                         MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'                             MD035545
      *                                                                                     MD035545
     C           W0RTCD    IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C                     MOVE WCALC6    SCALC6  1                                         MD051554
0785 C           ENDBNK    TAG                             ** ENDBNK TAG**
0786 C                     GOTO END
0787 C/SPACE 3
0788 C           START     TAG                             ** START TAG **
0789 C* RESET INDS.
0790 C                     SETOF                     707172
0791 C                     SETOF                     737475
0792 C******************   SETOF  ****************   7677 ************    S01119
0792 C                     SETOF                     767787               S01119
0793 C                     SETOF                     313233
0794 C                     SETOF                     5839
0795 C                     SETOF                     2426
0796 C                     SETOF                     8338
      *                                                                                     MD051554
      ** If FRA/IRS then core interest calculation otherwise when the system                MD051554
      ** value is set to Y, then the interest calculation period covering                 MD051554
      ** December will be one day shorter, and the period in January will be                MD051554
      ** one day longer for calculation basis 6                                             MD051554
      *                                                                                     MD051554
     C           *IN15     IFEQ '1'                                                         MD051554
     C                     MOVE 'N'       WCALC6                                            MD051554
     C                     ELSE                                                             MD051554
     C                     MOVE SCALC6    WCALC6                                            MD051554
     C                     ENDIF                                                            MD051554
     C* PSEUDO I/P PROCESSING
     C   04                MOVE RIP1      RIP,1
0152 C* IF I/P CYCLE THEN AS LF/DTRIN TRAILER
     C   04                Z-ADDRIP5      RIP,5
0797 C/EJECT
0798 C* M A I N L I N E   O F   P R O C E S S I N G
0799 C* END OF DAY
0800 C  N89                GOTO NOTEOD
0802 C   03                EXSR PROC3
0803 C   04                EXSR TTRANS                     CONTROLS
0805 C   06                EXSR PROC4
0806 C   07                EXSR TDAIND                     CONTROLS
0807 C                     GOTO END
0808 C/SPACE 3
0809 C* ELSE IF NOT END OF DAY
0810 C           NOTEOD    TAG                             ** NOTEOD TAG**
0812 C   03                EXSR PROC5
0813 C   04                EXSR TTRANS                     CONTROLS
0814 C           END       TAG                             **  END TAG  **
0815 C/SPACE 3
0816 C* E N D   O F   M A I N L I N E
0817 C/SPACE 3
0818 C/SPACE 3
     C** TOTAL TIME PROCESSING                                            S01117
     C*                                                                   S01117
     C** IF NO RECORDS ON FILE THEN READ BANK DETAILS FOR OUTPUT          S01117
     CLR   N40             EXSR #ZZ                                       S01117
     CLR   N40             MOVE '0'       *IN25                           S01117
     CLR    40             MOVE '1'       *IN25                           S01117
     C*                                                                   S01117
0819 C* FOR CONTROLS ON LF/PREX TRAILERS
0820 C*****LR         ROP       ADD  2         ROP     50                 S01117
0820 CLR    40   ROP       ADD  2         ROP     50                      S01117
0821 C/EJECT
0822 C*                     E N D   O F   D A Y
0823 C/SPACE 3
0824 C* P R O C E S S  .3.      - LF / D L I N D
0825 C*
0826 C           PROC3     BEGSR                           ***  PROC3  ***
0827 C* I/P CONTROLS
0828 C           RIP,3     ADD  1         RIP,3
     C**                                                                  E11193
     C* FRA/IRS CHANGES TO DL0279 NOW ALLOW PAY/RECEIVE INDICATORS TO     E11193
     C* BE SET ON MORE THAN 1 DLIND RECORD FOR A DEAL, SO THIS CHECK      E11193
     C* SHOULD NO LONGER BE MADE.                                         E11193
     C*                                                                   E11193
0830 C* THIS KEY EQ. LAST KEY - IF SO GOTO END.                           E11193
0831 C***        KEY       COMP PREKEY                   42               E11193
0832 C***42                GOTO P3END                                     E11193
0833 C***                  MOVE KEY       PREKEY 14        SAVE KEY FIELD E11193
0834 C* IF ANY PAY/RECEIVE IND SET THEN DO PROCESS DEAL
0835 C   21
0836 COR 22
0837 COR 23                EXSR PROC1
0838 C*
0839 C           P3END     ENDSR                           ** P3END TAG **
0840 C********************************************************************
0841 C/SPACE 2
0842 C* P R O C E S S  .4.      - LF / D A I N D
0843 C*
0844 C           PROC4     BEGSR                           ***  PROC4  ***
0845 C* I/P CONTROLS
0846 C           RIP,4     ADD  1         RIP,4
0847 C*
0848 C* THIS KEY EQ..LAST KEY - IF SO GOTO END.
0849 C           KEY       COMP PREKEY                   42
0850 C   42                GOTO P4END
0851 C                     MOVE KEY       PREKEY 14        SAVE KEY FIELD
0852 C* IF ANY PAY/RECEIVE IND SET THEN DO PROCESS AMENDMENT
0853 C   21
0854 COR 22
0855 COR 23                EXSR PROC2
0856 C*
0857 C           P4END     ENDSR                           ** P4END TAG **
0858 C********************************************************************
0859 C/EJECT
0860 C*                  N O T   E N D   O F   D A Y
0861 C/SPACE 3
0862 C* P R O C E S S  .5.      - LF / D T R I N
0863 C*
0864 C           PROC5     BEGSR                           ***  PROC5  ***
0865 C* I/P CONTROLS
0866 C           RIP,3     ADD  1         RIP,3
0867 C*
0868 C* THIS KEY EQ. LAST KEY - IF SO GOTO END.
0869 C           KEY       COMP PREKEY                   42
0870 C   42                GOTO P5END
0871 C                     MOVE KEY       PREKEY           SAVE KEY FIELD
0872 C           CHTP      COMP 'A'                      42
0873 C  N42      CHTP      COMP 'I'                      42
0874 C*  42 SET IF ACTION CODE EQ 'A' OR 'I'
0875 C* IF ANY PAY/RECEIVE IND SET AND '42' THEN CONTINUE - ELSE END
0876 C*
0877 C  N21N22N23
0878 CORN42                GOTO P5END                      ELSE OPTION
0879 C*
0880 C*
0881 C           RCDT      COMP 'D'                      42
0882 C   42                EXSR PROC1                      DO DEAL
0883 C           RCDT      COMP 'A'                      42
0884 C   42                EXSR PROC2                      DO AMENDMENT
0885 C*
0886 C           P5END     ENDSR                           ** P5END TAG **
0887 C********************************************************************
0888 C/EJECT
0889 C* P R O C E S S  .1.      - D E A L S
0890 C*
0891 C           PROC1     BEGSR                           ***  PROC1  ***
0892 C* GET LF/DEALS RECORD
0893 C           DLNO      CHAINDEALS                41
0894 C***41                SETON                     LRU764       *****   S01194
0894 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEALS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'005'     DBASE   3        * DBERR 005 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELDLNO      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
0895 C           RECI      COMP 'D'                      42
0896 C   41
0897 CORN42                GOTO P1END
     C*                                                                   S01392
     C* RESET ROUND DOWN AND FRONT-UP INTEREST INDS                       S01392
     C* IF NOT LOAN/DEPOSIT OR NA PURCHASED DEAL                          S01392
     C*                                                                   S01392
     C  N09N10             MOVEL*BLANK    JRDFC                           S01392
     C  N09                MOVEL*BLANK    FUID                            S01392
0975 C*                                                                   S01354
0976 C**      IGNORE Internal Funding Deals                               S01354
0977 C*                                                                   S01354
0978 C           DTYP      IFEQ 'IL'                                      S01354
0979 C           DTYP      OREQ 'ID'                                      S01354
0982 C                     GOTO P1END                                     S01354
0982 C                     END                                            S01354
0977 C*                                                                   S01354
0898 C******************   EXSR CONVER ***********************            S01119
0898 C  N15                EXSR CONVER                                    S01119
0899 C*
0900 C*    DETERMINE 'IT' 'CD' OR 'TD' DEAL
0901 C   09    19DTYP      COMP 'IT'                     24
0902 C   09N24 19DTYP      COMP 'CD'                     24
0903 C   09N24 19DTYP      COMP 'TD'                     24
0904 C*
0905 C*    DETERMINE TAXABLE
0906 C   19      TAXI      COMP 'Y'                      26
      *                                                                                       CDL013
      ** Additional check on ind.19 and taxable ind. if CDL013 is                             CDL013
      ** installed                                                                            CDL013
      *                                                                                       CDL013
     C           CDL013    IFEQ *ON                                                           CDL013
     C           *IN19     IFEQ *ON                                                           CDL013
     C           TAXI      ANDNE'0'                                                           CDL013
     C                     MOVE *ON       *IN26                                               CDL013
     C                     ENDIF                                                              CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0304CCP2                                           S01408
     C*                                                                   S01408
0907 C*
0908 C*
0909 C* 'CASE' ON TYPE OF DEAL
0910 C*
0911 C* IF FOREIGN EXCHANGE
0912 C           RCDC      COMP 11                       42
0913 C  N42      RCDC      COMP 12                       42
0914 C  N42      RCDC      COMP 13                       42
0915 C  N42      RCDC      COMP 14                       42
0915 C  N42      RCDC      COMP 10                       42               S01108
0916 C   42 08             EXSR PROCAA                     DO DL0304-A A
0917 C* IF POSITION SWAP
0918 C  N42      RCDC      COMP 20                       42
0919 C   42 08             GOTO P1END
0920 C* IF LOAN/DEPOSIT PLACED
0921 C           RCDC      COMP 15                       42
0922 C   42 09             EXSR PROCBA                     DO DL0304-B A
0923 C   42 09             GOTO P1END                      DO DL0304-B A
0924 C* IF DEPOSIT ACCEPTED OR C.D. ISSUED
0925 C           RCDC      COMP 16                       42
0926 C   42 09             EXSR PROCBB                     DO DL0304-B B
0927 C   42 09             GOTO P1END
0928 C* IF INTEREST BEARING NEGOTIABLE ASSET PURCHASED
0929 C           RCDC      COMP 17                       42
0930 C           DTYP      COMP 'C1'                     43
0931 C  N43      DTYP      COMP 'C2'                     43
0932 C  N43      DTYP      COMP 'BD'                     43
0933 C  N43      DTYP      COMP 'BP'                     43
0934 C   42 43 10          EXSR PROCBC                     DO DL0304-B C
0935 C   42 43 10          GOTO P1END
0936 C* IF NON-INTEREST BEARING NEGOTIABLE ASSET PURCHASED
0937 C           RCDC      COMP 17                       42
0938 C           DTYP      COMP 'TB'                     43
0939 C  N43      DTYP      COMP 'TA'                     43
0940 C  N43      DTYP      COMP 'DA'                     43
0941 C   42 43 10          EXSR PROCBD                     DO DL0304-B D
0942 C   42 43 10          GOTO P1END
0943 C* NEGOTIABLE ASSET SOLD
0944 C           RCDC      COMP 18                       42
0945 C   42 11             EXSR PROCBE                     DO DL0304-B E
0946 C   42 11             GOTO P1END
     C*                                                                   S01119
     C* IF END OF DAY SELECT FRA/IRS RECORDS FOR PROCBH TO PROCESS        S01119
     C*                                                                   S01119
     C           *IN89     IFEQ '1'                                       S01119
     C           *IN15     ANDEQ'1'                                       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C           DTYP      OREQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C**         DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     EXSR PROCBH                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
0947 C* A N Y   O T H E R S
0948 C* NULL
0949 C*
0950 C           P1END     ENDSR                           ** P1END TAG **
0951 C********************************************************************
0952 C/EJECT
0953 C* P R O C E S S  .2.      - D E A L   A M E N D M E N T S
0954 C*
0955 C           PROC2     BEGSR                           ***  PROC2  ***
0956 C* GET LF/DEAMS RECORD
0957 C           KEY       CHAINDEAMS                41
0958 C***41                SETON                     LRU766       *****   S01194
0894 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'006'     DBASE   3        * DBERR 006 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY       DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
0959 C   41                GOTO P2END
0960 C* TEST IF TELEX BIT ON OR OFF - ONLY FOR I/P CYCLE
0961 C  N89                TESTB'1'       DAINDI         42-IF ON
0962 C  N12
0963 COR 42N89             GOTO P2END
0964 C           DLNO      CHAINDEALS                41
0965 C***41**              SETON                     LRU767       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEALS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'007'     DBASE   3        * DBERR 007 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELDLNO      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
0966 C   41                GOTO P2END
0967 C           RECI      COMP 'D'                      42
0968 C  N42                GOTO P2END
     C*                                                                   S01392
     C* RESET ROUND DOWN AND FRONT-UP INTEREST INDS                       S01392
     C* IF NOT LOAN/DEPOSIT OR NA PURCHASED DEAL                          S01392
     C*                                                                   S01392
     C  N09N10             MOVEL*BLANK    JRDFC                           S01392
     C  N09                MOVEL*BLANK    FUID                            S01392
0975 C*                                                                   S01354
0976 C**      IGNORE Internal Funding Deals                               S01354
0977 C*                                                                   S01354
0978 C           DTYP      COMP 'IL'                     42               S01354
0979 C  N42      DTYP      COMP 'ID'                     42               S01354
0982 C   42                GOTO P2END                                     S01354
0977 C*                                                                   S01354
0969 C                     EXSR CONVER
0970 C*
0971 C*    DETERMINE 'IT' 'CD' OR 'TD' DEAL
0972 C   09    19DTYP      COMP 'IT'                     24
0973 C   09N24 19DTYP      COMP 'CD'                     24
0974 C   09N24 19DTYP      COMP 'TD'                     24
0975 C*
0976 C*    DETERMINE TAXABLE
0977 C   19      TAXI      COMP 'Y'                      26
      *                                                                                       CDL013
      ** Additional check on ind.19 and taxable ind. if CDL013 is                             CDL013
      ** installed                                                                            CDL013
      *                                                                                       CDL013
     C           CDL013    IFEQ *ON                                                           CDL013
     C           *IN19     IFEQ *ON                                                           CDL013
     C           TAXI      ANDNE'0'                                                           CDL013
     C                     MOVE *ON       *IN26                                               CDL013
     C                     ENDIF                                                              CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0304CCP3                                           S01408
     C*                                                                   S01408
0978 C*
0979 C           RCDC      COMP 15                       42
0980 C  N42      RCDC      COMP 17                       42
0981 C   42                EXSR PROCBF                     DO DL0304-B F
0982 C           RCDC      COMP 16                       42
0983 C   42                EXSR PROCBG                     DO DL0304-B G
     C*                                                                   S01119
     C* IF END OF DAY SELECT FRA/IRS RECORDS FOR PROCBH TO PROCESS        S01119
     C*                                                                   S01119
     C           *IN89     IFEQ '1'                                       S01119
     C           *IN15     ANDEQ'1'                                       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C           DTYP      OREQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C**         DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     EXSR PROCBH                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
0984 C*                                                                   S01119
0985 C           P2END     ENDSR                           ** P2END TAG **
0986 C********************************************************************
0987 C/SPACE 3
0988 C********************************************************************
0989 C* CONVERT SHORT-NAME TO CUSTOMER NUMBER ON THEIR SETTLEMENT A/C
0990 C*  AND 'FOR A/C OF' IF SETTLEMENT TYPES 01 07 OR 08.
0991 C           CONVER    BEGSR                           *** CONVER ***
0992 C           SET1      COMP 01                       42
0993 C  N42      SET1      COMP 07                       42
0994 C  N42      SET1      COMP 08                       42
0995 C  N42                GOTO CON2
0996 C* CONVERT THEIR SETTLEMENT A/C *START/PURCHASE*
0997 C*****      TSET1     CHAINSNAME                41           *****   S01194
0998 C**N41                MOVE SNCUST    TSET1                   *****   S01194
0327 C* CALL ACCESS PROG. FOR CUSTOMER NUMBER DETAILS.                    S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM TSET1     @CLKEY 10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
0998 C                     MOVE BBCUST    TSET1                           S01194
2172 C                     END                                            S01194
0999 C* QUIT IF NEG. ASSET SOLD
1000 C   11                GOTO ENDCV
1001 C* SETTLEMENT TYPES 01 07 OR 08
1002 C           CON2      TAG                             **  CON2 TAG **
1003 C           SET2      COMP 01                       42
1004 C  N42      SET2      COMP 07                       42
1005 C  N42      SET2      COMP 08                       42
1006 C  N42                GOTO ENDCV
1007 C* CONVERT THEIR AGENT *MATURITY/SELL*
1008 C*****      TSET2     CHAINSNAME                41           *****   S01194
1009 C**N41                MOVE SNCUST    TSET2                   *****   S01194
0327 C* CALL ACCESS PROG. FOR CUSTOMER NUMBER DETAILS.                    S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM TSET2     @CLKEY 10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
0998 C                     MOVE BBCUST    TSET2                           S01194
2172 C                     END                                            S01194
1010 C* CONVERT 'FOR A/C OF'
1011 C*****      FACO      CHAINSNAME                41           *****   S01194
1012 C**N41                MOVE SNCUST    FACO                    *****   S01194
0327 C* CALL ACCESS PROG. FOR CUSTOMER NUMBER DETAILS.                    S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM FACO      @CLKEY 10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
0998 C                     MOVE BBCUST    FACO                            S01194
2172 C                     END                                            S01194
1013 C           ENDCV     ENDSR                           ** ENDCV TAG **
1014 C********************************************************************
1015 C/EJECT
1016 C********************************************************************
1017 C* F O R E I G N   E X C H A N G E   * DL0304-AA *
1018 C           PROCAA    BEGSR                           *** PROCAA ***
1019 C                     SETON                     70
1020 C* B U Y   C U R R E N C Y   P R O C E S S I N G
1021 C                     TESTB'0'       TLXI           42
1022 C   42N89
1023 CORN21                GOTO SELLAA
1024 C                     SETON                     31
1025 C                     MOVE PCST      SETTLE  20       ** BUY CURRENCY
1026 C                     MOVE 'R'       PAYREC  1         *
1027 C                     MOVE OPCA      OURAG             *
     C                     MOVE ROBR      OURSB             *             S01117
1028 C                     MOVE TSCN      THRAG             *
1029 C                     MOVE PUCY      CURREN  3         *
1030 C                     EXSR CREATE                     **
1031 C* S E L L   C U R R E N C Y   P R O C E S S I N G
1032 C           SELLAA    TAG
1033 C                     TESTB'1'       TLXI           42
1034 C   42N89
1035 CORN23                GOTO ENDAA
1036 C                     SETON                     33
1037 C                     MOVE SCST      SETTLE           ** SELL CURREN.
1038 C                     MOVE 'P'       PAYREC            *
1039 C                     MOVE OSCA      OURAG             *
     C                     MOVE POBR      OURSB             *             S01117
1040 C                     MOVE TPCN      THRAG             *
1041 C                     MOVE SLCY      CURREN            *
1042 C                     EXSR CREATE                     **
1043 C           ENDAA     ENDSR
1044 C********************************************************************
1045 C/SPACE 3
1046 C********************************************************************
1047 C* L O A N S   A N D   D E P O S I T S   P L A C E D   * DL0304-B A *
1048 C           PROCBA    BEGSR                           *** PROCBA ***
1049 C                     SETON                     71
1050 C* START DATE PROCESSING
1051 C                     TESTB'0'       TLXI           42
1052 C   42N89
1053 CORN21                GOTO INTBA
1054 C                     SETON                     31
1055 C           RODA      COMP 0                    57
1056 C                     MOVE SDST      SETTLE
1057 C                     MOVE 'P'       PAYREC
1058 C                     MOVE OSDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
1059 C                     MOVE TSTN      THRAG
1060 C                     MOVE CCY       CURREN
1061 C   57 89             EXSR OPREX4                     CREATEPFS/PREX4
1062 C  N57                EXSR CREATE
1063 C* INTREST DATE PROCESSING
1064 C           INTBA     TAG                             ** INTBA TAG **
1065 C                     TESTB'2'       TLXI           42
1066 C   42N89
1067 CORN22                GOTO MATBA
1068 C                     SETON                     32
1069 C                     EXSR INTRES
1070 C                     MOVE MDST      SETTLE
1071 C                     MOVE 'R'       PAYREC
1072 C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
1073 C                     MOVE TMAN      THRAG
1074 C                     MOVE CCY       CURREN
1075 C           INTC      COMP 'Y'                      49
1076 C                     EXSR CREATE
1077 C                     SETOF                     49
1078 C* MATURITY DATE PROCESSING
1079 C           MATBA     TAG                             ** MATBA TAG **
1080 C                     TESTB'1'       TLXI           42
1081 C   42N89
1082 CORN23                GOTO ENDBA
1083 C                     SETON                     33
1084 C                     EXSR INTRES
1085 C                     MOVE MDST      SETTLE
1086 C                     MOVE 'R'       PAYREC
1087 C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
1088 C                     MOVE TMAN      THRAG
1089 C                     MOVE CCY       CURREN
1090 C* IF 'ROLLED OVER BY DEAL AMOUNT' NGT ZERO
1091 C           RBDA      COMP 0                    42
1092 C   42                GOTO GTBA
     C           IPFR      IFNE 'N'                                       E49966
1093 C           PCPL      ADD  INTDUE    AMTDUE
     C                     ELSE                                           E49966
     C                     Z-ADDPCPL      AMTDUE                          E49966
     C                     END                                            E49966
1094 C                     EXSR CREATE
1095 C                     GOTO ENDBA
1096 C* ELSE 'ROLLED OVER BY DEAL AMOUNT' GT ZERO
1097 C           GTBA      TAG                             ** GTBA TAG **
1098 C           INTDUE    ADD  PCPL      AMTDUE 130
     C           IPFR      IFEQ 'N'                                       AUS003
     C                     Z-ADDPCPL      AMTDUE                          AUS003
     C                     END                                            AUS003
1101 C           AMTDUE    SUB  RBDA      AMTDUE     57
1102 C* CREATE PFS/PREX4 WITH 'RBDA' AS THE AMOUNT
1103 C  N57                SETON                     47
     C*                                                                   S01392
     C* IF FRONT-UP INTEREST = Y                                          S01392
     C*                                                                   S01392
     C           FUID      IFEQ 'Y'                                       S01392
1104 C                     EXSR OPREX4                                    S01392
     C                     ELSE                                           S01392
1104 C  N57 89             EXSR OPREX4
     C                     END                                            S01392
1105 C  N57                SETOF                     47
1106 C  N57                GOTO ENDBA                      DIFF NOT POSVE
1107 C* CREATE S/PREXX WITH 'AMTDUE' AS THE AMOUNT
1108 C                     SETON                     33
1109 C                     EXSR CREATE
1110 C           ENDBA     ENDSR                           ** ENDBA TAG **
1111 C********************************************************************
1112 C/EJECT
1113 C********************************************************************
1114 C* D E P O S I T S   A C C E P T E D , T A K I N G S   * DL0304-B B *
1115 C*   A N D   C . D . ' S   I S S U E D
1116 C           PROCBB    BEGSR                           ***  PROCBB ***
1117 C                     SETON                     72
1118 C* START DATE PROCESSING
1119 C                     TESTB'0'       TLXI           42
1120 C   42N89
1121 CORN21                GOTO INTBB
1122 C                     SETON                     31
1123 C           RODA      COMP 0                    57
1124 C                     MOVE SDST      SETTLE
1125 C                     MOVE 'R'       PAYREC
1126 C                     MOVE OSDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
1127 C                     MOVE TSTN      THRAG
1128 C                     MOVE CCY       CURREN
1129 C   57 89             EXSR OPREX4                     CREATEPFS/PREX4
1130 C  N57                EXSR CREATE
1131 C* INTEREST DATE PROCESSING
1132 C           INTBB     TAG                             ** INTBB TAG **
1133 C                     TESTB'2'       TLXI           42
1134 C   42N89
1135 CORN22                GOTO MATBB
1136 C                     SETON                     32
1137 C                     EXSR INTRES
1138 C                     MOVE MDST      SETTLE
1139 C                     MOVE 'P'       PAYREC
1140 C                     MOVE OMDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
1141 C                     MOVE TMAN      THRAG
1142 C                     MOVE CCY       CURREN
1143 C           INTC      COMP 'Y'                      49
1144 C                     EXSR CREATE
1145 C                     SETOF                     49
1146 C* MATURITY DATE PROCESSING
1147 C           MATBB     TAG                             ** MTABB TAG **
1148 C                     TESTB'1'       TLXI           42
1149 C   42N89
1150 CORN23                GOTO ENDBB
1151 C                     SETON                     33
1152 C                     EXSR INTRES
1153 C                     MOVE MDST      SETTLE
1154 C                     MOVE 'P'       PAYREC
1155 C                     MOVE OMDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
1156 C                     MOVE TMAN      THRAG
1157 C                     MOVE CCY       CURREN
1158 C* IF 'ROLLED OVER BY DEAL AMOUNT' NGT ZERO
1159 C           RBDA      COMP 0                    42
1160 C   42                GOTO GTBB
1161 C           PCPL      ADD  INTDUE    AMTDUE
     C           IPFR      IFEQ 'N'                                       AUS003
     C                     Z-ADDPCPL      AMTDUE                          AUS003
     C                     END                                            AUS003
1162 C                     EXSR CREATE
1163 C                     GOTO ENDBB
1164 C* ELSE 'ROLLED OVER BY DEAL AMOUNT' GT ZERO
1165 C           GTBB      TAG                             ** GTBB TAG **
1166 C           INTDUE    ADD  PCPL      AMTDUE
     C           IPFR      IFEQ 'N'                                       AUS003
     C                     Z-ADDPCPL      AMTDUE                          AUS003
     C                     END                                            AUS003
1169 C           AMTDUE    SUB  RBDA      AMTDUE     57
1170 C* CREATE PFS/PREX4 WITH 'RBDA' AS THE AMOUNT
1171 C  N57                SETON                     47
     C*                                                                   S01392
     C* IF FRONT-UP INTEREST = Y                                          S01392
     C*                                                                   S01392
     C           FUID      IFEQ 'Y'                                       S01392
1104 C                     EXSR OPREX4                                    S01392
     C                     ELSE                                           S01392
1172 C  N57 89             EXSR OPREX4
     C                     END                                            S01392
1173 C  N57                SETOF                     47
1174 C  N57                GOTO ENDBB                      DIFF NOT POSVE
1175 C* CREATE S/PREXX WITH 'AMTDUE' AS THE AMOUNT
1176 C                     SETON                     33
1177 C                     EXSR CREATE
1178 C           ENDBB     ENDSR                           ** ENDBB TAG **
1179 C********************************************************************
1180 C/SPACE 3
1181 C********************************************************************
1182 C* N E G .   A S S E T S   PU R C H . - INT.BEAR * DL0304-BC *
1183 C           PROCBC    BEGSR                           *** PROCBC ***
1184 C                     SETON                     73
1185 C* VALUE DATE PROCESSING
1186 C                     TESTB'0'       TLXI           42
1187 C   42N89
1188 CORN21                GOTO INTBC
1189 C                     SETON                     31
1190 C                     MOVE SDST      SETTLE
1191 C                     MOVE 'P'       PAYREC
1192 C                     MOVE OSDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
1193 C                     MOVE TSTN      THRAG
1194 C                     MOVE CCY       CURREN
1195 C                     EXSR CREATE
1196 C* INTREST DATE PROCESSING
1197 C           INTBC     TAG                             ** INTBC TAG **
1198 C                     TESTB'2'       TLXI           42
1199 C   42N89
1200 CORN22                GOTO MATBC
1201 C                     SETON                     32
1202 C                     MOVE MDST      SETTLE
1203 C                     MOVE 'R'       PAYREC
1204 C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
1205 C                     MOVE TMAN      THRAG
1206 C                     MOVE CCY       CURREN
1207 C                     EXSR CREATE
1208 C* MATURITY DATE PROCESSING
1209 C           MATBC     TAG                             ** MATBC TAG **
1210 C                     TESTB'1'       TLXI           42
1211 C   42N89
1212 CORN23                GOTO ENDBC
1213 C           SADT      COMP 0                    4242
1214 C   42                GOTO ENDBC
1215 C                     SETON                     33
1216 C                     MOVE MDST      SETTLE
1217 C                     MOVE 'R'       PAYREC
1218 C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
1219 C                     MOVE TMAN      THRAG
1220 C                     MOVE CCY       CURREN
1221 C                     EXSR CREATE
1222 C           ENDBC     ENDSR                           ** ENDBC TAG **
1223 C********************************************************************
1224 C/EJECT
1225 C********************************************************************
1226 C* N E G .   A S S E T S   P U R C H . - NON INT.BEAR * DL0304-BD
1227 C           PROCBD    BEGSR                           *** PROCBD ***
1228 C                     SETON                     74
1229 C* VALUE DATE PROCESSING
1230 C  N21                GOTO MATBD
1231 C                     SETON                     31
1232 C                     MOVE SDST      SETTLE
1233 C                     MOVE 'P'       PAYREC
1234 C                     MOVE OSDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
1235 C                     MOVE TSTN      THRAG
1236 C                     MOVE CCY       CURREN
1237 C                     EXSR CREATE
1238 C* MATURITY DATE PROCESSING
1239 C           MATBD     TAG                             ** MATBD TAG **
1240 C  N23                GOTO ENDBD
1241 C           SADT      COMP 0                    4242
1242 C   42                GOTO ENDBD
1243 C                     SETON                     33
1244 C                     MOVE MDST      SETTLE
1245 C                     MOVE 'R'       PAYREC
1246 C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
1247 C                     MOVE TMAN      THRAG
1248 C                     MOVE CCY       CURREN
1249 C                     EXSR CREATE
1250 C           ENDBD     ENDSR                           ** ENDBD TAG **
1251 C********************************************************************
1252 C/SPACE 3
1253 C********************************************************************
1254 C* N E G O T I A B L E   A S S E T S   S O L D   * DL0304-BE *
1255 C           PROCBE    BEGSR                           *** PROCBE ***
1256 C                     SETON                     75
1257 C* TEST VALUE DATE TELEX IND.
1258 C                     TESTB'0'       TLXI           42
1259 C   42N89
1260 CORN23                GOTO ENDBE
1261 C                     SETON                     31
1262 C* VALUE DATE PROCESSING
1263 C                     MOVE SETP      SETTLE
1264 C                     MOVE 'R'       PAYREC
1265 C                     MOVE OSAC      OURAG
     C                     MOVE OSBR      OURSB                           S01117
1266 C                     MOVE TSEN      THRAG
1267 C                     MOVE CCY       CURREN
1268 C                     EXSR CREATE
1269 C           ENDBE     ENDSR
1270 C********************************************************************
1271 C/EJECT
1272 C********************************************************************
1273 C* D E A L   A M E N D M E N T S   * DLP0304-BF *
1274 C*  DEPOSITS PLACED AND INT.BEARING NEG. ASSETS PURCHASED
1275 C           PROCBF    BEGSR                           *** PROCBF ***
1276 C                     SETON                     76
1277 C* INCREASE OF PRINCIPAL
1278 C  N21                GOTO INTBF
1279 C                     SETON                     31
1280 C                     MOVE SETPDI    SETTLE
1281 C                     MOVE 'P'       PAYREC
1282 C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
1283 C                     MOVE TSENDI    THRAG
1284 C                     MOVE CCYDI     CURREN
1285 C                     EXSR CREATE
1286 C* SETTLEMENT/CAPITALISATION OF INTEREST
1287 C           INTBF     TAG                             ** INTBF TAG **
1288 C  N22                GOTO DECBF
1289 C  N89      AMTPDI    COMP 'CI'                     42
1290 C  N89 42             GOTO DECBF
1291 C                     EXSR INTRES
1292 C* IF DEPOSIT PLACED AND INTREST TO BE CAPITALISED AND END OF DAY
1293 C   09      INTC      COMP 'Y'                      57
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0304CCP8                                           S01408
     C*                                                                   S01408
1294 C                     SETON                     48
1295 C   09 57 89          SETON                     32
1296 C   09 57 89          EXSR OPREX4                     CREATEPFS/PREX4
1297 C                     SETOF                     48
1298 C   09 57             GOTO DECBF
1299 C* OTHERWISE
1300 C                     SETON                     32
1301 C                     MOVE SETPDI    SETTLE
1302 C                     MOVE 'R'       PAYREC
1303 C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
1304 C                     MOVE TSENDI    THRAG
1305 C                     MOVE CCYDI     CURREN
1306 C                     EXSR CREATE
1307 C* DECREASE OF PRINCIPAL
1308 C           DECBF     TAG                             ** DECBF TAG **
1309 C  N23                GOTO ENDBF
1310 C                     SETON                     33
1311 C                     MOVE SETPDI    SETTLE
1312 C                     MOVE 'R'       PAYREC
1313 C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
1314 C                     MOVE TSENDI    THRAG
1315 C                     MOVE CCYDI     CURREN
1316 C                     EXSR CREATE
1317 C           ENDBF     ENDSR                           ** ENDBF TAG **
1318 C********************************************************************
1319 C/SPACE 3
1320 C********************************************************************
1321 C* D E A L   A M E N D M E N T S   * DL0304-BG *
1322 C*  DEPOSITS ACCEPTED AND TAKINGS
1323 C           PROCBG    BEGSR                           *** PROCBG ***
1324 C                     SETON                     77
1325 C* INCREASE OF PRINCIPAL
1326 C  N21                GOTO INTBG
1327 C                     SETON                     31
1328 C                     MOVE SETPDI    SETTLE
1329 C                     MOVE 'R'       PAYREC
1330 C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
1331 C                     MOVE TSENDI    THRAG
1332 C                     MOVE CCYDI     CURREN
1333 C                     EXSR CREATE
1334 C* SETTLEMENT/CAPITALISATION OF INTEREST
1335 C           INTBG     TAG                             ** INTBG TAG **
1336 C  N22                GOTO DECBG
1337 C  N89      AMTPDI    COMP 'CI'                     42
1338 C  N89 42             GOTO DECBG
1339 C                     EXSR INTRES
1340 C* IF DEPOSIT PLACED AND INTREST TO BE CAPITALISED AND END OF DAY
1341 C   09      INTC      COMP 'Y'                      57
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0304CCP9                                           S01408
     C*                                                                   S01408
1342 C                     SETON                     48
1343 C   09 57 89          SETON                     32
1344 C   09 57 89          EXSR OPREX4                     CREATEPFS/PREX4
1345 C                     SETOF                     48
1346 C   09 57             GOTO DECBG
1347 C* OTHERWISE
1348 C                     SETON                     32
1349 C                     MOVE SETPDI    SETTLE
1350 C                     MOVE 'P'       PAYREC
1351 C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
1352 C                     MOVE TSENDI    THRAG
1353 C                     MOVE CCYDI     CURREN
1354 C                     EXSR CREATE
1355 C* DECREASE OF PRINCIPAL
1356 C           DECBG     TAG                             ** DECBG TAG **
1357 C  N23                GOTO ENDBG
1358 C                     SETON                     33
1359 C                     MOVE SETPDI    SETTLE
1360 C                     MOVE 'P'       PAYREC
1361 C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
1362 C                     MOVE TSENDI    THRAG
1363 C                     MOVE CCYDI     CURREN
1364 C                     EXSR CREATE
1365 C           ENDBG     ENDSR                           ** ENDBG TAG **
     C*****************************************************************   S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C* FRA/IRS RECORD PROCESSING DL0304-BH                               S01119
     C*                                                                   S01119
     C           PROCBH    BEGSR                                          S01119
     C*                                                                   S01119
     C* INTEREST PAY/RECIEVE IND3-1                                       S01119
     C                     MOVE '1'       *IN87                           S01119
     C           PRI3      IFEQ 1                                         S01119
     C                     Z-ADDPIAMT     EAMT                            S01119
     C                     MOVEL'1'       PINDS                           S01119
     C                     MOVE PSETM     SETTLE                          S01119
     C                     MOVE UCUCY     CURREN                          S01119
     C                     MOVE 'P'       PAYREC                          S01119
     C                     MOVE UPACC     OURAG                           S01119
     C**********           MOVE CPPBK     THRAG                    S01119 E21695
     C                     MOVE CPRBK     THRAG                    S01119 E21695
     C                     EXSR CREATE                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C* INTEREST PAY/RECIEVE IND1-1                                       S01119
     C           PRI1      IFEQ 1                                         S01119
     C                     Z-ADDRIAMT     EAMT                            S01119
     C                     MOVE '1'       PINDS                           S01119
     C                     MOVE RSETM     SETTLE                          S01119
     C                     MOVE TCUCY     CURREN                          S01119
     C                     MOVE 'R'       PAYREC                          S01119
     C                     MOVE URACC     OURAG                           S01119
     C**********           MOVE CPRBK     THRAG                    S01119 E21695
     C                     MOVE CPPBK     THRAG                    S01119 E21695
     C                     EXSR CREATE                                    S01119
     C                     END                                            S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
1366 C********************************************************************
1367 C/EJECT
1368 C********************************************************************
1369 C* S U B R O U T I N E   T O   D E T E R M I N E   W H I C H
1370 C*
1371 C* R E C O R D S   T O   C R E A T E
1372 C*       I/P PARMS - SETTLE - SETTLEMENT TYPE
1373 C*                 - CURREN - CURRENCY
1374 C*                 - PAYREC - PAY/RECEIVE IND.
1375 C*                 - OURAG  - OUR AGENT
1376 C*                 - THRAG  - THEIR AGENT
1377 C           CREATE    BEGSR                           *** CREATE ***
1378 C                     SETOF                       3958
1379 C   49                GOTO SELSE3
1380 C* IF I/P CYCLE CHECK SETTLEMENT TYPE
1381 C  N89      SETTLE    LOKUPIPSET                    42
1382 C  N89N42             GOTO ENDCRE
1383 C* IF INT.BEAR. NEG. ASSET GET INTEREST
1384 C   73                EXSR INTRES
     C* SELECT FIELDS FROM FRA/IRS RECORDS                                S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DLH00466
     C           *IN15     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C           SETTLE    IFEQ 01                                        S01119
     C           SETTLE    OREQ 07                                        S01119
     C           SETTLE    OREQ 08                                        S01119
     C*                                                                   S01119
     C*****      CURREN    IFNE LOCY                              S01119  S01194
     C*****      CURREN    OREQ LOCY                              S01119  S01194
     C           CURREN    IFNE BJLCCY                                    S01194
     C           CURREN    OREQ BJLCCY                                    S01194
     C*****      LCYN      ANDEQ'T'                               S01119  S01194
     C           BLLCTB    ANDEQ'T'                                       S01194
     C                     EXSR PROCEE                                    S01119
     C*                                                                   S01119
     C           *IN50     CASEQ'1'       OPREX1                          S01119
     C           *IN50     CASEQ'0'       OPREX2                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*****      CURREN    IFEQ LOCY                              S01119  S01194
     C           CURREN    IFEQ BJLCCY                                    S01194
     C*****      LCYN      ANDEQ'B'                               S01119  S01194
     C           BLLCTB    ANDEQ'B'                                       S01194
     C                     EXSR OPREX3                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                            NOT 01/07/08   S01119
     C*                                                                   S01119
     C           SETTLE    IFEQ 02                                        S01119
     C           SETTLE    OREQ 12                                        S01119
     C                     MOVE '1'       *IN39                           S01119
     C                     EXSR OPREX3                                    S01119
     C*                                                                   S01119
     C                     ELSE                            ELSE NOT 02/12 S01119
     C*                                                                   S01119
     C           OURAG     IFEQ *BLANK                                    S01119
     C                     MOVE '01'      OURASQ                          S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C                     MOVE OURAG     OURASQ                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     EXSR OPREX4                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                             SETTLE 01/07/08S01119
     C                     GOTO ENDCRE                                    S01119
     C                     END                             *IN15          S01119
     C*                                                                   S01119
1385 C* 'CASE' ON SETTLEMENT TYPE                          ** IF 07 OR 08
1386 C           SETTLE    COMP 07                       42 *
1387 C  N42      SETTLE    COMP 08                       42 *
1388 C  N42                GOTO SELSE1                      *
1389 C                     EXSR PROCEE                      * VAL. INSTR.
1390 C   50                EXSR OPREX1                      * CREATE-PREX1
1391 C  N50                EXSR OPREX2                      *       -PREX2
1392 C                     GOTO ENDCRE                      *
1393 C           SELSE1    TAG                             ** ELSEIF 01
1394 C           SETTLE    COMP 01                       42 *
1395 C  N42                GOTO SELSE2                      *
1396 C*****      CURREN    COMP LOCY                     42 *     *****   S01194
1396 C           CURREN    COMP BJLCCY                   42 *             S01194
1397 C* CURRENCY NOT EQ LOCAL CURRENCY                      *
1398 C   42 25             GOTO CURELS
1399 C                     EXSR PROCEE                      * VAL. INSTR.
1400 C   50                EXSR OPREX1                      * CREATE-PREX1
1401 C  N50                EXSR OPREX2                      *       -PREX2
1402 C                     GOTO ENDCCY                      *
1403 C* ELSE CURRENCY EQ LOCAL CURRENCY                     *
1404 C           CURELS    TAG                              * CURELS TAG**
1405 C                     SETON                     39
1406 C                     EXSR OPREX3                      * CREATE PREX3
1407 C           ENDCCY    TAG                              *
1408 C* ENDIF                                               *
1409 C                     GOTO ENDCRE                      *
1410 C           SELSE2    TAG                             ** ELSEIF 02
1411 C           SETTLE    COMP 02                       42 *     OR 12
1412 C  N42      SETTLE    COMP 12                       42 *
1413 C  N42                GOTO SELSE3                      *
     C                     SETON                     39
1414 C                     EXSR OPREX3                      * CREATE PREX3
1415 C                     GOTO ENDCRE                      *
1416 C           SELSE3    TAG                             ** ELSE
1417 C                     MOVE OURAG     OURASQ  2         * A/C SEQ
1418 C           OURASQ    COMP '  '                     42 * NULL
1419 C   42                MOVE '01'      OURAG             * DEFAULT 01
1420 C                     EXSR OPREX4                      * CREATE PREX4
1421 C           ENDCRE    ENDSR                           **
1422 C*
1423 C********************************************************************
1424 C/EJECT
1425 C********************************************************************
1426 C* I N T E R E S T   C A L C U L A T I O N   * DL0304-DD *
1427 C           INTRES    BEGSR                           *** INTRES ***
1428 C* IF LOAN/DEPOSIT
1429 C  N71N72             GOTO NEGAS
1430 C* IF INTERIM CALCULATION
1431 C  N32                GOTO MATLD
1432 C* SPEC. REF 1.1
1433 C           DAVDDC    COMP 0                        42
1434 C  N42      DAVDDC    COMP NIDT                 42
1435 C   42                GOTO TAG18
1436 C* REF. 1.2
1437 C           LOOP1     TAG                             ** LOOP1 TAG **
1438 C                     SETOF                     1213
1439 C           KEY2      CHAINDEAMS                41
1440 C***41                SETON                     LRU768       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'008'     DBASE   3        * DBERR 008 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY2      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
1441 C   41                GOTO ENDINT
1442 C* REF. 1.3
1443 C   12      VDATDI    COMP IACD                 42  42
1444 C   12 42             GOTO TAG16
1445 C* REF. 1.4
1446 C           TAG14     TAG                             ** TAG14 TAG **
1447 C           NAADDI    COMP NIDT                 42
1448 C  N42      NAADDI    COMP 0                        42
1449 C   42                GOTO TAG18
1450 C* REF. 1.5
1451 C                     MOVE KEY3      KEY2
1452 C                     GOTO LOOP1
1453 C           TAG16     TAG                             ** TAG16 TAG **
1454 C* REF. 1.6
1455 C* A 'CASE' ON AMENDMENT TYPE
1456 C           AMTPDI    COMP 'PI'                     42** IF PRINCIPAL
1457 C  N42                GOTO TAG162                      *    INCREASE
1458 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1459 C           ZINTR     ADD  AITC      AITC              *             S01392
     C                     ELSE                                           S01392
1459 C           ZINTR     ADD  AITC      AITC      H       *
     C                     END                                            S01392
1460 C                     Z-ADDVDATDI    IACD              *
1461 C           DAAMDI    ADD  PCPL      PCPL              *
1462 C                     GOTO END1IN                      *
1463 C           TAG162    TAG                             ** IF PRINCIPAL
1464 C           AMTPDI    COMP 'PD'                     42 *    DECREASE
1465 C  N42                GOTO TAG163                      *
1466 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1459 C           ZINTR     ADD  AITC      AITC              *             S01392
     C                     ELSE                                           S01392
1467 C           ZINTR     ADD  AITC      AITC      H       *
     C                     END                                            S01392
1468 C                     Z-ADDVDATDI    IACD              *
1469 C           PCPL      SUB  DAAMDI    PCPL              *
1470 C                     GOTO END1IN                      *
1471 C           TAG163    TAG                             ** IF SPREAD
1472 C           AMTPDI    COMP 'SC'                     42 *  RATE CHANGE
1473 C  N42                GOTO END1IN                      *
1474 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1459 C           ZINTR     ADD  AITC      AITC              *             S01392
     C                     ELSE                                           S01392
1475 C           ZINTR     ADD  AITC      AITC      H       *
     C                     END                                            S01392
1476 C                     Z-ADDVDATDI    IACD              *
1477 C           INTR      SUB  RTSP      INTR              *
1478 C           INTR      ADD  RTSPDI    INTR              *
1479 C                     Z-ADDRTSPDI    RTSP              *
1480 C           END1IN    TAG                             **ENDIF
1481 C* REF. 1.7
1482 C                     GOTO TAG14
1483 C*
1484 C           TAG18     TAG                             ** TAG18 TAG **
1485 C                     Z-ADDIACD      ZIBEG
1486 C                     Z-ADDNIDT      ZIEND
     C           NIDT      IFLT MDAT                                      AUS003
     C           MDAT      OREQ 0                                         AUS003
     C/COPY WNCPYSRC,DL0304CCP6                                           S01408
     C                     ADD  1         ZIEND                           AUS002
     C/COPY WNCPYSRC,DL0304CCP7                                           S01408
     C                     ELSE                                           AUS003
     C                     Z-ADDMDAT      ZIEND                           AUS003
     C                     END                                            AUS003
1487 C                     Z-ADDICBS      ZICALC
1488 C                     Z-ADDPCPL      ZIAMT
1489 C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL0304C018
1490 C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0304C019
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1491 C                     Z-ADDZINTR     INTCAL           INTEREST CALC. S01392
1493 C           ZINTR     ADD  AITC      ITODTE                          S01392
     C                     ELSE                                           S01392
1491 C                     Z-ADDZINTR     INTCAL 130H      INTEREST CALC.
1492 C*
1493 C           ZINTR     ADD  AITC      ITODTE 130H
     C                     END                                            S01392
1494 C           ITODTE    ADD  AIAP      ITODTE
1495 C           ITODTE    ADD  AIAN      ITODTE           INTREST TO DATE
1496 C*
1497 C           ITODTE    SUB  IPRD      INTDUE 130
1498 C           INTDUE    SUB  ICTD      INTDUE           INTEREST DUE
1499 C*
1500 C   19                EXSR CALTAX                     INTEREST TAX
1501 C   19      INTDUE    SUB  ITAX      INTDUE
1502 C*
1503 C           INTC      COMP 'Y'                      42
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0304CP10                                           S01408
     C*                                                                   S01408
1504 C   42      INTDUE    ADD  PCPL      PCPL
1505 C   42      INTDUE    ADD  ICTD      ICTD
1506 C  N42      INTDUE    ADD  IPRD      IPRD
1507 C                     Z-ADDNIDT      IACD
1508 C                     Z-ADDITODTE    AITC
1509 C   38                GOTO TAG38
1510 C                     GOTO ENDLOD
1511 C* IF MATURITY OF LOAN/DEPOSIT
1512 C           MATLD     TAG                             ** MATLD TAG **
1513 C*
1514 C* SPEC. REF 3.1
1515 C           DAVDDC    COMP 0                        42
1516 C   42                GOTO TAG38
1517 C* REF. 3.2
1518 C           LOOP2     TAG                             ** LOOP2 TAG **
1519 C                     SETOF                     1213
1520 C           KEY2      CHAINDEAMS                41
1440 C***41                SETON                     LRU768       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'009'     DBASE   3        * DBERR 009 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY2      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
1522 C   41                GOTO ENDINT
1523 C* REF. 3.3
1524 C   12      VDATDI    COMP IACD                 42  42
1525 C   12 42             GOTO TAG36
1526 C* REF. 3.4
1527 C           TAG34     TAG                             ** TAG34 TAG **
1528 C           NAADDI    COMP 0                        42
1529 C   42                GOTO TAG38
1530 C* REF. 3.5
1531 C                     MOVE KEY3      KEY2
1532 C                     GOTO LOOP2
1533 C           TAG36     TAG                             ** TAG36 TAG **
1534 C* REF. 3.6
1535 C* A 'CASE' ON AMENDMENT TYPE
1536 C           AMTPDI    COMP 'PI'                     42** IF PRINCIPAL
1537 C  N42                GOTO TAG362                      *    INCREASE
1538 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1539 C           ZINTR     ADD  AITC      AITC              *             S01392
     C                     ELSE                                           S01392
1539 C           ZINTR     ADD  AITC      AITC      H       *
     C                     END                                            S01392
1540 C                     Z-ADDVDATDI    IACD              *
1541 C           DAAMDI    ADD  PCPL      PCPL              *
1542 C                     GOTO END3IN                      *
1543 C           TAG362    TAG                             ** IF PRINCIPAL
1544 C           AMTPDI    COMP 'PD'                     42 *    DECREASE
1545 C  N42                GOTO TAG363                      *
1546 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1539 C           ZINTR     ADD  AITC      AITC              *             S01392
     C                     ELSE                                           S01392
1547 C           ZINTR     ADD  AITC      AITC      H       *
     C                     END                                            S01392
1548 C                     Z-ADDVDATDI    IACD              *
1549 C           PCPL      SUB  DAAMDI    PCPL              *
1550 C                     GOTO END3IN                      *
1551 C           TAG363    TAG                             ** IF SPREAD
1552 C           AMTPDI    COMP 'SC'                     42 *  RATE CHANGE
1553 C  N42                GOTO TAG364                      *
1554 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1539 C           ZINTR     ADD  AITC      AITC              *             S01392
     C                     ELSE                                           S01392
1555 C           ZINTR     ADD  AITC      AITC      H       *
     C                     END                                            S01392
1556 C                     Z-ADDVDATDI    IACD              *
1557 C           INTR      SUB  RTSP      INTR              *
1558 C           INTR      ADD  RTSPDI    INTR              *
1559 C                     Z-ADDRTSPDI    RTSP              *
1560 C                     GOTO END3IN                      *
1561 C           TAG364    TAG                             ** IF CAPITAL.
1562 C           AMTPDI    COMP 'CI'                     42 *  OF INTEREST
1563 C  N42                GOTO TAG365                      *
1564 C           TG364B    TAG                             ** TAG364B **
1565 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1566 C                     Z-ADDZINTR     INTCAL            * INTREST CALCS01392
1568 C           ZINTR     ADD  AITC      ITODTE            *             S01392
     C                     ELSE                                           S01392
1566 C                     Z-ADDZINTR     INTCAL    H       * INTREST CALC
1567 C*                                                     *
1568 C           ZINTR     ADD  AITC      ITODTE    H       *
     C                     END                                            S01392
1569 C           ITODTE    ADD  AIAP      ITODTE            *
1570 C           ITODTE    ADD  AIAN      ITODTE            * INT. TO DATE
1571 C*                                                     *
1572 C           IPRD      ADD  ICTD      INTDUE            *
1573 C           ITODTE    SUB  INTDUE    INTDUE            * INTEREST DUE
1574 C*
1575 C   19                EXSR CALTAX                     INTEREST TAX
1576 C   19      INTDUE    SUB  ITAX      INTDUE
1577 C*                                                     *
1578 C           PCPL      ADD  INTDUE    PCPL              *
1579 C           ICTD      ADD  INTDUE    ICTD              *
1580 C*                                                     *
1581 C                     Z-ADDVDATDI    IACD              *
1582 C*                                                     *
1583 C                     Z-ADDITODTE    AITC              *
1584 C                     GOTO END3IN                      *
1585 C           TAG365    TAG                             ** IF SET.MENT
1586 C           AMTPDI    COMP 'SI'                     42 *  OF INTEREST
1587 C  N42                GOTO END3IN                      *
1588 C           INTC      COMP 'Y'                      42 *
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0304CP11                                           S01408
     C*                                                                   S01408
1589 C   42                GOTO TG364B                      * AS FOR CI
1590 C*                                                     *
1591 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1566 C                     Z-ADDZINTR     INTCAL            * INTREST CALCS01392
1568 C           ZINTR     ADD  AITC      ITODTE            *             S01392
     C                     ELSE                                           S01392
1592 C                     Z-ADDZINTR     INTCAL    H       * INTREST CALC
1593 C*                                                     *
1594 C           ZINTR     ADD  AITC      ITODTE    H       *
     C                     END                                            S01392
1595 C           ITODTE    ADD  AIAP      ITODTE            *
1596 C           ITODTE    ADD  AIAN      ITODTE            * INT. TO DATE
1597 C*                                                     *
1598 C           IPRD      ADD  ICTD      INTDUE            *
1599 C           ITODTE    SUB  INTDUE    INTDUE            * INTEREST DUE
1600 C*                                                     *
1601 C   19                EXSR CALTAX                     INTEREST TAX
1602 C   19      INTDUE    SUB  ITAX      INTDUE
1603 C*                                                     *
1604 C           IPRD      ADD  INTDUE    IPRD              *
1605 C*                                                     *
1606 C*                                                     *
     C*
     C                     Z-ADDVDATDI    IACD
     C                     Z-ADDITODTE    AITC
     C*
1607 C           END3IN    TAG                             **ENDIF
1608 C* REF. 3.7
1609 C                     GOTO TAG34
1610 C*
1611 C           TAG38     TAG                             ** TAG38 TAG **
     C*                                                                   AUS003
     C                     MOVE '0'       *IN38                           AUS003
     C           IPFR      IFEQ 'N'                                       AUS003
     C           MDAT      IFGT NIDT                                      AUS003
     C           MDAT      OREQ 0                                         AUS003
1613 C           NIDT      COMP IACD                 38
     C                     END                                            AUS003
     C                     ELSE                                           AUS003
     C           NIDT      COMP IACD                 38                   AUS003
     C                     END                                            AUS003
1614 C   38                GOTO TAG18
1615 C* IF TOTAL INTEREST OVERRIDE FLAG ON.
1616 C                     TESTB'2'       DNSI           42
1617 C  N42                GOTO TAG38E
1618 C                     Z-ADDIACD      ZIBEG
1619 C                     Z-ADDMDAT      ZIEND
1620 C                     Z-ADDICBS      ZICALC
1621 C                     Z-ADDPCPL      ZIAMT
1622 C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL0304C020
1623 C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0304C021
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1566 C                     Z-ADDZINTR     INTCAL            * INTREST CALCS01392
1568 C           ZINTR     ADD  AITC      ITODTE            *             S01392
     C                     ELSE                                           S01392
1624 C                     Z-ADDZINTR     INTCAL 130H      INTEREST CALC.
1625 C*
1626 C           ZINTR     ADD  AITC      ITODTE 130H
     C                     END                                            S01392
1627 C           ITODTE    ADD  AIAP      ITODTE
1628 C           ITODTE    ADD  AIAN      ITODTE           INTREST TO DATE
1629 C*
1630 C           ITODTE    SUB  IPRD      INTDUE 130
1631 C           INTDUE    SUB  ICTD      INTDUE           INTEREST DUE
1632 C*
1633 C   19                EXSR CALTAX                     INTEREST TAX
1634 C   19      INTDUE    SUB  ITAX      INTDUE
1635 C*
1636 C                     GOTO ENDLOD
1637 C           TAG38E    TAG                             ** TAG38E TAG**
     C                     TESTB'1'       DSTI           28               153330
     C           *IN28     IFEQ '1'                                       153330
     C                     Z-SUBTOTI      TOTI                            153330
     C                     ENDIF                                          153330
1638 C           TOTI      SUB  IPRD      INTDUE           INTEREST DUE
     C           *IN28     IFEQ '1'                                       153330
     C                     Z-SUBTOTI      TOTI                            153330
     C                     ENDIF                                          153330
1639 C   19                EXSR CALTAX                     INTEREST TAX
1640 C   19      INTDUE    SUB  ITAX      INTDUE
1641 C*
1642 C           ENDLOD    TAG                             ** ENDLOD TAG**
1643 C                     GOTO ENDINT
1644 C           NEGAS     TAG                             ** NEGAS TAG **
1645 C* NEGOTIABLE ASSETS PURCHASED
1646 C  N73                GOTO SETCAP
1647 C* IF INTERIM CALCULATION
1648 C  N32                GOTO MATNA
1649 C* REF. 2.1
1650 C                     Z-ADDSLID      ZIBEG
1651 C                     Z-ADDNIDT      ZIEND
1652 C                     Z-ADDICBS      ZICALC
1653 C                     Z-ADDFVAL      ZIAMT
1654 C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL0304C002
1655 C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0304C003
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1656 C                     Z-ADDZINTR     INTDUE           INTEREST DUE   S01392
     C                     ELSE                                           S01392
1656 C                     Z-ADDZINTR     INTDUE    H      INTEREST DUE
     C                     END                                            S01392
1657 C*
1658 C                     Z-ADDNIDT      SLID
1659 C                     GOTO END1NA
1660 C* IF NEG. ASS. TO MATURITY
1661 C           MATNA     TAG                             ** MATNA TAG **
1662 C* REF. 4.1
1663 C           DAVDDD    COMP 0                        42
1664 C   42                GOTO TAG48
1665 C* REF. 4.2
1666 C           LOOP3     TAG                             ** LOOP3 TAG **
1667 C                     SETOF                     1213
1668 C           KEY4      CHAINDEAMS                41
1440 C***41                SETON                     LRU768       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'010'     DBASE   3        * DBERR 010 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY4      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
1670 C   41                GOTO ENDINT
1671 C* REF. 4.3
1672 C   12      VDATDI    COMP SLID                 42
1673 C   12 42             GOTO TAG46
1674 C* REF. 4.4
1675 C           TAG44     TAG                             ** TAG44 TAG **
1676 C           NAADDI    COMP 0                        42
1677 C   42                GOTO TAG48
1678 C* REF. 4.5
1679 C                     MOVE KEY3      KEY4
1680 C                     GOTO LOOP3
1681 C*
1682 C* REF. 4.6
1683 C           TAG46     TAG                             ** TAG46 TAG **
1684 C                     Z-ADDVDATDI    SLID
1685 C* REF. 4.7
1686 C                     GOTO TAG44
1687 C* REF. 4.8
1688 C           TAG48     TAG                             ** TAG48 TAG **
1689 C                     Z-ADDSLID      ZIBEG
1690 C                     Z-ADDMDAT      ZIEND
1691 C                     Z-ADDICBS      ZICALC
1692 C                     Z-ADDFVAL      ZIAMT
1693 C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL0304C004
1694 C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0304C005
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1656 C                     Z-ADDZINTR     INTDUE           INTEREST DUE   S01392
     C                     ELSE                                           S01392
1695 C                     Z-ADDZINTR     INTDUE    H      INTEREST DUE
     C                     END                                            S01392
1696 C*
1697 C           END1NA    TAG                             ** END1NA TAG**
1698 C                     GOTO ENDINT
1699 C*
1700 C* DEAL AMENDMENT - SETTLEMENT/CAPITALISATION OF INTEREST
1701 C           SETCAP    TAG                             ** SETCAP TAG**
1702 C  N76N77             GOTO ERRINT
1703 C* REF. 5.1
1704 C                     SETOF                     1213
1705 C   09      KEY2      CHAINDEAMS                41
1706 C  N09      KEY4      CHAINDEAMS                41
1440 C***41                SETON                     LRU768       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'011'     DBASE   3        * DBERR 011 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY4      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
1708 C   41                GOTO ERRINT
1709 C* REF  5.1.1
1710 C           TAG511    TAG                             ** TAG511 TAG**
1711 C           VDATDI    COMP IACD                   42
1712 C   42
1713 CORN12                GOTO TAG53
1714 C* REF 5.2
1715 C   10                GOTO TAG526
1716 C* A 'CASE' AN AMENDMENT TYPE
1717 C           AMTPDI    COMP 'PI'                     42** IF PRINCIPAL
1718 C  N42                GOTO SCELS1                      *    INCREASE
1719 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1720 C           ZINTR     ADD  AITC      AITC              *             S01392
     C                     ELSE                                           S01392
1720 C           ZINTR     ADD  AITC      AITC      H       *
     C                     END                                            S01392
1721 C                     Z-ADDVDATDI    IACD              *
1722 C           DAAMDI    ADD  PCPL      PCPL
1723 C                     GOTO END1SC                      *
1724 C*                                                     *
1725 C           SCELS1    TAG                             ** IF PRINCIPAL
1726 C           AMTPDI    COMP 'PD'                     42 *    DECREASE
1727 C  N42                GOTO SCELS2                      *
1728 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1720 C           ZINTR     ADD  AITC      AITC              *             S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
1730 C                     Z-ADDVDATDI    IACD              *
1731 C           PCPL      SUB  DAAMDI    PCPL
1732 C                     GOTO END1SC                      *
1733 C*                                                     *
1734 C           SCELS2    TAG                             ** IF SPREAD
1735 C           AMTPDI    COMP 'SC'                     42 *  RATE CHANGE
1736 C  N42                GOTO SCELS3                      *
1737 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1720 C           ZINTR     ADD  AITC      AITC              *             S01392
     C                     ELSE                                           S01392
1738 C           ZINTR     ADD  AITC      AITC      H       *
     C                     END                                            S01392
1739 C           INTR      SUB  RTSP      INTR              *
1740 C           RTSPDI    ADD  INTR      INTR              *
1741 C                     Z-ADDRTSPDI    RTSP              *
1742 C                     GOTO END1SC                      *
1743 C*                                                     *
1744 C           SCELS3    TAG                             ** IF CAPITAL-
1745 C           AMTPDI    COMP 'CI'                     42 *  ISATION OF
1746 C  N42                GOTO SCELS4                      * INTREST
1747 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1748 C                     Z-ADDZINTR     INTCAL            * INTREST CALLS01392
1750 C           ZINTR     ADD  AITC      ITODTE            *             S01392
     C                     ELSE                                           S01392
1748 C                     Z-ADDZINTR     INTCAL    H       * INTREST CALL
1749 C*  II                                                 *
1750 C           ZINTR     ADD  AITC      ITODTE    H       *
     C                     END                                            S01392
1751 C           ITODTE    ADD  AIAN      ITODTE            * INT. TO DATE
1751 C           ITODTE    ADD  AIAP      ITODTE
1752 C*  III                                                *
1753 C           ITODTE    SUB  IPRD      INTDUE            *
1754 C           INTDUE    SUB  ICTD      INTDUE            * INT. DUE
1755 C         19          EXSR CALTAX                     INTEREST TAX
1756 C         19INTDUE    SUB  ITAX      INTDUE
1757 C*
1758 C*  IV                                                 *
1759 C           INTDUE    ADD  PCPL      PCPL              *
1760 C           INTDUE    ADD  ICTD      ICTD              *
1761 C*  V                                                  *
1762 C                     Z-ADDVDATDI    IACD              *
1763 C*  VI                                                 *
1764 C                     Z-ADDITODTE    AITC              *
1765 C*  VII                                                *
1766 C           AIAN      ADD  AIAP      AIAP              *
1767 C*  VIII                                               *
1768 C                     Z-ADD0         AIAN              *
1769 C                     GOTO END1SC                      *
1770 C           SCELS4    TAG                             ** IF SET.MENT
1771 C           AMTPDI    COMP 'SI'                     42 *  OF INTEREST
1772 C  N42                GOTO END1SC                      *
1773 C           INTC      COMP 'Y'                      U7 *
1774 C   U7                SETON                     LR69   *
1775 C   U7                GOTO ENDINT                      *
1776 C                     EXSR GETINT                      *
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1748 C                     Z-ADDZINTR     INTCAL            * INTREST CALLS01392
1750 C           ZINTR     ADD  AITC      ITODTE            *             S01392
     C                     ELSE                                           S01392
1777 C                     Z-ADDZINTR     INTCAL    H       * INT. CALC.
1778 C*  II                                                 *
1779 C           ZINTR     ADD  AITC      ITODTE    H       *
     C                     END                                            S01392
1780 C           ITODTE    ADD  AIAN      ITODTE            * INT. TO DATE
1751 C           ITODTE    ADD  AIAP      ITODTE
1781 C*  III                                                *
1782 C           ITODTE    SUB  IPRD      INTDUE            *
1783 C           INTDUE    SUB  ICTD      INTDUE            * INT. DUE
1784 C         19          EXSR CALTAX                     INTEREST TAX
1785 C         19INTDUE    SUB  ITAX      INTDUE
1786 C*
1787 C*  IV                                                 *
1788 C           INTDUE    ADD  IPRD      IPRD              *
1789 C*  V                                                  *
1790 C                     Z-ADDVDATDI    IACD              *
1791 C*  VI                                                 *
1792 C                     Z-ADDITODTE    AITC              *
1793 C*  VII                                                *
1794 C           AIAN      ADD  AIAP      AIAP              *
1795 C*  VIII                                               *
1796 C                     Z-ADD0         AIAN              *
1797 C           END1SC    TAG                             ** END1SC TAG**
1798 C*
1799 C                     GOTO TAG53
1800 C           TAG526    TAG                             ** TAG526 TAG**
1801 C                     Z-ADDSLID      ZIBEG
1802 C                     Z-ADDVDATDI    ZIEND
1803 C                     Z-ADDICBS      ZICALC
1804 C                     Z-ADDFVAL      ZIAMT
1805 C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL0304C006
1806 C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0304C007
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1807 C                     Z-ADDZINTR     INTDUE           INTEREST DUE   S01392
     C                     ELSE                                           S01392
1807 C                     Z-ADDZINTR     INTDUE    H      INTEREST DUE
     C                     END                                            S01392
1808 C*
1809 C                     Z-ADDVDATDI    SLID
1810 C* REF. 5.3
1811 C           TAG53     TAG                             ** TAG53 TAG **
1812 C           VDATDL    COMP VDATDI                   42
1813 C   42      DASNDL    COMP DASNDI                   42
1814 C  N42                SETOF                     1213
1815 C  N42      KEY3      CHAINDEAMS                41
1440 C**N42 41             SETON                     LRU768       *****   S01194
0965 C  N42 41             SETON                     LRU7U8               S01194
     C  N42 41             MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C  N42 41             MOVEL'012'     DBASE   3        * DBERR 012 *  S01194
     C  N42 41             MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C  N42 41             MOVELKEY3      DBKEY  29                       S01194
     C  N42 41             EXSR *PSSR                                     S01194
1817 C  N42 41             GOTO ERRINT
1818 C  N42                GOTO TAG511
1819 C                     GOTO ENDINT
1820 C           ERRINT    TAG                             ** ERRINT TAG**
1821 C                     Z-ADD0         INTDUE
1822 C                     Z-ADD0         INTCAL
1823 C                     Z-ADD0         ITODTE
1824 C           ENDINT    ENDSR                           ** ENDINT TAG**
1825 C********************************************************************
1826 C/SPACE 3
1827 C********************************************************************
1828 C* GET INTEREST FOR COMMON PARTS OF 'INTRES' SUBROUTINE.
1829 C           GETINT    BEGSR                           *** GETINT ***
1830 C                     Z-ADDIACD      ZIBEG
1831 C                     Z-ADDVDATDI    ZIEND
1832 C                     Z-ADDICBS      ZICALC
1833 C                     Z-ADDPCPL      ZIAMT
1834 C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL0304C008
1835 C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0304C009
1836 C                     ENDSR
1837 C********************************************************************
1838 C/SPACE 3
1839 C********************************************************************
1840 C*    CALCULATE INTEREST TAX
1841 C*
1842 C           CALTAX    BEGSR                           ** CALTAX TAG *
1843 C                     Z-ADD0         ITAX   130
1844 C***24*26*  INTDUE    MULT TAXR      ITAX      H             *****   S01194
1844 C***24*26***INTDUE    MULT BNHKTR    ITAX                     S01194 S01383
1845 C***24*26***ITAX      DIV  100       ITAX      H                     S01383
     C*                                                                   S01383
     C* IF DEAL IS A DEPOSIT TAKEN (IT,CD,TD), AND IT IS TAXABLE          S01383
     C*                                                                   S01383
     C           *IN24     IFEQ '1'                        B001           S01383
     C           *IN26     ANDEQ'1'                                       S01383
     C/COPY WNCPYSRC,DL0304C012
     C*                                                                   S01383
     C** IF BRT SAR INSTALLED                                             S01383
     C*                                                                   S01383
     C           S01383    IFEQ 'Y'                        B002           S01383
     C*                                                                   S01383
     C           ZIEND     IFGE DEFF                       B003           S01383
     C                     Z-ADDBRTR      BNHKTR                          S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C           ZIEND     IFLT DEFF                       B003           S01383
     C                     Z-ADDPBRTR     BNHKTR                          S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C**********           MOVE CNUM      CLNKEY  60                                   S01383 CSD027
     C                     MOVE CNUM      CLNKEY  6                                           CSD027
     C           CLNKEY    CHAINSDCBRTL1             41                   S01383
     C           *IN41     IFEQ '1'                        B003           S01383
     C           XRECI     ORNE 'D'                                       S01383
0965 C                     SETON                     LRU7U8               S01383
     C                     MOVEL'SDCBRTPD'DBFILE           * * * * * * *  S01383
     C                     MOVEL'020'     DBASE            * DBERR 020 *  S01383
     C                     MOVELCNUM      DBKEY            * * * * * * *  S01383
     C                     EXSR *PSSR                                     S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C           TAXIND    IFEQ 'L'                        B003           S01383
     C/COPY WNCPYSRC,DL0304C013
     C           INTDUE    MULT BNHKTR    TAX01  155                      S01383
     C/COPY WNCPYSRC,DL0304C014
     C           TAX01     DIV  100       ITAX      H                     S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C           TAXIND    IFEQ 'P'                        B003           S01383
     C           BNHKTR    MULT 0.5       TAXRH  155                      S01383
     C/COPY WNCPYSRC,DL0304C015
     C           INTDUE    MULT TAXRH     TAX01  155                      S01383
     C/COPY WNCPYSRC,DL0304C016
     C           TAX01     DIV  100       ITAX      H                     S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C** ELSE BRT SAR IS NOT INSTALLED                                    S01383
     C*                                                                   S01383
1844 C                     ELSE                            X002           S01383
      *                                                                                       CDL013
      *** if CAR CDL013 is installed.                                                         CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
      *                                                                                       CDL013
      ** Call access program for base currency details                                        CDL013
      *                                                                                       CDL013
     C                     CALL 'AOCURRR0'                                                    CDL013
     C                     PARM '*MSG    '@RTCD                                               CDL013
     C                     PARM '*KEY    '@OPTN                                               CDL013
     C                     PARM BJCYCD    @AJCD   3                                           CDL013
     C           @CURR     PARM @CURR     DSSDY                                               CDL013
      *                                                                                       CDL013
      ** If no record is found perform standard database error process-                       CDL013
      ** ing                                                                                  CDL013
      *                                                                                       CDL013
     C           @RTCD     IFNE *BLANK                                                        CDL013
     C                     MOVEL'SDCURRPD'DBFILE                                              CDL013
     C                     MOVEL'23'      DBASE                                               CDL013
     C                     MOVEL@OPTN     DBOPTN                                              CDL013
     C                     MOVELBJCYCD    DBKEY  29                                           CDL013
     C                     MOVE *ON       *INU7                                               CDL013
     C                     MOVE *ON       *INU8                                               CDL013
     C                     MOVE *ON       *INLR                                               CDL013
     C                     EXSR *PSSR                                                         CDL013
     C                     GOTO END                                                           CDL013
     C                     END                                                                CDL013
      *                                                                                       CDL013
      *** Set WHT rate.                                                                       CDL013
     C                     SELEC                                                              CDL013
     C           TAXI      WHEQ '1'                                                           CDL013
     C                     Z-ADDETXR1     ULWHTR  52                                          CDL013
     C           TAXI      WHEQ '2'                                                           CDL013
     C                     Z-ADDETXR2     ULWHTR                                              CDL013
     C           TAXI      WHEQ '3'                                                           CDL013
     C                     Z-ADDETXR3     ULWHTR                                              CDL013
     C           TAXI      WHEQ '4'                                                           CDL013
     C                     Z-ADDETXR4     ULWHTR                                              CDL013
     C           TAXI      WHEQ '5'                                                           CDL013
     C                     Z-ADDETXR5     ULWHTR                                              CDL013
     C           TAXI      WHEQ '6'                                                           CDL013
     C                     Z-ADDETXR6     ULWHTR                                              CDL013
     C           TAXI      WHEQ '7'                                                           CDL013
     C                     Z-ADDETXR7     ULWHTR                                              CDL013
     C           TAXI      WHEQ '8'                                                           CDL013
     C                     Z-ADDETXR8     ULWHTR                                              CDL013
     C           TAXI      WHEQ '9'                                                           CDL013
     C                     Z-ADDETXR9     ULWHTR                                              CDL013
     C                     ENDSL                                                              CDL013
      *                                                                                       CDL013
      *                                                                                       CDL013
      *** If WHT rate is ZERO set tax amount to ZERO.                                         CDL013
     C           ULWHTR    IFEQ *ZERO                                                         CDL013
     C                     Z-ADD0         ITAX                                                CDL013
      *                                                                                       CDL013
      *** otherwise calculate tax amount.                                                     CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
      *** if Deal Ccy is equal to Base Ccy round down Interest Amount.                        CDL013
      ** and CDL081 is off                                                                    CDL081
      *                                                                                       CDL081
     C           CCY       IFEQ BJCYCD                                                        CDL013
     C           CDL081    ANDEQ'N'                                                           CDL081
      *                                                                                       CDL013
      *** set work adjustment field according to decimal places.                              CDL013
     C                     SELEC                                                              CDL013
     C           A6NBDP    WHEQ 1                                                             CDL013
     C                     Z-ADD10        ULWKAD  40                                          CDL013
     C           A6NBDP    WHEQ 2                                                             CDL013
     C                     Z-ADD100       ULWKAD                                              CDL013
     C           A6NBDP    WHEQ 3                                                             CDL013
     C                     Z-ADD1000      ULWKAD                                              CDL013
     C           A6NBDP    WHEQ 0                                                             CDL013
     C                     Z-ADD1         ULWKAD                                              CDL013
     C                     ENDSL                                                              CDL013
      *                                                                                       CDL013
      *** round down Interest Amount.                                                         CDL013
     C           TOTI      DIV  ULWKAD    ULTINT 150                                          CDL013
     C                     MULT ULWKAD    ULTINT                                              CDL013
      *                                                                                       CDL013
      *** calculate and then round down Tax Amount.                                           CDL013
     C           ULTINT    MULT ULWHTR    ITAX                                                CDL013
     C                     DIV  100       ITAX                                                CDL013
     C           ITAX      DIV  ULWKAD    ULITAX 150                                          CDL013
     C           ULITAX    MULT ULWKAD    ITAX                                                CDL013
      *                                                                                       CDL013
      *** otherwise (Deal Ccy NOT = Base Ccy) calculate Tax amount                            CDL013
      *** without rounding down.                                                              CDL013
     C                     ELSE                                                               CDL013
     C           TOTI      MULT ULWHTR    ITAX                                                CDL013
      *                                                                                       CDL081
      ** Check if tax amount is to be rounded down                                            CDL081
      *                                                                                       CDL081
     C           CCY       IFEQ BJCYCD                                                        CDL081
     C           CDL081    ANDEQ'Y'                                                           CDL081
     C           W#BSRD    ANDEQ'Y'                                                           CDL081
     C           CCY       ORNE BJCYCD                                                        CDL081
     C           CDL081    ANDEQ'Y'                                                           CDL081
     C           W#NBRD    ANDEQ'Y'                                                           CDL081
     C                     DIV  100       ITAX                                                CDL081
     C                     ELSE                                                               CDL081
     C                     DIV  100       ITAX      H                                         CDL013
     C                     ENDIF                                                              CDL081
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
      *** otherwise perform Original Tax calculations.                                        CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0304CCP4                                           S01408
     C*                                                                   S01408
     C*                                                                   S01383
1844 C           INTDUE    MULT BNHKTR    ITAX                            S01383
     C/COPY WNCPYSRC,DL0304C017
     C*                                                                   S01392
     C* ROUND DOWN INTEREST                                               S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1845 C           ITAX      DIV  100       ITAX                            S01383
     C                     ELSE                                           S01392
1845 C           ITAX      DIV  100       ITAX      H                     S01383
     C                     END                                            S01392
      *                                                                                       CDL013
      ** Endif for New Tax Process(If CDL013 is installed)                                    CDL013
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0304CCP5                                           S01408
     C*                                                                   S01408
     C*                                                                   S01383
     C                     END                             E002           S01383
     C                     END                             E001           S01383
     C/COPY WNCPYSRC,DL0304C010
1846 C                     ENDSR
1847 C*******************************************************************
1848 C/SPACE 3
1849 C********************************************************************
1850 C* VALIDATION OF INSTRUCTIONS  * DL0304-EE *
1851 C*       I/P  OURAG - OUR AGENT A/C
1852 C*            THRAG - THEIR AGENT A/C
1853 C*
1854 C*       O/P  PAYREC - WILL BE SET TO 'C' IF NECCESSARY
1855 C*            IND.50 - INSTRUCTIONS VALID
1856 C           PROCEE    BEGSR                           *** PROCEE ***
1857 C                     SETOF                     50
1858 C           OURAG     COMP ' '                  5050  ** OUR AGENT
1859 C  N50                GOTO ENDEE                       *  VALIDATION.
1860 C*****                MOVELOURAG     NOSN              *     *****   S01194
1860 C                     MOVELOURAG     @KEYE             *             S01194
1861 C*****                MOVE CURREN    CCY               *     *****   S01194
1862 C*****                Z-ADD70        RECT              *     *****   S01194
1863 C*****                EXSR TABCHN                      *     *****   S01194
0327 C*                                                                   S01194
0327 C* CALL ACCESS PROG. FOR NOSTRO DETAILS                              S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @KEYA   6                       S01194
     C                     PARM CURREN    @KEYB   3                       S01194
     C**********           PARM *BLANKS   @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANKS   @KEYC  10                                           CGL029
     C                     PARM *BLANKS   @KEYD   2                       S01194
     C                     PARM           @KEYE   2                       S01194
     C                     PARM *BLANKS   @KEYF   3                       S01194
     C                     PARM *BLANKS   @KEYG  10                       S01194
     C                     PARM *BLANKS   @KEYH   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
1864 C           @RTCD     IFNE *BLANK                                    S01194
1864 C                     SETOF                     50     *             S01194
1865 C                     GOTO ENDEE                      **             S01194
1865 C                     END                             **             S01194
0327 C*                                                                   S01194
1864 C***99**              SETOF                     50     *     *****   S01194
1865 C***99**              GOTO ENDEE                      **     *****   S01194
0327 C*                                                                   S01194
1866 C*
1867 C           THRAG     COMP ' '                  5050  ** THIER AGENT
1868 C  N50                GOTO ENDEE                       *  VALIDATION.
1869 C           IFCUST    COMP '000001'             42     *
1870 C   42      IFCUST    COMP '999999'               42   *
1871 C  N42                GOTO ENDEE                      **NOT A CUSTNO.
1872 C*
1873 C           PAYREC    COMP 'P'                      42** CREDIT VAL.
1874 C***42*     CNUMTL    COMP CUST                     42 *     *****   S01194
1874 C   42      A7CUST    COMP IFCUST                   42 *             S01194
1875 C   42                MOVE 'C'       PAYREC           **
1876 C*
1877 C           ENDEE     ENDSR                           ** ENDEE TAG **
1878 C********************************************************************
1879 C/SPACE 3
1880 C********************************************************************
1881 C* S E T U P   A N D   W R I T E   O U T P U T   R E C O R D
1882 C           OUTPUT    BEGSR                           *** OUTPUT ***
1883 C* NB. SOME FIELDS HAVE ALREADY BEEN SETUP AND SOME ARE COMMON
1884 C*
1885 C* IF FOREIGN EXCHANGE EXTRACT
1886 C  N70                GOTO ELSEO1
1887 C           DTYP      COMP 'OP'                     42
1888 C   42                Z-ADDOTDT      VDATPH
1889 C  N42                Z-ADDVDAT      VDATPH  50
1890 C**********           Z-ADDCNUM      CNUMPH                                              CSD027
1890 C                     MOVE CNUM      CNUMPH                                              CSD027
1891 C                     Z-ADDDLNODB    DLNOPH
1892 C                     Z-ADD0         PRODPH
1893 C           PAYREC    COMP 'R'                      42
1894 C   42                Z-ADDPUAM      EAMT   130
1895 C  N42                Z-ADDSLAM      EAMT
1896 C                     MOVE 'D'       RCDT
1897 C                     Z-ADD0         DASNPH
1898 C   42                MOVE BLNK10    OTFACO 10
1899 C   42                MOVE BLNK35    OTSPI  35
1900 C                     Z-ADD0         RCPI
1901 C                     Z-ADD0         RRDN
1902 C  N42                MOVE FACO      OTFACO
1903 C  N42                MOVE SPI       OTSPI
1904 C                     GOTO ENDO
1905 C* NON-FX DEALS EXTRACT
1906 C           ELSEO1    TAG                             ** ELSEO1 TAG**
1907 C  N71N72N73
1908 CANN74N75N87          GOTO ELSEO2                                    S01119
1908 C*NN74N75 **********  GOTO ELSEO2  ****************************      S01119
1909 C           SETTLE    COMP 07                       42
1910 C  N42      SETTLE    COMP 08                       42
1911 C                     Z-ADD0         PRODPH
1912 C***46                Z-ADD2         PRODPH                  *****   S01194
1913 C***46      DTYP      LOKUPDTABA                    42       *****   S01194
1914 C***46 42             Z-ADD1         PRODPH                  *****   S01194
1915 C   31                Z-ADDVDAT      VDATPH
1916 C   32                Z-ADDNIDT      VDATPH
1917 C   33                Z-ADDMDAT      VDATPH
     C   15                Z-ADDEVDAT     VDATPH                          S01119
1918 C**N10*****           Z-ADDCNUM      CNUMPH                                              CSD027
1919 C***10*****           Z-ADDISCN      CNUMPH                                              CSD027
1918 C  N10                MOVE CNUM      CNUMPH                                              CSD027
1919 C   10                MOVE ISCN      CNUMPH                                              CSD027
1920 C           DTYP      COMP 'CI'                     42
1921 C***42*****           Z-ADDCHNA      CNUMPH                                              CSD027
1921 C   42                MOVE CHNA      CNUMPH                                              CSD027
1922 C           PAYREC    COMP 'R'                      42
1923 C***10N42**           Z-ADDPCUS      CNUMPH                                              CSD027
1924 C***10*42**           Z-ADDISCN      CNUMPH                                              CSD027
1923 C   10N42             MOVE PCUS      CNUMPH                                              CSD027
1924 C   10 42             MOVE ISCN      CNUMPH                                              CSD027
1925 C   09                Z-ADDDLNODC    DLNOPH
1926 C   10                Z-ADDDLNODD    DLNOPH
1927 C   11                Z-ADDDLNODE    DLNOPH
     C           *IN15     IFEQ '0'                                       S01119
     C*                                                                   S01392
     C* FRONT-UP INTEREST = Y                                             S01392
     C*                                                                   S01392
     C           FUID      IFEQ 'Y'                        B001           S01392
     C           PCPL      SUB  TOTI      EAMT                            S01392
     C   32                Z-ADDINTDUE    EAMT                            S01392
     C   33                Z-ADDPCPL      EAMT                            S01392
     C           *IN33     IFEQ '1'                        B002           S01392
     C           RBDN      ANDNE*ZERO                                     S01392
     C           RBDN      CHAINDRSDEALS             37                   S01392
     C           *IN37     IFEQ '1'                        B003           S01392
     C                     MOVEL'DRSDEALS'DBFILE           * * * * * * *  S01194
     C                     MOVEL'021'     DBASE            * DBERR 021 *  S01194
     C                     MOVEL'*KEY   ' DBOPTN           * * * * * * *  S01194
     C                     MOVELRBDN      DBKEY                           S01194
     C                     SETON                     U7U8LR               S01392
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDO                                      S01392
     C                     END                             E003           S01392
     C           MTIN      IFEQ '12'                       B003           S01392
     C           PCPL      SUB  TOTI2     EAMT                            S01392
     C                     ELSE                                           S01392
     C                     Z-ADDTOTI2     EAMT                            S01392
     C                     END                             E003           S01392
     C                     END                             E002           S01392
     C                     ELSE                            X001           S01392
1928 C* LOANS AND DEPOSITS
1929 C   09                Z-ADDPCPL      EAMT
1930 C   09 32             Z-ADDINTDUE    EAMT
1931 C   09 33             Z-ADDAMTDUE    EAMT
1932 C   09 33 47          Z-ADDRBDA      EAMT
     C                     END                             E001           S01392
1933 C* INT-BEAR. NEG. ASSETS. PURCH.
1934 C   73                Z-ADDPUPR      EAMT
1935 C   73 32             Z-ADDINTDUE    EAMT
1936 C   73 33             Z-ADDFVAL      EAMT
1937 C   73 33   INTDUE    ADD  EAMT      EAMT
1938 C* NON-INT-BEAR. NEG. ASSETS PURCH.
1939 C   74                Z-ADDPUPR      EAMT
1940 C   74 33             Z-ADDFVAL      EAMT
1941 C* NEG. ASSETS SOLD
1942 C   75                Z-ADDSAPR      EAMT
     C                     ELSE                                           S01119
     C                     Z-ADDDLNO      DLNOPH                          S01119
     C                     END                                            S01119
1943 C*
1944 C                     MOVE 'D'       RCDT
1945 C                     Z-ADD0         DASNPH
1946 C           PAYREC    COMP 'R'                      42
1947 C   42                MOVE BLNK10    OTFACO
1948 C   42                MOVE BLNK35    OTSPI
1949 C                     Z-ADD0         RCPI
1950 C                     Z-ADD0         RRDN
1951 C  N42                MOVE FACO      OTFACO
1952 C  N42                MOVE SPI       OTSPI
1953 C* IF LOAN OR DEPOSIT                                 **
1954 C  N09                GOTO ENDROL                      *
1955 C   49                Z-ADD3         RCPI
1956 C* IF START DATE PROCESSING                            *
1957 C   31      RODA      COMP 0                    42     *
1958 C   31 42             Z-ADD1         RCPI              *
1959 C   31 42             Z-ADDRODN      RRDN              *
1960 C* ELSE MATURITY PROCESSING                            *
1961 C   47                Z-ADD2         RCPI              *
1962 C   47                Z-ADDRBDN      RRDN              *
1963 C* ENDIF                                               *
1964 C           ENDROL    TAG                             ** ENDROL TAG**
1965 C                     GOTO ENDO
1966 C           ELSEO2    TAG                             ** ELSEO2 TAG**
1967 C* DEAL AMENDMENT EXTRACT
1968 C  N76N77             GOTO ENDO
1969 C                     Z-ADD0         PRODPH
1970 C***46                Z-ADD2         PRODPH                  *****   S01194
1971 C***46      DTYP      LOKUPDTABB                    42       *****   S01194
1972 C***46 42             Z-ADD1         PRODPH                  *****   S01194
1973 C*
1974 C                     Z-ADDVDATDI    VDATPH
1975 C**********           Z-ADDCNUMDI    CNUMPH                                              CSD027
1975 C                     MOVE CNUMDI    CNUMPH                                              CSD027
1976 C                     Z-ADDDLNODI    DLNOPH
1977 C   31
1978 COR 33                Z-ADDDAAMDI    EAMT
1979 C   32                Z-ADDINTDUE    EAMT
1980 C                     MOVE 'A'       RCDT
1981 C                     Z-ADDDASNDI    DASNPH
1982 C                     MOVE FACODI    OTFACO
1983 C                     MOVE SPIDI     OTSPI
1984 C                     MOVE DTYPDI    DTYP
1985 C                     MOVE DLSTDI    DLST
1986 C                     Z-ADD0         RCPI
1987 C                     Z-ADD0         RRDN
1988 C   48                Z-ADD3         RCPI
1989 C           ENDO      TAG                             ** ENDO TAG **
1990 C* COMMON ROUTINES
1991 C                     MOVE '100'     PINDS
1992 C   32                MOVE '010'     PINDS
1993 C   33                MOVE '001'     PINDS
1994 C                     Z-ADD0         FFIN
1995 C*****      CURREN    COMP USCY                     42       *****   S01194
1995 C           CURREN    COMP BLUSCY                   42               S01194
1996 C                     TESTB'2'       DSTI           43
1997 C  N43                TESTB'3'       DSTI           43
1998 C   42 43             Z-ADD1         FFIN
1999 C   42N43             Z-ADD2         FFIN
2000 C***44**              MOVE BRCD      BRKEY                           S01117
2000 C***44**              MOVE BRCA      BRKEY                   S01117  S01194
2001 C***44**    BRKEY     CHAINTABLE                41           *****   S01194
2002 C***44*41             SETON                     LRU759       *****   S01194
     C           *IN44     IFEQ '1'                                       S01194
0327 C* CALL ACCESS PROG. FOR BRANCH DETAILS                              S01194
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BRCA      @BRKEY  3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBRCHPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'013'     DBASE   3        * DBERR 013 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVELBRCA      DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
     C                     END                                            S01194
2003 C           DTYP      COMP 'OP'                     42
2004 C   42      EAMT      COMP 0                        42
2005 C**   IF AMOUNT NEGATIVE
2006 C           EAMT      COMP 0                      45
2007 C   45      PAYREC    COMP 'P'                      43REVERSE TX IF
2008 C   45 43             MOVE 'R'       PAYREC           NEGATIVE
2009 C   45N43             MOVE 'P'       PAYREC
2010 C   45                Z-SUBEAMT      EAMT
2019 C* IF AMOUNT NEGATIVE SETON '45'
     C*
     C* SUPPRESS OUTPUT IF NULL EAMT OR REQUIRED BRANCH CODE NOT FOUND.
     C   42
     COR 44 41             GOTO NOPREX
     C*                                                                   S01117
     C*                                                                   S01117
     C           OURSB     IFEQ *BLANKS                                   S01117
     C*****                MOVE BRCD      OURSB                           S01117
     C                     MOVE BRCA      OURSB                           S01117
     C                     END                                            S01117
     C*
     C* INTERNAL SETTLEMENTS NEVER OVERIDDEN BY CHIPS OR SWIFT.
     C   54                GOTO OUTEXT
     C*
     C* IF PAYMENT AND TELEX IS INCOMPLETE THEN DO NOT SEND BY SWIFT OR
     C*  CHIPS
     C           X         IFEQ 2                           INCOMPLETE
     C           PAYREC    CABNE'R'       OUTEXT            NOT RECEIVE
     C                     END
     C* IF NOSTRO TRANSFER, DO NOT GENERATE A PAYMENT SWIFT MESSAGE       S01108
     C           PAYREC    IFEQ 'P'                                       S01108
     C           PAYREC    OREQ 'C'                                       S01108
     C           DTYP      CABEQ'NX'      OUTEXT                          S01108
     C                     END                                            S01108
     C* IF CHIPS INTERFACE EXISTS, DETERMINE IF EVENT IS FOR CHIPS
     C  N29                GOTO SWPRTY
     C           PAYREC    COMP 'P'                      42 = PAYMENT
     C  N42      PAYREC    COMP 'C'                      42 = CREDIT
     C   42      SETTLE    COMP 07                       42 = CHIPS
     C***42**    CURREN    COMP USCY                  ***42*=*US*DOLLARS**S01194
     C   42      CURREN    COMP BLUSCY                   42 = US DOLLARS  S01194
     C*
     C*  IF EVENT IS FOR CHIPS, CHECK DATE.
     C  N42                GOTO SWPRTY
     C***89**    VDATPH    COMP DNWD              *****4343*EOD=NXT*WRK*DYS01194
     C   89      VDATPH    COMP BJDNWD                 4343 EOD=NXT WRK DYS01194
     C**N89**    VDATPH    COMP RUND              *******43*I/P=TODAY*****S01194
     C  N89      VDATPH    COMP BJRDNB                   43 I/P=TODAY     S01194
     C*  IF CHIPS PAYMENT DATE IS WRONG, SKIP OUTPUT
     C  N43                GOTO NOPREX
     C*
     C*  IF CHIPS PAYMENT DATE IS CORRECT, OUTPUT TO CHIPS EXTRACT FILE.
     C   43                MOVE '02'      MTIN
     C   43                GOTO OUTEXT
     C*
     C*  IF SWIFT INTERFACE EXISTS AND EVENT IS NOT A LOCAL CCY
     C*   BANKERS AUTHORISATION, TEST SWIFT PRIORITY
     C           SWPRTY    TAG                             ** SWPRTY TAG *
     C   30N39             EXSR PRIOR
     C*
     C*  OUTPUT AN EXTRACT RECORD.
     C           OUTEXT    TAG                             ** OUTEXT TAG *
     C                     SETON                     34
     C                     EXCPT
2020 C* RESET O/P INDS.
     C           NOPREX    TAG                             ** NOPREX TAG *
2021 C                     SETOF                     313233
2022 C                     ENDSR
2023 C********************************************************************
2024 C/EJECT
2025 C* O U T P U T   R O U T I N E S
2026 C/SPACE 2
2027 C********************************************************************
2028 C*
2029 C           OPREX1    BEGSR                           *** OPREX1 ***
2030 C                     MOVE '09'      MTIN
2031 C                     Z-ADD1         X       10
2032 C                     SETON                     51
2033 C                     SETON                     58
2034 C                     SETOF                     34
2035 C                     EXSR OUTPUT
2036 C                     SETOF                     51
2037 C   34                EXSR HASH
2038 C                     SETOF                     34
2039 C                     ENDSR
2040 C********************************************************************
2041 C/SPACE 2
2042 C********************************************************************
2043 C*
2044 C           OPREX2    BEGSR                           *** OPREX2 ***
2045 C                     MOVE '10'      MTIN
2046 C                     Z-ADD2         X
2048 C                     SETON                     58
2049 C                     SETOF                     34
2050 C                     EXSR OUTPUT
2052 C   34                EXSR HASH
2053 C                     SETOF                     34
2054 C                     ENDSR
2055 C********************************************************************
2056 C/SPACE 2
2057 C********************************************************************
2058 C*
2059 C           OPREX3    BEGSR                           *** OPREX3 ***
2060 C                     MOVE '11'      MTIN
2061 C                     Z-ADD3         X
2063 C                     SETOF                     34
2064 C                     EXSR OUTPUT
2066 C   34                EXSR HASH
2067 C                     SETOF                     34
2068 C                     ENDSR
2069 C********************************************************************
2070 C/SPACE 2
2071 C********************************************************************
2072 C*
2073 C           OPREX4    BEGSR                           *** OPREX4 ***
2074 C                     MOVE '12'      MTIN
2075 C                     Z-ADD4         X
2076 C                     SETON                     54
2078 C                     SETOF                     34
2079 C                     EXSR OUTPUT
2080 C                     SETOF                     54
2082 C   34                EXSR HASH
2083 C                     SETOF                     34
2084 C                     ENDSR
2085 C********************************************************************
2086 C*
2087 C**   SUBROUTINE TO FIND MESSAGE TYPE PRIORITY
2088 C*
2089 C           PRIOR     BEGSR
2090 C*
2091 C                     Z-ADD0         P       10
2092 C           LOOP1A    TAG
2093 C           P         ADD  1         P
2094 C           P         COMP 9                    78  78
2095 C   78                SETON                     82
2096 C   78                GOTO SWIFT
2097 C                     Z-ADD1         N       10
2098 C           LOOP2A    TAG
2099 C           PR,N      COMP P                        79
2100 C   79                GOTO PRI
2101 C           N         ADD  1         N
2102 C           N         COMP 9                    78  78
2103 C   78                GOTO LOOP1A
2104 C                     GOTO LOOP2A
2105 C*
2106 C           PRI       TAG
2107 C*    TELEX
2108 C           N         COMP 4                        81
2109 C   81 58             GOTO PREND
2110 C   81                GOTO LOOP1A
2111 C*
2112 C**   SWIFT
2113 C           N         COMP 1                        82
2114 C           SWIFT     TAG
2115 C   82                EXSR SWADDR
2116 C   82 80             MOVE '01'      MTIN
2117 C  N82                GOTO LOOP1A
2118 C           PREND     TAG
2119 C                     ENDSR
2120 C********************************************************************
2121 C*
2122 C*    SWADDR - SUBROUTINE TO CHECK IF SWIFT ADDRESS EXISTS
2123 C*
2124 C           SWADDR    BEGSR
2125 C*
2126 C                     SETOF                     80
2127 C           OURAG     COMP ' '                      86
2128 C   86                GOTO SAEND
2129 C*
2130 C*    CHECK WHETHER FIELD CONTENTS ARE ALPHAMERIC OR NUMERIC
2131 C*
2132 C                     MOVELOURAG     CHK1    1
2133 C           CHK1      COMP '0'                    90
2134 C   90                GOTO ALPHA
2135 C*
2136 C*    CONTENTS ARE NUMERIC - CHECK IF NOSTRO,CUSTOMER NUMBER,
2137 C*    ACCOUNT NUMBER OR RETAIL ACCOUNT NUMBER
2138 C*
2139 C**********           MOVE OURAG     CHK10  10                                           CGL029
     C                     MOVE OURAG     CHK10  16                                           CGL029
2140 C           CHK10     COMP ' '                      90
2141 C**N90                MOVELOURAG     ZCLKEY  7                       S01194
2141 C  N90                MOVELOURAG     @CLKEY                          S01194
2142 C  N90                GOTO QCUST
2143 C*
2144 C*    NOSTRO
2145 C*
2146 C                     MOVELOURAG     CHK2    2
2147 C*****                MOVELCURREN    CHK5    5               *****   S01194
2148 C*****                MOVE CHK2      CHK5                    *****   S01194
2149 C*****                MOVE CHK5      ZTABKY                  *****   S01194
2150 C*****                MOVEL'70'      ZTABKY                  *****   S01194
2151 C*****                EXSR TABCHN                            *****   S01194
0327 C*                                                                   S01194
0327 C* CALL ACCESS PROG. FOR NOSTRO DETAILS                              S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @KEYA   6                       S01194
     C                     PARM CURREN    @KEYB   3                       S01194
     C**********           PARM *BLANKS   @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANKS   @KEYC                                               CGL029
     C                     PARM *BLANKS   @KEYD   2                       S01194
     C                     PARM CHK2      @KEYE   2                       S01194
     C                     PARM *BLANKS   @KEYF                           S01194
     C                     PARM *BLANKS   @KEYG                           S01194
     C                     PARM *BLANKS   @KEYH                           S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDNOSTPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'014'     DBASE   3        * DBERR 014 *  S01194
     C                     MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL@KEYB     DBKEY  29                       S01194
     C                     MOVEL@KEYE     DBKEY                           S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
1865 C                     GOTO SAEND                                     S01194
0327 C*                                                                   S01194
     C                     ELSE                                           S01194
2154 C                     MOVELA7CUST    @CLKEY                          S01194
     C                     GOTO QCUST                                     S01194
1865 C                     END                                            S01194
0327 C*                                                                   S01194
1864 C***99**              SETON                     83           *****   S01194
1865 C***99**              GOTO SAEND                             *****   S01194
0327 C*                                                                   S01194
2154 C*****                MOVELCNUMTL    ZCLKEY                  *****   S01194
2155 C*****                GOTO QCUST                             *****   S01194
2156 C*
2157 C*    CONTENTS ARE ALPHAMERIC
2158 C*
2159 C           ALPHA     TAG
2154 C                     MOVELOURAG     @CLKEY                          S01194
2160 C*****                MOVELOURAG     CHK10  10               *****   S01194
2161 C*****      CHK10     CHAINSNAME                99           *****   S01194
2162 C***99                SETON                     84           *****   S01194
2163 C***99                GOTO SAEND                             *****   S01194
2164 C*****                MOVELCNUMCD    ZCLKEY                  *****   S01194
2165 C*
2166 C*    CUSTOMER NUMBER
2167 C*
2168 C           QCUST     TAG
2169 C*****                MOVE 'A'       ZCLKEY                          S01194
2170 C*****                EXSR CLICHN                            *****   S01194
0327 C* CALL ACCESS PROG. FOR CUSTOMER DETAILS.                           S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @CLKEY 10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           @KYST     OREQ '*ERROR'                                  S01194
     C                     MOVEL'SDCUSTPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'015'     DBASE   3        * DBERR 015 *  S01194
     C                     MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL@CLKEY    DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
2172 C                     GOTO SAEND                                     S01194
2172 C                     END                                            S01194
2171 C***99**              SETON                     85           *****   S01194
2172 C***99**              GOTO SAEND                             *****   S01194
2173 C*****      CSID      COMP ' '                  8080         *****   S01194
2173 C           BBCSID    COMP ' '                  8080                 S01194
2174 C***80                MOVELZCLKEY    OURAG                           S01194
2174 C   80                MOVEL@CLKEY    OURAG                           S01194
2175 C   80                MOVE BLNK6     OURAG
2176 C*
2177 C           SAEND     TAG
2178 C   99                SETON                     U7LR
2179 C                     ENDSR
2180 C*
2181 C********************************************************************
2182 C********************************************************************
2183 C/EJECT
2184 C*****************************************************************   S01194
2185 C*****                                                       *****   S01194
2186 C*****      TABCHN    BEGSR                           *** TABCHN**   S01194
2187 C*****                SETOF                     99           *****   S01194
2188 C*****      ZTABKY    CHAINTABLE                41           *****   S01194
2189 C***41                SETON                     99           *****   S01194
2190 C**N41      RECI      COMP 'D'                  9999         *****   S01194
2191 C*****                ENDSR                                  *****   S01194
2192 C*****************************************************************   S01194
2193 C*****                                                       *****   S01194
2194 C*****CLICHN SR. TO RANDOM ACCESS CLIENT FILE.               *****   S01194
219  C*****                                                       *****   S01194
2196 C*****      CLICHN    BEGSR                           *** CLICHN**   S01194
2197 C*****                                                       *****   S01194
2198 C*****                                                       *****   S01194
2199 C*****RANDOM ACCESS CLIENT FILE BY KEY.                      *****   S01194
2200 C*****      ZCLKEY    CHAINCLINT                99    ON NOT THERE   S01194
2201 C**N99      RECI      COMP 'D'                  9999  ON IF INACTIVE S01194
2202 C*****                                                       *****   S01194
2203 C*****                ENDSR                                  *****   S01194
2204 C*****                                                       *****   S01194
2205 C*****************************************************************   S01194
2206 C/SPACE
2207 C********************************************************************
2208 C*
2209 C           HASH      BEGSR                           ***  HASH  ***
2210 C                     Z-ADDINT       ZZTOTI
2211 C                     Z-ADDDEC       ZZTOTD
2212 C           EAMT      DIV  1000      ZZAMT
2213 C                     EXSR GLZADD
2214 C                     Z-ADDZZTOTI    INT    150
2215 C                     Z-ADDZZTOTD    DEC     30
2216 C*
2217 C           ROP       ADD  1         ROP
2218 C                     ENDSR
2219 C********************************************************************
2220 C/SPACE 3
2221 C********************************************************************
2222 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
2223 C*   IND '99' IS SET BY AN OVERFLOW ERROR
2224 C*
2225 CSR         GLZADD    BEGSR                           *** GLZADD ****
2226 C*
2227 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
2228 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
2229 C*
2230 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
2231 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
2232 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
2233 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
2234 C*
2235 CSR                   EXSR GLZSUM
2236 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
2237 C*
2238 C********************************************************************
2239 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
2240 C*                        GLZADD, GLZSUB, GLZCMP.
2241 C*          PARAMETERS PASSED -
2242 C*                     I/P ZZAMTI ZZAMTD
2243 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
2244 C*
2245 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
2246 C*
2247 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
2248 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
2249 CSR                   SETOF                     919293
2250 CSR                   SETOF                     949599
2251 C*
2252 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
2253 CSR         ZZAMTI    COMP 0                      9293
2254 CSR 93      ZZAMTD    COMP 0                      9293
2255 CSR 93                GOTO ZZSEND                     ZERO BYPASS
2256 C*
2257 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
2258 CSR         ZZTOTI    COMP 0                      9193
2259 CSR 93      ZZTOTD    COMP 0                      9193
2260 C*
2261 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
2262 CSR 93                Z-ADDZZAMTI    ZZTOTI
2263 CSR 93                Z-ADDZZAMTD    ZZTOTD
2264 CSR 93                GOTO ZZSEND                     ZERO BYPASS
2265 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
2266 CSR 91N92
2267 CORN91 92             GOTO ZZOFPS
2268 C*
2269 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
2270 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
2271 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
2272 C*
2273 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
2274 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
2275 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
2276 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
2277 C*
2278 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
2279 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
2280 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
2281 CSRN99                Z-ADDZZWK2     ZZTOTD
2282 CSRN99                Z-ADDZZWK3     ZZTOTI
2283 C*
2284 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
2285 CSR 99                Z-ADD0         ZZAMT  153
2286 CSR                   GOTO ZZSEND
2287 C*
2288 C* THE 'SIGNS' ARE DIFFERENT
2289 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
2290 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
2291 C*
2292 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
2293 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
2294 C*
2295 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
2296 C*
2297 CSR 91                Z-SUBZZTOTI    ZZTOTI
2298 CSR 91                Z-SUBZZTOTD    ZZTOTD
2299 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
2300 C*
2301 CSR         ZZTOTI    COMP ZZAMTI               93  95
2302 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
2303 C*
2304 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
2305 CSR 95                Z-ADD0         ZZTOTI
2306 CSR 95                Z-ADD0         ZZTOTD
2307 CSR 95                GOTO ZZSEND
2308 C*
2309 C* IF ZZTOT GT. ZZAMT.
2310 CSR 93      ZZAMTD    COMP ZZTOTD               94
2311 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
2312 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
2313 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
2314 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
2315 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
2316 C*
2317 C*
2318 C* IF ZZAMT GT. ZZTOT.
2319 CSRN93      ZZTOTD    COMP ZZAMTD               94
2320 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
2321 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
2322 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
2323 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
2324 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
2325 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
2326 C*
2327 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
2328 CSR                   SETOF                     94
2329 CSR 93 91
2330 CORN93 92             SETON                     94
2331 CSR 94                Z-SUBZZTOTI    ZZTOTI
2332 CSR 94                Z-SUBZZTOTD    ZZTOTD
2333 C**
2334 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
2335 CSR 92                Z-SUBZZAMTI    ZZAMTI
2336 CSR 92                Z-SUBZZAMTD    ZZAMTD
2337 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
2338 C**
2339 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
2340 CSR                   SETOF                     96
2341 CSR         ZZTOTD    COMP 0                        91
2342 CSR 91      ZZTOTI    COMP 0                      96
2343 CSR 96                MOVE '.000-'   ZZNEGD  5
2344 CSR                   ENDSR                             ** ENDSR **
2345 C********************************************************************
2346 C/SPACE 3
2347 C********************************************************************066550
2348 C***********                                                         066550
2349 C*****GLINTC SR. TO CALCULATE INTEREST BETWEEN ANY TWO DAY NUMBERS.  066550
2350 C***********                                                         066550
2351 C*****THIS*VERSION REPLACES THE ORIGINAL GLINTC SR. NOW NAMED        066550
2352 C*****GLINTO.                                                        066550
2353 C***********                                                         066550
2354 C*****CALCULATION METHODS ARE -                                      066550
2355 C*****1**ACTUAL/365                                                  066550
2356 C*****2**ACTUAL/360                                                  066550
2357 C*****3**360/360 (SOMETIMES CALLED 30/360)                           066550
2358 C*****4**365/365 (EXCLUDING 29/02)                                   066550
2359 C*****5**365/360 (EXCLUDING 29/02)                                   066550
2360 C*****6**ACTUAL/366                                                  066550
2361 C***********                                                         066550
2362 C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.                     066550
2363 C***********                                                         066550
2364 C***********                                                         066550
2365 C*R*********GLINTC    BEGSR                           ** GLINTC  **  066550
2366 C***********                                                         066550
2367 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                           066550
2368 C*R*********          Z-ADDZIBEG     ZIBEG   50       STARTING DATE  066550
2369 C*R*********          Z-ADDZIEND     ZIEND   50       FINISHING DATE 066550
2370 C*R*********          Z-ADDZICALC    ZICALC  10       CALC. BASIS    066550
2371 C*R*********          Z-ADDZIAMT     ZIAMT  150       PRINCIPAL      066550
2372 C*R*********          Z-ADDZIRATE    ZIRATE 117       RATE OF INTRST 066550
2373 C***********                                                         066550
2374 C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED           066550
2375 C*R*********ZIEND     SUB  ZIBEG     ZDAYN1  50                      066550
2376 C***********                                                         066550
2377 C****CHECK*FOR INTEREST CALCULATION BASIS                            066550
2378 C*****USE*OF INDICATRS                                               066550
2379 C*****1,92**2,90  3,91  4,97  5,96  6,95                             066550
2380 C*R*********ZICALC    COMP 2                    919290               066550
2381 C**N91******          GOTO ZILPCK                                    066550
2382 C***********ZICALC    COMP 5                    959796               066550
2383 C***97******ZICALC    COMP 3                    97  91               066550
2384 C***95******                                                         066550
2385 C*R*96******          SETOF                     91                   066550
2386 C**N91******          GOTO ZILPCK                                    066550
2387 C***********                                                         066550
2388 C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WHEN      066550
2389 C*****USING*THE 30/360 BASIS - METHOD 3.                             066550
2390 C***********          EXSR ZSAVE                                     066550
2391 C***********          Z-ADDZIBEG     ZDAYNO                          066550
2392 C***********          EXSR ZDATE2                                    066550
2393 C***********          MOVE ZDAY      ZISD    20                      066550
2394 C***********          MOVE ZMTH      ZISM    20                      066550
2395 C***********          MOVE ZYEAR     ZISY    20                      066550
2396 C***********          Z-ADDZIEND     ZDAYNO                          066550
2397 C***********          EXSR ZDATE2                                    066550
2398 C***********          MOVE ZDAY      ZIFD    20                      066550
2399 C***********          MOVE ZMTH      ZIFM    20                      066550
2400 C***********          MOVE ZYEAR     ZIFY    20                      066550
2401 C***********          EXSR ZRSTOR                                    066550
2402 C***********          SETOF                     93                   066550
0    C****IN*ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEAR IF  066550
     C****ZIEND*IS GREATER THAN ZIBEG,THEN THE DATE ZIEND MUST BE IN A    066550
     C****DIFFERENT CENTURY TO ZIBEG.IF SO ADD 100 YEARS TO IT.           066550
     C***********ZIEND     COMP ZIBEG                93                   066550
     C***93******ZIFY      COMP ZISY                   93                 066550
     C***********          Z-ADDZISY      ZISY2   30                      066550
     C**N93******          Z-ADDZIFY      ZIFY2   30                      066550
     C***93******ZIFY      ADD  100       ZIFY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*START*YEAR*IS*A*LEAP*YEAR*AND*IF*START*S01147066550
     C*****MONTH*IS*FEBRUARY.***************************************S01147066550
     C***********                                                   S01147066550
     C**N98******          BITOF'0'       ZGLBIT  1           E80945S01147066550
     C***98******          BITON'0'       ZGLBIT              E80945S01147066550
     C***********ZISY2     ADD  1900      ZLYCHK  40                S01147066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01147066550
     C***********          MVR            ZLYREM  20                S01147066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YE S01147066550
     C***********ZISM      COMP 2                        99*FEBRUAR S01147066550
2209 C**N99******30        SUB  ZISD      ZID1    50   93           S01147066550
2210 C**N99*93***          Z-ADD0         ZID1                      S01147066550
     C***99N98***28        SUB  ZISD      ZID1                      S01147066550
     C***99*98***29        SUB  ZISD      ZID1                      S01147066550
2209 C***********30        SUB  ZISD      ZID1    50   93           S01147066550
2210 C***93******          Z-ADD0         ZID1                      S01147066550
2211 C***********ZISM      COMP 12                       93               066550
2212 C***93******          Z-ADD0         ZISM                            066550
2213 C***93******ZISY      ADD  1         ZISY                            066550
     C***93******ZISY2     ADD  1         ZISY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*END*YEAR*IS*A*LEAP*YEAR*AND*IF*END*MON*S01147066550
     C*****IS*FEBRUARY.*********************************************S01147066550
     C***********                                                   S01147066550
     C***********ZIFY2     ADD  1900      ZLYCHK  40                S01147066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01147066550
     C***********          MVR            ZLYREM  20                S01147066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YE S01147066550
     C***********ZIFM      COMP 2                        99*FEBRUAR S01147066550
2214 C**N99******ZIFD      COMP 31                       93         S01147066550
2214 C***99N98***ZIFD      COMP 28                       93         S01147066550
2214 C***99*98***ZIFD      COMP 29                       93         S01147066550
     C***********          SETOF                     98       E80945S01147066550
     C***********          TESTB'0'       ZGLBIT         98   E80945S01147066550
2214 C***********ZIFD      COMP 31                       93         S01147066550
2409 C***93******ZID1      ADD  30        ZID1                            066550
2410 C**N93******ZID1      ADD  ZIFD      ZID1                            066550
2411 C***********ZIFM      SUB  1         ZIFM                            066550
     C***********ZISY      COMP ZIFY                     93               066550
2413 C***93******ZIFM      SUB  ZISM      ZINOM   30                      066550
2414 C***93******          GOTO ZIOUT                                     066550
2415 C***********12        SUB  ZISM      ZIM1    20                      066550
2416 C***********          Z-ADD1         ZISM                            066550
     C*****USE*ENLARGED FIELDS THAT CAN HANDLE 1999 ONWARDS               066550
     C***********ZISY2     ADD  1         ZISY2                           066550
     C***********ZIFY2     SUB  ZISY2     ZIY1    20                      066550
2419 C***********ZIY1      MULT 12        ZIM2    30                      066550
2420 C***********ZIM2      ADD  ZIFM      ZIM2                            066550
2421 C***********ZIM1      ADD  ZIM2      ZINOM                           066550
2422 C***********ZIOUT     TAG                             * ZIOUT TAG *  066550
2423 C***********ZINOM     MULT 30        ZID2    50                      066550
2424 C***********ZID2      ADD  ZID1      ZDAYN1                          066550
2425 C***********          SETOF                     93                   066550
2426 C***********ZILPCK    TAG                             * ZILPCK TAG * 066550
2427 C**N96N97***          GOTO ZICAL                                     066550
2428 C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.         066550
2429 C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB   066550
2430 C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, & ZIEND.066550
2431 C***********                                                         066550
2432 C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                        066550
2433 C***********ZDAYN1    DIV  1461      ZIMAN   20                      066550
2434 C***********          MVR            ZIREM   50                      066550
2435 C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.                    066550
2436 C***********ZIBEG     SUB  60        ZIBW1   50                      066550
2437 C***********ZIBW1     DIV  1461      ZIDW1   20                      066550
2438 C***********          MVR            ZIDREM  50                      066550
2439 C***********ZIDREM    COMP 0                        94               066550
2440 C***94******          Z-ADDZIBEG     ZIDW2   50                      066550
2441 C***94******          GOTO ZILP1                                     066550
2442 C*****ROUND*UP RESULT                                                066550
2443 C***********ZIDW1     ADD  1         ZIDW2                           066550
2444 C*****CALCULATE NEXT 29 FEB.                                         066550
2445 C***********ZIDW2     MULT 1461      ZIDW2                           066550
2446 C***********ZIDW2     ADD  60        ZIDW2                           066550
2447 C***********ZILP1     TAG                             * ZILP1 TAG *  066550
2448 C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO        066550
2449 C*****ZIREM*THEN ADD 1 TO ZIMAN.                                     066550
2450 C***********ZIDW2     SUB  ZIBEG     ZILPCP  50                      066550
2451 C***********ZIREM     COMP ZILPCP               94  94               066550
2452 C***94******ZIMAN     ADD  1         ZIMAN                           066550
2453 C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1             066550
2454 C*****REQUIRED FOR THIS INTEREST CALCULATION.                        066550
2455 C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                          066550
2456 C***********          SETOF                     94                   066550
2457 C***********ZICAL     TAG                             * ZICAL TAG *  066550
2458 C***********                                                         066550
2459 C****CALCULATE INTEREST                                              066550
2460 C***90******                                                         066550
2461 C*R*91******                                                         066550
2462 C*R*96******ZIAMT     DIV  36000     ZIWRK1 155H                     066550
2463 C***92******                                                         066550
2464 C*R*97******ZIAMT     DIV  36500     ZIWRK1    H                     066550
2465 C***95******ZIAMT     DIV  36600     ZIWRK1    H                     066550
2466 C*R*********ZIWRK1    MULT ZIRATE    ZIWRK2 155H                     066550
2467 C*R*********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF INTRST 066550
2468 C***********                                                         066550
2469 C***********          SETOF                     909192               066550
2470 C***********          SETOF                     959697               066550
2471 C*R*********          ENDSR                                          066550
2472 C***********                                                         066550
2473 C********************************************************************066550
2474 C/SPACE
2475 C********************************************************************
2476 C**
2477 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS
2478 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.
2479 C**
2480 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS
2481 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.
2482 C**
2483 C           ZSAVE     BEGSR                           *** ZSAVE ***
2484 C**
2485 C                     BITOF'01234567'ZBITS   1
2486 C   90                BITON'0'       ZBITS
2487 C   91                BITON'1'       ZBITS
2488 C   92                BITON'2'       ZBITS
2489 C   93                BITON'3'       ZBITS
2490 C   94                BITON'4'       ZBITS
2491 C   95                BITON'5'       ZBITS
2492 C   96                BITON'6'       ZBITS
2493 C   97                BITON'7'       ZBITS
2494 C**
2495 C                     SETOF                     909192
2496 C                     SETOF                     939495
2497 C                     SETOF                     9697
2498 C**
2499 C                     ENDSR
2500 C**
2501 C**
2502 C********************************************************************
2503 C/SPACE 3
2504 C********************************************************************
2505 C**
2506 C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS
2507 C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.
2508 C**
2509 C           ZRSTOR    BEGSR                           *** ZRSTOR ***
2510 C**
2511 C                     TESTB'0'       ZBITS          90
2512 C                     TESTB'1'       ZBITS          91
2513 C                     TESTB'2'       ZBITS          92
2514 C                     TESTB'3'       ZBITS          93
2515 C                     TESTB'4'       ZBITS          94
2516 C                     TESTB'5'       ZBITS          95
2517 C                     TESTB'6'       ZBITS          96
2518 C                     TESTB'7'       ZBITS          97
2519 C**
2520 C                     ENDSR
2521 C**
2522 C**
2523 C********************************************************************
2524 C/SPACE 3
2525 C********************************************************************
2526 C**
2527 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
2528 C**
2529 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
2530 C**
2531 C           ZDATE2    BEGSR                           *** ZDATE2 ***
2532 C**
2533 C**   CLEAR DATE FIELDS.
2534 C                     Z-ADD0         ZDATE   60
2535 C                     MOVEL'       ' ZADATE  7
2536 C**
2537 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
2538 C                     Z-ADDZDAYNO    ZDAYNO  50
2539 C**
2540 C**   DETERMINE YEAR NUMBER.
2541 C**
2542 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
2543 C           ZDAYNO    SUB  1         ZDAYN1  50   99
2544 C   99                GOTO ZDEND2
2545 C**
2546 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
2547 C           ZDAYN1    DIV  1461      ZLYR    20
2548 C                     MVR            ZDAYN1           SAVE REMAINING
2549 C**                                                   DAYS
2550 C**   CALCULATE NUMBER OF REMAINING YEARS.
2551 C                     Z-ADD1         ZWRK2   20
2552 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
2553 C           ZDAYN1    COMP ZYDY,ZWRK2             90
2554 C  N90      ZWRK2     ADD  1         ZWRK2
2555 C  N90                GOTO ZDTAG1
2556 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
2557 C**
2558 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
2559 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
2560 C**
2561 C**   CALCULATE ACTUAL YEAR NUMBER.
2562 C           ZLYR      MULT 4         ZWRK3   30
2563 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
2564 C                     Z-ADDZWRK3     ZYEAR   20
2565 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
2566 C**
2567 C**   DETERMINE MONTH NUMBER.
2568 C**
2569 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
2570 C                     SETOF                     9293
2571 C   91      ZDAYN1    COMP 59                     9293
2572 C   91N92   ZDAYN1    SUB  1         ZDAYN1
2573 C**
2574 C**   CALCULATE MONTH NUMBER.
2575 C                     Z-ADD2         ZWRK2
2576 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
2577 C           ZDAYN1    COMP ZMDY,ZWRK2             94
2578 C  N94      ZWRK2     ADD  1         ZWRK2
2579 C  N94                GOTO ZDTAG2
2580 C           ZWRK2     SUB  1         ZWRK2
2581 C**
2582 C                     Z-ADDZWRK2     ZMTH    20       MONTH
2583 C**
2584 C**   DETERMINE DAY OF MONTH.
2585 C**
2586 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
2587 C           ZDAYN1    ADD  1         ZDAYN1
2588 C**
2589 C**   CALCULATE DAY OF MONTH.
2590 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
2591 C**
2592 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
2593 C   93      ZDAY      ADD  1         ZDAY
2594 C**
2595 C**   FORMAT DATE, DDMMYY OR MMDDYY.
2596 C  N98                MOVELZDAY      ZWRK4   40
2597 C   98                MOVE ZDAY      ZWRK4
2598 C  N98                MOVE ZMTH      ZWRK4
2599 C   98                MOVELZMTH      ZWRK4
2600 C                     MOVELZWRK4     ZDATE
2601 C                     MOVE ZYEAR     ZDATE
2602 C**
2603 C**   FORMAT ALPHA DATE, DDMMMYY.
2604 C           ZDAY      COMP 10                     95
2605 C                     MOVELZDAY      ZWRK5   5
2606 C   95                MOVEL' '       ZWRK5
2607 C                     MOVE ZMNM,ZMTH ZWRK5
2608 C                     MOVELZWRK5     ZADATE
2609 C                     MOVE ZYEAR     ZADATE
2610 C**
2611 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
2612 C**
2613 C**
2614 C********************************************************************
2615 C/SPACE 3
2616 C********************************************************************
2617 C* CONTROL CHECK ONLF/DTRIN DURING I/P CYCLE ORLF/DLIND AT END OF DAY
2618 C           TTRANS    BEGSR                           *** TTRANS ***
2619 C* FOR 'H' AND 'T'
2620 C           RIP,3     ADD  2         RIP,3
2621 C  N55N89   RIP,3     COMP RIP,5                5555
2622 C  N55 89   RIP,1     COMP RIP,3                5555
2623 C   55                SETON                     U8
2624 C                     ENDSR
2625 C********************************************************************
2626 C/SPACE 3
2627 C********************************************************************
2628 C* CONTROL CHECK ON LF/DAIND *END OF DAY*
2629 C           TDAIND    BEGSR                           *** TDAIND ***
2630 C* FOR 'H' AND 'T'
2631 C           RIP,4     ADD  2         RIP,4
2632 C  N56      RIP,2     COMP RIP,4                5656
2633 C   56                SETON                     U8
2634 C                     ENDSR
2635 C********************************************************************
2636 C/SPACE 3
2637 C********************************************************************
0880 C*****                                                       *****   S01194
0881 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD*   S01194
0882 C*****                                                       *****   S01194
0883 C*****      ZSYSTM    BEGSR                           *** ZSYSTM**** S01194
0884 C*****                                                       *****   S01194
0885 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.            *****   S01194
0886 C*****                MOVEL'01      'ZTABKY 12               *****   S01194
0887 C*****                MOVE '  10'    ZTABKY                  *****   S01194
0888 C*****                                                       *****   S01194
0889 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0890 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0891 C*****                                                       *****   S01194
0892 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.            *****   S01194
0893 C*****      DATF      COMP 'M'                      98MMDDYY,*98*ON  S01194
0894 C*****                                                       *****   S01194
0895 C*****                ENDSR                                  *****   S01194
0896 C*****                                                       *****   S01194
2655 C********************************************************************
     C/EJECT                                                              S01119
     C*****************************************************************   S01194
     C*                                                                   S01194
     C* SUBROUTINE : #ZZ                                                  S01194
     C*                                                                   S01194
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01194
     C* NO RECORDS READ AND THEREFORE SDBANKPD NOT READ                   S01194
     C*                                                                   S01194
     C           #ZZ       BEGSR                                          S01194
     C*                                                                   S01194
     C** IF FIRST CYCLE NOT PERFORMED GET BANK DETAILS FOR HEADINGS       S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'016'     DBASE   3        * DBERR 016*   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO #ZZ9                                      S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           #ZZ9      ENDSR                                          S01194
     C*****************************************************************   S01194
1034 C/EJECT                                                              S01194
0726 C*****************************************************************   S01194
1024 C*    ERROR DUMP SUBROUTINE.                                         S01194
1048 C*                                                                   S01194
1034 C           *PSSR     BEGSR                           ***  PSSR **   S01194
1020 C           @RUN      IFEQ *BLANK                                    S01194
1021 C                     MOVE 'Y'       @RUN    1                       S01194
1020 C                     DUMP                                           S01194
1021 C                     END                                            S01194
1022 C                     ENDSR                           *** *PSSR **   S01194
1048 C**                                                                  S01194
0726 C*****************************************************************   S01194
2656 C/EJECT
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
2657 O*                  C O N T R O L   R E P O R T
2658 O/SPACE 3
2659 O*L0304P1T**203   LR                                                 S01117
2659 ODL0304AUT  203   LR                                                 S01117
2660 O***********                        22 'REFERENCE DL0304'            S01117
2660 O                                   24 'REFERENCE DL0304AU'          S01117
2661 O*****                    TITL      89                       *****   S01194
2661 O                         BJURPT    89                               S01194
2662 O                                  122 'DATE              PAGE'
2663 O*****                    RUNA     112                       *****   S01194
2663 O                         BJMRDT   112                               S01194
2664 O                                  130 '1'
2665 O        T  1     LR
2666 O                                   63 'PAY/RECEIVE EXTRACT - FI'
2667 O                                   80 'LE CONTROL REPORT'
2668 O                                  113 'EXCEPTION'
2669 O                       89         113 'NON EXCEPTION'
2670 O        T  3     LR
2671 O                                   63 '------------------------'
2672 O                                   80 '-----------------'
2673 O        T  1     LR
2674 O                                   28 'S/DTRIN - RUN CONTROLS'
2675 O                       89          13 'DLIND'
2676 O                                   59 'NUMBER'
2677 O                                   84 'VALUE'
2678 O        T  2     LR
2679 O                                   28 '----------------------'
2680 O                                   59 'OF RECORDS'
2681 O                                   84 'OF RECORDS'
2682 O        T  2     LR
2683 O                                   31 'TOTAL RECORDS - ON FILE'
2684 O                      N89RIP,5 3   59
2685 O                       89RIP,1 3   59
2686 O        T  3     LR
2687 O                                   32 'TOTAL RECORDS - CALCULAT'
2688 O                                   34 'ED'
2689 O                         RIP,3 3   59
2690 O                       55         119 '***   DIFFERENCE   ***'
2691 O        T  1     LR 89
2692 O                                   28 'S/DAIND - RUN CONTROLS'
2693 O        T  2     LR 89
2694 O                                   28 '----------------------'
2695 O        T  2     LR 89
2696 O                                   31 'TOTAL RECORDS - ON FILE'
2697 O                         RIP,2 3   59
2698 O        T  3     LR 89
2699 O                                   32 'TOTAL RECORDS - CALCULAT'
2700 O                                   34 'ED'
2701 O                         RIP,4 3   59
2702 O                       56         119 '***   DIFFERENCE   ***'
2703 O        T  1     LR
2704 O                                   28 'S/PREX - RUN CONTROLS'
2705 O        T  2     LR
2706 O                                   28 '----------------------'
2707 O        T  3     LR
2708 O                                   28 'TOTAL RECORDS OUTPUT'
2709 O                         ROP   3   59
2710 O                         INT   Z   81
2711 O                         DEC       84
     O*                                                                   S01117
     O        T 3      LRNU7N25                                           S01117
0564 O                                   63 '***   NO DETAILS TO REPO'    S01117
0565 O                                   71 'RT   ***'                    S01117
2712 O*****   T 00     LRNU7                                      *****   S01117
2712 O*****   T 11     LRNU7 25                                    S01117 LN0135
2713 O*****                              71 '*** END OF REPORT ***'       LN0135
2714 O/SPACE 3
2715 O*****DATABASE ERROR                                         *****   S01194
2716 O*****   T  203   LR U7                                      *****   S01194
2717 O*****                              22 'REFERENCE DL0304'    *****   S01194
2661 O*****                    TITL      89                       *****   S01194
2719 O*****                             122 'DATE              PAG*****   S01194
2720 O*****                    RUNA     112                       *****   S01194
2721 O*****                             130 '2'                   *****   S01194
2722 O*****   T  1     LR U7                                      *****   S01194
2723 O*****                              63 'PAY/RECEIVE EXTRACT -*****   S01194
2724 O*****                              75 'TABASE ERROR'        *****   S01194
2725 O*****                             113 'EXCEPTION'           *****   S01194
2726 O*****                  89         113 'NON EXCEPTION'       *****   S01194
2727 O*****   T  3     LR U7                                      *****   S01194
2728 O*****                              63 '---------------------*****   S01194
2729 O*****                              75 '------------'        *****   S01194
2730 O*****   T 3      U7 60 LR                                   *****   S01194
2731 O*****                              67 'INSTALLATION CONTROL *****   S01194
2732 O*****                              80 'ORD 1 MISSING'       *****   S01194
2733 O*****   T 3      U7 61 LR                                   *****   S01194
2734 O*****                              67 'INSTALLATION CONTROL *****   S01194
2735 O*****                              80 'ORD 2 MISSING'       *****   S01194
2736 O*****   T 3      U7 62 LR                                   *****   S01194
2737 O*****                           ***67**INSTALLATION*CONTROL*REC**   S01194
2738 O*****                              80 'ORD 5 MISSING'       *****   S01194
2739 O*****   T 3      U7 63 LR                                   *****   S01194
2740 O*****                              70 'DEFAULT BRANCH CODE R*****   S01194
2741 O*****                              80 'RD MISSING'          *****   S01194
2742 O*****   T 3      U7 64 LR                                   *****   S01194
2743 O*****                              58 'DEAL RECORD'         *****   S01194
2744 O*****                    DLNO      65                       *****   S01194
2745 O*****                              80 'MISSING *PROC1*'     *****   S01194
2746 O*****   T 3      U7 66 LR                                   *****   S01194
2747 O*****                              49 'DEAM RECORD'         *****   S01194
2748 O*****                    KEY       64                       *****   S01194
2749 O*****                              80 'MISSING *PROC2*'     *****   S01194
2750 O*****   T 3      U7 67 LR                                   *****   S01194
2751 O*****                              58 'DEAL RECORD'         *****   S01194
2752 O*****                    DLNO      65                       *****   S01194
2753 O*****                              80 'MISSING *PROC2*'     *****   S01194
2754 O*****   T 3      U7 68 LR                                   *****   S01194
2755 O*****                              48 'DEAM RECORD'         *****   S01194
2756 O*****                    KEY2      64                       *****   S01194
2757 O*****                              67 'OR'                  *****   S01194
2758 O*****                    KEY4      82                       *****   S01194
2759 O*****                              99 'MISSING *INTRES*'    *****   S01194
2760 O*****   T 3      U7 59 LR                                   *****   S01194
2761 O*****                              76 'NO BRANCH CODE'      *****   S01194
2762 O*****                    BRCD      80                       S01117  S01194
2762 O*****                    BRCA      80                       S01117  S01194
2763 O*****   T 3      U7 LR 83                                   *****   S01194
2764 O*****                              58 'TABLE FILE RECORD'   *****   S01194
2765 O*****                    ZTABKY    71                       *****   S01194
2766 O*****                              80 'MISSING'             *****   S01194
2767 O*****   T 3      U7 LR 84                                   *****   S01194
2768 O*****                              58 'SNAME FILE RECORD'   *****   S01194
2769 O*****                    CHK10     71                       *****   S01194
2770 O*****                              79 'MISSING'             *****   S01194
2771 O*****   T 3      LR U7 85                                   *****   S01194
2772 O*****                              58 'CLINT FILE RECORD'   *****   S01194
2773 O*****                    ZCLKEY    71                       *****   S01194
2774 O*****                              76 'MISSING'             *****   S01194
2775 O*****   T 3      U7 LR                                      *****   S01194
2776 O*****                              71 '*** END OF REPORT ********   S01194
     O*                                                                   S01117
     O** OUTPUT DATABASE ERROR IF NECESSARY                               S01117
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   49 'OPTION'                      S01117
     O                         DBOPTN    57                               S01117
     O                                   66 'KEY'                         S01117
     O                         DBKEY     96                               S01117
2712 O*****   T 13     LR U7 U8                                    S01117 LN0135
2713 O*****                              71 '*** END OF REPORT ***'S01117 LN0135
     O**
2777 O/EJECT
2778 O* O U T P U T   E X T R A C T S
2779 OPREXHH  HADD     1P
2780 O                                    1 'A'
2781 OPREXZZ  TADD     LR
2782 O                                    1 'T'
2783 O                         ROP        4P
2784 O                         INT       12P
2785 O                         DEC       14P
2786 OPREXPH  EADD     34
2787 O*************************PREX     160                               E22600
2787 O**********               PREX     182                                            E22600 CGL029
     O                         PREX     230                                                   CGL029
2788 O                         VDATPH    34P
2789 O                         EAMT      74P
2790 O/SPACE 3
2791 O/SPACE 3
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** IPSET - I/P CYCLE SETTLEMENT TYPES
0102070812
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
