0001 H        1
0002 F********************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Pay/receive extract file split')
0002 F********************************************************************
0003 F*                                                                  *
     F*  Midas - Dealing Module
0005 F*                                                                  *
0006 F*       DL0307 - PAY/RECEIVE FILE SPLIT                            *
0007 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CDL025             Date 27Jan05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR003             Date 13Sep00               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 137909             Date 17Jul98               *
      *                 CEU003             Date 27Jan98               *
      *                 CDL002             Date 16Sep97               *   E22600
     F*                 E22600             Date 03Aug90               *   E22600
     F*                    LN0298             DATE 30MAY90               *LN0298
     F*                    S01117             DATE 01/03/89              *S01117
     F*                    S01194             DATE 01/03/89              *S01194
     F*                    S01144             DATE 13/01/88              *
0009 F*                                                                  *
0010 F********************************************************************
      *                                                               *  *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL025 - FX Netting Payment Generation (Recompile)           *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CIR003 - FRA/IRS Pay/Receive Messages for Swaps.             *
     F*  137909 - Adjust the prex file lengths to include the two extra  *
     F*           fields, (OTRC OTRA). ie. file length should be 211.    *
     F*  CEU003 - EMU Dealing Settlement Ccy conversion - Recompile      *
     F*           only.                                                  *
     F*     CDL002  -  FX Netting                                        *
0010 F*     E22600  -  MT203, SELECTION CRITERIA SHOULD INCLUDE          *E22600
0010 F*                FIELDS 52/53/54.                                  *E22600
     F*     LN0298  -  REMOVE 'END OF REPORT' FOR AUDIT REPORT           *LN0298
0010 F*     S01117  -  MULTIBRANCHING.                                   *S01117
0010 F*     S01194  -  NEW STANDING PROGRAMS - ADD ACCESS PROGRAMS       *S01194
0010 F*     S01144  -  RELEASE 22 INCORPORATION                          *E11682
0010 F********************************************************************
0011 FPREXHH  IP  F     160            DISK
0011 F*PREXPH**IS**F*****160************DISK                              E22600
0011 F***PREXPH**IS**F     182            DISK                      E22600CDL002
0011 F***PREXPH  IS  F     201            DISK                      CDL002137909
0011 F***PREXPH  IS  F     211            DISK                     137903 CIR003
     F***PREXPH* IS  F     212            DISK                                         CIR003 CGL029
     FPREXPH  IS  F     230            DISK                                                   CGL029
0011 FPREXZZ  IS  F     160            DISK
0012 F*****TABLE   IF  F      96 12AI     2 DISK                          S01194
0013 FPREX1HH O   F     160            DISK
0013 F*PREX1PH*O***F*****160************DISK                              E22600
0013 F***PREX1PH*O***F     182            DISK                      E22600CDL002
0013 F***PREX1PH O   F     201            DISK                      CDL002137909
0011 F***PREX1PH O   F     211            DISK                     137903 CIR003
     F***PREX1PH O   F     212            DISK                                         CIR003 CGL029
     FPREX1PH O   F     230            DISK                                                   CGL029
0013 FPREX1ZZ O   F     160            DISK
0014 FPREX2HH O   F     160            DISK
0014 F*PREX2PH*O***F*****160************DISK                              E22600
0014 F***PREX2PH*O***F     182            DISK                      E22600CDL002
0014 F***PREX2PH*O***F     201            DISK                      CDL002137909
0011 F***PREX2PH O   F     211            DISK                     137909 CIR003
     F***PREX2PH O   F     212            DISK                                         CIR003 CGL029
     FPREX2PH O   F     230            DISK                                                   CGL029
0014 FPREX2ZZ O   F     160            DISK
0015 FPREX3HH O   F     160            DISK
0015 F*PREX3PH*O***F*****160************DISK                              E22600
0015 F***PREX3PH*O***F     182            DISK                      E22600CDL002
0015 F***PREX3PH*O***F     201            DISK                      CDL002137909
0011 F***PREX3PH O   F     211            DISK                     137909 CIR003
     F***PREX3PH O   F     212            DISK                                         CIR003 CGL029
     FPREX3PH O   F     230            DISK                                                   CGL029
0015 FPREX3ZZ O   F     160            DISK
0016 FPREX4HH O   F     160            DISK
0016 F*PREX4PH*O***F*****160************DISK                              E22600
0016 F***PREX4PH*O***F     182            DISK                      E22600CDL002
0016 F***PREX4PH*O***F     201            DISK                      CDL002137909
0011 F***PREX4PH O   F     211            DISK                     137909 CIR003
     F***PREX4PH O   F     212            DISK                                         CIR003 CGL029
     FPREX4PH O   F     230            DISK                                                   CGL029
0016 FPREX4ZZ O   F     160            DISK
0017 FPREX5HH O   F     160            DISK
0017 F*PREX5PH*O***F*****160************DISK                              E22600
0017 F***PREX5PH*O***F     182            DISK                      E22600CDL002
0017 F***PREX5PH O   F     201            DISK                      CDL002137909
0017 F***PREX5PH O   F     211            DISK                     137909 CIR003
     F***PREX5PH O   F     212            DISK                                         CIR003 CGL029
     FPREX5PH O   F     230            DISK                                                   CGL029
0017 FPREX5ZZ O   F     160            DISK
0017 FPREX6HH O   F     160            DISK
0017 F*PREX6PH*O***F*****160************DISK                              E22600
0017 F***PREX6PH*O***F     182            DISK                      E22600CDL002
0017 F***PREX6PH*O***F     201            DISK                      CDL002137909
0017 F***PREX6PH O   F     211            DISK                     137909 CIR003
     F***PREX6PH O   F     212            DISK                                         CIR003 CGL029
     FPREX6PH O   F     230            DISK                                                   CGL029
0017 FPREX6ZZ O   F     160            DISK
0018 F***DL0307P1O F    132            PRINTER                      S01124S01117
0018 FDL0307AUO   F     132            PRINTER                            S01117
     F/COPY WNCPYSRC,DL0307F001
0019 F*
0020 F********************************************************************
0021 F*
0022 F* ID F  C  H  L    FUNCTION OF INDICATORS
0023 F*
0024 F* 01            PREX HEADER
0025 F* 02            PREX DETAIL
0026 F* 03            PREX TRAILER
0027 F*
0028 F*       40      BYPASS FIRST CYCLE OPERATIONS
0029 F*       41      S.W.I.F.T. IN SYSTEM
     F*       42      DEALING-TO-CHIPS INTERFACE PRESENT
0030 F*
 031 F*     51-56     MESSAGE OUTPUT TYPES
0032 F*
0033 F******91-99*****ZSYSTM,GLZADD,GLZSUM*******                         S01194
0033 F*     91-99     GLZADD,GLZSUM                                       S01194
0034 F*
0035 F*         U7U8  DATABASE ERROR
     F*          U5    NETTING MODE                                       CDL002
0036 F*          U8   FOOB
0037 F*
0038 F********************************************************************
     E                    CPY@    1   1 80
0039 E*
0040 E*    TABLES AND ARRAYS
0041 E*
0042 E                    TABMTI  6   6  2 0 TABN    1 0 MSG TYPE/INDEX
     E/COPY WNCPYSRC,DL0307E001
0043 E                    INT         6 15 0             FIRST 15
0044 E                    DEC         6  3 0             LAST 3
0045 E                    TOT         6  5 0             MSG TYPE TOTALS
     E/COPY WNCPYSRC,DL0307E002
0046 E/EJECT
0047 I*
0048 I*    SORTED PAY/RECEIVE EXTRACT FILE
0049 I*
0050 IPREXHH  NS  01   1 CA
0051 I                                        1   1 RECI
0052 IPREXPH  NS  02   1 CD
0053 I                                        1   1 RECI
     I/COPY WNCPYSRC,DL0307I002
0054 I****************************************1 160 RECORD                E22600
0054 I***********                             1 182 RECORD          E22600CDL002
     I***********                             1 201 RECORD          CDL002137909
     I**********                              1 211 RECORD         137909 CIR003
     I**********                              1 212 RECORD                             CIR003 CGL029
     I                                        1 230 RECORD                                    CGL029
0055 I                                    P  68  740EAMT
0056 I                                      157 1580MTIN
     I/COPY WNCPYSRC,DL0307I001
0057 IPREXZZ  NS  03   1 CT
0058 I                                        1   1 RECI
0059 I                                    P   2   40NORE
0060 I                                    P   5  120HRWN
0061 I                                    P  13  140HRDC
0062 I        NS
0063 I*
0064 I*
0065 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0066 I*****                                                               S01194
0067 I*****TABLE   NS       2 C0   3 C1  12 C1                            S01194
0068 I*****  AND      13 C0                                               S01194
0069 I*****                                   1   1 RECI                  S01194
0070 I*****                                   2   30RECT                  S01194
0071 I*****                                  12  130RCDE                  S01194
0072 I*****                                  14  66 TITL                  S01194
0073 I*****                                  67  67 DATF                  S01194
0074 I*****                                  68  700DFBR                  S01194
     I*****                                  72  72 CHIM                  S01194
0075 I*****                                  73  73 SWIM                  S01194
0076 I*****                                  74  74 MODI1                 S01194
0077 I*****                                  75  75 MODI2                 S01194
0078 I*****                                  76  76 MODI3                 S01194
0079 I*****                               P  77  790RUND                  S01194
0080 I*****                                  80  86 RUNA                  S01194
0081 I*****                                  87  870SFLG                  S01194
0081 I*****                                  89  89 MODI5           S01144S01194
0082 I*****                               P  90  920LCD                   S01194
0083 I*****                                  93  93 CHTP                  S01194
0084 I*****                               P  94  960TNLU                  S01194
0085 I*****CATCHALL                                                       S01194
0086 I*****   NS                                                          S01194
     I/COPY WNCPYSRC,DL0307I003
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I** EXTERNAL DS FOR MIDAS MODULES DETAILS                            S01194
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
0088 I*    LOCAL DATA AREA - DATABASE ERRORS
0089 I*
0090 ILDA        UDS                            256
0546 I*****                                 134 138 DBFILE                S01194
0547 I*****                                 139 167 DBKEY                 S01194
0548 I*****                                 168 175 DBPGM                 S01194
0549 I*****                                 176 1770DBASE                 S01194
0546 I                                      134 141 DBFILE                S01194
0547 I                                      142 170 DBKEY                 S01194
0548 I                                      171 180 DBPGM                 S01194
0549 I                                      181 1830DBASE                 S01194
     I/COPY WNCPYSRC,DL0307I004
0095 I*
0096 I/EJECT
0097 C********************************************************************
0098 C*
0099 C*    FIRST CYCLE OPERATIONS
0100 C*
0101 C   40                GOTO NOTFC
0102 C                     SETON                     40
     C                     MOVEACPY@      BIS@   80
0104 C                     MOVEL'DL0307'  DBPGM                           S01194
     C*                                                                   S01117
0103 C*********************EXSR ZSYSTM                                    S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG'    @RTCD   7                       S01194
     C                     PARM '*FIRST'  @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
0104 C*********************MOVEL'DL0307'  DBPGM                           S01194
0105 C***99****************MOVEL'TABLE'   DBFILE                          S01194
0106 C***99****************MOVELZTABKY    DBKEY                           S01194
0107 C***99****************Z-ADD01        DBASE            * DB ERROR 01 *S01194
0108 C***99****************SETON                     U7U8LR               S01194
0109 C***99****************GOTO END                                       S01194
     C                     MOVEL'SDBANKPD'DBFILE           ************   S01194
     C                     MOVEL@OPTN     DBKEY            * DBERR 01 *   S01194
0107 C                     Z-ADD01        DBASE            ************   S01194
     C                     EXSR *PSSR                                     S01194
0109 C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG'    @RTCD   7                       S01194
     C                     PARM '*FIRST'  @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C*********************MOVEL'DL0307'  DBPGM                           S01194
     C                     MOVEL'SDMMODPD'DBFILE           ************   S01194
     C                     MOVEL@OPTN     DBKEY            * DBERR 02 *   S01194
0107 C                     Z-ADD02        DBASE            ************   S01194
     C                     EXSR *PSSR                                     S01194
0109 C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*                                                                   S01194
0110 C*********************TESTB'0'       SWIM           41               S01194
0110 C**N41****************TESTB'1'       MODI5          41         S01144S01194
0110 C*********************TESTB'0'       CHIM           42-CHIPS INTRFACES01194
     C           BGSWDL    IFEQ 'Y'                                       S01194
     C                     MOVE '1'       *IN41                           S01194
     C                     ELSE                                           S01194
     C           BGMTMI    IFEQ 'Y'                                       S01194
     C                     MOVE '1'       *IN41                           S01194
     C                     END                                            S01194
     C                     END                                            S01194
     C           BGCHDL    IFEQ 'Y'                                       S01194
     C                     MOVE '1'       *IN42                           S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,DL0307C001
0111 C           NOTFC     TAG                             ***  NOTFC  ***
0112 C*
0113 C********************************************************************
0114 C*
0115 C           TOTT      ADD  1         TOTT    50
0116 C   03                SETON                     13
0117 C  N02                GOTO END
0118 C*
0119 C*    WHICH FILE IS TO BE WRITTEN TO
0120 C*
     C/COPY WNCPYSRC,DL0307C008
0121 C           MTIN      COMP 09                       51   PREX1
0122 C           MTIN      COMP 10                       52   PREX2
0123 C           MTIN      COMP 11                       53   PREX3
0124 C           MTIN      COMP 12                       54   PREX4
0125 C           MTIN      COMP 01                       55   PREX5 SWIFT
0125 C           MTIN      COMP 02                       56   PREX6
0126 C           MTIN      LOKUPTABMTI    TABN           89
     C  N89                MOVEL'PRSX '   DBFILE
     C  N89                MOVEL'REC NO ' CHK12  12
     C  N89                MOVE TOTT      CHK12
     C  N89                MOVELCHK12     DBKEY
     C  N89                Z-ADD02        DBASE             *DB ERROR 02 *
     C  N89                SETON                     U7U8LR
     C  N89                GOTO END
0127 C                     Z-ADDTABN      N       10
     C/COPY WNCPYSRC,DL0307C009
0128 C*
0129 C*    IF SWIFT NOT IN SYSTEM PREX5 NOT USED
0130 C*
0131 C   55N41             SETON                     U7U8LR
0132 C   55N41             MOVEL'PRSX  '  DBFILE
0133 C   55N41             MOVEL'REC NO ' CHK12  12
0134 C   55N41             MOVE TOTT      CHK12
0135 C   55N41             MOVELCHK12     DBKEY
0136 C   55N41             Z-ADD03        DBASE            * DB ERROR 03 *
0137 C   55N41             GOTO END
     C*
     C/COPY WNCPYSRC,DL0307C004
     C*    IF NO CHIPS INTERFACE, S/PREX6 CANNOT BE USED
     C*
     C   56N42             MOVEL'PRSX '   DBFILE
     C   56N42             MOVEL'REC NO ' CHK12
     C   56N42             MOVE TOTT      CHK12
     C   56N42             MOVELCHK12     DBKEY
     C   56N42             Z-ADD04        DBASE            * DB ERROR 04 *
     C   56N42             SETON                     U7U8LR
     C   56N42             GOTO END
     C/COPY WNCPYSRC,DL0307C002
0138 C*
0139 C*    MAINTAIN HASH TOTALS
0140 C*
0141 C           EAMT      DIV  1000      ZZAMT
0142 C                     Z-ADDINT,N     ZZTOTI
0143 C                     Z-ADDDEC,N     ZZTOTD
0144 C                     EXSR GLZADD
0145 C                     Z-ADDZZTOTI    INT,N
0146 C                     Z-ADDZZTOTD    DEC,N
0147 C*
0148 C           TOT,N     ADD  1         TOT,N
     C/COPY WNCPYSRC,DL0307C006
0149 C*
0150 C           END       TAG                             ***   END   ***
0151 C*
0152 CLR U7 U8             GOTO LRPASS
0153 C*
0154 C*    DATABASE ERROR IF NO TRAILER
0155 C*
0156 CLRN13                SETON                     U7U8
0157 CLRN13                MOVEL'PRSX  '  DBFILE
0158 CLRN13                MOVEL'TRAILER 'CHK15  15
0159 CLRN13                MOVE 'MISSING' CHK15
0160 CLRN13                MOVELCHK15     DBKEY
0161 CLRN13                Z-ADD05        DBASE            * DB ERROR 05 *
0162 C*
0163 C*    INCLUDE HEADER AND TRAILER
0164 C*
0165 CLRNU7      TOT       ADD  2         TOT
     C/COPY WNCPYSRC,DL0307C005
0166 C*
0167 CLR         LRPASS    TAG                             *** LRPASS  ***
0168 C*
0169 C*    INPUT FILE #TOTALS
0170 C*
0171 CLR                   XFOOTDEC       DECT    40
0172 CLR                   XFOOTINT       INTT   150
     C/COPY WNCPYSRC,DL0307C003
0173 CLR                   MOVELDECT      DEC1    10
0174 CLR                   MOVE DECT      DEC3    30
0175 CLR         INTT      ADD  DEC1      INTT
0176 CLRNU7      DEC3      COMP HRDC                 U8U8
0177 CLRNU7NU8   INTT      COMP HRWN                 U8U8
0178 CLRNU7NU8   TOTT      COMP NORE                 U8U8
     C*                                                                   S01117
0180 C/EJECT
0181 C********************************************************************
0182 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0183 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0184 C*
0185 C           GLZADD    BEGSR                           *** GLZADD ****
0186 C*
0187 C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0188 C   91                GOTO ZZAEND                     AMT = 0.BYPASS
0189 C*
0190 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0191 C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0192 C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0193 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0194 C*
0195 C                     EXSR GLZSUM
0196 C           ZZAEND    ENDSR                           ** ZZAEND TAG *
0197 C*
0198 C********************************************************************
0199 C********************************************************************
0200 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0201 C*                        GLZADD, GLZSUB, GLZCMP.
0202 C*          PARAMETERS PASSED -
0203 C*                     I/P ZZAMTI ZZAMTD
0204 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0205 C*
0206 C           GLZSUM    BEGSR                           *** GLZSUM ****
0207 C*
0208 C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0209 C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0210 C                     SETOF                     919293
0211 C                     SETOF                     949599
0212 C*
0213 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0214 C           ZZAMTI    COMP 0                      9293
0215 C   93      ZZAMTD    COMP 0                      9293
0216 C   93                GOTO ZZSEND                     ZERO BYPASS
0217 C*
0218 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0219 C           ZZTOTI    COMP 0                      9193
0220 C   93      ZZTOTD    COMP 0                      9193
0221 C*
0222 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0223 C   93                Z-ADDZZAMTI    ZZTOTI
0224 C   93                Z-ADDZZAMTD    ZZTOTD
0225 C   93                GOTO ZZSEND                     ZERO BYPASS
0226 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0227 C   91N92
0228 CORN91 92             GOTO ZZOFPS
0229 C*
0230 C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0231 C           ZZWK2     COMP 999                  93    '93' = CARRY
0232 C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
0233 C*
0234 C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0235 C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0236 C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
0237 C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0238 C*
0239 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0240 C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0241 C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0242 C  N99                Z-ADDZZWK2     ZZTOTD
0243 C  N99                Z-ADDZZWK3     ZZTOTI
0244 C*
0245 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0246 C   99                Z-ADD0         ZZAMT  153
0247 C                     GOTO ZZSEND
0248 C*
0249 C* THE 'SIGNS' ARE DIFFERENT
0250 C           ZZOFPS    TAG                             ** ZZOFPS TAG**
0251 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0252 C*
0253 C   92                Z-SUBZZAMTI    ZZAMTI 150
0254 C   92                Z-SUBZZAMTD    ZZAMTD  30
0255 C*
0256 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0257 C*
0258 C   91                Z-SUBZZTOTI    ZZTOTI
0259 C   91                Z-SUBZZTOTD    ZZTOTD
0260 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0261 C*
0262 C           ZZTOTI    COMP ZZAMTI               93  95
0263 C   95      ZZTOTD    COMP ZZAMTD               93  95
0264 C*
0265 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0266 C   95                Z-ADD0         ZZTOTI
0267 C   95                Z-ADD0         ZZTOTD
0268 C   95                GOTO ZZSEND
0269 C*
0270 C* IF ZZTOT GT. ZZAMT.
0271 C   93      ZZAMTD    COMP ZZTOTD               94
0272 C   93 94   ZZTOTI    SUB  1         ZZTOTI
0273 C   93 94   ZZTOTD    ADD  1000      ZZWK2
0274 C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0275 C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0276 C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0277 C*
0278 C*
0279 C* IF ZZAMT GT. ZZTOT.
0280 C  N93      ZZTOTD    COMP ZZAMTD               94
0281 C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
0282 C  N93 94   ZZAMTD    ADD  1000      ZZWK2
0283 C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0284 C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0285 C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0286 C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0287 C*
0288 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0289 C                     SETOF                     94
0290 C   93 91
0291 CORN93 92             SETON                     94
0292 C   94                Z-SUBZZTOTI    ZZTOTI
0293 C   94                Z-SUBZZTOTD    ZZTOTD
0294 C**
0295 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0296 C   92                Z-SUBZZAMTI    ZZAMTI
0297 C   92                Z-SUBZZAMTD    ZZAMTD
0298 C           ZZSEND    TAG                             ** ZZSEND TAG *
0299 C**
0300 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0301 C                     SETOF                     96
0302 C           ZZTOTD    COMP 0                        91
0303 C   91      ZZTOTI    COMP 0                      96
0304 C   96                MOVE '.000-'   ZZNEGD  5
0305 C                     ENDSR                             ** ENDSR **
0306 C********************************************************************
     C*                                                                   S01194
     C/COPY WNCPYSRC,DL0307C010
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0307 C********************************************************************S01194
0308 C*********************                                               S01194
0309 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.   S01194
0310 C*********************                                               S01194
0311 C***********ZSYSTM****BEGSR                           *** ZSYSTM *** S01194
0312 C*********************                                               S01194
0313 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.*****************   S01194
0314 C*********************MOVEL'01      'ZTABKY 12                       S01194
0315 C*********************MOVE '  10'    ZTABKY                          S01194
0316 C*********************                                               S01194
0317 C***********ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
0318 C**N99******RECI******COMP 'D'                  9999  ON, IS DELETED S01194
0319 C*********************                                               S01194
0320 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.*****************   S01194
0321 C***********DATF******COMP 'M'                      98MMDDYY, 98 ON  S01194
0322 C*********************                                               S01194
0323 C*********************ENDSR                                          S01194
0324 C*********************                                               S01194
0325 C*********************                                               S01194
0326 C********************************************************************S01194
     C/COPY WNCPYSRC,DL0307C007
0327 C/EJECT
0328 O*
0329 O*    OUTPUT FILES
0330 O*
0331 OPREX1HH H        01
0332 O                                    1 'A'
0333 OPREX1PH D        02 51
0334 O*************************RECORD   160                               E22600
0334 O***********              RECORD   182                         E22600CDL002
0334 O***********              RECORD   201                         CDL002137909
0334 O**********               RECORD   211                        137909 CIR003
     O**********               RECORD   212                                            CIR003 CGL029
     O                         RECORD   230                                                   CGL029
0335 OPREX1ZZ T        LRNU7
0336 O                                    1 'T'
0337 O                         TOT,1      4P
0338 O                         INT,1     12P
0339 O                         DEC,1     14P
0340 O*
0341 OPREX2HH H        01
0342 O                                    1 'A'
0343 OPREX2PH D        02 52
0344 O*************************RECORD   160                               E22600
0344 O***********              RECORD   182                         E22600CDL002
0344 O***********              RECORD   201                         CDL002137909
0334 O**********               RECORD   211                        137909 CIR003
     O**********               RECORD   212                                            CIR003 CGL029
     O                         RECORD   230                                                   CGL029
0345 OPREX2ZZ T        LRNU7
0346 O                                    1 'T'
0347 O                         TOT,2      4P
0348 O                         INT,2     12P
0349 O                         DEC,2     14P
0350 O*
0351 OPREX3HH H        01
0352 O                                    1 'A'
0353 OPREX3PH D        02 53
0354 O*************************RECORD   160                               E22600
0354 O***********              RECORD   182                         E22600CDL002
0354 O***********              RECORD   201                         CDL002137909
0334 O**********               RECORD   211                        137909 CIR003
     O**********               RECORD   212                                            CIR003 CGL029
     O                         RECORD   230                                                   CGL029
0355 OPREX3ZZ T        LRNU7
0356 O                                    1 'T'
0357 O                         TOT,3      4P
0358 O                         INT,3     12P
0359 O                         DEC,3     14P
0360 O*
0361 OPREX4HH H        01
0362 O                                    1 'A'
0363 OPREX4PH D        02 54
0364 O*************************RECORD   160                               E22600
0364 O***********              RECORD   182                         E22600CDL002
0364 O***********              RECORD   201                         CDL002137909
0334 O**********               RECORD   211                        137909 CIR003
     O**********               RECORD   212                                            CIR003 CGL029
     O                         RECORD   230                                                   CGL029
0365 OPREX4ZZ T        LRNU7
0366 O                                    1 'T'
0367 O                         TOT,4      4P
0368 O                         INT,4     12P
0369 O                         DEC,4     14P
0370 O*
0371 OPREX5HH H        01
0372 O                                    1 'A'
0373 OPREX5PH D        02 55
0374 O*************************RECORD   160                               E22600
0374 O***********              RECORD   182                         E22600CDL002
0374 O***********              RECORD   201                         CDL002137909
0374 O**********               RECORD   211                        137909 CIR003
     O**********               RECORD   212                                            CIR003 CGL029
     O                         RECORD   230                                                   CGL029
0375 OPREX5ZZ T        LRNU7
0376 O                                    1 'T'
0377 O                         TOT,5      4P
0378 O                         INT,5     12P
0379 O                         DEC,5     14P
     OPREX6HH H        01
     O                                    1 'A'
     OPREX6PH D        02 56
     O*************************RECORD   160                               E22600
     O***********              RECORD   182                         E22600CDL002
     O***********              RECORD   201                         CDL002137909
0334 O**********               RECORD   211                        137909 CIR003
     O**********               RECORD   212                                            CIR003 CGL029
     O                         RECORD   230                                                   CGL029
     OPREX6ZZ T        LRNU7
     O                                    1 'T'
     O                         TOT,6      4P
     O                         INT,6     12P
     O                         DEC,6     14P
     O/COPY WNCPYSRC,DL0307O003
0380 O*
0381 O*
0382 O*    REPORT
0383 O*
0384 O*DL0307P1T*203***LR****************                           S01124S01117
0385 O***********************************22 'REFERENCE DL0307'            S01117
0384 ODL0307AUT  203   LR                                                 S01117
0385 O                                   22 'REFERENCE DL0307AU'          S01117
0386 O*************************TITL      92                               S01194
     O                         BJURPT    92                               S01194
0387 O                                  103 'DATE'
0388 O*************************RUNA     112                               S01194
     O                         BJMRDT   112                               S01194
0389 O                                  125 'PAGE  1'
0390 O        T  1     LR
0391 O                                   60 'PAY/RECEIVE EXTRACT FILE'
0392 O                                   84 ' SPLIT - FILE CONTROL RE'
0393 O                                   88 'PORT'
0393 O                 U5               128 'NETTING MODE'                CDL002
0394 O        T  2     LR
0395 O                                   60 '------------------------'
0396 O                                   84 '------------------------'
0397 O                                   88 '----'
0397 O                 U5               128 '------------'                CDL002
0398 O        T 21     LR
0399 O                                   51 'INPUT FILE S/PRSX'
0400 O        T  2     LR
0401 O                                   51 '-----------------'
     O/COPY WNCPYSRC,DL0307O001
0402 O                                   74 'VALUE'
0403 O                                   88 'NUMBER'
0404 O        T  2     LR
0405 O                                   38 'FILE'
0406 O                         HRWN  3   71
0407 O                         HRDC      74
0408 O                         NORE  3   88
0409 O        T  2     LR
0410 O                                   44 'CALCULATED'
0411 O                         DECT      74
0412 O                         INTT  3   71
0413 O                         TOTT  3   88
0414 O                 U8NU7            111 '*** DIFFERENCE ***'
0415 O        T 21     LR
0416 O                                   46 'OUTPUT FILES'
0417 O        T  2     LR
0418 O                                   46 '------------'
0419 O        T  2     LR
0420 O                                   41 'S/PREX1'
0421 O                         INT,1 3   71
0422 O                         DEC,1     74
0423 O                         TOT,1 3   88
0424 O        T  2     LR
0425 O                                   41 'S/PREX2'
0426 O                         INT,2 3   71
0427 O                         DEC,2     74
0428 O                         TOT,2 3   88
0429 O        T  2     LR
0430 O                                   41 'S/PREX3'
0431 O                         INT,3 3   71
0432 O                         DEC,3     74
0433 O                         TOT,3 3   88
0434 O        T  2     LR
0435 O                                   41 'S/PREX4'
0436 O                         INT,4 3   71
0437 O                         DEC,4     74
0438 O                         TOT,4 3   88
0439 O        T  2     LR
0440 O                                   41 'S/PREX5'
0441 O                         INT,5 3   71
0442 O                         DEC,5     74
0443 O                         TOT,5 3   88
0439 O        T  2     LR
0440 O                                   41 'S/PREX6'
0441 O                         INT,6 3   71
0442 O                         DEC,6     74
0443 O                         TOT,6 3   88
     O/COPY WNCPYSRC,DL0307O002
0444 O*
0445 O*
0446 O*    DATABASE ERROR
0447 O*
0448 O********T 22     U7 U8 LR                                           S01117
0449 O*************************          47 '*****     REFERENCE'         S01117
0450 O*************************DBPGM     57                               S01117
0451 O*************************          77 '- DATABASE ERROR AT'         S01117
0452 O*************************DBASE     78                               S01117
0453 O********T  2     U7 U8 LR                                           S01117
0454 O********                           47 '*****     FILE NAME'         S01117
0455 O*************************DBFILE    54                               S01117
0456 O***********************************61 'KEY'                         S01117
0456 O********                           64 'KEY'                         S01117
0457 O*************************DBKEY     92                               S01117
0458 O*                                                                   S01117
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    76                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
0459 O********T 2      LR                                                 LN0298
0460 O********                           73 '*** END OF REPORT ***'       LN0298
0461 O*
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** TABMTI/TABN - MESSAGE TYPE/INDEX
091102113124015026
