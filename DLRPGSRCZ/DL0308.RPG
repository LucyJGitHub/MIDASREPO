0001 H        1
0002 F********************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Complete Pay/Receive Telexes')
0002 F********************************************************************
     F*                                                                  *
     F*  Midas - Dealing Module
0004 F*                                                                  *
0005 F*     DL0308  -  PAY/RECEIVE TELEXES - COMPLETE INSTRUCTIONS       *
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CDL025             Date 27Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU003             Date 27Jan98               *
      *                 CDL002             Date 16Sep97               *
     F*                 S01429             Date 13Jul93                  *
     F*                    E47225             DATE:  1FEB93              *
     F*                    S01374             DATE:  23MAR92             *
     F*                    BHF590             DATE: 17SEP90              *BHF494
     F*                    BHF406             DATE:  26SEP90             *BHF406
     F*                    BHF681             DATE:  24SEP90             *BHF406
     F*                    BHF406             DATE:  29AUG90             *BHF406
     F*                    BHF494             DATE:  27AUG90             *BHF494
     F*                    BHF471             DATE:  27AUG90             *BHF471
     F*                    S01273             DATE:  25JUL90             *
     F*                    BHF073             DATE:  15JUL90             *
     F*                    E299               DATE:  04APR90             *
     F*                    E264               DATE:  16MAR90             *
     F*                    E114               DATE:  27NOV89             *
     F*                    S01194             DATE:  10/03/89            *S01194
     F*                    S01117                                        *S01117
     F*                    S01122                                        *
     F*                                                                  *
0011 F*----------------------------------------------------------------  *
      *                                                               *  *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CDL025 - FX Netting Payment Generation (Recompile)           *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  CEU003 - EMU Dealing Settlement Ccy conversion - Recompile      *
     F*           only.                                                  *
     F*       CDL002 - FX NETTING                                        *
     F*       S01429 - CHIPS ABA NUMBER MODIFICATION FROM 3A TO 4A     ***
     F*                FOR CHIPS II                                    ***
     F*       E47225 - CONDITION CALL TO AORETLR0 ON RETAIL BEING PRESENT*
     F*       S01374 - ENSURE FULL NAME AND ADDRESS ON TELEX REPORT      *
     F*                                                                  *
     F*       BHF590 - FOR A/C OF FIELD ALWAYS PRINTED AS NOT ENTERED
     F*               B'COS *IN67 NEVER RESET
     F*       BHF406 - FURTHER FIX FOR THIS ERROR. DSFDY USED INSTEAD
     F*                OF DSSDY.
     F*       BHF681 - BY ORDER OF OVERWRITTEN WITH DEAL NUMBER          *
     F*       BHF406 - CHIPS ABA NUMBER IS NOT WRITTEN OUT               *
     F*       BHF494 - BY ORDER OF OVERWRITTEN WITH DEAL NUMBER          *
     F*       BHF471 - BY ORDER OF NAME AND ADDRESS IS INCORRECT         *
     F*       S01273 - PRINT FULL CUSTOMER NAME AND ADDRESS
     F*       BHF073 - *IN67 NOT BEING SET OFF                           *
     F*       E299   - 'AU' REPORT SHOULD NOT WRITE 'END OF REPORT'      *
     F*       E264  - SHOULD RECEIVE SEQ. NO. PARM AND PASS TO ZSFILE    *
0011 F* E114/S01117 - REMOVE INPUT PARMS REPORT ENTITY NOT SELECTABLE    *
     F*       S01194 - STANDING DATA CHANGES - TO USE ACCESS PROGRAMS    *S01194
     F*       S01117 - AMENDMENTS FOR MULTIBRANCHING R10                 *S01117
0011 F*                                                                  *
0010 F********************************************************************
0011 F/SPACE 3
0012 FPRSX1   IP  E           K        DISK
0013 F*TABLE***IF**F******96 12AI     2 DISK                              S01194
0014 F*CLINT***IF**F*****256  7AI     2 DISK                              S01194
     F**TLXHH O   F     303            DISK                      A    U4
     F**TLXDT O   F     303            DISK                      A    U4
     FPRTLXHH O   F     305            DISK                      A    U4
     FPRTLXDT O   F     305            DISK                      A    U4
0015 F*L0308P1O***F*****132************PRINTER                   S01124   S01117
0015 FDL0308P1O   F     132     OF     PRINTER      KINFDS SPOOL1     UC  S01117
0015 FDL0308AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
     F/COPY WNCPYSRC,DL0308F001
0016 F/SPACE 3
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            LF/PRSX1 - DETAIL
0019 F* 02                    - TRAILER
0020 F* 03            CURRENCIES RECORD
0021 F* 04            CUSTOMER DETAIL RECORD
0022 F* 05            CLOSED RETAIL A/C NUMBER
     F*      N14     P1 NOT OPENED/WRITTEN TO SO 'NO DETAILS TO REPORT'   S01117
     F* 15            OUTPUT HEADER TO TELEX FILE
0023 F*    20         AMOUNT NEGATIVE
0024 F*    21         SPECIAL INSTR. BLANK.
     F*    25         OUTPUT TOTAL NO. OF TELEXES ON REPORT
     F*       30      OUTPUT TO TELEX FILE
     F*       31      WORK INDICATOR USED FOR BENEFICIARY BANK DETAILS
     F*       32      BENEFICIARY BANK DETAILS EXIST IN SPI FIELD
0025 F*       40      1ST CYCLE
0026 F*       41      1ST DETAIL
0027 F*       45      DEPOSITS
0028 F*       46      FOREIGN EXCHANGE
0029 F*       47      FED. FUNDS
0030 F*       48      CLEARING HOUSE FUNDS
0031 F*       49      BENEFICIARY NOT A CUSTOMER
0032 F*       50      CREDIT
0033 F*       51      PAY
0034 F*       52      RECEIVE
0035 F********53******BY PRODUCT                                          S01194
0036 F*       54      CHIPS - SETTLEMENT TYPE '07'
0037 F*       55      SWIFT - SETTLEMENT TYPE '08'
0038 F*       57      PRINT TELEX TOTAL ON NEXT HEADER
0039 F*       60      DEC. PLACES 0
0040 F*       61                  1
0041 F*       62                  2
0042 F*       63                  3
0043 F*       64      BENEFICIARY-NAME AND TOWN BLANK
0044 F*       66      WORK IND.
0045 F*       67      CHAIN FAILURE
0046 F*       68      DETAIL RECORD READ
     F*       70      OUTPUT TO TELEX FILE
     F*       75      CHECK FOR DEALING/SWIFT INTERFACE
     F********77      MULTIBRANCHING OUTPUT                               E114
0047 F*       80      I/P CYCLE RUN
     F*          U4   TELEX MODULE INTERFACE ACTIVE
     F*          U5    NETTING MODE                                       CDL002
     E                    CPY@    1   1 80
0048 E                    MESS    1   4 29
0049 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0050 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0051 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0051 E                    DBK        29  1               D/B ERR KEY ARR. S01194
     E/COPY WNCPYSRC,DL0308E001
0052 I* LF/PRSX1 DETAIL RECORD
0053 IPREXPHF     01
0054 I                                              PYRC  L7
0055 I                                              SETP  L6
0056 I                                              PROD  L5
0057 I                                              CCY   L4
0058 I                                              OSAC  L3
0059 I                                              FFIN  L2
0060 I                                              VDAT  L1
0062 I              CNUM                            CNUMPH
0064 I                                              EAMT          20
0068 I                                              SPI             21
0075 I*******                                       BRCD  L8              S01117
0075 I                                              OSBR  L8              S01117
0078 I*
0080 IPREXZZF     02
0079 I* TRAILER
0084 I*
0088 I******    TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.          S01194
0089 I******                                                              S01194
0090 I*****TABLE   NS       2 C0   3 C1  12 C1                            S01194
0091 I*****       AND      13 C0                                          S01194
0092 I*****                                   1   1 RECI                  S01194
0093 I*****                                   2   30RECT                  S01194
0094 I*****                                  12  130RCDE                  S01194
0095 I*****                                  14  66 TITL                  S01194
0096 I*****                                  67  67 DATF                  S01194
0097 I*****                                  68  700DFBR                  S01194
     I*****                                  71  71 TLXM                  S01194
     I*****                                  73  73 SWIM                  S01194
0098 I*****                                  74  74 MODI1                 S01194
0099 I*****                                  75  75 MODI2                 S01194
0100 I*****                                  76  76 MODI3                 S01194
0101 I*****                               P  77  790RUND                  S01194
0102 I*****                                  80  86 RUNA                  S01194
0103 I*****                                  87  870SFLG                  S01194
0104 I*****                               P  90  920LCD                   S01194
0105 I*****                                  93  93 CHTP                  S01194
0106 I*****                               P  94  960TNLU                  S01194
0107 I*****                                                               S01194
0108 I******    TABLE FILE - INSTALLATION CONTROL DATA RECORD 3.          S01194
0109 I*****                                                               S01194
0110 I*****TABLE   NS       1 CD   2 C0   3 C1                            S01194
0111 I*****       AND      12 C2  13 C0                                   S01194
0112 I*****                                   1   1 RECI                  S01194
0113 I*****                                   2   30RECT                  S01194
0114 I*****                                  12  130RCDE                  S01194
0115 I*****                                  14  170COMS                  S01194
0116 I*****                                  18  210CADC                  S01194
0117 I*****                               P  22  240MDIC                  S01194
0118 I*****                               P  25  270MCIC                  S01194
0119 I*****                               P  28  300MDIA                  S01194
0120 I*****                               P  31  330MCIA                  S01194
0121 I*****                                  34  370SRPL                  S01194
0122 I*****                                  38  410SPAC                  S01194
0123 I*****                                  42  450SWAC                  S01194
0124 I*****                                  46  490FTAC                  S01194
0125 I*****                                  50  530TAC4                  S01194
0126 I*****                                  54  570TAC5                  S01194
0127 I*****                               P  63  650NOBA                  S01194
0128 I*****                               P  66  680TSIZ                  S01194
0129 I*****                                  69  69 RACN                  S01194
0130 I*****                                  70  700GLSI                  S01194
0131 I*****                                  71  710RTSI                  S01194
0132 I*****                                  72  720DLSI                  S01194
0133 I*****                                  73  730NOSI                  S01194
0134 I*****                                  74  740CTSI                  S01194
0135 I*****                               P  75  770ELAC                  S01194
0136 I*****                               P  78  800ECAC                  S01194
0137 I*****                               P  90  920LCD                   S01194
0138 I*****                                  93  93 CHTP                  S01194
0139 I*****                               P  94  960TNLU                  S01194
0140 I******                                                              S01194
0141 I******    TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.          S01194
0142 I******                                                              S01194
0143 I*****TABLE   NS       1 CD   2 C0   3 C1                            S01194
0144 I*****       AND      12 C4  13 C0                                   S01194
0145 I*****                                   1   1 RECI                  S01194
0146 I*****                                   2   30RECT                  S01194
0147 I*****                                  12  130RCDE                  S01194
0148 I*****                                  18  210CSAC                  S01194
0149 I*****                                  22  22 TLII                  S01194
0150 I*****                                  23  23 MCRI                  S01194
0151 I*****                               P  24  250MCEP                  S01194
0152 I*****                                  26  270MCLP                  S01194
0153 I*****                                  28  28 FRDI                  S01194
0154 I*****                                  29  29 BRCF                  S01194
0155 I*****                                  30  350PSCN                  S01194
0156 I*****                                  36  380DLBR                  S01194
0157 I*****                                  39  420FRPA                  S01194
0158 I*****                                  43  460FRPC                  S01194
0159 I*****                                  47  49 USCY                  S01194
0160 I*****                                  50  52 STCY                  S01194
0161 I*****                               P  53  553MBGE                  S01194
0162 I*****                                  56  56 PRID                  S01194
0163 I*****                               P  90  920LCD                   S01194
0164 I*****                                  93  93 CHTP                  S01194
0165 I*****                               P  94  960TNLU                  S01194
0166 I*****                                                               S01194
0167 I******    TABLE FILE - CURRENCIES RECORD 1.                         S01194
0168 I******                                                              S01194
0169 I*****TABLE   NS       1 CD   2 C2   3 C0                            S01194
0170 I*****       AND      13 C1                                          S01194
0171 I*****                                   1   1 RECI                  S01194
0172 I*****                                   2   30RECT                  S01194
0173 I*****                                  10  12 CCY                   S01194
0174 I*****                                  13  130SREC                  S01194
0175 I*****                                  14  27 CCNM                  S01194
0176 I*****                               P  28  348SPOT                  S01194
0177 I*****                                  35  37 CCYS                  S01194
0178 I*****                                  38  380CDP                   S01194
0179 I*****                                  39  390TNOT                  S01194
0180 I*****                                  40  40 DCCY                  S01194
0181 I*****                                  41  44 SRC1                  S01194
0182 I*****                                  45  48 SRC2                  S01194
0183 I*****                                  49  520TACC                  S01194
0184 I*****                                  53  560TEQV                  S01194
0185 I*****                                  57  600SWQV                  S01194
0186 I*****                                  61  640TAC4                  S01194
0187 I*****                                  65  680TAC5                  S01194
0188 I*****                                  69  69 HIND                  S01194
0189 I*****                               P  70  768PART                  S01194
0190 I*****                                  77  780SSNO                  S01194
0191 I*****                               P  79  858ERLC                  S01194
0192 I*****                               P  90  920LCD                   S01194
0193 I*****                                  93  93 CHTP                  S01194
0194 I*****                               P  94  960TNLU                  S01194
0195 I******                                                              S01194
0196 I*******    TABLE FILE - NOSTROS RECORD.                             S01194
0197 I*******                                                             S01194
0198 I*****TABLE   NS       1 CD   2 C7   3 C0                            S01194
0199 I*****                                   1   1 RECI                  S01194
0200 I*****                                   2   30RECT                  S01194
0201 I*****                                   9  11 CCY                   S01194
0202 I*****                                  12  130NOSN                  S01194
0203 I*****                                  16  29 ONAC                  S01194
0204 I*****                                  30  350CNUM                  S01194
0205 I*****                                  36  370ACSQ                  S01194
0206 I*****                                  38  410ACOD                  S01194
0207 I*****                               P  90  920LCD                   S01194
0208 I*****                                  93  93 CHTP                  S01194
0209 I*****                               P  94  960TNLU                  S01194
0210 I*****                                                               S01194
0211 I******    TABLE FILE - COUNTERPARTY NOSTROS RECORD.                 S01194
0212 I******                                                              S01194
0213 I*****TABLE   NS       1 CD   2 C7   3 C1                            S01194
0214 I*****                                   1   1 RECI                  S01194
0215 I*****                                   2   30RECT                  S01194
0216 I*****                                   6  13 CPSH                  S01194
0217 I*****                                  14  48 CPNM                  S01194
0218 I*****                                  49  68 CPTN                  S01194
0219 I*****                               P  90  920LCD                   S01194
0220 I*****                                  93  93 CHTP                  S01194
0221 I*****                               P  94  960TNLU                  S01194
0222 I*****                                                               S01194
0223 I****** CATCHALL                                                     S01194
0224 I*****        NS  67                                                 S01194
0225 I******                                                              S01194
0226 I******    CLIENT FILE - CUSTOMER STANDING DATA RECORD.              S01194
0227 I******                                                              S01194
0228 I*****CLINT   NS       1 CD   8 CA                                   S01194
0229 I*****                                   1   1 RECI                  S01194
0230 I*****                                   2   70CNUM                  S01194
0231 I*****                                   8   8 RCDT                  S01194
0232 I*****                                   9  28 CRNM                  S01194
0233 I*****                                  29  38 CTWN                  S01194
0234 I*****                                  39  48 CSNM                  S01194
0235 I*****                                  49  56 CASK                  S01194
0236 I*****                                  57  68 TELX                  S01194
0237 I*****                                  69  80 CSID                  S01194
0238 I*****                                  81  82 ACOC                  S01194
0239 I*****                                  83  83 CBSI                  S01194
0240 I*****                                  84  85 CCTZ                  S01194
0241 I*****                                  86  87 CLOC                  S01194
0242 I*****                                  88  930CPAR                  S01194
0243 I*****                                  94  960BRCDCB                S01194
0244 I*****                                  97  980LINS                  S01194
0245 I*****                                  99 1010LIND                  S01194
0246 I*****                               P 102 1040DASU                  S01194
0247 I*****                               P 105 1070CDIC                  S01194
0248 I*****                               P 108 1100DADE                  S01194
0249 I*****                                 111 111 CMIN                  S01194
0250 I*****                                 112 112 CTYP                  S01194
0251 I*****                                 113 124 TELF                  S01194
0252 I*****                                 125 133 CHID                  S01194
0253 I*****                                 134 136 CHAB                  S01194
     I*****                                 245 245 TLXR                  S01194
0254 I*****                               P 250 2520LCD                   S01194
0255 I*****                                 253 253 CHTP                  S01194
0256 I*****                               P 254 2560TNLU                  S01194
0257 I******                                                              S01194
0258 I******                                                              S01194
0259 I******    CLIENT FILE - CUSTOMER NAME AND ADDRESS RECORD.           S01194
0260 I******                                                              S01194
0261 I*****        NS       1 CD   8 CB                                   S01194
0262 I*****                                   1   1 RECI                  S01194
0263 I*****                                   2   70CNUM                  S01194
0264 I*****                                   8   8 RCDT                  S01194
0265 I*****                                   9  43 CNA1                  S01194
0266 I*****                                  44  78 CNA2                  S01194
0267 I*****                                  79 113 CNA3                  S01194
0268 I*****                                 114 148 CNA4                  S01194
0269 I*****                                 240 249 CTWN                  S01194
0270 I*****                               P 250 2520LCD                   S01194
0271 I*****                                 253 253 CHTP                  S01194
0272 I*****                               P 254 2560TNLU                  S01194
0273 I*****                                                               S01194
0274 I****** CATCHALL                                                     S01194
0275 I*****        NS  67                                                 S01194
     I*                                                                   S01194
     I* DATA STRUCTURES FOR USE WITH ACCESS OBJECTS                       S01194
     I*                                                                   S01194
     I@BANK     E DSSDBANKPD                                              S01194
     I*                                                                   S01194
     I@MMOD     E DSSDMMODPD                                              S01194
     I*                                                                   S01194
     I@GELR     E DSSDGELRPD                                              S01194
     I*                                                                   S01194
     I@RETL     E DSSDRETLPD                                              S01194
     I              QQACCD                          QQACCX                                    CGL029
     I*                                                                   S01194
     I@TRAD     E DSSDTRADPD                                              S01194
     I              QQACCD                          QQACCY                                    CGL029
     I*                                                                   S01194
     I@CURR     E DSSDCURRPD                                              S01194
     I*                                                                   S01194
     I@NOST     E DSSDNOSTPD                                              S01194
     I              QQACCD                          QQACCZ                                    CGL029
     I*                                                                   S01194
     I@CNST     E DSSDCNSTPD                                              S01194
     I*                                                                   S01194
     I@CUST     E DSSDCUSTPD                                              S01194
     I*                                                                   S01194
     I@BRCH     E DSSDBRCHPD                                              S01194
     I              QQDFAC                          QQDFAX                                    CGL029
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I/COPY WNCPYSRC,DL0308I001
0276 I* D A T A - S T R U C T U R E S
0277 I            DS
0278 I                                        1  45 RP21
0279 I                                        1  35 OURAGN
0280 I                                       36  45 OURAGT
0281 I*
0282 I            DS
0283 I**********                              1  24 RP22                  S01429
0284 I**********                              1   3 OCHABA                S01429
0285 I**********                              4  12 OCHID                 S01429
0286 I**********                             13  24 OSWADR                S01429
0283 I                                        1  25 RP22                  S01429
0284 I                                        1   4 OCHABA                S01429
0285 I                                        5  13 OCHID                 S01429
0286 I                                       14  25 OSWADR                S01429
0287 I*
0288 I            DS
0289 I                                        1  55 RP31
0290 I                                        1  35 THEIRN
0291 I                                       36  55 THEIRT
0292 I*
0293 I            DS
0294 I**********                              1  24 RP32                  S01429
0295 I**********                              1   3 TCHABA                S01429
0296 I**********                              4  12 TCHID                 S01429
0297 I**********                             13  24 TSWADR                S01429
0294 I                                        1  25 RP32                  S01429
0295 I                                        1   4 TCHABA                S01429
0296 I                                        5  13 TCHID                 S01429
0297 I                                       14  25 TSWADR                S01429
0298 I*
0299 I            DS
0300 I                                        1  55 RP41
0301 I                                        1  35 BENAME
0302 I                                       36  55 BETOWN
0303 I*
0304 I            DS
0305 I**********                              1  24 RP42                  S01429
0306 I**********                              1   3 BCHABA                S01429
0307 I**********                              4  12 BCHID                 S01429
0308 I**********                             13  24 BSWADR                S01429
0305 I                                        1  25 RP42                  S01429
0306 I                                        1   4 BCHABA                S01429
0307 I                                        5  13 BCHID                 S01429
0308 I                                       14  25 BSWADR                S01429
0309 I*
0310 I            DS
0311 I                                        1  65 RP61
0312 I                                        1  35 CPNAME
0313 I                                       36  45 CPRTWN
0314 I                                       46  65 CPRNAM
0315 I*
0316 I            DS
0317 I**********                              1  24 RP62                  S01429
0318 I**********                              1   3 CCHABA                S01429
0319 I**********                              4  12 CCHID                 S01429
0320 I**********                             13  24 CSWADR                S01429
0317 I                                        1  25 RP62                  S01429
0318 I                                        1   4 CCHABA                S01429
0319 I                                        5  13 CCHID                 S01429
0320 I                                       14  25 CSWADR                S01429
0321 I****** TABLES FILE KEY                                              S01194
0322 I*****       DS                                                      S01194
0323 I*****                                   1  12 ZTABKY                S01194
0324 I*****                                   1   2 CODE                  S01194
0325 I*****                                   8  10 CURR                  S01194
0326 I*****                                  11  12 NOSTNO                S01194
0327 I*****                                   9  11 CURX                  S01194
0328 I*****                                  12  12 NOX                   S01194
0329 I****** TABLES FILE KEY FOR COUNTERPARTY/NOSTROS                     S01194
0330 I*****       DS                                                      S01194
0331 I*****                                   1  12 CNOSKY                S01194
0332 I*****                                   5  12 COUNTN                S01194
0333 I****** CLIENT FILE KEY                                              S01194
0334 I*****       DS                                                      S01194
0335 I*****                                   1   7 CLIKEY                S01194
0336 I*****                                   1   6 CNUMK                 S01194
0337 I* CLIENT DETAILS
0338 I            DS
0339 I                                        1  65 NAMTWN
0340 I**********                              1  35 CNA1                  S01194
0341 I**********                             36  45 CTWN                  S01194
0342 I**********                             46  65 CRNM                  S01194
0340 I                                        1  35 @BCATX                S01194
0341 I                                       36  45 @BBVTX                S01194
0342 I                                       46  65 @BBUTX                S01194
0343 I            DS
0344 I**********                              1  24 SWCH                  S01429
0345 I**********                              1   3 CHAB                  S01194
0346 I**********                              4  12 CHID                  S01194
0347 I**********                             13  24 CSID                  S01194
0345 I**********                              1   3 @BB2TX                S01429
0346 I**********                              4  12 @BB1TX                S01429
0347 I**********                             13  24 @BBYTX                S01429
0344 I                                        1  25 SWCH                  S01429
0345 I                                        1   4 @BB2TX                S01429
0346 I                                        5  13 @BB1TX                S01429
0347 I                                       14  25 @BBYTX                S01429
0348 I* COUNTERPARTY/NOSTRO DETAILS
0349 I            DS
0350 I                                        1  55 COUNOS
0351 I**********                              1  35 CPNM                  S01194
0352 I**********                             36  55 CPTN                  S01194
0351 I                                        1  35 @WAWTX                S01194
0352 I                                       36  55 @WAXTX                S01194
0353 I* OUR SETTLEMENT A/C * AGENT *
0354 I            DS
0355 I**********                              1  12 OSAC                                      CGL029
     I                                        1  18 OSAC                                      CGL029
0356 I                                        1   2 ONOS
0357 I                                        1   6 OCNUM
0358 I**********                              7  10 OACOD                                     CGL029
0359 I**********                             11  12 OACSQ                                     CGL029
     I                                        7  16 OACOD                                     CGL029
     I                                       17  18 OACSQ                                     CGL029
0360 I                                        1  10 RETNO
0361 I* THEIR AGENT
0362 I            DS
0363 I                                        1  10 TSEN
0365 I                                        1   8 TCNOS
0366 I                                        1   6 ALPHA1
0367 I* BLANK FIELDS
0368 I            DS
0369 I                                        1  65 BLNK65
0370 I**********                              1  24 BLNK24                S01429
0370 I                                        1  25 BLNK25                S01429
0371 I                                        1  45 BLNK45
0372 I                                        1  55 BLNK55
0373 I                                        1   3 BLNK3
0374 I                                        1  10 BLNK10
0375 I                                        1  20 BLNK20
0376 I* FOR A/C OF
0377 I            DS
0378 I                                        1  10 FACO
0379 I                                        1   6 FCNUM
0380 I                                        1   8 CONOST
     I**   FIELDS USED FOR BENEFICIARY BANK DETAILS
     I            DS
     I                                        1  35 SPI
     I                                        1   3 SPEC3
     I                                        1   5 SPEC5
     I                                        6   8 SPEC8
     I                                        1   8 SPEC9
     I                                        6  12 SPEC12
     I                                        9  14 SPEC14
     I                                        9  17 SPEC17
     I                                       10  18 SPEC18
     I                                        5  34 SPEC34
     I                                        6  35 SPEC35
     I*
     I*                                                                   S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL1      DS                                                      S01117
     I                                       83  92 SFILE1                S01117
     I                                    B 123 1240SFNUM1                S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
      *                                                                   E47225
     ILDA         DS                            256                       E47225
     I                                      134 143 DBFILE                E47225
     I                                      142 170 DBKEY                 E47225
     I                                      171 180 DBPGM                 E47225
     I                                      181 183 DBASE                 E47225
      **  Local data area                                                 E47225
      *                                                                   E47225
     I**                                                                  S01117
     C**                                                                  S01117
     C********   *ENTRY    PLIST                                          E114
     C********             PARM           SEQ     5                       S01117
     C********             PARM           BRNCH   3        BRANCH OR ALL  S01117
     C**
     C           *ENTRY    PLIST                                          E264
     C                     PARM           SEQ     5                       E264
     C           *NAMVAR   DEFN           LDA                             E47225
     C                     MOVEL*BLANKS   DBPGM                           E47225
     C                     MOVEL'DL0308'  DBPGM                           E47225
     C**
0382 C* 1 S T   C Y C L E   P R O C E S S I N G
     C                     SETOF                     15
0383 C   41                GOTO MAIN
0384 C   40                GOTO START
     C/COPY WNCPYSRC,DL0308C018
0385 C                     SETON                     40
0386 C   U7                SETON                     80
0387 C                     SETOF                     U7
0388 C******               EXSR ZSYSTM                                    S01194
     C                     MOVEACPY@      BIS@   80
     C*                                                                   S01194
     C* USE ACCESS PROGRAM TO READ THE MODULE DETAILS FILE                S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @MMOD     PARM @MMOD     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDMMODPD'DBFILE 10        *************  S01194
     C                     MOVEL'001'     DBASE   3        * DBERR 001 *  S01194
     C                     MOVEL@OPTN     DBKEY            *************  S01194
     C                     OUT  LDA                                       E47225
     C                     MOVE '1'       *IN67                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C* USE ACCESS PROGRAM TO READ THE BANK DETAILS FILE                  S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*FIRST  '@OPTN                           S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDBANKPD'DBFILE           *************  S01194
     C                     MOVEL'002'     DBASE            * DBERR 002 *  S01194
     C                     MOVEL@OPTN     DBKEY            *************  S01194
     C                     OUT  LDA                                       E47225
     C                     MOVE '1'       *IN67                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     ELSE                                           S01194
     C*                                                                   S01194
0864 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C*                                                                   S01194
0865 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C                     END                                            S01194
     C*                                                                   S01194
0389 C*****                MOVE '20'      ZTABKY                          S01194
0390 C*****      ZTABKY    CHAINTABLE                67                   S01194
0391 C***67                SETON                     LRU7                 S01194
     C*                                                                   S01194
     C* USE ACCESS PROGRAM TO READ THE GENERAL LEDGER FILE                S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST  '@OPTN                           S01194
     C********** @GELR     PARM @GELR     DSFDY                           S01194              CGL029
     C           @GELR     PARM @GELR     DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDGELRPD'DBFILE           *************  S01194
     C                     MOVEL'003'     DBASE            * DBERR 003 *  S01194
     C                     MOVEL@OPTN     DBKEY            *************  S01194
     C                     OUT  LDA                                       E47225
     C                     MOVE '1'       *IN67                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C* USE ACCESS PROGRAM TO READ THE TRADING DATA FILE                  S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST  '@OPTN                           S01194
     C           @TRAD     PARM @TRAD     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDTRADPD'DBFILE           *************  S01194
     C                     MOVEL'006'     DBASE            * DBERR 003 *  S01194
     C                     MOVEL@OPTN     DBKEY            *************  S01194
     C                     OUT  LDA                                       E47225
     C                     MOVE '1'       *IN67                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C* USE THE ACCESS PROGRAM TO READ THE RETAIL DETAILS FILE            S01194
     C           BGRTBN    IFEQ 'Y'                                       E47225
     C           BGIOAC    OREQ 'Y'                                       E47225
     C                     CALL 'AORETLR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*FIRST  '@OPTN                           S01194
     C           @RETL     PARM @RETL     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDRETLPD'DBFILE           *************  S01194
     C                     MOVEL'004'     DBASE            * DBERR 004 *  S01194
     C                     MOVEL@OPTN     DBKEY            *************  S01194
     C                     OUT  LDA                                       E47225
     C                     MOVE '1'       *IN67                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C                     END                                            E47225
     C*                                                                   S01194
0392 C*****                MOVE '40'      ZTABKY                          S01194
0393 C*****      ZTABKY    CHAINTABLE                67                   S01194
0394 C***67                SETON                     LRU7                 S01194
     C*****                TESTB'0'       TLXM           70               S01194
     C***70                SETON                     1530                 S01194
     C           BGMTDL    IFEQ 'Y'                                       S01194
     C                     SETON                     153070               S01194
     C                     END                                            S01194
0395 C*****      PRID      COMP 'Y'                      53               S01194
0396 C                     Z-ADD0         TCOUNT  50
     C                     Z-ADD0         TOTLX   30
0397 C*****                MOVE 'A'       CLIKEY                          S01194
0398 C*****                MOVEL'71'      CNOSKY                          S01194
0399 C* S T A R T
0400 C           START     TAG                             ** START TAG **
0401 C  N01                GOTO ENDDET
0402 C* DETAIL PROCESSING FOR 1ST DETAIL RECORD
0403 C                     SETON                     41
0404 C                     EXSR HEADER
0405 C                     SETON                     68
0406 C                     GOTO ENTRY1
0407 C/SPACE 3
0408 C* M A I N   P R O C E S S I N G
0409 C           MAIN      TAG
0410 C************         SETOF                     57
     C                     SETOF                     3132
     C/COPY WNCPYSRC,DL0308C001
0411 C  N01                GOTO ENDDET
0412 C*
0413 C*    PRINT TELEX TOTAL.
0414 C***L1********        SETON                     57
     C***L1********        Z-ADDTEST      OTTEST 150
0416 C***L1********        Z-ADD0         TEST
0417 C***L1********        Z-ADD0         TCOUNT
0418 C           TCOUNT    COMP 5                    66  66
0419 C   66                SETON                     L1
0420 C   66                Z-ADD0         TCOUNT
0421 C   L1                EXSR HEADER
0422 C           ENTRY1    TAG                             ** ENTRY1 TAG**
0423 C           TCOUNT    ADD  1         TCOUNT
0424 C   50                EXSR CREDIT
0425 C   51                EXSR PAY
0426 C   52                EXSR RECEIV
     C*
     C**   CHECK BENEFICIARY BANK DETAILS
     C*
     C**   IGNORE IF SPECIAL INSTRUCTIONS IS BLANK
     C   21                GOTO BENEND
     C*
     C           SPEC5     COMP '/BEN/'              313132
     C   31                GOTO BENEND
     C*
     C**   CHECK FOR CHIPS NUMBER
     C           SPEC8     COMP '/CH'                    31
     C   31                MOVE SPEC14    WORK6   6
     C   31                MOVE *BLANKS   SPI
     C   31                MOVE 'CHIPS'   SPEC5
     C   31                MOVE WORK6     SPEC12
     C   31                GOTO BENEND
     C*
     C**   CHECK FOR FED. WIRE NUMBER
     C           SPEC8     COMP '/FW'                    31
     C   31                MOVE SPEC17    WORK9   9
     C   31                MOVE *BLANKS   SPI
     C   31                MOVE 'FED.WIRE'SPEC9
     C   31                MOVE WORK9     SPEC18
     C   31                GOTO BENEND
     C*
     C**   MUST NOW BE 'ACCOUNT'
     C                     MOVE SPEC35    WORK30 30
     C                     MOVE *BLANKS   SPI
     C                     MOVE 'A/C'     SPEC3
     C                     MOVE WORK30    SPEC34
     C*
     C           BENEND    TAG                             * BENEND TAG *
     C*
0427 C   60                Z-ADDEAMT      TESTOT 150
0428 C   61      EAMT      DIV  10        TESTOT
0429 C   62      EAMT      DIV  100       TESTOT
0430 C   63      EAMT      DIV  1000      TESTOT
0431 C           TEST      ADD  TESTOT    TEST   150
0432 C   20                Z-SUBEAMT      EAMT
0433 C           EAMT      DIV  1000      ZZAMT
0434 C                     EXSR GLZADD
     C/COPY WNCPYSRC,DL0308C017
0435 C*
0436 C           ENDDET    TAG                             ** ENDDET TAG**
0437 C           RECIN     ADD  1         RECIN   50
     C**   IF CHANGE OF BRANCH                                            S01117
     C           *INL8     IFEQ '1'                                       S01117
     C                     CLOSEDL0308P1                                  S01117
     C***********BRNCH     IFEQ 'ALL'                                     E114
     C***********BRNCH     OREQ OSBR                                      E114
     C*****************    SETON                     77                   E114
     C                     OPEN DL0308P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** IF P1 FILE OPENED THEN SET ON FLAG                               S01117
     C                     MOVE '1'       *IN14                           S01117
     C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF                                S01117
     C                     Z-ADDSFNUM1    ZSNUM   60                      S01117
     C                     CALL 'ZSFILE'                                  S01117
     C*********************PARM *BLANKS   SEQ     5                S01117 E264
     C                     PARM           SEQ     5                       E264
     C                     PARM OSBR      @PARM   3                       S01117
     C                     PARM           SFILE1                          S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*****                MOVE *BLANKS   ZTABKY                   S01117 S01194
     C*****                MOVEL'10'      ZTABKY 12                S01117 S01194
     C*****                MOVE OSBR      ZTABKY                   S01117 S01194
     C*****      ZTABKY    CHAINTABLE                67            S01117 S01194
     C* USE ACCESS PROGRAM TO READ THE BRANCH DETAILS FILE                S01194
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '@RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM OSBR      @DSNB   3                       S01117
     C********** @BRCH     PARM @BRCH     DSFDY                           S01194              CGL029
     C           @BRCH     PARM @BRCH     DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDBRCHPD'DBFILE           *************  S01194
     C                     MOVEL'005'     DBASE            * DBERR 005 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        *************  S01194
     C                     MOVELOSBR      DBKEY  29                       S01194
     C                     OUT  LDA                                       E47225
     C                     MOVE '1'       *IN67                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*****  N67      RECI      COMP 'D'                  6767     S01117 S01194
     C*****   67                SETON                     U7U8LR   S01117 S01194
     C   U8                GOTO END                                       S01117
     C********                                                            S01117
     C********             ELSE                                           E114
     C********             SETOF                     77                   E114
     C                     END                                            S01117
     C*********************END                                            E114
     C**                                                                  S01117
0438 C   02                SETON                     LR
     C           END       TAG                             * END TAG *    S01117
     C/COPY WNCPYSRC,DL0308C019
0439 C/SPACE 3
0440 C* IF NO PRODUCT BREAKDOWN AND LEVEL BREAK CAUSED BY 'PROD'
0441 C*L5NL6N53*****        SETOF                     L1                  S01194
0441 CL5NL6                SETOF                     L1                   S01194
0442 C/SPACE 3
     C/COPY WNCPYSRC,DL0308C020
     C*                                                                   S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUMU    ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     C*LR******************PARM *BLANKS   SEQ                      S01117 E264
     CLR                   PARM           SEQ                             E264
     CLR                   PARM *BLANKS   @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR                           S01117
      *                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CL1                   Z-ADDTEST      OTTEST 150
     CL1                   Z-ADD0         TEST
     CL1                   Z-ADD0         TCOUNT
0443 C*LR**********         Z-ADDTEST      OTTEST
     CLR         TOTLX     COMP 0                    25
0444 CLR         NORE      COMP RECIN                U8U8
0445 CLRNU8      HRWN      COMP ZZTOTI               U8U8
0446 CLRNU8      HRDC      COMP ZZTOTD               U8U8
0447 C/EJECT
0448 C* S U B R O U T I N E S
0449 C*
0450 C********************************************************************
0451 C**
0452 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0453 C**
0454 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0455 C**
0456 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0457 C**
0458 C**   CLEAR DATE FIELDS.
0459 C                     Z-ADD0         ZDATE   60
0460 C                     MOVEL'       ' ZADATE  7
0461 C**
0462 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0463 C                     Z-ADDZDAYNO    ZDAYNO  50
0464 C**
0465 C**   DETERMINE YEAR NUMBER.
0466 C**
0467 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0468 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0469 C   99                GOTO ZDEND2
0470 C**
0471 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0472 C           ZDAYN1    DIV  1461      ZLYR    20
0473 C                     MVR            ZDAYN1           SAVE REMAINING
0474 C**                                                   DAYS
0475 C**   CALCULATE NUMBER OF REMAINING YEARS.
0476 C                     Z-ADD1         ZWRK2   20
0477 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0478 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0479 C  N90      ZWRK2     ADD  1         ZWRK2
0480 C  N90                GOTO ZDTAG1
0481 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0482 C**
0483 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0484 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0485 C**
0486 C**   CALCULATE ACTUAL YEAR NUMBER.
0487 C           ZLYR      MULT 4         ZWRK3   30
0488 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0489 C                     Z-ADDZWRK3     ZYEAR   20
0490 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0491 C**
0492 C**   DETERMINE MONTH NUMBER.
0493 C**
0494 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0495 C                     SETOF                     9293
0496 C   91      ZDAYN1    COMP 59                     9293
0497 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0498 C**
0499 C**   CALCULATE MONTH NUMBER.
0500 C                     Z-ADD2         ZWRK2
0501 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0502 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0503 C  N94      ZWRK2     ADD  1         ZWRK2
0504 C  N94                GOTO ZDTAG2
0505 C           ZWRK2     SUB  1         ZWRK2
0506 C**
0507 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0508 C**
0509 C**   DETERMINE DAY OF MONTH.
0510 C**
0511 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0512 C           ZDAYN1    ADD  1         ZDAYN1
0513 C**
0514 C**   CALCULATE DAY OF MONTH.
0515 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0516 C**
0517 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0518 C   93      ZDAY      ADD  1         ZDAY
0519 C**
0520 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0521 C  N98                MOVELZDAY      ZWRK4   40
0522 C   98                MOVE ZDAY      ZWRK4
0523 C  N98                MOVE ZMTH      ZWRK4
0524 C   98                MOVELZMTH      ZWRK4
0525 C                     MOVELZWRK4     ZDATE
0526 C                     MOVE ZYEAR     ZDATE
0527 C**
0528 C**   FORMAT ALPHA DATE, DDMMMYY.
0529 C           ZDAY      COMP 10                     95
0530 C                     MOVELZDAY      ZWRK5   5
0531 C   95                MOVEL' '       ZWRK5
0532 C                     MOVE ZMNM,ZMTH ZWRK5
0533 C                     MOVELZWRK5     ZADATE
0534 C                     MOVE ZYEAR     ZADATE
0535 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0536 C**
0537 C**
0538 C**
0539 C********************************************************************
0540 C/SPACE 3
0541 C********************************************************************
0542 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0543 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0544 C*
0545 CSR         GLZADD    BEGSR                           *** GLZADD ****
0546 C*
0547 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0548 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0549 C*
0550 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0551 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0552 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0553 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0554 C*
0555 CSR                   EXSR GLZSUM
0556 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0557 C*
0558 C********************************************************************
0559 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0560 C*                        GLZADD, GLZSUB, GLZCMP.
0561 C*          PARAMETERS PASSED -
0562 C*                     I/P ZZAMTI ZZAMTD
0563 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0564 C*
0565 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0566 C*
0567 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0568 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0569 CSR                   SETOF                     919293
0570 CSR                   SETOF                     949599
0571 C*
0572 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0573 CSR         ZZAMTI    COMP 0                      9293
0574 CSR 93      ZZAMTD    COMP 0                      9293
0575 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0576 C*
0577 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0578 CSR         ZZTOTI    COMP 0                      9193
0579 CSR 93      ZZTOTD    COMP 0                      9193
0580 C*
0581 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0582 CSR 93                Z-ADDZZAMTI    ZZTOTI
0583 CSR 93                Z-ADDZZAMTD    ZZTOTD
0584 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0585 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0586 CSR 91N92
0587 CORN91 92             GOTO ZZOFPS
0588 C*
0589 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0590 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0591 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0592 C*
0593 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0594 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0595 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0596 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0597 C*
0598 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0599 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0600 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0601 CSRN99                Z-ADDZZWK2     ZZTOTD
0602 CSRN99                Z-ADDZZWK3     ZZTOTI
0603 C*
0604 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0605 CSR 99                Z-ADD0         ZZAMT  153
0606 CSR                   GOTO ZZSEND
0607 C*
0608 C* THE 'SIGNS' ARE DIFFERENT
0609 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0610 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0611 C*
0612 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0613 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0614 C*
0615 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0616 C*
0617 CSR 91                Z-SUBZZTOTI    ZZTOTI
0618 CSR 91                Z-SUBZZTOTD    ZZTOTD
0619 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0620 C*
0621 CSR         ZZTOTI    COMP ZZAMTI               93  95
0622 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0623 C*
0624 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0625 CSR 95                Z-ADD0         ZZTOTI
0626 CSR 95                Z-ADD0         ZZTOTD
0627 CSR 95                GOTO ZZSEND
0628 C*
0629 C* IF ZZTOT GT. ZZAMT.
0630 CSR 93      ZZAMTD    COMP ZZTOTD               94
0631 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0632 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0633 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0634 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0635 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0636 C*
0637 C*
0638 C* IF ZZAMT GT. ZZTOT.
0639 CSRN93      ZZTOTD    COMP ZZAMTD               94
0640 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0641 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0642 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0643 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0644 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0645 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0646 C*
0647 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0648 CSR                   SETOF                     94
0649 CSR 93 91
0650 CORN93 92             SETON                     94
0651 CSR 94                Z-SUBZZTOTI    ZZTOTI
0652 CSR 94                Z-SUBZZTOTD    ZZTOTD
0653 C**
0654 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0655 CSR 92                Z-SUBZZAMTI    ZZAMTI
0656 CSR 92                Z-SUBZZAMTD    ZZAMTD
0657 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0658 C**
0659 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0660 CSR                   SETOF                     96
0661 CSR         ZZTOTD    COMP 0                        91
0662 CSR 91      ZZTOTI    COMP 0                      96
0663 CSR 96                MOVE '.000-'   ZZNEGD  5
0664 CSR                   ENDSR                             ** ENDSR **
0665 C********************************************************************
0666 C/EJECT
0667 C********************************************************************
0668 C*
0669 C           HEADER    BEGSR                           ***  HEADER ***
     C***********          Z-ADD0         NOSTRO                                              CSD027
     C                     MOVE *BLANKS   NOSTRO                                              CSD027
0670 C*********************SETON                     56                   E114
     C                     SETOF                     70
0671 C           PYRC      COMP 'C'                      50
0672 C           PYRC      COMP 'P'                      51
0673 C           PYRC      COMP 'R'                      52
0674 C                     MOVE BLNK45    RP21
0675 C**********           MOVE BLNK24    RP22                            S01429
     C                     MOVE BLNK25    RP22                            S01429
0676 C           PROD      COMP 1                      4645
0677 C* O U R   A G E N T - 'CASE' ON SETTLEMENT TYPE
0678 C           SETP      COMP 00                       66**IF SETTLEMENT
0679 C  N66                GOTO CELSE1                      * TYPE EQ '00'
0680 C* N U L L                                             *
0681 C                     GOTO CEND1                       *
0682 C           CELSE1    TAG                              *ELSEIF EQ 01,
0683 C                     SETOF                     5455
     C           SETP      COMP 01                   666670
0685 C   66      SETP      COMP 02                   6666   *
0686 C   66      SETP      COMP 07                   666654 *
0687 C   66      SETP      COMP 08                   666655 *
0688 C   66      SETP      COMP 12                   6666   *
0689 C   66                GOTO CELSE2                      *
0690 C           OSAC      COMP ' '                      66 *
0691 C*****                MOVE CCY       CURR              *             S01194
0692 C*****                MOVE ONOS      NOSTNO                          S01194
0693 C***66                MOVE '00'      NOSTNO            *             S01194
     C                     MOVE NOSTNO    NSNO    20                      S01135
0694 C*****                MOVE '70'      CODE              *             S01194
0695 C*****      ZTABKY    CHAINTABLE                67     *             S01194
     C*                                                                   S01194
     C           *IN66     IFEQ '0'                                       S01194
     C                     MOVE ONOS      NOSTNO  2                       S01194
     C                     ELSE                                           S01194
     C                     MOVE '00'      NOSTNO                          S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C* USE ACCESS PROGRAM TO READ THE NOSTRO DETAILS FILE                S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM *BLANK    @KEYA   6                       S01194
     C                     PARM CCY       @KEYB   3                       S01194
     C**********           PARM *BLANK    @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANK    @KEYC  10                                           CGL029
     C                     PARM *BLANK    @KEYD   2                       S01194
     C                     PARM NOSTNO    @KEYE   2                       S01194
     C                     PARM *BLANKS   @KEYF   3                       S01194
     C                     PARM *BLANKS   @KEYG  10                       S01194
     C                     PARM *BLANKS   @KEYH   1                       S01194
     C           @NOST     PARM @NOST     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     CABEQ*BLANK    NOER1                           S01194
     C*                                                                   S01194
0696 C**N67***             GOTO NOER1                       *             S01194
     C                     MOVE '1'       *IN67                           S01194
0697 C                     MOVELMESS,1    OURAGN            *
     C*     IF NOSTRO NOT FOUND OR BLANK THEN TELEX CAN'T BE SENT
     C                     SETOF                     70
0698 C                     GOTO CEND1                       *
0699 C           NOER1     TAG                              * NOER1 TAG **
     C*****                MOVE CNUM      NOSTRO  60                      S01194
     C***********          MOVE A7CUST    NOSTRO  60                      S01194              CSD027
     C                     MOVE A7CUST    NOSTRO  6                                           CSD027
0700 C*****                MOVE CNUM      CNUMK                           S01194
0701 C*****                MOVE 'B'       CLIKEY                          S01194
0702 C*****      CLIKEY    CHAINCLINT                67     *             S01194
0703 C**N67                MOVELNAMTWN    RP21              *             S01194
     C**N67                MOVE 'A'       CLIKEY                          S01194
     C**N67      CLIKEY    CHAINCLINT                67                   S01194
0704 C**N67                MOVE SWCH      RP22              *             S01194
     C*                                                                   S01194
     C* USE ACCESS PROGRAM TO READ THE CUSTOMER DETAILS FILE              S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM A7CUST    @KEY1  10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           @CUST     PARM @CUST     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C                     MOVE BBCNA1    @BCATX                          S01194
     C                     MOVE BBCRTN    @BBVTX                          S01194
     C                     MOVE BBCRNM    @BBUTX                          S01194
     C**********           MOVE BBCABA    @BB2TX                    S01194BHF406
     C**********           Z-ADDBBCABA    @BB2T2  30                BHF406S01429
     C                     Z-ADDBBABA2    @BB2T2  40                      S01429
     C                     MOVE @BB2T2    @BB2TX                          BHF406
     C                     MOVE BBCHID    @BB1TX                          S01194
     C                     MOVE BBCSID    @BBYTX                          S01194
     C                     MOVELNAMTWN    RP21                            S01194
     C                     MOVE SWCH      RP22                            S01194
     C                     MOVE '0'       *IN67                           BHF073
     C                     ELSE                                           S01194
     C*     IF CUSTOMER NOT FOUND TELEX CAN'T BE SENT
     C***67**              SETOF                     70                   S01194
     C                     MOVE '1'       *IN67                           S01194
     C                     SETOF                     70                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C***** CHECK SWIFT I.D. ON MODULE DETAILS FILE                       S01194
     C*****                        IF BLANK AND SWIFT SEND A TELEX        S01194
     C*****                TESTB'0'       SWIM           75               S01194
     C           BGSWDL    IFEQ 'Y'                                       S01194
     C                     MOVE '1'       *IN75                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C***75N67***CSID      COMP BLNK20                   75               S01194
     C           *IN67     IFEQ '0'                                       S01194
     C           *IN75     ANDEQ'1'                                       S01194
     C           BBCSID    COMP BLNK20                   75               S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C***55*75N67****      SETON                     70                   S01194
     C           *IN67     IFEQ '0'                                       S01194
     C           *IN55     ANDEQ'1'                                       S01194
     C           *IN75     ANDEQ'1'                                       S01194
     C                     MOVE '1'       *IN70                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
0705 C***67***             MOVELMESS,2    OURAGN            *             S01194
     C           *IN67     IFEQ '1'                                       S01194
     C                     MOVELMESS,2    OURAGN            *             S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*    IF TELEX TO BE SENT INDICATOR ON, CHECK IF DEALING/TELEX
     C*    INTERFACE IS IN SYSTEM
     C*    CHECK IF TELEXES TO BE GENERATED FOR THIS CUSTOMER
     C***70 30             TESTB'0'       TLXR           70               S01122
     C*****      TELX      IFEQ *BLANKS                            S01122 S01194
     C           BBSTAD    IFEQ *BLANKS                                   S01194
     C                     SETOF                         70               S01122
     C                     END                                            S01122
     C   70 30   TOTLX     ADD  1         TOTLX
0706 C                     GOTO CEND1                       *
0707 C           CELSE2    TAG                             **ELSEIF EQ 03
0708 C           SETP      COMP 03                       66 *
0709 C  N66                GOTO CELSE3                      *
0710 C                     MOVE BICN      CUST              *
0711 C*****                MOVE CSAC      ACOD              *             S01194
0712 C*****                MOVE '01'      ACSQ              *             S01194
0711 C                     MOVE BLACCD    A7ACCD            *             S01194
0712 C                     MOVE '01'      A7ACSN            *             S01194
0713 C                     GOTO CEND1                       *
0714 C           CELSE3    TAG                             **ELSEIF EQ 06
0715 C           SETP      COMP 06                       66 *
0716 C  N66                GOTO CELSE4                      *
0717 C                     MOVE BICN      CUST              *
0718 C*****                MOVE COMS      ACOD              *             S01194
0719 C*****                MOVE '01'      ACSQ              *             S01194
0718 C                     MOVE BKACCD    A7ACCD            *             S01194
0719 C                     MOVE '01'      A7ACSN            *             S01194
0720 C                     GOTO CEND1                       *
0721 C           CELSE4    TAG                             **ELSEIF EQ 05
0722 C           SETP      COMP 05                       66 *
0723 C  N66                GOTO CELSE5                      *
0724 C                     MOVE OCNUM     CUST              *
0725 C*****                MOVE OACOD     ACOD              *             S01194
0726 C*****                MOVE OACSQ     ACSQ              *             S01194
0725 C                     MOVE OACOD     A7ACCD            *             S01194
0726 C                     MOVE OACSQ     A7ACSN            *             S01194
0727 C                     GOTO CEND1                       *
0728 C           CELSE5    TAG                             **ELSEIF EQ 14
0729 C* TYPE '14' WILL NOT OCCUR HERE.
0730 C*          SETP      COMP 14                       66 *
0731 C* N66                GOTO CELSE6                      *
0732 C*                    GOTO CEND1                       *
0733 C*          CELSE6    TAG                             **ELSEIF EQ 04
0734 C           SETP      COMP 04                       66 *
0735 C  N66                GOTO CELSE7                      *
0736 C*****                MOVE CADC      ACOD              *             S01194
0737 C*****                MOVE '01'      ACSQ              *             S01194
0736 C                     MOVE BMACCD    A7ACCD            *             S01194
0737 C                     MOVE '01'      A7ACSN            *             S01194
0738 C                     GOTO CEND1                       *
0739 C           CELSE7    TAG                             **ELSE BUCKET
0740 C* N U L L                                             *
0741 C           CEND1     TAG                             **ENDIF
0742 C*
0743 C                     Z-ADDVDAT      ZDAYNO           CONVERT
0744 C                     EXSR ZDATE2                       VALUE DATE
0745 C*
0746 C*****                MOVE '20'      CODE             GET CCY NAME   S01194
0747 C*****                MOVE '        'ZTABKY                          S01194
0748 C*****                MOVE CCY       CURX                            S01194
0749 C*****                MOVE '1'       NOX                             S01194
0750 C*****      ZTABKY    CHAINTABLE                67                   S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CCY       @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
0751 C***67**              MOVELMESS,3    CCNM                            S01194
     C                     MOVE '1'       *IN67                           S01194
0751 C                     MOVELMESS,3    A6CYNM                          S01194
     C                     END                                            S01194
     C*                                                                   S09119
0752 C*****      CDP       COMP 1                    626061               S01194
0753 C*****      CDP       COMP 2                    63  62               S01194
0752 C           A6NBDP    COMP 1                    626061               S01194
0753 C           A6NBDP    COMP 2                    63  62               S01194
0754 C* FED FUNDS
0755 C           FFIN      COMP 1                    48  47
0756 C*
     C/COPY WNCPYSRC,DL0308C002
0757 C                     ENDSR
0758 C********************************************************************
0759 C/EJECT
0760 C********************************************************************
0761 C*
0762 C           CREDIT    BEGSR                           *** CREDIT ***
0763 C* IF SWIFT OR CHIPS
0764 C  N55N54             GOTO CRECHP
0765 C                     MOVE BLNK55    RP31
0766 C**********           MOVE BLNK24    RP32                            S01429
     C                     MOVE BLNK25    RP32                            S01429
0767 C           TSEN      COMP BLNK10                 66
0768 C   66                GOTO CRECHP
0769 C*****                MOVE ALPHA1    CNUMK                           S01194
0769 C                     MOVE ALPHA1    CNUMK   6                       S01194
0770 C                     EXSR CLIEN1                                    S01194
0771 C**N67***             MOVE CSID      TSWADR                          S01194
0772 C**N67***             MOVE CHAB      TCHABA                          S01194
     C           *IN67     IFEQ '0'                                       S01194
0771 C                     MOVE BBCSID    TSWADR                          S01194
     C***********          MOVE BBCABA    TCHABA                    S01194BHF406
     C**********           Z-ADDBBCABA    @TCHAB  30                BHF406S01429
     C**********           MOVE @TCHAB    @BB2TX                    BHF406S01429
     C                     Z-ADDBBABA2    @TCHAB  40                      S01429
     C                     MOVE @TCHAB    @BB2TX                          S01429
     C                     END                                            S01194
     C*                                                                   S01194
0773 C* GET BENEFICIARY DETAILS
     C/COPY WNCPYSRC,DL0308C007
0774 C           CRECHP    TAG                             ** CRECHP TAG**
0775 C                     MOVE BLNK55    RP41
0776 C**********           MOVE BLNK24    RP42                            S01429
     C                     MOVE BLNK25    RP42                            S01429
0777 C           FACO      COMP BLNK10                   49
0778 C   49                SETON                     64
0779 C   49                GOTO CREND1
0780 C                     MOVE FCNUM     CNUMK
0781 C                     EXSR CLIEN1
0782 C*****                MOVE CHID      TCHID                           S01194
0783 C*****                MOVELCRNM      BENAME                          S01194
0784 C*****                MOVELCTWN      BETOWN                          S01194
     C/COPY WNCPYSRC,DL0308C008
     C                     MOVE BBCHID    TCHID                           S01194
     C                     MOVELBBCRNM    BENAME                          S01194
     C                     MOVELBBCRTN    BETOWN                          S01194
     C                     MOVE BLNK10    BETOWN                          S01194
     C*                                                                   S01194
0786 C**N67***             GOTO CREND1                                    S01194
     C           *IN67     IFEQ '0'                                       S01194
     C                     GOTO CREND1                                    S01194
     C                     END                                            S01194
     C*                                                                   S01194
0787 C*****                MOVE CONOST    COUNTN                          S01194
0787 C                     MOVE CONOST    COUNTN  8                       S01194
0788 C                     EXSR CPNOST
0789 C                     MOVE COUNOS    RP41
     C/COPY WNCPYSRC,DL0308C003
0790 C* GET COUNTERPARTY DETAILS
0791 C           CREND1    TAG                             ** CREND1 TAG**
0792 C                     MOVE CNUMPH    CNUMK
0793 C*****                EXSR CLIEN2                                    S01194
0793 C                     EXSR CLIEN1                                    S01194
     C/COPY WNCPYSRC,DL0308C009
0794 C   49                MOVELNAMTWN    RP41
0795 C   49                MOVE BLNK10    RP41
0796 C                     MOVE NAMTWN    RP61
0797 C           CREND     ENDSR                           ** CREND TAG **
0798 C********************************************************************
0799 C/SPACE 3
0800 C********************************************************************
0801 C           PAY       BEGSR                           ****  PAY  ****
     C/COPY WNCPYSRC,DL0308C010
0802 C                     MOVE BLNK55    RP31
0803 C**********           MOVE BLNK24    RP32                            S01429
     C                     MOVE BLNK25    RP32                            S01429
0804 C* IF SETTLEMENT TYPES EQ 01 07 OR 08.
0805 C           SETP      COMP 01                       66
0806 C  N66N54N55          GOTO ENDTHR
     C**********           MOVELTCNOS     CUST    60                                          CSD027
     C                     MOVELTCNOS     CUST    6                                           CSD027
0807 C                     MOVE CUST      ALPHA2  6
0808 C           ALPHA1    COMP ALPHA2               6767
0809 C***67**              GOTO ALPHA                                     S01194
     C           *IN67     IFEQ '1'                                       S01194
     C                     SETOF                     67                   BHF073
     C                     GOTO ALPHA                                     S01194
     C                     END                                            S01194
0810 C                     MOVE ALPHA1    CNUMK
0811 C*****                EXSR CLIEN2                                    S01194
     C                     EXSR CLIEN1                                    S01194
     C/COPY WNCPYSRC,DL0308C011
0812 C                     MOVE SWCH      RP32
0813 C                     MOVELNAMTWN    RP31
0814 C                     MOVE BLNK10    RP31
     C*                                                                   S01194
0815 C**N67***             GOTO ENDTHR                     CLIENT FOUND   S01194
     C           *IN67     IFEQ '0'                                       S01194
     C                     GOTO ENDTHR                     CLIENT FOUND   S01194
     C                     END                                            S01194
     C*                                                                   S01194
0816 C           ALPHA     TAG
0817 C                     MOVE TCNOS     COUNTN
0818 C                     EXSR CPNOST
0819 C                     MOVELCOUNOS    RP31
     C/COPY WNCPYSRC,DL0308C004
0820 C           ENDTHR    TAG                             ** ENDTHR TAG**
0821 C* GET BENEFICIARY DETAILS
0822 C                     MOVE BLNK55    RP41
0823 C**********           MOVE BLNK24    RP42                            S01429
     C                     MOVE BLNK25    RP42                            S01429
0824 C           FACO      COMP ' '                      49
0825 C   49                GOTO ENDFAC
0826 C* IF SETTLEMENT TYPES EQ 01 07 OR 08.
0827 C*  IND '66' IS STILL SET
0828 C  N66N54N55          GOTO ENDFAC
     C**********           MOVELCONOST    BETA1   60                                          CSD027
     C                     MOVELCONOST    BETA1   6                                           CSD027
0829 C                     MOVE BETA1     BETA2   6
0830 C           FCNUM     COMP BETA2                6767
0831 C   67                GOTO BETA
0832 C                     MOVE FCNUM     CNUMK
0833 C                     EXSR CLIEN1
     C/COPY WNCPYSRC,DL0308C012
0834 C                     MOVE SWCH      RP42
0835 C*****                MOVELCRNM      BENAME                          S01194
0836 C*****                MOVELCTWN      BETOWN                          S01194
0835 C                     MOVELBBCRNM    BENAME                          S01194
0836 C                     MOVELBBCRTN    BETOWN                          S01194
     C*                                                                   S01194
0837 C**N67***             GOTO ENDFAC                                    S01194
     C           *IN67     IFEQ '0'                                       S01194
     C                     GOTO ENDFAC                                    S01194
     C                     END                                            S01194
     C*                                                                   S01194
0838 C           BETA      TAG
0839 C                     MOVE CONOST    COUNTN
0840 C                     EXSR CPNOST
0841 C                     MOVE COUNOS    RP41
     C/COPY WNCPYSRC,DL0308C005
0842 C           ENDFAC    TAG                             ** ENDFAC TAG**
0843 C                     MOVE CNUMPH    CNUMK
0844 C                     EXSR CLIEN1
     C/COPY WNCPYSRC,DL0308C013
0845 C                     ENDSR
0846 C********************************************************************
0847 C/SPACE 3
0848 C********************************************************************
0849 C           RECEIV    BEGSR                           *** RECEIV ***
0850 C* GET THEIR AGENT DETAILS
     C/COPY WNCPYSRC,DL0308C014
0851 C**********           MOVE BLNK24    RP32                            S01429
0851 C                     MOVE BLNK25    RP32                            S01429
0852 C                     MOVE BLNK55    RP31
0853 C           SETP      COMP 01                       66IF SET.MENT TYP
0854 C  N66N54N55          GOTO CPARTY                       EQ 01 07 08.
     C                     MOVELTCNOS     CUST
0855 C                     MOVE CUST      ALPHA2
0856 C           ALPHA1    COMP ALPHA2               6767
     C*                                                                   S01194
0857 C***67**              GOTO GAMMA                                     S01194
     C           *IN67     IFEQ '1'                                       S01194
     C                     GOTO GAMMA                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
0858 C                     MOVE ALPHA1    CNUMK
0859 C*****                EXSR CLIEN2                                    S01194
     C                     EXSR CLIEN1                                    S01194
     C/COPY WNCPYSRC,DL0308C015
0860 C                     MOVELNAMTWN    RP31
0861 C                     MOVE BLNK10    RP31
0862 C                     MOVE SWCH      RP32
     C*                                                                   S01194
0863 C**N67***             GOTO CPARTY                                    S01194
     C           *IN67     IFEQ '0'                                       S01194
     C                     GOTO CPARTY                                    S01194
     C                     END                                            S01194
     C*                                                                   S01194
0864 C           GAMMA     TAG
0865 C                     MOVE TCNOS     COUNTN
0866 C                     EXSR CPNOST
0867 C                     MOVE COUNOS    RP31
     C/COPY WNCPYSRC,DL0308C006
0868 C*
0869 C* GET COUNTERPARTY DETAILS
0870 C           CPARTY    TAG                             ** CPARTY TAG**
0871 C                     MOVE CNUMPH    CNUMK
0872 C                     EXSR CLIEN1
     C/COPY WNCPYSRC,DL0308C016
0873 C                     ENDSR
0874 C********************************************************************
0875 C/EJECT
0876 C********************************************************************
0877 C* SUBROUTINE TO GET COUNTERPARTY/NOSTRO INFOMATION
0878 C           CPNOST    BEGSR                           *** CPNOST ***
0879 C                     MOVE BLNK55    COUNOS
0880 C*****      CNOSKY    CHAINTABLE                67                   S01194
     C*                                                                   S01194
     C                     CALL 'AOCNSTR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM COUNTN    @ARCD   8                       S01194
     C           @CNST     PARM @CNST     DSFDY                           S01194
     C*                                                                   S01194
0881 C***67**              MOVELMESS,4    CPNM                            S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVELMESS,4    @WAWTX                          S01194
     C                     MOVE '1'       *IN67                           S01194
     C                     ELSE                                           S01194
     C                     MOVE AWCPNM    @WAWTX                          S01194
     C                     MOVE AWCNTN    @WAXTX                          S01194
     C                     MOVE '0'       *IN67                           BHF590
     C                     END                                            S01194
     C*                                                                   S01194
0882 C                     ENDSR
0883 C********************************************************************
0884 C/SPACE 3
0885 C********************************************************************
0886 C* SUBROUNTINE TO SETUP CLIENT INFOMATION FROM THE 1ST CLIENT RECORD
0887 C           CLIEN1    BEGSR                           *** CLIEN1 ***
0888 C                     MOVE BLNK65    NAMTWN
0889 C**********           MOVE BLNK24    SWCH                            S01429
0889 C                     MOVE BLNK25    SWCH                            S01429
0890 C*****                MOVE 'A'       CLIKEY                          S01194
0891 C*****      CLIKEY    CHAINCLINT                67                   S01194
     C* USE ACCESS PROGRAM TO READ THE CUSTOMER DETAILS FILE              S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CNUMK     @KEY1                           S01194
     C                     PARM *BLANK    @KYST                           S01194
     C********** @CUST     PARM @CUST     DSFDY                           S01194
     C           @CUST     PARM @CUST     DSSDY                    S01194 BHF406
     C*                                                                   S01194
0892 C***67**              MOVELMESS,2    CRNM                            S01194
0893 C***67**              MOVELMESS,2    CTWN                            S01194
     C*                                                                   S01374
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVELMESS,2    @BCATX                          S01194
     C                     MOVELMESS,2    @BBUTX                          S01194
     C                     MOVELMESS,2    @BBVTX                          S01194
     C                     MOVELMESS,2    BBCNA1                          S01374
     C                     MOVE *BLANKS   BBCNA2                          S01374
     C                     MOVE *BLANKS   BBCNA3                          S01374
     C                     MOVE *BLANKS   BBCNA4                          S01374
     C                     MOVE '1'       *IN67                           S01194
     C                     ELSE                                           S01194
     C                     MOVE BBCNA1    @BCATX                          S01194
     C                     MOVE BBCRTN    @BBVTX                          S01194
     C                     MOVE BBCRNM    @BBUTX                          S01194
     C***********          MOVE BBCABA    @BB2TX                    S01194BHF406
     C***********          Z-ADDBBCABA    @BB2T2  30                BHF406S01429
     C                     Z-ADDBBABA2    @BB2T2  40                      S01429
     C                     MOVE @BB2T2    @BB2TX                          BHF406
     C                     MOVE BBCHID    @BB1TX                          S01194
     C                     MOVE BBCSID    @BBYTX                          S01194
     C                     MOVE '0'       *IN67                           BHF590
     C                     END                                            S01194
0894 C                     ENDSR
0895 C********************************************************************
0896 C/SPACE 3
0897 C********************************************************************S01194
0898 C* SUBROUTINE TO SETUP CLIENT INFOMATION FROM BOTH RECORDS           S01194
0899 C*****      CLIEN2    BEGSR                           *** CLIEN2 *** S01194
0900 C*****                MOVE 'A'       CLIKEY                          S01194
0901 C*****      CLIKEY    CHAINCLINT                67                   S01194
0902 C***67                GOTO CLIERR                                    S01194
0903 C*****                MOVE 'B'       CLIKEY                          S01194
0904 C*****      CLIKEY    CHAINCLINT                67                   S01194
0905 C*****                MOVE 'A'       CLIKEY                          S01194
0906 C**N67                GOTO CLIEND                                    S01194
0907 C*****      CLIERR    TAG                             ** CLIERR TAG**S01194
0908 C*****                MOVE BLNK65    NAMTWN                          S01194
0909 C*****                MOVE BLNK24    SWCH                            S01194
0910 C*****                MOVELMESS,2    CRNM                            S01194
0911 C*****                MOVELMESS,2    CTWN                            S01194
0912 C*****                MOVELMESS,2    CNA1                            S01194
0913 C*****      CLIEND    ENDSR                           ** CLIEND TAG**S01194
0914 C********************************************************************
0915 C/EJECT
0916 C********************************************************************S01194
0917 C*****                                                               S01194
0918 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.   S01194
0919 C*****                                                               S01194
0920 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0921 C*****                                                               S01194
0922 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0923 C*****                MOVEL'01      'ZTABKY 12                       S01194
0924 C*****                MOVE '  10'    ZTABKY                          S01194
0925 C*****                                                               S01194
0926 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0927 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0928 C*****                                                               S01194
0929 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0930 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0931 C*****                                                               S01194
0932 C*****                ENDSR                                          S01194
0933 C*****                                                               S01194
0934 C******                                                              S01194
0935 C********************************************************************S01194
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                           * PSSR ENDSR  *S01194
0307 C********************************************************************S01194
     C/COPY WNCPYSRC,DL0308C021
0936 C/EJECT                                                              S01117
     C********************************************************************S01117
0936 C******/EJECT                                                        S01117
0937 O* S T A N D A R D   H E A D E R   L I N E
0938 O*L0308P1H** 59   57                                        S01124   S01117
0938 O*******DL0308P1H   59   57 77                                       S01117
0938 O**DL0308P1H** 59   57                                               E114
0939 O*************                      10 'TEST TOTAL'
0940 O*************            OTTEST1B  32
0941 O*L0308P1H**203   L1                                        S01124   S01117
0941 O********DL0308P1H  203   L1 77                                      S01117
0941 ODL0308P1H  203   L1                                                 E114
     O/COPY WNCPYSRC,DL0308O006
0942 O                                   24 'REFERENCE DL0308P1'
0942 O************                       22 'REFERENCE DL0308'
0943 O*****                    TITL      89                               S01194
     O                         BJURPT    89                               S01194
0944 O                                  122 'DATE              PAGE'
0945 O*****                    RUNA     112                               S01194
     O                         BJMRDT   112                               S01194
0946 O                         PAGE  Z  127
0947 O/SPACE 3
0948 O* C O M M O N   H E A D I N G S
0949 O********H**1     L1                                                 S01117
0949 O********H  1     L1 77                                              S01117
0949 O        H  1     L1                                                 E114
     O/COPY WNCPYSRC,DL0308O007
0950 O                                   64 'OTHER CREDIT TELEX'
0951 O                       54          51 'CHIPS'
0952 O                       55          51 'SWIFT'
0953 O                    51             58 '   OTHER PAY'
0954 O                    51 54          54 'CHIPS'
0955 O                    51 55          54 'SWIFT'
0956 O                    52             58 'OTHER RECEIVE'
0957 O                    52 54          50 'CHIPS'
0958 O                    52 55          50 'SWIFT'
0959 O*****                  53          72 '- LOANS'                     S01194
0960 O*****               45 53          75 '- DEPOSITS'                  S01194
0961 O*****               46 53          82 '- FOREIGN EXCHANGE'          S01194
0962 O***********                       124 'EXCEPTION     BRANCH'        S01117
0962 O                                  113 'EXCEPTION    '               S01117
0963 O                      N80         113 'NON-EXCEPTION'
0393 O                 U5               128 'NETTING MODE'                CDL002
0964 O***********              BRCD     128                               S01117
0965 O********H**1     L1                                                 S01117
0965 O********H  1     L1 77                                              S01117
0965 O        H  1     L1                                                 E114
     O/COPY WNCPYSRC,DL0308O008
0966 O                                   64 '------------------'
0967 O                    51             49 '   '
0968 O                    52             46 '-'
0393 O                 U5               128 '------------'                CDL002
0969 O*****                  53          73 '---------'                   S01194
0970 O*****               45 53          75 '-----------'                 S01194
0971 O*****               46 53          82 '------------------'          S01194
     O********H  2     L1 77                                              S01117
     O        H  2     L1                                                 E114
     O/COPY WNCPYSRC,DL0308O009
     O                                   12 'BRANCH'                      S01117
     O                         OSBR      16                               S01117
     O*****                    BRNM      48                         S01117S01194
     O                         A8BRNM    48                               S01194
0972 O********H**1     L1                                                 S01117
0972 O********H  1     L1 77                                              S01117
0972 O        H  1     L1                                                 E114
     O/COPY WNCPYSRC,DL0308O010
0973 O                                   12 'DESTINATION'
     O/COPY WNCPYSRC,DL0308O001
0974 O                         OURAGN    49
     O/COPY WNCPYSRC,DL0308O002
0975 O********H**2     L1                                                 S01117
0975 O********H  2     L1 77                                              S01117
0975 O        H  2     L1                                                 E114
     O/COPY WNCPYSRC,DL0308O011
0976 O                         OURAGT    24
     O                 70 30            113 '** TELEX GENERATED **'
0977 O********H**2     L1                                                 S01117
0977 O********H  2     L1 77                                              S01117
0977 O        H  2     L1                                                 E114
     O/COPY WNCPYSRC,DL0308O012
0978 O                                    5 'TEST:'
0979 O********H**3     L1                                                 S01117
0979 O********H  3     L1 77                                              S01117
0979 O        H  3     L1                                                 E114
     O/COPY WNCPYSRC,DL0308O013
0980 O                                    6 'VALUE'
0981 O                         ZADATE    14
0982 O                                   30 'CREDIT'
0983 O                    51             30 '   PAY'
0984 O                    52             30 'RECEIVE'
0985 O*****                    CCNM      45
     O                         A6CYNM    45
0986 O                       47          74 'FEDERAL FUNDS'
0987 O                       48          74 'SAME DAY FUNDS'
0988 O********H**1     L1                                                 S01117
0988 O********H  1     L1 77                                              S01117
0988 O        H  1     L1                                                 E114
     O/COPY WNCPYSRC,DL0308O014
0989 O                    50 54          17 'CREDIT CHIPS CODE'
0990 O                    50 55          17 'CREDIT SWIFT CODE'
0991 O                       51          10 'PAY TO'
0992 O                                   50 'ACCOUNT OF'
0993 O                       52          52 'RECEIVE FROM'
0994 O                                   87 'BY ORDER OF'
0995 O                                  102 'REF.'
0996 O                                  126 'AMOUNT'
0997 O********H**2     L1                                                 S01117
0997 O********H  2     L1 77                                              S01117
0997 O        H  2     L1                                                 E114
     O/COPY WNCPYSRC,DL0308O015
0998 O                    50 54          17 '-----------------'
0999 O                    50 55          17 '-----------------'
1000 O                       51          10 '------'
1001 O                                   50 '----------'
1002 O                       52          52 '--'
1003 O                                   87 '-----------'
1004 O                                  102 '----'
1005 O                                  126 '------'
1006 O* C R E D I T   T E L E X E S
1007 O********D**2     01 50                                              S01117
1007 O********D  2     01 50 77                                           S01117
1007 O        D  2     01 50                                              E114
     O/COPY WNCPYSRC,DL0308O016
1008 O                       55TSWADR    12
1009 O***********            54TCHABA     3                               S01429
1009 O                       54TCHABA     4                               S01429
1010 O                       54TCHID     45
     O/COPY WNCPYSRC,DL0308O003
1011 O********D**1     01 50                                              S01117
1011 O********D  1     01 50 77                                           S01117
1011 O        D  1     01 50                                              E114
     O/COPY WNCPYSRC,DL0308O017
1012 O                         BENAME    71
1013 O***********              CPRNAM    92                               S01374
1014 O***********              DLNO     103                               S01117
1014 O***********              DLNO     101                         S01117CDL002
1014 O                NU5      DLNO     101                               CDL002
1014 O                 U5      NTRF     101                               CDL002
1014 O                                  102 '/'                           S01117
1014 O                         BRCA     105                               S01117
1015 O                       60EAMT     126 ' ,   ,   ,   , 0 -'
1016 O                       61EAMT     128 '   ,   ,   , 0 . -'
1017 O                       62EAMT     129 '  ,   ,   , 0 .  -'
1018 O                       63EAMT     130 ' ,   ,   , 0 .   -'
     O        D  1     01 50                                              S01374
     O/COPY WNCPYSRC,DL0308O018
     O                         BBCNA1   107                               S01374
1019 O********D**2     01 50                                              S01117
1019 O********D  2     01 50 77                                           S01117
1019 O********D  2     01 50                                          E114S01374
     O        D  1     01 50                                              S01374
     O/COPY WNCPYSRC,DL0308O019
1020 O                         BETOWN    56
1021 O********                 CPRTWN    82                               S01374
     O                         BBCNA2   107                               S01374
     O        D  1     01 50                                              S01374
     O/COPY WNCPYSRC,DL0308O020
     O                         BBCNA3   107                               S01374
     O        D  1     01 50                                              S01374
     O/COPY WNCPYSRC,DL0308O021
     O                         BBCNA4   107                               S01374
1022 O********D**3     01 50                                              S01117
1022 O********D  3     01 50 77                                           S01117
1022 O        D  3     01 50                                              E114
     O/COPY WNCPYSRC,DL0308O022
1023 O                      N21          34 'SPEC. INST.'
     O                    32N21          34 'BENEF. BANK'
1024 O                      N21SPI       71
1025 O* P A Y   T E L E X E S
1026 O********D**2     01 51                                              S01117
1026 O********D  2     01 51 77                                           S01117
1026 O        D  2     01 51                                              E114
     O/COPY WNCPYSRC,DL0308O023
1027 O                 55      TSWADR    12
1028 O**********       54      TCHABA     3                               S01429
1028 O                 54      TCHABA     4                               S01429
1029 O                 54N49   BCHID     45
     O/COPY WNCPYSRC,DL0308O004
1030 O********D**1     01 51                                              S01117
1030 O********D  1     01 51 77                                           S01117
1030 O        D  1     01 51                                              E114
     O/COPY WNCPYSRC,DL0308O024
1031 O                         THEIRN    35
1032 O                      N49BENAME    71
1033 O*****                  49CRNM      56                               S01194
1034 O*****                    CRNM      92                               S01194
     O**********             49BBCRNM    56                         S01194S01273
     O**********               BBCRNM    92                         S01194S01273
     O****************         BBCNA1    71                         S01273BHF471
     O****************       49BBCNA1   107                         S01273BHF471
     O                       49BBCNA1    71                               BHF471
     O****************         BBCNA1   107                         BHF471BHF494
     O                         BBCRNM    92                               BHF494
1035 O*******                  DLNO     103                               S01117
1014 O                         DLNO     101                               S01117
1014 O                                  102 '/'                           S01117
1014 O                         BRCA     105                               S01117
1036 O                       60EAMT     126 ' ,   ,   ,   , 0 -'
1037 O                       61EAMT     128 '   ,   ,   , 0 . -'
1038 O                       62EAMT     129 '  ,   ,   , 0 .  -'
1039 O                       63EAMT     130 ' ,   ,   , 0 .   -'
1040 O********D**2     01 51                                              S01117
1040 O********D  2     01 51 77                                           S01117
1040 O********D**2*****01 51                                          E114BHF471
1040 O        D  1     01 51                                              BHF471
     O/COPY WNCPYSRC,DL0308O025
1041 O                         THEIRT    20
1042 O                      N49BETOWN    56
1043 O*****                  49CTWN      46                               S01194
     O**********             49BBCRTN    46                         S01194S01273
1044 O*****                    CTWN      82                               S01194
     O**********               BBCRTN    82                         S01194S01273
     O                 49      BBCNA2    71                               S01273
     O                         BBCNA2   107                               S01273
     O                 U5               115 'NET REF'                     CDL002
     O        D  1     01 51                                              S01273
     O/COPY WNCPYSRC,DL0308O026
     O                 49      BBCNA3    71                               S01273
     O                         BBCNA3   107                               S01273
     O                 U5      NTRF     127                               CDL002
     O        D  1     01 51                                              S01273
     O/COPY WNCPYSRC,DL0308O027
     O                 49      BBCNA4    71                               S01273
     O                         BBCNA4   107                               S01273
1045 O********D**3     01 51                                              S01117
1045 O********D  3     01 51 77                                           S01117
1045 O        D  3     01 51                                              E114
     O/COPY WNCPYSRC,DL0308O028
1046 O                      N21          34 'SPEC. INSTR.'
     O                    32N21          34 'BENEF. BANK '
1047 O                      N21SPI       72
1048 O* R E C E I V E   T E L E X E S
1049 O********D**2     01 52                                              S01117
1049 O********D  2     01 52 77                                           S01117
1049 O        D  2     01 52                                              E114
     O/COPY WNCPYSRC,DL0308O029
1050 O                 55      TSWADR    48
1051 O                 54      TCHABA    48
     O/COPY WNCPYSRC,DL0308O005
1052 O********D**1     01 52                                              S01117
1052 O********D  1     01 52 77                                           S01117
1052 O        D  1     01 52                                              E114
     O/COPY WNCPYSRC,DL0308O030
1053 O                         THEIRN    71
1054 O*****                    CRNM      92                               S01194
     O**********               BBCRNM    92                         S01194S01273
     O*****************        BBCNA1   107                         S01273BHF494
     O***********              BBCRNM   107                         BHF494BHF681
     O                         BBCRNM    92                               BHF681
1055 ********                  DLNO     103                               S01117
1014 O                         DLNO     101                               S01117
1014 O                                  102 '/'                           S01117
1014 O                         BRCA     105                               S01117
1056 O                       60EAMT     126 ' ,   ,   ,   , 0 -'
1057 O                       61EAMT     128 '   ,   ,   , 0 . -'
1058 O                       62EAMT     129 '  ,   ,   , 0 .  -'
1059 O                       63EAMT     130 ' ,   ,   , 0 .   -'
1060 O********D**3     01 52                                              S01117
1060 O********D  3     01 52 77                                           S01117
1060 O********D* 3     01 52                                          E114S01273
1060 O        D  1     01 52                                              S01273
     O/COPY WNCPYSRC,DL0308O031
1061 O                         THEIRT    56
1062 O*****                    CTWN      82                               S01194
     O**********               BBCRTN    82                         S01194S01273
     O                         BBCNA2   107                               S01273
     O                 U5               115 'NET REF'                     CDL002
     O        D  1     01 52                                              S01273
     O/COPY WNCPYSRC,DL0308O032
     O                         BBCNA3   107                               S01273
     O                 U5      NTRF     127                               CDL002
     O        D  1     01 52                                              S01273
     O/COPY WNCPYSRC,DL0308O033
     O                         BBCNA4   107                               S01273
1063 O*
     O********T 3      L8 77                                              S01117
     O********T 3      L8 14                                              E114
     O********                           66 '*** END OF BRANCH '          S01117
     O********                           76 'REPORT ***'                  S01117
     O*                                                                   S01117
     O********T   59   LR 41 68
     O*******AND*****  77                                                 E114
     O        T   59   L1 14
     O/COPY WNCPYSRC,DL0308O034
1065 O                                   10 'TEST TOTAL'
1066 O                         OTTEST1   32
1067 O*
     O        T 1      L8 14                                              E114
     O/COPY WNCPYSRC,DL0308O035
     O                                   66 '*** END OF BRANCH '          S01117
     O                                   76 'REPORT ***'                  S01117
1068 O*
1069 O*
1070 O* C O N T R O L S
1071 O********T  203   LR                                                 S01117
1071 ODL0308AUT  203   LR                                                 S01117
1072 O********                           22 'REFERENCE DL0308'            S01117
1072 O                                   24 'REFERENCE DL0308AU'          S01117
1073 O*****                    TITL      89                               S01194
1073 O                         BJURPT    89                               S01194
1074 O                                  122 'DATE              PAGE'
1075 O*****                    RUNA     112                               S01194
1075 O                         BJMRDT   112                               S01194
1076 O***********              PAGE  Z  127                               S01117
1076 O                         PAGE1 Z  127                               S01117
1077 O        T  1     LR
1078 O                                   67 'PAY/RECEIVE TELEXES - FI'
1079 O                                   84 'LE CONTROL REPORT'
1080 O                                  113 'EXCEPTION'
1081 O                      N80         113 'NON-EXCEPTION'
0393 O                 U5               128 'NETTING MODE'                CDL002
1082 O        T  3     LR
1083 O                                   67 '------------------------'
1084 O                                   84 '-----------------'
0393 O                 U5               128 '------------'                CDL002
1085 O        T  1     LR
1086 O                                   29 'S/PRSX1 - RUN CONTROLS'
1087 O                                   59 'NUMBER'
1088 O                                   84 'VALUE'
1089 O        T  2     LR
1090 O                                   29 '----------------------'
1091 O                                   59 'OF RECORDS'
1092 O                                   84 'OF RECORDS'
1093 O        T  2     LR
1094 O                                   31 'TOTAL RECORDS - ON FILE'
1095 O                         NORE  3   59
1096 O                         HRWN  Z   81
1097 O                         HRDC      84
1098 O        T  3     LR
1099 O                                   32 'TOTAL RECORDS - CALCULAT'
1100 O                                   34 'ED'
1101 O                         RECIN 3   59
1102 O                         ZZTOTIZ   81
1103 O                         ZZTOTD    84
1104 O                 U8               118 '***   DIFFERENCE   ***'
     O        T  3     LR 25
     O                                   27 'TOTAL TELEX RECORDS'
     O                         TOTLX Z   59
1105 O********T 33     LR U7                                              S01117
1106 O********                           71 '*** DATABASE ERROR ***'      S01117
     C*                                                                   S01117
     O        T 3      LRNU7N14                                           S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
     O        T 3      LR U7                                              S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7                                              S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7                                              S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
1107 O*****   T 3   60 LR                                                 E299
1108 O*****                              71 '*** END OF REPORT ***'       E299
     O*
     O*    T E L E X    M O D U L E    I N T E R F A C E
     O*
     OPRTLXHH DADD     15
     O                                    1 'A'
     OPRTLXDT DADD     70 01 30
     O                                    1 'D'
     O***********              BRCD       4                               S01117
     O                         BRCA       4                               S01117
     O                         NOSTRO    10
     O                         DTYP      12
     O                         ZDAY      14
     O                         ZMTH      16
     O                         ZYEAR     18
     O                         CCY       21
     O                         DLNO      27
     O                         PYRC      28
     O                      N52          29 'I'
     O                       52          29 'C'
     O                                   30 'D'
     O                         FFIN      31
     O*****                    CCNM      45                               S01194
     O*****                    CDP       46                               S01194
     O                         A6CYNM    45                               S01194
     O                         A6NBDP    46                               S01194
     O                         EAMT      53P
     O*****                    RUNA      60                               S01194
     O                         BJMRDT    60                               S01194
     O                         RP31     115
     O*****            51      CRNM     135                               S01194
     O*****            51      CTWN     160                               S01194
     O                 51      BBCRNM   135                               S01194
     O                 51      BBCRTN   160                               S01194
     O                 51N49   RP41     170
     O*****                    CRNM     190                               S01194
     O*****                    CTWN     200                               S01194
     O                         BBCRNM   190                               S01194
     O                         BBCRTN   200                               S01194
     O                         SPI      235
     O***********              BRCD     303                               S01117
     O                         BRCA     303                               S01117
     O                         NSNO     305                               S01135
** CPY@   **      OBJECT COPYRIGHT                                        S01194
(c) Finastra International Limited 2001
**  MESS
NOSTRO MISSING
CLIENT MISSING
CUR.NOT FOUND
COUNTERPARTY/NOSTRO MISSING
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
     X/COPY WNCPYSRC,DL0308X001
