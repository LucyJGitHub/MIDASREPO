0001 H        1
0002 F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Incomplete Pay/Rec Telexes BHF056')
0002 F*****************************************************************
     F*                                                               *
0003 F*  Midas - Dealing Module                                   *
0004 F*                                                               *
0005 F*  DL0312 - Pay/Receive Telexes - Incomplete Instructions       *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CDL025             Date 27Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU003             Date 27Jan98               *
      *                 CDL002             Date 16Sep97               *
     F*                 066201             Date 07Mar94               *
     F*                 S01429             DATE 13JUL93               *
     F*                 E47225             DATE 01FEB93               *
     F*                 S01374             DATE 24MAR92               *
     F*                 BHF590             DATE 17SEP90               *
     F*                 BHF494             DATE 27AUG90               *
     F*                 BHF408             DATE 13AUG90               *
     F*                 S01273             DATE 11JUN90               *
     F*                 LN0219             DATE 21MAY90               *
     F*                 E299               DATE 04APR90               *
     F*                 E264               DATE 03APR90               *
     F*                 E114               DATE 27NOV89               *
     F*                 S01194             DATE 23FEB89               *
     F*                 S01122             DATE 31AUG86               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *  *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CDL025 - FX Netting Payment Generation (Recompile)           *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  CEU003 - EMU Dealing Settlement Ccy conversion - Recompile   *
     F*           only.                                               *
     F*  CDL002 - FX Netting                                          *
     F*  066201 - Prints 'NOSTRO MISSING' when not true.              *
     F*           Check for alpha/numeric uses wrong field.           *
     F*  S01429 - CHIPS ABA number midification from 3A to 4A for     *
     F*           CHIPS II.                                           *
     F*  E47225 - Condition call to AORETLR0 on Retail being present. *
     F*  S01374 - Print full name and address on Telex report.        *
     F*  BHF590 - For A/C of field always printed as not entered      *
     F*           because *IN67 never reset.                          *
     F*  BHF494 - By order of overwritten with deal number.           *
     F*  BHF408 - Report should be keyed by Booking Branch and have   *
     F*           Settlement Branch as the account key.               *
     F*  E114/S01117 Program should not allow entity selection.       *
     F*  S01273 - Print full customer name and address.               *
     F*  LN0219 - 'END OF REPORT FOR BRANCH' text error.              *
     F*  E299   - 'AU' report should not write 'END OF REPORT'        *
     F*  E264   - Should receive seq. no  and pass to ZSFILE          *
     F*  S01194 - Incorporation of new Standing Data files via A/O    *
     F*           N.B field PRID is reserved for CHASE MANHAT & is    *
     F*           not supported by new SD files. Hence all coding     *
     F*           relating to this field has been removed.            *
     F*****************************************************************
0011 F/SPACE 3
0012 FPRSX2   IP  E           K        DISK
0013 F***LE   IF  F      96 12AI     2 DISK                               S01194
0014 F***NT   IF  F     256  7AI     2 DISK                               S01194
     F**TLXDT O   F     303            DISK                      A    U4
     FPRTLXDT O   F     305            DISK                      A    U4
0015 F***312P1O   F     132            PRINTER                            S01117
0015 FDL0312P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0015 FDL0312AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
     F/COPY WNCPYSRC,DL0312F001
0016 F/SPACE 3
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            LF/PRSX2 - DETAIL
0019 F* 02                    - TRAILER
0020 F* 03            CURRENCIES RECORD
0021 F* 04            CUSTOMER DETAIL RECORD
0022 F* 05            CLOSED RETAIL A/C NUMBER
0023 F*    20         AMOUNT NEGATIVE
0024 F*    21         SPECIAL INSTR. NULL
     F*       25      OUTPUT TOTAL NO. OF TELEXES ON REPORT
     F*       30      OUTPUT TO TELEX FILE
     F*       31      WORK INDICATOR USED FOR BENEFICIARY BANK DETAILS
     F*       32      BENEFICIARY BANK DETAILS EXIST IN SPI FIELD
0025 F*       40      1ST CYCLE
0026 F*       41      1ST DETAIL
0027 F*       45      DEPOSITS
0028 F*       46      FOREIGN EXCHANGE
0029 F*       47      FED. FUNDS
0030 F*       48      CLEARING HOUSE FUNDS
0031 F*       49      BENEFICIARY NOT A CUSTOMER
0032 F*       51      PAY
0033 F*       52      RECEIVE
0034 F*       53      BY PRODUCT
0035 F*       54      CHIPS - SETTLEMENT TYPE '07'
0036 F*       55      SWIFT - SETTLEMENT TYPE '08'
0037 F*       57      PRINT TELEX TOTAL ON NEXT HEADER
0038 F*       60      DEC. PLACES 0
0039 F*       61                  1
0040 F*       62                  2
0041 F*       63                  3
0042 F*       64      BENEFICIARY-NAME AND TOWN BLANK
0043 F*       66      WORK IND.
0044 F*       67      CHAIN FAILURE
     F*       70      OUTPUT TO TELEX FILE
     F*       71      SWIFT CODE FIELD IS BLANK
     F*       75      CHECK FOR SWIFT/DEALING INTERFACE
     F*       77      CONDITION OUTPUT TO DL0312P1                        S01117
     F*      N78      P1 NOT OPENED/WRITTEN TO SO NO DETAILS TO REPORT    S01117
0045 F*       80      I/P CYCLE RUN
     F*         U4    TELEX MODULE INTERFACE ACTIVE
     F*         U5    NETTING MODE                                        CDL002
     E                    CPY@    1   1 80
0046 E                    MESS    1   4 29
0047 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0048 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0049 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    ASTAR      55  1               ARRAY OF *
     E/COPY WNCPYSRC,DL0312E001
0050 I* LF/PRSX2 DETAIL RECORD
0051 IPREXPHF     01
0052 I                                              PYRC  L7
0053 I                                              SETP  L6
0054 I                                              PROD  L5
0055 I                                              CCY   L4
0056 I                                              OSAC  L3
0057 I                                              FFIN  L2
0058 I                                              VDAT  L1
0060 I              CNUM                            CNUMPH
0062 I                                              EAMT          20
0066 I                                              SPI             21
0073 I*****                                         BRCD  L8              S01117
0073 I*******************************************   OSBR  L8        S01117BHF407
     I                                              BRCA  L8              BHF407
0076 I*
0077 I* TRAILER
0078 IPREXZZF     02
0087 I*
0086 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.**             S01194
0087 I*****************                                                   S01194
0088 I***LE   NS       2 C0   3 C1  12 C1                                 S01194
0089 I***    AND      13 C0                                               S01194
0090 I***                                     1   1 RECI                  S01194
0091 I***                                     2   30RECT                  S01194
0092 I***                                    12  130RCDE                  S01194
0093 I***                                    14  66 TITL                  S01194
0094 I***                                    67  67 DATF                  S01194
0095 I***                                    68  700DFBR                  S01194
     I***                                    71  71 TLXM                  S01194
     I***                                    73  73 SWIM                  S01194
0096 I***                                    74  74 MODI1                 S01194
0097 I***                                    75  75 MODI2                 S01194
0098 I***                                    76  76 MODI3                 S01194
0099 I***                                 P  77  790RUND                  S01194
0100 I***                                    80  86 RUNA                  S01194
0101 I***                                    87  870SFLG                  S01194
0102 I***                                 P  90  920LCD                   S01194
0103 I***                                    93  93 CHTP                  S01194
0104 I***                                 P  94  960TNLU                  S01194
0105 I***                                                                 S01194
0106 I**** TABLE FILE - INSTALLATION CONTROL DATA RECORD 3.               S01194
0107 I***                                                                 S01194
0108 I***LE   NS       1 CD   2 C0   3 C1                                 S01194
0109 I***    AND      12 C2  13 C0                                        S01194
0110 I***                                     1   1 RECI                  S01194
0111 I***                                     2   30RECT                  S01194
0112 I***                                    12  130RCDE                  S01194
0113 I***                                    14  170COMS                  S01194
0114 I***                                    18  210CADC                  S01194
0115 I***                                 P  22  240MDIC                  S01194
0116 I***                                 P  25  270MCIC                  S01194
0117 I***                                 P  28  300MDIA                  S01194
0118 I***                                 P  31  330MCIA                  S01194
0119 I***                                    34  370SRPL                  S01194
0120 I***                                    38  410SPAC                  S01194
0121 I***                                    42  450SWAC                  S01194
0122 I***                                    46  490FTAC                  S01194
0123 I***                                    50  530TAC4                  S01194
0124 I***                                    54  570TAC5                  S01194
0125 I***                                 P  63  650NOBA                  S01194
0126 I***                                 P  66  680TSIZ                  S01194
0127 I***                                    69  69 RACN                  S01194
0128 I***                                    70  700GLSI                  S01194
0129 I***                                    71  710RTSI                  S01194
0130 I***                                    72  720DLSI                  S01194
0131 I***                                    73  730NOSI                  S01194
0132 I***                                    74  740CTSI                  S01194
0133 I***                                 P  75  770ELAC                  S01194
0134 I***                                 P  78  800ECAC                  S01194
0135 I***                                 P  90  920LCD                   S01194
0136 I***                                    93  93 CHTP                  S01194
0137 I***                                 P  94  960TNLU                  S01194
0138 I***                                                                 S01194
0139 I***  TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.               S01194
0140 I***                                                                 S01194
0141 I***LE   NS       1 CD   2 C0   3 C1                                 S01194
0142 I***    AND      12 C4  13 C0                                        S01194
0143 I***                                     1   1 RECI                  S01194
0144 I***                                     2   30RECT                  S01194
0145 I***                                    12  130RCDE                  S01194
0146 I***                                    18  210CSAC                  S01194
0147 I***                                    22  22 TLII                  S01194
0148 I***                                    23  23 MCRI                  S01194
0149 I***                                 P  24  250MCEP                  S01194
0150 I***                                    26  270MCLP                  S01194
0151 I***                                    28  28 FRDI                  S01194
0152 I***                                    29  29 BRCF                  S01194
0153 I***                                    30  350PSCN                  S01194
0154 I***                                    36  380DLBR                  S01194
0155 I***                                    39  420FRPA                  S01194
0156 I***                                    43  460FRPC                  S01194
0157 I***                                    47  49 USCY                  S01194
0158 I***                                    50  52 STCY                  S01194
0159 I***                                 P  53  553MBGE                  S01194
0160 I***                                    56  56 PRID                  S01194
0161 I***                                 P  90  920LCD                   S01194
0162 I***                                    93  93 CHTP                  S01194
0163 I***                                 P  94  960TNLU                  S01194
0164 I***                                                                 S01194
0165 I***  TABLE FILE - CURRENCIES RECORD 1.                              S01194
0166 I****                                                                S01194
0167 I***LE   NS       1 CD   2 C2   3 C0                                 S01194
0168 I***    AND      13 C1                                               S01194
0169 I***                                     1   1 RECI                  S01194
0170 I***                                     2   30RECT                  S01194
0171 I***                                    10  12 CCY                   S01194
0172 I***                                    13  130SREC                  S01194
0173 I***                                    14  27 CCNM                  S01194
0174 I***                                 P  28  348SPOT                  S01194
0175 I***                                    35  37 CCYS                  S01194
0176 I***                                    38  380CDP                   S01194
0177 I***                                    39  390TNOT                  S01194
0178 I***                                    40  40 DCCY                  S01194
0179 I***                                    41  44 SRC1                  S01194
0180 I***                                    45  48 SRC2                  S01194
0181 I***                                    49  520TACC                  S01194
0182 I***                                    53  560TEQV                  S01194
0183 I***                                    57  600SWQV                  S01194
0184 I***                                    61  640TAC4                  S01194
0185 I***                                    65  680TAC5                  S01194
0186 I***                                    69  69 HIND                  S01194
0187 I***                                 P  70  768PART                  S01194
0188 I***                                    77  780SSNO                  S01194
0189 I***                                 P  79  858ERLC                  S01194
0190 I***                                 P  90  920LCD                   S01194
0191 I***                                    93  93 CHTP                  S01194
0192 I***                                 P  94  960TNLU                  S01194
0193 I***                                                                 S01194
0194 I***  TABLE FILE - NOSTROS RECORD.                                   S01194
0195 I***                                                                 S01194
0196 I***LE   NS       1 CD   2 C7   3 C0                                 S01194
0197 I***                                     1   1 RECI                  S01194
0198 I***                                     2   30RECT                  S01194
0199 I***                                     9  11 CCY                   S01194
0200 I***                                    12  130NOSN                  S01194
0201 I***                                    16  29 ONAC                  S01194
0202 I***                                    30  350CNUM                  S01194
0203 I***                                    36  370ACSQ                  S01194
0204 I***                                    38  410ACOD                  S01194
0205 I***                                 P  90  920LCD                   S01194
0206 I***                                    93  93 CHTP                  S01194
0207 I***                                 P  94  960TNLU                  S01194
0208 I***                                                                 S01194
0209 I***  TABLE FILE - COUNTERPARTY NOSTROS RECORD.                      S01194
0210 I***                                                                 S01194
0211 I***LE   NS       1 CD   2 C7   3 C1                                 S01194
0212 I***                                     1   1 RECI                  S01194
0213 I***                                     2   30RECT                  S01194
0214 I***                                     6  13 CPSH                  S01194
0215 I***                                    14  48 CPNM                  S01194
0216 I***                                    49  68 CPTN                  S01194
0217 I***                                 P  90  920LCD                   S01194
0218 I***                                    93  93 CHTP                  S01194
0219 I***                                 P  94  960TNLU                  S01194
0220 I***                                                                 S01194
0221 I***ATCHALL                                                          S01194
0222 I***     NS  67                                                      S01194
0223 I***                                                                 S01194
0224 I***  CLIENT FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0225 I***                                                                 S01194
0226 I***NT   NS       1 CD   8 CA                                        S01194
0227 I***                                     1   1 RECI                  S01194
0228 I***                                     2   70CNUM                  S01194
0229 I***                                     8   8 RCDT                  S01194
0230 I***                                     9  28 CRNM                  S01194
0231 I***                                    29  38 CTWN                  S01194
0232 I***                                    39  48 CSNM                  S01194
0233 I***                                    49  56 CASK                  S01194
0234 I***                                    57  68 TELX                  S01194
0235 I***                                    69  80 CSID                  S01194
0236 I***                                    81  82 ACOC                  S01194
0237 I***                                    83  83 CBSI                  S01194
0238 I***                                    84  85 CCTZ                  S01194
0239 I***                                    86  87 CLOC                  S01194
0240 I***                                    88  930CPAR                  S01194
0241 I***                                    94  960BRCDCB                S01194
0242 I***                                    97  980LINS                  S01194
0243 I***                                    99 1010LIND                  S01194
0244 I***                                 P 102 1040DASU                  S01194
0245 I***                                 P 105 1070CDIC                  S01194
0246 I***                                 P 108 1100DADE                  S01194
0247 I***                                   111 111 CMIN                  S01194
0248 I***                                   112 112 CTYP                  S01194
0249 I***                                   113 124 TELF                  S01194
0250 I***                                   125 133 CHID                  S01194
0251 I***                                   134 136 CHAB                  S01194
     I***                                   245 245 TLXR                  S01194
0252 I***                                 P 250 2520LCD                   S01194
0253 I***                                   253 253 CHTP                  S01194
0254 I***                                 P 254 2560TNLU                  S01194
0255 I***                                                                 S01194
0256 I***                                                                 S01194
0257 I***  CLIENT FILE - CUSTOMER NAME AND ADDRESS RECORD.                S01194
0258 I***                                                                 S01194
0259 I***     NS       1 CD   8 CB                                        S01194
0260 I***                                     1   1 RECI                  S01194
0261 I***                                     2   70CNUM                  S01194
0262 I***                                     8   8 RCDT                  S01194
0263 I***                                     9  43 CNA1                  S01194
0264 I***                                    44  78 CNA2                  S01194
0265 I***                                    79 113 CNA3                  S01194
0266 I***                                   114 148 CNA4                  S01194
0267 I***                                   240 249 CTWN                  S01194
0268 I***                                 P 250 2520LCD                   S01194
0269 I***                                   253 253 CHTP                  S01194
0270 I***                                 P 254 2560TNLU                  S01194
0271 I***                                                                 S01194
0272 I***ATCHALL                                                          S01194
0273 I***     NS  67                                                      S01194
     I*                                                                   S01194
     I* DATA STRUCTURES FOR USE WITH ACCESS OBJECTS                       S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I*                                                                   S01194
     ISDRETL    E DSSDRETLPD                                              S01194
     I              QQACCD                          QQACCX                                    CGL029
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I              QQACCD                          QQACCY                                    CGL029
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I*                                                                   S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
     I              QQACCD                          QQACCZ                                    CGL029
     I*                                                                   S01194
     ISDCNST    E DSSDCNSTPD                                              S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I              QQDFAC                          QQDFAX                                    CGL029
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I/COPY WNCPYSRC,DL0312I001
0274 I* D A T A - S T R U C T U R E S
0275 I            DS
0276 I                                        1  45 RP21
0277 I                                        1  35 OURAGN
0278 I                                       36  45 OURAGT
0279 I*
0280 I            DS
0281 I**********                              1  24 RP22                  S01429
0282 I**********                              1   3 OCHABA                S01429
0283 I**********                              4  12 OCHID                 S01429
0284 I**********                             13  24 OSWADR                S01429
0281 I                                        1  25 RP22                  S01429
0282 I                                        1   4 OCHABA                S01429
0283 I                                        5  13 OCHID                 S01429
0284 I                                       14  25 OSWADR                S01429
0285 I*
0286 I            DS
0287 I                                        1  55 RP31
0288 I                                        1  35 THEIRN
0289 I                                       36  55 THEIRT
0290 I*
0291 I            DS
0292 I**********                              1  24 RP32                  S01429
0293 I**********                              1   3 TCHABA                S01429
0294 I**********                              4  12 TCHID                 S01429
0295 I**********                             13  24 TSWADR                S01429
0292 I                                        1  25 RP32                  S01429
0293 I                                        1   4 TCHABA                S01429
0294 I                                        5  13 TCHID                 S01429
0295 I                                       14  25 TSWADR                S01429
0296 I*
0297 I            DS
0298 I                                        1  55 RP41
0299 I                                        1  35 BENAME
0300 I                                       36  55 BETOWN
0301 I*
0302 I            DS
0303 I**********                              1  24 RP42                  S01429
0304 I**********                              1   3 BCHABA                S01429
0305 I**********                              4  12 BCHID                 S01429
0306 I**********                             13  24 BSWADR                S01429
0303 I                                        1  25 RP42                  S01429
0304 I                                        1   4 BCHABA                S01429
0305 I                                        5  13 BCHID                 S01429
0306 I                                       14  25 BSWADR                S01429
0307 I*
0308 I            DS
0309 I                                        1  65 RP61
0310 I                                        1  35 CPNAME
0311 I                                       36  45 CPRTWN
0312 I                                       46  65 CPRNAM
0313 I*
0314 I            DS
0315 I**********                              1  24 RP62                  S01429
0316 I**********                              1   3 CCHABA                S01429
0317 I**********                              4  12 CCHID                 S01429
0318 I**********                             13  24 CSWADR                S01429
0315 I                                        1  25 RP62                  S01429
0316 I                                        1   4 CCHABA                S01429
0317 I                                        5  13 CCHID                 S01429
0318 I                                       14  25 CSWADR                S01429
0319 I****BLES FILE KEY                                                   S01194
0320 I****        DS                                                      S01194
0321 I****                                    1  12 ZTABKY                S01194
0322 I***                                     1   2 CODE                  S01194
0323 I***                                     8  10 CURR                  S01194
0324 I***                                    11  12 NOSTNO                S01194
0325 I***                                     9  11 CURX                  S01194
0326 I***                                    12  12 NOX                   S01194
0327 I***ABLES FILE KEY FOR COUNTERPARTY/NOSTROS                          S01194
0328 I***         DS                                                      S01194
0329 I***                                     1  12 CNOSKY                S01194
0330 I***                                     5  12 COUNTN                S01194
0331 I***LIENT FILE KEY                                                   S01194
0332 I***         DS                                                      S01194
0333 I***                                     1   7 CLIKEY                S01194
0334 I***                                     1   6 CNUMK                 S01194
     I***                                                                 S01194
0335 I* CLIENT DETAILS
0336 I            DS
0337 I                                        1  65 NAMTWN
0338 I                                        1  35 @CNA1                 S01194
0339 I                                       36  45 @CTWN                 S01194
0340 I                                       46  65 @CRNM                 S01194
0338 I***                                     1  35 CNA1                  S01194
0339 I***                                    36  45 CTWN                  S01194
0340 I***                                    46  65 CRNM                  S01194
0341 I            DS
0342 I                                        1  25 SWCH                  S01429
0343 I                                        1   4 @CHAB                 S01429
0344 I                                        5  13 @CHID                 S01429
0345 I                                       14  25 @CSID                 S01429
0342 I**********                              1  24 SWCH                  S01429
0343 I**********                              1   3 @CHAB           S01194S01429
0344 I**********                              4  12 @CHID           S01194S01429
0345 I**********                             13  24 @CSID           S01194S01429
0343 I***                                     1   3 CHAB                  S01194
0344 I***                                     4  12 CHID                  S01194
0345 I***                                    13  24 CSID                  S01194
0346 I* COUNTERPARTY/NOSTRO DETAILS
0347 I            DS
0348 I                                        1  55 COUNOS
0349 I                                        1  35 @CPNM                 S01194
0350 I                                       36  55 @CPTN                 S01194
0349 I****                                    1  35 CPNM                  S01194
0350 I****                                   36  55 CPTN                  S01194
0351 I* OUR SETTLEMENT A/C * AGENT *
0352 I            DS
0353 I**********                              1  12 OSAC                                      CGL029
     I                                        1  18 OSAC                                      CGL029
0354 I                                        1   2 ONOS
0355 I                                        1   6 OCNUM
0356 I**********                              7  10 OACOD                                     CGL029
0357 I**********                             11  12 OACSQ                                     CGL029
0356 I                                        7  16 OACOD                                     CGL029
0357 I                                       17  18 OACSQ                                     CGL029
0358 I                                        1  10 RETNO
0359 I* THEIR AGENT
0360 I            DS
0361 I                                        1  10 TSEN
0362 I                                        1   6 CUST
0363 I                                        1   8 TCNOS
0364 I* BLANK FIELDS
0365 I            DS
0366 I                                        1  65 BLNK65
0367 I**********                              1  24 BLNK24                S01429
0367 I                                        1  25 BLNK25                S01429
0368 I                                        1  45 BLNK45
0369 I                                        1  55 BLNK55
0370 I                                        1   3 BLNK3
0371 I                                        1  10 BLNK10
0372 I                                        1  20 BLNK20
0373 I* FOR A/C OF
0374 I            DS
0375 I                                        1  10 FACO
0376 I                                        1   6 FCNUM
0377 I                                        1   8 CONOST
     I**   FIELDS USED FOR BENEFICIARY BANK DETAILS
     I            DS
     I                                        1  35 SPI
     I                                        1   3 SPEC3
     I                                        1   5 SPEC5
     I                                        6   8 SPEC8
     I                                        1   8 SPEC9
     I                                        6  12 SPEC12
     I                                        9  14 SPEC14
     I                                        9  17 SPEC17
     I                                       10  18 SPEC18
     I                                        5  34 SPEC34
     I                                        6  35 SPEC35
     I*
     I**                                                                  S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I**    FILE INFORMATION DATA STRUCTURE                               S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I**    FILE INFORMATION DATA STRUCTURE                               S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ILDA         DS                            256                       E47225
     I                                      134 143 DBFILE                E47225
     I                                      142 170 DBKEY                 E47225
     I                                      171 180 DBPGM                 E47225
     I                                      181 183 DBASE                 E47225
      **  Local data area                                                 E47225
      *                                                                   E47225
     I**                                                                  S01117
     C**                                                                  S01117
     C********   *ENTRY    PLIST                                          E114
     C********             PARM           SEQ     5                       E114
     C********             PARM           BRNCH   3        BRANCH OR ALL  E114
     C**                                                                  E264
     C           *ENTRY    PLIST                                          E264
     C                     PARM           SEQ     5                       E264
     C**                                                                  E264
0378 C* 1 S T   C Y C L E   P R O C E S S I N G
0379 C   41                GOTO MAIN
0380 C   40                GOTO START
     C*                                                                   S01117
     C/COPY WNCPYSRC,DL0312C010
0381 C                     SETON                     40
0382 C   U7                SETON                     80
0383 C                     SETOF                     U7
0384 C*****                EXSR ZSYSTM                                    S01194
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN           LDA                             E47225
     C                     MOVEL*BLANKS   DBPGM                           E47225
     C                     MOVEL'DL0312'  DBPGM                           E47225
     C*                                                                   S01194
     C* CALL A/O AOMMODR0                                                 S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C********             MOVEL'SDMMODPD'DBFILE 10        *********S01194E47225
     C********             MOVEL'01'      DBASE   2        * DBERR 0S01194E47225
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDMMODPD'DBFILE           ************   E47225
     C                     MOVEL'001'     DBASE            * DBERR 01 *   E47225
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     OUT  LDA                                       E47225
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C* CALL A/O AOBANKR0                                                 S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C********             MOVEL'SDBANKPD'DBFILE 10        *********S01194E47225
     C********             MOVEL'02'      DBASE   2        * DBERR 0S01194E47225
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDBANKPD'DBFILE           ************   E47225
     C                     MOVEL'002'     DBASE            * DBERR 02 *   E47225
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     OUT  LDA                                       E47225
     C                     EXSR *PSSR                                     S01194
     C                     ELSE                                           S01194
     C*                                                                   S01194
0864 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C*                                                                   S01194
0865 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C                     END                                            S01194
     C*                                                                   S01194
0385 C***                  MOVE '20'      ZTABKY                          S01194
0386 C***        ZTABKY    CHAINTABLE                67                   S01194
0387 C***67                SETON                     LRU7                 S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDGELRPD'DBFILE           ************   S01194
     C********             MOVEL'03'      DBASE   2        * DBERR 0S01194E47225
     C                     MOVEL'003'     DBASE            * DBERR 03 *   E47225
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     OUT  LDA                                       E47225
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           BGRTBN    IFEQ 'Y'                                       E47225
     C           BGIOAC    OREQ 'Y'                                       E47225
     C                     CALL 'AORETLR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDRETLPD'DBFILE           ************   S01194
     C********             MOVEL'04'      DBASE   2        * DBERR 0S01194E47225
     C                     MOVEL'004'     DBASE            * DBERR 04 *   E47225
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     OUT  LDA                                       E47225
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C                     END                                            E47225
     C*                                                                   S01194
0388 C****                 MOVE '40'      ZTABKY                          S01194
0389 C****       ZTABKY    CHAINTABLE                67                   S01194
0390 C***67                SETON                     LRU7                 S01194
     C*                                                                   S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDTRADPD'DBFILE           ************   S01194
     C********             MOVEL'05'      DBASE   2        * DBERR 0S01194E47225
     C                     MOVEL'005'     DBASE            * DBERR 04 *   E47225
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     OUT  LDA                                       E47225
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*    IF TELEX TO BE SENT INDICATOR ON, CHECK IF DEALING/TELEX
     C*    INTERFACE IS IN SYSTEM
     C****                 TESTB'0'       TLXM           70               S01194
     C           BGMTDL    IFEQ 'Y'                                       S01194
     C                     MOVE '1'       *IN70                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C   70                SETON                     30
0391 C****       PRID      COMP 'Y'                      53               S01194
0392 C                     Z-ADD0         TCOUNT  50
     C                     Z-ADD0         TOTLX   30
0393 C***                  MOVE 'A'       CLIKEY                          S01194
0394 C***                  MOVEL'71'      CNOSKY                          S01194
     C*   BUILD ARRAY OF ASTERISKS FOR OUTPUT TO AN INCOMPLETE TELEX
     C                     MOVE '*'       ASTAR
0395 C* S T A R T
0396 C           START     TAG                             ** START TAG **
0397 C  N01                GOTO ENDDET
0398 C* DETAIL PROCESSING FOR 1ST DETAIL RECORD
0399 C                     SETON                     41
0400 C                     EXSR HEADER
0401 C                     GOTO ENTRY1
0402 C/SPACE 3
0403 C* M A I N   P R O C E S S I N G
0404 C           MAIN      TAG
     C                     SETOF                     3132
     C/COPY WNCPYSRC,DL0312C005
0405 C  N01                GOTO ENDDET
0406 C   L1                Z-ADD0         TCOUNT
0407 C           TCOUNT    COMP 5                    66  66
0408 C   66                SETON                     L1
0409 C   66                Z-ADD0         TCOUNT
0410 C   L1                EXSR HEADER
0411 C           ENTRY1    TAG                             ** ENTRY1 TAG**
0412 C           TCOUNT    ADD  1         TCOUNT
0413 C   51                EXSR PAY
0414 C   52                EXSR RECEIV
0415 C   60                Z-ADDEAMT      WK13
     C*
     C**   CHECK BENEFICIARY BANK DETAILS
     C*
     C**   IGNORE IF SPECIAL INSTRUCTIONS IS BLANK
     C   21                GOTO BENEND
     C*
     C           SPEC5     COMP '/BEN/'              313132
     C   31                GOTO BENEND
     C*
     C**   CHECK FOR CHIPS NUMBER
     C           SPEC8     COMP '/CH'                    31
     C   31                MOVE SPEC14    WORK6   6
     C   31                MOVE *BLANKS   SPI
     C   31                MOVE 'CHIPS'   SPEC5
     C   31                MOVE WORK6     SPEC12
     C   31                GOTO BENEND
     C*
     C**   CHECK FOR FED. WIRE NUMBER
     C           SPEC8     COMP '/FW'                    31
     C   31                MOVE SPEC17    WORK9   9
     C   31                MOVE *BLANKS   SPI
     C   31                MOVE 'FED.WIRE'SPEC9
     C   31                MOVE WORK9     SPEC18
     C   31                GOTO BENEND
     C*
     C**   MUST NOW BE 'ACCOUNT'
     C                     MOVE SPEC35    WORK30 30
     C                     MOVE *BLANKS   SPI
     C                     MOVE 'A/C'     SPEC3
     C                     MOVE WORK30    SPEC34
     C*
     C           BENEND    TAG                             * BENEND TAG *
     C*
0416 C   61      EAMT      DIV  10        WK13   130
0417 C   62      EAMT      DIV  100       WK13
0418 C   63      EAMT      DIV  1000      WK13
0419 C           TESTOT    ADD  WK13      TESTOT 150
0420 C           EAMT      DIV  1000      ZZAMT
0421 C   20                Z-SUBZZAMT     ZZAMT
0422 C                     EXSR GLZADD
0423 C*
0424 C           ENDDET    TAG                             ** ENDDET TAG**
0425 C           RECIN     ADD  1         RECIN   50
     C**    IF CHANGE OF BRANCH                                           S01117
     C           *INL8     IFEQ '1'                                       S01117
     C                     CLOSEDL0312P1                                  S01117
     C********   BRNCH     IFEQ 'ALL'                                     E114
     C********   BRNCH     OREQ OSBR                                      E114
     C*********************SETON                     77                   E114
     C                     OPEN DL0312P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** IF P1 FILE OPENED THEN SET ON FLAG                               S01117
     C                     MOVE '1'       *IN78                           S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     CALL 'ZSFILE'                                  S01117
     C*********************PARM *BLANKS   SEQ     5                S01117 E264
     C                     PARM           SEQ     5                       E264
     C*******************  PARM OSBR      @PARM   3                 S01117BHF407
     C                     PARM BRCA      @PARM   3                       BHF407
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**                                                                  S01117
     C**    TO GET BRANCH NAME (IN A8BNTX)                                S01117
     C***                  MOVE *BLANKS   ZTABKY                   S01117 S01194
     C***                  MOVEL'10'      ZTABKY 12                S01117 S01194
     C***                  MOVE OSBR      ZTABKY                   S01117 S01194
     C***        ZTABKY    CHAINTABLE                67            S01117 S01194
     C*                                                                   S01194
     C* CALL A/O                                                          S01194
     C*                                                                   S01194
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C*******************  PARM OSBR      @DSNB   3                 S01194BHF407
     C                     PARM BRCA      @DSNB   3                       BHF407
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INU8                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01194
     C********             MOVEL'06'      DBASE            * DBERR 0S01194E47225
     C                     MOVEL'006'     DBASE            * DBERR 06 *   E47225
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     OUT  LDA                                       E47225
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C***67      RECI      COMP 'D'                  6767          S01117 S01194
     C***67                SETON                     U7U8LR        S01117 S01194
     C   U8                GOTO END                                       S01117
     C*********            ELSE                                           E114
     C*********            SETOF                     77                   E114
     C*********            END                                            E114
     C                     END                                            S01117
0426 C   02                SETON                     LR
     C           END       TAG                             ** END TAG **  S01117
     C/COPY WNCPYSRC,DL0312C011
0427 C/SPACE 3
0428 C* IF NO PRODUCT BREAKDOWN USED AND LEVEL BREAK CAUSED BY 'PROD'
0429 C***L6N53             SETOF                     L1                   S01194
0429 CL5NL6                SETOF                     L1                   S01194
0430 C/SPACE 3
     C/COPY WNCPYSRC,DL0312C012
0431 CLR         TOTLX     COMP 0                    25
0431 CLR         NORE      COMP RECIN                U8U8
0432 CLRNU8      HRWN      COMP ZZTOTI               U8U8
0433 CLRNU8      HRDC      COMP ZZTOTD               U8U8
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUM   60                      S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     C**LR*****************PARM *BLANKS   SEQ                      S01117 E264
     CLR                   PARM           SEQ                             E264
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0434 C/EJECT
0435 C* S U B R O U T I N E S
0436 C*
0437 C********************************************************************
0438 C**
0439 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0440 C**
0441 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0442 C**
0443 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0444 C**
0445 C**   CLEAR DATE FIELDS.
0446 C                     Z-ADD0         ZDATE   60
0447 C                     MOVEL'       ' ZADATE  7
0448 C**
0449 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0450 C                     Z-ADDZDAYNO    ZDAYNO  50
0451 C**
0452 C**   DETERMINE YEAR NUMBER.
0453 C**
0454 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0455 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0456 C   99                GOTO ZDEND2
0457 C**
0458 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0459 C           ZDAYN1    DIV  1461      ZLYR    20
0460 C                     MVR            ZDAYN1           SAVE REMAINING
0461 C**                                                   DAYS
0462 C**   CALCULATE NUMBER OF REMAINING YEARS.
0463 C                     Z-ADD1         ZWRK2   20
0464 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0465 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0466 C  N90      ZWRK2     ADD  1         ZWRK2
0467 C  N90                GOTO ZDTAG1
0468 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0469 C**
0470 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0471 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0472 C**
0473 C**   CALCULATE ACTUAL YEAR NUMBER.
0474 C           ZLYR      MULT 4         ZWRK3   30
0475 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0476 C                     Z-ADDZWRK3     ZYEAR   20
0477 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0478 C**
0479 C**   DETERMINE MONTH NUMBER.
0480 C**
0481 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0482 C                     SETOF                     9293
0483 C   91      ZDAYN1    COMP 59                     9293
0484 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0485 C**
0486 C**   CALCULATE MONTH NUMBER.
0487 C                     Z-ADD2         ZWRK2
0488 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0489 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0490 C  N94      ZWRK2     ADD  1         ZWRK2
0491 C  N94                GOTO ZDTAG2
0492 C           ZWRK2     SUB  1         ZWRK2
0493 C**
0494 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0495 C**
0496 C**   DETERMINE DAY OF MONTH.
0497 C**
0498 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0499 C           ZDAYN1    ADD  1         ZDAYN1
0500 C**
0501 C**   CALCULATE DAY OF MONTH.
0502 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0503 C**
0504 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0505 C   93      ZDAY      ADD  1         ZDAY
0506 C**
0507 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0508 C  N98                MOVELZDAY      ZWRK4   40
0509 C   98                MOVE ZDAY      ZWRK4
0510 C  N98                MOVE ZMTH      ZWRK4
0511 C   98                MOVELZMTH      ZWRK4
0512 C                     MOVELZWRK4     ZDATE
0513 C                     MOVE ZYEAR     ZDATE
0514 C**
0515 C**   FORMAT ALPHA DATE, DDMMMYY.
0516 C           ZDAY      COMP 10                     95
0517 C                     MOVELZDAY      ZWRK5   5
0518 C   95                MOVEL' '       ZWRK5
0519 C                     MOVE ZMNM,ZMTH ZWRK5
0520 C                     MOVELZWRK5     ZADATE
0521 C                     MOVE ZYEAR     ZADATE
0522 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0523 C**
0524 C**
0525 C**
0526 C********************************************************************
0527 C/SPACE 3
0528 C********************************************************************
0529 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0530 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0531 C*
0532 CSR         GLZADD    BEGSR                           *** GLZADD ****
0533 C*
0534 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0535 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0536 C*
0537 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0538 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0539 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0540 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0541 C*
0542 CSR                   EXSR GLZSUM
0543 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0544 C*
0545 C********************************************************************
0546 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0547 C*                        GLZADD, GLZSUB, GLZCMP.
0548 C*          PARAMETERS PASSED -
0549 C*                     I/P ZZAMTI ZZAMTD
0550 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0551 C*
0552 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0553 C*
0554 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0555 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0556 CSR                   SETOF                     919293
0557 CSR                   SETOF                     949599
0558 C*
0559 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0560 CSR         ZZAMTI    COMP 0                      9293
0561 CSR 93      ZZAMTD    COMP 0                      9293
0562 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0563 C*
0564 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0565 CSR         ZZTOTI    COMP 0                      9193
0566 CSR 93      ZZTOTD    COMP 0                      9193
0567 C*
0568 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0569 CSR 93                Z-ADDZZAMTI    ZZTOTI
0570 CSR 93                Z-ADDZZAMTD    ZZTOTD
0571 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0572 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0573 CSR 91N92
0574 CORN91 92             GOTO ZZOFPS
0575 C*
0576 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0577 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0578 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0579 C*
0580 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0581 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0582 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0583 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0584 C*
0585 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0586 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0587 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0588 CSRN99                Z-ADDZZWK2     ZZTOTD
0589 CSRN99                Z-ADDZZWK3     ZZTOTI
0590 C*
0591 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0592 CSR 99                Z-ADD0         ZZAMT  153
0593 CSR                   GOTO ZZSEND
0594 C*
0595 C* THE 'SIGNS' ARE DIFFERENT
0596 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0597 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0598 C*
0599 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0600 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0601 C*
0602 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0603 C*
0604 CSR 91                Z-SUBZZTOTI    ZZTOTI
0605 CSR 91                Z-SUBZZTOTD    ZZTOTD
0606 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0607 C*
0608 CSR         ZZTOTI    COMP ZZAMTI               93  95
0609 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0610 C*
0611 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0612 CSR 95                Z-ADD0         ZZTOTI
0613 CSR 95                Z-ADD0         ZZTOTD
0614 CSR 95                GOTO ZZSEND
0615 C*
0616 C* IF ZZTOT GT. ZZAMT.
0617 CSR 93      ZZAMTD    COMP ZZTOTD               94
0618 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0619 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0620 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0621 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0622 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0623 C*
0624 C*
0625 C* IF ZZAMT GT. ZZTOT.
0626 CSRN93      ZZTOTD    COMP ZZAMTD               94
0627 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0628 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0629 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0630 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0631 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0632 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0633 C*
0634 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0635 CSR                   SETOF                     94
0636 CSR 93 91
0637 CORN93 92             SETON                     94
0638 CSR 94                Z-SUBZZTOTI    ZZTOTI
0639 CSR 94                Z-SUBZZTOTD    ZZTOTD
0640 C**
0641 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0642 CSR 92                Z-SUBZZAMTI    ZZAMTI
0643 CSR 92                Z-SUBZZAMTD    ZZAMTD
0644 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0645 C**
0646 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0647 CSR                   SETOF                     96
0648 CSR         ZZTOTD    COMP 0                        91
0649 CSR 91      ZZTOTI    COMP 0                      96
0650 CSR 96                MOVE '.000-'   ZZNEGD  5
0651 CSR                   ENDSR                             ** ENDSR **
0652 C********************************************************************
0653 C/EJECT
0654 C********************************************************************
0655 C*
0656 C           HEADER    BEGSR                           ***  HEADER ***
     C***********          Z-ADD0         NOSTRO  60                                          CSD027
     C                     MOVE *BLANKS   NOSTRO  6                                           CSD027
0657 C                     SETOF                     5455
     C                     SETOF                     70
0658 C           PYRC      COMP 'P'                  525251
0659 C                     MOVE BLNK45    RP21
0660 C**********           MOVE BLNK24    RP22                            S01429
     C                     MOVE BLNK25    RP22                            S01429
0661 C           PROD      COMP 1                      4645
0662 C* O U R   A G E N T - 'CASE' ON SETTLEMENT TYPE
0663 C           SETP      COMP 00                       66**IF SETTLEMENT
0664 C  N66                GOTO CELSE1                      * TYPE EQ '00'
0665 C* N U L L                                             *
0666 C                     GOTO CEND1                       *
0667 C           CELSE1    TAG                              *ELSEIF EQ 01,
     C           SETP      COMP 01                   666670
0669 C   66      SETP      COMP 02                   6666   *
0670 C   66      SETP      COMP 07                   666654 *
0671 C   66      SETP      COMP 08                   666655 *
0672 C   66      SETP      COMP 12                   6666   *
0673 C   66                GOTO CELSE2                      *
0674 C           OSAC      COMP ' '                      66 *
0675 C***                  MOVE CCY       CURR              *             S01194
0676 C***                  MOVE ONOS      NOSTNO                          S01194
0677 C***66                MOVE '00'      NOSTNO            *             S01194
     C                     MOVE NOSTNO    NSNO    20
0678 C***                  MOVE '70'      CODE              *             S01194
0679 C***        ZTABKY    CHAINTABLE                67     *             S01194
     C*                                                                   S01194
     C           *IN66     IFEQ '0'                                       S01194
     C                     MOVE ONOS      NOSTNO  2                       S01194
     C                     ELSE                                           S01194
     C                     MOVE '00'      NOSTNO                          S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C* NOSTRO NOS FILE                                                   S01194
     C*                                                                   S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM *BLANK    @KEYA   6                       S01194
     C                     PARM CCY       @KEYB   3                       S01194
     C**********           PARM *BLANK    @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANK    @KEYC  10                                           CGL029
     C                     PARM *BLANK    @KEYD   2                       S01194
     C                     PARM NOSTNO    @KEYE   2                       S01194
     C                     PARM *BLANKS   @KEYF   3                       S01194
     C                     PARM *BLANKS   @KEYG  10                       S01194
     C                     PARM *BLANKS   @KEYH   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     CABEQ*BLANK    NOER1                           S01194
     C*                                                                   S01194
0680 C**N67                GOTO NOER1                       *             S01194
0681 C                     MOVELMESS,1    OURAGN            *
     C*    IF NOSTRO NOT FOUND OR BLANK THEN TELEX CAN'T BE SENT
     C                     SETOF                     70
0682 C                     GOTO CEND1                       *
0683 C           NOER1     TAG                              * NOER1 TAG **
     C                     MOVE A7CUST    NOSTRO
0684 C***                  MOVE CNUM      CNUMK                           S01194
0685 C***                  MOVE 'B'       CLIKEY                          S01194
     C***                                                                 S01194
0686 C***        CLIKEY    CHAINCLINT                67     *             S01194
0687 C**N67                MOVELNAMTWN    RP21              *             S01194
0688 C**N67                MOVE 'A'       CLIKEY                          S01194
0689 C**N67      CLIKEY    CHAINCLINT                67                   S01194
0690 C**N67                MOVE SWCH      RP22              *             S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM A7CUST    @KEY1  10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C                     MOVE BBCNA1    @CNA1                           S01194
     C                     MOVE BBCRTN    @CTWN                           S01194
     C                     MOVE BBCRNM    @CRNM                           S01194
     C**********           MOVE BBCABA    @CHAB                     S01194S01429
     C                     MOVE BBABA2    @CHAB                           S01429
     C                     MOVE BBCHID    @CHID                           S01194
     C                     MOVE BBCSID    @CSID                           S01194
     C                     MOVELNAMTWN    RP21                            S01194
     C                     MOVE SWCH      RP22                            S01194
     C                     ELSE                                           S01194
     C*                                                                   S01194
     C*    IF CUSTOMER NOT FOUND TELEX CAN'T BE SENT
     C***67                SETOF                     70                   S01194
     C                     SETOF                     70                   S01194
0691 C                     MOVELMESS,2    OURAGN            *             S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C*    CHECK SWIFT I.D. ON S/CLINT ,IF BLANK AND SWIFT SEND A TELEX
     C****                 TESTB'0'       SWIM           75               S01194
     C           BGSWDL    IFEQ 'Y'                                       S01194
     C                     MOVE '1'       *IN75                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C           *IN75     ANDEQ'1'                                       S01194
     C           BBCSID    COMP BLNK20                   75               S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           *IN75     IFEQ '1'                                       S01194
     C           *IN55     ANDEQ'1'                                       S01194
     C           @RTCD     ANDEQ*BLANK                                    S01194
     C                     MOVE '1'       *IN70                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C***75N67   CSID      COMP BLNK20                   75               S01194
     C***55 75N67          SETON                     70                   S01194
0691 C***67                MOVELMESS,2    OURAGN            *             S01194
     C*    CHECK IF TELEXES TO BE GENERATED FOR THIS CUSTOMER
     C***70 30             TESTB'0'       TLXR           70               S01122
     C   70 30   BBCTNB    IFEQ *BLANKS                            S01122 S01194
     C***70 30   TELX      IFEQ *BLANKS                            S01122 S01194
     C                     SETOF                         70               S01122
     C                     END                                            S01122
     C   70 30   TOTLX     ADD  1         TOTLX
0692 C                     GOTO CEND1                       *
0693 C           CELSE2    TAG                             **ELSEIF EQ 03
0694 C           SETP      COMP 03                       66 *
0695 C  N66                GOTO CELSE3                      *
0696 C                     MOVE BICN      CUST              *
0697 C                     MOVE BLACCD    A7ACCD            *             S01194
0698 C                     MOVE '01'      A7ACSN            *             S01194
0697 C***                  MOVE CSAC      ACOD              *             S01194
0698 C***                  MOVE '01'      ACSQ              *             S01194
0699 C                     GOTO CEND1                       *
0700 C           CELSE3    TAG                             **ELSEIF EQ 06
0701 C           SETP      COMP 06                       66 *
0702 C  N66                GOTO CELSE4                      *
0703 C                     MOVE BICN      CUST              *
0704 C                     MOVE BKACCD    A7ACCD            *             S01194
0705 C                     MOVE '01'      A7ACSN            *             S01194
0704 C***                  MOVE COMS      ACOD              *             S01194
0705 C***                  MOVE '01'      ACSQ              *             S01194
0706 C                     GOTO CEND1                       *
0707 C           CELSE4    TAG                             **ELSEIF EQ 05
0708 C           SETP      COMP 05                       66 *
0709 C  N66                GOTO CELSE5                      *
0710 C                     MOVE OCNUM     CUST              *
0711 C                     MOVE OACOD     A7ACCD            *             S01194
0712 C                     MOVE OACSQ     A7ACSN            *             S01194
0711 C***                  MOVE OACOD     ACOD              *             S01194
0712 C***                  MOVE OACSQ     ACSQ              *             S01194
0713 C                     GOTO CEND1                       *
0714 C           CELSE5    TAG                             **ELSEIF EQ 14
0715 C* TYPE '14' WILL NOT OCCUR.
0716 C*          SETP      COMP 14                       66 *
0717 C* N66                GOTO CELSE6                      *
0718 C*                    GOTO CEND1                       *
0719 C*          CELSE6    TAG                             **ELSEIF EQ 04
0720 C           SETP      COMP 04                       66 *
0721 C  N66                GOTO CELSE7                      *
0722 C                     MOVE BMACCD    A7ACCD            *             S01194
0723 C                     MOVE '01'      A7ACSN            *             S01194
0722 C***                  MOVE CADC      ACOD              *             S01194
0723 C***                  MOVE '01'      ACSQ              *             S01194
0724 C                     GOTO CEND1                       *
0725 C           CELSE7    TAG                             **ELSE BUCKET
0726 C* N U L L                                             *
0727 C           CEND1     TAG                             **ENDIF
0728 C*
0729 C                     Z-ADDVDAT      ZDAYNO           CONVERT
0730 C                     EXSR ZDATE2                       VALUE DATE
0731 C*
0732 C****                 MOVE '20'      CODE             GET CCY NAME   S01194
0733 C****                 MOVE '        'ZTABKY                          S01194
0734 C****                 MOVE CCY       CURX                            S01194
0735 C****                 MOVE '1'       NOX                             S01194
0736 C****       ZTABKY    CHAINTABLE                67                   S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CCY       @K101   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVELMESS,3    A6CYNM                          S01194
     C                     END                                            S01194
     C*                                                                   S01194
0737 C***67                MOVELMESS,3    CCNM                            S01194
0738 C           A6NBDP    COMP 1                    626061               S01194
0739 C           A6NBDP    COMP 2                    63  62               S01194
0738 C***        CDP       COMP 1                    626061               S01194
0739 C***        CDP       COMP 2                    63  62               S01194
0740 C* FED FUNDS
0741 C           FFIN      COMP 1                    48  47
     C/COPY WNCPYSRC,DL0312C006
0742 C*
0743 C                     ENDSR
0744 C********************************************************************
0745 C***ECT
0746 C/SPACE 3
0747 C********************************************************************
0748 C           PAY       BEGSR                           ****  PAY  ****
0749 C                     MOVE BLNK55    RP31
0750 C**********           MOVE BLNK24    RP32                            S01429
0750 C                     MOVE BLNK25    RP32                            S01429
0751 C* IF SETTLEMENT TYPES EQ 01 07 OR 08.
0752 C           SETP      COMP 01                       66
0753 C  N66N54N55          GOTO ENDTHR
     C***********          MOVELTCNOS     NUM6    60                      066201
     C**********           MOVELFCNUM     NUM6    60                                   066201 CSD027
     C                     MOVELFCNUM     NUM6    6                                           CSD027
     C                     MOVELNUM6      ALPHA2  6
     C***********CUST      COMP ALPHA2               6767                 066201
     C           FCNUM     CABNEALPHA2    ALPHA      6767                 066201
     C***67******          GOTO ALPHA                                     066201
0754 C***                  MOVE CUST      CNUMK                           S01194
0754 C***********          MOVE CUST      CNUMK   6                S01194 066201
     C                     MOVE FCNUM     CNUMK   6                       066201
     C/COPY WNCPYSRC,DL0312C003
0755 C                     EXSR CLIEN1
0756 C****                 EXSR CLIEN2                                    S01194
0757 C                     MOVE SWCH      RP32
0758 C                     MOVELNAMTWN    RP31
0759 C                     MOVE BLNK10    RP31
0760 C  N67                GOTO ENDTHR                     CLIENT FOUND
     C           ALPHA     TAG                             ** ALPHA TAG **
0761 C                     MOVE CONOST    COUNTN
0762 C                     EXSR CPNOST
0763 C                     MOVELCOUNOS    RP31
     C                     MOVELCOUNOS    RP31T  55
     C/COPY WNCPYSRC,DL0312C007
     C* COUNTERPARTY NOSTRO & CUSTOMER NOT FOUND, TELEX IS INCOMPLETE
     C   67 70             MOVEAASTAR     RP31T
0764 C           ENDTHR    TAG                             ** ENDTHR TAG**
0765 C* GET BENEFICIARY DETAILS
0766 C                     MOVE BLNK55    RP41
0767 C           FACO      COMP ' '                      49
0768 C   49                GOTO ENDFAC
0769 C* IF SETTLEMENT TYPES EQ 01 07 OR 08.
0770 C*  IND '66' IS STILL SET
0771 C  N66N54N55          GOTO ENDFAC
0772 C                     MOVE FCNUM     CNUMK
0773 C                     EXSR CLIEN1
0774 C                     MOVELBBCRNM    BENAME                          S01194
0775 C                     MOVELBBCRTN    BETOWN                          S01194
0774 C***                  MOVELCRNM      BENAME                          S01194
0775 C***                  MOVELCTWN      BETOWN                          S01194
0776 C  N67                GOTO ENDFAC
0777 C***                  MOVE CONOST    COUNTN                          S01194
0777 C                     MOVE CONOST    COUNTN  8                       S01194
0778 C                     EXSR CPNOST
0779 C                     MOVE COUNOS    RP41
     C/COPY WNCPYSRC,DL0312C008
0780 C           ENDFAC    TAG                             ** ENDFAC TAG**
0781 C                     MOVE CNUMPH    CNUMK
0782 C                     EXSR CLIEN1
0783 C                     ENDSR
0784 C********************************************************************
0785 C/SPACE 3
0786 C********************************************************************
0787 C           RECEIV    BEGSR                           *** RECEIV ***
0788 C* GET THEIR AGENT DETAILS
0789 C**********           MOVE BLNK24    RP32                            S01429
0789 C                     MOVE BLNK25    RP32                            S01429
0790 C                     MOVE BLNK55    RP31
0791 C           SETP      COMP 01                       66IF SET.MENT TYP
0792 C  N66N54N55          GOTO CPARTY                       EQ 01 07 08.
     C***********          MOVELTCNOS     NUM6                            066201
     C**********           MOVELFCNUM     NUM6    60                                   066201 CSD027
     C                     MOVELFCNUM     NUM6    6                                           CSD027
     C                     MOVELNUM6      ALPHA2
     C***********CUST      COMP ALPHA2               6767                 066201
     C           FCNUM     CABNEALPHA2    GAMMA      6767                 066201
     C***67******          GOTO GAMMA                                     066201
0793 C***********          MOVE CUST      CNUMK                           066201
     C                     MOVE FCNUM     CNUMK   6                       066201
     C/COPY WNCPYSRC,DL0312C004
0794 C                     EXSR CLIEN1
0795 C****                 EXSR CLIEN2                                    S01194
0796 C                     MOVELNAMTWN    RP31
0797 C                     MOVE BLNK10    RP31
0798 C                     MOVE SWCH      RP32
0799 C  N67                GOTO CPARTY
     C           GAMMA     TAG                             ** GAMMA TAG **
0800 C                     MOVE TCNOS     COUNTN
0801 C                     EXSR CPNOST
0802 C                     MOVE COUNOS    RP31
     C                     MOVELCOUNOS    RP31T  55
     C/COPY WNCPYSRC,DL0312C009
     C* COUNTERPARTY NOSTRO & CUSTOMER NOT FOUND, TELEX IS INCOMPLETE
     C***67 70             MOVEAASTAR     RP31T                           S01135
     C   67 70             MOVELBLNK55    RP31T                           S01135
     C   67 70             MOVEL'UNKNOWN' RP31T                           S01135
0803 C*
0804 C* GET COUNTERPARTY DETAILS
0805 C           CPARTY    TAG                             ** CPARTY TAG**
0806 C                     MOVE CNUMPH    CNUMK
0807 C                     EXSR CLIEN1
0808 C                     ENDSR
0809 C********************************************************************
0810 C/EJECT
0811 C********************************************************************
0812 C* SUBROUTINE TO GET COUNTERPARTY/NOSTRO INFOMATION
0813 C           CPNOST    BEGSR                           *** CPNOST ***
0814 C                     MOVE BLNK55    COUNOS
0815 C******     CNOSKY    CHAINTABLE                67                   S01194
     C*                                                                   S01194
     C/COPY WNCPYSRC,DL0312C002
     C                     CALL 'AOCNSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM COUNTN    @ARCD   8                       S01194
     C           SDCNST    PARM SDCNST    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVELMESS,4    @CPNM                           S01194
     C/COPY WNCPYSRC,DL0312C001
     C                     ELSE                                           S01194
     C                     MOVE AWCPNM    @CPNM                           S01194
     C                     MOVE AWCNTN    @CPTN                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
0816 C***67                MOVELMESS,4    CPNM                            S01194
0817 C                     ENDSR
0818 C********************************************************************
0819 C/SPACE 3
0820 C********************************************************************
0821 C* SUBROUNTINE TO SETUP CLIENT INFOMATION FROM THE 1ST CLIENT RECORD
0822 C           CLIEN1    BEGSR                           *** CLIEN1 ***
0823 C                     MOVE BLNK65    NAMTWN
0824 C**********           MOVE BLNK24    SWCH                            S01429
0824 C                     MOVE BLNK25    SWCH                            S01429
0825 C***                  MOVE 'A'       CLIKEY                          S01194
0826 C***        CLIKEY    CHAINCLINT                67                   S01194
     C*                                                                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CNUMK     @KEY1                           S01194
     C                     PARM *BLANK    @KYST                           S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
0827 C                     MOVELMESS,2    @CNA1                           S01194
0828 C                     MOVELMESS,2    @CTWN                           S01194
0828 C                     MOVELMESS,2    @CRNM                           S01194
     C                     MOVELMESS,2    BBCNA1                          S01374
     C                     MOVE *BLANKS   BBCNA2                          S01374
     C                     MOVE *BLANKS   BBCNA3                          S01374
     C                     MOVE *BLANKS   BBCNA4                          S01374
     C                     SETON                     67                   BHF590
     C                     ELSE                                           S01194
     C                     MOVE BBCNA1    @CNA1                           S01194
     C                     MOVE BBCRTN    @CTWN                           S01194
     C                     MOVE BBCRNM    @CRNM                           S01194
     C**********           MOVE BBCABA    @CHAB                     S01194S01429
     C                     MOVE BBABA2    @CHAB                           S01429
     C                     MOVE BBCHID    @CHID                           S01194
     C                     MOVE BBCSID    @CSID                           S01194
     C                     SETOF                     67                   BHF590
     C                     END                                            S01194
0827 C***67                MOVELMESS,2    CRNM                            S01194
0828 C***67                MOVELMESS,2    CTWN                            S01194
0829 C                     ENDSR
0830 C********************************************************************S01194
0831 C/SPACE 3                                                            S01194
0832 C********************************************************************S01194
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C/COPY WNCPYSRC,DL0312C013
0597 C*****************************************************************   S01194
0833 C* SUBROUTINE TO SETUP CLIENT INFOMATION FROM BOTH RECORDS           S01194
0834 C****       CLIEN2    BEGSR                           *** CLIEN2 *** S01194
0835 C***                  MOVE 'A'       CLIKEY                          S01194
0836 C***        CLIKEY    CHAINCLINT                67                   S01194
0837 C***67                GOTO CLIERR                                    S01194
0838 C***                  MOVE 'B'       CLIKEY                          S01194
0839 C***        CLIKEY    CHAINCLINT                67                   S01194
0840 C***                  MOVE 'A'       CLIKEY                          S01194
0841 C**N67                GOTO CLIEND                                    S01194
0842 C***        CLIERR    TAG                             ** CLIERR TAG**S01194
0843 C***                  MOVE BLNK65    NAMTWN                          S01194
0844 C***                  MOVE BLNK24    SWCH                            S01194
0845 C***                  MOVELMESS,2    CRNM                            S01194
0846 C***                  MOVELMESS,2    CTWN                            S01194
0847 C***                  MOVELMESS,2    CNA1                            S01194
0848 C***        CLIEND    ENDSR                           ** CLIEND TAG**S01194
0849 C********************************************************************S01194
0850 C/EJECT                                                              S01194
0851 C********************************************************************S01194
0852 C**                                                                  S01194
0853 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0854 C**                                                                  S01194
0855 C**         ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0856 C**                                                                  S01194
0857 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0858 C***                  MOVEL'01      'ZTABKY 12                       S01194
0859 C***                  MOVE '  10'    ZTABKY                          S01194
0860 C**                                                                  S01194
0861 C***        ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0862 C***99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0863 C***                                                                 S01194
0864 C***  CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0865 C***        DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0866 C***                                                                 S01194
0867 C***                  ENDSR                                          S01194
0868 C**
0869 C**
0870 C********************************************************************
0871 C/EJECT
0872 O* S T A N D A R D   H E A D E R   L I N E
0873 O***312P1H  203   L1                                          S01124 S01117
0873 O***DL0312P1H**203   L1 77                                           S01117
0873 ODL0312P1H  203   L1                                                 E114
     O/COPY WNCPYSRC,DL0312O004
0874 O****                               22 'REFERENCE DL0312'            S01117
0874 O                                   24 'REFERENCE DL0312P1'          S01117
0875 O                         BJURPT    89                               S01194
0875 O****                     TITL      89                               S01194
0876 O                                  122 'DATE              PAGE'
0877 O                         BJMRDT   112                               S01194
0877 O****                     RUNA     112                               S01194
0878 O                         PAGE  Z  127
0879 O/SPACE 3
0880 O* C O M M O N   H E A D I N G S
0881 O****    H  1     L1                                                 S01117
0881 O********H  1     L1 77                                              S01117
0881 O        H  1     L1                                                 E114
     O/COPY WNCPYSRC,DL0312O005
0882 O                                   40 'IN'
0883 O                                   64 'COMPLETE OTHER PAY TELEX'
0884 O                       54          54 'CHIPS'
0885 O                       55          54 'SWIFT'
0886 O                    52             58 'INCOMPLETE OTHER RECEIVE'
0887 O                    52 54          50 'CHIPS'
0888 O                    52 55          50 'SWIFT'
0889 O****                   53          72 '- LOANS'                     S01194
0890 O***                 45 53          75 '- DEPOSITS'                  S01194
0891 O****                46 53          82 '- FOREIGN EXCHANGE'          S01194
0892 O***********                       124 'EXCEPTION     BRANCH'        S01117
0892 O                                  113 'EXCEPTION    '               S01117
0393 O                 U5               128 'NETTING MODE'                CDL002
0893 O                      N80         113 'NON-EXCEPTION'
0894 ********                  BRCD     128                               S01117
0894 O***********              OSBR     128                               S01117
0895 O********H**1     L1                                                 S01117
0895 O********H  1     L1 77                                              S01117
0895 O        H  1     L1                                                 E114
     O/COPY WNCPYSRC,DL0312O006
0896 O                    52             38 '----'
0897 O                                   64 '------------------------'
0898 O                                   40 '--'
0393 O                 U5               128 '------------'                CDL002
0899 O****                   53          73 '---------'                   S01194
0900 O****                45 53          75 '-----------'                 S01194
0901 O****                46 53          82 '------------------'          S01194
     O********H  2     L1 77                                              S01117
     O        H  2     L1                                                 E114
     O/COPY WNCPYSRC,DL0312O007
     O*********************              12 'BRANCH'                S01117BHF407
     O*********************    OSBR      16                         S01117BHF407
     O                                   18 'BOOKING BRANCH'              BHF407
     O                         BRCA      23                               BHF407
     O****                     BRNM      48                     SO1117    S01194
     O*********************    A8BRNM    48                         S01117BHF407
     O                         A8BRNM    56                               BHF407
0902 O********H**1     L1                                                 S01117
0902 O********H  1     L1 77                                              S01117
0902 O        H  1     L1                                                 E114
     O/COPY WNCPYSRC,DL0312O008
0903 O                                   12 'DESTINATION'
     O/COPY WNCPYSRC,DL0312O001
0904 O                         OURAGN    49
0905 O********H**2     L1                                                 S01117
0905 O********H  2     L1 77                                              S01117
0905 O        H  2     L1                                                 E114
     O/COPY WNCPYSRC,DL0312O009
0906 O                         OURAGT    24
     O                 70 30            115 '** TELEX GENERATED **'
0907 O********H**2     L1                                                 S01117
0907 O********H  2     L1 77                                              S01117
0907 O        H  2     L1                                                 E114
     O/COPY WNCPYSRC,DL0312O010
0908 O                                    5 'TEST:'
0909 O********H**3     L1                                                 S01117
0909 O********H  3     L1 77                                              S01117
0909 O        H  3     L1                                                 E114
     O/COPY WNCPYSRC,DL0312O011
0910 O                                    6 'VALUE'
0911 O                         ZADATE    14
0912 O                    51             30 '   PAY'
0913 O                    52             30 'RECEIVE'
0914 O                         A6CYNM    45                               S01194
0914 O*****                    CCNM      45                               S01194
0915 O                       47          74 'FEDERAL FUNDS'
0916 O                       48          74 'SAME DAY FUNDS'
0917 O********H**1     L1                                                 S01117
0917 O********H  1     L1 77                                              S01117
0917 O        H  1     L1                                                 E114
     O/COPY WNCPYSRC,DL0312O012
0918 O                       51          10 'PAY TO'
0919 O                                   50 'ACCOUNT OF'
0920 O                       52          52 'RECEIVE FROM'
0921 O                                   87 'BY ORDER OF'
0922 O                                  102 'REF.'
0923 O                                  126 'AMOUNT'
0924 O********H**2     L1                                                 S01117
0924 O********H  2     L1 77                                              S01117
0924 O        H  2     L1                                                 E114
     O/COPY WNCPYSRC,DL0312O013
0925 O                       51          10 '------'
0926 O                       51          10 '------'
0927 O                                   50 '----------'
0928 O                       52          52 '--'
0929 O                                   87 '-----------'
0930 O                                  102 '----'
0931 O                                  126 '------'
0932 O* P A Y   T E L E X E S
0933 O********D**2     01 51                                              S01117
0933 O********D  2     01 51 77                                           S01117
0933 O        D  2     01 51                                              E114
     O/COPY WNCPYSRC,DL0312O014
0934 O                 55      TSWADR    12
0935 O**********       54      TCHABA     3                               S01429
0935 O                 54      TCHABA     4                               S01429
0936 O                 54      TCHID     45
     O/COPY WNCPYSRC,DL0312O002
0937 O********D**1     01 51                                              S01117
0937 O********D  1     01 51 77                                           S01117
0937 O        D  1     01 51                                              E114
     O/COPY WNCPYSRC,DL0312O015
0938 O                         THEIRN    35
0939 O                      N49BENAME    71
0940 O**********             49BBCRNM    56                         S01194S01273
0941 O**********               BBCRNM    92                         S01194S01273
     O                       49BBCNA1    71                               S01273
     O****************         BBCNA1   107                         S01273BHF494
     O                         BBCRNM    92                               BHF494
0940 O****                   49CRNM      56                               S01194
0941 O****                     CRNM      92                               S01194
0942 ********                  DLNO     103                               S01117
0942 O                         DLNO     101                               S01117
0942 O                                  102 '/'                           S01117
0942 O***********              BRCD     105                               S01117
0942 O                         BRCA     105                               S01117
0943 O                       60EAMT     126 ' ,   ,   ,   , 0 -'
0944 O                       61EAMT     128 '   ,   ,   , 0 . -'
0945 O                       62EAMT     129 '  ,   ,   , 0 .  -'
0946 O                       63EAMT     130 ' ,   ,   , 0 .   -'
0947 O********D**2     01 51                                              S01117
0947 O********D  2     01 51 77                                           S01117
0947 O********D* 2     01 51                                          E114S01273
0947 O        D  1     01 51                                              E114
     O/COPY WNCPYSRC,DL0312O016
0948 O                         THEIRT    20
0949 O                      N49BETOWN    56
0950 O**********             49BBCRTN    46                         S01194S01273
0951 O**********               BBCRTN    82                         S01194S01273
     O                       49BBCNA2    71                               S01273
     O                         BBCNA2   107                               S01273
     O                 U5               115 'NET REF'                     CDL002
     O        D  1     01 51                                              S01273
     O/COPY WNCPYSRC,DL0312O017
     O                 49      BBCNA3    71                               S01273
     O                         BBCNA3   107                               S01273
     O                 U5      NTRF     127                               CDL002
     O        D  1     01 51                                              S01273
     O/COPY WNCPYSRC,DL0312O018
     O                 49      BBCNA4    71                               S01273
     O                         BBCNA4   107                               S01273
0950 O***                    49CTWN      46                               S01194
0951 O***                      CTWN      82                               S01194
0952 O********D**3     01 51                                              S01117
0952 O********D  3     01 51 77                                           S01117
0952 O        D  3     01 51                                              E114
     O/COPY WNCPYSRC,DL0312O019
0953 O                      N21          34 'SPEC. INSTR.'
     O                    32N21          34 'BENEF. BANK '
0954 O                      N21SPI       72
0955 O* R E C E I V E   T E L E X E S
0956 O********D**2     01 52                                              S01117
0956 O********D  2     01 52 77                                           S01117
0956 O        D  2     01 52                                              E114
     O/COPY WNCPYSRC,DL0312O020
0957 O                 55      TSWADR    48
0958 O                 54      TCHABA    48
     O/COPY WNCPYSRC,DL0312O003
0959 O********D**1     01 52                                              S01117
0959 O********D  1     01 52 77                                           S01117
0959 O        D  1     01 52                                              E114
     O/COPY WNCPYSRC,DL0312O021
0960 O                         THEIRN    71
     O**********               BBCRNM    92                               S01273
     O*****************        BBCNA1   107                         S01273BHF494
     O                         BBCRNM    92                               BHF494
0962 ********                  DLNO     103                               S01117
0942 O                         DLNO     101                               S01117
0942 O                                  102 '/'                           S01117
0942 O***********              BRCD     105                               S01117
0942 O                         BRCA     105                               S01117
0963 O                       60EAMT     126 ' ,   ,   ,   , 0 -'
0964 O                       61EAMT     128 '   ,   ,   , 0 . -'
0965 O                       62EAMT     129 '  ,   ,   , 0 .  -'
0966 O                       63EAMT     130 ' ,   ,   , 0 .   -'
0967 O********D**3     01 52                                              S01117
0967 O********D  3     01 52 77                                           S01117
0967 O********D* 3     01 52                                          E114S01273
0967 O        D  1     01 52                                              S01273
     O/COPY WNCPYSRC,DL0312O022
0968 O                         THEIRT    56
     O**********               BBCRTN    82                         S01194S01273
     O                         BBCNA2   107                               S01273
     O                 U5               115 'NET REF'                     CDL002
     O        D  1     01 52                                              S01273
     O/COPY WNCPYSRC,DL0312O023
     O                         BBCNA3   107                               S01273
     O                 U5      NTRF     127                               CDL002
     O        D  1     01 52                                              S01273
     O/COPY WNCPYSRC,DL0312O024
     O                         BBCNA4   107                               S01273
0969 O***                      CTWN      82                               S01194
     O*                                                                   S01117
     O********T 3      L8 77                                              S01117
     O        T 3      L8 78                                              E114
     O/COPY WNCPYSRC,DL0312O025
     O                                   65 '*** END OF REPORT '          S01117
     O********                           78 'FOR BRANCH ***'       S01117 LN0219
     O                                   79 'FOR BRANCH ***'              LN0219
     O********                           66 '*** END OF BRANCH '          S01117
     O********                           76 'REPORT ***'                  S01117
0970 O*
0971 O*
0972 O********T** 59   L1 41                                              S01117
0972 O********T   59   L1 41 77                                           S01117
0972 O        T   59   L1 41 78                                           E114
     O/COPY WNCPYSRC,DL0312O026
0973 O                                   10 'TEST TOTAL'
0974 O                         TESTOT1B  32
0975 O*
0976 O*
0977 O* C O N T R O L S
0978 O********T  203   LR                                                 S01117
0978 ODL0312AUT  203   LR                                                 S01117
0979 O********                           22 'REFERENCE DL0312'            S01117
0979 O                                   24 'REFERENCE DL0312AU'          S01117
0980 O                         BJURPT    89                               S01194
0980 O****                     TITL      89                               S01194
0981 O                                  122 'DATE              PAGE'
0982 O                         BJMRDT   112                               S01194
0982 O****                     RUNA     112                               S01194
0983 O***********              PAGE  Z  127                               S01117
0983 O                         PAGE1 Z  127                               S01117
0984 O        T  1     LR
0985 O                                   46 'INCOMPLETE'
0986 O                                   71 'PAY/RECEIVE TELEXES - FI'
0987 O                                   88 'LE CONTROL REPORT'
0988 O                                  113 'EXCEPTION'
0989 O                      N80         113 'NON-EXCEPTION'
0393 O                 U5               128 'NETTING MODE'                CDL002
0990 O        T  3     LR
0991 O                                   47 '-----------'
0992 O                                   71 '------------------------'
0993 O                                   88 '-----------------'
0393 O                 U5               128 '------------'                CDL002
0994 O        T  1     LR
0995 O                                   29 'S/PRSX2 - RUN CONTROLS'
0996 O                                   59 'NUMBER'
0997 O                                   84 'VALUE'
0998 O        T  2     LR
0999 O                                   29 '----------------------'
1000 O                                   59 'OF RECORDS'
1001 O                                   84 'OF RECORDS'
1002 O        T  2     LR
1003 O                                   31 'TOTAL RECORDS - ON FILE'
1004 O                         NORE  3   59
1005 O                         HRWN  Z   81
1006 O                         HRDC      84
1007 O        T  3     LR
1008 O                                   32 'TOTAL RECORDS - CALCULAT'
1009 O                                   34 'ED'
1010 O                         RECIN 3   59
1011 O                         ZZTOTIZ   81
1012 O                         ZZTOTD    84
1013 O                 U8               118 '***   DIFFERENCE   ***'
     O        T  3     LR 25
     O                                   27 'TOTAL TELEX RECORDS'
     O                         TOTLX Z   59
     C*                                                                   S01117
     O        T 3      LRNU7N78                                           S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
1014 O********T 33     LR U7                                              S01117
1015 O********************************** 71 '*** DATABASE ERROR ***'      S01117
     O        T 3      LR U7                                              S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7                                              S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7                                              S01117
     O                                   46 'KEY'                         S01117
     O                         DBOPTN    54                               S01117
1016 O********T*3   60 LR                                                 E299
1017 O***********************************71 '*** END OF REPORT ***'       E299
     O*
     O*   T E L E X   M O D U L E   I N T E R F A C E
     O*
     OPRTLXDT DADD     70 01 30
     O                                    1 'D'
     O*****                    BRCD       4                               S01117
     O                         BRCA       4                               S01117
     O                         NOSTRO    10
     O                         DTYP      12
     O                         ZDAY      14
     O                         ZMTH      16
     O                         ZYEAR     18
     O                         CCY       21
     O                         DLNO      27
     O                         PYRC      28
     O                                   29 'I'
     O                                   30 'D'
     O                         FFIN      31
     O                         A6CYNM    45                               S01194
     O                         A6NBDP    46                               S01194
     O****                     CCNM      45                               S01194
     O****                     CDP       46                               S01194
     O                         EAMT      53P
     O                         BJMRDT    60                               S01194
     O****                     RUNA      60                               S01194
     O                         RP31T    115
     O                 51      BBCRNM   135                               S01194
     O                 51      BBCRTN   160                               S01194
     O***              51      CRNM     135                               S01194
     O***              51      CTWN     160                               S01194
     O                 51N49   RP41     170
     O                         BBCRNM   190                               S01194
     O                         BBCRTN   200                               S01194
     O***                      CRNM     190                               S01194
     O***                      CTWN     200                               S01194
     O                         SPI      235
     O****                     BRCD     303                               S01117
     O                         BRCA     303                               S01117
     O                         NSNO     305                               S01135
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  MESS
NOSTRO MISSING
CLIENT MISSING
CUR.NOT FOUND
COUNTERPARTY/NOSTRO MISSING
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
     X/COPY WNCPYSRC,DL0312X001
