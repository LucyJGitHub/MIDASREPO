     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Internal Settlements Report')
0002 F********************************************************************
     F*  Midas - Dealing Module
0004 F*                                                                  *
0005 F*       DL0318  -  INTERNAL SETTLEMENTS REPORT                     *
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL025             Date 27Jan05               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 10Mar99               *
      *                    CTI002 Exposure Management / TI Interface  *
     F*                    CEU003             DATE: 28MAR98              *
     F*                    124760             DATE: 03FEB98              *
     F*                  : CDL002             DATE: 04APR97
     F*                  : S01408             DATE: 27SEP96
     F*                  : 068941             DATE: 25OCT94
     F*                  : 047225             DATE: 09NOV92
     F*                  : BHF408             DATE: 13AUG90
     F*                  : E331               DATE: 19APR90
     F*                  : E14417             DATE: 17APR90              *
     F*                  : E299               DATE: 04APR90              *
     F*                  : E264               DATE: 03APR90              *
     F*                  : E114               DATE: 17NOV89              *
     F*                  : S01194             DATE: 07/03/89             *
     F*                  : S01117             DATE  06/03/89             *
0008 F*                                                                  *
0010 F********************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL025 - FX Netting Payment Generation (Recompile)           *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  CSD005 - Addition of Standing Data Account Narrative field   *
     F*           on condition of switchable feature CSD005 to        *
     F*           replace current account name/description.           *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*  CEU003 - EMU Dealing Settlement Ccy conversion - Recompile   *
     F*           only.                                               *
     F*  124760 - Missing header details and page numbering are       *
     F*           inccorect on PRTF/DL0318P1.  Fix is to set on       *
     F*           *INOF after opening the printer file.               *
     F*  CDL002 - FX Netting                                          *
     F*  S01408 - Addition of core Hook DL0318CCP2                    *
     F*           Addition of core Hook DL0318CCP1                    *
     F*           Addition of core Hook DL0318FFP1                    *
     F*           Addition of core Hook DL0318OOP3                    *
     F*           Addition of core Hook DL0318OOP2                    *
     F*           Addition of core Hook DL0318OOP1                    *
     F*  068941 - Audit report page number printed incorrectly        *
     F*  E47225 - CONDITION CALL TO AORETLR0 ON RETAIL BEING PRESENT  *
     F*  BHF408 - RPT SHOULD BE KEYED BY BKG BRANCH AND HAVE SETTLEMENT
     F*           BRANCH AS THE ACCOUNT KEY.                          *
     F*  E331   - MUST LOCK DATA AREA LDA WHEN USING IN OPERATION     *
     F*  E14417 - ADDITION OF CODE TO ENSURE CORRECT CUSTOMER         *E14417
     F*           PRINTED FOR FX DEAL WITH SETTLE. TYPE '05'.         *E14417
     F*  E299   - 'AU' REPORT SHOULD NOT WRITE 'END OF REPORT'        *
0008 F*  E264   - SHOULD RECEIVE SEQ. NO. AND PASS TO ZSFILE          *
0008 F*  E114/S01117 RELEASE 10 REPORT NOT SELECTABLE ON ENTITY       *
     F*  S01194 - INCORPORATION OF NEW STANDING DATA FILES VIA A/O    *
     F*           N.B FIELD PRID IS RESERVED FOR CHASE MANHAT & IS    *
     F*           NOT SUPPORTED BY NEW SD FILES. HENCE ALL CODING     *
     F*           RELATING TO THIS FIELD HAS BEEN REMOVED             *
     F*                                                               *
     F*  S01117 - MULTIBRANCHING                                      *
     F*****************************************************************
0011 F/SPACE 3
0012 FPRSX4   IP  E           K        DISK
0013 F***LE   IF  F      96 12AI     2 DISK                               S01194
0014 F***ACNUM** IF  F      32 10AI     2 DISK                           U1                   CGL029
     FACNUM   IF  F      33 10AI     2 DISK                           U1                      CGL029
     F*L0318P1O** F     132     OF     PRINTER                            S01117
     FDL0318P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     FDL0318AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0318FFP1                                           S01408
     F*                                                                   S01408
0016 F/SPACE 3
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            LF/PRSX4 - DETAIL
0019 F* 02                    - TRAILER
     F* 03            S/ACNUM LIVE ACCOUNT
     F* 04            S/ACNUM CLOSED RETAIL ACCOUNT
     F*      N14     P1 NOT OPENED/WRITTEN TO SO 'NO DETAILS TO REPORT'   S01117
0020 F* 41            CATCHALL FOR LF/TABLE AND LF/ACNUM  NB.CHAIN FAILURE
0021 F*    20         SETTLEMENT TYPE NULL
0022 F*    21         AMOUNT NEGATIVE
0023 F*****30*********DATABASE*ERROR*-*NO*TAB/I3***********               S01194
0024 F*****31************************-*NO*TAB/I5***********               S01194
0025 F*****32************************-*NO*A/C*CODE*REC*****               S01194
0026 F*****33************************-*NO*ACNUM*RECORD*****               S01194
0027 F*    38         FED FUNDS IND. IS 1
0028 F*    39         FED FUNDS IND. IS 2
0042 F*       37      CONDITION OUTPUT TO DL0318P1                        S01117
0029 F*       40      1ST CYCLE IND.
0030 F*       41      CHAIN FAILURE
0031 F*       50      PRODUCT BREAKDOWN
0032 F*       51      SETTLEMENT TYPE - 01 02 07 08 OR 12
0033 F*       52                      - 03
0034 F*       53                      - 06
0035 F*       54                      - 05
0036 F*       55                      - 14
0037 F*       56                      - 04
0038 F*       60      DEC. PLACES - 0
0039 F*       61                    1
0040 F*       62                    2
0041 F*       63                    3
0042 F*       69      NO DETAIL RECORDS
0043 F*       70      PRODUCT TYPE - 0
0044 F*       71                     1
0045 F*       72                     2
0046 F*       73      CREDIT
0047 F*       74      DEBIT
     F*       75      SWITCHABLE FEATURE= ACCOUNT NARRATIVE               CSD005
0048 F*       80      ROLLOVER/CAPITALISATION IND - 0
0049 F*       81                                    1
0050 F*       82                                    2
0051 F*       83                                    3
     F*       U5      NETTING MODE                                        CDL002
     E                    CPY@    1   1 80
0052 E                    MESS    1   1 14               CURRENCY NOT FOUN
0053 E                    TABTYP  5   5  2 0A            5 SETTLEMENT TYPE
0054 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0055 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0056 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0057 E/EJECT
0058 I* LF/PRSX4 DETAIL RECORD
0059 IPREXPHF     01
0060 I                                              PYRC  L5
0061 I                                              SETP            20
0062 I                                              PROD  L4
0063 I                                              CCY   L3
0065 I                                              FFIN  L2
0066 I                                              VDAT  L1
0070 I                                              EAMT          21
0081 I********                                      BRCD  L6              S01117
0081 I*******************************************   OSBR  L6        S01117BHF408
     I                                              BRCA  L6              BHF408
0084 I*
0085 I* TRAILER
0086 IPREXZZF     02
0090 I*
0094 I********LE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0095 I***                                                                 S01194
0096 I***LE   NS       2 C0   3 C1  12 C1                                 S01194
0097 I***    AND      13 C0                                               S01194
0098 I***                                     1   1 RECI                  S01194
0099 I***                                     2   30RECT                  S01194
0100 I***                                    12  130RCDE                  S01194
0101 I***                                    14  66 TITL                  S01194
0102 I***                                    67  67 DATF                  S01194
0103 I***                                    68  700DFBR                  S01194
0104 I***                                    74  74 MODI1                 S01194
0105 I***                                    75  75 MODI2                 S01194
0106 I***                                    76  76 MODI3                 S01194
0107 I***                                 P  77  790RUND                  S01194
0108 I***                                    80  86 RUNA                  S01194
0109 I***                                    87  870SFLG                  S01194
0110 I***                                 P  90  920LCD                   S01194
0111 I***                                    93  93 CHTP                  S01194
0112 I***                                 P  94  960TNLU                  S01194
0113 I****                                                                S01194
0114 I*******BLE FILE - INSTALLATION CONTROL DATA RECORD 3.               S01194
0115 I***                                                                 S01194
0116 I***LE   NS       1 CD   2 C0   3 C1                                 S01194
0117 I***    AND      12 C2  13 C0                                        S01194
0118 I***                                     1   1 RECI                  S01194
0119 I***                                     2   30RECT                  S01194
0120 I***                                    12  130RCDE                  S01194
0121 I***                                    14  170COMS                  S01194
0122 I***                                    18  210CADC                  S01194
0123 I***                                 P  22  240MDIC                  S01194
0124 I***                                 P  25  270MCIC                  S01194
0125 I***                                 P  28  300MDIA                  S01194
0126 I***                                 P  31  330MCIA                  S01194
0127 I***                                    34  370SRPL                  S01194
0128 I***                                    38  410SPAC                  S01194
0129 I***                                    42  450SWAC                  S01194
0130 I***                                    46  490FTAC                  S01194
0131 I***                                    50  530TAC4                  S01194
0132 I***                                    54  570TAC5                  S01194
0133 I***                                 P  63  650NOBA                  S01194
0134 I***                                 P  66  680TSIZ                  S01194
0135 I***                                    69  69 RACN                  S01194
0136 I***                                    70  700GLSI                  S01194
0137 I***                                    71  710RTSI                  S01194
0138 I***                                    72  720DLSI                  S01194
0139 I***                                    73  730NOSI                  S01194
0140 I***                                    74  740CTSI                  S01194
0141 I***                                 P  75  770ELAC                  S01194
0142 I***                                 P  78  800ECAC                  S01194
0143 I***                                 P  90  920LCD                   S01194
0144 I***                                    93  93 CHTP                  S01194
0145 I***                                 P  94  960TNLU                  S01194
0146 I***                                                                 S01194
0147 I***  TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.               S01194
0148 I****                                                                S01194
0149 I***LE   NS       1 CD   2 C0   3 C1                                 S01194
0150 I***    AND      12 C4  13 C0                                        S01194
0151 I***                                     1   1 RECI                  S01194
0152 I****                                    2   30RECT                  S01194
0153 I***                                    12  130RCDE                  S01194
0154 I***                                    18  210CSAC                  S01194
0155 I***                                    22  22 TLII                  S01194
0156 I***                                    23  23 MCRI                  S01194
0157 I***                                 P  24  250MCEP                  S01194
0158 I***                                    26  270MCLP                  S01194
0159 I***                                    28  28 FRDI                  S01194
0160 I***                                    29  29 BRCF                  S01194
0161 I***                                    30  350PSCN                  S01194
0162 I***                                    36  380DLBR                  S01194
0163 I***                                    39  420FRPA                  S01194
0164 I***                                    43  460FRPC                  S01194
0165 I****                                   47  49 USCY                  S01194
0166 I***                                    50  52 STCY                  S01194
0167 I***                                 P  53  553MBGE                  S01194
0168 I***                                    56  56 PRID                  S01194
0169 I***                                    57  57 FFNY                  S01194
0170 I***                                    58  58 OURC                  S01194
0171 I***                                    59  59 BRNC                  S01194
0172 I***                                    60  60 LCYN                  S01194
0173 I***                                 P  90  920LCD                   S01194
0174 I***                                    93  93 CHTP                  S01194
0175 I***                                 P  94  960TNLU                  S01194
0176 I***                                                                 S01194
0177 I***  TABLE FILE - ACCOUNT CODES RECORD 1.                           S01194
0178 I***                                                                 S01194
0179 I***LE   NS       1 CD   2 C3   3 C0                                 S01194
0180 I***    AND      13 C1                                               S01194
0181 I***                                     1   1 RECI                  S01194
0182 I***                                     2   30RECT                  S01194
0183 I***                                     9  120ACOD                  S01194
0184 I***                                    13  130SREC                  S01194
0185 I***                                    14  38 ACKN                  S01194
0186 I***                                    39  39 ATYP                  S01194
0187 I***                                 P  40  420SHLC                  S01194
0188 I***                                 P  43  450SHFC                  S01194
0189 I***                                    48  48 TITO                  S01194
0190 I***                                    49  520BSDR                  S01194
0191 I***                                    53  560BSCR                  S01194
0192 I***                                    57  600PLDR                  S01194
0193 I***                                    61  640PLCR                  S01194
0194 I***                                    65  740RPCD                  S01194
0195 I***                                    75  76 ACCS                  S01194
0196 I***                                    77  77 STYP                  S01194
0197 I***                                 P  90  920LCD                   S01194
0198 I***                                    93  93 CHTP                  S01194
0199 I***                                 P  94  960TNLU                  S01194
0200 I***                                                                 S01194
0201 I***  TABLE FILE - CURRENCIES RECORD 1.                              S01194
0202 I***                                                                 S01194
0203 I***LE   NS       1 CD   2 C2   3 C0                                 S01194
0204 I***    AND      13 C1                                               S01194
0205 I***                                     1   1 RECI                  S01194
0206 I***                                     2   30RECT                  S01194
0207 I***                                    10  12 CCY                   S01194
0208 I***                                    13  130SREC                  S01194
0209 I***                                    14  27 CCNM                  S01194
0210 I***                                 P  28  348SPOT                  S01194
0211 I***                                    35  37 CCYS                  S01194
0212 I***                                    38  380CDP                   S01194
0213 I***                                    39  390TNOT                  S01194
0214 I***                                    40  40 DCCY                  S01194
0215 I***                                    41  44 SRC1                  S01194
0216 I****                                   45  48 SRC2                  S01194
0217 I***                                    49  520TACC                  S01194
0218 I***                                    53  560TEQV                  S01194
0219 I***                                    57  600SWQV                  S01194
0220 I***                                    61  640TAC4                  S01194
0221 I***                                    65  680TAC5                  S01194
0222 I***                                    69  69 HIND                  S01194
0223 I***                                 P  70  768PART                  S01194
0224 I***                                    77  780SSNO                  S01194
0225 I***                                 P  79  858ERLC                  S01194
0226 I***                                 P  90  920LCD                   S01194
0227 I***                                    93  93 CHTP                  S01194
0228 I***                                 P  94  960TNLU                  S01194
0229 I***                                                                 S01194
0230 I****TCHALL                                                          S01194
0231 I***     NS  41                                                      S01194
0232 I****                                                                S01194
0233 I* RETAIL ACCOUNT NUMBERS DETAIL RECORD
0234 I*
0235 IACNUM   NS  03   1 CD
     I       OR   04   1 CC
0236 I                                        1   1 RECI
0237 I                                        2  110ACNO
0238 I**********                             12  170CNUM                                      CSD027
0238 I                                       12  17 CNUM                                      CSD027
0239 I                                       18  20 CCY
0240 I**********                             21  240ACOD                                      CGL029
0241 I**********                             25  26 ACSQ                                      CGL029
0242 I**********                             27  27 ACST                                      CGL029
     I                                       21  300ACOD                                      CGL029
     I                                       31  32 ACSQ                                      CGL029
     I                                       33  33 ACST                                      CGL029
0245 I*
0246 I* CATCHALL
0247 I        NS  41
 542 I*
0543 I** LOCAL DATA AREA TO IDENTIFY DATABASE ERRORS
 544 I*
0545 ILDA        UDS                            256
0546 I***                                   134 138 DBFILE                S01194
0547 I***                                   139 167 DBKEY                 S01194
0548 I***                                   168 175 DBPGM                 S01194
0549 I***                                   176 1770DBASE                 S01194
0546 I                                      134 141 DBFILE                S01194
0547 I                                      142 170 DBKEY                 S01194
0548 I                                      171 180 DBPGM                 S01194
0549 I                                      181 1830DBASE                 S01194
0248 I/EJECT
0249 I* D A T A   S T R U C T U R E S
0250 I*
0251 IOSAC        DS
0252 I                                        1   2 NOSNO
0253 I**********                              7  100ACOD                                      CGL029
0254 I**********                             11  12 ACSQ                                      CGL029
     I                                        7  160ACOD                                      CGL029
     I                                       17  18 ACSQ                                      CGL029
0255 I                                        1  10 RETNO
0256 I************LES FILE FOR ACCOUNT CODES                              S01194
0257 I****        DS                                                      S01194
0258 I****                                    1  12 ZTABKY                S01194
0259 I***                                     1   2 CODE                  S01194
0260 I***                                     8  11 ACODE                 S01194
0261 I***                                    12  12 SUBTYP                S01194
0262 I***********BLES FILE FOR CURRENCIES                                 S01194
0263 I***         DS                                                      S01194
0264 I***                                     1  12 CURKEY                S01194
0265 I***                                     1   2 TYPE                  S01194
0266 I***                                     9  11 CCY                   S01194
0267 I***                                    12  12 SRECT                 S01194
0268 I/EJECT
     I********************************************************************S01117
     I*                                                                   S01117
     ISPOOL       DS                                                      S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01194
     I* DATA STRUCTURES FOR USE WITH ACCESS OBJECTS                       S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              E47225
     I*                                                                   E47225
     ISDBANK    E DSSDBANKPD                                              S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I*                                                                   S01194
     ISDRETL    E DSSDRETLPD                                              S01194
     I              QQACCD                          QQACCX                                    CGL029
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I              QQACCD                          QQACCY                                    CGL029
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I*                                                                   S01194
     ISDACOD    E DSSDACODPD                                              S01194
     I              QQACCD                          QQACCZ                                    CGL029
     I*
     I*                                                                   CSD005
     ISCSARD    E DSSCSARDPD                                              CSD005
     I* Switchable Features File Details                                  CSD005
      *                                                                   CSD005
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0269 I/EJECT                                                              S01117
     C********   *ENTRY    PLIST                                          E114
     C********             PARM           SEQ     5                       E114
     C********             PARM           BRNCH   3                       E114
     C*                                                                   E264
     C           *ENTRY    PLIST                                          E264
     C                     PARM           SEQ     5                       E264
     C*                                                                   S01117
0269 C* 1 S T   C Y C L E   P R O C E S S I N G  - H E A D E R  R E A D
0270 C   40                GOTO START
     C                     MOVEACPY@      BIS@   80
     C**
     C** FOR DATABASE ERROR REFERENCE
     C**
     C                     MOVE 'DL0318  'DBPGM
     C                     MOVE ' '       BLANKS 29
     C                     MOVE BLANKS    DBKEY
     C           *NAMVAR   DEFN           LDA
     C**********           IN   LDA                                       E47225
     C           *LOCK     IN   LDA                                       E47225
     C*
0271 C                     SETON                     40
0272 C                     Z-ADD2         RECIN   50
0273 C*****                EXSR ZSYSTM                                    S01194
     C*                                                                   E47225
     C* CALL A/O AOMMODR0                                                 E47225
     C*                                                                   E47225
     C                     CALL 'AOMMODR0'                                E47225
     C                     PARM '*MSG   ' @RTCD   7                       E47225
     C                     PARM '*FIRST ' @OPTN   7                       E47225
     C           SDMMOD    PARM SDMMOD    DSFDY                           E47225
     C*                                                                   E47225
     C           @RTCD     IFNE *BLANK                                    E47225
     C                     MOVE '1'       *INLR                           E47225
     C                     MOVE '1'       *INU7                           E47225
     C                     MOVEL'SDMMODPD'DBFILE           ************   E47225
     C                     MOVEL'101'     DBASE            * DBERR 101*   E47225
     C                     MOVEL@OPTN     DBOPTN           ************   E47225
     C                     END                                            E47225
     C*                                                                   S01194
     C* CALL A/O AOBANKR0                                                 S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     MOVE '01'      DBASE            ************   S01194
     C                     MOVE '1'       *INU7            * DBERR 01 *   S01194
     C                     MOVE '1'       *INLR            ************   S01194
     C                     ELSE                                           S01194
     C*                                                                   S01194
0864 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C*                                                                   S01194
0865 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C                     END                                            S01194
     C*                                                                   S01194
0274 C***                  MOVE '20'      ZTABKY                          S01194
0275 C***                  EXSR TABCH1                                    S01194
     C***41                SETON                     LRU730               S01194
     C***41                MOVE '01'      DBASE                           S01194
     C***41                MOVELZTABKY    DBKEY                           S01194
     C***41                MOVE 'TABLE'   DBFILE                          S01194
     C*                                                                   S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDGELRPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     MOVE '02'      DBASE            * DBERR 02 *   S01194
     C                     MOVE '1'       *INU7            ************   S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           BGRTBN    IFEQ 'Y'                                       E47225
     C           BGIOAC    OREQ 'Y'                                       E47225
     C                     CALL 'AORETLR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDRETLPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     MOVE '04'      DBASE            * DBERR 04 *   S01194
     C                     MOVE '1'       *INU7            ************   S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     END                                            S01194
     C                     END                                            E47225
     C*                                                                   S01194
0277 C****                 MOVE '40'      ZTABKY                          S01194
0278 C****                 EXSR TABCH1                                    S01194
     C***41                SETON                     LRU731               S01194
     C***41                MOVE '02'      DBASE                           S01194
     C***41                MOVELZTABKY    DBKEY                           S01194
     C***41                MOVE 'TABLE'   DBFILE                          S01194
     C*                                                                   S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDTRADPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     MOVE '05'      DBASE            * DBERR 05 *   S01194
     C                     MOVE '1'       *INU7            ************   S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     END                                            S01194
      *                                                                   CSD005
      *** Obtain switchable feature CSD005 status.                        CSD005
      *                                                                   CSD005
     C                     CALL 'AOSARDR0'                                CSD005
     C                     PARM *BLANKS   @RTCD   7                       CSD005
     C                     PARM '*VERIFY' @OPTN   7                       CSD005
     C                     PARM 'CSD005'  @SARD   6                       CSD005
     C           SCSARD    PARM SCSARD    DSFDY                           CSD005
      *                                                                   CSD005
     C                     SELEC                                          CSD005
     C           @RTCD     WHEQ *BLANK                                    CSD005
     C                     MOVE *ON       *IN75                           CSD005
     C           @RTCD     WHEQ '*NRF'                                    CSD005
     C                     MOVE *OFF      *IN75                           CSD005
     C                     OTHER                                          CSD005
      *                                                                   CSD005
      *** Process error                                                   CSD005
      *                                                                   CSD005
     C           *LOCK     IN   LDA                                       CSD005
     C                     MOVEL'SCSARDPD'DBFILE            ************* CSD005
     C                     MOVEL'008'     DBASE             *DBERROR 008* CSD005
     C                     MOVEL@OPTN     DBKEY             ************* CSD005
     C                     SETON                     U7U8LR               CSD005
     C                     OUT  LDA                                       CSD005
     C                     ENDSL                                          CSD005
      *                                                                   CSD005
     C*                                                                   S01194
     C*
0280 C****       PRID      COMP 'Y'                      50               S01194
0281 C***                  MOVE '20'      TYPE                            S01194
0282 C***                  MOVE '1'       SRECT                           S01194
0283 C***                  MOVE '1'       SUBTYP                          S01194
0284 C***                  MOVE '30'      CODE                            S01194
0285 C                     GOTO END
0286 C/SPACE 3
0287 C* M A I N   P R O C E S S I N G
0288 C           START     TAG                             ** START TAG **
0289 C* VALUE DATE CHANGE
0290 C  NL1                GOTO ENDLEV
0291 C                     Z-ADDVDAT      ZDAYNO
0292 C                     EXSR ZDATE2
0293 C* IF CHANGE OF FEDERAL FUNDS IND.
0294 C  NL2                GOTO ENDLEV
0295 C                     SETON                     OF
0296 C           FFIN      COMP 1                    39  38
0297 C* IF CHANGE OF CURRENCY
0299 C  NL3                GOTO ENDLEV
0300 C****                 EXSR TABCH2                                    S01194
0301 C***41                MOVE MESS,1    CCNM                            S01194
0302 C***41                MOVELCCY       CCNM                            S01194
0303 C***41                Z-ADD0         CDP                             S01194
0304 C***        CDP       COMP 1                    626061               S01194
0305 C***        CDP       COMP 2                    63  62               S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CCY       @K101   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE MESS,1    A6CYNM                          S01194
     C                     MOVELCCY       A6CYNM                          S01194
     C                     Z-ADD0         A6NBDP                          S01194
     C                     END                                            S01194
     C*                                                                   S01194
0738 C           A6NBDP    COMP 1                    626061               S01194
0739 C           A6NBDP    COMP 2                    63  62               S01194
0306 C*
0307 C* IF CHANGE OF PRODUCT TYPE
0308 C  NL4                GOTO ENDLEV
0309 C           PROD      COMP 1                    727071
0310 C* IF CHANGE OF PAY/RECEIVE IND
0311 C  NL5                GOTO ENDLEV
0312 C           PYRC      COMP 'P'                  74  73
     C* IF CHANGE OF SETTLEMENT BRANCH                                    S01117
     C           *INL6     IFEQ '1'                                       S01117
     C                     CLOSEDL0318P1                                  S01117
     C********   BRNCH     IFEQ 'ALL'                                     E114
     C********   BRNCH     OREQ OSBR                                      E114
     C********             SETON                     37    ALLOW OUTPUT   E114
     C                     OPEN DL0318P1                                  S01117
     C                     MOVE '1'       *INOF                           124760
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** IF P1 FILE OPENED THEN SET ON FLAG                               S01117
     C                     MOVE '1'       *IN14                           S01117
     C*                                                                   S01117
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C                     CALL 'ZSFILE'
     C*********************PARM *BLANKS   SEQ     5                       E264
     C                     PARM           SEQ     5                       E264
     C******************** PARM OSBR      @PARM                           BHF408
     C                     PARM BRCA      @PARM                           BHF408
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM *BLANK    ZSERR   1                       S01117
     C******               IN   LDA                                       E331
     C           *LOCK     IN   LDA                                       E331
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**
     C***                  MOVEL'10'      BRCKEY 12             S01117    S01194
     C***                  MOVE OSBR      BRCKEY                S01117    S01194
     C***        BRCKEY    CHAINTABLE                41         S01117    S01194
     C***                                                       S01117    S01194
     C***41      RECI      COMP 'D'                  4141       S01117    S01194
     C***41                SETON                     LRU7     * S01117    S01194
     C***41                MOVE '05'      DBASE               *DS01117    S01194
     C***41                MOVE 'TABLE'   DBFILE                S01117    S01194
     C***41                MOVELBRCKEY    DBKEY                 S01117    S01194
     C***41                GOTO END                           * S01117    S01117
     C*                                                                   S01194
     C* CALL A/O                                                          S01194
     C*                                                                   S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C*******************  PARM OSBR      @DSNB   3                 S01194BHF408
     C                     PARM BRCA      @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBRCHPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBOPTN  7                       S01194
     C*******************  MOVE OSBR      DBKEY            ******   S01194BHF408
     C                     MOVE BRCA      DBKEY            ************   S01194
     C                     MOVE '06'      DBASE            * DBERR 06 *   S01194
     C                     MOVE '1'       *INU7            ************   S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C********             ELSE                                           E114
     C********             SETOF                     37                   E114
     C********             END                                            E114
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0318CCP1                                           S01408
     C*                                                                   S01408
     C                     END                                            S01117
     C**                                                                  S01117
0313 C           ENDLEV    TAG                             ** ENDLEV TAG**
0314 C* IF DETAIL
0315 C  N01                GOTO END
0316 C* IF SETTLEMENT TYPE NULL THEN USE '06'
0317 C   20                Z-ADD6         SETP
0318 C* IF ROLLOVER/CAPITALISATION IND TEST
0319 C                     SETOF                     83
0320 C           RCPI      COMP 1                    828081
0321 C   82      RCPI      COMP 2                    83  82
0322 C* IF IND EQ '0'                                      ****
0323 C  N80                GOTO ENDACI                        *
0324 C*                                                       *
0325 C* SET.SETTLEMENT TYPE INDS.                             *
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0318CCP2                                           S01408
     C*                                                                   S01408
0326 C                     SETOF                     525354
0327 C                     SETOF                     5556
0328 C           SETP      LOKUPTABTYP                   51-01*02,07,08,12
0329 C   51                GOTO ENDSET                        *
0330 C           SETP      COMP 03                       52   *
0331 C  N52      SETP      COMP 06                       53   *
0332 C   52                                                   *
0333 COR 53                GOTO ENDSET                        *
0334 C           SETP      COMP 05                       54   *
0335 C  N54      SETP      COMP 14                       55   *
0336 C  N54N55   SETP      COMP 04                       56   *
0337 C           ENDSET    TAG                             ** ENDSET TAG**
0338 C*                                                       *
0339 C* IF SETTLE. TYPE '14'OR '05'                           *
0340 C  N54N55             GOTO ENDACI                        *
0341 C* IF SETTLE. TYPE '14' ONLY                             *
0342 C  N55                GOTO TBCHN1
0343 C           RETNO     CHAINACNUM                41       *
0344 C   41                SETON                     LRU733   *
     C   41                MOVE '03'      DBASE
     C   41                MOVELRETNO     DBKEY
     C   41                MOVE 'ACNUM'   DBFILE
0345 C   U7                GOTO ENDACI                        *
0346 C           TBCHN1    TAG                             ** TBCHN1 TAG**
     C*                                                                   E14417
     C* If Settle. type '05' obtain CNUM from OSAC.                       E14477
     C*                                                                   E14477
     C   54                MOVELOSAC      CNUM                            E14477
     C*                                                                   E14477
0347 C***                  MOVE ACOD      ACODE               *           S01194
0348 C***                  EXSR TABCH1                        *           S01194
0349 C***41                SETON                     LRU732   *           S01194
     C***41                MOVE '04'      DBASE                           S01194
     C***41                MOVELZTABKY    DBKEY                           S01194
     C***41                MOVE 'TABLE'   DBFILE                          S01194
     C*                                                                   S01194
     C                     MOVE ACOD      @AFNB                           S01194
     C*                                                                   S01194
     C                     CALL 'AOACODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C**********           PARM           @AFNB   4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM           @AFNB  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDACODPD'DBFILE           ************   S01194
     C                     MOVEL@OPTN     DBOPTN           * DBERR 07 *   S01194
     C                     MOVE ACOD      DBKEY            ************   S01194
     C                     MOVE '07'      DBASE                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     END                                            S01194
      *                                                                   CSD005
      * Find the account narrative for the account code if the            CSD005
      *  feature CSD005 is active                                         CSD005
      *                                                                   CSD005
     C           *IN75     IFEQ *ON                                       CSD005
      *                                                                   CSD005
     C                     MOVE ACOD      @ACCD                           CSD005
      *                                                                   CSD005
     C                     CALL 'AOACODR0'                                CSD005
     C                     PARM '*BLANK ' @RTCD   7                       CSD005
     C                     PARM '*KEY   ' @OPTN   7                       CSD005
     C**********           PARM           @ACCD   4                                    CSD005 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        CSD005 CGL029
     C                     PARM           @ACCD  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                   CSD005
     C                     SELEC                                          CSD005
     C           @RTCD     WHEQ *BLANKS                                   CSD005
     C                     MOVELA5NARR    W#NARR 39                       CSD005
     C                     OTHER                                          CSD005
      *                                                                   CSD005
     C           *LOCK     IN   LDA                                       CSD005
     C                     MOVEL'SDACODPD'DBFILE            ************* CSD005
     C                     MOVEL'009'     DBASE             *DBERROR 009* CSD005
     C                     MOVEL@OPTN     DBKEY             ************* CSD005
     C                     SETON                     U7U8LR               CSD005
     C                     OUT  LDA                                       CSD005
     C                     ENDSL                                          CSD005
      *                                                                   CSD005
     C                     ENDIF                                          CSD005
      *                                                                   CSD005
     C*                                                                   S01194
0350 C           ENDACI    TAG                                ENDACI TAG**
0351 C*                                                    ****
0352 C* SECTION TOTALS
0353 C           TOTAL     ADD  EAMT      TOTAL  150
0354 C           RECS      ADD  1         RECS    40
0355 C           RECIN     ADD  1         RECIN
0356 C           EAMT      DIV  1000      ZZAMT
0357 C   21                Z-SUBZZAMT     ZZAMT
0358 C                     EXSR GLZADD
0359 C*
0360 C           END       TAG                             **  END TAG  **
0361 C/SPACE 3
0362 CLR         NORE      COMP RECIN                U8U8
0363 CLRNU8      HRWN      COMP ZZTOTI               U8U8
0364 CLRNU8      HRDC      COMP ZZTOTD               U8U8
0365 C* SETON '69' IF NO DETAIL RECORDS
0366 CLR         NORE      COMP 2                        69
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF
     C*                                                                   S01117
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA
     C*                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     C**LR*****************PARM *BLANKS   SEQ     5                S01117 E264
     CLR                   PARM           SEQ     5                       E264
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM *BLANK    ZSERR                           S01117
     C*LR*******           IN   LDA                                       E47225
     CLR         *LOCK     IN   LDA                                       E47225
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*
0367 C/EJECT
0368 C* S U B R O U T I N E S
0369 C*
0370 C********************************************************************
0371 C***        TABCH1    BEGSR                           *** TABCH1 *** S01194
0372 C***        ZTABKY    CHAINTABLE                41                   S01194
0373 C***41      RECI      COMP 'D'                  4141                 S01194
0374 C***                  ENDSR                                          S01194
0375 C********************************************************************
0376 C/SPACE 3
0377 C********************************************************************
0378 C***        TABCH2    BEGSR                           *** TABCH2 *** S01194
0379 C***        CURKEY    CHAINTABLE                41                   S01194
0380 C***41      RECI      COMP 'D'                  4141                 S01194
0381 C***                  ENDSR                                          S01194
0382 C********************************************************************
0383 C/SPACE 3
0384 C********************************************************************
0385 C**
0386 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0387 C**
0388 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0389 C**
0390 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0391 C**
0392 C**   CLEAR DATE FIELDS.
0393 C                     Z-ADD0         ZDATE   60
0394 C                     MOVEL'       ' ZADATE  7
0395 C**
0396 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0397 C                     Z-ADDZDAYNO    ZDAYNO  50
0398 C**
0399 C**   DETERMINE YEAR NUMBER.
0400 C**
0401 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0402 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0403 C   99                GOTO ZDEND2
0404 C**
0405 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0406 C           ZDAYN1    DIV  1461      ZLYR    20
0407 C                     MVR            ZDAYN1           SAVE REMAINING
0408 C**                                                   DAYS
0409 C**   CALCULATE NUMBER OF REMAINING YEARS.
0410 C                     Z-ADD1         ZWRK2   20
0411 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0412 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0413 C  N90      ZWRK2     ADD  1         ZWRK2
0414 C  N90                GOTO ZDTAG1
0415 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0416 C**
0417 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0418 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0419 C**
0420 C**   CALCULATE ACTUAL YEAR NUMBER.
0421 C           ZLYR      MULT 4         ZWRK3   30
0422 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0423 C                     Z-ADDZWRK3     ZYEAR   20
0424 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0425 C**
0426 C**   DETERMINE MONTH NUMBER.
0427 C**
0428 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0429 C                     SETOF                     9293
0430 C   91      ZDAYN1    COMP 59                     9293
0431 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0432 C**
0433 C**   CALCULATE MONTH NUMBER.
0434 C                     Z-ADD2         ZWRK2
0435 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0436 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0437 C  N94      ZWRK2     ADD  1         ZWRK2
0438 C  N94                GOTO ZDTAG2
0439 C           ZWRK2     SUB  1         ZWRK2
0440 C**
0441 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0442 C**
0443 C**   DETERMINE DAY OF MONTH.
0444 C**
0445 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0446 C           ZDAYN1    ADD  1         ZDAYN1
0447 C**
0448 C**   CALCULATE DAY OF MONTH.
0449 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0450 C**
0451 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0452 C   93      ZDAY      ADD  1         ZDAY
0453 C**
0454 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0455 C  N98                MOVELZDAY      ZWRK4   40
0456 C   98                MOVE ZDAY      ZWRK4
0457 C  N98                MOVE ZMTH      ZWRK4
0458 C   98                MOVELZMTH      ZWRK4
0459 C                     MOVELZWRK4     ZDATE
0460 C                     MOVE ZYEAR     ZDATE
0461 C**
0462 C**   FORMAT ALPHA DATE, DDMMMYY.
0463 C           ZDAY      COMP 10                     95
0464 C                     MOVELZDAY      ZWRK5   5
0465 C   95                MOVEL' '       ZWRK5
0466 C                     MOVE ZMNM,ZMTH ZWRK5
0467 C                     MOVELZWRK5     ZADATE
0468 C                     MOVE ZYEAR     ZADATE
0469 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0470 C**
0471 C**
0472 C**
0473 C********************************************************************
0474 C/SPACE 3
0475 C********************************************************************
0476 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0477 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0478 C*
0479 CSR         GLZADD    BEGSR                           *** GLZADD ****
0480 C*
0481 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0482 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0483 C*
0484 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0485 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0486 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0487 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0488 C*
0489 CSR                   EXSR GLZSUM
0490 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0491 C*
0492 C********************************************************************
0493 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0494 C*                        GLZADD, GLZSUB, GLZCMP.
0495 C*          PARAMETERS PASSED -
0496 C*                     I/P ZZAMTI ZZAMTD
0497 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0498 C*
0499 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0500 C*
0501 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0502 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0503 CSR                   SETOF                     919293
0504 CSR                   SETOF                     949599
0505 C*
0506 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0507 CSR         ZZAMTI    COMP 0                      9293
0508 CSR 93      ZZAMTD    COMP 0                      9293
0509 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0510 C*
0511 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0512 CSR         ZZTOTI    COMP 0                      9193
0513 CSR 93      ZZTOTD    COMP 0                      9193
0514 C*
0515 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0516 CSR 93                Z-ADDZZAMTI    ZZTOTI
0517 CSR 93                Z-ADDZZAMTD    ZZTOTD
0518 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0519 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0520 CSR 91N92
0521 CORN91 92             GOTO ZZOFPS
0522 C*
0523 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0524 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0525 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0526 C*
0527 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0528 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0529 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0530 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0531 C*
0532 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0533 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0534 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0535 CSRN99                Z-ADDZZWK2     ZZTOTD
0536 CSRN99                Z-ADDZZWK3     ZZTOTI
0537 C*
0538 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0539 CSR 99                Z-ADD0         ZZAMT  153
0540 CSR                   GOTO ZZSEND
0541 C*
0542 C* THE 'SIGNS' ARE DIFFERENT
0543 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0544 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0545 C*
0546 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0547 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0548 C*
0549 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0550 C*
0551 CSR 91                Z-SUBZZTOTI    ZZTOTI
0552 CSR 91                Z-SUBZZTOTD    ZZTOTD
0553 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0554 C*
0555 CSR         ZZTOTI    COMP ZZAMTI               93  95
0556 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0557 C*
0558 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0559 CSR 95                Z-ADD0         ZZTOTI
0560 CSR 95                Z-ADD0         ZZTOTD
0561 CSR 95                GOTO ZZSEND
0562 C*
0563 C* IF ZZTOT GT. ZZAMT.
0564 CSR 93      ZZAMTD    COMP ZZTOTD               94
0565 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0566 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0567 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0568 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0569 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0570 C*
0571 C*
0572 C* IF ZZAMT GT. ZZTOT.
0573 CSRN93      ZZTOTD    COMP ZZAMTD               94
0574 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0575 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0576 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0577 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0578 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0579 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0580 C*
0581 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0582 CSR                   SETOF                     94
0583 CSR 93 91
0584 CORN93 92             SETON                     94
0585 CSR 94                Z-SUBZZTOTI    ZZTOTI
0586 CSR 94                Z-SUBZZTOTD    ZZTOTD
0587 C**
0588 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0589 CSR 92                Z-SUBZZAMTI    ZZAMTI
0590 CSR 92                Z-SUBZZAMTD    ZZAMTD
0591 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0592 C**
0593 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0594 CSR                   SETOF                     96
0595 CSR         ZZTOTD    COMP 0                        91
0596 CSR 91      ZZTOTI    COMP 0                      96
0597 CSR 96                MOVE '.000-'   ZZNEGD  5
0598 CSR                   ENDSR                             ** ENDSR **
0599 C********************************************************************
0600 C/EJECT
0601 C********************************************************************
0602 C****                                                                S01194
0603 C*********TM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0604 C****                                                                S01194
0605 C***        ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0606 C***                                                                 S01194
0607 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0608 C***                  MOVEL'01      'ZTABKY 12                       S01194
0609 C***                  MOVE '  10'    ZTABKY                          S01194
0610 C***                                                                 S01194
0611 C***        ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0612 C***99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0613 C***                                                                 S01194
0614 C***  CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0615 C***        DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0616 C****                                                                S01194
0617 C****                 ENDSR                                          S01194
0618 C****                                                                S01194
0619 C**
0620 C********************************************************************
0621 C/EJECT
0623 O*****                              22 'REFERENCE DL0318'            S01117
     O*L0318P1H**203   OF                                                 S01117
     O******DL0318P1H  203   OF 37                                        S01117
     ODL0318P1H  203   OF                                                 E114
     O                                   22 'REFERENCE DL0318P1'          S01117
0875 O                         BJURPT    89                               S01194
0875 O****                     TITL      89                               S01194
0625 O                                  122 'DATE              PAGE'
0877 O                         BJMRDT   112                               S01194
0877 O****                     RUNA     112                               S01194
0627 O                         PAGE  Z  127
     O        H  1     OF                                                 S01117
     O********H  1     OF 37                                              E114
0628 O********H**1     OF                                                 S01117
0629 O                                   63 'DEBITS - INTERNAL SETTLE'
0630 O                                   68 'MENTS'
0631 O                 73                45 'CREDITS'
0393 O                 U5               128 'NETTING MODE'                CDL002
0632 O***              50                76 '- LOANS'                     S01194
0633 O***              50 72             79 'DEPOSITS'                    S01194
0634 O***              50 70             87 'FOREIGN EXCHANGE'            S01194
0635 O***********                       124 'BRANCH'                      S01117
0636 O***********              BRCD     128                     S01117    S01117
0636 O***********              OSBR     128                     S01117    S01117
0637 O********H**2     OF                                                 S01117
     O********H  2     OF 37                                              S01117
     O        H  2     OF                                                 E114
0638 O                 73                39 '-'
0639 O                                   63 '------------------------'
0640 O                                   68 '-----'
0641 O                                   40 '-'
0393 O                 U5               128 '------------'                CDL002
0642 O***              50                76 '-------'                     S01194
0643 O***              50 72             79 '---'                         S01194
0644 O***              50 70             87 '--------'                    S01194
     O**                                                                  S01117
     O********H  2     OF 37                                              S01117
     O        H  2     OF                                                 E114
     O*********************              10 'BRANCH'                S01117BHF408
     O*********************    OSBR      15                         S01117BHF408
     O                                   18 'BOOKING BRANCH'              BHF408
     O                         BRCA      23                               BHF408
     O***                      BRNM      48                               S01117
     O*********************    A8BRNM    48                         S01117BHF408
     O                         A8BRNM    56                               BHF408
     O**                                                                  S01117
     O        H  2     OF                                                 S01117
     O********H  2     OF 37                                              E114
0645 O********H**2     OF                                                 S01117
0646 O                                    9 'CURRENCY'
0647 O***                      CCNM      26                               S01194
0647 O                         A6CYNM    26                               S01194
0648 O                       38          44 'FEDERAL FUNDS'
0649 O                       39          51 'SAME DAY FUNDS'
     O********H  1     OF 37                                              S01117
     O        H  1     OF                                                 E114
0650 O********H**1     OF                                                 S01117
0651 O                                    6 'VALUE'
0652 O********H**2     OF                                                 S01117
     O********H  2     OF 37                                              S01117
     O        H  2     OF                                                 E114
0653 O*****                              20 ' DATE     REF.    CU'        S01117
0654 O*****                              44 'STOMER  ACCOUNT DEBITED '    S01117
0653 O                                   20 ' DATE     REF.     C'        S01117
0654 O                                   44 'USTOMER ACCOUNT DEBITED '    S01117
0655 O                 73                44 'CREDITED'
0656 O                                   68 '    ACCOUNT IDENTITY    '
0657 O**********                         81 '      COMMENT'               CSD005
0657 O                N75                81 '      COMMENT'               CSD005
0657 O                 75                92 '      COMMENT'               CSD005
0658 O**********                        124 'AMOUNT'                      CSD005
0658 O                N75               124 'AMOUNT'                      CSD005
0658 O                 75               131 'AMOUNT'                      CSD005
0659 O*
     O        DF 2     01 80                                              E114
     O********DF 2     01 80 37                                           S01117
0660 O********DF*2     01 80                                              S01117
0661 O                 L1      ZADATE     7
0662 O                         DLNO      15
     O***********              BRCD      24                               S01117
     O*********************    BRCA      24                         S01117BHF408
     O                         OSBR      24                               BHF408
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0318OOP1                                           S01408
     O*                                                                   S01408
     O*****                    CNUM      25                               S01117
     O*****               52   BICN      25                               S01117
     O*****               53   BICN      25                               S01117
     O*****                  51          25 '000000'                      S01117
     O*****               52             30 '-'                           S01117
     O*****               53             30 '-'                           S01117
0663 O*****                    ACOD      34                               S01117
0664 O*****               52   CSAC      34                               S01117
0665 O*****               53   COMS      34                               S01117
0666 O*****               56   CADC      34                               S01117
0667 O*****               51             34 '0000'                        S01117
0668 O*****                              39 '- 01'                        S01117
     O                                   25 '-'                           S01117
     O                         CNUM      31                               S01117
     O                    52   BICN      31                               S01117
     O                    53   BICN      31                               S01117
     O                       51          31 '000000'                      S01117
     O                                   32 '-'                           S01117
0663 O**********               ACOD      36                                            S01117 CGL029
0664 O****                52   CSAC      36                       S0117   S01194
0664 O**********          52   BLACCD    36                                            S01194 CGL029
0665 O****                53   COMS      36                       S01117  S01194
0665 O**********          53   BKACCD    36                                            S01194 CGL029
0666 O****                56   CADC      36                       S01117  S01194
0666 O**********          56   BMACCD    36                                            S01194 CGL029
0667 O**********          51             36 '0000'                                     S01117 CGL029
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0318OOP2                                           S01408
     O*                                                                   S01408
0668 O**********                         39 '-01'                                      S01117 CGL029
0669 O**********          54   ACSQ      39                                                   CGL029
0670 O**********          55   ACSQ      39                                                   CGL029
0671 O**********         N80             39 '         '                                       CGL029
     O                         ACOD      42                                                   CGL029
     O                    52   BLACCD    42                                                   CGL029
     O                    53   BKACCD    42                                                   CGL029
     O                    56   BMACCD    42                                                   CGL029
     O                    51             42 '0000000000'                                      CGL029
     O                                   45 '-01'                                             CGL029
     O                    54   ACSQ      45                                                   CGL029
     O                    55   ACSQ      45                                                   CGL029
     O                   N80             45 '              '                                  CGL029
0672 O                    53             60 'COMPUTER SUSPENSE'
0673 O                    52             64 'COMPENSATION SUSPENSE'
0674 O                    56             60 'PRIME CURRENT A/C'
     O                    55 04          65 'RETAIL ACCOUNT CLOSED'
     O                    55 04          68 'POSTING TO SUSPENSE A/C'
0675 O***                 54   ACKN      68                               S01194
     O***                 55N04ACKN      68                               S01194
0675 O***********         54   A5ACCN    68                         S01194CSD005
0675 O                N75 54   A5ACCN    68                               CSD005
0675 O                 75 54   W#NARR    82                               CSD005
     O**********          55N04A5ACCN    68                         S01194CSD005
     O                N75 55N04A5ACCN    68                               CSD005
     O                 75 55N04W#NARR    82                               CSD005
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0318OOP3                                           S01408
     O*                                                                   S01408
     O**********            N04SPI      106                               CSD005
     O                   N75N04SPI      106                               CSD005
     O                    75N04SPI      113                               CSD005
0678 O**********          60   EAMT     127 ' ,   ,   ,   , 0 -'          CSD005
0678 O                    60N75EAMT     127 ' ,   ,   ,   , 0 -'          CSD005
0678 O                    60 75EAMT     132 ' ,   ,   ,   , 0 -'          CSD005
0679 O*********           61   EAMT     127 '   ,   ,   , 0 . -'          CSD005
0679 O                    61N75EAMT     127 '   ,   ,   , 0 . -'          CSD005
0679 O                    61 75EAMT     132 '   ,   ,   , 0 . -'          CSD005
0680 O*********           62   EAMT     127 '  ,   ,   , 0 .  -'          CSD005
0680 O                    62N75EAMT     127 '  ,   ,   , 0 .  -'          CSD005
0680 O                    62 75EAMT     132 '  ,   ,   , 0 .  -'          CSD005
0681 O*********           63   EAMT     127 ' ,   ,   , 0 .   -'          CSD005
0681 O                    63N75EAMT     127 ' ,   ,   , 0 .   -'          CSD005
0681 O                    63 75EAMT     132 ' ,   ,   , 0 .   -'          CSD005
     O*                                                                   CSD005
     O        DF 1     01 80 U5                                           CDL002
     O                 U5                 8 'NET REF'                     CDL002
     O                 U5      NTRF      30                               CDL002
0682 O*
     O        DF 2     01N80                                              S01117
     O********DF 2     01N80 37                                           E114
0683 O********DF*2     01N80                                              S01117
0684 O                 L1      ZADATE     7
0685 O                         DLNO      15
0686 O                       81          83 'ROLL OVER OF'
0687 O                       81RRDN      90
0688 O                       82          85 'ROLLED OVER BY'
0689 O                       82RRDN      92
0690 O                       83          90 'INT. CAPITALISATION'
     O*                                                                   CSD005
0691 O***********      60      EAMT     127 ' ,   ,   ,   , 0 -'          CSD005
0691 O                 60N75   EAMT     127 ' ,   ,   ,   , 0 -'          CSD005
0691 O                 60 75   EAMT     132 ' ,   ,   ,   , 0 -'          CSD005
0692 O***********      61      EAMT     127 '   ,   ,   , 0 . -'          CSD005
0692 O                 61N75   EAMT     127 '   ,   ,   , 0 . -'          CSD005
0692 O                 61 75   EAMT     132 '   ,   ,   , 0 . -'          CSD005
0693 O***********      62      EAMT     127 '  ,   ,   , 0 .  -'          CSD005
0693 O                 62N75   EAMT     127 '  ,   ,   , 0 .  -'          CSD005
0693 O                 62 75   EAMT     132 '  ,   ,   , 0 .  -'          CSD005
0694 O***********      63      EAMT     127 ' ,   ,   , 0 .   -'          CSD005
0694 O                 63N75   EAMT     127 ' ,   ,   , 0 .   -'          CSD005
0694 O                 63 75   EAMT     132 ' ,   ,   , 0 .   -'          CSD005
     O*                                                                   CSD005
0695 O*
0696 O        TF1      L3N69NU7
     O*******AND       37                                                 E114
0697 O                                   74 'CURRENCY TOTAL  -  NO. 0'
0698 O                                   81 'F ITEMS'
0699 O                         RECS  3B  86
     O*                                                                   CSD005
0700 O***********                       102 'VALUE'                       CSD005
0700 O                N75               102 'VALUE'                       CSD005
0700 O                 75               110 'VALUE'                       CSD005
0701 O***********      60      TOTAL  B 127 '   ,   ,   ,   , 0 -'        CSD005
0701 O                 60N75   TOTAL  B 127 '   ,   ,   ,   , 0 -'        CSD005
0701 O                 60 75   TOTAL  B 132 '   ,   ,   ,   , 0 -'        CSD005
0702 O**********       61      TOTAL  B 127 '  ,   ,   ,   , 0 . -'       CSD005
0702 O                 61N75   TOTAL  B 127 '  ,   ,   ,   , 0 . -'       CSD005
0702 O                 61 75   TOTAL  B 132 '  ,   ,   ,   , 0 . -'       CSD005
0703 O***********      62      TOTAL  B 127 ' ,   ,   ,   , 0 .  -'       CSD005
0703 O                 62N75   TOTAL  B 127 ' ,   ,   ,   , 0 .  -'       CSD005
0703 O                 62 75   TOTAL  B 132 ' ,   ,   ,   , 0 .  -'       CSD005
0704 O***********      63      TOTAL  B 127 '   ,   ,   , 0 .   -'        CSD005
0704 O                 63N75   TOTAL  B 127 '   ,   ,   , 0 .   -'        CSD005
0704 O                 63 75   TOTAL  B 132 '   ,   ,   , 0 .   -'        CSD005
     O*                                                                   CSD005
0705 O*
     O        T 3      L6 14                                              S01117
     O********T 3      L6 37                                              E114
     O                                   65 '*** END OF REPORT '          S01117
     O                                   79 'FOR BRANCH ***'              S01117
     O********                           71 '*** END OF BRANCH REPORT'    S01117
     O********                           75 ' ***'                        S01117
     O******************************************************************* S01117
0706 O* C O N T R O L S
0707 O*****   T  203   LR                                                 S01117
0708 O*****                              22 'REFERENCE DL0318'            S01117
     ODL0318AUT  203   LR                                                 S01117
     O                                   22 'REFERENCE DL0318AU'          S01117
0875 O                         BJURPT    89                               S01194
0875 O****                     TITL      89                               S01194
0710 O                                  122 'DATE              PAGE'
0877 O                         BJMRDT   112                               S01194
0877 O****                     RUNA     112                               S01194
0712 O***********              PAGE  Z  127                               068941
0712 O                         PAGE1 Z  127                               068941
0713 O        T  1     LR
0714 O                                   67 'INTERNAL SETTLEMENTS - F'
0715 O                                   85 'ILE CONTROL REPORT'
0393 O                 U5               128 'NETTING MODE'                CDL002
0716 O        T  3     LR
0717 O                                   67 '------------------------'
0718 O                                   85 '------------------'
0393 O                 U5               128 '------------'                CDL002
0719 O        T  1     LR
0720 O                                   29 'S/PRSX4 - RUN CONTROLS'
0721 O                                   59 'NUMBER'
0722 O                                   84 'VALUE'
0723 O        T  2     LR
0724 O                                   29 '----------------------'
0725 O                                   59 'OF RECORDS'
0726 O                                   84 'OF RECORDS'
0727 O        T  2     LR
0728 O                                   31 'TOTAL RECORDS - ON FILE'
0729 O                         NORE  3   59
0730 O                         HRWN  Z   81
0731 O                         HRDC      84
0732 O        T  3     LR
0733 O                                   32 'TOTAL RECORDS - CALCULAT'
0734 O                                   34 'ED'
0735 O                         RECIN 3   59
0736 O                         ZZTOTIZ   81
0737 O                         ZZTOTD    84
0738 O                 U8               118 '***   DIFFERENCE   ***'
     C*                                                                   S01117
     O        T 3      LRNU7N14                                           S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
0739 O********T 33     LR U7
3853 O********                           42 '*** REFERENCE'
3854 O********                 DBPGM     51
3855 O********                           71 '-  DATABASE ERROR AT'
3856 O********                 DBASE     74
3857 O********T        LR U7
3858 O********                           37 'FILE NAME'
3859 O********                 DBFILE    43
3860 O********                           48 'KEY'
3861 O********                 DBKEY     78
     O        T 3      LR U7                                              S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7                                              S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    76                               S01117
     O        T 13     LR U7                                              S01117
     O                                   49 'OPTION'                      S01117
     O                         DBOPTN    57                               S01117
     O                                   66 'KEY'                         S01117
     O                         DBKEY     96                               S01117
0741 O*****   T 3      LR                                                 E299
0742 O*****                              71 '*** END OF REPORT ***'       E299
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  MESS - CURRENCY NOT FOUND MESSAGE
XXX  NOT FOUND
**  TABTYP
0102070812
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
