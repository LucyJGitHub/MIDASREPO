0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Upd Pay/Rec Ind on Deals & Deal Amd')         *
     F*****************************************************************
0003 F*                                                               *
     F*  Midas - Dealing Module
0004 F*                                                               *
0005 F*  DL0330 - UPDATE PAY/RECEIVE INDS. ON DEALS FILE              *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CDL099             Date 06Oct17               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CRE073             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER048             Date 19May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 BUG11217           Date 23May06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CAS009             Date 04May04               *
      *                 CDL028             Date 07Feb05               *
      *                 BUG6799            Date 27Apr05               *
      *                 CAS008             Date 16Jun04               *
      *                 CDL025             Date 27Jan05               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 217684             Date 12May03               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR003             Date 12Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR005             Date 21Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 046820             DATE 13DEC93               *
     F*                 E47225             DATE 01FEB93               *
     F*                 E299               DATE 04APR90               *
     F*                 E264               DATE 03APR90               *
     F*                 E114               DATE 27NOV89               *
     F*                 S01194             DATE 08/08/89              *
     F*                 S01117             DATE 07/08/89              *
     F*                 S01157             DATE 03/10/88              *
     F*                 E11963             DATE 17/03/88              *
0009 F*                 E11294             DATE 09/09/87              *
0009 F*                 S01119             DATE 15/06/87              *
0009 F*                 S01118             DATE 16/03/87              *
0009 F*                 S01125             DATE                       *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  BUG11217 - Duplicate SWIFT Payment Message for 'SI' Deal     *
      *             Amendment is generated at COB because bit 1 of    *
      *             DAIN field in PF/DEAMSDI remains OFF. Rename DASN *
      *             of DS/KEY to RXDASN so that the update of DAIN    *
      *             field will not be bypassed.                       *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  BUG6799 - Field Tag :22A: must be SETT instead of AMND.      *
      *            Do not update fields LCD and CHTP. Applied GEMS    *
      *            fix 222632/218356.                                 *
      *  CAS008 - IAS 39 Enhancements                                 *
      *  CDL025 - FX Netting Payment Generation (Recompile)           *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS006 - Hedge Accounting Phase B                            *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  217684 - Authorisation User Malfunction (Recompile)          *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  CIR003 - FRA/IRS Pay/Receive Messages for Swaps.             *
      *  CDL008 - Continuous Linked Settlement (Recompiled)           *
      *  CIR005 - FRA/IRS Business Day Conventions to DEALSDG         *
      *           (recompile)                                         *
     F*  046820 - If reading in a reversed FRA, update TLXI to        *
     F*           prevent duplicate cancellation msgs being produced. *
     F*  E47225 - CONDITION CALL TO AORETLR0 ON RETAIL BEING PRESENT  *
     F*           AND CODE LDA PROPERLY                               *
     F*  E299   - 'AU' REPORT SHOULD NOT WRITE 'END OF REPORT'        *
     F*  E264   - SHOULD RECEIVE SEQ. NO. AND PASS TO ZSFILE          *
     F*  E114/S01117 - REPORT IS NOT AVAILABLE BY ENTITY              *
     F*  S01194 - NEW STANDING DATA CHANGES                           *
     F*  S01117 - NEW MULTI-BRANCHING CHANGES                         *
     F*  S01157 - APPROPRIATE BITS ON PAY/RECEIVE REPORT &            *
     F*           CONFIRMATIONS ATRE PRODUCED FOR FRA DEALS WHEN      *
     F*           PROCESS CALLED FROM MENU OPTION                     *
     F*           AND ALSO                                            *
0011 F*           FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL' INTO    *
     F*          'RR' (COLLAR), 'RP' (CAP) AND 'RF' (FLOOR).          *
     F*  E11963 - AVOID OVERRIDE OF DATA STRUCTURE 'KEY' BY ZSYSTM    *
     F*  E11294 - AVOID UPDATE OF TLXI WHEN PROCESSING FRI/IRS DEAL.  *
     F*  S01119 - FRA/IRS INCORPORATION                               *
     F*  S01118 - MIDAS/S.W.I.F.T. DIRECT LINK                        *
     F*  S01125 -                                                     *
     F*                                                               *
0010 F*****************************************************************
0011 F/SPACE 3
0012 F***PRSXM** IP  F     160 12AI     2 DISK                                                CGL029
     FPRSXM   IP  F     162 12AI     2 DISK                                                   CGL029
0013 F**TABLE***IF  F      96 12AI     2 DISK                             S01194
0016 F*DEALS***UF**F*****400**6AI*****2*DISK**************************    S01119
0016 F***DEALS***UF  F     600  6AI     2 DISK                                         S01119 CAS004
     F***DEALS** UF  F    2247  6AI     2 DISK                                         CAS004 CAS005
     F***DEALS** UF  F    2441  6AI     2 DISK                                         CAS005 CAS006
     F***DEALS** UF  F    2448  6AI     2 DISK                                         CAS006 CGL029
     F***DEALS** UF  F    2540  6AI     2 DISK                                         CGL029 CAS008
     FDEALS   UF  F    2550  6AI     2 DISK                                                   CAS008
     F                                              KCOMIT
0017 F***DEAMS** UF  F     200 14AI     2 DISK                                                CGL029
     FDEAMS   UF  F     933 14AI     2 DISK                                                   CGL029
     F                                              KCOMIT
     FDLFEEDL1UF  E           K        DISK                                                   CAS009
     F                                              KCOMIT                                    CAS009
0018 FDTRIXHH UF  F      40            DISK
     F                                              KCOMIT
0019 F*MPRINT  O   F     132     OF     PRINTER                           S01125
0019 F*DL0330P1O** F     132     OF     PRINTER                   S01125  S01117
0019 FDL0330P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0019 FDL0330AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
     F/COPY WNCPYSRC,DL0330F001
0020 F/SPACE 3
0021 F* ID F  C  H  L    FUNCTION OF INDICATORS
0022 F* 01            LF/PRSXM - DETAIL
0022 F* 04            PF/DTRIXHH
0027 F* 06            LF/DEALS - NON '*' DETAIL
0028 F* 07            LF/DEAMS - NON '*' DETAIL
     F**10*****       ALLOW OUTPUT TO BRANCH                              E114
     F* 11            FRA/IRS - DEALSDG FILE                              S01119
0029 F*    20         AMOUNT NEGATIVE
0030 F*    21         PAY/RECEIVE IND 1 SET
0031 F*    22                         2 SET
0032 F*    23                         3 SET
     F*   N25         P1 NOT OPENED/WRITTEN ,'NO DETAILS TO REPORT'.      S01117
0033 F*       40      1ST CYCLE IND.
0034 F*       41      GENERAL
0035 F*       42      CHAIN FAILURE
0036 F*       43      GROUP ON DEALS FILE
0037 F*       44      UNMATCHED LF/PRSXM RECORD
0038 F*       45      RELEASE LF/DEAMS
0039 F*       46      RELEASE LF/DEALS
0041 F*       50      DEC. PLACES - 0
0042 F*       51                    1
0043 F*       52                    2
0044 F*       53                    3
0051 F*       71      UPDATE LF/DEALS
0052 F*       72      UPDATE LF/DEAMS
0053 F*       73      UPDATE PF/DTRIXHH
0053 F*       74      RELEASE PF/DTRIXHH
0055 F*       85      AT LEAST 1 UNMATCHED RECORD
     F*          L1   INDICATING CHANGE OF BRANCH                         S01117
     E                    CPY@    1   1 80                                S01194
0056 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0057 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0058 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0059 E                    TABDCA  8   8  2   TABDCB  2
0060 F/EJECT
0061 I* LF/PRSMX DETAIL RECORD
0062 IPRSXM   NS  01   1 CD
0072 I                                        2   70DLNO
0075 I**********                              8  100DASN                                      CAS009
     I                                        8  100RXDASN                                    CAS009
     I/COPY WNCPYSRC,DL0330I001
0069 I                                    P  11  130VDAT
     I/COPY WNCPYSRC,DL0330I002
0063 I                                       14  14 PYRC
0064 I                                       15  160SETP
0065 I                                       17  170PROD
0066 I                                       18  20 CCY
0067 I**********                             21  32 OSAC                                      CGL029
0068 I**********                             43  430FFIN                                      CGL029
0070 I**********                             44  53 TSEN                                      CGL029
0071 I**********                             64  690CNUM                                      CGL029
0073 I**********                          P  71  770EAMT          20                          CGL029
0074 I**********                             78  78 RCDT                                      CGL029
0076 I**********                             79  88 FACO                                      CGL029
0077 I**********                             99 133 SPI                                       CGL029
0078 I**********                            134 1340PRI1        2121                          CGL029
0079 I**********                            135 1350PRI2        2222                          CGL029
0080 I**********                            136 1360PRI3        2323                          CGL029
0081 I**********                            137 1420BICN                                      CGL029
0082 I**********                            143 144 DTYP                                      CGL029
0083 I**********                            145 146 DLST                                      CGL029
0084 I******                                147 1490BRCD                  S01117
0084 I**********                            147 149 BRCA  L1                           S01117 CGL029
0085 I**********                            150 1500RCPI                                      CGL029
0086 I**********                            151 1560RRDN                                      CGL029
     I                                       21  38 OSAC                                      CGL029
     I                                       49  490FFIN                                      CGL029
     I                                       50  59 TSEN                                      CGL029
     I**********                             70  750CNUM                               CGL029 CSD027
     I                                       70  75 CNUM                                      CSD027
     I                                    P  77  830EAMT          20                          CGL029
     I                                       84  84 RCDT                                      CGL029
     I                                       85  94 FACO                                      CGL029
     I                                      105 139 SPI                                       CGL029
     I                                      140 1400PRI1        2121                          CGL029
     I                                      141 1410PRI2        2222                          CGL029
     I                                      142 1420PRI3        2323                          CGL029
     I**********                            143 1480BICN                               CGL029 CSD027
     I                                      143 148 BICN                                      CSD027
     I                                      149 150 DTYP                                      CGL029
     I                                      151 152 DLST                                      CGL029
     I                                      153 155 BRCA  L1                                  CGL029
     I                                      156 1560RCPI                                      CGL029
     I                                      157 1620RRDN                                      CGL029
     I**********                              2 156 LOT                                       CGL029
     I                                        2 162 LOT                                       CGL029
0087 I*
0088 I* TRAILER
0089 I        NS  02   1 CT
0090 I                                    P   2   40NORE
0091 I                                    P   5  120HRWN
0092 I                                    P  13  140HRDC
0093 I*
0094 I* CATCHALL
0095 I        NS
0096 I*
0097 I* LOOK-AHEAD FOR DEAL NUMBER
0098 I        NS  **
     I                                        1   1 NXRECI
0099 I                                        2   70NXDLNO
0100 I                                        8  100NXDASN
0101 I*
0102 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0103 I*****                                                               S01194
0104 I***TABLE***NS       2 C0   3 C1  12 C1                              S01194
0105 I*****  AND      13 C0                                               S01194
0106 I*****                                   1   1 RECI                  S01194
0107 I*****                                   2   30RECT                  S01194
0108 I*****                                  12  130RCDE                  S01194
0109 I*****                                  14  66 TITL                  S01194
0110 I*****                                  67  67 DATF                  S01194
0111 I*****                                  68  700DFBR                  S01194
0112 I*****                                  74  74 MODI1                 S01194
0113 I*****                                  75  75 MODI2                 S01194
0114 I*****                                  76  76 MODI3                 S01194
0115 I*****                               P  77  790RUND                  S01194
0716 I*****                                  80  86 RUNA                  S01194
0117 I*****                                  87  870SFLG                  S01194
0118 I*****                               P  90  920LCD                   S01194
0119 I*****                                  93  93 CHTP                  S01194
0120 I*****                               P  94  960TNLU                  S01194
0121 I*****                                                               S01194
0122 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0123 I*****                                                               S01194
0124 I***TABLE** NS              2 C2   3 C0                              S01194
0125 I*****  AND      13 C1                                               S01194
0126 I*****                                   1   1 RECI                  S01194
0127 I*****                                   2   30RECT                  S01194
0128 I*****                                  10  12 CCY                   S01194
0129 I*****                                  13  130SREC                  S01194
0130 I*****                                  14  27 CCNM                  S01194
0131 I*****                               P  28  348SPOT                  S01194
0132 I*****                                  35  37 CCYS                  S01194
0133 I*****                                  38  380CDP                   S01194
0134 I*****                                  39  390TNOT                  S01194
0135 I*****                                  40  40 DCCY                  S01194
0136 I*****                                  41  44 SRC1                  S01194
0137 I*****                                  45  48 SRC2                  S01194
0138 I*****                                  49  520TACC                  S01194
0139 I*****                                  53  560TEQV                  S01194
0140 I*****                                  57  600SWQV                  S01194
0141 I*****                                  61  640TAC4                  S01194
0142 I*****                                  65  680TAC5                  S01194
0143 I*****                                  69  69 HIND                  S01194
0144 I*****                               P  70  768PART                  S01194
0145 I*****                                  77  780SSNO                  S01194
0146 I*****                               P  79  858ERLC                  S01194
0147 I*****                               P  90  920LCD                   S01194
0148 I*****                                  93  93 CHTP                  S01194
0149 I*****                               P  94  960TNLU                  S01194
0150 I**CATCHALL*****                                                     S01194
0151 I********NS                                                          S01194
0179 I*
0180 I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
0181 I*
0182 IDEALS   NS  06   1 CD   8 CB
0183 I                                        1   1 RECI
0184 I                                        2   70DLNO
0185 I                                        8   8 RCDT
0186 I                                        9  100RCDC
0187 I**********                             11  160CNUM                                      CSD027
0187 I                                       11  16 CNUM                                      CSD027
0188 I*****                                  17  190BRCD                  S01117
0188 I                                       17  19 BRCA                  S01117
0189 I                                       20  21 DTYP
0190 I                                       22  23 DLST
0191 I                                    P  24  260DDAT
0192 I                                    P  27  290VDAT
0193 I                                    P  30  320OTDT
0194 I                                       35  38 BRKC
0195 I                                    P  39  450BAGE
0196 I                                       46  48 PUCY
0197 I                                    P  49  550PUAM
0198 I                                    P  56  628EXRT
0199 I                                       86  88 SLCY
0200 I                                    P  89  950SLAM
0201 I                                    P 117 1230BCEQ
0202 I                                    P 131 1378LCXR
0203 I                                      138 1390PCST
0204 I**********                            140 151 OPCA                                      CGL029
     I                                      140 151 OPCAQQ                                    CGL029
0205 I                                      152 161 TSCN
0206 I                                      162 1630SCST
0207 I**********                            164 175 OSCA                                      CGL029
     I                                      164 175 OSCAQQ                                    CGL029
0208 I                                      176 185 TPCN
0209 I                                    P 192 1980ORPA
0210 I                                    P 205 2110ORSA
0211 I                                      212 2120FSLI
0212 I                                    P 241 2470SPPD
0213 I                                    P 248 2540SPLA
0214 I                                      255 257 SPLC
0215 I                                      285 2900SODN
0216 I                                      300 309 FACO
0217 I                                      310 344 SPI
0218 I                                      370 370 DNSI
0219 I                                      371 371 DSTI
0220 I                                      372 372 CNFI
0221 I                                      373 373 ACEI
0222 I                                      374 374 TLXI
0223 I                                    P 391 3930ORED
0224 I                                    P 394 3960LCD
0225 I                                      397 397 CHTP
0226 I                                    P 398 4000TNLU
     I                                     12921309 OPCA                                      CGL029
     I                                     13101327 OSCA                                      CGL029
0227 I                                        1 200 BRS1
0228 I                                      201 400 BRS2
0230 I*
0231 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0232 I*
0233 IDEALS   NS  06   1 CD   8 CC
0234 I                                        1   1 RECI
0235 I                                        2   70DLNO
0236 I                                        8   8 RCDT
0237 I                                        9  100RCDC
0238 I**********                             11  160CNUM                                      CSD027
0238 I                                       11  16 CNUM                                      CSD027
0239 I******                                 17  190BRCD                  S01117
0239 I                                       17  19 BRCA                  S01117
0240 I                                       20  21 DTYP
0241 I                                       22  23 DLST
0242 I                                    P  24  260DDAT
0243 I                                    P  27  290VDAT
0244 I                                    P  30  320MDAT
0245 I                                       33  340CDAS
0246 I                                       35  38 BRKC
0247 I                                    P  39  450BAGE
0248 I                                       46  48 CCY
0249 I                                    P  49  550PCPL
0250 I                                       56  56 INTC
0251 I                                       63  640BRTT
0252 I                                    P  65  707BRTE
0253 I                                    P  71  767RTSP
0254 I                                    P  77  827INTR
0255 I                                       83  850NOTD
0256 I                                       86 105 RNNA
0257 I**********                            106 1110CHNA                                      CSD027
0257 I                                      106 111 CHNA                                      CSD027
0258 I                                      112 1140FACT
0259 I                                      115 1160FCNO
0260 I                                    P 117 1230OPAM
0261 I                                    P 124 1308BCXR
0262 I                                    P 131 1378LCXR
0263 I                                      138 1390SDST
0264 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0265 I                                      152 161 TSTN
0266 I                                      162 1630MDST
0267 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0268 I                                      176 185 TMAN
0269 I                                      186 1910RODN
0270 I                                    P 192 1980RODA
0271 I                                      199 2040RBDN
0272 I                                    P 205 2110RBDA
0273 I                                      212 2120ICBS
0274 I                                      213 213 IPFR
0275 I                                    P 214 2200TOTI
0276 I                                    P 221 2230NIDT
0277 I                                    P 224 2260IBDT
0278 I                                    P 227 2290SLID
0279 I                                    P 230 2360AIPD
0280 I                                    P 237 2390DLRC
0281 I                                    P 240 2420IACD
0282 I                                    P 243 2490AITC
0283 I                                    P 250 2560AIAN
0284 I                                    P 257 2630AIAP
0285 I                                    P 264 2700IPRD
0286 I                                    P 271 2770IPRM
0287 I                                    P 278 2840ICTD
0288 I                                    P 294 2960DAVD
0289 I                                      297 2990DASN
0290 I                                      300 309 FACO
0291 I                                      310 344 SPI
0292 I                                      345 3460INTF
0293 I                                      370 370 DNSI
0294 I                                      371 371 DSTI
0295 I                                      372 372 CNFI
0296 I                                      373 373 ACEI
0297 I                                      374 374 TLXI
0298 I                                    P 391 3930ORED
0299 I                                    P 394 3960LCD
0300 I                                      397 397 CHTP
0301 I                                    P 398 4000TNLU
     I                                     17211738 OSDA                                      CGL029
     I                                     17391756 OMDA                                      CGL029
0302 I                                        1 200 BRS1
0303 I                                      201 400 BRS2
0304 I*
0305 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
0306 I*
0307 IDEALS   NS  06   1 CD   8 CD
0308 I                                        1   1 RECI
0309 I                                        2   70DLNO
0310 I                                        8   8 RCDT
0311 I                                        9  100RCDC
0312 I**********                             11  160ISCN                                      CSD027
0312 I                                       11  16 ISCN                                      CSD027
0313 I******                                 17  190BRCD                  S01117
0313 I                                       17  19 BRCA                  S01117
0314 I                                       20  21 DTYP
0315 I                                       22  23 DLST
0316 I                                    P  24  260DDAT
0317 I                                    P  27  290VDAT
0318 I                                    P  30  320MDAT
0319 I                                       33  340IDAS
0320 I                                       35  38 BRKC
0321 I                                    P  39  450BAGE
0322 I                                       46  48 CCY
0323 I                                    P  49  550PUPR
0324 I                                    P  57  627YRAT
0325 I                                    P  71  767RTSP
0326 I                                    P  77  827INTR
0327 I                                       86 105 RNNA
0328 I**********                            106 1110PCUS                                      CSD027
0328 I                                      106 111 PCUS                                      CSD027
0329 I                                      112 1140FACT
0330 I                                      115 1160FCNO
0331 I                                    P 117 1230FVAL
0332 I                                    P 124 1308BCXR
0333 I                                    P 131 1378LCXR
0334 I                                      138 1390SDST
0335 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0336 I                                      152 161 TSTN
0337 I                                      162 1630MDST
0338 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0339 I                                      176 185 TMAN
0340 I                                    P 192 1980DISA
0341 I                                    P 205 2110DPTD
0342 I                                      212 2120ICBS
0343 I                                      213 213 IPFR
0344 I                                    P 214 2200TOTI
0345 I                                    P 221 2230NIDT
0346 I                                    P 224 2260IBDT
0347 I                                    P 227 2290SLID
0348 I                                    P 230 2360AIPD
0349 I                                    P 237 2390DLRC
0350 I                                    P 240 2420IACD
0351 I                                    P 243 2490AITC
0352 I                                    P 250 2560AIAN
0353 I                                    P 257 2630AIAP
0354 I                                    P 264 2700IPRD
0355 I                                    P 271 2770IPRM
0356 I                                    P 278 2840SAPR
0357 I                                      285 2900ASDN
0358 I                                    P 291 2930SADT
0359 I                                    P 294 2960DAVD
0360 I                                      297 2990DASN
0361 I                                      300 309 FACO
0362 I                                      310 344 SPI
0363 I                                      345 3460INTF
0364 I                                      370 370 DNSI
0365 I                                      371 371 DSTI
0366 I                                      372 372 CNFI
0367 I                                      373 373 ACEI
0368 I                                      374 374 TLXI
0369 I                                    P 391 3930ORED
0370 I                                    P 394 3960LCD
0371 I                                      397 397 CHTP
0372 I                                    P 398 4000TNLU
     I                                     12451262 OSDA                                      CGL029
     I                                     12631280 OMDA                                      CGL029
0373 I                                        1 200 BRS1
0374 I                                      201 400 BRS2
0376 I*
0377 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
0378 I*
0379 IDEALS   NS  06   1 CD   8 CE
0380 I                                        1   1 RECI
0381 I                                        2   70DLNO
0382 I                                        8   8 RCDT
0383 I                                        9  100RCDC
0384 I**********                             11  160ISCN                                      CSD027
0384 I                                       11  16 ISCN                                      CSD027
0385 I*******                                17  190BRCD                  S01117
0385 I                                       17  19 BRCA                  S01117
0386 I                                       20  21 DTYP
0387 I                                       22  23 DLST
0388 I                                    P  24  260DDAT
0389 I                                    P  27  290VDAT
0390 I                                       35  38 BRKC
0391 I                                    P  39  450BAGE
0392 I                                       46  48 CCY
0393 I                                    P  49  550SAPR
0394 I                                    P  57  627YRAT
0395 I                                    P  77  827INTR
0396 I                                       86 105 RNNA
0397 I**********                            106 1110SCUS                                      CSD027
0397 I                                      106 111 SCUS                                      CSD027
0398 I                                    P 117 1230FVAL
0399 I                                      138 1390SETP
0400 I**********                            140 151 OSAC                                      CGL029
     I                                      140 151 OSACQQ                                    CGL029
0401 I                                      152 161 TSEN
0402 I                                    P 285 2900RPDN
0403 I                                      370 370 DNSI
0404 I                                      371 371 DSTI
0405 I                                      372 372 CNFI
0406 I                                      373 373 ACEI
0407 I                                      374 374 TLXI
0408 I                                    P 391 3930ORED
0409 I                                    P 394 3960LCD
0410 I                                      397 397 CHTP
0411 I                                    P 398 4000TNLU
     I                                     10481065 OSAC                                      CGL029
0412 I                                        1 200 BRS1
0413 I                                      201 400 BRS2
     I*                                                                   S01119
     I*    DEALS FILE - DETAIL - FRA/IRS                                  S01119
     I*                                                                   S01119
     IDEALS   NS  11   1 CD   8 CG                                        S01119
     I       OR        1 CE   8 CG                                        S01119
     I       OR        1 CM   8 CG                                        S01119
     I       OR        1 CR   8 CG                                        S01119
     I                                        1   1 RECI                  S01119
     I                                        2   70DLNO                  S01119
     I                                        8   8 RCDT                  S01119
     I                                        9  100RCDC                  S01119
     I**********                             11  160CNUM                               S01119 CSD027
     I                                       11  16 CNUM                                      CSD027
     I******                                 17  190BRCD           S01119 S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP                  S01119
     I                                       22  23 DLST                  S01119
     I                                    P  24  260DDAT                  S01119
     I                                    P  27  290VDAT                  S01119
     I                                    P  30  320MDAT                  S01119
     I                                       33  340CDAS                  S01119
     I                                       35  38 BRKC                  S01119
     I                                    P  39  450BAGE                  S01119
     I                                       46  510LNKDN                 S01119
     I                                       52  52 HEDIN                 S01119
     I                                       53  53 TAXI                  S01119
     I                                       54  56 UCUCY                 S01119
     I                                    P  57  630UPAMT                 S01119
     I                                       64  650UBRTT                 S01119
     I                                    P  66  717USTRT                 S01119
     I                                    P  72  777UBRTE                 S01119
     I                                    P  78  837URTSP                 S01119
     I                                       84  84 USPIN                 S01119
     I                                    P  85  907UEINR                 S01119
     I                                       91  910UICBS                 S01119
     I                                       92  930UFRFD                 S01119
     I                                    P  94  960UINFD                 S01119
     I                                    P  97  990USLIP                 S01119
     I                                    P 100 1020UNICD                 S01119
     I                                    P 103 1050UICBD                 S01119
     I                                      106 106 UICFR                 S01119
     I                                      107 1080UICFD                 S01119
     I                                    P 109 1110UNIPD                 S01119
     I                                    P 112 1140UIPBD                 S01119
     I                                      115 115 UIPFR                 S01119
     I                                      116 1170UIPFD                 S01119
     I                                    P 118 1248UBCXR                 S01119
     I                                    P 125 1270UIACD                 S01119
     I                                    P 128 1340UIALC                 S01119
     I                                    P 135 1410UAITC                 S01119
     I                                    P 142 1480UAIPD                 S01119
     I                                    P 149 1550UAIAN                 S01119
     I                                    P 156 1620UAIAP                 S01119
     I                                    P 163 1690UIPRD                 S01119
     I                                    P 170 1760UIPRM                 S01119
     I                                    P 177 1830UNSAM                 S01119
     I                                    P 184 1900UTAXD                 S01119
     I                                    P 191 1970UTAXM                 S01119
     I                                      198 200 TCUCY                 S01119
     I                                    P 201 2070TPAMT                 S01119
     I                                      208 2090TBRTT                 S01119
     I                                    P 210 2157TSTRT                 S01119
     I                                    P 216 2217TBRTE                 S01119
     I                                    P 222 2277TRTSP                 S01119
     I                                      228 228 TSPIN                 S01119
     I                                    P 229 2347TEINR                 S01119
     I                                      235 2350TICBS                 S01119
     I                                      236 2370TFRFD                 S01119
     I                                    P 238 2400TINFD                 S01119
     I                                    P 241 2430TSLIP                 S01119
     I                                    P 244 2460TNICD                 S01119
     I                                    P 247 2490TICBD                 S01119
     I                                      250 250 TICFR                 S01119
     I                                      251 2520TICFD                 S01119
     I                                    P 253 2550TNIPD                 S01119
     I                                    P 256 2580TIPBD                 S01119
     I                                      259 259 TIPFR                 S01119
     I                                      260 2610TIPFD                 S01119
     I                                    P 262 2688TBCXR                 S01119
     I                                    P 269 2710TIACD                 S01119
     I                                    P 272 2780TIALC                 S01119
     I                                    P 279 2850TAITC                 S01119
     I                                    P 286 2920TAIPD                 S01119
     I                                    P 293 2990TAIAN                 S01119
     I                                    P 300 3060TAIAP                 S01119
     I                                    P 307 3130TIPRD                 S01119
     I                                    P 314 3200TIPRM                 S01119
     I                                    P 321 3270TNSAM                 S01119
     I                                    P 328 3340TTAXD                 S01119
     I                                    P 335 3410TTAXM                 S01119
     I                                    P 342 3477CLRAT                 S01119
     I                                    P 348 3537FLRAT                 S01119
     I                                    P 354 3550AVPER                 S01119
     I                                    P 356 3638TIRAT                 S01119
     I                                    P 364 3697AACRT                 S01119
     I                                      370 3710RSETM                 S01119
     I**********                            372 383 URACC                              S01119 CGL029
     I                                      372 383 URACQQ                                    CGL029
     I                                      384 393 CPPBK                 S01119
     I                                      394 3950PSETM                 S01119
     I**********                            396 407 UPACC                              S01119 CGL029
     I                                      396 407 UPACQQ                                    CGL029
     I                                      408 417 CPRBK                 S01119
     I                                      418 427 FACO                  S01119
     I                                      428 462 SPI                   S01119
     I                                    P 463 4650SDCAR                 S01119
     I                                    P 466 4680ULPCD                 S01119
     I                                    P 469 4710TLPCD                 S01119
     I                                    P 472 4780UAEXA                 S01119
     I                                    P 479 4850TAEXA                 S01119
     I                                      570 570 UDNSI                 S01119
     I                                      571 571 TDNSI                 S01119
     I                                      572 572 UDSTI                 S01119
     I                                      573 573 TDSTI                 S01119
     I                                      574 574 CNFI                  S01119
     I                                      575 575 ACEI                  S01119
     I                                      576 576 TLXI                  S01119
     I                                    P 587 5880LSWC                  S01119
     I                                    P 589 5900LSWS                  S01119
     I                                    P 591 5930ORED                  S01119
     I                                    P 594 5960LCD                   S01119
     I                                      597 597 CHTP                  S01119
     I                                    P 598 6000TNLU                  S01119
     I                                     24692486 URACC                                     CGL029
     I                                     24872504 UPACC                                     CGL029
0414 I* CATCHALL
0415 I        NS
0417 I*
0418 I*    DEALS AMENDMENT FILE - DETAIL RECORD.
0419 I*
0420 IDEAMS   NS  07   1 CD
0421 I                                        1   1 RECI
0422 I                                        2   70DLNO
0423 I                                        8  120VDAT
0424 I                                       13  150DASN
0425 I                                       16  17 DTYP
0426 I                                       18  19 DLST
0427 I                                       20  21 AMTP
0428 I                                       22  220PSEQ
0429 I                                       23  240BRTT
0430 I                                    P  25  307RTSP
0431 I                                       31  33 CCY
0432 I                                    P  34  400DAAM
0433 I                                       41  41 MOGI
0434 I**********                             42  470CNUM                                      CSD027
0434 I                                       42  47 CNUM                                      CSD027
0435 I                                       48  490SETP
0436 I**********                             50  61 OSAC                                      CGL029
     I                                       50  61 OSACQQ                                    CGL029
0437 I                                       62  71 TSEN
0438 I                                       72  81 FACO
0439 I                                       82 116 SPI
0440 I                                    P 139 1410NAAD
0441 I                                      142 1440NASN
0442 I                                      145 145 DAIN
0443 I                                    P 191 1930ORED
0444 I                                    P 194 1960LCD
0445 I                                      197 197 CHTP
0446 I                                    P  17  190NDAR
     I                                      880 897 OSAC                                      CGL029
0447 I                                        1 200 LOTDEA
0448 I* CATCHALL
0449 I        NS
0450 I*
0451 I*    DEAL TRANSACTIONS INDEX FILE - HEADER RECORD.
0452 I*
0453 IDTRIXHH NS  04   1 CH
0454 I                                        1   1 RECI
0455 I                                        2   2 RCDT
0456 I                                        3   80DLNO
0459 I                                    P  15  170RRLC
0461 I                                    P  21  230RRLX
0462 I                                    P  24  260RRXP
0463 I                                    P  27  290NDLR
0464 I                                    P  30  320NDAR
0465 I                                       33  330STPI
0467 I                                        1  40 LOTDTR
0468 I* CATCHALL
0469 I        NS
0470 I*
0473 I/SPACE 3
0474 I* D A T A   S T R U C T U R E S
0475 I*
0476 I            DS
0477 I                                        1  14 KEY
0478 I                                        1   60DLNO
0479 I                                        7  110VDAT
0480 I**********                             12  140DASN                                    BUG11217
     I                                       12  140RXDASN                                  BUG11217
0481 I**LF*TABLE*KEY                                                      S01194
0482 I*****       DS                                                      S01194
0483 I*****                                   1  12 ZTABKY                S01194
0484 I*****                                   9  11 CCY                   S01194
0485 I*****                                  12  12 SUBTYP                S01194
     I*
     IPSDS       SDS
     I                                      254 263 USRID
     I*
     IDNATN       DS                              5
     I* DATA STRUCTURE TO UPDATE LAST TRANSACTION NUMBER DTAARA
     I                                        1   50FNATN
     I*
     I***CMTTXT*     DS                            205                                        CGL029
     ICMTTXT      DS                            211                                           CGL029
     I* DATA STRUCTURE TO PROVIDE TEXT ON COMIT ENTRY IN JOURNAL
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSID
     I                                       19  240TIME
     I                                       25  25 ACTCD
     I                                       26  35 USRIDX
     I**********                             51 205 LOT                                       CGL029
     I                                       51 211 LOT                                       CGL029
     I*
     I@BANK     E DSSDBANKPD                                              S01194
     I** DUMMY RECORD FORMAT TO ACCESS BANK DETAILS                       S01194
     I*                                                                   S01194
     I@BRCH     E DSSDBRCHPD                                              S01194
     I** DUMMY RECORD FORMAT TO ACCESS BRANCH DETAILS                     S01194
     I*                                                                   S01194
     I@CURR     E DSSDCURRPD                                              S01194
     I** DUMMY RECORD FORMAT TO ACCESS CURRENCY DETAILS                   S01194
     I*
     ISCSARD    E DSSCSARDPD                                              CIR003
      **  Data structure for Switchable Features file                     CIR003
      *                                                                   CIR003
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01117
     ISPOOL       DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I* FILE INFORMATION DATA STRUCTURE                                   S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ILDA         DS                            256                       E47225
     I                                      134 143 DBFILE                E47225
     I                                      142 170 DBKEY                 E47225
     I                                      171 180 DBPGM                 E47225
     I                                      181 183 DBASE                 E47225
      **  Local data area                                                 E47225
      *                                                                   E47225
0486 I/EJECT
0487 C* 1 S T   C Y C L E   P R O C E S S I N G
0488 C   40                GOTO START
     C*                                                                   S01117
     C********   *ENTRY    PLIST                                          E114
     C********             PARM           SEQ     5                       E114
     C********             PARM           BRNCH   3                       E114
     C*
     C           *ENTRY    PLIST                                          E264
     C                     PARM           SEQ     5                       E264
     C*
     C                     MOVEACPY@      BIS@   80                       S01194
     C           *NAMVAR   DEFN           LDA                             E47225
     C                     MOVEL*BLANKS   DBPGM                           E47225
     C                     MOVEL'DL0330'  DBPGM                           E47225
     C*
0489 C*****                SETON                     40OF                 S01117
0489 C                     SETON                     40                   S01117
0490 C                     Z-ADD0         ZERO5   50
0491 C                     Z-ADD2         RECIN   50
     C*****                MOVE CCY       SAVEF   3                E11963 S01194
0492 C*****                EXSR ZSYSTM                                    S01194
     C*****                MOVE SAVEF     CCY                      E11963 S01194
     C***99                SETON                     U7U8LR               S01194
0493 C*****                MOVE '1'       SUBTYP                          S01194
0494 C*****                MOVEL'20'      ZTABKY                          S01194
     C*
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDBANKPD'DBFILE 10         ************* S01194
     C                     MOVEL'01'      DBASE   3         *DBERROR 001* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     OUT  LDA                                       E47225
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CIR003
      ** Check if switchable feature CIR003 is switched on                CIR003
      *                                                                   CIR003
     C                     CALL 'AOSARDR0'                                CIR003
     C                     PARM *BLANKS   @RTCD                           CIR003
     C                     PARM '*VERIFY' @OPTN                           CIR003
     C                     PARM 'CIR003'  @SARD   6                       CIR003
     C           SCSARD    PARM SCSARD    DSFDY                           CIR003
      *                                                                   CIR003
     C           @RTCD     IFNE *BLANK                                    CIR003
     C           @RTCD     ANDNE'*NRF   '                                 CIR003
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR003
     C                     MOVEL'4'       DBASE            * DB ERROR 04 *CIR003
     C                     MOVEL'CIR003'  DBKEY            ***************CIR003
     C                     MOVE *ON       *INU7                           CIR003
     C                     MOVE *ON       *INU8                           CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO END                                       CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           @RTCD     IFEQ *BLANKS                                   CIR003
     C                     MOVE 'Y'       CIR003  1                       CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'N'       CIR003                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
0182 C*
0327 C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0328 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
      *                                                                                       CAS009
      ** Determine if CAS009 is installed                                                     CAS009
      *                                                                                       CAS009
     C                     MOVE 'N'       CAS009                                              CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANKS   @RTCD                                               CAS009
     C                     PARM '*VERIFY' @OPTN                                               CAS009
     C                     PARM 'CAS009'  @SARD                                               CAS009
     C           @RTCD     IFNE *BLANK                                                        CAS009
     C           @RTCD     ANDNE'*NRF   '                                                     CAS009
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS009
     C                     MOVEL'006'     DBASE                                               CAS009
     C                     MOVEL'CAS009'  DBKEY                                               CAS009
     C                     MOVE *ON       *INU7                                               CAS009
     C                     MOVE *ON       *INU8                                               CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C           @RTCD     IFEQ *BLANKS                                                       CAS009
     C                     MOVE 'Y'       CAS009  1                                           CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C           KEYFEE    KLIST                                                              CAS009
     C                     KFLD           KDLNO   60                                          CAS009
     C                     KFLD           KFSEQ   20                                          CAS009
      *                                                                                       CAS009
     C/COPY WNCPYSRC,DL0330C001
0496 C/SPACE 3
0497 C* M A I N   P R O C E S S I N G
0498 C           START     TAG                             ** START TAG **
0499 C                     SETOF                     444546
     C*                                                                   S01117
     C           *INL1     IFEQ '1'                                       S01117
     C                     CLOSEDL0330P1                                  S01117
     C*********  BRNCH     IFEQ 'ALL'                                     E114
     C***If*Branch Report                                                 E114
     C*********  BRNCH     OREQ BRCA                                      E114
     C*********            SETON                     10                   E114
     C                     SETOF                     85                   S01117
     C                     OPEN DL0330P1                                  S01117
     C*
     C* IF P1 FILE OPENED THEN SET ON FLAG                                S01117
     C                     MOVE '1'       *IN25                           S01117
     C*                                                                   S01117
     C* REPORT SPOOL FILE GENERATION                                      S01117
     C* TRANSFER BINARY DATA INTO NUMERIC FIELD
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     CALL 'ZSFILE'                                  S01117
     C*********************PARM *BLANKS   SEQ     5                S01117 E264
     C                     PARM           SEQ     5                       E264
     C                     PARM BRCA      @PARM   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** To get Branch Name                                               S01117
     C*
     C** CALL ACCESS PROGRAM FOR BRANCH DETAILS                           S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM BRCA      @DSNB   3                       S01194
     C********** @BRCH     PARM @BRCH     DSFDY                                        S01194 CGL029
     C           @BRCH     PARM @BRCH     DSSDY                                               CGL029
     C**                                                                  S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDBRCHPD'DBFILE                          S01194
     C                     MOVEL'02'      DBASE            ************** S01194
     C                     MOVEL@OPTN     DBOPTN           *DBERROR 002 * S01194
     C                     MOVELBRCA      DBKEY  29        ************** S01194
     C                     OUT  LDA                                       E47225
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C**                                                                  S01117
     C********             ELSE                                           E114
     C********             SETOF                     10                   E114
     C********             END                                            E114
     C                     END                                            S01117
     C**                                                                  S01117
     C   01      RECIN     ADD  1         RECIN
0500 C  N01                GOTO END                        **** IF DETAIL
0501 C                     EXSR HASH
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           RCDT      ANDEQ'M'                                                           CAS009
      *                                                                                       CAS009
     C                     Z-ADDDLNO      KDLNO                                               CAS009
     C                     Z-ADDRXDASN    KFSEQ                                               CAS009
     C           KEYFEE    CHAINDLFEEDL1             12                                       CAS009
      *                                                                                       CAS009
     C           *IN12     IFEQ '1'                                                           CAS009
     C           DFRECI    ORNE 'D'                                                           CAS009
     C           DFRECI    ANDNE'R'                                                           CAS009
     C           *LOCK     IN   LDA                                                           CAS009
     C                     MOVE '005'     DBASE                                               CAS009
     C                     MOVELKDLNO     DBKEY                                               CAS009
     C                     MOVE KFSEQ     DBKEY                                               CAS009
     C                     MOVEL'DLFEEDL1'DBFILE                                              CAS009
     C                     OUT  LDA                                                           CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     MOVEL'X'       DFSWRI                                              CAS009
     C                     UPDATDLFEEDD0                                                      CAS009
     C                     GOTO END                                                           CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
0502 C           RCDT      COMP 'A'                      41** IF 'A' REC
0503 C  N41                GOTO DGROUP
0505 C           KEY       CHAINDEAMS                42
0506 C  N42N07             SETON                     45
0507 C  N07                GOTO NPRESA
0508 C                     BITON'1'       DAIN
0509 C                     EXSR UPDATE                     UPDAT LF/DEAMS
0510 C                     GOTO END
0511 C           NPRESA    TAG                              * NPRESA TAG**
0515 C                     EXSR UNMAT
0516 C                     GOTO END
0517 C*
0518 C           DGROUP    TAG                                DGROUP TAG**
0519 C* IS THIS A NEW DEAL NUMBER
0520 C           DLNO      COMP DLNOST                   41** IF NEW GROUP
0521 C   41                GOTO OLDGRP
0522 C                     MOVE DLNO      DLNOST  60
0524 C           DLNO      CHAINDEALS                42
0525 C**N42N06*************SETON*********************46****************   S01119
0525 C  N42N06N11          SETON                     46                   S01119
0526 C                     SETOF                     43
0527 C   06                SETON                     43
     C   11                SETON                     43                   S01119
0528 C           OLDGRP    TAG                             ** OLDGRP TAG**
0529 C**   RESET REC-ID FOR DEAL - NOT ACCESSED YET THIS CYCLE
0530 C***43****************SETON*********************06****************   S01119
0531 C**
     C           *IN43     IFEQ '1'                                       S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C           DTYP      OREQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C****       DTYP      OREQ 'RL'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     MOVE '1'       *IN,11                          S01119
     C                     ELSE                                           S01119
     C                     MOVE '1'       *IN,06                          S01119
     C                     END                                            S01119
     C                     END                                            S01119
0535 C* N43                EXSR UNMAT                                     S01118
0535 C  N43 06             EXSR UNMAT                                     S01118
0536 C  N43                GOTO END
0537 C* 'TLXI' CAN BE UPDATED AS THE   DEALS RECORD IS NOT RELEASED UNTIL
0538 C*  ALL TRANSACTIONS FOR THAT DEAL HAVE BEEN PROCESSED
0539 C***21****************BITON'0'       TLXI                            E11294
0540 C***22****************BITON'2'       TLXI                            E11294
0541 C***23****************BITON'1'       TLXI                            E11294
0539 C   21N11             BITON'0'       TLXI                            E11294
0540 C   22N11             BITON'2'       TLXI                            E11294
0541 C   23N11             BITON'1'       TLXI                            E11294
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           DTYP      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
     C           PYRC      IFEQ 'P'                                       CIR003
     C                     BITON'0'       TLXI                            CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           PYRC      IFEQ 'R'                                       CIR003
     C                     BITON'1'       TLXI                            CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
     C*                                                                   046820
     C** If this is a reversed FRA, update bit 7 to prevent duplicate     046820
     C** cancellation messages being generated.                           046820
     C*                                                                   046820
     C           *IN11     IFEQ '1'                                       046820
     C           CHTP      ANDEQ'R'                                       046820
     C                     BITON'7'       TLXI                            046820
     C                     END                                            046820
     C*                                                                   S01157
     C* IF DEAL IS FR & INPUT CYCLE ZERO RATE FIX DAYS PROCESSING         S01157
     C* HAS BEEN SELECTED                                                 S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C           *INU5     ANDEQ'1'                                       S01157
     C*                                                                   S01157
     C                     BITOF'23'      CNFI                            S01157
     C                     BITOF'34'      TLXI                            S01157
     C*                                                                   S01157
     C** IF PAYMENT CONFIRMATION PRODUCED FOR FRA                         S01157
     C*                                                                   S01157
     C           *IN23     IFEQ '1'                                       S01157
     C                     BITON'3'       TLXI                            S01157
     C                     BITON'2'       CNFI                            S01157
     C*                                                                   S01157
     C** IF RECEIVE CONFIRMATION PRODUCED FOR FRA                         S01157
     C*                                                                   S01157
     C                     ELSE                                           S01157
     C           *IN21     IFEQ '1'                                       S01157
     C                     BITON'4'       TLXI                            S01157
     C                     BITON'3'       CNFI                            S01157
     C                     END                                            S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C/COPY WNCPYSRC,DL0330C002
0542 C* IS IT THE LAST DEAL IN THE GROUP
     C           NXRECI    COMP 'T'                      41
0543 C  N41      DLNO      COMP NXDLNO               4141
0544 C*    UPDATE IF NEXT REC. IS DEAL AMENDMENT
0545 C  N41      NXDASN    COMP 0                    41
0546 C   41                EXSR UPDATE                     UPDAT LF/DEALS
0547 C*                                                       *
0548 C           END       TAG                             **** END TAG **
0549 C* C O N T R O L S
0550 C** TRAILER READ.
     C*
     C   02      NORE      COMP RECIN                U8U8
     C  NU8 02   ZZTOTI    COMP HRWN                 U8U8
     C  NU8 02   ZZTOTD    COMP HRDC                 U8U8
     CLRNU8                EXSR DTHUPD
     CLR         ENDLR     TAG
     C*
     C* TOTALS SPOOL FILE RECORDED BY RCF                                 S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     C**LR*****************PARM *BLANKS   SEQ                      S01117 E264
     CLR                   PARM           SEQ     5                       E264
     CLR                   PARM *BLANKS   @PARM   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C/COPY WNCPYSRC,DL0330C003
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
0558 C/EJECT
0559 C* S U B R O U T I N E S
0560 C*
0561 C********************************************************************
0562 C*
0563 C           HASH      BEGSR                           ***  HASH  ***
0564 C           EAMT      DIV  1000      ZZAMT
0565 C   20                Z-SUBZZAMT     ZZAMT
0566 C                     EXSR GLZADD
0568 C                     ENDSR
0569 C********************************************************************
0570 C/SPACE 3
0571 C********************************************************************
0572 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0573 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0574 C*
0575 CSR         GLZADD    BEGSR                           *** GLZADD ****
0576 C*
0577 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0578 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0579 C*
0580 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0581 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0582 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0583 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0584 C*
0585 CSR                   EXSR GLZSUM
0586 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0587 C*
0588 C********************************************************************
0589 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0590 C*                        GLZADD, GLZSUB, GLZCMP.
0591 C*          PARAMETERS PASSED -
0592 C*                     I/P ZZAMTI ZZAMTD
0593 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0594 C*
0595 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0596 C*
0597 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0598 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0599 CSR                   SETOF                     919293
0600 CSR                   SETOF                     949599
0601 C*
0602 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0603 CSR         ZZAMTI    COMP 0                      9293
0604 CSR 93      ZZAMTD    COMP 0                      9293
0605 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0606 C*
0607 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0608 CSR         ZZTOTI    COMP 0                      9193
0609 CSR 93      ZZTOTD    COMP 0                      9193
0610 C*
0611 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0612 CSR 93                Z-ADDZZAMTI    ZZTOTI
0613 CSR 93                Z-ADDZZAMTD    ZZTOTD
0614 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0615 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0616 CSR 91N92
0617 CORN91 92             GOTO ZZOFPS
0618 C*
0619 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0620 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0621 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0622 C*
0623 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0624 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0625 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0626 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0627 C*
0628 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0629 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0630 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0631 CSRN99                Z-ADDZZWK2     ZZTOTD
0632 CSRN99                Z-ADDZZWK3     ZZTOTI
0633 C*
0634 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0635 CSR 99                Z-ADD0         ZZAMT  153
0636 CSR                   GOTO ZZSEND
0637 C*
0638 C* THE 'SIGNS' ARE DIFFERENT
0639 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0640 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0641 C*
0642 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0643 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0644 C*
0645 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0646 C*
0647 CSR 91                Z-SUBZZTOTI    ZZTOTI
0648 CSR 91                Z-SUBZZTOTD    ZZTOTD
0649 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0650 C*
0651 CSR         ZZTOTI    COMP ZZAMTI               93  95
0652 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0653 C*
0654 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0655 CSR 95                Z-ADD0         ZZTOTI
0656 CSR 95                Z-ADD0         ZZTOTD
0657 CSR 95                GOTO ZZSEND
0658 C*
0659 C* IF ZZTOT GT. ZZAMT.
0660 CSR 93      ZZAMTD    COMP ZZTOTD               94
0661 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0662 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0663 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0664 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0665 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0667 C*
0668 C* IF ZZAMT GT. ZZTOT.
0669 CSRN93      ZZTOTD    COMP ZZAMTD               94
0670 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0671 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0672 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0673 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0674 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0675 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0676 C*
0677 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0678 CSR                   SETOF                     94
0679 CSR 93 91
0680 CORN93 92             SETON                     94
0681 CSR 94                Z-SUBZZTOTI    ZZTOTI
0682 CSR 94                Z-SUBZZTOTD    ZZTOTD
0683 C**
0684 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0685 CSR 92                Z-SUBZZAMTI    ZZAMTI
0686 CSR 92                Z-SUBZZAMTD    ZZAMTD
0687 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0688 C**
0689 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0690 CSR                   SETOF                     96
0691 CSR         ZZTOTD    COMP 0                        91
0692 CSR 91      ZZTOTI    COMP 0                      96
0693 CSR 96                MOVE '.000-'   ZZNEGD  5
0694 CSR                   ENDSR                             ** ENDSR **
0695 C********************************************************************
0696 C/SPACE 3
0697 C********************************************************************
0698 C**   UNMAT SR TO GET DEAL FIELDS TO PRINT 'ITEMS TO BE
0699 C**   INVESTIGATED' REPORT.
0700 C           UNMAT     BEGSR                           ***  UNMAT  ***
0701 C                     SETON                     4485
0702 C* CONVERT VALUE DATE
0703 C                     Z-ADDVDAT      ZDAYNO
0704 C                     EXSR ZDATE2
0705 C* GET NO. DECIMAL PLACES
0706 C******               Z-ADD0         CDP                             S01194
0706 C                     Z-ADD0         A6NBDP                          S01194
0707 C*****      ZTABKY    CHAINTABLE                42                   S01194
     C**N42      RECI      COMP 'D'                  4242                 S01194
     C***42                SETON                     U7U8LR               S01194
     C*
     C***     CALL ACCESS PROGRAM FOR CURRENCY                            S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCY       @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C**                                                                  S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           *LOCK     IN   LDA                                       E47225
     C                     MOVEL'SDCURRPD'DBFILE 10                       S01194
     C                     MOVEL'03'      DBASE   3        ************** S01194
     C                     MOVEL@OPTN     DBOPTN  7        * DBERROR 003* S01194
     C                     MOVELCCY       DBKEY  29        ************** S01194
     C                     OUT  LDA                                       E47225
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*
0708 C*****      CDP       COMP 1                      5051               S01194
0708 C           A6NBDP    COMP 1                      5051               S01194
0709 C*****      CDP       COMP 2                    53  52               S01194
0709 C           A6NBDP    COMP 2                    53  52               S01194
0710 C                     ENDSR
0711 C********************************************************************
0712 C/EJECT
0713 C********************************************************************
0714 C*
0715 C           UPDATE    BEGSR                           ***  UPDATE ***
0716 C***
     C* OBTAIN LAST TRANSACTION NUMBER AND
     C* SET UP STANDARD OUTPUT INFORMATION.
     C                     EXSR ZTNLU1
     C                     MOVE 'DL'      MDID
     C                     MOVEL'DL0330'  PGMN
     C                     MOVE 'XXX'     WSID
     C                     MOVE 'X'       ACTCD
     C                     MOVE USRID     USRIDX
0740 C**
0741 C**   GET RECORD TYPE FOR DEAL
0742 C                     MOVE RCDC      RCDCA   2
0743 C           RCDCA     LOKUPTABDCA    TABDCB         41
0744 C**
0768 C* UPDATE LF/DEALS
0769 C   06                SETON                     71
     C   11                SETON                     71                   S01119
0770 C   06      1         ADD  UPDEAL    UPDEAL  50
0770 C   11      1         ADD  UPDEAL    UPDEAL  50                      S01119
0771 C* UPDATE LF/DEAMS
0772 C   07                SETON                     72
0773 C   07      1         ADD  UPDEAM    UPDEAM  50
0776 C                     EXSR EXCPT
0777 C                     SETOF                     717273
0787 C                     GOTO ENDLOG
     C           ENDLOG    TAG                             ** ENDLOG TAG**
     C* UPDATES FINISHED - END COMMITMENT CYCLE.
     C           CMTTXT    COMIT
     C                     ENDSR
0791 C*
0792 C********************************************************************
0793 C/SPACE 3
0794 C********************************************************************
0795 C           DTHUPD    BEGSR                           *** DTHUPD  ***
0722 C           1         CHAINDTRIXHH              42
     C*
     C* CHECK DTRIX HEADER EXISTS
     C   42
     CORN04                DO
     C                     SETON                     U7U8
0775 C  N42                SETON                     74
0776 C                     EXCPT
0777 C                     SETOF                     74
     C                     GOTO ENDDTH
     C                     END
0774 C* UPDATE PF/DTRIXHH
0775 C                     SETON                     73
0776 C                     EXSR EXCPT
0777 C                     SETOF                     73
     C* UPDATE FINISHED - END COMMITMENT CYCLE.
     C                     COMIT
     C           ENDDTH    ENDSR
     C*
0792 C********************************************************************
0793 C/SPACE 3
0794 C********************************************************************
0795 C           EXCPT     BEGSR                           ***  EXCPT  ***
0796 C                     TIME           TIME    60
0797 C                     EXCPT
0798 C                     ENDSR
0799 C********************************************************************
0800 C/SPACE 3
0801 C********************************************************************
0802 C**
0803 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0804 C**
0805 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0806 C**
0807 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0808 C**
0809 C**   CLEAR DATE FIELDS.
0810 C                     Z-ADD0         ZDATE   60
0811 C                     MOVEL'       ' ZADATE  7
0812 C**
0813 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0814 C                     Z-ADDZDAYNO    ZDAYNO  50
0815 C**
0816 C**   DETERMINE YEAR NUMBER.
0817 C**
0818 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0819 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0820 C   99                GOTO ZDEND2
0821 C**
0822 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0823 C           ZDAYN1    DIV  1461      ZLYR    20
0824 C                     MVR            ZDAYN1           SAVE REMAINING
0825 C**                                                   DAYS
0826 C**   CALCULATE NUMBER OF REMAINING YEARS.
0827 C                     Z-ADD1         ZWRK2   20
0828 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0829 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0830 C  N90      ZWRK2     ADD  1         ZWRK2
0831 C  N90                GOTO ZDTAG1
0832 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0833 C**
0834 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0835 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0836 C**
0837 C**   CALCULATE ACTUAL YEAR NUMBER.
0838 C           ZLYR      MULT 4         ZWRK3   30
0839 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0840 C                     Z-ADDZWRK3     ZYEAR   20
0841 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0842 C**
0843 C**   DETERMINE MONTH NUMBER.
0844 C**
0845 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0846 C                     SETOF                     9293
0847 C   91      ZDAYN1    COMP 59                     9293
0848 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0849 C**
0850 C**   CALCULATE MONTH NUMBER.
0851 C                     Z-ADD2         ZWRK2
0852 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0853 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0854 C  N94      ZWRK2     ADD  1         ZWRK2
0855 C  N94                GOTO ZDTAG2
0856 C           ZWRK2     SUB  1         ZWRK2
0857 C**
0858 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0859 C**
0860 C**   DETERMINE DAY OF MONTH.
0861 C**
0862 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0863 C           ZDAYN1    ADD  1         ZDAYN1
0864 C**
0865 C**   CALCULATE DAY OF MONTH.
0866 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0867 C**
0868 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0869 C   93      ZDAY      ADD  1         ZDAY
0870 C**
0871 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0872 C  N98                MOVELZDAY      ZWRK4   40
0873 C   98                MOVE ZDAY      ZWRK4
0874 C  N98                MOVE ZMTH      ZWRK4
0875 C   98                MOVELZMTH      ZWRK4
0876 C                     MOVELZWRK4     ZDATE
0877 C                     MOVE ZYEAR     ZDATE
0878 C**
0879 C**   FORMAT ALPHA DATE, DDMMMYY.
0880 C           ZDAY      COMP 10                     95
0881 C                     MOVELZDAY      ZWRK5   5
0882 C   95                MOVEL' '       ZWRK5
0883 C                     MOVE ZMNM,ZMTH ZWRK5
0884 C                     MOVELZWRK5     ZADATE
0885 C                     MOVE ZYEAR     ZADATE
0886 C**
0887 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0889 C**
0890 C********************************************************************
0891 C/SPACE 3
0892 C********************************************************************
0893 C*****                                                               S01194
0894 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0895 C*****                                                               S01194
0896 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0897 C*****                                                               S01194
0898 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0899 C*****                MOVEL'01      'ZTABKY 12                       S01194
0900 C*****                MOVE '  10'    ZTABKY                          S01194
0901 C*****                                                               S01194
0902 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0903 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0904 C*****                                                               S01194
0905 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0906 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0907 C*****                                                               S01194
0908 C*****                ENDSR                                          S01194
0910 C*****                                                               S01194
0911 C********************************************************************
     C*
     C*   ZTNLU1 SR. - TO LOCK THE TRANSACTION NUMBER DATA AREA AND
     C*                THEN UPDATE AND RELEASE THE DATA AREA.
     C*
     C           ZTNLU1    BEGSR
     C           *NAMVAR   DEFN MNATN     DNATN
     C           *LOCK     IN   DNATN
     C                     MOVE FNATN     NATN    50
     C                     MOVE FNATN     ZZWK05  50
     C                     ADD  1         ZZWK05
     C                     MOVE ZZWK05    FNATN
     C                     OUT  DNATN
     C                     ENDSR
     C*****************************************************************
     C*                                                                   S01194
     C*   *PSSR SR HANDLES DATABASE ERROR IN NEW STANDING DATA FILES      S01194
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
     C*                                                                   S01194
     C********************************************************************S01194
0912 C/EJECT
0913 O* P R I N T O U T
0914 O*MPRINT  H  203   OF                                                S01125
0914 O**DL0330P1H  203   OF                                        S01125 S01117
0914 O******DL0330P1H  203   10 L1                                        E114
0914 O****** OR        OF 10                                              E114
0914 ODL0330P1H  203   L1                                                 S01117
0914 O       OR        OF                                                 S01117
0915 O******                             22 'REFERENCE DL0330'            S01117
0915 O                                   24 'REFERENCE DL0330P1'          S01117
0916 O******                   TITL      89                               S01194
0916 O                         BJURPT    89                               S01194
0917 O                                  122 'DATE              PAGE'
0918 O******                   RUNA     112                               S01194
0918 O                         BJMRDT   112                               S01194
0919 O                         PAGE  Z  127
0920 O******* H  1     OF                                                 S01117
0920 O******* H  2     10 L1                                              E114
0914 O*******OR        OF 10                                              E114
0920 O        H  2     L1                                                 S01117
0914 O       OR        OF                                                 S01117
0921 O                                   58 'UPDATE PAY/RECEIVE INDIC'
0922 O                                   82 'ATORS - ITEMS TO BE INVE'
0923 O                                   90 'STIGATED'
0924 O******  H  2     OF                                                 S01117
0920 O******* H  2     10 L1                                              E114
0914 O*******OR        OF 10                                              E114
0920 O        H  2     L1                                                 S01117
0914 O       OR        OF                                                 S01117
0925 O                                   58 '------------------------'
0926 O                                   82 '------------------------'
0927 O                                   90 '--------'
0920 O******  H  2     10 L1                                              E114
0914 O****** OR        OF 10                                              E114
0920 O        H  2     L1                                                 S01117
0914 O       OR        OF                                                 S01117
     O                                   12 'BRANCH'                      S01117
     O                         BRCA      16                               S01117
     O                         A8BRNM    48                               S01194
0928 O*****   H  1     OF                                                 S01117
0920 O******* H  1     10 L1                                              E114
0914 O*******OR        OF 10                                              E114
0920 O        H  1     L1                                                 S01117
0914 O       OR        OF                                                 S01117
0929 O                                   25 'RECORD             AMEND'
0930 O                                   53 'VALUE    DEAL  PAY/RECEI'
0931 O                                   60 'VE IND.'
0932 O                                   88 'SETTLE         OUR'
0933 O                                  107 'THEIR'
0934 O*****   H  2     OF                                                 S01117
0920 O*****   H  2     10 L1                                              E114
0914 O*****  OR        OF 10                                              E114
0920 O        H  2     L1                                                 S01117
0914 O       OR        OF                                                 S01117
0935 O                                   26 'TYPE   DEAL NO.  SEQ. NO'
0936 O                                   52 'DATE     TYPE    1    2'
0937 O                                   75 '3      CCY     TYPE'
0938 O**********                        107 'AGENT             AGENT'                         CGL029
0938 O                                  105 'AGENT           AGENT'                           CGL029
0939 O                                  126 'AMOUNT'
0940 O*
0941 O*****   DF 2     44                                                 S01117
0941 O******  DF 2     44 10                                              E114
0941 O        DF 2     44                                                 S01117
0942 O                         RCDT       4
0943 O                         DLNO      16
0944 O                         DASN      24
0945 O                         ZADATE    35
0946 O                         DTYP      39
0947 O                                   40 '-'
0948 O                         DLST      42
0949 O                       21          47 'Y'
0950 O                       22          52 'Y'
0951 O                       23          57 'Y'
0952 O                         CCY       66
0953 O                         SETP      74
0954 O**********               OSAC      94                                                   CGL029
0955 O**********               TSEN     109                                                   CGL029
0956 O**********             50EAMT     126 ' ,   ,   ,   , 0 -'                              CGL029
0957 O**********             51EAMT     128 '   ,   ,   , 0 . -'                              CGL029
0958 O**********             52EAMT     129 '  ,   ,   ,   .  -'                              CGL029
0959 O**********             53EAMT     130 ' ,   ,   ,   .   -'                              CGL029
     O                         OSAC      96                                                   CGL029
     O                         TSEN     108                                                   CGL029
     O                       50EAMT     127 ' ,   ,   ,   , 0 -'                              CGL029
     O                       51EAMT     129 '   ,   ,   , 0 . -'                              CGL029
     O                       52EAMT     120 '  ,   ,   ,   .  -'                              CGL029
     O                       53EAMT     131 ' ,   ,   ,   .   -'                              CGL029
0961 O        T 33     L1N85NU7                                           S01117
     O       AND       25                                                 E114
     O*******AND       10                                                 E114
0962 O                                   77 'THERE ARE NO ITEMS TO BE'    S01117
0963 O                                   90 'INVESTIGATED'                S01117
1012 O********T 2      L1 10                                              E114
1012 O        T 2      L1 25                                              S01117
1013 O                                   66 '*** END OF BRANCH '          S01117
     O                                   76 'REPORT ***'                  S01117
     O*
     O**NO*ITEMS*TO*BE*INVESTIGATED                                       S01117
     O*****                                                               S01117
     O*****   T  203   LRN85                                              S01117
0915 O*****                              22 'REFERENCE DL0330'            S01117
0916 O*****                    TITL      89                               S01117
0917 O*****                             122 'DATE              PAGE'      S01117
0918 O*****                    RUNA     112                               S01117
0919 O*****                    PAGE  Z  127                               S01117
     O*****   T  1     LRN85                                              S01117
     O*****                              68 'UPDATE PAY/RECEIVE'          S01117
     O*****                              79 'INDICATORS'                  S01117
     O*****   T  3     LRN85                                              S01117
     O*****                              69 '-------------------'         S01117
     O*****                              79 '----------'                  S01117
0960 O*****                                                               S01117
0961 O*****   T 3      LRN85NU7                                           S01117
0962 O*****                              77 'THERE ARE NO ITEMS TO BE'    S01117
0963 O*****                              90 'INVESTIGATED'                S01117
     O*****   T 3      U7 U8 LR                                           S01117
     O*****                              22 'REFERENCE DL0330'            S01117
     O*****                              62 'PRINT TERMINATED'            S01117
     O*****                              80 'DATABASE IN ERROR'           S01117
0964 O******* T  203   LR                                                 S01117
     O*                                                                   S01117
0964 ODL0330AUT  203   LR                                                 S01117
0965 O*******                            22 'REFERENCE DL0330'            S01117
0965 O                                   24 'REFERENCE DL0330AU'          S01117
0966 O******                   TITL      89                               S01194
0966 O                         BJURPT    89                               S01194
0967 O                                  122 'DATE              PAGE'
0968 O*****                    RUNA     112                               S01194
0968 O                         BJMRDT   112                               S01194
0969 O******                   PAGE  Z  127                               S01117
0969 O                         PAGE1 Z  127                               S01117
0970 O        T  1     LR
0971 O                                   62 'UPDATE PAY/RECEIVE INDIC'
0972 O                                   86 'ATORS - FILE CONTROL REP'
0973 O                                   89 'ORT'
0974 O        T  3     LR
0975 O                                   62 '------------------------'
0976 O                                   86 '------------------------'
0977 O                                   89 '---'
0978 O        T  1     LR
0979 O                                   28 'S/PRSXM - RUN CONTROLS'
0980 O                                   59 'NUMBER'
0981 O                                   83 'VALUE'
0982 O        T  2     LR
0983 O                                   28 '----------------------'
0984 O                                   59 'OF RECORDS'
0985 O                                   83 'OF RECORDS'
0986 O        T  2     LR
0987 O                                   31 'TOTAL RECORDS - ON FILE'
0988 O                         NORE  3   59
0989 O                         HRWN  Z   80
0990 O                         HRDC      83
0991 O        T  3     LR
0992 O                                   32 'TOTAL RECORDS - CALCULAT'
0993 O                                   34 'ED'
0994 O                         RECIN 3   59
0995 O                         ZZTOTIZ   80
0996 O                         ZZTOTD    83
0997 O                   NU7 U8         118 '***   DIFFERENCE   ***'
0998 O        T  1     LR
0999 O                                   28 'S/DEALS - RUN CONTROLS'
1000 O        T  2     LR
1001 O                                   28 '----------------------'
1002 O        T  3     LR
1003 O                                   29 'TOTAL RECORDS UPDATED'
1004 O                         UPDEAL3   59
1005 O        T  1     LR
1006 O                                   28 'S/DEAMS - RUN CONTROLS'
1007 O        T  2     LR
1008 O                                   28 '----------------------'
1009 O        T  3     LR
1010 O                                   29 'TOTAL RECORDS UPDATED'
1011 O                         UPDEAM3   59
0746 O        T 3      LR U7 U8                                           S01194
0749 O                                   71 '*** PRINT TERMINATED ***'    S01194
     O        T 2      LR U7 U8                                           S01194
     O                                   57 'DATABASE ERROR'              S01194
     O                         DBASE     61                               S01194
     O                                   67 'FILE'                        S01194
     O                         DBFILE    78                               S01194
     O        T 13     LR U7 U8                                           S01194
     O                                   49 'OPTION'                      S01194
     O                         DBOPTN    57                               S01194
     O                                   66 'KEY'                         S01194
     O                         DBKEY     96                               S01194
     O        T 3      LRNU7N25                                           S01194
     O                                   63 '***   NO DETAILS TO REPO'    S01194
     O                                   71 'RT   ***'                    S01194
1012 O******  T 00     LR                                                 S01117
1012 O*****   T 2      LR                                           S01117E299
1013 O******                             71 '*** END OF REPORT ***'       E299
1014 O/EJECT
     O* U P D A T E S
1087 O* LF/ D E A L S
1088 ODEALS   E        71
     O*                                                                   S01157
     O                      N11CNFI     372                               S01157
     O                       11CNFI     574                               S01157
     O**                                                                  S01157
1089 O*************************TLXI*****374***************************    S01119
1089 O                      N11TLXI     374                               S01119
1089 O                       11TLXI     576                               S01119
1090 O*************************RUND*****396P**************************    S01119
1090 O*****                 N11RUND     396P                       S01119 S01194
1090 O**********************N11BJRDNB   396P                       S01194 BUG6799
1090 O*****                  11RUND     596P                       S01119 S01194
1090 O********************** 11BJRDNB   596P                       S01194 BUG6799
1091 O**********************************397 'A'**********************     S01119
1091 O**********************N11         397 'A'                    S01119 BUG6799
1091 O********************** 11         597 'A'                    S01119 BUG6799
1092 O************************ NATN*****400P*************************     S01119
1092 O                      N11NATN     400P                              S01119
1092 O                       11NATN     600P                              S01119
1093 O        D        46
1094 O/SPACE 3
1095 O* LF/ D E A M S
1096 ODEAMS   E        72
1097 O                         DAIN     145
1098 O*****                    RUND     196P                              S01194
1098 O                         BJRDNB   196P                              S01194
1099 O                                  197 'A'
1100 O                         NATN     200P
1101 O        D        45
1102 O/SPACE 3
1103 O* LF/ D T R I X
1104 ODTRIXHH E        73
1105 O                         RRXP      23P
1106 O                         NATN      40P
     O* RELEASE DTRIXHH
1104 O        E        74
     O*
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  TABDCA/TABDCB
11DB12DB14DB15DC16DC17DD18DE20DB
