     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Event file creation')                         *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
     F*                                                               *
     F*  DL0400 - CREATE EVENTS FILE                                  *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CDL099             Date 06Oct17               *
      *  Prev Amend No. CGL187             Date 06Oct17               *
      *                 MD045010           Date 05Apr17               *
      *                 CGL184             Date 07Dec16               *
      *                 MD039107           Date 01Aug16               *
      *                 MD033601           Date 06Aug15               *
      *                 MD031115           Date 23Jun15               *
      *                 CGL165             Date 17Feb15               *
      *                 MD031098           Date 19Nov14               *
      *                 MD027820           Date 19Nov14               *
      *                 CDL096I01          Date 03Nov14               *
      *                 CDL096             Date 26Sep14               *
      *                 CER069             Date 03Jul14               *
      *                 CDL094             Date 01Sep14               *
      *                 MD027339           Date 19Aug14               *
      *                 MD020363           Date 06Jun14               *
      *                 MD024930           Date 11May14               *
      *                 AR996895           Date 25Nov12               *
      *                 AR947093           Date 26Apr12               *
      *                 AR847249           Date 28Jan12               *
      *                 AR854630           Date 13Nov11               *
      *                 CER049             Date 06Dec10               *
      *                 CRE073             Date 06Dec10               *
      *                 AR787620           Date 10Jun11               *
      *                 CLE064             Date 06Dec10               *
      *                 AR734446           Date 18Mar11               *
      *                 263666             Date 01Feb10               *
      *                 261175             Date 20Aug09               *
      *                 259640             Date 02Apr09               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26839           Date 05Jan10               *
      *                 BUG26475A          Date 01Dec09               *
      *                 BUG26475           Date 26Oct09               *
      *                 CER054             Date 07Apr09               *
      *                 BUG22911           Date 17Feb09               *
      *                 CER016A            Date 19May08               *
      *                 CER048             Date 19May08               *
      *                 BUG28009           Date 14Aug10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 258536             Date 21Jan09               *
      *                 246380             Date 27Jun07               *
      *                 247618             Date 06Jan07               *
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 169798             Date 04Dec06               *
      *                 243447             Date 03Nov06               *
      *                 CRE026             Date 24May06               *
      *                 BUG13030           Date 10Jan07               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242892             Date 06Oct06               *
      *                 242286             Date 25Sep06               *
      *                 230229             Date 25Sep06               *
      *                 CPK025             Date 12Oct06               *
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 155498             Date 06Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG10282           Date 04Feb06               *
      *                 BUG9784            Date 06Jan06               *
      *                 235330             Date 04Aug05               *
      *                 234341R            Date 30Jun05               *
      *                 234341R            Date 29Jun05               *
      *                 234341             Date 24Jun05               *
      *                 CDL038             Date 10May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CDL033             Date 10Feb05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 228545             Date 23Aug04               *
      *                 228544             Date 16Aug04               *
      *                 226512             Date 23Apr04               *
      *                 220738             Date 28Aug03               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 BUG3620            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CDL022             Date 31Mar03               *
      *                 CDL020             Date 30Mar03               *
      *                 CDL019             Date 30Mar03               *
      *                 CDL017             Date 15Mar03               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS005             Date 16Dec02               *
      *                 CGL015             Date 15Apr02               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4.01 -------------------------------------------*
      *                 136237             Date 26Oct01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 121875             Date 20Jul01               *
      *                 151104             Date 14Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 164532             Date 05Apr01               *
      *                 181604             Date 29Jan01               *
      *                 153330             Date 10Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 141731             Date 28Nov00               *
      *                 179203             Date 01Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
     F*                 152893             Date 03Jul00               *
      *                 CIR004             Date 20Jan00               *
     F*                 101258             Date 10MAY96               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 CPB001             Date 18Jun99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 132172             DATE 02Oct98               *
      *                 150457             Date 11Dec98               *
     F*                 149234             Date 14DEC98               *
     F*                 149415             Date  2DEC98               *
     F*                 145001             Date 25Nov98               *
     F*                 138007             Date 05Nov98               *
     F*                 138004             Date 21OCT98               *
     F*                 CEU015             Date 18Feb98               *
     F*                 137223             Date 17Jun98               *
     F*                 134625             Date 05MAY98               *
     F*                 130756             Date 28MAR98               *
     F*                 CEU003             Date 28MAR98               *
     F*                 084826             DATE 15JAN98               *
     F*                 126017             DATE 14NOV97               *
     F*                 102129             Date 23Sep97               *
     F*                 CDL002             Date 16Sep97               *
     F*                 101985             DATE 03MAR97               *
     F*                 097885             DATE 31JAN97               *
     F*                 S01408             DATE 03SEP96               *
     F*                 S01408             DATE 27AUG96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 S01408             DATE 22MAY96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 S01408             DATE 07DEC95               *  *
     F*                 073893             DATE 09OCT95               *  *
     F*                 077164             DATE 09OCT95               *  *
     F*                 082738             DATE 09FEB95               *
     F*                 S01408             DATE 25APR95               *
     F*                 080698             DATE 19JAN95               *
     F*                 081766             DATE 17JAN95               *
     F*                 082475             DATE 20FEB95               *
     F*                 S01486             DATE 04OCT94               *
     F*                 055773             DATE 26MAY94               *
     F*                 031578             DATE 26APR94               *
     F*                 060306             DATE 02MAR94               *
     F*                 066550             DATE 04FEB94               *
     F*                 025121             DATE 03FEB94               *
     F*                 S01434             DATE 06AUG93               *
     F*                 S01378             DATE 15OCT92               *
     F*                 S01393             DATE 22SEP92               *
     F*                 S01220             DATE 18AUG92               *
     F*                 S01392             DATE 20JUL92               *
     F*                 E38323             DATE 31JUL92               *
     F*                 E38730             DATE 08JUL92               *
     F*                 E37702             DATE 08JUL92               *
     F*                 AUS003             DATE 01JUL92               *
     F*                 E25364             DATE 12FEB92               *
     F*                 S01354             DATE 08JAN92               *
     F*                 E21775             DATE 05JUL91               *
     F*                 DT0206             DATE 02JUN91               *
     F*                 S01332             DATE 13MAY91               *
     F*                 BHF936             DATE 13NOV90               *
     F*                 BHF880             DATE 05NOV90               *
     F*                 BHF676             DATE 15SEP90               *
     F*                 S01314             DATE 18DEC90               *
     F*                 E20644             DATE 14JUN90               *
     F*                 E15988             DATE 01FEB90               *
     F*                 E12206             DATE 01FEB90               *
     F*                 LN0447             DATE 28JUN90               *
     F*                 LN0127 (E344)      DATE 08MAY90               *
     F*                 E325 (LN0025)      DATE 27APR90               *
     F*                 E17215             DATE 17APR90               *
     F*                 E269               DATE 14MAR90               *
     F*                 E251               DATE 07MAR90               *
     F*                 E256               DATE 03MAR90               *
     F*                 E184               DATE 14DEC89               *
     F*                 E181               DATE 13DEC89               *
     F*                 E166               DATE 08DEC89               *
     F*                 E165               DATE 08DEC89               *
     F*                 E57                DATE  20NOV89              *
     F*                 S01195             DATE 10/03/89              *
     F*                 S01194             DATE 10/03/89              *
     F*                 S01117             DATE 08/03/89              *
     F*                 E15116             DATE 19/09/88              *
     F*                 E11058             DATE 06/05/88              *
     F*                 S01147             DATE 10/12/87              *
     F*                 E10423             DATE 20/07/87              *
     F*                 S01119             DATE 15/06/87              *
     F*                 E10847             DATE 22/04/87              *
     F*                 E10714             DATE 22/04/87              *
     F*                 E10028             DATE 19/03/87              *
     F*                 S01095             DATE 25/09/86              *
     F*                 S01108             DATE 25/09/86              *
     F*                 E80945             DATE 10/09/86              *
     F*                 E43430             DATE 10/09/86              *
     F*                 E80540             DATE 10/09/86              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CDL099 - Split Value Date                                    *
      *  CGL187 - Amendment to Net Trading Position Report            *
      *  MD045010 - Component LEC06A 10008 looping during COB caused  *
      *             by CGL184. Recompile due to changes in ZFRQB3.    *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  MD039107 - Make sure that there is no negative amount in the *
      *             projection.                                       *
      *  MD033601 - MM Deal Rollover with increase leads to wrong     *
      *             forecast and no payment message                   *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *  MD031115 - Proj. A/C Movements wrong DR/CR indicator in case *
      *             of interest due posting amount is negative. For   *
      *             SI deal amendments, negate sign of amount if deal *
      *             has negative interest rate.                       *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  MD031098 - MM Taxable Call Deposit's Interim interest pay-   *
      *             ment MT103 has a wrong/strange amount.            *
      *           - Correct the Interest amount for tax calculation.  *
      *           - Applied for MD031111                              *
      *  MD027820 - MM Time Deposit (taxable acc. to CER048): payment *
      *             message (MT103) not generated for interim int pay *
      *           - Applied for MD031111                              *
      *  CDL096I01 - CDL096 Fixes                                     *
      *  CDL096 - Business Day Conventions for MM Deals               *
      *  CER069 - German Tax Enhancement                              *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompile)                                         *
      *  MD027339 - CGL035+CER048 Taxable deposit maturity: A/C       *
      *             projected movement (principal + net interest)     *
      *             deducts only main tax instead of both taxes.      *
      *           - Include second tax when CER048 is ON and third    *
      *             tax when CER054 is switched ON.                   *
      *  MD020363 - Include MM deal exposure from the VALUE DATE      *
      *             rather than DEAL DATE. Reverse part of fix 169798.*
      *           - Applied for MD027409.                             *
      *  MD024930 - DLC0607 00001 failed due to divide by zero        *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  AR947093 - Base Rate amendment resulted to 0 interest rate   *
      *  AR847249 - Perform exception handling when Final rate is     *
      *             negative or zero.                                 *
      *  AR854630 - Program loops when there are long periods of      *
      *           holidays set up in the system. Apply fix 255705.    *
      *  255705 - Component DLC0607 has been running for 2 hours      *
      *  CER049 - Stamp Tax                                           *
      *  CRE073 - Interest Rate Rounding                              *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,DLH00035                                 *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  AR734446 - Parameter mismatch (Child: AR735370)              *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  261175 - For settlement '05', need not to change to '00'     *
      *           as this gives wrong information in DL0670P1.        *
      *  259640 - Reversed fix 247618, AITC is not being computed on  *
      *           interest payment.                                   *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26839 - JA1_Threshold limit of the main joint customer was*
      *             utilized by the member                            *
      *  BUG26475A - DLC0400 00001. Reverse changes done by BUG26475  *
      *  BUG26475 - DLC0607 00001                                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  BUG22911 - Changes for Correct Tax Calculation               *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER048 - German Features - Taxes                             *
      *  BUG28009 - GLC0802C 00001                                    *
      *  CSC042 - COB performance fixes                               *
      *           Attempt to reduce number of calls to AOCUST by using*
      *           last set of data if this call is same as last call  *
      *  258536 - Include field BCXR in Negotiable Assets Sold.       *
      *  246380 - Shadow posting was generated for a nostro account   *
      *           even though account used is an internal account but *
      *           is not a nostro account. Parameters passed for call *
      *           to AONOSTR0 is wrong (introduced by 242892).        *
      *  247618 - Sync computation of interest with DL0280 processing.*
      *           For deals that have interest payments that have not *
      *           yet valued, consider previous I2 event for maturity *
      *           interest processing.                                *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  169798 - Include MM deal exposure from the Deal Date rather  *
      *           than Value Date.                                    *
      *           If MM transaction and rollover deal, include in     *
      *           exposure on Value Date.                             *
      *  243447 - Array index record error in DL0400 when CDL033 is   *
      *           switched on and SR/SRFRC4 is executed.              *
      *  CRE026 - Consumer Banking (Recompile)                        *
      *  BUG13030 - Execute subroutine SRFRC4 if rate change date is  *
      *             not zero.                                         *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242892 - DLC0802C crashes if OSAC1 is alpha                  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  230229 - Interest events for call deal not being shown on    *
      *           cash flow reports.                                  *
      *  CPK025 - MidasPlus 1.3 packaging. Further Customer Number    *
      *           changes.                                            *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  155498 - Incorrect interbranch events on GL0551P1 Daily      *
      *           Events by Currency Report. Amended to reflect       *
      *           settlement branch name in details.                  *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG10282 - Fix field CLAS for DEALSDC.                       *
      *  BUG9784 - Incorrect field positions in file EMXT2D2.         *
      *  235330 - A database error must be given in *PSSR subroutine  *
      *  234341R- Place SDBRCHL1 into User Control Open/Close to avoid*
      *           file being reopened in DL0401.                      *
      *  234341R- Change the access of AOBRCHR0 to access the branch  *
      *           code array instead (Reopen)                         *
      *  234341 - EU Tax not being subtracted from INTDUE for event   *
      *           types 16I2 and 16M2 for deal types CD TD DT DP.     *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  228545 - Event was posted on a holiday instead of next       *
      *           working day                                         *
      *  228544 - Monthly interest payments missing on MM4111 report  *
      *  226512 - Some events related to CAS005 have blank in position*
      *           4 of event code.  Suppress legacy events for CAS005.*
      *  220738 - Dump if customer is closed                          *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  BUG3620- Apply Base Rate at Value Date for Spread Changes    *
      *  CLE025 - Credit Lines                                        *
      *  CDL022 - Deal Amendment Changes                              *
      *  CDL020 - Apply Base Rate at Value Date                       *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *  CDL017 - Penalty Fees and Early Maturity of Fixed Term Deals *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  CGL015 - Net Amounts on Events by Nostro.                    *
      *  136237 - The exposure amount in the dealing report for       *
      *           ccy other than the base currency should be the      *
      *           equivalent of the purchase at the current spot      *
      *           rate and not at the contract rate.                  *
      *  121875 - If base ccy equivalent is zero do not do divide.    *
      *  151104 - Allow up to 900 branches.                           *
      *  164532 - Applied fix 148549.  Ignore matured deals when      *
      *           there is an error after calling AOCUSTR0.           *
      *  181604 - Exclude from Outstanding Delivery Instructions      *
      *           Report those deals with Interest Paid Separately    *
      *           set to 'Y' and no Interest Settlement Details but   *
      *           with Maturity Settlement Details.                   *
      *  153330 - When negative interest indicator is ON, negate TOTI *
      *           to reflect correct event amount.  Apply fix 154920. *
     F*  141731 - Amended fix 084826 to exclude deal type C2 in       *
     F*           having Yield rate setup as RATE.                    *
      *  179203 - Incorrect Projected Account Mvmt for deals where    *
      *           interest is capitalised - should project a movement *
      *           only if interest to be settled = 'N'.  Need 4 fixes:*
      *           1) Set off *IN59 (used to check INTC value) at start.
      *           2) Amended fix 101985 to check value of INTC for    *
      *              deals as well as deal amends, and check at start *
      *              of processing so it includes all DEALSDC records.*
      *           3) Amended fix 101985 to set on *IN59 for amend type*
      *              CI irrespective of INTC value on DEALSDI.        *
      *           4) Amend Call/Notice deal processing to output      *
      *              interest event only if INTC is 'N'.              *
     F*  152893 - There were no postings for deals settled with       *
     F*           Interest Paid Separately set to 'Y'.                *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  101258 - Some Nostro Events are not appearing on Gl0580 if   *
     F*           settlement account and transaction in different     *
     F*           branches because settlement branch was being        *
     F*           overwritten by POBR or ROBR - amend pgm to default  *
     F*           settlement branch only of not set up already.       *
     F*  CPB001 - 'Private Banking' Module                            *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  132172 - Do not skip generation of event for deal amendment  *
     F*           e.g. SC, SI, PD & PI if the value date is greater   *
     F*           than the next working day.  Fix 101985 should only  *
     F*           cater for CI deal amendment.   Apply fix 129005.    *
     F*           than 15M1, 15M2, 16M1, 16M2, 17M1 and 17M2. Caused  *
     F*           by 138004.                                          *
     F*         - Invalid DB error 18.                                *
     F*  150457 - Set up event amount correctly for event types other *
     F*  149234 - WRONG EURO EVENT FOR FX DEALS                       *
     F*  149415 - Default deal branch to event branch in cases where  *
     F*         - settlement information is not established.          *
     F*  145001 - CEU015 fix: Remove CEU015 changes as RBDA is again  *
     F*           expressed in deal currency.                         *
     F*  138007 - Extension of errors found alongside 138004          *
     F*         - Event branch not being set up correctly.            *
     F*  138004 - Problem with events not being  split for Interest   *
     F*         - when deal request that interest should be split.    *
     F*           same fix to resolve problem on 138004/6/7. Additional
     F*           problem with blanks being introduced to numeric     *
     F*           field SETTYP causing problems with access object    *
     F*           AONOSTPD.                                           *
     F*  CEU015 - EMU Enhanced MM Deal Rollover                       *
     F*  137223 - Blank Evnt Brnch causing DB error in GL0541.        *
     F*         - Evnt Brnch for Trans. ccy reversal for Euro         *
     F*           Settlement ccy evnt should be the branch of the     *
     F*           transaction and the branch of the settlement.       *
     F*  134625 - Settlements not using Euro currency.                *
     F*  130756 - Interest event for Money Market Deal is not being   *
     F*           reflected to the Interest Settlement Account when   *
     F*           interest is paid separately                         *
     F*  CEU003 - Settlement currency conversion.  When an event is   *
     F*           written with settlement details and if the          *
     F*           transaction holds a settlement currency, 2 new      *
     F*           events will be generated for each existing          *
     F*           transaction currency event. One is to cancel the    *
     F*           effect of the transaction currency event and the    *
     F*           other will provide a cashflow in settlement ccy.    *
     F*  084826 - Interest or Discount/Yield rate not shown for some  *
     F*           deals. Fix is to set up RATE correctly for deal     *
     F*           types TA, TB, DA and C2.                            *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  102129 - The settlement type is being zeroised for a rate    *
     F*           change deal amendment (SC) causing events not to be *
     F*           included in the events by nostro report GL0580P2.   *
     F*  CDL002 - FX Netting. Stop EM extract records being generated *
     F*           for deals which are being netted.                   *
     F*           Stop EM event records being generated for deals     *
     F*           which are being netted.                             *
     F*  101985 - Events should not generate for deals amendment which*
     F*           has value date greater than next working day.       *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  S01408 - Addition of core hook DL0400CP13                    *
     F*           Addition of core hook DL0400CP12                    *
     F*           Addition of core hook DL0400IIP2                    *
     F*  S01408 - Addition of core hook DL0400CCP8                    *
     F*           Addition of core hook DL0400CCP9                    *
     F*           Addition of core hook DL0400CP10                    *
     F*           Addition of core hook DL0400CP11                    *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           Output profit center to the DL events file.         *
     F*  S01408 - Addition of core hook DL0400FFP1                    *
     F*           Addition of core hook DL0400EEP1                    *
     F*           Addition of core hook DL0400IIP1                    *
     F*           Addition of core hook DL0400CCP7                    *
     F*           Addition of core hook DL0400CCP6                    *
     F*           Addition of core hook DL0400CCP5                    *
     F*           Addition of core hook DL0400OOP3                    *
     F*           Addition of core hook DL0400OOP2                    *
     F*           Addition of core hook DL0400OOP1                    *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  S01408 - Addition of core hook DL0400CCP4                    *
     F*  073893 - Parent Customer Name is not written to file when       *
     F*           deal is followed by a matured deal of the same         *
     F*           customer and caused blank customer name of DL0761P   1.*
     F*  077164 - Some Nostro Events are not appearing on Gl0580.     *
     F*           This is because OSBR is not being output to         *
     F*           EVNTXED. Fix is to use the Nostro Branch for the    *
     F*           settlement branch.                                  *
     F*  082738 - Settle interest event generated with zero amount    *
     F*           when there was a Principal Decrease on the date of  *
     F*           next working day. This is because field PDTOT is    *
     F*           used up to and including date of next working day   *
     F*           for no understandable reason.                       *
     F*  S01408 - Addition of core hook DL0400FFPG                    *
     F*           Addition of core hook DL0400CCPG                    *
     F*           Addition of core hook DL0400CCP1                    *
     F*           Addition of core hook DL0400CCP2                    *
     F*           Addition of core hook DL0400CCP3                    *
     F*  080698 - Interbranch posting must not be setup with          *
     F*           Portfolio reference                                 *
     F*  081766 - Output of Portfolio reference on a non Portfolio    *
     F*           customer                                            *
     F*  082475 - If Recipients correspondent is entered on the deal  *
     F*           amendment settlement screen, set the full instruct- *
     F*           ions present indicator to 'Y' on the event.         *
     F*  S01486 - Portfolio Management Upgrade to Release 10.         *
     F*  055773 - If Accrual for Non-working days indicator is 2 then *
     F*           the following checking is needed.  If the Accrual/  *
     F*           Profit Date is less than or equal to Date of Next   *
     F*           Working Day minus 1, then the Event Control Date    *
     F*           should be the Accrual/Profit Date.  Otherwise,      *
     F*           Event Control Date should be Run Date.              *
     F*  031578 - Hash total calculation for deals file differs from  *
     F*           processing in DL0280. (Negative amounts).           *
     F*  060306 - DL0660: Outstanding deals by customers              *
     F*           for CALL account incorrect.  To maintain            *
     F*           consistency, 'ADD' and 'SUB' have been assigned     *
     F*           to 'PI' and 'PD' of deal amendments,                *
     F*           respectively in SUBRTN: CALNOT.                     *
     F*           (Applied fix 048726).                               *
     F*  066550 - GLINTC has had historical problems and inaccuracies *
     F*           and is now externaly descibed and changed to use    *
     F*           ZINTDYZ1. See document atached to error no on GEMS  *
     F*  025121 - Settlement details are complete if 'For a/c of'/    *
     F*           '/FACO/'Field 58 Beneficiary' is filled in.         *
     F*           Complete deals are appearing on the Outstanding     *
     F*           Delivery instructions report.                       *
     F*  S01434 - Rollover Enhancement                                *
     F*  S01378 - Facilitates the partial sale of a parcel            *
     F*           of negotiable instruments which have been           *
     F*           previously input to the system as a single          *
     F*           transaction (was MOF53). Must ensure events         *
     F*           reflect the partial sale of NA's. Add parcel        *
     F*           flag to events file.                                *
     F*           Note that when this is run (after DL0280) rcd       *
     F*           for NA's purchased on deals file will have had      *
     F*           Purchase amount, Face value, Parcel size            *
     F*           reduced to remove sold portions of the NA. So       *
     F*           NA purchased events will reflect the sold portion   *
     F*           'automatically'.                                    *
     F*  S01393 - Upgrade Strategic Risk Management to R10            *
     F*           Do not output SRM multibranch events 'S1' and 'S2'  *
     F*  S01220 - Strategic Risk Management annendment:               *
     F*           Book Code added to DL Event File, PF/EVNTXED.       *
     F*           New Internal Contract Events, 20S1 and 20S2,        *
     F*           generated (identical to currently generated         *
     F*           FX events, 20V1 and 20V2 EXCEPT bookcode used       *
     F*           is MM bookcode (1st Leg deal);                      *
     F*           FX Events generated at 2nd Leg (20V1 and 20V2)      *
     F*           ammended to have FX bookcode (instead of MM         *
     F*           bookcode)                                           *
     F*  S01392 - JAP.SUB-MODULE INCORPORATION (CORE)                 *
     F*  E38323 - Recompiled over changed copy source ZFWDT subr.     *
     F*  E38730 - Fix E37702 causes interest amount for bond          *
     F*           purchased to be $0.00                               *
     F*         - Bypass subtraction of IPRD from INTDUE and other    *
     F*           undesired INTDUE computations for NASP deals,       *
     F*           without overriding the last fix applied             *
     F*  E37702 - Accrued interest adjustments made to deals          *
     F*           are not being included in the amounts reported      *
     F*           on the Daily Events by Currency report (DL0550)     *
     F*           or the Amount Events by Nostro report (DL0580)      *
     F*  AUS003 - AUSTRALIAN PRODUCT - INTEREST TO CALENDER MONTH     *
     F*           END.                                                *
     F*  E25364 - Generation of settlement Interest and next          *
     F*           Payment date events for Call/Notice Deals           *
     F*           including fix of incorp error of E21775             *
     F*  S01354 - Add internal funding deal processing                *
     F*  E21775 - Call/notice deal interest on maturity amount is     *
     F*           not output to the 'other amount' field on M1 recs   *
     F*           (E17215 is incomplete)                              *
     F*  DT0206 - DECREMENTAION OF DAYNO DOES NOT OCCUR               *
     F*  S01332 - Release 10 Exposure Mgmt, add Value Date and        *
     F*           Maturity Date fields to Tomorrows Events file       *
     F*  BHF936 - PSTM AND PONS SHOULD BE ADDED TO DEALSDD AND DEALSDE*
     F*  BHF880 - PARENT SHOULD BE OUTPUT FOR ALL CUSTOMERS           *
     F*  BHF676 - NAS FIELDS ARE INCORRECT, CAUSING DATABASE ERROR    *
     F*           FOR EBRC                                            *
     F*  S01314 - PTF incorporation changes                           *
     F*  E20644 - FORWARD REVALUATIONS OF DEPOSIT INTEREST EVENTS     *
     F*           ARE BEING OUTPUT WITH INCORRECT DBCE.               *
     F*  E15988 - IF THE VALUE DATE OF A DATE AMENDMENT EXCEEDS       *
     F*           THAT OF NEXT WORKING DAY THEN THIS AMENDMENT        *
     F*           SHOULD BE SHOWN ON THE DEALING REPORT BUT NOT ON    *
     F*           EXPOSURE MANAGEMENT REPORTS.                        *
     F*  E12206 - INCREASING THE NUMBER OF FIELDS OUTPUT TO           *
     F*           EMXT2D2.                                            *
     F*  LN0447 - CORRECT DB ERROR PROCESSING TO SDTRADPD, SDMMODPD.  *
     F*           REMOVE 'COUNT' VARIABLE.                          D.*
     F*           RESET INDICATOR 40                                  *
     F*  LN0127 - 'AU' REPORT SHOULD NOT HAVE 'END OF REPORT' (E344)  *
     F*  E325   - (CROSS REF ERROR NO LN0025) -                       *
     F*           SHOULD USE LOCATION WHEN CONSIDERING NEXT WORKING   *
     F*           DAY.  LOCATION WILL DEPEND ON SETTLEMENT METHOD.    *
     F*  E17215 - EVENT TYPES ADDED TO TAB1/TAB2 WHICH WERE PRESEN  T *
     F*           ON S/36 BUT NOT ON AS400.                           *
     F*  E269   - INCORRECT EVENT BRANCH SET UP                       *
     F*  E251   - INCORRECT USE OF OPCODES WHEN SETTING UP EXEI       *
     F*  E256   - PROGRAM OUTPUTTING INCORRECT EVENT BRANCH           *
     F*  E184   - PROGRAM NOT WRITING OUT PARENT DETAILS TO EXTRACT   *
     F*  E181   - PARENT IND BEING COMPARED TO 'Y' NOT 'P'            *
     F*  E166   - LENGTH OF COPYRIGHT FIELD NOT CORRECT               *
     F*  E165   - FIX TO REMOVE ANY REFERENCES TO RCF PROCESSING IF   *
     F*           ONLY AN 'AU' REPORT PRODUCED                        *
     F*  E57    - REPLACE SET UP OF FIELDS BRCA & COBB ON EVNTXED     *
     F*  S01195 - NEW STANDING DATA - HOLIDAY PROCESSING              *
     F*  S01194 - REPLACING STANDING DATA FILES WITH ACCESS OBJECTS   *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  E15116 - 'FULL INSTRUCTIONS' INDICATOR SET ON WRONGLY.       *
     F*  E11058 - FOR DATABASE ERRORS SWITCH U7 IS SET ON BUT NOT     *
     F*           LR, SO PROCESSING DOES NOT FINISH.                  *
     F*  S01147 - RELEASE 22                                          *
     F*  E10423 - PGM SETS UP PARENT INDICATOR ON EVNTXED AS 'Y'      *
     F*           OR BLANK INSTEAD OF '1' OR '0'.                     *
     F*  S01119 - FORWARD RATE AGREEMENTS/INTEREST RATE SWAPS         *
     F*  E10847 - DEAL AMENDMENTS VALUED LATER THAN NEXT WORKING      *
     F*           DAY SHOULD NOT BE PROCESSED.                        *
     F*  E10714 - INCLUDE OPTION TAKEDOWNS IN EXPOSURE                *
     F*  E10028 - AMEND THE OUTPUT RECORD TO FILE EMTE2E2             *
     F*           TO INCLUDE SETTLEMENT TYPE (SETT) AS A FIELD        *
     F*           ON THE FILE                                         *
     F*  S01128 - OUTPUT FX SALE EVENT TO MASTER FILE EXTRACT         *
     F*           AND TOMORROW"S EVENTS FILE.                         *
     F*  S01095 - IMPROVEMENTS TO PGM EFFICIENCY                      *
     F*           (A) OBTAIN CCY DETAILS FROM PRE-EX TIME ARRAYS      *
     F*           (B) LOAD COUNTRY/REGION CODES INTO EX TIME          *
     F*           ARRAYS                                              *
     F*           (C) STOP UNNECESSARY EXECUTION OF SR ZDATE5         *
     F*           (D) DEALS ARE READ THRU LF/CUSDE, SO CUSTOMER       *
     F*           DETAILS ARE ACCESSED ONLY ON CHANGE OF CUSTOMER.    *
     F*           SETTLEMENT INSTRUCTIONS OUTPUT TO EVENTS NOT        *
     F*           REQUIRING THEM                                      *
     F*           NEGATIVE INTERST INDICATOR OUTPUT INCORRECTLY       *
     F*           TO EVENTS FOR CALL DEALS                            *
     F*           DEAL AMENDMENT SEQ NO OUTPUT TO EVENTS NOT          *
     F*           REQUIRING IT                                        *
     F*  S01108 - PROCESS NOSTRO XFER DEALS                           *
     F*  E80945 - INDICATOR 98 SETTING IS SAVED AND RESTORED          *
     F*           WHEN S.R.GLINTC IS PERFORMED.                       *
     F*                                                               *
     F*****************************************************************
     F*EALS***IP**F*****400  6AI     2 DISK                           *
     F*                                                               *
     F*****************************************************************
0013 F*DEAMS***IF**F*****200 14AI     2 DISK                              082475
0013 F*DEAMS***IF  F     346 14AI     2 DISK                       082475 CEU003
     F***DEAMS** IF  F     843 14AI     2 DISK                                         CEU003 CGL029
     F*DEAMS   IF  F     843 14AI     2 DISK                        CEU003CDL022
     F*DEAMS   IF  F     933 14AI     2 DISK                                                  CGL029
     F*DEAMS***IF**F*****963*14AI*****2*DISK                                           CDL017 CDL038
     F***DEAMS***IF**F**   967 14AI     2 DISK                                         CDL038 CRE073
     FDEAMS   IF  F     985 14AI     2 DISK                                                   CRE073
     FSDJACCLBIF  E           K        DISK                                                   234341
0014 F***NT   IF  F     256  7AI     2 DISK                               S01194
0015 F***LE   IF  F      96 12AI     2 DISK                               S01194
     FTABTG30 IT  F      40           EDISK                               S01195
0012 F*USDE   IP  F     400  6AI     2 DISK                               S01117
0012 F***CUSDE***IP**F    1075  6AI     2 DISK                      S01117AUS003
     F***CUSDE1**IP**F    1075  6AI     2 DISK                      AUS003S01434
     F***CUSDE1**IP**F    1142  6AI     2 DISK                      S01434S01486
     F***CUSDE1**IP**F    1154  6AI     2 DISK                      S01486CDL002
     F*CUSDE1  IP  F    1199  6AI     2 DISK                       CDL002 CEU003
     F*CUSDE1**IP**F    2006  6AI     2 DISK                       CEU003 CEU015
     F*CUSDE1**IP**F    2009  6AI     2 DISK                       CEU015 145001
     F***CUSDE1* IP  F    2006  6AI     2 DISK                                         145001 CAS005
     F***CUSDE1* IP  F    2387  6AI     2 DISK                                         CAS005 CGL029
     F*CUSDE1**IP**F****2540**6AI*****2*DISK                                           CGL029 CDL038
     FCUSDE1  IP  F    2606  6AI     2 DISK                                                   CDL038
     F/COPY WNCPYSRC,DL0400F004
     F***DEALS** IF  F     402  6AI   285 DISK                                         S01220 CGL029
     FDEALS   IF  F    2319  6AI   285 DISK                                                   CGL029
     F/COPY WNCPYSRC,DL0400F001
     F***SDBRCHL1IF  E                    DISK                                         S01194 234341
     FSDBRCHL1IF  E                    DISK                           UC                      234341
     F*                                                                   S01408
     FDLCCGDL0IF  E           K        DISK                           UC  CDL006
      ** Midas DL Charge Types Codes file (FDCCY/FDCCOM).                 CDL006
      *                                                                   CDL006
      ** Midas DL Deals Extension File                                                        CLE025
     FDLDEALL5IF  E           K        DISK                           UC                      CLE025
     F            DLDLDGD0                          KIGNORE                                   CLE025
      *                                                                                       CLE025
     F/COPY WNCPYSRC,DL0400FFPG                                           S01408
      *                                                                                       CDL033
     FDLFRSCL3IF  E           K        DISK                           UC                      CDL033
      ** Midas DL FRCD Issued Date Schedule                                                   CDL033
      ** (unprocessed interest payment dates) file                                            CDL033
      *                                                                                       CDL033
     FDLFRSCL2IF  E           K        DISK                           UC                      CDL033
     F            DLFRSCD0                          KRENAMEDLFRSCD1                           CDL033
      ** Midas DL FRCD Issued Date Schedule                                                   CDL033
      ** (unprocessed rate change dates) file                                                 CDL033
     F*                                                                   S01408
0016 F*VNTXEC O   F     320            DISK                               E57
0016 F*VNTXED O   F     320            DISK                               E57
0016 F*VNTXZZ O   F     320            DISK                               E57
0016 FEVNTXEC O   F     326            DISK                               E57
0016 F*VNTXED*O***F     326            DISK                           E57 S01392
0016 F*VNTXED*O***F     333            DISK                         S01392S01220
0016 F*VNTXED*O***F*****335            DISK                         S01220S01378
0016 F***EVNTXED*O***F*****337            DISK                      S01378S01434
0016 F***EVNTXED*O***F     338            DISK                      S01434S01486
0016 F***EVNTXED*O***F     342            DISK                     S01486 CAC001
     F/COPY WNCPYSRC,DL0400F002
     F*EVNTXED*O   F     346            DISK                       CAC001 CEU003
     F***EVNTXED*O***F     348            DISK                     CEU003 CDL006
0016 F***EVNTXED*O***F     363            DISK                                         CDL006 CGL015
     F***EVNTXED O   F     370            DISK                                         CGL015 CGL029
     F***EVNTXED O   F     386            DISK                                         CGL029 CLE025
     F*EVNTXED*O***F*****397************DISK                                           CLE025 CDL038
     FEVNTXED O   F     405            DISK                                                   CDL038
     F/COPY WNCPYSRC,DL0400F003
     FEVNTXEX0O   E                    DISK                           UC                      CGL187
0016 FEVNTXZZ O   F     326            DISK                               E57
     FEMTE2H1 O   F     128            DISK                      A    U1
     FEMXT2H1 O   F     128            DISK                      A    U1
     FEMTE2E2 O   F     128            DISK                      A    U1
     FEMXT2D2 O   F     128            DISK                      A    U1
     FEMTE2T1 O   F     128            DISK                      A    U1
     FEMXT2T1 O   F     128            DISK                      A    U1
0017 F****00P1O   F     132            PRINTER                    S01124  S01117
0017 F*L0400AUO   F     132            PRINTER                            S01117
0017 F**DL0400AUO   F     132            PRINTER      KINFDS SPOOLU S01117E165
0017 FDL0400AUO   F     132            PRINTER                            E165
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0400FFP1                                           S01408
     F*                                                                   S01408
0018 F*
0019 F* 01            DEALS - FOREIGN EXCHANGE
0020 F* 02                  - FIXED LOAN/DEPOSIT, CALL NOTICE
0021 F* 03                  - NEGOTIABLE ASSETS PURCHASED
0022 F* 04                  - NEGOTIABLE ASSETS SOLD
0023 F* 05                  - TRAILER
0024 F* 06            DEAL AMENDMENT RECORD - LIVE
0025 F**07**          TABLE DETAIL LIVE                                   S01194
0026 F**08**          CLINT 'A' RECORD LIVE                               S01194
      *       08      Work indicator for CF deals                                             CDL033
0027 F* 09            DEALS - EXPIRED FX
0028 F*       10      FIRST CYCLE
0029 F* 11            DEAL AMENDMENT RECORD - REVERSED
0030 F*    20         SWAP PROFIT
0031 F*    21         SWAP LOSS
0032 F*    22         MATURITY DATE PRESENT
0033 F*    23         FACILITY TYPE PRESENT
0034 F*    24         ROLLOVER OF DEAL NO PRESENT
0035 F*    25         ROLLOVER BY DEAL NO PRESENT
0036 F*    26         INTEREST PAYMENT FREQUENCY BLANK
     F*    27         NEXT INTEREST DATE ZERO
0037 F*    28         DEAL AMENDMENT VALUE DATE ABSENT
0038 F*    29         SALE DATE PRESENT
0039 F*       30      HASH AMOUNT NEGATIVE
0040 F*       31      POSITION SWAP
0041 F*       33      CALCULATE INTEREST TO NEXT INTEREST DATE
0042 F*       34      CALCULATE DEALT BASE CURRENCY EQUIVALENT OF SOLD AMO
0043 F*       35      OBTAINING CONVERSION FACTOR FOR CCY
0044 F*       40      CUSTOMER IS A PARENT
0045 F*       41      NEGATIVE INTEREST INDICATOR ON
0046 F*       42      ROLLOVER INDICATOR ON
0047 F*       43      FEDERAL FUNDS INDICATOR ON
0048 F*       44      OUTGOING
0049 F*       45      PRINT PARENT DETAILS
     F*       46      BLANK OUT SETTLEMENT DETAILS FOR EXISTING EVENT     CEU003
     F*       47      CONDITIONING REVERSAL OF TRAN CURRENCY EVENT        CEU003
     F*       48      CONDITIONING FOR A CASHFLOW IN SETTLEMENT CCY       CEU003
     F*       49      GENERAL PURPOSE
0050 F*       50-54   GENERAL USE
     F*       55      OSBR is blank (CEU003 related)                      137223
     F*       59      INTEREST IS CAPITALISED
     F*       60      DEALS IS AN INTERNAL CONTRACT 1ST LEG
     F*       61      ACCOUNTING BIT SET IN ACEI
     F*       62      FX DEAL TYPE 'OP'
     F*       63      EVENT DATE IS DATE OF NEXT WORKING DAY
     F*       64      MATURITY DATE IS <=  EVENT CONTROL DATE
     F*       65      VALUE DATE IS > DATE OF NEXT WORKING DAY            E15988
     F*       66      CALL/NOTICE DEAL HAS A MATURITY DATE
     F*       67      Portfolio Management is switched on.                S01486
     F*       67      Or Private Banking  is switched on.                 CPB001
     F*       70      NEXT INTEREST DATE AFTER DEAL AMEND VALUE DATE
     F*       72      Interest paid separately Settlement details.        138004
0051 F*       87      RATE IS DIVIDE
      *       89      Event Tax Calculation if CGL015 ON                                      CGL015
0052 F*       90-99   Z-SUBROUTINES
0053 F*          U7   DATABASE ERROR
0054 F*          U8   FILE CONTROL TOTALS DISAGREE
     E                    CPY@    1   1 80
0055 E*       KEY TO TABLES -
0056 E*    TAB1 CONTAINS DEAL TYPE AND LAST 2 CHARACTERS OF EVENT CODE.
0057 E*    TAB2 CONTAINS CORRESPONDING VALUES FOR THE OUTPUT FIELDS -
0058 E*    FIRST 2 CHARS. OF EVENT CODE, EVENT DATE, EVENT AMOUNT,
0059 E*    EVENT CCY, OTHER AMOUNT, OTHER CCY, OTHER DATE, INT/EXCH RATE,
0060 E*    S.I.IND, I/O IND.   REPRESENTATIONS ARE -
0061 E*
0062 E*    AMT -                         DAT -
0063 E*     1   ZERO                      1   ZERO
0064 E*     2  PURCHASED AMT/ PRINCIPAL/  2  VALUE
0065 E*          PURCHASE/SALE PRICE      3  MATURITY / OTHER LEG VALUE
0066 E*     3  SOLD                       4  MATURITY/NOTICE
0067 E*     4  PRINCIPAL INCR/DECREASE    5  INTEREST
0068 E*     5  FACE VALUE                 6  SALE
0069 E*     6  SWAP PROFIT/LOSS           7  AMEND VALUE
0070 E*     7  INTEREST
0071 E*     9  LEG 1 AMOUNT - PURCH/SALE
0072 E*
0073 E*
0074 E*    CURRENCIES -                  INTEREST/EXCHANGE RATES -
0075 E*         BLANK                         ZERO
0076 E*     D  DEAL                       E  EXCHANGE
0077 E*     L  P/L                        I  INTEREST
0078 E*     P  PURCHASE                   Y  YIELD
0079 E*     S  SALE
0080 E*
0081 E*
0082 E*    INSTRUCTION INDS -            I/O INDS -
0083 E*     0  0                              BLANK
0084 E*     1  1                          I  I
0085 E*     2  2                          O  O
0086 E*     3  3
0087 E*     4  2/3
0088 E*
0089 E                    POWER   1   7  7 3
     E******              TAB1    1 117  4   TAB2   11   IN/OUTPUT FIELDS S01108
     E******              TAB1    1 113  4   TAB2   11   IN/OUTPUT S0110  E17215
     E******************  TAB1    1 119  4   TAB2   11   IN/OUTPUT E17215 S01354
     E******************  TAB1    1 131  4   TAB2   11   IN/OUTPUT S01354 S01220
     E***********         TAB1    1 133  4   TAB2   11   IN/OUTPUT S01220 CDL006
     E/COPY WNCPYSRC,DL0400E002
     E**********          TAB1    1 165  4   TAB2   11   IN/OUTPUT FIELDS              CDL006 CAS005
     E**********          TAB1    1 246  4   TAB2   11                    CDL022              CAS005
     E**********          TAB1    1 254  4   TAB2   11                          CDL022 CAS005 CDL033
     E/COPY WNCPYSRC,DL0400E003
     E                    TAB1    1 262  4   TAB2   11   IN/OUTPUT FIELDS                     CDL033
      *                                                                                       CDL033
0091 E**********          AMT         7 13 0             OUTPUT AMOUNTS                       CAS005
     E                    AMT         8 13 0                                                  CAS005
0092 E                    DAT         7  5 0             OUTPUT DATES
     E*                                                                   S01408
      *                                                                   CDL006
      ** Arrays used to retrieve percentage of current range for          CDL006
      ** Deal Principal Amount.                                           CDL006
     E                    ZRA        14 15 0A                             CDL006
     E                    ZPE        15  7 0                              CDL006
      *                                                                   CDL006
     E/COPY WNCPYSRC,DL0400EEP1                                           S01408
     E                    BBD         2  5 0                                                  CDL099
     E*                                                                   S01408
0093 E*****               HCCY       25  3               HOLIDAY CURENCIESS01194
0094 E*****               ZHC        50  3               ZFREQ SR. ARRAY  S01194
0095 E********************ZFMD   12  12  2               ZFREQ SR. ARRAY  DT0206
      /COPY ZSRSRC,ZFREQBZ1                                               DT0206
0096 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0097 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0098 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E**  STD CODE FOR LOADING ARRAY OF BRANCH & COMPANY CODES            S01117
0089 E***********         BR        100  3               BRANCH CO S01117 151104
0089 E***********         CO        100  3               COMPANY CDS01117 151104
0089 E***********         IC        100  6               INTRNL CUSS01117 151104
     E                    BR        900  3               BRANCH CO        151104
     E                    CO        900  3               COMPANY CDS      151104
     E                    IC        900  6               INTRNL CUST NO   151104
     E                    LC        900  3                                                    234341
     E**  SAVE OF BRANCH AND REPORT NAME & ADDRESS                        S01354
     E***********         CP        100  6               BRANCH PARS01354 151104
     E***********         CR        100 20               BRANCH RPTS01354 151104
     E***********         CT        100 10               BRANCH TOWS01354 151104
     E***********         CA        100  8               BRANCH ALFS01354 151104
     E***********         CZ        100  2               BRANCH CTRS01354 151104
     E***********         CL        100  2               BRANCH CTRS01354 151104
     E***********         PI        100  2               BRANCH PARS01354 151104
     E                    CP        900  6               BRANCH PARENT    151104
     E                    CR        900 20               BRANCH RPT NAME  151104
     E                    CT        900 10               BRANCH TOWN      151104
     E                    CA        900  8               BRANCH ALFA SORT 151104
     E                    CZ        900  2               BRANCH CTRY CTZN 151104
     E                    CL        900  2               BRANCH CTRY LOCC 151104
     E                    PI        900  2               BRANCH PARNT IND 151104
     E***********         PR        100 20               PARENT RPTS01354 151104
     E***********         PT        100 10               PARENT TOWS01354 151104
     E***********         PA        100  8               PARENT ALFS01354 151104
     E                    PR        900 20               PARENT RPT NAME  151104
     E                    PT        900 10               PARENT TOWN      151104
     E                    PA        900  8               PARENT ALFA SORT 151104
     E    TABTG30         CY      1 200  3   CYD    37   CCY/CCY DETAILS  S01095
     E                    FRQ     5   5  1               FREQS FOR NWD CHKS01095
     E                    CC        200  2               COUNTRY CODES    S01095
     E                    RC        200  2               REGION  CODES    S01095
      /COPY ZSRSRC,ZHOLE                                                  S01195
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E/COPY WNCPYSRC,DL0400E001
0099 I*
0100 I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
0101 I*
0102 I*EALS***NS**01***1 CD   8 CB                                        S01095
0102 I***CUSDE***NS**01   1 CD   8 CB                               S01095AUS003
     ICUSDE1  NS  01   1 CD   8 CB                                        AUS003
0103 I       OR   09   1 CE   8 CB
0104 I                                        1   1 RECI
0105 I                                        2   70DLNO
0106 I                                        8   8 RCDT
0107 I                                        9  100RCDC
0108 I****                                   11  160CNUM                  S01095
0108 I**********                             11  160CNUM  L1                           S01095 CSD027
0108 I                                       11  16 CNUM  L1                                  CSD027
0109 I******                                 17  190BRCD                  S01117
0109 I                                       17  19 BRCA                  S01117
0110 I                                       20  21 DTYP
0111 I                                       22  23 DLST
0112 I                                    P  24  260DDAT
0113 I                                    P  27  290VDAT
0114 I                                    P  30  320OTDT
0115 I                                       35  38 BRKC
0116 I                                    P  39  450BAGE
0117 I                                       46  48 PUCY
0118 I                                    P  49  550PUAM
0119 I                                    P  56  628EXRT
0120 I                                       86  88 SLCY
0121 I                                    P  89  950SLAM
0122 I                                    P 117 1230BCEQ
0123 I                                    P 124 1300OBCE
0124 I                                    P 131 1378LCXR
0125 I                                      138 1390PCST
0126 I**********                            140 151 OPCA                                      CGL029
     I                                      140 151 OPCAQQ                                    CGL029
0127 I                                      152 161 TSCN
0128 I                                      162 1630SCST
0129 I**********                            164 175 OSCA                                      CGL029
     I                                      164 175 OSCAQQ                                    CGL029
0130 I                                      176 185 TPCN
0131 I                                    P 192 1980ORPA
0132 I                                    P 205 2110ORSA
0133 I                                      212 2120FSLI
0134 I                                    P 213 2190LITD
0135 I                                    P 220 2260LILA
0136 I                                    P 227 2330DITD
0137 I                                    P 234 2400DILA
0138 I                                    P 241 2470SPPD
0139 I                                    P 248 2540SPLA        2021
0140 I                                      255 257 SPLC
0141 I                                      258 260 ILCY
0142 I                                    P 261 2670ILAM
0143 I                                      268 270 IDCY
0144 I                                    P 271 2770IDAM
0145 I                                    P 278 2840IDIA
0146 I                                      285 290 SODN
0147 I                                      300 309 FACO
0148 I                                      310 344 SPI
0149 I                                    P 347 3527ILIR
0150 I                                    P 353 3587IDIR
0151 I                                    P 360 3660ILIA
0152 I                                      370 370 DNSI
0153 I                                      371 371 DSTI
0154 I                                      372 372 CNFI
0155 I                                      373 373 ACEI
0156 I                                      374 374 TLXI
0157 I                                      382 3820ILCM
0158 I                                      383 3830IDCM
0159 I                                    P 391 3930ORED
0160 I                                    P 394 3960LCD
0161 I                                      397 397 CHTP
0162 I                                    P 398 4000TNLU
0162 I                                      401 402 BOKC                  S01220
0162 I                                     10371039 ORBR                  S01117
     I                                     10401043 PRFC                  CAC001
0162 I                                     10441046 ROBR                  S01117
0162 I                                     10471049 POBR                  S01117
     I                                    P105310590GCPCAP                                    CGL187
     I                                    P106010660GCSCAP                                    CGL187
      *                                                                                       CGL187
     I                                     11501153 PTFR                  S01486
     I                                     11541154 HLEX                  CDL002
     I                                     11551158 ICPC                  CDL002
     I                                     11591159 NETBY                 CDL002
     I                                     11601178 NETBR                 CDL002
     I                                     11791179 NETSL                 CDL002
     I                                     11801198 NETSR                 CDL002
     I                                     11991199 MATCH                 CDL002
     I                                     12001202 RSCY                  CEU003
     I                                     12031205 PSCY                  CEU003
     I                                     12921309 OPCA                                      CGL029
     I                                     13101327 OSCA                                      CGL029
     I                                     13641367 CLAS                                      CDL038
     I                                    P223922410BSDT2                                     CDL099
     I                                    P224222440BRSD2                                     CDL099
      *                                                                   S01408
     I/COPY WNCPYSRC,DL0400IIP2                                           S01408
      *                                                                   S01408
0163 I*
0164 I*
0165 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0166 I*
0167 I        NS  02   1 CD   8 CC
     I       OR   02   1 CM   8 CC                                        AUS003
0168 I                                        1   1 RECI
0169 I                                        2   70DLNO
0170 I                                        8   8 RCDT
0171 I                                        9  100RCDC
0108 I****                                   11  160CNUM                  S01095
0108 I**********                             11  160CNUM  L1                           S01095 CSD027
0108 I                                       11  16 CNUM  L1                                  CSD027
0173 I******                                 17  190BRCD                  S01117
0173 I                                       17  19 BRCA                  S01117
0174 I                                       20  21 DTYP
0175 I                                       22  23 DLST
0176 I                                    P  24  260DDAT
0177 I                                    P  27  290VDAT
0178 I                                    P  30  320MDAT        22
0179 I                                       33  340CDAS
0180 I                                       35  38 BRKC
0181 I                                    P  39  450BAGE
0182 I                                       46  48 CCY
0183 I                                    P  49  550PCPL
0184 I                                       56  56 INTC
0185 I                                       63  640BRTT
0186 I                                    P  65  707BRTE
0187 I                                    P  71  767RTSP
0188 I                                    P  77  827INTR
0189 I                                       83  850NOTD
0190 I                                       86 105 RNNA
0191 I**********                            106 1110CHNA                                      CSD027
0191 I                                      106 111 CHNA                                      CSD027
0192 I                                      112 1140FACT        23
0193 I                                      115 1160FCNO
0194 I                                    P 117 1230OPAM
0195 I                                    P 124 1308BCXR
0196 I                                    P 131 1378LCXR
0197 I                                      138 1390SDST
0198 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0199 I                                      152 161 TSTN
0200 I                                      162 1630MDST
0201 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0202 I                                      176 185 TMAN
0203 I                                      186 1910RODN        24
0204 I                                    P 192 1980RODA
0205 I                                      199 2040RBDN        25
0206 I                                    P 205 2110RBDA
0207 I                                      212 2120ICBS
0208 I                                      213 213 IPFR            26
0209 I                                    P 214 2200TOTI
0210 I                                    P 221 2230NIDT            27
0211 I                                    P 224 2260IBDT
0212 I                                    P 227 2290SLID
0213 I                                    P 230 2360AIPD
0214 I                                    P 237 2390DLRC
0215 I                                    P 240 2420IACD
0216 I                                    P 243 2490AITC
0217 I                                    P 250 2560AIAN
0218 I                                    P 257 2630AIAP
0219 I                                    P 264 2700IPRD
0220 I                                    P 271 2770IPRM
0221 I                                    P 278 2840ICTD
0222 I                                    P 294 2960DAVD            28
0223 I                                      297 2990DASN
0224 I                                      300 309 FACO
0225 I                                      310 344 SPI
0226 I                                      345 3460INTF
0227 I                                      347 3470MDBCXR          77
     I                                      355 355 TAXI
0228 I                                      370 370 DNSI
0229 I                                      371 371 DSTI
0230 I                                      372 372 CNFI
0231 I                                      373 373 ACEI
0232 I                                      374 374 TLXI
0233 I                                    P 391 3930ORED
0234 I                                    P 394 3960LCD
0235 I                                      397 397 CHTP
0236 I                                    P 398 4000TNLU
0162 I                                      421 422 BOKC                  S01220
0387 I                                      429 4300RSTM                  E325
0387 I**********                            431 442 RONS                                 E325 CGL029
     I                                      431 442 RONSQQ                                    CGL029
0387 I                                      498 4990PSTM                  E325
0387 I**********                            500 511 PONS                                 E325 CGL029
0387 I                                      500 511 PONSQQ                                    CGL029
0162 I                                     10571059 ORBR                  S01117
     I                                     10601063 PRFC                  CAC001
0162 I                                     10641066 ROBR                  S01117
0162 I                                     10671069 POBR                  S01117
     I                                     10721072 JRDFC                 S01392
     I                                     10741074 FUID                  S01392
     I/COPY WNCPYSRC,DL0400I002
     I                                     10761076 IPDS                  S01434
     I/COPY WNCPYSRC,DL0400I003
     I                                     11151116 IMET                  130756
     I**********                           11171131 INSA                               130756 CGL029
     I                                     11171131 INSAQQ                                    CGL029
     I* Additional fields to split INSA                                   138004
     I**********                           11171118 INSA00                             138004 CGL029
     I**********                           11191131 INSABL                             138004 CGL029
     I* Split ends here                                                   138004
     I                                     11321141 INOS                  130756
     I                                     11431146 PTFR                  S01486
     I                                     12251227 STCY                  CEU003
     I/COPY WNCPYSRC,DL0400I004
     I                                     12311233 ISCY                  CEU003
     I***********                          12371239 RTFC           CEU015 145001
      *                                                                   CDL006
      ** Additional fields for Fiduciary Dealing                          CDL006
     I                                     12401241 FCGC                  CDL006
     I                                    P126212680FCGA                  CDL006
     I                                     12401241 FCMC                  CDL006
     I                                    P126212680FCMA                  CDL006
     I                                    P146914750FACTC                 CDL006
     I                                    P147614820FACPD                 CDL006
     I                                    P148314890FCPRD                 CDL006
     I                                    P165116567FSLQPR                                    CAS005
     I                                     16571657 FSLQPS                                    CAS005
     I                                    P165816640FSAIPN                                    CAS005
     I                                    P166516710FSIPRN                                    CAS005
     I                                    P167216780FSAIAN                                    CAS005
     I                                    P167916850FSAITN                                    CAS005
     I                                    P168616920FSAINN                                    CAS005
     I                                    P169316990FSIPMN                                    CAS005
     I                                    P170017060FSICTN                                    CAS005
     I                                    P170717130FSTOTN                                    CAS005
     I                                    P171417200FSPAMT                                    CAS005
     I                                     17211738 OSDA                                      CGL029
     I                                     17391756 OMDA                                      CGL029
     I                                     17571774 RONS                                      CGL029
     I                                     17751792 PONS                                      CGL029
     I                                     17931813 INSA                                      CGL029
     I                                     17931794 INSA00                                    CGL029
     I                                     17951813 INSABL                                    CGL029
      *                                                                                       CDL033
      ** Additional fields for Floating Rate                                                  CDL033
      *                                                                                       CDL033
     I                                    P185118530XKRCDT                                    CDL033
     I                                     18541854 XKRCFR                                    CDL033
     I                                     185518560XKRCDM                                    CDL033
     I                                     18571857 XKSTRF                                    CDL033
     I                                    P185818637XKSTRT                                    CDL033
     I                                    P186418707XKAILC                                    CDL033
     I                                    P187118770XKACDA                                    CDL033
     I                                     18781878 XKSTVF                                    CDL033
     I                                     18791879 XKBSVF                                    CDL033
     I                                     188018810XKFXDM                                    CDL033
     I                                    P188218840XKINFD                                    CDL033
     I                                     18851885 XKINFF                                    CDL033
     I                                    P188618917XKBSRF                                    CDL033
     I                                     18921892 XKFRCI                                    CDL033
     I                                     18931897 XKFYLD                                    CDL033
     I**********                           18981901 CLAS                             CDL038 BUG10282
     I                                     20102013 CLAS                                    BUG10282
     I                                    P212321287CNSP                                      CRE073
     I                                     21292135 RDMT                                      CRE073
     I                                     21362139 RDFD                                      CRE073
     I                                     23502379 CCYPC                                     CDL096
     I                                     23502352 C1PC                                      CDL096
     I                                     23532355 C2PC                                      CDL096
     I                                     23562358 C3PC                                      CDL096
     I                                     23592361 C4PC                                      CDL096
     I                                     23622364 C5PC                                      CDL096
     I                                     23652367 C6PC                                      CDL096
     I                                     23682370 C7PC                                      CDL096
     I                                     23712373 C8PC                                      CDL096
     I                                     23742376 C9PC                                      CDL096
     I                                     23772379 C0PC                                      CDL096
     I                                     23802381 PYDC                                      CDL096
     I                                     23822383 AMTC                                      CDL096
0237 I*
0238 I*
0239 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
0240 I*
0241 I        NS  03   1 CD   8 CD
0242 I                                        1   1 RECI
0243 I                                        2   70DLNO
0244 I                                        8   8 RCDT
0245 I                                        9  100RCDC
0108 I****                                   11  160ISCN                  S01095
0108 I**********                             11  160ISCN  L1                           S01095 CSD027
0108 I                                       11  16 ISCN  L1                                  CSD027
0247 I*****                                  17  190BRCD                  S01117
0247 I                                       17  19 BRCA                  S01117
0248 I                                       20  21 DTYP
0249 I                                       22  23 DLST
0250 I                                    P  24  260DDAT
0251 I                                    P  27  290VDAT
0252 I                                    P  30  320MDAT
0253 I                                       33  340IDAS
0254 I                                       35  38 BRKC
0255 I                                    P  39  450BAGE
0256 I                                       46  48 CCY
0257 I                                    P  49  550PUPR
0258 I                                    P  57  627YRAT
0259 I                                    P  71  767RTSP
0260 I                                    P  77  827INTR
0261 I                                       86 105 RNNA
0262 I**********                            106 1110PCUS                                      CSD027
0262 I                                      106 111 PCUS                                      CSD027
0263 I                                      112 1140FACT        23
0264 I                                      115 1160FCNO
0265 I                                    P 117 1230FVAL
0266 I                                    P 124 1308BCXR
0267 I                                    P 131 1378LCXR
0268 I                                      138 1390SDST
0269 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0270 I                                      152 161 TSTN
0271 I                                      162 1630MDST
0272 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0273 I                                      176 185 TMAN
0274 I                                    P 192 1980DISA
0275 I                                    P 205 2110DPTD
0276 I                                      212 2120ICBS
0277 I                                      213 213 IPFR            26
0278 I                                    P 214 2200TOTI
0279 I                                    P 221 2230NIDT
0280 I                                    P 224 2260IBDT
0281 I                                    P 227 2290SLID
0282 I                                    P 230 2360AIPD
0283 I                                    P 237 2390DLRC
0284 I                                    P 240 2420IACD
0285 I                                    P 243 2490AITC
0286 I                                    P 250 2560AIAN
0287 I                                    P 257 2630AIAP
0288 I                                    P 264 2700IPRD
0289 I                                    P 271 2770IPRM
0290 I                                    P 278 2840SAPRD
0291 I                                      285 2900ASDN
0292 I                                    P 291 2930SADT        29
0293 I                                    P 294 2960DAVD            28
0294 I                                      297 2990DASN
0295 I                                      300 309 FACO
0296 I                                      310 344 SPI
0297 I                                      345 3460INTF
0298 I                                      347 3470MDBCXR          77
0299 I                                      370 370 DNSI
0300 I                                      371 371 DSTI
0301 I                                      372 372 CNFI
0302 I                                      373 373 ACEI
0303 I                                      374 374 TLXI
0304 I                                    P 391 3930ORED
0305 I                                    P 394 3960LCD
0306 I                                      397 397 CHTP
0307 I                                    P 398 4000TNLU
0162 I                                      401 402 BOKC                  S01220
0387 I                                      409 4100RSTM                  BHF936
0387 I**********                            411 422 RONS                               BHF936 CGL029
     I                                      411 422 RONSQQ                                    CGL029
0387 I                                      478 4790PSTM                  BHF936
0387 I**********                            480 491 PONS                               BHF936 CGL029
     I                                      480 491 PONSQQ                                    CGL029
0162 I                                     10371039 ORBR                  S01117
     I                                     10401043 PRFC                  CAC001
0162 I                                     10441046 ROBR                  S01117
0162 I                                     10471049 POBR                  S01117
     I                                     10511051 JRDFC                 S01392
     I                                     10551055 PCLI                  S01378
     I                                    P105610580PSZE                  S01378
     I                                    P106610680NSLD                  S01378
     I                                     11291131 STCY                  CEU003
     I                                    P118211877FSLQPR                                    CAS005
     I                                     11881188 FSLQPS                                    CAS005
     I                                    P118911950FSAIPN                                    CAS005
     I                                    P119612020FSIPRN                                    CAS005
     I                                    P120312090FSAIAN                                    CAS005
     I                                    P121012160FSAITN                                    CAS005
     I                                    P121712230FSAINN                                    CAS005
     I                                    P122412300FSIPMN                                    CAS005
     I                                    P123112370FSTOTN                                    CAS005
     I                                    P123812440FSPINN                                    CAS005
     I**********                          P124512510FSPAMT                             CAS005 CGL029
     I                                     12451262 OSDA                                      CGL029
     I                                     12631280 OMDA                                      CGL029
     I                                     12811298 RONS                                      CGL029
     I                                     12991316 PONS                                      CGL029
     I                                     13171320 CLAS                                      CDL038
     I/COPY WNCPYSRC,DL0400I005
0308 I*
0309 I*
0310 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
0311 I*
0312 I        NS  04   1 CD   8 CE
0313 I                                        1   1 RECI
0314 I                                        2   70DLNO
0315 I                                        8   8 RCDT
0316 I                                        9  100RCDC
0108 I****                                   11  160CNUM                  S01095
0108 I**********                             11  160CNUM  L1                           S01095 CSD027
0108 I                                       11  16 CNUM  L1                                  CSD027
0318 I                                       17  190BRCD
0318 I*****                                  17  190BRCD                  S01117
0318 I                                       17  19 BRCA                  S01117
0319 I                                       20  21 DTYP
0320 I                                       22  23 DLST
0321 I                                    P  24  260DDAT
0322 I                                    P  27  290VDAT
0323 I                                       35  38 BRKC
0324 I                                    P  39  450BAGE
0325 I                                       46  48 CCY
0326 I                                    P  49  550SAPR
0327 I                                    P  57  627YRAT
0328 I                                    P  77  827INTR
0329 I                                       86 105 RNNA
0330 I**********                            106 1110ISCNDE                                    CSD027
0330 I                                      106 111 ISCNDE                                    CSD027
0331 I                                    P 117 1230FVAL
     I                                    P 124 1308BCXR                                      258536
0332 I                                      138 1390SETP
0333 I**********                            140 151 OSAC                                      CGL029
     I                                      140 151 OSACQQ                                    CGL029
0334 I                                      152 161 TSEN
0162 I                                      162 164 ORBR                  S01117
0162 I************                          165 167 OSBR            S01117BHF676
0162 I                                      165 167 ROBR                  BHF676
     I                                      168 171 PRFC                  CAC001
0335 I                                    P 278 2840PUPRX
0336 I                                    P 285 2900RPDN
0337 I                                      370 370 DNSI
0338 I                                      371 371 DSTI
0339 I                                      372 372 CNFI
0340 I                                      373 373 ACEI
0341 I                                      374 374 TLXI
0342 I                                    P 391 3930ORED
0343 I                                    P 394 3960LCD
0344 I                                      397 397 CHTP
0345 I                                    P 398 4000TNLU
0162 I                                      401 402 BOKC                  S01220
0387 I                                      409 4100RSTM                  BHF936
0387 I**********                            411 422 RONS                               BHF936 CGL029
     I                                      411 422 RONSQQ                                    CGL029
0387 I                                      478 4790PSTM                  BHF936
0387 I**********                            480 491 PONS                               BHF936 CGL029
     I                                      480 491 PONSQQ                                    CGL029
     I                                     10381038 PCLI                  S01378
0162 I***********                          10371039 ROBR            S01117BHF676
0162 I***********                          10401042 POBR            S01117BHF676
     I                                     10421044 STCY                  CEU003
     I                                     10481065 OSAC                                      CGL029
     I                                     10661083 RONS                                      CGL029
     I                                     10841101 PONS                                      CGL029
     I                                     11021105 CLAS                                      CDL038
0346 I*
0347 I*
0348 I*    DEALS FILE -TRAILER RECORD.
0349 I*
0350 I********NS  05   1 CT                                               S01095
0350 I***CUSDE***NS**05   1 CT                                      S01095AUS003
     ICUSDE1  NS  05   1 CT                                               AUS003
0351 I                                    P  17  190NORE
0352 I                                    P  32  340NLRA
0353 I                                    P  65  720VLAF
0354 I                                    P  73  740VLAL
0355 I*
0356 I        NS
0357 I*
0358 I*    DEALS AMENDMENT FILE - DETAIL RECORD.
0359 I*
0360 IDEAMS   NS  06   1 CD
0361 I       OR   11   1 CR
0362 I                                        1   1 RECI
0363 I                                        2   70DLNO
0364 I                                        8  120VDATM
0365 I                                       13  150DASN
0366 I                                       16  17 DTYP
0367 I                                       18  19 DLST
0368 I                                       20  21 AMTP
0369 I                                       22  220PSEQ
0370 I                                       23  240BRTT
0371 I                                    P  25  307RTSP
0372 I                                       31  33 CCY
0373 I                                    P  34  400DAAM
0374 I                                       41  41 MOGI
0375 I**********                             42  470CNUM                                      CSD027
0375 I                                       42  47 CNUM                                      CSD027
0376 I                                       48  490SETPM
0377 I**********                             50  61 OSACM                                     CGL029
     I                                       50  61 OSCMQQ                                    CGL029
0378 I                                       62  71 TSENM
0379 I                                       72  81 FACOM
0380 I                                       82 116 SPIM
0162 I                                      117 119 OSBR                  S01117
0381 I                                    P 139 1410NAAD
0382 I                                      142 1440NASN
0383 I                                      145 145 DAIN
0384 I                                    P 191 1930ORED
0385 I                                    P 194 1960LCD
0386 I                                      197 197 CHTP
0387 I                                    P 198 2000TNLU
     I                                      339 346 RCRNM                 082475
     I                                      838 840 STCY                  CEU003
     I                                      880 897 OSACM                 CGL029
     I                                    P 935 9370EMDAT                 CDL017
     I                                    P 958 9637BRTEM                 CDL020
     I                                      964 967 CLAS                                      CDL038
     I                                    P 968 9737CNSP                                      CRE073
     I                                      974 974 CNSG                                      CRE073
     I                                      975 981 RDMT                                      CRE073
     I                                      982 985 RDFD                                      CRE073
0388 I*
0389 I        NS
0390 I*
0391 I***                                                                 S01194
0392 I********LE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0393 I***                                                                 S01194
0394 I***LE   NS  07   2 C0   3 C1  12 C1                                 S01194
0395 I***    AND      13 C0                                               S01194
0396 I***                                     1   1 RECI                  S01194
0397 I***                                     2   30RECT                  S01194
0398 I***                                    12  130RCDE                  S01194
0399 I***                                    14  66 TITL                  S01194
0400 I***                                    67  67 DATF                  S01194
0401 I***                                    68  700DFBR                  S01194
0402 I***                                    74  74 MODI1                 S01194
0403 I***                                    75  75 MODI2                 S01194
0404 I***                                    76  76 MODI3                 S01194
0405 I***                                 P  77  790RUND                  S01194
0406 I***                                    80  86 RUNA                  S01194
0407 I***                                    87  870SFLG                  S01194
0408 I***                                 P  90  920LCD                   S01194
0409 I***                                    93  93 CHTP                  S01194
0410 I***                                 P  94  960TNLU                  S01194
0411 I**                                                                  S01194
0412 I***                                                                 S01194
0413 I******ABLE FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0414 I***                                                                 S01194
0415 I***     NS  07   1 CD   2 C0   3 C1                                 S01194
0416 I***    AND      12 C1  13 C1                                        S01194
0417 I***                                     1   1 RECI                  S01194
0418 I***                                     2   30RECT                  S01194
0419 I***                                    12  130RCDE                  S01194
0420 I***                                    14  16 BCCY                  S01194
0421 I***                                    17  19 BCYL                  S01194
0422 I***                                    20  22 HOCY                  S01194
0423 I***                                    23  280HEAD                  S01194
0424 I***                                 P  29  310APDA                  S01194
0425 I***                                    35  35 APFQ                  S01194
0426 I***                                 P  36  380LOGS                  S01194
0427 I***                                    39  40 CUZR                  S01194
0428 I***                                 P  41  430DNWD                  S01194
0429 I***                                    44  460BVLP                  S01194
0430 I***                                    47  49 LOCY                  S01194
0431 I***                                    50  510FDAY                  S01194
0432 I***                                    86  86 ISAV                  S01194
0433 I***                                 P  87  890LLOG                  S01194
0434 I***                                 P  90  920LCD                   S01194
0435 I***                                    93  93 CHTP                  S01194
0436 I***                                 P  94  960TNLU                  S01194
0437 I***                                                                 S01194
0438 I***                                                                 S01194
0439 I******ABLE FILE - INSTALLATION CONTROL DATA RECORD 5.               S01194
0440 I***                                                                 S01194
0441 I***     NS  07   1 CD   2 C0   3 C1                                 S01194
0442 I***    AND      12 C4  13 C0                                        S01194
0444 I***                                    14  14 IRFRA                 S01194
0443 I***                                    47  49 USCY                  S01194
0444 I***                                    57  57 FFNY                  S01194
0444 I***                                 P  87  892TAXR                  S01194
0445 I***                                                                 S01194
0446 I***                                                                 S01194
0447 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01095
0448 I*****                                                               S01095
0449 I*****   NS  07   1 CD   2 C2   3 C0                                 S01095
0450 I*****  AND      13 C1                                               S01095
0451 I*****                               P  28  348SPOT                  S01095
0452 I*****                                  38  380CDP                   S01095
0453 I*****                                  77  780SSNO                  S01095
0454 I*****                               P  79  858ERLC                  S01095
0455 I*****                                  86  860MDIN            87    S01095
0456 I*
0457 I***                                                                 S01194
0458 I***  TABLE FILE - COUNTRY CODES RECORD.                             S01194
0459 I***                                                                 S01194
0460 I***     NS  07   1 CD   2 C5   3 C0                                 S01194
     I***                                    12  13 CCOD                  S01194
0461 I***                                    44  45 REGC                  S01194
0462 I***                                                                 S01194
0463 I****                                                                S01194
0464 I*******BLE FILE - HOLIDAY RECORD.                                   S01194
0465 I****    E-EXCLUDE, I-INCLUDE.                                       S01194
0466 I****                                                                S01194
0467 I***     NS       1 CD   2 C2   3 C2                                 S01194
0468 I***                                     1   1 RECI                  S01194
0469 I***                                     2   30RECT                  S01194
0470 I***                                     8  120HOL                   S01194
0471 I***                                    13  130SREC                  S01194
0472 I***                                    14  14 INEX                  S01194
0473 I***                                    15  89 HCCY                  S01194
0474 I***                                 P  90  920LCD                   S01194
0475 I***                                    93  93 CHTP                  S01194
0476 I***                                 P  94  960TNLU                  S01194
0477 I***                                                                 S01194
0478 I***     NS                                                          S01194
0479 I***                                     1   1 RECI                  S01194
0480 I**                                                                  S01194
0481 I**                                                                  S01194
0482 I*********NT FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0483 I**                                                                  S01194
0484 I***NT   NS  08   1 CD   8 CA                                        S01194
0485 I***                                     9  28 CRNM                  S01194
0486 I***                                    29  38 CTWN                  S01194
0487 I***                                    49  56 CASK                  S01194
0488 I***                                    84  85 CCTZ                  S01194
0489 I***                                    86  87 CLOC                  S01194
0490 I***                                    88  930CPAR                  S01194
0491 I***                                   111 111 CMIN                  S01194
0492 I***                                                                 S01194
0493 I***     NS                                                          S01194
      *                                                                   S01220
      ** Deals File - used to access book code of associated leg of       S01220
      **              internal contract                                   S01220
      *                                                                   S01220
     IDEALS   NS       1 CD   8 CB                                        S01220
     I       OR        1 CE   8 CB                                        S01220
     I                                      401 402 BOOK                  S01220
     I        NS                                                          S01220
      *                                                                   S01220
     I/COPY WNCPYSRC,DL0400I008
0494 I*
0495 I*
0496 I*    D A T A   S T R U C T U R E S
0497 I*
0498 I*    AMOUNT AND DATE ARRAYS
0499 I            DS
0500 I**********                              1  91 AMT                                       CAS005
     I                                        1 104 AMT                                       CAS005
0501 I                                       14  260PUAM
0502 I                                       14  260PCPL
0503 I                                       14  260PUPR
0504 I                                       14  260SAPR
0505 I                                       27  390SLAM
     I/COPY WNCPYSRC,DL0400I006
0506 I                                       40  520DAAM
0507 I                                       53  650FVAL
0508 I                                       66  780SPLA
0509 I                                       79  910INTDUE
     I                                       92 1040INTDUN                                    CAS005
0510 I            DS
0511 I                                        1  35 DAT
0512 I                                        6  100VDAT
0513 I                                       11  150MDAT
0514 I                                       11  150OTDT
0515 I                                       18  200NOTD
0516 I                                       21  250TODATE
0517 I                                       26  300SADT
0518 I                                       31  350VDATM
     I*                                                                   S01408
      *                                                                   CDL006
      ** Data-structure used to set up arrays ZRA and ZPE from            CDL006
      ** DL Charges Types logical file DLCCGDL0, to locate the highest    CDL006
      ** range for Deal Principal amount.                                 CDL006
     I          E DSDLCCGDPD                                              CDL006
     I                                    P  31 1420ZRA                   CDL006
     I                                    P 143 2020ZPE                   CDL006
     I/COPY WNCPYSRC,DL0400IIP1                                           S01408
      *                                                                                       CDL099
      ** Data structure for array BBD                                                         CDL099
      *                                                                                       CDL099
     I            DS                                                                          CDL099
     I                                        1  10 BBD                                       CDL099
     I                                        1   50BSDT2                                     CDL099
     I                                        6  100BRSD2                                     CDL099
      *                                                                                       CDL099
     I*                                                                   S01408
0519 I*    EVNTX OUTPUT KEYS
0520 I            DS
0521 I                                        1   4 KEY
0522 I                                        1   2 DTYP
0523 I                                        3   4 CODE2
0524 I                                        5  15 KEYDS
0525 I                                        5   6 NN
0526 I                                        7   70ED
0527 I                                        8   80EA
0528 I                                        9   9 EC
0529 I                                       10  100OA
0530 I                                       11  11 OC
0531 I                                       12  120OD
0532 I                                       13  13 RAT
0533 I                                       14  14 SIIND
0534 I                                       15  15 IOIND
0535 I*****TABLE FILE AND DEALS AMENDMENT FILE CHAINING KEYS              S01194
0536 I*****       DS                                                      S01194
0537 I*****                                   1  12 TABKEY                S01194
0538 I*****                                   9  11 CCYK                  S01194
0539 I*****                                  13  26 DAMKEY                S01194
0540 I*****                                  13  180DLNO                  S01194
0541 I*****                                  19  230DATE                  S01194
0542 I*****                                  24  260SEQNO                 S01194
0535 I*    DEALS AMENDMENT FILE CHAINING KEYS                             S01194
0536 I            DS                                                      S01194
0539 I                                        1  14 DAMKEY                S01194
0540 I                                        1   60DLNO                  S01194
0541 I                                        7  110DATE                  S01194
0542 I                                       12  140SEQNO                 S01194
0543 I*
0544 I*    DATA STRUCTURE TO CONTAIN EQUIVALENT FIELDS FROM DIFFERENT
0545 I*    RECORD TYPES
0546 I            DS
0547 I*                 SETTLEMENT DETAILS
0548 I**********                              1  24 SETTLE                                    CGL029
0549 I**********                              1   20SETTYP                                    CGL029
     I                                        1  30 SETTLE                                    CGL029
     I                                        1   20SETTYP                                    CGL029
     I                                        1   4 SETTL1                                    CGL029
     I                                        5  20 SETTL2                                    CGL029
     I                                       21  30 SETTL3                                    CGL029
     I*                                                                   138004
     I*  Define field SETTYP as alpha to check for existance              138004
     I*  of blanks being introduced into numeric field SETTYP             138004
     I*  This corruption can be introduced by ALPHA fields                138004
     I*  being moved into DS field SETTLE.                                138004
     I*                                                                   138004
0549 I                                        1   2 SETALF                138004
0550 I**********                              3  14 SETAC                                     CGL029
0551 I**********                             15  24 SETNOS                                    CGL029
0550 I                                        3  20 SETAC                                     CGL029
0551 I                                       21  30 SETNOS                                    CGL029
0552 I*
0553 I**********                             25  48 SETST                                     CGL029
0554 I**********                             25  260PCST                                      CGL029
0555 I**********                             25  260SDST                                      CGL029
0556 I**********                             25  260SETP                                      CGL029
0557 I**********                             27  38 OPCA                                      CGL029
0558 I**********                             27  38 OSDA                                      CGL029
0559 I**********                             27  38 OSAC                                      CGL029
0560 I**********                             39  48 TSCN                                      CGL029
0561 I**********                             39  48 TSTN                                      CGL029
0562 I**********                             39  48 TSEN                                      CGL029
0563 I*
     I                                       31  60 SETST                                     CGL029
     I                                       31  320PCST                                      CGL029
     I                                       31  320SDST                                      CGL029
     I                                       31  320SETP                                      CGL029
     I                                       33  50 OPCA                                      CGL029
     I                                       33  50 OSDA                                      CGL029
     I                                       33  50 OSAC                                      CGL029
     I                                       51  60 TSCN                                      CGL029
     I                                       51  60 TSTN                                      CGL029
     I                                       51  60 TSEN                                      CGL029
0564 I**********                             49  72 SETMAT                                    CGL029
0565 I**********                             49  500SCST                                      CGL029
0566 I**********                             49  500MDST                                      CGL029
0567 I**********                             51  62 OSCA                                      CGL029
0568 I**********                             51  62 OMDA                                      CGL029
      *                                                                                       CGL029
     I                                       61  90 SETMAT                                    CGL029
     I                                       61  620SCST                                      CGL029
     I                                       61  620MDST                                      CGL029
     I                                       63  80 OSCA                                      CGL029
     I                                       63  80 OMDA                                      CGL029
      *                                                                                       CGL029
0569 I***********                            63  72 TPCN                  025121
0570 I***********                            63  72 TMAN                  025121
     I**********                             63  72 FACO                               025121 CGL029
     I                                       81  90 FACO                                      CGL029
0571 I*
0572 I**********                             73  96 SETDM                                     CGL029
0573 I**********                             73  740SETPM                                     CGL029
0574 I**********                             75  86 OSACM                                     CGL029
0575 I**********                             87  96 TSENM                                     CGL029
     I**********                             87  94 RCRNM                              082475 CGL029
      *                                                                                       CGL029
     I                                       91 120 SETDM                                     CGL029
     I                                       91  920SETPM                                     CGL029
     I                                       93 110 OSACM                                     CGL029
     I                                      111 120 TSENM                                     CGL029
     I                                      111 118 RCRNM                                     CGL029
0576 I*                 CUSTOMER NO
0577 I**********                             97 1020CUSTNO                                    CGL029
0578 I**********                             97 1020CNUM                                      CGL029
0579 I**********                             97 1020ISCN                                      CGL029
     I**********                            121 1260CUSTNO                             CGL029 CSD027
     I**********                            121 1260CNUM                               CGL029 CSD027
     I**********                            121 1260ISCN                               CGL029 CSD027
     I                                      121 126 CUSTNO                                    CSD027
     I                                      121 126 CNUM                                      CSD027
     I                                      121 126 ISCN                                      CSD027
0580 I*                 COUNTERPARTY CUSTOMER NO
0581 I**********                            103 1080CPCN                                      CGL029
0582 I**********                            103 1080CHNA                                      CGL029
0583 I**********                            103 1080PCUS                                      CGL029
0584 I**********                            103 1080ISCNDE                                    CGL029
     I**********                            127 1320CPCN                               CGL029 CSD027
     I**********                            127 1320CHNA                               CGL029 CSD027
     I**********                            127 1320PCUS                               CGL029 CSD027
     I**********                            127 1320ISCNDE                             CGL029 CSD027
     I                                      127 132 CPCN                                      CSD027
     I                                      127 132 CHNA                                      CSD027
     I                                      127 132 PCUS                                      CSD027
     I                                      127 132 ISCNDE                                    CSD027
0585 I*                 GLINTC & ZFREQ FIELDS
0586 I**********                            109 1090ZICALC                                    CGL029
0587 I**********                            109 1090ICBS                                      CGL029
0588 I**********                            110 1207ZIRATE                                    CGL029
0589 I**********                            110 1207INTR                                      CGL029
0590 I**********                            121 121 ZFREQ                                     CGL029
0591 I**********                            121 121 IPFR                                      CGL029
0592 I**********                            122 1230ZMDAY                                     CGL029
0593 I**********                            122 1230INTF                                      CGL029
     I                                      133 1330ZICALC                                    CGL029
     I                                      133 1330ICBS                                      CGL029
     I                                      134 1447ZIRATE                                    CGL029
     I                                      134 1447INTR                                      CGL029
     I                                      145 145 ZFREQ                                     CGL029
     I                                      145 145 IPFR                                      CGL029
     I                                      146 1470ZMDAY                                     CGL029
     I                                      146 1470INTF                                      CGL029
     I*                                                                   130756
     I**********                            124 147 SETISA                             130756 CGL029
     I**********                            124 125 IMET                               130756 CGL029
     I**********                            126 140 INSA                               130756 CGL029
     I**********                            138 147 INOS                               130756 CGL029
      *                                                                                       CGL029
     I                                      148 177 SETISA                                    CGL029
     I                                      148 151 SETIS1                                    CGL029
     I                                      152 167 SETIS2                                    CGL029
     I                                      168 177 SETIS3                                    CGL029
     I                                      148 149 IMET                                      CGL029
     I                                      150 170 INSA                                      CGL029
     I                                      168 177 INOS                                      CGL029
     I*                                                                   130756
     I*    CURRENCY DETAILS FROM TABTG10                                  S01095
     ICYDDS       DS                                                      S01095
     I                                        1   10CDP                   S01095
     I                                    P   2   88SPOT                  S01095
     I                                        9   90MDIN                  S01095
     I                                    P  10  168ERLC                  S01095
     I                                       17  170TNOT                  S01095
     I                                       18  31 CCNM                  S01095
     I                                       32  35 TEAC                  S01095
     I                                       36  370SSNO                  S01095
      *                                                                                       234341
     ILDA         DS                            256                                           234341
     I                                      134 143 DBFILE                                    234341
     I                                      142 170 DBKEY                                     234341
     I                                      171 180 DBPGM                                     234341
     I                                      181 183 DBASE                                     234341
      **  Local data area                                                                     234341
      *                                                                                       234341
     I/COPY WNCPYSRC,DL0400I001
      *                                                                                       CDL033
      ** External DS for Currencies details                                                   CDL033
      *                                                                                       CDL033
     ISDCURR    E DSSDCURRPD                                                                  CDL033
     I*
     ISDBANK    E DSSDBANKPD                                              S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I*                                                                   S01194
     ISDDEAL    E DSSDDEALPD                                              S01194
     I*                                                                   S01194
     ISDCTRY    E DSSDCTRYPD                                              S01194
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I              QQACCD                          QQACD1                                    CGL029
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I                                        1 250 ##C01                                     CSC042
     I                                      251 500 ##C02                                     CSC042
     I                                      501 750 ##C03                                     CSC042
     I                                      7511000 ##C04                                     CSC042
     I                                     10011250 ##C05                                     CSC042
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I              QQACCD                          QQACD2                                    CGL029
     I*                                                                   CDL002
     ISDEXPM    E DSSDEXPMPD                                              CDL002
     I*
     ISDBSRT    E DSSDBSRTPD                                                                  CRE073
     I** EXTERNAL DS FOR BASE RATE DETAILS                                                    CRE073
     I*                                                                                       CRE073
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSLDY     E DSDSLDY                                                 220738
     I*  THIRD DS FOR ACCESS PROGRAMS, VERY LONG DATA STRUCTURE           220738
     I*                                                                   220738
     ISDNOST    E DSSDNOSTPD                                              E325
     I              QQACCD                          QQACD3                                    CGL029
     I** EXTERNAL DS FOR NOSTRO DETAILS                                   E325
     I*                                                                   E325
     I***SDBRCH    E DSSDBRCHPD                                                        234341234341R
      ***Branch*details*accessed*via*access*program********************                234341234341R
      **********                                                                       234341234341R
     ISDLOCN    E DSSDLOCNPD                                                                  234341
      ** Data structure for Location Codes                                                    234341
      *                                                                                       234341
     ISDCTTX    E DSSDCTTXPD                                                                  234341
      ** Data Structure for Country of Tax Code Details                                       234341
      *                                                                                       234341
      *                                                                   CDL020
     ISDBSHS    E DSSDBSHSPD                                              CDL020
      ** Record formats for access to historic base rates                 CDL020
      *                                                                   CDL020
     ISDTXPA    E DSSDTXPAPD                                                                BUG22911
      ** Data structure for Tax Parameter File                                              BUG22911
      *                                                                                     BUG22911
      *                                                                                       242892
      ** Data structure for GL Account Details                                                242892
     IGLACCN      DS                                                                          242892
     I                                        3   8 GCNUM                                     242892
     I                                        9  18 GACOD                                     242892
     I                                       19  20 GSEQN                                     242892
      *                                                                                       242892
     I**SPOOLU      DS                                              S01117E165
     I*****FILE INFORMATION DATA STRUCTURE                          S01117E165
     I****                                   83  90 SFILEU          S01117E165
     I****                                B 123 1240SFNUMU          S01117E165
     I*
     IRUNDAT      DS                                                      S01117
     I**   RUNDAT DATA STRUCTURE - TO ACCESS MULTI-BRANCHING FLAG         S01117
     I                                       13  13 @MBIN                 S01117
     I*                                                                   S01195
     ISCSARD    E DSSCSARDPD                                              S01434
     I** DATA STRUCTURE FOR ROLLOVER SWITCH ON FILE                       S01434
     I*                                                                   S01434
     ISDSTPD    E DSSDSTPDPD                                                                  CER049
      *                                                                                       CER069
     ISDACTX    E DSSDACTXPD                                                                  CER069
      **  External DS for customer details by country of tax                                  CER069
      *                                                                                       CER069
      /COPY ZSRSRC,ZHOLI                                                  S01195
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
0594 I/EJECT
     I/COPY WNCPYSRC,DL0400I007
      *                                                                                       CRE073
     I              'ZACALCSPRT'          C         CALCSR                                    CRE073
     I** Constant                                                                             CRE073
      *                                                                                       CRE073
     C           *NAMVAR   DEFN           LDA                                                 234341
      *                                                                                       234341
     C****                 MOVEACPY@      BIS@   13                       E166
0595 C   10                GOTO START
0596 C                     EXCPT
0597 C                     SETON                     10
     C                     MOVEACPY@      BIS@   80                       E166
     C/COPY WNCPYSRC,DL0400C122
     C*                                                                   S01117
     C* READ RUNDAT FOR MULTI-BRANCHING INDICATOR                         S01117
     C                     IN   RUNDAT                                    S01117
     C           *NAMVAR   DEFN           RUNDAT 13                       S01117
0598 C*
0599 C*******T INSTALLATION CONTROL DATA 1, 2, 5                          S01194
0600 C*******D CALCULATE EVENT CONTROL DATE                               S01194
0601 C***                                                                 S01194
0602 C***                  MOVEL'01'      TABKEY                          S01194
0603 C***                  MOVE '10'      TABKEY                          S01194
0604 C***                  EXSR TABCHN                                    S01194
     C***U7                GOTO END                                       S01194
0605 C***        DATF      COMP 'M'                      98               S01194
     C*                                                                   S01194
     C* CALL A/O AOBANKR0                                                 S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVE '01'      DBASE   3        * DBERR 01 *   S01194
     C                     MOVE @OPTN     DBOPTN  7        ************   S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           @RTCD     CABNE*BLANK    END                             S01194
     C*                                                                   S01434
     C**   CHECK ROLLOVER SWITCH ON                                       S01434
     C*                                                                   S01434
     C                     CALL 'AOSARDR0'                                S01434
     C                     PARM '*MSG   ' @RTCD   7                       S01434
     C                     PARM '*KEY   ' @OPTN   7                       S01434
     C                     PARM 'S01434'  @SARD   6                       S01434
     C           SCSARD    PARM SCSARD    DSFDY                           S01434
     C*                                                                   S01434
     C           @RTCD     IFEQ *BLANKS                                   S01434
     C                     MOVE 'Y'       S01434  1                       S01434
     C                     ELSE                                           S01434
     C                     MOVE 'N'       S01434                          S01434
     C                     ENDIF                                          S01434
     C*                                                                   CEU003
     C**   Check EMU switchable feature CEU003 in SCSARDPD file.          CEU003
     C*                                                                   CEU003
     C           *LIKE     DEFN S01434    CEU003                          CEU003
     C*                                                                   CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM '*MSG   ' @RTCD                           CEU003
     C                     PARM '*KEY   ' @OPTN                           CEU003
     C                     PARM 'CEU003'  @SARD                           CEU003
     C           SCSARD    PARM SCSARD    DSFDY                           CEU003
     C*                                                                   CEU003
     C           @RTCD     IFEQ *BLANKS                                   CEU003
     C                     MOVE 'Y'       CEU003                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE 'N'       CEU003                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C*                                                                   CEU003
     C*****Check*EMU*switchable*feature*CEU015*in*SCSARDPD*file.*  CEU015 145001
     C***********                                                  CEU015 145001
     C************LIKE     DEFN S01434    CEU015                   CEU015 145001
     C***********                                                  CEU015 145001
     C***********          CALL 'AOSARDR0'                         CEU015 145001
     C***********          PARM '*MSG   ' @RTCD                    CEU015 145001
     C***********          PARM '*KEY   ' @OPTN                    CEU015 145001
     C***********          PARM 'CEU015'  @SARD                    CEU015 145001
     C***********SCSARD    PARM SCSARD    DSFDY                    CEU015 145001
     C***********                                                  CEU015 145001
     C***********@RTCD     IFEQ *BLANKS                            CEU015 145001
     C***********          MOVE 'Y'       CEU015                   CEU015 145001
     C***********          ELSE                                    CEU015 145001
     C***********          MOVE 'N'       CEU015                   CEU015 145001
     C***********          ENDIF                                   CEU015 145001
      *                                                                   CDL006
      ** Access Switchable Feature Details, Check if CDL006 is            CDL006
      ** switch on.                                                       CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   PRTCD   7                       CDL006
     C                     PARM '*VERIFY 'POPTN   7                       CDL006
     C                     PARM 'CDL006'  PSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           PRTCD     IFNE *BLANKS                                   CDL006
     C           PRTCD     ANDNE'*NRF '                                   CDL006
     C                     SETON                     U7U8LR               CDL006
     C                     MOVEL'SCSARDPD'DBFILE                          CDL006
     C                     MOVE '001'     DBASE                           CDL006
     C                     MOVE POPTN     DBOPTN                          CDL006
     C                     MOVELPOPTN     DBKEY                           CDL006
     C                     GOTO END                                       CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           PRTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     ELSE                                           CDL006
     C                     MOVE 'N'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                                       CGL015
      ** Access Switchable Feature Details, Check if CGL015 is                                CGL015
      ** switch on.                                                                           CGL015
      *                                                                                       CGL015
     C                     CALL 'AOSARDR0'                                                    CGL015
     C                     PARM *BLANKS   PRTCD   7                                           CGL015
     C                     PARM '*VERIFY 'POPTN   7                                           CGL015
     C                     PARM 'CGL015'  PSARD   6                                           CGL015
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL015
      *                                                                                       CGL015
     C           PRTCD     IFNE *BLANKS                                                       CGL015
     C           PRTCD     ANDNE'*NRF '                                                       CGL015
     C                     MOVE '1'       *INU7                                               CGL015
     C                     MOVE '1'       *INU8                                               CGL015
     C                     MOVE '1'       *INLR                                               CGL015
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL015
     C                     MOVE '020'     DBASE                                               CGL015
     C                     MOVE POPTN     DBOPTN                                              CGL015
     C                     MOVELPOPTN     DBKEY                                               CGL015
     C                     GOTO END                                                           CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C           PRTCD     IFEQ *BLANKS                                                       CGL015
     C                     MOVE 'Y'       CGL015  1                                           CGL015
     C                     ELSE                                                               CGL015
     C                     MOVE 'N'       CGL015                                              CGL015
     C                     ENDIF                                                              CGL015
     C/COPY WNCPYSRC,DLH00403
      *                                                                                       CDL099
      **   Check if feature CDL099 is enabled                                                 CDL099
      *                                                                                       CDL099
     C                     CALL 'AOSARDR0'                                                    CDL099
     C                     PARM '*MSG   ' @RTCD   7                                           CDL099
     C                     PARM '*KEY   ' @OPTN   7                                           CDL099
     C                     PARM 'CDL099'  @SARD   6                                           CDL099
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL099
      *                                                                                       CDL099
     C           @RTCD     IFEQ *BLANKS                                                       CDL099
     C                     MOVE 'Y'       CDL099  1                                           CDL099
     C                     ELSE                                                               CDL099
     C                     MOVE 'N'       CDL099                                              CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CAS005
      ** Access Switchable Feature Details, check if CAS005 is                                CAS005
      ** switch on.                                                                           CAS005
      *                                                                                       CAS005
     C                     CALL 'AOSARDR0'                                                    CAS005
     C                     PARM *BLANKS   PRTCD                                               CAS005
     C                     PARM '*VERIFY 'POPTN                                               CAS005
     C                     PARM 'CAS005'  PSARD                                               CAS005
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS005
      *                                                                                       CAS005
     C           PRTCD     IFNE *BLANKS                                                       CAS005
     C           PRTCD     ANDNE'*NRF '                                                       CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     MOVE *ON       *INLR                                               CAS005
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS005
     C                     MOVE '19'      DBASE                                               CAS005
     C                     MOVE POPTN     DBOPTN                                              CAS005
     C                     MOVELPSARD     DBKEY                                               CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           PRTCD     IFEQ *BLANKS                                                       CAS005
     C                     MOVE 'Y'       CAS005  1                                           CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE 'N'       CAS005                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *LIKE     DEFN ZIRATE    WZRATE                                              CAS005
     C*                                                                   CEU015
     C/COPY WNCPYSRC,DL0400CCP9                                           S01408
      *                                                                                       CGL187
      ** Access switchable features file for CGL187                                           CGL187
      *                                                                                       CGL187
     C                     CALL 'AOSARDR0'                                                    CGL187
     C                     PARM *BLANKS   @RTCD                                               CGL187
     C                     PARM '*VERIFY' @OPTN                                               CGL187
     C                     PARM 'CGL187'  @SARD                                               CGL187
      *                                                                                       CGL187
     C                     MOVE 'N'       CGL187  1                                           CGL187
     C           @RTCD     IFEQ *BLANK                                                        CGL187
     C                     MOVE 'Y'       CGL187                                              CGL187
     C                     OPEN EVNTXEX0                                                      CGL187
     C                     ENDIF                                                              CGL187
     C*                                                                   S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*                                                                   S01195
     C** SET UP SYSTEM LOCATION FOR FUTURE USE                            S01195
     C                     MOVELBJSLCD    ZLOC                            S01195
0279 C*                                                                   S01194
0606 C*
0607 C****                 MOVE '11'      TABKEY                          S01194
0608 C***                  EXSR TABCHN                                    S01194
     C***U7                GOTO END                                       S01194
     C*                                                                   S01194
     C* CALL A/O AODEALR0                                                 S01194
     C*                                                                   S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDDEALPD'DBFILE           ************   S01194
     C                     MOVE '02'      DBASE            * DBERR 02 *   S01194
     C                     MOVE @OPTN     DBOPTN           ************   S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           @RTCD     CABNE*BLANK    END                             S01194
      *                                                                                       CGL015
      **  Calculate Tax Rate (HK Tax Rate)                                                    CGL015
      *                                                                                       CGL015
     C           BNHKTR    DIV  100       TAXR    54                                          CGL015
      *                                                                                       CGL015
     C/COPY WNCPYSRC,DL0400C001
1649 C*                                                                   055773
1649 C** Access GL details.                                               055773
1649 C*                                                                   055773
1649 C**********           CALL 'AOGELRR0'                                             055773 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
1649 C                     PARM '*MSG   ' @RTCD                           055773
1649 C                     PARM '*FIRST ' @OPTN                           055773
1649 C********** SDGELR    PARM SDGELR    DSFDY                                        055773 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
1649 C*                                                                   055773
1649 C           @RTCD     IFNE *BLANK                                    055773
1649 C                     SETON                     U7U8LR               055773
1649 C                     MOVEL'SDGELRPD'DBFILE           *************  055773
1649 C                     MOVE '007'     DBASE            * DBERR 007 *  055773
1649 C                     MOVEL@OPTN     DBOPTN           *************  055773
1649 C                     MOVEL@OPTN     DBKEY                           055773
     C                     GOTO END                                       055773
1649 C                     END                                            055773
      *                                                                                       234341
      ** Check if switchable feature CGL031 is switched on                                    234341
      *                                                                                       234341
     C                     CALL 'AOSARDR0'                                                    234341
     C                     PARM *BLANKS   PRTCD                                               234341
     C                     PARM '*VERIFY' POPTN                                               234341
     C                     PARM 'CGL031'  PSARD                                               234341
     C           SCSARD    PARM SCSARD    DSFDY                                               234341
      *                                                                                       234341
     C           PRTCD     IFNE *BLANK                                                        234341
     C           PRTCD     ANDNE'*NRF   '                                                     234341
     C                     MOVEL'SCSARDPD'DBFILE           *************                      234341
     C                     MOVEL'20'      DBASE            * DBERR 020 *                      234341
     C                     MOVEL'CGL031'  DBKEY            *************                      234341
     C                     MOVE *ON       *INU7                                               234341
     C                     MOVE *ON       *INU8                                               234341
     C                     EXSR *PSSR                                                         234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
     C           PRTCD     IFEQ *BLANKS                                                       234341
     C                     MOVE 'Y'       CGL031  1                                           234341
     C                     ELSE                                                               234341
     C                     MOVE 'N'       CGL031                                              234341
     C                     ENDIF                                                              234341
      *                                                                                       CRE073
      ** Check if switchable feature CRE073 is switched on                                    CRE073
      *                                                                                       CRE073
     C                     CALL 'AOSARDR0'                                                    CRE073
     C                     PARM *BLANKS   PRTCD                                               CRE073
     C                     PARM '*VERIFY' POPTN                                               CRE073
     C                     PARM 'CRE073'  PSARD                                               CRE073
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE073
      *                                                                                       CRE073
     C           PRTCD     IFNE *BLANK                                                        CRE073
     C           PRTCD     ANDNE'*NRF   '                                                     CRE073
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE073
     C                     MOVEL'025'     DBASE                                               CRE073
     C                     MOVEL'CRE073'  DBKEY                                               CRE073
     C                     EXSR *PSSR                                                         CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
     C           PRTCD     IFEQ *BLANKS                                                       CRE073
     C                     MOVE 'Y'       CRE073  1                                           CRE073
     C                     ELSE                                                               CRE073
     C                     MOVE 'N'       CRE073                                              CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CDL096
      ** Check if CDL096 - Business Day Conventions for MM Deals - is switched on             CDL096
      *                                                                                       CDL096
     C                     CALL 'AOSARDR0'                                                    CDL096
     C                     PARM *BLANKS   PRTCD                                               CDL096
     C                     PARM '*VERIFY' POPTN                                               CDL096
     C                     PARM 'CDL096'  PSARD                                               CDL096
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL096
      *                                                                                       CDL096
     C           PRTCD     IFEQ *BLANKS                                                       CDL096
     C                     MOVE 'Y'       CDL096  1                                           CDL096
     C                     ELSE                                                               CDL096
     C                     MOVE 'N'       CDL096                                              CDL096
     C                     ENDIF                                                              CDL096
      *                                                                                       CDL096
     C*                                                                   S01194
     C** For Accrual for Non-working Days Processing Types 0 and 1,       055773
     C** Event Control Date is DNWD - 1.                                  055773
     C*                                                                   055773
0609 C****       DNWD      SUB  1         ECD     50                      S01194
0609 C           BJDNWD    SUB  1         ECD     50                      S01194
     C*                                                                   055773
     C** If Accrual for Non-working days indicator is equal 2, then       055773
     C** if the Accrual/Profit Date is less than or equal to Date of      055773
     C** Next Working Day minus 1, the Event Control Date should be       055773
     C** the Accrual/Profit Date.  Otherwise, it should be Run Date.      055773
     C** This is because Processing Type 2 processes non-working days     055773
     C** retrospectively and will only generate events up to today,       055773
     C** unless the next accrual day is before the next working day, in   055773
     C** which case it will generate events to accrual day.               055773
     C*                                                                   055773
     C           BKANWD    IFEQ '2'                                       055773
     C           BKAPDT    IFLE ECD                                       055773
     C                     Z-ADDBKAPDT    ECD                             055773
     C                     ELSE                                           055773
     C                     Z-ADDBJRDNB    ECD                             055773
     C                     END                                            055773
     C                     END                                            055773
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
      ** Determine Control Date To Calculate Interest Accrued for SWAP                        CGL187
      *                                                                                       CGL187
     C                     Z-ADDBJDNWD    REPCD   50                                          CGL187
      *                                                                                       CGL187
      ** If First Day Accrual                                                                 CGL187
      *                                                                                       CGL187
     C           BKALDI    IFEQ 'Y'                                                           CGL187
     C           BJDNWD    SUB  1         REPCD                                               CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
     C           BKAPDT    IFLT BJDNWD                                                        CGL187
     C           BKAPDT    ADD  1         REPCD                                               CGL187
     C           BKALDI    IFEQ 'Y'                                                           CGL187
     C                     Z-ADDBKAPDT    REPCD                                               CGL187
     C                     END                                                                CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
0610 C*
0611 C***                  MOVE '40'      TABKEY                          S01194
0612 C***                  EXSR TABCHN                                    S01194
     C***U7                GOTO END                                       S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR************   S01194
     C                     MOVE '03'      DBASE            * DBERR 03 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVEL'SDTRADPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           @RTCD     CABNE*BLANK    END                             LN0447
     C*                                                                   S01194
     C* CALL A/O AOMMODR0                                                 S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     U7U8LR************   S01194
     C                     MOVE '06'      DBASE            * DBERR 06 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVEL'SDMMODPD'DBFILE                          S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           @RTCD     CABNE*BLANK    END                             LN0447
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
     C                     MOVE 'N'       W0CHCO  1                       CDL006
      *                                                                   CDL006
      ** If Charges taken, Commission or Accrue commisssion.              CDL006
      *                                                                   CDL006
     C           BNCHTK    IFEQ 'Y'                                       CDL006
     C           BNCOTK    OREQ 'Y'                                       CDL006
     C           BNACCO    OREQ 'Y'                                       CDL006
     C                     MOVE 'Y'       W0CHCO                          CDL006
     C                     OPEN DLCCGDL0                                  CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0400CCP5                                           S01408
     C*                                                                   S01408
     C*                                                                   CAC001
     C** Check if Analytical Accounting Module is switched on             CAC001
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '1'       *IN17                           CAC001
     C                     ELSE                                           CAC001
     C/COPY WNCPYSRC,DL0400C108
     C                     MOVE '0'       *IN17                           CAC001
     C/COPY WNCPYSRC,DL0400C109
     C                     END                                            CAC001
     C/COPY WNCPYSRC,DLH00404
0613 C*
0614 C*    OBTAIN NO. OF D.P. FOR BASE CCYAND
0615 C*    LIMITS CCY.
0616 C***                  MOVEL'20      'TABKEY                          S01095
0617 C***                  MOVE BCCY      CCYK                            S01095
0618 C***                  MOVE '1'       TABKEY                          S01095
0619 C***                  EXSR TABCHN                                    S01095
0620 C***U7                GOTO END                                       S01095
0621 C***                  Z-ADDCDP       BCD     10                      S01095
0622 C***                  MOVE BCYL      CCYK                            S01095
0623 C***                  EXSR TABCHN                                    S01095
0624 C***U7                MOVEL'TABLECCY'ERROR  20                       S01095
0625 C***U7                MOVE TABKEY    ERROR                           S01095
0626 C***U7                GOTO END                                       S01095
0627 C***                  Z-ADDCDP       LMD     10                      S01095
     C**   BASE CCY DETAILS                                               S01095
     C                     Z-ADD1         I       30                      S01095
     C****       BCCY      LOKUPCY,I                     50       S01095  S01194
     C           BJCYCD    LOKUPCY,I                     50               S01194
     C           *IN50     IFEQ '1'                        ** IF  001     S01095
     C                     MOVE CYD,I     CYDDS                           S01095
     C                     Z-ADDCDP       BCD     10                      S01095
     C                     ELSE                            ** ELS 001     S01095
     C**    ERROR IF NOT FOUND                                            S01095
     C                     MOVE '1'       *INU7                           S01095
     C                     MOVEL'NO CCY'  ERROR  20                       S01095
     C***                  MOVE BCCY      ERROR                   S01095  S01194
     C                     MOVE BJCYCD    ERROR                           S01194
     C                     GOTO END                                       S01095
     C                     END                             ** END 001     S01095
     C**    LIMIT CCY DETAILS                                             S01095
     C                     Z-ADD1         I                               S01095
     C*****      BCYL      LOKUPCY,I                     50       S01095  S01194
     C           BNCYCD    LOKUPCY,I                     50               S01194
     C           *IN50     IFEQ '1'                        ** IF  001     S01095
     C                     MOVE CYD,I     CYDDS                           S01095
     C                     Z-ADDCDP       LMD     10                      S01095
     C                     ELSE                            ** ELS 001     S01095
     C**    ERROR IF NOT FOUND                                            S01095
     C                     MOVE '1'       *INU7                           S01095
     C                     MOVEL'NO CCY'  ERROR                           S01095
     C****                 MOVE BCYL      ERROR                   S01095  S01194
     C                     MOVE BNCYCD    ERROR                           S01194
     C                     GOTO END                                       S01095
     C                     END                             ** END 001     S01095
0628 C*
0629 C******               MOVE 'A'       CLIKEY  7                       S01194
0630 C                     Z-ADD0         AMT,1
0631 C                     Z-ADD0         DAT,1
0632 C                     Z-ADD0         ZERO13 130
     C                     Z-ADD0         ZERO5   50
     C**
     C** RESET REC COUNTS FOR EMTE2, EMXT2
     C                     Z-ADD0         TNDLR   50
     C                     Z-ADD0         XNDLR   50
     C*
     C** SET NO. OF DAYS FORWARD TO ZERO FOR USE IN ZFWDT                 S01195
     C                     Z-ADD0         ZNRDYS                          S01195
     C*                                                                   S01195
     C**  TO LOAD BRANCH/COMPANY CODE ARRAY                               S01117
     C**                                                                  S01117
     C*****ET POINTER                                             S01117  S01194
     C***                  MOVE *BLANK    TABKEY 12               S01117  S01194
     C***                  MOVEL'10'      TABKEY                  S01117  S01194
     C***        TABKEY    SETLLTABLE                             S01117  S01194
     C***                  Z-ADD1         X       30              S01117  S01194
     C******AD BRANCH RECORDS                                     S01117  S01194
     C***        RECT      DOUNE10                                S01117  S01194
     C***                  MOVE *ZEROS    RECT                    S01117  S01194
     C***                  READ TABLE                    99       S01117  S01194
     C****** LIVE BRANCH, UPDATE ARRAY                            S01117  S01194
     C***        RECT      IFEQ 10                                S01117  S01194
     C***        RECI      ANDEQ'D'                               S01117  S01194
     C***                  MOVE BRAN      BR,X                    S01117  S01194
     C******               MOVE CMPY      CO,X             S01117 S01117  S01194
     C***                  MOVE CMPYM     CO,X                    S01117  S01194
     C***                  ADD  1         X                       S01117  S01194
     C***                  END                                    S01117  S01194
     C****                 END                                    S01117  S01194
     C**                                                          S01117  S01194
     C**                                                          S01117  S01194
     C* LOAD ARRAY OF BRANCH AND COMPANY CODES FROM SDBRCHPD              S01194
     C*                                                                   S01194
     C/COPY WNCPYSRC,DL0400C002
     C                     OPEN SDBRCHL1                                                      234341
     C           1         SETLLSDBRCHL1                                  S01194
     C                     READ SDBRCHL1                 80               S01194
     C/COPY WNCPYSRC,DL0400C003
     C***********          Z-ADD1         X       20               S01194 151104
     C                     Z-ADD1         X       30                      151104
     C*                                                                   S01194
     C/COPY WNCPYSRC,DL0400C004
     C           *IN80     DOWEQ'0'                                       S01194
     C/COPY WNCPYSRC,DL0400C005
     C*                                                                   S01194
     C                     MOVE A8BRCD    BR,X                            S01194
     C                     MOVE A8CMCD    CO,X                            S01194
     C                     MOVE A8BICN    IC,X                            S01117
     C                     MOVE A8LCCD    LC,X                                                234341
     C*                                                                   S01354
     C*** Access Customer Details of Branch                               S01354
     C*                                                                   S01354
     C                     MOVE *BLANK    @KEY1                           S01354
     C                     MOVELA8BICN    @KEY1                           S01354
     C******               CALL 'AOCUSTR0'                         S01354 220738
     C                     CALL 'AOCUSTR1'                                220738
     C                     PARM '*MSG   ' @RTCD                           S01354
     C                     PARM '*KEY   ' @OPTN                           S01354
     C                     PARM           @KEY1  10                       S01354
     C                     PARM *BLANK    @KYST   7                       S01354
     C****       SDCUST    PARM SDCUST    DSSDY                    S01354 220738
     C           SDCUST    PARM SDCUST    DSLDY                           220738
     C*                                                                   S01354
     C           @RTCD     IFNE *BLANK                                    S01354
     C           BBCLST    ANDNE'Y'                                       220738
     C                     MOVE '1'       *INU7                           S01354
     C                     MOVE '1'       *INU8                           S01354
     C                     MOVE '1'       *INLR                           S01354
     C                     MOVEL'SDCUSTPD'DBFILE           ************   S01354
     C                     MOVE '012'     DBASE            * DBERR 12 *   S01354
     C                     MOVE @OPTN     DBOPTN           ************   S01354
     C                     MOVEL@KEY1     DBKEY                           S01354
     C                     GOTO END                                       S01354
     C                     END                                            S01354
     C*                                                                   S01354
0661 C                     MOVE BBPCNB    CP,X                            S01354
0662 C                     MOVE BBCRNM    CR,X                            S01354
0663 C                     MOVE BBCRTN    CT,X                            S01354
0664 C                     MOVE BBCASC    CA,X                            S01354
0665 C                     MOVE BBCNCZ    CZ,X                            S01354
0666 C                     MOVE BBCOLC    CL,X                            S01354
0666 C                     MOVE BBPAIN    PI,X                            S01354
     C*                                                                   S01354
     C*** Access Customer Details of Parent                               S01354
     C*                                                                   S01354
     C           BBPCNB    IFNE *BLANK                                    S01354
     C                     MOVE *BLANK    @KEY1                           S01354
     C                     MOVELBBPCNB    @KEY1                           S01354
     C******               CALL 'AOCUSTR0'                         S01354 220738
     C                     CALL 'AOCUSTR1'                                220738
     C                     PARM '*MSG   ' @RTCD                           S01354
     C                     PARM '*KEY   ' @OPTN                           S01354
     C                     PARM           @KEY1  10                       S01354
     C                     PARM *BLANK    @KYST   7                       S01354
     C****       SDCUST    PARM SDCUST    DSSDY                    S01354 220738
     C           SDCUST    PARM SDCUST    DSLDY                           220738
     C*                                                                   S01354
     C           @RTCD     IFNE *BLANK                                    S01354
     C           BBCLST    ANDNE'Y'                                       220738
     C                     MOVE '1'       *INU7                           S01354
     C                     MOVE '1'       *INU8                           S01354
     C                     MOVE '1'       *INLR                           S01354
     C                     MOVEL'SDCUSTPD'DBFILE           ************   S01354
     C                     MOVE '013'     DBASE            * DBERR 13 *   S01354
     C                     MOVE @OPTN     DBOPTN           ************   S01354
     C                     MOVEL@KEY1     DBKEY                           S01354
     C                     GOTO END                                       S01354
     C                     END                                            S01354
     C*                                                                   S01354
0662 C                     MOVE BBCRNM    PR,X                            S01354
0663 C                     MOVE BBCRTN    PT,X                            S01354
0664 C                     MOVE BBCASC    PA,X                            S01354
     C                     END                                            S01354
0669 C*                                                                   S01354
     C                     ADD  1         X                               S01194
     C*                                                                   S01194
     C/COPY WNCPYSRC,DL0400C006
     C                     READ SDBRCHL1                 80               S01194
     C*                                                                   S01194
     C/COPY WNCPYSRC,DL0400C007
     C                     END                                            S01194
     C                     CLOSESDBRCHL1                                                      234341
     C*
     C*
     C**  SET INITIAL POINTER FOR TOP-DOWN ARRAY OF COUNTRY/REGION        S01095
     C                     Z-ADD200       II      30                      S01095
     C****SETUP*KEY*TO*COUNTRY*TABLE                               S01095 S01194
     C******               MOVEL'50'      KEY50  12                S01095 S01194
      *                                                                   CDL002
      * Access Switchable features file for                               CDL002
      * FX Netting - CDL002                                               CDL002
     C                     CALL 'AOSARDR0'                                CDL002
     C                     PARM *BLANKS   @RTCD                           CDL002
     C                     PARM '*VERIFY' @OPTN                           CDL002
     C                     PARM 'CDL002'  WSARD   6                       CDL002
     C           SCSARD    PARM SCSARD    DSFDY                           CDL002
     C                     MOVE 'N'       CDL002  1                       CDL002
     C           @RTCD     IFEQ *BLANK                                    CDL002
     C                     MOVE 'Y'       CDL002                          CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C* Get Exposure Management ICD                                       CDL002
     C           BGEXMG    IFEQ 'Y'                                       CDL002
     C                     CALL 'AOEXPMR0'                                CDL002
     C                     PARM '*BLANKS' @RTCD   7                       CDL002
     C                     PARM '*KEY   ' @OPTN   7                       CDL002
     C           SDEXPM    PARM SDEXPM    DSFDY                           CDL002
     C           @RTCD     IFNE *BLANKS                                   CDL002
     C                     SETON                     U7U8LR               CDL002
     C                     MOVEL'AOEXPMR0'DBFILE           ************   CDL002
     C                     MOVEL'15'      DBASE            *  DBASE15 *   CDL002
     C                     MOVE @OPTN     DBOPTN           ************   CDL002
     C                     GOTO END                                       CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
      * Net FX Exposure?                                                  CDL002
     C                     MOVE 'N'       W#NFXE  1                       CDL002
     C           CDL002    IFEQ 'Y'                                       CDL002
     C           BGEXMG    ANDEQ'Y'                                       CDL002
     C                     MOVE BUNTEM    W#NFXE                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                                       CLE025
      ** Check if enhancement CLE025 (Credit Lines) is on                                     CLE025
      *                                                                                       CLE025
     C                     CALL 'AOSARDR0'                                                    CLE025
     C                     PARM *BLANKS   PRTCD                                               CLE025
     C                     PARM '*VERIFY' POPTN                                               CLE025
     C                     PARM 'CLE025'  PSARD                                               CLE025
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE025
      *                                                                                       CLE025
     C           PRTCD     IFNE *BLANKS                                                       CLE025
     C           PRTCD     ANDNE'*NRF   '                                                     CLE025
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE025
     C                     MOVEL'CLE025'  DBKEY                                               CLE025
     C                     MOVE '019'     DBASE                                               CLE025
     C                     SETON                     U7U8LR                                   CLE025
     C                     GOTO END                                                           CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
     C           PRTCD     IFEQ *BLANKS                                                       CLE025
     C                     MOVE 'Y'       CLE025  1                                           CLE025
     C                     ELSE                                                               CLE025
     C                     MOVE 'N'       CLE025                                              CLE025
     C                     ENDIF                                                              CLE025
     C*
      *                                                                   CDL020
      * Check if swicthable feature CDL020 is switched on                 CDL020
     C                     CALL 'AOSARDR0'                                CDL020
     C                     PARM *BLANKS   @RTCD                           CDL020
     C                     PARM '*VERIFY' @OPTN                           CDL020
     C                     PARM 'CDL020'  WSARD   6                       CDL020
     C           SCSARD    PARM SCSARD    DSFDY                           CDL020
     C                     MOVE 'N'       CDL020  1                       CDL020
     C           @RTCD     IFEQ *BLANK                                    CDL020
     C                     MOVE 'Y'       CDL020                          CDL020
     C                     ENDIF                                          CDL020
      ** Determine if Portfolio Management is swicthed on.                S01486
      ** or Private Banking is switched on                                CPB001
      ** o  used to determine if PTFR is output to EVNTXED.               S01486
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C                     MOVE *ON       *IN67                           S01486
     C                     END                                            S01486
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0400CCP3                                           S01408
      *                                                                                       CDL033
      ** Determine if Floating Rate CD Issued feature is                                      CDL033
      ** switched on.                                                                         CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    CDL033  1                                           CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   PRTCD                                               CDL033
     C                     PARM '*VERIFY' POPTN                                               CDL033
     C                     PARM 'CDL033'  PSARD                                               CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           PRTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVE 'Y'       CDL033                                              CDL033
     C                     OPEN DLFRSCL2                                                      CDL033
     C                     OPEN DLFRSCL3                                                      CDL033
     C                     ELSE                                                               CDL033
      *                                                                                       CDL033
     C           PRTCD     IFNE '*NRF   '                                                     CDL033
     C                     MOVE '020'     DBASE                                               CDL033
     C                     MOVEL'CDL033'  DBKEY                                               CDL033
     C                     MOVELPOPTN     DBOPTN                                              CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     GOTO END                                                           CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                     MD027339
      ** Determine if SAR CER048 is installed                                               MD027339
      *                                                                                     MD027339
     C                     CALL 'AOSARDR0'                                                  MD027339
     C                     PARM *BLANKS   PRTCD                                             MD027339
     C                     PARM '*VERIFY 'POPTN                                             MD027339
     C                     PARM 'CER048'  PSARD                                             MD027339
     C           SCSARD    PARM SCSARD    DSFDY                                             MD027339
      *                                                                                     MD027339
     C           @RTCD     IFNE *BLANKS                                                     MD027339
     C           @RTCD     ANDNE'*NRF   '                                                   MD027339
     C                     MOVEL'SCSARDPD'DBFILE                                            MD027339
     C                     MOVEL'901'     DBASE                                             MD027339
     C                     MOVEL'CER048'  DBKEY                                             MD027339
     C                     MOVE *ON       *INU7                                             MD027339
     C                     MOVE *ON       *INU8                                             MD027339
     C                     MOVE *ON       *INLR                                             MD027339
     C                     EXSR *PSSR                                                       MD027339
     C                     ENDIF                                                            MD027339
      *                                                                                     MD027339
     C           PRTCD     IFEQ *BLANKS                                                     MD027339
     C                     MOVE 'Y'       CER048  1                                         MD027339
     C                     ELSE                                                             MD027339
     C                     MOVE 'N'       CER048                                            MD027339
     C                     ENDIF                                                            MD027339
      *                                                                                     MD027339
      ** Determine if SAR CER054 is installed                                               MD027339
      *                                                                                     MD027339
     C                     CALL 'AOSARDR0'                                                  MD027339
     C                     PARM *BLANKS   PRTCD                                             MD027339
     C                     PARM '*VERIFY 'POPTN                                             MD027339
     C                     PARM 'CER054'  PSARD                                             MD027339
     C           SCSARD    PARM SCSARD    DSFDY                                             MD027339
      *                                                                                     MD027339
     C           @RTCD     IFNE *BLANKS                                                     MD027339
     C           @RTCD     ANDNE'*NRF   '                                                   MD027339
     C                     MOVEL'SCSARDPD'DBFILE                                            MD027339
     C                     MOVEL'902'     DBASE                                             MD027339
     C                     MOVEL'CER054'  DBKEY                                             MD027339
     C                     MOVE *ON       *INU7                                             MD027339
     C                     MOVE *ON       *INU8                                             MD027339
     C                     MOVE *ON       *INLR                                             MD027339
     C                     EXSR *PSSR                                                       MD027339
     C                     ENDIF                                                            MD027339
      *                                                                                     MD027339
     C           PRTCD     IFEQ *BLANKS                                                     MD027339
     C                     MOVE 'Y'       CER054  1                                         MD027339
     C                     ELSE                                                             MD027339
     C                     MOVE 'N'       CER054                                            MD027339
     C                     ENDIF                                                            MD027339
      *                                                                                       CER049
      ** Determine if SAR CER049 is installed                                                 CER049
      *                                                                                       CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   PRTCD                                               CER049
     C                     PARM '*VERIFY 'POPTN                                               CER049
     C                     PARM 'CER049'  PSARD                                               CER049
     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
      *                                                                                       CER049
     C           @RTCD     IFNE *BLANKS                                                       CER049
     C           @RTCD     ANDNE'*NRF   '                                                     CER049
     C                     MOVEL'SCSARDPD'DBFILE                                              CER049
     C                     MOVEL'21'      DBASE                                               CER049
     C                     MOVEL'CER049'  DBKEY                                               CER049
     C                     MOVE *ON       *INU7                                               CER049
     C                     MOVE *ON       *INU8                                               CER049
     C                     MOVE *ON       *INLR                                               CER049
     C                     EXSR *PSSR                                                         CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PRTCD     IFEQ *BLANKS                                                       CER049
     C                     MOVE 'Y'       CER049  1                                           CER049
     C                     ELSE                                                               CER049
     C                     MOVE 'N'       CER049                                              CER049
     C                     ENDIF                                                              CER049
     C*                                                                   S01408
     C                     MOVE *BLANKS   SETDUM 10                                           CGL029
     C                     Z-ADD0         ICIR                                              BUG28009
     C                     Z-ADD0         ICAM                                              BUG28009
     C                     Z-ADD0         RBDN                                              BUG28009
     C                     Z-ADD0         EVFCGA                                            BUG28009
     C                     Z-ADD0         EVFCMA                                            BUG28009
     C                     Z-ADD0         EVETAX                                            BUG28009
     C                     Z-ADD0         ZEROTX                                            BUG28009
     C*
0633 C*
0634 C*    KEEP COUNTS AND HASH TOTALS FOR DEALS FILE
0635 C*
0636 C           START     TAG                             ** START TAG **
     C           *IN02     IFEQ *ON                                                           CER069
     C           TAXI      ANDEQ'A'                                                           CER069
     C                     CALL 'AOACTXR0'                                                    CER069
     C                     PARM *BLANKS   @RTCD                                               CER069
     C                     PARM '*KEY    '@OPTN                                               CER069
     C                     PARM CNUM      @CNUM   6                                           CER069
     C                     PARM BRCA      @BRCD   3                                           CER069
     C           SDACTX    PARM SDACTX    DSFDY                                               CER069
     C           @RTCD     IFNE *BLANKS                                                       CER069
     C           AXETXS    OREQ *BLANKS                                                       CER069
     C           AXETXS    OREQ 'S'                                                           CER069
     C           AXETXS    OREQ 'E'                                                           CER069
     C           AXETXS    OREQ 'D'                                                           CER069
     C                     MOVE 'N'       TAXI                                                CER069
     C                     ELSE                                                               CER069
     C                     MOVE AXETXS    TAXI                                                CER069
     C                     ENDIF                                                              CER069
     C                     ENDIF                                                              CER069
     C*                                                                   CDL002
     C                     CLEAR*IN36                                     CDL002
     C                     CLEAR*IN37                                     CDL002
     C                     SETOF                     72                   138004
     C*                                                                   138004
     C                     MOVE '0'       *IN69                           138004
     C*                                                                   138004
     C* Roll over deal amount being left as blank if indicator 42         138004
     C* not on when posting to events file EVNTXED. Post Z13 if           138004
     C* Indicator 42 not on. To stop blanks being posted to RBDA          138004
     C* field.                                                            138004
     C**                                                                  138004
     C           *LIKE     DEFN RBDA      Z13                             138004
     C*                                                                   S01194
     C* SET INPUT FIELDS FOR HOLIDAY SUBROUTINE                           S01194
     C*                                                                   S01194
     C                     Z-ADD0         INTDUE
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD0         INTDUN                                              CAS005
     C                     Z-ADDMDAT      WMDAT   50                                          CAS005
     C                     ENDIF                                                              CAS005
0637 C           DTYP      COMP 'PS'                     31
0638 C*
0639 C***********COUNT*****ADD  1         COUNT   50                      LN0447
      *                                                                                       CGL015
      ** If it is not DEALSDC then move 'N' to TAXI, just to be sure.                         CGL015
      *                                                                                       CGL015
     C           *IN02     IFNE '1'                                                           CGL015
     C           CGL015    ANDEQ'Y'                                                           CGL015
     C                     MOVE 'N'       TAXI                                                CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
      ** Reinitialise Tax field and indicator for each deal processed.                        CGL015
      *                                                                                       CGL015
     C                     MOVE '0'       *IN89                                               CGL015
     C                     Z-ADD0         EVETAX 130                                          CGL015
     C                     Z-ADD0         ZEROTX 130                                          CGL015
     C*
     C/COPY WNCPYSRC,DL0400C008
     C                     SETOF                     0661
0641 C   05                GOTO TRAIL
0642 C  N01N02N03
0643 CANN04N09             GOTO END
     C*                                                                   AUS003
     C**   STORE RECORD ID OF DEAL                                        AUS003
     C*                                                                   AUS003
     C                     MOVE RECI      RECISV  1                       AUS003
     C/COPY WNCPYSRC,DL0400C009
     C*                                                                   AUS003
     C**   GET CUSTOMER DETAILS FROM CLIENT FILE                          AUS003
     C*                                                                   AUS003
     C           *INL1     IFEQ '1'                                       AUS003
     C                     MOVELCUSTNO    @KEY1                           AUS003
     C                     EXSR CLICHN                                    AUS003
     C           BBPAIN    IFEQ 'P'                                       AUS003
     C                     SETON                     40                   AUS003
     C                     END                                            AUS003
     C                     MOVE BBPCNB    CPARC                           AUS003
     C                     MOVE BBCRNM    CRNMC                           AUS003
     C                     MOVE BBCRTN    CTWNC                           AUS003
     C                     MOVE BBCASC    CASKC                           AUS003
     C                     MOVE BBCNCZ    CCTZC                           AUS003
     C                     MOVE BBCOLC    CLOCC                           AUS003
     C*                                                                   AUS003
     C**   GET PARENT DETAILS FROM CLIENT FILE                            AUS003
     C*                                                                   AUS003
     C                     MOVELBBPCNB    @KEY1                           AUS003
     C           BBPCNB    IFNE *BLANKS                                   AUS003
     C                     SETON                     45                   AUS003
     C                     EXSR CLICHN                                    AUS003
     C                     MOVE *IN40     IND40                           073893
     C                     MOVE *IN45     IND45                           073893
     C                     END                                            AUS003
     C*                                                                   AUS003
     C**  CHECK ARRAY FOR COUNTRY CODE                                    AUS003
     C*                                                                   AUS003
     C                     Z-ADDII        I                               AUS003
     C           CCTZC     LOKUPCC,I                     50               AUS003
     C           *IN50     IFEQ '1'                                       AUS003
     C                     MOVE RC,I      A4RGCD                          AUS003
     C                     ELSE                                           AUS003
     C**  ELSE GET IT FROM FILE AND ADD TO ARRAY                          AUS003
     C*                                                                   AUS003
     C                     CALL 'AOCTRYR0'                                AUS003
     C                     PARM '*MSG   ' @RTCD                           AUS003
     C                     PARM '*KEY   ' @OPTN                           AUS003
     C                     PARM CCTZC     @AXCD                           AUS003
     C           SDCTRY    PARM SDCTRY    DSFDY                           AUS003
     C*                                                                   AUS003
     C           @RTCD     IFNE *BLANK                                    AUS003
     C                     SETON                     U7U8  ************   AUS003
     C                     MOVE '05'      DBASE            * DBERR 05 *   AUS003
     C                     MOVE @OPTN     DBOPTN           ************   AUS003
     C                     MOVEL@AXCD     DBKEY                           AUS003
     C                     MOVEL'SDCTRYPD'DBFILE                          AUS003
     C                     GOTO END                                       AUS003
     C                     ELSE                                           AUS003
     C*                                                                   AUS003
     C                     SUB  1         II                              AUS003
     C                     MOVE CCTZC     CC,II                           AUS003
     C                     MOVE A4RGCD    RC,II                           AUS003
     C                     END                                            AUS003
     C                     END                                            AUS003
     C                     END                                            AUS003
     C*    DEAL WITH INTEREST FREQUENCY NOT 'N' HAS MATURED, SO BYPASS    AUS003
     C*                                                                   AUS003
     C           *IN02     IFEQ '1'                                       AUS003
     C           RECISV    IFEQ 'M'                                       AUS003
     C           IPFR      IFNE 'N'                                       AUS003
     C                     GOTO END                                       AUS003
     C                     END                                            AUS003
     C                     END                                            AUS003
     C                     END                                            AUS003
      *                                                                   CDL006
      ** If feature CDL006 is  installed.                                 CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** Initialize Fiduciary deposits flag.                              CDL006
     C                     MOVE 'N'       WUFIDE  1                       CDL006
     C                     MOVE 'N'       EVFIDE  1                       CDL006
      *                                                                   CDL006
      ** Deal type is a Fiduciary deposit.                                CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FL'                                      CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C                     MOVE 'D'       WUFIDE                          CDL006
     C                     MOVE 'D'       EVFIDE                          CDL006
     C                     ELSE                                           CDL006
      *                                                                   CDL006
      ** Otherwise deal type is a Fiduciary Loan.                         CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'LP'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C                     MOVE 'L'       WUFIDE                          CDL006
     C                     MOVE 'L'       EVFIDE                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Initialize Fiduciary deposit fields.                             CDL006
      *                                                                   CDL006
     C                     Z-ADD*ZEROS    EVFCGA 130                      CDL006
     C                     Z-ADD*ZEROS    EVFCMA 130                      CDL006
      *                                                                   CDL006
      ** Deal type is Deposit call taking(DT), Deposit loan call taking   CDL006
      ** (LT) and Deposit term taking(FT).                                CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
      *                                                                   CDL006
      ** If Charges or Commission.                                        CDL006
      *                                                                   CDL006
     C           W0CHCO    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** If commission taken and Commission code not blank.               CDL006
      *                                                                   CDL006
     C           BNCOTK    IFEQ 'Y'                                       CDL006
     C           FCMC      ANDNE*BLANK                                    CDL006
      *                                                                   CDL006
      ** Setup Key list for Charges type file (DLCCGDL0).                 CDL006
      *                                                                   CDL006
     C           K0SEC     KLIST                                          CDL006
     C                     KFLD           W0CCY                           CDL006
     C                     KFLD           FCMC                            CDL006
     C                     MOVE CCY       W0CCY   3                       CDL006
      *                                                                   CDL006
      ** If commission table in Base currency, access charge type         CDL006
      ** record with the base currency.                                   CDL006
      *                                                                   CDL006
     C           BNCTBC    IFEQ 'Y'                                       CDL006
     C           CCY       ANDNEBJCYCD                                    CDL006
     C                     MOVE BJCYCD    W0CCY                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Access DL Charges Types logical file DLCCGDL0 to retrieve        CDL006
      ** range upper limits and percentages for commission                CDL006
      ** calculation.                                                     CDL006
     C                     Z-ADD0         ZRA                             CDL006
     C                     Z-ADD0         ZPE                             CDL006
     C           K0SEC     CHAINDLCCGDL0             71                   CDL006
      *                                                                   CDL006
      ** If record doesn't exist for Base currency, database error.       CDL006
      *                                                                   CDL006
     C           W0CCY     IFEQ BJCYCD                                    CDL006
     C           *IN71     IFEQ '1'                                       CDL006
     C           *IN71     OREQ '0'                                       CDL006
     C           FDRECI    ANDNE'D'                                       CDL006
     C                     MOVE '1'       *INU7                           CDL006
     C                     MOVE '1'       *INU8                           CDL006
     C                     MOVEL'DLCCGDL0'DBFILE                          CDL006
     C                     MOVE '018'     DBASE                           CDL006
     C                     MOVE '*KEY   ' DBOPTN                          CDL006
     C                     MOVELW0CCY     W0KEY   5                       CDL006
     C                     MOVE FCMC      W0KEY                           CDL006
     C                     MOVELW0KEY     DBKEY                           CDL006
     C                     GOTO END                                       CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If Commission tables in Base currency, convert the range         CDL006
      ** limits amounts from Base currency to Deal currency, only         CDL006
      ** if at least one percentage not equal to 0.                       CDL006
      *                                                                   CDL006
     C           BNCTBC    IFEQ 'Y'                                       CDL006
     C           CCY       ANDNEBJCYCD                                    CDL006
     C           ZPE,1     ANDNE0                                         CDL006
      *                                                                   CDL006
      ** Retrieve Deal currency Spot rate, Number of decimal places       CDL006
      ** and Multiply/divide indicator.                                   CDL006
      *                                                                   CDL006
     C           CCY       LOKUPCY,I                     50               CDL006
      *                                                                   CDL006
      ** Currency code is found.                                          CDL006
      *                                                                   CDL006
     C           *IN50     IFEQ '1'                                       CDL006
     C                     MOVE CYD,I     CYDDS                           CDL006
     C                     Z-ADDCDP       W0CDP   10                      CDL006
     C                     Z-ADDSPOT      W0SPOT 138                      CDL006
     C                     Z-ADDMDIN      W0MDIN  10                      CDL006
      *                                                                   CDL006
      ** Otherwise currency code not found.                               CDL006
      *                                                                   CDL006
     C                     ELSE                                           CDL006
     C                     MOVE '1'       *INU7                           CDL006
     C                     MOVEL'NO CCY'  ERROR  20                       CDL006
     C                     MOVE CCY       ERROR                           CDL006
     C                     GOTO END                                       CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Convert the range limits amounts from Base currency to           CDL006
      ** Deal currency.                                                   CDL006
      *                                                                   CDL006
     C                     EXSR RLACVT                                    CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Save previous Interest accrual control date.                     CDL006
      *                                                                   CDL006
     C                     Z-ADDIACD      WUIACD  50                      CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0400CCPG                                           S01408
     C*                                                                   S01408
     C*                                                                   AUS003
     C           RECISV    IFNE 'M'                                       AUS003
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0400CP12                                           S01408
      *                                                                   S01408
0644 C  N09      COUNTD    ADD  1         COUNTD  50
0645 C   01      PUAM      DIV  1000      ZZAMT        30
0646 C   02      PCPL      DIV  1000      ZZAMT        30
0647 C   03      PUPR      DIV  1000      ZZAMT        30
0648 C   04      SAPR      DIV  1000      ZZAMT        30
     C           *LIKE     DEFN SLAM      SAMT                            S01128
     C   01                Z-SUBSLAM      SAMT                            S01128
0649 C***30N09***          Z-SUBZZAMT     ZZAMT                           031578
0650 C  N09                Z-ADDHASHW     ZZTOTI
0651 C  N09                Z-ADDHASHD     ZZTOTD
0652 C  N09                EXSR GLZADD
0653 C  N09                Z-ADDZZTOTI    HASHW  150
0654 C  N09                Z-ADDZZTOTD    HASHD   30
     C                     END                             ** END 001     AUS003
     C**
     C** CONDITION OUTPUT TO EXTRACT FILE EMXT2
     C** CHECK ACCOUNTING BIT SET
     C   01      DTYP      IFEQ 'OT'                                      E10714
     C                     BITON'0'       ACEI                            E10714
     C                     END                                            E10714
     C   01                TESTB'0'       ACEI           61
     C   02
     COR 03
     COR 04                TESTB'1'       ACEI           61
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0400CCP4                                           S01408
     C*                                                                   S01408
      ** If MM transaction and rollover deal, include in exposure                             169798
      ** on Value Date                                                                        169798
      *                                                                                       169798
     C           *IN02     IFEQ '1'                                                           169798
      *                                                                                       169798
     C           RODN      IFNE *ZEROS                                                        169798
      *                                                                                       169798
     C                     TESTB'1'       ACEI           61                                   169798
      *                                                                                       169798
     C**********           ELSE                                                      169798 MD020363
     C**********           MOVE '1'       *IN61                                      169798 MD020363
     C                     ENDIF                                                              169798
     C                     ENDIF                                                              169798
      *                                                                                       169798
     C                     SETOF                     62
     C*                                                                   S01354
     C**  Internal Funding Deals are Notional Suppress output             S01354
     C**   to Exposure Management Files                                   S01354
     C*                                                                   S01354
     C           DTYP      IFEQ 'IL'                                      S01354
     C           DTYP      OREQ 'ID'                                      S01354
     C                     MOVE '0'       *IN61                           S01354
     C                     END                                            S01354
     C*                                                                   CDL002
     C* Net FX Exposure?                                                  CDL002
     C           W#NFXE    IFEQ 'Y'                                       CDL002
     C           *IN01     ANDEQ'1'                                       CDL002
     C*                                                                   CDL002
     C* Buy amount to be netted?                                          CDL002
     C           NETBR     IFNE *BLANK                                    CDL002
     C*   Suppress output of purchase record to Exposure Management       CDL002
     C                     MOVE *ON       *IN36                           CDL002
     C                     ENDIF                                          CDL002
     C* Sell amount to be netted?                                         CDL002
     C           NETSR     IFNE *BLANK                                    CDL002
     C*   Suppress output of sale record to Exposure Management           CDL002
     C                     MOVE *ON       *IN37                           CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   S01354
     C   01 61   DTYP      COMP 'OP'                     62
     C***U1*61N31**********ADD  1         XNDLR                           CDL002
     C  N36                                                               CDL002
     CAN U1 61N31          ADD  1         XNDLR                           CDL002
     C***01****************                                         S01128CDL002
     C*AN*U1*61N31*********ADD  1         XNDLR                     S01128CDL002
     C   01N37                                                            CDL002
     CAN U1 61N31          ADD  1         XNDLR                           CDL002
0655 C*
0656 C*    GET CUSTOMER DETAILS FROM CLIENT FILE
0657 C*
     C           *INL1     IFEQ '1'                         ** IF  001    S01095
0658 C***                  MOVELCUSTNO    CLIKEY                          S01194
0658 C                     MOVE *BLANK    @KEY1                           S01194
0658 C                     MOVELCUSTNO    @KEY1                           S01194
0659 C                     EXSR CLICHN
     C***U7                MOVEL'CLINT   'ERROR                           S01194
     C***U7                MOVE CLIKEY    ERROR                           S01194
     C   U7                GOTO END
0660 C***                  TESTB'2'       CMIN           40               S01194
     C*****      BBBNST    IFEQ 'Y'                                 S01194E181
      * SAVE ALSO THE VALUES OF IND40 AND IND45  WHICH MAY BE CHANGED BY  E184
     C**  THE FF CHAIN TO SDCUSTPD                                        E184
     C                     MOVE '0'       *IN40                           LN0447
     C                     MOVE '0'       IND40                           LN0447
     C           BBPAIN    IFEQ 'P'                                       E181
     C                     MOVE '1'       *IN40                           S01194
     C                     MOVE '1'       IND40   1                       E184
     C                     END                                            S01194
     C*                                                                   S01194
      *
0661 C***                  MOVE CPAR      CPARC   60                      S01194
0662 C***                  MOVE CRNM      CRNMC  20                       S01194
0663 C***                  MOVE CTWN      CTWNC  10                       S01194
0664 C***                  MOVE CASK      CASKC   8                       S01194
0665 C***                  MOVE CCTZ      CCTZC   2                       S01194
0666 C****                 MOVE CLOC      CLOCC   2                       S01194
0661 C**********           MOVE BBPCNB    CPARC   60                                   S01194 CSD027
0661 C                     MOVE BBPCNB    CPARC   6                                           CSD027
0662 C                     MOVE BBCRNM    CRNMC  20                       S01194
0663 C                     MOVE BBCRTN    CTWNC  10                       S01194
0664 C                     MOVE BBCASC    CASKC   8                       S01194
0665 C                     MOVE BBCNCZ    CCTZC   2                       S01194
0666 C                     MOVE BBCOLC    CLOCC   2                       S01194
0667 C*
0668 C*    GET PARENT DETAILS FROM CLIENT FILE
0669 C*
A670 C****                 MOVELCPAR      CLIKEY                          S01194
0658 C                     MOVE *BLANK    @KEY1                           S01194
0658 C                     MOVELBBPCNB    @KEY1                           S01194
0671 C****       CPAR      COMP 0                    45
0671 C********** CPARC     COMP 0                    45                                       CSD027
0671 C           CPARC     COMP *BLANKS              45                                       CSD027
     C                     MOVE *IN45     IND45   1                       E184
0672 C   45                EXSR CLICHN
     C****5 U7             MOVEL'CLINT   'ERROR                           S01194
     C***** U7             MOVE CLIKEY    ERROR                           S01194
     C   45 U7             GOTO END
0673 C*
0674 C*    GET REGION CODE FROM COUNTRY TABLE
0675 C*
0676 C***                  MOVEL'50'      TABKEY                          S01095
0677 C***                  MOVE '    '    TABKEY                          S01095
0678 C***                  MOVE CCTZC     TABKEY                          S01095
0679 C***                  EXSR TABCHN                                    S01095
0680 C***U7                MOVEL'TABLEREG'ERROR                           S01095
0681 C***U7                MOVE TABKEY    ERROR                           S01095
0682 C***U7                GOTO END                                       S01095
     C**  CHECK ARRAY FOR COUNTRY CODE                                    S01095
     C                     Z-ADDII        I                               S01095
     C           CCTZC     LOKUPCC,I                     50               S01095
     C           *IN50     IFEQ '1'                        ** IF  002     S01095
     C****                 MOVE RC,I      REGC                    S01095  S01194
     C                     MOVE RC,I      A4RGCD                          S01194
     C                     ELSE                            ** ELS 002     S01095
     C**  ELSE GET IT FROM TABLE AND ADD TO ARRAY                         S01095
     C***                  MOVE CCTZC     KEY50                   S01095  S01194
     C***                  MOVE '0'       *IN07                   S01095  S01194
     C***        KEY50     CHAINTABLE                51           S01095  S01194
     C*                                                                   S01194
     C                     CALL 'AOCTRYR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CCTZC     @AXCD   2                       S01194
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *INU7            ************   S01194
     C                     MOVE '05'      DBASE            * DBERR 05 *   S01194
     C                     MOVE @OPTN     DBOPTN           ************   S01194
     C                     MOVEL@AXCD     DBKEY                           S01194
     C                     MOVEL'SDCTRYPD'DBFILE                          S01194
     C                     GOTO END
     C                     ELSE
     C*                                                                   S01194
     C                     SUB  1         II                              S01095
     C                     MOVE CCTZC     CC,II                           S01095
     C****                 MOVE REGC      RC,II                   S01095  S01194
     C                     MOVE A4RGCD    RC,II                           S01194
     C                     END
     C*
     C****       *IN07     IFEQ '1'                        ** IF  003     S01095
     C****                 ELSE                            ** ELS 003     S01095
     C********ROR IF NOT FOUND                                            S01095
     C****                 MOVE '1'       *INU7                           S01095
     C***                  MOVEL'COUNTRY' ERROR                           S01095
     C***                  MOVE CCTZC     ERROR                           S01095
     C***                  GOTO END                                       S01095
     C***                  END                             ** END 003     S01095
     C                     END                             ** END 002     S01095
     C                     END                             ** END 001     S01095
0683 C*
0684 C*    SET UP COUNTERPARTY CUST NO, AND ZEROIZE FACILITY TYPE & NO
0685 C*
0686 C   02      DTYP      COMP 'CI'                     50
     C/COPY WNCPYSRC,DL0400C110
      *                                                                                       CDL033
      ** For CI and CF deals, no need to set up Counterparty                                  CDL033
      ** Customer Number, and Facility Type and Sequence Number.                              CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C                     MOVE *ON       *IN50                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0687 C   01
0688 C***OR*02N50             Z-ADDCUSTNO    CPCN                                             CSD027
0688 COR 02N50             MOVE CUSTNO    CPCN                                                CSD027
0689 C  N02N03             Z-ADD0         FACT
0690 C  N02N03             Z-ADD0         FCNO
     C/COPY WNCPYSRC,DL0400C083
     C**   RESET IND UPON WHICH CALCULATION OF PRINCIPAL DEPENDS.         E15988
     C                     SETOF                     65                   E15988
0691 C*
     C**  If this is a MM deal with Int to be Cap set to 'Y'              179203
     C**  or this is a Capitalise Interest deal amendment,                179203
     C**  set on the Interest to be Capitalised flag.                     179203
     C                     SETOF                         59               179203
     C           *IN02     IFEQ *ON                                       179203
     C           INTC      ANDEQ'Y'                                       179203
     C           *IN06     OREQ *ON                                       179203
     C           AMTP      ANDEQ'CI'                                      179203
     C                     SETON                         59               179203
     C                     END                                            179203
      *                                                                                       CLE025
      ** Initialise the associated credit agreement facility details                          CLE025
      *                                                                                       CLE025
     C**********           Z-ADD*ZERO     WMCAC                                        CLE025 CSD027
     C                     MOVE *BLANKS   WMCAC                                               CSD027
     C                     Z-ADD*ZERO     WMCAT                                               CLE025
     C                     Z-ADD*ZERO     WMCAS                                               CLE025
      *                                                                                       CLE025
      ** If CLE025 is on and deal is from DEALSDB or DEALSDC,                                 CLE025
      ** access FX/MM deals extension file                                                    CLE025
      *                                                                                       CLE025
     C           CLE025    IFEQ 'Y'                                                           CLE025
      *                                                                                       CLE025
     C           *IN01     IFEQ *ON                                                           CLE025
     C           *IN02     OREQ *ON                                                           CLE025
      *                                                                                       CLE025
     C                     OPEN DLDEALL5                                                      CLE025
     C                     MOVE DLNO      KDLNO   6                                           CLE025
     C           KDLNO     CHAINDLDEALL5             81                                       CLE025
      *                                                                                       CLE025
     C           *IN81     IFEQ *OFF                                                          CLE025
     C**********           Z-ADDF1FCCU    WMCAC   60                                   CLE025 CSD027
     C                     MOVE F1FCCU    WMCAC   6                                           CSD027
     C                     Z-ADDF1FACT    WMCAT   30                                          CLE025
     C                     Z-ADDF1FCNO    WMCAS   20                                          CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
     C                     CLOSEDLDEALL5                                                      CLE025
     C                     ENDIF                                                              CLE025
     C                     ENDIF                                                              CLE025
     C*
0692 C*    GO TO APPROPRIATE CALCS
0693 C*
0694 C   02      NOTD      COMP -999                     50
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     Z-ADD0         PSAIP  130                                          CGL187
     C                     Z-ADD*ZEROS    DAYS                                                CGL187
     C                     Z-ADD*ZEROS    PERIOD                                              CGL187
     C                     Z-ADD*ZEROS    PRODUC                                              CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
0695 C   02N50             GOTO CALNOT
0696 C   02
0697 COR 03                GOTO FIXNAP
0698 C   04                GOTO NASOLD
0699 C*
0700 C*
0701 C*    F O R E I G N   E X C H A N G E
0702 C*
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     Z-ADD0         AIPD   130                                          CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
0703 C*    FIND DEALT BASE RATE FOR PURCHASE AND SALE CCYS
     C/COPY WNCPYSRC,DL0400C084
0704 C*
0705 C*****NOT*USED*FOR*INTERNAL*CONTRACTS********************************
0706 C*
0707 C*    IF OPTION DEAL USE ORIGINAL AMOUNTS
0708 C           DTYP      COMP 'OP'                     51
0709 C****                 MOVE PUCY      DPCCY   3                       S01095
0710 C****                 EXSR CURDP                                     S01095
     C**  GET PURCH CCY DEC PLACES                                        S01095
     C                     Z-ADD1         I                               S01095
     C           PUCY      LOKUPCY,I                     50               S01095
     C           *IN50     IFEQ '1'                        ** IF  001     S01095
     C                     MOVE CYD,I     CYDDS                           S01095
     C                     ELSE                            ** ELS 001     S01095
     C**    ERROR IF NOT FOUND                                            S01095
     C                     MOVE '1'       *INU7                           S01095
     C                     MOVEL'NO CCY'  ERROR                           S01095
     C                     MOVE PUCY      ERROR                           S01095
     C                     GOTO END                                       S01095
     C                     END                             ** END 001     S01095
     C           CDP       SUB  BCD       N       10   35                 S01095
     C                     ADD  4         N                               S01095
0711 C**N35N51** PUAM      DIV  BCEQ      DBRATP 138                      121875
      *                                                                   121875
     C           *IN35     IFEQ *OFF                                      121875
     C           *IN51     ANDEQ*OFF                                      121875
     C           BCEQ      IFEQ *ZEROS                                    121875
     C                     Z-ADD*ZEROS    DBRATP 138                      121875
     C                     ELSE                                           121875
     C           PUAM      DIV  BCEQ      DBRATP                          121875
     C                     END                                            121875
     C                     END                                            121875
      *                                                                   121875
0712 C  N35 51   ORPA      DIV  OBCE      DBRATP
0713 C  N35      DBRATP    DIV  POWER,N   DBRATP
0714 C   35N51   PUAM      DIV  POWER,N   WK15   150
0715 C***35N51** WK15      DIV  BCEQ      DBRATP    H                     121875
      *                                                                   121875
     C           *IN35     IFEQ *ON                                       121875
     C           *IN51     ANDEQ*OFF                                      121875
     C           BCEQ      IFEQ *ZEROS                                    121875
     C                     Z-ADD*ZEROS    DBRATP                          121875
     C                     ELSE                                           121875
     C           WK15      DIV  BCEQ      DBRATP    H                     121875
     C                     END                                            121875
     C                     END                                            121875
      *                                                                   121875
0716 C   35 51   ORPA      DIV  POWER,N   WK15
0717 C   35 51   WK15      DIV  OBCE      DBRATP
0718 C**                   MOVE SLCY      DPCCY                           S01095
0719 C**                   EXSR CURDP                                     S01095
     C**  GET SALE  CCY DEC PLACES                                        S01095
     C                     Z-ADD1         I                               S01095
     C           SLCY      LOKUPCY,I                     50               S01095
     C           *IN50     IFEQ '1'                        ** IF  001     S01095
     C                     MOVE CYD,I     CYDDS                           S01095
     C                     ELSE                            ** ELS 001     S01095
     C**    ERROR IF NOT FOUND                                            S01095
     C                     MOVE '1'       *INU7                           S01095
     C                     MOVEL'NO CCY'  ERROR                           S01095
     C                     MOVE SLCY      ERROR                           S01095
     C                     GOTO END                                       S01095
     C                     END                             ** END 001     S01095
     C           CDP       SUB  BCD       N       10   35                 S01095
     C                     ADD  4         N                               S01095
0720 C**N35N51** SLAM      DIV  BCEQ      DBRATS 138                      121875
      *                                                                   121875
     C           *IN35     IFEQ *OFF                                      121875
     C           *IN51     ANDEQ*OFF                                      121875
     C           BCEQ      IFEQ *ZEROS                                    121875
     C                     Z-ADD*ZEROS    DBRATS 138                      121875
     C                     ELSE                                           121875
     C           SLAM      DIV  BCEQ      DBRATS                          121875
     C                     END                                            121875
     C                     END                                            121875
      *                                                                   121875
0721 C  N35 51   ORSA      DIV  OBCE      DBRATS
0722 C  N35      DBRATS    DIV  POWER,N   DBRATS
0723 C   35N51   SLAM      DIV  POWER,N   WK15
0724 C***35N51** WK15      DIV  BCEQ      DBRATS    H                     121875
      *                                                                   121875
     C           *IN35     IFEQ *ON                                       121875
     C           *IN51     ANDEQ*OFF                                      121875
     C           BCEQ      IFEQ *ZEROS                                    121875
     C                     Z-ADD*ZEROS    DBRATS    H                     121875
     C                     ELSE                                           121875
     C           WK15      DIV  BCEQ      DBRATS    H                     121875
     C                     END                                            121875
     C                     END                                            121875
      *                                                                   121875
0725 C   35 51   ORSA      DIV  POWER,N   WK15
0726 C   35 51   WK15      DIV  OBCE      DBRATS
0727 C*
0728 C*****      DATECH    TAG                             ** DATECH TAG *S01194
0729 C***09      VDAT      COMP RUND                   5050               S01194
0729 C   09      VDAT      COMP BJRDNB                 5050               S01194
0730 C   09 50             GOTO SWCHK
0731 C   09                GOTO END
0732 C*
0733 C*    WRITE EVENT RECORDS
0734 C                     MOVE 'V1'      KEY
     C   31      FSLI      COMP 1                        60
      *                                                                   S01220
      ** For 2nd Leg deal chain to associated deal for FX bookcode        S01220
      ** (only for 20V1 and 20V2 events) saving MM bookcode in TEMP       S01220
      *                                                                   S01220
     C   31N60             MOVE BOKC      TEMP    2                       S01220
     C   31N60   SODN      CHAINDEALS                71                   S01220
     C   31N60             MOVE BOOK      BOKC                            S01220
      *                                                                   S01220
     C   31N60             Z-ADDIDIR      ICIR   117
     C   31N60             Z-ADDIDAM      ICAM   130
     C   31 60             Z-ADD0         ICIR
     C   31 60             Z-ADD0         ICAM
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0400CCP1                                           S01408
     C*                                                                   S01408
0737 C                     EXSR EVENT
     C   U7                GOTO END                                       E11058
0738 C                     MOVE 'V2'      KEY
     C   31N60             Z-ADDILIR      ICIR
     C   31N60             Z-ADDILAM      ICAM
     C   31 60             Z-ADD0         ICIR
     C   31 60             Z-ADD0         ICAM
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0400CCP2                                           S01408
     C*                                                                   S01408
0741 C                     EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                   S01220
      ** For 2nd Leg deals Restore MM bookcode for 20V3, 20V4, 20V7       S01220
      ** and 20V8 events. For 1st Leg deals chain to DEALS file           S01220
      ** (using associated deal number as the Key) to get MM bookcode     S01220
      ** then output new events 20S1 and 20S2 (identical to the 20V1      S01220
      ** and 20V2 events except for bookcode (MM not FX).                 S01220
      *                                                                   S01220
     C   31N60             MOVE TEMP      BOKC                            S01220
      *                                                                   S01220
     C   31 60   SODN      CHAINDEALS                71                   S01220
     C   31 60             MOVE BOOK      BOKC                            S01220
     C   31 60             MOVE 'S1'      KEY                             S01220
     C   31 60             Z-ADD0         ICIR                            S01220
     C   31 60             Z-ADD0         ICAM                            S01220
     C   31 60             EXSR EVENT                                     S01220
     C   U7                GOTO END                                       S01220
     C   31 60             MOVE 'S2'      KEY                             S01220
     C   31 60             Z-ADD0         ICIR                            S01220
     C   31 60             Z-ADD0         ICAM                            S01220
     C   31 60             EXSR EVENT                                     S01220
     C   U7                GOTO END                                       S01220
      *                                                                   S01220
0742 C*
0743 C*    IF LEG 1 SWAP, CREATE EVENT RECORDS ACCORDING TO WHETHER
0744 C*    SWAP PROFIT OR SWAP LOSS OR NEITHER
0745 C*
0746 C           SWCHK     TAG                             ** SWCHK TAG **
0747 C           DTYP      COMP 'OP'                     50
0748 C**
0749 C**      ONLY TO BE DONE FOR DTYP = SW
0750 C**
0751 C           DTYP      COMP 'SW'                     55
0752 C   55      FSLI      COMP 1                    5050
0753 C   50                GOTO END
0754 C   31      FSLI      COMP 1                        50
0755 C   31 50             GOTO END
0756 C*
0757 C*    WRITE EVENTS RECORDS
0758 C      31             MOVE 'V4'      KEY
0759 C      31             Z-ADDVDAT      VDAT1   50
0759 C      31             Z-ADDVDAT1     DAT,3
0760 C      31             Z-ADDIDIA      AMT,6
0761 C      31             Z-ADDIDIR      ICIR
0762 C      31             EXSR EVENT
     C   U7                GOTO END                                       E11058
0763 C      31             MOVE 'V3'      KEY
0759 C      31             Z-ADDVDAT      VDAT1
0764 C      31             Z-ADDVDAT1     DAT,3
0765 C      31             Z-ADDILIA      AMT,6
0766 C      31             Z-ADDILIR      ICIR
0767 C      31             EXSR EVENT
     C   U7                GOTO END                                       E11058
0768 C   31                Z-ADDILAM      AMT,2
0769 C                     MOVE 'V7'      KEY
0770 C                     EXSR EVENT
     C   U7                GOTO END                                       E11058
0771 C   31                Z-ADDIDAM      AMT,3
0772 C                     MOVE 'V8'      KEY
0773 C                     EXSR EVENT
     C   31                                                               E11058
     COR U7                GOTO END                                       E11058
0774 C***31****************GOTO END                                       E11058
0775 C   20                MOVE 'V3'      KEY
0776 C   21                MOVE 'V4'      KEY
0777 C*  20
0778 C*R 21
0779 C   20
0780 COR 21                EXSR EVENT
     C   U7                GOTO END                                       E11058
0781 C   20                MOVE 'V5'      KEY
0782 C   21                MOVE 'V6'      KEY
0783 C* N53 20
0784 C   20
0785 COR 21                EXSR EVENT
0786 C*
0787 C                     GOTO END
0788 C*
0789 C*
0790 C*    F I X E D   L O A N S / D E P O S I T S
0791 C*      A N D
0792 C*    N E G O T I A B L E   A S S E T S   P U R C H A S E D
0793 C*
0794 C           FIXNAP    TAG                             ** FIXNAP TAG *
      *                                                                                       CAS005
      ***When*deal*is*of*type*fixed*or*call*deposit*save*IACD*to*a*****                247618 259640
      ***variable*for*use*on*maturity*interest*calculation.************                247618 259640
      *****************************************************************                247618 259640
     C********** *IN02     IFEQ '1'                                                    247618 259640
     C**********           Z-ADDIACD      DLIACD  50                                   247618 259640
     C**********           ENDIF                                                       247618 259640
     C**********           Z-ADDDLNO      DLNRF   60                                   247618 259640
      *****************************************************************                247618 259640
      *                                                                                       CGL187
      ** Save original interest date                                                          CGL187
      *                                                                                       CGL187
     C                     Z-ADDNIDT      WNIDT   50                                          CGL187
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           MDAT      ANDEQ0                                                             CAS005
     C                     MOVE CCY       ZCCY                                                228545
     C           NOTD      IFEQ 0                                                             CAS005
     C                     Z-ADDBNDCMT    MDAT                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDNOTD      MDAT                                                CAS005
     C                     ENDIF                                                              CAS005
     C**********           ADD  BJRDNB    MDAT                                         CAS005 228545
     C                     Z-ADDBJRDNB    ZDAYNO                                              228545
     C                     Z-ADDMDAT      ZNRDYS                                              228545
     C                     EXSR ZFWDT                                                         228545
     C                     Z-ADDZDYNBR    MDAT                                                228545
     C           NIDT      IFGT MDAT                                                          CAS005
     C                     Z-ADDMDAT      NIDT                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0795 C   02                TESTB'1'       DSTI           41NEG. INT. IND.
     C***
     C***  CHECK IF A CD, CL OR DL DEAL WITH A MATURITY DATE
     C***
     C           DTYP      COMP 'CD'                     66
     C  N66      DTYP      COMP 'CL'                     66
     C  N66      DTYP      COMP 'DL'                     66
     C  N66      DTYP      COMP 'IL'                     66               S01354
     C  N66      DTYP      COMP 'ID'                     66               S01354
      *                                                                   CDL006
     C           *IN66     IFEQ '0'                                       CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      ANDEQ'DT'                                      CDL006
     C                     MOVE '1'       *IN66                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           *IN66     IFEQ '0'                                       CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      ANDEQ'LT'                                      CDL006
     C                     MOVE '1'       *IN66                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           *IN66     IFEQ '0'                                       CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      ANDEQ'DP'                                      CDL006
     C                     MOVE '1'       *IN66                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           *IN66     IFEQ '0'                                       CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      ANDEQ'LP'                                      CDL006
     C                     MOVE '1'       *IN66                           CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,DL0400C123
      *                                                                   CDL019
      **  Calculate interest to maturity for fixed deposits/loans         CDL019
     C           DTYP      IFEQ 'TD'                                      CDL019
     C           DTYP      OREQ 'IT'                                      CDL019
     C           DTYP      OREQ 'TI'                                      CDL019
     C           DTYP      OREQ 'IP'                                      CDL019
     C                     MOVE *ON       *IN66                           CDL019
     C                     ENDIF                                          CDL019
      *                                                                   CDL006
     C/COPY WNCPYSRC,DLH00322
     C  N66                GOTO BYPASS
     C*                                                                   AUS003
     C*    DEAL HAS MATURED, SO BYPASS PROCESSING                         AUS003
     C*                                                                   AUS003
     C           *IN02     IFEQ '1'                                       AUS003
     C           RECISV    IFEQ 'M'                                       AUS003
     C/COPY WNCPYSRC,DL0400C047
     C                     GOTO END                                       AUS003
     C                     END                                            AUS003
     C                     END                                            AUS003
     C*                                                                   AUS003
     C*    CHECK FOR INTEREST FREQUENCY 'N'                               AUS003
     C*                                                                   AUS003
     C                     MOVE '0'       *IN88                           AUS003
     C           IPFR      IFEQ 'N'                                       AUS003
     C                     MOVE '1'       *IN88                           AUS003
     C                     MOVE 'L'       IPFR                            AUS003
     C                     END                                            AUS003
     C*
     C           VDAT      COMP ECD                  50
     C   50                MOVE 'V1'      KEY
     C   50                EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN50     ANDEQ'1'                                                           CAS005
     C                     MOVE 'V6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C**
     C**   SET INDICATORS AND FIELDS FOR CALL DEALS
     C**
     C***********INTC      COMP 'Y'                      59               101985
     C***********INTC      IFEQ 'Y'                                 101985179203
     C************IN06     OREQ *ON                                 101985179203
     C***********AMTP      ANDEQ'CI'                                101985179203
     C***********          SETON                         59         101985179203
     C***********          END                                      101985179203
     C**
     C           AITC      ADD  AIAN      INTDUE 130
     C           INTDUE    ADD  AIAP      INTDUE
     C           INTDUE    SUB  IPRD      INTDUE
     C           INTDUE    SUB  ICTD      INTDUE
     C/COPY WNCPYSRC,DL0400C090
     C**
     C                     Z-ADDPCPL      PRINAM 130
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPAMT    WPRNAM 130                                          CAS005
     C           FSAITN    ADD  FSAINN    INTDUN                                              CAS005
     C                     ADD  FSAIAN    INTDUN                                              CAS005
     C                     SUB  FSIPRN    INTDUN                                              CAS005
     C                     SUB  FSICTN    INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
     C**
     C           LOOP1     TAG                             ** LOOP1 TAG **
     C   27 28             GOTO ENDCNX
     C*
     C                     Z-ADDDAVD      DATE
     C                     Z-ADDDASN      SEQNO
     C                     SETOF                     70
     C  N27N28   NIDT      COMP DAVD                 70
     C**
     C**   CALCULATE INTEREST FROM IACD TO NEXT ACTION DATE
     C**
     C                     Z-ADDIACD      ZIBEG
     C  N27N28 70
     COR 27                Z-ADDDAVD      ZIEND
     C  N27N28N70
     COR 28                Z-ADDNIDT      ZIEND
     C/COPY WNCPYSRC,DL0400CCP8                                           S01408
      * If CDL096 is On and Amount Convention is 'A', update Next Interest                    CDL096
      * Payment Date to be the Interest Base Date (which contains the                         CDL096
      * correct date that interest should be calculated up to)                                CDL096
     C           CDL096    IFEQ 'Y'                                                           CDL096
     C           *IN02     ANDEQ'1'                                                           CDL096
     C           IPFR      ANDNE' '                                                           CDL096
     C           AMTC      ANDEQ'A '                                                          CDL096
     C                     Z-ADDIBDT      ZIEND                                               CDL096
     C                     ENDIF                                                              CDL096
      *                                                                                       CDL096
     C                     Z-ADDPRINAM    ZIAMT
     C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0400C048
     C*                                                                   S01392
     C* IF LOAN/DEPOSIT OR NA PURCHASED WITH ROUND DOWN INTEREST = 'Y'    S01392
     C*                                                                   S01392
     C           *IN02     IFEQ '1'                                       S01392
     C           JRDFC     ANDEQ'Y'                                       S01392
     C           *IN03     OREQ '1'                                       S01392
     C           JRDFC     ANDEQ'Y'                                       S01392
     C           INTDUE    ADD  ZINTR     INTDUE                          S01392
     C                     ELSE                                           S01392
     C           INTDUE    ADD  ZINTR     INTDUE    H
     C                     END                                            S01392
     C**********           Z-ADDZIEND     IACD                                                228544
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
      *                                                                                       CAS005
      ** Calculate interest from IACD to Next Action Date                                     CAS005
      *                                                                                       CAS005
     C                     Z-ADDZIRATE    WZRATE                                              CAS005
     C           FSLQPS    IFEQ '+'                                                           CAS005
     C                     ADD  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSLQPS    IFEQ '-'                                                           CAS005
     C                     SUB  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDIACD      ZIBEG                                               CAS005
     C           *IN27     IFEQ *OFF                                                          CAS005
     C           *IN28     ANDEQ*OFF                                                          CAS005
     C           *IN70     ANDEQ*ON                                                           CAS005
     C           *IN27     OREQ *ON                                                           CAS005
     C                     Z-ADDDAVD      ZIEND                                               CAS005
     C                     ENDIF                                                              CAS005
     C           *IN27     IFEQ *OFF                                                          CAS005
     C           *IN28     ANDEQ*OFF                                                          CAS005
     C           *IN70     ANDEQ*OFF                                                          CAS005
     C           *IN28     OREQ *ON                                                           CAS005
     C                     Z-ADDNIDT      ZIEND                                               CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDWPRNAM    ZIAMT                                               CAS005
     C                     EXSR GLINTC                                                        CAS005
     C                     Z-ADDWZRATE    ZIRATE                                              CAS005
      *                                                                                       CAS005
      ** If Loan/Deposit or NA Purchased with Round Down Interest = 'Y'                       CAS005
      *                                                                                       CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C           JRDFC     ANDEQ'Y'                                                           CAS005
     C           *IN03     OREQ *ON                                                           CAS005
     C           JRDFC     ANDEQ'Y'                                                           CAS005
     C                     ADD  ZINTR     INTDUN                                              CAS005
     C                     ELSE                                                               CAS005
     C                     ADD  ZINTR     INTDUN    H                                         CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDZIEND     IACD                                                228544
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** If commission due on Fiduciary deposits.                         CDL006
      *                                                                   CDL006
     C           EVFIDE    IFEQ 'D'                                       CDL006
     C           BNCOTK    ANDEQ'Y'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
     C           EVFIDE    OREQ 'L'                                       CDL006
     C           BNCOTK    ANDEQ'Y'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
     C           EVFIDE    OREQ 'D'                                       CDL006
     C           BNACCO    ANDEQ'Y'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
     C           EVFIDE    OREQ 'L'                                       CDL006
     C           BNACCO    ANDEQ'Y'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
      *                                                                   CDL006
      ** As the commission calculation is based on the Interest           CDL006
      ** accrual control date (IACD), the Commission amount must          CDL006
      ** be calculated each time the Interest Accrual Control date is     CDL006
      ** updated; the result must be added to the field Accrued           CDL006
      ** commission to control date FACTC.                                CDL006
      *                                                                   CDL006
      ** If Interest Accrual Control date has been changed.               CDL006
     C           IACD      IFNE WUIACD                                    CDL006
     C                     Z-ADDWUIACD    WUDBEG                          CDL006
     C                     Z-ADDIACD      WUDEND                          CDL006
     C                     EXSR COMCAL                                    CDL006
     C                     ADD  WUACSC    FACTC                           CDL006
     C                     Z-ADDIACD      WUIACD                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,DL0400C010
      *                                                                                       CGL015
      ** If CGL015 is ON, calculate non-resident tax processing                               CGL015
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
     C**
     C**   GENERATE EVENT FOR INTEREST PAYMENT
     C**
     C  N27N28 70
     COR 27                GOTO AMDEVX
     C**
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           *IN59     ANDEQ'1'                                                           CGL015
     C           INTDUE    SUB  W0TAX     INTDUE                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C**   IF INTEREST IS CAPITALISED ADD TO PRINCIPAL
     C**
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN59     ANDEQ*ON                                                           CAS005
     C                     ADD  INTDUN    WPRNAM                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0400C011
     C   59      PRINAM    ADD  INTDUE    PRINAM
     C   59                GOTO CLCID
     C/COPY WNCPYSRC,DL0400C012
      *                                                                                       CGL015
      ** If CGL015 is ON, calculate non-resident tax processing                               CGL015
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
     C**
     C**   INTEREST NOT CAP'D - GENERATE EVENT
     C**
     C                     SETOF                     06                   102129
     C                     Z-ADDNIDT      TODATE
     C/COPY WNCPYSRC,DL0400C049
     C                     MOVE 'I2'      KEY
     C                     EXSR EVENT
      *****************************************************************                247618 259640
      ***On*change*of*deal*reset*work*variable*WKINT3******************                247618 259640
      *****************************************************************                247618 259640
     C********** DLNO      IFNE DLNRF                                                  247618 259640
     C**********           Z-ADD0         WKINT3                                       247618 259640
     C**********           ENDIF                                                       247618 259640
      *****************************************************************                247618 259640
      ***If*the*interest*payment*date*is*yet*to*value,*accumulate******                247618 259640
      ***computed*interest*in*interest*work*variable*which*will********                247618 259640
      ***be*used*later*on*for*maturity*interest.***********************                247618 259640
      *****************************************************************                247618 259640
     C********** EVCODE    IFEQ '15I2'                                                 247618 259640
     C********** EVCODE    OREQ '16I2'                                                 247618 259640
      *****************************************************************                247618 259640
     C********** *IN02     IFEQ '1'                                                    247618 259640
     C********** NIDT      ANDGEBJRDNB                                                 247618 259640
     C********** WKINT3    ADD  INTDUE    WKINT3 130                                   247618 259640
     C**********           ENDIF                                                       247618 259640
      *****************************************************************                247618 259640
     C**********           ENDIF                                                       247618 259640
      *****************************************************************                247618 259640
     C   U7                GOTO END                                       E11058
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'I6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C**                                                                  AUS003
     C           *IN88     IFEQ '1'                                       AUS003
     C           NIDT      ANDGTMDAT                                      AUS003
     C                     Z-ADD0         INTDUE                          AUS003
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD0         INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     GOTO ENDN                                      AUS003
     C                     END                                            AUS003
     C**
     C**   CALCULATE NEXT INTEREST DATE
     C**
     C           CLCID     TAG                             ** CLCID TAG **
     C                     Z-ADD0         INTDUE
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD0         INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
     C   26                Z-ADD0         NIDT
     C   26                SETON                     27
     C   26                GOTO LOOP1
     C* Ensure settlement currency is used where appropriate for calls    CEU003
     C*  to AONOSTRO, sr/ZFREQB, sr/ZFWDT.                                CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      ZCCY                            CEU003
     C                     ELSE                                           CEU003
     C**
     C                     MOVE CCY       ZCCY
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C****                 MOVE 'Y'       ZOPT                            S01194
     C                     Z-ADDIBDT      ZDAYNO
     C**  Check whether loan or deposit in order to set up location       S01195
     C           PCPL      IFGT 0                                         E325
     C*                                                                   E325
     C*  Set up location - if Our PAY Settlement                          E325
     C*  Method is a nostro then use nostro code and currency to find     E325
     C*  Nostro Location                                                  E325
     C           PSTM      IFEQ 01                                        E325
     C           PSTM      OREQ 02                                        E325
     C           PSTM      OREQ 07                                        E325
     C           PSTM      OREQ 08                                        E325
     C           PSTM      OREQ 12                                        E325
     C*                                                                   E325
     C                     CALL 'AONOSTR0'                                E325
     C                     PARM '*MSG   ' @RTCD   7                       E325
     C                     PARM '*KEY   ' @OPTN   7                       E325
     C                     PARM *BLANKS   @KEYA   6                       E325
     C***********          PARM CCY       @KEYB   3                  E325 CEU003
     C                     PARM ZCCY      @KEYB   3                       CEU003
     C**********           PARM *BLANKS   @KEYC   4                                      E325 CGL029
     C                     PARM *BLANKS   @KEYC  10                                           CGL029
     C                     PARM *BLANKS   @KEYD   2                       E325
     C                     PARM PONS      @KEYE   2                       E325
     C                     PARM *BLANKS   @KEYF   3                       E325
     C                     PARM *BLANKS   @KEYG  10                       E325
     C                     PARM *BLANKS   @KEYH   1                       E325
     C           SDNOST    PARM SDNOST    DSFDY                           E325
     C*                                                                   E325
     C           @RTCD     IFNE *BLANK                                    E325
     C                     SETON                     U7U8LR               E325
     C                     MOVEL'SDNOSTPD'DBFILE 10        ************   E325
     C                     MOVE '08'      DBASE   3        * DBERR 08 *   E325
     C                     MOVE @OPTN     DBOPTN  7        ************   E325
     C                     MOVEL@OPTN     DBKEY  29                       E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C                     MOVE A7NOSN    ZLOC                            E325
     C                     END                                            E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C                     MOVE BJSLCD    ZLOC                            E325
     C                     END                                            E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C*                                                                   E325
     C**  PCPL is less than zero so deal is a loan                        E325
     C*  Set up location - if Our receive Settlement                      E325
     C*  Method is a nostro then use nostro code and currency to find     E325
     C*  Nostro Location                                                  E325
     C*                                                                   E325
     C           RSTM      IFEQ 01                                        E325
     C           RSTM      OREQ 02                                        E325
     C           RSTM      OREQ 07                                        E325
     C           RSTM      OREQ 08                                        E325
     C           RSTM      OREQ 12                                        E325
     C*                                                                   E325
     C                     CALL 'AONOSTR0'                                E325
     C                     PARM '*MSG   ' @RTCD   7                       E325
     C                     PARM '*KEY   ' @OPTN   7                       E325
     C                     PARM *BLANKS   @KEYA   6                       E325
     C***********          PARM CCY       @KEYB   3                  E325 CEU003
     C                     PARM ZCCY      @KEYB                           CEU003
     C**********           PARM *BLANKS   @KEYC   4                                      E325 CGL029
     C                     PARM *BLANKS   @KEYC                                               CGL029
     C                     PARM *BLANKS   @KEYD   2                       E325
     C                     PARM RONS      @KEYE   2                       E325
     C                     PARM *BLANKS   @KEYF                           E325
     C                     PARM *BLANKS   @KEYG                           E325
     C                     PARM *BLANKS   @KEYH                           E325
     C           SDNOST    PARM SDNOST    DSFDY                           E325
     C*                                                                   E325
     C*                                                                   E325
     C           @RTCD     IFNE *BLANK                                    E325
     C                     SETON                     U7U8LR               E325
     C                     MOVEL'SDNOSTPD'DBFILE 10        ************   E325
     C                     MOVE '09'      DBASE   3        * DBERR 09 *   E325
     C                     MOVE @OPTN     DBOPTN  7        ************   E325
     C                     MOVEL@OPTN     DBKEY  29                       E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C                     MOVE A7NOSN    ZLOC                            E325
     C                     END                                            E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C                     MOVE BJSLCD    ZLOC                            E325
     C                     END                                            E325
     C*                                                                   E325
     C                     END                                            E325
      *                                                                                       CDL033
      ** For CDL033 deals, calculate Next Interest Payment                                    CDL033
      ** Date.                                                                                CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           XKRCDT    IFNE 0                                                           BUG13030
      *                                                                                       243447
     C           XKRCDT    IFNE 0                                                             243447
     C           XKRCFR    ANDNE' '                                                           243447
     C                     EXSR SRFRC4                                                        CDL033
     C                     Z-ADDXKRCDT    NIDT                                                CDL033
     C           NIDT      IFGE MDAT                                                          CDL033
     C                     Z-ADD0         NIDT                                                CDL033
     C                     MOVE '1'       *IN27                                               CDL033
     C                     GOTO LOOP1                                                       BUG13030
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              243447
      *                                                                                       243447
     C**********           GOTO LOOP1                                                CDL033 BUG13030
     C                     ENDIF                                                            BUG13030
     C                     ENDIF                                                              CDL033
     C*                                                                   E325
     C*****                EXSR ZFREQB                                    S01194
     C*********************EXSR FREQB                               S01194DT0206
     C/COPY WNCPYSRC,DL0400C074
      * If CDL096 is On, determine next interest payment date considering Business            CDL096
      * Day convention details defined for the deal                                           CDL096
     C           CDL096    IFEQ 'Y'                                                           CDL096
     C           *IN02     ANDEQ*ON                                                           CDL096
     C           CCYPC     ANDNE*BLANKS                                                       CDL096
      *                                                                                       CDL096
     C                     EXSR ZFRQB3                                                        CDL096
      *                                                                                       CDL096
     C                     CALL 'DLZIRP'                                                      CDL096
     C                     PARM           ZDAYNO                                              CDL096
     C                     PARM CCYPC     PCURR   3                                           CDL096
     C                     PARM PYDC      PPDCN   2                                           CDL096
     C                     PARM           ZLOC                                                CDL096
     C                     PARM           BJDFIN                                              CDL096
     C                     PARM *ZEROS    PAJDT   50                                          CDL096
     C                     PARM *ZEROS    PBSDT   50                                          CDL096
     C                     Z-ADDPAJDT     ZDYNBR                                              CDL096
      *                                                                                       CDL096
      ** Do not return adjusted date if it is equal to or earlier than                        CDL096
      ** previous date (only happens for 'previous' date calculations);                       CDL096
      ** instead use the base date                                                            CDL096
      *                                                                                       CDL096
     C           IBDT      IFGE ZDYNBR                                                        CDL096
     C                     Z-ADDPBSDT     ZDYNBR                                              CDL096
     C                     ENDIF                                                              CDL096
     C                     Z-ADDNIDT      ONIDT                                               CDL096
     C                     Z-ADDZDYNBR    NIDT                                                CDL096
     C                     Z-ADDZDAYNO    IBDT                                                CDL096
      *                                                                                       CDL096
     C                     ELSE                                                               CDL096
     C                     EXSR ZFREQB                                    DT0206
     C/COPY WNCPYSRC,DL0400C075
     C                     Z-ADDZDAYNO    IBDT
     C                     Z-ADDNIDT      ONIDT   50                                          255705
     C**  ZFREQ MAY RETURN A NON-WORKING DAY FOR FREQ W,F,S,R AND L       S01095
     C**  CHECK WITH ZDATE5 AND GET NEXT WORKING DAY                      S01095
     C           ZFREQ     LOKUPFRQ                      50               S01095
     C/COPY WNCPYSRC,DL0400C076
     C           *IN50     IFEQ '1'                        ** IF  001     S01095
     C***                  EXSR ZDATE5                                    S01195
     C                     EXSR ZFWDT                                     S01195
     C                     Z-ADDZDYNBR    NIDT
     C                     ELSE                            ** ELS 001     S01095
     C                     Z-ADDZDAYNO    NIDT                            S01095
     C                     END                             ** END 001     S01095
      *                                                                                       CDL096
     C                     ENDIF                                                              CDL096
     C**
     C           NIDT      COMP MDAT                 27
      **                                                                                   CDL096I01
      ** If business day conventions are being used and preceding or                       CDL096I01
      ** modified preceding is the payment convention, if maturity date                    CDL096I01
      ** falls on a holiday the next interest payment date will be the                     CDL096I01
      ** working day before the maturity date so should use interest                       CDL096I01
      ** base date calculated based on the interest payment day in month                   CDL096I01
      ** as comparison                                                                     CDL096I01
     C           CDL096    IFEQ 'Y'                                                        CDL096I01
     C           *IN02     ANDEQ'1'                                                        CDL096I01
     C           IPFR      ANDNE' '                                                        CDL096I01
     C           PYDC      IFEQ 'P '                                                       CDL096I01
     C           PYDC      OREQ 'MP'                                                       CDL096I01
     C           PYDC      OREQ 'MF'                                                       CDL096I01
     C           IBDT      COMP MDAT                 27                                    CDL096I01
     C  N27      IBDT      COMP MDAT                     27                                CDL096I01
     C                     ENDIF                                                           CDL096I01
     C                     ENDIF                                                           CDL096I01
     C   27                Z-ADD0         NIDT
     C*                                                                                       255705
     C** If, because of holidays, the calculated NIDT is less than or                         255705
     C** equal to the previous NIDT, proceed to maturity event.                               255705
     C           NIDT      IFNE *ZERO                                                         255705
     C           NIDT      ANDLEONIDT                                                         255705
     C                     Z-ADD*ZERO     NIDT                                                255705
     C                     MOVE '1'       *IN27                                               255705
     C                     ENDIF                                                              255705
     C**
     C                     GOTO LOOP1
     C*
     C*     CHAIN TO DEALS AMENDMENT FILE AND WRITE EVENT RECORDS
     C*
     C           AMDEVX    TAG                             ** AMDEVX TA
     C                     EXSR DAMCHN
     C/COPY WNCPYSRC,DL0400C044
     C***U7******          MOVEL'DEAMS'   ERROR                           CDL006
     C***U7******          MOVE DAMKEY    ERROR                           CDL006
     C/COPY WNCPYSRC,DL0400C045
     C   U7                GOTO END
     C*     IF DEAL AMENDMENT REVERSED, GET NEXT DEAL AMENDMENT REC.
     C   11                GOTO NXTAMX
     C**  IF VALUE DATE > NEXT WORKING DATE DO NOT INCLUDE THIS           E15988
     C**  AMENDMENT IN THE PRINCIPAL CALCULATION.                         E15988
S13  C***        VDATM     CABGTDNWD      NXTAMX                  E10847  S01194
S13  C***********VDATM     CABGTBJDNWD    NXTAMX                    S01194E15988
S13  C           VDATM     COMP BJDNWD               65                   E15988
     C***  IF VALUE DATE > NEXT WORKING DATE, SKIP THIS AMENDMENT REC.    101985
      ** Skip only 'CI' amendment type.                                   132172
     C           AMTP      IFEQ 'CI'                                      132172
     C   65                GOTO NXTAMX                                    101985
     C                     END                                            132172
     C           AMTP      COMP 'PD'                     50
     C           AMTP      COMP 'PI'                     51
      *                                                                   CDL022
      **  Allow principal increase or principal decrease to be            CDL022
      **  processed for fixed deposit/loan                                CDL022
     C           DTYP      IFEQ 'TD'                                      CDL022
     C           DTYP      OREQ 'IT'                                      CDL022
     C           DTYP      OREQ 'TI'                                      CDL022
     C           DTYP      OREQ 'IP'                                      CDL022
     C           AMTP      IFEQ 'PD'                                      CDL022
     C           AMTP      OREQ 'PI'                                      CDL022
     C                     MOVE *OFF      *IN65                           CDL022
     C                     ENDIF                                          CDL022
     C                     ENDIF                                          CDL022
      *                                                                   CDL022
     C/COPY WNCPYSRC,DL0400C013
     C   50                MOVE 'M4'      KEY
     C   51                MOVE 'V3'      KEY
     C   50
     COR 51                EXSR EVENT
     C   U7                GOTO END                                       E11058
     C           AMTP      COMP 'PD'                     50
     C           AMTP      COMP 'PI'                     51
     C***50******PRINAM    SUB  DAAM      PRINAM                          E15988
     C***51******PRINAM    ADD  DAAM      PRINAM                          E15988
     C   50N65   PRINAM    SUB  DAAM      PRINAM                          E15988
     C   51N65   PRINAM    ADD  DAAM      PRINAM                          E15988
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN50     IFEQ *ON                                                           CAS005
     C           *IN65     ANDEQ*OFF                                                          CAS005
     C                     SUB  DAAM      WPRNAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN51     IFEQ *ON                                                           CAS005
     C           *IN65     ANDEQ*OFF                                                          CAS005
     C                     ADD  DAAM      WPRNAM                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C   50
     COR 51                GOTO NXTAMX
     C**
     C**   PROCESS OTHER DEAL AMENDMENT TYPES
     C**
     C           AMTP      COMP 'SC'                     49SPREAD CHANGE
     C   49      RTSP      ADD  BRTE      INTR
      *                                                                                      BUG3620
     C           CDL020    IFEQ 'Y'                                                          BUG3620
     C   49      RTSP      ADD  BRTEM     INTR                                               BUG3620
     C                     ENDIF                                                             BUG3620
      *                                                                                      BUG3620
     C   49                GOTO NXTAMX
     C**
      *                                                                   CDL022
      ** Base Rate code change deal amendment type 'BC'                   CDL022
     C           AMTP      IFEQ 'BC'                                      CDL022
      *                                                                                       CRE073
     C           CRE073    IFEQ 'Y'                                                           CRE073
      *                                                                                       CRE073
      ** Get base rate details from SDBSRTPD via access program                               CRE073
      *                                                                                       CRE073
     C                     MOVELBRTT      @DWNB                                               CRE073
     C                     CALL 'AOBSRTR0'                                                    CRE073
     C                     PARM '*MSG   ' @RTCD   7                                           CRE073
     C                     PARM '*KEY   ' @OPTN   7                                           CRE073
     C                     PARM CCY       @AJCD   3                                           CRE073
     C                     PARM           @DWNB   2                                           CRE073
     C           SDBSRT    PARM SDBSRT    DSSDY                                               CRE073
      *                                                                                       CRE073
     C           @RTCD     IFNE *BLANKS                                                       CRE073
     C                     MOVEL'SDBSRTPD'DBFILE                                              CRE073
     C                     MOVEL'026'     DBASE                                               CRE073
     C                     MOVEL@DWNB     DBKEY                                               CRE073
     C                     SETON                     U7U8LR                                   CRE073
     C                     GOTO END                                                           CRE073
     C                     END                                                                CRE073
     C                     Z-ADDBANBRT    BRTE                                                CRE073
      *                                                                                       CRE073
      ** Calculate new spread rate                                                            CRE073
      *                                                                                       CRE073
     C                     CALL CALCSR                                                        CRE073
     C                     PARM *BLANK    @RTCD   7                                           CRE073
     C                     PARM BRTE      @NBRT  117                                          CRE073
     C                     PARM CNSP      @CNSP  117                                          CRE073
     C                     PARM '+'       @CNSG   1                                           CRE073
     C                     PARM RDMT      @RDMT   7                                           CRE073
     C                     PARM RDFD      @RDFD   4                                           CRE073
     C                     PARM *ZERO     @RTSP  117                                          CRE073
     C                     PARM *ZERO     @FRAT  117                                        AR847249
      *                                                                                       CRE073
     C           @RTCD     IFNE *BLANK                                                        CRE073
     C********** @FRAT     ORLE 0                                                  AR847249 AR947093
     C********** RDMT      ANDNE*BLANKS                                            AR847249 AR947093
     C                     SETON                     U7U8LR                                   CRE073
     C                     GOTO END                                                           CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
     C                     Z-ADD@RTSP     RTSP                                                CRE073
     C           BRTE      ADD  RTSP      INTR                                                CRE073
     C                     GOTO NXTAMX                                                        CRE073
      *                                                                                       CRE073
     C                     ENDIF                                                              CRE073
      *                                                                   CDL020
      **  Get base rate for base rate code                                CDL020
     C           CDL020    IFNE 'Y'                                       CDL020
     C                     MOVE BRTT      @@BSRC  20                      CDL020
     C                     CALL 'AOBSHSR0'                                CDL020
     C                     PARM *BLANKS   @RTCD                           CDL020
     C                     PARM '*KEY   ' @OPTN                           CDL020
     C                     PARM CCY       @@CYCD  3                       CDL020
     C                     PARM           @@BSRC                          CDL020
     C                     PARM VDATM     @HSTDT  50                      CDL020
     C           SDBSHS    PARM SDBSHS    DSFDY                           CDL020
     C           @RTCD     IFNE *BLANK                                    CDL020
     C                     MOVEL'SDBSHSPD'DBFILE 10         ************* CDL020
     C                     MOVEL'20'      DBASE   3         *DBERROR 20 * CDL020
     C                     MOVEL@@BSRC    DBKEY             ************* CDL020
     C                     SETON                     U7U8LR               CDL020
     C                     GOTO END                                       CDL020
     C                     ENDIF                                          CDL020
     C                     Z-ADDG0CBSR    BRTEM                           CDL020
     C                     ENDIF                                          CDL020
      *                                                                   CDL020
     C           BRTEM     ADD  RTSP      INTR                            CDL022
     C                     GOTO NXTAMX                                    CDL022
     C                     ENDIF                                          CDL022
      *                                                                   CDL017
      ** Early Maturity deal amendment type 'EM'                          CDL017
     C           AMTP      IFEQ 'EM'                                      CDL017
      *                                                                   CDL017
      **  Update maturity date                                            CDL017
     C                     Z-ADDEMDAT     MDAT                            CDL017
      *                                                                   CDL017
      **  New base rate code has been entered                             CDL017
     C           BRTT      IFNE 0                                         CDL017
     C           RTSP      ORNE 0                                         CDL017
      *                                                                   CDL017
      **  Get base rate for base rate code                                CDL020
     C           CDL020    IFNE 'Y'                                       CDL020
     C                     MOVE BRTT      @@BSRC  20                      CDL020
     C                     CALL 'AOBSHSR0'                                CDL020
     C                     PARM *BLANKS   @RTCD                           CDL020
     C                     PARM '*KEY   ' @OPTN                           CDL020
     C                     PARM CCY       @@CYCD  3                       CDL020
     C                     PARM           @@BSRC                          CDL020
     C                     PARM VDATM     @HSTDT  50                      CDL020
     C           SDBSHS    PARM SDBSHS    DSFDY                           CDL020
     C           @RTCD     IFNE *BLANK                                    CDL020
     C                     MOVEL'SDBSHSPD'DBFILE 10         ************* CDL020
     C                     MOVEL'21'      DBASE   3         *DBERROR 21 * CDL020
     C                     MOVEL@@BSRC    DBKEY             ************* CDL020
     C                     SETON                     U7U8LR               CDL020
     C                     GOTO END                                       CDL020
     C                     ENDIF                                          CDL020
     C                     Z-ADDG0CBSR    BRTEM                           CDL020
     C                     ENDIF                                          CDL020
      *                                                                   CDL017
      **  Update interest rate for deal                                   CDL017
     C           BRTEM     ADD  RTSP      INTR                            CDL017
     C                     ENDIF                                          CDL017
      *                                                                   CDL017
     C                     GOTO NXTAMX                                    CDL017
     C                     ENDIF                                          CDL017
     C           AMTP      COMP 'SI'                     49SETTLE INTEREST
     C/COPY WNCPYSRC,DL0400C014
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           *IN49     ANDEQ'1'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     Z-ADDDAAM      INTDUE                                              CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     Z-ADD*ZERO     INTDUE                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C   49                MOVE 'I2'      KEY
     C   49                Z-ADDVDATM     TODATE
     C   49                EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN49     ANDEQ*ON                                                           CAS005
     C                     MOVE 'I6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADD0         INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C   49                Z-ADD0         INTDUE
     C   49                GOTO NXTAMX
     C**
     C**
     C           AMTP      COMP 'CI'                     49CAPIT. INTEREST
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN49     ANDEQ*ON                                                           CAS005
     C                     ADD  INTDUN    WPRNAM                                              CAS005
     C                     Z-ADD0         INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0400C091
     C   49      PRINAM    ADD  INTDUE    PRINAM
     C   49                Z-ADD0         INTDUE
     C*
     C           NXTAMX    TAG                             ** NXTAMX **
     C**                   Z-ADDNAAD      DATE       50    20DEC82SAR02625
     C                     Z-ADDNAAD      DAVD           28
     C***********          Z-ADDNASN      SEQNO                      E2625E43430
     C                     Z-ADDNASN      DASN                            E43430
     C** 50                GOTO AMDEVX                     20DEC82SAR02625
     C                     GOTO LOOP1
     C*
     C*    WRITE 'M1' EVENT RECORD
     C*
     C**         PCPL      SUB  PDTOT     PCPL             20DEC82SAR02625
     C           ENDCNX    TAG
     C                     SETOF                     06                   S01095
     C**
     C                     Z-ADDPRINAM    PCPL
     C**
     C**   CALCULATE INTEREST AT MATURITY
     C**
     C/COPY WNCPYSRC,DL0400C050
     C                     Z-ADDIACD      ZIBEG
      *****************************************************************                247618 259640
      ***For*fixed/call*deposits,*used*DLIACD*which*is*the*original****                247618 259640
      ***IACD*on*file.*************************************************                247618 259640
      *****************************************************************                247618 259640
     C********** *IN02     IFEQ '1'                                                    247618 259640
     C**********           Z-ADDDLIACD    ZIBEG                                        247618 259640
     C**********           ENDIF                                                       247618 259640
      *****************************************************************                247618 259640
     C                     Z-ADDMDAT      ZIEND
     C                     Z-ADDPCPL      ZIAMT
     C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0400C051
     C*                                                                   S01392
     C* IF LOAN/DEPOSIT OR NA PURCHASED WITH ROUND DOWN INTEREST = 'Y'    S01392
     C*                                                                   S01392
     C           *IN02     IFEQ '1'                                       S01392
     C           JRDFC     ANDEQ'Y'                                       S01392
     C           *IN03     OREQ '1'                                       S01392
     C           JRDFC     ANDEQ'Y'                                       S01392
     C           INTDUE    ADD  ZINTR     INTDUE                          S01392
     C                     ELSE                                           S01392
     C           INTDUE    ADD  ZINTR     INTDUE    H
     C                     END                                            S01392
      *****************************************************************                247618 259640
      ***for*fixed/call*deposit*transactions,*determine*interest*******                247618 259640
      ***due*by*considering*AITC*and*IPRD.*****************************                247618 259640
      *****************************************************************                247618 259640
     C********** *IN02     IFEQ '1'                                                    247618 259640
     C********** INTDUE    ADD  AITC      INTDUE                                       247618 259640
     C********** INTDUE    SUB  WKINT3    INTDUE                                       247618 259640
     C********** INTDUE    SUB  IPRD      INTDUE                                       247618 259640
     C**********           ENDIF                                                       247618 259640
     C**********           Z-ADD0         WKINT3                                       247618 259640
      *****************************************************************                247618 259640
     C/COPY WNCPYSRC,DL0400C015
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
     C**
     C**   IF INTEREST IS CAPITALISED ADD TO PRINCIPAL
     C**
     C   59      PCPL      ADD  INTDUE    PCPL
     C   59                Z-ADD0         INTDUE
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDWPRNAM    FSPAMT                                              CAS005
      *                                                                                       CAS005
      ** Calculate interest at maturity                                                       CAS005
      *                                                                                       CAS005
     C                     Z-ADDZIRATE    WZRATE                                              CAS005
     C           FSLQPS    IFEQ '+'                                                           CAS005
     C                     ADD  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSLQPS    IFEQ '-'                                                           CAS005
     C                     SUB  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDIACD      ZIBEG                                               CAS005
     C                     Z-ADDMDAT      ZIEND                                               CAS005
     C                     Z-ADDFSPAMT    ZIAMT                                               CAS005
     C                     EXSR GLINTC                                                        CAS005
     C                     Z-ADDWZRATE    ZIRATE                                              CAS005
      *                                                                                       CAS005
      ** If Loan/Deposit or NA Purchased with Round Down Interest = 'Y'                       CAS005
      *                                                                                       CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C           JRDFC     ANDEQ'Y'                                                           CAS005
     C           *IN03     OREQ *ON                                                           CAS005
     C           JRDFC     ANDEQ'Y'                                                           CAS005
     C                     ADD  ZINTR     INTDUN                                              CAS005
     C                     ELSE                                                               CAS005
     C                     ADD  ZINTR     INTDUN    H                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** If interest is capitalised add to principal                                          CAS005
      *                                                                                       CAS005
     C           *IN59     IFEQ *ON                                                           CAS005
     C                     ADD  INTDUN    FSPAMT                                              CAS005
     C                     Z-ADD0         INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C***                                                                 AUS003
     C           ENDN      TAG                             ** ENDN  TAG** AUS003
     C***                                                                 AUS003
     C           MDAT      COMP ECD                    6464
     C   64                GOTO END
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C/COPY WNCPYSRC,DL0400C016
     C                     Z-ADDEVETAX    TAXSV  150                                          CGL015
     C                     ENDIF                                                              CGL015
     C*
     C                     MOVE 'M1'      KEY
     C                     EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'M6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN88     IFEQ '0'                                       AUS003
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C/COPY WNCPYSRC,DL0400C017
     C                     Z-ADDTAXSV     EVETAX                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C  N59                MOVE 'M2'      KEY
     C  N59                EXSR EVENT
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'M8'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     END                                            AUS003
     C*
     C                     GOTO END
     C***
     C           BYPASS    TAG                             **BYPASS TAG**
     C***
      *                                                                                       CGL015
      ** Save the interest frequency for later use                                            CGL015
      *                                                                                       CGL015
     C           *LIKE     DEFN IPFR      SVIPFR                                              CGL015
     C                     MOVE IPFR      SVIPFR                                              CGL015
      *                                                                                       CGL015
     C/COPY WNCPYSRC,DL0400C018
     C*                                                                   AUS003
     C*    CHECK FOR INTEREST FREQUENCY 'N'                               AUS003
     C*                                                                   AUS003
     C                     MOVE '0'       *IN88                           AUS003
     C           IPFR      IFEQ 'N'                                       AUS003
     C                     MOVE '1'       *IN88                           AUS003
     C                     MOVE 'L'       IPFR                            AUS003
     C                     END                                            AUS003
     C/COPY WNCPYSRC,DL0400C111
      *                                                                                       CDL033
      ** Retrieve extension details of CF, CI, IP, IT, TI and TD deals.                       CDL033
      ** DB error if not found.                                                               CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
      *                                                                                       CDL033
      ** Reset flag for use of new rate.                                                      CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    WFLAG1  1                                           CDL033
      *                                                                                       CDL033
      ** Save original effective rate.                                                        CDL033
      *                                                                                       CDL033
     C                     Z-ADDINTR      WCFRAT 117                                          CDL033
      *                                                                                       CDL033
      ** Initialise some fields.                                                              CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFEQ *ZEROS                                                        CDL033
     C                     Z-ADD99999     XKRCDT                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANKS   WNOADD  1                                           CDL033
     C                     Z-ADD*ZEROS    WTODAT  50                                          CDL033
     C                     ENDIF                                                              CDL033
0796 C*
0797 C           VDAT      COMP ECD                  53
     C/COPY WNCPYSRC,DL0400C112
      *                                                                                       CDL033
      ** For CF deals, if value date is in the future, if                                     CDL033
      ** short term rate and fixed base rate not yet applied                                  CDL033
      ** for value date but current rate fix date has been                                    CDL033
      ** processed already, interest rate starting on this                                    CDL033
      ** event will be the fixed base rate plus signed                                        CDL033
      ** spread rate (new rate).                                                              CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           *IN53     IFEQ *ON                                                           CDL033
     C           XKSTVF    ANDEQ*BLANK                                                        CDL033
     C           XKBSVF    ANDEQ*BLANK                                                        CDL033
     C           XKINFF    ANDEQ'Y'                                                           CDL033
      *                                                                                       CDL033
     C           XKBSRF    ADD  RTSP      INTR                                                CDL033
     C           INTR      IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     INTR                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WFLAG1                                              CDL033
      *                                                                                       CDL033
      ** Set on interest override indicator.                                                  CDL033
      *                                                                                       CDL033
     C                     BITON'2'       DNSI                                                CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** CDL033 is switched on:                                                               CDL033
      ** For CF deals, if value date is in the future, if                                     CDL033
      ** short term rate and fixed base rate not yet applied                                  CDL033
      ** for value date and Current Rate Fix Date has not been                                CDL033
      ** processed yet, interest rate as of value date will be                                CDL033
      ** the base rate, determined from the yield curve, plus                                 CDL033
      ** signed spread rate.                                                                  CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           *IN53     IFEQ *ON                                                           CDL033
     C           XKSTVF    ANDEQ*BLANK                                                        CDL033
     C           XKBSVF    ANDEQ*BLANK                                                        CDL033
     C           XKINFF    ANDNE'Y'                                                           CDL033
      *                                                                                       CDL033
      ** Determine base rate from yield curve.                                                CDL033
      *                                                                                       CDL033
     C                     Z-ADDVDAT      WLICD                                               CDL033
     C                     EXSR SRFRC3                                                        CDL033
      *                                                                                       CDL033
     C           WKBSRF    ADD  RTSP      INTR                                                CDL033
     C           INTR      IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     INTR                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Set on interest override indicator.                                                  CDL033
      *                                                                                       CDL033
     C                     BITON'2'       DNSI                                                CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0798 C   53                MOVE 'V1'      KEY
0799 C   53                EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN53     ANDEQ'1'                                                           CAS005
     C                     MOVE 'V6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0800 C   53 03             MOVE 'V3'      KEY
0801 C   53 03             EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                   S01378
      ** If parcelled NA purchased has forward valued sales must          S01378
      ** adjust face value and purchase price to reflect this for         S01378
      ** maturity and other events. (Note that as sales reach their       S01378
      ** value date DL0280 reduces PSZE, NSLD, FVAL, PUPR to reflect      S01378
      ** the sale). *IN03 indicates an NA purchased.                      S01378
      ** Do this by calculating the face value/purchase price per parcel  S01378
      ** and multiplying this by no. of forward sales. Then subtract the  S01378
      ** face value/purchase price of the forward sales from the current  S01378
      ** amounts.                                                         S01378
     C           *IN03     IFEQ '1'                        B1             S01378
     C           PCLI      ANDEQ'P'                        B1             S01378
     C           NSLD      ANDNE*ZERO                      B1             S01378
      *                                                                   S01378
     C           *LIKE     DEFN FVAL      @WRK             *1             S01378
     C           FVAL      DIV  PSZE      @WRK      H      *1             S01378
     C           @WRK      MULT NSLD      @WRK             *1             S01378
     C           FVAL      SUB  @WRK      FVAL             *1             S01378
      *                                                                   S01378
     C           PUPR      DIV  PSZE      @WRK      H      *1             S01378
     C           @WRK      MULT NSLD      @WRK             *1             S01378
     C           PUPR      SUB  @WRK      PUPR             *1             S01378
     C                     END                             E1             S01378
0802 C*
0803 C*    NEG. ASSETS PURCH. - WRITE 'S1' EVENT RECORD AND FINISH
0804 C*    IF NEXT INTEREST DATE GREATER THAN SALE DATE
0805 C*
0806 C   03      NIDT      COMP SADT                 50
0807 C   03 50   SADT      COMP 0                    5050
0808 C   03 50             GOTO S1REC
0809 C*
0810 C*    IF NEXT INTEREST DATE GREATER THAN E.C.D., WRITE 'I2' RECORD
0811 C*
     C/COPY WNCPYSRC,DL0400C101
0812 C   03
0813 COR 02                Z-ADD0         TOTINT 130
0814 C*
0815 C           NIDT      COMP ECD                  53
     C/COPY WNCPYSRC,DL0400C052
      *                                                                                       CDL033
      ** For CF deals, if next interest date is in the future,                                CDL033
      ** current rate fix date has been processed already,                                    CDL033
      ** next interest date falls on or after rate change date,                               CDL033
      ** and new rate has not been applied before in previous                                 CDL033
      ** events, apply new rate starting on this event.                                       CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           *IN53     IFEQ *ON                                                           CDL033
     C           XKINFF    ANDEQ'Y'                                                           CDL033
     C           NIDT      ANDGEXKRCDT                                                        CDL033
     C           WFLAG1    ANDEQ*BLANK                                                        CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date.                                             CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC1                                                        CDL033
      *                                                                                       CDL033
     C           XKBSRF    ADD  RTSP      INTR                                                CDL033
     C           INTR      IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     INTR                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WFLAG1                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** CDL033 is switched on:                                                               CDL033
      ** For CF deals, if next interest date is in the future,                                CDL033
      ** process all rate changes up to this date.                                            CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           *IN53     IFEQ *ON                                                           CDL033
     C                     EXSR SRFRC5                                                        CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0816 C   53                SETON                     33
0817 C   53                EXSR INTDSR
     C/COPY WNCPYSRC,DL0400C019
0818 C   53                SETOF                     33
0819 C   53                Z-ADDNIDT      TODATE
     C/COPY WNCPYSRC,DL0400C053
0820 C   53                MOVE 'I2'      KEY
0821 C   53                EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
      *                                                                                       CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C           *IN03     OREQ *ON                                                           CAS005
     C                     Z-ADD0         WTOTIN 130                                          CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           NIDT      COMP ECD                  53                                       CAS005
      *                                                                                       CAS005
     C           *IN53     IFEQ *ON                                                           CAS005
     C                     MOVE *ON       *IN33                                               CAS005
     C                     EXSR SRINTD                                                        CAS005
     C                     MOVE *OFF      *IN33                                               CAS005
     C                     Z-ADDNIDT      TODATE                                              CAS005
      *                                                                                       CAS005
     C                     MOVE 'I6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
      *                                                                                       CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ADD  INTDUN    WTOTIN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0822 C   53      TOTINT    ADD  INTDUE    TOTINT
     C*                                                                   AUS003
     C*    BYPASS INTERIM INTEREST PROCESSING FOR FREQUENCY 'N'           AUS003
     C*    IF NEXT INTEREST DATE IS PAST MATURITY DATE                    AUS003
     C*                                                                   AUS003
     C           *IN88     IFEQ '1'                                       AUS003
     C           NIDT      IFGE MDAT                                      AUS003
     C                     GOTO NOINTR                                    AUS003
     C                     END                                            AUS003
     C                     END                                            AUS003
     C*                                                                   AUS003
     C*    BYPASS INTERIM INTEREST PROCESSING FOR FREQUENCY 'N'           AUS003
     C*    IF NEXT INTEREST DATE IS ZERO                                  AUS003
     C*                                                                   AUS003
     C           *IN88     IFEQ '1'                                       AUS003
     C           NIDT      IFEQ 0                                         AUS003
     C                     GOTO NOINTR                                    AUS003
     C                     END                                            AUS003
     C                     END                                            AUS003
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           NIDT      ANDEQ0                                                             CDL033
     C                     GOTO NOINTR                                                        CDL033
     C                     ENDIF                                                              CDL033
0823 C*
0824 C*    CALCULATE INTEREST DATE AND INTEREST DUE AT MATURITY
0825 C*
0826 C  N26
0827 CORN28                EXSR INTDAT
0828 C   U7                MOVEL'INTDAT'  ERROR
0829 C   U7                MOVE DAMKEY    ERROR
0830 C   U7                GOTO END
0831 C   03 29             GOTO S1REC
0832 C*
0833 C*  02 50
0834 C*
     C           NOINTR    TAG                             ** NOINTR **   AUS003
     C/COPY WNCPYSRC,DL0400C113
      *                                                                                       CDL033
      ** For CF deals, if current rate fix date has been                                      CDL033
      ** processed already and new rate has not been applied                                  CDL033
      ** before in previous events, apply new rate for                                        CDL033
      ** maturity event.  Also do this for                                                    CDL033
      ** CI, IP, IT, TI and TD deals.                                                         CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           XKINFF    IFEQ 'Y'                                                           CDL033
     C           WFLAG1    ANDEQ*BLANK                                                        CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date.                                             CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC1                                                        CDL033
      *                                                                                       CDL033
     C           XKBSRF    ADD  RTSP      INTR                                                CDL033
     C           INTR      IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     INTR                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WFLAG1                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** CDL033 is switched on:                                                               CDL033
      ** For CF deals, process all rate changes up to                                         CDL033
      ** maturity date and compute for interest up to                                         CDL033
      ** this event.  Also do this for                                                        CDL033
      ** CI, IP, IT, TI and TD deals.                                                         CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C                     EXSR SRFRC7                                                        CDL033
     C                     ENDIF                                                              CDL033
     C*                                                                   AUS003
     C*    SET INTEREST DUE TO ZERO FOR INTEREST FREQUENCY 'N'            AUS003
     C*                                                                   AUS003
     C           *IN88     IFEQ '1'                                       AUS003
     C                     MOVE *ZEROS    INTDUE                          AUS003
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD0         INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     GOTO NOINTD                                    AUS003
     C                     END                                            AUS003
     C*                                                                   AUS003
0835 C   02                TESTB'2'       DNSI           50
      **  Negate TOTI if negative interest indicator is ON                153330
     C                     TESTB'1'       DSTI           41               153330
     C           *IN41     IFEQ '1'                                       153330
     C                     Z-SUBTOTI      TOTI                            153330
     C                     ENDIF                                          153330
0836 C   02N50   TOTI      SUB  IPRD      INTDUE
     C/COPY WNCPYSRC,DL0400C020
0837 C   02N50   INTDUE    SUB  TOTINT    INTDUE
     C/COPY WNCPYSRC,DL0400C087
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           *IN02     IFEQ '1'                                                           CGL015
     C           *IN50     ANDEQ'0'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     Z-ADD*ZERO     EVETAX                                              CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
0838 C   02 50
0839 COR 03                EXSR INTDSR
0840 C   02 50
0841 COR 03      INTDUE    SUB  TOTINT    INTDUE
      **  Return the original value of TOTI                               153330
     C           *IN41     IFEQ '1'                                       153330
     C                     Z-SUBTOTI      TOTI                            153330
     C                     ENDIF                                          153330
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C                     TESTB'2'       DNSI           50                                   CAS005
     C                     ENDIF                                                              CAS005
     C                     TESTB'1'       DSTI           41                                   CAS005
     C           *IN41     IFEQ *ON                                                           CAS005
     C                     Z-SUBFSTOTN    FSTOTN                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C           *IN03     OREQ *ON                                                           CAS005
     C                     EXSR SRINTD                                                        CAS005
     C                     SUB  WTOTIN    INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
     C           *IN41     IFEQ *ON                                                           CAS005
     C                     Z-SUBFSTOTN    FSTOTN                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0400C088
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           *IN50     ANDEQ*ON                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           *IN50     ANDEQ*ON                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           *IN50     ANDEQ*ON                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           *IN50     ANDEQ*ON                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           *IN50     ANDEQ*ON                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN50     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
      *                                                                                       CDL033
     C           INTDUE    SUB  TOTINT    INTDUE                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** CDL033 is switched on:                                                               CDL033
      ** Override interest at maturity.                                                       CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C                     Z-ADDWKTOTI    INTDUE                                              CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
     C                     Z-ADDWKTOT2    INTDUN                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           *IN02     IFEQ '1'                                                           CGL015
     C           *IN50     ANDEQ'1'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     Z-ADD*ZERO     EVETAX                                              CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C*                                                                   AUS003
     C           NOINTD    TAG                             ** NOINTD **   AUS003
0842 C*
0843 C*    WRITE MATURITY EVENT RECORDS
     C           MDAT      COMP ECD                    6464
     C/COPY WNCPYSRC,DL0400C054
     C   64                GOTO END
     C*
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C/COPY WNCPYSRC,DL0400C021
     C                     Z-ADDEVETAX    TAXSV                                               CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
0844 C*
0845 C                     MOVE 'M1'      KEY
0846 C                     EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'M6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN88     IFEQ '0'                                       AUS003
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C/COPY WNCPYSRC,DL0400C022
     C                     Z-ADDTAXSV     EVETAX                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
0847 C                     MOVE 'M2'      KEY
0848 C                     EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'M8'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     END                                            AUS003
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C/COPY WNCPYSRC,DL0400C023
      *                                                                                       CGL015
     C           *IN03     IFEQ '1'                                                           CGL015
     C                     Z-ADDTAXSV     EVETAX                                              CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
0849 C   03                MOVE 'M3'      KEY
0850 C   03                EXSR EVENT
     C/COPY WNCPYSRC,DL0400C081
0851 C*
0852 C                     GOTO END
0853 C*
0854 C*    WRITE 'S1' EVENT RECORD FOR NEGOTIABLE ASSETS PURCHASED
0855 C*
0856 C           S1REC     TAG                             ** S1REC TAG **
0857 C                     MOVE 'S1'      KEY
0858 C                     EXSR EVENT
0859 C*
0860 C                     GOTO END
0861 C*
0862 C*
0863 C*    C A L L / N O T I C E
0864 C*
0865 C           CALNOT    TAG                             ** CALNOT TAG *
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           MDAT      ANDEQ0                                                             CAS005
     C                     MOVE CCY       ZCCY                                                228545
     C           NOTD      IFEQ 0                                                             CAS005
     C**********           Z-ADDBNDCMT    MDAT                                         CAS005 230229
     C                     Z-ADDBNDCMT    CLMDAT  50                                          230229
     C                     ELSE                                                               CAS005
     C**********           Z-ADDNOTD      MDAT                                         CAS005 230229
     C                     Z-ADDNOTD      CLMDAT                                              230229
     C                     ENDIF                                                              CAS005
     C**********           ADD  BJRDNB    MDAT                                         CAS005 228545
     C                     Z-ADDBJRDNB    ZDAYNO                                              228545
     C**********           Z-ADDMDAT      ZNRDYS                                       228545 230229
     C                     Z-ADDCLMDAT    ZNRDYS                                              230229
     C                     EXSR ZFWDT                                                         228545
     C*********            Z-ADDZDYNBR    MDAT                                         228545 230229
     C                     Z-ADDZDYNBR    CLMDAT                                              230229
     C           NIDT      IFGT MDAT                                                          CAS005
     C*********            Z-ADDMDAT      NIDT                                         CAS005 230229
     C                     Z-ADDMDAT      CLNIDT  50                                          230229
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   AUS003
     C*    DEAL HAS MATURED, SO BYPASS PROCESSING                         AUS003
     C*                                                                   AUS003
     C           RECISV    IFEQ 'M'                                       AUS003
     C/COPY WNCPYSRC,DL0400C055
     C                     GOTO END                                       AUS003
     C                     END                                            AUS003
     C*                                                                   AUS003
     C                     TESTB'1'       DSTI           41               S01095
0866 C*
0867 C           VDAT      COMP ECD                  50
0868 C   50                MOVE 'V1'      KEY
0869 C   50                EXSR EVENT
     C   U7                GOTO END                                       E11058
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN50     IFEQ '1'                                                           CAS005
     C                     MOVE 'V6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADD0         WTOTPN 130                                          CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0872 C*********************Z-ADD0         PDTOT  130                E25364082738
     C                     Z-ADD0         TOTPRN 130                      E25364
0870 C   28                GOTO ENDCN
0871 C*
0872 C*********************Z-ADD0         PDTOT  130                      E25364
0873 C                     Z-ADDDAVD      DATE
0874 C                     Z-ADDDASN      SEQNO
0875 C*
0876 C*    CHAIN TO DEALS AMENDMENT FILE AND WRITE EVENT RECORDS
0877 C*
0878 C           AMDEV     TAG                             ** AMDEV TAG **
0879 C                     EXSR DAMCHN
0880 C   U7                MOVEL'DEAMS'   ERROR
0881 C   U7                MOVE DAMKEY    ERROR
0882 C   U7                GOTO END
0883 C*    IF DEAL AMENDMENT REVERSED, GET NEXT DEAL AMENDMENT REC.
0884 C   11                GOTO NXTAMD
S13  C****       VDATM     CABGTDNWD      NXTAMD                  E10847  S01194
S13  C***********VDATM*****CABGTBJDNWD    NXTAMD                    S01194E15988
     C           VDATM     COMP BJDNWD               65                   E15988
     C***  IF VALUE DATE > NEXT WORKING DATE, SKIP THIS AMENDMENT REC.    101985
      ** Skip only 'CI' amendment type.                                   132172
     C           AMTP      IFEQ 'CI'                                      132172
     C   65                GOTO NXTAMD                                    101985
     C                     END                                            132172
0885 C           AMTP      COMP 'PD'                     50
0886 C           AMTP      COMP 'PI'                     51
     C/COPY WNCPYSRC,DL0400C024
0887 C   50                MOVE 'M4'      KEY
0888 C   51                MOVE 'V3'      KEY
0889 C   50
0890 COR 51                EXSR EVENT
     C   U7                GOTO END                                       E11058
0891 C           AMTP      COMP 'PD'                     50
0892 C           AMTP      COMP 'PI'                     51
0893 C***50******PDTOT     ADD  DAAM      PDTOT                           E15988
0894 C***51******PDTOT     SUB  DAAM      PDTOT                           E15988
0893 C***50N65***PDTOT     ADD  DAAM      PDTOT                    E15988 060306
0894 C***51N65***PDTOT     SUB  DAAM      PDTOT                    E15988 060306
     C*                                                                   060306
     C***Assign*'+'*or*'-'*sign*to**********************            060306082738
     C***Deal*Amendment*amt*and*store*in*PDTOT**********            060306082738
     C***If*deal*amendment*value*date*</=*next*working*day.         060306082738
     C**************************************************            060306082738
     C***********VDATM     IFLE BJDNWD                              060306082738
     C***********AMTP      IFEQ 'PI'                                060306082738
     C***********          ADD  DAAM      PDTOT                     060306082738
     C***********          END                                      060306082738
     C***********AMTP      IFEQ 'PD'                                060306082738
     C***********          SUB  DAAM      PDTOT                     060306082738
     C***********          END                                      060306082738
     C***********          END                                      060306082738
     C**                                                                  E25364
     C**   IF THE DEAL AMENDMENT VALUE DATE IS LESS THAN THE NEXT         E25364
     C**   INTEREST PAYMENT DATE ON THE DEAL (IF IT IS DEFINED)           E25364
     C**                                                                  E25364
     C           VDATM     IFLE NIDT                                      E25364
     C           NIDT      OREQ *ZERO                                     E25364
     C/COPY WNCPYSRC,DL0400C056
      *                                                                                       CAS005
      ** If this is just a one day interest calculation, update                               CAS005
      ** first the principal before doing the calculation                                     CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADD0         WNDAY   50                                          CAS005
     C           VDATM     SUB  IACD      WNDAY                                               CAS005
     C           WNDAY     IFEQ 1                                                             CAS005
     C           AMTP      IFEQ 'PI'                                                          CAS005
     C                     ADD  DAAM      TOTPRN                                              CAS005
     C                     ADD  DAAM      WTOTPN                                              CAS005
     C                     ENDIF                                                              CAS005
     C           AMTP      IFEQ 'PD'                                                          CAS005
     C                     SUB  DAAM      TOTPRN                                              CAS005
     C                     SUB  DAAM      WTOTPN                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C**                                                                  E25364
     C**   CALCULATE INTEREST DUE AS AT THIS DEAL AMENDMENT VALUE DATE    E25364
     C**                                                                  E25364
     C                     Z-ADDIACD      ZIBEG                           E25364
     C                     Z-ADDVDATM     ZIEND                           E25364
     C           PCPL      ADD  TOTPRN    ZIAMT                           E25364
     C/COPY WNCPYSRC,DL0400C100
     C                     EXSR GLINTC                                    E25364
     C/COPY WNCPYSRC,DL0400C057
     C           AITC      ADD  ZINTR     AITC      H                     E25364
     C                     Z-ADDZIEND     IACD                            E25364
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDZIRATE    WZRATE                                              CAS005
     C           FSLQPS    IFEQ '+'                                                           CAS005
     C                     ADD  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSLQPS    IFEQ '-'                                                           CAS005
     C                     SUB  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSPAMT    ADD  WTOTPN    ZIAMT                                               CAS005
     C                     EXSR GLINTC                                                        CAS005
     C                     Z-ADDWZRATE    ZIRATE                                              CAS005
     C           FSAITN    ADD  ZINTR     FSAITN    H                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** If commission due on Fiduciary deposits.                         CDL006
      *                                                                   CDL006
     C           EVFIDE    IFEQ 'D'                                       CDL006
     C           BNCOTK    ANDEQ'Y'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
     C           EVFIDE    OREQ 'L'                                       CDL006
     C           BNCOTK    ANDEQ'Y'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
     C           EVFIDE    OREQ 'D'                                       CDL006
     C           BNACCO    ANDEQ'Y'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
     C           EVFIDE    OREQ 'L'                                       CDL006
     C           BNACCO    ANDEQ'Y'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
      *                                                                   CDL006
      ** As the commission calculation is based on the Interest           CDL006
      ** accrual control date (IACD), the Commission amount must          CDL006
      ** be calculated each time the Interest Accrual Control date is     CDL006
      ** updated; the result must be added to the field Accrued           CDL006
      ** commission to control date FACTC.                                CDL006
      *                                                                   CDL006
      ** If Interest Accrual Control date has been changed.               CDL006
     C           IACD      IFNE WUIACD                                    CDL006
     C                     Z-ADDWUIACD    WUDBEG                          CDL006
     C                     Z-ADDIACD      WUDEND                          CDL006
     C                     EXSR COMCAL                                    CDL006
     C                     ADD  WUACSC    FACTC                           CDL006
     C                     Z-ADDIACD      WUIACD                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,DL0400C073
1246 C           AITC      ADD  AIAN      INTDUE                          E25364
1248 C                     ADD  AIAP      INTDUE                          E25364
1249 C                     SUB  IPRD      INTDUE                          E25364
1250 C                     SUB  ICTD      INTDUE                          E25364
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           FSAITN    ADD  FSAINN    INTDUN                                              CAS005
     C                     ADD  FSAIAN    INTDUN                                              CAS005
     C                     SUB  FSIPRN    INTDUN                                              CAS005
     C                     SUB  FSICTN    INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0400C092
     C*                                                                   E25364
     C** MAINTAIN TOTAL OF CHANGES TO PRINCIPAL (+ INTEREST CAPITALIZED)  E25364
     C*                                                                   E25364
     C           CAS005    IFNE 'Y'
     C           AMTP      IFEQ 'PI'                                      E25364
     C                     ADD  DAAM      TOTPRN                          E25364
     C                     END                                            E25364
     C           AMTP      IFEQ 'PD'                                      E25364
     C                     SUB  DAAM      TOTPRN                          E25364
     C                     END                                            E25364
     C           AMTP      IFEQ 'CI'                                      E25364
     C                     ADD  INTDUE    TOTPRN                          E25364
     C                     ADD  INTDUE    ICTD                            E25364
     C                     END                                            E25364
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           WNDAY     IFNE 1                                                             CAS005
     C           AMTP      IFEQ 'PI'                                                          CAS005
     C                     ADD  DAAM      TOTPRN                                              CAS005
     C                     ADD  DAAM      WTOTPN                                              CAS005
     C                     ENDIF                                                              CAS005
     C           AMTP      IFEQ 'PD'                                                          CAS005
     C                     SUB  DAAM      TOTPRN                                              CAS005
     C                     SUB  DAAM      WTOTPN                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C           AMTP      IFEQ 'CI'                                                          CAS005
     C                     ADD  INTDUE    TOTPRN                                              CAS005
     C                     ADD  INTDUE    ICTD                                                CAS005
     C                     ADD  INTDUN    WTOTPN                                              CAS005
     C                     ADD  INTDUN    FSICTN                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   E25364
     C** UPDATE EFFECTIVE INTEREST RATE IF AMENDMENT IS A RATE CHANGE     E25364
     C*                                                                   E25364
     C           AMTP      IFEQ 'SC'                                      E25364
     C           RTSP      ADD  BRTE      INTR                            E25364
      *                                                                                      BUG3620
     C           CDL020    IFEQ 'Y'                                                          BUG3620
     C           RTSP      ADD  BRTEM     INTR                                               BUG3620
     C                     ENDIF                                                             BUG3620
      *                                                                                      BUG3620
     C                     END                                            E25364
     C*                                                                   E25364
     C** IF AMENDMENT IS SETTLE INTEREST, GENERATE AN INTEREST DUE EVENT  E25364
     C** - AMENDMENT AMOUNT CARRIES THE INTEREST DUE                      E25364
     C**  AND MAINTAIN INTEREST PAID/RECEIVED                             E25364
     C*                                                                   E25364
     C           AMTP      IFEQ 'SI'                                      E25364
     C/COPY WNCPYSRC,DL0400C025
     C                     MOVE 'I2'      KEY                             E25364
     C           INTR      IFLT 0                                                           MD031115
     C                     Z-SUBDAAM      DAAM                                              MD031115
     C                     ENDIF                                                            MD031115
     C                     Z-ADDDAAM      INTDUE                          E25364
     C                     Z-ADDVDATM     TODATE                          E25364
     C/COPY WNCPYSRC,DL0400C058
     C                     EXSR EVENT                                     E25364
     C   U7                GOTO END                                       E25364
     C                     ADD  INTDUE    IPRD                            E25364
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'I6'      KEY                                                 CAS005
     C                     Z-ADDDAAM      INTDUN                                              CAS005
     C                     Z-ADDVDATM     TODATE                                              CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ADD  INTDUN    FSIPRN                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     END                                            E25364
     C                     END                                            E25364
0895 C*
0896 C           NXTAMD    TAG                             ** NXTAMD **
0897 C                     Z-ADDNAAD      DATE       50
0898 C                     Z-ADDNASN      SEQNO
0899 C   50                GOTO AMDEV
0900 C*
0901 C*    WRITE 'M1' EVENT RECORD
0902 C*
0903 C***********PCPL      SUB  PDTOT     PCPL                            060306
0903 C***********PCPL      ADD  PDTOT     PCPL                      060306082738
0904 C           ENDCN     TAG                             ** ENDCN TAG **
     C*                                                                   E25364
     C** IF THE NEXT INTEREST PAYMENT DATE ON THE DEAL IS DEFINED         E25364
     C** AND INTEREST CAPITALISATION IND IS NOT 'Y'                       179203
     C** GENERATE AN INTEREST DUE EVENT                                   E25364
     C*                                                                   E25364
     C           NIDT      IFNE *ZERO                                     E25364
     C********** CAS005    ANDNE'Y'                                                    CAS005 230229
     C********** NIDT      ORNE *ZERO                                                  CAS005 230229
     C********** NIDT      ANDLTMDAT                                                   CAS005 230229
     C********** CAS005    ANDEQ'Y'                                                    CAS005 230229
     C                     SETOF                     06                   102129
     C                     Z-ADDIACD      ZIBEG                           E25364
     C                     Z-ADDNIDT      ZIEND                           E25364
     C/COPY WNCPYSRC,DL0400CP11                                           S01408
     C           PCPL      ADD  TOTPRN    ZIAMT                           E25364
     C*********************ADD  PDTOT     ZIAMT                     E25364082738
     C/COPY WNCPYSRC,DL0400C059
     C                     EXSR GLINTC                                    E25364
     C/COPY WNCPYSRC,DL0400C060
     C           AITC      ADD  ZINTR     INTDUE    H                     E25364
1246 C                     ADD  AIAN      INTDUE                          E25364
1248 C                     ADD  AIAP      INTDUE                          E25364
1249 C                     SUB  IPRD      INTDUE                          E25364
1250 C                     SUB  ICTD      INTDUE                          E25364
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           AITC      ADD  ZINTR     AITC      H                                         CAS005
     C                     Z-ADDZIRATE    WZRATE                                              CAS005
     C           FSLQPS    IFEQ '+'                                                           CAS005
     C                     ADD  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSLQPS    IFEQ '-'                                                           CAS005
     C                     SUB  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     Z-ADDIACD      ZIBEG                                               CAS005
     C                     Z-ADDNIDT      ZIEND                                               CAS005
     C           FSPAMT    ADD  WTOTPN    ZIAMT                                               CAS005
     C                     EXSR GLINTC                                                        CAS005
     C                     Z-ADDWZRATE    ZIRATE                                              CAS005
     C           FSAITN    ADD  ZINTR     INTDUN    H                                         CAS005
     C                     ADD  FSAINN    INTDUN                                              CAS005
     C                     ADD  FSAIAN    INTDUN                                              CAS005
     C                     SUB  FSIPRN    INTDUN                                              CAS005
     C                     SUB  FSICTN    INTDUN                                              CAS005
     C           FSAITN    ADD  ZINTR     FSAITN    H                                         CAS005
     C                     Z-ADDZIEND     IACD                                                CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   179203
     C** Generate interest event if interest not to be capitalised.       179203
     C           *IN59     IFEQ *OFF                                      179203
     C                     MOVE 'I2'      KEY                             E25364
     C/COPY WNCPYSRC,DL0400C026
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C                     Z-ADDNIDT      TODATE                          E25364
     C/COPY WNCPYSRC,DL0400C061
     C                     EXSR EVENT                                     E25364
     C   U7                GOTO END                                       E25364
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'I6'      KEY                                                 CAS005
     C                     Z-ADDNIDT      TODATE                                              CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ADD  INTDUE    IPRD                                                CAS005
     C                     ADD  INTDUN    FSIPRN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ELSE                                           179203
     C*                                                                   179203
     C** If interest is capitalised, add interest to principal,           179203
     C** except where this is a call deal with no maturity date.          179203
     C           MDAT      IFNE *ZEROS                                    179203
     C           CAS005    ANDNE'Y'                                                           CAS005
     C           WMDAT     ORNE *ZEROS                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           PCPL      ADD  INTDUE    PCPL                            179203
     C                     END                                            179203
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           WMDAT     ANDNE*ZEROS                                                        CAS005
     C                     ADD  INTDUN    FSPAMT                                              CAS005
     C                     ADD  INTDUE    ICTD                                                CAS005
     C                     ADD  INTDUN    FSICTN                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   179203
     C                     END                                            179203
     C*                                                                   179203
     C                     END                                            E25364
      *                                                                                       CAS005
      ** Generate maturity interest                                                           CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDIACD      ZIBEG                                               CAS005
     C           MDAT      IFNE 0                                                             230229
     C                     Z-ADDMDAT      ZIEND                                               CAS005
     C                     ELSE                                                               230229
     C                     Z-ADDCLMDAT    ZIEND                                               230229
     C                     ENDIF                                                              230229
      *                                                                                       CAS005
     C           PCPL      ADD  TOTPRN    ZIAMT                                               CAS005
     C                     EXSR GLINTC                                                        CAS005
     C           AITC      ADD  ZINTR     INTDUE    H                                         CAS005
     C                     ADD  AIAN      INTDUE                                              CAS005
     C                     ADD  AIAP      INTDUE                                              CAS005
     C                     SUB  IPRD      INTDUE                                              CAS005
     C                     SUB  ICTD      INTDUE                                              CAS005
      *                                                                                       CAS005
     C                     Z-ADDZIRATE    WZRATE                                              CAS005
     C           FSLQPS    IFEQ '+'                                                           CAS005
     C                     ADD  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSLQPS    IFEQ '-'                                                           CAS005
     C                     SUB  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSPAMT    ADD  WTOTPN    ZIAMT                                               CAS005
     C                     EXSR GLINTC                                                        CAS005
     C           FSAITN    ADD  ZINTR     INTDUN    H                                         CAS005
     C                     ADD  FSAINN    INTDUN                                              CAS005
     C                     ADD  FSAIAN    INTDUN                                              CAS005
     C                     SUB  FSIPRN    INTDUN                                              CAS005
     C                     SUB  FSICTN    INTDUN                                              CAS005
      *                                                                                       CAS005
     C                     MOVE 'M2'      KEY                                                 CAS005
     C                     Z-ADDMDAT      TODATE                                              CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE 'M8'      KEY                                                 CAS005
     C                     Z-ADDMDAT      TODATE                                              CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *INU7     IFEQ *ON                                                           CAS005
     C                     GOTO END                                                           CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   179203
     C           PCPL      ADD  TOTPRN    PCPL                            082738
1249 C                     Z-ADD*ZERO     INTDUE                          E25364
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     ADD  WTOTPN    FSPAMT                                              CAS005
     C                     Z-ADD*ZERO     INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     SETOF                     06                   S01095
     C/COPY WNCPYSRC,DL0400C027
0905 C                     MOVE 'M1'      KEY
0906 C                     EXSR EVENT
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'M6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C                     ENDIF                                                              CAS005
0907 C*
0908 C                     GOTO END
0909 C*
0910 C*
0911 C*    N E G O T I A B L E   A S S E T S   S O L D
0912 C*
0913 C           NASOLD    TAG                             ** NASOLD TAG *
     C           VDAT      COMP ECD                    6464
     C   64                GOTO END
     C/COPY WNCPYSRC,DL0400C028
0914 C                     MOVE 'M1'      KEY
0915 C                     EXSR EVENT
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'M6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C                     ENDIF                                                              CAS005
0916 C*
0917 C                     GOTO END
0918 C*
0919 C*
0920 C**   F I L E   C O N T R O L   T O T A L S
0921 C**
0922 C           TRAIL     TAG                             ** TRAIL TAG **
0923 C**
     C*                                                                   S01119
     C** CALL PROGRAM DL0401 FOR FRA/IRS EVENTS CREATION IF PRESENT       S01119
     C*                                                                   S01119
     C***        IRFRA     IFEQ 'Y'                               S01119  S01194
     C           BGFIIN    IFEQ 'Y'                                       S01194
     C                     CALL 'DL0401'                                  S01119
     C***                  PARM           DATF             DATE FORS01119 S01194
     C                     PARM           BJDFIN           DATE FORMAT    S01194
     C*****                PARM           RUND             RUN DATES01119 S01194
     C                     PARM           BJRDNB           RUN DATE       S01194
     C****                 PARM           DNWD             DATE NEXS01119 S01194
     C                     PARM           BJDNWD           DATE NEXT W DAYS01194
     C                     PARM           ECD              EVNT CONTROL DTS01119
     C****                 PARM           BCCY             BASE CCYS01119 S01194
     C                     PARM           BJCYCD           BASE CCY       S01194
     C*****                PARM           BCYL             LIMIT CCS01119 S01194
     C                     PARM           BNCYCD           LIMIT CCY      S01194
     C                     PARM           BCD              BASE CCY D.P.  S01119
     C                     PARM           LMD              LIMIT CCY D.P. S01119
     C****                 PARM           TAXR             INT TAX S01119 S01194
     C                     PARM           BNHKTR           INT TAX RATE   S01194
     C                     PARM           HASHW            DEALS HASH     S01119
     C                     PARM           HASHD            DEALS HASH DEC S01119
     C                     PARM           COUNTD           DEALS LIVE REC S01119
     C                     PARM           HASHEW           EVNTXED HASH   S01119
     C                     PARM           HASHED           EVNTXED HASHDECS01119
     C                     PARM           COUNTE           EVNTXED COUNT  S01119
     C                     PARM           TNDLR            EMTE2E2 COUNT  S01119
     C                     PARM           XNDLR            EMXT2D2 COUNT  S01119
     C                     PARM           ERROR            D.B. ERROR FILES01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0400C082
0923 C*
0924 C           COUNTE    ADD  2         COUNTE
0925 C********** COUNT     COMP NORE                     50               S01095
0926 C           COUNTD    COMP NLRA                     51
0927 C           HASHW     COMP VLAF                     52
0928 C   52      HASHD     COMP VLAL                     52
0929 C**N50*****                                                          S01095
0930 C*RN51*****                                                          S01095
0930 C  N51                                                               S01095
0931 CORN52                SETON                     U8
0932 C*
0933 C*
0934 C           END       TAG                             ** END TAG **
     C***U7                SETON                     LR           E11058  S01194
     C*                                                                   S01194
     C           *INU7     IFEQ '1'                                       S01194
     C                     MOVE '1'       *INLR                           S01194
     C*********************DUMP                                     S01194138004
     C                     END                                            S01194
     C                     MOVE *BLANK    RECISV                          AUS003
     C/COPY WNCPYSRC,DL0400C029
     C*                                                                   S01117
0936 C********************************************************************
 937 C*    SUBROUTINE TO WRITE RECORDS TO EVNTX AND EMTE2 FILES
0938 C*    AND KEEP COUNT AND HASH TOTALS
0939 C*
0940 C           EVENT     BEGSR                           *** EVENT   ***
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     Z-ADD*ZEROS    PSAIP                                               CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
0941 C*
0942 C*    FIND FIELD VALUES FROM TABLES - SEE COMMENTS IN EXTENSION SPECS
0943 C*
     C                     MOVE ' '       EXEI                            S01117
0943 C*                                                                   S01117
     C/COPY WNCPYSRC,DL0400C102
0944 C           KEY       LOKUPTAB1      TAB2           50
0945 C  N50                GOTO ENDEV
0946 C                     MOVE TAB2      KEYDS            DATA STRUCTURE
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C   02                                                                                   CGL187
     COR 03      CODE2     IFEQ 'M2'                                                          CGL187
     C           CODE2     OREQ 'I2'                                                          CGL187
     C           EA        ANDEQ7                                                             CGL187
     C                     Z-ADDAIPD      PSAIP                                               CGL187
     C                     SUB  IPRD      PSAIP                                               CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,DL0400C103
0947 C*
0948 C*    EVENT TYPE
0949 C                     MOVE KEY       EVCODE  4
0950 C                     MOVELNN        EVCODE
      *                                                                                       234341
      ** Calculate EU tax.                                                                    234341
      *                                                                                       234341
     C                     Z-ADD0         WNTAMT                                              234341
     C                     Z-ADD0         INTBAK                                              234341
      *                                                                                       234341
      ** If CGL031 is installed, retrieve tax amount in original                              234341
      ** currency and accumulate.                                                             234341
      *                                                                                       234341
     C           CGL031    IFEQ 'Y'                                                           234341
     C           EVCODE    ANDEQ'16I2'                                                        234341
     C           CGL031    OREQ 'Y'                                                           234341
     C           EVCODE    ANDEQ'16M2'                                                        234341
     C           CGL031    OREQ 'Y'                                                           234341
     C           EVCODE    ANDEQ'16M1'                                                        234341
      *                                                                                       234341
     C           DTYP      IFEQ 'CD'                                                          234341
     C           DTYP      OREQ 'TD'                                                          234341
     C           DTYP      OREQ 'DT'                                                          234341
     C           CDL006    ANDEQ'Y'                                                           234341
     C           DTYP      OREQ 'DP'                                                          234341
     C           CDL006    ANDEQ'Y'                                                           234341
      *                                                                                       234341
     C                     MOVEL'D'       WKMODI  1                                           234341
      *                                                                                       234341
      ** Call Deposits                                                                        234341
      *                                                                                       234341
     C           DTYP      IFEQ 'CD'                                                          234341
     C           MDAT      ANDEQ0                                                             234341
     C           DTYP      OREQ 'DT'                                                          234341
     C           MDAT      ANDEQ0                                                             234341
      *                                                                                       234341
     C           VDAT      IFGE BJRDNB                                                        234341
     C           NOTD      IFEQ 0                                                             234341
     C           VDAT      ADD  1         WKMDAT  50                                          234341
     C                     ELSE                                                               234341
     C           NOTD      ADD  VDAT      WKMDAT                                              234341
     C                     ENDIF                                                              234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
     C           VDAT      IFLT BJRDNB                                                        234341
     C           NOTD      IFEQ 0                                                             234341
     C           BJRDNB    ADD  1         WKMDAT                                              234341
     C                     ELSE                                                               234341
     C           NOTD      ADD  BJRDNB    WKMDAT                                              234341
     C                     ENDIF                                                              234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
      ** Else, Fixed Term Deposits                                                            234341
      *                                                                                       234341
     C                     ELSE                                                               234341
     C                     Z-ADDMDAT      WKMDAT                                              234341
     C                     ENDIF                                                              234341
      *                                                                                     MD027820
      ** Use the interest due in calculating the interest tax                               MD027820
      ** if the interest payment date is not zero                                           MD027820
      *                                                                                     MD027820
     C           NIDT      IFNE *ZEROS                                                      MD027820
     C           DTYP      IFEQ 'TD'                                                        MD027820
     C           DTYP      OREQ 'TI'                                                        MD027820
     C           DTYP      OREQ 'IT'                                                        MD027820
     C           DTYP      OREQ 'IP'                                                        MD027820
     C           DTYP      OREQ 'CD'                                                        MD031098
     C                     Z-ADDNIDT      WKMDAT                                            MD027820
     C                     Z-ADDINTDUE    TOTI                                              MD027820
     C                     ENDIF                                                            MD027820
     C                     ENDIF                                                            MD027820
      *                                                                                       234341
     C                     MOVE DLNO      WDLNO   6                                           234341
     C                     MOVE CNUM      WCNUM   6                                           234341
     C                     EXSR SRCHKD                                                        234341
     C           WSKIP     IFEQ 'N'                                                           234341
     C                     EXSR SRCEUT                                                        234341
     C                     ELSE                                                               234341
     C                     Z-ADD*ZEROS    WNTAMT                                              234341
     C                     ENDIF                                                              234341
      *                                                                                     MD027339
      ** Apply the 2nd and 3rd tax to the tax amount                                        MD027339
      *                                                                                     MD027339
     C           CER048    IFEQ 'Y'                                                         MD027339
     C                     ADD  PSTXA     WNTAMT                                            MD027339
     C                     ENDIF                                                            MD027339
     C           CER054    IFEQ 'Y'                                                         MD027339
     C                     ADD  PTTXA     WNTAMT                                            MD027339
     C                     ENDIF                                                            MD027339
      *                                                                                       234341
     C                     Z-ADDINTDUE    INTBAK 130                                          234341
     C                     SUB  WNTAMT    INTDUE                                              234341
      *                                                                                       234341
     C                     ENDIF                                                              234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
0951 C*
     C           S01434    IFEQ 'Y'                                       S01434
     C*                                                                   S01434
     C           *IN02     IFEQ '1'                                       S01434
     C***********RBDN      ANDNE0                                  S01434 152893
     C*                                                                   S01434
     C/COPY WNCPYSRC,DL0400C079
     C           IPDS      IFEQ 'Y'                                       S01434
     C           EVCODE    IFEQ '15M2'                                    S01434
     C           EVCODE    OREQ '16M2'                                    S01434
     C           EVCODE    OREQ '15M8'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '16M8'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '15I6'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '16I6'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C                     MOVE '2'       SIIND                           S01434
     C           IMET      IFNE *BLANKS                                                       181604
     C                     SETON                     72                   138004
     C                     ENDIF                                                              181604
     C           IMET      IFEQ *BLANKS                                   138004
     C                     MOVEL'00'      IMET                            138004
     C                     END                                            138004
     C                     END                                            S01434
     C                     END                                            S01434
     C*                                                                   S01434
     C********             MOVE IPDS      IPSI    1                 S01434138004
     C/COPY WNCPYSRC,DL0400C080
     C********             ELSE                                     S01434138004
     C********             MOVE ' '       IPSI    1                 S01434138004
     C                     END                                            S01434
     C*                                                                   138004
     C                     MOVE IPDS      IPSI    1                       138004
     C*                                                                   138004
     C                     END                                            S01434
     C*                                                                   S01434
0952 C*    EVENT DATE
0953 C           ED        COMP 4                        50
0954 C   50 22             Z-ADD3         ED
0955 C*
0956 C*    EVENT AMOUNT
0957 C           EA        COMP 9                        50
0958 C   50      SPLC      COMP PUCY                     51
0959 C   50 51             Z-ADD2         EA
0960 C   50N51             Z-ADD3         EA
0961 C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0400CCP6                                           S01408
      *                                                                                       CDL099
      ** If CDL099 is enabled, do processing in Sr/#BSPVD                                     CDL099
      *                                                                                       CDL099
     C                     SETOF                     82                                       CDL099
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C           *IN01     ANDEQ'1'                                                           CDL099
     C           BSDT2     ANDNE0                                                             CDL099
     C           CDL099    OREQ 'Y'                                                           CDL099
     C           *IN09     ANDEQ'1'                                                           CDL099
     C           BSDT2     ANDNE0                                                             CDL099
      *                                                                                       CDL099
     C                     EXSR #BSPVD                                                        CDL099
     C   68      BBD,BE    CABLEECD       ENDEV                                               CDL099
     C   67      VDAT      CABLEECD       ENDEV                                               CDL099
     C                     SETON                     82                                       CDL099
      *                                                                                       CDL099
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
0962 C*    EVENT CCY
     C           *LIKE     DEFN CCY       SETCCY                          CEU003
     C           *LIKE     DEFN CCY       @SETCY                          CEU003
     C           *LIKE     DEFN CCY       WOTHCY                          CEU003
     C           *LIKE     DEFN IOIND     WKINOI                          CEU003
     C           *LIKE     DEFN PUAM      WSTAMT                          CEU003
     C           *LIKE     DEFN PUAM      WOTAMT                          CEU003
     C           *LIKE     DEFN SSNO      STSSNO                          CEU003
     C                     MOVEA'000'     *IN,46                          CEU003
     C                     MOVE *BLANK    WEVCD1  1                       CEU003
     C                     MOVE *BLANK    WEVCD4  1                       CEU003
     C                     MOVE *BLANKS   SETCCY                          CEU003
     C                     MOVE *BLANK    IFXS    1                       CEU003
     C                     MOVE *BLANK    SIAC    1                       CEU003
0963 C                     EXSR QCCY
0964 C                     MOVE OTHCCY    EVCCY   3
     C                     MOVE @SETCY    SETCCY                          CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           S01434    ANDEQ'Y'                                       CEU003
     C           *IN02     ANDEQ'1'                                       CEU003
     C           IPDS      ANDEQ'Y'                                       CEU003
     C           EVCODE    IFEQ '15I2'                                    CEU003
     C           EVCODE    OREQ '15M2'                                    CEU003
     C           EVCODE    OREQ '16I2'                                    CEU003
     C           EVCODE    OREQ '16M2'                                    CEU003
     C           EVCODE    OREQ '15M8'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '16M8'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '15I6'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '16I6'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C                     MOVE ISCY      SETCCY                          CEU003
     C                     ENDIF                                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   S01392
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
      ** FOR FX DEAL 'PI' AND 'SI' CALCULATE NEW AMOUNT                                       CGL187
      *                                                                                       CGL187
     C           DTYP      IFEQ 'PI'                                                          CGL187
     C           DTYP      OREQ 'SI'                                                          CGL187
     C           EVCCY     IFEQ PUCY                                                          CGL187
     C                     Z-ADDGCPCAP    PSAIP                                               CGL187
     C                     Z-ADDGCPCAP    AIPD                                                CGL187
     C                     ELSE                                                               CGL187
     C                     Z-ADDGCSCAP    PSAIP                                               CGL187
     C                     Z-ADDGCSCAP    AIPD                                                CGL187
     C                     END                                                                CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
      ** CALCULATE SWAP PROFIT/LOSS ACCRUED TO DATE                                           CGL187
      *                                                                                       CGL187
     C           DTYP      IFEQ 'SW'                                                          CGL187
      *                                                                                       CGL187
     C           CODE2     IFEQ 'V3'                                                          CGL187
     C           CODE2     OREQ 'V4'                                                          CGL187
     C           REPCD     SUB  VDAT      DAYS    50                                          CGL187
     C           OTDT      SUB  VDAT      PERIOD  50                                          CGL187
      *                                                                                       CGL187
     C           SPLA      MULT DAYS      PRODUC 150                                          CGL187
     C           PRODUC    DIV  PERIOD    PSAIP                                               CGL187
      *                                                                                       CGL187
      ** IF FIRST LEG HAS NOT REACHED VALUE DATE                                              CGL187
      *                                                                                       CGL187
     C           VDAT      IFGT REPCD                                                         CGL187
     C                     Z-ADD0         PSAIP                                               CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
     C                     END                                                                CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,DL0400C085
     C*  EVENT AMOUNT FOR LOANS/DEPOSITS                                  S01392
     C*  IF FRONT-UP INTEREST = Y AND M2 EVENT, SET EQUAL TO ZERO         S01392
     C*                                                                   S01392
     C           NN        IFEQ '15'                                      S01392
     C           NN        OREQ '16'                                      S01392
     C           FUID      IFEQ 'Y'                                       S01392
     C           CODE2     ANDEQ'M2'                                      S01392
     C           FUID      OREQ 'Y'                                                           CAS005
     C           CODE2     ANDEQ'M8'                                                          CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C                     Z-ADD1         EA                              S01392
     C                     END                                            S01392
     C                     END                                            S01392
0965 C*
0966 C*    INTEREST/EXCHANGE RATE
0967 C                     Z-ADD0         RATE   138
0968 C           RAT       COMP 'E'                      50
0969 C   50                Z-ADDEXRT      RATE             E - EXCHANGE
0970 C           RAT       COMP 'I'                  51  50
0971 C   50                Z-ADDINTR      RATE             I - INTEREST
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN50     IFEQ *ON                                                           CAS005
     C           CODE2     ANDEQ'V6'                                                          CAS005
     C           *IN50     OREQ *ON                                                           CAS005
     C           CODE2     ANDEQ'M6'                                                          CAS005
     C           *IN50     OREQ *ON                                                           CAS005
     C           CODE2     ANDEQ'I6'                                                          CAS005
     C           *IN50     OREQ *ON                                                           CAS005
     C           CODE2     ANDEQ'M8'                                                          CAS005
     C           FSLQPS    IFEQ '+'                                                           CAS005
     C           INTR      ADD  FSLQPR    RATE                                                CAS005
     C                     ENDIF                                                              CAS005
     C           FSLQPS    IFEQ '-'                                                           CAS005
     C           INTR      SUB  FSLQPR    RATE                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0972 C   51                Z-ADDYRAT      RATE             Y - YIELD
     C/COPY WNCPYSRC,DL0400C117
      *                                                                                       CDL033
      ** For CF deals, if rate change date falls on interest                                  CDL033
      ** payment date, new rate is effective only on the                                      CDL033
      ** next interest payment date.  Therefore, report                                       CDL033
      ** old rate as the exchange rate for the event.                                         CDL033
      ** Also do this for CI, IP, IT, TI and TD deals.                                        CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           TODATE    IFEQ XKRCDT                                                        CDL033
      *                                                                                       CDL033
     C           CODE2     IFEQ 'I2'                                                          CDL033
     C                     Z-ADDWCFRAT    RATE                                                CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
     C           CODE2     ANDEQ'I6'                                                          CDL033
      *                                                                                       CDL033
     C           FSLQPS    IFEQ '+'                                                           CDL033
     C           WCFRAT    ADD  FSLQPR    RATE                                                CDL033
     C                     ENDIF                                                              CDL033
     C           FSLQPS    IFEQ '-'                                                           CDL033
     C           WCFRAT    SUB  FSLQPR    RATE                                                CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Update flag to indicate that an interest event has                                   CDL033
      ** been processed for this deal and save event date.                                    CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           CODE2     IFEQ 'I2'                                                          CDL033
     C                     MOVE 'Y'       WNOADD                                              CDL033
     C                     Z-ADDTODATE    WTODAT                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
0973 C*
     C*                                                                   084826
     C           DTYP      IFEQ 'TA'                                      084826
     C           DTYP      OREQ 'TB'                                      084826
     C           DTYP      OREQ 'DA'                                      084826
     C***********DTYP      OREQ 'C2'                               084826 141731
     C                     Z-ADDYRAT      RATE                            084826
     C                     END                                            084826
0974 C*    OTHER CCY
0975 C                     MOVE OC        EC
0976 C                     EXSR QCCY
     C*                                                                   S01392
     C*  OTHER AMOUNT FOR LOANS/DEPOSITS                                  S01392
     C*                                                                   S01392
     C           NN        IFEQ '15'                                      S01392
     C           NN        OREQ '16'                                      S01392
     C*                                                                   S01392
     C*  IF FRONT-UP INTEREST = Y AND V1 EVENT, SET EQUAL TO INTEREST     S01392
     C*  IF FRONT-UP INTEREST = Y AND M1 EVENT, SET EQUAL TO ZERO         S01392
     C*                                                                   S01392
     C           FUID      IFEQ 'Y'                                       S01392
     C           CODE2     IFEQ 'V1'                                      S01392
     C                     Z-ADD7         OA                              S01392
     C                     Z-ADDTOTI      INTDUE                          S01392
     C                     END                                            S01392
      *                                                                                       CAS005
     C           CODE2     IFEQ 'V6'                                                          CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C                     Z-ADD8         OA                                                  CAS005
     C                     Z-ADDFSTOTN    INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           CODE2     IFEQ 'M1'                                      S01392
     C           CODE2     OREQ 'M6'                                                          CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C                     Z-ADD1         OA                              S01392
     C                     END                                            S01392
     C                     END                                            S01392
     C                     END                                            S01392
0977 C*
0978 C*    GET DETAILS FROM CURRENCY TABLE
0979 C***                  MOVEL'20'      TABKEY                          S01095
0980 C***                  MOVE EVCCY     CCYK                            S01095
0981 C***                  MOVE '1'       TABKEY                          S01095
0982 C***                  EXSR TABCHN                                    S01095
0983 C***U7                MOVEL'TABLECCY'ERROR                           S01095
0984 C***U7                MOVE TABKEY    ERROR                           S01095
0985 C***U7                GOTO ENDEV                                     S01095
     C                     Z-ADD1         I                               S01095
     C           EVCCY     LOKUPCY,I                     50               S01095
     C           *IN50     IFEQ '1'                        ** IF  001     S01095
     C                     MOVE CYD,I     CYDDS                           S01095
     C**    ERROR IF NOT FOUND                                            S01095
     C                     ELSE                            ** ELS 001     S01095
     C                     MOVE '1'       *INU7                           S01095
     C                     MOVEL'NO CCY'  ERROR                           S01095
     C                     MOVE EVCCY     ERROR                           S01095
     C****                 GOTO END                                 S01095E11058
     C                     GOTO ENDEV                                     E11058
     C                     END                             ** END 001     S01095
     C**  CHECK MULT/DIV IND                                              S01095
     C           MDIN      COMP 0                        87               S01095
0986 C*
0987 C*
0988 C*    DEALT BASE CCY RATE, & EQUIV OF EVENT AMOUNT
0989 C  N01N09             GOTO DEALT
0990 C           PUCY      COMP EVCCY                    50
0991 C   50                Z-ADDDBRATP    DBCR   138
0992 C  N50                Z-ADDDBRATS    DBCR
0993 C           CODE2     COMP 'V2'                 50
0994 C  N50                Z-ADDBCEQ      DBCE   130
0995 C*
0996 C           DEALT     TAG                             ** DEALT TAG **
     C**        BCXR IS FIXED ON DEAL INPUT
0998 C  N01N09             Z-ADDBCXR      DBCR
0999 C                     SETOF                     34
1000 C* N01N09
1001 C*R 09 50
1002 C  N01N09             SETON                     78
1003 C   09 50
1004 COR 01 50             SETON                     34
1005 C           CDP       SUB  BCD       N       10   35
1006 C           N         ADD  4         N
1007 C   34N35   AMT,EA    DIV  DBCR      DBCE      H
1008 C   34N35   DBCE      DIV  POWER,N   DBCE      H
1009 C   34 35   DBCR      MULT POWER,N   WK158  158
1010 C   34 35   AMT,EA    DIV  WK158     DBCE      H
     C*                                                                   E20644
     C*  *IN77 IS SET ON IF MDBCXR =0. THIS FIELD USED TO BE UPDATED IN   E20644
     C*  DL0400 BUT HAS BEEN OVERLOOKED IN THE NEW MM PROGRAMS.           E20644
     C*  THEREFORE USE *IN87 AS THIS HAS JUST BEEN CHECKED.               E20644
1011 C***78 77   DBCR      MULT POWER,N   WK159                           E20644
1012 C***78 77   AMT,EA    DIV  WK159     DBCE      H                     E20644
1013 C***78N77   DBCR      DIV  POWER,N   WK159                           E20644
1014 C***78N77   AMT,EA    MULT WK159     DBCE      H                     E20644
1011 C   78 87   DBCR      MULT POWER,N   WK159                           E20644
1012 C   78 87   AMT,EA    DIV  WK159     DBCE      H                     E20644
1013 C   78N87   DBCR      DIV  POWER,N   WK159                           E20644
1014 C   78N87   AMT,EA    MULT WK159     DBCE      H                     E20644
     C/COPY WNCPYSRC,DL0400C086
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
      ** INTEREST MUST BE CALCULATED FOR THE PERIOD IF NOT FIRST PERIOD                       CGL187
      *                                                                                       CGL187
     C           ZFREQ     IFNE *BLANK                                                        CGL187
     C           DAT,ED    ANDGTNIDT                                                          CGL187
     C           ZFREQ     ORNE *BLANK                                                        CGL187
     C           DAT,ED    ANDGTWNIDT                                                         CGL187
     C                     Z-ADD*ZEROS    PSAIP                                               CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
1015 C                     SETOF                     78
1016 C*
1017 C*    SPOT BASE CCY EQUIV OF EVENT AMOUNT
1018 C   87      SPOT      MULT POWER,N   WK159  159
1019 C   87      AMT,EA    DIV  WK159     SBCEQ  130H
1020 C  N87      SPOT      DIV  POWER,N   WK159
1021 C  N87      AMT,EA    MULT WK159     SBCEQ     H
1022 C*
1023 C*    SPOT LIMIT CCY EQUIV OF EVENT AMOUNT
1024 C****       EVCCY     COMP BCYL                     50               S01194
1024 C           EVCCY     COMP BNCYCD                   50               S01194
1025 C   50                Z-ADDAMT,EA    LCEQ
1026 C   50                GOTO SETDE
1027 C   01
1028 C***09      OTHCCY    COMP BCYL                     50               S01194
1028 COR 09      OTHCCY    COMP BNCYCD                   50               S01194
1029 C***01*50**                                                          136237
1030 C***OR*09*50          Z-ADDAMT,OA    LCEQ                            136237
      *                                                                   136237
      ** Exposure amount for ccy other than the base ccy should be        136237
      ** the equivalent of the purchase at the current spot rate          136237
      ** and not at the contract rate.                                    136237
      *                                                                   136237
     C           *IN01     IFEQ '1'                                       136237
     C           *IN50     ANDEQ'1'                                       136237
     C           *IN09     OREQ '1'                                       136237
     C           *IN50     ANDEQ'1'                                       136237
     C           CDP       SUB  LMD       N            35                 136237
     C           N         ADD  4         N                               136237
     C           *IN87     IFEQ '1'                                       136237
     C           ERLC      MULT POWER,N   WK159                           136237
     C           WK159     IFEQ *ZEROS                                                      MD024930
     C                     Z-ADD*ZEROS    LCEQ                                              MD024930
     C                     ELSE                                                             MD024930
     C           AMT,EA    DIV  WK159     LCEQ   130H                     136237
     C                     ENDIF                                                            MD024930
     C                     ELSE                                           136237
     C           ERLC      DIV  POWER,N   WK159                           136237
     C           AMT,EA    MULT WK159     LCEQ      H                     136237
     C                     END                                            136237
     C                     END                                            136237
1031 C   01 50
1032 COR 09 50             GOTO SETDE
1033 C           CDP       SUB  LMD       N            35
1034 C           N         ADD  4         N
1035 C   87      ERLC      MULT POWER,N   WK159
1036 C***87***** AMT,EA    DIV  WK159     LCEQ   130H                                       MD024930
     C           *IN87     IFEQ *ON                                                         MD024930
     C           WK159     IFEQ *ZEROS                                                      MD024930
     C                     Z-ADD*ZEROS    LCEQ                                              MD024930
     C                     ELSE                                                             MD024930
     C           AMT,EA    DIV  WK159     LCEQ   130H                                       MD024930
     C                     ENDIF                                                            MD024930
     C                     ENDIF                                                            MD024930
1037 C  N87      ERLC      DIV  POWER,N   WK159
1038 C  N87      AMT,EA    MULT WK159     LCEQ      H
1039 C*
1040 C*    SETTLEMENT DETAILS - SEE DATA STRUCTURE -
1041 C*    AND FULL INSTRUCTIONS PRESENT INDICATOR
1042 C           SETDE     TAG                             ** SETDE TAG **
     C                     MOVE *BLANKS   SETTLE                          S01095
     C                     MOVE *BLANKS   @SBR    3                       S01095
1043 C                     MOVE 'N'       WRKFLG  1                       101258
1043 C                     MOVE ' '       FIPI    1
     C*                                                                   CEU003
     C* The Settlement type SETP is not initialised to Zeros under        CEU003
     C*   certain circumstances and hence Zeros are moved in positions    CEU003
     C*   1 and 2 of SETTLE field.                                        CEU003
     C*                                                                   CEU003
     C                     MOVEL'00'      SETTLE                          CEU003
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0400CP13                                           S01408
      *                                                                   S01408
1044 C           SIIND     COMP '0'                      50
      *                                                                                     MD033601
     C           *IN02     IFEQ *ON                                                         MD033601
     C           *IN50     ANDEQ*ON                                                         MD033601
     C           CODE2     ANDEQ'M2'                                                        MD033601
     C           RBDN      ANDNE0                                                           MD033601
     C                     MOVELSETMAT    SETTLE                                            MD033601
     C                     ENDIF                                                            MD033601
      *                                                                                     MD033601
1045 C   50                GOTO ROLLOV
1046 C           SIIND     COMP '3'                  52  50
1047 C   50
1048 COR 52 06             MOVE SETDM     SETTLE           AMENDMENT REC.
     C*                                                                   CEU003
     C* Under the same conditions where SETDM is moved to SETTLE, use     CEU003
     C*  the settlement currency from DEAMS file.                         CEU003
     C           *IN50     IFEQ *ON                                       CEU003
     C           *IN52     OREQ *ON                                       CEU003
     C           *IN06     ANDEQ*ON                                       CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      @KEYB                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       @KEYB                           CEU003
     C                     ENDIF                                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
1047 C   50                                                               S01117
1048 COR 52 06             MOVE OSBR      @SBR             AMENDMENT REC. S01117
1047 C   50                                                               101258
1048 COR 52 06             MOVE 'Y'       WRKFLG                          101258
1048 C*                                                                   101258
1049 C           SIIND     COMP '2'                    5051
1050 C   50                MOVE SETST     SETTLE           START/PURCHASE
     C*                                                                   CEU003
     C* Under the same conditions where SETST is moved to SETTLE, use     CEU003
     C*  the settlement currency from DEAMS file.                         CEU003
     C           *IN50     IFEQ *ON                                       CEU003
     C                     SELEC                                          CEU003
     C           *IN01     WHEQ *ON                                       CEU003
     C           *IN09     OREQ *ON                                       CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           RSCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE RSCY      @KEYB                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE PUCY      @KEYB                           CEU003
     C                     ENDIF                                          CEU003
     C           *IN02     WHEQ *ON                                       CEU003
     C           *IN03     OREQ *ON                                       CEU003
     C           *IN04     OREQ *ON                                       CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      @KEYB                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       @KEYB                           CEU003
     C                     ENDIF                                          CEU003
     C                     ENDSL                                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
1050 C***50****************MOVE ROBR      @SBR       RECEIVE BRANCH S01117E269
1051 C   51
1052 COR 52N06             MOVE SETMAT    SETTLE           MATURITY/SALE
     C*                                                                   CEU003
     C           *IN51     IFEQ *ON                                       CEU003
     C           *IN52     OREQ *ON                                       CEU003
     C           *IN06     ANDEQ*OFF                                      CEU003
     C                     SELEC                                          CEU003
     C           *IN01     WHEQ *ON                                       CEU003
     C           *IN09     OREQ *ON                                       CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           PSCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE PSCY      @KEYB                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE SLCY      @KEYB                           CEU003
     C                     ENDIF                                          CEU003
     C           *IN02     WHEQ *ON                                       CEU003
     C           *IN03     OREQ *ON                                       CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      @KEYB                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       @KEYB                           CEU003
     C                     ENDIF                                          CEU003
     C                     ENDSL                                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C           S01434    IFEQ 'Y'                                       130756
     C           *IN02     ANDEQ'1'                                       130756
     C           IPDS      ANDEQ'Y'                                       130756
     C           EVCODE    IFEQ '15I2'                                    130756
     C           EVCODE    OREQ '15M2'                                    130756
     C           EVCODE    OREQ '16I2'                                    130756
     C           EVCODE    OREQ '16M2'                                    130756
     C           EVCODE    OREQ '15M8'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '16M8'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '15I6'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '16I6'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           IMET      IFNE '00'                                                          181604
     C                     MOVE SETISA    SETTLE                          130756
     C                     ENDIF                                                              181604
     C                     ENDIF                                          130756
     C                     ENDIF                                          130756
     C*                                                                   130756
1051 C***51****************                                         S01117E269
1052 C*OR*52N06*************MOVE POBR      @SBR       PAY BRANCH    S01117E269
1053 C*                                                                         `
      * For settlement type 5 (any midas a/c) check if GL a/c is a nostro                     242892
     C           SETTYP    IFEQ 5                                                             242892
     C                     EXSR CHKGLN                                                        242892
     C                     ENDIF                                                              242892
      *                                                                                       242892
1053 C           WRKFLG    IFNE 'Y'                                       101258
1053 C*                                                                   101258
     C           IOIND     IFEQ 'I'                                       E269
     C                     MOVE ROBR      @SBR                            E269
     C                     END                                            E269
      *                                                                   E269
     C           IOIND     IFEQ 'O'                                       E269
     C                     MOVE POBR      @SBR                            E269
     C                     END                                            E269
      *                                                                   E256
     C                     MOVE @SBR      OSBR                            E256
1053 C*                                                                   101258
     C                     END                                            101258
      *                                                                   E256
     C*                                                                   138004
     C* Test to see if Blanks have been introduced to numeric field       138004
     C* SETTYP by other fields being moved into DS field SETTLE.          138004
     C* Use ALPHA field SETALF to accomplish this.                        138004
     C* possible alpha fields being SETDM, SETST, SETMAT, SETISR          138004
     C*                                                                   138004
     C           SETALF    IFEQ *BLANKS                                   138004
     C                     MOVE '00'      SETALF                          138004
     C                     END                                            138004
     C*                                                                   138004
     C           OSBR      IFEQ ' '                                       077164
     C           SETTYP    IFEQ 1                                         077164
     C           SETTYP    OREQ 7                                         077164
     C           SETTYP    OREQ 8                                         077164
     C                     MOVELSETAC     @KEYE                           077164
     C                     CALL 'AONOSTR0'                                077164
     C                     PARM '*MSG   ' @RTCD   7                       077164
     C                     PARM '*KEY   ' @OPTN   7                       077164
     C                     PARM *BLANKS   @KEYA   6                       077164
     C***********          PARM CCY       @KEYB   3                077164 CEU003
     C                     PARM           @KEYB                           CEU003
     C**********           PARM *BLANKS   @KEYC   4                                    077164 CGL029
     C                     PARM *BLANKS   @KEYC                                               CGL029
     C                     PARM *BLANKS   @KEYD   2                       077164
     C                     PARM           @KEYE   2                       077164
     C                     PARM *BLANKS   @KEYF                           077164
     C                     PARM *BLANKS   @KEYG                           077164
     C                     PARM *BLANKS   @KEYH                           077164
     C           SDNOST    PARM SDNOST    DSFDY                           077164
     C*                                                                   077164
     C           @RTCD     IFNE *BLANK                                    077164
     C                     SETON                     U7U8LR               077164
     C                     MOVEL'SDNOSTPD'DBFILE 10        ************   077164
     C                     MOVE '14'      DBASE   3        * DBERR 14 *   077164
     C                     MOVE @OPTN     DBOPTN  7        ************   077164
     C                     MOVEL@OPTN     DBKEY  29                       077164
     C*                                                                   077164
     C                     ELSE                                           077164
     C                     MOVE A7BRCD    OSBR                            077164
     C                     END                                            077164
     C                     END                                            077164
     C                     END                                            077164
     C*                                                                   077164
     C**  INDICATOR 54 SHOULD BE SET OFF, OTHERWISE MAY BE LEFT ON        E15116
     C                     MOVE '0'       *IN54                           E15116
1053 C*                                                                   149415
     C* Default booking branch                                            149415
     C* into work field event brch.                                       149415
     C*                                                                   149415
     C                     MOVE BRCA      W#ZBRC                          149415
     C*                                                                   138004
     C*                                                                   138004
     C* Pick up Interest settlement currency nostro.                      138004
     C           IPDS      IFEQ 'Y'                                       138004
     C           *IN02     ANDEQ'1'                                       132172
     C*                                                                   138004
     C                     MOVELINSA00    TSTINS  3                       138004
     C                     MOVE '0'       TSTINS                          138004
     C                     TESTN          TSTINS     69                   138004
     C*                                                                   138004
     C           *IN69     IFEQ '1'                                       138004
     C           INSABL    IFEQ *BLANKS                                   138004
     C           IMET      IFEQ '01'                                      138004
     C           IMET      OREQ '02'                                      138004
     C           IMET      OREQ '03'                                      138004
     C           IMET      OREQ '08'                                      138004
     C           IMET      OREQ '12'                                      138004
     C*                                                                   138004
     C* If interest currency field is blank use deal currency else        138004
     C* use interest settlement currency to find Nostro information.      138004
     C*                                                                   138004
     C           ISCY      IFEQ *BLANKS                                   138004
     C                     MOVE CCY       W#CURR  3                       138004
     C                     ELSE                                           138004
     C                     MOVE ISCY      W#CURR                          138004
     C                     END                                            138004
     C*                                                                   138004
     C                     CALL 'AONOSTR0'                                138004
     C                     PARM '*MSG   ' @RTCD   7                       138004
     C                     PARM '*KEY   ' @OPTN   7                       138004
     C                     PARM *BLANKS   @KEYA   6                       138004
     C                     PARM W#CURR    @KEYB   3                       138004
     C**********           PARM *BLANKS   @KEYC   4                                    138004 CGL029
     C                     PARM *BLANKS   @KEYC                                               CGL029
     C                     PARM *BLANKS   @KEYD   2                       138004
     C                     PARM INSA00    @KEYE   2                       138004
     C                     PARM *BLANKS   @KEYF   3                       138004
     C                     PARM *BLANKS   @KEYG  10                       138004
     C                     PARM *BLANKS   @KEYH   1                       138004
     C           SDNOST    PARM SDNOST    DSFDY                           138004
     C*                                                                   138004
     C           @RTCD     IFNE *BLANK                                    138004
     C                     SETON                     U7U8LR               138004
     C                     MOVEL'SDNOSTPD'DBFILE 10        ************   138004
     C                     MOVE '18'      DBASE   3        * DBERR 18 *   138004
     C                     MOVE @OPTN     DBOPTN  7        ************   138004
     C                     MOVEL@OPTN     DBKEY  29                       138004
     C*                                                                   138004
     C                     ELSE                                           138004
     C                     MOVE A7BRCD    W#ZBRC  3                       138004
     C                     END                                            138004
     C*                                                                   138004
     C*                                                                   138004
     C                     END                                            138004
     C                     END                                            138004
     C                     END                                            138004
     C                     END                                            138004
     C*                                                                   138004
1053 C*                                                                   E15116
     C*                                                                   138004
     C* Test to see if Blanks have been introduced to numeric field       138004
     C* SETTYP by other fields being moved into DS field SETTLE.          138004
     C* Use ALPHA field SETALF to accomplish this.                        138004
     C*                                                                   138004
     C           SETALF    IFEQ *BLANKS                                   138004
     C                     MOVE '00'      SETALF                          138004
     C                     END                                            138004
     C*                                                                   138004
1054 C           SETTYP    COMP 1                      5051
1055 C  N51      SETTYP    COMP 7                        51
1056 C  N51      SETTYP    COMP 8                        51
1057 C  N50      SETAC     COMP ' '                      50
1058 C   51N50   SETNOS    COMP ' '                      50
1059 C  N51      SETTYP    COMP 3                        54
1060 C  N51N54   SETTYP    COMP 6                        54
1061 C   54                SETOF                     50
1062 C   50                MOVE 'N'       FIPI
1063 C  N50                MOVE 'Y'       FIPI
1064 C*
1065 C*    ROLLOVER INDICATOR
1066 C           ROLLOV    TAG                             ** ROLLOV TAG *
1067 C                     SETOF                     42
1068 C   02 25   CODE2     COMP 'M1'                     42
1069 C   02 25N42CODE2     COMP 'M2'                     42
1070 C   02 24N42CODE2     COMP 'V1'                     42
      *                                                                                       CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C           *IN25     ANDEQ*ON                                                           CAS005
     C           *IN42     ANDEQ*OFF                                                          CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
      *                                                                                       CAS005
     C           CODE2     IFEQ 'M6'                                                          CAS005
     C           CODE2     OREQ 'M8'                                                          CAS005
     C           CODE2     OREQ 'V6'                                                          CAS005
     C                     MOVE *ON       *IN42                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   CEU015
     C************IN42     IFEQ *ON                                CEU015 145001
     C************LIKE     DEFN RBDA      RBD1                     CEU015 145001
     C***********          Z-ADDRBDA      RBD1                     CEU015 145001
     C***********CEU015    IFEQ 'Y'                                CEU015 145001
     C***********RTFC      ANDNE*BLANKS                            CEU015 145001
     C***********          Z-ADDRBDA      P@FRAM                   CEU015 145001
     C***********          MOVELRTFC      P@FRCY                   CEU015 145001
     C***********          MOVELCCY       P@TOCY                   CEU015 145001
      ***********                                                  CEU015 145001
      ***Convert*RBDA*to*deal*currency*equivalent*via*call*to*EU020CEU015 145001
      ***********                                                  CEU015 145001
     C***********          CALL 'EU0200'                           CEU015 145001
     C***********          PARM *BLANKS   P@RTCD  7 Return Code    CEU015 145001
     C***********          PARM           P@FRAM 183FROM Ccy AmountCEU015 145001
     C***********          PARM           P@FRCY  3 FROM Currency  CEU015 145001
     C***********          PARM           P@TOCY  3 TO Currency    CEU015 145001
     C***********          PARM           P@OUTA 150Outright AmountCEU015 145001
     C***********          PARM           P@INTA 183Interim Amount CEU015 145001
     C***********          PARM           P@EXRT 159Exchange Rate  CEU015 145001
     C***********          PARM           P@MDIN  1 Mult/Div Ind   CEU015 145001
     C***********P@RTCD    IFEQ '*ERROR*'                          CEU015 145001
     C***********          SETON                     U7U8LR        CEU015 145001
     C***********          MOVEL*BLANKS   DBFILE 10                CEU015 145001
     C***********          MOVEL'EU0200  'DBFILE    ************   CEU015 145001
     C***********          MOVE '17'      DBASE   3 * DBERR 17 *   CEU015 145001
     C***********          MOVE @OPTN     DBOPTN  7 ************   CEU015 145001
     C***********          MOVE *BLANKS   DBKEY  29                CEU015 145001
     C***********          MOVE *BLANKS   W@OPTN                   CEU015 145001
     C***********          MOVELP@FRCY    W@OPTN                   CEU015 145001
     C***********          MOVE P@TOCY    W@OPTN                   CEU015 145001
     C***********          MOVELW@OPTN    DBKEY                    CEU015 145001
     C***********                                                  CEU015 145001
     C***********          ELSE                                    CEU015 145001
     C***********          Z-ADDP@OUTA    RBD1                     CEU015 145001
     C***********          ENDIF                                   CEU015 145001
     C***********          ENDIF                                   CEU015 145001
     C***********          ENDIF                                   CEU015 145001
1071 C*
1072 C*    DEAL AMENDMENT SEQUENCE NO
1073 C  N06                Z-ADD0         OTDASN  30
1074 C   06                Z-ADDDASN      OTDASN
1075 C*
1076 C*    FEDERAL FUNDS VALUE DATE AND INDICATOR
1077 C                     Z-ADDDAT,ED    FFVD    50
1078 C                     SETOF                     565743
1079 C                     TESTB'2'       DSTI           56
1080 C   01
1081 COR 09                TESTB'3'       DSTI           57
1082 C                     MOVE ' '       FFIN    1
1083 C                     MOVE ' '       OCFF    1
1084 C                     EXSR FEDAT
1085 C***43                Z-ADDFFVD      ZDAYNO
1086 C***43                EXSR ZDATE5
1087 C**
1088 C*
1089 C*    FOR ACCOUNT OF, SPECIAL INSTRUCTIONS
1090 C           IOIND     COMP 'O'                      44
1091 C   44N06             MOVE FACO      OTFACO 10
1092 C   44N06             MOVE SPI       OTSPI  35
1093 C   44 06             MOVE FACOM     OTFACO
1094 C   44 06             MOVE SPIM      OTSPI
     C**   TO MOVE COMPANY CODE FOR BOOKING BRANCH                        S01117
     C** & SET UP EVENT BRANCH COMPANY                                    S01117
     C                     MOVE *BLANKS   COBB    3                       S01117
     C                     MOVE *BLANKS   ECPY    3                       S01117
     C                     MOVE BRCA      EBRC    3                       S01117
     C                     Z-ADD1         X                               S01117
     C******     BRCD      LOKUPBR,X                     55  S01117       S01117
     C           BRCA      LOKUPBR,X                     55               S01117
     C           *IN55     IFEQ '1'                                       S01117
     C                     MOVE CO,X      COBB                            S01117
     C                     MOVE CO,X      ECPY                            S01117
     C                     MOVE IC,X      WRKCNO  6                       S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**   TO MOVE COMPANY CODE FOR ORIGINATING BRANCH                    S01117
     C                     MOVE *BLANKS   COOB    3                       S01117
     C                     Z-ADD1         X                               S01117
     C           ORBR      LOKUPBR,X                     55               S01117
     C           *IN55     IFEQ '1'                                       S01117
     C                     MOVE CO,X      COOB                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C**   TO MOVE VALUE FOR FX EXPOSURE                                  S01117
     C           *IN01     IFEQ '1'                                       S01117
     C           EVCODE    ANDEQ'11V1'                                    S01117
     C           EVCODE    OREQ '12V1'                                    S01117
     C           *IN01     ANDEQ'1'                                       E251
     C           EVCODE    OREQ '13V1'                                    S01117
     C           *IN01     ANDEQ'1'                                       E251
     C           EVCODE    OREQ '14V1'                                    S01117
     C           *IN01     ANDEQ'1'                                       E251
     C                     MOVE 'F'       EXEI    1                       S01117
     C                     END                                            S01117
     C**   ASSIGN LENDING EXPOSURE INDICATOR                              S01117
     C           *IN42     IFEQ '0'                                       S01117
     C           *IN23     ANDEQ'0'                                       S01117
     C** Suppress Internal Loans from Loan Exposure Events                S01354
     C           DTYP      ANDNE'IL'                                      S01354
     C           EVCODE    ANDEQ'15M1'                                    S01117
     C           EVCODE    OREQ '17M1'                                    S01117
     C           *IN42     ANDEQ'0'                                       E251
     C           *IN23     ANDEQ'0'                                       E251
     C           *IN42     OREQ *OFF                                                          CAS005
     C           *IN23     ANDEQ*OFF                                                          CAS005
     C           DTYP      ANDNE'IL'                                                          CAS005
     C           EVCODE    ANDEQ'15M6'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '17M6'                                                        CAS005
     C           *IN42     ANDEQ*OFF                                                          CAS005
     C           *IN23     ANDEQ*OFF                                                          CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '17S1'                                    S01117
     C           *IN42     ANDEQ'0'                                       E251
     C           *IN23     ANDEQ'0'                                       E251
     C                     MOVE 'L'       EXEI                            S01117
     C                     END                                            S01117
1095 C*
1096 C*    KEEP COUNT AND HASH TOTAL OF EVENT RECORDS
1097 C           EVHASH    TAG                             ** EVHASH TAG *
1098 C*
1099 C           COUNTE    ADD  1         COUNTE  50
1100 C           AMT,EA    DIV  1000      ZZAMT        30
1101 C   30                Z-SUBZZAMT     ZZAMT
1102 C                     Z-ADDHASHEW    ZZTOTI
1103 C                     Z-ADDHASHED    ZZTOTD
1104 C                     EXSR GLZADD
1105 C                     Z-ADDZZTOTI    HASHEW 150
1106 C                     Z-ADDZZTOTD    HASHED  30
     C**
     C** CHECK TO SEE IF THE EVENT DATE IS EQUAL
     C** THE DATE NEXT WORKING DAY
     C****1      DAT,ED    COMP DNWD                     63               S01194
     C   U1      DAT,ED    COMP BJDNWD                   63               S01194
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
      ** INTEREST MUST BE CALCULATED FOR THE PERIOD IF NOT FIRST PERIOD                       CGL187
      *                                                                                       CGL187
     C           ZFREQ     IFNE *BLANKS                                                       CGL187
     C           DAT,ED    ANDGTNIDT                                                          CGL187
     C           ZFREQ     ORNE *BLANKS                                                       CGL187
     C           DAT,ED    ANDGTWNIDT                                                         CGL187
     C                     Z-ADD*ZEROS    PSAIP                                               CGL187
     C                     END                                                                CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,DL0400C062
     C***U1*63*******      ADD  1         TNDLR                           S01354
     C*
     C*
     C*
     C*
     C*
1107 C*
1108 C*    WRITE RECORD TO FILE
1109 C*
1110 C                     MOVE CUSTNO    CNMR    6                       S01117
     C                     MOVE IOIND     @INOI   1                       S01117
     C                     MOVE 'N'       IBRE    1                       S01117
     C                     MOVE 'Y'       ICYE    1                       S01117
      * IF CUST IS STILL THE SAME MOVE THE SAVED VALUE OF INDS 40 & 45    E184
     C************INL1     IFEQ '0'                                   E184BHF880
     C                     MOVE IND40     *IN40                           E184
     C                     MOVE IND45     *IN45                           E184
     C************         END                                        E184BHF880
     C**   Set Suppress Revaluation Flag                                  S01354
     C                     MOVE ' '       RSUPR   1                       S01354
      *                                                                   E184
     C**  Internal Funding Deals are Notional therefore:                  S01354
     C*                                                                   S01354
     C           DTYP      IFEQ 'IL'                                      S01354
     C           DTYP      OREQ 'ID'                                      S01354
     C**   Suppress Complete and Outstanding Instructions                 S01354
     C                     MOVE ' '       FIPI                            S01354
     C**   Suppress Output to Exposure Management Files                   S01354
     C                     MOVE '0'       *IN63                           S01354
     C**   Suppress Revaluation of Internal Deals                         S01354
     C                     MOVE 'Y'       RSUPR                           S01354
     C**   Reset Inter Branch Indicator                                   S01354
     C           OSBR      IFEQ BRCA                                      S01354
     C           OSBR      OREQ *BLANKS                                   S01354
     C                     MOVE 'Y'       IBRE                            S01354
     C                     MOVE 'N'       ICYE                            S01354
     C                     ELSE                                           S01354
     C                     MOVE 'N'       IBRE                            S01354
     C*                                                                   S01354
     C**   Reset Inter Company Indicator                                  S01354
     C                     Z-ADD1         X                               S01354
     C           OSBR      LOKUPBR,X                     55               S01354
     C*                                                                   S01354
     C           ECPY      IFEQ CO,X                                      S01354
     C                     MOVE 'N'       ICYE                            S01354
     C                     ELSE                                           S01354
     C                     MOVE 'Y'       ICYE                            S01354
     C                     END                                            S01354
     C*                                                                   S01354
     C                     END                                            S01354
     C                     END                                            S01354
     C*                                                                   S01354
     C** If a FX deal which has been netted, do not output to EMTE2E2     CDL002
     C*                                                                   CDL002
     C                     SETOF                     38                   CDL002
     C           *IN01     IFEQ '1'                                       CDL002
     C           EC        IFEQ 'P'                                       CDL002
     C           NETBR     ANDNE*BLANKS                                   CDL002
     C           EC        OREQ 'S'                                       CDL002
     C           NETSR     ANDNE*BLANKS                                   CDL002
     C                     SETON                     38                   CDL002
     C                     END                                            CDL002
     C                     END                                            CDL002
     C*                                                                   CDL002
     C           *IN38     IFEQ '0'                                       CDL002
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** When event V1 is written on file.                                CDL006
      *                                                                   CDL006
     C           CODE2     IFEQ 'V1'                                      CDL006
      *                                                                   CDL006
      ** If charge due on Fiduciary Call or Time deposits.                CDL006
      *                                                                   CDL006
     C           BNCHTK    IFEQ 'Y'                                       CDL006
     C           EVFIDE    ANDEQ'D'                                       CDL006
     C           FCGC      ANDNE*BLANKS                                   CDL006
     C           BNCHTK    OREQ 'Y'                                       CDL006
     C           EVFIDE    ANDEQ'L'                                       CDL006
     C           FCGC      ANDNE*BLANKS                                   CDL006
     C                     Z-ADDFCGA      EVFCGA                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** When event I2 is written on file.                                CDL006
      *                                                                   CDL006
     C           CODE2     IFEQ 'I2'                                      CDL006
      *                                                                   CDL006
      ** If commission due on Fiduciary Call or Time deposits.            CDL006
      *                                                                   CDL006
     C           BNCOTK    IFEQ 'Y'                                       CDL006
     C           EVFIDE    ANDEQ'D'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
     C           BNCOTK    OREQ 'Y'                                       CDL006
     C           EVFIDE    ANDEQ'L'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
      *                                                                   CDL006
      ** Calculate commission amount due.                                 CDL006
      *                                                                   CDL006
      ** If Call deposit.                                                 CDL006
      *                                                                   CDL006
      **      PCPL                                                        CDL006
      ** (------------) X (NIDT - IACD) x (% current range) + FACTC       CDL006
      **  Days of year                                      - FCPRD       CDL006
      **                                                                  CDL006
      *                                                                   CDL006
      ** If Fixed Term deposit.                                           CDL006
      *                                                                   CDL006
      **     FCMA                                                         CDL006
      ** (-----------)  x  (NIDT - IACD) + FACTC - FCPRD                  CDL006
      **  MDAT - VDAT                                                     CDL006
      *                                                                   CDL006
     C                     Z-ADDIACD      WUDBEG                          CDL006
     C                     Z-ADDNIDT      WUDEND                          CDL006
     C                     EXSR COMCAL                                    CDL006
     C           *LIKE     DEFN PCPL      WORKTD                          CDL006
     C           *LIKE     DEFN PCPL      WORKD                           CDL006
      *                                                                   CDL006
     C                     Z-ADD*ZEROS    EVFCMA                          CDL006
     C           WUACSC    IFGE *ZEROS                                    CDL006
     C           WUACSC    ADD  FACTC     WORKTD                          CDL006
     C           WORKTD    SUB  FACPD     WORKD                           CDL006
     C                     Z-ADDWORKD     EVFCMA                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** When event M1 is written on file.                                CDL006
      *                                                                   CDL006
     C           CODE2     IFEQ 'M1'                                      CDL006
      *                                                                   CDL006
      ** If commission due on Fiduciary Call or Time deposits.            CDL006
      *                                                                   CDL006
     C           BNCOTK    IFEQ 'Y'                                       CDL006
     C           EVFIDE    ANDEQ'D'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
     C           BNCOTK    OREQ 'Y'                                       CDL006
     C           EVFIDE    ANDEQ'L'                                       CDL006
     C           FCMC      ANDNE*BLANKS                                   CDL006
      *                                                                   CDL006
      ** Deal type is Deposit call taken / Loan call taken.               CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
      *                                                                   CDL006
      **  Calculate Commission amount due.                                CDL006
      *                                                                   CDL006
      **        PCPL       (MDAT - IACD)                                  CDL006
      **  (------------) x      O R      x (% current range) + FACTC      CDL006
      **   Days of year    (NIDT - IACD)                     - FCPRD      CDL006
      *                                                                   CDL006
     C                     Z-ADDIACD      WUDBEG                          CDL006
      *                                                                   CDL006
     C           MDAT      IFNE *ZEROS                                    CDL006
     C           CAS005    ANDNE'Y'                                                           CAS005
     C           WMDAT     ORNE *ZEROS                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C                     Z-ADDMDAT      WUDEND                          CDL006
     C                     ELSE                                           CDL006
     C                     Z-ADDNIDT      WUDEND                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     EXSR COMCAL                                    CDL006
      *                                                                   CDL006
     C                     Z-ADD*ZEROS    WORKTD                          CDL006
     C           WUACSC    IFGE *ZEROS                                    CDL006
     C           WUACSC    ADD  FACTC     WORKTD                          CDL006
     C           WORKTD    SUB  FCPRD     WORKD                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Deal type is Deposit term taken.                                 CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FT'                                      CDL006
      *                                                                   CDL006
      **  Calculate Commission amount due : FCMA  - FCPRD.                CDL006
      *                                                                   CDL006
     C                     Z-ADDFCMA      WORKTD                          CDL006
     C           WORKTD    SUB  FCPRD     WORKD                           CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     Z-ADDWORKD     EVFCMA                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** When events V3 or M4 are written on file.                        CDL006
      *                                                                   CDL006
     C           CODE2     IFEQ 'V3'                                      CDL006
     C           CODE2     OREQ 'M4'                                      CDL006
      *                                                                   CDL006
      ** If charges on principal changes for Fiduciary Call deposits.     CDL006
      *                                                                   CDL006
     C           BNCHPC    IFEQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DT'                                      CDL006
     C           FCGC      ANDNE*BLANKS                                   CDL006
     C           BNCHPC    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LT'                                      CDL006
     C           FCGC      ANDNE*BLANKS                                   CDL006
      *                                                                   CDL006
     C                     Z-ADDFCGA      EVFCGA                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,DL0400C030
     C   U1 63             ADD  1         TNDLR                           S01354
     C                     END                                            CDL002
     C*                                                                   CDL002
     C           IPDS      IFEQ 'Y'                                       138004
     C           EVCODE    IFEQ '15M2'                                    138004
     C           EVCODE    OREQ '16M2'                                    138004
     C           EVCODE    OREQ '15M8'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '16M8'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '15I6'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           EVCODE    OREQ '16I6'                                                        CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           IMET      IFNE '00'                                                          181604
     C                     SETON                     72                   138004
     C                     ENDIF                                                              181604
     C                     END                                            138004
     C                     END                                            138004
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           KEY       IFEQ 'I6'                                                          CAS005
     C           KEY       OREQ 'V6'                                                          CAS005
     C           KEY       OREQ 'M8'                                                          CAS005
     C                     MOVE *BLANKS   PTFR                                                CAS005
     C                     Z-ADD*ZEROS    SETP                                                CAS005
     C                     MOVE *BLANKS   OSAC                                                CAS005
     C                     MOVE *BLANKS   SETTLE                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   CEU003
     C* For settlement event, if the settlement currency is defined,      CEU003
     C*  use the new routine to output 2 additional records.              CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           SETCCY    ANDNE*BLANKS                                   CEU003
     C           SIIND     IFEQ '1'                                       CEU003
     C           EVCODE    ANDNE'15V6'                                                        226512
     C           EVCODE    ANDNE'16V6'                                                        226512
     C           SIIND     OREQ '2'                                       CEU003
     C           EVCODE    ANDNE'15M6'                                                        226512
     C           EVCODE    ANDNE'16M6'                                                        226512
     C           EVCODE    ANDNE'17M6'                                                        226512
     C           EVCODE    ANDNE'15M8'                                                        226512
     C           EVCODE    ANDNE'16M8'                                                        226512
     C           EVCODE    ANDNE'15I6'                                                        226512
     C           EVCODE    ANDNE'16I6'                                                        226512
     C           SIIND     OREQ '3'                                       CEU003
     C           EVCODE    OREQ '15M2'                                    CEU003
     C           EVCODE    OREQ '16M2'                                    CEU003
     C           EVCODE    OREQ '17M2'                                    CEU003
     C********** EVCODE    OREQ '15M8'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '16M8'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '17M8'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C           EVCODE    OREQ '15I2'                                    CEU003
     C           EVCODE    OREQ '16I2'                                    CEU003
     C           EVCODE    OREQ '17I2'                                    CEU003
     C********** EVCODE    OREQ '15I6'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '16I6'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '17I6'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C                     EXSR EVNTEU                                    CEU003
     C                     ELSE                                           CEU003
     C/COPY WNCPYSRC,DL0400C118
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                     CEU003
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     EXSR SREVEX                                                        CGL187
      *                                                                                       CGL187
     C                     WRITEEVNTXED0                                                      CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,DL0400C095
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C*                                                                   138007
     C*  If Nostro settlement branch is not same branch as the event      138007
     C* branch move settlemnt branch into event branch if settlement      138007
     C* branch is not blank. Same idea as *IN55 on record three           138007
     C* This might happen if curency not changed but nostro points to     138007
     C* another branch.                                                   138007
     C*                                                                   138007
     C*                                                                   138007
     C                     MOVE '0'       *IN55                           138007
     C           CODE2     IFEQ 'M2'                                      138007
     C           CODE2     OREQ 'I2'                                      138007
     C           CODE2     OREQ 'MY'                                      138007
     C           CODE2     OREQ 'IY'                                      138007
     C           CODE2     OREQ 'M8'                                                          CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C           CODE2     OREQ 'I6'                                                          CAS005
     C           CAS005    ANDEQ'Y'                                                           CAS005
     C                     MOVE '1'       *IN55                           138007
     C                     END                                            138007
     C*                                                                   138007
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           DTYP      IFEQ 'IT'                                                          CGL015
     C           DTYP      OREQ 'CD'                                                          CGL015
     C           DTYP      OREQ 'TD'                                                          CGL015
     C           EVCODE    IFEQ '16I2'                                                        CGL015
     C           EVCODE    OREQ '16M1'                                                        CGL015
     C                     MOVE '1'       *IN89                                               CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C/COPY WNCPYSRC,DL0400C105
     C                     EXSR SRNEG                                                       MD039107
1110 C                     EXCPTEVNTX                                     S01117
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     EXSR SREVEX                                                        CGL187
      *                                                                                       CGL187
     C                     WRITEEVNTXED0                                                      CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,DL0400C096
     C                     ENDIF                                          CEU003
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     EXSR SRSTAX                                                        CER049
     C                     ENDIF                                                              CER049
     C/COPY WNCPYSRC,DL0400C089
     C*                                                                   CEU003
     C           *IN38     IFEQ '0'                                       CDL002
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** Don't write on Exposure Management files if Deal types           CDL006
      ** 'IP', 'CL', 'TD', 'CD' with Deal sub-type flagged as             CDL006
      ** Fiduciary Deposit.                                               CDL006
      *                                                                   CDL006
     C           WUFIDE    IFEQ 'D'                                       CDL006
     C           *INU1     ANDEQ'1'                                       CDL006
     C           WUFIDE    OREQ 'L'                                       CDL006
     C           *INU1     ANDEQ'1'                                       CDL006
      *                                                                   CDL006
      ** Save indicator *INU1.                                            CDL006
      *                                                                   CDL006
     C           *LIKE     DEFN *INU1     WUSVU1                          CDL006
     C                     MOVE *INU1     WUSVU1                          CDL006
      *                                                                   CDL006
     C                     MOVE '0'       *INU1                           CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C/COPY WNCPYSRC,DL0400C040
1110 C                     EXCPT
      *                                                                   CDL006
      ** If feature CDL006 is installed.                                  CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
      ** If Interbank Placing, Call/notice deposit placed, Time deposi t  CDL006
      ** or Call/notice deposit taken flagged as Fiduciary deposits.      CDL006
      *                                                                   CDL006
     C           WUFIDE    IFEQ 'D'                                       CDL006
     C           WUFIDE    OREQ 'L'                                       CDL006
      *                                                                   CDL006
      ** Restore indicator *INU1.                                         CDL006
     C                     MOVE WUSVU1    *INU1                           CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C/COPY WNCPYSRC,DL0400C043
     C                     END                                            CDL002
     C*                                                                   CDL002
     C           *IN67     IFEQ '1'                                       080698
     C                     MOVEL'0'       *IN68                           080698
     C                     END                                            080698
     C*
     C* WRITE OUT 2 EXTRA EVNTEXD RECORDS FOR DEALS WITH NON-BLANK        S01117
     C* SETTLEMENT BRANCH NOT EQUAL TO BOOKING BRANCH                     S01117
     C*
     C           @MBIN     IFEQ 'Y'                                       S01117
     C           @SBR      ANDNE*BLANKS                                   S01117
     C           @SBR      ANDNEBRCA                                      S01117
     C           DTYP      ANDNE'IL'                                      S01354
     C           DTYP      ANDNE'ID'                                      S01354
     C           KEY       ANDNE'PSS1'                                    S01393
     C           KEY       ANDNE'PSS2'                                    S01393
     C           IOIND     ANDNE*BLANKS                                   S01117
     C           *IN67     IFEQ '1'                                       080698
     C                     MOVEL'1'       *IN68                           080698
     C                     END                                            080698
     C*                                                                   S01117
     C           COUNTE    ADD  2         COUNTE  50                      S01117
     C           AMT,EA    DIV  1000      ZZAMT        30                 S01117
     C   30                Z-SUBZZAMT     ZZAMT                           S01117
     C                     Z-ADDHASHEW    ZZTOTI                          S01117
     C                     Z-ADDHASHED    ZZTOTD                          S01117
     C                     EXSR GLZADD                                    S01117
     C                     Z-ADDZZTOTI    HASHEW 150                      S01117
     C                     Z-ADDZZTOTD    HASHED  30                      S01117
     C           AMT,EA    DIV  1000      ZZAMT        30                 S01117
     C   30                Z-SUBZZAMT     ZZAMT                           S01117
     C                     Z-ADDHASHEW    ZZTOTI                          S01117
     C                     Z-ADDHASHED    ZZTOTD                          S01117
     C                     EXSR GLZADD                                    S01117
     C                     Z-ADDZZTOTI    HASHEW 150                      S01117
     C                     Z-ADDZZTOTD    HASHED  30                      S01117
     C**                                                                  S01117
     C                     MOVE @SBR      EBRC                            S01117
     C                     MOVE *BLANKS   ECPY                            S01117
     C                     Z-ADD1         X                               S01117
     C           EBRC      LOKUPBR,X                     55               S01117
     C           *IN55     IFEQ '1'                                       S01117
     C                     MOVE CO,X      ECPY                            S01117
     C                     END                                            S01117
     C                     MOVE 'Y'       IBRE    1                       S01117
     C*                                                                   S01117
     C           COBB      IFNE ECPY                                      S01117
     C                     MOVE 'Y'       ICYE    1                       S01117
     C                     ELSE                                           S01117
     C                     MOVE 'N'       ICYE                            S01117
     C                     END                                            S01117
     C                     MOVE BBCRNM    WBBUTX                          155498
     C                     MOVE BBCRTN    WBBVTX                          155498
     C                     MOVE BBCASC    WBBWTX                          155498
     C                     MOVE CPARC     WCPAR                           155498
     C                     MOVE CRNMC     WCRNM                           155498
     C                     MOVE CTWNC     WCTWN                           155498
     C                     MOVE CASKC     WCASK                           155498
     C                     MOVE CCTZC     WCCTZ                           155498
     C                     MOVE CLOCC     WCLOC                           155498
     C           EBRC      IFNE BRCA                                      155498
     C                     MOVE IC,X      CNMR                            155498
     C                     MOVE CP,X      CPARC                           155498
     C                     MOVE CR,X      CRNMC                           155498
     C                     MOVE CT,X      CTWNC                           155498
     C                     MOVE CA,X      CASKC                           155498
     C                     MOVE CZ,X      CCTZC                           155498
     C                     MOVE CL,X      CLOCC                           155498
     C                     MOVE PR,X      BBCRNM                          155498
     C                     MOVE PT,X      BBCRTN                          155498
     C                     MOVE PA,X      BBCASC                          155498
      *                                                                   155498
     C                     MOVE '0'       *IN40                           155498
     C                     MOVE '0'       *IN45                           155498
      *                                                                   155498
      ** Set Parent Indicator                                             155498
      *                                                                   155498
     C           PI,X      IFEQ 'P'                                       155498
     C                     MOVE '1'       *IN40                           155498
     C                     END                                            155498
      *                                                                   155498
      ** Set Child indicator                                              155498
      *                                                                   155498
     C********** CPARC     IFGT 0                                                      155498 CPK025
     C           CPARC     IFNE *BLANKS                                                       CPK025
     C                     MOVE '1'       *IN45                           155498
     C                     END                                            155498
      *                                                                   155498
     C                     ENDIF                                          155498
     C/COPY WNCPYSRC,DL0400C106
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           DTYP      IFEQ 'IT'                                                          CGL015
     C           DTYP      OREQ 'CD'                                                          CGL015
     C           DTYP      OREQ 'TD'                                                          CGL015
     C           EVCODE    IFEQ '16I2'                                                        CGL015
     C           EVCODE    OREQ '16M1'                                                        CGL015
     C                     MOVE '1'       *IN89                                               CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                     S01117
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     EXSR SREVEX                                                        CGL187
      *                                                                                       CGL187
     C                     WRITEEVNTXED0                                                      CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C                     MOVE WBBUTX    BBCRNM                          155498
     C                     MOVE WBBVTX    BBCRTN                          155498
     C                     MOVE WBBWTX    BBCASC                          155498
     C                     MOVE WCPAR     CPARC                           155498
     C                     MOVE WCRNM     CRNMC                           155498
     C                     MOVE WCTWN     CTWNC                           155498
     C                     MOVE WCASK     CASKC                           155498
     C                     MOVE WCCTZ     CCTZC                           155498
     C                     MOVE WCLOC     CLOCC                           155498
     C/COPY WNCPYSRC,DL0400C041
     C*                                                                   S01117
      ** SAVE FIELDS TO AVOID OVERWRITING MAIN EVENT FIELDS
     C                     MOVE BBPCNB    WBE1NB  6                       S01117
     C                     MOVE BBCRNM    WBBUTX 20                       S01117
     C                     MOVE BBCRTN    WBBVTX 10                       S01117
     C                     MOVE BBCASC    WBBWTX  8                       S01117
     C                     MOVE BBCNCZ    WBA6CD  2                       S01117
     C                     MOVE BBCOLC    WBA5CD  2                       S01117
     C                     MOVE CPARC     WCPAR   6                       S01117
     C                     MOVE CRNMC     WCRNM  20                       S01117
     C                     MOVE CTWNC     WCTWN  10                       S01117
     C                     MOVE CASKC     WCASK   8                       S01117
     C                     MOVE CCTZC     WCCTZ   2                       S01117
     C                     MOVE CLOCC     WCLOC   2                       S01117
     C***********          MOVE CLOCC     WCLOC   2                S01117 S01354
     C***********          MOVE WRKCNO    CNMR                     S01117 S01354
     C***********          MOVELWRKCNO    @KEY1                    S01117 S01354
     C***********          EXSR CLICHN                             S01117 S01354
     C***********          MOVE BBPCNB    CPARC                    S01117 S01354
     C***********          MOVE BBCRNM    CRNMC                    S01117 S01354
     C***********          MOVE BBCRTN    CTWNC                    S01117 S01354
     C***********          MOVE BBCASC    CASKC                    S01117 S01354
     C***********          MOVE BBCNCZ    CCTZC                    S01117 S01354
     C***********          MOVE BBCOLC    CLOCC                    S01117 S01354
     C***********                                                  S01117 S01354
     C***SEE*IF*CUSTOMER*IS*A*PARENT                               S01117 S01354
     C***********BBBNST    COMP 'Y'                      40        S01117 E181
     C***********BBPAIN    COMP 'P'                      40        E181   S01354
     C***********          MOVELBBPCNB    @KEY1                    S01117 S01354
     C***SEE*IF*CUSTOMER*HAS*A*PARENT,*IF*SO*OBTAIN*DETAILS        S01117 S01354
     C***********CPARC     COMP 0                    45            S01117 S01354
     C***45******          EXSR CLICHN                             S01117 S01354
     C***45*U7***          GOTO END                                S01117 S01354
     C*                                                                   S01354
     C** Booking Branch is Second leg's Customer                          S01354
     C*                                                                   S01354
     C                     Z-ADD1         X                               S01354
     C           BRCA      LOKUPBR,X                     55               S01354
     C*                                                                   S01354
     C                     MOVE IC,X      CNMR                            S01354
     C                     MOVE CP,X      CPARC                           S01354
     C                     MOVE CR,X      CRNMC                           S01354
     C                     MOVE CT,X      CTWNC                           S01354
     C                     MOVE CA,X      CASKC                           S01354
     C                     MOVE CZ,X      CCTZC                           S01354
     C                     MOVE CL,X      CLOCC                           S01354
     C                     MOVE PR,X      BBCRNM                          S01354
     C                     MOVE PT,X      BBCRTN                          S01354
     C                     MOVE PA,X      BBCASC                          S01354
     C*                                                                   S01354
     C                     MOVE '0'       *IN40                           S01354
     C                     MOVE '0'       *IN45                           S01354
     C*                                                                   S01354
     C** Set Parent Indicator                                             S01354
     C           PI,X      IFEQ 'P'                                       S01354
     C                     MOVE '1'       *IN40                           S01354
     C                     END                                            S01354
     C** Set Child indicator                                              S01354
     C********** CPARC     IFGT 0                                                      S01354 CSD027
     C           CPARC     IFGT *BLANKS                                                       CSD027
     C                     MOVE '1'       *IN45                           S01354
     C                     END                                            S01354
     C*                                                                   S01354
     C           IOIND     IFEQ 'O'                                       S01117
     C                     MOVE 'I'       @INOI                           S01117
     C                     ELSE                                           S01117
     C                     MOVE 'O'       @INOI                           S01117
     C                     END                                            S01117
     C************IN67     IFEQ '1'                                 081766080698
     C***********          MOVEL*BLANKS   PTFR                      081766080698
     C***********          END                                      081766080698
     C*                                                                   S01117
     C/COPY WNCPYSRC,DL0400C107
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           DTYP      IFEQ 'IT'                                                          CGL015
     C           DTYP      OREQ 'CD'                                                          CGL015
     C           DTYP      OREQ 'TD'                                                          CGL015
     C           EVCODE    IFEQ '16I2'                                                        CGL015
     C           EVCODE    OREQ '16M1'                                                        CGL015
     C                     MOVE '1'       *IN89                                               CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                     S01117
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     EXSR SREVEX                                                        CGL187
      *                                                                                       CGL187
     C                     WRITEEVNTXED0                                                      CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,DL0400C042
      *
      ** RESET FIELDS READY FOR NEXT EVENT
     C                     MOVE WBE1NB    BBPCNB                          S01117
     C                     MOVE WBBUTX    BBCRNM                          S01117
     C                     MOVE WBBVTX    BBCRTN                          S01117
     C                     MOVE WBBWTX    BBCASC                          S01117
     C                     MOVE WBA6CD    BBCNCZ                          S01117
     C                     MOVE WBA5CD    BBCOLC                          S01117
     C                     MOVE WCPAR     CPARC                           S01117
     C                     MOVE WCRNM     CRNMC                           S01117
     C                     MOVE WCTWN     CTWNC                           S01117
     C                     MOVE WCASK     CASKC                           S01117
     C                     MOVE WCCTZ     CCTZC                           S01117
     C                     MOVE WCLOC     CLOCC                           S01117
     C                     END                                            S01117
     C*
     C           *IN67     IFEQ '1'                                       080698
     C                     MOVEL'0'       *IN68                           080698
     C                     END                                            080698
     C                     SETOF                     064463
      *                                                                                       234341
      ** Return INTDUE to original value after writing to EVNTXED to                          234341
      ** prevent interest computation problems.                                               234341
      *                                                                                       234341
     C           CGL031    IFEQ 'Y'                                                           234341
     C           EVCODE    ANDEQ'16I2'                                                        234341
     C           INTBAK    ANDNE0                                                             234341
     C           CGL031    OREQ 'Y'                                                           234341
     C           EVCODE    ANDEQ'16M2'                                                        234341
     C           INTBAK    ANDNE0                                                             234341
     C           CGL031    OREQ 'Y'                                                           234341
     C           EVCODE    ANDEQ'16M1'                                                        234341
     C           INTBAK    ANDNE0                                                             234341
      *                                                                                       234341
     C                     Z-ADDINTBAK    INTDUE                                              234341
      *                                                                                       234341
     C                     ENDIF                                                              234341
1112 C*
     C/COPY WNCPYSRC,DL0400C031
1113 C           ENDEV     ENDSR                           ** ENDEV TAG **
1114 C*
1115 C********************************************************************
1116 C**** SR TO OBTAIN CONVERSION FACTOR FOR CCY                         S01095
1117 C****       CURDP     BEGSR                           *** CURDP ***  S01095
1118 C****                 MOVEL'20      'TABKEY                          S01095
1119 C****                 MOVE DPCCY     CCYK                            S01095
1120 C****                 MOVE '1'       TABKEY                          S01095
1121 C****                 EXSR TABCHN                                    S01095
1122 C****       CDP       SUB  BCD       N            35                 S01095
1123 C****       N         ADD  4         N                               S01095
1124 C****                                                                S01095
1125 C****                 ENDSR                                          S01095
1126 C********************************************************************
1127 C*    FIND CURRENCY USING TABLES
1128 C*
1129 C           QCCY      BEGSR                           *** CCY ***
1130 C                     MOVE '   '     OTHCCY  3
     C                     MOVE *BLANKS   @SETCY                          CEU003
1131 C           EC        COMP 'D'                  51  50
1132 C   50                MOVE CCY       OTHCCY           D - DEAL CCY
     C   50                MOVE STCY      @SETCY                          CEU003
1133 C                     SETOF                     5052
1134 C   51      EC        COMP 'P'                  525051
1135 C   50                MOVE SPLC      OTHCCY           L - P/L CCY
1136 C   51                MOVE PUCY      OTHCCY           P - PURCHASE
     C   51                MOVE RSCY      @SETCY           Receipt Setl cyCEU003
1137 C   52                MOVE SLCY      OTHCCY           S - SALE CCY
     C   52                MOVE PSCY      @SETCY           Payment Setl cyCEU003
1138 C*
1139 C                     ENDSR
1140 C*
1141 C********************************************************************
1142 C*    SUBROUTINE TO CALCULATE INTEREST DATE FOR DEAL OR DEAL AMEND.
1143 C*
1144 C           INTDAT    BEGSR                           *** INTDAT ***
1145 C*
1146 C   26                GOTO AMEND
     C*                                                                   AUS003
     C*   BYPASS IF NEXT INTEREST IS ZERO                                 AUS003
     C*                                                                   AUS003
     C           NIDT      CABEQ0         ENDDAT                          AUS003
1147 C*
1148 C*    RR - INTEREST DATE FOR DEAL
     C/COPY WNCPYSRC,DL0400C114
      *                                                                                       CDL033
      ** For CF deals, if frequency of next interest payment                                  CDL033
      ** date is irregular, process differently. Also included                                CDL033
      ** are CI, IP, IT, TI and TD deals.                                                     CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
      *                                                                                       CDL033
     C           KFRCD1    KLIST                                                              CDL033
     C                     KFLD           DLNO                                                CDL033
     C                     KFLD           KRCIP   1                                           CDL033
     C                     KFLD           KPRDT   50                                          CDL033
      *                                                                                       CDL033
     C                     MOVE 'P'       KRCIP                                               CDL033
      *                                                                                       CDL033
     C                     Z-ADDNIDT      FROMDT                                              CDL033
     C                     Z-ADDNIDT      TODATE                                              CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
1149 C*
     C* Ensure settlement currency is used where appropriate for calls    CEU003
     C*  to AONOSTRO, sr/ZFREQB, sr/ZFWDT.                                CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      ZCCY                            CEU003
     C                     ELSE                                           CEU003
1150 C                     MOVE CCY       ZCCY
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
1151 C****                 MOVE 'Y'       ZOPT                            S01194
1152 C                     Z-ADDIBDT      DATE1   50
1153 C                     Z-ADDNIDT      FROMDT  50
1154 C                     Z-ADDINTF      INTF1   20
1154 C                     Z-ADDINTF1     ZMDAY
     C/COPY WNCPYSRC,DL0400C115
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
1155 C*
1156 C*    CALCULATE BASE DATE - DATE1 - AND TO-DATE
1157 C           REPEAT    TAG                             ** REPEAT TAG *
     C/COPY WNCPYSRC,DL0400C116
      *                                                                                       CDL033
      ** For CF deals, if frequency of next interest payment                                  CDL033
      ** date is irregular, process differently.  Also included                               CDL033
      ** are CI, IP, IT, TI and TD deals.                                                     CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
      *                                                                                       CDL033
     C                     Z-ADDTODATE    KPRDT                                               CDL033
      *                                                                                       CDL033
      ** Access the schedule file for the next interest payment                               CDL033
      ** date.                                                                                CDL033
      *                                                                                       CDL033
     C           KFRCD1    SETGTDLFRSCL3                                                      CDL033
     C           DLNO      READEDLFRSCL3                 08                                   CDL033
     C           *IN08     IFEQ *OFF                                                          CDL033
     C                     Z-ADDHHPRDT    TODATE                                              CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADD*ZERO     TODATE                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
1158 C                     Z-ADDDATE1     ZDAYNO
     C**  Check whether loan or deposit in order to set up location       S01195
     C           PCPL      IFGT 0                                         E325
     C*                                                                   E325
     C*  Set up location - if Our PAY Settlement                          E325
     C*  Method is a nostro then use nostro code and currency to find     E325
     C*  Nostro Location                                                  E325
     C           PSTM      IFEQ 01                                        E325
     C           PSTM      OREQ 02                                        E325
     C           PSTM      OREQ 07                                        E325
     C           PSTM      OREQ 08                                        E325
     C           PSTM      OREQ 12                                        E325
     C*                                                                   E325
     C                     CALL 'AONOSTR0'                                E325
     C                     PARM '*MSG   ' @RTCD   7                       E325
     C                     PARM '*KEY   ' @OPTN   7                       E325
     C                     PARM *BLANKS   @KEYA   6                       E325
     C***********          PARM CCY       @KEYB   3                  E325 CEU003
     C                     PARM ZCCY      @KEYB                           CEU003
     C**********           PARM *BLANKS   @KEYC   4                                      E325 CGL029
     C                     PARM *BLANKS   @KEYC                                               CGL029
     C                     PARM *BLANKS   @KEYD   2                       E325
     C                     PARM PONS      @KEYE   2                       E325
     C                     PARM *BLANKS   @KEYF                           E325
     C                     PARM *BLANKS   @KEYG                           E325
     C                     PARM *BLANKS   @KEYH                           E325
     C           SDNOST    PARM SDNOST    DSFDY                           E325
     C*                                                                   E325
     C           @RTCD     IFNE *BLANK                                    E325
     C                     SETON                     U7U8LR               E325
     C                     MOVEL'SDNOSTPD'DBFILE 10        ************   E325
     C                     MOVE '10'      DBASE   3        * DBERR 10 *   E325
     C                     MOVE @OPTN     DBOPTN  7        ************   E325
     C                     MOVEL@OPTN     DBKEY  29                       E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C                     MOVE A7NOSN    ZLOC                            E325
     C                     END                                            E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C                     MOVE BJSLCD    ZLOC                            E325
     C                     END                                            E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C*                                                                   E325
     C**  PCPL is less than zero so deal is a loan                        E325
     C*  Set up location - if Our receive Settlement                      E325
     C*  Method is a nostro then use nostro code and currency to find     E325
     C*  Nostro Location                                                  E325
     C*                                                                   E325
     C           RSTM      IFEQ 01                                        E325
     C           RSTM      OREQ 02                                        E325
     C           RSTM      OREQ 07                                        E325
     C           RSTM      OREQ 08                                        E325
     C           RSTM      OREQ 12                                        E325
     C*                                                                   E325
     C                     CALL 'AONOSTR0'                                E325
     C                     PARM '*MSG   ' @RTCD   7                       E325
     C                     PARM '*KEY   ' @OPTN   7                       E325
     C                     PARM *BLANKS   @KEYA   6                       E325
     C***********          PARM CCY       @KEYB   3                  E325 CEU003
     C                     PARM ZCCY      @KEYB                           CEU003
     C**********           PARM *BLANKS   @KEYC   4                                      E325 CGL029
     C                     PARM *BLANKS   @KEYC                                               CGL029
     C                     PARM *BLANKS   @KEYD   2                       E325
     C                     PARM RONS      @KEYE   2                       E325
     C                     PARM *BLANKS   @KEYF                           E325
     C                     PARM *BLANKS   @KEYG                           E325
     C                     PARM *BLANKS   @KEYH                           E325
     C           SDNOST    PARM SDNOST    DSFDY                           E325
     C*                                                                   E325
     C           @RTCD     IFNE *BLANK                                    E325
     C                     SETON                     U7U8LR               E325
     C                     MOVEL'SDNOSTPD'DBFILE 10        ************   E325
     C                     MOVE '11'      DBASE   3        * DBERR 11 *   E325
     C                     MOVE @OPTN     DBOPTN  7        ************   E325
     C                     MOVEL@OPTN     DBKEY  29                       E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C                     MOVE A7NOSN    ZLOC                            E325
     C                     END                                            E325
     C*                                                                   E325
     C                     ELSE                                           E325
     C                     MOVE BJSLCD    ZLOC                            E325
     C                     END                                            E325
     C*                                                                   E325
     C                     END                                            E325
     C*                                                                   E325
1159 C*****                EXSR ZFREQB                                    S01194
1159 C*********************EXSR FREQB                               S01194DT0206
     C/COPY WNCPYSRC,DL0400C063
     C                     EXSR ZFREQB                                    DT0206
     C/COPY WNCPYSRC,DL0400C064
1160 C                     Z-ADDZDAYNO    DATE1
     C**  ZFREQ MAY RETURN A NON-WORKING DAY FOR FREQ W,F,S,R AND L       S01095
     C**  CHECK WITH ZDATE5 AND GET NEXT WORKING DAY                      S01095
     C           ZFREQ     LOKUPFRQ                      50               S01095
     C/COPY WNCPYSRC,DL0400C065
     C*                                                                   AUS003
     C*   LEAVE DATE UNCHANGED, IF INTEREST FREQUENCY 'N'                 AUS003
     C*                                                                   AUS003
     C           *IN88     IFEQ '1'                                       AUS003
     C                     MOVE '0'       *IN50                           AUS003
     C                     END                                            AUS003
     C*                                                                   AUS003
     C           *IN50     IFEQ '1'                        ** IF  001     S01095
1161 C****                 MOVE 'Y'       ZOPT                            S01195
1162 C****                 EXSR ZDATE5                                    S01195
     C                     EXSR ZFWDT                                     S01195
1163 C                     Z-ADDZDYNBR    TODATE
     C                     ELSE                            ** ELS 001     S01095
     C                     Z-ADDZDAYNO    TODATE                          S01095
     C                     END                             ** END 001     S01095
1164 C*
1165 C*    FINISH IF N.A.PURCHASED WITH NON-ZERO SALE DATE, OR
1166 C*    OTHERWISE IF TO-DATE EQUAL TO OR GREATER THAN MATURITY DATE
     C/COPY WNCPYSRC,DL0400C066
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
1167 C   02
1168 COR 03N29   TODATE    COMP MDAT                 50  50
1169 C   03 29   TODATE    COMP SADT                 50
     C*                                                                                       255705
     C** If, because of holidays, the calculated NIDT is less than or                         255705
     C** equal to the previous NIDT, proceed to maturity event.                               255705
     C           TODATE    IFNE *ZERO                                                         255705
     C           TODATE    ANDLEFROMDT                                                        255705
     C                     MOVE '1'       *IN50                                               255705
     C                     ENDIF                                                              255705
     C*                                                                   AUS003
     C*    CALCULATE INTERIM INTEREST, IF INTEREST FREQUENCY 'N'          AUS003
     C*                                                                   AUS003
     C/COPY WNCPYSRC,DL0400C032
      *                                                                                       CDL033
      ** For CF deals, if frequency of next interest payment                                  CDL033
      ** date is irregular and next interest payment date                                     CDL033
      ** is zero, process maturity event.  Also included                                      CDL033
      ** are CI, IP, IT, TI and TD deals.                                                     CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           IPFR      ANDEQ'Z'                                                           CDL033
     C           TODATE    IFEQ *ZERO                                                         CDL033
     C                     MOVE *ON       *IN50                                               CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** For CF deals, if new rate has not been applied                                       CDL033
      ** before in previous events, determine if new                                          CDL033
      ** rate has to be applied at this point.  Also included                                 CDL033
      ** are CI, IP, IT, TI and TD deals.                                                     CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           WFLAG1    IFEQ *BLANK                                                        CDL033
      *                                                                                       CDL033
      ** If this is a next interest event, current rate fix                                   CDL033
      ** date has been processed already and next interest                                    CDL033
      ** date falls on or after rate change date, apply new                                   CDL033
      ** rate starting on this event.                                                         CDL033
      *                                                                                       CDL033
     C           *IN50     IFEQ *OFF                                                          CDL033
     C           XKINFF    ANDEQ'Y'                                                           CDL033
     C           TODATE    ANDGEXKRCDT                                                        CDL033
      *                                                                                       CDL033
      ** Determine interest due up to rate change date.                                       CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC2                                                        CDL033
      *                                                                                       CDL033
     C           XKBSRF    ADD  RTSP      INTR                                                CDL033
      *                                                                                       CDL033
     C           INTR      IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     INTR                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WFLAG1                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** CDL033 is switched on:                                                               CDL033
      ** For CF deals, process all rate changes up to the                                     CDL033
      ** determined next interest date.  Also included                                        CDL033
      ** are CI, IP, IT, TI and TD deals.                                                     CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'CI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IP'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'IT'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TI'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN02     ANDEQ*ON                                                           CDL033
     C           DTYP      ANDEQ'TD'                                                          CDL033
     C           *IN50     IFEQ *OFF                                                          CDL033
     C                     EXSR SRFRC6                                                        CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C   50                EXSR INTMAT                                    AUS003
     C*                                                                   AUS003
1170 C   50                GOTO ENDDAT
1171 C*
1172 C*    CALCULATE INTERIM INTEREST AND WRITE 'I2' EVENT RECORD
1173 C                     Z-ADDPCPL      ZIAMT
1174 C   03                Z-ADDFVAL      ZIAMT
     C/COPY WNCPYSRC,DL0400C033
1175 C                     EXSR INTRIM
1176 C                     Z-ADDTODATE    FROMDT
1177 C                     GOTO REPEAT
1178 C*
1179 C*
1180 C*    SS - DEAL AMENDMENT INTEREST DATE
1181 C*
1182 C           AMEND     TAG                             ** AMEND TAG **
1183 C*
1184 C                     Z-ADDNIDT      FROMDT         50
1185 C   50                Z-ADDSLID      FROMDT
1186 C                     Z-ADDDAVD      DATE
1187 C                     Z-ADDDASN      SEQNO
1188 C*
1189 C*    CHAIN TO DEALS AMENDMENT FILE
1190 C           RECALC    TAG                             ** RECALC TAG *
1191 C                     EXSR DAMCHN
1192 C   U7                GOTO ENDDAT
1193 C*
1194 C*    IF DEAL AMENDMENT LIVE, &
1195 C*    IF AMEND TYPE 'SI', FIND INTERIM INTEREST & WRITE 'I2' RECORD
1196 C           AMTP      COMP 'SI'                     50
1197 C   50                Z-ADDVDATM     TODATE
1198 C   50 03             Z-ADDFVAL      ZIAMT
1199 C   50 02             Z-ADDPCPL      ZIAMT
     C/COPY WNCPYSRC,DL0400C034
1200 C   50 06             EXSR INTRIM
1201 C*
1202 C                     Z-ADDTODATE    FROMDT
1203 C                     Z-ADDNAAD      DATE       50
1204 C                     Z-ADDNASN      SEQNO
1205 C   50                GOTO RECALC
1206 C*
1207 C           ENDDAT    ENDSR                           ** ENDDAT TAG *
1208 C*
     C********************************************************************AUS003
     C*    DD - CALCULATE INTEREST DUE AT MATURITY                        AUS003
     C*    WRITE 'I2' EVENT RECORD                                        AUS003
     C*    FOR INTEREST FREQUENCY 'N'                                     AUS003
     C*                                                                   AUS003
     C           INTMAT    BEGSR                           *** INTMAT *** AUS003
     C*                                                                   AUS003
     C*    STORE STATUS OF *IN50 WHICH IS A WORK IND IN SUBR EVENT        AUS003
     C                     MOVE '0'       IND50   1                       AUS003
     C   50                MOVE '1'       IND50                           AUS003
     C*                                                                   AUS003
     C           *IN88     IFEQ '0'                                       AUS003
     C                     GOTO INTEND                                    AUS003
     C                     END                                            AUS003
     C*                                                                   AUS003
     C           MDAT      IFEQ *ZEROS                                    AUS003
     C                     GOTO INTEND                                    AUS003
     C                     END                                            AUS003
     C*                                                                   AUS003
     C                     TESTB'2'       DNSI           51               AUS003
     C/COPY WNCPYSRC,DLH00035
      *                                                                   CDL019
      **  Calculate interest to maturity for fixed deposits/loans         CDL019
     C           DTYP      IFEQ 'TD'                                      CDL019
     C           DTYP      OREQ 'IT'                                      CDL019
     C           DTYP      OREQ 'TI'                                      CDL019
     C           DTYP      OREQ 'IP'                                      CDL019
     C                     MOVE *ON       *IN51                           CDL019
     C                     ENDIF                                          CDL019
     C*                                                                   AUS003
     C           *IN51     IFEQ '0'                                       AUS003
     C           TOTI      SUB  IPRD      INTDUE                          AUS003
     C           INTDUE    SUB  TOTINT    INTDUE                          AUS003
     C/COPY WNCPYSRC,DL0400C035
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C                     END                                            AUS003
     C*                                                                   AUS003
     C           *IN51     IFEQ '1'                                       AUS003
     C                     Z-ADDIACD      ZIBEG                           AUS003
     C                     Z-ADDMDAT      ZIEND                           AUS003
     C                     Z-ADDPCPL      ZIAMT                           AUS003
     C/COPY WNCPYSRC,DL0400C067
     C                     EXSR GLINTC                                    AUS003
     C/COPY WNCPYSRC,DL0400C068
     C                     Z-ADDZINTR     INTDUE    H                     AUS003
     C           INTDUE    ADD  AITC      INTDUE                          AUS003
     C           INTDUE    ADD  AIAN      INTDUE                          AUS003
     C           INTDUE    ADD  AIAP      INTDUE                          AUS003
     C           INTDUE    SUB  IPRD      INTDUE                          AUS003
     C           INTDUE    SUB  ICTD      INTDUE                          AUS003
     C           INTDUE    SUB  TOTINT    INTDUE                          AUS003
     C/COPY WNCPYSRC,DL0400C036
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
     C                     END                                            AUS003
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDIACD      ZIBEG                                               CAS005
     C                     Z-ADDMDAT      ZIEND                                               CAS005
     C                     Z-ADDFSPAMT    ZIAMT                                               CAS005
     C                     Z-ADDZIRATE    WZRATE                                              CAS005
     C           FSLQPS    IFEQ '+'                                                           CAS005
     C                     ADD  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSLQPS    IFEQ '-'                                                           CAS005
     C                     SUB  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     EXSR GLINTC                                                        CAS005
     C                     Z-ADDWZRATE    ZIRATE                                              CAS005
     C                     Z-ADDZINTR     INTDUN    H                                         CAS005
     C                     ADD  FSAITN    INTDUN                                              CAS005
     C                     ADD  FSAINN    INTDUN                                              CAS005
     C                     ADD  FSAIAN    INTDUN                                              CAS005
     C                     SUB  FSIPRN    INTDUN                                              CAS005
     C                     SUB  FSICTN    INTDUN                                              CAS005
     C                     SUB  WTOTIN    INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C*                                                                   AUS003
     C                     MOVE 'I2'      KEY                             AUS003
     C/COPY WNCPYSRC,DL0400C037
     C                     EXSR EVENT                                     AUS003
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'I6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   AUS003
     C*    RESTORE STATUS OF *IN50                                        AUS003
     C           IND50     IFEQ '1'                                       AUS003
     C                     MOVE '1'       *IN50                           AUS003
     C                     ELSE                                           AUS003
     C                     MOVE '0'       *IN50                           AUS003
     C                     END                                            AUS003
     C*                                                                   AUS003
     C           INTEND    ENDSR                                          AUS003
     C*                                                                   AUS003
1209 C********************************************************************
1210 C*    DD - CALCULATE INTEREST DUE AT INTERIM INTEREST DATES
1211 C*    WRITE 'I2' EVENT RECORD, AND KEEP INTEREST TOTAL FOR FIXED L/D
1212 C*
1213 C           INTRIM    BEGSR                           *** INTRIM ***
1214 C                     Z-ADDFROMDT    ZIBEG
1215 C**         TODATE    SUB  1         ZIEND
1216 C                     Z-ADDTODATE    ZIEND
     C/COPY WNCPYSRC,DL0400C077
1217 C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0400C078
     C*                                                                   S01392
     C* IF LOAN/DEPOSIT OR NA PURCHASED WITH ROUND DOWN INTEREST = 'Y'    S01392
     C*                                                                   S01392
     C           *IN02     IFEQ '1'                                       S01392
     C           JRDFC     ANDEQ'Y'                                       S01392
     C           *IN03     OREQ '1'                                       S01392
     C           JRDFC     ANDEQ'Y'                                       S01392
1218 C                     Z-ADDZINTR     INTDUE                          S01392
     C                     ELSE                                           S01392
1218 C                     Z-ADDZINTR     INTDUE    H
     C                     END                                            S01392
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDFSPAMT    ZIAMT                                               CAS005
     C                     Z-ADDFROMDT    ZIBEG                                               CAS005
     C                     Z-ADDTODATE    ZIEND                                               CAS005
     C                     Z-ADDZIRATE    WZRATE                                              CAS005
     C           FSLQPS    IFEQ '+'                                                           CAS005
     C                     ADD  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSLQPS    IFEQ '-'                                                           CAS005
     C                     SUB  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     EXSR GLINTC                                                        CAS005
     C                     Z-ADDWZRATE    ZIRATE                                              CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C           JRDFC     ANDEQ'Y'                                                           CAS005
     C           *IN03     OREQ *ON                                                           CAS005
     C           JRDFC     ANDEQ'Y'                                                           CAS005
     C                     Z-ADDZINTR     INTDUN                                              CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDZINTR     INTDUN    H                                         CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
1219 C*
     C/COPY WNCPYSRC,DL0400C038
      *                                                                                       CDL033
      ** If rate change has occurred within the current period,                               CDL033
      ** include interest due up to rate change date in the                                   CDL033
      ** interest due for the current period.                                                 CDL033
      *                                                                                       CDL033
     C           WRCDTF    IFEQ 'Y'                                                           CDL033
     C           CDL033    ANDEQ'Y'                                                           CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           INTDUE    ADD  WKTOTI    INTDUE                                              CDL033
     C                     ELSE                                                               CDL033
     C           INTDUE    ADD  WKINT     INTDUE                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           INTDUN    ADD  WKTOT2    INTDUN                                              CDL033
     C                     ELSE                                                               CDL033
     C           INTDUN    ADD  WKINT2    INTDUN                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    WRCDTF                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
1220 C                     MOVE 'I2'      KEY
     C/COPY WNCPYSRC,DL0400C069
1221 C                     EXSR EVENT
     C/COPY WNCPYSRC,DL0400C070
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE 'I6'      KEY                                                 CAS005
     C                     EXSR EVENT                                                         CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C           *IN03     OREQ *ON                                                           CAS005
     C                     ADD  INTDUN    WTOTIN                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
1222 C   03
1223 COR 02      TOTINT    ADD  INTDUE    TOTINT
1224 C*
1225 C                     ENDSR
1226 C*
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRINTD - Calculate Interest Due at Next Interest Date 2      *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
      *                                                                                       CAS005
     C           SRINTD    BEGSR                                                              CAS005
      *                                                                                       CAS005
      ** Get interest calculated                                                              CAS005
      *                                                                                       CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C                     Z-ADDIACD      ZIBEG                                               CAS005
     C                     ENDIF                                                              CAS005
     C           *IN03     IFEQ *ON                                                           CAS005
     C                     Z-ADDSLID      ZIBEG                                               CAS005
     C                     ENDIF                                                              CAS005
     C           *IN33     IFEQ *OFF                                                          CAS005
     C                     Z-ADDMDAT      ZIEND                                               CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDNIDT      ZIEND                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Use maturity date, if next interest date is greater                                  CAS005
      *                                                                                       CAS005
     C           *IN88     IFEQ *ON                                                           CAS005
     C           NIDT      IFGT MDAT                                                          CAS005
     C                     Z-ADDMDAT      ZIEND                                               CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C                     Z-ADDFSPAMT    ZIAMT                                               CAS005
     C                     ENDIF                                                              CAS005
     C           *IN03     IFEQ *ON                                                           CAS005
     C                     Z-ADDFVAL      ZIAMT                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     Z-ADDZIRATE    WZRATE                                              CAS005
     C           FSLQPS    IFEQ '+'                                                           CAS005
     C                     ADD  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C           FSLQPS    IFEQ '-'                                                           CAS005
     C                     SUB  FSLQPR    ZIRATE                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     EXSR GLINTC                                                        CAS005
     C                     Z-ADDWZRATE    ZIRATE                                              CAS005
      *                                                                                       CAS005
      ** If Loan/Deposit or NA Purchased with Round Down Interest = 'Y'                       CAS005
      *                                                                                       CAS005
     C           *IN02     IFEQ *ON                                                           CAS005
     C           JRDFC     ANDEQ'Y'                                                           CAS005
     C           *IN03     OREQ *ON                                                           CAS005
     C           JRDFC     ANDEQ'Y'                                                           CAS005
     C                     Z-ADDZINTR     INTDUN                                              CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDZINTR     INTDUN    H                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Get interest due for fixed loan/deposit & negotiable assets purchased                CAS005
      *                                                                                       CAS005
     C                     ADD  FSAINN    INTDUN                                              CAS005
     C                     ADD  FSAIAN    INTDUN                                              CAS005
      *                                                                                       CAS005
      ** Exclude this if calculation is for negotiable assets purchased                       CAS005
      *                                                                                       CAS005
     C           *IN03     IFNE *ON                                                           CAS005
     C                     ADD  FSAITN    INTDUN                                              CAS005
     C                     SUB  FSIPRN    INTDUN                                              CAS005
     C                     SUB  FSICTN    INTDUN                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      *                                                                                       CAS005
1227 C********************************************************************
1228 C*    CALCULATE INTEREST DUE AT NEXT INTEREST DATE
1229 C*    BB - FOR FIXED LOANS AND DEPOSITS
1230 C*    CC - FOR NEGOTIABLE ASSETS PURCHASED
1231 C*
1232 C           INTDSR    BEGSR                           *** INTDUE ***
1233 C*
1234 C*    GET INTEREST CALCULATED
1235 C   02                Z-ADDIACD      ZIBEG
1236 C   03                Z-ADDSLID      ZIBEG
1237 C  N33                Z-ADDMDAT      ZIEND
1238 C   33                Z-ADDNIDT      ZIEND
     C/COPY WNCPYSRC,DL0400CP10                                           S01408
     C*    USE MATURITY DATE, IF NEXT INTEREST DATE IS GREATER            AUS003
     C*                                                                   AUS003
     C           *IN88     IFEQ '1'                                       AUS003
     C           NIDT      IFGT MDAT                                      AUS003
     C                     Z-ADDMDAT      ZIEND                           AUS003
     C                     END                                            AUS003
     C                     END                                            AUS003
     C*                                                                   AUS003
1239 C   02                Z-ADDPCPL      ZIAMT
1240 C   03                Z-ADDFVAL      ZIAMT
     C/COPY WNCPYSRC,DL0400C071
1241 C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL0400C072
     C*                                                                   S01392
     C* IF LOAN/DEPOSIT OR NA PURCHASED WITH ROUND DOWN INTEREST = 'Y'    S01392
     C*                                                                   S01392
     C           *IN02     IFEQ '1'                                       S01392
     C           JRDFC     ANDEQ'Y'                                       S01392
     C           *IN03     OREQ '1'                                       S01392
     C           JRDFC     ANDEQ'Y'                                       S01392
1218 C                     Z-ADDZINTR     INTDUE                          S01392
     C                     ELSE                                           S01392
1242 C                     Z-ADDZINTR     INTDUE 130H
     C                     END                                            S01392
     C*                                                                   E37702
     C**   Accrued interest adjustment posted or not posted               E37702
     C**   to be included for negotiable assets purchased                 E37702
1243 C***03******          GOTO ENDDUE                                    E37702
1244 C***********                                                         E37702
1245 C*****GET*INTEREST*DUE*FOR*FIXED*LOAN/DEPOSIT*********************   E37702
     C*                                                                   E37702
     C**   Get interest due for fixed loan/deposit &                      E37702
     C**   negotiable assets purchased                                    E37702
1246 C***********INTDUE    ADD  AITC      INTDUE                          E38730
1247 C           INTDUE    ADD  AIAN      INTDUE
1248 C           INTDUE    ADD  AIAP      INTDUE
1249 C***********INTDUE    SUB  IPRD      INTDUE                          E38730
1250 C***********INTDUE    SUB  ICTD      INTDUE                          E37702
     C*                                                                   E37702
     C**   Exclude this if calculation is for negotiable                  E37702
     C**   assets purchased (*IN03  = 1)                                  E37702
     C**N03******INTDUE    SUB  ICTD      INTDUE                   E37702 E38730
     C           *IN03     IFNE '1'                                       E38730
     C           INTDUE    ADD  AITC      INTDUE                          E38730
     C           INTDUE    SUB  IPRD      INTDUE                          E38730
     C           INTDUE    SUB  ICTD      INTDUE                          E38730
     C                     END                                            E38730
     C/COPY WNCPYSRC,DL0400C039
      *                                                                                       CGL015
     C           CGL015    IFEQ 'Y'                                                           CGL015
     C           BNHKTR    ANDNE0                                                             CGL015
     C                     EXSR CALHKT                                                        CGL015
     C                     ENDIF                                                              CGL015
      *                                                                                       CGL015
1251 C*
1252 C           ENDDUE    ENDSR                           ** ENDDUE TAG *
1253 C*
1254 C********************************************************************
1255 C*
1256 C           DAMCHN    BEGSR                           *** DAMCHN ***
1257 C                     SETOF                     0611
1258 C           DAMKEY    CHAINDEAMS                50
1259 C  N06N11             SETON                     U7U8LR
     C           *IN06     IFEQ '0'                                       CDL006
     C           *IN11     ANDEQ'0'                                       CDL006
     C                     MOVEL'DEAMS'   ERROR                           CDL006
     C                     MOVE DAMKEY    ERROR                           CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,DL0400C046
1260 C                     ENDSR
1261 C*
1262 C********************************************************************
1263 C***                                                                 S01194
1264 C***        TABCHN    BEGSR                           *** TABCHN *** S01194
1265 C***                  SETOF                     07                   S01194
1266 C***        TABKEY    CHAINTABLE                50                   S01194
1267 C***07                SETON                     U7U8LR               S01194
1268 C***                  ENDSR                                          S01194
1269 C***                                                                 S01194
1270 C********************************************************************
1271 C*
1272 C           CLICHN    BEGSR                           *** CLICHN ***
1273 C****                 SETOF                     08                   S01194
1274 C***        CLIKEY    CHAINCLINT                50                   S01194
1275 C**N08                SETON                     U7U8LR               S01194
     C*                                                                   S01194
     C******               CALL 'AOCUSTR0'                         S01194 220738
     C           *LIKE     DEFN BBCUST    ##CUS6                                              CSC042
     C           *LIKE     DEFN BBCUST    ##LCUS                                              CSC042
     C           *LIKE     DEFN ##C01     ##L01                                               CSC042
     C           *LIKE     DEFN ##C02     ##L02                                               CSC042
     C           *LIKE     DEFN ##C03     ##L03                                               CSC042
     C           *LIKE     DEFN ##C04     ##L04                                               CSC042
     C           *LIKE     DEFN ##C05     ##L05                                               CSC042
      *                                                                                       CSC042
     C                     MOVEL@KEY1     ##CUS6                                              CSC042
     C           ##CUS6    IFEQ ##LCUS                                                        CSC042
     C                     MOVEL##L01     ##C01                                               CSC042
     C                     MOVEL##L02     ##C02                                               CSC042
     C                     MOVEL##L03     ##C03                                               CSC042
     C                     MOVEL##L04     ##C04                                               CSC042
     C                     MOVEL##L05     ##C05                                               CSC042
     C                     ELSE                                                               CSC042
     C                     CALL 'AOCUSTR1'                                220738
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           @KEY1  10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C****       SDCUST    PARM SDCUST    DSSDY                    S01194 220738
     C           SDCUST    PARM SDCUST    DSLDY                           220738
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           RECISV    ANDNE'M'                                       164532
     C           BBCLST    ANDNE'Y'                                       220738
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INU8                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVEL'SDCUSTPD'DBFILE           ************   S01194
     C                     MOVE '004'     DBASE            * DBERR 04 *   S01194
     C                     MOVE @OPTN     DBOPTN           ************   S01194
     C                     MOVEL@KEY1     DBKEY            ************   S01194
     C                     ELSE                                                               CSC042
     C                     MOVEL##CUS6    ##LCUS                                              CSC042
     C                     MOVEL##C01     ##L01                                               CSC042
     C                     MOVEL##C02     ##L02                                               CSC042
     C                     MOVEL##C03     ##L03                                               CSC042
     C                     MOVEL##C04     ##L04                                               CSC042
     C                     MOVEL##C05     ##L05                                               CSC042
     C                     END                                            S01194
     C                     END                                                                CSC042
     C*                                                                   S01194
1276 C                     ENDSR                                          S01194
1277 C*
1278 C********************************************************************
1279 C********************************************************************066550
1280 C***********                                                         066550
1281 C*****GLINTC SR. TO CALCULATE INTEREST BETWEEN ANY TWO DAY NUMBERS.  066550
1282 C***********                                                         066550
1283 C*****THIS*VERSION REPLACES THE ORIGINAL GLINTC SR. NOW NAMED        066550
1284 C*****GLINTO.                                                        066550
1285 C***********                                                         066550
1286 C*****CALCULATION METHODS ARE -                                      066550
1287 C*****1**ACTUAL/365                                                  066550
1288 C*****2**ACTUAL/360                                                  066550
1289 C*****3**360/360 (SOMETIMES CALLED 30/360)                           066550
1290 C*****4**365/365 (EXCLUDING 29/02)                                   066550
1291 C*****5**365/360 (EXCLUDING 29/02)                                   066550
1292 C*****6**ACTUAL/366                                                  066550
1293 C***********                                                         066550
1294 C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.                     066550
1295 C***********                                                         066550
1296 C***********                                                         066550
1297 C*R*********GLINTC    BEGSR                           ** GLINTC  **  066550
1298 C***********                                                         066550
1299 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                           066550
1300 C***********          Z-ADDZIBEG     ZIBEG   50       STARTING DATE  066550
1301 C*R*********          Z-ADDZIEND     ZIEND   50       FINISHING DATE 066550
1302 C*R*********          Z-ADDZICALC    ZICALC  10       CALC. BASIS    066550
1303 C*R*********          Z-ADDZIAMT     ZIAMT  150       PRINCIPAL      066550
1304 C*R*********          Z-ADDZIRATE    ZIRATE 117       RATE OF INTRST 066550
1305 C***********                                                         066550
1306 C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED           066550
1307 C*R*********ZIEND     SUB  ZIBEG     ZDAYN1  50                      066550
1308 C***********                                                         066550
1309 C****CHECK*FOR INTEREST CALCULATION BASIS                            066550
1310 C*****USE*OF INDICATRS                                               066550
1311 C*****1,92**2,90  3,91  4,97  5,96  6,95                             066550
1312 C***********          SETOF                     959697               066550
1313 C*R*********ZICALC    COMP 2                    919290               066550
1314 C**N91******          GOTO ZICAL                                     066550
1315 C***********ZICALC    COMP 5                    959796               066550
1316 C***97******ZICALC    COMP 3                    97  91               066550
1317 C***95******                                                         066550
1318 C*R*96******          SETOF                     91                   066550
1319 C**N91******          GOTO ZILPCK                                    066550
1320 C***********                                                         066550
1321 C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WHEN      066550
1322 C*****USING*THE 30/360 BASIS - METHOD 3.                             066550
1323 C***********          EXSR ZSAVE                                     066550
1324 C***********          Z-ADDZIBEG     ZDAYNO                          066550
1325 C***********          EXSR ZDATE2                                    066550
1326 C***********          MOVE ZDAY      ZISD    20                      066550
1327 C***********          MOVE ZMTH      ZISM    20                      066550
1328 C***********          MOVE ZYEAR     ZISY    20                      066550
1329 C***********          Z-ADDZIEND     ZDAYNO                          066550
1330 C***********          EXSR ZDATE2                                    066550
1331 C***********          MOVE ZDAY      ZIFD    20                      066550
1332 C***********          MOVE ZMTH      ZIFM    20                      066550
1333 C***********          MOVE ZYEAR     ZIFY    20                      066550
1334 C***********          EXSR ZRSTOR                                    066550
1335 C***********          SETOF                     93                   066550
0    C****IN*ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEAR IF  066550
     C****ZIEND*IS GREATER THAN ZIBEG,THEN THE DATE ZIEND MUST BE IN A    066550
     C****DIFFERENT CENTURY TO ZIBEG.IF SO ADD 100 YEARS TO IT.           066550
     C***********ZIEND     COMP ZIBEG                93                   066550
     C***93******ZIFY      COMP ZISY                   93                 066550
     C***********          Z-ADDZISY      ZISY2   30                      066550
     C**N93******          Z-ADDZIFY      ZIFY2   30                      066550
     C***93******ZIFY      ADD  100       ZIFY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*START*YEAR*IS*A*LEAP*YEAR*AND*IF*START*S01147066550
     C*****MONTH*IS*FEBRUARY.***************************************S01147066550
     C***********                                                   S01147066550
     C**N98******          BITOF'0'       ZGLBIT  1           E80945S01147066550
     C***98******          BITON'0'       ZGLBIT              E80945S01147066550
     C***********ZISY2     ADD  1900      ZLYCHK  40                S01147066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01147066550
     C***********          MVR            ZLYREM  20               S01147 066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YES01147 066550
     C***********ZISM      COMP 2                        99*FEBRUARS01147 066550
2209 C**N99******30        SUB  ZISD      ZID1    50   93          S01147 066550
2210 C**N99*93***          Z-ADD0         ZID1                     S01147 066550
     C***99N98***28        SUB  ZISD      ZID1                     S01147 066550
     C***99*98***29        SUB  ZISD      ZID1                     S01147 066550
2209 C***********30        SUB  ZISD      ZID1    50   93          S01147 066550
2210 C***93******          Z-ADD0         ZID1                      S01147066550
2211 C***********ZISM      COMP 12                       93               066550
2212 C***93******          Z-ADD0         ZISM                            066550
2213 C***93******ZISY      ADD  1         ZISY                            066550
     C***93******ZISY2     ADD  1         ZISY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*END*YEAR*IS*A*LEAP*YEAR*AND*IF*END*MONTH*****S01147
     C*****IS*FEBRUARY.***************************************************S01147
     C***********                                                   S01147066550
     C***********ZIFY2     ADD  1900      ZLYCHK  40               S01147 066550
     C***********ZLYCHK    DIV  4         ZLYCHK                   S01147 066550
     C***********          MVR            ZLYREM  20               S01147 066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YES01147 066550
     C***********ZIFM      COMP 2                        99*FEBRUARS01147 066550
2214 C**N99******ZIFD      COMP 31                       93        S01147 066550
2214 C***99N98***ZIFD      COMP 28                       93        S01147 066550
2214 C***99*98***ZIFD      COMP 29                       93        S01147 066550
     C***********          SETOF                     98       E80945S01147066550
     C***********          TESTB'0'       ZGLBIT         98   E80945S01147066550
2214 C***********ZIFD      COMP 31                       93         S01147066550
1342 C***93******ZID1      ADD  30        ZID1                            066550
1343 C**N93******ZID1      ADD  ZIFD      ZID1                            066550
1344 C***********ZIFM      SUB  1         ZIFM                            066550
     C***********ZISY      COMP ZIFY                     93               066550
1346 C***93******ZIFM      SUB  ZISM      ZINOM   30                      066550
1347 C***93******          GOTO ZIOUT                                     066550
1348 C***********12        SUB  ZISM      ZIM1    20                      066550
1349 C***********          Z-ADD1         ZISM                            066550
     C*****USE*ENLARGED FIELDS THAT CAN HANDLE 1999 ONWARDS               066550
     C***********ZISY2     ADD  1         ZISY2                           066550
     C***********ZIFY2     SUB  ZISY2     ZIY1    20                      066550
1352 C***********ZIY1      MULT 12        ZIM2    30                      066550
1353 C***********ZIM2      ADD  ZIFM      ZIM2                            066550
1354 C***********ZIM1      ADD  ZIM2      ZINOM                           066550
1355 C***********ZIOUT     TAG                             * ZIOUT TAG *  066550
1356 C***********ZINOM     MULT 30        ZID2    50                      066550
1357 C***********ZID2      ADD  ZID1      ZDAYN1                          066550
1358 C***********          SETOF                     93                   066550
1359 C***********ZILPCK    TAG                             * ZILPCK TAG * 066550
1360 C**N96N97***          GOTO ZICAL                                     066550
1361 C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.         066550
1362 C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB   066550
1363 C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, & ZIEND.066550
1364 C***********                                                         066550
1365 C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                        066550
1366 C***********ZDAYN1    DIV  1461      ZIMAN   20                      066550
1367 C***********          MVR            ZIREM   50                      066550
1368 C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.                    066550
1369 C***********ZIBEG     SUB  60        ZIBW1   50                      066550
1370 C***********ZIBW1     DIV  1461      ZIDW1   20                      066550
1371 C***********          MVR            ZIDREM  50                      066550
1372 C***********ZIDREM    COMP 0                        94               066550
1373 C***94******          Z-ADDZIBEG     ZIDW2   50                      066550
1374 C***94******          GOTO ZILP1                                     066550
1375 C*****ROUND*UP RESULT                                                066550
1376 C***********ZIDW1     ADD  1         ZIDW2                           066550
1377 C*****CALCULATE NEXT 29 FEB.                                         066550
1378 C***********ZIDW2     MULT 1461      ZIDW2                           066550
1379 C***********ZIDW2     ADD  60        ZIDW2                           066550
1380 C***********ZILP1     TAG                             * ZILP1 TAG *  066550
1381 C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO        066550
1382 C*****ZIREM*THEN ADD 1 TO ZIMAN.                                     066550
1383 C***********ZIDW2     SUB  ZIBEG     ZILPCP  50                      066550
1384 C***********ZIREM     COMP ZILPCP               94  94               066550
1385 C***94******ZIMAN     ADD  1         ZIMAN                           066550
1386 C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1             066550
1387 C*****REQUIRED FOR THIS INTEREST CALCULATION.                        066550
1388 C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                          066550
1389 C***********          SETOF                     94                   066550
1390 C***********ZICAL     TAG                             * ZICAL TAG *  066550
1391 C***********                                                         066550
1392 C****CALCULATE INTEREST                                              066550
1393 C***90******                                                         066550
1394 C*R*91******                                                         066550
1395 C*R*96******ZIAMT     DIV  36000     ZIWRK1 155H                     066550
1396 C***92******                                                         066550
1397 C*R*97******ZIAMT     DIV  36500     ZIWRK1    H                     066550
1398 C***95******ZIAMT     DIV  36600     ZIWRK1    H                     066550
1399 C*R*********ZIWRK1    MULT ZIRATE    ZIWRK2 155H                     066550
1400 C*R*********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF INTRST 066550
1401 C***********                                                         066550
1402 C***********          SETOF                     909192               066550
1403 C***********          SETOF                     959697               066550
1404 C*R*********          ENDSR                                          066550
1405 C***********                                                         066550
1406 C********************************************************************066550
1407 C********************************************************************
1408 C**
1409 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS
1410 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.
1411 C**
1412 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS
1413 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.
1414 C**
1415 C           ZSAVE     BEGSR                           *** ZSAVE ***
1416 C**
1417 C                     BITOF'01234567'ZBITS   1
1418 C   90                BITON'0'       ZBITS
1419 C   91                BITON'1'       ZBITS
1420 C   92                BITON'2'       ZBITS
1421 C   93                BITON'3'       ZBITS
1422 C   94                BITON'4'       ZBITS
1423 C   95                BITON'5'       ZBITS
1424 C   96                BITON'6'       ZBITS
1425 C   97                BITON'7'       ZBITS
1426 C**
1427 C                     SETOF                     909192
1428 C                     SETOF                     939495
1429 C                     SETOF                     9697
1430 C**
1431 C                     ENDSR
1432 C**
1433 C**
1434 C********************************************************************
1435 C**
1436 C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS
1437 C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.
1438 C**
1439 C           ZRSTOR    BEGSR                           *** ZRSTOR ***
1440 C**
1441 C                     TESTB'0'       ZBITS          90
1442 C                     TESTB'1'       ZBITS          91
1443 C                     TESTB'2'       ZBITS          92
1444 C                     TESTB'3'       ZBITS          93
1445 C                     TESTB'4'       ZBITS          94
1446 C                     TESTB'5'       ZBITS          95
1447 C                     TESTB'6'       ZBITS          96
1448 C                     TESTB'7'       ZBITS          97
1449 C**
1450 C                     ENDSR
1451 C**
1452 C**
1453 C********************************************************************
1454 C***                                                                 S01194
1455 C********TE5 SR. TO DE****INE ***A DAY N**BER D**E IS A HOLIDAY      S01194
1456 C***             IN GIVEN CURRENCY, AND, IF DAY IS A HOLIDAY         S01194
1457 C***             AND IF REQUIRED, DETERMINE NEXT WORKING DAY.        S01194
1458 C***                                                                 S01194
1459 C*************ATE5    BEGSR                           *** ZDATE5 *** S01194
1460 C****                                                                S01194
1461 C**** CALCULATIONS TO DEFINE INPUT FIELDS.                           S01194
1462 C***                  Z-ADDZDAYNO    ZDAYNO  50                      S01194
1463 C***                  MOVE ZCCY      ZCCY    3                       S01194
1464 C***                  MOVE ZOPT      ZOPT    1                       S01194
1465 C***                                                                 S01194
1466 C***  CALCULATIONS TO DEFINE/CLEAR WORKFIELDS.                       S01194
1467 C***                  MOVE '   '     ZHC                             S01194
1468 C***                                                                 S01194
1469 C***  RESET INDICATOR.                                               S01194
1470 C***                  SETOF                     99                   S01194
1471 C****                                                                S01194
1472 C*****CALCULATION TO DEFINE/SET OUTPUT FIELD.                        S01194
1473 C***                  Z-ADDZDAYNO    ZDYNBR  50                      S01194
1474 C***                                                                 S01194
1475 C***  DETERMINE IF HOLIDAY                                           S01194
1476 C***        ZDHOL     TAG                             ** ZDHOL TAG **S01194
1477 C***                  SETOF                     91                   S01194
1478 C***                                                                 S01194
1479 C***  SET KEY FOR FIRST HOLIDAY RECORD.                              S01194
1480 C***                  MOVEL'22      'ZTABKY 12                       S01194
1481 C***                  MOVELZDYNBR    ZWRK6   6                       S01194
1482 C***                  MOVE '1'       ZWRK6                           S01194
1483 C***                  MOVE ZWRK6     ZTABKY                          S01194
1484 C***                                                                 S01194
1485 C***  CHAIN FOR HOLIDAY RECORD, RECORD 1 OR 2.                       S01194
1486 C***        ZDHCH5    TAG                             ** ZDHCH5 TAG *S01194
1487 C***        ZTABKY    CHAINTABLE                90    ON NOT THERE   S01194
1488 C***90      RECI      COMP 'D'                  9090  DELETED        S01194
1489 C***                                                                 S01194
1490 C***  STORE CURRENCIES IF RECORD FOUND.                              S01194
1491 C***90N91             MOVEAHCCY      ZHC,1                           S01194
1492 C***91N90             MOVEAHCCY      ZHC,26                          S01194
1493 C***                                                                 S01194
1494 C***  GET SECOND RECORD, IF NOT ALREADY DONE.                        S01194
1495 C***                  MOVE ZTABKY    ZWRK1   10                      S01194
1496 C***        ZWRK1     COMP 1                        91               S01194
1497 C***                  MOVE '2'       ZTABKY                          S01194
1498 C***91N90             GOTO ZDHCH5                                    S01194
1499 C***                                                                 S01194
1500 C***  BYPASS TO END IF NO FIRST RECORD FOUND.                        S01194
1501 C***90 91             GOTO ZDEND5                                    S01194
1502 C***                                                                 S01194
1503 C***  DETERMINE HOLIDAY RECORD TYPE.                                 S01194
1504 C***        INEX      COMP 'E'                      92               S01194
1505 C****       INEX      COMP 'I'                      93               S01194
1506 C***                                                                 S01194
1507 C***  CHECK IF CURRENCY ON HOLIDAY.                                  S01194
1508 C***        ZCCY      LOKUPZHC                      94               S01194
1509 C***                                                                 S01194
1510 C***  BYPASS TO END IF NOT HOLIDAY FOR CURRENCY.                     S01194
1511 C***92 94                                                            S01194
1512 C***93N94             GOTO ZDEND5                                    S01194
1513 C***                                                                 S01194
1514 C***  SET INDICATOR FOR HOLIDAY FOR DAY NUMBER.                      S01194
1515 C***                  SETON                     99                   S01194
1516 C***                                                                 S01194
1517 C***                                                                 S01194
1518 C***  CHECK IF NEXT WORKING DAY REQUIRED.                            S01194
1519 C***        ZOPT      COMP 'Y'                      95               S01194
1520 C***95      ZDYNBR    ADD  1         ZDYNBR                          S01194
1521 C***95                GOTO ZDHOL                                     S01194
1522 C***                                                                 S01194
1523 C***                                                                 S01194
1524 C********** ZDEND5 ***ENDSR *******************************ND5 ENDSR*S01194
1611 C**
1612 C******FREQB-SR. TO INCREMENT A DAY NUMBER DATE BY A                 S01194
1612 C*****FREQB-SR.*TO*INCREMENT*A DAY*NUMBER*DATE*BY A            S01194DT0206
1613 C***************PERIOD VALUE DETERMINED BY A CODE.                   DT0206
1614 C*********************                                               DT0206
1615 C***********ZFREQB****BEGSR                           *** ZFREQB01194DT0206
1615 C***********FREQB*****BEGSR                           *** FREQBS01194DT0206
1616 C*********************                                               DT0206
1617 C*****CALCULATIONS*TO*DEFINE/CLEAR*FIELDS.                           DT0206
1618 C*********************MOVE ZFREQ     ZFREQ   1                       DT0206
1619 C*********************Z-ADDZDAYNO    ZDAYNO  50                      DT0206
1620 C*********************Z-ADDZMDAY     ZMDAY   20                      DT0206
1621 C*********************MOVE ZCCY      ZCCY    3                       DT0206
1622 C*********************                                               DT0206
1623 C*********************MOVE '   '     ZHC                             S01194
1624 C*********************MOVE ' '       ZTABKY 12                       S01194
1625 C*********************                                               DT0206
1626 C*************FIELDS*USED FOR PERIOD CODES M,T,Q,X,Y                 DT0206
1627 C*********************                                               DT0206
1628 C*********************MOVE '  '      ZINDE   2                       DT0206
1629 C*********************Z-ADD0         ZINTO   20                      DT0206
1630 C*********************                                               DT0206
1631 C*****CONVERT*DAY*NUMBER*TO DATE.                                    DT0206
1632 C*********************EXSR ZDATE2                                    DT0206
1633 C*********************SETOF                     90                   DT0206
1634 C*********************                                               DT0206
1635 C*****CHECK*FOR*AND*INCREMENT FOR CODE D-DAILY-WORKING DAY.          DT0206
1636 C***********ZFREQ*****COMP 'D'                      91               DT0206
1637 C***91******ZDAYNO****ADD  1         ZDAYNO                          DT0206
1638 C***91****************GOTO ZFHCHK                                    DT0206
1639 C*********************                                               DT0206
1640 C*****CHECK*FOR*AND*INCREMENT FOR CODE W-WEEKLY.                     DT0206
1641 C***********ZFREQ*****COMP 'W'                      91               DT0206
1642 C***91******ZDAYNO****ADD  7         ZDAYNO                          DT0206
1643 C***91****************GOTO ZFEND                                     DT0206
1644 C*********************                                               DT0206
1645 C*****CHECK*FOR*AND*INCREMENT FOR CODE F-FORTNIGHTLY.                DT0206
1646 C***********ZFREQ*****COMP 'F'                      91               DT0206
1647 C***91******ZDAYNO****ADD  14        ZDAYNO                          DT0206
1648 C***91****************GOTO ZFEND                                     DT0206
1649 C*********************                                               DT0206
1650 C*****CHECK*FOR*AND*INCREMENT FOR CODE S-SEMI-MONTHLY.               DT0206
1651 C***********ZFREQ*****COMP 'S'                      91               DT0206
1652 C***91******ZDAY******COMP 15                   939292               DT0206
1653 C***91*92*************Z-ADD31        ZDAY                            DT0206
1654 C***91*93*************Z-ADD15        ZDAY                            DT0206
1655 C***91*93***ZMTH******ADD  1         ZMTH                            DT0206
1656 C***91****************GOTO ZFDATE                                    DT0206
1657 C*********************                                               DT0206
1658 C*****CHECK*FOR*AND*INCREMENT FOR CODE M-MONTHLY.                    DT0206
1659 C***********ZFREQ*****COMP 'M'                      91               DT0206
1660 C***91****************MOVE 'IN'      ZINDE                           DT0206
1661 C***91****************Z-ADDZMDAY     ZDAY                            DT0206
1662 C***91******ZMTH******ADD  1         ZMTH                            DT0206
1663 C***91****************GOTO ZFDATE                                    DT0206
1664 C*********************                                               DT0206
1665 C*****CHECK*FOR*AND*INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTHDT0206
1666 C***********ZFREQ*****COMP 'R'                      91               DT0206
1667 C***91****************Z-ADD31        ZDAY                            DT0206
1668 C***91******ZMTH******ADD  1         ZMTH                            DT0206
1669 C***91****************GOTO ZFDATE                                    DT0206
1670 C*********************                                               DT0206
1671 C*****CHECK*FOR*AND*INCREMENT FOR CODE T-BIMONTHLY.                  DT0206
1672 C***********ZFREQ*****COMP 'T'                      91               DT0206
1673 C***91****************MOVE 'IN'      ZINDE                           DT0206
1674 C***91****************Z-ADDZMDAY     ZDAY                            DT0206
1675 C***91******ZMTH******ADD  2         ZMTH                            DT0206
1676 C***91****************GOTO ZFDATE                                    DT0206
1677 C*********************                                               DT0206
1678 C*****CHECK*FOR*AND*INCREMENT FOR CODE Q-QUARTERLY.                  DT0206
1679 C***********ZFREQ*****COMP 'Q'                      91               DT0206
1680 C***91****************MOVE 'IN'      ZINDE                           DT0206
1681 C***91****************Z-ADDZMDAY     ZDAY                            DT0206
1682 C***91******ZMTH******ADD  3         ZMTH                            DT0206
1683 C***91****************GOTO ZFDATE                                    DT0206
1684 C*********************                                               DT0206
1685 C*****CHECK*FOR*AND*INCREMENT FOR CODE X-SIX MONTHLY.                DT0206
1686 C***********ZFREQ*****COMP 'X'                      91               DT0206
1687 C***91****************MOVE 'IN'      ZINDE                           DT0206
1688 C***91****************Z-ADDZMDAY     ZDAY                            DT0206
1689 C***91******ZMTH******ADD  6         ZMTH                            DT0206
1690 C***91****************GOTO ZFDATE                                    DT0206
1691 C*********************                                               DT0206
1692 C*****CHECK*FOR*AND*INCREMENT FOR CODE Y-YEARLY.                     DT0206
1693 C***********ZFREQ*****COMP 'Y'                      91               DT0206
1694 C***91****************MOVE 'IN'      ZINDE                           DT0206
1688 C***91****************Z-ADDZMDAY     ZDAY                            DT0206
1695 C***91******ZYEAR*****ADD  1         ZYEAR                           DT0206
1696 C***91****************GOTO ZFDATE                                    DT0206
1697 C*********************                                               DT0206
1698 C*****CHECK*FOR*AND*INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH. DT0206
1699 C***********ZFREQ*****COMP 'L'                      91               DT0206
1700 C***91****************Z-ADD31        ZDAY                            DT0206
1701 C***91******ZMTH******ADD  1         ZMTH                            DT0206
1702 C***91****************GOTO ZFDATE                                    DT0206
1703 C*********************                                               DT0206
1704 C*****CHECK*FOR*AND*INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.  DT0206
1705 C***********ZFREQ*****COMP 'B'                      91               DT0206
1706 C***91****************Z-ADD31        ZDAY                            DT0206
1707 C***91******ZMTH******ADD  1         ZMTH                            DT0206
1708 C***91****************GOTO ZFDATE                                    DT0206
1709 C*********************                                               DT0206
1710 C*****CHECK*FOR*AND*INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.DT0206
1711 C***********ZFREQ*****COMP 'A'                      91               DT0206
1712 C***91****************MOVEL'01    '  ZTABKY                          DT0206
1713 C***91****************MOVE '    11'  ZTABKY                          DT0206
1714 C***91******ZTABKY****CHAINTABLE                99    ON NOT THERE   DT0206
1715 C***99******RECI******COMP '*'                      99         S01194DT0206
1649 C*********************                                         S01194DT0206
1649 C************IN91*****IFEQ '1'                                 S01194DT0206
1649 C*********************                                         S01194DT0206
1649 C*********************CALL 'AOGELRR0'                          S01194DT0206
1649 C*********************PARM '*MSG   ' @RTCD                     S01194DT0206
1649 C*********************PARM '*FIRST ' @OPTN                     S01194DT0206
1649 C***********SDGELR****PARM SDGELR    DSFDY                     S01194DT0206
1649 C*********************                                         S01194DT0206
1649 C***********@RTCD*****IFNE *BLANK                              S01194DT0206
1649 C*********************SETON                     U7U8LR         S01194DT0206
1649 C*********************MOVEL'SDGELRPD'DBFILE           *********S01194DT0206
1649 C*********************MOVE '007'     DBASE            * DBERR 0S01194DT0206
1649 C*********************MOVEL@OPTN     DBOPTN           *********S01194DT0206
1649 C*********************MOVEL@OPTN     DBKEY                     S01194DT0206
1649 C*********************END                                      S01194DT0206
1649 C*********************                                         S01194DT0206
1716 C***91N99*************Z-ADDAPDA      ZDAYNO                    S01194DT0206
1716 C*********************Z-ADDBKAPDT    ZDAYNO                    S01194DT0206
1649 C*********************END                                      S01194DT0206
1717 C*********************                                               DT0206
1718 C*****BYPASS*IF*ZFREQ*IS 'A' OR ANY OTHER VALUE                      DT0206
1719 C*********************GOTO ZFEND                                     DT0206
1720 C*********************                                               DT0206
1721 C*********************                                               DT0206
1722 C*****REFORMAT*DATE*AND ENSURE VALID.                                DT0206
1723 C***********ZFDATE****TAG                             ** ZFDATE TAG* DT0206
1724 C*********************                                               DT0206
1725 C*****VALIDATE*MONTH.*                                               DT0206
1726 C***********ZMTH******COMP 12                   91                   DT0206
1727 C***91******ZMTH******SUB  12        ZMTH                            DT0206
1728 C***91******ZYEAR*****ADD  1         ZYEAR                           DT0206
1729 C*********************                                               DT0206
1730 C*****CHECK*FOR*LEAP*YEAR.                                           DT0206
1731 C***********ZYEAR*****DIV  4         ZLYR    20                      DT0206
1732 C*********************MVR            ZLY     10     92LEAP YEAR-92 ONDT0206
1733 C*********************                                               DT0206
1734 C*****VALIDATE*DAY*NUMBER.                                           DT0206
1735 C*********************MOVE ZFMD,ZMTH ZWRK2   20                      DT0206
1736 C***********ZMTH******COMP 2                        93               DT0206
1737 C***92*93*************Z-ADD29        ZWRK2                           DT0206
1738 C*********************                                               DT0206
1739 C***********ZDAY******COMP ZWRK2                94                   DT0206
1740 C***94****************Z-ADDZWRK2     ZDAY                            DT0206
1741 C*********************                                               DT0206
1742 C*****CHECK*IF*CODE*R, TO SUBTRACT 6 DAYS.                           DT0206
1743 C***********ZFREQ*****COMP 'R'                      91               DT0206
1744 C***91******ZDAY******SUB  6         ZDAY                            DT0206
1745 C*********************                                               DT0206
1746 C*****REFORMAT*DATE,*DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.    DT0206
1747 C*********************MOVELZDAY      ZWRK4   40                      DT0206
1748 C*********************MOVE ZMTH      ZWRK4                           DT0206
1749 C***98****************MOVELZMTH      ZWRK4                           DT0206
1750 C***98****************MOVE ZDAY      ZWRK4                           DT0206
1751 C*********************MOVELZWRK4     ZDATE                           DT0206
1752 C*********************MOVE ZYEAR     ZDATE                           DT0206
1753 C*********************EXSR ZDATE1                                    DT0206
1754 C*********************                                               DT0206
1755 C*****CHECK*IF*CODE*B, OR M,T,Q,X,Y TO BE CHECKED FOR HOLIDAY.       DT0206
1756 C***********ZFREQ*****COMP 'B'                      91               DT0206
1757 C***********ZINDE*****COMP 'IN'                     92               DT0206
1758 C***92N99*************                                               DT0206
1759 C*OR*91N99*************GOTO ZFHCHK                                   DT0206
1760 C*********************                                               DT0206
1761 C*********************GOTO ZFEND                                     DT0206
1762 C*********************                                               DT0206
1763 C*****CHECK*IF*DAY*NUMBER IS A HOLIDAY.                              DT0206
1764 C*********************                                               DT0206
1765 C***********ZFHCHK****TAG                             ** ZFHCHK TAG *DT0206
1766 C*********************SETOF                     94                   DT0206
1767 C***********ZFREQ*****COMP 'D'                      91               DT0206
1768 C***********ZFREQ*****COMP 'B'                      92               DT0206
1769 C***91****************                                               DT0206
1770 C*OR*92****************GOTO ZSETK                                    DT0206
1771 C*********************                                               DT0206
1772 C****FOR*CODES*M,T,Q,X,Y, CHECK ZINDE - 'IN' TO INCREMENT,           DT0206
1773 C*********************                - 'DE' TO DECREMENT            DT0206
1774 C*********************                                               DT0206
1775 C***********ZINDE*****COMP 'IN'                     90               DT0206
1776 C***********ZINDE*****COMP 'IN'                     91               DT0206
1777 C***********ZINDE*****COMP 'DE'                     92               DT0206
1778 C*********************                                               DT0206
1779 C*******T*KEY*FOR*FIRST HOLIDAY RECORD.                              DT0206
1780 C***********ZSETK*****TAG                             ** ZSETK TAG **DT0206
1781 C*********************MOVEL'22    '  ZTABKY                          DT0206
1782 C*********************MOVELZDAYNO    ZWRK6   6                       DT0206
1783 C*********************MOVE 1         ZWRK6                           DT0206
1784 C*********************MOVE ZWRK6     ZTABKY                          DT0206
1785 C*********************                                               DT0206
1786 C*****GET*HOLIDAY*RECORD.                                            DT0206
1787 C***********ZFHCHN****TAG                             ** ZFHCHN TAG* S01194
1788 C***********ZTABKY****CHAINTABLE                93    ON NOT THERE   DT0206
1789 C***93******RECI******COMP '*'                      93               DT0206
1649 C***94****************MOVE '   '     ZHC                             DT0206
1792 C***94N93*************MOVEAHCCY      ZHC,1                           DT0206
1793 C***94N93*************MOVEAHCCY      ZHC,26                          DT0206
1794 C*********************                                               DT0206
1795 C*******T*SECOND*RECORD, IF NOT ALREADY DONE.                        DT0206
1796 C*********************MOVE ZTABKY    ZWRK1N  10                      DT0206
1797 C***********ZWRK1N****COMP 1                        94               DT0206
1798 C*********************MOVE '2'       ZTABKY                          DT0206
1799 C****4N93*************GOTO ZFHCHN                                    DT0206
1800 C*********************                                               DT0206
1801 C*****BYPASS*TO*END*IF NO FIRST RECORD FOUND.                        DT0206
1802 C******94*************GOTO ZFEND                                     DT0206
1649 C*********************                                         S01195DT0206
1649 C*********************EXSR ZCHKH                               S01195DT0206
1803 C*********************                                               DT0206
1804 C*****DETERMINE*HOLIDAY RECORD TYPE.                                 DT0206
1805 C***********INEX******COMP 'E'                      95         S01195DT0206
1806 C***********INEX******COMP 'I'                      96         S01195DT0206
1807 C*********************                                               DT0206
1808 C*****CHECK*IF*CURRENCY ON HOLIDAY.                                  DT0206
1809 C***********ZCCY******LOKUPZHC                      97               S01195
1809 C***********ZIND******CABEQ'W'       ZFEND                     S01195DT0206
1810 C*********************                                               DT0206
1811 C*****BYPASS*IF*NOT*HOLIDAY FOR CURRENCY.                            DT0206
1812 C***95*97*************                                EXCLUDE FOUND  S01195
1813 C***96N97*************GOTO ZFEND                      INCL. NOT FOUNDS01195
1814 C*********************                                               DT0206
1815 C*********************                                               DT0206
1816 C***92****************GOTO ZDECR                                     DT0206
1817 C*********************                                               DT0206
1818 C*****INCREMENT*OR*DECREMENT DAY NUMBER AS REQUIRED.                 DT0206
1819 C***91******ZDAYNO****ADD  1         ZDAYNO                          DT0206
1820 C*********************                                               DT0206
1821 C*****ONLY*FOR*PERIOD*CODE = M,T,Q,X OR Y, IF INCREMENTATION         DT0206
1822 C*****TAKES*THE*OUTPUT DATE INTO THE FOLLOWING MONTH, RETURN TO      DT0206
1823 C*****THE*INPUT*DATE*AND DECREMENT - 92 ON.                          DT0206
1824 C*********************                                               DT0206
1825 C***90*91***ZINTO*****ADD  1         ZINTO                           DT0206
1826 C***90*91***ZINTO*****ADD  ZDAY      ZINTOT  20                      DT0206
1827 C***90*91*************MOVE ZINTOT    ZINTOA  2                       DT0206
1649 C**TO*ALLOW*29*FEB*ON*LEAP YEARS TO PASS                             DT0206
1649 C*********************SETOF                     93                   DT0206
1649 C***90*91***ZYEAR*****DIV  4         ZLYR                            DT0206
1649 C***90*91*************MVR            ZLY            92               DT0206
1649 C***90*91*92ZMTH******COMP 2                        93               DT0206
1649 C***93******ZINTOA****COMP '29'                 92                   DT0206
1649 C***90*91N93ZINTOA****COMP ZFMD,ZMTH            92                   DT0206
1829 C***90*91*92ZDAYNO****SUB  ZINTO     ZDAYNO                          DT0206
1830 C***90*91*92**********MOVE 'DE'      ZINDE                           DT0206
1831 C*********************                                               DT0206
1832 C***********ZDECR*****TAG                             ** ZDECR TAG **DT0206
1833 C***92*95N97**********                                EXCL. NOT FOUNDDT0206
1834 C*OR*92*96*97ZDAYNO****SUB 1         ZDAYNO           INCLUDE FOUND  DT0206
1835 C*********************GOTO ZFHCHK                                    DT0206
1836 C*********************                                               DT0206
1837 C*********************                                               DT0206
1838 C***********ZFEND*****ENDSR                           * ZFEND ENDSR *DT0206
1839 C*********************                                               DT0206
1840 C********************************************************************
     C/COPY WNCPYSRC,DL0400C104
      /COPY ZSRSRC,ZFREQBZ2                                               DT0206
     C/COPY WNCPYSRC,DL0400C093
1841 C**
1842 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
1843 C**              CONVERT TO A NUMBER OF DAYS.
1844 C**
1845 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
1846 C**
1847 C           ZDATE1    BEGSR                           *** ZDATE1 ***
1848 C**
1849 C**   CLEAR DAY NUMBER.
1850 C                     Z-ADD0         ZDAYNO  50
1851 C**
1852 C**   CALCULATION TO DEFINE INPUT DATE FIELD.
1853 C                     Z-ADDZDATE     ZDATE   60
1854 C**
1855 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
1856 C                     MOVE ZDATE     ZYEAR   20
1857 C  N98                MOVELZDATE     ZDAY    20
1858 C   98                MOVELZDATE     ZMTH    20
1859 C                     MOVE ZDATE     ZWRK4   40
1860 C  N98                MOVELZWRK4     ZMTH
1861 C   98                MOVELZWRK4     ZDAY
1862 C**
1863 C**   ENSURE MONTH IS VALID.
1864 C           ZMTH      COMP 0                      9999
1865 C  N99      ZMTH      COMP 12                   99
1866 C   99                GOTO ZDEND1                     BYPASS IF ERROR
1867 C**
1868 C**   CHECK FOR 30 DAY MONTHS.
1869 C           ZMTH      COMP 4                        90IF 90 ON, 30
1870 C  N90      ZMTH      COMP 6                        90DAY MONTH.
1871 C  N90      ZMTH      COMP 9                        90
1872 C  N90      ZMTH      COMP 11                       90
1873 C**
1874 C**   ENSURE DAY IS VALID.
1875 C           ZDAY      COMP 0                      9999
1876 C   90N99   ZDAY      COMP 30                   99
1877 C  N90N99   ZDAY      COMP 31                   99
1878 C   99                GOTO ZDEND1                     BYPASS IF ERROR
1879 C**
1880 C**   CHECK FOR LEAP YEAR AND FEBRUARY.
1881 C           ZYEAR     ADD  28        ZYEAR
1882 C           ZYEAR     DIV  4         ZLYR    20
1883 C                     MVR            ZLY     10     91LEAP YR, 91 ON
1884 C           ZMTH      COMP 2                    93  92FEB., 92 ON
1885 C**                                                   PAST FEB, 93 ON
1886 C**   IF FEBUARY FURTHER VALIDATE DAY.
1887 C  N91 92   ZDAY      COMP 28                   99
1888 C   91 92   ZDAY      COMP 29                   99
1889 C   99                GOTO ZDEND1                     BYPASS IF ERROR
1890 C**
1891 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
1892 C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
1893 C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
1894 C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
1895 C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
1896 C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
1897 C**
1898 C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
1899 C**
1900 C**
1901 C********************************************************************
1902 C**
1903 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
1904 C**
1905 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
1906 C**
1907 C           ZDATE2    BEGSR                           *** ZDATE2 ***
1908 C**
1909 C**   CLEAR DATE FIELDS.
1910 C                     Z-ADD0         ZDATE   60
1911 C                     MOVEL'       ' ZADATE  7
1912 C**
1913 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
1914 C                     Z-ADDZDAYNO    ZDAYNO  50
1915 C**
1916 C**   DETERMINE YEAR NUMBER.
1917 C**
1918 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
1919 C           ZDAYNO    SUB  1         ZDAYN1  50   99
1920 C   99                GOTO ZDEND2
1921 C**
1922 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
1923 C           ZDAYN1    DIV  1461      ZLYR    20
1924 C                     MVR            ZDAYN1           SAVE REMAINING
1925 C**                                                   DAYS
1926 C**   CALCULATE NUMBER OF REMAINING YEARS.
1927 C                     Z-ADD1         ZWRK2   20
1928 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
1929 C           ZDAYN1    COMP ZYDY,ZWRK2             90
1930 C  N90      ZWRK2     ADD  1         ZWRK2
1931 C  N90                GOTO ZDTAG1
1932 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
1933 C**
1934 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
1935 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
1936 C**
1937 C**   CALCULATE ACTUAL YEAR NUMBER.
1938 C           ZLYR      MULT 4         ZWRK3   30
1939 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
1940 C                     Z-ADDZWRK3     ZYEAR   20
1941 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
1942 C**
1943 C**   DETERMINE MONTH NUMBER.
1944 C**
1945 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
1946 C                     SETOF                     9293
1947 C   91      ZDAYN1    COMP 59                     9293
1948 C   91N92   ZDAYN1    SUB  1         ZDAYN1
1949 C**
1950 C**   CALCULATE MONTH NUMBER.
1951 C                     Z-ADD2         ZWRK2
1952 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
1953 C           ZDAYN1    COMP ZMDY,ZWRK2             94
1954 C  N94      ZWRK2     ADD  1         ZWRK2
1955 C  N94                GOTO ZDTAG2
1956 C           ZWRK2     SUB  1         ZWRK2
1957 C**
1958 C                     Z-ADDZWRK2     ZMTH    20       MONTH
1959 C**
1960 C**   DETERMINE DAY OF MONTH.
1961 C**
1962 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
1963 C           ZDAYN1    ADD  1         ZDAYN1
1964 C**
1965 C**   CALCULATE DAY OF MONTH.
1966 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
1967 C**
1968 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
1969 C   93      ZDAY      ADD  1         ZDAY
1970 C**
1971 C**   FORMAT DATE, DDMMYY OR MMDDYY.
1972 C  N98                MOVELZDAY      ZWRK4   40
1973 C   98                MOVE ZDAY      ZWRK4
1974 C  N98                MOVE ZMTH      ZWRK4
1975 C   98                MOVELZMTH      ZWRK4
1976 C                     MOVELZWRK4     ZDATE
1977 C                     MOVE ZYEAR     ZDATE
1978 C**
1979 C**   FORMAT ALPHA DATE, DDMMMYY.
1980 C           ZDAY      COMP 10                     95
1981 C                     MOVELZDAY      ZWRK5   5
1982 C   95                MOVEL' '       ZWRK5
1983 C                     MOVE ZMNM,ZMTH ZWRK5
1984 C                     MOVELZWRK5     ZADATE
1985 C                     MOVE ZYEAR     ZADATE
1986 C**
1987 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
1988 C**
1989 C**
1990 C********************************************************************
1991 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
1992 C*   IND '99' IS SET BY AN OVERFLOW ERROR
1993 C*
1994 CSR         GLZADD    BEGSR                           *** GLZADD ****
1995 C*
1996 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
1997 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
1998 C*
1999 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
2000 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
2001 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
2002 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
2003 C*
2004 CSR                   EXSR GLZSUM
2005 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
2006 C*
2007 C********************************************************************
2008 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
2009 C*                        GLZADD, GLZSUB, GLZCMP.
2010 C*          PARAMETERS PASSED -
2011 C*                     I/P ZZAMTI ZZAMTD
2012 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
2013 C*
2014 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
2015 C*
2016 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
2017 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
2018 CSR                   SETOF                     919293
2019 CSR                   SETOF                     949599
2020 C*
2021 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
2022 CSR         ZZAMTI    COMP 0                      9293
2023 CSR 93      ZZAMTD    COMP 0                      9293
2024 CSR 93                GOTO ZZSEND                     ZERO BYPASS
2025 C*
2026 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
2027 CSR         ZZTOTI    COMP 0                      9193
2028 CSR 93      ZZTOTD    COMP 0                      9193
2029 C*
2030 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
2031 CSR 93                Z-ADDZZAMTI    ZZTOTI
2032 CSR 93                Z-ADDZZAMTD    ZZTOTD
2033 CSR 93                GOTO ZZSEND                     ZERO BYPASS
2034 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
2035 CSR 91N92
2036 CORN91 92             GOTO ZZOFPS
2037 C*
2038 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
2039 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
2040 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
2041 C*
2042 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
2043 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
2044 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
2045 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
2046 C*
2047 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
2048 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
2049 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
2050 CSRN99                Z-ADDZZWK2     ZZTOTD
2051 CSRN99                Z-ADDZZWK3     ZZTOTI
2052 C*
2053 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
2054 CSR 99                Z-ADD0         ZZAMT  153
2055 CSR                   GOTO ZZSEND
2056 C*
2057 C* THE 'SIGNS' ARE DIFFERENT
2058 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
2059 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
2060 C*
2061 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
2062 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
2063 C*
2064 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
2065 C*
2066 CSR 91                Z-SUBZZTOTI    ZZTOTI
2067 CSR 91                Z-SUBZZTOTD    ZZTOTD
2068 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
2069 C*
2070 CSR         ZZTOTI    COMP ZZAMTI               93  95
2071 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
2072 C*
2073 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
2074 CSR 95                Z-ADD0         ZZTOTI
2075 CSR 95                Z-ADD0         ZZTOTD
2076 CSR 95                GOTO ZZSEND
2077 C*
2078 C* IF ZZTOT GT. ZZAMT.
2079 CSR 93      ZZAMTD    COMP ZZTOTD               94
2080 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
2081 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
2082 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
2083 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
2084 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
2085 C*
2086 C*
2087 C* IF ZZAMT GT. ZZTOT.
2088 CSRN93      ZZTOTD    COMP ZZAMTD               94
2089 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
2090 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
2091 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
2092 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
2093 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
2094 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
2095 C*
2096 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
2097 CSR                   SETOF                     94
2098 CSR 93 91
2099 CORN93 92             SETON                     94
2100 CSR 94                Z-SUBZZTOTI    ZZTOTI
2101 CSR 94                Z-SUBZZTOTD    ZZTOTD
2102 C**
2103 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
2104 CSR 92                Z-SUBZZAMTI    ZZAMTI
2105 CSR 92                Z-SUBZZAMTD    ZZAMTD
2106 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
2107 C**
2108 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
2109 CSR                   SETOF                     96
2110 CSR         ZZTOTD    COMP 0                        91
2111 CSR 91      ZZTOTI    COMP 0                      96
2112 CSR 96                MOVE '.000-'   ZZNEGD  5
2113 CSR                   ENDSR                             ** ENDSR **
2114 C********************************************************************
2115 C/EJECT
2116 C********************************************************************
2117 C*****
2118 C*** FEDAT IS A SUBROUTINE TO CALCULATE FEDERAL FUND VALUE DATE
2119 C**  FOR EVENT RECORD
2120 C****
2121 C********************************************************************
2122 C           FEDAT     BEGSR                           *** FEDAT ***
2123 C***
2124 C*****
2125 C***        EVCCY     COMP USCY                     58               S01194
2125 C           EVCCY     COMP BLUSCY                   58               S01194
2126 C  N58                GOTO ENDFF
2127 C   56
2128 COR 57                MOVE 'F'       FFIN
2129 C**                                                                **
2130 C**     IGNORE SPECIFIC FEDERAL FUND PROCESSING FOR EVENT DATES    **
2131 C**     ON OR AFTER 01 OCT 81 (=03562).                            **
2132 C**                                                                **
2133 C           DAT,ED    COMP 3562                 43  43
2134 C   43                GOTO ENDFF
2135 C****                 Z-ADD1         ZNRDYS                          S01194
2136 C                     MOVE EVCCY     ZCCY
2137 C                     Z-ADDDAT,ED    ZDAYNO
2138 C***
2139 C***  FEDERAL FUND INDICATOR = Y
2140 C****
2141 C***        FFNY      COMP 'Y'                  4343                 S01194
2141 C           BLFFIN    COMP 'Y'                  4343                 S01194
2142 C  N43 56
2143 CORN43 57             SETON                     43
2144 C**N43                EXSR FDATE                                     S01195
2144 C  N43                EXSR ZFWDT                                     S01195
2145 C  N43                Z-ADDZDYNBR    FFVD
2146 C****
2147 C***        FFNY      COMP 'Y'                  4343                 S01194
2141 C           BLFFIN    COMP 'Y'                  4343                 S01194
2148 C   43N56N57          SETOF                     43
2149 C***43                EXSR FDATE                                     S01195
2144 C***43                EXSR ZFWDT                                     S01195
2144 C   43                EXSR ZBKDT                                     S01195
2150 C   43                Z-ADDZDYNBR    FFVD
2151 C**
2152 C           FFVD      COMP 0                      99
2153 C   99                Z-ADD0         FFVD             FOR CALL/NOTICE
2154 C           ENDFF     TAG
2155 C****       OTHCCY    COMP USCY                     58               S01194
2155 C           OTHCCY    COMP BLUSCY                   58               S01194
2156 C   58 56
2157 COR 58 57             MOVE 'F'       OCFF
2158 C                     ENDSR
2159 C**
2160 C********************************************************************
2161 C****                                                                S01195
2162 C********TE3 SR. TO CALCULATE ANY NUMBER OF WORKING                  S01195
2163 C******          DAYS FORWARD IN ANY CURRENCY.                       S01195
2164 C*******DIFIED VERSION OF ZDATE3 - FDATE                             S01195
2165 C*****                                                               S01195
2166 C***********IS SR. CAN BE USED WHEN THE INPUT CYCLE IS RUNNING AS    S01195
2167 C***********LIDAY RECORDS ARE ACCESSED BY CHAIN. THEREFORE NEWLY     S01195
2168 C***********DED RECORDS IN THE OVERFLOW AREA CAN ALSO BE ACCESSED.   S01195
2169 C******                                                              S01195
2170 C*************ATE     BEGSR                                          S01195
2171 C*******LCULATIONS TO DEFINE INPUT FIELDS.                           S01195
2172 C****                 Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01195
2173 C***                  MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01195
2174 C****                 Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01195
2175 C****                                                 DAYS FORWARD   S01195
2176 C********AR COUNT OF NBR OF DAYS ADDED, & DEFINE ZDYNBR.             S01195
2177 C*****                Z-ADD0         ZDCNT   20                      S01195
2178 C****                 Z-ADDZDAYNO    ZDYNBR  50                      S01195
2179 C****                                                                S01195
2180 C******OOP TO INCREMENT DAY NUMBER AND CHECK FOR HOLIDAY.            S01195
2181 C****       ZDLOP1    TAG                             ** ZDLOP1 TAG *S01195
2182 C****                 SETOF                     9596                 S01195
2183 C****       ZDYNBR       ADD  1         ZDYNBR                       S01195
2184 C****3      ZDYNBR    ADD  1         ZDYNBR                          S01195
2185 C****3      ZDYNBR    SUB  1         ZDYNBR                          S01195
2186 C*******T KEY FOR FIRST HOLIDAY RECORD.                              S01195
2187 C****                 MOVEL'22    '  ZDHKEY 12                       S01195
2188 C***                  MOVELZDYNBR    ZWRK6   6                       S01195
2189 C***                  MOVE '1'       ZWRK6                           S01195
2190 C***                  MOVE ZWRK6     ZDHKEY                          S01195
2191 C***                                                                 S01195
2192 C***  CHAIN FOR HOLIDAY RECORD, RECORD 1 OR 2                        S01195
2193 C******     ZDHCHN    TAG                             ** ZDHCHN TAG *S01195
2194 C*****                                                               S01195
2195 C****       ZDHKEY    CHAINTABLE                90    ON NOT THERE   S01195
2196 C***90      RECI      COMP 'D'                  9090  DELETED        S01195
2197 C****                                                                S01195
2198 C******O RECORD 1 FOUND, IS NOT A HOLIDAY                            S01195
2199 C*****N95             GOTO ZDOAGN                                    S01195
2200 C****                                                                S01195
2201 C******O RECORD 2 FOUND                                              S01195
2202 C***** 95 96          GOTO ZDLOP1                     EXC. NOT FOUND S01195
2203 C****0 95N96          GOTO ZDOAGN                     INC. NOT FOUND S01195
2204 C****                                                                S01195
2205 C********ERMINE TYPE FOUND, INCLUDE OR EXCLUDE                       S01195
2206 C******     INEX      COMP 'E'                  92  91               S01195
2207 C*****                                                               S01195
2208 C*******ECK IF DAY IS HOLIDAY FOR CURRENCY.                          S01195
2209 C*****      ZCCY      LOKUPHCCY                     93               S01195
2210 C****1 93             GOTO ZDOAGN                     EXCLUDE FOUND  S01195
2211 C****2 93             GOTO ZDLOP1                     INCLUDE FOUND  S01195
2212 C****                                                                S01195
2213 C******F EXCLUDE OR INCLUDE NOT FOUND CHECK                          S01195
2214 C*****                                                               S01195
2215 C****       '   '     LOKUPHCCY                     94ON IF NO RCD.2 S01195
2216 C****                 MOVE ZDHKEY    ZWRK1H  1                       S01195
2217 C****       ZWRK1H    COMP '1'                      95               S01195
2218 C****1 95             SETON                     96                   S01195
2219 C****5N94             MOVE '2'       ZDHKEY                          S01195
2220 C*****N94             GOTO ZDHCHN                     GET SECOND REC S01195
2221 C*****                                                               S01195
2222 C***91                GOTO ZDLOP1                     EXC. NOT FOUND S01195
2223 C****2                GOTO ZDOAGN                     INC. NOT FOUND S01195
2224 C*****                                                               S01195
2225 C*******CREMENT COUNT AND CHECK IF REQUIRED NUMBER OF DAYS           S01195
2226 C******AVE BEEN ADDED. IF NOT, GO THROUGH LOOP1 AGAIN.               S01195
2227 C****       ZDOAGN    TAG                             ** ZDOAGN TAG *S01195
2228 C****                                                                S01195
2229 C****       ZDCNT     ADD  1         ZDCNT                           S01195
2230 C****       ZDCNT     COMP ZNRDYS                 97                 S01195
2231 C****7                GOTO ZDLOP1                                    S01195
2232 C****                                                                S01195
2233 C*****                ENDSR                                          S01195
2234 C*****                                                               S01195
2235 C*****                                                               S01195
2236 C********************************************************************S01195
     C*    SUBROUTINE TO WRITE 3 RECORDS TO EVNTXED FOR SETTLEMENT        CEU003
     C*    CURRENCY CONVERSION                                            CEU003
     C*                                                                   CEU003
     C           EVNTEU    BEGSR                           *** EVNTEU  ***CEU003
     C*                                                                   CEU003
     C*   CALLED FROM :- EVENT                                        *   CEU003
     C*   CALLS       :- EU0200                                           CEU003
     C*                                                                   CEU003
     C* EVNTEU Sub routine to ouptput 3 records for Settlement currency   CEU003
     C*  conversion                                                       CEU003
     C*                                                                   CEU003
     C* For events to correctly reflect when settlement is occurring in   CEU003
     C*  a currency, new 'cross currency' events will be generated in     CEU003
     C*  addition to the existing events (which are in transaction        CEU003
     C*  currency).  These events will appear like internal foreign       CEU003
     C*  exchange transactions.                                           CEU003
     C*                                                                   CEU003
     C* Record 1 (existing event).  This will be same as what would       CEU003
     C*  have been written, except that the Settlement details will       CEU003
     C*  be blank.  'Settlement in another currency' flag is set to 'Y'   CEU003
     C*  This is achieved by conditioning o/p operation with *IN46.       CEU003
     C*                                                                   CEU003
     C*                                                                   CEU003
     C* If Other currency OTHCCY is blank and Other amount is not zero,   CEU003
     C*  this is causing error in calling EU0200 routine.  Hence the      CEU003
     C*  Event currency is used for Other currency.                       CEU003
     C*                                                                   CEU003
     C           AMT,OA    IFNE *ZEROS                                    CEU003
     C           OTHCCY    ANDEQ*BLANKS                                   CEU003
     C           *IN04     OREQ *ON                                       CEU003
     C           PUPRX     ANDNE*ZEROS                                    CEU003
     C           OTHCCY    ANDEQ*BLANKS                                   CEU003
     C                     MOVE EVCCY     OTHCCY                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     MOVE *ON       *IN46                           CEU003
     C/COPY WNCPYSRC,DL0400C119
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                     CEU003
     C/COPY WNCPYSRC,DL0400C097
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     EXSR SREVEX                                                        CGL187
      *                                                                                       CGL187
     C                     WRITEEVNTXED0                                                      CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C                     MOVE *OFF      *IN46                           CEU003
     C*                                                                   CEU003
     C* For records 2 and 3 the following attributes are common.          CEU003
     C*                                                                   CEU003
     C* For both the new events set Internal FX indicator to 'Y' (IFXS)   CEU003
     C*  This is achieved by using indicators 47 and 48 in the output.    CEU003
     C*                                                                   CEU003
     C* For both the new events the last character of Event type (EVCOD   CEU003
     C*  E) is changed as follows.                                        CEU003
     C                     MOVE EVCODE    WEVCD4                          CEU003
     C                     SELEC                                          CEU003
     C           WEVCD4    WHEQ '1'                                       CEU003
     C                     MOVE 'X'       WEVCD1                          CEU003
     C           WEVCD4    WHEQ '2'                                       CEU003
     C                     MOVE 'Y'       WEVCD1                          CEU003
     C           WEVCD4    WHEQ '3'                                       CEU003
     C           WEVCD4    OREQ '4'                                       CEU003
     C                     MOVE 'Z'       WEVCD1                          CEU003
     C                     ENDSL                                          CEU003
     C*                                                                   CEU003
     C* Set Event Branch (EBRC) to Settlement Branch (OSBR).  This is     CEU003
     C*  achieved by conditioning the output with indicators 47 and 48.   CEU003
     C*                                                                   CEU003
     C* Record 2 (this is used to cancel the effect of the transaction    CEU003
     C*  currency event).                                                 CEU003
     C* This is same as that written in Record 1, except that the         CEU003
     C*  Incoming/Outgoing indicator (@INOI) is reversed.                 CEU003
     C                     SELEC                                          CEU003
     C           @INOI     WHEQ 'I'                                       CEU003
     C                     MOVE 'O'       WKINOI                          CEU003
     C           @INOI     WHEQ 'O'                                       CEU003
     C                     MOVE 'I'       WKINOI                          CEU003
     C                     ENDSL                                          CEU003
     C* Other Amount is set to the transaction event amount (AMT,EA)134625138004
     C/COPY WNCPYSRC,DL0400C094
     C*  converted to settlement currency using pgm/EU0200.         134625138004
     C*                                                             134625138004
     C***********          Z-ADDAMT,EA    W#EAMT                    134625138004
     C***********          Z-ADD0         WOTAMT                    134625138004
     C***********                                                   134625138004
     C***********W#EAMT    IFNE *ZEROS                              134625138004
     C***********          MOVE EVCCY     W#TRCY           FROM Curr134625138004
     C***********          MOVE SETCCY    W#STCY           TO Curren134625138004
     C***********                                                   134625138004
     C***********          CALL 'EU0200'                            134625138004
     C***********          PARM *BLANKS   P@RTCD  7        Return Co134625138004
     C***********          PARM W#EAMT    P@FRAM 183       FROM Ccy 134625138004
     C***********          PARM W#TRCY    P@FRCY  3        FROM Curr134625138004
     C***********          PARM W#STCY    P@TOCY  3        TO Curren134625138004
     C***********EAMT      PARM           P@OUTA 150       Outright 134625138004
     C***********          PARM           P@INTA 183       Interim A134625138004
     C***********          PARM           P@EXRT 159       Exchange 134625138004
     C***********          PARM           P@MDIN  1        Mult/Div 134625138004
     C***********P@RTCD    IFEQ '*ERROR*'                           134625138004
     C***********          SETON                     U7U8LR         134625138004
     C***********          MOVEL*BLANKS   DBFILE 10                 134625138004
     C***********          MOVEL'EU0200  'DBFILE           *********134625138004
     C***********          MOVE '16'      DBASE   3        * DBERR 1134625138004
     C***********          MOVE @OPTN     DBOPTN  7        *********134625138004
     C***********          MOVE *BLANKS   DBKEY  29                 134625138004
     C***********          MOVE *BLANKS   W@OPTN  7                 134625138004
     C***********          MOVELP@FRCY    W@OPTN                    134625138004
     C***********          MOVE P@TOCY    W@OPTN                    134625138004
     C***********          MOVELW@OPTN    DBKEY                     134625138004
     C***********          ELSE                                     134625138004
     C***********          Z-ADDEAMT      WOTAMT                    134625138004
     C***********          ENDIF                                    134625138004
     C***********                                                   134625138004
     C***********          ENDIF                                    134625138004
     C*                                                             134625138004
     C*                                                                   138007
     C                     MOVE *ON       *IN47                           CEU003
     C/COPY WNCPYSRC,DL0400C120
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                     CEU003
     C/COPY WNCPYSRC,DL0400C098
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     EXSR SREVEX                                                        CGL187
      *                                                                                       CGL187
     C                     WRITEEVNTXED0                                                      CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C                     MOVE *OFF      *IN47                           CEU003
     C*                                                                   CEU003
     C* Keep the Event records count and hash total of event amount.      CEU003
     C*                                                                   CEU003
     C           COUNTE    ADD  1         COUNTE  50                      CEU003
     C           AMT,EA    DIV  1000      ZZAMT        30                 CEU003
     C   30                Z-SUBZZAMT     ZZAMT                           CEU003
     C                     Z-ADDHASHEW    ZZTOTI                          CEU003
     C                     Z-ADDHASHED    ZZTOTD                          CEU003
     C                     EXSR GLZADD                                    CEU003
     C                     Z-ADDZZTOTI    HASHEW 150                      CEU003
     C                     Z-ADDZZTOTD    HASHED  30                      CEU003
     C**                                                                  CEU003
     C*                                                                   CEU003
     C* Record 3 (this will provide a cash flow in the settlement         CEU003
     C*  currency).                                                       CEU003
     C*                                                                   CEU003
     C* Event amount is set to the transaction event amount (AMT,EA)      CEU003
     C*  converted to settlement currency using pgm/EU0200.               CEU003
     C*                                                                   CEU003
     C***********          Z-ADDAMT,EA    W#EAMT           FROM Cu CEU003 134625
     C***********          MOVE EVCCY     W#TRCY           FROM Cu CEU003 134625
     C***********          MOVE SETCCY    W#STCY           TO Curr CEU003 134625
     C           *LIKE     DEFN P@FRAM    W#EAMT                          CEU003
     C           *LIKE     DEFN P@FRCY    W#TRCY                          CEU003
     C           *LIKE     DEFN P@TOCY    W#STCY                          CEU003
     C           *LIKE     DEFN P@OUTA    EAMT                            CEU003
     C                     Z-ADDAMT,EA    W#EAMT           FROM Currency  150457
     C***********          CALL 'EU0200'                           CEU003 134625
     C***********          PARM *BLANKS   P@RTCD  7        Return  CEU003 134625
     C***********          PARM W#EAMT    P@FRAM 183       FROM Cc CEU003 134625
     C***********          PARM W#TRCY    P@FRCY  3        FROM Cu CEU003 134625
     C***********          PARM W#STCY    P@TOCY  3        TO Curr CEU003 134625
     C***********EAMT      PARM           P@OUTA 150       Outrigh CEU003 134625
     C***********          PARM           P@INTA 183       Interim CEU003 134625
     C***********          PARM           P@EXRT 159       Exchang CEU003 134625
     C***********          PARM           P@MDIN  1        Mult/Di CEU003 134625
     C***********P@RTCD    IFEQ '*ERROR*'                          CEU003 134625
     C***********          SETON                     U7U8LR        CEU003 134625
     C***********          MOVEL*BLANKS   DBFILE 10        ******* CEU003 134625
     C***********          MOVEL'EU0200  'DBFILE           ******* CEU003 134625
     C***********          MOVE '15'      DBASE   3        * DBERR CEU003 134625
     C***********          MOVE @OPTN     DBOPTN  7        ******* CEU003 134625
     C***********          MOVE *BLANKS   DBKEY  29                CEU003 134625
     C***********          MOVE *BLANKS   W@OPTN  7                CEU003 134625
     C***********          MOVELP@FRCY    W@OPTN                   CEU003 134625
     C***********          MOVE P@TOCY    W@OPTN                   CEU003 134625
     C***********          MOVELW@OPTN    DBKEY                    CEU003 134625
     C***********                                                  CEU003 134625
     C***********          ELSE                                    CEU003 134625
     C***********          Z-ADDEAMT      WSTAMT                   CEU003 134625
     C***********          ENDIF                                   CEU003 134625
     C***********          Z-ADDWOTAMT    WSTAMT                   134625 138004
      *                                                                   138004
     C           EVCODE    IFEQ '15M1'                                    138004
     C           EVCODE    OREQ '16M1'                                    138004
TAS19C           EVCODE    OREQ '17M1'                                    138004
     C********** EVCODE    OREQ '15M6'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '16M6'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '17M6'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C                     Z-ADDAMT,EA    W#EAMT                          138004
     C                     END                                            138004
      *                                                                   138004
     C                     Z-ADD0         WOTAMT                          138004
     C                     Z-ADD0         WSTAMT                          138004
      *                                                                   138004
     C           EVCODE    IFEQ '15M2'                                    138004
     C           EVCODE    OREQ '16M2'                                    138004
TAS19C           EVCODE    OREQ '17M2'                                    138004
     C                     Z-ADDINTDUE    W#EAMT                          138004
     C                     END                                            138004
      **********                                                                       CAS005 226512
     C********** EVCODE    IFEQ '15M8'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '16M8'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '17M8'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C**********           Z-ADDINTDUN    W#EAMT                                       CAS005 226512
     C**********           ENDIF                                                       CAS005 226512
     C*                                                                   149234
     C           EVCODE    IFEQ '11V1'                                    149234
     C                     Z-ADDAMT,EA    W#EAMT                          149234
     C                     END                                            149234
      *                                                                   138004
     C*                                                                   134625
     C           W#EAMT    IFNE *ZEROS                                    138004
     C                     MOVE EVCCY     W#TRCY           FROM Currency  138004
     C                     MOVE SETCCY    W#STCY           TO Currency    138004
     C                     END                                            138004
     C*                                                                   138004
     C           W#EAMT    IFNE 0                                         138004
     C*                                                                   138004
     C                     CALL 'EU0200'                                  138004
     C                     PARM *BLANKS   P@RTCD  7        Return Code    138004
     C                     PARM W#EAMT    P@FRAM 183       FROM Ccy Amoun 138004
     C                     PARM W#TRCY    P@FRCY  3        FROM Currency  138004
     C                     PARM W#STCY    P@TOCY  3        TO Currency    138004
     C           EAMT      PARM           P@OUTA 150       Outright Amoun 138004
     C                     PARM           P@INTA 183       Interim Amount 138004
     C                     PARM           P@EXRT 159       Exchange Rate  138004
     C                     PARM           P@MDIN  1        Mult/Div Ind   138004
     C           P@RTCD    IFEQ '*ERROR*'                                 138004
     C                     SETON                     U7U8LR               138004
     C                     MOVEL*BLANKS   DBFILE 10                       138004
     C                     MOVEL'EU0200  'DBFILE           ************   138004
     C                     MOVE '16'      DBASE   3        * DBERR 16 *   138004
     C                     MOVE @OPTN     DBOPTN  7        ************   138004
     C                     MOVE *BLANKS   DBKEY  29                       138004
     C                     MOVE *BLANKS   W@OPTN  7                       138004
     C                     MOVELP@FRCY    W@OPTN                          138004
     C                     MOVE P@TOCY    W@OPTN                          138004
     C                     MOVELW@OPTN    DBKEY                           138004
     C                     ELSE                                           138004
     C                     Z-ADDEAMT      WSTAMT                          138004
     C                     ENDIF                                          138004
     C*                                                                   138004
     C                     ENDIF                                          138004
      **                                                                  138004
     C           EVCODE    IFEQ '15M1'                                    138004
     C           EVCODE    OREQ '16M1'                                    138004
TAS19C           EVCODE    OREQ '17M1'                                    138004
     C                     Z-ADDINTDUE    W#EAMT                          138004
     C                     END                                            138004
      **********                                                                       CAS005 226512
     C********** EVCODE    IFEQ '15M6'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '16M6'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '17M6'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C**********           Z-ADDINTDUN    W#EAMT                                       CAS005 226512
     C**********           ENDIF                                                       CAS005 226512
      *                                                                   138004
     C           EVCODE    IFEQ '15M2'                                    138004
     C           EVCODE    OREQ '16M2'                                    138004
TAS19C           EVCODE    OREQ '17M2'                                    138004
     C********** EVCODE    OREQ '15M8'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '16M8'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C********** EVCODE    OREQ '17M8'                                                 CAS005 226512
     C********** CAS005    ANDEQ'Y'                                                    CAS005 226512
     C                     Z-ADDAMT,OA    W#EAMT                          138004
     C                     END                                            138004
     C*                                                                   149234
     C           EVCODE    IFEQ '11V2'                                    149234
     C                     Z-ADDAMT,EA    W#EAMT                          149234
     C                     END                                            149234
      *                                                                   138004
     C*                                                                   134625
     C           W#EAMT    IFNE *ZEROS                                    138004
     C                     MOVE EVCCY     W#TRCY           FROM Currency  138004
     C                     MOVE SETCCY    W#STCY           TO Currency    138004
     C                     END                                            138004
     C*                                                                   138004
     C           W#EAMT    IFNE 0                                         138004
     C*                                                                   138004
     C                     CALL 'EU0200'                                  138004
     C                     PARM *BLANKS   P@RTCD  7        Return Code    138004
     C                     PARM W#EAMT    P@FRAM 183       FROM Ccy Amoun 138004
     C                     PARM W#TRCY    P@FRCY  3        FROM Currency  138004
     C                     PARM W#STCY    P@TOCY  3        TO Currency    138004
     C           EAMT      PARM           P@OUTA 150       Outright Amoun 138004
     C                     PARM           P@INTA 183       Interim Amount 138004
     C                     PARM           P@EXRT 159       Exchange Rate  138004
     C                     PARM           P@MDIN  1        Mult/Div Ind   138004
     C           P@RTCD    IFEQ '*ERROR*'                                 138004
     C                     SETON                     U7U8LR               138004
     C                     MOVEL*BLANKS   DBFILE 10                       138004
     C                     MOVEL'EU0200  'DBFILE           ************   138004
     C                     MOVE '16'      DBASE   3        * DBERR 16 *   138004
     C                     MOVE @OPTN     DBOPTN  7        ************   138004
     C                     MOVE *BLANKS   DBKEY  29                       138004
     C                     MOVE *BLANKS   W@OPTN  7                       138004
     C                     MOVELP@FRCY    W@OPTN                          138004
     C                     MOVE P@TOCY    W@OPTN                          138004
     C                     MOVELW@OPTN    DBKEY                           138004
     C                     ELSE                                           138004
     C                     Z-ADDEAMT      WOTAMT                          138004
     C                     ENDIF                                          138004
     C*                                                                   138004
     C                     ENDIF                                          138004
      **                                                                  138004
      *                                                                   138004
     C*                                                                   CEU003
     C* Event Currency is set to Settlement Currency (SETCCY) using       CEU003
     C*  indicator 48 in the Output specs.                                CEU003
     C*                                                                   CEU003
     C* Event Currency Sort Sequence is set to that of Settlement         CEU003
     C*  Currency.                                                        CEU003
     C*  This is retrieved from Table file TABTG30.                       CEU003
     C*                                                                   CEU003
     C           *INU7     IFEQ *OFF                                      CEU003
     C                     Z-ADD1         I                               CEU003
     C           SETCCY    LOKUPCY,I                     50               CEU003
     C           *IN50     IFEQ '1'                                       CEU003
     C                     MOVE CYD,I     STSSNO                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE '1'       *INU7                           CEU003
     C                     MOVEL'NO CCY'  ERROR                           CEU003
     C                     MOVE SETCCY    ERROR                           CEU003
     C                     ENDIF                                          CEU003
     C                     ENDIF                           *INU7 = *OFF   CEU003
     C***********                                                  CEU003 134625
     C**Other*Amount*is*set*to*the*transaction*currency*other*amou CEU003 134625
     C***(AMT,OA)*converted*to*Settlement*currency*using*pgm/EU020 CEU003 134625
     C**In*case*of*Negotiable*Asset*Sold*(*IN04),*PUPRX*Purchase*p CEU003 134625
     C***is*used.                                                  CEU003 134625
     C***********                                                  CEU003 134625
     C************INU7     IFEQ *OFF                               CEU003 134625
     C************IN04     IFEQ *ON                                CEU003 134625
     C***********          Z-ADDPUPRX     W#EAMT                   CEU003 134625
     C***********          ELSE                                    CEU003 134625
     C***********          Z-ADDAMT,OA    W#EAMT           FROM Cc CEU003t134625
     C***********          ENDIF                           *IN04 = CEU003 134625
     C***********                                                  CEU003 134625
     C***********          Z-ADD0         WOTAMT                   CEU003 134625
     C***********          MOVE OTHCCY    WOTHCY                   CEU003 134625
     C***********                                                  CEU003 134625
     C***********W#EAMT    IFNE *ZEROS                             CEU003 134625
     C***********          MOVE OTHCCY    W#TRCY           FROM Cu CEU003 134625
     C***********          MOVE SETCCY    W#STCY           TO Curr CEU003 134625
     C***********                                                  CEU003 134625
     C***********          CALL 'EU0200'                           CEU003 134625
     C***********          PARM *BLANKS   P@RTCD  7        Return  CEU003 134625
     C***********          PARM W#EAMT    P@FRAM 183       FROM Cc CEU003 134625
     C***********          PARM W#TRCY    P@FRCY  3        FROM Cu CEU003 134625
     C***********          PARM W#STCY    P@TOCY  3        TO Curr CEU003 134625
     C***********EAMT      PARM           P@OUTA 150       Outrigh CEU003 134625
     C***********          PARM           P@INTA 183       Interim CEU003 134625
     C***********          PARM           P@EXRT 159       Exchang CEU003 134625
     C***********          PARM           P@MDIN  1        Mult/Di CEU003 134625
     C***********P@RTCD    IFEQ '*ERROR*'                          CEU003 134625
     C***********          SETON                     U7U8LR        CEU003 134625
     C***********          MOVEL*BLANKS   DBFILE 10        ******* CEU003 134625
     C***********          MOVEL'EU0200  'DBFILE           ******* CEU003 134625
     C***********          MOVE '16'      DBASE   3        * DBERR CEU003 134625
     C***********          MOVE @OPTN     DBOPTN  7        ******* CEU003 134625
     C***********          MOVE *BLANKS   DBKEY  29                CEU003 134625
     C***********          MOVE *BLANKS   W@OPTN                   CEU003 134625
     C***********          MOVELP@FRCY    W@OPTN                   CEU003 134625
     C***********          MOVE P@TOCY    W@OPTN                   CEU003 134625
     C***********          MOVELW@OPTN    DBKEY                    CEU003 134625
     C***********                                                  CEU003 134625
     C***********          ELSE                                    CEU003 134625
     C***********          Z-ADDEAMT      WOTAMT                   CEU003 134625
     C***********          ENDIF                                   CEU003 134625
     C***********                                                  CEU003 134625
     C***********          Z-ADDWOTAMT    WSTAMT                   134625 138004
     C***********                                                  CEU003 134625
     C**Other*currency*is*set*to*Settlement*Currency*(SETCCY).**Th CEU003 134625
     C***is*achieved*by*conditioning**IN48*in*the*Output*specs.    CEU003 134625
     C***********          MOVE SETCCY    WOTHCY                   CEU003 134625
     C***********          ENDIF                           W#EAMT  CEU003 134625
     C***********          ENDIF                           *INU7 = CEU003 134625
     C*                                                                   138004
     C* Other Amount is set to the transaction currency event amount      134625
     C*                                                                   138004
     C*******              Z-ADDAMT,EA    WOTAMT                    134625138004
     C*                                                                   137223
     C** Use Evnt Branch (EBRC) instead of the Settlement Branch          137223
     C** (OSBR) if Settlement Branch is Blank.  This is achieved          137223
     C** switching on ind. 55 which is used as a condition in the         137223
     C** 'O' Specs.                                                       137223
     C*                                                                   137223
     C                     MOVE *OFF      *IN55                           137223
     C           OSBR      IFEQ *BLANKS                                   137223
     C                     MOVE *ON       *IN55                           137223
     C                     ENDIF                                          137223
     C*                                                                   134625
     C* Other currency is set to Event currency (EVCCY). This is          134625
     C* achieved by conditioning *IN48 in the Output specs.               134625
     C*                                                                   CEU003
     C* 'Settlement In Another Currency' is set to blank.  This is the    CEU003
     C*   default value in the output.                                    CEU003
     C*                                                                   CEU003
     C           *INU7     IFEQ *OFF                                      CEU003
     C                     MOVE *ON       *IN48                           CEU003
     C/COPY WNCPYSRC,DL0400C121
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                     CEU003
      *                                                                                       CGL187
     C           CGL187    IFEQ 'Y'                                                           CGL187
      *                                                                                       CGL187
     C                     EXSR SREVEX                                                        CGL187
      *                                                                                       CGL187
     C                     WRITEEVNTXED0                                                      CGL187
      *                                                                                       CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C/COPY WNCPYSRC,DL0400C099
     C                     MOVE *OFF      *IN48                           CEU003
     C*                                                                   CEU003
     C*                                                                   CEU003
     C* Keep the Event records count and hash total of event amount.      CEU003
     C*                                                                   CEU003
     C           COUNTE    ADD  1         COUNTE  50                      CEU003
     C           WSTAMT    DIV  1000      ZZAMT        30                 CEU003
     C   30                Z-SUBZZAMT     ZZAMT                           CEU003
     C                     Z-ADDHASHEW    ZZTOTI                          CEU003
     C                     Z-ADDHASHED    ZZTOTD                          CEU003
     C                     EXSR GLZADD                                    CEU003
     C                     Z-ADDZZTOTI    HASHEW 150                      CEU003
     C                     Z-ADDZZTOTD    HASHED  30                      CEU003
     C                     ENDIF                           *INU7 = *OFF   CEU003
     C**                                                                  CEU003
     C*                                                                   CEU003
     C           ENDEVU    ENDSR                           ** ENDEVU TAG *CEU003
     C********************************************************************CEU003
1331  /COPY ZSRSRC,ZCHKH                                                  S01195
1330 C********************************************************************S01195
     C/EJECT                                                              S01195
      /COPY ZSRSRC,ZACCH                                                  S01195
1330 C********************************************************************S01195
     C/EJECT                                                              S01195
      /COPY ZSRSRC,ZFWDT                                                  S01195
1330 C********************************************************************S01195
     C/EJECT                                                              S01195
      /COPY ZSRSRC,ZBKDT                                                  S01195
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
1330 C********************************************************************S01195
     C/EJECT                                                              S01195
     C*                                                                   S01408
      /EJECT                                                                                  CGL187
      *****************************************************************                       CGL187
      *                                                               *                       CGL187
      *  SREVEX - Format Event Code and Type                          *                       CGL187
      *                                                               *                       CGL187
      *****************************************************************                       CGL187
      *                                                                                       CGL187
     C           SREVEX    BEGSR                                                              CGL187
      *                                                                                       CGL187
     C                     MOVE DLNO      LDLNO                                               CGL187
     C                     MOVE CNMR      LCUNR                                               CGL187
     C           *IN47     IFEQ *ON                                                           CGL187
     C           *IN48     OREQ *ON                                                           CGL187
     C                     MOVE WEVCD1    LEDAT                                               CGL187
     C                     ELSE                                                               CGL187
     C                     MOVE EVCODE    LETYP                                               CGL187
     C                     ENDIF                                                              CGL187
     C                     MOVE DAT,ED    LEDAT                                               CGL187
     C                     MOVE EVCCY     LECCY                                               CGL187
     C                     MOVE SSNO      LECSS                                               CGL187
     C                     MOVE DTYP      LDTYP                                               CGL187
     C                     MOVE DLST      LDLST                                               CGL187
     C                     MOVE BRCA      LEBRC                                               CGL187
      *                                                                                       CGL187
     C           *IN48     IFEQ *ON                                                           CGL187
     C                     MOVE SETCCY    LECCY                                               CGL187
     C                     MOVE STSSNO    LECSS                                               CGL187
     C                     ENDIF                                                              CGL187
      *                                                                                       CGL187
     C                     ENDSR                                                              CGL187
      *                                                                                       CGL187
      /EJECT                                                              CDL006
      *****************************************************************   CDL006
      *                                                               *   CDL006
      *  RLACVT - subroutine to convert range limits amounts held on  *   CDL006
      *           DL charges types DLCCGDL0, from base currency to    *   CDL006
      *           deal currency, if Commission tables in base currency*   CDL006
      *                                                               *   CDL006
      *  Called by : - Main processing.                               *   CDL006
      *                                                               *   CDL006
      *  Calls     : - ZCONVN                                         *   CDL006
      *                                                               *   CDL006
      *****************************************************************   CDL006
      *                                                                   CDL006
     C           RLACVT    BEGSR                                          CDL006
      *                                                                   CDL006
     C                     Z-ADDW0SPOT    ZEXCH                           CDL006
      *                                                                   CDL006
     C           W0MDIN    IFEQ 1                                         CDL006
     C                     MOVE 'D'       ZMD                             CDL006
     C                     ELSE                                           CDL006
     C                     MOVE 'M'       ZMD                             CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     Z-ADDBCD       ZCDPI                           CDL006
     C                     Z-ADDW0CDP     ZCDPO                           CDL006
      *                                                                   CDL006
      ** Process all array entries.                                       CDL006
      *                                                                   CDL006
     C           1         DO   14        I                               CDL006
     C                     Z-ADDZRA,I     ZAMTCI                          CDL006
      *                                                                   CDL006
      ** Convert range limit amount from Base currency                    CDL006
      ** to Deal currency.                                                CDL006
      *                                                                   CDL006
     C                     EXSR ZCONVN                                    CDL006
      *                                                                   CDL006
     C                     Z-ADDZAMTCO    ZRA,I                           CDL006
      *                                                                   CDL006
     C                     ENDDO                                          CDL006
      *                                                                   CDL006
     C                     ENDSR                                          CDL006
      *                                                                   CDL006
      *****************************************************************   CDL006
      /EJECT                                                              CDL006
     C/COPY ZSRSRC,ZCONVNZ1                                               CDL006
      /EJECT                                                              CDL006
      *****************************************************************   CDL006
      *                                                               *   CDL006
      *  COMCAL - subroutine to calculate accrued commission due      *   CDL006
      *           to work date since interest accrual control date.   *   CDL006
      *                                                               *   CDL006
      *  Called by : - EVENT                                          *   CDL006
      *                                                               *   CDL006
      *  Calls     : - GLINTC                                         *   CDL006
      *              - ZINTDY                                         *   CDL006
      *                                                               *   CDL006
      *  Input     : - WUDBEG (5 0) : start date of accrue period.    *   CDL006
      *              - WUDEND (5 0) : end date of accrue period.      *   CDL006
      *                                                               *   CDL006
      *  Output    : - WUACSC       : accrued commission amount.      *   CDL006
      *                                                               *   CDL006
      *****************************************************************   CDL006
      *                                                                   CDL006
     C           COMCAL    BEGSR                                          CDL006
      *                                                                   CDL006
      ** Work fields definition.                                          CDL006
      *                                                                   CDL006
     C           *LIKE     DEFN FACTC     WUACSC                          CDL006
     C           *LIKE     DEFN IACD      WUDBEG                          CDL006
     C           *LIKE     DEFN IACD      WUDEND                          CDL006
     C           *LIKE     DEFN ZZINDY    ZFULPD                          CDL006
     C           *LIKE     DEFN ZZINDY    ZPARPD                          CDL006
      *                                                                   CDL006
      ** Initialize accrued commission amount.                            CDL006
      *                                                                   CDL006
     C                     Z-ADD*ZEROS    WUACSC                          CDL006
      *                                                                   CDL006
      ** Deal type is Fiduciary Deposit call taken/Loan call taken.       CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C/COPY WNCPYSRC,DL0400C124
      *                                                                   CDL006
      **  Commission amount calculation :                                 CDL006
      *                                                                   CDL006
      **       PCPL                                                       CDL006
      **  (------------) x (WUDEND - WUDBEG) x (% current range)          CDL006
      **   Days of year                                                   CDL006
      *                                                                   CDL006
      ** Retrieve percentage of current range, only if at least           CDL006
      ** one percentage different from 0.                                 CDL006
      *                                                                   CDL006
     C           ZPE,1     IFNE 0                                         CDL006
     C                     Z-ADDPCPL      ZIAMT                           CDL006
     C                     Z-ADD1         I                               CDL006
     C           ZRA,1     IFNE 0                                         CDL006
     C           ZIAMT     LOKUPZRA,I                53  53               CDL006
      *                                                                   CDL006
     C           *IN53     IFEQ '0'                                       CDL006
     C                     Z-ADD15        I                               CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     Z-ADDWUDBEG    ZIBEG                           CDL006
     C                     Z-ADDWUDEND    ZIEND                           CDL006
     C                     MOVE ZPE,I     WUPERC  74                      CDL006
     C                     Z-ADDWUPERC    ZIRATE                          CDL006
      *                                                                   CDL006
     C                     EXSR GLINTC                                    CDL006
      *                                                                   CDL006
     C                     Z-ADDZINTR     WUACSC                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,DL0400C125
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Deal type is Deposit term taken.                                 CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FT'                                      CDL006
      *                                                                   CDL006
      **      FCMA                                                        CDL006
      **  (-----------)  x  (WUDEND - WUDBEG)                             CDL006
      **   MDAT - VDAT                                                    CDL006
      *                                                                   CDL006
      ** To determine number of days between Value date and               CDL006
      ** Maturity date.                                                   CDL006
      *                                                                   CDL006
     C                     Z-ADDVDAT      ZZBEG                           CDL006
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     Z-ADDWMDAT     ZZEND                                               CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADDMDAT      ZZEND                           CDL006
     C                     ENDIF                                                              CAS005
     C                     EXSR ZINTDY                                    CDL006
     C                     Z-ADDZZINDY    ZFULPD                          CDL006
      *                                                                   CDL006
      ** To determine number of days between Interest Accrual             CDL006
      ** control date and Next interest date.                             CDL006
      *                                                                   CDL006
     C                     Z-ADDWUDBEG    ZZBEG                           CDL006
     C                     Z-ADDWUDEND    ZZEND                           CDL006
     C                     EXSR ZINTDY                                    CDL006
     C                     Z-ADDZZINDY    ZPARPD                          CDL006
      *                                                                   CDL006
     C           ZFULPD    IFNE 0                                         CDL006
     C           FCMA      MULT ZPARPD    W0AMT  180                      CDL006
     C           W0AMT     DIV  ZFULPD    WUACSC                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDSR                                          CDL006
      *                                                                   CDL006
      *****************************************************************   CDL006
      *****************************************************************                       CGL015
      *                                                               *                       CGL015
      *  SUBROUTINE : CALHKT - Calculate HONG KONG tax amount         *                       CGL015
      *                                                               *                       CGL015
      *  CALLED BY  :                                                 *                       CGL015
      *                                                               *                       CGL015
      *  CALLS      : -                                               *                       CGL015
      *                                                               *                       CGL015
      *****************************************************************                       CGL015
      *                                                                                       CGL015
     C           CALHKT    BEGSR                                                              CGL015
      *                                                                                       CGL015
      ** Calculate tax amount W0TAX using HK interest rate                                    CGL015
      *                                                                                       CGL015
     C                     Z-ADD0         W0TAX  130        WRKTAX = W0TAX = TAXA             CGL015
     C                     Z-ADDINTDUE    W0IDUE 130        @IDUE = W0AMT                     CGL015
     C/COPY WNCPYSRC,DLH00405
      *                                                                                       CGL015
     C           JRDFC     IFEQ 'Y'                                                           CGL015
     C           W0IDUE    MULT BNHKTR    W0TAX                                               CGL015
     C           W0TAX     DIV  100       W0TAX                                               CGL015
     C                     ELSE                                                               CGL015
     C           W0IDUE    MULT BNHKTR    W0TAX     H                                         CGL015
     C           W0TAX     DIV  100       W0TAX     H                                         CGL015
     C                     ENDIF                           E 003                              CGL015
     C/COPY WNCPYSRC,DLH00406
      *                                                                                       CGL015
     C           EVETAX    ADD  W0TAX     EVETAX                                              CGL015
      *                                                                                       CGL015
     C           CALHK9    ENDSR                                                              CGL015
      *****************************************************************                       CGL015
     C/EJECT                                                                                  234341
      *****************************************************************                       234341
      *                                                               *                       234341
      *  SRCHKD - Subroutine to check the effectivity date            *                       234341
      *                                                               *                       234341
      *****************************************************************                       234341
     C           SRCHKD    BEGSR                                                              234341
      *                                                                                       234341
      ** Access the Branch details to get location code                                       234341
      *                                                                                       234341
     C**********           CALL 'AOBRCHR0'                                            234341 234341R
     C**********           PARM '*MSG    'PRTCD                                       234341 234341R
     C**********           PARM '*KEY    'POPTN                                       234341 234341R
     C**********           PARM BRCA      PDSNB   3                                   234341 234341R
     C********** SDBRCH    PARM SDBRCH    DSFDY                                       234341 234341R
     C                     Z-ADD1         J       30                                          234341
     C           BRCA      LOKUPBR,J                     81                                   234341
      *                                                                                       234341
     C********** PRTCD     IFNE *BLANKS                                               234341 234341R
     C           *IN81     IFEQ *OFF                                                          234341
     C           *LOCK     IN   LDA                                                           234341
     C                     MOVELBRCA      DBKEY                                               234341
     C                     MOVEL'SDBRCHPD'DBFILE                                              234341
     C                     MOVEL'21'      DBASE                                               234341
     C                     OUT  LDA                                                           234341
     C                     EXSR *PSSR                                                         234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
      ** Access the Country of Tax using the branch's location code                           234341
      *                                                                                       234341
     C                     MOVE LC,J      PLOCN                                               234341
     C                     CALL 'AOLOCNR0'                                                    234341
     C                     PARM *BLANKS   PRTCD                                               234341
     C                     PARM '*KEY   ' POPTN                                               234341
     C**********           PARM A8LCCD    PLOCN   3                                   234341 234341R
     C                     PARM           PLOCN   3                                           234341
     C           SDLOCN    PARM SDLOCN    DSFDY                                               234341
      *                                                                                       234341
     C           PRTCD     IFNE *BLANKS                                                       234341
     C           *LOCK     IN   LDA                                                           234341
     C**********           MOVELA8LCCD    DBKEY                                       234341 234341R
     C                     MOVELLC,J      DBKEY                                               234341
     C                     MOVEL'SDLOCNPD'DBFILE                                              234341
     C                     MOVEL'22'      DBASE                                               234341
     C                     OUT  LDA                                                           234341
     C                     EXSR *PSSR                                                         234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
      ** Retreive the country of residence of the customer                                    234341
      *                                                                                       234341
     C                     CALL 'AOCUSTR0'                                                    234341
     C                     PARM *BLANKS   PRTCD                                               234341
     C                     PARM '*KEY   ' POPTN                                               234341
     C                     PARM WCNUM     PCNUM  10                                           234341
     C                     PARM           PKEYS   7                                           234341
     C           SDCUST    PARM SDCUST    DSSDY                                               234341
      *                                                                                       234341
     C           PRTCD     IFNE *BLANKS                                                       234341
     C           *LOCK     IN   LDA                                                           234341
     C                     MOVELWCNUM     DBKEY                                               234341
     C                     MOVEL'SDCUSTPD'DBFILE                                              234341
     C                     MOVEL'23'      DBASE                                               234341
     C                     OUT  LDA                                                           234341
     C                     EXSR *PSSR                                                         234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
      ** Retrieve effective date                                                              234341
      *                                                                                       234341
     C                     CALL 'AOCTTXR0'                                                    234341
     C                     PARM *BLANKS   PRTCD                                               234341
     C                     PARM '*KEY   ' POPTN                                               234341
     C                     PARM DVCNCD    PCTRT   2                                           234341
     C                     PARM BBCOLC    PCTRR   2                                           234341
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234341
      *                                                                                       234341
      ** If no record is found, access with country of tax only                               234341
      *                                                                                       234341
     C           PRTCD     IFNE *BLANKS                                                       234341
     C                     CALL 'AOCTTXR0'                                                    234341
     C                     PARM *BLANKS   PRTCD                                               234341
     C                     PARM '*KEY   ' POPTN                                               234341
     C                     PARM DVCNCD    PCTRT                                               234341
     C                     PARM *BLANKS   PCTRR                                               234341
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234341
      *                                                                                       234341
     C           PRTCD     IFNE *BLANKS                                                       234341
     C           *LOCK     IN   LDA                                                           234341
     C                     MOVELDVCNCD    DBKEY                                               234341
     C                     MOVEL'SDCTTXPD'DBFILE                                              234341
     C                     MOVEL'24'      DBASE                                               234341
     C                     OUT  LDA                                                           234341
     C                     EXSR *PSSR                                                         234341
     C                     ENDIF                                                              234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
     C           WKMDAT    IFLT EWEDT1                                                        234341
     C********** TAXI      IFNE 'Y'                                               BUG26475 BUG26475A
     C********** TAXI      ORNE 'T'                                               BUG26475 BUG26475A
     C                     MOVE 'Y'       WSKIP   1                                           234341
     C                     ELSE                                                               234341
     C                     MOVE 'N'       WSKIP                                               234341
     C**********           ENDIF                                                  BUG26475 BUG26475A
     C                     ENDIF                                                              234341
      *                                                                                       234341
     C                     ENDSR                                                              234341
      *****************************************************************                       234341
     C/EJECT                                                                                  234341
      *****************************************************************                       234341
      *                                                               *                       234341
      *  SRCEUT - Calculate EU Tax Amount                             *                       234341
      *                                                               *                       234341
      *****************************************************************                       234341
     C           SRCEUT    BEGSR                                                              234341
      *                                                                                       234341
     C                     Z-ADD*ZEROS    WNTAMT 130                                          234341
      *                                                                                       234341
      ** Call EU Tax Calculation for Private Individual                                       234341
      *                                                                                       234341
     C                     CALL 'ZATXCLPI'                                                    234341
      *                                                                                       234341
     C                     PARM 'D'       @@MODI  1                                           234341
     C                     PARM WDLNO     @@TRRF 18                                           234341
     C                     PARM BRCA      @@BRCA  3                                           234341
     C                     PARM WCNUM     @@CUST  6                                           234341
     C                     PARM VDAT      @@STRD  50                                          234341
     C                     PARM WKMDAT    @@ENDD  50                                          234341
     C                     PARM TOTI      @@TOTI 150                                          234341
     C                     PARM *ZERO     @@TAXR  64                                          234341
     C                     PARM CCY       @@OCCY  3                                           234341
     C                     PARM *BLANKS   PINTH   1                                           CER048
      *                                                                                       234341
      ** Output parameters                                                                    234341
      *                                                                                       234341
     C                     PARM           @@IAED 150                                          234341
     C                     PARM           @@TAXA 150                                          234341
     C                     PARM           @@TOTO 150                                          234341
     C                     PARM           @@TXCY  3                                           234341
     C                     PARM           @@CTAX  2                                           234341
     C                     PARM           @@TXBS  2                                           234341
     C                     PARM           @@WTAC  40                                          234341
     C                     PARM           @@COLC  2                                           234341
     C                     PARM           @@STAT  5                                           234341
     C                     PARM           @@TRTE  1                                           234341
     C                     PARM           @@TXR1  64                                          234341
     C**********           PARM *ZEROS    PSTXB   20                                 CER048 BUG22911
     C**********           PARM *ZEROS    PSTAC  100                                 CER048 BUG22911
     C**********           PARM *ZEROS    PSTTR   64                                 CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP   1                                  CER048 BUG22911
     C**********           PARM *ZEROS    PSTXA  150                                 CER048 BUG22911
     C                     PARM           @@KEY  10                                           234341
     C                     PARM           @@FILE 10                                           234341
     C                     PARM           @@RTRN  7                                           234341
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       234341
     C                     SELEC                                                              234341
      *                                                                                       234341
     C           @@RTRN    WHEQ 'ERROR'                                                       234341
     C                     MOVE @@FILE    DBFILE                                              234341
     C                     MOVE @@KEY     DBKEY                                               234341
     C                     EXSR *PSSR                                                         234341
      *                                                                                       234341
     C           @@RTRN    WHNE 'JOINT'                                                       234341
     C                     Z-ADD@@TAXA    WNTAMT                                              234341
      *                                                                                       234341
     C           @@RTRN    WHEQ 'JOINT'                                                       234341
     C                     EXSR SRCALJ                                                        234341
     C                     ENDSL                                                              234341
      *                                                                                       234341
      ** Calculate Tax according to the effective date                                        234341
      *                                                                                       234341
     C           EWTRT1    IFEQ '1'                                                           234341
     C           VDAT      ANDLTEWEDT1                                                        234341
     C           WKMDAT    ANDGTEWEDT1                                                        234341
     C           WKMDAT    SUB  VDAT      WINTP   50                                          234341
     C           WKMDAT    SUB  EWEDT1    WEFFP   50                                          234341
      *                                                                                       234341
     C           WNTAMT    MULT WEFFP     WEFAMT 160                                          234341
     C           WEFAMT    DIV  WINTP     WNTAMT                                              234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
     C                     ENDSR                                                              234341
      *****************************************************************                       234341
     C/EJECT                                                                                  234341
      *****************************************************************                       234341
      *                                                               *                       234341
      *  SRCJAH - Calculate EU Tax Amount for Joint Account Members   *                       234341
      *                                                               *                       234341
      *****************************************************************                       234341
     C           SRCALJ    BEGSR                                                              234341
      *                                                                                       234341
     C           WCNUM     SETLLSDJACCLB                                                      234341
     C           WCNUM     READESDJACCLB                 12                                   234341
      *                                                                                       234341
     C                     Z-ADD*ZEROS    WTAXA                                               234341
      *                                                                                       234341
     C           *IN12     DOWEQ'0'                                                           234341
      *                                                                                       234341
     C                     EXSR SRCZJA                                                        234341
      *                                                                                       234341
     C           @@RTRN    IFEQ 'ERROR'                                                       234341
     C                     MOVE @@FILE    DBFILE                                              234341
     C                     MOVE @@KEY     DBKEY                                               234341
     C                     EXSR *PSSR                                                         234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
     C           @@STAT    IFEQ 'TAXAB'                                                       234341
     C           @@STAT    OREQ 'DISCL'                                                       234341
     C           @@STAT    OREQ 'SELF '                                                       234341
     C                     ADD  @@TAXA    WTAXA  150                                          234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
     C           @@RTRN    IFEQ 'NOTAX'                                                       234341
     C           @@RTRN    OREQ 'TAXAB'                                                       234341
     C           WCNUM     READESDJACCLB                 12                                   234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
     C           @@RTRN    IFEQ 'LAST '                                                       234341
     C                     MOVE '1'       *IN12                                               234341
     C                     ENDIF                                                              234341
      *                                                                                       234341
     C                     ENDDO                                                              234341
      *                                                                                       234341
      ** Accumulate the taxa amount from the account holder and                               234341
      ** non-account holder                                                                   234341
      *                                                                                       234341
     C                     ADD  WTAXA     WNTAMT                                              234341
      *                                                                                       234341
     C                     ENDSR                                                              234341
      *****************************************************************                       234341
     C/EJECT                                                                                  234341
      *****************************************************************                       234341
      *                                                               *                       234341
      *  SRCZJA - Calls European W/Tax Calculation for Joint Accounts *                       234341
      *                                                               *                       234341
      *****************************************************************                       234341
     C           SRCZJA    BEGSR                                                              234341
      *                                                                                       234341
     C                     CALL 'ZATXCLJA'                                                    234341
     C                     PARM 'D'       @@MODI                                              234341
     C                     PARM WDLNO     @@TRRF                                              234341
     C                     PARM BRCA      @@BRCA                                              234341
     C                     PARM WCNUM     @@JANO  6                                           234341
     C                     PARM JCCUST    @@CUST                                              234341
     C                     PARM JCNAHO    @@NARF 10                                           234341
     C                     PARM JCINVP    @@INVP 10                                           234341
     C                     PARM JCPAHT    PPAHT   1                                         BUG26839
     C                     PARM VDAT      @@STRD                                              234341
     C                     PARM WKMDAT    @@ENDD                                              234341
     C                     PARM TOTI      @@TOTI                                              234341
     C                     PARM *ZERO     @@TAXR                                              234341
     C                     PARM CCY       @@OCCY                                              234341
     C                     PARM *BLANKS   PINTH                                               CER048
      *                                                                                       234341
      ** Output parameters                                                                    234341
      *                                                                                       234341
     C                     PARM           @@IAED                                              234341
     C                     PARM           @@TAXA                                              234341
     C                     PARM           @@TOTO                                              234341
     C                     PARM           @@TXCY                                              234341
     C                     PARM           @@CTAX                                              234341
     C                     PARM           @@TXBS                                              234341
     C                     PARM           @@WTAC                                              234341
     C                     PARM           @@COLC                                              234341
     C                     PARM           @@STAT                                              234341
     C                     PARM           @@TRTE                                              234341
     C                     PARM           @@TXR1                                              234341
     C                     PARM           @@JAMG  1                                           234341
     C**********           PARM *ZEROS    PSTXB                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTAC                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTTR                                      CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTXA                                      CER048 BUG22911
     C                     PARM           @@KEY                                               234341
     C                     PARM           @@FILE                                              234341
     C                     PARM           @@RTRN                                              234341
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       234341
     C                     ENDSR                                                              234341
      *****************************************************************                       234341
     C/EJECT                                                                                  234341
      *****************************************************************                       234341
      *                                                               *                       234341
      *   *PSSR - Handles database error in new standing data files.  *                       234341
      *                                                               *                       234341
      *****************************************************************                       234341
     C           *PSSR     BEGSR                                                              234341
     C           @RUN      IFEQ *BLANK                                                        234341
     C                     MOVE 'Y'       @RUN    1                                           234341
     C                     DUMP                                                               234341
     C                     END                                                                234341
     C                     MOVE *ON       *INU7                                               235330
     C                     MOVE *ON       *INU8                                               235330
     C                     MOVE *ON       *INLR                                               235330
     C                     RETRN                                                              235330
     C                     ENDSR                                                              234341
      *****************************************************************                       234341
     C/COPY WNCPYSRC,DL0400CCP7                                           S01408
      *                                                                                       CDL099
      *****************************************************************                       CDL099
      **  There are several changes to the dates output on the event records.                 CDL099
      **  In understanding the following codes, it is useful to refer to                      CDL099
      **  programmers Guide No. 2, the list of event codes.                                   CDL099
      **                                                                                      CDL099
      **  Split Value Date effects the following changes:                                     CDL099
      **  Where SALE DATE is output for Leg 1, Date is replaced with                          CDL099
      **        BSDT2 if entered.                                                             CDL099
      **  Where SALE DATE is output for Leg 2, Date is replaced with                          CDL099
      **        BRSD2 if entered.                                                             CDL099
      **  Where SOLD DATE is output for EVENT DATE and PURCH AMT is                           CDL099
      **        output for OTHER AMOUNT, VDAT or OTHD is output for                           CDL099
      **        OTHER DATE is output as appropriate.                                          CDL099
      **  Where PURCH DAT is output for EVENT DATE and SALE AMT is                            CDL099
      **        output for OTHER AMOUNT, BSDT2 or BRSD2 is output for                         CDL099
      **        OTHER DATE is output as appropriate.                                          CDL099
      **                                                                                      CDL099
      **   NB For a Split Value Deal, the records hold the following values:                  CDL099
      **                                                                                      CDL099
      **  DEAL            FIELD: VDAT    OTHD    BRSD2  BSDT2                                 CDL099
      **  FX OUTRIGHT             P                      S                                    CDL099
      **  SW OR PS LEG1           P1      P2      S2     S1                                   CDL099
      **  SW OR PS LEG2           P2      P1      S1     S2                                   CDL099
      **                                                                                      CDL099
      **|  DEAL |EV  |EVENT |EV DT*SVD DT *EV |OTH|OTH|OT DT*SVD DT *                         CDL099
      **|  TYPE |CODE|DATE  |CODE *CODE   *CCY|CCY|DAT|CODE *CODE   *                         CDL099
      **|       |    |      |     *IF DIFF*   |   |   |     *IF DIFF *                        CDL099
      **|(FP/FS)|11V1|VALUE | 2   *  -    * P | S |ZER|  1  * 8 BSDT2*                        CDL099
      **|(CX/SW)|11V2|VALUE | 2   *8 BSDT2* S | P |ZER|  1  * 2 VDAT *                        CDL099
      **|(PS   )|    |      |     *       *   |   |   |     *        *                        CDL099
      **|       |    |      |     *       *   |   |   |     *        *                        CDL099
      **|  SW   |11V3|L2 VAL| 3   *9 BRSD2*P/L|P/L|ZER|  1  *  -     *                        CDL099
      **|  SW   |11V4|L2 VAL| 3   *9 BRSD2*P/L|P/L|ZER|  1  *  -     *                        CDL099
      **|  SW   |11V5|L1 VAL| 2   *8 BSDT2*P/L|P/L|L2V|  3  * 9 OTHD *                        CDL099
      **|  SW   |11V6|L1 VAL| 2   *8 BSDT2*P/L|P/L|L2V|  3  * 9 OTHD *                        CDL099
      **|  SW   |11V7|L2 VAL| 3   *   -   *L1P| - |ZER|  1  *  -     *                        CDL099
      **|  SW   |11V8|L2 VAL| 3   *9 BRSD2*L1S| - |ZER|  1  *  -     *                        CDL099
      **|       |    |      |     *       *   |   |   |     *        *                        CDL099
      **|  P2   |11V3|L2 VAL| 3   *9 BRSD2*L2S  - |ZER|  1  *  -     *                        CDL099
      **|  P2   |11V4|L2 VAL| 3   *       *L2P| - |ZER|  1  *  -     *                        CDL099
      **|  P2   |11V7|L2 VAL| 3   *       *L1P| - |ZER|  1  *  -     *                        CDL099
      **|  P2   |11V8|L2 VAL| 3   *9 BRSD2*L1S  - |ZER|  1  *  -     *                        CDL099
      **       NB PS EVENTS V3-8 ARE CALCULATED FROM LEG2 SO EVENT DATES                      CDL099
      **       ARE IN THE OPPOSITE SENSE TO A SW, IE VDAT = LEG 2 VALUE                       CDL099
      **       BSDT2 = LEG 2 SALE ETC, SO IN REALITY THE VALUES ARE:                          CDL099
      **|  P2   |11V3|L2 VAL| 2   *8 BRSD2*L2S  - |ZER|  1  *  -     *                        CDL099
      **|  P2   |11V4|L2 VAL| 2   *       *L2P| - |ZER|  1  *  -     *                        CDL099
      **|  P2   |11V7|L2 VAL| 2   *       *L1P| - |ZER|  1  *  -     *                        CDL099
      **|  P2   |11V8|L2 VAL| 2   *8 BRSD2*L1S  - |ZER|  1  *  -     *                        CDL099
      **                                                                                      CDL099
      *******************************************************************                     CDL099
      ** #BSPVD checks for deal types with split value dates.                                 CDL099
      *******************************************************************                     CDL099
      *                                                                                       CDL099
     C           #BSPVD    BEGSR                                                              CDL099
      *                                                                                       CDL099
     C                     SETOF                     676869                                   CDL099
      *                                                                                       CDL099
     C           DTYP      COMP 'FP'                     50                                   CDL099
     C  N50      DTYP      COMP 'FS'                     50                                   CDL099
     C  N50      DTYP      COMP 'PI'                     50                                   CDL099
     C  N50      DTYP      COMP 'SI'                     50                                   CDL099
     C  N50      DTYP      COMP 'CX'                     50                                   CDL099
     C   50      EVCODE    COMP '11V1'                   67                                   CDL099
     C   50      EVCODE    COMP '11V2'                   68                                   CDL099
     C   50                GOTO #BTAG1                                                        CDL099
      *                                                                                       CDL099
     C           DTYP      COMP 'OT'                     50                                   CDL099
     C   50      EVCODE    COMP '13V1'                   67                                   CDL099
     C   50      EVCODE    COMP '13V2'                   68                                   CDL099
     C   50                GOTO #BTAG1                                                        CDL099
      *                                                                                       CDL099
     C           DTYP      COMP 'SW'                     69                                   CDL099
     C   69      EVCODE    COMP '14V1'                   67                                   CDL099
     C   69      EVCODE    COMP '14V2'                   68                                   CDL099
      *                                                                                       CDL099
     C           DTYP      COMP 'PS'                     69                                   CDL099
     C   69      EVCODE    COMP '20V1'                   67                                   CDL099
     C   69      EVCODE    COMP '20V2'                   68                                   CDL099
      *                                                                                       CDL099
     C           #BTAG1    TAG                                                                CDL099
      *                                                                                       CDL099
      ** Initialise BO                                                                        CDL099
      *                                                                                       CDL099
     C                     Z-ADD1         BO                                                  CDL099
      *                                                                                       CDL099
      ** Initialise BE                                                                        CDL099
      *                                                                                       CDL099
     C                     Z-ADD1         BE                                                  CDL099
     C   67                EXSR #BSOD1                                                        CDL099
     C   68                EXSR #BSPED                                                        CDL099
     C   68                EXSR #BSOD2                                                        CDL099
     C   50                GOTO #BSPV9                                                        CDL099
      *                                                                                       CDL099
      ** Additional processing for (first leg of) swap                                        CDL099
      *                                                                                       CDL099
     C           EVCODE    IFEQ '14V3'                                                        CDL099
     C           BRSD2     ANDGT0                                                             CDL099
     C           SPLC      ANDEQSLCY                                                          CDL099
     C                     Z-ADD2         BE      10                                          CDL099
     C                     END                                                                CDL099
      *                                                                                       CDL099
     C           EVCODE    IFEQ '14V5'                                                        CDL099
     C           EVCODE    OREQ '14V6'                                                        CDL099
      *                                                                                       CDL099
     C           BSDT2     IFGT 0                                                             CDL099
     C           SPLC      ANDEQSLCY                                                          CDL099
     C                     Z-ADD1         BE                                                  CDL099
     C                     Z-ADD2         BO      10                                          CDL099
     C                     END                                                                CDL099
     C                     END                                                                CDL099
      *                                                                                       CDL099
     C           EVCODE    IFEQ '14V8'                                                        CDL099
     C           BRSD2     ANDGT0                                                             CDL099
     C                     Z-ADD2         BE                                                  CDL099
     C                     END                                                                CDL099
      *                                                                                       CDL099
      ** End fo SW processing                                                                 CDL099
      *                                                                                       CDL099
      ** Additional processing for (second leg of) internal contract                          CDL099
      *                                                                                       CDL099
     C           EVCODE    IFEQ '20V3'                                                        CDL099
     C           EVCODE    OREQ '20V8'                                                        CDL099
      *                                                                                       CDL099
     C           BSDT2     IFGT 0                                                             CDL099
     C                     Z-ADD1         BE                                                  CDL099
     C                     END                                                                CDL099
     C                     END                                                                CDL099
      *                                                                                       CDL099
      ** End of PS processing                                                                 CDL099
      *                                                                                       CDL099
     C           #BSPV9    ENDSR                                                              CDL099
      *                                                                                       CDL099
      *******************************************************************                     CDL099
      ** #BSPED S.R. to set up sale value date as event if non zero                           CDL099
      *******************************************************************                     CDL099
      *                                                                                       CDL099
     C           #BSPED    BEGSR                                                              CDL099
      *                                                                                       CDL099
     C           BSDT2     COMP 0                        56                                   CDL099
     C  N56                Z-ADD1         BE                                                  CDL099
      *                                                                                       CDL099
     C                     ENDSR                                                              CDL099
      *                                                                                       CDL099
      *******************************************************************                     CDL099
      ** #BSOD1 S.R. to set up other date as sale value date if non zero                      CDL099
      *******************************************************************                     CDL099
      *                                                                                       CDL099
     C           #BSOD1    BEGSR                                                              CDL099
      *                                                                                       CDL099
     C           BSDT2     COMP 0                        56                                   CDL099
     C  N56                Z-ADD1         BO                                                  CDL099
      *                                                                                       CDL099
     C                     ENDSR                                                              CDL099
      *                                                                                       CDL099
      *******************************************************************                     CDL099
      ** #BSOD2 S.R. to set up other date as value date if event date                         CDL099
      **             equals sale value date                                                   CDL099
      *******************************************************************                     CDL099
      *                                                                                       CDL099
     C           #BSOD2    BEGSR                                                              CDL099
      *                                                                                       CDL099
     C           BE        COMP 1                        56                                   CDL099
     C   56                Z-ADD2         OD                                                  CDL099
      *                                                                                       CDL099
     C                     ENDSR                                                              CDL099
      *                                                                                       CDL099
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC1 - Processing #1 for CF deals                          *                       CDL033
      *         - Update accrued interest to control date             *                       CDL033
      *           (for rate changes)                                  *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC1    BEGSR                                                              CDL033
      *                                                                                       CDL033
     C                     Z-ADDIACD      ZIBEG                                               CDL033
     C                     Z-ADDXKRCDT    ZIEND                                               CDL033
     C                     Z-ADDPCPL      ZIAMT                                               CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT                                               CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT  130H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           AITC      ADD  WKINT     AITC                                                CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date using                                        CDL033
      ** net treasury rate.                                                                   CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
      *                                                                                       CDL033
     C                     Z-ADDFSPAMT    ZIAMT                                               CDL033
      *                                                                                       CDL033
     C                     Z-ADDZIRATE    WZRATE                                              CDL033
      *                                                                                       CDL033
     C           FSLQPS    IFEQ '+'                                                           CDL033
     C                     ADD  FSLQPR    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C           FSLQPS    IFEQ '-'                                                           CDL033
     C                     SUB  FSLQPR    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
     C                     Z-ADDWZRATE    ZIRATE                                              CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT2                                              CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT2 130H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           FSAITN    ADD  WKINT2    FSAITN                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Reset interest accrual control date to rate change                                   CDL033
      ** date.                                                                                CDL033
      *                                                                                       CDL033
     C                     Z-ADDXKRCDT    IACD                                                CDL033
      *                                                                                       CDL033
      ** Set on interest override indicator.                                                  CDL033
      *                                                                                       CDL033
     C                     BITON'2'       DNSI                                                CDL033
      *                                                                                       CDL033
     C           EFRC1     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC2 - Processing #2 for CF deals                          *                       CDL033
      *         - Determine interest due up to rate change date       *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC2    BEGSR                                                              CDL033
      *                                                                                       CDL033
     C                     Z-ADDFROMDT    ZIBEG                                               CDL033
     C                     Z-ADDXKRCDT    ZIEND                                               CDL033
     C                     Z-ADDPCPL      ZIAMT                                               CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT                                               CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT     H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date using                                        CDL033
      ** net treasury rate.                                                                   CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
      *                                                                                       CDL033
     C                     Z-ADDFSPAMT    ZIAMT                                               CDL033
      *                                                                                       CDL033
     C                     Z-ADDZIRATE    WZRATE                                              CDL033
      *                                                                                       CDL033
     C           FSLQPS    IFEQ '+'                                                           CDL033
     C                     ADD  FSLQPR    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C           FSLQPS    IFEQ '-'                                                           CDL033
     C                     SUB  FSLQPR    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
     C                     Z-ADDWZRATE    ZIRATE                                              CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT2                                              CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT2    H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Set on interest override indicator.                                                  CDL033
      *                                                                                       CDL033
     C                     BITON'2'       DNSI                                                CDL033
      *                                                                                       CDL033
      ** Indicate that rate change has occurred within the                                    CDL033
      ** current period so that interest due up to this                                       CDL033
      ** rate change date will be included in the interest                                    CDL033
      ** due for the period currently being processed.                                        CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WRCDTF  1                                           CDL033
      *                                                                                       CDL033
      ** Set from-date for interest calculation to rate                                       CDL033
      ** change date.                                                                         CDL033
      *                                                                                       CDL033
     C                     Z-ADDXKRCDT    FROMDT                                              CDL033
      *                                                                                       CDL033
     C           EFRC2     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC3 - Processing #3 for CF deals                          *                       CDL033
      *         - Determine base rate from yield curve                *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC3    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** If currency has changed, access the currency                                         CDL033
      ** details and calculate the spot date.                                                 CDL033
      *                                                                                       CDL033
     C           CCY       IFNE WCCY                                                          CDL033
      *                                                                                       CDL033
     C                     MOVE CCY       WCCY    3                                           CDL033
     C                     CALL 'AOCURRR0'                                                    CDL033
     C                     PARM *BLANKS   PRTCD                                               CDL033
     C                     PARM '*KEY    'POPTN                                               CDL033
     C                     PARM CCY       PKCCY   3                                           CDL033
     C           SDCURR    PARM SDCURR    DSSDY                                               CDL033
      *                                                                                       CDL033
     C           PRTCD     IFNE *BLANKS                                                       CDL033
     C                     MOVE '903'     DBASE                                               CDL033
     C                     MOVELCCY       DBKEY                                               CDL033
     C                     MOVEL'SDCURRPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     GOTO END                                                           CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Calculate the currency spot date.                                                    CDL033
      *                                                                                       CDL033
     C                     MOVE CCY       ZCCY                                                CDL033
     C                     MOVE BJSLCD    ZLOC                                                CDL033
     C                     Z-ADDBJRDNB    ZDAYNO                                              CDL033
     C                     Z-ADDA6SPDY    ZNRDYS                                              CDL033
     C                     EXSR ZFWDT                                                         CDL033
     C                     Z-ADDZDYNBR    WSPDT   50                                          CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Determine FAR DATE.                                                                  CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFEQ 99999                                                         CDL033
     C                     Z-ADDMDAT      WNICD   50                                          CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDXKRCDT    WNICD                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Supply forward yield curve.                                                          CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
     C                     MOVELXKFYLD    WYLDC   5                                           CDL033
     C                     ELSE                                                               CDL033
     C                     MOVEL*BLANKS   WYLDC                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     MOVE ICBS      ZFWINC                                              CDL033
      *                                                                                       CDL033
     C                     CALL 'DLZFWR2'                                                     CDL033
      *                                                                                       CDL033
      ** Return Code                                                                          CDL033
      *                                                                                       CDL033
     C                     PARM *BLANK    ZFWRTC  5                                           CDL033
      *                                                                                       CDL033
      ** Currency                                                                             CDL033
      *                                                                                       CDL033
     C                     PARM CCY       ZFWCCY  3                                           CDL033
      *                                                                                       CDL033
      ** Int Calc Basis                                                                       CDL033
      *                                                                                       CDL033
     C                     PARM           ZFWINC  1                                           CDL033
      *                                                                                       CDL033
      ** Spot Date                                                                            CDL033
      *                                                                                       CDL033
     C                     PARM WSPDT     ZFWSDT  50                                          CDL033
      *                                                                                       CDL033
      ** Near Date                                                                            CDL033
      *                                                                                       CDL033
     C                     PARM WLICD     ZFWNDT  50                                          CDL033
      *                                                                                       CDL033
      ** For Date                                                                             CDL033
      *                                                                                       CDL033
     C                     PARM WNICD     ZFWFDT  50                                          CDL033
      *                                                                                       CDL033
      ** Forward Rate                                                                         CDL033
      *                                                                                       CDL033
     C                     PARM *ZEROS    ZFWOUT 117                                          CDL033
      *                                                                                       CDL033
      ** Yield Curve                                                                          CDL033
      *                                                                                       CDL033
     C                     PARM WYLDC     ZYLDC   5                                           CDL033
     C                     PARM           AS001C  1                                           CDL033
     C                     PARM           CAS008  1                                         AR734446
     C                     PARM           CIR004  1                                         AR734446
     C                     PARM           ZFWCC2  3                                         AR734446
     C                     PARM           ZFWIN2  1                                         AR734446
     C                     PARM           ZFYLD2  5                                         AR734446
     C                     PARM           ZFWSD2  50                                        AR734446
     C                     PARM           ZFWND2  50                                        AR734446
     C                     PARM           ZFWNE2 119                                        AR734446
      *                                                                                       CDL033
     C           ZFWRTC    IFEQ '*ERR*'                                                       CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     GOTO END                                                           CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     Z-ADDZFWOUT    WKBSRF 117                                          CDL033
      *                                                                                       CDL033
     C           EFRC3     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC4 - Processing #4 for CF deals                          *                       CDL033
      *         - Determine next rate change date                     *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC4    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Save current rate change date as the NEAR DATE.                                      CDL033
      *                                                                                       CDL033
     C                     Z-ADDXKRCDT    WLICD   50                                          CDL033
      *                                                                                       CDL033
      ** Process irregular rate changes.                                                      CDL033
      *                                                                                       CDL033
     C           XKRCFR    IFEQ 'Z'                                                           CDL033
      *                                                                                       CDL033
     C           KFRCD2    KLIST                                                              CDL033
     C                     KFLD           DLNO                                                CDL033
     C                     KFLD           K2RCIP  1                                           CDL033
     C                     KFLD           K2PRDT  50                                          CDL033
      *                                                                                       CDL033
     C                     MOVE 'R'       K2RCIP                                              CDL033
      *                                                                                       CDL033
     C                     Z-ADDXKRCDT    K2PRDT                                              CDL033
      *                                                                                       CDL033
      ** Access the schedule file for the next rate change date.                              CDL033
      *                                                                                       CDL033
     C           KFRCD2    SETGTDLFRSCL2                                                      CDL033
     C           DLNO      READEDLFRSCL2                 08                                   CDL033
     C           *IN08     IFEQ *OFF                                                          CDL033
     C           HHPRDT    ANDLTMDAT                                                          CDL033
     C                     Z-ADDHHPRDT    XKRCDT                                              CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADD99999     XKRCDT                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
      *                                                                                       CDL033
      ** Process regular rate changes.                                                        CDL033
      *                                                                                       CDL033
     C                     MOVE CCY       ZCCY                                                CDL033
     C                     MOVE BJSLCD    ZLOC                                                CDL033
     C                     Z-ADDXKRCDT    ZDAYNO                                              CDL033
      *                                                                                       CDL033
      ** Save current values of fields.                                                       CDL033
      *                                                                                       CDL033
     C                     MOVE ZFREQ     WZFREQ  1                                           CDL033
     C                     Z-ADDZMDAY     WZMDAY  20                                          CDL033
      *                                                                                       CDL033
     C                     MOVE XKRCFR    ZFREQ                                               CDL033
     C                     Z-ADDXKRCDM    ZMDAY                                               CDL033
      *                                                                                       CDL033
     C                     EXSR ZFREQB                                                        CDL033
      *                                                                                       CDL033
     C           ZDAYNO    IFLT MDAT                                                          CDL033
     C                     Z-ADDZDAYNO    XKRCDT                                              CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADD99999     XKRCDT                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Restore previous values of fields.                                                   CDL033
      *                                                                                       CDL033
     C                     MOVE WZFREQ    ZFREQ                                               CDL033
     C                     Z-ADDWZMDAY    ZMDAY                                               CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           EFRC4     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC5 - Processing #5 for CF deals                          *                       CDL033
      *         - Process next rate changes up to next interest       *                       CDL033
      *           payment date                                        *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC5    BEGSR                                                              CDL033
      *                                                                                       CDL033
     C           NIDT      DOWGTXKRCDT                                                        CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date.                                             CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC1                                                        CDL033
      *                                                                                       CDL033
      ** Apply fixed base rate or base rate determined from                                   CDL033
      ** yield curve.                                                                         CDL033
      *                                                                                       CDL033
     C           XKINFF    IFEQ 'Y'                                                           CDL033
     C           WFLAG1    ANDEQ*BLANK                                                        CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WFLAG1                                              CDL033
     C           XKBSRF    ADD  RTSP      INTR                                                CDL033
      *                                                                                       CDL033
      ** Determine next rate change date.                                                     CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC4                                                        CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
      *                                                                                       CDL033
      ** Determine next rate change date.                                                     CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC4                                                        CDL033
      *                                                                                       CDL033
      ** Determine base rate from yield curve.                                                CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC3                                                        CDL033
      *                                                                                       CDL033
     C           WKBSRF    ADD  RTSP      INTR                                                CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           INTR      IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     INTR                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDDO                                                              CDL033
      *                                                                                       CDL033
     C           EFRC5     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC6 - Processing #6 for CF deals                          *                       CDL033
      *         - Process next rate changes up to the determined      *                       CDL033
      *           next interest date                                  *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC6    BEGSR                                                              CDL033
      *                                                                                       CDL033
     C                     Z-ADD*ZEROS    WKTOTI 130                                          CDL033
     C                     Z-ADD*ZEROS    WKTOT2 130                                          CDL033
      *                                                                                       CDL033
     C           TODATE    DOWGTXKRCDT                                                        CDL033
      *                                                                                       CDL033
      ** Determine interest due up to rate change date.                                       CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC2                                                        CDL033
      *                                                                                       CDL033
     C           WKTOTI    ADD  WKINT     WKTOTI                                              CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
     C           WKTOT2    ADD  WKINT2    WKTOT2                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Apply fixed base rate or base rate determined from                                   CDL033
      ** yield curve.                                                                         CDL033
      *                                                                                       CDL033
     C           XKINFF    IFEQ 'Y'                                                           CDL033
     C           WFLAG1    ANDEQ*BLANK                                                        CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WFLAG1                                              CDL033
     C           XKBSRF    ADD  RTSP      INTR                                                CDL033
      *                                                                                       CDL033
      ** Determine next rate change date.                                                     CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC4                                                        CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
      *                                                                                       CDL033
      ** Determine next rate change date.                                                     CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC4                                                        CDL033
      *                                                                                       CDL033
      ** Determine base rate from yield curve.                                                CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC3                                                        CDL033
      *                                                                                       CDL033
     C           WKBSRF    ADD  RTSP      INTR                                                CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           INTR      IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     INTR                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDDO                                                              CDL033
      *                                                                                       CDL033
     C           EFRC6     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC7 - Processing #7 for CF deals                          *                       CDL033
      *         - Process next rate changes up to maturity date and   *                       CDL033
      *           compute for interest up to this event               *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC7    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Initialise initial date for calculating the interest                                 CDL033
      ** at maturity.                                                                         CDL033
      *                                                                                       CDL033
     C           WNOADD    IFEQ 'Y'                                                           CDL033
     C                     Z-ADDWTODAT    FROMDT                                              CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDIACD      FROMDT                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     Z-ADD*ZEROS    WKTOTI 130                                          CDL033
     C                     Z-ADD*ZEROS    WKTOT2 130                                          CDL033
      *                                                                                       CDL033
     C           MDAT      DOWGTXKRCDT                                                        CDL033
      *                                                                                       CDL033
      ** Determine interest due up to rate change date.                                       CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC2                                                        CDL033
      *                                                                                       CDL033
     C           WKTOTI    ADD  WKINT     WKTOTI                                              CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
     C           WKTOT2    ADD  WKINT2    WKTOT2                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Apply fixed base rate or base rate determined from                                   CDL033
      ** yield curve.                                                                         CDL033
      *                                                                                       CDL033
     C           XKINFF    IFEQ 'Y'                                                           CDL033
     C           WFLAG1    ANDEQ*BLANK                                                        CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WFLAG1                                              CDL033
     C           XKBSRF    ADD  RTSP      INTR                                                CDL033
      *                                                                                       CDL033
      ** Determine next rate change date.                                                     CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC4                                                        CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
      *                                                                                       CDL033
      ** Determine next rate change date.                                                     CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC4                                                        CDL033
      *                                                                                       CDL033
      ** Determine base rate from yield curve.                                                CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC3                                                        CDL033
      *                                                                                       CDL033
     C           WKBSRF    ADD  RTSP      INTR                                                CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           INTR      IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     INTR                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDDO                                                              CDL033
      *                                                                                       CDL033
      ** Override rate change date with maturity date                                         CDL033
      ** and compute for remaining interest.                                                  CDL033
      *                                                                                       CDL033
     C                     Z-ADDMDAT      XKRCDT                                              CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC2                                                        CDL033
      *                                                                                       CDL033
     C           WKTOTI    ADD  WKINT     WKTOTI                                              CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
     C           WKTOT2    ADD  WKINT2    WKTOT2                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** If this the only interest event for this deal,                                       CDL033
      ** include other amounts.                                                               CDL033
      *                                                                                       CDL033
     C           WNOADD    IFNE 'Y'                                                           CDL033
      *                                                                                       CDL033
     C           WKTOTI    ADD  AIAN      WKTOTI                                              CDL033
     C           WKTOTI    ADD  AIAP      WKTOTI                                              CDL033
     C           WKTOTI    ADD  AITC      WKTOTI                                              CDL033
     C           WKTOTI    SUB  IPRD      WKTOTI                                              CDL033
     C           WKTOTI    SUB  ICTD      WKTOTI                                              CDL033
      *                                                                                       CDL033
     C           CAS005    IFEQ 'Y'                                                           CDL033
     C           WKTOT2    ADD  FSAINN    WKTOT2                                              CDL033
     C           WKTOT2    ADD  FSAIAN    WKTOT2                                              CDL033
     C           WKTOT2    ADD  FSAITN    WKTOT2                                              CDL033
     C           WKTOT2    SUB  FSIPRN    WKTOT2                                              CDL033
     C           WKTOT2    SUB  FSICTN    WKTOT2                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           EFRC7     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       242892
      *                                                               *                       242892
      *  CHKGLN - Check if G/L account is a Nostro account            *                       242892
      *                                                               *                       242892
      *****************************************************************                       242892
      *                                                                                       242892
     C           CHKGLN    BEGSR                                                              242892
      *                                                                                       242892
     C                     MOVELSETTLE    GLACCN                                              242892
     C                     MOVE GCNUM     @KEYA                                               242892
     C                     MOVE EVCCY     @KEYB                                               242892
     C                     MOVE GACOD     @KEYC                                               242892
     C                     MOVE GSEQN     @KEYD                                               242892
     C**********           MOVE BRCA      @KEYE                                        242892 246380
     C                     MOVE BRCA      @KEYF                                               246380
     C           IOIND     IFEQ 'I'                                                         MD042716
     C           ROBR      ANDNE*BLANKS                                                     MD042716
     C                     MOVE ROBR      @KEYF                                             MD042716
     C                     ENDIF                                                            MD042716
     C           IOIND     IFEQ 'O'                                                         MD042716
     C           POBR      ANDNE*BLANKS                                                     MD042716
     C                     MOVE POBR      @KEYF                                             MD042716
     C                     ENDIF                                                            MD042716
      *                                                                                       242892
     C                     CALL 'AONOSTR0'                                                    242892
     C                     PARM *BLANKS   @RTCD                                               242892
     C                     PARM '*KEY   ' @OPTN                                               242892
     C                     PARM           @KEYA                                               242892
     C                     PARM           @KEYB                                               242892
     C                     PARM           @KEYC                                               242892
     C                     PARM           @KEYD                                               242892
     C**********           PARM           @KEYE                                        242892 246380
     C**********           PARM *BLANKS   @KEYF                                        242892 246380
     C                     PARM *BLANKS   @KEYE                                               246380
     C                     PARM           @KEYF                                               246380
     C                     PARM *BLANKS   @KEYG                                               242892
     C                     PARM *BLANKS   @KEYH                                               242892
     C           SDNOST    PARM SDNOST    DSFDY                                               242892
      *                                                                                       242892
      * If GL account references a nostro, change settlement type                             242892
      * to 'through a nostro' and use the nostro number....                                   242892
     C                     MOVE *BLANKS   SETTL2                                              242892
     C           @RTCD     IFEQ *BLANKS                                                       242892
     C                     Z-ADD08        SETTYP                                              242892
     C                     MOVE A7NONB    SETTL1                                              242892
     C**********           ELSE                                                        242892 261175
      *****************************************************************                242892 261175
      **...*not*a*nostro,*so*set*to*'settlement*undecided'.************                242892 261175
     C**********           Z-ADD00        SETTYP                                       242892 261175
     C**********           MOVE '00'      SETTL1                                       242892 261175
     C                     ENDIF                                                              242892
      *                                                                                       242892
     C                     ENDSR                                                              242892
      *                                                                                       242892
      *****************************************************************                       242892
      /EJECT                                                                                  242892
      *****************************************************************                       CER049
      *                                                               *                       CER049
      *  SRSTAX - Generate Stamp tax event type 49ST                  *                       CER049
      *                                                               *                       CER049
      *****************************************************************                       CER049
      *                                                                                       CER049
     C           SRSTAX    BEGSR                                                              CER049
      *                                                                                       CER049
     C           F1TAX     IFEQ 'Y'                                                           CER049
      *                                                                                       CER049
     C                     MOVE 'N'       STAX    1                                           CER049
     C                     MOVE 'N'       SBAL    1                                           CER049
     C           DTYP      IFEQ 'IP'                                                          CER049
     C           DTYP      OREQ 'TI'                                                          CER049
     C           EVCODE    IFEQ '15V1'                                                        CER049
     C           EVCODE    OREQ '15V3'                                                        CER049
     C           EVCODE    OREQ '15I2'                                                        CER049
     C           EVCODE    OREQ '15M2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           DTYP      IFEQ 'CD'                                                          CER049
     C           DTYP      OREQ 'CL'                                                          CER049
     C           EVCODE    IFEQ '15I2'                                                        CER049
     C           EVCODE    OREQ '15M2'                                                        CER049
     C                     MOVE 'Y'       STAX                                                CER049
     C                     MOVE 'Y'       SBAL                                                CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           STAX      IFEQ 'Y'                                                           CER049
     C                     MOVE 'N'       SIBRE   1                                           CER049
     C                     EXSR CASTAX                                                        CER049
     C                     MOVE '1'       *IN79                                               CER049
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                                         CER049
     C                     EXSR SRAUDT                                                        CER049
      *                                                                                       CER049
      ** Generate inter branch events                                                         CER049
      *                                                                                       CER049
     C           F1DBRC    IFNE BRCA                                                          CER049
     C                     MOVE 'Y'       SIBRE                                               CER049
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                                         CER049
     C                     EXSR SRAUDT                                                        CER049
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                                         CER049
     C                     EXSR SRAUDT                                                        CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           F1AVBL    IFEQ 'Y'                                                           CER049
     C           SBAL      ANDEQ'Y'                                                           CER049
     C                     MOVE 'N'       SIBRE                                               CER049
     C                     MOVELF1TAXE    WSSTAX 130                                          CER049
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                                         CER049
     C                     EXSR SRAUDT                                                        CER049
      *                                                                                       CER049
      ** Generate inter branch events                                                         CER049
      *                                                                                       CER049
     C           F1DBRC    IFNE BRCA                                                          CER049
     C                     MOVE 'Y'       SIBRE                                               CER049
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                                         CER049
     C                     EXSR SRAUDT                                                        CER049
     C                     EXSR SRNEG                                                       MD039107
     C                     EXCPTEVNTX                                                         CER049
     C                     EXSR SRAUDT                                                        CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
     C                     MOVE '0'       *IN79                                               CER049
      *                                                                                       CER049
     C                     ENDSR                                                              CER049
      *                                                                                       CER049
      *****************************************************************                       CER049
      /EJECT                                                                                  CER049
      *****************************************************************                       CER049
      *                                                               *                       CER049
      *  CASTAX - Calculate Stamp tax amount                          *                       CER049
      *                                                               *                       CER049
      *****************************************************************                       CER049
      *                                                                                       CER049
     C           CASTAX    BEGSR                                                              CER049
      *                                                                                       CER049
     C                     MOVE VDAT      VDATX                                               CER049
     C                     MOVE MDAT      MDATX                                               CER049
     C           EVCODE    IFEQ '15V3'                                                        CER049
     C                     MOVE VDATM     VDATX                                               CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     CALL 'SD008141'                                                    CER049
     C                     PARM VDATX     U#DATE  50                                          CER049
     C                     PARM 'DEAL'    U#ORGN 10                                           CER049
     C                     PARM DTYP      ##TYPE  4                                           CER049
     C                     PARM           U#CTAX 138                                          CER049
     C                     PARM           U#MTAX 138                                          CER049
     C                     PARM           U#CCCY  3                                           CER049
     C                     PARM           U#MCCY  3                                           CER049
     C                     PARM           U#CSCC  2                                           CER049
     C                     PARM           U#MSCC  2                                           CER049
     C                     PARM           U#TXTY  1                                           CER049
     C                     PARM           SDSTPD                                              CER049
      *                                                                                       CER049
      ** If there is a default for the Module use this tax rate and ccy                       CER049
      ** otherwise use the ICD Control defaults.                                              CER049
      *                                                                                       CER049
     C           U#MTAX    IFNE *ZEROS                                                        CER049
     C                     Z-ADDU#MTAX    U#TAXR 138                                          CER049
     C                     ELSE                                                               CER049
     C                     Z-ADDU#CTAX    U#TAXR                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           U#MTAX    IFNE *ZEROS                                                        CER049
     C           DTYP      IFEQ 'IP'                                                          CER049
     C           DTYP      OREQ 'TI'                                                          CER049
     C           EVCODE    IFNE '15I2'                                                        CER049
     C           EVCODE    ANDNE'15M2'                                                        CER049
      *                                                                                       CER049
     C                     CALL 'SD008142'                                                    CER049
     C                     PARM           PVALD   60                                          CER049
     C                     PARM           PMATD   60                                          CER049
     C                     PARM           SDSTPD                                              CER049
     C                     PARM           U#TAXR                                              CER049
     C                     PARM *BLANKS   U#PERD  1                                           CER049
     C                     PARM 0         U#TXBR 138                                          CER049
     C                     PARM 0         U#MNTH  70                                          CER049
     C                     PARM           VDATX   50                                          CER049
     C                     PARM           MDATX   50                                          CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     MOVE EVCCY     ECCY    3                                           CER049
     C                     MOVE AMT,EA    WSTAX                                               CER049
     C           *IN48     IFEQ *ON                                                           CER049
     C                     MOVE SETCCY    ECCY                                                CER049
     C                     MOVE WSTAMT    WSTAX  150                                          CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           ECCY      IFNE F1DCCY                                                        CER049
      *                                                                                       CER049
      ** Access stamp tax currency for decimal places                                         CER049
      *                                                                                       CER049
     C                     CALL 'AOCURRR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*KEY   ' @OPTN                                               CER049
     C                     PARM F1DCCY    @AJCD                                               CER049
     C           SDCURR    PARM SDCURR    DSSDY                                               CER049
     C                     MOVE A6NBDP    NDP     10                                          CER049
     C                     MOVELA6SPRT    ZRATE1 138                                          CER049
     C                     MOVELA6MDIN    ZMDI1   1                                           CER049
      *                                                                                       CER049
      ** Access event currency for decimal places                                             CER049
      *                                                                                       CER049
     C                     CALL 'AOCURRR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*KEY   ' @OPTN                                               CER049
     C                     PARM ECCY      @AJCD                                               CER049
     C           SDCURR    PARM SDCURR    DSSDY                                               CER049
     C                     MOVELA6SPRT    ZRATE2 138                                          CER049
     C                     MOVELA6MDIN    ZMDI2   1                                           CER049
      *                                                                                       CER049
      ** Get exchange rate                                                                    CER049
      *                                                                                       CER049
     C                     EXSR RTZXRT                                                        CER049
      *                                                                                       CER049
     C                     Z-ADDZRATEX    ZEXCH                                               CER049
     C                     MOVE ZMDI1     ZMD                                                 CER049
     C                     Z-ADDWSTAX     ZAMTCI                                              CER049
     C                     Z-ADDA6NBDP    ZCDPI                                               CER049
     C                     Z-ADDNDP       ZCDPO                                               CER049
     C                     EXSR ZCONVN                                                        CER049
     C                     Z-ADDZAMTCO    WSTAX                                               CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           WSTAX     MULT U#TAXR    WSSTAX                                              CER049
      *                                                                                       CER049
     C                     MOVE *BLANK    PCNUM                                               CER049
     C                     MOVELF1DCST    PCNUM                                               CER049
     C                     CALL 'AOCUSTR1'                                                    CER049
     C                     PARM *BLANKS   PRTCD                                               CER049
     C                     PARM '*KEY   ' POPTN                                               CER049
     C                     PARM           PCNUM                                               CER049
     C                     PARM           PKEYS                                               CER049
     C           SDCUST    PARM SDCUST    DSLDY                                               CER049
      *                                                                                       CER049
     C           PRTCD     IFNE *BLANKS                                                       CER049
     C           *LOCK     IN   LDA                                                           CER049
     C                     MOVELF1DCST    DBKEY                                               CER049
     C                     MOVEL'SDCUSTPD'DBFILE                                              CER049
     C                     MOVEL'33'      DBASE                                               CER049
     C                     OUT  LDA                                                           CER049
     C                     EXSR *PSSR                                                         CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     MOVE '0'       SPARI   1                                           CER049
     C           BBPAIN    IFEQ 'P'                                                           CER049
     C                     MOVE '1'       SPARI                                               CER049
     C                     ENDIF                                                              CER049
     C                     MOVE BBPCNB    SPARC   6                                           CER049
     C                     MOVE BBCRNM    SRNMC  20                                           CER049
     C                     MOVE BBCRTN    STWNC  10                                           CER049
     C                     MOVE BBCASC    SASKC   8                                           CER049
     C                     MOVE BBCNCZ    SCTZC   2                                           CER049
     C                     MOVE BBCOLC    SLOCC   2                                           CER049
     C*                                                                                       CER049
     C**  Get Parent Details from Client File                                                 CER049
     C*                                                                                       CER049
     C           BBPCNB    IFNE *BLANKS                                                       CER049
     C                     MOVE *BLANK    PCNUM                                               CER049
     C                     MOVELBBPCNB    PCNUM                                               CER049
     C                     CALL 'AOCUSTR1'                                                    CER049
     C                     PARM *BLANKS   PRTCD                                               CER049
     C                     PARM '*KEY   ' POPTN                                               CER049
     C                     PARM           PCNUM                                               CER049
     C                     PARM           PKEYS                                               CER049
     C           SDCUST    PARM SDCUST    DSLDY                                               CER049
      *                                                                                       CER049
     C           PRTCD     IFNE *BLANKS                                                       CER049
     C           *LOCK     IN   LDA                                                           CER049
     C                     MOVELF1DCST    DBKEY                                               CER049
     C                     MOVEL'SDCUSTPD'DBFILE                                              CER049
     C                     MOVEL'33'      DBASE                                               CER049
     C                     OUT  LDA                                                           CER049
     C                     EXSR *PSSR                                                         CER049
     C                     ENDIF                                                              CER049
     C                     MOVE BBCRNM    PCRNM  20                                           CER049
     C                     MOVE BBCRTN    PCRTN  10                                           CER049
     C                     MOVE BBCASC    PCASC   2                                           CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     Z-ADDII        I                                                   CER049
     C           BBCNCZ    LOKUPCC,I                     50                                   CER049
     C           *IN50     IFEQ '1'                                                           CER049
     C                     MOVE RC,I      S4RGCD  2                                           CER049
     C                     ELSE                                                               CER049
     C                     CALL 'AOCTRYR0'                                                    CER049
     C                     PARM '*MSG   ' @RTCD                                               CER049
     C                     PARM '*KEY   ' @OPTN                                               CER049
     C                     PARM BBCNCZ    @AXCD                                               CER049
     C           SDCTRY    PARM SDCTRY    DSFDY                                               CER049
     C*                                                                                       CER049
     C           @RTCD     IFNE *BLANK                                                        CER049
     C                     MOVE '34'      DBASE                                               CER049
     C                     MOVE @OPTN     DBOPTN                                              CER049
     C                     MOVEL@AXCD     DBKEY                                               CER049
     C                     MOVEL'SDCTRYPD'DBFILE                                              CER049
     C                     EXSR *PSSR                                                         CER049
     C                     ELSE                                                               CER049
      *                                                                                       CER049
     C                     SUB  1         II                                                  CER049
     C                     MOVE BBCNCZ    CC,II                                               CER049
     C                     MOVE A4RGCD    RC,II                                               CER049
     C                     MOVE A4RGCD    S4RGCD                                              CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     ENDSR                                                              CER049
      *                                                                                       CER049
      *****************************************************************                       CER049
      /EJECT                                                                                  CER049
      *****************************************************************                       CER049
     C           SRAUDT    BEGSR                                                              CER049
     C           COUNTE    ADD  1         COUNTE                                              CER049
     C           WSSTAX    DIV  1000      ZZAMT        30                                     CER049
     C   30                Z-SUBZZAMT     ZZAMT                                               CER049
     C                     Z-ADDHASHEW    ZZTOTI                                              CER049
     C                     Z-ADDHASHED    ZZTOTD                                              CER049
     C                     EXSR GLZADD                                                        CER049
     C                     Z-ADDZZTOTI    HASHEW                                              CER049
     C                     Z-ADDZZTOTD    HASHED                                              CER049
     C                     ENDSR                                                              CER049
      *****************************************************************                       CER049
      /EJECT                                                                                MD039107
      *****************************************************************                     MD039107
      *                                                               *                     MD039107
      *  SRNEG - Process negative amount                              *                     MD039107
      *                                                               *                     MD039107
      *****************************************************************                     MD039107
     C           SRNEG     BEGSR                                                            MD039107
      *                                                                                     MD039107
     C                     MOVE 'N'       NEGIND  1                                         MD039107
     C           AMT,EA    IFLT 0                                                           MD039107
     C           *IN48     ANDEQ'0'                                                         MD039107
     C           *IN79     ANDEQ'0'                                                         MD039107
     C                     Z-SUBAMT,EA    AMT,EA                                            MD039107
     C                     MOVE 'Y'       NEGIND                                            MD039107
     C                     ENDIF                                                            MD039107
      *                                                                                     MD039107
     C           WSTAMT    IFLT 0                                                           MD039107
     C           *IN48     ANDEQ'1'                                                         MD039107
     C                     Z-SUBWSTAMT    WSTAMT                                            MD039107
     C                     MOVE 'Y'       NEGIND                                            MD039107
     C                     ENDIF                                                            MD039107
      *                                                                                     MD039107
     C           WSSTAX    IFLT 0                                                           MD039107
     C           *IN79     ANDEQ'1'                                                         MD039107
     C                     Z-SUBWSSTAX    WSSTAX                                            MD039107
     C                     MOVE 'Y'       NEGIND                                            MD039107
     C                     ENDIF                                                            MD039107
      *                                                                                     MD039107
     C           NEGIND    IFEQ 'Y'                                                         MD039107
     C           @INOI     IFEQ 'O'                                                         MD039107
     C                     MOVE 'I'       @INOI                                             MD039107
     C                     ELSE                                                             MD039107
     C                     MOVE 'O'       @INOI                                             MD039107
     C                     ENDIF                                                            MD039107
     C                     ENDIF                                                            MD039107
      *                                                                                     MD039107
     C                     ENDSR                                                            MD039107
      *****************************************************************                     MD039107
      /EJECT                                                                                  CER049
     C/COPY ZSRSRC,RTZXRTC1                                                                   CER049
     C/COPY ZSRSRC,ZFRQB3                                                                     CDL096
      /EJECT                                                                                  CER049
     C*                                                                   S01408
2237 OEVNTXEC E       N10
2238 O                                    1 'A'
2239 OEVNTXZZ D        05
2240 O                                    1 'T'
2241 O                         COUNTE     6
2242 O                         HASHEW    14P
2243 O                         HASHED    16P
2244 O*VNTXED*E        10                                                 S01117
2244 O*VNTXED E                EVNTX                               S01117 E57
2245 O*****                               1 'D'                           E57
2246 O*****                    DLNO       7                               E57
2247 O*****                    CUSTNO    13                               S01117
2247 O*****                    CNMR      13                        S01117 E57
2248 O*****                    EVCODE    17                               E57
2249 O*****                    DAT,ED    20P                              E57
2250 O*****                    AMT,EA    27P                              E57
2251 O*****                    EVCCY     30                               E57
2252 O*****                    SSNO      32                        S01194 E57
2253 O*****                    DTYP      34                               E57
2254 O*****                    DLST      36                               E57
2255 O******                   BRCD      39                               S01117
2255 O*****                    BRCA      39                               S01117
2255 O*****                    EBRC      39                        S01117 E57
2256 O*****                    RATE      46P                              E57
2257 O*****               02 41          47 'Y'                           E57
2258 O*****               02   NOTD      50                               E57
2259 O*****              N02             50 '000'                         E57
2260 O*****                    DAT,OD    53P                              E57
2261 O*****                    AMT,OA    60P                              E57
2262 O*****            04      PUPRX     60P                              E57
2263 O*****                    OTHCCY    63                               E57
2264 O*****                    DBCE      70P                              E57
2265 O*****                    SBCEQ     77P                              E57
2266 O*****                    DBCR      84P                              E57
2267 O*****                    LCEQ      91P                              E57
2268 O*****            31      ZERO13    91P                              E57
2269 O*****                    SETTLE   115                               E57
2270 O*****************31               115 '                        '    E80540
     O*****            31               115 '00                    E80540 E57
2271 O*****                    FIPI     119                               E57
2272 O*****                    IOIND    120                               S01117
2272 O*****                    @INOI    120                        S01117 E57
2273 O*****            31               120 '     '                       E57
2274 O*****                             122 'NN'                          E57
2275 O*****           N01N04 23         121 'Y'                           E57
2276 O*****               42            122 'Y'                           E57
2277 O*****                    CPARC    128                               E57
2278 O********************40            129 'Y'                           E10423
2278 O*****               40            129 '1'                    E10423 E57
2278 O*****              N40            129 '0'                    E10423 E57
2279 O*****                    CRNMC    149                               E57
2280 O*****                    CTWNC    159                               E57
2281 O*****                    CASKC    167                               E57
2282 O***                 45   CRNM     187                               S01194
2283 O***                 45   CTWN     197                               S01194
2284 O***                 45   CASK     205                               S01194
2282 O*****               45   BBBUTX   187                        S01194 E57
2283 O*****               45   BBBVTX   197                        S01194 E57
2284 O*****               45   BBBWTX   205                        S01194 E57
2285 O*****                    CCTZC    207                               E57
2286 O*****                    CLOCC    209                               E57
2287 O****                     REGC     211                               S01194
2287 O*****                    A4AWCD   211                        S01194 E57
2288 O*****                    OTDASN   214                               E57
2289 O*****            31               214 '000'                         E57
2250 O*****                    DAT,ED   217P                              E57
2292 O*****                    FFIN     218                               E57
2293 O*****            31               218 ' '                           E57
2294 O*****                    FACT     221                               E57
2295 O*****                    FCNO     223                               E57
2296 O*****            31               223 '00000'                       E57
2297 O*****               44   OTFACO   233                               E57
2298 O*****            31               247 '                        '    E57
2299 O*****               44   OTSPI    268                               E57
2300 O*****            31               268 '                     '       E57
2301 O*****                    CPCN     274                               E57
2302 O*****            31               274 '000000'                      E57
2303 O*****                             275 '0'                           E57
2304 O*****               01   FSLI     275                               E57
2305 O*****            31      ICIR   B 281P                              E57
2306 O*****               31   ICAM   B 288P                              E57
2307 O*****                  42RBDA     295P                              E57
2308 O*****                    OCFF     296                               E57
2308 O*****                    ORBR     299                        S01117 E57
2308 O*****                    COBB     302                               S01117
2308 O*****                    COOB     302                        S01117 E57
     O*****                    ECPY     305                        S01117 E57
     O*****                    IBRE     306                        S01117 E57
     O*****                    ICYE     307                        S01117 E57
2308 O*****                    EXEI     308                        S01117 E57
      *****                                                        S01117 E57
      ***THE NEXT 3 FIELDS ARE USED TO JOIN TO LIMITS FILES FOR    S01117 E57
      ***EXPOSURE REPORTING                                        S01117 E57
2308 O*****                             309 'B'                    S01117 E57
2308 O*****                             310 'C'                    S01117 E57
2308 O*****                             311 'S'                    S01117 E57
2308 O*****                    OSBR     314                               E57
     O*****            02      TAXI     320                               E57
     O*****           N02               320 ' '                           E57
     O**
2244 OEVNTXED E                EVNTX                                      E57
2245 O                                    1 'D'                           E57
2246 O                         DLNO       7                               E57
2247 O                         CNMR      13                               E57
     O                 79      F1DCST    13                                                   CER049
2248 O                         EVCODE    17                               E57
     O                 79                17 '49ST'                                            CER049
     O                 47      WEVCD1    17                               CEU003
     O                 48      WEVCD1    17                               CEU003
     O/COPY WNCPYSRC,DL0400O002
2249 O                         DAT,ED    20P                              E57
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0400OOP1                                           S01408
      *                                                                                       CDL099
     O                 01 82N67BBD,BE    20P                                                  CDL099
     O                 09 82N67BBD,BE    20P                                                  CDL099
     O*                                                                   S01408
2250 O                         AMT,EA    27P                              E57
     O**********       48      WSTAMT    27P                        CEU003138004
     O**********       48      WSTAMT    27P                        138004149234
     O                 48      WSTAMT    27P                              149234
     O                 79      WSSTAX    27P                                                  CER049
2251 O                         EVCCY     30                               E57
     O                 48      SETCCY    30                               CEU003
     O                 79      F1DCCY    30                                                   CER049
2252 O                         SSNO      32                               E57
     O                 48      STSSNO    32                               CEU003
2253 O                         DTYP      34                               E57
2254 O                         DLST      36                               E57
2255 O                         BRCA      39                               E57
     O***********              EBRC      42                            E57138007
     O                N48N55   EBRC      42                               138007
     O                N48 55   W#ZBRC    42                               138007
     O***********      47      OSBR      42                         CEU003137223
     O***********      48      OSBR      42                         CEU003137223
     O                 48 55   EBRC      42                               137223
     O                 48N55   OSBR      42                               137223
2256 O                         RATE      49P                              E57
2257 O                    02 41          50 'Y'                           E57
2258 O                    02   NOTD      53                               E57
2259 O                   N02             53 '000'                         E57
2260 O                         DAT,OD    56P                              E57
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0400OOP2                                           S01408
      *                                                                                       CDL099
     O                 01 82N68BBD,BO    56P                                                  CDL099
     O                 09 82N68BBD,BO    56P                                                  CDL099
     O*                                                                   S01408
2261 O                         AMT,OA    63P                              E57
2262 O                 04      PUPRX     63P                              E57
     O****             47      WOTAMT    63P                        134625138004
     O                 48      WOTAMT    63P                              CEU003
2263 O                         OTHCCY    66                               E57
     O****             47      SETCCY    66                         134625138004
     O***********      48      SETCCY    66                        CEU003 134625
     O**********       48      EVCCY     66                         134625138004
     O                 48      SETCCY    66                               138004
2264 O                         DBCE      73P                              E57
2265 O                         SBCEQ     80P                              E57
2266 O                         DBCR      87P                              E57
2267 O                         LCEQ      94P                              E57
2268 O                 31      ZERO13    94P                              E57
2269 O**********               SETTLE   118                                               E57 CGL029
     O**********       31               118 '00                      '                    E57 CGL029
     O**********       46               118 '00                      '                 CEU003 CGL029
     O**********       47               118 '00                      '                 CEU003 CGL029
     O**********       72      SETISA   118                                            138004 CGL029
     O                         SETTL1    98                                                   CGL029
     O                 31                98 '00  '                                            CGL029
     O                 46                98 '00  '                                            CGL029
     O                 47                98 '00  '                                            CGL029
     O                 72      SETIS1    98                                                   CGL029
     O                         SETDUM   108                                                   CGL029
     O                         SETTL3   118                                                   CGL029
     O                 31               118 '          '                                      CGL029
     O                 46               118 '          '                                      CGL029
     O                 47               118 '          '                                      CGL029
     O                 72      SETIS3   118                                                   CGL029
2271 O                         FIPI     122                               E57
2272 O                         @INOI    123                               E57
2273 O                 31               123 '     '                       E57
     O                 47      WKINOI   123                               CEU003
     O                 79               123 'O'                                               CER049
2274 O                                  125 'NN'                          E57
2275 O                N01N04 23         124 'Y'                           E57
2276 O                    42            125 'Y'                           E57
2277 O                         CPARC    131                               E57
     O                    79   SPARC    131                                                   CER049
2278 O                    40            132 '1'                           E57
2278 O                   N40            132 '0'                           E57
     O                    79   SPARI    132                                                   CER049
2279 O                         CRNMC    152                               E57
     O                    79   SRNMC    152                                                   CER049
2280 O                         CTWNC    162                               E57
     O                    79   STWNC    162                                                   CER049
2281 O                         CASKC    170                               E57
     O                    79   SASKC    170                                                   CER049
2282 O                    45   BBCRNM   190                               E57
     O                    79   PCRNM    190                                                   CER049
2283 O                    45   BBCRTN   200                               E57
     O                    79   PCRTN    200                                                   CER049
2284 O                    45   BBCASC   208                               E57
     O                    79   PCASC    208                                                   CER049
2285 O                         CCTZC    210                               E57
     O                    79   SCTZC    210                                                   CER049
2286 O                         CLOCC    212                               E57
     O                    79   SLOCC    212                                                   CER049
2287 O                         A4RGCD   214                               E57
     O                    79   S4RGCD   214                                                   CER049
2288 O                         OTDASN   217                               E57
2289 O                 31               217 '000'                         E57
     O/COPY WNCPYSRC,DL0400O003
2250 O                         DAT,ED   220P                              E57
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0400OOP3                                           S01408
      *                                                                                       CDL099
     O                 01 82   BBD,BE   220P                                                  CDL099
     O                 09 82   BBD,BE   220P                                                  CDL099
     O*                                                                   S01408
2292 O                         FFIN     221                               E57
2293 O                 31               221 ' '                           E57
2294 O                         FACT     224                               E57
2295 O                         FCNO     226                               E57
2296 O                 31               226 '00000'                       E57
2297 O                    44   OTFACO   236                               E57
2298 O                 31               250 '                        '    E57
2299 O                    44   OTSPI    271                               E57
2300 O                 31               271 '                     '       E57
2301 O                         CPCN     277                               E57
2302 O**********       31               277 '000000'                                   E57    CSD027
2302 O                 31               277 '      '                                          CSD027
2303 O                                  278 '0'                           E57
2304 O                    01   FSLI     278                               E57
2305 O**********       31      ICIR   B 284P                              E57               BUG28009
2306 O**********          31   ICAM   B 291P                              E57               BUG28009
     O                         ICIR   B 284P                                                BUG28009
     O                         ICAM   B 291P                                                BUG28009
2307 O***********            42RBDA     298P                          E57 CEU015
2307 O***********            42RBD1     298P                       CEU015 145001
2307 O                       42RBDA     298P                              145001
2307 O                      N42Z13      298P                              138004
2308 O                         OCFF     299                               E57
2308 O                         ORBR     302                               E57
2308 O                         COBB     305                               E57
2308 O                         COOB     308                               E57
     O                         ECPY     311                               E57
     O                         IBRE     312                               E57
     O                 79      SIBRE    312                                                   CER049
     O                         ICYE     313                               E57
2308 O                         EXEI     314                               E57
     O                         RSUPR    325                               S01354
      *                                                                   E57
      ** THE NEXT 3 FIELDS ARE USED TO JOIN TO LIMITS FILES FOR           S01117
      ** EXPOSURE REPORTING                                               S01117
2308 O                                  315 'B'                           E57
2308 O                                  316 'C'                           E57
2308 O                                  317 'S'                           E57
2308 O                         OSBR     320                               E57
     O                    69   W#ZBRC   320                               138004
     O                 02      TAXI     326                               E57
     O                N02               326 ' '                           E57
     O                 02      FUID     327                               S01392
     O**********       02      RBDN     333                                          S01392 BUG28009
     O                         RBDN     333                                                 BUG28009
     O                         BOKC     335                               S01220
      *                                                                   S01378
      ** Output parcel flag for NA's purchased/sold                       S01378
     O                    03   PCLI     337                               S01378
     O                    04   PCLI     337                               S01378
     O                    02   IPSI     338                               S01434
     O***********         67   PTFR     342                         S01486080698
     O                N68 67   PTFR     342                               080698
     O                 17      PRFC     346                               CAC001
     O                         IFXS     347                               CEU003
     O                 47               347 'Y'                           CEU003
     O                 48               347 'Y'                           CEU003
     O                         SIAC     348                               CEU003
     O                 46               348 'Y'                           CEU003
     O                 47               348 'Y'                           CEU003
     O                         EVFIDE   349                               CDL006
     O                         EVFCGA B 356P                              CDL006
     O                         EVFCMA B 363P                              CDL006
     O                 89      EVETAX   370P                                                  CGL015
     O                N89      ZEROTX   370P                                                  CGL015
     O                         SETTL2   386                                                   CGL029
     O                 31               386 '                '                                CGL029
     O                 46               386 '                '                                CGL029
     O                 47               386 '                '                                CGL029
     O                 72      SETIS2   386                                                   CGL029
     O                         WMCAC    392                                                   CLE025
     O                         WMCAT    395                                                   CLE025
     O                         WMCAS    397                                                   CLE025
     O                         CLAS     405                                                   CDL038
     O/COPY WNCPYSRC,DL0400O001
     O**                                                                  E57
     O** TOMORROWS EVENTS FOR DEALING
     O**
     O** HEADER RECORD
     OEMTE2H1 EADD     U1N10
     O                                    1 'H'
     O                                    8 '0'
     O**
     O** DETAIL RECORD
     OEMTE2E2 EADD     U1 63N31
     O                                    1 'D'
     O                         CUSTNO     7
     O/COPY WNCPYSRC,DL0400O004
     O                         EVCODE    11
     O                         EVCCY     14
     O                         AMT,EA    21P
     O/COPY WNCPYSRC,DL0400O005
     O                      N23          22 'N'
     O                       23          22 'Y'
     O                         DTYP      24
     O                         SETTYP    26                               E10028
     O*****                    BRCD      29                               S01117
     O                         BRCA      29                               S01117
     O                         VDAT      32P                              S01332
     O                N62      MDAT      35P                              S01332
     O                 62      OTDT      35P                              S01332
     O**
     O** TRAILER RECORD
     OEMTE2T1 DADD     U1 05
     O                                    1 'T'
     O                                    7 '999999'
     O                                    8 'D'
     O                         TNDLR     11P
     O**
     O** DEALING MASTER FILE EXTRACT
     O**
     O** HEADER RECORD
     OEMXT2H1 EADD     U1N10
     O                                    1 'H'
     O                                    8 '0'
     O**
     O***DETAIL RECORD
     O** PURCHASE DETAIL RECORD                                           S01128
     OEMXT2D2 DADD     U1 61 10
     O*******AND******N31                                                 CDL002
     O       AND      N31N36                                              CDL002
     O                                    1 'D'
     O                         CUSTNO     7
     O                         DTYP       9
     O                         VDAT      12P
     O                       62OTDT      15P
     O                      N62MDAT      15P
     O                         CCY       18
     O                       01PUCY      18
     O                         ZERO13    25P
     O                       01PUAM      25P
     O                       02PCPL      25P
     O                         ZERO13    32P
     O                       03FVAL      32P
     O                       04FVAL      32P
     O                         FACT      36
     O                         FCNO      38
     O                         SETTYP    40
     O******                   BRCD      43             S01117            S01117
     O                         BRCA      43                               S01117
     O                         COBB      46                               S01117
     O*************************DLNO      46                         E12206S01314
     O*************************CCTZ      48                         E12206S01314
     O*************************REGC      50                         E12206S01314
     O*************************ACOC      52                         E12206S01314
     O                         DLNO      52                               S01314
     O                         BBCNCZ    54                               S01314
     O                         A4RGCD    56                               S01314
     O**********               BBACOC    62                                           S01314 BUG9784
     O                         BBACOC    58                                           S01314 BUG9784
     O**                                                                  S01128
     O** SALE DETAIL RECORD                                               S01128
     O        DADD     U1 61 10                                           S01128
     O****   AND      N31                                                 S01128
     O*******AND*******01N31                                        S01128CDL002
     O       AND       01N31N37                                           CDL002
     O                                    1 'D'                           S01128
     O                         CUSTNO     7                               S01128
     O                         DTYP       9                               S01128
     O                         VDAT      12P                              S01128
     O                       62OTDT      15P                              S01128
     O                      N62MDAT      15P                              S01128
     O                         SLCY      18                               S01128
     O                         SAMT      25P                              S01128
     O                         ZERO13    32P                              S01128
     O                         FACT      36                               S01128
     O                         FCNO      38                               S01128
     O                         SETTYP    40                               S01128
     O*************************DLNO      46                         E12206S01314
     O*************************CCTZ      48                         E12206S01314
     O*************************REGC      50                         E12206S01314
     O*************************ACOC      52                         E12206S01314
     O                         BRCA      43                                                  BUG9784
     O                         COBB      46                                                  BUG9784
     O                         DLNO      52                               S01314
     O                         BBCNCZ    54                               S01314
     O                         A4RGCD    56                               S01314
     O**********               BBACOC    62                                           S01314 BUG9784
     O                         BBACOC    58                                                  BUG9784
     O**
     O** TRAILER RECORD
     OEMXT2T1 DADD     U1 05
     O                                    1 'T'
     O                                    7 '999999'
     O                                    8 'D'
     O                         XNDLR     11P
     O**
2309 O***400P1D  203   05                                                 S01117
2310 O***                                22 'REFERENCE DL0400'            S01117
2309 ODL0400AUD  203   05                                                 S01117
2309 O       OR       N05 U7                                              S01117
2310 O                                   24 'REFERENCE DL0400AU'          S01117
2311 O*****                    TITL      89                               S01194
2311 O                         BJURPT    89                               S01194
2312 O                                  104 'DATE'
2313 O****                     RUNA     112                               S01194
2313 O                         BJMRDT   112                               S01194
2314 O                                  127 'PAGE    1'
2315 O        D  1     05
2309 O       OR       N05 U7                                              S01117
2316 O                                   72 'EVENTS FILE CREATION'
2317 O        D  3     05
2318 O                                   72 '--------------------'
2319 O        D  120   05
2320 O                                   33 'S/DEALS  -  RUN CONTROLS'
2321 O                                   72 'ON FILE'
2322 O                                  102 'IN PROGRAM'
2323 O        D  2     05
2324 O                                   33 '-------     ------------'
2325 O                                   72 '-------'
2326 O                                  102 '----------'
2327 O******  D  2     05                                                 S01095
2328 O******                             42 'TOTAL RECORDS ON FILE'       S01095
2329 O******                   NORE  3   72                               S01095
2330 O******                   COUNT 3  102                               S01095
2331 O******                N50         129 '***   DIFFERENCE   ***'      S01095
2332 O        D  2     05
2333 O                                   43 'DETAIL RECORDS ON FILE'
2334 O                         NLRA  3   72
2335 O                         COUNTD3  102
2336 O                      N51         129 '***   DIFFERENCE   ***'
2337 O        D  3     05
2338 O                                   40 'DETAIL RECORDS HASH'
2339 O                                   46 'TOTAL'
2340 O                         VLAF  Z   69
2341 O                         VLAL      72
2342 O                         HASHW Z   99
2343 O                         HASHD    102
2344 O                      N52         129 '***   DIFFERENCE   ***'
2345 O        D 31     05
2346 O                                   33 'S/EVNTX  -  RUN CONTROLS'
2347 O                                  102 'FILE CREATE'
2348 O        D  2     05
2349 O                                   33 '-------     ------------'
2350 O                                  102 '-----------'
2351 O        D  2     05
2352 O                                   42 'TOTAL RECORDS ON FILE'
2353 O                         COUNTE3  102
2354 O        D  3     05
2355 O                                   40 'DETAIL RECORDS HASH'
2356 O                                   46 'TOTAL'
2357 O                         HASHEWZ   99
2358 O                         HASHED   102
2345 O        D 31     05 U1
2346 O                                   33 'EXPOSURE MANAGEMENT EXTR'
2347 O                                   42 'ACT FILES'
2348 O        D  2     05 U1
2349 O                                   33 '------------------------'
2350 O                                   42 '---------'
2351 O        D  1     05 U1
2352 O                                   33 'S/EMXT2  -  RUN CONTROLS'
2352 O                                  102 'FILE CREATE'
2348 O        D  2     05 U1
2349 O                                   33 '-------     ------------'
2350 O                                  102 '-----------'
2354 O        D  2     05 U1
2355 O                                   43 'DETAIL RECORDS ON FILE'
2353 O                         XNDLR 3  102
2351 O        D 31     05 U1
2352 O                                   33 'S/EMTE2  -  RUN CONTROLS'
2352 O                                  102 'FILE CREATE'
2348 O        D  2     05 U1
2349 O                                   33 '-------     ------------'
2350 O                                  102 '-----------'
2354 O        D  2     05 U1
2355 O                                   43 'DETAIL RECORDS ON FILE'
2353 O                         TNDLR 3  102
2359 O********D        05                                                 LN0127
2360 O********                           76 '***  END OF REPORT  ***'     LN0127
2361 O******* D        U7
2362 O*******                            22 'REFERENCE DL0400'            S01117
2363 O*******                            65 'PRINT TERMINATED -'
2364 O*******                            80 'DATABASE ERROR'
     O        D 3      U7                                                 S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        D 1      U7                                                 S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        D 1      U7                                                 S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
2365 O********D 3      U7                                                 S01117
2365 O        D 13     U7                                                 S01117
     O                                   47 'TEXT'                        S01117
2366 O*************************ERROR     60                               S01117
2366 O                         ERROR     68                               S01117
     O/COPY WNCPYSRC,DL0400O006
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   POWER - ARRAY OF POWERS OF 10 FOR CURRENCY CONVERSIONS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**    TAB1/TAB2   -   SEE COMMENTS IN EXTENSION SPECS FOR KEY TO VALUES
NXV11022P3S1E1I
NXV21023S2P1E2O
FPV11122P3S1E1I
FPV21123S2P1E2O
FSV11122P3S1E1I
FSV21123S2P1E2O
PIV11122P3S1E1I
PIV21123S2P1E2O
SIV11122P3S1E1I
SIV21123S2P1E2O
CXV11122P3S1E1I
CXV21123S2P1E2O
OPV11232P3S2E1I
OPV21233S2P2E2O
OTV11322P3S1E1I
OTV21323S2P1E2O
SWV11422P3S1E1I
SWV21423S2P1E2O
SWV31436L1 1 0
SWV41436L1 1 0
SWV51429L6 3 0
SWV61429L6 3 0
SWV71432P1 1 0
SWV81433S1 1 0
IPV11522D1 3I1O
IPI21557D1 1I4I
IPM11532D7 2I2I
IPM21537D2 1I0I
FLV11522D1 3I1O                                                           CDL006
FLI21557D1 1I4I                                                           CDL006
FLM11532D7 2I2I                                                           CDL006
FLM21537D2 1I0I                                                           CDL006
TIV11522D1 3I1O
TII21557D1 1I4I
TIM11532D7 2I2I
TIM21537D2 1I0I
LNV11522D1 3I1O
LNI21557D1 1I4I
LNM11532D7 2I2I
LNM21537D2 1I0I
CLV11522D1 1I1O
CLI21557D1 1I4I                                                           E17215
CLM11542D7 2I2I              ** PREVIOUSLY CLM11542D1                     E21775
CLM21537D2 1I0I                                                           E17215
CLV31574D2 1I3O
CLM41574D2 1I3I
DPV11522D1 1I1O                                                           CDL006
DPI21557D1 1I4I                                                           CDL006
DPM11542D7 2I2I                                                           CDL006
DPM21537D2 1I0I                                                           CDL006
DPV31574D2 1I3O                                                           CDL006
DPM41574D2 1I3I                                                           CDL006
LPV11522D1 1I1O                                                           CDL006
LPI21557D1 1I4I                                                           CDL006
LPM11542D7 2I2I                                                           CDL006
LPM21537D2 1I0I                                                           CDL006
LPV31574D2 1I3O                                                           CDL006
LPM41574D2 1I3I                                                           CDL006
DLV11522D1 1I1O
DLI21557D1 1I4I                                                           E17215
DLM11542D7 2I2I              ** PREVIOUSLY DLM11542D1
DLM21537D2 1I0I                                                           E17215
DLV31574D2 1I3O
DLM41574D2 1I3I
ITV11622D1 3I1I
ITI21657D1 1I4O
ITM11632D7 2I2O
ITM21637D2 1I0O
TDV11622D1 3I1I
TDI21657D1 1I4O
TDM11632D7 2I2O
TDM21637D2 1I0O
FTV11622D1 3I1I                                                           CDL006
FTI21657D1 1I4O                                                           CDL006
FTM11632D7 2I2O                                                           CDL006
FTM21632D2 1I0O                                                           CDL006
CIV11622D1 3I1I
CII21657D1 1I4O
CIM11632D7 2I2O
CIM21637D2 1I0O
CDV11622D1 1I1I
CDI21657D1 1I4O                                                           E17215
CDM11642D7 2I2O              ** PREVIOUSLY CDM11642D1              E21775 E25364
CDM21637D2 1I0O                                                           E17215
CDV31674D2 1I3I
CDM41674D2 1I3O
DTV11622D1 1I1I                                                           CDL006
DTI21657D1 1I4O                                                           CDL006
DTM11642D7 2I2O                                                           CDL006
DTM21637D2 1I0O                                                           CDL006
DTV31674D2 1I3I                                                           CDL006
DTM41674D2 1I3O                                                           CDL006
LTV11622D1 1I1I                                                           CDL006
LTI21657D1 1I4O                                                           CDL006
LTM11642D7 2I2O                                                           CDL006
LTM21637D2 1I0O                                                           CDL006
LTV31674D2 1I3I                                                           CDL006
LTM41674D2 1I3O                                                           CDL006
C1V11725D5 3I1O
C1I21757D1 1I4I
C1M11735D7 2I2I
C1M21737D5 1I0I
C1S11765D1 1I0
C2V11725D2 3I0
C2V31722D5 3Y1O
C2I21757D1 1I4I
C2M11735D7 2I2I
C2M21737D5 1I0I
C2M31732D5 1Y0
C2S11765D1 1 0
BDV11725D2 3I0
BDV31722D5 3Y1O
BDI21757D1 1I4I
BDM11735D7 2I2I
BDM21737D5 1I0I
BDM31732D5 1Y0
BDS11765D1 1 0
BPV11725D2 3I0
BPV31722D5 3Y1O
BPI21757D1 1I4I
BPM11735D7 2I2I
BPM21737D5 1I0I
BPM31732D5 1Y0
BPS11765D1 1 0
TBV11725D2 3 0
TBV31722D5 3Y1O
TBM11735D1 2 2I
TBM31732D5 1Y0
TBS11765D1 1 0
DAV11725D2 3 0
DAV31722D5 3Y1O
DAM11735D1 2 2I
DAM31732D5 1Y0
DAS11765D1 1 0
TAV11725D2 3 0
TAV31722D5 3Y1O
TAM11735D1 2 2I
TAM31732D5 1Y0
TAS11765D1 1 0
CSM11822D1 1Y1I
BRM11822D1 1Y1I
BSM11822D1 1Y1I
TSM11822D1 1Y1I
RAM11822D1 1Y1I
TRM11822D1 1Y1I
PSV12022P3S3E0
PSV22023S2P3E0
PSS12022P3S3E0                                                            S01220
PSS22023S2P3E0                                                            S01220
PSV32036S1 1 0
PSV42036P1 1 0
PSV72022S1 1 0
PSV82023P1 1 0
ILV11522D1 3I1O                                                           S01354
ILI21557D1 1I4I                                                           S01354
ILM11542D7 2I2I                                                           S01354
ILM21537D2 1I0I                                                           S01354
ILV31574D2 1I3O                                                           S01354
ILM41574D2 1I3I                                                           S01354
IDV11622D1 3I1I                                                           S01354
IDI21657D1 1I4O                                                           S01354
IDM11642D7 2I2O                                                           S01354
IDM21637D2 1I0O                                                           S01354
IDV31674D2 1I3I                                                           S01354
IDM41674D2 1I3O                                                           S01354
IPV61522D1 3I1O                                                                               CAS005
IPI61558D1 1I4I                                                                               CAS005
IPM61532D8 2I2I                                                                               CAS005
IPM81538D2 1I0I                                                                               CAS005
FLV61522D1 3I1O                                                                               CAS005
FLI61558D1 1I4I                                                                               CAS005
FLM61532D8 2I2I                                                                               CAS005
FLM81538D2 1I0I                                                                               CAS005
TIV61522D1 3I1O                                                                               CAS005
TII61558D1 1I4I                                                                               CAS005
TIM61532D8 2I2I                                                                               CAS005
TIM81538D2 1I0I                                                                               CAS005
LNV61522D1 3I1O                                                                               CAS005
LNI61558D1 1I4I                                                                               CAS005
LNM61532D8 2I2I                                                                               CAS005
LNM81538D2 1I0I                                                                               CAS005
CLV61522D1 1I1O                                                                               CAS005
CLI61558D1 1I4I                                                                               CAS005
CLM61542D8 2I2I                                                                               CAS005
CLM81538D2 1I0I                                                                               CAS005
DPV61522D1 1I1O                                                                               CAS005
DPI61558D1 1I4I                                                                               CAS005
DPM61542D8 2I2I                                                                               CAS005
DPM81538D2 1I0I                                                                               CAS005
LPV61522D1 1I1O                                                                               CAS005
LPI61558D1 1I4I                                                                               CAS005
LPM61542D8 2I2I                                                                               CAS005
LPM81538D2 1I0I                                                                               CAS005
DLV61522D1 1I1O                                                                               CAS005
DLI61558D1 1I4I                                                                               CAS005
DLM61542D8 2I2I                                                                               CAS005
DLM81538D2 1I0I                                                                               CAS005
ITV61622D1 3I1I                                                                               CAS005
ITI61658D1 1I4O                                                                               CAS005
ITM61632D8 2I2O                                                                               CAS005
ITM81638D2 1I0O                                                                               CAS005
TDV61622D1 3I1I                                                                               CAS005
TDI61658D1 1I4O                                                                               CAS005
TDM61632D8 2I2O                                                                               CAS005
TDM81638D2 1I0O                                                                               CAS005
FTV61622D1 3I1I                                                                               CAS005
FTI61658D1 1I4O                                                                               CAS005
FTM61632D8 2I2O                                                                               CAS005
FTM81638D2 1I0O                                                                               CAS005
CIV61622D1 3I1I                                                                               CAS005
CII61658D1 1I4O                                                                               CAS005
CIM61632D8 2I2O                                                                               CAS005
CIM81638D2 1I0O                                                                               CAS005
CDV61622D1 1I1I                                                                               CAS005
CDI61658D1 1I4O                                                                               CAS005
CDM61642D8 2I2O                                                                               CAS005
CDM81638D2 1I0O                                                                               CAS005
DTV61622D1 1I1I                                                                               CAS005
DTI61658D1 1I4O                                                                               CAS005
DTM61642D8 2I2O                                                                               CAS005
DTM81638D2 1I0O                                                                               CAS005
LTV61622D1 1I1I                                                                               CAS005
LTI61658D1 1I4O                                                                               CAS005
LTM61642D8 2I2O                                                                               CAS005
LTM81638D2 1I0O                                                                               CAS005
C1I61758D1 1I4I                                                                               CAS005
C1M61735D8 2I2I                                                                               CAS005
C1M81738D5 1I0I                                                                               CAS005
C2I61758D1 1I4I                                                                               CAS005
C2M61735D8 2I2I                                                                               CAS005
C2M81738D5 1I0I                                                                               CAS005
BDI61758D1 1I4I                                                                               CAS005
BDM61735D8 2I2I                                                                               CAS005
BDM81738D5 1I0I                                                                               CAS005
BPI61758D1 1I4I                                                                               CAS005
BPM61735D8 2I2I                                                                               CAS005
BPM81738D5 1I0I                                                                               CAS005
ILV61522D1 3I1O                                                                               CAS005
ILI61558D1 1I4I                                                                               CAS005
ILM61542D8 2I2I                                                                               CAS005
ILM81538D2 1I0I                                                                               CAS005
IDV61622D1 3I1I                                                                               CAS005
IDI61658D1 1I4O                                                                               CAS005
IDM61642D8 2I2O                                                                               CAS005
IDM81638D2 1I0O                                                                               CAS005
CSM61822D1 1Y1I                                                                               CAS005
TIV31574D2 1I3O                                                                               CDL022
TIM41574D2 1I3I                                                                               CDL022
IPV31574D2 1I3O                                                                               CDL022
IPM41574D2 1I3I                                                                               CDL022
TDV31674D2 1I3I                                                                               CDL022
TDM41674D2 1I3O                                                                               CDL022
ITV31674D2 1I3I                                                                               CDL022
ITM41674D2 1I3O                                                                               CDL022
CFV11622D1 3I1I                                                                               CDL033
CFI21657D1 1I4O                                                                               CDL033
CFM11632D7 2I2O                                                                               CDL033
CFM21637D2 1I0O                                                                               CDL033
CFV61622D1 3I1I                                                                               CDL033
CFI61658D1 1I4O                                                                               CDL033
CFM61632D8 2I2O                                                                               CDL033
CFM81638D2 1I0O                                                                               CDL033
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** FRQ - FREQUENCIES REQUIRING NON-WORKING DAY CHECK
FLRSW
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
