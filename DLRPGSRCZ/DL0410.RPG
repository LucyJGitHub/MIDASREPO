     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Forward revaluation')                         *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
     F*                                                               *
     F*  DL0410  -  FORWARD REVALUATION.                              *
     F*                                                               *
      *  Called By: DLC0608 - Forward Revaluation                     *
      *                                                               *
      *  Note:      Developers/Fixers - Program DL0411 runs instead   *
      *             of DL0410 when Profit Centre Accounting is        *
      *             switched on.  Any changes made to this program    *
      *             should be duplicated in DL0411.                   *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. 259866             Date 25Oct23               *
      *  Prev Amend No. CSD103             Date 10Aug20               *
      *                 MD049609           Date 21Feb18               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 135952             Date 11May16               *
      *                 MD036289A          Date 11May16               *
      *                 MD036289           Date 11May16               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 01Sep14               *
      *                 AR720506           Date 19Aug14               *
      *                 258435             Date 16Jan09               *
      *                 AR828127           Date 21Dec12               *
      *                 AR813358           Date 18Dec12               *
      *                 CSW212             Date 03May12               *
      *                 259031             Date 31Jul12               *
      *                 262151             Date 27Oct09               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 247250             Date 14May07               *
      *                 BUG13768           Date 23Apr07               *
      *                 244711             Date 04Jan07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 05Jul06               *
      *                 BUG10877           Date 19Apr06               *
      *                 BUG11232           Date 12Apr06               *
      *                 BUG11203           Date 10Apr06               *
      *                 CSD031             Date 10Apr06               *
      *                 BUG9453            Date 30Nov05               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 BUG5336R *REOPEN   Date 17Jun05               *
      *                 BUG7256            Date 19May05               *
      *                 CSW037A            Date 02May05               *
      *                 CAS008             Date 16Jun04               *
      *                 227580             Date 28Jun04               *
      *                 227579             Date 14Jun04               *
      *                 225831             Date 19Mar04               *
      *                 225302             Date 27Feb04               *
      *                 225189             Date 18Feb04               *
      *                 BUG5336            Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 BUG1813            Date 08Apr04               *
      *                 BUG1810            Date 08Apr04               *
      *                 BUG1811            Date 08Apr04               *
      *                 TDA110             Date 05Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 220200             Date 31Jul03               *
      *                 220199             Date 31Jul03               *
      *                 219337             Date 26Jun03               *
      *                 219336             Date 26Jun03               *
      *                 219334             Date 26Jun03               *
      *                 219333             Date 26Jun03               *
      *                 CAS005             Date 16Dec02               *
      *                 CGL020             Date 12Dec02               *
      *                 213046             Date 15Nov02               *
      *                 217120             Date 21Apr03               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 209177             Date 13Jan03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 199516             Date 14Aug02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAS001             Date 23Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 138010             Date 20Jun01               *
      *                 192193             Date 18Jun01               *
      *                 140797             Date 03May01               *
      *                 CDE002             Date 05Dec00               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 187356             Date 08Jan01               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 142799             Date 09May00               *
     F*                 170442             Date 28Mar00               *
     F*                 157652             Date 29Mar99               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 158840             Date 06May99               *
      *                 155225             Date 16Apr99               *
      *                 153673             Date 10Feb99               *
      *                 CSD005             Date 01MAR99               *
      *                 CTI002             Date 23Sep98               *
      *                 135952             Date 11OCT98               *
      *                 142250             Date 08OCT98               *
     F*                 151153             Date 21DEC98               *
      *                 145193             Date 16OCT98               *
     F*                 140989             Date 29SEP98               *
     F*                 139778             Date 30Jul98               *
      *                 CEU011             Date 11Mar98               *
     F*                 129805             Date 13Feb98               *
     F*                 106646             Date 28Jan98               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 S01408             DATE 29APR96               *
     F*                 S01408             DATE 04APR96               *
     F*                 089129             DATE 28JUL95               *
     F*                 087548             DATE 19MAY95               *
     F*                 S01408             DATE 13APR95               *
     F*                 086125             DATE 16MAR95               *
     F*                 S01522             DATE 25JAN95               *
     F*                 054383             DATE 27MAY94               *
     F*                 040070             DATE 10JAN94               *
     F*                 S01440             DATE 07OCT93               *
     F*                 S01432             DATE 27JUL93               *
     F*                 S01393             DATE 11AUG92               *
     F*                 S10736             DATE 03SEP92               *
     F*                 E39370             DATE 30APR92               *
     F*                 E27018             DATE 28AUG91               *
     F*                 DT0154             DATE 02MAY91               *
     F*                 S01328             DATE 04FEB91               *
     F*                 E21556             DATE 03SEP90               *
     F*                 E22164             DATE 12AUG90               *
     F*                 E21634             DATE 04MAR90               *
     F*                 E16086             DATE 06FEB90               *
     F*                 S01182             DATE 12DEC89               *
     F*                 LN0816             DATE 09OCT90               *
     F*                 LN0761             DATE 17SEP90               *
     F*                 BHF589             DATE 06SEP90               *
     F*                 S01303             DATE 24AUG90               *
     F*                 LN0363             DATE 13JUN90               *
     F*                 LN0188             DATE 15MAY90               *
     F*                 S01178             DATE 17APR90               *
     F*                 E296               DATE 03APR90               *
     F*                 E148               DATE 06DEC89               *
     F*                 E151               DATE 06DEC89               *
     F*                 E157               DATE 06DEC89               *
     F*                 E158               DATE 06DEC89               *
     F*                 E137               DATE 01DEC89               *
     F*                 E19341             DATE 25OCT89               *
     F*                 E15224             DATE 25OCT89               *
     F*                 E17662             DATE 25OCT89               *
     F*                 E14293             DATE 25OCT89               *
     F*                 S01117             DATE 21/02/89              *
     F*                 S01194             DATE 21/02/89              *
     F*                 S03220             DATE 10/05/88              *
     F*                 E12711             DATE 09/03/88              *
     F*                 E12096             DATE 18/01/88              *
     F*                 E10953             DATE 07/10/87              *
     F*                 S01119             DATE 15/06/87              *
     F*                 S1107              DATE 20/06/86              *
     F*                 E47226             DATE 13/06/86              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  Note:      Developers/Fixers - Program DL0411 runs instead   *
      *             of DL0410 when Profit Centre Accounting is        *
      *             switched on.  Any changes made to this program    *
      *             should be duplicated in DL0411.                   *
      *                                                               *
      *  259866 - First day on the Forward Rates table should be set  *
      *           to zero. Applied fix 148772.                        *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD049609 - Adjustment of forward day and rate array          *
      *             (entries per table)                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  135952 - Exclude single currency payments from fwd           *
      *           revaluation for a funds transfer payment (FPVNTDD). *
      *           Applied for MD034900                                *
      *  MD036289A - UseForwardRateReval is not checked correctly.    *
      *              Remove also unnecessary codes in setting up      *
      *              rates and dates.                                 *
      *            - Applied for MD038095.                            *
      *  MD036289 - Forward rate is wrong. Rate interpolation should  *
      *             be done for dates in between.                     *
      *           - Applied for MD038095.                             *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  AR720506 - Allow user to choose if Forward Rates or Spot     *
      *             rate will be used in Forward Revaluation.         *
      *             Introduced new system value UseForwardRateReval   *
      *             so that core processing will not be affected.     *
      *             (Child: AR720507)                                 *
      *  258435 - Allow user to define parameter for calculation of   *
      *           forward days. Use new system value ForwardDays,     *
      *           whose permitted values are as follows:              *
      *           WR = Working Days from Run Date                     *
      *           WS = Working Days from Spot Date                    *
      *           CR = Calendar Days from Run Date                    *
      *           CS = Calendar Days from Spot Date                   *
      *           Apply fix 255972.                                   *
      *  AR828127 - Branch header missing in some reports. *IN12      *
      *             should be checked as well. (Child: AR828128)      *
      *  AR813358 - Data mapping error on member EODPOPD, fix is to   *
      *             apply part of fix 249489 to correctly initialise  *
      *             TRAT and other numeric fields. Also apply fix     *
      *             CGL120 for ORAMT NITMS CHGA. (Child: AR813359)    *
      *  CSW212 - SWIFT 2012 Changes (Recompile)                      *
      *  259031 - Forward Revaluation postings differences between    *
      *           R4 and MidasPlus. Reversed fix 135952.              *
      *  262151 - Incorrect forward revaluation rate calculated.      *
      *           Align Days array and Rate arrays. Applied fix       *
      *           241940.                                             *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  247250 - Applied fix BUG9453.                                *
      *  BUG13768 - External field name entry is longer than six(6)   *
      *             characters                                        *
      *  244711 - Pass FSPRLA to WKPRLA when ECCY is equal to BJCYCD  *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  BUG10877 - Blank currency codes in GEFRPD                    *
      *  BUG11232 - CCY is blank on GEFRPD if account found on ACCNT  *
      *  BUG11203 - DLC0608 00002 Dbase error 16 File DEALSDC         *
      *  BUG9453- Print RX principal amounts only if both CIR003 and  *
      *           CAS008 are ON.                                      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  BUG5336R - Rename work fields to indicate current length.    *
      *           - WDLDS must remain original length.                *
      *  BUG7256- Customer number and account not being set up if     *
      *           account not already exist in ACCNT.                 *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CAS008 - IAS39 Enhancements                                  *
      *  227580 - Skip call to access program AOBOOKR0 for deal types *
      *           NX (nostro transfer) as NX deals have blank book    *
      *           codes.                                              *
      *  227579 - Attempts to write to a closed file DL0410P3.        *
      *  225831 - If yield curve rate combination is not found, print *
      *           'Rates Missing' and do not compute for profit/loss. *
      *  225302 - GLC30 fails. Three records was produced in GEFRZZ.  *
      *  225189 - Ensure that *IN08 is reset between each branch      *
      *           process                                             *
      *  BUG5336- Incorrect length for WDLDS                          *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  BUG1813- Initialize cheque number field.                     *
      *  BUG1810- Wrong length for ACCNTAB AND GEFRPD and wrong       *
      *           postion for field ACOD                              *
      *  BUG1811- RECI of 'D' was being output to GEFRPD. should be P *
      *  TDA110 - Include book code for FT transactions for reval.    *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  220200 - Incorrect field length for WFLDS.                   *
      *         - Incorrect indicators for GEFRPD. U1 must be         *
      *           specified to prevent writing to GEFRPD when BRAR    *
      *           index variable A is zero and &FREVAL = 'N'          *
      *           (DLC0608).                                          *
      *  220199 - A blank page is sometimes printed on DL0411P1       *
      *           because Total Time calculations do not fetch        *
      *           overflow.                                           *
      *  219337 - Incorrect revaluation and profit/loss amount for    *
      *           method other than 'N' or ' '.                       *
      *  219336 - Dealt Equivalent and Revalued Equivalent amount     *
      *           always reported negative.                           *
      *  219334 - Writes 'NO DETAILS TO REPORT' on the audit report   *
      *           even there were details reported in DL0410P4        *
      *  219333 - Attempts to write to a closed file DL0410P4.        *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  CGL020 - Midas Compliance Watch - Additional A/C Postings    *
      *           Information                                         *
      *  213046 - Access book code details only if book code is not   *
      *           blanks.                                             *
      *  217120 - Net Profit/Loss Amounts for each reval type is      *
      *           incorrect                                           *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  209177 - Indicators 16 and 19 should only be used if the     *
      *           transaction came from file FPVNTDD (*IN12 = '1').   *
      *  199516 - Reverse fix 187356. Accdg to Account Keys manual    *
      *           swap deals are not revalued. Remove 14V1 & 14V2 in  *
      *           TABE1 data array, and 14V1 in TABE3.                *
      *  CAS001 - Net Present Value (NPV) Accounting                  *
      *  138010 - Allow 5 digits in Forward Rate. Previous fix #089129*
      *           incorporated in CORE M106PXXSRC but missing few lines
      *           and not working properly. Compared it with #128797 &*
      *           #129789 and added the missing lines .               *
      *  192193 - DL0410P2 not routed to correct OUTPUTQ.             *
      *  140797 - Event Type (ETYP) 91P7 was removed from Array TABE1 *
      *           because it is not necessary to have that Event Type *
      *           in generating the Revaluation of Forward Commitment *
      *           Report (DL0410P1).                                  *
      *  CDE002 - Data Export - CCRM Revenue Analysis.                *
      *  187356 - Swap deals (2nd leg) not included in system         *
      *           revaluation.                                        *
     F*  142799 - DL0410 not distributed to the correct output queue. *
     F*           Pass correct spool info to ZSFILE.                  *
      *  170442 - Mid-rate can not be reconciled with the interpolated*
      *           value from Forward rates table .  Enhanced core fix *
      *           129805 by applying associated 147688 .              *
      *  157652 - When both DL0410P1 and DL0410P2 are produced,       *
      *           neither is automatically distributed - fix is to    *
      *           pass the correct file name parameter to ZSFILE for  *
      *           the P2 report, instead of the P1 file name.         *
      *  CGL007 - Account Postings Enquiry                            *
      *  158840 - Nostro Transfer 'FROM & TO' postings (and Totals )  *
      *           both shown as Credit instead of  one Credit and one *
      *           Debit in  DL0410P1 .   Additional  error detected in*
      *           DL0410P2  printer file :  Payment Reference field   *
      *           'PREF'  not shown on reports and some overprinting  *
      *           occurred as a result of introducing the same .      *
      *            =>DBA2 only : reversed a line frm Core Gems#142250 *
      *           since the Header details were not printed on DL0410P2
      *           reports once it was fixed to split the revaluations *
      *           according to the Branch Codes.                      *
      *  155225 - Applied only part of the origin. fix done for DL0411.
      *           DL0410P2 'Revaluation of Forward Commitments- Consol*
      *           EUR position' doesn't split the report into separate*
      *           pages by Branch Codes .  The rest of #155225 deals  *
      *           with problem solved here by #153673 .
      *  153673 - When converting Dealt/ Revalued equivalent from Base*
      *           back to EUR ccy, reversed MULT/ DIV operation should*
      *           be performed depending on MDIN value .              *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDEXPMPD changed                  *
     F*  135952 - Exclude single currency payments from fwd           *
     F*           revaluation for a funds transfer payment (FPVNTDD). *
     F*  142250 - Error occured again after refresh so reinstated     *
     F*           version with EFIXCE.                                *
     F*  151153 - Trying to write to DL0410P2 while closed            *
     F*           Applied fixes 145369 and 147150.                    *
      *  145193 - Blank out the rate field to avoid incorrect rate.   *
     F*  140989 - EMU: Program should use the number of decimal       *
     F*           places for the EURO.                                *
     F*  139778 - EMU: Amounts shown for Consolidated Euro in Forward *
     F*                Revaluation Commitment report are all zeros.   *
      *  CEU011 - EMU Position/Risk Reporting.                        *
     F*  129805 - Program does not calculate Forward dates correctly. *
     F*           Amended program to increment Run date by No of Spot *
     F*           Days (working days only),  and then calculate the   *
     F*           Forward Date from this date; i.e. 90 days forward   *
     F*           is 90 calendar days from the Spot Date for the ccy. *
     F*           Amended program to do this.                         *
     F*  106646 - Exclude interbranch events on Payments Events file  *
     F*           FTVNTDD as well as EVNTXED, as per BHF589.          *
     F*  CAC001  -  Profit Centre Accounting Development:             *
     F*             Output profit center to the posting file GEFRPD   *
     F*             and print on the report.                          *
     F*  S01408  -  Addition of Core Hook DL0410OOP3                  *
     F*             Addition of Core Hook DL0410OOP4                  *
     F*  S01408  -  Addition of Core Hook DL0410CP15                  *
     F*             Addition of Core Hook DL0410CP14                  *
     F*             Addition of Core Hook DL0410CP13                  *
     F*             Addition of Core Hook DL0410CP12                  *
     F*             Addition of Core Hook DL0410CP11                  *
     F*             Addition of Core Hook DL0410CP10                  *
     F*             Addition of Core Hook DL0410CCP9                  *
     F*             Addition of Core Hook DL0410CCP8                  *
     F*             Addition of Core Hook DL0410CCP7                  *
     F*             Addition of Core Hook DL0410CCP6                  *
     F*             Addition of Core Hook DL0410CCP5                  *
     F*             Addition of Core Hook DL0410OOP2                  *
     F*             Addition of Core Hook DL0410OOP1                  *
     F*             Addition of Core Hook DL0410EEP2                  *
     F*             Addition of Core Hook DL0410EEP1                  *
     F*  089129 - Recompile over amended FWDRT file                   *
     F*  087548 - The monthly sub-totals carried prevous year values  *
     F*           for the next year if the month number is the same   *
     F*           for the previous and the next year. Fix is to set   *
     F*           monthly level break on if yearly break is on.       *
     F*  S01408  -  Addition of Core Hook DL0410CCPG                  *
     F*             Addition of Core Hook DL0410CCP2                  *
     F*             Addition of Core Hook DL0410FFPG                  *
     F*             Addition of Core Hook DL0410CCP1                  *
     F*             Addition of Core Hook DL0410OOPG                  *
     F*             Addition of Core Hook DL0410EEPG                  *
     F*             Addition of Core Hook DL0410CCP3                  *
     F*             Addition of Core Hook DL0410CCP4                  *
     F*  086125 - Add new parameter to AOPNARR0                       *
     F*  S01522 - Call to AOPNARR0 if switchable feature installed    *
     F*           and UDC present                                     *
     F*  054383 - Discrepancies in amounts calculated by this pgm.    *
     F*           1) The monthly and yearly sub-totals do not equal   *
     F*              the sum of individual totals, because the correct*
     F*              amount is not always used for option deals -     *
     F*              should use the lower of event date and start     *
     F*              date amounts                                     *
     F*           2) Should use half-adjust when scaling down the     *
     F*              final calculated revaluation, else the last      *
     F*              digit(s) may be truncated if the 2 currencies    *
     F*              have different no. of decimal places.            *
     F*  040070 - Events for a deal already rolled over should not    *
     F*           be included in revaluation.                         *
     F*  S01440 - Amended to ignore PI/SI deals if the 'Accruals      *
     F*           on Interest Outrights' flag on the dealing          *
     F*           I.C.D. is on.                                       *
     F*  S01432 - Recompile over changed version of FWDRT             *
     F*  S01393 - Recompiled for Strategic Risk Management            *
     F*           Book Code added to PF/EVNTXED                       *
     F*  S10736 - MANAGEMENT ACCOUNTING                               *
     F*  E39370 - IF NOT POSTING DO NOT PRINT 'VALUE' ON AUDIT REP    *
     F*  E27018 - LN0816 NOT CORRECT. CAUSES REPORT TO PRINT OVER     *
     F*           THE END OF THE PAGE SOMETIMES WHEN IT IS THE END    *
     F*           OF A CURRENCY OR BRANCH. REMOVE LN0816.             *
     F*  DT0154 - FIX E21556 IS WRONG FOR EVENT CCYS WHICH HAVE A     *
     F*           DIVIDE RATE & LESS DECIMAL PLACES THAN THE          *
     F*           BASE CCY DECIMAL PLACES.                            *
     F*  S01328 - FRA/IRS REVALUATION                                 *
     F*  E21556 - CALCULATED REVALUED EQUIVALENT IS INCORRECT.        *
     F*           CERTAIN CIRCUMSTANCES HAVE NOT BEEN COVERED         *
     F*           WHEN WORKING WITH THE RATE FIELD.                   *
     F*  E22164 - IF OPTION DEAL IS IN BASE CURRENCY IT SHOULD        *
     F*           BYPASS REVALUATION.                                 *
     F*  E21634 - COMPLETE E16086                                     *
     F*  E16086 - ENSURE FT EVENTS TRAILER DOES NOT INCLUDE REGULAR   *
     F*           PAYMENTS, FOR CONSISTENCY WITH EVENTA/LF.           *
     F*  S01182 - Writes new account posting fields to the            *
     F*           file PF/GEFRPD for MIS.                             *
     F*  LN0816 - EXTRA HEADINGS PRODUCED BECAUSE OF OVFLOW INDICATOR *
     F*           EVEN THOUGH THERE WERE NO MORE DETAILS FOR THAT BR. *
     F*  LN0761 - THE P1 AND AU USED THE SAME VARIABLE TO COUNT PAGES *
     F*         - THE ACCUMALATION OF MONTHLY SUB-TOTALS WAS NOT      *
     F*           DEPENDENT ON THE REQUESTED BRANCH                   *
     F*         - ZSFILE WAS BEING UPDATED EVEN THOUGH THE P1         *
     F*           WAS EMPTY AND THEREFORE NOT PRODUCED                *
     F*  BHF589 - EXCLUDE INTERBRANCH EVENTS                          *
     F*  S01303 - ADDITION OF MONTHLY SUMMARY - NOTE THIS MAY         *
     F*           ONLY BE NEW YORK CHANGE                             *
     F*  LN0363 - 'END OF REPORT' NOT BEING PRINTED WHEN CHANGE OF    *
     F*           BRANCH BUT NOT OF CURRENCY FOR EVENTS TO BE         *
     F*           INCLUDED                                            *
     F*  LN0188 - COUNTS AND HASH TOTALS ARE WRONG                    *
     F*  S01178 - FUNDS TRANSFER ENHANCEMENTS                         *
     F*  E296   - Should read SDBANK when run on empty files          *
     F*  E148   - Branch refered to in heading of report when mbin    *
     F*           is off                                              *
     F*  E151   - Incorrect sign for totals of 'amount' field on      *
     F*           report                                              *
     F*  E157   - Incorrect end of report message when mbin off       *
     F*  E158   - Branch code not set up when multibranching off      *
     F*  E137   - Suppress AU end of report message                   *
     F*  E19341 - Fields NRBR & NRBG redefined as 5 characters        *
     F*           long in accordance with SDS.                        *
     F*  E15224 - AMEND PROGRAM SO THAT OPTION TO DATE IS OUTPUT      *
     F*           FOR OPTIONS(I.E EVENT DATE)                         *
     F*  E17662 - AMEND INPUT SPEC FOR FWDRT TO AGREE WITH THE        *
     F*           EXTERNAL SPECIFICATION.                             *
     F*  E14293 - S01119 INCORRECTLY USED THE EAMSGN FIELD TO         *
     F*           DETERMINE WHETHER TO ADD OR SUBTRACT EVENT AMOUNT   *
     F*           FROM/TO TOTAL AMOUNT.                               *
     F*  S01194 - STANDING DATA CHANGES - TO USE ACCESS PROGRAMS      *
     F*  S01117 - AMENDMENTS FOR MULTIBRANCHING R10                   *
     F*  S03220 - FUNDS TRANSFER                                      *
     F*  E12711 - REVERSING OUT FIXES E10953 & E12096.                *
     F*  E12096 - PROFIT/LOSS AMOUNT REPORTED WITH WRONG NUMBER       *
     F*           OF DECIMAL PLACES. AMENDMENT TO E10953.             *
     F*  E10953 - CHECK IF WK159 EQUALS ZERO WHEN USING A CURRENCY    *
     F*           WITH 0 DECIMAL PLACES AND VERY SMALL FORWARD        *
     F*           RATES. REVALUED EQUIVALENT,PROFIT/LOSS FIELDS ARE   *
     F*           INCREASED TO HOLD COMPLETE VALUE.                   *
     F*  S01119 - FRA/IRS INCORPORATION.                              *
     F*  S1107  - TO USE THE START DATE OR RUN DATE FOR AN OPTION     *
     F*           DEAL.                                               *
     F*****************************************************************
0013 F***EVENT   IP  E           K        DISK                            S03220
     F/COPY WNCPYSRC,DL0410FAC1
0013 F***EVENTA**IP  E           K        DISK                     S03220 CEU011
      *                                                                   CEU011
     F/COPY WNCPYSRC,DL0410F001
     F**********DLEVNAL1IP  E           K        DISK                                  CEU011 CAS001
     FDLEVNPL1IP  E           K        DISK                                                   CAS001
      ** Merged Events for Forward Revaluation NPV Method                                     CAS001
      *                                                                                       CAS001
     F***DLEVNPL2IF  E           K        DISK                                         CAS001 CAS004
     F**********  EVNTXEDF                          KRENAMEEVNTXDDF                    CAS001 CAS004
      ***Dealing*Events*by*Deal*no.*for*Forward*Revaluation*NPV*Method*                CAS001 CAS004
      *                                                                                       CAS001
     FDLDLDBL1UF  E           K        DISK                                                   CAS001
     F            DEALSDBF                          KRENAMEDEALSBBF                           CAS001
      ** FX Deals by Deal Number for Forward Revaluation NPV Method                           CAS001
      *                                                                                       CAS001
     FDLDLDCL1IF  E           K        DISK                                                   CAS004
     F            DEALSDCF                          KRENAMEDEALSCCF                           CAS004
      ** MM Deals by Deal Number for Forward Revaluation NPV Method                           CAS004
      *                                                                                       CAS004
     FDLDLDGLEIF  E           K        DISK                                                   CAS008
     F            DEALSDGF                          KRENAMEDEALSGGF                           CAS008
      ** FRA/IRSs by Deal Number for Forward Revaluation NPV Method                           CAS008
      *                                                                                       CAS008
     FRXCFLAPDO   E                    DISK                                                   CAS008
      ** Cross Currency Cash flow by Deal Number                                              CAS008
      *                                                                                       CAS008
     FSDYLDCL1IF  E           K        DISK                                                   CAS008
      ** Yield Curves File                                                                    CAS008
      *                                                                                       CAS008
     FFDDTSTL1IF  E           K        DISK                                                   CDL038
      ** Deal Types/Sub Types                                                                 CDL038
      *                                                                                       CDL038
     F/COPY WNCPYSRC,DL0410F002
     FFPVNTZZ IF  E                    DISK                               S01178
     F/COPY WNCPYSRC,DL0410F003
0014 F**********TABLE   IF  F      96 12AI     2 DISK                     S01194
0015 F**********ACCNT   IF  F     400 15AI     2 DISK                     S01117
0015 F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
0015 F***ACCNT   IF  F     410 24AI     2 DISK                                        CGL029 BUG1810
     FACCNT   IF  F     573 24AI     2 DISK                                                  BUG1810
     F**********TABLED  IF  F      96 12AI     2 DISK                     S01194
0016 F*FWDRT***IF**F*****256  3AI     2 DISK                              S01328
0014 F*FWDRT***IF  F     261  3AI     2 DISK                       S01328 S01432
0014 F*FWDRT***IF  F     436  3AI     2 DISK                       S01432 089129
0014 FFWDRT   IF  F     611  3AI     2 DISK                               089129
     F/COPY WNCPYSRC,DL0410F004
0017 FGEFRHH  O   F     160            DISK                           U1
0017 F****GEFRPD  O   F     160        DISK                           U1  S01182
0017 F***GEFRPD**O   F     268            DISK                 U1  S01182 CGL007
0017 F*GEFRPD*O***F     331            DISK                           U1               CGL007 CGL020
0017 F***GEFRPD* O   F     589            DISK                           U1            CGL020 CGL029
0017 F***GEFRPD* O   F     599            DISK                           U1           CGL029 BUG1810
     F/COPY WNCPYSRC,DLH00475
     FGEFRPD  O   F     620            DISK                           U1                     BUG1810
     F/COPY WNCPYSRC,DLH00476
0017 FGEFRZZ  O   F     160            DISK                           U1
     FDLPOSTL0UF  E           K        DISK                      A    U1                      CAS005
     F            APOSTPDF                          KRENAMEDLPOSTF                            CAS005
0015 FSDBRCHL1IF  E           K        DISK                               S01194
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0410FFPG                                           S01408
      *                                                                                       CAS001
     FDLNPVLPDO   E                    DISK                                                   CAS001
      * Revalued Forward Commitments File                                                     CAS001
     FDL0410P3O   E                    PRINTER      KINFDS SPOOL3     UC                      CAS001
      ** Printer File for Revaluation method "F"                                              CAS001
     FDL0410P4O   E                    PRINTER      KINFDS SPOOL4     UC                      CAS001
      ** Printer File for Revaluation method "B"                                              CAS001
     FDL0410P5O   E                    PRINTER      KINFDS SPOOL5     UC                      CAS001
      ** Printer File for Revaluation method "D"                                              CAS001
     F*                                                                   S01408
0018 F**********DL0410P1O   F     132     OF     PRINTER           S01124 S01117
     FDL0410P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
      *                                                                   CEU011
     FDL0410P2O   E                    PRINTER      KINFDS SPOOL2     UC  CEU011
0018 FDL0410AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
0019 F* ID F  C  H  L    FUNCTION OF INDICATORS
0020 F**04************TABLE FILE I.C.D. RECORD 1                          S01194
0021 F**05***********************I.C.D. RECORD 2                          S01194
0022 F**06***********************I.C.D. RECORD 5
0023 F* 07                       BRANCH CODES RECORD
0024 F* 08                       CURRENCY RECORD
0025 F* 09                       ACCOUNT CODES
0026 F* 10            FORWARD RATES DETAIL
0027 F* 11            ACCOUNT MASTER DETAIL
0028 F* 01            EVENT FILE HEADER
0029 F* 02                       DETAIL
0030 F* 03                       TRAILER
0027 F* 12            DETAIL FPVNTDD                                      S03220
     F*      N14     P1 NOT OPENED/WRITTEN TO SO 'NO DETAILS TO REPORT'   S01117
0031 F*    15         LEDGER BALANCE POSITIVE
     F*       16      FT - Nostro Transfer 'FROM' ---> Outgoing           158840
     F*       19      FT - Nostro Transfer 'TO '  ---> Incoming           158840
0032 F*       20      FORWARD REVALUATION OF INTEREST INDICATOR ON
0033 F*       21      EVENT TO BE INCLUDED IN REVALUATION
0034 F*       22      EVENT TYPE IS ON EVENT TABLE 3
0035 F*       23      P/L AMOUNT POSITIVE
0036 F*       24      TOTAL P/L AMOUNT FOR CURRENCY POSITIVE
0037 F*       25      TOTAL CURRENCY AMOUNT IS POSITIVE
0038 F*       26      TOTAL P/L AMOUNT POSITIVE
0039 F*       27      FIRST DETAIL RECORD NOT FOUND.
0040 F*       28      FIRST EVENT FOR A CURRENCY
0041 F*       29      TRAILER RECORD READ
0042 F*       30      ALL DATES ENTERED IN ARRAY
0042 F*       32      PRINT DEAL TYPE/SUB TYPE HEADINGS                   S01328
0043 F********32******DIVIDE RATE FOR CURRENCY****************            S01194
 043 F*       33      EVENT AMOUNT NEGATIVE
0042 F********34******WK159 EQUALS ZERO                             E10953E12711
0044 F*       35      EVENT DATE EARLIER THAN NTH DATE IN ARRAY.
0045 F*       36      EVENT DATE EQUALS N-1 TH DATE IN ARRAY
     F*       38      '-' SIGN FOR YEARLY SUB-TOTAL OF DBCE               S01303
     F*       39      '-' SIGN FOR YEARLY SUB-TOTAL OF REVA               S01303
0046 F*       40      CHAIN FAIL
     F*       48      '+' SIGN FOR ACCUMULATED VALUE OF DBCE FOR CCY      S01303
     F*       49      '-' SIGN FOR ACCUMULATED VALUE OF DBCE FOR CCY      S01303
0047 F*       51      P/L AMOUNT NEGATIVE
     F*       57      '+' SIGN FOR MONTHLY SUB-TOTAL OF PROFIT/LOSS AMT   S01303
     F*       58      '-' SIGN FOR MONTHLY SUB-TOTAL OF PROFIT/LOSS AMT   S01303
     F*       59      '+' SIGN FOR YEARLY SUB-TOTAL OF EAMT               S01303
     F*       64      '+' SIGN FOR MONTHLY SUB-TOTAL OF EAMT              S01303
     F*       65      '-' SIGN FOR MONTHLY SUB-TOTAL OF EAMT              S01303
     F*       66      '+' SIGN FOR MONTHLY SUB-TOTAL OF DBCE              S01303
     F*       67      '-' SIGN FOR MONTHLY SUB-TOTAL OF DBCE              S01303
     F*       68      '+' SIGN FOR MONTHLY SUB-TOTAL OF REVA              S01303
     F*       69      '-' SIGN FOR MONTHLY SUB-TOTAL OF REVA              S01303
     F*       77      '-' SIGN FOR YEARLY SUB-TOTAL OF EAMT               S01303
     F*       78      '+' SIGN FOR YEARLY SUB-TOTAL OF DBCE               S01303
     F*       79      DETAIL WRITTEN TO P1                                LN0363
     F*       81      IND. TO CHECK FOR MONTHLY BREAK                     S01303
     F*       82      IND. TO CHECK FOR YEARLY BREAK                      S01303
     F*       83      OUTPUT CONTROL IND.                                 S01303
     F*       84      '+' SIGN FOR YEARLY SUB-TOTAL OF REVA               S01303
0046 F*       85      Multibranching off                                  E157
     F*       86      '+' SIGN FOR YEARLY SUB-TOTAL OF PROFIT/LOSS AMT    S01303
     F*       87      '-' SIGN FOR YEARLY SUB-TOTAL OF PROFIT/LOSS AMT    S01303
     F*       88      '+' SIGN FOR ACCUMULATED VALUE OF REVA FOR CCY      S01303
     F*       89      '-' SIGN FOR ACCUMULATED VALUE OF REVA FOR CCY      S01303
0048 F*       U1      GEFR TO BE CREATED
     E*                                                                   S01408
     E/COPY WNCPYSRC,DL0410EEPG                                           S01408
     E*                                                                   S01408
     E/COPY ZSRSRC,ZHOLE                                                  129805
     E                    CPY@    1   1 80
0049 E                    POWER   1   7  7 3
     E**********          BRAR      999  3 0                              S01117
     E                    BRAR      999  3                                S01117
     E**********          BICA      999  6 0                                                  CSD027
     E                    BICA      999  6                                                    CSD027
     E                    TBR       999 13 0
     E                    TBP       999 13 0                                                  CAS005
     E                    TBL       999 13 0                                                  CAS005
0050 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0051 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0052 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0053 E                    INT         2 15 0
0054 E                    DEC         2  3 0
0055 E********************DFW        26  3 0                              S01328
0055 E********************DFW        26  5 0                        S01328129805
0055 E**********          DFW        25  5 0                                           129805 262151
     E**********          DFW        26  5 0                                         262151 MD049609
     E                    DFW        25  5 0                                                MD049609
0056 E***********         DAT        26  5 0A                             170442
0057 E***********         RAT        26 13 8                              170442
     E/COPY WNCPYSRC,DL0410E003
     E**********          DAT        27  5 0A                                          170442 262151
     E**********          RAT        27 13 8                                           170442 262151
     E**********          DAT        26  5 0A                                        262151 MD049609
     E**********          RAT        26 13 8                                         262151 MD049609
     E                    DAT        27  5 0A                                               MD049609
     E                    RAT        27 13 8                                                MD049609
     E/COPY WNCPYSRC,DL0410E004
0057 E                    RFW        25 13 8                              E17662
0058 E***                 TABE1   1   8  4                                S03220
0058 E********            TABE1   1  17  4                         S03220 187356
     E***********         TABE1   1  19  4                         187356 140797
     E**********          TABE1   1  18  4                                             140797 199516
     E**********          TABE1   1  16  4                                             199516 CAS008
     E                    TABE1   1  20  4                                                    CAS008
0059 E********************TABE2***1**10**4*****************************   S01119
0059 E********************TABE2   1  14  4                         S01119 S01328
0059 E                    TABE2   1  15  4                                S01328
0060 E***                 TABE3   1  11  4                                S03220
     E*                                                                   S01408
     E/COPY WNCPYSRC,DL0410EEP1                                           S01408
     E*                                                                   S01408
0060 E********            TABE3   1  15  4                         S03220 187356
0060 E**********          TABE3   1  16  4                                             187356 199516
0060 E                    TABE3   1  15  4                                                    199516
     E*                                                                   S01408
     E/COPY WNCPYSRC,DL0410EEP2                                           S01408
     E*                                                                   S01408
     E                    DTX     1   3  2                                S01328
     E                    DTH     1   3 35                                S01328
     E/COPY WNCPYSRC,DL0410E001
     E                    TEXT    1   1 70                                S01522
     E/COPY WNCPYSRC,DL0410E002
      *                                                                   CEU011
     E/COPY ZSRSRC,ZSEDITZ1                                               CEU011
 061 I*    EVENTS FILE - HEADER RECORD.
0062 I*
0063 IEVNTXECF    01
0065 I*
0066 I*
0067 I*    EVENTS FILE - DETAIL RECORD.
0068 I*
0069 IEVNTXEDF    02
     I              DLNO                            EDLNO
     I**************CNUM                            ECNUM                 S01117
     I              CUNR                            ECNUM                 S01117
     I***********                                   ECCY  L2              S01117
     I                                              ECCY  L1              S01117
     I*****                                         BRCD  L1              S01117
     I              EBRC                            BRCA  L2              S01117
     I/COPY WNCPYSRC,DL0410I006
0069 IFPVNTDDF    12                                                      S03220
     I**************CNUM                            ECNUM           S03220S01117
     I              CUNR                            ECNUM                 S01117
     I              RATE                            ERATE                 S03220
     I**********                                    ECCY  L2              S03220
     I                                              ECCY  L1              S01117
     I**********                                    BRCD  L1       S03220 S01117
     I                                              BRCA  L2              S01117
     I/COPY WNCPYSRC,DL0410I007
0117 I*
0118 I*
0119 I*    EVENTS FILE - TRAILER RECORD.
0120 I*
0121 IEVNTXZZF    03
0126 I*
0127 I*    ACCOUNT MASTER FILE - DETAIL.
0128 I*
0129 IACCNT   NS  11   1 CD
0130 I                                        1   1 RECI
0131 I                                        2  16 ACMDKY
0132 I**********                              2   70CNUM                                      CSD027
0132 I                                        2   7 CNUM                                      CSD027
0133 I                                        8  10 CCY
0134 I**********                             11  140ACOD                                      CGL029
0134 I                                       11  140ACODQQ                                    CGL029
0135 I                                       15  160ACSQ
0136 I**********                             23  250BRCD                  S01117
0136 I                                       23  25 BRCA                  S01117
0137 I                                       26  26 ATYP
0138 I                                       27  27 STYP
0139 I                                       29  29 ACST
0140 I                                    P  30  320DACO
0141 I                                    P  33  350DACC
0142 I                                       36  55 ANAM
0143 I                                    P  56  630LDBL          1515
0144 I                                    P  64  710CLBL
0145 I                                       72  72 STFQ
0146 I                                       73  740STDY
0147 I                                    P  75  770LSTD
0148 I                                    P  78  800NSTD
0149 I                                    P  81  820LSTP
0150 I                                    P  83  900CFSB
0151 I                                    P  91  930LMVD
0152 I                                    P  94 1010EPLB
0153 I                                    P 102 1090EPCB
0154 I                                    P 110 1170YTDB
0155 I                                      118 118 GLBT
0156 I                                    P 138 1400LIMC
0157 I                                    P 178 1837CDIR
0158 I                                    P 184 1897CCIR
0159 I                                      190 1990ACNO
0160 I                                      200 200 RETB
0161 I                                      201 201 ODSC
0162 I                                    P 202 2070ODLN
0163 I                                    P 208 2100ODED
0164 I                                    P 211 2120DIOD
0165 I                                      213 2150FACT
0166 I                                      216 2170FCNO
0167 I                                      218 219 EFAC
0168 I                                    P 220 2270HELD
0169 I                                    P 228 2330MINB
0170 I                                    P 234 2360LACD
0171 I                                    P 237 2380LISP
0172 I                                    P 239 2410RRNM
0173 I**********                            242 2430DRIB                                      CSD103
0173 I                                      242 243 DRIB                                      CSD103
0174 I                                    P 244 2497DRIS
0175 I                                    P 250 2520DRCD
0176 I                                      253 2530DRIC
0177 I                                      254 254 DRIF
0178 I                                      255 2560DRDY
0179 I                                    P 257 2590NDID
0180 I                                    P 260 2620LDID
0181 I                                    P 263 2690LDIA
0182 I                                      270 270 SDAP
0183 I                                    P 271 2730LPAR
0184 I                                    P 274 2800DIIE
0185 I                                    P 281 2882DAIC
0186 I                                    P 289 2950MADI
0187 I                                    P 296 3020GADI
0188 I                                      303 303 DDIS
0189 I                                    P 304 3060DDIA
0190 I**********                            310 3110OLDB                                      CSD103
0190 I                                      310 311 OLDB                                      CSD103
0191 I                                    P 312 3177OLDS
0192 I**********                            318 3190CRIB                                      CSD103
0192 I                                      318 319 CRIB                                      CSD103
0193 I                                    P 320 3257CRIS
0194 I                                    P 326 3280CRCD
0195 I                                      329 3290CRIC
0196 I                                      330 330 CRIF
0197 I                                      331 3320CRDY
0198 I                                    P 333 3350NCID
0199 I                                    P 336 3380LCID
0200 I                                    P 339 3450LCIA
0201 I                                      346 346 SCAP
0202 I                                    P 347 3490LPAP
0203 I                                    P 350 3560CIIE
0204 I                                    P 357 3642CAIC
0205 I                                    P 365 3710MACI
0206 I                                    P 372 3780GACI
0207 I                                      379 379 CDIS
0208 I                                    P 380 3820DCIA
0209 I**********                            386 3870OLCB                                      CSD103
0209 I                                      386 387 OLCB                                      CSD103
0210 I                                    P 388 3937OLCS
0211 I                                    P 394 3960LCD
0212 I                                      397 397 CHTP
0213 I                                    P 398 4000TNLU
0134 I*********                             401 4100ACOD                              CLG029 BUG1810
0134 I                                      554 5630ACOD                                     BUG1810
0214 I                                        1 200 ACC1
0215 I                                      201 400 ACC2
     I/COPY WNCPYSRC,DL0410I009
0216 I*
0217 I*   CATCHALL
0218 I        NS
     I/COPY WNCPYSRC,DL0410I005
0219 I*
0220 I*
0221 I*    FORWARD RATES FILE - HEADER RECORD.
0222 IFWDRT   NS  10   1 CD
0223 I                                        1   1 RECI
0224 I                                        2   4 CCY
0225 I**********                          P   3  54 DFW                   E17662
0226 I**********                          P  48 229 RAT                   E17662
0225 I************************************P   5  54 DFW            E17662 S01328
0226 I************************************P  55 229 RFW            E17662 S01328
0227 I************************************P 250 2520LCD                   S01328
0228 I************************************  253 253 CHTP                  S01328
0229 I************************************P 254 2560TNLU                  S01328
0225 I                                    P   5  79 DFW                   S01328
0226 I                                    P  80 254 RFW                   S01328
0227 I                                    P 255 2570LCD                   S01328
0228 I                                      258 258 CHTP                  S01328
0229 I                                    P 259 2610TNLU                  S01328
0230 I*
0231 I*    CATCHALL FOR DELETED RECORDS
0232 I*
0233 IFWDRT   NS
0234 I*
0235 I***********    TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.     S01194
0236 I***********                                                         S01194
0237 I**********TABLE   NS  04   2 C0   3 C1  12 C1                       S01194
0238 I**********       AND      13 C0                                     S01194
0239 I**********                              1   1 RECI                  S01194
0240 I**********                              2   30RECT                  S01194
0241 I**********                             12  130RCDE                  S01194
0242 I**********                             14  66 TITL                  S01194
0243 I**********                             67  67 DATF                  S01194
0244 I**********                             68  700DFBR                  S01194
0245 I**********                             74  74 MODI1                 S01194
0246 I**********                             75  75 MODI2                 S01194
0247 I**********                             76  76 MODI3                 S01194
0248 I**********                          P  77  790RUND                  S01194
0249 I**********                             80  86 RUNA                  S01194
0250 I**********                             87  870SFLG                  S01194
0251 I**********                          P  90  920LCD                   S01194
0252 I**********                             93  93 CHTP                  S01194
0253 I**********                          P  94  960TNLU                  S01194
0254 I***********                                                         S01194
0255 I***********                                                         S01194
0256 I***********    TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.     S01194
0257 I***********                                                         S01194
0258 I**********TABLE   NS  05   1 CD   2 C0   3 C1                       S01194
0259 I**********       AND      12 C1  13 C1                              S01194
0260 I**********                              1   1 RECI                  S01194
0261 I**********                              2   30RECT                  S01194
0262 I**********                             12  130RCDE                  S01194
0263 I**********                             14  16 BCCY                  S01194
0264 I**********                             17  19 BCYL                  S01194
0265 I**********                             20  22 HOCY                  S01194
0266 I**********                             23  280HEAD                  S01194
0267 I**********                          P  29  310APDA                  S01194
0268 I**********                             35  35 APFQ                  S01194
0269 I**********                          P  36  380LOGS                  S01194
0270 I**********                             39  40 CUZR                  S01194
0271 I**********                          P  41  430DNWD                  S01194
0272 I**********                             44  460BVLP                  S01194
0273 I**********                             47  49 LOCY                  S01194
0274 I**********                             50  510FDAY                  S01194
0275 I**********                             86  86 ISAV                  S01194
0276 I**********                          P  87  890LLOG                  S01194
0277 I**********                          P  90  920LCD                   S01194
0278 I**********                             93  93 CHTP                  S01194
0279 I**********                          P  94  960TNLU                  S01194
0280 I***********    TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.     S01194
0281 I***********                                                         S01194
0282 I**********TABLE   NS  06   1 CD   2 C0   3 C1                       S01194
0283 I**********       AND      12 C4  13 C0                              S01194
0284 I**********                              1   1 RECI                  S01194
0285 I**********                              2   30RECT                  S01194
0286 I**********                             12  130RCDE                  S01194
0287 I**********                             18  210CSAC                  S01194
0288 I**********                             22  22 TLII                  S01194
0289 I**********                             23  23 MCRI                  S01194
0290 I**********                          P  24  250MCEP                  S01194
0291 I**********                             26  270MCLP                  S01194
0292 I**********                             28  28 FRDI                  S01194
0293 I**********                             29  29 BRCF                  S01194
0294 I**********                             30  350PSCN                  S01194
0295 I**********                             36  380DLBR                  S01194
0296 I**********                             39  420FRPA                  S01194
0297 I**********                             43  460FRPC                  S01194
0298 I**********                             47  49 USCY                  S01194
0299 I**********                             50  52 STCY                  S01194
0300 I**********                          P  53  553MBGE                  S01194
0301 I**********                          P  90  920LCD                   S01194
0302 I**********                             93  93 CHTP                  S01194
0303 I**********                          P  94  960TNLU                  S01194
0304 I***********                                                         S01194
0305 I***********    TABLE FILE - ACCOUNT CODES RECORD 1.                 S01194
0306 I***********                                                         S01194
0307 I**********TABLE   NS  09   1 CD   2 C3   3 C0                       S01194
0308 I**********       AND      13 C1                                     S01194
0309 I**********                              1   1 RECI                  S01194
0310 I**********                              2   30RECT                  S01194
0311 I**********                              9  120ACOD                  S01194
0312 I**********                             13  130SREC                  S01194
0313 I**********                             14  38 ACKN                  S01194
0314 I**********                             39  39 ATYP                  S01194
0315 I**********                          P  40  420SHLC                  S01194
0316 I**********                          P  43  450SHFC                  S01194
0317 I**********                             48  48 TITO                  S01194
0318 I**********                             49  520BSDR                  S01194
0319 I**********                             53  560BSCR                  S01194
0320 I**********                             57  600PLDR                  S01194
0321 I**********                             61  640PLCR                  S01194
0322 I**********                             65  740RPCD                  S01194
0323 I**********                             75  76 ACCS                  S01194
0324 I**********                             77  77 STYP                  S01194
0325 I**********                          P  90  920LCD                   S01194
0326 I**********                             93  93 CHTP                  S01194
0327 I**********                          P  94  960TNLU                  S01194
0328 I***********                                                         S01194
0329 I***********    TABLE FILE - CURRENCIES RECORD 1.                    S01194
0330 I***********                                                         S01194
0331 I**********TABLE   NS  08   1 CD   2 C2   3 C0                       S01194
0332 I**********       AND      13 C1                                     S01194
0333 I**********                              1   1 RECI                  S01194
0334 I**********                              2   30RECT                  S01194
0335 I**********                             10  12 CCY                   S01194
0336 I**********                             13  130SREC                  S01194
0337 I**********                             14  27 CCNM                  S01194
0338 I**********                          P  28  348SPOT                  S01194
0339 I**********                             35  37 CCYS                  S01194
0340 I**********                             38  380CDP                   S01194
0341 I**********                             39  390TNOT                  S01194
0342 I**********                             40  40 DCCY                  S01194
0343 I**********                             41  44 SRC1                  S01194
0344 I**********                             45  48 SRC2                  S01194
0375 I**********                             49  520TACC                  S01194
0346 I**********                             53  560TEQV                  S01194
0347 I**********                             57  600SWQV                  S01194
0348 I**********                             61  640TAC4                  S01194
0349 I**********                             65  680TAC5                  S01194
0350 I**********                             69  69 HIND                  S01194
0351 I**********                          P  70  768PART                  S01194
0352 I**********                             77  780SSNO                  S01194
0353 I**********                          P  79  858ERLC                  S01194
0354 I**********                             86  860DIVMLT          32    S01194
0355 I**********                          P  90  920LCD                   S01194
0356 I**********                             93  93 CHTP                  S01194
0357 I**********                          P  94  960TNLU                  S01194
0358 I***********                                                         S01194
0359 I***********    TABLE FILE - BRANCH CODES RECORD.                    S01194
0360 I***********                                                         S01194
0361 I**********TABLE   NS  07   1 CD   2 C1   3 C0                       S01194
0362 I**********                              1   1 RECI                  S01194
0363 I**********                              2   30RECT                  S01194
0364 I**********                             11  130BRCD                  S01194
0365 I**********                             14  43 BRNM                  S01194
0366 I**********                             44  490BICN                  S01194
0367 I**********                             50  51 LOCC                  S01194
0368 I**********                             52  53 CMPY                  S01194
0369 I**********                          P  90  920LCD                   S01194
0370 I**********                             93  93 CHTP                  S01194
0371 I**********                          P  94  960TNLU                  S01194
0372 I***********                                                         S01194
0373 I***********  CATCHALL                                               S01194
0374 I**********        NS                                                S01194
     I**********TABLED  NS       1 CD   2 C1   3 C0                       S01194
     I**********                              1   1 RECID                 S01194
     I**********                              2   30RECTD                 S01194
     I**********                             11  130BRCDD                 S01194
     I**********                             44  490BICND                 S01194
     I**********        NS                                                S01194
     I**********                              1   1 RECID                 S01194
     I**********                              2   30RECTD                 S01194
     I/COPY WNCPYSRC,DL0410I008
     IFPVNTZZF                                                            S01178
     I*                                                                   S01178
     I** Fields renamed to avoid confusion between trailer file fields    S01178
     I              RECI                            RRECI                 S01178
     I              HRWN                            RHRWN                 S01178
     I              HRDC                            RHRDC                 S01178
     I/COPY WNCPYSRC,DL0410I003
      *                                                                                       CAS001
      ** Rename fields                                                                        CAS001
      *                                                                                       CAS001
     I***EVNTXDDF                                                                      CAS001 CAS004
     I**********    DLNO                            DLNO2                              CAS001 CAS004
     I**********    EDAT                            EDAT2                              CAS001 CAS004
     I**********    ETYP                            ETYP2                              CAS001 CAS004
     I**********    INOI                            INOI2                              CAS001 CAS004
     IDEALSBBF                                                                                CAS001
     I              DLNO                            WMDLNO                                    CAS001
     I              FSYUPL                          WMYUPL                                    CAS001
      *                                                                                       CAS004
     IDEALSCCF                                                                                CAS004
     I              DLNO                            WCDLNO                                    CAS004
     I              DTYP                            WDTYP                                     CAS004
     I              DLST                            WDLST                                     CAS004
     I              FSOYLC                          WCOYLC                                    CAS004
     I              FSYUPL                          WCYUPL                                    CAS004
      *                                                                                     BUG13768
     ISDYLDCD0                                                                              BUG13768
     I              FSYLDCA                         FYSLCA                                  BUG13768
      *                                                                                       CAS005
     IWPOSL0    E DSDLPOSTPD                                                                  CAS005
     I                                        2  16 WDLDS                           BUG5336 BUG5336R
     I**********                              2  16 WDLDS                             CAS005 BUG5336
     I***WDLDS**     DS                                                             BUG5336 BUG5336R
     I**********                              1   60WCNUM                           BUG5336 BUG5336R
     I**********                              7   9 WCCY                            BUG5336 BUG5336R
     I**********                             10  190WACOD                           BUG5336 BUG5336R
     I**********                             20  210WACSQ                           BUG5336 BUG5336R
      *                                                                                       CAS005
     IWPOSSV      DS                                                                          CAS005
     I                                        1 100 WPSAV1                                    CAS005
     I                                      101 200 WPSAV2                                    CAS005
     I                                      201 300 WPSAV3                                    CAS005
     I                                      301 400 WPSAV4                                    CAS005
      *                                                                                       CAS001
      ** File Information Data Structure for DL0410P3                                         CAS001
     ISPOOL3      DS                                                                          CAS001
     I                                       83  92 SFILE3                                    CAS001
     I                                    B 123 1240SFNUM3                                    CAS001
     I                                    B 188 1890OFLLN3                                    CAS001
     I                                    B 367 3680PRTLN3                                    CAS001
      *                                                                                       CAS001
      ** File Information Data Structure for DL0410P4                                         CAS001
     ISPOOL4      DS                                                                          CAS001
     I                                       83  92 SFILE4                                    CAS001
     I                                    B 123 1240SFNUM4                                    CAS001
     I                                    B 188 1890OFLLN4                                    CAS001
     I                                    B 367 3680PRTLN4                                    CAS001
      *                                                                                       CAS001
      ** File Information Data Structure for DL0410P5                                         CAS001
     ISPOOL5      DS                                                                          CAS001
     I                                       83  92 SFILE5                                    CAS001
     I                                    B 123 1240SFNUM5                                    CAS001
     I                                    B 188 1890OFLLN5                                    CAS001
     I                                    B 367 3680PRTLN5                                    CAS001
0375 I*
     I********************************************************************S01117
0925 I**                                                                  S01117
     ISPOOL       DS                                                      S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOL2      DS                                                      CEU011
      **   FILE INFORMATION DATA STRUCTURE                                CEU011
     I                                       83  92 SFILE2                CEU011
     I                                    B 123 1240SFNUM2                CEU011
     I                                    B 188 1890OFLLN2                CEU011
     I                                    B 367 3680PRTLN2                CEU011
0925 I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01117
     IJNSTAT     UDS                            200                                           CAS005
     I                                    P 103 1050PRUN                                      CAS005
     I@BANK     E DSSDBANKPD                                              S01194
     I* BANK DETAILS FILE - EXTERNALLY DESCRIBED                          S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01522
     I* Module Details Accessed via access program                        S01522
     I*                                                                   S01522
     ISCSARD    E DSSCSARDPD                                              S01522
     I* SAR File Details accessed via access program AOSARDR0             S01522
     I*                                                                   S01522
     ICGPNAR    E DSCGPNARPD                                              S01522
     I* UDC Multi Language Narrative Data Structure                       S01522
     I*                                                                   S01522
     I##PRM1      DS                                                      086125
      **  Data Structure for Customer and Branch                          086125
      *                                                                   086125
     I                                        1   6 A#CUST                086125
     I                                        7   9 A#BRCA                086125
      *                                                                   086125
     ISDCUST    E DSSDCUSTPD                                              S01522
     I**  Customer Details                                                S01522
     I*                                                                   S01522
     I@DEAL     E DSSDDEALPD                                              S01194
     I* DEALING DATA FILE - EXTERNALLY DESCRIBED                          S01194
     I*                                                                   S01194
     I              QQACCD                          QQACD2                                    CGL029
     I@ACOD     E DSSDACODPD                                              S01194
     I* ACCOUNT CODES FILE - EXTERNALLY DESCRIBED                         S01194
     I*                                                                   S01194
     I              QQACCD                          QQACD1                                    CGL029
     I@CURR     E DSSDCURRPD                                              S01194
     I* CURRENCIES FILE - EXTERNALLY DESCRIBED                            S01194
     I*                                                                   S01194
     I@BRCH     E DSSDBRCHPD                                              S01194
     I* BRANCH CODES FILE - EXTERNALLY DESCRIBED                          S01194
     I*                                                                   S01328
     I              QQDFAC                          QQDFA1                                    CGL029
     I@DLST     E DSSDDLSTPD                                              S01328
     I** EXTERNAL DS FOR DEAL  SUBTYPE DETAILS                            S01328
     I/COPY WNCPYSRC,DL0410I004
      *                                                                                       CAS001
     ISDBOOK    E DSSDBOOKPD                                                                  CAS001
      ** Externally described DS for book details                                             CAS001
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              CEU011
      ** General ledger details                                           CEU011
      *                                                                   CEU011
     I              QQACCD                          QQACD3                                    CGL029
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   E158
     I/COPY WNCPYSRC,DL0410I002
      *                                                                                       CAS001
     IDSFLDS      DS                                                                          CAS001
     I**********                              1  94 WFLDS                              CAS001 220200
     I                                        1  96 WFLDS                                     220200
     IDSNPVS      DS                                                                          CAS001
      **  DS to store revalued amount fields                                                  CAS001
     I                                        1  138RATE                                      CAS001
     I                                       14  268RATES                                     CAS001
     I                                       27  390REVA                                      CAS001
     I                                       40  520REVAS                                     CAS001
     I                                       53  650PLAM                                      CAS001
     I                                       66  789WDSCF                                     CAS001
     I                                       79  919WDSCFS                                    CAS001
     I                                       92  96 FSYLDC                                    CAS001
      *                                                                                       CAS001
     IRUNDAT      DS                                                      E158
     I**   RUNDAT DATA STRUCTURE - TO ACCESS MULTI-BRANCHING FLAG         E158
     I                                       13  13 @MBIN                 E158
      *                                                                   S01522
     I##ACID      DS                                                      S01522
      **  DS to decode Account ID                                         S01522
     I                                        1   6 ##CNUM                S01522
     I                                        7   9 ##CCY                 S01522
     I**********                             10  13 ##ACOD                             S01522 CGL029
     I**********                             14  15 ##ACSQ                             S01522 CGL029
     I                                       10  19 ##ACOD                                    CGL029
     I                                       20  21 ##ACSQ                                    CGL029
      *                                                                                       258435
      * Data structure to hold input parameter for AOSVALR0.                                  258435
     I            DS                                                                          258435
     I                                        1  20 WPARM                                     258435
     I                                        1   5 WPARM1                                    258435
     I                                        6  10 WPARM2                                    258435
     I                                       11  15 WPARM3                                    258435
     I                                       16  20 WPARM4                                    258435
      *                                                                                     AR720506
     I              'UseForwardRateReval' C         WSVAL                                   AR720506
      *                                                                                     AR720506
     I/COPY ZSRSRC,ZHOLIA                                                 129805
     I/COPY WNCPYSRC,DL0410I001
      *                                                                   CEU011
     I/COPY ZSRSRC,ZSEDITZ2                                               CEU011
      *
     C********************************************************************S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3                       S01117
     C*
0377 C*    FIRST CYCLE CALCULATIONS.
     C                     Z-ADD0         ZERO15 150                      S01182
     C                     Z-ADD0         CHQN                                               BUG1813
     C                     Z-ADD0         ORAMT  130                                        AR813358
     C                     Z-ADD0         NITMS   50                                        AR813358
     C                     Z-ADD0         CHGA   130                                        AR813358
     C                     Z-ADD0         RRNM    50                                        AR813358
     C                     Z-ADD0         ACNO   100                                        AR813358
     C                     Z-ADD0         SETDAT  50                                        AR813358
     C                     Z-ADD0         REJC    30                                        AR813358
     C                     Z-ADD0         FEEVAL 130                                        AR813358
     C                     Z-ADD0         FEEPCT  52                                        AR813358
     C                     Z-ADD0         TRAT    50                                        AR813358
     C                     Z-ADD0         LTAI    10                                        AR813358
     C                     Z-ADD0         ACUM    10                                        AR813358
     C                     Z-ADD0         XRFN   100                                        AR813358
     C                     Z-ADD0         NOMINL 132                                        AR813358
      *                                                                                     AR813358
0378 C   80                GOTO ENDFC
     C**                                                                  S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCPG                                           S01408
     C*                                                                   S01408
     C                     MOVEACPY@      BIS@   80
     C*                                                                   E158
     C* READ RUNDAT FOR MULTI-BRANCHING INDICATOR                         E158
     C                     IN   RUNDAT                                    E158
     C           *NAMVAR   DEFN           RUNDAT 13                       E158
     C**********           Z-ADD0         ASOC    60                                   S10736 CSD027
     C                     MOVE *BLANKS   ASOC    6                                           CSD027
     C                     MOVE 'Y'       WUFLAG                                              CAS004
     C*                                                                   E158
0379 C                     SETON                     80
0380 C*****ACCESS I.C.D. RECORD 1 ********************                    S01194
0381 C**********           MOVEL'01'      TABKEY 12                       S01194
0382 C**********           MOVE '10'      TABKEY                          S01194
0383 C**********           EXSR TABCHN                                    S01194
0384 C**********  N04                GOTO ERROR                           S01194
0385 C********** DATF      COMP 'M'                      98               S01194
0386 C*                                                                   S01194
0387 C*****ACCESS I.C.D RECORD 2 *********************                    S01194
0388 C**********           MOVE '1'       TABKEY                          S01194
0389 C**********           EXSR TABCHN                                    S01194
0390 C**********     N05             GOTO ERROR                           S01194
0391 C*
     C** USE ACCESS PROGRAM TO READ BANK DETAILS FILE                     S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
     C           BJDFIN    COMP 'M'                      98               S01194
      *                                                                   E158
      ** If multibranching indicator is off set up the branch code        E158
      *                                                                   E158
     C           @MBIN     IFNE 'Y'                                       E158
     C                     MOVE BJSBRC    BRNCH                           E158
     C                     MOVE '1'       *IN85                           E157
     C                     END                                            E158
     C*                                                                   S01194
0392 C*****ACCESS I.C.D. RECORD 5*************************                S01194
0393 C**********           MOVE '40'      TABKEY                          S01194
0394 C**********           EXSR TABCHN                                    S01194
0395 C**********  N06                GOTO ERROR                           S01194
     C** USE ACCESS PROGRAM TO READ DEALING DATA FILE                     S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** @DEAL     PARM @DEAL     DSFDY                           S01194              CGL029
     C           @DEAL     PARM @DEAL     DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDEALPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,DL0410C001
0396 C           BNFRDI    COMP 'Y'                      20               S01194
0397 C*
0398 C*    ACCESS BRANCH CODE FILE TO OBTAIN DEALING BRANCH
0399 C*    ASSOCIATED CUSTOMER NUMBER IF SWITCH 1 ON
     C/COPY WNCPYSRC,DL0410C033
     C  NU1                GOTO BYPAS
     C/COPY WNCPYSRC,DL0410C034
     C**********           MOVEL'10'      DEMKEY 12                       S01194
     C**********           MOVE '000'     DEMKEY                          S01194
     C*    ACCESS NEW SYNON VERSION OF BRANCH CODE FILE                   S01194
     C********** DEMKEY    SETLLTABLED                                    S01194
     C           *LOVAL    SETLLSDBRCHL1                                  S01194
     C                     Z-ADD1         A       30
     C           LOOP      TAG
     C**********           READ TABLED                   74               S01194
     C                     READ SDBRCHL1                 74               S01194
     C********  N74      RECTD     COMP 10                   7474         S01194
     C   74                GOTO BYPAS
     C********           RECID     COMP 'D'                      74       S01194
     C**N74                GOTO LOOP                                      S01117
     C**********           MOVE BICND     BICA,A                          S01194
     C**********           MOVE BRCDD     BRAR,A                          S01194
     C                     MOVE A8BICN    BICA,A                          S01194
     C                     MOVE A8BRCD    BRAR,A                          S01194
     C           A         ADD  1         A
     C                     SETOF                     74
     C                     GOTO LOOP
     C           BYPAS     TAG
0404 C*
0405 C*    SET ON FIRST DETAIL RECORD INDICATOR.
0406 C                     SETON                     27
0407 C*
0408 C*    SET UP WORK FIELDS.
0409 C                     MOVE '1'       WK4     4
0410 C                     MOVE '1'       WK5     5
0411 C                     BITOF'1'       PRIN    1
0412 C***********          Z-ADD0         NRBR    10                      E19341
0413 C***********          Z-ADD0         NRBG    10                      E19341
     C/COPY WNCPYSRC,DL0410C043
0412 C                     Z-ADD0         NRBR    50                      E19341
0413 C                     Z-ADD0         NRBG    50                      E19341
     C/COPY WNCPYSRC,DL0410C044
0414 C*
0415 C*****ACCESS CURRENCY TABLE FOR BASE CURRENCY************            S01194
0416 C**********           MOVEL'20      'TABKEY                          S01194
0417 C**********           MOVELBCCY      WK4                             S01194
0418 C**********           MOVE WK4       TABKEY                          S01194
0419 C**********           EXSR TABCHN                                    S01194
0420 C**********  N08                GOTO ERROR                           S01194
     C** USE ACCESS PROGRAM TO READ DEALING DATA FILE                     S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM BJCYCD    @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE                          S01194
     C                     MOVEL'03'      DBASE            ************   S01194
     C                     MOVEL@OPTN     DBOPTN           * DBERR 03 *   S01194
     C                     MOVELBJCYCD    DBKEY  29        ************   S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,DL0410C002
0421 C*    SET INDICATOR FOR NO. OF D.P. FOR BASE CURRENCY
0422 C********** CDP       COMP 1                      6061               S01194
0423 C********** CDP       COMP 2                    63  62               S01194
0424 C**********           Z-ADDCDP       BCCDP   10                      S01194
0422 C           A6NBDP    COMP 1                      6061               S01194
0423 C           A6NBDP    COMP 2                    63  62               S01194
0424 C                     Z-ADDA6NBDP    BCCDP   10                      S01194
     C/COPY WNCPYSRC,DL0410C013
      *                                                                                       CAS001
      ** Save base currency interest calculation basis                                        CAS001
      *                                                                                       CAS001
     C                     MOVELA6DICB    WBCICB  1                                           CAS001
      *                                                                   S01522
      **  Call Module Prog. for Module Details.                           S01522
     C                     CALL 'AOMMODR0'                                S01522
     C                     PARM '*MSG   ' @RTCD                           S01522
     C                     PARM '*FIRST ' @OPTN                           S01522
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01522
      *                                                                   S01522
     C           @RTCD     IFNE *BLANK                     B1             S01522
     C                     MOVEL'SDMMODPD'DBFILE           * * * * * * *  S01522
     C                     MOVEL'086'     DBASE            * DBERR 086 *  S01522
     C                     MOVEL@OPTN     DBOPTN           * * * * * * *  S01522
     C                     MOVEL@OPTN     DBKEY             1             S01522
     C                     GOTO ERROR                       1             S01522
     C                     ELSE                            X1             S01522
     C*                                                                   CAC001
     C** Check if Analytical Accounting Module is switched on             CAC001
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '1'       *IN17                           CAC001
     C                     ELSE                                           CAC001
     C                     MOVE '0'       *IN17                           CAC001
     C                     END                                            CAC001
     C/COPY WNCPYSRC,DLH00444
      *                                                                   S01522
      **  Call SAR Prog. for Switchable Feature                           S01522
     C           BGN1ST    IFEQ 'Y'                        B2             S01522
     C/COPY WNCPYSRC,DLH00445
      *                                                                   S01522
     C                     CALL 'AOSARDR0'                  2             S01522
     C                     PARM '       ' @RTCD             2             S01522
     C                     PARM '*VERIFY' @OPTN             2             S01522
     C                     PARM 'DLPNAR'  @SARD   6         2             S01522
     C           SCSARD    PARM SCSARD    DSFDY             2             S01522
      *                                                                   S01522
     C           @RTCD     IFNE *BLANK                     B3             S01522
     C           @RTCD     ANDNE'*NRF   '                   3             S01522
     C                     MOVEL'SCSARDPD'DBFILE            ************* S01522
     C                     MOVEL'007'     DBASE             *DBERROR 007* S01522
     C                     MOVEL@RTCD     DBKEY             ************* S01522
     C                     GOTO ERROR                       1             S01522
     C                     END                             E3             S01522
      *                                                                   S01522
     C           @RTCD     IFEQ *BLANK                     B3             S01522
     C                     MOVEL'Y'       DLPNAR  1         3             S01522
     C                     END                             E3             S01522
     C                     END                             E2             S01522
     C                     END                             E1             S01522
      *                                                                   CEU011
      ** Call Access pgm AOSARDR0 to check if CEU011 is ON.               CEU011
      *                                                                   CEU011
     C                     MOVE 'N'       CEU011  1                       CEU011
     C                     CALL 'AOSARDR0'                                CEU011
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*VERIFY' @OPTN                           CEU011
     C                     PARM 'CEU011'  @SARD   6                       CEU011
     C           SCSARD    PARM SCSARD    DSFDY                           CEU011
      *                                                                   CEU011
     C           @RTCD     IFEQ *BLANKS                                   CEU011
     C                     MOVE 'Y'       CEU011                          CEU011
     C                     MOVE A6INCY    WBINCY  1                       139778
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C           @RTCD     ANDNE'*NRF   '                                 CEU011
      *                                                                   CEU011
      ** Call to program ended in error                                   CEU011
      *                                                                   CEU011
     C                     MOVEL'CEU011'  DBKEY            ************   CEU011
     C                     MOVE 'SCSARDPD'DBFILE           * DBERR 10 *   CEU011
     C                     MOVEL'10'      DBASE            ************   CEU011
     C                     GOTO ERROR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                                       CAS001
      ** Call Access pgm AOSARDR0 to check if CAS001 is ON                                    CAS001
      *                                                                                       CAS001
     C                     MOVEL'N'       CAS001  1                                           CAS001
     C                     MOVE *OFF      *IN05                                               219334
     C                     MOVE *OFF      *IN06                                               CAS001
     C                     CALL 'AOSARDR0'                                                    CAS001
     C                     PARM *BLANKS   PRTCD   7                                           CAS001
     C                     PARM '*VERIFY' POPTN   7                                           CAS001
     C                     PARM 'CAS001'  PSARD   6                                           CAS001
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS001
      *                                                                                       CAS001
     C           PRTCD     IFNE *BLANKS                                                       CAS001
     C           PRTCD     ANDNE'*NRF'                                                        CAS001
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS001
     C                     MOVEL'13'      DBASE                                               CAS001
     C                     MOVEL'CAS001'  DBKEY                                               CAS001
     C                     GOTO ERROR                                                         CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           PRTCD     IFEQ *BLANKS                                                       CAS001
     C                     MOVEL'Y'       CAS001                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C/COPY WNCPYSRC,DLH00374
     C           CAS001    IFEQ 'Y'                                                           CAS001
      *                                                                                       CAS001
     C                     MOVE 'Y'       WFIRST  1                                           CAS001
     C                     MOVE 'N'       WFNPRT  1                                           CAS001
     C                     MOVE 'Y'       W1STBK  1                                           CAS001
     C                     MOVE 'Y'       W1STDS  1                                           CAS001
     C                     MOVE 'Y'       WNREC   1                                           CAS001
     C                     MOVE 'Y'       WPAS1   1                                           CAS001
     C                     MOVE *ON       *IN06                                               CAS001
     C                     MOVE *OFF      *IN09                                               CAS001
      *                                                                                       CAS001
     C           BNNPVM    IFEQ 'N'                                                           CAS001
     C           BNNPVM    OREQ ' '                                                           CAS001
     C                     MOVE *ON       *IN09                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ELSE                                                               CAS001
      *                                                                                       CAS001
     C                     MOVE *ON       *IN09                                               CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS005
      ** Call access pgm AOSARDR0 to check if CAS005 is ON                                    CAS005
      *                                                                                       CAS005
     C                     MOVEL'N'       CAS005  1                                           CAS005
     C                     MOVE *OFF      *IN07                                               CAS005
     C                     MOVE 'Y'       WFRUN   1                                           CAS005
     C                     CALL 'AOSARDR0'                                                    CAS005
     C                     PARM *BLANKS   PRTCD                                               CAS005
     C                     PARM '*VERIFY' POPTN                                               CAS005
     C                     PARM 'CAS005'  PSARD                                               CAS005
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS005
      *                                                                                       CAS005
     C           PRTCD     IFNE *BLANKS                                                       CAS005
     C           PRTCD     ANDNE'*NRF'                                                        CAS005
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS005
     C                     MOVEL'17'      DBASE                                               CAS005
     C                     MOVEL'CAS005'  DBKEY                                               CAS005
     C                     GOTO ERROR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           PRTCD     IFEQ *BLANKS                                                       CAS005
     C                     MOVEL'Y'       CAS005                                              CAS005
     C                     MOVE *ON       *IN07                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     IN   JNSTAT                                                        CAS005
     C           *NAMVAR   DEFN           JNSTAT                                              CAS005
      *                                                                                       CAS005
      ** Call access pgm AOSARDR0 to check if CIR003 is ON                                    CAS008
      *                                                                                       CAS008
     C                     MOVEL'N'       CIR003  1                                           CAS008
     C                     CALL 'AOSARDR0'                                                    CAS008
     C                     PARM *BLANKS   PRTCD                                               CAS008
     C                     PARM '*VERIFY' POPTN                                               CAS008
     C                     PARM 'CIR003'  PSARD                                               CAS008
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS008
      *                                                                                       CAS008
     C           PRTCD     IFNE *BLANKS                                                       CAS008
     C           PRTCD     ANDNE'*NRF'                                                        CAS008
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS008
     C                     MOVEL'20'      DBASE                                               CAS008
     C                     MOVEL'CIR003'  DBKEY                                               CAS008
     C                     GOTO ERROR                                                         CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C           PRTCD     IFEQ *BLANKS                                                       CAS008
     C                     MOVEL'Y'       CIR003                                              CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
      ** Call access pgm AOSARDR0 to check if CAS008 is ON                                    CAS008
      *                                                                                       CAS008
     C                     MOVEL'N'       CAS008  1                                           CAS008
     C                     CALL 'AOSARDR0'                                                    CAS008
     C                     PARM *BLANKS   PRTCD                                               CAS008
     C                     PARM '*VERIFY' POPTN                                               CAS008
     C                     PARM 'CAS008'  PSARD                                               CAS008
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS008
      *                                                                                       CAS008
     C           PRTCD     IFNE *BLANKS                                                       CAS008
     C           PRTCD     ANDNE'*NRF'                                                        CAS008
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS008
     C                     MOVEL'21'      DBASE                                               CAS008
     C                     MOVEL'CAS008'  DBKEY                                               CAS008
     C                     GOTO ERROR                                                         CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C           PRTCD     IFEQ *BLANKS                                                       CAS008
     C                     MOVEL'Y'       CAS008                                              CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
      ** Calculate the Event Control Date                                                     CAS008
      *                                                                                       CAS008
     C           BJDNWD    SUB  1         EVCD    50                                          CAS008
      *                                                                                       CAS008
     C           BKAPDT    IFLT EVCD                                                          CAS008
     C                     Z-ADDBKAPDT    EVCD                                                CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C/COPY WNCPYSRC,DL0410C085
      *                                                                   CEU011
      ** Retrieve general ledger details                                  CEU011
      *                                                                   CEU011
     C**********           CALL 'AOGELRR0'                                             CEU011 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*FIRST ' @OPTN                           CEU011
     C           SDGELR    PARM SDGELR    DSSDY                           CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C                     MOVEL'SDGELRPD'DBFILE           ************   CEU011
     C                     MOVEL'11'      DBASE            * DBERR 11 *   CEU011
     C                     MOVEL'*FIRST'  DBKEY            ************   CEU011
     C                     GOTO ERROR                                     CEU011
     C                     ENDIF                                          CEU011
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCP5                                           S01408
     C*                                                                   S01408
      *                                                                   S01522
      ** Get currency details for Euro.                                   139778
      *                                                                   139778
     C           CEU011    IFEQ 'Y'                                       139778
     C                     CALL 'AOCURRR0'                                139778
     C                     PARM '*MSG   ' @RTCD                           139778
     C                     PARM '*KEY   ' @OPTN                           139778
     C                     PARM BKEURO    @AJCD                           139778
     C           @CURR     PARM @CURR     DSSDY                           139778
     C           @RTCD     IFNE *BLANK                                    139778
     C                     MOVEL'SDCURRPD'DBFILE                          139778
     C                     MOVEL'12'      DBASE            ************   139778
     C                     MOVEL@OPTN     DBOPTN           * DBERR 12 *   139778
     C                     MOVELBKEURO    DBKEY            ************   139778
     C                     GOTO ERROR                                     139778
     C                     ENDIF                                          139778
     C                     Z-ADDA6NBDP    WENBDP  10                      139778
     C                     Z-ADDA6SPRT    WESPRT 138                      139778
     C                     MOVE A6MDIN    WEMDIN  1                       139778
     C                     ENDIF                                          139778
      *                                                                                       258435
      ** Check system value for meaning of Forward Days.                                      258435
      ** Set up parameter so access object checks System Value ForwardDays                    258435
     C                     MOVE *BLANKS   WPARM                                               258435
     C                     MOVEL'Forwa'   WPARM1                                              258435
     C                     MOVEL'rdDay'   WPARM2                                              258435
     C                     MOVEL's'       WPARM3                                              258435
     C                     MOVELWPARM     SVALK1                                              258435
      *                                                                                     AR720506
      ** Check if system should use Forward Rates as the first and                          AR720506
      ** second rate on the forward revaluation process.                                    AR720506
      *                                                                                     AR720506
     C                     MOVELWSVAL     SVALK2                                            AR720506
      * Call Access object:                                                                   258435
     C                     CALL 'AOSVALR0'                                                    258435
     C                     PARM           RTNCDE  7                                           258435
     C                     PARM           SVALK1 20                                           258435
     C                     PARM           SVAL1 200                                           258435
     C                     PARM           SVALK2 20                                           258435
     C                     PARM           SVAL2 200                                           258435
     C                     PARM           SVALK3 20                                           258435
     C                     PARM           SVAL3 200                                           258435
     C                     PARM           SVALK4 20                                           258435
     C                     PARM           SVAL4 200                                           258435
     C                     PARM           SVALK5 20                                           258435
     C                     PARM           SVAL5 200                                           258435
     C                     PARM           SVALK6 20                                           258435
     C                     PARM           SVAL6 200                                           258435
     C                     PARM           SVALK7 20                                           258435
     C                     PARM           SVAL7 200                                           258435
     C                     PARM           SVALK8 20                                           258435
     C                     PARM           SVAL8 200                                           258435
     C                     PARM           SVALK9 20                                           258435
     C                     PARM           SVAL9 200                                           258435
     C                     PARM           SVALK0 20                                           258435
     C                     PARM           SVAL10200                                           258435
      * If the system value is not found then issue a database error                          258435
     C           RTNCDE    IFNE '        '                                                    258435
     C                     MOVEL'SDSVALPD'DBFILE                                              258435
     C                     MOVEL'66'      DBASE                                               258435
     C                     MOVEL@OPTN     DBOPTN                                              258435
     C                     SELEC                                                            AR720506
     C           SVAL1     WHEQ '*NRF'                                                      AR720506
     C                     MOVEL'SVALK1'  DBKEY                                               258435
     C           SVAL2     WHEQ '*NRF'                                                      AR720506
     C                     MOVEL'SVALK2'  DBKEY                                             AR720506
     C                     ENDSL                                                            AR720506
     C                     GOTO ERROR                                                       AR720506
     C                     ELSE                                                               258435
      * Isolate the first 2 characters of SVAL1 which should contain the value                258435
     C                     MOVELSVAL1     WRK02   2        2 character fld                    258435
     C                     MOVELWRK02     WC      1        working or calendar                258435
     C                     MOVE WRK02     RS      1        from run date or spot              258435
      *                                                                                     AR720506
      ** Save SVAL2 to 'Use Forward Rate' work field.                                       AR720506
      *                                                                                     AR720506
     C                     MOVELSVAL2     WUFWR   1                                         AR720506
      *                                                                                     AR720506
     C                     ENDIF                                                              258435
      *                                                                                       CGL020
      ** Access SAR details to see if CGL020 is enabled.                                      CGL020
      *                                                                                       CGL020
     C                     CALL 'AOSARDR0'                                                    CGL020
     C                     PARM *BLANKS   @RTCD                                               CGL020
     C                     PARM '*VERIFY' @OPTN                                               CGL020
     C                     PARM 'CGL020'  @SARD                                               CGL020
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL020
      *                                                                                       CGL020
     C           @RTCD     IFEQ *BLANKS                                                       CGL020
     C                     MOVE *BLANK    FEEFLG  1                                           CGL020
     C                     Z-ADD0         FEEVAL 130                                          CGL020
     C                     Z-ADD0         FEEPCT  52                                          CGL020
     C                     MOVE *BLANKS   TICKER 10                                           CGL020
     C                     MOVE *BLANKS   EXCHNG 20                                           CGL020
     C                     Z-ADD0         NOMINL 132                                          CGL020
     C                     ELSE                                                               CGL020
      *                                                                                       CGL020
     C           @RTCD     IFNE '*NRF'                                                        CGL020
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL020
     C                     MOVEL'16'      DBASE                                               CGL020
     C                     MOVEL@SARD     DBKEY                                               CGL020
     C                     GOTO ERROR                                                         CGL020
     C                     ENDIF                                                              CGL020
      *                                                                                       CGL020
     C                     ENDIF                                                              CGL020
      *
0425  *    DETAIL CALCULATIONS.
0426 C           ENDFC     TAG                             ** ENDFC TAG **
0427 C   21                SETOF                     2128
     C***L2*******         SETOF                     31                   S01117
     C   L1                SETOF                     31                   S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCP2                                           S01408
     C*                                                                   S01408
0429 C*
0430 C*    SET INDICATOR IF TRAILER READ.
0431 C   03                SETON                     29
0432 C*
0433 C*    IGNOR NON-DETAIL RECORDS
0434 C**N02                GOTO END                                       S03220
     C/COPY WNCPYSRC,DL0410C070
0434 C  N02N12             GOTO END                                       S03220
     C/COPY WNCPYSRC,DL0410C071
     C***************************************                             S01117
     C           *INL2     IFEQ '1'                                       S01117
     C/COPY WNCPYSRC,DL0410C076
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
      *                                                                                       CAS001
     C           WP3CHK    IFEQ 'Y'                                                           227579
     C           WP4CHK    OREQ 'Y'                                                           227579
     C           WP5CHK    OREQ 'Y'                                                           227579
     C           WFIRST    IFNE 'Y'                                                           CAS001
     C           BRNCH     ANDEQ'ALL'                                                         CAS001
     C           WFIRST    ORNE 'Y'                                                           CAS001
     C           WFNPRT    ANDNE'Y'                                                           CAS001
     C                     EXSR SRPRT1                                                        CAS001
     C                     ENDIF                                                              CAS001
     C                     ENDIF                                                              227579
      *                                                                                       CAS001
     C                     MOVE 'N'       WFIRST                                              CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'N'                                                           CAS001
     C           BNNPVM    OREQ ' '                                                           CAS001
     C                     CLOSEDL0410P1                                                      CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C           WP3CHK    IFEQ 'Y'                                                           CAS001
     C                     CLOSEDL0410P3                                                      CAS001
     C                     MOVE ' '       WP3CHK                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C           WP4CHK    IFEQ 'Y'                                                           CAS001
     C                     CLOSEDL0410P4                                                      CAS001
     C                     MOVE ' '       WP4CHK                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C           WP5CHK    IFEQ 'Y'                                                           CAS001
     C                     CLOSEDL0410P5                                                      CAS001
     C                     MOVE ' '       WP5CHK                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
     C                     ELSE                                                               CAS001
      *                                                                                       CAS001
     C                     CLOSEDL0410P1                                  S01117
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C/COPY WNCPYSRC,DL0410C064
     C                     SETOF                     79                   LN0363
     C***********BRNCH*****IFEQ 'ALL'                              S01117 LN0761
     C***********BRNCH*****OREQ BRCA                               S01117 LN0761
     C*********************SETON                     37    ALLOW OUS01117 LN0761
     C*********************OPEN DL0410P1                           S01117 LN0761
     C*********************                                        S01117 LN0761
     C***IF*P1*FILE*OPENED*THEN SET ON FLAG                        S01117 LN0761
     C*********************MOVE '1'       *IN14                    S01117 LN0761
     C*********************                                               LN0761
     C***ENSURE*REPORT*SPOOL FILE RECORDED BY RCF                  S01117 LN0761
     C**transfer*binary*data into numeric field                    S01117 LN0761
     C*********************Z-ADDSFNUM     ZSNUM   60               S01117 LN0761
     C*********************CALL 'ZSFILE'                           S01117 LN0761
     C*********************PARM           SEQ     5                S01117 LN0761
     C*********************PARM BRCA      @PARM   3                S01117 LN0761
     C*********************PARM           SFILE                    S01117 LN0761
     C*********************PARM           ZSNUM                    S01117 LN0761
     C*********************PARM *BLANK    ZSERR   1                S01117 LN0761
     C*********************                                        S01117 LN0761
     C***Error*during*ZSFILE processing, return to calling program S01117 LN0761
     C***********ZSERR*****IFEQ 'Y'                                S01117 LN0761
     C*********************SETON                     U7U8LR        S01117 LN0761
     C*********************RETRN                                   S01117 LN0761
     C*********************END                                     S01117 LN0761
     C*********************                                        S01117 LN0761
     C*********************Z-ADD0         PAGE                     S01117 LN0761
     C*********************                                        S01117 LN0761
     C**********           MOVE *BLANK    TABKEY                   S01117 S01194
     C**********           MOVEL'10'      TABKEY                   S01117 S01194
     C**********           MOVE BRCA      TABKEY                   S01117 S01194
     C**********           EXSR TABCHN                             S01117 S01194
     C**********          *IN07     CABEQ'0'       ERROR           S01117 S01194
     C***USE*ACCESS*PROGRAM*TO READ BRANCH CODES FILE              S01194 LN0761
     C*********************CALL 'AOBRCHR0'                         S01194 LN0761
     C*********************PARM '*MSG   ' @RTCD                    S01194 LN0761
     C*********************PARM '*KEY   ' @OPTN                    S01194 LN0761
     C*********************PARM BRCA      @DSNB   3                S01194 LN0761
     C***********@BRCH*****PARM @BRCH     DSFDY                    S01194 LN0761
     C***********@RTCD*****IFNE *BLANK                             S01194 LN0761
     C*********************MOVEL'SDBRCHPD'DBFILE                   S01194 LN0761
     C*********************MOVEL'04'      DBASE     ************   S01194 LN0761
     C*********************MOVEL@OPTN     DBOPTN    * DBERR 04 *   S01194 LN0761
     C*********************MOVELBRCA      DBKEY     ************   S01194 LN0761
     C*********************GOTO ERROR                              S01194 LN0761
     C*********************END                                     S01194 LN0761
     C*********************                                               LN0761
     C*********************ELSE                                    S01117 LN0761
     C*********************SETOF                     37            S01117 LN0761
     C*********************END                                     S01117 LN0761
     C                     END                                            S01117
     C/COPY WNCPYSRC,DL0410C072
0435 C*
     C**   CLEAR FIELDS ON EVNTXED NOT READ FROM FPVNTDD                  S01328
     C*                                                                   S01328
     C           *IN12     IFEQ '1'                                       S01328
     C                     MOVEL*BLANK    RDTYP                           S01328
     C                     MOVEL*BLANK    RDLST                           S01328
     C                     MOVEL*BLANK    RCLAS                           CDL038
     C                     MOVEL*BLANK    RSUPR                           S01328
     C                     END                                            S01328
     C/COPY WNCPYSRC,DL0410C073
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
      *                                                                                       CAS001
      ** If there's a change in Currency                                                      CAS001
      *                                                                                       CAS001
     C           *INL1     IFEQ *ON                                                           CAS001
     C                     MOVE 'Y'       WCYCH   1                                           CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** If there's a change in Book Code                                                     CAS001
      *                                                                                       CAS001
     C           BOKC      IFNE WBOKC                                                         CAS001
     C           BOKC      ANDNE*BLANKS                                                       213046
      *                                                                                       227580
      ** Call access program only for non-nostro transfer deal types.                         227580
      *                                                                                       227580
     C           DTYP      IFNE 'NX'                                                          227580
      *                                                                                       CAS001
      ** Call Access Program for Book Details                                                 CAS001
      *                                                                                       CAS001
     C                     CALL 'AOBOOKR0'                                                    CAS001
     C                     PARM *BLANKS   PRTCD   7                                           CAS001
     C                     PARM '*KEY   ' POPTN   7                                           CAS001
     C                     PARM BOKC      PBOKC   2                                           CAS001
     C           SDBOOK    PARM SDBOOK    DSFDY                                               CAS001
      *                                                                                       CAS001
     C           PRTCD     IFNE *BLANKS                                                       CAS001
     C                     MOVEL'SDBOOKPD'DBFILE                                              CAS001
     C                     MOVEL'14'      DBASE                                               CAS001
     C                     MOVELBOKC      DBKEY                                               CAS001
     C                     GOTO ERROR                                                         CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       227580
     C                     ENDIF                                                              227580
      *                                                                                       CAS001
      ** Force a change in Deal Type/Subtype                                                  CAS001
      ** or a monthly/yearly total if *IN12 is on.                                            CAS001
      *                                                                                       CAS001
     C                     Z-ADD*ZERO     OMTH                                                CAS001
     C                     Z-ADD*ZERO     OYEAR                                               CAS001
     C                     MOVELBOKC      WBOKC   2                                           CAS001
     C                     MOVE *ON       *IN28                                               CAS001
      *                                                                                       CAS001
     C           W1STBK    IFNE 'Y'                                                           CAS001
     C                     MOVE 'Y'       WBKCH   1                                           CAS001
     C                     ELSE                                                               CAS001
     C                     MOVE 'N'       W1STBK                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
     C*                                                                   S01328
     C**   IF THE REVALUATION DEAL TYPE/DEAL SUB-TYPE HAVE CHANGED        S01328
     C*                                                                   S01328
     C           SRDTYP    IFNE RDTYP                                     S01328
     C           SRDLST    ORNE RDLST                                     S01328
     C           SRCLAS    ORNE RCLAS                                     CDL038
     C*                                                                   S01328
     C**   ACCESS SUB-TYPE NARRATIVE                                      S01328
     C*                                                                   S01328
     C           SRDLST    IFNE RDLST                                     S01328
     C           RDLST     ANDNE*BLANK                                    S01328
     C                     CALL 'AODLSTR0'                                S01328
     C                     PARM '*MSG    '@RTCD   7                       S01328
     C                     PARM '*KEY    '@OPTN   7                       S01328
     C                     PARM RDLST     @AQCD   2                       S01328
     C           @DLST     PARM @DLST     DSFDY                           S01328
     C*                                                                   S01328
     C**   DATABASE ERROR IF DEAL SUB-TYPE NOT FOUND                      S01328
     C*                                                                   S01328
     C           @RTCD     IFNE *BLANK                                    S01328
     C                     MOVEL'SDDLSTPD'DBFILE           ************   S01328
     C                     MOVEL'09'      DBASE            * DBERR 09 *   S01328
     C                     MOVEL@OPTN     DBOPTN           ************   S01328
     C                     MOVELRDLST     DBKEY                           S01328
     C                     GOTO ERROR                                     S01328
     C                     END                                            S01328
     C                     END                                            S01328
     C*                                                                   CDL038
     C**   ACCESS DEAL TYPE/SUB-TYPE NARRATIVE                            CDL038
     C*                                                                   CDL038
     C           DTSTK     KLIST                                          CDL038
     C                     KFLD           RDTYP                           CDL038
     C                     KFLD           RDLST                           CDL038
     C                     KFLD           RCLAS                           CDL038
     C           DTSTK     CHAINFDDTSTL1             99                   CDL038
     C*                                                                   CDL038
     C           *IN99     IFEQ *OFF                                      CDL038
     C                     MOVELNARR11    DSTCNR                          CDL038
     C                     ELSE                                           CDL038
     C                     MOVEL*BLANK    DSTCNR                          CDL038
     C                     MOVELASDSTN    DSTCNR 35                       CDL038
     C                     ENDIF                                          CDL038
     C*                                                                   CDL038
     C                     MOVELRDTYP     SRDTYP  2                       S01328
     C                     MOVELRDLST     SRDLST  2                       S01328
     C                     MOVELRCLAS     SRCLAS  4                       CDL038
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
      *                                                                                       CAS001
     C           W1STDS    IFNE 'Y'                                                           CAS001
     C                     MOVE 'Y'       WDSCH   1                                           CAS001
     C                     ELSE                                                               CAS001
     C                     MOVE 'N'       W1STDS                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
     C*                                                                   S01328
     C**   FORCE OUTPUT OF MONTHLY/YEARLY TOTALS                          S01328
     C*                                                                   S01328
     C                     Z-ADD*ZERO     OMTH                            S01328
     C                     Z-ADD*ZERO     OYEAR                           S01328
     C*                                                                   S01328
     C**   SET THE NARRATIVE TO APPEAR IN THE REPORT HEADINGS             S01328
     C**   SET ON INDICATOR 32 TO OUTPUT THESE HEADINGS                   S01328
     C**   AND SET ON INDICATOR 28 TO FORCE A PAGE CHANGE                 S01328
     C*                                                                   S01328
     C                     Z-ADD1         X       10                      S01328
     C           RDTYP     LOKUPDTX,X                    32*              S01328
     C           *IN32     IFEQ '1'                                       S01328
     C                     MOVEL'1'       *IN28                           S01328
     C                     MOVELDTH,X     DTPNAR 35                       S01328
     C                     END                                            S01328
     C                     END                                            S01328
0436 C*
0437 C*    CHECK IF FIRST EVENT RECORD FOR A CURRENCY.
     C***L2******                                                         S01117
     C   L1                                                               S01117
0439 COR 27                SETON                     28
     C/COPY WNCPYSRC,DL0410C083
0440 C*
0441 C*    IF NOT, BYPASS DATA SETUP.
0442 C**N28****************GOTO BYPASS                                    S01328
     C           *INL1     IFEQ '0'                                       S01328
     C           *IN27     ANDEQ'0'                                       S01328
     C/COPY WNCPYSRC,DL0410C065
0442 C                     GOTO BYPASS                                    S01328
0442 C                     END                                            S01328
0443 C                     SETOF                     27
0444 C*
0445 C*****ACCESS CURRENCY TABLE RECORD FOR EVENT CURRENCY.***********    S01194
0446 C**********           MOVEL'20'      TABKEY                          S01194
0447 C**********           MOVELECCY      WK4                             S01194
0448 C**********           MOVE WK4       TABKEY                          S01194
0449 C**********           EXSR TABCHN                                    S01194
0450 C**********  N08                GOTO ERROR                           S01194
     C** USE ACCESS PROGRAM TO READ DEALING DATA FILE                     S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM ECCY      @AJCD                           S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE                          S01194
     C                     MOVEL'05'      DBASE            ************   S01194
     C                     MOVEL@OPTN     DBOPTN           * DBERR 05 *   S01194
     C                     MOVELECCY      DBKEY            ************   S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
0451 C*    SET INDICATOR FOR NO. OF D.P. FOR CURRENCY.
0452 C********** CDP       COMP 1                      7071               S01194
0453 C********** CDP       COMP 2                    73  72               S01194
0452 C           A6NBDP    COMP 1                      7071               S01194
0453 C           A6NBDP    COMP 2                    73  72               S01194
      *                                                                                       CAS001
      ** Save number of decimal places of base currency                                       CAS001
      *                                                                                       CAS001
     C                     Z-ADDA6NBDP    WECDP   10                                          CAS001
      *                                                                                       CAS001
     C/COPY WNCPYSRC,DL0410C086
0454 C                     EXSR SUDA
      *                                                                                     AR720506
      ** Use Forward rates instead of Spot Rate                                             AR720506
      *                                                                                     AR720506
     C           WUFWR     IFEQ 'Y'                                                         AR720506
      *                                                                                     AR720506
     C**********           SELEC                                                  AR720506 MD036289A
      **********                                                                  AR720506 MD036289A
     C********** DFW,1     WHEQ 1                                                 AR720506 MD036289A
     C********** DFW,2     ANDEQ2                                                 AR720506 MD036289A
     C********** *IN40     ANDEQ*OFF                                              AR720506 MD036289A
     C**********           MOVEARFW       RAT                                     AR720506 MD036289A
      **********                                                                  AR720506 MD036289A
     C********** DFW,1     WHEQ 1                                                 AR720506 MD036289A
     C********** DFW,2     ANDGT2                                                 AR720506 MD036289A
     C********** *IN40     ANDEQ*OFF                                              AR720506 MD036289A
     C********** DFW,1     OREQ 2                                                 AR720506 MD036289A
     C********** DFW,2     ANDGT2                                                 AR720506 MD036289A
     C********** *IN40     ANDEQ*OFF                                              AR720506 MD036289A
     C**********           Z-ADDRFW,1     RAT,1                                   AR720506 MD036289A
     C**********           Z-ADDRFW,1     RAT,2                                   AR720506 MD036289A
     C**********           MOVEARFW,2     RAT,3                                   AR720506 MD036289A
      **********                                                                  AR720506 MD036289A
     C**********           OTHER                                                  AR720506 MD036289A
     C           RS        IFEQ 'S'                                                        MD036289A
     C                     Z-ADDA6SPRT    RAT,1                                             AR720506
     C**********           Z-ADDA6SPRT    RAT,2                                    AR720506 MD036289
     C**********           MOVEARFW       RAT,3                                    AR720506 MD036289
     C                     Z-ADDA6SPRT    RAT,2                                            MD036289A
     C                     MOVEARFW       RAT,3                                            MD036289A
     C                     ELSE                                                            MD036289A
     C                     Z-ADDA6SPRT    RAT,1                                            MD036289A
     C                     MOVEARFW       RAT,2                                             MD036289
     C                     ENDIF                                                           MD036289A
      **********                                                                  AR720506 MD036289A
     C**********           ENDSL                                                  AR720506 MD036289A
      **********                                                                  AR720506 MD036289A
     C                     ELSE                                                             AR720506
     C/COPY WNCPYSRC,DL0410C087
0455 C*
0456 C*    ELEMENT 1 OF RATE ARRAY CONTAINS SPOT RATE.
     C***********          MOVEARFW       RAT,2                    E17662 170442
0457 C**********           Z-ADDSPOT      RAT,1                           S01194
0457 C                     Z-ADDA6SPRT    RAT,1                           S01194
     C                     MOVEARFW       RAT,2                                               262151
     C/COPY WNCPYSRC,DL0410C095
     C**********           Z-ADDA6SPRT    RAT,2                                        170442 262151
     C**********           MOVEARFW       RAT,3                                        170442 262151
     C/COPY WNCPYSRC,DL0410C005
     C                     ENDIF                                                            AR720506
0458 C*
0459 C*    MAINTAIN HASH TOTALS OF EVENT AMOUNT.
0460 C           BYPASS    TAG                             ** BYPASS TAG *
     C                     SETOF                     33
     C           EAMT      COMP 0                      33
0461 C                     Z-ADD1         S       10
0462 C           EAMT      DIV  1000      ZZAMT
0463 C                     EXSR HASH
     C/COPY WNCPYSRC,DL0410C016
0464 C*
0465 C*    CHECK IF THIS EVENT IS TO BE INCLUDED IN REVALUATION
0466 C                     EXSR INCLU
     C/COPY WNCPYSRC,DL0410C040
      *                                                                   LN0761
      ** If event branch is not the requested branch, then do not         LN0761
      **    update monthly sub-totals                                     LN0761
     C           BRNCH     IFNE 'ALL'                                     LN0761
     C           BRNCH     ANDNEBRCA                                      LN0761
     C                     MOVE '0'       *IN21                           LN0761
     C                     END                                            LN0761
      *                                                                   LN0761
0467 C  N21                GOTO END
      *                                                                   LN0761
      ** If P1 is closed and the event branch is the one requested,       LN0761
      **    then open the P1                                              LN0761
     C           *IN79     IFEQ '0'                                       LN0761
      *                                                                   LN0761
     C           BRNCH     IFEQ 'ALL'                                     LN0761
     C           BRNCH     OREQ BRCA                                      LN0761
     C                     SETON                     37    ALLOW OUTPUT   LN0761
     C/COPY WNCPYSRC,DL0410C077
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'N'                                                           CAS001
     C           BNNPVM    OREQ ' '                                                           CAS001
     C                     OPEN DL0410P1                                                      CAS001
     C                     MOVE *ON       *IN14                                               CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C           WP3CHK    IFEQ ' '                                                           CAS001
     C                     OPEN DL0410P3                                                      CAS001
     C                     MOVE 'Y'       WP3CHK                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C           WP4CHK    IFEQ ' '                                                           CAS001
     C                     OPEN DL0410P4                                                      CAS001
     C                     MOVE 'Y'       WP4CHK                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C           WP5CHK    IFEQ ' '                                                           CAS001
     C                     OPEN DL0410P5                                                      CAS001
     C                     MOVE 'Y'       WP5CHK                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
     C                     ELSE                                                               CAS001
      *                                                                                       CAS001
     C                     OPEN DL0410P1                                  LN0761
     C/COPY WNCPYSRC,DL0410C066
      *                                                                   LN0761
      ** If P1 file opened then set on flag                               LN0761
     C                     MOVE '1'       *IN14                           LN0761
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                   LN0761
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         LN0761
      *  transfer binary data into numeric field                          LN0761
     C/COPY WNCPYSRC,DL0410C078
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'N'                                                           CAS001
     C           BNNPVM    OREQ ' '                                                           CAS001
     C                     Z-ADDSFNUM     ZSNUM   60                                          CAS001
     C                     CALL 'ZSFILE'                                                      CAS001
     C                     PARM           SEQ     5                                           CAS001
     C                     PARM BRCA      @PARM   3                                           CAS001
     C                     PARM           SFILE                                               CAS001
     C                     PARM           ZSNUM                                               CAS001
     C                     PARM *BLANK    ZSERR   1                                           CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C                     MOVELSFNUM3    ZSNUM   60                                          CAS001
     C                     MOVELSFILE3    ZFILE  10                                           CAS001
     C                     EXSR SRRCF                                                         CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C                     MOVELSFNUM4    ZSNUM                                               CAS001
     C                     MOVELSFILE4    ZFILE                                               CAS001
     C                     EXSR SRRCF                                                         CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C                     MOVELSFNUM5    ZSNUM                                               CAS001
     C                     MOVELSFILE5    ZFILE                                               CAS001
     C                     EXSR SRRCF                                                         CAS001
      *                                                                                       CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
     C                     ELSE                                                               CAS001
      *                                                                                       CAS001
     C                     Z-ADDSFNUM     ZSNUM   60                      LN0761
     C                     CALL 'ZSFILE'                                  LN0761
     C                     PARM           SEQ     5                       LN0761
     C                     PARM BRCA      @PARM   3                       LN0761
     C                     PARM           SFILE                           LN0761
     C                     PARM           ZSNUM                           LN0761
     C                     PARM *BLANK    ZSERR   1                       LN0761
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C/COPY WNCPYSRC,DL0410C079
     C*                                                                   LN0761
     C** Error during ZSFILE processing, return to calling program        LN0761
     C           ZSERR     IFEQ 'Y'                                       LN0761
     C                     SETON                     U7U8LR               LN0761
     C                     RETRN                                          LN0761
     C                     END                                            LN0761
      *                                                                   LN0761
     C                     Z-ADD0         PAGE                            LN0761
      *                                                                   LN0761
      ** Use access program to read branch codes file                     LN0761
     C**********           CALL 'AOBRCHR0'                                             LN0761 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           LN0761
     C                     PARM '*KEY   ' @OPTN                           LN0761
     C                     PARM BRCA      @DSNB   3                       LN0761
     C********** @BRCH     PARM @BRCH     DSFDY                                        LN0761 CGL029
     C           @BRCH     PARM @BRCH     DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    LN0761
     C                     MOVEL'SDBRCHPD'DBFILE                          LN0761
     C                     MOVEL'04'      DBASE            ************   LN0761
     C                     MOVEL@OPTN     DBOPTN           * DBERR 04 *   LN0761
     C                     MOVELBRCA      DBKEY            ************   LN0761
     C                     GOTO ERROR                                     LN0761
     C                     END                                            LN0761
      *                                                                   LN0761
      ** Else the event branch is not the one requested                   LN0761
     C                     ELSE                                           LN0761
     C                     SETOF                     37                   LN0761
     C                     END                                            LN0761
     C                     END                                            LN0761
      *                                                                   LN0761
0468 C***********          SETON                     31                   LN0363
     C/COPY WNCPYSRC,DL0410C022
0468 C                     SETON                     3179                 LN0363
     C/COPY WNCPYSRC,DL0410C023
0469 C*
0470 C*    CONVERT EVENT DATE TO DDMMMYY FORMAT.
0471 C                     Z-ADDEDAT      ZDAYNO
0472 C                     EXSR ZDATE2
0473 C                     MOVE ZADATE    EDATA   7
     C/COPY WNCPYSRC,DL0410C057
     C**                                                                  S01303
     C**   TO CHECK FOR DIFF. MTH. & DIFF. YEAR                           S01303
     C**                                                                  S01303
     C           ZMTH      COMP OMTH                 8181                 S01303
     C           ZYEAR     COMP OYEAR                8282                 S01303
     C* If year changes, must also be change of month even if month no.   087548
     C* is the same.                                                      087548
     C*                                                                   087548
     C   82                SETON                     81                   087548
     C**      CHECK '+' OR '-' SIGN                                       S01303
     C   81                                                               S01303
     COR 82                EXSR CHECK                                     S01303
     C**                                                                  S01303
     C**   OUTPUT MONTHLY OR YEARLY SUB-TOTAL                             S01303
     C**                                                                  S01303
     C/COPY WNCPYSRC,DL0410C067
     C   81 83                                                            S01303
     COR 82 83             EXSR EXCEPT                                    S01303
     C**   STORE VALUE MONTH AND YEAR OF LAST EVENT                       S01303
     C                     Z-ADDZMTH      OMTH    20                      S01303
     C                     Z-ADDZYEAR     OYEAR   20                      S01303
     C**                                                                  S01303
     C  N83                MOVE '1'       *IN83                           S01303
     C**                                                                  S01303
0474 C*  47                Z-ADDEAMT      REVA                            S1107
0475 C*  47                Z-ADDSPOT      RATE                            S1107
0476 C*  47                GOTO PLCALC                                    S1107
     C*                                                                   S1107
     C*    CHECK IF EVENT IS AN OPTION DEAL                               S1107
     C*                                                                   S1107
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCP1                                           S01408
     C*                                                                   S01408
     C                     SETOF                     5253                 S1107
     C           ETYP      COMP '12V1'                   52               S1107
     C  N52      ETYP      COMP '12V2'                   53               S1107
     C*                                                                   S1107
0474 C   47                Z-ADDEAMT      REVA                            S0107
0475 C***********   47                Z-ADDSPOT      RATE          S0107 S01194
0475 C   47                Z-ADDA6SPRT    RATE                           S01194
0476 C   47                GOTO PLCALC                                    S0107
     C*                                                                   S1107
     C*    CONVERT EVENT AMOUNT TO BASE CURRENCY USING THE 'START DATE'   S1107
     C*    AS THE EVENT DATE                                              S1107
     C*                                                                   S1107
     C   52                                                               S1107
     COR 53                EXSR CONVTA                                    S1107
0477 C*
0478 C*    CONVERT EVENT AMOUNT TO BASE CURRENCY
0479 C                     EXSR CONVT
     C/COPY WNCPYSRC,DL0410C045
0480 C           PLCALC    TAG                             ** PLCALC TAG**
0481 C*
0482 C*    CALCULATE PROFIT/LOSS AMOUNT AND MAINTAIN
0483 C*    TOTAL FOR CURRENCY.
      *                                                                                       219337
      ** Set a work field that would determine which type of                                  219337
      ** method CPRLO subroutine should process.                                              219337
      *                                                                                       219337
     C                     MOVE 'N'       WNPVM   1                                           219337
0484 C                     EXSR CPRLO
     C/COPY WNCPYSRC,DL0410C080
      *                                                                                       CAS001
      ** DL0410 will process all the four different NPV method                                CAS001
      ** and output the details to PF/DLNPVLPD for ad hoc reporting.                          CAS001
      ** However, it will ony generate postings for one method.                               CAS001
      ** After processing method "N" or " ", process method "D",                              CAS001
      ** then method "B" and finally method "F". This additional                              CAS001
      ** process is for FX events only.                                                       CAS001
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
      *                                                                                       CAS001
      ** Initialize work fields                                                               CAS001
      *                                                                                       CAS001
     C                     MOVEL*BLANKS   WFLDS                                               CAS001
     C                     MOVEL*BLANKS   WIN23   1                                           CAS001
     C                     MOVEL*BLANKS   WIN51   1                                           CAS001
     C                     MOVEL*BLANKS   WIN55   1                                           CAS001
      *                                                                                       CAS001
     C                     MOVEL'N'       FSNPVM                                              CAS001
     C                     MOVEL*BLANKS   PNPYLD                                              CAS001
     C                     Z-ADD0         WDSCF                                               CAS001
     C                     Z-ADD0         WDSCFS                                              CAS001
     C                     EXSR SRWNPV                                                        CAS001
      *                                                                                       CAS001
     C           BNNPVM    IFEQ 'N'                                                           CAS001
     C           BNNPVM    OREQ ' '                                                           CAS001
     C                     MOVELDSNPVS    WFLDS                                               CAS001
     C                     MOVEL*IN23     WIN23                                               CAS001
     C                     MOVEL*IN51     WIN51                                               CAS001
     C                     MOVEL*IN55     WIN55                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Calculate Profit and Loss Using Method D                                             CAS001
      *                                                                                       CAS001
     C                     EXSR SRREVD                                                        CAS001
      *                                                                                       CAS001
      ** Calculate Profit and Loss Using Method B                                             CAS001
      *                                                                                       CAS001
     C                     EXSR SRREVB                                                        CAS001
      *                                                                                       CAS001
      ** Calculate Profit and Loss Using Method F                                             CAS001
      *                                                                                       CAS001
     C                     EXSR SRREVF                                                        CAS001
      *                                                                                       CAS008
      ** For CAS008 changes, populate RXCFLAPD fields                                         CAS008
      *                                                                                       CAS008
     C           CIR003    IFEQ 'Y'                                                           CAS008
     C           CAS008    ANDEQ'Y'                                                           CAS008
      *                                                                                       CAS008
     C           ETYP      IFEQ '23C3'                                                        CAS008
     C           ETYP      OREQ '23S3'                                                        CAS008
     C           ETYP      OREQ '23C4'                                                        CAS008
     C           ETYP      OREQ '23S4'                                                        CAS008
      *                                                                                       CAS008
     C                     MOVE EDLNO     IRDLNO                                              CAS008
     C                     MOVE 'RX'      IRDTYP                                              CAS008
     C                     MOVE DLST      IRDLST                                              CAS008
     C                     MOVE CLAS      IRCLAS                                              CDL038
     C                     Z-ADDEDAT      IRFLDT                                              CAS008
      *                                                                                       CAS008
      ** Convert Event Date to DDMMMYY format                                                 CAS008
      *                                                                                       CAS008
     C                     Z-ADDEDAT      ZDAYNO                                              CAS008
     C                     EXSR ZDATE2                                                        CAS008
     C                     MOVE ZADATE    IRDATE                                              CAS008
      *                                                                                       CAS008
     C           EDAT      SUB  EVCD      IRNDYP                                              CAS008
      *                                                                                       CAS008
     C                     Z-ADDEAMT      IRCAMT                                              CAS008
      *                                                                                       CAS008
     C                     Z-ADDWDSCF     IRDSCF                                              CAS008
     C                     MOVE INOI      IRIOIN                                              CAS008
     C                     MOVE ECNUM     IRCNUM                                              CAS008
     C                     MOVE BRCA      IRBRCA                                              CAS008
     C                     MOVE ECCY      IRCYCD                                              CAS008
     C                     MOVE BOKC      IRBKCD                                              CAS008
     C                     Z-ADD0         IRIRAT                                              CAS008
     C                     Z-ADD0         IRSPRR                                              CAS008
     C                     MOVE *BLANK    IRSPIN                                              CAS008
     C                     MOVE *BLANK    IRMISS                                              CAS008
      *                                                                                       CAS008
      ** If Yield Rates missing, update IRMISS accordingly.                                   CAS008
      *                                                                                       CAS008
     C           *IN30     IFEQ *ON                                                           CAS008
     C                     MOVE 'R'       IRMISS                                              CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
      ** If Yield Curve missing, update IRMISS accordingly.                                   CAS008
      *                                                                                       CAS008
     C           PNPYLD    IFNE *BLANKS                                                       CAS008
     C           PNPYLD    CHAINSDYLDCL1             34                                       CAS008
     C           *IN34     IFEQ *ON                                                           CAS008
     C                     MOVE 'C'       IRMISS                                              CAS008
     C                     ENDIF                                                              CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C           EDLNO     CHAINDLDLDGLE             34                                       CAS008
     C           *IN34     IFEQ *OFF                                                          CAS008
     C           ECCY      IFEQ UCUCY                                                         CAS008
     C                     MOVE UICBS     IRICBS                                              CAS008
     C                     MOVE FSOFYC    IRFYLD                                              CAS008
     C                     ELSE                                                               CAS008
     C                     MOVE TICBS     IRICBS                                              CAS008
     C                     MOVE FSTFYC    IRFYLD                                              CAS008
     C                     ENDIF                                                              CAS008
     C                     ELSE                                                               CAS008
     C                     MOVEL'DEALSDG' DBFILE                                              CAS008
     C                     MOVEL'24'      DBASE                                               CAS008
     C                     MOVELEDLNO     DBKEY                                               CAS008
     C                     GOTO ERROR                                                         CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
      ** Calculation Methods are:                                                             CAS008
      *                                                                                       CAS008
     C                     SELEC                                                              CAS008
      *                                                                                       CAS008
      ** 1  Actual/365                                                                        CAS008
      ** 4  365/365 (excluding 29/02)                                                         CAS008
      *                                                                                       CAS008
     C           IRICBS    WHEQ 1                                                             CAS008
     C           IRICBS    OREQ 4                                                             CAS008
     C                     Z-ADD365       IRNDYY                                              CAS008
      *                                                                                       CAS008
      ** 2  Actual/360                                                                        CAS008
      ** 3  360/360 (sometimes called 30/360)                                                 CAS008
      ** 5  365/360 (excluding 29/02)                                                         CAS008
      *                                                                                       CAS008
     C           IRICBS    WHEQ 2                                                             CAS008
     C           IRICBS    OREQ 3                                                             CAS008
     C           IRICBS    OREQ 5                                                             CAS008
     C                     Z-ADD360       IRNDYY                                              CAS008
      *                                                                                       CAS008
      ** 6  Actual/366                                                                        CAS008
      *                                                                                       CAS008
     C           IRICBS    WHEQ 6                                                             CAS008
     C                     Z-ADD366       IRNDYY                                              CAS008
      *                                                                                       CAS008
     C                     ENDSL                                                              CAS008
      *                                                                                       CAS008
      ** Determine value of Cash Flow Type                                                    CAS008
     C                     SELEC                                                              CAS008
      *                                                                                       CAS008
     C           VDAT      WHEQ EDAT                                                          CAS008
     C                     MOVE 'VAMT'    IRFTYP                                              CAS008
      *                                                                                       CAS008
     C           BOVD      WHEQ EDAT                                                          CAS008
     C           MDAT      OREQ EDAT                                                          CAS008
     C                     MOVE 'MAMT'    IRFTYP                                              CAS008
      *                                                                                       CAS008
     C                     OTHER                                                              CAS008
      *                                                                                       CAS008
      ** For Principal Increase, 'S3' or 'C3'.  For                                           CAS008
      ** Principal Decrease, 'S4' or 'C4'.                                                    CAS008
      *                                                                                       CAS008
     C           ETYP      IFEQ '23S3'                                                        CAS008
     C           ETYP      OREQ '23C3'                                                        CAS008
     C                     MOVE 'PINC'    IRFTYP                                              CAS008
     C                     ENDIF                                                              CAS008
     C           ETYP      IFEQ '23S4'                                                        CAS008
     C           ETYP      OREQ '23C4'                                                        CAS008
     C                     MOVE 'PDEC'    IRFTYP                                              CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C                     ENDSL                                                              CAS008
      *                                                                                       CAS008
     C           BNNPVM    IFEQ 'F'                                                           CAS008
     C           *INU1     ANDEQ*ON                                                           CAS008
     C           BNNPV2    OREQ 'F'                                                           CAS008
     C           *INU1     ANDEQ*OFF                                                          CAS008
     C                     MOVE PNPYLD    IRYLDC                                              CAS008
     C                     ELSE                                                               CAS008
     C                     MOVELBNBCYC    IRYLDC                                              CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C           IRCAMT    MULT IRDSCF    IRNPVA                                              CAS008
      *                                                                                       CAS008
     C                     WRITERXCFLAD0                                                      CAS008
      *                                                                                       CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS001
      ** Restore back fields for reporting                                                    CAS001
      *                                                                                       CAS001
     C                     MOVELWFLDS     DSNPVS                                              CAS001
     C                     MOVELWIN23     *IN23                                               CAS001
     C                     MOVELWIN51     *IN51                                               CAS001
     C                     MOVELWIN55     *IN55                                               CAS001
      *                                                                                       CAS001
     C           *IN09     IFEQ *OFF                                                          CAS001
     C                     EXSR SRPRD1                                                        CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                   CEU011
      ** If CEU011 is ON, do the processing for Revaluation of Forward    CEU011
      ** Commitments of 'In' currencies and the Euro currency.            CEU011
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
      *                                                                   CEU011
      ** If change in branch, output totals                               CEU011
      *                                                                   CEU011
     C           *INL2     IFEQ *ON                                       CEU011
     C           WBRCA     ANDNE*BLANKS                                   CEU011
      *                                                                   CEU011
      * Since *inL2 is NOT correctly  set ON  when the branch changes ,   155225
      * check its value against Branch-field-check 'WBFCK'  and use WFRST 155225
      * to make sure it is not the very first, initial run .              155225
     C           BRCA      ORNE WBFCK                                     155225
     C           WFRST     ANDNE' '                                       155225
      *                                                                   155225
     C                     MOVE *BLANKS   ZFLD15                          CEU011
     C                     MOVE ETDBCE    ZFLD15                          CEU011
     C**********           Z-ADDA6NBDP    ZDECS                     CEU011140989
     C                     Z-ADDWENBDP    ZDECS                           140989
     C                     MOVE 'J'       ZECODE                          CEU011
     C                     EXSR ZSEDIT                                    CEU011
     C                     MOVE ZOUT21    PTOTL1                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   ZFLD15                          CEU011
     C                     MOVE ETREVA    ZFLD15                          CEU011
     C**********           Z-ADDA6NBDP    ZDECS                     CEU011140989
     C                     Z-ADDWENBDP    ZDECS                           140989
     C                     MOVE 'J'       ZECODE                          CEU011
     C                     EXSR ZSEDIT                                    CEU011
     C                     MOVE ZOUT21    PTOTL2                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   ZFLD15                          CEU011
     C                     MOVE ETPROF    ZFLD15                          CEU011
     C**********           Z-ADDA6NBDP    ZDECS                     CEU011140989
     C                     Z-ADDWENBDP    ZDECS                           140989
     C                     MOVE 'J'       ZECODE                          CEU011
     C                     EXSR ZSEDIT                                    CEU011
     C                     MOVE ZOUT21    PTOTL3                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   ZFLD15                          CEU011
     C                     MOVE ETLOSS    ZFLD15                          CEU011
     C**********           Z-ADDA6NBDP    ZDECS                     CEU011140989
     C                     Z-ADDWENBDP    ZDECS                           140989
     C                     MOVE 'J'       ZECODE                          CEU011
     C                     EXSR ZSEDIT                                    CEU011
     C                     MOVE ZOUT21    PTOTL4                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   ZFLD15                          CEU011
     C                     MOVE ETOTPL    ZFLD15                          CEU011
     C**********           Z-ADDA6NBDP    ZDECS                     CEU011140989
     C                     Z-ADDWENBDP    ZDECS                           140989
     C                     MOVE 'J'       ZECODE                          CEU011
     C                     EXSR ZSEDIT                                    CEU011
     C                     MOVE ZOUT21    PTOTL5                          CEU011
      *                                                                   CEU011
     C           *IN18     IFEQ *ON                                       142250
     C           PRTLN2    IFGE 49                                        CEU011
     C                     WRITEDL0410D1                                  CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      ** Write the total for the particular branch.                       CEU011
      *                                                                   CEU011
     C                     WRITEDL0410D3                                  CEU011
     C                     WRITEDL0410D4                                  CEU011
      *
     C           FCHK      IFEQ '1'                                       151153
     C                     CLOSEDL0410P2                                  CEU011
     C                     MOVE ' '       FCHK    1                       151153
     C                     ENDIF                                          142250
     C                     ENDIF                                          151153
      *                                                                   151153
     C           FCHK      IFEQ ' '                                       151153
     C                     OPEN DL0410P2                                  CEU011
     C                     MOVE '1'       FCHK    1                       151153
     C                     ENDIF                                          151153
      *                                                                   CEU011
     C                     MOVE BRCA      PBRNCH                          CEU011
     C                     MOVE A8BRNM    PBRNCD                          CEU011
      *                                                                   142799
     C                     Z-ADDSFNUM2    ZSNUM   60                      142799
     C                     CALL 'ZSFILE'                                  142799
     C                     PARM           SEQ     5                       142799
     C                     PARM PBRNCH    @PARM   3                       142799
     C                     PARM           SFILE2                          142799
     C                     PARM           ZSNUM                           142799
     C                     PARM *BLANK    ZSERR   1                       142799
      *                                                                   142799
      ** Error during ZSFILE processing, return to calling program        142799
      *                                                                   142799
     C           ZSERR     IFEQ 'Y'                                       142799
     C                     SETON                     U7U8LR               142799
     C                     RETRN                                          142799
     C                     ENDIF                                          142799
      *                                                                   142799
     C**********           WRITEDL0410D1                            CEU011142250
     C**********           MOVE *ON       *IN18                     CEU011142250
     C                     WRITEDL0410D1                                  158840
      *                                                                   CEU011
      ** Initialise totals fields.                                        CEU011
      *                                                                   CEU011
     C                     Z-ADD*ZEROS    ETDBCE                          CEU011
     C                     Z-ADD*ZEROS    ETREVA                          CEU011
     C                     Z-ADD*ZEROS    ETPROF                          CEU011
     C                     Z-ADD*ZEROS    ETLOSS                          CEU011
     C                     Z-ADD*ZEROS    ETOTPL                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     MOVE BRCA      WBRCA   3                       CEU011
      *                                                                   155225
     C                     MOVE BRCA      WBFCK   3                       155225
     C                     MOVE '1'       WFRST   1                       155225
      *                                                                   CEU011
     C           *IN21     IFEQ *ON                                       CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   SINCY   1                       CEU011
     C           *IN02     IFEQ *ON                                       CEU011
     C                     CALL 'AOCURRR0'                                CEU011
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*KEY   ' @OPTN                           CEU011
     C                     PARM ECCY      @AJCD                           CEU011
     C           @CURR     PARM @CURR     DSSDY                           CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANK                                    CEU011
     C                     MOVEL'SDCURRPD'DBFILE                          CEU011
     C                     MOVEL'05'      DBASE            ************   CEU011
     C                     MOVEL@OPTN     DBOPTN           * DBERR 05 *   CEU011
     C                     MOVELECCY      DBKEY            ************   CEU011
     C                     GOTO ERROR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     MOVE A6INCY    SINCY                           CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      ** If the event currency is an 'In' currency or it is the Euro      CEU011
      ** currency, it should be included in the Consolidated Euro         CEU011
      ** Position report.                                                 CEU011
      *                                                                   CEU011
     C           INCY      IFEQ 'Y'                                       CEU011
     C           SINCY     OREQ 'Y'                                       CEU011
     C           ECCY      OREQ BKEURO                                    CEU011
      *                                                                   CEU011
      ** Convert the Dealt Base Equivalent Amount to Euro                 CEU011
      *                                                                   CEU011
     C           BKEURO    IFEQ BJCYCD                                    CEU011
     C                     Z-ADDDBCE      EUDBCE                          CEU011
     C                     ELSE                                           CEU011
     C                     Z-ADDDBCE      P@FRAM                          CEU011
     C                     EXSR P001                                      CEU011
     C                     MOVE P@OUTA    EUDBCE 130                      CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      ** Convert the Revalued Equivalent Amount to Euro                   CEU011
      *                                                                   CEU011
     C           BKEURO    IFEQ BJCYCD                                    CEU011
     C           *IN55     IFEQ *OFF                                      CEU011
     C                     Z-ADDREVA      EUREVA                          CEU011
     C                     ELSE                                           CEU011
     C                     Z-ADDREVAS     EUREVA                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ELSE                                           CEU011
     C           *IN55     IFEQ *OFF                                      CEU011
     C                     Z-ADDREVA      P@FRAM                          CEU011
     C                     ELSE                                           CEU011
     C                     Z-ADDREVAS     P@FRAM                          CEU011
     C                     ENDIF                                          CEU011
     C                     EXSR P001                                      CEU011
     C                     MOVE P@OUTA    EUREVA 130                      CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      ** Convert the Profit/Loss Amount to Euro                           CEU011
      *                                                                   CEU011
     C           BKEURO    IFEQ BJCYCD                                    CEU011
     C                     Z-ADDPLAM      EUPLAM                          CEU011
     C                     ELSE                                           CEU011
     C                     Z-ADDPLAM      P@FRAM                          CEU011
     C                     EXSR P001                                      CEU011
     C                     MOVE P@OUTA    EUPLAM 130                      CEU011
     C                     ENDIF                                          CEU011
      *                                                                   158840
      * If Incoming --> 'TO'  Nostro Transfer payment,   it should be     158840
      * opposite sign of the previous 'FROM'  payment .                   158840
     C           *IN19     IFEQ '1'                                       158840
     C           WNTCHK    ANDEQ'Y'                                       158840
     C                     Z-SUBEUPLAM    EUPLAM                          158840
     C                     END                                            158840
      *                                                                   CEU011
     C           *IN22     IFEQ *ON                                       CEU011
      *                                                                   158840
      * If Incoming --> 'TO'  Nostro Transfer payment,  opposite calcula  158840
      * tion should be used .                                             158840
     C           *IN19     OREQ '1'                                       158840
     C           WNTCHK    ANDEQ'Y'                                       158840
     C                     ADD  EUDBCE    ETDBCE 130                      CEU011
     C                     ADD  EUREVA    ETREVA 130                      CEU011
     C                     ELSE                                           CEU011
     C                     SUB  EUDBCE    ETDBCE                          CEU011
     C                     SUB  EUREVA    ETREVA                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ADD  EUPLAM    ETOTPL 130                      CEU011
      *                                                                   CEU011
     C           *IN23     IFEQ *ON                                       CEU011
     C                     ADD  EUPLAM    ETPROF 130                      CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           *IN51     IFEQ *ON                                       CEU011
     C                     ADD  EUPLAM    ETLOSS 130                      CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      ** Write a record to DL0410P2                                       CEU011
      *                                                                   CEU011
     C                     EXSR P002                                      CEU011
     C                     ENDIF                                          CEU011
     C                     ENDIF                                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCP4                                           S01408
     C*                                                                   S01408
     C***RESTORE*CODING*TO*PREVIOUS*STATE*******************              S01119
     C***22      TEAMT     ADD  EAMT      TEAMT  130                      S01119
     C**N22*     TEAMT     SUB  EAMT      TEAMT                           S01119
0485 C**         TEAMT     ADD  EAMT      TEAMT  130
     C*                                                                   S01119
     C*****FOR*SETTING*OF*EAMSGN*VALUE*SEE*SR.*CPRLO.*******        S01119E14293
     C*                                                                   S01119
     C** RESTORE CODING TO PREVIOUS STATE - EAMSGN SHOULD BE USED ONLY    E14293
     C** FOR DETERMINING P/L AND SIGN PRINTING                            E14293
     C***********EAMSGN    IFEQ '+'                                 S01119E14293
     C           *IN,22    IFEQ '1'                                       E14293
     C/COPY WNCPYSRC,DL0410C046
      *                                                                   158840
      * If Incoming --> 'TO'  Nostro Transfer payment,  opposite calcula  158840
      * tion should be used .                                             158840
     C           *IN19     OREQ '1'                                       158840
     C           WNTCHK    ANDEQ'Y'                                       158840
      *                                                                   158840
     C/COPY WNCPYSRC,DL0410C075
     C           TEAMT     ADD  EAMT      TEAMT  130                      S01119
     C                     ELSE                                           S01119
     C/COPY WNCPYSRC,DL0410C047
     C           TEAMT     SUB  EAMT      TEAMT  130                      S01119
     C                     END                                            S01119
0487 C***********TOTPL     ADD  PLAM      TOTPL  130 2446                 E10953
0487 C***********TOTPL     ADD  PLAM      TOTPL  150 2446           E10953E12711
     C/COPY WNCPYSRC,DL0410C035
      *                                                                   158840
      * If Incoming --> 'TO'  Nostro Transfer payment,  opposite calcula  158840
      * tion should be used .                                             158840
     C           *IN19     IFEQ '1'                                       158840
     C           WNTCHK    ANDEQ'Y'                                       158840
     C                     SELEC                                                              217120
     C           BNNPVM    WHEQ 'N'                                                           217120
     C           BNNPVM    OREQ ' '                                                           217120
     C           TOTPL     SUB  PLAM      TOTPL      2446                 158840
     C           TOTBR     SUB  PLAM      TOTBR                           158840
     C           BNNPVM    WHEQ 'D'                                                           217120
     C                     SUB  PLAMD     TOTPL      2446                                     217120
     C                     SUB  PLAMD     TOTBR                                               217120
     C           BNNPVM    WHEQ 'B'                                                           217120
     C                     SUB  PLAMB     TOTPL      2446                                     217120
     C                     SUB  PLAMB     TOTBR                                               217120
     C           BNNPVM    WHEQ 'F'                                                           217120
     C                     SUB  PLAMF     TOTPL      2446                                     217120
     C                     SUB  PLAMF     TOTBR                                               217120
     C                     ENDSL                                                              217120
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     SELEC                                                              CAS005
     C           BNNPVM    WHEQ 'N'                                                           CAS005
     C           BNNPVM    OREQ ' '                                                           CAS005
     C           PLAM      IFGE 0                                                             CAS005
     C                     SUB  PLAM      WLAMT  130                                          CAS005
     C                     ELSE                                                               CAS005
     C                     SUB  PLAM      WPAMT  130                                          CAS005
     C                     ENDIF                                                              CAS005
     C           BNNPVM    WHEQ 'D'                                                           CAS005
     C           PLAMD     IFGE 0                                                             CAS005
     C                     SUB  PLAMD     WLAMT                                               CAS005
     C                     ELSE                                                               CAS005
     C                     SUB  PLAMD     WPAMT                                               CAS005
     C                     ENDIF                                                              CAS005
     C           BNNPVM    WHEQ 'B'                                                           CAS005
     C           PLAMB     IFGE 0                                                             CAS005
     C                     SUB  PLAMB     WLAMT                                               CAS005
     C                     ELSE                                                               CAS005
     C                     SUB  PLAMB     WPAMT                                               CAS005
     C                     ENDIF                                                              CAS005
     C           BNNPVM    WHEQ 'F'                                                           CAS005
     C           PLAMF     IFGE 0                                                             CAS005
     C                     SUB  PLAMF     WLAMT                                               CAS005
     C                     ELSE                                                               CAS005
     C                     SUB  PLAMF     WPAMT                                               CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDSL                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   158840
     C                     ELSE                                           158840
     C                     SELEC                                                              217120
     C           BNNPVM    WHEQ 'N'                                                           217120
     C           BNNPVM    OREQ ' '                                                           217120
0487 C           TOTPL     ADD  PLAM      TOTPL  130 2446                 E12711
     C/COPY WNCPYSRC,DL0410C042
     C           BNNPVM    WHEQ 'D'                                                           217120
     C                     ADD  PLAMD     TOTPL      2446                                     217120
     C           BNNPVM    WHEQ 'B'                                                           217120
     C                     ADD  PLAMB     TOTPL      2446                                     217120
     C           BNNPVM    WHEQ 'F'                                                           217120
     C                     ADD  PLAMF     TOTPL      2446                                     217120
     C                     ENDSL                                                              217120
     C                     SELEC                                                              217120
     C           BNNPVM    WHEQ 'N'                                                           217120
     C           BNNPVM    OREQ ' '                                                           217120
     C           TOTBR     ADD  PLAM      TOTBR  130
     C           BNNPVM    WHEQ 'D'                                                           217120
     C                     ADD  PLAMD     TOTBR                                               217120
     C           BNNPVM    WHEQ 'B'                                                           217120
     C                     ADD  PLAMB     TOTBR                                               217120
     C           BNNPVM    WHEQ 'F'                                                           217120
     C                     ADD  PLAMF     TOTBR                                               217120
     C                     ENDSL                                                              217120
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     SELEC                                                              CAS005
     C           BNNPVM    WHEQ 'N'                                                           CAS005
     C           BNNPVM    OREQ ' '                                                           CAS005
     C           PLAM      IFGE 0                                                             CAS005
     C                     ADD  PLAM      WPAMT                                               CAS005
     C                     ELSE                                                               CAS005
     C                     ADD  PLAM      WLAMT                                               CAS005
     C                     ENDIF                                                              CAS005
     C           BNNPVM    WHEQ 'D'                                                           CAS005
     C           PLAMD     IFGE 0                                                             CAS005
     C                     ADD  PLAMD     WPAMT                                               CAS005
     C                     ELSE                                                               CAS005
     C                     ADD  PLAMD     WLAMT                                               CAS005
     C                     ENDIF                                                              CAS005
     C           BNNPVM    WHEQ 'B'                                                           CAS005
     C           PLAMB     IFGE 0                                                             CAS005
     C                     ADD  PLAMB     WPAMT                                               CAS005
     C                     ELSE                                                               CAS005
     C                     ADD  PLAMB     WLAMT                                               CAS005
     C                     ENDIF                                                              CAS005
     C           BNNPVM    WHEQ 'F'                                                           CAS005
     C           PLAMF     IFGE 0                                                             CAS005
     C                     ADD  PLAMF     WPAMT                                               CAS005
     C                     ELSE                                                               CAS005
     C                     ADD  PLAMF     WLAMT                                               CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDSL                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                   158840
     C                     END                                            158840
     C/COPY WNCPYSRC,DL0410C024
     C*                                                                   S01303
     C** TO ACCUMULATE MONTHLY AND YEARLY SUB-TOTAL                       S01303
     C** For option deals, the revaluation amount reported is the         054383
     C** lowest of revaluation using event date (REVA), and               054383
     C** revaluation using start date (REVAS) - the correct amount        054383
     C** should be used when calculating monthly and yearly totals.       054383
     C*                                                                   S01303
     C           *IN22     IFEQ '1'                                       S01303
      *                                                                   158840
      * If Incoming --> 'TO'  Nostro Transfer payment,  opposite calcula  158840
      * tion should be used .                                             158840
     C           *IN19     OREQ '1'                                       158840
     C           WNTCHK    ANDEQ'Y'                                       158840
      *                                                                   158840
     C                     ADD  EAMT      MEAMT  130                      S01303
     C                     ADD  DBCE      MDBCE  130                      S01303
     C***********          ADD  REVA      MREVA  130               S01303 054383
     C*                                                                   054383
     C           *IN55     IFEQ '0'                                       054383
     C                     ADD  REVA      MREVA  130                      054383
     C                     ELSE                                           054383
     C                     ADD  REVAS     MREVA  130                      054383
     C                     END                                            054383
     C*                                                                   054383
     C                     ADD  EAMT      YEAMT  130                      S01303
     C                     ADD  DBCE      YDBCE  130                      S01303
     C***********          ADD  REVA      YREVA  130               S01303 054383
     C*                                                                   054383
     C           *IN55     IFEQ '0'                                       054383
     C                     ADD  REVA      YREVA  130                      054383
     C                     ELSE                                           054383
     C                     ADD  REVAS     YREVA  130                      054383
     C                     END                                            054383
     C*                                                                   054383
     C                     ADD  DBCE      TDBCE  130                      S01303
     C***********          ADD  REVA      TREVA  130               S01303 054383
     C*                                                                   054383
     C           *IN55     IFEQ '0'                                       054383
     C                     ADD  REVA      TREVA  130                      054383
     C                     ELSE                                           054383
     C                     ADD  REVAS     TREVA  130                      054383
     C                     END                                            054383
     C*                                                                   054383
     C                     ELSE                                           S01303
     C                     SUB  EAMT      MEAMT  130                      S01303
     C                     SUB  DBCE      MDBCE  130                      S01303
     C***********          SUB  REVA      MREVA  130               S01303 054383
     C*                                                                   054383
     C           *IN55     IFEQ '0'                                       054383
     C                     SUB  REVA      MREVA  130                      054383
     C                     ELSE                                           054383
     C                     SUB  REVAS     MREVA  130                      054383
     C                     END                                            054383
     C*                                                                   054383
     C                     SUB  EAMT      YEAMT  130                      S01303
     C                     SUB  DBCE      YDBCE  130                      S01303
     C***********          SUB  REVA      YREVA  130               S01303 054383
     C*                                                                   054383
     C           *IN55     IFEQ '0'                                       054383
     C                     SUB  REVA      YREVA  130                      054383
     C                     ELSE                                           054383
     C                     SUB  REVAS     YREVA  130                      054383
     C                     END                                            054383
     C*                                                                   054383
     C                     SUB  DBCE      TDBCE  130                      S01303
     C***********          SUB  REVA      TREVA  130               S01303 054383
     C*                                                                   054383
     C           *IN55     IFEQ '0'                                       054383
     C                     SUB  REVA      TREVA  130                      054383
     C                     ELSE                                           054383
     C                     SUB  REVAS     TREVA  130                      054383
     C                     END                                            054383
     C*                                                                   054383
     C                     END                                            S01303
     C/COPY WNCPYSRC,DL0410C036
      *                                                                   158840
      * If Incoming --> 'TO'  Nostro Transfer payment,  opposite calcula  158840
      * tion should be used .                                             158840
     C           *IN19     IFEQ '1'                                       158840
     C           WNTCHK    ANDEQ'Y'                                       158840
     C                     SELEC                                                              217120
     C           BNNPVM    WHEQ 'N'                                                           217120
     C           BNNPVM    OREQ ' '                                                           217120
     C                     SUB  PLAM      MPLAM                           158840
     C                     SUB  PLAM      YPLAM                           158840
     C**                                                                  158840
     C   23                SUB  PLAM      TPROF                           158840
     C   51                SUB  PLAM      TLOSS                           158840
     C           BNNPVM    WHEQ 'D'                                                           217120
     C                     SUB  PLAMD     MPLAM                                               217120
     C                     SUB  PLAMD     YPLAM                                               217120
      *                                                                                       217120
     C   23                SUB  PLAMD     TPROF                                               217120
     C   51                SUB  PLAMD     TLOSS                                               217120
     C           BNNPVM    WHEQ 'B'                                                           217120
     C                     SUB  PLAMB     MPLAM                                               217120
     C                     SUB  PLAMB     YPLAM                                               217120
      *                                                                                       217120
     C   23                SUB  PLAMB     TPROF                                               217120
     C   51                SUB  PLAMB     TLOSS                                               217120
     C           BNNPVM    WHEQ 'F'                                                           217120
     C                     SUB  PLAMF     MPLAM                                               217120
     C                     SUB  PLAMF     YPLAM                                               217120
      *                                                                                       217120
     C   23                SUB  PLAMF     TPROF                                               217120
     C   51                SUB  PLAMF     TLOSS                                               217120
     C                     ENDSL                                                              217120
      *                                                                   158840
     C                     ELSE                                           158840
     C                     SELEC                                                              217120
     C           BNNPVM    WHEQ 'N'                                                           217120
     C           BNNPVM    OREQ ' '                                                           217120
     C                     ADD  PLAM      MPLAM  130                      S01303
     C                     ADD  PLAM      YPLAM  130                      S01303
     C**                                                                  S01303
     C   23                ADD  PLAM      TPROF  130                      S01303
     C   51                ADD  PLAM      TLOSS  130                      S01303
     C           BNNPVM    WHEQ 'D'                                                           217120
     C                     ADD  PLAMD     MPLAM                                               217120
     C                     ADD  PLAMD     YPLAM                                               217120
      *                                                                                       217120
     C   23                ADD  PLAMD     TPROF                                               217120
     C   51                ADD  PLAMD     TLOSS                                               217120
     C           BNNPVM    WHEQ 'B'                                                           217120
     C                     ADD  PLAMB     MPLAM                                               217120
     C                     ADD  PLAMB     YPLAM                                               217120
      *                                                                                       217120
     C   23                ADD  PLAMB     TPROF                                               217120
     C   51                ADD  PLAMB     TLOSS                                               217120
     C           BNNPVM    WHEQ 'F'                                                           217120
     C                     ADD  PLAMF     MPLAM                                               217120
     C                     ADD  PLAMF     YPLAM                                               217120
      *                                                                                       217120
     C   23                ADD  PLAMF     TPROF                                               217120
     C   51                ADD  PLAMF     TLOSS                                               217120
     C                     ENDSL                                                              217120
      *                                                                   158840
     C                     END                                            158840
     C/COPY WNCPYSRC,DL0410C014
     C**                                                                  S01303
0488 C*
0489 C*    INCREMENT TOTAL OF RECORDS REPORTED.
0490 C*****      RECS      ADD  1         RECS    50                      S01117
0490 C   37      RECS      ADD  1         RECS    50                      S01117
     C/COPY WNCPYSRC,DL0410C025
     C*
0491 C                     GOTO END
0492 C*
0493 C*    SET ERROR INDICATORS.
0494 C           ERROR     TAG                             ** ERROR TAG **
0495 C                     SETON                     U7U8LR
     C                     EXSR *PSSR                                     S01194
0496 C*
0497 C*    END OF DETAIL CALULATIONS.
0498 C           END       TAG                             ** END TAG **
0499 C*
0500 C*    TOTAL CALCULATIONS.
     C*1NU7*U1***          Z-ADD1         A                               S01117
     C*1NU7*U1   BRCD      LOKUPBRAR,A                   75               S01117
     C*1NU7*U1***BRCA      LOKUPBRAR,A                   75               S01117
     C*1NU7*U1***TBR,A     ADD  TOTBR     TBR,A                           S01117
     C*1NU7*U1***          Z-ADD0         TOTBR                           S01117
0502 C*1NU7******TEAMT     COMP 0                    25             S01117E151
     C/COPY WNCPYSRC,DL0410C003
0502 CL1NU7      TEAMT     COMP 0                    25                   E151
     C/COPY WNCPYSRC,DL0410C069
     C*                                                                   S01303
     CL1NU7 31             MOVEA'11'      *IN,81                          S01303
     CL1NU7 31             EXSR CHECK                                     S01303
     CL1NU7 31             EXSR EXCEPT                                    S01303
     CL1NU7                MOVE '0'       *IN83                           S01303
     CL1NU7      TDBCE     COMP 0                    8889                 S01303
     CL1NU7      TREVA     COMP 0                    4849                 S01303
     C/COPY WNCPYSRC,DL0410C037
     CL2NU7 U1             Z-ADD1         A                               S01117
     CL2NU7 U1   BRCA      LOKUPBRAR,A                   75               S01117
     C/COPY WNCPYSRC,DL0410C015
      *                                                                                       CAS005
     CL2NU7 U1   CAS005    IFEQ 'N'                                                           CAS005
     CL2NU7 U1   TBR,A     ADD  TOTBR     TBR,A                           S01117
     CL2                   ELSE                                                               CAS005
     CL2NU7 U1   TBP,A     ADD  WPAMT     TBP,A                                               CAS005
     CL2NU7 U1   TBL,A     ADD  WLAMT     TBL,A                                               CAS005
     CL2                   ENDIF                                                              CAS005
      *                                                                                       CAS005
     CL2NU7 U1             Z-ADD0         TOTBR                           S01117
      *                                                                                       CAS005
     CL2NU7 U1   CAS005    IFEQ 'Y'                                                           CAS005
     CL2NU7 U1             Z-ADD0         WPAMT                                               CAS005
     CL2NU7 U1             Z-ADD0         WLAMT                                               CAS005
     CL2                   ENDIF                                                              CAS005
      *                                                                                       CAS005
     C*L2NU7******TEAMT*****COMP 0                    25            S01117E151
0503 C*
0503 C*
     C/COPY WNCPYSRC,DL0410C009
      *                                                                   CEU011
     CLR         CEU011    IFEQ 'Y'                                       CEU011
      *                                                                   CEU011
     CLR                   MOVE *BLANKS   ZFLD15                          CEU011
     CLR                   MOVE ETDBCE    ZFLD15                          CEU011
     C**LR********         Z-ADDA6NBDP    ZDECS                     CEU011140989
     CLR                   Z-ADDWENBDP    ZDECS                           140989
     CLR                   MOVE 'J'       ZECODE                          CEU011
     CLR                   EXSR ZSEDIT                                    CEU011
     CLR                   MOVE ZOUT21    PTOTL1                          CEU011
      *                                                                   CEU011
     CLR                   MOVE *BLANKS   ZFLD15                          CEU011
     CLR                   MOVE ETREVA    ZFLD15                          CEU011
     C**LR********         Z-ADDA6NBDP    ZDECS                     CEU011140989
     CLR                   Z-ADDWENBDP    ZDECS                           140989
     CLR                   MOVE 'J'       ZECODE                          CEU011
     CLR                   EXSR ZSEDIT                                    CEU011
     CLR                   MOVE ZOUT21    PTOTL2                          CEU011
      *                                                                   CEU011
     CLR                   MOVE *BLANKS   ZFLD15                          CEU011
     CLR                   MOVE ETPROF    ZFLD15                          CEU011
     C**LR********         Z-ADDA6NBDP    ZDECS                     CEU011140989
     CLR                   Z-ADDWENBDP    ZDECS                           140989
     CLR                   MOVE 'J'       ZECODE                          CEU011
     CLR                   EXSR ZSEDIT                                    CEU011
     CLR                   MOVE ZOUT21    PTOTL3                          CEU011
      *                                                                   CEU011
     CLR                   MOVE *BLANKS   ZFLD15                          CEU011
     CLR                   MOVE ETLOSS    ZFLD15                          CEU011
     C**LR********         Z-ADDA6NBDP    ZDECS                     CEU011140989
     CLR                   Z-ADDWENBDP    ZDECS                           140989
     CLR                   MOVE 'J'       ZECODE                          CEU011
     CLR                   EXSR ZSEDIT                                    CEU011
     CLR                   MOVE ZOUT21    PTOTL4                          CEU011
      *                                                                   CEU011
     CLR                   MOVE *BLANKS   ZFLD15                          CEU011
     CLR                   MOVE ETOTPL    ZFLD15                          CEU011
     C**LR********         Z-ADDA6NBDP    ZDECS                     CEU011140989
     CLR                   Z-ADDWENBDP    ZDECS                           140989
     CLR                   MOVE 'J'       ZECODE                          CEU011
     CLR                   EXSR ZSEDIT                                    CEU011
     CLR                   MOVE ZOUT21    PTOTL5                          CEU011
      *                                                                   CEU011
     CLR         *IN18     IFEQ *ON                                       CEU011
     CLR         PRTLN2    IFGE 49                                        CEU011
     CLR                   WRITEDL0410D1                                  CEU011
     CLR                   ENDIF                                          CEU011
     CLR                   WRITEDL0410D3                                  CEU011
     CLR                   WRITEDL0410D4                                  CEU011
      *                                                                   151153
     CLR         FCHK      IFEQ '1'                                       151153
     CLR                   CLOSEDL0410P2                                  CEU011
     CLR                   MOVE ' '       FCHK                            151153
     CLR                   ENDIF                                          151153
     CLR                   ENDIF                                          CEU011
      *                                                                   CEU011
     CLR                   ENDIF                                          CEU011
      *                                                                   CEU011
0504 C*    IGNORE LR CALCULATIONS IF DATABASE ERROR OR SWITCH 1 OFF
0505 CLRNU1
0506 COR U7                GOTO FIN
     C/COPY WNCPYSRC,DL0410C026
0507 C*
0508 C*    SETUP KEY FOR ACCOUNT MASTER FILE.
     CLR                   Z-ADD0         A
     C/COPY WNCPYSRC,DL0410C048
     C/SPACE 3                                                            LN0188
     C*******                                                             LN0188
      *    REPEAT FOR EACH BRANCH                                         LN0188
     C*******                                                             LN0188
     CLR         AGAIN     TAG
     C/COPY WNCPYSRC,DL0410C049
     CLR         A         ADD  1         A
     C*LR******* BICA,A    COMP 0                        76                                   CSD027
     CLR         BICA,A    COMP *BLANKS                  76                                   CSD027
     CLR 76                GOTO FINISH
     C/SPACE 3                                                            LN0188
     C*******                                                             LN0188
      *    DO FWD REVAL P/L ACCOUNT                                       LN0188
     C*******                                                             LN0188
     C/COPY WNCPYSRC,DL0410C010
     CLR                   MOVELBICA,A    WK9     9
0510 C**********LR                   MOVE BCCY      WK9                   S01194
0510 CLR                   MOVE BJCYCD    WK9                             S01194
0511 C***LR*****              MOVE '01'      WK6     6                                        CGL029
0511 C***LR*****              MOVE '01'      WK6    12                               CGL029 BUG5336R
0511 CLR                   MOVE '01'      WK12   12                                         BUG5336R
0512 C*****LR                   MOVELWK9       ACCKEY 15                  S01117
0512 C***LR*****              MOVELWK9       ACCKEY 18                                 S01117 CGL029
0512 CLR                   MOVELWK9       ACCKEY 24                                           CGL029
0513 C*    ACCESS FWD REVAL. P/L A/C.
     C**********LR                   MOVELFRPC      WK6                   S01194
     C***LR*****              MOVELBNACCD    WK6                                     S01194 BUG5336R
     CLR                   MOVELBNACCD    WK12                                              BUG5336R
     C/COPY WNCPYSRC,DL0410C084
     C***LR*****              MOVELWK6       WK9A    9                                 S01117 CGL029
     C***LR*****              MOVELWK6       WK9A   15                               CGL029 BUG5336R
     CLR                   MOVELWK12      WK15   15                                         BUG5336R
0513 C*    INSERT BRANCH CODE INTO ACCOUNT KEY                            S01117
     C***LR*****              MOVE BRAR,A    WK9A                                    S01117 BUG5336R
0515 C*****                MOVE WK6       ACCKEY                          S01117
0515 C***LR*****              MOVE WK9A      ACCKEY                                  S01117 BUG5336R
     CLR                   MOVE BRAR,A    WK15                                              BUG5336R
0515 CLR                   MOVE WK15      ACCKEY                                            BUG5336R
0512 C***LR*****              MOVELACCKEY    ACCKY  15                                 S01117 CGL029
0512 CLR                   MOVELACCKEY    ACCKY  21                                           CGL029
0516 CLR                   EXSR ACCHN
0518 C*
0519 C*****OBTAIN ACCOUNT TYPE FROM A/C CODES TABLE****************       S01194
0520 C**********LR                   MOVEL'30'      TABKEY                S01194
0521 C**********LR                   MOVELFRPA      WK5                   S01194
0522 C**********LR                   MOVE WK5       TABKEY                S01194
0523 C**********LR                   EXSR TABCHN                          S01194
0524 C**********LRN09                GOTO LRERR                           S01194
     C/COPY WNCPYSRC,DL0410C030
     C** USE ACCESS PROG.TO READ A/C CODES FILE TO OBTAIN ACCOUNT TYPE    S01194
     CLR                   CALL 'AOACODR0'                                S01194
     CLR                   PARM '*MSG   ' @RTCD                           S01194
     CLR                   PARM '*KEY   ' @OPTN                           S01194
     C***LR*****              PARM BNFRPL    @AFNB   4                                 S01194 CGL029
     C***LR*****    @ACOD     PARM @ACOD     DSFDY                                     S01194 CGL029
     CLR                   PARM BNFRPL    @AFNB  10                                           CGL029
     CLR         @ACOD     PARM @ACOD     DSSDY                                               CGL029
     CLR         @RTCD     IFNE *BLANK                                    S01194
     CLR                   MOVEL'SDACODPD'DBFILE                          S01194
     CLR                   MOVEL'06'      DBASE            ************   S01194
     CLR                   MOVEL@OPTN     DBOPTN           * DBERR 06 *   S01194
     CLR                   MOVELBNFRPL    DBKEY            ************   S01194
     CLR                   GOTO LRERR                                     S01194
     CLR                   END                                            S01194
      *                                                                                       CAS005
     CLR         CAS005    IFEQ 'N'                                                           CAS005
     CLR         TBR,A     COMP 0                    26
     CLR                   ELSE                                                               CAS005
     CLR         TBP,A     COMP 0                    26                                       CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0410C058
0525 C*
0526 C*    POST POSITIVE AMOUNTS
     CLR 15                Z-SUBLDBL      LDBL
      *                                                                                       CAS005
     CLR         CAS005    IFEQ 'N'                                                           CAS005
     CLRN26                Z-SUBTBR,A     TBR,A
     CLR                   ELSE                                                               CAS005
     CLRN26                Z-SUBTBP,A     TBP,A                                               CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0410C050
0529 C*
0530 C***********    MAINTAIN TOTAL OF REVALUATION BALANCE                S01117
     C**********LR         RBR       ADD  LDBL      RBR    150            S01117
     C**********LR         RBG       ADD  TBR,A     RBG    150            S01117
0533 C*
     C*****POST*ONLY NON ZERO BALANCES                             S01117 LN0188
0546 C*                                                                   S01117
     C*******    LDBL      IFNE *ZEROS                             S01117 LN0188
0530 C*****MAINTAIN*TOTAL*OF*REVALUATION*BALANCE                   S01117 LN0188
     C*******    RBR       ADD  LDBL      RBR    150                      LN0188
0533 C**                                                                  S01117
     C/SPACE 3                                                            LN0188
     C/COPY WNCPYSRC,DL0410C051
0534 C*    WRITE GENERATED ENTRY,
     C*    BUT NOT ZERO BALANCES.                                         S01107
     C*                                                                   LN0188
      *    REVERSE EXISTING BALANCE (LDBL)                                LN0188
     C*                                                                   LN0188
     CLR         LDBL      IFNE 0                          *LDBL ZERO?    S01107
     CLR         CAS005    ANDEQ'N'                                                           CAS005
     C/COPY WNCPYSRC,DL0410C059
      *                                                                   S01522
      **  Determine Posting Narratives:                                   S01522
     CLR                   MOVE ACCKY     ##ACID                          S01522
     CLR                   MOVE BNFRPL    ##ACOD                          S01522
     CLR                   MOVE 'GB00470' ##MGID                          S01522
     CLR                   EXSR SRPNAR                                    S01522
      *                                                                   S01522
0535 CLR                   SETON                     41
0536 CLR                   EXSR EXCEPT
     CLR         TOTNUM    ADD  1         TOTNUM  50       UPDATE COUNT   S01107
     CLR         NRBR      ADD  1         NRBR                            LN0188
     CLR         RBR       ADD  LDBL      RBR    150                      LN0188
0540 C*    KEEP HASH TOTAL OF POSTING AMOUNTS.                            LN0188
0541 CLR                   Z-ADD2         S                               LN0188
0542 CLR         LDBL      DIV  1000      ZZAMT                           LN0188
0543 CLR                   EXSR HASH                                      LN0188
     CLR                   END                             *              S01107
     C/SPACE 3                                                            LN0188
     C*                                                                   LN0188
      *    POST NEW BALANCE (TBR)                                         LN0188
     C*                                                                   LN0188
     CLR         TBR,A     IFNE 0                          *TBR,A ZERO?   S01107
     CLR         CAS005    ANDEQ'N'                                                           CAS005
     CLR         TBP,A     ORNE 0                                                             CAS005
     CLR         CAS005    ANDEQ'Y'                                                           CAS005
0537 C**********LR                   SETON                     42         S01117
0538 C**********LR                   EXSR EXCEPT                          S01117
     C/COPY WNCPYSRC,DL0410C031
      *                                                                   S01522
      **  Determine Posting Narratives:                                   S01522
     CLR                   MOVE ACCKY     ##ACID                          S01522
     CLR                   MOVE BNFRPL    ##ACOD                          S01522
     CLR                   MOVE 'GB00480' ##MGID                          S01522
     CLR                   EXSR SRPNAR                                    S01522
      *                                                                   S01522
0537 CLR                   SETON                     42                   LN0188
0538 CLR                   EXSR EXCEPT                                    LN0188
     CLR         TOTNUM    ADD  1         TOTNUM           UPDATE COUNT   S01107
     CLR         NRBG      ADD  1         NRBG                            LN0188
      *                                                                                       CAS005
     CLR         CAS005    IFEQ 'N'                                                           CAS005
     CLR         RBG       ADD  TBR,A     RBG    150                      LN0188
     CLR                   ELSE                                                               CAS005
     CLR         RBG       ADD  TBP,A     RBG                                                 CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0410C027
0540 C*    KEEP HASH TOTAL OF POSTING AMOUNTS.                            LN0188
0541 CLR                   Z-ADD2         S                               LN0188
      *                                                                                       CAS005
     CLR         CAS005    IFEQ 'N'                                                           CAS005
     CLR         TBR,A     DIV  500       ZZAMT                           LN0188
     CLR                   ELSE                                                               CAS005
     CLR         TBP,A     DIV  500       ZZAMT                                               CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
0545 CLR                   EXSR HASH                                      LN0188
     C/COPY WNCPYSRC,DL0410C068
     CLR                   END                             *              S01107
     C*R*******  TOTNUM ** ADD  2  ****** TOTNUM  50 *******              S01107
0539 C*
0540 C*****KEEP*HASH*TOTAL OF POSTING AMOUNTS.                            LN0188
0541 C*****                Z-ADD2         S                               LN0188
0542 C*****      LDBL      DIV  1000      ZZAMT                           LN0188
0543 C*****                EXSR HASH                                      LN0188
     C**********LR         TBR,A     DIV  500       ZZAMT                 LN0188
     C*****      TBR,A     DIV  500       ZZAMT                           LN0188
     C*****      NRBR      ADD  2         NRBR                            LN0188
0545 C*****                EXSR HASH                                      LN0188
0545 C*****                END                                            LN0188
     C*                                                                   S01117
     C*****POST*ONLY*NON*ZERO BALANCES                             S01117 LN0188
     C******     TBR,A     IFNE *ZEROS                             S01117 LN0188
0530 C*****MAINTAIN TOTAL OF REVALUATION BALANCE                   S01117 LN0188
     C*****      RBG       ADD  TBR,A     RBG    150               S01117 LN0188
0533 C**                                                           S01117 LN0188
0534 C*****WRITE GENERATED ENTRY.                                  S01117 LN0188
0537 C*****                SETON                     42            S01117 LN0188
0538 C*****                EXSR EXCEPT                             S01117 LN0188
     C*****      TOTNUM    ADD  2         TOTNUM                   S01117 LN0188
0539 C*****                                                        S01117 LN0188
0540 C*****KEEP HASH TOTAL OF POSTING AMOUNTS.                     S01117 LN0188
0541 C*****                Z-ADD2         S                        S01117 LN0188
     C*****      TBR,A     DIV  500       ZZAMT                    S01117 LN0188
0545 C*****                EXSR HASH                               S01117 LN0188
     C*****      NRBG      ADD  2         NRBG                     S01117 LN0188
0543 C*****                END                                     S01117 LN0188
0546 C*
     C/SPACE 3                                                            LN0188
     C*******                                                             LN0188
     C/COPY WNCPYSRC,DL0410C032
      *    DO FWD REVAL P/L CONTRA ACCOUNT                                LN0188
     C*******                                                             LN0188
0547 C*****ACCESS FWD REVAL CONTRA A/C
0548 C**   SET UP ACCOUNT KEY FOR FWD REVAL CONTRA A/C
0549 C**********LR                   MOVELFRPC      WK6            S01194 S01117
0549 C**********LR                   MOVELBNAFNB    WK6            S01194 S01117
0549 C***LR*****              MOVELBNACCD    WK9A                                    S01117 BUG5336R
0550 C**********LR                   MOVE WK6       ACCKEY                S01117
0550 C***LR*****              MOVE WK9A      ACCKEY                                  S01117 BUG5336R
     CLR                   MOVELBNACCD    WK15                                              BUG5336R
     CLR                   MOVE WK15      ACCKEY                                            BUG5336R
     CLR                   MOVELACCKEY    ACCKY                           S01117
     C/COPY WNCPYSRC,DLH00386
0551 C*
0552 C*****OBTAIN A/C TYPE FROM A/C CODES TABLE******************         S01194
0553 C**********LR                   MOVELFRPC      WK5                   S01194
0554 C**********LR                   MOVE WK5       TABKEY                S01194
0555 C**********LR                   EXSR TABCHN                          S01194
0556 C**********LRN09                GOTO LRERR                           S01194
     C** USE ACCESS PROG.TO READ A/C CODES FILE TO OBTAIN ACCOUNT TYPE    S01194
     CLR                   CALL 'AOACODR0'                                S01194
     CLR                   PARM '*MSG   ' @RTCD                           S01194
     CLR                   PARM '*KEY   ' @OPTN                           S01194
     CLR                   PARM BNACCD    @AFNB                           S01194
     C***LR*****    @ACOD     PARM @ACOD     DSFDY                                     S01194 CGL029
     CLR         @ACOD     PARM @ACOD     DSSDY                                               CGL029
     CLR         @RTCD     IFNE *BLANK                                    S01194
     CLR                   MOVEL'SDACODPD'DBFILE                          S01194
     CLR                   MOVEL'07'      DBASE            ************   S01194
     CLR                   MOVEL@OPTN     DBOPTN           * DBERR 07 *   S01194
     CLR                   MOVELBNACCD    DBKEY            ************   S01194
     CLR                   GOTO LRERR                                     S01194
     CLR                   END                                            S01194
     C/COPY WNCPYSRC,DL0410C052
0557 C*
0558 C*****POST POSITIVE AMOUNT
0559 C*
     C*******                                                             LN0188
     C*******                                                             LN0188
0530 C*****MAINTAIN*TOTAL*OF*REVALUATION*BALANCE                          LN0188
0561 C*******    RBR       ADD  LDBL      RBR                             LN0188
     C*******    RBG       ADD  TBR,A     RBG                             LN0188
0563 C*
     C/SPACE 3                                                            LN0188
0564 C*    WRITE GENERATED ENTRIES
     C*    BUT NOT ZERO BALANCES.                                         S01107
     C*                                                                   LN0188
     C/COPY WNCPYSRC,DL0410C053
      *    REVERSE EXISTING BALANCE (LDBL)                                LN0188
     C*                                                                   LN0188
     CLR         LDBL      IFNE 0                          *LDBL ZERO?    S01107
     CLR         CAS005    ANDEQ'N'                                                           CAS005
     C/COPY WNCPYSRC,DL0410C060
      *                                                                   S01522
      **  Determine Posting Narratives:                                   S01522
     CLR                   MOVE ACCKY     ##ACID                          S01522
     CLR                   MOVE 'GB00690' ##MGID                          S01522
     CLR                   EXSR SRPNAR                                    S01522
      *                                                                   S01522
0565 CLR                   SETON                     43
0566 CLR                   EXSR EXCEPT
     CLR         TOTNUM    ADD  1         TOTNUM           UPDATE COUNT   S01107
     CLR         NRBR      ADD  1         NRBR                            LN0188
0561 CLR         RBR       ADD  LDBL      RBR                             LN0188
0570 C*    KEEP HASH TOTAL OF POSTING AMOUNT.                             LN0188
     CLR                   Z-ADD2         S                               LN0188
0571 CLR         LDBL      DIV  1000      ZZAMT                           LN0188
0572 CLR                   EXSR HASH                                      LN0188
     CLR                   END                             *              S01107
     C/SPACE 3                                                            LN0188
     C*                                                                   LN0188
      *    POST NEW BALANCE (TBR)                                         LN0188
     C*                                                                   LN0188
     CLR         TBR,A     IFNE 0                          *TBR,A ZERO?   S01107
     CLR         CAS005    ANDEQ'N'                                                           CAS005
     CLR         TBP,A     ORNE 0                                                             CAS005
     CLR         CAS005    ANDEQ'Y'                                                           CAS005
      *                                                                   S01522
      **  Determine Posting Narratives:                                   S01522
     CLR                   MOVE ACCKY     ##ACID                          S01522
     CLR                   MOVE 'GB00700' ##MGID                          S01522
     CLR                   EXSR SRPNAR                                    S01522
      *                                                                   S01522
0567 CLR                   SETON                     44
0568 CLR                   EXSR EXCEPT
     CLR         TOTNUM    ADD  1         TOTNUM           UPDATE COUNT   S01107
     CLR         NRBG      ADD  1         NRBG                            LN0188
      *                                                                                       CAS005
     CLR         CAS005    IFEQ 'N'                                                           CAS005
     CLR         RBG       ADD  TBR,A     RBG                             LN0188
     CLR                   ELSE                                                               CAS005
     CLR         RBG       ADD  TBP,A     RBG                                                 CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0410C028
     CLR                   END                             *              S01107
     C*R*******  TOTNUM ** ADD  2  ****** TOTNUM     *******              S01107
0569 C*
0570 C*****KEEP*HASH*TOTAL OF POSTING AMOUNT.                             LN0188
     C*******              Z-ADD2         S                        S01117 LN0188
0571 C*******    LDBL      DIV  1000      ZZAMT                           LN0188
0572 C*******              EXSR HASH                                      LN0188
     C*******    NRBR      ADD  2         NRBR                            LN0188
     C*******    NRBG      ADD  2         NRBG                            LN0188
      *                                                                                       CAS005
      ** Do Forward Revaluation Loss Account Code Posting                                     CAS005
      *                                                                                       CAS005
     CLR         CAS005    IFEQ 'Y'                                                           CAS005
     CLR                   MOVE *ON       *IN08                                               CAS005
     CLR                   MOVELBICA,A    WK9                                                 CAS005
     CLR                   MOVE BJCYCD    WK9                                                 CAS005
     C***LR*****              MOVE '01'      WK6                                     CAS005 BUG5336R
     CLR                   MOVE '01'      WK12                                       CAS005 BUG5336R
     CLR                   MOVELWK9       ACCKEY                                              CAS005
     C***LR*****              MOVELBNLCAC    WK6                                     CAS005 BUG5336R
     C***LR*****              MOVELWK6       WK9A                                    CAS005 BUG5336R
     CLR                   MOVELBNLCAC    WK12                                              BUG5336R
     CLR                   MOVELWK12      WK15                                              BUG5336R
     C***LR*****              MOVE BRAR,A    WK9A                                    CAS005 BUG5336R
     C***LR*****              MOVE WK9A      ACCKEY                                  CAS005 BUG5336R
     CLR                   MOVE BRAR,A    WK15                                              BUG5336R
     CLR                   MOVE WK15      ACCKEY                                            BUG5336R
     CLR                   MOVELACCKEY    ACCKY                                               CAS005
     CLR                   EXSR ACCHN                                                         CAS005
      *                                                                                       CAS005
      ** Use access pgm to read A/C Codes file to obtain account type                         CAS005
      *                                                                                       CAS005
     CLR                   CALL 'AOACODR0'                                                    CAS005
     CLR                   PARM '*MSG   ' PRTCD                                               CAS005
     CLR                   PARM '*KEY   ' POPTN                                               CAS005
     C***LR*****              PARM BNFRLA    PAFNB   4                                 CAS005 CGL029
     C***LR*****    @ACOD     PARM @ACOD     DSFDY                                     CAS005 CGL029
     CLR                   PARM BNFRLA    PAFNB  10                                           CGL029
     CLR         @ACOD     PARM @ACOD     DSSDY                                               CGL029
      *                                                                                       CAS005
     CLR         PRTCD     IFNE *BLANKS                                                       CAS005
     CLR                   MOVEL'SDACODPD'DBFILE                                              CAS005
     CLR                   MOVEL'18'      DBASE                                               CAS005
     CLR                   MOVELPOPTN     DBOPTN                                              CAS005
     CLR                   MOVELBNFRLA    DBKEY                                               CAS005
     CLR                   GOTO LRERR                                                         CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Post positive amounts                                                                CAS005
      *                                                                                       CAS005
     CLR         TBL,A     COMP 0                    26                                       CAS005
     CLR 15                Z-SUBLDBL      LDBL                                                CAS005
     CLRN26                Z-SUBTBL,A     TBL,A                                               CAS005
      *                                                                                       CAS005
      ** Post new balance (TBL)                                                               CAS005
      *                                                                                       CAS005
     CLR         TBL,A     IFNE 0                                                             CAS005
      *                                                                                       CAS005
      ** Determine Posting Narratives                                                         CAS005
      *                                                                                       CAS005
     CLR                   MOVE ACCKY     ##ACID                                              CAS005
     CLR                   MOVE BNFRLA    ##ACOD                                              CAS005
     CLR                   MOVE 'GB00480' ##MGID                                              CAS005
     CLR                   EXSR SRPNAR                                                        CAS005
      *                                                                                       CAS005
     CLR                   MOVE *ON       *IN42                                               CAS005
     CLR                   EXSR EXCEPT                                                        CAS005
     CLR         TOTNUM    ADD  1         TOTNUM                                              CAS005
     CLR         NRBG      ADD  1         NRBG                                                CAS005
     CLR         RBG       ADD  TBL,A     RBG                                                 CAS005
      *                                                                                       CAS005
      ** Keep hash total of posting amounts                                                   CAS005
      *                                                                                       CAS005
     CLR                   Z-ADD2         S                                                   CAS005
     CLR         TBL,A     DIV  500       ZZAMT                                               CAS005
     CLR                   EXSR HASH                                                          CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Do Forward Revaluation Loss Contra Account Code Posting                              CAS005
      *                                                                                       CAS005
     CLR                   MOVE *ON       *IN08                                               CAS005
     C***LR*****              MOVELBNLCAC    WK9A                                    CAS005 BUG5336R
     C***LR*****              MOVE WK9A      ACCKEY                                  CAS005 BUG5336R
     CLR                   MOVELBNLCAC    WK15                                              BUG5336R
     CLR                   MOVE WK15      ACCKEY                                            BUG5336R
     CLR                   MOVELACCKEY    ACCKY                                               CAS005
      *                                                                                       CAS005
      ** Use access pgm to read A/C Codes file to obtain account type                         CAS005
      *                                                                                       CAS005
     CLR                   CALL 'AOACODR0'                                                    CAS005
     CLR                   PARM '*MSG   ' PRTCD                                               CAS005
     CLR                   PARM '*KEY   ' POPTN                                               CAS005
     CLR                   PARM BNLCAC    PAFNB                                               CAS005
     C***LR*****    @ACOD     PARM @ACOD     DSFDY                                     CAS005 CGL029
     CLR         @ACOD     PARM @ACOD     DSSDY                                               CGL029
      *                                                                                       CAS005
     CLR         PRTCD     IFNE *BLANKS                                                       CAS005
     CLR                   MOVEL'SDACODPD'DBFILE                                              CAS005
     CLR                   MOVEL'19'      DBASE                                               CAS005
     CLR                   MOVELPOPTN     DBOPTN                                              CAS005
     CLR                   MOVELBNLCAC    DBKEY                                               CAS005
     CLR                   GOTO LRERR                                                         CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Post new balance (TBL)                                                               CAS005
      *                                                                                       CAS005
     CLR         TBL,A     IFNE 0                                                             CAS005
      *                                                                                       CAS005
      ** Determine Posting Narratives                                                         CAS005
      *                                                                                       CAS005
     CLR                   MOVE ACCKY     ##ACID                                              CAS005
     CLR                   MOVE 'GB00700' ##MGID                                              CAS005
     CLR                   EXSR SRPNAR                                                        CAS005
      *                                                                                       CAS005
     CLR                   MOVE *ON       *IN44                                               CAS005
     CLR                   EXSR EXCEPT                                                        CAS005
     CLR         TOTNUM    ADD  1         TOTNUM                                              CAS005
     CLR         NRBG      ADD  1         NRBG                                                CAS005
     CLR         RBG       ADD  TBL,A     RBG                                                 CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
     CLR                   ENDIF                                                              CAS005
      *                                                                                       CAS005
     C/COPY WNCPYSRC,DL0410C011
     C/SPACE 3                                                            LN0188
     CLR                   MOVE *OFF      *IN08                                               225189
     CLR                   GOTO AGAIN
     C/COPY WNCPYSRC,DL0410C054
     C/SPACE 3                                                            LN0188
     CLR         FINISH    TAG
     C/SPACE 3                                                            LN0188
0575 C*
0576 C*    WRITE GENERATED ENTRIES TRAILER.
     CLR         TOTNUM    ADD  2         TOTNUM
     C/COPY WNCPYSRC,DLH00371
0577 CLR                   SETON                     45
0578 CLR                   EXSR EXCEPT
     C/COPY WNCPYSRC,DL0410C063
0579 C*
0580 C*    COMPARE INPUT AND CALCULATED EVENT AMOUNT TOTALS
     CLR         1         SETLLFPVNTZZF                                  S01178
     CLR                   READ FPVNTZZ                  99               S01178
     C*                                                                   E16086
     C** ENSURE FT EVENTS HASH TOTAL DOES NOT INCLUDE REGULAR             E16086
     C** PAYMENTS, FOR CONSISTENCY WITH EVENTA/LF.                        E16086
     C*                                                                   E16086
     C*RN99******          Z-ADDRHRWN     ZZAMT      INTEGER FIELD  S01178E16086
     C*RN99******          MOVE RHRDC     ZZAMT      DECIMAL FIELD  S01178E16086
     C*                                                                   E16086
     CLRN99                Z-ADDHWNX      ZZAMT            INTEGER FIELD  E16086
     CLRN99                MOVE HDCX      ZZAMT            DECIMAL FIELD  E16086
     C/COPY WNCPYSRC,DL0410C074
     C*                                                                   E16086
     C*R*********          Z-ADDHRWN      ZZTOTI                    S01178E16086
     C*R*********          Z-ADDHRDC      ZZTOTD                    S01178E16086
     CLR                   Z-ADDHRWN      ZZTOTI                          E21634
     CLR                   Z-ADDHRDC      ZZTOTD                          E21634
     C*                                                                   E16086
     C*R*********          Z-ADDHWNX      ZZTOTI                    E16086E21634
     C*R*********          Z-ADDHDCX      ZZTOTD                    E16086E21634
     CLRN99                EXSR GLZADD                                    S01178
     C/COPY WNCPYSRC,DL0410C055
0581 C*R*********INT,1     COMP HRWN                 U8U8                 S01178
0582 C*RNU8******DEC,1     COMP HRDC                 U8U8                 S01178
0581 CLR         INT,1     COMP ZZTOTI               U8U8                 S01178
0582 CLRNU8      DEC,1     COMP ZZTOTD               U8U8                 S01178
     C/COPY WNCPYSRC,DLH00372
     C*                                                                   E21634
     CLR U8                DUMP                                           E21634
     C*                                                                   E21634
0583 CLR                   GOTO FIN
0584 C*
0585 C*    SET ERROR INDICATORS
0586 CLR         LRERR     TAG                             ** LRERR TAG **
0587 CLR                   SETON                     U7U8
     CLR                   EXSR *PSSR                                     S01194
0588 C*
0589 CLR         FIN       TAG                             ** FIN TAG **
     C*                                                                   S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM *BLANK    ZSERR   1                       S01117
     C*                                                                   S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   E296
     C** READ BANK DETAILS FILE (WHEN EMPTY FILES )                       E296
     CLRN80                CALL 'AOBANKR0'                                E296
     C                     PARM '*MSG   ' @RTCD   7                       E296
     C                     PARM '*FIRST ' @OPTN   7                       E296
     C           @BANK     PARM @BANK     DSFDY                           E296
     CLRN80      @RTCD     IFNE *BLANK                                    E296
     CLRN80                MOVEL'SDBANKPD'DBFILE 10        ************   E296
     CLRN80                MOVEL'08'      DBASE   2        * DBERR 08 *   E296
     CLRN80                MOVEL@OPTN     DBOPTN  7        ************   E296
     CLR                   END                                            E296
      *                                                                                       CAS001
     CLR         CAS001    IFEQ 'Y'                                                           CAS001
      *                                                                                       CAS001
     CLR         WP3CHK    IFEQ 'Y'                                                           219333
     CLR         WP4CHK    OREQ 'Y'                                                           219333
     CLR         WP5CHK    OREQ 'Y'                                                           219333
     CLR         BRNCH     IFEQ 'ALL'                                                         CAS001
     CLR                   EXSR SRPRT1                                                        CAS001
     CLR                   ENDIF                                                              CAS001
     CLR                   ENDIF                                                              219333
      *                                                                                       CAS001
     CLR                   SELEC                                                              CAS001
      *                                                                                       CAS001
     CLR         BNNPVM    WHEQ 'F'                                                           CAS001
     CLR         WP3CHK    IFEQ 'Y'                                                           CAS001
     CLR                   CLOSEDL0410P3                                                      CAS001
     CLR                   ENDIF                                                              CAS001
      *                                                                                       CAS001
     CLR         BNNPVM    WHEQ 'B'                                                           CAS001
     CLR         WP4CHK    IFEQ 'Y'                                                           CAS001
     CLR                   CLOSEDL0410P4                                                      CAS001
     CLR                   ENDIF                                                              CAS001
      *                                                                                       CAS001
     CLR         BNNPVM    WHEQ 'D'                                                           CAS001
     CLR         WP5CHK    IFEQ 'Y'                                                           CAS001
     CLR                   CLOSEDL0410P5                                                      CAS001
     CLR                   ENDIF                                                              CAS001
      *                                                                                       CAS001
     CLR                   ENDSL                                                              CAS001
      *                                                                                       CAS001
     CLR                   ENDIF                                                              CAS001
      *                                                                                       CAS001
     C/COPY WNCPYSRC,DL0410C006
0391 C*                                                                   E296
     C*****************************************************************   S01303
     C*    SR. TO CHECK VALUE FOR OUTPUT '+' OR '-' SIGN                  S01303
     C           CHECK     BEGSR                           ** CHECK ***   S01303
     C*                                                                   S01303
     C           MEAMT     COMP 0                    6465                 S01303
     C           MDBCE     COMP 0                    6667                 S01303
     C           MREVA     COMP 0                    6869                 S01303
     C           MPLAM     COMP 0                    5758                 S01303
     C           YEAMT     COMP 0                    5977                 S01303
     C           YDBCE     COMP 0                    7838                 S01303
     C           YREVA     COMP 0                    8439                 S01303
     C           YPLAM     COMP 0                    8687                 S01303
     C/COPY WNCPYSRC,DL0410C012
     C*                                                                   S01303
     C                     ENDSR                           END CHECK **   S01303
     C*                                                                   S01303
0590 C********************************************************************S1107
0591 C*    SR. TO CONVERT EVENT AMOUNT TO BASE CURRENCY USING THE         S1107
     C*    'START DATE' AS THE EVENT DATE                                 S1107
0592 C           CONVTA    BEGSR                           *** CONVTA *** S1107
     C/COPY WNCPYSRC,DL0410C061
     C*                                                                   S1107
     C*    IS THE START DATE LESS THAN THE RUN DATE?                      S1107
     C*                                                                   S1107
     C           OTHD      COMP DAT,1                  54                 S1107
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCP6                                           S01408
     C*                                                                   S01408
     C***54******          Z-ADDRAT,1     RATES  128                S1107 138010
     C   54                Z-ADDRAT,1     RATES  138                      138010
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCP7                                           S01408
     C*                                                                   S01408
     C   54                GOTO CREVAS                                    S1107
0593 C*                                                                   S1107
0594 C*    COMPARE START DATE WITH DATES IN ARRAY.                        S1107
0595 C                     Z-ADD1         N       20                      S1107
0596 C           OTHD      LOKUPDAT,N                35                   S1107
0597 C  N35                GOTO CASEB                                     S1107
0598 C*                                                                   S1107
0599 C*    CHECK IF N-1 TH DATE MATCHES START DATE                        S1107
0600 C           N         SUB  1         M       20                      S1197
0601 C           OTHD      COMP DAT,M                    36               S1107
0602 C   36                GOTO CASEA                                     S1107
0603 C*                                                                   S1107
0604 C*    THIRD  CASE - START DATE IS BETWEEN TWO DATES IN               S1107
0605 C*    THE ARRAY.                                                     S1107
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCP8                                           S01408
     C*                                                                   S01408
0606 C********** RAT,N     SUB  RAT,M     WKR1   128                S1107 138010
0606 C           RAT,N     SUB  RAT,M     WKR1   138                      138010
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCP9                                           S01408
     C*                                                                   S01408
0607 C           OTHD      SUB  DAT,M     WKD1    50                      S1107
0608 C           DAT,N     SUB  DAT,M     WKD2    50                      S1107
0609 C           WKR1      MULT WKD1      RATES                           S1107
0610 C           RATES     DIV  WKD2      RATES                           S1107
0611 C           RATES     ADD  RAT,M     RATES                           S1107
0612 C                     GOTO CREVAS                                    S1107
0613 C*                                                                   S1107
0614 C*    FIRST CASE - START DATE MATCHES A DATE IN THE ARRAY            S1107
0615 C           CASEA     TAG                             ** CASEA TAG **S1107
0616 C                     Z-ADDRAT,M     RATES                           S1107
0617 C                     GOTO CREVAS                                    S1107
0618 C*                                                                   S1107
0619 C*    SECOND CASE - START DATE IS AFTER LAST DATE IN                 S1107
0620 C*    THE ARRAY                                                      S1107
0621 C           CASEB     TAG                             ** CASEB TAG **S1107
0622 C                     Z-ADDRAT,LAST  RATES                           S1107
0623 C*                                                                   S1107
0624 C*    CALCULATE REVALUED AMOUNT.                                     S1107
0625 C*                                                                   S1107
0626 C           CREVAS    TAG                                            S1107
0627 C*                                                                   S1107
0628 C**********           CDP       SUB  BCCDP     K       10     S01194 S1107
0628 C           A6NBDP    SUB  BCCDP     K       10               S01194 S1107
0629 C           K         ADD  4         K                               S1107
     C**                                                                  S01194
     C** INDICATOR 32 NO LONGER ATTACHED TO THE MULTIPLY/DIVIDE FLAG      S01194
     C** AS CURRENCIES FILE IS NOW EXTERNALLY DESCRIBED                   S01194
0630 C***32******RATES     MULT POWER,K   WK159  159               S1107  S01194
0631 C***32******EAMT      DIV  WK159     REVAS  130H              E10953 S01194
0631 C***32******EAMT      DIV  WK159     REVAS  150H        E10953E12711 S01194
0631 C***32******EAMT      DIV  WK159     REVAS  130H              E12711 S01194
     C***********A6MDIN    IFEQ 'D'                                 S01194E21556
0630 C***********RATES     MULT POWER,K   WK159  159                S01194E21556
0631 C***********EAMT      DIV  WK159     REVAS  130H               S01194E21556
     C******************** END                                      S01194E21556
0632 C**N32******RATES     DIV  POWER,K   WK159                           S01194
0633 C**N32******EAMT      MULT WK159     REVAS     H                     S01194
     C***********A6MDIN    IFEQ 'M'                                 S01194E21556
0632 C***********RATES     DIV  POWER,K   WK159                     S01194E21556
0633 C***********EAMT      MULT WK159     REVAS     H               S01194E21556
     C******************** END                                      S01194E21556
0634 C*                                                                   S1107
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CP10                                           S01408
     C*                                                                   S01408
     C**********           Z-ADDRATES     WKRATE 128               E21556 138010
     C                     Z-ADDRATES     WKRATE 138                      138010
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CP11                                           S01408
     C*                                                                   S01408
     C                     EXSR CLREVA                                    E21556
     C                     Z-ADDWKREVA    REVAS  130                      E21556
0470 C*    CONVERT OTHER DATE TO DDMMMYY FORMAT.                          S1107
0471 C                     Z-ADDOTHD      ZDAYNO                          S1107
0472 C                     EXSR ZDATE2                                    S1107
0473 C                     MOVE ZADATE    ODATA   7                       S1107
0635 C                     ENDSR                                          S1107
0636 C*                                                                   S1107
0590 C********************************************************************
0591 C*    SR. TO CONVERT EVENT AMOUNT TO BASE CURRENCY.
0592 C           CONVT     BEGSR                           *** CONVT ***
     C/COPY WNCPYSRC,DL0410C062
0593 C*
0594 C*    COMPARE EVENT DATE WITH DATES IN ARRAY.
0595 C                     Z-ADD1         N       20
0596 C           EDAT      LOKUPDAT,N                35
0597 C  N35                GOTO CASE2
0598 C*
0599 C*    CHECK IF N-1 TH DATE MATCHES EVENT DATE
0600 C           N         SUB  1         M       20
0601 C           EDAT      COMP DAT,M                    36
0602 C   36                GOTO CASE1
0603 C*
0604 C*    THIRD  CASE - EVENT DATE IS BETWEEN TO DATES IN
0605 C*    THE ARRAY.
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CP12                                           S01408
     C*                                                                   S01408
0606 C********** RAT,N     SUB  RAT,M     WKR1   128                      138010
0606 C           RAT,N     SUB  RAT,M     WKR1   138                      138010
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CP13                                           S01408
     C*                                                                   S01408
0607 C           EDAT      SUB  DAT,M     WKD1    50
0608 C           DAT,N     SUB  DAT,M     WKD2    50
0609 C***********WKR1      MULT WKD1      RATE   128                      E47226
0610 C***********RATE      DIV  WKD2      RATE                            E47226
0609 C           WKR1      MULT WKD1      WRK15  158                      E47226
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CP14                                           S01408
     C*                                                                   S01408
0610 C********** WRK15     DIV  WKD2      RATE   128               E47226 138010
     C           WRK15     DIV  WKD2      RATE   138                      138010
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CP15                                           S01408
     C*                                                                   S01408
0611 C           RATE      ADD  RAT,M     RATE
0612 C                     GOTO CREVA
0613 C*
0614 C*    FIRST CASE - EVENT DATE MATCHES A DATE IN THE ARRAY
0615 C           CASE1     TAG                             ** CASE1 TAG **
0616 C                     Z-ADDRAT,M     RATE
0617 C                     GOTO CREVA
0618 C*
0619 C*    SECOND CASE - EVENT DATE IS AFTER LAST DATE IN
0620 C*    THE ARRAY
0621 C           CASE2     TAG                             ** CASE2 TAG **
0622 C                     Z-ADDRAT,LAST  RATE
0623 C*
0624 C*    CALCULATE REVALUED AMOUNT.
0625 C*
0626 C           CREVA     TAG
0627 C*
0617 C***********          SETOF                         34         E10953E12711
0628 C**********           CDP       SUB  BCCDP     K       10            S01194
0628 C           A6NBDP    SUB  BCCDP     K       10                      S01194
0629 C           K         ADD  4         K
     C**                                                                  S01194
     C** INDICATOR 32 NO LONGER ATTACHED TO THE MULTIPLY/DIVIDE FLAG      S01194
     C** AS CURRENCIES FILE IS NOW EXTERNALLY DESCRIBED                   S01194
0630 C***32******RATE      MULT POWER,K   WK159  159                      E10953
0630 C***32******RATE      MULT POWER,K   WK159  159     34         E10953E12711
0630 C***32******RATE      MULT POWER,K   WK159  159               E12711 S01194
0631 C***34******          Z-ADD1         WK159                     E10953E12711
0631 C***32******EAMT      DIV  WK159     REVA   130H                     E10953
0631 C***32******EAMT      DIV  WK159     REVA   150H               E10953E12711
0631 C***32******EAMT      DIV  WK159     REVA   130H              E12711 S01194
     C***********A6MDIN    IFEQ 'D'                                 S01194E21556
0630 C***********RATE      MULT POWER,K   WK159  159                S01194E21556
0631 C***********EAMT      DIV  WK159     REVA   130H               S01194E21556
     C******************** END                                      S01194E21556
0632 C**N32******RATE      DIV  POWER,K   WK159                     S01194E21556
0633 C**N32******EAMT      MULT WK159     REVA      H               S01194E21556
     C***********A6MDIN    IFEQ 'M'                                 S01194E21556
0632 C***********RATE      DIV  POWER,K   WK159                     S01194E21556
0633 C***********EAMT      MULT WK159     REVA      H               S01194E21556
     C*******************  END                                      S01194E21556
0634 C*
     C                     Z-ADDRATE      WKRATE                          E21556
     C                     EXSR CLREVA                                    E21556
     C                     Z-ADDWKREVA    REVA   130                      E21556
0634 C*
0635 C                     ENDSR
0636 C*
0590 C********************************************************************E21556
0591 C*    SR. TO CALCULATE REVALUED EQUIVALENT FOR REPORT                E21556
0637 C********************************************************************
0640 C           CLREVA    BEGSR                                       *  E21556
     C*                                                                   E21556
     C           A6MDIN    IFEQ 'D'                                       E21556
     C*                                                                   E21556
     C           K         IFNE 1                                         E21556
     C           K         ANDNE2                                         E21556
     C           WKRATE    MULT POWER,K   WK159  159                      E21556
     C           EAMT      DIV  WK159     WKREVA 130H                     E21556
     C                     END                                            E21556
     C           K         IFEQ 1                                         E21556
     C***********WKRATE    MULT 100       RATE1  126               E21556 138010
     C***********RATE1     MULT POWER,K   WK129  129               E21556 138010
     C           WKRATE    MULT 100       RATE1  136                      138010
     C           RATE1     MULT POWER,K   WK129  159                      138010
     C***********EAMT      DIV  WK129     WKREVA    H              E21556 DT0154
     C***********WKREVA    DIV  100       WKREVA                   E21556 DT0154
     C           EAMT      DIV  WK129     WK152  152H                     DT0154
     C***********WK152     MULT 100       WKREVA                   DT0154 054383
     C           WK152     MULT 100       WKREVA    H                     054383
     C                     END                                            E21556
     C*                                                                   E21556
     C           K         IFEQ 2                                         E21556
     C***********WKRATE    MULT 10        RATE2  127               E21556 138010
     C           WKRATE    MULT 10        RATE2  137                      138010
     C           RATE2     MULT POWER,K   WK129                           E21556
     C***********EAMT      DIV  WK129     WKREVA    H              E21556 DT0154
     C***********WKREVA    DIV  10        WKREVA                   E21556 DT0154
     C           EAMT      DIV  WK129     WK151  151H                     DT0154
     C***********WK151     MULT 10        WKREVA                   DT0154 054383
     C           WK151     MULT 10        WKREVA    H                     054383
     C                     END                                            E21556
     C*                                                                   E21556
     C                     ELSE                                           E21556
     C*                                                                   E21556
     C           K         IFNE 6                                         E21556
     C           K         ANDNE7                                         E21556
     C           WKRATE    DIV  POWER,K   WK159                           E21556
     C           EAMT      MULT WK159     WKREVA    H                     E21556
     C                     END                                            E21556
     C           K         IFEQ 7                                         E21556
     C           WKRATE    MULT 100       RATE1                           E21556
     C           RATE1     DIV  POWER,K   WK129                           E21556
     C*                                                                   054383
     C** Use half-adjust instead of truncate, to ensure calculated        054383
     C** amount is correct to the nearest unit.                           054383
     C*                                                                   054383
     C           EAMT      MULT WK129     WKREVA    H                     E21556
     C***********WKREVA    DIV  100       WKREVA                   E21556 054383
     C           WKREVA    DIV  100       WKREVA    H                     054383
     C                     END                                            E21556
     C*                                                                   E21556
     C           K         IFEQ 6                                         E21556
     C           WKRATE    MULT 10        RATE2                           E21556
     C           RATE2     DIV  POWER,K   WK129                           E21556
     C*                                                                   054383
     C** Use half-adjust instead of truncate, to ensure calculated        054383
     C** amount is correct to the nearest unit.                           054383
     C*                                                                   054383
     C           EAMT      MULT WK129     WKREVA    H                     E21556
     C***********WKREVA    DIV  10        WKREVA                   E21556 054383
     C           WKREVA    DIV  10        WKREVA    H                     054383
     C                     END                                            E21556
0636 C*                                                                   E21556
     C                     END                                            E21556
0636 C*                                                                   E21556
0654 C                     ENDSR                                          E21556
     C/COPY WNCPYSRC,DL0410C019
0655 C*                                                                   E21556
0637 C********************************************************************
0638 C*    SR. TO IDENTIFY EVENTS TO BE INCLUDED IN THE
0639 C*    FORWARD REVALUATION.
0640 C           INCLU     BEGSR                           *** INCLU ***
0641 C*
0642 C           ETYP      LOKUPTABE1                    21
     C/COPY WNCPYSRC,DL0410C041
      *                                                                                      BUG9453
      ** Include principal amounts for RX deals only when                                    BUG9453
      ** CIR003 and CAS008 are ON.                                                           BUG9453
      *                                                                                      BUG9453
     C           ETYP      IFEQ '23C3'                                                       BUG9453
     C           ETYP      OREQ '23S3'                                                       BUG9453
     C           ETYP      OREQ '23C4'                                                       BUG9453
     C           ETYP      OREQ '23S4'                                                       BUG9453
      *                                                                                      BUG9453
     C           CIR003    IFNE 'Y'                                                          BUG9453
     C           CAS008    ORNE 'Y'                                                          BUG9453
     C                     MOVE *OFF      *IN21                                              BUG9453
     C                     ENDIF                                                             BUG9453
      *                                                                                      BUG9453
     C                     ENDIF                                                             BUG9453
      *                                                                                      BUG9453
0643 C*
0644 C*    SECOND GROUP OF EVENTS IS CHECKED ONLY IF FWD.REV.
0645 C*    OF INTEREST IND. IS ON
0646 C   20N21   ETYP      LOKUPTABE2                    21
     C/COPY WNCPYSRC,DL0410C081
     C*                                                                   S01328
     C* CHECK SUPPRESS REVALUATION INDICATOR TO SEE IF OUTPUT NECESSARY   S01328
     C*                                                                   S01328
     C   20 21   RSUPR     COMP 'Y'                  2121                 S01328
0647 C*
     C**                                                                  BHF589
     C*   DO NOT INCLUDE INTERBRANCH EVENTS.NOTE FIELD ONLY ON EVNTXED    BHF589
     C*   ALSO ON FPVNTDD                                                 106646
     C**                                                                  BHF589
     C   21 02   IBRE      COMP 'Y'                  2121                 BHF589
     C   21 12   IBRE      COMP 'Y'                  2121                 106646
      ***Exclude*if*funds*transfer*single*ccy*payment.*****************                135952 259031
     C**********   21 12   ECCY      COMP OTCY                 2121                    135952 259031
      ** Exclude if funds transfer single ccy payment.                                        135952
     C   21 12   ECCY      COMP OTCY                 2121                                     135952
0648 C**   NOT INCL. IF AMOUNT ZERO
0649 C   21      EAMT      COMP 0                    2121
0650 C**********   21      EDAT      COMP RUND                 21  21     S01194
0650 C   21      EDAT      COMP BJRDNB               21  21               S01194
     C/COPY WNCPYSRC,DL0410C018
0651 *******OT INCL. IF EVENT FOR BASE CCY.
0652 C**   INCL. IF EVENT FOR BASE CCY.
0653 C**********   21      ECCY      COMP BCCY                     47     S01194
0653 C   21      ECCY      COMP BJCYCD                   47               S01194
      *                                                                   S01440
      ** If Interest on Outright Accruals Indicator is on, and            S01440
      ** deal type is PI or SI, set include flag off.                     S01440
      *                                                                   S01440
     C           BNAOIO    IFEQ 'Y'                                       S01440
     C           DTYP      IFEQ 'PI'                                      S01440
     C           DTYP      OREQ 'SI'                                      S01440
     C                     MOVE '0'       *IN21                           S01440
     C                     END                                            S01440
     C                     END                                            S01440
     C*                                                                   S01440
     C** Events of deals which has already been rolled over               040070
     C** should not be included in revaluation                            040070
     C*                                                                   040070
     C           RLVI      IFEQ 'Y'                                       040070
     C           RBDA      ANDNE0                                         040070
     C                     MOVE '0'       *IN21                           040070
     C                     END                                            040070
     C*                                                                   040070
0654 C                     ENDSR
0655 C*
0656 C********************************************************************
0657 C*    SR. TO SET UP DATE ARRAY.
0658 C           SUDA      BEGSR                           *** SUDA ***
0659 C                     Z-ADD0         DAT
0660 C                     Z-ADD0         RAT
     C                     Z-ADD*ZERO     RFW                             S01328
0661 C*
0662 C*    ACCESS FORWARD RATE FILE.
0663 C                     SETOF                     10
0664 C           ECCY      CHAINFWDRT                40
0665 C*
0666 C*    PUT RUN DATE IN FIRST ELEMENT.
     C*    This is a default - will be overwritten with the first forward 129805
     C*    date specified on the currency record, if found.               129805
0667 C**********                     Z-ADDRUND      DAT,1                 S01194
0667 C                     Z-ADDBJRDNB    DAT,1                           S01194
     C/COPY WNCPYSRC,DL0410C007
     C*                                                                   129805
     C**  If no record for this currency, bypass Forward Dates setup.     129805
0668 C  N10                Z-ADD2         N
0669 C  N10                GOTO ESUDA
     C/COPY WNCPYSRC,DL0410C056
0670 C*
     C**  Increment Run Date by No of Spot Days for Currency, taking any  129805
     C**  non-working days for the currency into account - Forward Days   129805
     C**  are calculated from spot date.                                  129805
     C*                                                                   129805
     C           RS        IFEQ 'S'                                                           258435
     C           WUFWR     ANDEQ'Y'                                                        MD036289A
     C                     Z-ADDBJRDNB    ZDAYNO                          129805
     C                     MOVE ECCY      ZCCY                            129805
     C                     MOVE *BLANKS   ZLOC                            129805
     C                     Z-ADDA6SPDY    ZNRDYS                          129805
     C                     EXSR ZFWDTA                                    129805
     C/COPY WNCPYSRC,DL0410C089
     C                     Z-ADDZDYNBR    @BASE   50                      129805
     C                     Z-ADD@BASE     DAT,2                                            MD036289A
     C                     Z-ADD3         N                                                MD036289A
     C                     ELSE                                                               258435
     C                     Z-ADDBJRDNB    @BASE                                               258435
     C                     Z-ADD2         N                                                MD036289A
     C                     END                                                                258435
     C***************************************************************               129805 MD036289A
     C****Increment*Spot*date*by*number*of*Forward*Days**************               129805 MD036289A
     C***************************************************************               129805 MD036289A
     C**********           Z-ADD2         N                                         129805 MD036289A
     C***********          Z-ADD2         Y       20               129805 170442
     C/COPY WNCPYSRC,DL0410C096
     C**********           Z-ADD1         Y       20                                170442 MD036289A
     C**********                                                                    170442 MD036289A
     C**********           Z-ADD@BASE     DAT,N                                        170442 262151
     C**********           ADD  1         N                                            170442 262151
     C/COPY WNCPYSRC,DL0410C097
      **********                                                                  AR720506 MD036289A
     C********** WUFWR     IFEQ 'Y'                                               AR720506 MD036289A
      **********                                                                  AR720506 MD036289A
     C**********           SELEC                                                  AR720506 MD036289A
      **********                                                                  AR720506 MD036289A
     C********** DFW,1     WHEQ 1                                                 AR720506 MD036289A
     C********** DFW,2     ANDEQ2                                                 AR720506 MD036289A
     C**********           Z-ADD2         N                                       AR720506 MD036289A
     C**********           Z-ADD2         Y                                       AR720506 MD036289A
      **********                                                                  AR720506 MD036289A
     C********** DFW,1     WHEQ 1                                                 AR720506 MD036289A
     C********** DFW,2     ANDGT2                                                 AR720506 MD036289A
     C********** DFW,1     OREQ 2                                                 AR720506 MD036289A
     C********** DFW,2     ANDGT2                                                 AR720506 MD036289A
     C**********           Z-ADD2         N                                       AR720506 MD036289A
     C**********           Z-ADD1         Y                                       AR720506 MD036289A
      **********                                                                  AR720506 MD036289A
     C**********           ENDSL                                                  AR720506 MD036289A
      **********                                                                  AR720506 MD036289A
     C**********           ENDIF                                                  AR720506 MD036289A
     C*                                                                   129805
     C*****                Z-ADD1         Y       20                                 MD036289A259866
     C                     Z-ADD2         Y       20                                          259866
     C           N         DOWLE25                                        129805
     C           DFW,Y     ANDNE0                                         129805
     C           WC        IFEQ 'C'                                                           258435
     C           WUFWR     ORNE 'Y'                                                        MD036289A
     C********** @BASE     ADD  DFW,Y     DAT,N                                        129805 262151
     C********** BJRDNB    ADD  DFW,Y     DAT,N                                     262151 MD036289A
     C           @BASE     ADD  DFW,Y     DAT,N                                            MD036289A
     C                     ELSE                                                               258435
     C                     Z-ADD@BASE     ZDAYNO                                              258435
     C                     MOVE ECCY      ZCCY                                                258435
     C                     MOVE *BLANKS   ZLOC                                                258435
     C                     Z-ADDDFW,Y     ZNRDYS                                              258435
     C                     EXSR ZFWDTA                                                        258435
     C                     Z-ADDZDYNBR    DAT,N                                               258435
     C                     END                                                                258435
     C                     ADD  1         N                               129805
     C                     ADD  1         Y                               129805
     C                     ENDDO                                          129805
0157 C*                                                                   129805
0671 C*****LOOP*TO CALCULATE REMAINING DATES.                             129805
0672 C************         Z-ADD1         N                               129805
0672 C************         Z-ADD0         Y       20                E17662129805
     C/COPY WNCPYSRC,DL0410C008
0673 C***********REST      TAG                             ** REST TAG ** 129805
0674 C***********N         ADD  1         N                               129805
0674 C***********Y         ADD  1         Y                         E17662129805
0675 C***********N         COMP 26                   30                   129805
0676 C**N30******DFW,N     COMP 0                        30               E17662
0676 C**N30******DFW,Y     COMP 0                        30         E17662129805
0677 C***30*******         GOTO ESUDA                                     129805
0678 C************         DFW,N     ADD  RUND      DAT,N                 S01194
0678 C***********DFW,N     ADD  BJAKTX    DAT,N                           E17662
0678 C***********DFW,Y     ADD  BJRDNB    DAT,N                     E17662129805
0679 C************         GOTO REST                                      129805
0680 C*
0681 C           ESUDA     TAG                             ** ESUDA TAG **
0682 C           N         SUB  1         LAST    20
0683 C                     ENDSR
     C/COPY WNCPYSRC,DL0410C088
0684 C*
0685 C********************************************************************
0686 C*    SR. TO CALCULATE PROFIT/LOSS.
0687 C           CPRLO     BEGSR                           *** CPRLO ***
0688 C*
     C                     SETOF                     5556                 S1107
     C*                                                                   S1107
0689 C*    CHECK EVENT TYPE
0690 C           ETYP      LOKUPTABE3                    22
0689 C*                                                                   S01119
     C           *IN22     IFEQ '0'                                       S01119
     C           ETYP      IFEQ '21I1'                                    S01119
     C           INOI      ANDEQ'I'                                       S01119
     C           ETYP      OREQ '22I1'                                    S01119
     C           INOI      ANDEQ'I'                                       S01119
     C           ETYP      OREQ '23I1'                                    S01119
     C           INOI      ANDEQ'I'                                       S01119
     C           ETYP      OREQ '24I1'                                    S01119
     C           INOI      ANDEQ'I'                                       S01119
     C           ETYP      OREQ '23C3'                                                        CAS008
     C           INOI      ANDEQ'I'                                                           CAS008
     C           CIR003    ANDEQ'Y'                                                          BUG9453
     C           CAS008    ANDEQ'Y'                                                          BUG9453
     C           ETYP      OREQ '23S3'                                                        CAS008
     C           INOI      ANDEQ'I'                                                           CAS008
     C           CIR003    ANDEQ'Y'                                                          BUG9453
     C           CAS008    ANDEQ'Y'                                                          BUG9453
     C           ETYP      OREQ '23C4'                                                        CAS008
     C           INOI      ANDEQ'I'                                                           CAS008
     C           CIR003    ANDEQ'Y'                                                          BUG9453
     C           CAS008    ANDEQ'Y'                                                          BUG9453
     C           ETYP      OREQ '23S4'                                                        CAS008
     C           INOI      ANDEQ'I'                                                           CAS008
     C           CIR003    ANDEQ'Y'                                                          BUG9453
     C           CAS008    ANDEQ'Y'                                                          BUG9453
     C                     MOVE '1'       *IN,22                          S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*    *IN22 IF ON (1), INDICATES EVENT AMOUNT IS INCOMING.           S01119
     C*    *IN33 IF ON (1), INDICATES EVENT AMOUNT IS NEGATIVE.           S01119
     C*    REPORT REQUIRES '+' TO SHOW INCOMING AND '-' FOR OUTGOING.     S01119
     C*    GIVEN THE ABOVE, EVENT AMOUNT SIGN & EFFECT SHOULD BE -        S01119
     C*    INCOMING POSITIVE, SIGN '+', INCOMING.                         S01119
     C*    INCOMING NEGATIVE, SIGN '-', OUTGOING.                         S01119
     C*    OUTGOING POSITIVE, SIGN '-', OUTGOING.                         S01119
     C*    OUTGOING NEGATIVE, SIGN '+', INCOMING.                         S01119
     C*                                                                   S01119
      * Check for the type of Nostro Transfer payments and initialize the 158840
      * work-field to check NT payments and indicators for it- *in16 & 19 158840
     C                     SETOF                     1619                 158840
     C           *IN12     IFEQ '1'                                                           209177
     C           PYTP      IFEQ 'NT'                                      158840
     C                     MOVE 'Y'       WNTCHK  1                       158840
      *                                                                   158840
     C           INOI      IFEQ 'O'                                       158840
     C                     MOVE '1'       *IN16                           158840
     C                     ELSE                                           158840
     C                     MOVE '1'       *IN19                           158840
     C                     END                                            158840
      *                                                                   158840
     C                     ELSE                                           158840
     C                     MOVE *BLANKS   WNTCHK                          158840
     C                     END                                            158840
     C                     ENDIF                                                              209177
      *                                                                   158840
     C                     MOVE *BLANKS   PYTP                            158840
      *                                                                   158840
     C                     MOVE '+'       EAMSGN  1                       S01119
     C*                                                                   S01119
     C           *IN,22    IFEQ '1'                        INCOMING &     S01119
     C           *IN,33    ANDEQ'1'                        NEGATIVE       S01119
     C*                                                                   S01119
     C           *IN,22    OREQ '0'                        OUTGOING &     S01119
     C           *IN,33    ANDEQ'0'                        POSITIVE       S01119
     C*                                                                   S01119
     C                     MOVE '-'       EAMSGN                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*    CALCULATE PROFIT/LOSS USING POSITIVE VALUES.                   S01119
     C*                                                                   S01119
     C           *IN,33    IFEQ '1'                                       S01119
     C                     Z-SUBREVA      REVA                            S01119
     C                     Z-SUBREVAS     REVAS                           S01119
     C                     Z-SUBDBCE      DBCE                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
      *                                                                                       219337
      ** Instead of using BNNPVM which will never change through out                          219337
      ** the whole processing, use WNPVM (set before each call to CPRLO                       219337
      ** to calculate profit/loss for method 'N', 'F' and 'B'). Profit                        219337
      ** and Loss for method 'D' has its own calculation subroutine (SRREVD)                  219337
      ** and should never be recalculated in this subroutine.                                 219337
      *                                                                                       219337
     C                     SELEC                                                              217120
     C********** BNNPVM    WHEQ 'N'                                                    217120 219337
     C********** BNNPVM    OREQ ' '                                                    217120 219337
     C           WNPVM     WHEQ 'N'                                                           219337
     C           WNPVM     OREQ ' '                                                           219337
     C           EAMSGN    IFEQ '+'                                       S01119
     C***********REVA      SUB  DBCE      PLAM   130 2351          S01119 E10953
     C***********REVA      SUB  DBCE      PLAM   150 2351     S01119E10953E12711
     C           REVA      SUB  DBCE      PLAM   130 2351                 E12711
     C                     ELSE                                           S01119
     C           DBCE      SUB  REVA      PLAM       2351                 S01119
     C                     END                                            S01119
      *                                                                                       217120
     C********** BNNPVM    WHEQ 'D'                                                    217120 219337
     C********** EAMSGN    IFEQ '+'                                                    217120 219337
     C********** REVA      SUB  DBCE      PLAMD      2351                              217120 219337
     C**********           ELSE                                                        217120 219337
     C********** DBCE      SUB  REVA      PLAMD      2351                              217120 219337
     C**********           ENDIF                                                       217120 219337
      *                                                                                       217120
     C********** BNNPVM    WHEQ 'B'                                                    217120 219337
     C           WNPVM     WHEQ 'B'                                                           219337
     C           EAMSGN    IFEQ '+'                                                           217120
     C           REVA      SUB  DBCE      PLAMB  130 2351                                     217120
     C                     ELSE                                                               217120
     C           DBCE      SUB  REVA      PLAMB      2351                                     217120
     C                     ENDIF                                                              217120
      *                                                                                       217120
     C********** BNNPVM    WHEQ 'F'                                                    217120 219337
     C           WNPVM     WHEQ 'F'                                                           219337
     C           EAMSGN    IFEQ '+'                                                           217120
     C           REVA      SUB  DBCE      PLAMF  130 2351                                     217120
     C                     ELSE                                                               217120
     C           DBCE      SUB  REVA      PLAMF      2351                                     217120
     C                     ENDIF                                                              217120
     C                     ENDSL                                                              217120
     C*                                                                   S01119
0691 C*  22      REVA      SUB  DBCE      PLAM   130 23                   S1107
0692 C* N22      DBCE      SUB  REVA      PLAM       23                   S1107
0691 C***22N52N53REVA      SUB  DBCE      PLAM   130 23                   S1107
0691 C*  22N52N53                                                   S1107 S01119
0691 C*R 22 47   REVA      SUB  DBCE      PLAM   130 23             S1107 S01119
0692 C**N22N52N53DBCE      SUB  REVA      PLAM       23                   S1107
0692 C* N22N52N53                                                   S1107 S01119
0692 C*RN22 47   DBCE      SUB  REVA      PLAM       23             S1107 S01119
     C***                                                           S1107 S01119
     C***        *IN47     IFEQ '0'                        ***B01   S1107 S01119
     C***52      REVAS     SUB  DBCE      PLAMS  130 23             S1107 S01119
     C***52      REVA      SUB  DBCE      PLAMO  130 23             S1107 S01119
     C***                                                           S1107 S01119
     C***53      DBCE      SUB  REVAS     PLAMS      23             S1107 S01119
     C***53      DBCE      SUB  REVA      PLAMO      23             S1107 S01119
     C***                                                           S1107 S01119
     C***52                                                         S1107 S01119
     C*R*53*     PLAMS     COMP PLAMO                565555         S1107 S01119
     C***55                Z-ADDPLAMS     PLAM                      S1107 S01119
     C***56                Z-ADDPLAMO     PLAM                      S1107 S01119
     C***                  END                             ***E01   S1107 S01119
0693 C***        PLAM      COMP 0                      51                 S01119
     C*                                                                   S01119
     C*    FOR OPTION DEALS SELECT LEAST PROFIT OR GREATEST LOSS.         S01119
     C*                                                                   S01119
     C           *IN47     IFEQ '0'                        NOT BCCY       S01119
     C           *IN52     ANDEQ'1'                        OPTION 12V1    S01119
     C           *IN47     OREQ '0'                        NOT BCCY       E22164
     C           *IN53     ANDEQ'1'                        OPTION 12V2    E22164
     C************IN53     OREQ '1'                               S01119  E22164
     C           EAMSGN    IFEQ '+'                                       S01119
     C           REVA      SUB  DBCE      PLAMO  130                      S01119
     C           REVAS     SUB  DBCE      PLAMS  130                      S01119
     C                     ELSE                                           S01119
     C           DBCE      SUB  REVA      PLAMO                           S01119
     C           DBCE      SUB  REVAS     PLAMS                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0410C020
     C           PLAMS     COMP PLAMO                565555               S01119
     C/COPY WNCPYSRC,DL0410C021
     C********** BNNPVM    IFEQ 'N'                                                    217120 219337
     C********** BNNPVM    OREQ ' '                                                    217120 219337
     C           WNPVM     IFEQ 'N'                                                           219337
     C           WNPVM     OREQ ' '                                                           219337
     C   55                Z-ADDPLAMS     PLAM       2351                 S01119
     C   56                Z-ADDPLAMO     PLAM       2351                 S01119
     C                     ENDIF                                                              217120
      *                                                                                       217120
     C           *IN55     IFEQ *ON                                                           217120
     C                     SELEC                                                              217120
     C********** BNNPVM    WHEQ 'D'                                                    217120 219337
     C**********           Z-ADDPLAMS     PLAMD      2351                              217120 219337
     C********** BNNPVM    WHEQ 'F'                                                    217120 219337
     C           WNPVM     WHEQ 'F'                                                           219337
     C                     Z-ADDPLAMS     PLAMF      2351                                     217120
     C********** BNNPVM    WHEQ 'B'                                                    217120 219337
     C           WNPVM     WHEQ 'B'                                                           219337
     C                     Z-ADDPLAMS     PLAMB      2351                                     217120
     C                     ENDSL                                                              217120
     C                     ENDIF                                                              217120
      *                                                                                       217120
     C           *IN56     IFEQ *ON                                                           217120
     C                     SELEC                                                              217120
     C********** BNNPVM    WHEQ 'D'                                                    217120 219337
     C**********           Z-ADDPLAMO     PLAMD      2351                              217120 219337
     C********** BNNPVM    WHEQ 'F'                                                    217120 219337
     C           WNPVM     WHEQ 'F'                                                           219337
     C                     Z-ADDPLAMO     PLAMF      2351                                     217120
     C********** BNNPVM    WHEQ 'B'                                                    217120 219337
     C           WNPVM     WHEQ 'B'                                                           219337
     C                     Z-ADDPLAMO     PLAMB      2351                                     217120
     C                     ENDSL                                                              217120
     C                     ENDIF                                                              217120
0694 C*                                                                   S01119
     C*   SET PROFIT AND LOSS TO ZERO FOR OPTIONS (PURCH +SOLD)           E22164
     C*   EVENT TYPES 12V1 AND 12V2 IF IN BASE CURRENCY.                  E22164
0694 C*
     C           *IN47     IFEQ '1'                        BASE CCY       E22164
     C           *IN52     ANDEQ'1'                        + OPT 12V1     E22164
     C           *IN47     OREQ '1'                        OR BASE CCY    E22164
     C           *IN53     ANDEQ'1'                        + OPT 12V2     E22164
     C                     Z-ADD0         PLAM                            E22164
     C                     Z-ADD*ZEROS    PLAMD                                               217120
     C                     Z-ADD*ZEROS    PLAMF                                               217120
     C                     Z-ADD*ZEROS    PLAMB                                               217120
0703 C                     SETOF                     2351                 E22164
     C                     END                                            E22164
     C*                                                                   E22164
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0410C017
0694 C*
0695 C                     ENDSR
0696 C*
0697 C********************************************************************
0698 C*    SR. TO PERFORM EXCEPTION OUTPUT.
0699 C           EXCEPT    BEGSR                           *** EXCEPT ***
      *                                                                                       CAS005
      ** Process reversals                                                                    CAS005
      *                                                                                       CAS005
     C           WFRUN     IFEQ 'Y'                                                           CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WFRUN                                               CAS005
     C                     MOVE *IN45     WIN45   1                                           225302
     C                     MOVE '0'       *IN45                                               225302
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE *ON       *IN04                                               CAS005
      *                                                                                       CAS005
      ** To avoid field overrides, save values of DLPOSTL0 and then put back                  CAS005
      ** later                                                                                CAS005
      *                                                                                       CAS005
     C                     MOVELWPOSL0    WPOSSV                                              CAS005
      *                                                                                       CAS005
     C           *LOVAL    SETLLDLPOSTL0                                                      CAS005
     C                     READ DLPOSTL0                 16                                   CAS005
     C           *IN16     DOWEQ*OFF                                                          CAS005
      *                                                                                       CAS005
     C           DRCR      IFEQ 1                                                             CAS005
     C                     Z-ADD0         DRCR                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADD1         DRCR                                                CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     Z-ADD1         VOIN                                                CAS005
      *                                                                                       CAS005
      ** Prevent printer file exception output.                                               CAS005
      *                                                                                       CAS005
     C                     MOVE *IN37     WIN37   1                                           CAS005
     C                     MOVE *OFF      *IN37                                               CAS005
      *                                                                                       CAS005
     C                     EXCPT                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE WIN37     *IN37                                               CAS005
      *                                                                                       CAS005
      ** Keep hash total of posting amounts                                                   CAS005
      *                                                                                       CAS005
     C                     ADD  1         NRBR                                                CAS005
     C           RBR       ADD  PSTA      RBR                                                 CAS005
     C                     ADD  1         TOTNUM                                              CAS005
      *                                                                                       CAS005
     C                     Z-ADD2         S                                                   CAS005
     C           PSTA      DIV  1000      ZZAMT                                               CAS005
     C                     EXSR HASH                                                          CAS005
      *                                                                                       CAS005
      ** Delete records                                                                       CAS005
      *                                                                                       CAS005
     C                     DELETDLPOSTL0                                                      CAS005
      *                                                                                       CAS005
     C                     READ DLPOSTL0                 16                                   CAS005
     C                     ENDDO                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE *OFF      *IN04                                               CAS005
      *                                                                                       CAS005
      ** Put back the values of DLPOSTL0                                                      CAS005
      *                                                                                       CAS005
     C                     MOVELWPOSSV    WPOSL0                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
     C                     MOVE WIN45     *IN45                                               225302
     C                     ENDIF                                                              CAS005
0700 C*                                                                   S10736
0700 C**  VOIN = 1 IF REVERSA OF LEDGER BALANCES (*IN41 OR *IN43 ON)      S10736
0700 C**  OTHERWISE, VOIN = 0.                                            S10736
0700 C           *IN41     IFEQ '1'                                       S10736
0700 C           *IN43     OREQ '1'                                       S10736
0700 C                     Z-ADD1         VOIN    10                      S10736
0700 C                     ELSE                                           S10736
0700 C                     Z-ADD0         VOIN                            S10736
0700 C                     END                                            S10736
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0410CCP3                                           S01408
     C*                                                                   S01408
0700 C*
      *                                                                                       CAS005
     C           CAS005    IFEQ 'N'                                                           CAS005
     C           CAS005    OREQ 'Y'                                                           CAS005
     C           WFRUN     ANDNE'Y'                                                           CAS005
     C                     MOVE ##ACOD    ACOD                                              BUG5336R
0701 C                     EXCPT
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Post to PF/DLPOSTPD                                                                  CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           *IN42     ANDEQ*ON                                                           CAS005
     C           CAS005    OREQ 'Y'                                                           CAS005
     C           *IN44     ANDEQ*ON                                                           CAS005
      *                                                                                       CAS005
     C**********           MOVE ACCKY     WDLDS                                      CAS005 BUG5336R
     C                     MOVELACCKY     WDLDS                                             BUG5336R
     C                     MOVE '000001'  WDLDS                                             BUG5336R
      *                                                                                      BUG5336
     C**********           Z-ADDWCNUM     CNUM                                      BUG5336 BUG5336R
     C**********           MOVELWCCY      CCY                                       BUG5336 BUG5336R
     C**********           Z-ADDWACOD     ACOD                                      BUG5336 BUG5336R
     C**********           Z-ADDWACSQ     ACSQ                                      BUG5336 BUG5336R
      *                                                                                      BUG5336
     C                     MOVEABRAR,A    BRCA                                                CAS005
      *                                                                                       CAS005
      ** Account Code                                                                         CAS005
      *                                                                                       CAS005
     C           *IN42     IFEQ *ON                                                           CAS005
     C           *IN08     IFEQ *OFF                                                          CAS005
     C                     MOVE BNFRPL    ACOD                                                CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE BNFRLA    ACOD                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Posting Amount                                                                       CAS005
      *                                                                                       CAS005
     C           *IN08     IFEQ *OFF                                                          CAS005
     C           *IN42     ANDEQ*ON                                                           CAS005
     C           *IN08     OREQ *OFF                                                          CAS005
     C           *IN44     ANDEQ*ON                                                           CAS005
     C                     Z-ADDTBP,A     PSTA                                                CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN08     IFEQ *ON                                                           CAS005
     C           *IN42     ANDEQ*ON                                                           CAS005
     C           *IN08     OREQ *ON                                                           CAS005
     C           *IN44     ANDEQ*ON                                                           CAS005
     C                     Z-ADDTBL,A     PSTA                                                CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Debit/Credit Indicator                                                               CAS005
      *                                                                                       CAS005
     C           *IN42     IFEQ *ON                                                           CAS005
     C           *IN26     ANDEQ*ON                                                           CAS005
     C           *IN44     OREQ *ON                                                           CAS005
     C           *IN26     ANDEQ*OFF                                                          CAS005
     C                     Z-ADD1         DRCR                                                CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADD0         DRCR                                                CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Posting Date                                                                         CAS005
      *                                                                                       CAS005
     C                     Z-ADDBJRDNB    PSTD                                                CAS005
      *                                                                                       CAS005
     C                     MOVE 'P'       RECI                                                CAS005
     C**********           Z-ADDCNUM      CNUM                                         CAS005 CSD027
     C                     MOVE CNUM      CNUM                                                CSD027
     C                     MOVE CCY       CCY                                                 CAS005
      *                                                                                       CAS005
     C**********           Z-ADDACOD      ACOD                                       CAS005 BUG5336R
     C                     MOVE ##ACOD    ACOD                                              BUG5336R
     C                     Z-ADDACSQ      ACSQ                                                CAS005
     C                     Z-ADDBJRDNB    VALD                                                CAS005
     C                     MOVELO#PNAR    PNAR                                                CAS005
      *                                                                                       CAS005
     C**********           Z-ADDASOC      ASOC                                         CAS005 CSD027
     C                     MOVE ASOC      ASOC                                                CSD027
     C                     MOVE 'GE-FR'   SPOS                                                CAS005
     C                     MOVE *OFF      RIND                                                CAS005
     C                     MOVE A5ACTY    ATYP                                                CAS005
     C                     MOVE PRIN      PRIN                                                CAS005
     C                     MOVE 'F'       GETP                                                CAS005
     C           *IN17     IFEQ *OFF                                                          CAS005
     C                     MOVE *BLANKS   PRFC                                                CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE PRFC      PRFC                                                CAS005
     C                     ENDIF                                                              CAS005
     C                     MOVE '235959'  PTIM                                                CAS005
     C                     MOVE VOIN      VOIN                                                CAS005
     C                     MOVE A5ACSC    ACSC                                                CAS005
     C                     MOVE *BLANKS   OTRF                                                CAS005
     C                     MOVE *BLANKS   OTST                                                CAS005
     C                     MOVE *BLANKS   OTTP                                                CAS005
     C                     Z-ADDZERO15    SDCB                                                CAS005
     C                     Z-ADDZERO15    SDLB                                                CAS005
     C                     MOVE *BLANKS   BOKC                                                CAS005
      *                                                                                       CAS005
     C                     WRITEDLPOSTF                                                       CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS001
     C           CAS001    IFEQ 'Y'                                                           CAS001
     C           *IN09     ANDEQ*OFF                                                          CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
      *                                                                                       CAS001
      ** Total calculations                                                                   CAS001
      *                                                                                       CAS001
     C           *INL1     WHEQ *ON                                                           CAS001
     C           *INU7     ANDEQ*OFF                                                          CAS001
     C           *IN31     ANDEQ*ON                                                           CAS001
     C                     EXSR SRPRD2                                                        CAS001
     C                     EXSR SRPRD3                                                        CAS001
     C                     EXSR SRPRD4                                                        CAS001
      *                                                                                       CAS001
      ** Annual Calculations                                                                  CAS001
      *                                                                                       CAS001
     C           *IN82     WHEQ *ON                                                           CAS001
     C                     EXSR SRPRD2                                                        CAS001
     C                     EXSR SRPRD3                                                        CAS001
      *                                                                                       CAS001
      ** Monthly Calculations                                                                 CAS001
      *                                                                                       CAS001
     C           *IN81     WHEQ *ON                                                           CAS001
     C                     EXSR SRPRD2                                                        CAS001
      *                                                                                       CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
0702 C                     SETOF                     414243
0703 C                     SETOF                     4445
     C                     MOVE *OFF      *IN08                                               CAS005
     C                     MOVEA'00'      *IN,38                          S01303
     C                     MOVEA'000'     *IN,57                          S01303
     C                     MOVEA'000000'  *IN,64                          S01303
     C                     MOVEA'00'      *IN,77                          S01303
     C                     MOVEA'00'      *IN,81                          S01303
     C                     MOVEA'0'       *IN,84                          S01303
     C                     MOVEA'00'      *IN,86                          S01303
     C/COPY WNCPYSRC,DL0410C029
0704 C*
0705 C                     ENDSR
0706 C*
0707 C********************************************************************
0708 C************   SR. TO ACCESS TABLE FILE.                            S01194
0709 C************                                                        S01194
0710 C***********TABCHN    BEGSR                           *** TABCHN *** S01194
0711 C***********                                                         S01194
0712 C***********          SETOF                     040506               S01194
0713 C***********          SETOF                     070809               S01194
0714 C***********TABKEY    CHAINTABLE                40                   S01194
0715 C***********                                                         S01194
0716 C***********          ENDSR                                          S01194
0717 C***********                                                         S01194
0718 C********************************************************************
0719 C*    SR. TO ACCESS ACCOUNT MASTER FILE.
0720 C           ACCHN     BEGSR                           ** ACCHN ***
0721 C*
0722 C                     SETOF                     11
0723 C           ACCKEY    CHAINACCNT                40
0724 C  N11                Z-ADD0         LDBL           15
     C           *IN40     IFEQ '1'                                                          BUG7256
     C                     MOVELACCKY     CNUM                                               BUG7256
     C           3         SUBSTACCKY:7   CCY                                               BUG11232
     C                     MOVE ACCKY     @ACCNT 12                                          BUG7256
     C                     MOVEL@ACCNT    ACOD                                               BUG7256
     C                     MOVE @ACCNT    ACSQ                                               BUG7256
     C                     Z-ADD0         ACODQQ                                             BUG7256
     C                     MOVELBJCYCD    CCY                                               BUG10877
     C                     ENDIF                                                             BUG7256
0725 C*
0726 C                     ENDSR
0727 C*
0728 C********************************************************************
0729 C*    SR. TO ADD ZZAMT TO HASH TOTALS IN ARRAYS INT & DEC.
0730 C           HASH      BEGSR                           *** HASH ***
0731 C*
0732 C           ZZAMT     COMP 0                      50
0733 C   50                Z-SUBZZAMT     ZZAMT
0734 C                     Z-ADDINT,S     ZZTOTI
0735 C                     Z-ADDDEC,S     ZZTOTD
0736 C                     EXSR GLZADD
0737 C                     Z-ADDZZTOTI    INT,S
0738 C                     Z-ADDZZTOTD    DEC,S
0739 C*
0740 C                     ENDSR
0741 C*
0742 C********************************************************************
     C/EJECT
     C********************************************************************S01522
     C**  Subroutine SRPNAR determines the required narratives.         **S01522
     C********************************************************************S01522
     C           SRPNAR    BEGSR                           * S R P N A R *S01522
     C*                                                                   S01522
     C* Define the destination narrative field:                           S01522
     C*                                                                   S01522
     C                     MOVE *BLANKS   O#PNAR 30                       S01522
     C*                                                                   S01522
     C* Define the data structure parameter:                              S01522
     C*                                                                   S01522
     C           *LIKE     DEFN CGPNAR    ##PNAR                          S01522
     C*                                                                   S01522
     C* Fill the variable narrative field with the existing value:        S01522
     C*                                                                   S01522
     C/COPY WNCPYSRC,DL0410C038
     C                     MOVELTEXT,1    O#PNAR                          S01522
     C/COPY WNCPYSRC,DL0410C039
     C*                                                                   S01522
     C* If the facility is switched off or unavailable,                   S01522
     C*  or UDC is not installed, exit this subroutine:                   S01522
     C*                                                                   S01522
     C           DLPNAR    IFNE 'Y'                                       S01522
     C                     GOTO EXPNAR                                    S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* Determine the customer's name:                                    S01522
     C*                                                                   S01522
     C                     MOVEL##CNUM    ##KEY     P                     S01522
     C*                                                                   S01522
     C                     CALL 'AOCUSTR0'                                S01522
     C                     PARM           ##RTN   7                       S01522
     C                     PARM '*KEY   ' ##OPT   7                       S01522
     C                     PARM           ##KEY  10                       S01522
     C                     PARM           ##STS   7                       S01522
     C           SDCUST    PARM SDCUST    DSSDY                           S01522
     C*                                                                   S01522
     C           ##RTN     IFNE *BLANKS                                   S01522
     C                     MOVEL'SDCUSTPD'DBFILE             *************S01522
     C                     MOVEL'101'     DBASE              * DBERR 101 *S01522
     C                     MOVEL##OPT     DBOPTN             *************S01522
     C                     MOVEL##KEY     DBKEY                           S01522
     C                     EXSR *PSSR                                     S01522
     C                     SETON                     U7U8LR               S01522
     C                     GOTO END                                       S01522
     C                     ENDIF                                          S01522
     C*...................................................................S01522
     C/EJECT                                                              S01522
     C*...................................................................S01522
     C* Determine the value for the narrative using AOPNARR0:             S01522
     C*                                                                   S01522
     C                     CLEARCGPNAR                                    S01522
     C                     CLEAR##PRM1                                    086125
     C*                                                                   S01522
     C                     MOVE 'DL'      MNMODI                          S01522
     C                     MOVE BRAR,A    MNBRCA                          S01522
     C                     MOVE ##CNUM    MNCUST                          S01522
     C                     MOVE ##CCY     MNCYCD                          S01522
     C                     MOVE ##ACOD    MNACCD                          S01522
     C                     MOVE ##ACSQ    MNACSQ                          S01522
     C                     MOVE BBCRNM    MNCRNM                          S01522
     C                     MOVELO#PNAR    MNNARR    P                     S01522
     C                     MOVELASOC      MNASOC    P                     S01522
     C/COPY WNCPYSRC,DLH00446
     C*                                                                   S01522
     C                     CALL 'AOPNARR0'                                S01522
     C                     PARM           ##RTN                           S01522
     C                     PARM           ##MGID  7                       S01522
     C                     PARM           ##PRM1                          086125
     C           CGPNAR    PARM CGPNAR    ##PNAR                          S01522
     C                     PARM           ##NARR 50                       S01522
     C/COPY WNCPYSRC,DLH00447
     C*                                                                   S01522
     C           ##RTN     IFNE *BLANKS                                   S01522
     C                     MOVEL'CGPNARPD'DBFILE             *************S01522
     C                     MOVEL'102'     DBASE              * DBERR 102 *S01522
     C                     MOVELMNCUST    DBKEY              *************S01522
     C                     EXSR *PSSR                                     S01522
     C                     SETON                     U7U8LR               S01522
     C                     GOTO END                                       S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C                     MOVEL##NARR    O#PNAR    P                     S01522
     C*                                                                   S01522
     C           EXPNAR    TAG                             < EXPNAR       S01522
     C*                                                                   S01522
     C                     ENDSR                                          S01522
     C********************************************************************S01522
     C/EJECT
0742 C********************************************************************
0743 C**
0744 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0745 C**
0746 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0747 C**
0748 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0749 C**
0750 C**   CLEAR DATE FIELDS.
0751 C                     Z-ADD0         ZDATE   60
0752 C                     MOVEL'       ' ZADATE  7
0753 C**
0754 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0755 C                     Z-ADDZDAYNO    ZDAYNO  50
0756 C**
0757 C**   DETERMINE YEAR NUMBER.
0758 C**
0759 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0760 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0761 C   99                GOTO ZDEND2
0762 C**
0763 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0764 C           ZDAYN1    DIV  1461      ZLYR    20
0765 C                     MVR            ZDAYN1           SAVE REMAINING
0766 C**                                                   DAYS
0767 C**   CALCULATE NUMBER OF REMAINING YEARS.
0768 C                     Z-ADD1         ZWRK2   20
0769 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0770 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0771 C  N90      ZWRK2     ADD  1         ZWRK2
0772 C  N90                GOTO ZDTAG1
0773 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0774 C**
0775 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0776 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0777 C**
0778 C**   CALCULATE ACTUAL YEAR NUMBER.
0779 C           ZLYR      MULT 4         ZWRK3   30
0780 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0781 C                     Z-ADDZWRK3     ZYEAR   20
0782 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0783 C**
0784 C**   DETERMINE MONTH NUMBER.
0785 C**
0786 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0787 C                     SETOF                     9293
0788 C   91      ZDAYN1    COMP 59                     9293
0789 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0790 C**
0791 C**   CALCULATE MONTH NUMBER.
0792 C                     Z-ADD2         ZWRK2
0793 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0794 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0795 C  N94      ZWRK2     ADD  1         ZWRK2
0796 C  N94                GOTO ZDTAG2
0797 C           ZWRK2     SUB  1         ZWRK2
0798 C**
0799 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0800 C**
0801 C**   DETERMINE DAY OF MONTH.
0802 C**
0803 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0804 C           ZDAYN1    ADD  1         ZDAYN1
0805 C**
0806 C**   CALCULATE DAY OF MONTH.
0807 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0808 C**
0809 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0810 C   93      ZDAY      ADD  1         ZDAY
0811 C**
0812 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0813 C  N98                MOVELZDAY      ZWRK4   40
0814 C   98                MOVE ZDAY      ZWRK4
0815 C  N98                MOVE ZMTH      ZWRK4
0816 C   98                MOVELZMTH      ZWRK4
0817 C                     MOVELZWRK4     ZDATE
0818 C                     MOVE ZYEAR     ZDATE
0819 C**
0820 C**   FORMAT ALPHA DATE, DDMMMYY.
0821 C           ZDAY      COMP 10                     95
0822 C                     MOVELZDAY      ZWRK5   5
0823 C   95                MOVEL' '       ZWRK5
0824 C                     MOVE ZMNM,ZMTH ZWRK5
0825 C                     MOVELZWRK5     ZADATE
0826 C                     MOVE ZYEAR     ZADATE
0827 C**
0828 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0829 C**
0830 C********************************************************************
0831 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0832 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0833 C*
0834 CSR         GLZADD    BEGSR                           *** GLZADD ****
0835 C*
0836 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0837 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0838 C*
0839 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0840 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0841 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0842 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0843 C*
0844 CSR                   EXSR GLZSUM
0845 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0846 C*
0847 C********************************************************************
0848 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0849 C*                        GLZADD, GLZSUB, GLZCMP.
0850 C*          PARAMETERS PASSED -
0851 C*                     I/P ZZAMTI ZZAMTD
0852 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0853 C*
0854 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0855 C*
0856 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0857 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0858 CSR                   SETOF                     919293
0859 CSR                   SETOF                     949599
0860 C*
0861 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0862 CSR         ZZAMTI    COMP 0                      9293
0863 CSR 93      ZZAMTD    COMP 0                      9293
0864 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0865 C*
0866 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0867 CSR         ZZTOTI    COMP 0                      9193
0868 CSR 93      ZZTOTD    COMP 0                      9193
0869 C*
0870 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0871 CSR 93                Z-ADDZZAMTI    ZZTOTI
0872 CSR 93                Z-ADDZZAMTD    ZZTOTD
0873 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0874 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0875 CSR 91N92
0876 CORN91 92             GOTO ZZOFPS
0877 C*
0878 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0879 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0880 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0881 C*
0882 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0883 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0884 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0885 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0886 C*
0887 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0888 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0889 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0890 CSRN99                Z-ADDZZWK2     ZZTOTD
0891 CSRN99                Z-ADDZZWK3     ZZTOTI
0892 C*
0893 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0894 CSR 99                Z-ADD0         ZZAMT  153
0895 CSR                   GOTO ZZSEND
0896 C*
0897 C* THE 'SIGNS' ARE DIFFERENT
0898 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0899 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0900 C*
0901 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0902 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0903 C*
0904 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0905 C*
0906 CSR 91                Z-SUBZZTOTI    ZZTOTI
0907 CSR 91                Z-SUBZZTOTD    ZZTOTD
0908 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0909 C*
0910 CSR         ZZTOTI    COMP ZZAMTI               93  95
0911 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0912 C*
0913 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0914 CSR 95                Z-ADD0         ZZTOTI
0915 CSR 95                Z-ADD0         ZZTOTD
0916 CSR 95                GOTO ZZSEND
0917 C*
0918 C* IF ZZTOT GT. ZZAMT.
0919 CSR 93      ZZAMTD    COMP ZZTOTD               94
0920 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0921 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0922 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0923 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0924 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0925 C*
0926 C*
0927 C* IF ZZAMT GT. ZZTOT.
0928 CSRN93      ZZTOTD    COMP ZZAMTD               94
0929 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0930 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0931 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0932 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0933 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0934 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0935 C*
0936 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0937 CSR                   SETOF                     94
0938 CSR 93 91
0939 CORN93 92             SETON                     94
0940 CSR 94                Z-SUBZZTOTI    ZZTOTI
0941 CSR 94                Z-SUBZZTOTD    ZZTOTD
0942 C**
0943 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0944 CSR 92                Z-SUBZZAMTI    ZZAMTI
0945 CSR 92                Z-SUBZZAMTD    ZZAMTD
0946 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0947 C**
0948 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0949 CSR                   SETOF                     96
0950 CSR         ZZTOTD    COMP 0                        91
0951 CSR 91      ZZTOTI    COMP 0                      96
0952 CSR 96                MOVE '.000-'   ZZNEGD  5
0953 CSR                   ENDSR                             ** ENDSR **
     C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*****************************************************************   S01194
      *                                                               *   CEU011
      *   SR/P001 - Convert amount to Euro Equivalent                 *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           P001      BEGSR                                          CEU011
      *                                                                   139778
     C           WBINCY    IFEQ 'Y'                                       139778
      *                                                                   CEU011
     C                     MOVE *BLANKS   WRTCD                           CEU011
     C                     MOVE BJCYCD    P@FRCY                          CEU011
     C                     MOVE BKEURO    P@TOCY                          CEU011
     C                     Z-ADD*ZEROS    P@OUTA                          CEU011
     C                     Z-ADD*ZEROS    P@INTA                          CEU011
     C                     Z-ADD*ZEROS    P@EXRT                          CEU011
     C                     MOVE *BLANKS   P@MDIN                          CEU011
      *                                                                   CEU011
     C                     CALL 'EU0200'                                  CEU011
     C                     PARM           WRTCD   7                       CEU011
     C                     PARM           P@FRAM 183                      CEU011
     C                     PARM           P@FRCY  3                       CEU011
     C                     PARM           P@TOCY  3                       CEU011
     C                     PARM           P@OUTA 150                      CEU011
     C                     PARM           P@INTA 183                      CEU011
     C                     PARM           P@EXRT 159                      CEU011
     C                     PARM           P@MDIN  1                       CEU011
      *                                                                   139778
     C                     ELSE                                           139778
      *                                                                   139778
     C                     Z-ADDP@FRAM    ZAMTCI                          139778
     C                     Z-ADDWESPRT    ZEXCH                           139778
     C                     MOVE WEMDIN    ZMD                             139778
     C                     Z-ADDBCCDP     ZCDPI                           139778
     C                     Z-ADDWENBDP    ZCDPO                           139778
      *                                                                   153673
      * Use unique field WUFLAG - for the use in CONVN sub-routine to     153673
      * establsh if it has been called from DL0410                        153673
     C                     MOVE 'Y'       WUFLAG  1                       153673
      *                                                                   153673
     C                     EXSR ZCONVN                                    139778
     C                     Z-ADDZAMTCO    P@OUTA                          139778
      *                                                                   139778
     C                     ENDIF                                          139778
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *   SR/P002 - Write a record to PRTF/DL0410P2                   *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           P002      BEGSR                                          CEU011
      *                                                                   CEU011
     C           *IN18     IFEQ *OFF                                      CEU011
      *                                                                   151153
     C           FCHK      IFEQ ' '                                       151153
     C                     OPEN DL0410P2                                  CEU011
     C                     MOVE '1'       FCHK                            151153
     C                     ENDIF                                          151153
      *                                                                   151153
     C                     MOVE *ON       *IN18                           CEU011
     C                     MOVE BRCA      PBRNCH                          192193
     C                     Z-ADDSFNUM2    ZSNUM   60                      CEU011
     C                     CALL 'ZSFILE'                                  CEU011
     C                     PARM           SEQ     5                       CEU011
     C***********          PARM BRCA      @PARM   3                 CEU011142799
     C                     PARM PBRNCH    @PARM   3                       142799
     C**********           PARM           SFILE                     CEU011157652
     C                     PARM           SFILE2                          157652
     C                     PARM           ZSNUM                           CEU011
     C                     PARM *BLANK    ZSERR   1                       CEU011
      *                                                                   CEU011
      ** Error during ZSFILE processing, return to calling program        CEU011
      *                                                                   CEU011
     C           ZSERR     IFEQ 'Y'                                       CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     RETRN                                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C**********           MOVE BRCA      PBRNCH                   CEU011 192193
     C                     MOVE A8BRNM    PBRNCD                          CEU011
     C                     WRITEDL0410D1                                  CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     EXSR P003                                      CEU011
      *                                                                   CEU011
     C           PRTLN2    IFGE 58                                        CEU011
     C                     WRITEDL0410D1                                  CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     WRITEDL0410D2                                  CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
      *****************************************************************   CEU011
      *                                                               *   CEU011
      *   SR/P003 - Setup printer file fields.                        *   CEU011
      *                                                               *   CEU011
      *****************************************************************   CEU011
      *                                                                   CEU011
     C           P003      BEGSR                                          CEU011
      *                                                                   CEU011
     C                     MOVE EDATA     PVDAT                           CEU011
     C                     MOVE ECNUM     PCNUM                           CEU011
     C           *IN02     IFEQ *ON                                       CEU011
     C                     MOVE EDLNO     PDLNO                           CEU011
     C***********          MOVE DTYP      PDLTP                     CEU011158840
     C                     MOVE DTYP      PDTYP                           158840
     C                     MOVE DLST      PDLST                           CEU011
     C                     MOVE CLAS      PCLAS                           CDL038
     C                     ELSE                                           CEU011
     C                     MOVE *BLANKS   PDLNO                           CEU011
     C************         MOVE *BLANKS   PDLTP                     CEU011158840
     C                     MOVE *BLANKS   PDTYP                           158840
     C                     MOVE *BLANKS   PDLST                           CEU011
     C                     MOVE *BLANKS   PCLAS                           CDL038
     C                     ENDIF                                          CEU011
     C                     MOVE PREF      PPREF                           158840
     C                     MOVE ECCY      PCCY                            CEU011
      *                                                                   CEU011
     C           *IN22     IFEQ *OFF                                      CEU011
      *                                                                   158840
      * If Incoming --> 'TO'  Nostro Transfer payment,  opposite calcula  158840
      * tion should be used .                                             158840
     C           *IN19     IFEQ '1'                                       158840
     C           WNTCHK    ANDEQ'Y'                                       158840
     C                     Z-ADDEUDBCE    EUDBCE                          158840
     C                     Z-ADDEUREVA    EUREVA                          158840
      *                                                                   158840
     C                     ELSE                                           158840
     C                     Z-SUBEUDBCE    EUDBCE                          CEU011
     C                     Z-SUBEUREVA    EUREVA                          CEU011
     C                     END                                            158840
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   ZFLD15                          CEU011
     C                     MOVE EUDBCE    ZFLD15                          CEU011
     C**********           Z-ADDA6NBDP    ZDECS                     CEU011140989
     C                     Z-ADDWENBDP    ZDECS                           140989
     C                     MOVE 'J'       ZECODE                          CEU011
     C                     EXSR ZSEDIT                                    CEU011
     C                     MOVE ZOUT21    PDEUEQ                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   PMIDRT                          145193
     C           *IN55     IFEQ *ON                                       CEU011
     C                     MOVE RATES     PMIDRT                          CEU011
     C                     ELSE                                           CEU011
     C                     MOVE RATE      PMIDRT                          CEU011
     C                     ENDIF                                          CEU011
     C                     MOVE *BLANKS   ZFLD15                          CEU011
     C                     MOVE PMIDRT    ZFLD15                          CEU011
     C                     Z-ADD8         ZDECS                           CEU011
     C                     MOVE 'L'       ZECODE                          CEU011
     C                     EXSR ZSEDIT                                    CEU011
     C                     MOVE ZOUT21    PMIDRT                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   ZFLD15                          CEU011
     C                     MOVE EUREVA    ZFLD15                          CEU011
     C**********           Z-ADDA6NBDP    ZDECS                     CEU011140989
     C                     Z-ADDWENBDP    ZDECS                           140989
     C                     MOVE 'J'       ZECODE                          CEU011
     C                     EXSR ZSEDIT                                    CEU011
     C                     MOVE ZOUT21    PSEUEQ                          CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   ZFLD15                          CEU011
     C                     MOVE EUPLAM    ZFLD15                          CEU011
     C**********           Z-ADDA6NBDP    ZDECS                     CEU011140989
     C                     Z-ADDWENBDP    ZDECS                           140989
     C                     MOVE 'J'       ZECODE                          CEU011
     C                     EXSR ZSEDIT                                    CEU011
     C                     MOVE ZOUT21    PEURPL                          CEU011
      *                                                                   CEU011
     C                     ENDSR                                          CEU011
      *                                                                   CEU011
      *****************************************************************   CEU011
     C/COPY ZSRSRC,ZACCH                                                  129805
     C/COPY ZSRSRC,ZFWDTA                                                 129805
     C/COPY WNCPYSRC,DL0410C004
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRREVF - Revaluation Calculation NPV Method "F"              *                       CAS001
      *                                                               *                       CAS001
      *  Called by: Main Processing                                   *                       CAS001
      *                                                               *                       CAS001
      *  Calls: SRCREV  SRDFC  CPRLO  SRWNPV                          *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRREVF    BEGSR                                                              CAS001
      *                                                                                       217120
      ** Determine diff of currency decimal place between event                               217120
      ** currency and base currency                                                           217120
      *                                                                                       217120
     C           A6NBDP    SUB  BCCDP     K                                                   217120
     C           K         ADD  4         K                                                   217120
      *                                                                                       217120
      ** Convert event currency to base currency                                              217120
      *                                                                                       217120
     C                     Z-ADDA6SPRT    WKRATE                                              217120
     C                     EXSR SRCREV                                                        217120
     C                     Z-ADDWNREV     BASAMT 309                                          217120
      *                                                                                       CAS001
      ** Retrieve yield curve from master file and set up parameter                           CAS001
      ** parameter for ZADSFCAL                                                               CAS001
      *                                                                                       CAS001
     C                     Z-ADD1         WDSCF                                               CAS004
     C                     MOVEL*BLANKS   PNPYLD                                              CAS004
      *                                                                                       CAS004
     C           *IN12     IFEQ *ON                                                           CAS001
     C**********           Z-ADD1         WDSCF                                        CAS001 CAS004
     C**********           MOVEL*BLANKS   PNPYLD                                       CAS001 CAS004
     C                     ELSE                                                               CAS001
      *                                                                                       CAS001
     C           EDLNO     CHAINDLDLDBL1             13                                       CAS001
      *                                                                                       CAS001
     C           *IN13     IFEQ *OFF                                                          CAS001
      **********                                                                       CAS001 CAS004
      ***If*deal*is*an*internal*contract*and*event*"V1"*or*"V2"************            CAS001 CAS004
      ***use*linked*deal*yield*curve*from*master*file**********************            CAS001 CAS004
      **********                                                                       CAS001 CAS004
     C********** DTYP      IFEQ 'PS'                                                   CAS001 CAS004
     C**********           MOVE ETYP      WETYP   2                                    CAS001 CAS004
     C********** WETYP     IFEQ 'V1'                                                   CAS001 CAS004
     C********** WETYP     OREQ 'V2'                                                   CAS001 CAS004
      **********                                                                       CAS001 CAS004
     C**********           Z-ADDLNKDN     WLNKDN  60                                   CAS001 CAS004
      **********                                                                       CAS001 CAS004
      ***Retrieve*incoming*outgoing*indicator*of*link*deal*****************            CAS001 CAS004
      **********                                                                       CAS001 CAS004
     C**********           MOVELINOI      WINOI   1                                    CAS001 CAS004
     C********** WLNKDN    SETLLDLEVNPL2                                               CAS001 CAS004
     C********** WLNKDN    READEDLEVNPL2                 13                            CAS001 CAS004
     C********** *IN13     DOWEQ*OFF                                                   CAS001 CAS004
     C********** EDAT      ANDLEEDAT2                                                  CAS001 CAS004
     C**********           MOVE ETYP2     WETYP2  2                                    CAS001 CAS004
     C********** WETYP     IFEQ WETYP2                                                 CAS001 CAS004
     C**********           MOVELINOI2     INOI                                         CAS001 CAS004
     C**********           LEAVE                                                       CAS001 CAS004
     C**********           ENDIF                                                       CAS001 CAS004
     C********** WLNKDN    READEDLEVNPL2                 13                            CAS001 CAS004
     C**********           ENDDO                                                       CAS001 CAS004
      **********                                                                       CAS001 CAS004
     C**********           ENDIF                                                       CAS001 CAS004
     C**********           ENDIF                                                       CAS001 CAS004
      *                                                                                       CAS001
     C           INOI      IFEQ 'I'                                                           CAS001
     C                     MOVELFSOYLC    PNPYLD                                              CAS001
     C                     ELSE                                                               CAS001
     C                     MOVELFSTYLC    PNPYLD                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS004
      ** If deal is an internal contract, use Yield Curve of the                              CAS004
      ** linked deal number from DEALSDC.                                                     CAS004
      *                                                                                       CAS004
     C           DTYP      IFEQ 'PS'                                                          CAS004
     C           LNKDN     ANDNE*ZERO                                                         CDL038
      *                                                                                       CAS004
     C           LNKDN     CHAINDLDLDCL1             13                                       CAS004
     C           *IN13     IFEQ *OFF                                                          CAS004
     C                     MOVELWCOYLC    PNPYLD                                              CAS004
     C*********************ELSE                                                        CAS004 CDL038
     C*********************MOVEL'DEALSDC' DBFILE                                       CAS004 CDL038
     C*********************MOVEL'16'      DBASE                                        CAS004 CDL038
     C*********************MOVELLNKDN     DBKEY                                        CAS004 CDL038
     C*********************GOTO ERROR                                                  CAS004 CDL038
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS001
     C           PNPYLD    IFNE *BLANKS                                                       CAS001
      *                                                                                       CAS001
     C**********           MOVELWINOI     INOI                                         CAS001 CAS004
     C                     MOVELECCY      PNPCCY                                              CAS001
     C                     MOVELA6DICB    PNPINC                                              CAS001
      *                                                                                       CAS001
      ** If deal is an option deal use other date as a value date                             CAS001
      *                                                                                       CAS001
     C           ETYP      IFEQ '12V1'                                                        CAS001
     C           ETYP      OREQ '12V2'                                                        CAS001
     C                     Z-ADDOTHD      PNPFDT                                              CAS001
      *                                                                                       CAS001
     C                     EXSR SRDFC                                                         CAS001
      *                                                                                       CAS001
      ** Calculate revalued amount                                                            CAS001
      *                                                                                       CAS001
     C                     Z-ADDPNPDF     WDSCFS 139                                          CAS001
     C********** EAMT      MULT WDSCFS    WRKAMT 150H                                  CAS001 217120
     C           BASAMT    MULT WDSCFS    REVAS     H                                         217120
     C/COPY WNCPYSRC,DL0410C090
      *****************************************************************                CAS001 217120
      ***Determine*diff*of*currency*decimal*place*between*event********                CAS001 217120
      ***currency*and*base*currency************************************                CAS001 217120
      *****************************************************************                CAS001 217120
     C********** A6NBDP    SUB  BCCDP     K                                            CAS001 217120
     C********** K         ADD  4         K                                            CAS001 217120
      *****************************************************************                CAS001 217120
      ***Convert*revalued*equivalent*to*base*ccy***********************                CAS001 217120
      *****************************************************************                CAS001 217120
     C**********           Z-ADDA6SPRT    WKRATE                                       CAS001 217120
     C**********           EXSR SRCREV                                                 CAS001 217120
     C**********           Z-ADDWNREV     REVAS                                        CAS001 217120
      *                                                                                       CAS001
      ** End if ETYPE = "12V1" or "12V2"                                                      CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Revalue deal with value date                                                         CAS001
      *                                                                                       CAS001
     C                     Z-ADDEDAT      PNPFDT                                              CAS001
      *                                                                                       CAS001
     C                     EXSR SRDFC                                                         CAS001
      *                                                                                       CAS001
     C                     Z-ADDPNPDF     WDSCF  139                                          CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** For CAS008 changes, get the forward commitment yield curves                          CAS008
      ** from DLDLDGLE for cross currency principal exchanges.                                CAS008
      *                                                                                       CAS008
     C           CIR003    IFEQ 'Y'                                                           CAS008
     C           CAS008    ANDEQ'Y'                                                           CAS008
      *                                                                                       CAS008
     C           ETYP      IFEQ '23C3'                                                        CAS008
     C           ETYP      OREQ '23S3'                                                        CAS008
     C           ETYP      OREQ '23C4'                                                        CAS008
     C           ETYP      OREQ '23S4'                                                        CAS008
      *                                                                                       CAS008
     C           EDLNO     CHAINDLDLDGLE             34                                       CAS008
     C           *IN34     IFEQ *OFF                                                          CAS008
      *                                                                                       CAS008
      ** If deal found, process accordingly.                                                  CAS008
      *                                                                                       CAS008
     C           INOI      IFEQ 'I'                                                           CAS008
     C                     MOVELFSOFCC    PNPYLD                                              CAS008
     C                     ELSE                                                               CAS008
     C                     MOVELFSTFCC    PNPYLD                                              CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C                     MOVELECCY      PNPCCY                                              CAS008
     C                     MOVELA6DICB    PNPINC                                              CAS008
     C                     MOVELEDAT      PNPFDT                                              CAS008
      *                                                                                       CAS008
     C                     EXSR SRDFC                                                         CAS008
      *                                                                                       CAS008
     C                     Z-ADDPNPDF     WDSCF                                               CAS008
      *                                                                                       CAS008
      ** Deal number not found in Deals File                                                  CAS008
      *                                                                                       CAS008
     C                     ELSE                                                               CAS008
     C                     MOVEL'DEALSDG' DBFILE                                              CAS008
     C                     MOVEL'22'      DBASE                                               CAS008
     C                     MOVELEDLNO     DBKEY                                               CAS008
     C                     GOTO ERROR                                                         CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
      *                                                                                       CAS008
     C                     ENDIF                                                              CAS008
     C                     ENDIF                                                              CAS008
      *                                                                                       CAS008
     C********** EAMT      MULT WDSCF     WRKAMT    H                                  CAS001 217120
     C/COPY WNCPYSRC,DL0410C091
      *                                                                                       CAS001
      ***Determine*diff*of*currency*decimal*place*between*event********                CAS001 217120
      ***currency*and*base*currency************************************                CAS001 217120
      *****************************************************************                CAS001 217120
     C********** A6NBDP    SUB  BCCDP     K                                            CAS001 217120
     C********** K         ADD  4         K                                            CAS001 217120
      *****************************************************************                CAS001 217120
      ** Convert revalued equivalent to base ccy***********************                CAS001 217120
      *****************************************************************                CAS001 217120
     C**********           Z-ADDA6SPRT    WKRATE                                       CAS001 217120
     C**********           EXSR SRCREV                                                 CAS001 217120
     C**********           Z-ADDWNREV     REVA                                         CAS001 217120
     C                     Z-ADDA6SPRT    RATE                                                217120
     C           BASAMT    MULT WDSCF     REVA      H                                         217120
      *                                                                                       CAS001
      ** Calculate Profit/Loss                                                                CAS001
      ** only if rates are present                                                            225831
      *                                                                                       CAS001
     C           *IN30     IFEQ '0'                                                           225831
     C                     MOVE 'F'       WNPVM                                               219337
     C                     EXSR CPRLO                                                         CAS001
      *                                                                                       225831
     C                     ELSE                                                               225831
     C                     Z-ADD0         PLAMF                                               225831
     C                     ENDIF                                                              225831
      *                                                                                       CAS001
      ** Write Record to PF/DLNPVLPD                                                          CAS001
      *                                                                                       CAS001
     C                     MOVEL'F'       FSNPVM                                              CAS001
     C                     EXSR SRWNPV                                                        CAS001
      *                                                                                       CAS001
      ** Save indicators and fields in array                                                  CAS001
      *                                                                                       CAS001
     C           BNNPVM    IFEQ 'F'                                                           CAS001
     C                     MOVELDSNPVS    WFLDS                                               CAS001
     C                     MOVEL*IN23     WIN23                                               CAS001
     C                     MOVEL*IN51     WIN51                                               CAS001
     C                     MOVEL*IN55     WIN55                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           ENDSRF    ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRREVB - Revaluation Calculation NPV Method "B"              *                       CAS001
      *                                                               *                       CAS001
      *  Called by: Main Processing                                   *                       CAS001
      *                                                               *                       CAS001
      *  Calls: SRBCDF  SRCREV  CPRLO  SRWNPV                         *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRREVB    BEGSR                                                              CAS001
      *                                                                                       CAS001
      ** Determine diff of currency decimal place between event                               CAS001
      ** currency and base currency                                                           CAS001
      *                                                                                       CAS001
     C           A6NBDP    SUB  BCCDP     K                                                   CAS001
     C           K         ADD  4         K                                                   CAS001
      *                                                                                       CAS001
      ** Convert event amount to base currency                                                CAS001
      *                                                                                       CAS001
     C**********           Z-ADDEAMT      WRKAMT                                       CAS001 217120
     C                     Z-ADDEAMT      WRKAMT 150H                                         217120
      *                                                                                       CAS001
     C                     Z-ADDRATE      WKRATE                                              CAS001
     C                     EXSR SRCREV                                                        CAS001
     C                     Z-ADDWNREV     REVA                                                CAS001
      *                                                                                       CAS001
     C                     Z-ADDRATES     WKRATE                                              CAS001
     C                     EXSR SRCREV                                                        CAS001
     C                     Z-ADDWNREV     REVAS                                               CAS001
      *                                                                                       CAS001
      ** Calculate revalued amount, if option deal use other date.                            CAS001
      *                                                                                       CAS001
     C                     Z-ADD1         WDSCF                                               CAS004
     C                     MOVEL*BLANKS   PNPYLD                                              CAS004
      *                                                                                       CAS004
     C           *IN12     IFEQ *ON                                                           CAS001
     C**********           Z-ADD1         WDSCF                                        CAS001 CAS004
     C**********           MOVEL*BLANKS   PNPYLD                                       CAS001 CAS004
     C                     ELSE                                                               CAS001
      *                                                                                       CAS001
     C           ETYP      IFEQ '12V1'                                                        CAS001
     C           ETYP      OREQ '12V2'                                                        CAS001
     C                     Z-ADDOTHD      PNPFDT                                              CAS001
      *                                                                                       CAS001
      ** Get Base Currency Discount Factor                                                    CAS001
      *                                                                                       CAS001
     C                     EXSR SRBCDF                                                        CAS001
      *                                                                                       CAS001
     C                     Z-ADDPNPDF     WDSCFS                                              CAS001
      *                                                                                       CAS001
     C           REVAS     MULT WDSCFS    REVAS     H                                         CAS001
     C/COPY WNCPYSRC,DL0410C092
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Get Base Currency Discount Factor                                                    CAS001
      *                                                                                       CAS001
     C                     Z-ADDEDAT      PNPFDT                                              CAS001
     C                     EXSR SRBCDF                                                        CAS001
      *                                                                                       CAS001
     C                     Z-ADDPNPDF     WDSCF                                               CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           REVA      MULT WDSCF     REVA      H                                         CAS001
     C/COPY WNCPYSRC,DL0410C093
      *                                                                                       CAS001
      ** Calculate Profit/Loss                                                                CAS001
      ** only if rates are present                                                            225831
      *                                                                                       CAS001
     C           *IN30     IFEQ '0'                                                           225831
     C                     MOVE 'B'       WNPVM                                               219337
     C                     EXSR CPRLO                                                         CAS001
      *                                                                                       225831
     C                     ELSE                                                               225831
     C                     Z-ADD0         PLAMB                                               225831
     C                     ENDIF                                                              225831
      *                                                                                       CAS001
      ** Write Record to PF/DLNPVLPD                                                          CAS001
      *                                                                                       CAS001
     C                     MOVEL'B'       FSNPVM                                              CAS001
     C                     EXSR SRWNPV                                                        CAS001
      *                                                                                       CAS001
      ** Save fields in array                                                                 CAS001
      *                                                                                       CAS001
     C           BNNPVM    IFEQ 'B'                                                           CAS001
     C                     MOVELDSNPVS    WFLDS                                               CAS001
     C                     MOVEL*IN23     WIN23                                               CAS001
     C                     MOVEL*IN51     WIN51                                               CAS001
     C                     MOVEL*IN55     WIN55                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           ENDSRB    ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRREVD - Revaluation Calculation NPV Method "D"              *                       CAS001
      *                                                               *                       CAS001
      *  Called by: Main Processing                                   *                       CAS001
      *                                                               *                       CAS001
      *  Calls: SRBCDF  SRWNPV                                        *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRREVD    BEGSR                                                              CAS001
      *                                                                                       CAS001
     C                     Z-ADD1         WDSCF                                               CAS004
     C                     MOVE *BLANKS   PNPYLD                                              CAS004
      *                                                                                       CAS004
     C           *IN12     IFEQ *ON                                                           CAS001
     C**********           Z-ADD1         WDSCF                                        CAS001 CAS004
     C**********           MOVE *BLANKS   PNPYLD                                       CAS001 CAS004
     C                     ELSE                                                               CAS001
      *                                                                                       CAS001
     C           ETYP      IFEQ '12V1'                                                        CAS001
     C           ETYP      OREQ '12V2'                                                        CAS001
     C                     Z-ADDOTHD      PNPFDT                                              CAS001
     C                     ELSE                                                               CAS001
     C                     Z-ADDEDAT      PNPFDT                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Get base currency discount factor                                                    CAS001
      *                                                                                       CAS001
     C                     EXSR SRBCDF                                                        CAS001
      *                                                                                       CAS001
      ** Calculate profit/loss                                                                CAS001
      *                                                                                       CAS001
     C           *IN55     IFEQ *OFF                                                          CAS001
     C                     Z-ADDPNPDF     WDSCF                                               CAS001
     C                     ELSE                                                               CAS001
     C                     Z-ADDPNPDF     WDSCFS                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C********** PLAM      MULT PNPDF     PLAM      H                                  CAS001 217120
     C           PLAM      MULT PNPDF     PLAMD  130H                                         217120
     C/COPY WNCPYSRC,DL0410C094
      *                                                                                       CAS001
      ** Write Record to PF/DLNPVLPD                                                          CAS001
      *                                                                                       CAS001
     C                     MOVEL'D'       FSNPVM                                              CAS001
     C                     EXSR SRWNPV                                                        CAS001
      *                                                                                       CAS001
      ** Save fields in array                                                                 CAS001
      *                                                                                       CAS001
     C           BNNPVM    IFEQ 'D'                                                           CAS001
     C                     MOVELDSNPVS    WFLDS                                               CAS001
     C                     MOVEL*IN23     WIN23                                               CAS001
     C                     MOVEL*IN51     WIN51                                               CAS001
     C                     MOVEL*IN55     WIN55                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           ENDSRD    ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRWNPV - Initialize and Write Records to PF/DLNPVLPD         *                       CAS001
      *           Update master file with Unrealized P/L values.      *                       CAS001
      *                                                               *                       CAS001
      *  Called by: Main Processing                                   *                       CAS001
      *             SRREVF  SRREVB  SRREVD                            *                       CAS001
      *                                                               *                       CAS001
      *  Calls: None                                                  *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRWNPV    BEGSR                                                              CAS001
      *                                                                                       CAS001
      ** Move fields to PF/DLNPVLPD                                                           CAS001
      *                                                                                       CAS001
     C                     MOVELBRCA      FSBRCA                                              CAS001
     C                     MOVELPRFC      FSPRFC                                              CAS001
     C                     MOVELECCY      FSCYCD                                              CAS001
     C                     MOVELBOKC      FSBKCD                                              CAS001
     C                     Z-ADDEDAT      FSVDAT                                              CAS001
     C                     MOVELECNUM     FSCNUM                                              CAS001
     C                     MOVELDTYP      FSDTYP                                              CAS001
     C                     MOVELDLST      FSDLST                                              CAS001
     C                     MOVELCLAS      FSCLAS                                              CDL038
     C                     MOVELPNPYLD    FSYLDC                                              CAS001
     C                     Z-ADDA6SPRT    FSSPOT                                              CAS001
      *                                                                                       CAS001
     C           *IN12     IFEQ '1'                                                           CAS001
     C                     Z-ADD0         EDLNO                                               CAS001
     C                     ELSE                                                               CAS001
     C                     MOVEL*BLANKS   PREF                                                CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     MOVELPREF      FSPREF                                              CAS001
     C                     Z-ADDEDLNO     FSDLNO                                              CAS001
      *                                                                                       CAS001
      ** Use the other date values if *IN55 is 'ON'                                           CAS001
      *                                                                                       CAS001
     C           *IN55     IFEQ '0'                                                           CAS001
     C                     Z-ADDRATE      FSMRAT                                              CAS001
     C                     Z-ADDREVA      FSREVA                                              CAS001
     C                     Z-ADDWDSCF     FSDSCF                                              CAS001
     C                     ELSE                                                               CAS001
     C                     Z-ADDRATES     FSMRAT                                              CAS001
     C                     Z-ADDREVAS     FSREVA                                              CAS001
     C                     Z-ADDWDSCFS    FSDSCF                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Check sign of event amount if '+'                                                    CAS001
      *                                                                                       CAS001
     C           EAMSGN    IFEQ '-'                                                           CAS001
     C           *IN19     ANDEQ*OFF                                                          CAS001
     C           EAMT      IFGT 0                                                             CAS001
     C           EAMT      MULT -1        FSDAMT                                              CAS001
     C                     ELSE                                                               CAS001
     C                     Z-ADDEAMT      FSDAMT                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Event amount is '-'                                                                  CAS001
      *                                                                                       CAS001
     C                     ELSE                                                               CAS001
     C           EAMT      IFGE 0                                                             CAS001
     C                     Z-ADDEAMT      FSDAMT                                              CAS001
     C                     ELSE                                                               CAS001
     C           EAMT      MULT -1        FSDAMT                                              CAS001
     C                     ENDIF                                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     Z-ADDDBCE      FSEAMT                                              CAS001
     C           FSEAMT    IFGT 0                                                             CAS001
     C           FSEAMT    MULT -1        FSEAMT                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           *IN22     IFEQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C           *IN19     OREQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C           FSEAMT    MULT -1        FSEAMT                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           FSREVA    IFGT 0                                                             CAS001
     C           FSREVA    MULT -1        FSREVA                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           *IN22     IFEQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C           *IN19     OREQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C           FSREVA    MULT -1        FSREVA                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     Z-ADDPLAM      FSPRLA                                              CAS001
      *                                                                                       217120
     C           FSNPVM    IFEQ 'D'                                                           217120
     C                     Z-ADDPLAMD     FSPRLA                                              217120
     C                     ENDIF                                                              217120
      *                                                                                       217120
     C           FSNPVM    IFEQ 'B'                                                           217120
     C                     Z-ADDPLAMB     FSPRLA                                              217120
     C                     ENDIF                                                              217120
      *                                                                                       217120
     C           FSNPVM    IFEQ 'F'                                                           217120
     C                     Z-ADDPLAMF     FSPRLA                                              217120
     C                     ENDIF                                                              217120
      *                                                                                       217120
     C           *IN51     IFEQ *ON                                                           CAS001
     C           FSPRLA    ANDGT0                                                             CAS001
     C           *IN19     OREQ *ON                                                           CAS001
     C           FSPRLA    ANDGT0                                                             CAS001
     C                     MULT -1        FSPRLA                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           *IN23     IFEQ *ON                                                           CAS001
     C           FSPRLA    ANDLT0                                                             CAS001
     C           *IN16     OREQ *ON                                                           CAS001
     C           FSPRLA    ANDLT0                                                             CAS001
     C                     MULT -1        FSPRLA                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Initialize UNRL P/L as of Yearend to zero.                                           CAS001
      *                                                                                       CAS001
     C                     Z-ADD*ZERO     FSYUPL                                              CAS001
      *                                                                                       CAS004
      ** Update DEALSDB file with the unrealized P/L of the posting method                    CAS004
      *                                                                                       CAS004
     C           BNNPVM    IFEQ FSNPVM                                                        CAS004
     C           BNNPVM    ANDNE' '                                                           CAS004
     C           BNNPVM    OREQ ' '                                                           CAS004
     C           FSNPVM    ANDEQ'N'                                                           CAS004
      *                                                                                       CAS001
      ** If the transaction is NOT a FT payment:                                              CAS001
      *                                                                                       CAS001
     C           *IN12     IFEQ '0'                                                           CAS001
      *                                                                                       CAS001
      ** Update Deals File by outputting:                                                     CAS001
      ** 1. the value of previous unrealized P/L to both the                                  CAS001
      **    Unrealized P/L Today's Posting Amt & UNRL P/L Posted to Date.                     CAS001
      ** 2. the Revaluation Amount as the new Unrealized P/L Amount.                          CAS001
      *                                                                                       CAS001
     C           EDLNO     CHAINDLDLDBL1             13                                       CAS001
     C           *IN13     IFEQ *OFF                                                          CAS001
      *                                                                                       CAS001
     C           ETYP      IFEQ '20V1'                                                        CAS004
     C           ETYP      OREQ '20V2'                                                        CAS004
     C           ETYP      OREQ '11V1'                                                        CAS004
     C           ETYP      OREQ '11V2'                                                        CAS004
     C                     Z-ADD0         WPREV  150                                          CAS001
     C                     Z-ADDFSURPL    WPREV                                               CAS001
      *                                                                                       CAS004
     C           ECCY      IFNE BJCYCD                                                        CAS004
     C                     EXSR SRCONV                                                        CAS004
     C**********           Z-ADDZAMTCO    FSPRLA                                       CAS004 217120
     C                     Z-ADDZAMTCO    WKPRLA 130                                          217120
     C                     ELSE                                                               244711
     C                     Z-ADDFSPRLA    WKPRLA                                              244711
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C           ECCY      IFEQ PUCY                                                          CAS004
     C**********           Z-ADDFSREVA    FSURPL                                       CAS001 CAS004
     C**********           Z-ADDFSPRLA    FSURPL                                       CAS004 217120
     C                     Z-ADDWKPRLA    FSURPL                                              217120
     C                     ELSE                                                               CAS004
     C**********           Z-ADDFSPRLA    FSSUPL                                       CAS004 217120
     C                     Z-ADDWKPRLA    FSSUPL                                              217120
     C                     ENDIF                                                              CAS004
     C                     Z-ADDWPREV     FSTUPL                                              CAS001
     C                     Z-ADDWPREV     FSPUPL                                              CAS001
      *                                                                                       CAS001
     C                     UPDATDEALSBBF                                                      CAS001
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS001
      ** For FX, output UNRL P/L as of Yearend to DLNPVLPD                                    CAS001
      *                                                                                       CAS001
     C           ECCY      IFEQ PUCY                                                          CAS004
     C                     Z-ADDWMYUPL    FSYUPL                                              CAS001
     C                     ELSE                                                               CAS004
     C                     Z-ADDFSSYPL    FSYUPL                                              CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS001
     C                     WRITEDLNPVLD0                                                      CAS001
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRBCDF - Get Base Currency Discount Factor                   *                       CAS001
      *                                                               *                       CAS001
      *  Called by: SRREVB  SRREVD                                    *                       CAS001
      *                                                               *                       CAS001
      *  CALLS: SRDFC                                                 *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRBCDF    BEGSR                                                              CAS001
      *                                                                                       CAS001
      ** If NPV method is not "B" or "D", base currency yield curve is                        CAS001
      ** conditional and can be blank, as such discount factor is equal                       CAS001
      ** to 1.                                                                                CAS001
      *                                                                                       CAS001
     C           BNNPVM    IFEQ 'F'                                                           CAS001
     C           BNNPVM    OREQ 'N'                                                           CAS001
     C           BNNPVM    OREQ ' '                                                           CAS001
      *                                                                                       CAS001
     C           BNBCYC    IFEQ *BLANKS                                                       CAS001
     C                     Z-ADD1         PNPDF                                               CAS001
     C                     MOVELBNBCYC    PNPYLD                                              CAS001
     C                     MOVEL*BLANKS   PNPRTC                                              CAS001
     C                     GOTO ENDBDF                                                        CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     MOVELBNBCYC    PNPYLD                                              CAS001
     C                     MOVELBJCYCD    PNPCCY                                              CAS001
     C                     MOVELWBCICB    PNPINC                                              CAS001
      *                                                                                       CAS001
     C                     EXSR SRDFC                                                         CAS001
      *                                                                                       CAS001
     C           ENDBDF    ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRCREV - Calculate Revalued Amount for Method "F","B" & "D"  *                       CAS001
      *                                                               *                       CAS001
      *  Called by: SRREVF  SRREVB                                    *                       CAS001
      *                                                               *                       CAS001
      *  Calls: NONE                                                  *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRCREV    BEGSR                                                              CAS001
      *                                                                                       CAS001
     C           K         IFEQ 0                                                             CAS004
     C                     Z-ADD4         K                                                   CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C           A6MDIN    IFEQ 'D'                                                           CAS001
      *                                                                                       CAS001
     C           K         IFNE 1                                                             CAS001
     C           K         ANDNE2                                                             CAS001
     C           WKRATE    MULT POWER,K   WK159                                               CAS001
     C           WRKAMT    DIV  WK159     WNREV  309                                          CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           K         IFEQ 1                                                             CAS001
     C           WKRATE    MULT 100       RATE1                                               CAS001
     C           RATE1     MULT POWER,K   WK129                                               CAS001
     C           WRKAMT    DIV  WK129     WK309  309                                          CAS001
     C           WK309     MULT 100       WNREV                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           K         IFEQ 2                                                             CAS001
     C           WKRATE    MULT 10        RATE2                                               CAS001
     C           RATE2     MULT POWER,K   WK129                                               CAS001
     C           WRKAMT    DIV  WK129     WK309                                               CAS001
     C           WK309     MULT 10        WNREV                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ELSE                                                               CAS001
      *                                                                                       CAS001
     C           K         IFNE 6                                                             CAS001
     C           K         ANDNE7                                                             CAS001
     C           WKRATE    DIV  POWER,K   WK159                                               CAS001
     C           WRKAMT    MULT WK159     WNREV                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           K         IFEQ 7                                                             CAS001
     C           WKRATE    MULT 100       RATE1                                               CAS001
     C           RATE1     DIV  POWER,K   WK129                                               CAS001
     C           WRKAMT    MULT WK129     WNREV                                               CAS001
     C           WNREV     DIV  100       WNREV                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           K         IFEQ 6                                                             CAS001
     C           WKRATE    MULT 10        RATE2                                               CAS001
     C           RATE2     DIV  POWER,K   WK129                                               CAS001
     C           WRKAMT    MULT WK129     WNREV                                               CAS001
     C           WNREV     DIV  10        WNREV                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRPRH1 - Print Header Details                                *                       CAS001
      *                                                               *                       CAS001
      *  Called by: EXCEPT  SRCHKL                                    *                       CAS001
      *                                                               *                       CAS001
      *  Calls: None                                                  *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRPRH1    BEGSR                                                              CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C           WP3CHK    IFEQ ' '                                                           CAS001
     C                     OPEN DL0410P3                                                      CAS001
     C                     MOVELSFNUM3    ZSNUM   60                                          CAS001
     C                     MOVELSFILE3    ZFILE  10                                           CAS001
     C                     EXSR SRRCF                                                         CAS001
     C                     MOVEL'Y'       WP3CHK  1                                           CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C           WP4CHK    IFEQ ' '                                                           CAS001
     C                     OPEN DL0410P4                                                      CAS001
     C                     MOVELSFNUM4    ZSNUM                                               CAS001
     C                     MOVELSFILE4    ZFILE                                               CAS001
     C                     EXSR SRRCF                                                         CAS001
     C                     MOVEL'Y'       WP4CHK  1                                           CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C           WP5CHK    IFEQ ' '                                                           CAS001
     C                     OPEN DL0410P5                                                      CAS001
     C                     MOVELSFNUM5    ZSNUM                                               CAS001
     C                     MOVELSFILE5    ZFILE                                               CAS001
     C                     EXSR SRRCF                                                         CAS001
     C                     MOVEL'Y'       WP5CHK  1                                           CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
     C                     MOVELBRCA      RBRCA                                               CAS001
     C                     MOVELA8BRNM    RBRNM                                               CAS001
      *                                                                                       CAS001
     C           WNREC     IFEQ 'Y'                                                           CAS001
      *                                                                                       CAS001
     C                     MOVELECCY      RECCY                                               CAS001
     C                     MOVELBOKC      RBOKC                                               CAS001
     C                     MOVELBDBKD     RDBKD                                               CAS001
      *                                                                                       CAS001
     C           *IN32     IFEQ *ON                                                           CAS001
     C                     MOVELDTYP      RDTYP1                                              CAS001
     C                     MOVELDTPNAR    RDTNAR                                              CAS001
     C                     MOVELDLST      RDLST1                                              CAS001
     C                     MOVELCLAS      RCLAS1                                              CDL038
     C                     MOVELDSTCNR    RDSNAR                                              CDL038
     C*********************MOVELASDSTN    RDSNAR                                       CAS001 CDL038
     C                     ELSE                                                               CAS001
     C                     MOVE *BLANKS   RDTYP1                                              CAS001
     C                     MOVE *BLANKS   RDTNAR                                              CAS001
     C                     MOVE *BLANKS   RDLST1                                              CAS001
     C                     MOVE *BLANKS   RCLAS1                                              CDL038
     C                     MOVE *BLANKS   RDSNAR                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C                     WRITEHEADP3H1                                                      CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C                     WRITEHEADP4H1                                                      CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C                     WRITEHEADP5H1                                                      CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRPRD1 - Print Detail Record format 1                        *                       CAS001
      *                                                               *                       CAS001
      *  Called by: Main Processing                                   *                       CAS001
      *                                                               *                       CAS001
      *  Calls: ZSEDIT  SRCHKL                                        *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRPRD1    BEGSR                                                              CAS001
      *                                                                                       CAS001
     C           WDSCH     IFEQ 'Y'                                                           CAS001
     C           WBKCH     OREQ 'Y'                                                           CAS001
     C           WCYCH     OREQ 'Y'                                                           CAS001
     C                     MOVE 'Y'       WNREC                                               CAS001
     C                     EXSR SRPRH1                                                        CAS001
     C                     MOVE 'N'       WDSCH                                               CAS001
     C                     MOVE 'N'       WBKCH                                               CAS001
     C                     MOVE 'N'       WCYCH                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Value Date                                                                           CAS001
      *                                                                                       CAS001
     C                     MOVELEDATA     RVDAT                                               CAS001
      *                                                                                       CAS001
      ** Customer Number                                                                      CAS001
      *                                                                                       CAS001
     C                     MOVELECNUM     RCNUM                                               CAS001
      *                                                                                       CAS001
      ** Deal Number / Payment Reference                                                      CAS001
      *                                                                                       CAS001
     C           *IN02     IFEQ *ON                                                           CAS001
     C                     MOVELEDLNO     RDLNO                                               CAS001
     C                     ELSE                                                               CAS001
     C                     MOVELPREF      RDLNO                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Deal Type / Subtype                                                                  CAS001
      *                                                                                       CAS001
     C           *IN32     IFEQ *OFF                                                          CAS001
     C                     MOVELDTYP      RDTYP2                                              CAS001
     C                     MOVELDLST      RDLST2                                              CAS001
     C                     MOVELCLAS      RCLAS2                                              CDL038
     C                     ELSE                                                               CAS001
     C                     MOVE *BLANKS   RDTYP2                                              CAS001
     C                     MOVE *BLANKS   RDLST2                                              CAS001
     C                     MOVE *BLANKS   RCLAS2                                              CDL038
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Event Amount                                                                         CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDEAMT      ZFLD15                                              CAS001
     C           EAMSGN    IFEQ '-'                                                           CAS001
     C           *IN19     ANDEQ*OFF                                                          CAS001
     C           EAMT      IFGT 0                                                             CAS001
     C           EAMT      MULT -1        ZFLD15                                              CAS001
     C                     ELSE                                                               CAS001
     C                     Z-ADDEAMT      ZFLD15                                              CAS001
     C                     ENDIF                                                              CAS001
     C                     ELSE                                                               CAS001
     C           EAMT      IFGE 0                                                             CAS001
     C                     Z-ADDEAMT      ZFLD15                                              CAS001
     C                     ELSE                                                               CAS001
     C           EAMT      MULT -1        ZFLD15                                              CAS001
     C                     ENDIF                                                              CAS001
     C                     ENDIF                                                              CAS001
     C                     Z-ADDWECDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    REAMT                                               CAS001
      *                                                                                       CAS001
      ** Dealt Equivalent                                                                     CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDDBCE      ZFLD15                                              CAS001
     C           DBCE      IFGT 0                                                             CAS001
     C           DBCE      MULT -1        ZFLD15                                              CAS001
     C                     ENDIF                                                              CAS001
     C           *IN22     IFEQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C           *IN19     OREQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C********** DBCE      MULT -1        ZFLD15                                       CAS001 219336
     C           ZFLD15    MULT -1        ZFLD15                                              219336
     C                     ENDIF                                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RDBCE                                               CAS001
      *                                                                                       CAS001
      ** Yield Curve                                                                          CAS001
      *                                                                                       CAS001
     C                     MOVELFSYLDC    RYLDC                                               CAS001
      *                                                                                       CAS001
      ** Mid-Rate                                                                             CAS001
      *                                                                                       CAS001
     C           *IN55     IFEQ *ON                                                           CAS001
     C                     MOVE RATES     RMRAT                                               CAS001
     C                     ELSE                                                               CAS001
     C                     MOVE RATE      RMRAT                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Discount Factor                                                                      CAS001
      *                                                                                       CAS001
     C           *IN55     IFEQ *ON                                                           CAS001
     C                     MOVE WDSCFS    RDSCF                                               CAS001
     C                     ELSE                                                               CAS001
     C                     MOVE WDSCF     RDSCF                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Revalued Equivalent                                                                  CAS001
      *                                                                                       CAS001
     C           *IN55     IFEQ *ON                                                           CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDREVAS     ZFLD15                                              CAS001
     C           REVAS     IFGT 0                                                             CAS001
     C           REVAS     MULT -1        ZFLD15                                              CAS001
     C                     ENDIF                                                              CAS001
     C           *IN22     IFEQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C           *IN19     OREQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C********** REVAS     MULT -1        ZFLD15                                       CAS001 219336
     C           ZFLD15    MULT -1        ZFLD15                                              219336
     C                     ENDIF                                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RREVA                                               CAS001
      *                                                                                       CAS001
     C                     ELSE                                                               CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDREVA      ZFLD15                                              CAS001
     C           REVA      IFGT 0                                                             CAS001
     C           REVA      MULT -1        ZFLD15                                              CAS001
     C                     ENDIF                                                              CAS001
     C           *IN22     IFEQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C           *IN19     OREQ *ON                                                           CAS001
     C           *IN33     ANDEQ*OFF                                                          CAS001
     C********** REVA      MULT -1        ZFLD15                                       CAS001 219336
     C           ZFLD15    MULT -1        ZFLD15                                              219336
     C                     ENDIF                                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RREVA                                               CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
      ** Profit and Loss Amount                                                               CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     SELEC                                                              217120
     C           BNNPVM    WHEQ 'N'                                                           217120
     C           BNNPVM    OREQ ' '                                                           217120
     C                     Z-ADDPLAM      ZFLD15                                              CAS001
     C           *IN51     IFEQ *ON                                                           CAS001
     C           PLAM      ANDGT0                                                             CAS001
     C           *IN19     OREQ *ON                                                           CAS001
     C           PLAM      ANDGT0                                                             CAS001
     C                     MULT -1        ZFLD15                                              CAS001
     C                     ENDIF                                                              CAS001
     C           *IN23     IFEQ *ON                                                           CAS001
     C           PLAM      ANDLT0                                                             CAS001
     C           *IN16     OREQ *ON                                                           CAS001
     C           PLAM      ANDLT0                                                             CAS001
     C                     MULT -1        ZFLD15                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       217120
     C           BNNPVM    WHEQ 'D'                                                           217120
     C                     Z-ADDPLAMD     ZFLD15                                              217120
     C           *IN51     IFEQ *ON                                                           217120
     C           PLAMD     ANDGT0                                                             217120
     C           *IN19     OREQ *ON                                                           217120
     C           PLAMD     ANDGT0                                                             217120
     C                     MULT -1        ZFLD15                                              217120
     C                     ENDIF                                                              217120
     C           *IN23     IFEQ *ON                                                           217120
     C           PLAMD     ANDLT0                                                             217120
     C           *IN16     OREQ *ON                                                           217120
     C           PLAMD     ANDLT0                                                             217120
     C                     MULT -1        ZFLD15                                              217120
     C                     ENDIF                                                              217120
      *                                                                                       217120
     C           BNNPVM    WHEQ 'B'                                                           217120
     C                     Z-ADDPLAMB     ZFLD15                                              217120
     C           *IN51     IFEQ *ON                                                           217120
     C           PLAMB     ANDGT0                                                             217120
     C           *IN19     OREQ *ON                                                           217120
     C           PLAMB     ANDGT0                                                             217120
     C                     MULT -1        ZFLD15                                              217120
     C                     ENDIF                                                              217120
     C           *IN23     IFEQ *ON                                                           217120
     C           PLAMB     ANDLT0                                                             217120
     C           *IN16     OREQ *ON                                                           217120
     C           PLAMB     ANDLT0                                                             217120
     C                     MULT -1        ZFLD15                                              217120
     C                     ENDIF                                                              217120
      *                                                                                       217120
     C           BNNPVM    WHEQ 'F'                                                           217120
     C                     Z-ADDPLAMF     ZFLD15                                              217120
     C           *IN51     IFEQ *ON                                                           217120
     C           PLAMF     ANDGT0                                                             217120
     C           *IN19     OREQ *ON                                                           217120
     C           PLAMF     ANDGT0                                                             217120
     C                     MULT -1        ZFLD15                                              217120
     C                     ENDIF                                                              217120
     C           *IN23     IFEQ *ON                                                           217120
     C           PLAMF     ANDLT0                                                             217120
     C           *IN16     OREQ *ON                                                           217120
     C           PLAMF     ANDLT0                                                             217120
     C                     MULT -1        ZFLD15                                              217120
     C                     ENDIF                                                              217120
     C                     ENDSL                                                              217120
      *                                                                                       217120
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RPLAM                                               CAS001
      *                                                                                       CAS001
      ** Check that sufficient lines remain for the Format. If not,                           CAS001
      ** write out the Main Headings on a new page.                                           CAS001
      *                                                                                       CAS001
     C                     Z-ADD2         WRQDLN  30                                          CAS001
     C                     EXSR SRCHKL                                                        CAS001
      *                                                                                       CAS001
      ** Select which Record Format to Write by NPV                                           CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C                     WRITEDETLP3D1                                                      CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C                     WRITEDETLP4D1                                                      CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C                     WRITEDETLP5D1                                                      CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       219334
      ** Set on an indicator when details are reported for DL0410P3,                          219334
      ** DL0410P4 or DL0410P5.                                                                219334
      *                                                                                       219334
     C                     MOVE *ON       *IN05                                               219334
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRPRD2 - Print Detail Record format 2 - Monthly Calculation  *                       CAS001
      *                                                               *                       CAS001
      *  Called by: EXCEPT                                            *                       CAS001
      *                                                               *                       CAS001
      *  Calls: ZSEDIT  SRCHKL                                        *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRPRD2    BEGSR                                                              CAS001
      *                                                                                       CAS001
      ** Monthly Event Amount                                                                 CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDMEAMT     ZFLD15                                              CAS001
     C                     Z-ADDWECDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RMEAMT                                              CAS001
      *                                                                                       CAS001
      ** Monthly Dealt Equivalent                                                             CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDMDBCE     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RMDBCE                                              CAS001
      *                                                                                       CAS001
      ** Monthly Revalued Equivalent                                                          CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDMREVA     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RMREVA                                              CAS001
      *                                                                                       CAS001
      ** Monthly Profit and Loss Amount                                                       CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDMPLAM     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RMPLAM                                              CAS001
      *                                                                                       CAS001
      ** Check that sufficient lines remain for the Format. If not,                           CAS001
      ** write out the Main Headings on a new page.                                           CAS001
      *                                                                                       CAS001
     C                     Z-ADD4         WRQDLN                                              CAS001
     C                     EXSR SRCHKL                                                        CAS001
      *                                                                                       CAS001
      ** Select which Record Format to Write by NPV                                           CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C                     WRITEDETLP3D2                                                      CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C                     WRITEDETLP4D2                                                      CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C                     WRITEDETLP5D2                                                      CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
      ** Reset monthly values                                                                 CAS001
      *                                                                                       CAS001
     C                     Z-ADD0         MEAMT                                               CAS001
     C                     Z-ADD0         MDBCE                                               CAS001
     C                     Z-ADD0         MREVA                                               CAS001
     C                     Z-ADD0         MPLAM                                               CAS001
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRPRD3 - Print Detail Record format 3 - Annual Calculation   *                       CAS001
      *                                                               *                       CAS001
      *  Called by: EXCEPT                                            *                       CAS001
      *                                                               *                       CAS001
      *  Calls: ZSEDIT  SRCHKL                                        *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRPRD3    BEGSR                                                              CAS001
      *                                                                                       CAS001
      ** Annual Event Amount                                                                  CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDYEAMT     ZFLD15                                              CAS001
     C                     Z-ADDWECDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RYEAMT                                              CAS001
      *                                                                                       CAS001
      ** Annual Dealt Equivalent                                                              CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDYDBCE     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RYDBCE                                              CAS001
      *                                                                                       CAS001
      ** Annual Revalued Equivalent                                                           CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDYREVA     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RYREVA                                              CAS001
      *                                                                                       CAS001
      ** Annual Profit and Loss Amount                                                        CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDYPLAM     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RYPLAM                                              CAS001
      *                                                                                       CAS001
      ** Check that sufficient lines remain for the Format. If not,                           CAS001
      ** write out the Main Headings on a new page.                                           CAS001
      *                                                                                       CAS001
     C                     Z-ADD3         WRQDLN                                              CAS001
     C                     EXSR SRCHKL                                                        CAS001
      *                                                                                       CAS001
      ** Select which Record Format to Write by NPV                                           CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C                     WRITEDETLP3D3                                                      CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C                     WRITEDETLP4D3                                                      CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C                     WRITEDETLP5D3                                                      CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
      ** Reset Annual values                                                                  CAS001
      *                                                                                       CAS001
     C                     Z-ADD0         YEAMT                                               CAS001
     C                     Z-ADD0         YDBCE                                               CAS001
     C                     Z-ADD0         YREVA                                               CAS001
     C                     Z-ADD0         YPLAM                                               CAS001
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRPRD4 - Print Detail Record format 4 - Total Calculation    *                       CAS001
      *                                                               *                       CAS001
      *  Called by: Main Processing                                   *                       CAS001
      *                                                               *                       CAS001
      *  Calls: ZSEDIT  SRCHKL                                        *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRPRD4    BEGSR                                                              CAS001
      *                                                                                       CAS001
      ** Total Event Amount                                                                   CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDTEAMT     ZFLD15                                              CAS001
     C                     Z-ADDWECDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RTEAMT                                              CAS001
      *                                                                                       CAS001
      ** Total Dealt Equivalent                                                               CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDTDBCE     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RTDBCE                                              CAS001
      *                                                                                       CAS001
      ** Total Revalued Equivalent                                                            CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDTREVA     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RTREVA                                              CAS001
      *                                                                                       CAS001
      ** Total Profit Amount                                                                  CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDTPROF     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RTPROF                                              CAS001
      *                                                                                       CAS001
      ** Total Loss Amount                                                                    CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDTLOSS     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RTLOSS                                              CAS001
      *                                                                                       CAS001
      ** Total Profit and Loss Amount                                                         CAS001
      *                                                                                       CAS001
     C                     MOVE *BLANKS   ZFLD15                                              CAS001
     C                     Z-ADDTOTPL     ZFLD15                                              CAS001
     C                     Z-ADDBCCDP     ZDECS                                               CAS001
     C                     MOVE 'J'       ZECODE                                              CAS001
     C                     EXSR ZSEDIT                                                        CAS001
     C                     MOVE ZOUT21    RTPLAM                                              CAS001
      *                                                                                       CAS001
      ** Check that sufficient lines remain for the Format. If not,                           CAS001
      ** write out the Main Headings on a new page.                                           CAS001
      *                                                                                       CAS001
     C                     Z-ADD7         WRQDLN                                              CAS001
     C                     EXSR SRCHKL                                                        CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C                     WRITEDETLP3D4                                                      CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C                     WRITEDETLP4D4                                                      CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C                     WRITEDETLP5D4                                                      CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
      ** Reset Total values                                                                   CAS001
      *                                                                                       CAS001
     C                     Z-ADD0         TEAMT                                               CAS001
     C                     Z-ADD0         TDBCE                                               CAS001
     C                     Z-ADD0         TREVA                                               CAS001
     C                     Z-ADD0         TPROF                                               CAS001
     C                     Z-ADD0         TLOSS                                               CAS001
     C                     Z-ADD0         TOTPL                                               CAS001
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRPRT1 - Print End of Report                                 *                       CAS001
      *                                                               *                       CAS001
      *  Called by: Main Processing                                   *                       CAS001
      *                                                               *                       CAS001
      *  Calls: SRCHKL                                                *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRPRT1    BEGSR                                                              CAS001
      *                                                                                       CAS001
      ** Check that sufficient lines remain for the Format. If not,                           CAS001
      ** write out the Main Headings on a new page.                                           CAS001
      *                                                                                       CAS001
     C                     Z-ADD4         WRQDLN                                              CAS001
     C                     EXSR SRCHKL                                                        CAS001
      *                                                                                       CAS001
      ** Select which Record Format to Write by NPV                                           CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C                     WRITETRALP3T1                                                      CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C                     WRITETRALP4T1                                                      CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C                     WRITETRALP5T1                                                      CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
     C           BRNCH     IFNE 'ALL'                                                         CAS001
     C                     MOVE 'Y'       WFNPRT                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRCHKL - Check Available Space of Report                     *                       CAS001
      *                                                               *                       CAS001
      *  Called by: SRPRD1  SRPRD2  SRPRD3  SRPRD4  SRPRT1            *                       CAS001
      *                                                               *                       CAS001
      *  Calls: SRPRH1                                                *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRCHKL    BEGSR                                                              CAS001
      *                                                                                       CAS001
      ** Check if there are sufficient lines to print                                         CAS001
      *                                                                                       CAS001
     C                     SELEC                                                              CAS001
     C           BNNPVM    WHEQ 'F'                                                           CAS001
     C           OFLLN3    SUB  PRTLN3    WDIFLN  30                                          CAS001
     C           BNNPVM    WHEQ 'B'                                                           CAS001
     C           OFLLN4    SUB  PRTLN4    WDIFLN                                              CAS001
     C           BNNPVM    WHEQ 'D'                                                           CAS001
     C           OFLLN5    SUB  PRTLN5    WDIFLN                                              CAS001
     C                     ENDSL                                                              CAS001
      *                                                                                       CAS001
      ** If lines are not sufficient print out header for a new a page.                       CAS001
      *                                                                                       CAS001
     C           WDIFLN    IFLE WRQDLN                                                        CAS001
      *                                                                                       CAS001
     C           WPAS1     IFNE 'Y'                                                           CAS001
     C                     MOVE 'N'       WNREC                                               CAS001
     C                     ELSE                                                               CAS001
     C                     MOVE 'N'       WPAS1                                               CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     EXSR SRPRH1                                                        CAS001
      *                                                                                       CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRRCF - Register New Printer Files via RCF                   *                       CAS001
      *                                                               *                       CAS001
      *  Called by: Main Processing                                   *                       CAS001
      *                                                               *                       CAS001
      *  Calls: NONE                                                  *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRRCF     BEGSR                                                              CAS001
      *                                                                                       CAS001
      ** Ensure Report Spool File recorded by RCF                                             CAS001
      *                                                                                       CAS001
     C                     CALL 'ZSFILE'                                                      CAS001
     C                     PARM           SEQ                                                 CAS001
     C                     PARM BRCA      @PARM                                               CAS001
     C                     PARM           ZFILE                                               CAS001
     C                     PARM           ZSNUM                                               CAS001
     C                     PARM *BLANK    ZSERR                                               CAS001
      *                                                                                       CAS001
      ** Error during ZSFILE processing, return to calling program                            CAS001
      *                                                                                       CAS001
     C           ZSERR     IFEQ 'Y'                                                           CAS001
     C                     MOVE *ON       *INU7                                               CAS001
     C                     MOVE *ON       *INU8                                               CAS001
     C                     MOVE *ON       *INLR                                               CAS001
     C                     RETRN                                                              CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
     C/EJECT                                                                                  CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS001
      *  SRDFC - Discount Factor Calculation                          *                       CAS001
      *                                                               *                       CAS001
      *  Called by: SRREVF  SRBCDF                                    *                       CAS001
      *                                                               *                       CAS001
      *  Calls: NONE                                                  *                       CAS001
      *                                                               *                       CAS001
      *****************************************************************                       CAS001
      *                                                                                       CAS001
     C           SRDFC     BEGSR                                                              CAS001
      *                                                                                       CAS001
     C                     CALL 'ZADSFCAL'                                                    CAS001
     C                     PARM *BLANKS   PNRTCD  7                                           CAS001
     C                     PARM           PNPRTC  5                                           CAS001
     C                     PARM           PNPYLD  5                                           CAS001
     C                     PARM           PNPCCY  3                                           CAS001
     C                     PARM           PNPINC  1                                           CAS001
     C                     PARM           PNPFDT  50                                          CAS001
     C                     PARM *ZERO     PNPDF  139                                          CAS001
      *                                                                                       CAS001
     C                     MOVEL'0'       *IN30                                               225831
      *                                                                                       225831
     C           PNRTCD    IFEQ '*NRF'                                                        225831
     C                     MOVEL'1'       *IN30                                               225831
     C                     ELSE                                                               225831
      *                                                                                       225831
     C           PNRTCD    IFNE *BLANKS                                                       CAS001
     C                     MOVEL'SDYLDRL2'DBFILE                                              CAS001
     C                     MOVEL'15'      DBASE                                               CAS001
     C                     MOVEL*BLANKS   DBOPTN                                              CAS001
     C                     GOTO ERROR                                                         CAS001
     C                     ENDIF                                                              CAS001
      *                                                                                       225831
     C                     ENDIF                                                              225831
      *                                                                                       CAS001
     C                     ENDSR                                                              CAS001
      *                                                                                       CAS001
      *****************************************************************                       CAS001
      *                                                               *                       CAS004
      * SRCONV - Subroutine that convert amounts to another currency  *                       CAS004
      *                                                               *                       CAS004
      *****************************************************************                       CAS004
      *                                                                                       CAS004
     C           SRCONV    BEGSR                                                              CAS004
     C                     Z-ADDBCCDP     ZCDPI                                               CAS004
     C                     Z-ADDWECDP     ZCDPO                                               CAS004
     C                     Z-ADDFSPRLA    ZAMTCI                                              CAS004
     C                     MOVELA6MDIN    ZMD                                                 CAS004
     C                     Z-ADDA6SPRT    ZEXCH                                               CAS004
     C                     EXSR ZCONVN                                                        CAS004
      *                                                                                       CAS004
     C                     ENDSR                                                              CAS004
      ********************************************************************                    CAS004
      *                                                                   CEU011
     C/COPY ZSRSRC,ZSEDITZ3                                               CEU011
     C/EJECT                                                              139778
     C/COPY ZSRSRC,ZCONVNZ1                                               139778
     C/EJECT                                                              139778
     C/COPY WNCPYSRC,DL0410C082
0955 ODL0410P1D  203   02 21 28                                           S01124
     O*******AND       37                                                              S01117 CAS001
     O       AND       37 09                                                                  CAS001
0956 O*******OR  203   OF                                                 S01117
     O*******OR**203***OF*37***                                    S01117 LN0816
     O*******OR**203   OF 37NL2                                     LN0816E27018
     O*******AND******NL1                                           LN0816E27018
     O*******OR  203   OF 37                                                           E27018 CAS001
     O       OR  203   OF 37 09                                                               CAS001
     O/COPY WNCPYSRC,DL0410O014
     O       OR  203   12 21 28                                           S03220
     O       AND       09                                                                     CAS001
     O/COPY WNCPYSRC,DL0410O015
0957 O*******                            22 'REFERENCE DL0410'            S01117
0957 O                                   24 'REFERENCE DL0410P1'          S01117
0958 O**********                         TITL      89                     S01194
0958 O                         BJURPT    89                               S01194
0959 O                                  104 'DATE'
0960 O**********                         RUNA     112                     S01194
0960 O                         BJMRDT   112                               S01194
0961 O                                  122 'PAGE'
0962 O                         PAGE  Z  127
0963 O        D  1     02 21 28
     O*******AND       37                                                              S01117 CAS001
     O       AND       37 09                                                                  CAS001
0964 O*******OR  1     OF                                                 S01117
     O*******OR**1*****OF*37****                                   S01117 LN0816
     O*******OR**1     OF 37NL2                                     LN0816E27018
     O*******AND******NL1                                           LN0816E27018
     O*******OR  1     OF 37                                                           E27018 CAS001
     O       OR  1     OF 37 09                                                               CAS001
     O/COPY WNCPYSRC,DL0410O016
     O       OR  1     12 21 28                                           S03220
     O       AND       09                                                                     CAS001
     O/COPY WNCPYSRC,DL0410O017
0965 O                                   64 'REVALUATION OF FORWARD '
0966 O                                   78 'COMMITMENTS  -'
0967 O                         ECCY      83
0968 O        D  2     02 21 28
     O*******AND       37                                                              S01117 CAS001
     O       AND       37 09                                                                  CAS001
0964 O*******OR  2     OF                                                 S01117
     O*******OR**2*****OF*37***                                    S01117 LN0816
     O*******OR  2     OF 37NL2                                     LN0816E27018
     O*******AND******NL1                                           LN0816E27018
     O*******OR  2     OF 37                                                           E27018 CAS001
     O       OR  2     OF 37 09                                                               CAS001
     O/COPY WNCPYSRC,DL0410O018
     O       OR  2     12 21 28                                           S03220
     O       AND       09                                                                     CAS001
     O/COPY WNCPYSRC,DL0410O019
0970 O                                   65 '------------------------'
0971 O                                   83 '------------------'
     O        D  2     02 21 28                                           S01117
     O*******AND       37                                                              S01117 CAS001
     O       AND       37 09                                                                  CAS001
     O*******OR**2*****OF*37***                                    S01117 LN0816
     O*******OR**2     OF 37NL2                                     LN0816E27018
     O*******AND******NL1                                           LN0816E27018
     O*******OR  2     OF 37                                                           E27018 CAS001
     O       OR  2     OF 37 09                                                               CAS001
     O       OR  2     12 21 28                                                             AR828127
     O       AND       09                                                                   AR828127
     O************************           12 'BRANCH'                S01117E148
     O************************ BRCA      16                         S01117E148
     O**********               BRNM      48                         S01177S01194
     O*************************A8BNTX    48                         S01194E148
     O                N85                12 'BRANCH'                      E148
     O                N85      BRCA      16                               E148
     O                N85      A8BRNM    48                               E148
      *                                                                                       CAS001
     O        D  2     02 21 28                                                               CAS001
     O       AND       37 09 06                                                               CAS001
     O       OR  2     OF 37 09                                                               CAS001
     O       AND       06                                                                     CAS001
     O                                   15 'BOOK CODE'                                       CAS001
     O                         BOKC      18                                                   CAS001
     O                         BDBKD     50                                                   CAS001
      *                                                                                       CAS001
     O/COPY WNCPYSRC,DL0410O026
     O        D  1     02 21 28                                           S01328
     O*******AND       37 32                                                           S01328 CAS001
     O       AND       37 32 09                                                               CAS001
     O       OR  1     OF 37NL2                                           S01328
     O*******AND      NL1 32                                                           S01328 CAS001
     O       AND      NL1 32 09                                                               CAS001
     O                                   15 'DEAL TYPE'                   S01328
     O                         DTYP      19                               S01328
     O                         DTPNAR    55                               S01328
     O        D  2     02 21 28                                           S01328
     O*******AND       37 32                                                           S01328 CAS001
     O       AND       37 32 09                                                               CAS001
     O       OR  2     OF 37NL2                                           S01328
     O*******AND      NL1 32                                                           S01328 CAS001
     O       AND      NL1 32 09                                                               CAS001
     O                                   14 'SUB TYPE'                    S01328
     O                         DLST      19                               S01328
     O                         CLAS      23                               CDL038
     O                         DSTCNR    59                               CDL038
     O*************************ASDSTN    50                        S01328 CDL038
     O/COPY WNCPYSRC,DL0410O009
0972 O        D  1     02 21 28
0973 O*******OR  1     OF                                                 S01117
     O*******AND       37                                                              S01117 CAS001
     O       AND       37 09                                                                  CAS001
     O*******OR**1*****OF*37***                                    S01117 LN0816
     O*******OR**1     OF 37NL2                                     LN0816E27018
     O*******AND******NL1                                           LN0816E27018
     O*******OR  1     OF 37                                                           E27018 CAS001
     O       OR  1     OF 37 09                                                               CAS001
     O*******AND*******37****                                      S01117 LN0816
     O*******OR**2*****OF*37***                                    S01117 LN0816
     O*******OR**2     OF 37NL2                                     LN0816E27018
     O*******AND******NL1                                           LN0816E27018
     O*******OR  2     OF 37                                                           E27018 CAS001
     O       OR  2     OF 37 09                                                               CAS001
     O/COPY WNCPYSRC,DL0410O020
     O       OR  1     12 21 28                                           S03220
     O       AND       09                                                                     CAS001
     O/COPY WNCPYSRC,DL0410O001
0974 O                                   24 'VALUE  CUSTOMER   DEAL'
0975 O***********************************33 'DEAL'                        S01328
0975 O                N32                33 'DEAL'                        S01328
0976 O                                   71 'DEALT'
0977 O                                  124 'REVALUED          PROFIT'
     O/COPY WNCPYSRC,DL0410O010
     O                 17               132 'PROF'                        CAC001
0978 O        D  2     02 21 28
0979 O*******OR  2     OF                                                 S01117
     O*******AND       37                                                              S01117 CAS001
     O       AND       37 09                                                                  CAS001
     O*******OR**2*****OF*37***                                    S01117 LN0816
     O*******OR**2     OF 37NL2                                     LN0816E27018
     O*******AND******NL1                                           LN0816E27018
     O*******OR  2     OF 37                                                           E27018 CAS001
     O       OR  2     OF 37 09                                                               CAS001
     O/COPY WNCPYSRC,DL0410O021
     O       OR  2     12 21 28                                           S03220
     O       AND       09                                                                     CAS001
     O/COPY WNCPYSRC,DL0410O022
0980 O                                   25 'DATE   NUMBER   NUMBER'
0981 O***********************************33 'TYPE'                        S01328
0981 O                N32                33 'TYPE'                        S01328
0982 O                                   53 'AMOUNT'
0983 O                                   85 'EQUIVALENT    MID-RATE'
0984 O                                  109 'EQUIVALENT'
0985 O                                  126 '/LOSS'
     O                 17               132 'CENT'                        CAC001
     O/COPY WNCPYSRC,DL0410O005
0986 O********D  1     02 21                                              S01117
     O        D  1     02 21 37                                           S01117
     O       AND       09                                                                     CAS001
     O/COPY WNCPYSRC,DL0410O023
     O*******OR  1     12 21                                                           S03220 CAS001
     O       OR  1     12 21 09                                                               CAS001
     O/COPY WNCPYSRC,DL0410O024
0987 O***                      EDATA      8                               S1107
0987 O*********       N55      EDATA      8                       S1107   E15224
0987 O*********        55      ODATA      8                       S1107   E15224
     O                         EDATA      8                               E15224
0988 O                         ECNUM     16
0989 O**                       EDLNO     25                               S03220
0990 O**                       DTYP      30                               S03220
0991 O**                                 31 '-'                           S03220
0992 O**                       DLST      33                               S03220
0989 O                 02      EDLNO     25                               S03220
0990 O*****************02      DTYP      30                        S03220 S01328
0991 O*****************02                31 '-'                    S03220 S01328
0992 O*****************02      DLST      33                        S03220 S01328
0990 O                 02N32   DTYP      30                               S01328
0991 O                 02N32             31 '-'                           S01328
0992 O                 02N32   DLST      33                               S01328
     O/COPY WNCPYSRC,DL0410O025
0992 O                 12      PREF      34                               S03220
     O/COPY WNCPYSRC,DL0410O003
0993 O                 70      EAMT      53 ' ,   ,   ,   , 0 '
0994 O                 71      EAMT      53 '   ,   ,   , 0 . '
0995 O                 72      EAMT      53 '  ,   ,   , 0 .  '
0996 O                 73      EAMT      53 ' ,   ,   , 0 .   '
0996 O                         EAMSGN    54                               S01119
0998 O                 19                54 '+'                           158840
0997 O***                                54 '-'                           S01119
0998 O***              22                54 '+'                           S01119
0998 O**               33                54 '+'
0998 O***              33                54 '-'                           S01119
     O                 02N32   CLAS      37                               CDL038
     O                 60      DBCE      73 ' ,   ,   ,   , 0 '
1000 O                 61      DBCE      73 '   ,   ,   , 0 . '
1001 O                 62      DBCE      73 '  ,   ,   , 0 .  '
1002 O                 63      DBCE      73 ' ,   ,   , 0 .   '
     O                                   74 '-'                           S01303
     O                 22                74 '+'                           S01303
     O                 19                74 '+'                           158840
     O                 33                74 '-'                           S01303
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0410OOP1                                           S01408
     O*                                                                   S01408
1003 O*************            RATE      89 '  0 .        '               138010
     O*************    55      RATES     89 '  0 .        '         S1107 138010
1003 O                         RATE      89 '   0 .        '              138010
     O                 55      RATES     89 '   0 .        '              138010
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0410OOP2                                           S01408
     O*                                                                   S01408
1004 O*************    60      REVA     109 ' ,   ,   ,   , 0 '           S1107
1005 O*************    61      REVA     109 '   ,   ,   , 0 . '           S1107
1006 O*************    62      REVA     109 '  ,   ,   , 0 .  '           S1107
1007 O*************    63      REVA     109 ' ,   ,   , 0 .   '           S1107
1004 O*************    60N55   REVA     109 ' ,   ,   ,   , 0 '    S1107  E10953
1005 O*************    61N55   REVA     109 '   ,   ,   , 0 . '    S1107  E10953
1006 O*************    62N55   REVA     109 '  ,   ,   , 0 .  '    S1107  E10953
1007 O*************    63N55   REVA     109 ' ,   ,   , 0 .   '    S1107  E10953
1004 O*************    60 55   REVAS    109 ' ,   ,   ,   , 0 '    S1107  E10953
1005 O*************    61 55   REVAS    109 '   ,   ,   , 0 . '    S1107  E10953
1006 O*************    62 55   REVAS    109 '  ,   ,   , 0 .  '    S1107  E10953
1007 O*************    63 55   REVAS    109 ' ,   ,   , 0 .   '    S1107  E10953
1008 O*************    60      PLAM     127 ' ,   ,   ,   , 0 '           E10953
1009 O*************    61      PLAM     127 '   ,   ,   , 0 . '           E10953
1010 O*************    62      PLAM     127 '  ,   ,   , 0 .  '           E10953
1011 O*************    63      PLAM     127 ' ,   ,   , 0 .   '           E10953
1012 O*************    51               128 '-'                           E10953
1013 O*************    23               128 '+'                           E10953
1004 O*************    60N55   REVA     109 '   ,   ,   ,   , 0 '   E10953E12711
1005 O*************    61N55   REVA     109 '     ,   ,   , 0 . '   E10953E12711
1006 O*************    62N55   REVA     109 '    ,   ,   , 0 .  '   E10953E12711
1007 O*************    63N55   REVA     109 '   ,   ,   , 0 .   '   E10953E12711
1004 O*************    60 55   REVAS    109 '   ,   ,   ,   , 0 '   E10953E12711
1005 O*************    61 55   REVAS    109 '     ,   ,   , 0 . '   E10953E12711
1006 O*************    62 55   REVAS    109 '    ,   ,   , 0 .  '   E10953E12711
1007 O*************    63 55   REVAS    109 '   ,   ,   , 0 .   '   E10953E12711
1008 O*****            60      PLAM     129 ' ,   ,   ,   , 0   '   E10953E12096
1009 O*****            61      PLAM     129 '   ,   ,   , 0 .   '   E10953E12096
1010 O*****            62      PLAM     129 '  ,   ,   , 0 .    '   E10953E12096
1011 O*****            63      PLAM     129 ' ,   ,   , 0 .     '   E10953E12096
1118 O*************    60      PLAM     129 '   ,   ,   ,   , 0 '   E12096E12711
1009 O*************    61      PLAM     129 '     ,   ,   , 0 . '   E12096E12711
1010 O*************    62      PLAM     129 '    ,   ,   , 0 .  '   E12096E12711
1011 O*************    63      PLAM     129 '   ,   ,   , 0 .   '   E12096E12711
1012 O*************    51               130 '-'                     E10953E12711
1013 O*************    23               130 '+'                     E10953E12711
1004 O                 60N55   REVA     109 ' ,   ,   ,   , 0 '           E12711
1005 O                 61N55   REVA     109 '   ,   ,   , 0 . '           E12711
1006 O                 62N55   REVA     109 '  ,   ,   , 0 .  '           E12711
1007 O                 63N55   REVA     109 ' ,   ,   , 0 .   '           E12711
     O                                  110 '-'                           S01303
     O                 22               110 '+'                           S01303
     O                 19               110 '+'                           158840
     O                 33               110 '-'                           S01303
1004 O                 60 55   REVAS    109 ' ,   ,   ,   , 0 '           E12711
1005 O                 61 55   REVAS    109 '   ,   ,   , 0 . '           E12711
1006 O                 62 55   REVAS    109 '  ,   ,   , 0 .  '           E12711
1007 O                 63 55   REVAS    109 ' ,   ,   , 0 .   '           E12711
1008 O                 60      PLAM     127 ' ,   ,   ,   , 0 '           E12711
1009 O                 61      PLAM     127 '   ,   ,   , 0 . '           E12711
1010 O                 62      PLAM     127 '  ,   ,   , 0 .  '           E12711
1011 O                 63      PLAM     127 ' ,   ,   , 0 .   '           E12711
1012 O                 51               128 '-'                           E12711
1013 O                 23               128 '+'                           E12711
     O                 17      PRFC     132                               CAC001
     O                 16               128 '+'                           158840
     O                 19               128 '-'                           158840
     O/COPY WNCPYSRC,DL0410O007
     O********EF1      81 37                                                           S01303 CAS001
     O        EF1      81 37 09                                                               CAS001
     O                                   29 'MONTHLY SUB-TOTAL'           S01303
     O                 70      MEAMT  B  53 ' ,   ,   ,   , 0 '           S01303
     O                 71      MEAMT  B  53 '   ,   ,   , 0 . '           S01303
     O                 72      MEAMT  B  53 '  ,   ,   , 0 .  '           S01303
     O                 73      MEAMT  B  53 ' ,   ,   , 0 .   '           S01303
     O                    64             54 '+'                           S01303
     O                    65             54 '-'                           S01303
     O                 60      MDBCE  B  73 ' ,   ,   ,   , 0 '           S01303
     O                 61      MDBCE  B  73 '   ,   ,   , 0 . '           S01303
     O                 62      MDBCE  B  73 '  ,   ,   , 0 .  '           S01303
     O                 63      MDBCE  B  73 ' ,   ,   , 0 .   '           S01303
     O                    66             74 '+'                           S01303
     O                    67             74 '-'                           S01303
     O                 60      MREVA  B 109 ' ,   ,   ,   , 0 '           S01303
     O                 61      MREVA  B 109 '   ,   ,   , 0 . '           S01303
     O                 62      MREVA  B 109 '  ,   ,   , 0 .  '           S01303
     O                 63      MREVA  B 109 ' ,   ,   , 0 .   '           S01303
     O                    68            110 '+'                           S01303
     O                    69            110 '-'                           S01303
     O                 60      MPLAM  B 127 ' ,   ,   ,   , 0 '           S01303
     O                 61      MPLAM  B 127 '   ,   ,   , 0 . '           S01303
     O                 62      MPLAM  B 127 '  ,   ,   , 0 .  '           S01303
     O                 63      MPLAM  B 127 ' ,   ,   , 0 .   '           S01303
     O                    57            128 '+'                           S01303
     O                    58            128 '-'                           S01303
     O********E  2     81 37                                                           S01303 CAS001
     O        E  2     81 37 09                                                               CAS001
     O********E  2     82 37                                                           S01303 CAS001
     O        E  2     82 37 09                                                               CAS001
     O                                   29 'ANNUAL SUB-TOTAL'            S01303
     O                 70      YEAMT  B  53 ' ,   ,   ,   , 0 '           S01303
     O                 71      YEAMT  B  53 '   ,   ,   , 0 . '           S01303
     O                 72      YEAMT  B  53 '  ,   ,   , 0 .  '           S01303
     O                 73      YEAMT  B  53 ' ,   ,   , 0 .   '           S01303
     O                    59             54 '+'                           S01303
     O                    77             54 '-'                           S01303
     O                 60      YDBCE  B  73 ' ,   ,   ,   , 0 '           S01303
     O                 61      YDBCE  B  73 '   ,   ,   , 0 . '           S01303
     O                 62      YDBCE  B  73 '  ,   ,   , 0 .  '           S01303
     O                 63      YDBCE  B  73 ' ,   ,   , 0 .   '           S01303
     O                    78             74 '+'                           S01303
     O                    38             74 '-'                           S01303
     O                 60      YREVA  B 109 ' ,   ,   ,   , 0 '           S01303
     O                 61      YREVA  B 109 '   ,   ,   , 0 . '           S01303
     O                 62      YREVA  B 109 '  ,   ,   , 0 .  '           S01303
     O                 63      YREVA  B 109 ' ,   ,   , 0 .   '           S01303
     O                    84            110 '+'                           S01303
     O                    39            110 '-'                           S01303
     O                 60      YPLAM  B 127 ' ,   ,   ,   , 0 '           S01303
     O                 61      YPLAM  B 127 '   ,   ,   , 0 . '           S01303
     O                 62      YPLAM  B 127 '  ,   ,   , 0 .  '           S01303
     O                 63      YPLAM  B 127 ' ,   ,   , 0 .   '           S01303
     O                    86            128 '+'                           S01303
     O                    87            128 '-'                           S01303
     O********T 2      L2 31NU7                                           S01117
     O********T 2      L1 31NU7                                     S01117S01303
     O        TF2      L1 31NU7                                           S01303
     O*******AND       37                                                              S01117 CAS001
     O       AND       37 09                                                                  CAS001
1015 O                 70      TEAMT  B  53 ' ,   ,   ,   , 0 '
1016 O                 71      TEAMT  B  53 '   ,   ,   , 0 . '
1017 O                 72      TEAMT  B  53 '  ,   ,   , 0 .  '
1018 O                 73      TEAMT  B  53 ' ,   ,   , 0 .   '
1019 O                                   54 '-'
1020 O                 25                54 '+'
     O                 60      TDBCE  B  73 ' ,   ,   ,   , 0 '           S01303
     O                 61      TDBCE  B  73 '   ,   ,   , 0 . '           S01303
     O                 62      TDBCE  B  73 '  ,   ,   , 0 .  '           S01303
     O                 63      TDBCE  B  73 ' ,   ,   , 0 .   '           S01303
     O                    88             74 '+'                           S01303
     O                    89             74 '-'                           S01303
1021 O                                   90 'TOTAL'                       S01303
     O                 60      TREVA  B 109 ' ,   ,   ,   , 0 '           S01303
     O                 61      TREVA  B 109 '   ,   ,   , 0 . '           S01303
     O                 62      TREVA  B 109 '  ,   ,   , 0 .  '           S01303
     O                 63      TREVA  B 109 ' ,   ,   , 0 .   '           S01303
     O                    48            110 '+'                           S01303
     O                    49            110 '-'                           S01303
     O                 60      TPROF  B 127 ' ,   ,   ,   , 0 '           S01303
     O                 61      TPROF  B 127 '   ,   ,   , 0 . '           S01303
     O                 62      TPROF  B 127 '  ,   ,   , 0 .  '           S01303
     O                 63      TPROF  B 127 ' ,   ,   , 0 .   '           S01303
     O                                  128 '+'                           S01303
1021 O******                            104 'TOTAL'                       S01303
     O********T*2      L1 31NU7                                                        S01303 220199
     O        TF2      L1 31NU7                                                               220199
     O*******AND       37                                                              S01303 CAS001
     O       AND       37 09                                                                  CAS001
     O                 60      TLOSS  B 127 ' ,   ,   ,   , 0 '           S01303
     O                 61      TLOSS  B 127 '   ,   ,   , 0 . '           S01303
     O                 62      TLOSS  B 127 '  ,   ,   , 0 .  '           S01303
     O                 63      TLOSS  B 127 ' ,   ,   , 0 .   '           S01303
     O                                  128 '-'                           S01303
     O********T*2      L1 31NU7                                                        S01303 220199
     O        TF2      L1 31NU7                                                               220199
     O*******AND       37                                                              S01303 CAS001
     O       AND       37 09                                                                  CAS001
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0410OOP3                                           S01408
     O*                                                                   S01408
     O                                  109 '(NET)'                       S01303
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0410OOP4                                           S01408
     O*                                                                   S01408
1022 O**************   60      TOTPL  B 127 ' ,   ,   ,   , 0 '           E10953
1023 O**************   61      TOTPL  B 127 '   ,   ,   , 0 . '           E10953
1024 O**************   62      TOTPL  B 127 '  ,   ,   , 0 .  '           E10953
1025 O**************   63      TOTPL  B 127 ' ,   ,   , 0 .   '           E10953
1022 O**************   60      TOTPL  B 127 '   ,   ,   ,   , 0 '   E10953E12711
1023 O**************   61      TOTPL  B 127 '     ,   ,   , 0 . '   E10953E12711
1024 O**************   62      TOTPL  B 127 '    ,   ,   , 0 .  '   E10953E12711
1025 O**************   63      TOTPL  B 127 '   ,   ,   , 0 .   '   E10953E12711
1022 O                 60      TOTPL  B 127 ' ,   ,   ,   , 0 '           E12711
1023 O                 61      TOTPL  B 127 '   ,   ,   , 0 . '           E12711
1024 O                 62      TOTPL  B 127 '  ,   ,   , 0 .  '           E12711
1025 O                 63      TOTPL  B 127 ' ,   ,   , 0 .   '           E12711
     O/COPY WNCPYSRC,DL0410O008
1026 O                 46               128 '-'
1027 O                 24               128 '+'
     O/COPY WNCPYSRC,DL0410O004
1062 O        T 3      U7 U8 37                                           S01117
     O       AND       09                                                                     CAS001
1063 O                                   30 'REFERENCE DL0410'            S01117
1064 O                                   62 'PRINT TERMINATED'            S01117
1065 O                                   80 'DATABASE IN ERROR'           S01117
     O/COPY WNCPYSRC,DL0410O006
     O******  T 3      L2 37 31                                    S01117 LN0363
     O********T*3      L2 37 79                                                        LN0363 220199
     O        TF3      L2 37 79                                                               220199
     O       AND       09                                                                     CAS001
     O*******OR*       LR 37 79                                                        LN0363 220199
     O       ORF       LR 37 79                                                               220199
     O       AND       09                                                                     CAS001
     O********************               71 '*** END OF BRANCH REPORT'S111E157
     O********************               75 ' ***'                  S01117E157
     O                N85                65 '*** END OF REPORT '          S01117
     O                N85                79 'FOR BRANCH ***'              S01117
     O******          N85                71 '*** END OF BRANCH REPORT'    E157
     O******          N85                75 ' ***'                        E157
1061 O                 85                84 '*** END OF REPORT ***'       E157
     O********************************************************************S01117
     O/COPY WNCPYSRC,DL0410O002
1028 O********T  203   LRNU7                                              S01117
1028 ODL0410AUT  203   LR                                                 S01117
1029 O*******                            22 'REFERENCE DL0410'            S01117
1029 O                                   24 'REFERENCE DL0410AU'          S01117
1030 O**********                         TITL      89                     S01194
1030 O                         BJURPT    89                               S01194
1031 O                                  104 'DATE'
1032 O**********                         RUNA     112                     S01194
1032 O                         BJMRDT   112                               S01194
1033 O                                  122 'PAGE'
1034 O*********************    PAGE  Z  127                               LN0761
1034 O                         PAGE1 Z  127                               LN0761
1035 O********T  1     LRNU7                                              S01117
1035 O        T  1     LR                                                 S01117
1036 O                                   68 'REVALUATION OF FORWARD '
1037 O                                   79 'COMMITMENTS'
1038 O********T        LRNU7                                              S01117
1038 O        T        LR                                                 S01117
1039 O                                   69 '------------------------'
1040 O                                   79 '----------'
1041 O        T  215   LRNU7
1042 O                                   18 'RUN CONTROLS'
1043 O        T  2     LRNU7
1044 O                                   59 'NUMBER'
1045 O**********                         84 'VALUE'                       E39370
1045 O                 U1                84 'VALUE'                       E39370
1046 O        T  2     LRNU7
1047 O                                   31 'RECORDS LISTED IN THIS '
1048 O                                   37 'REPORT'
     O                         RECS  3   59
1050 O        T  2     LRNU7 U1
1051 O                                   29 'REVALUATION BALANCES '
1052 O                                   37 'REVERSED'
1053 O                         NRBR  3   59
1054 O                         RBR   3   84
1055 O        T  2     LRNU7 U1
1056 O                                   29 'REVALUATION BALANCES '
1057 O                                   38 'GENERATED'
1058 O                         NRBG  3   59
1059 O                         RBG   3   84
     C*                                                                   S01117
     O        T 33     LRNU7N14                                           S01117
     O       AND      N06                                                                     219334
     O       OR        LRNU7N09                                                               219334
     O       AND       06N05                                                                  219334
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
1060 O********T********LRNU7                                              E137
1061 O*****************                  84 '*** END OF REPORT ***'       E137
1062 O        T   25   LR U7 U8
1063 O***********************************30 'REFERENCE DL0410'            S01117
1064 O***********************************62 'PRINT TERMINATED'            S01117
1065 O***********************************80 'DATABASE IN ERROR'           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   49 'OPTION'                      S01117
     O                         DBOPTN    57                               S01117
     O                                   66 'KEY'                         S01117
     O                         DBKEY     96                               S01117
     O/COPY WNCPYSRC,DL0410O013
1066 OGEFRHH  H        01 U1
1067 O                                    1 'A'
     O/COPY WNCPYSRC,DL0410O012
1068 OGEFRPD  E        41
1069 O       OR        42
1070 O       OR        43
1071 O       OR        44
1071 O       OR        07 04 U1                                                               CAS005
     O/COPY WNCPYSRC,DLH00375
1072 O                                    1 'P'
1073 O*****                    ACCKEY    16                               S01117
1073 O**********               ACCKY     16                                            S01117 CGL029
1073 O**********               RECI       1                                           CGL029 BUG1811
1073 O                         CNUM       7                                                   CGL029
1073 O                         CCY       10                                                   CGL029
1073 O                         ACODQQ    14                                                   CGL029
1073 O                         ACSQ      16                                                   CGL029
1073 O                         ACOD     599                                                   CGL029
     O**********             04WDLDS     16                                           CAS005 BUG5336
     O                       04WDLDS     16                                         BUG5336 BUG5336R
     O**********                       41FRPA      14                     S01194
     O**********                       42FRPA      14                     S01194
1074 O**********                         RUND      35P                    S01194
1075 O**********                         RUND      38P                    S01194
     O**********             41BNFRPL    14                                            S01194 CAS005
     O**********             42BNFRPL    14                                            S01194 CAS005
     O**********         N07 41BNFRPL    14                                            CAS005 CGL029
     O**********         N07 42BNFRPL    14                                            CAS005 CGL029
     O**********      N08 07 41BNFRPL    14                                            CAS005 CGL029
     O**********      N08 07 42BNFRPL    14                                            CAS005 CGL029
     O**********       08 07 41BNFRLA    14                                            CAS005 CGL029
     O**********       08 07 42BNFRLA    14                                            CAS005 CGL029
     O**********          07 04ACOD      14                                            CAS005 CGL029
     O                   N07 41BNFRPL   599                                                   CGL029
     O                   N07 42BNFRPL   599                                                   CGL029
     O                N08 07 41BNFRPL   599                                                   CGL029
     O                N08 07 42BNFRPL   599                                                   CGL029
     O                 08 07 41BNFRLA   599                                                   CGL029
     O                 08 07 42BNFRLA   599                                                   CGL029
     O                    07 04ACOD     599                                                   CGL029
1074 O                         BJRDNB    35P                              S01194
1075 O                         BJRDNB    38P                              S01194
1076 O*********** S01522                 64 'FORWARD REVALUATIONS'        S01522
     O                         O#PNAR    73                               S01522
     O                    07 04PNAR      73                                                   CAS005
     O/COPY WNCPYSRC,DLH00385
1077 O                 41      LDBL      80P
1078 O                 43      LDBL      80P
     O**********             42TBR,A     80P                                                  CAS005
     O**********             44TBR,A     80P                                                  CAS005
     O                   N07 42TBR,A     80P                                                  CAS005
     O                   N07 44TBR,A     80P                                                  CAS005
     O                N08 07 42TBP,A     80P                                                  CAS005
     O                N08 07 44TBP,A     80P                                                  CAS005
     O                 08 07 42TBL,A     80P                                                  CAS005
     O                 08 07 44TBL,A     80P                                                  CAS005
     O                    07 04PSTA      80P                                                  CAS005
     O/COPY WNCPYSRC,DLH00376
1081 O                                   81 '0'
1082 O                 41 15             81 '1'
1083 O                 43N15             81 '1'
1084 O                    42 26          81 '1'
1085 O                    44N26          81 '1'
     O                       04DRCR      81                                                   CAS005
     O/COPY WNCPYSRC,DLH00377
1086 O                         ASOC      87                               S10736
     O                         CHQN      95                                                  BUG1813
1086 O                                  102 'GE-FR'
     O                         BRAR,A   105
     O                    07 04BRCA     105                                                   CAS005
     O/COPY WNCPYSRC,DLH00378
1088 O                                  106 '0'
1089 O**********                         ATYP     124                     S01194
1089 O                         A5ACTY   124                               S01194
     O                    07 04ATYP     124                                                   CAS005
     O/COPY WNCPYSRC,DLH00379
1090 O                         PRIN     128
1091 O                                  129 'F'
1091 O***********                       134 '    '                 S01182 CAC001
     O                N17               134 '    '                        CAC001
     O                 17      PRFC     134                               CAC001
     O/COPY WNCPYSRC,DLH00380
1090 O                                  140 '235959'                      S10736
1090 O                         VOIN     141                               S10736
1090 O                         A5ACSC   146                               S10736
1090 O                    07 04ACSC     146                                                   CAS005
     O/COPY WNCPYSRC,DLH00381
1091 O                                  230 '               '             S01182
1091 O                                  240 '          '                  S01182
     O/COPY WNCPYSRC,DLH00382
1091 O                                  250 '          '                  S01182
     O/COPY WNCPYSRC,DLH00383
1091 O                         ZERO15   258P                              S01182
1091 O                         ZERO15   266P                              S01182
1091 O                                  268 '  '                          S01182
     O/COPY WNCPYSRC,DLH00384
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         NITMS    271P                                                AR813358
     O                         CHGA     279P                                                AR813358
     O                         ORAMT    316P                                                AR813358
     O                         ACNO      32                                                 AR813358
     O                         TRAT      43                                                 AR813358
     O                         REJC     108P                                                AR813358
     O                         RRNM     114P                                                AR813358
     O                         ACUM     130                                                 AR813358
     O                         LTAI     147                                                 AR813358
     O                         XRFN     329                                                 AR813358
     O                         SETDAT   530P                                                AR813358
     O/COPY WNCPYSRC,DL0410O011
1092 OGEFRZZ  E        45
1093 O                                    1 'T'
     O                         TOTNUM     6
1095 O                         INT,2     14P
1096 O                         DEC,2     16P
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0410OOPG                                           S01408
     O*                                                                   S01408
     X/COPY WNCPYSRC,DL0410X001
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   POWER - POWERS OF 10 FOR CURRENCY CONVERSIONS
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   TABE1
11V1
11V2
12V1
12V2
13V1
13V2
20V1
20V2
91P1                                                                      S03220
91P2                                                                      S03220
91P3                                                                      S03220
91P4                                                                      S03220
91P5                                                                      S03220
91P6                                                                      S03220
91P8                                                                      S03220
91P9                                                                      S03220
23C3                                                                                          CAS008
23S3                                                                                          CAS008
23C4                                                                                          CAS008
23S4                                                                                          CAS008
**   TABE2
14V3
14V4
15I2
15M2
16I2
16M2
17I2
17M2
20V3
20V4
21C3                                                                      S01328
21I1                                                                      S01119
22I1                                                                      S01119
23I1                                                                      S01119
24I1                                                                      S01119
**   TABE3
11V1
12V1
13V1
14V3
14V4
15I2
15M2
17I2
17M2
20V1
20V3
91P2                                                                      S03220
91P3                                                                      S03220
91P6                                                                      S03220
91P8                                                                      S03220
** DTX DEAL TYPES                                                         S01328
FR                                                                        S01328
RS                                                                        S01328
RX                                                                        S01328
** DTH DEAL TYPE HEADINGS                                                 S01328
FORWARD RATE AGREEMENTS                                                   S01328
SINGLE CURRENCY INTEREST RATE SWAPS                                       S01328
CROSS CURRENCY INTEREST RATE SWAPS                                        S01328
** TEXT - Text Strings                                                    S01522
FORWARD REVALUATIONS                                                      S01522
     X/COPY WNCPYSRC,DL0410X002
