0001 H        1
.002 F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Spot revaluation')                            *
.002 F*****************************************************************
0006 F*                                                               *
     F*  Midas - Dealing Module                                       *
0004 F*                                                               *
0005 F*       DL0450 - SPOT REVALUATION                               *
0006 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                               *
      *  Last Amend No. MD025993           Date 19Aug14               *
      *  Prev Amend No. MD020563           Date 21May13               *
      *                 AR1097176          Date 22Mar13               *
      *                 CFC006             Date 06Aug12               *
      *                 AR813358A          Date 18Dec12               *
      *                 AR752668           Date 19May11               *
      *                 CER051             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 256813             Date 24Sep08               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 238975             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 BUG2595            Date 13Apr04               *
      *                 BUG1814            Date 08Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL020             Date 12Dec02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 202042             Date 18Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 151904             Date 27Jun01               *
      *                 151104             Date 14Jun01               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01Mar99               *
      *                 CTI002             Date 23Sep98               *
      *                 148829             Date 22Jan99               *
      *                 147250             Date 11Nov98               *
      *                 145517             Date 06Nov98               *
      *                 145515             Date 06Nov98               *
      *                 139568             Date 18Sep98               *
      *                 CEU011             Date 11Mar98               *
      *                 S01408             Date 14Oct96               *
      *                 097155             Date 15Apr96               *
     F*                      S01408           DATE  08JAN96
     F*                      095477           DATE  25OCT95              *
     F*                      086125           DATE  16MAR95              *
     F*                      S01522           DATE  25JAN95              *
     F*                      S10736           DATE  17NOV92              *
     F*                      E28761           DATE  27OCT92              *
     F*                      S01182           DATE  12OCT88              *
     F*                      LN0811           DATE  10OCT90              *
     F*                      BHF346           DATE  10AUG90              *
     F*                      LN0330           DATE  06JUN90              *
     F*                      BHF099           DATE  04JUN90              *
     F*                      E15192           DATE  17APR90              *
     F*                      E167             DATE  08DEC89              *
     F*                      E139             DATE  04DEC89              *
     F*                      E134             DATE  01DEC89              *S01194
     F*                      S01194           DATE  03/04/89             *S01194
     F*                      S01117           DATE  03/04/89             *S01117
     F*                      E14262           DATE  29/09/88             *
     F*                      E12161           DATE  26/08/87             *
     F*                      E11502           DATE  26/08/87             *
     F*                      E11096           DATE  03/07/87             *
0008 F*                      E10886           DATE  12/06/87             *
0008 F*                      E10217           DATE  29/12/86             *
0010 F*                                                                  *
0010 F*----------------------------------------------------------------  *
0010 F*                                                                  *
      *  MD025993 - Total Spot Revaluation and Profit / Loss fields   *
      *             were adjusted from 15 to 17 to avoid truncation   *
      *  MD020563 - CFC006 issues                                     *
      *  AR1097176 - Accessing AOCOMR0 multiple times slows down      *
      *              the system                                       *
      *  CFC006 - COB Restructure - Remove reports from COB           *
      *  AR813358A - Data mapping error on member EODPOPD, original   *
      *              fix is incomplete. Initialise fields SETDAT LTAI *
      *              XRFN and TRAT also added these fields to all the *
      *              EXCP format for GESRPD. Also apply CGL120 for    *
      *              ORAMT NITMS CHGA fields. (Child: AR813359A)      *
      *  AR752668 - GLC35A 00001 Database Error 010-FILE-S/SDACODPD   *
      *             (Child: AR752669)                                 *
      *  CER051 - Portuguese Upgrade Split Spot Revaluation (Profit   *
      *           and Loss)                                           *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (recompiled)                                        *
      *  256813 - Allow up to 900 branches.                           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  238975 - Size of WK159 is not enough to store the correct    *
      *           value.                                              *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  BUG2595- Array EQ needs to be 10 long
      *  BUG1814- Correctons to file lengths, input and output specs     *
      *           for 10-digit account code.                             *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL020 - Midas Compliance Watch - Additional A/C Postings    *
      *           Information                                         *
      *  202042 - Breakdown the posting amount if it is bigger than 13   *
      *           digits to avoid file out of balance.                   *
      *  151904 - Profit/Loss Euro Equivalent for 'IN' currencies     *
      *           10000 times too small when Base Currency has zero   *
      *           decimal place.                                      *
      *  151104 - Allow up to 900 branches.                           *
      *  CGL007 - Account Postings Enquiry                               *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDEXPMPD changed.                    *
     F*  148829 - Profit/Loss Euro Equivalent for 'EURO' wrongly         *
     F*           calculated. Amendment to #145517 .                     *
     F*  147250 - Profit/Loss Euro Equivalent for 'EXX' wrongly          *
     F*           cumulated for 'EUR' currency.                          *
     F*  145517 - Profit/Loss Euro Equivalent for 'EURO' wrongly         *
     F*           calculated.                                            *
     F*  145515 - Profit/Loss Euro Equivalent is calculated the wrong    *
     F*           way (Multiplying instead of divivding and vice versa)  *
0010 F*  139568 - Initialised the branch totals fields correctly and     *
0010 F*           reset the Euro details line indicator at beginning     *
0010 F*           of processing for each currency.                       *
      *  CEU011 - EMU Position/Risk Reporting                         *
     F*         S01408 - Core hook DL0450CP27 added                      *
     F*                  Core hook DL0450CP26 added                      *
     F*                  Core hook DL0450CP25 added                      *
     F*                  Core hook DL0450CP24 added                      *
     F*                  Core hook DL0450CP23 added                      *
     F*                  Core hook DL0450CP22 added                      *
     F*                  Core hook DL0450CP21 added                      *
     F*                  Core hook DL0450CP20 added                      *
     F*                  Core hook DL0450CP19 added                      *
     F*                  Core hook DL0450CP18 added                      *
     F*                  Core hook DL0450CP17 added                      *
     F*                  Core hook DL0450CP16 added                      *
     F*                  Core hook DL0450CP15 added                      *
     F*                  Core hook DL0450CP14 added                      *
     F*                  Core hook DL0450CP13 added                      *
     F*                  Core hook DL0450CP12 added                      *
     F*                  Core hook DL0450OP15 added                      *
     F*                  Core hook DL0450OP14 added                      *
     F*                  Core hook DL0450OP13 added                      *
     F*                  Core hook DL0450OP12 added                      *
     F*                  Core hook DL0450OP11 added                      *
     F*                  Core hook DL0450OP10 added                      *
     F*                  Core hook DL0450OOP9 added                      *
     F*                  Core hook DL0450OOP8 added                      *
     F*                  Core hook DL0450OOP7 added                      *
     F*                  Core hook DL0450OOP6 added                      *
     F*                  Core hook DL0450OOP5 added                      *
     F*       097155  -  Branch code 001 not being picked up for output  *
     F*                  to report DL0450P1 or file GESRPD.              *
     F*       S01408  -  Core hook DL0450FFP1 added                      *
     F*                  Core hook DL0450FFP2 added                      *
     F*                  Core hook DL0450CCP1 added                      *
     F*                  Core hook DL0450CCP2 added                      *
     F*                  Core hook DL0450CCP3 added                      *
     F*                  Core hook DL0450CCP4 added                      *
     F*                  Core hook DL0450CCP5 added                      *
     F*                  Core hook DL0450CCP6 added                      *
     F*                  Core hook DL0450CCP7 added                      *
     F*                  Core hook DL0450CCP8 added                      *
     F*                  Core hook DL0450CCP9 added                      *
     F*                  Core hook DL0450CP10 added                      *
     F*                  Core hook DL0450CP11 added                      *
     F*                  Core hook DL0450OOP1 added                      *
     F*                  Core hook DL0450OOP2 added                      *
     F*                  Core hook DL0450OOP3 added                      *
     F*                  Core hook DL0450OOP4 added                      *
     F*       095477  - Move SOPT REV text left not rignt                *
     F*       086125  - Add new parameter to AOPNARR0                    *
     F*       S01522  - Call to AOPNARR0 if switchable feature installed *
     F*                 and UDC present                                  *
     F*       S10736  -  MANAGEMENT ACCOUNTING.                          *
     F*       E28761  -  A6SPAE is 4A not 4N so compare to blanks
     F*                  BESIDE 0. A6SPAE compare to '0000' not '0'
     F*       S01182  -  WRITES NEW ACCOUNT POSTING FIELDS TO THE        *
     F*                  GENERATED ENTRIES FILE PF/GESRPD FOR MIS.       *
     F*       LN0811  - DO NOT SEND A BLANK SEQUENCE NUMBER TO ZSFILE
     F*                 AS THIS WILL CAUSE THE AU & P1 REPORTS TO
     F*                 HAVE DIFFERENT SEQUENCE NUMBERS.
     F*       BHF346  - TO CORRECT LN0330- NEW PAGE FOR EACH CURRENCY    *
     F*                 WAS BEING PRINTED                                *
     F*       LN0330  - PROGRAM LOOPS WHEN THERE ARE MORE  THAN 20       *
     F*                 BRANCHES AND ALSO PRINTS REPORT WHEN THERE       *
     F*                 ARE NO DETAILS                                   *
     F*       BHF099  - REVALUATION WAS MADE AGAINST SWAP TRADE INSTEAD  *
     F*                 OF SPOT TRADE ACCOUNT                            *
     F*       E15192  - TRANSFER OF BASE CCY IN/EX NOW DONE IN GL0800    *
     F*                 REMOVE FIXES E11096, E11502 AND E12161.          *
     F*       E167    - FIX TO SET UP DEFAULT BRANCH DETAILS IN ARRAYS   *
     F*                 WHEN MBIN-N                                      *
     F*       E139    - FIX TO CORRECT 'AU' REPORT OUTPUT                *
     F*       E134    - FIX TO USE CORRECT VALUE OF MULT/DIV INDICATOR   *
     F*       S01194  -  STANDING DATA CHANGES DERIVED FROM SYNON.       *S01194
     F*       S01117  -  MULTIBRANCHING.                                 *S01117
     F*       E14262  -  TO PREVENT PROGRAM LOOPING  IF  BRANCH CODE OF  *E14262
     F*                  '999' OCCURRED AS 20th ELEMENT OF BRANCH CODE   *E14262
     F*                  ARRAY                                           *E14262
     F*       E12161  -  FIX E11096 INCORRECT.(a)OUTPUT OF NEW RECORDS    E12161
     F*                  WAS INCORRECTLY DEPENDENT ON ENTRIES 3 & 4.      E12161
     F*                  (b)FIELD 'ACCS' WAS BEING OVERRIDDEN.            E12161
     F*       E11502  -  FIX E11096 NEEDS FILE CONTROL PROCESSING.       *E11502
     F*       E11096  -  CLEAR DOWN SPOT REVAL P&L A/C IF BASE CCY       *E11096
     F*                  TRANSFER IS DUE                                 *E11096
0010 F*       E10886  -  BRANCH TOTAL CARRIED FORWARD WHEN P/L = 0.      *E10886
0010 F*       E10217  -  PHASA NOW REDUNDANT                             *
0010 F*                                                                  *
0011 F********************************************************************
0012 F/EJECT
0013 F*HASA***IP**F      32            DISK                               E10217
0014 F*ABLE***IF**F******96*12AI*****2*DISK***************************    S01194
0015 F*ABLE2**IF**F******96*12AI*****2*DISK***************************    S01194
0016 F*CCNT***IF**F*****400*15AI*****2*DISK                               S01194
0016 F***ACCNT** IF  F     400 18AI     2 DISK                                         S01194 CGL029
0016 F***ACCNT** IF  F     410 24AI     2 DISK                                        CGL029 BUG1814
0016 FACCNT   IF  F     573 24AI     2 DISK                                                  BUG1814
     F***GLACNTL0IF  F     440 18AI     2 DISK                                         CEU011 CGL029
     FGLACNTL0IF  F     452 24AI     2 DISK                                                   CGL029
      **  GL Account Master                                               CEU011
      *                                                                   CEU011
0016 FSDCURRL0IF  E           K        DISK                               S01194
0016 FSDBRCHL1IF  E           K        DISK                               S01194
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0450FFP1                                           S01408
     F*                                                                   S01408
0017 FGESRHH  O   F     160            DISK
0017 F*****GESRPD**O***F*****160            DISK                          S01182
0017 F***GESRPD**O   F     268            DISK                     S01182 CGL007
0017 F***GESRPD* O   F     331            DISK                                         CGL007 CGL020
0017 F***GESRPD* O   F     589            DISK                                        CGL020 BUG1814
0017 FGESRPD  O   F     620            DISK                                                  BUG1814
0017 FGESRZZ  O   F     160            DISK
0018 F*PRINT**O***F*****132*****OF*****PRINTER                            S01117
0018 FDL0450AUO   F     132     OV     PRINTER      KINFDS SPOOLU         S01117
0018 FDL0450P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0019 F/EJECT
0020 F* ID F  C  H  L    FUNCTION OF INDICATORS
0021 F* 01            PHASD RECORDS
0022 F**02************ICDR1*********************TABLE,TB*********         S01194
0023 F**03************ICDR2*********************TABLE,TB*********         S01194
0024 F**04************ICDR3*********************TABLE,TB*********         S01194
0025 F**05************ACCOUNT*CODES*RECORD*1****TABLE,TE*********         S01194
0026 F**06************BRANCH*CODES*RECORD*******TABLE,TR**TABLE2*         S01194
0027 F**07************CURRENCIES*RECORDS*1&2****TABLE,TG**TABLE2*         S01194
0028 F**08************CATCHALL*TABLE2*FILE***********************         S01194
0029 F* 09            ACCNT DETAIL
0030 F* 10            CATCHALL ACCNT FILE
0031 F* 11            CATCHALL TABLE FILE
0032 F*       25      NO DETAILS TO REPORT FLAG                           S01117
0032 F*       30      WORK INDICATOR
     F********37      DEBIT BASE CCY P&L A/C IF TRANSFER DUE       E11096 E15192
0033 F*       40      END OF FILE FOR BUILDING CUSTOMERS ARRAY
0034 F*       41      KEY HAS CHANGED WHEN BUILDING CUSTOMERS ARRAY
0035 F*       42      CUSTOMER ARRAY EXCEEDED-MORE CUSTOMERSTHAN ELEMENTS
0036 F*       43      CURRENCY ARRAY FULL&MORE TO BE PROCESSED
0037 F*       46      END OF FILE FOR CURRENCIES ARRAY(+SR'S+DEC.+EQ.AC'S)
0038 F*       44      CURRENCY HAS 0 DEC.POS. ALSO POSBL1
0039 F*       45      CURRENCY HAS 1 DEC.POS. ALSO POSBL2
0040 F*       47      KEY HAS CHANGED FOR CURRENCIES ARRAY
0041 F*       48      CURRENCY HAS 2 DEC.POS. ALSO POSBL3
0042 F*       49      CURRENCY HAS 3 DEC.POS. ALSO POSBL4
0043 F*****   50      CHAIN TO ICDR2 FAIL                           ***** S01194
     F*       50      CONDITIONS OPENING OF DL0450P1                      BHF346
0044 F*****   51      CHAIN TO ICDR3 FAIL                           ***** S01194
0045 F*       52      CHAIN FOR POS.BAL.TO ACCNT FAIL
0046 F*       53      REC.ID NOT'D' FOR CHAIN TO ACCNT FOR POS.BAL.
0047 F*       54      CHAIN FOR EQ.BAL.TO ACCNT FAIL
0048 F*       55      REC.ID NOT'D' FOR CHAIN TO ACCNT FOR EQ.BAL.
0049 F*       56      POSTING AMOUNT ZERO
0050 F*       57      EXCEPT OUTPUT FOR COUNT TO REPORT&TRAILER FOR GESR
0051 F*       58      BASE CURRENCY HAS 0 DEC.POS.
0052 F*       59      BASE CURRENCY HAS 1 DEC.POS.
0053 F*       60      BASE CURRENCY HAS 2 DEC.POS.
0054 F*       61      BANK DOESN'T MAINTAIN EQ.A/C CODE FOR BASE CURRENCY
0055 F*       62      CURRENCY IS BASE CURRENCY
0056 F*       63      EQ.A/C CODE DOESN'T EXIST
0057 F*       64      END OF CURRENCY ARRAY IN PROCESSING
0058 F*       65      THIS ELEMENT IN CURRENCY ARRAY IS BLANK
0059 F*       66      END OF CUSTOMER ARRAY
0060 F*       67      THIS ELEMENT IN CUSTOMER ARRAY IS ZERO
0061 F*       68      BASE CURRENCY HAS 3 DEC.POS.
0062 F*       69      DELETED CURRENCY RECORD
0063 F*       70      POS.BAL. IS ZERO
0064 F*       71      LOSS
0065 F*       72      PROFIT
0066 F*       73      ACCOUNT IS RETAIL
0067 F*       74      EXCEPT OUTPUT TO REPORT DETAIL
0068 F*       75      EXCEPT OUTPUT TO GESR - ENTRY NO.1
0069 F*       76      EXCEPT OUTPUT TO REPORT BRANCH TOTALS
0070 F*       77      BRANCH LOSS
0071 F*       78      BRANCH PROFIT
0072 F*       79      EXCEPT OUTPUT TO GESR  ENTRY NO.2
0073 F*       80      EXCEPT OUTPUT TO GESR  ENTRY NO.4
0074 F*       81      EXCEPT OUTPUT TO GESR  ENTRY NO.3
0075 F*****   82      CHAIN FAIL TO TABLE.TE FOR EAT2             *****   S01194
0076 F*****   83      CHAIN FAIL TO TABLE,TE FOR EAT3             *****   S01194
0077 F*****   84      CHAIN FAIL TO TABLE,TE FOR EAT4             *****   S01194
0078 F*****   85      CHAIN FAIL TO TABLE,TE FOR EAT1             *****   S01194
0078 F*       85      DETAIL WRITTEN TO  REPORT FILE                      LN0330
0079 F*       86      EXCEPT OUTPUT FOR HEADER TO GESR
0080 F*       87      EXCEPT OUTPUT FOR HEADINGS TO REPORT
0081 F*     88    RATE IS DIVIDE
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0450FFP2                                           S01408
     F*                                                                   S01408
0082 F*****   98      ZSYSTM                                      *****   S01194
0083 F*****   99      ZSYSTM                                      *****   S01194
0084 F********U7      DATABASE ERROR CHAIN TO ICDR                        S01194
0085 F*******&U8      DATABASE ERROR CHAIN TO ICDR                        S01194
0084 F*       U7      DATABASE ERROR                                      S01194
0085 F*      &U8      DATABASE ERROR                                      S01194
0086 F*       U8      DATABASE ERROR CURRENCY ARRAY HASN'T ENOUGH ELEMENTS
0087 F/EJECT
     E                    CPY@    1   1 80
0088 E                    POWERS  1   7  7 3
0089 E*****               BR         20  3 0             BRANCH CODES     S01117
0089 E***********         BR        100  3               BRANCH CODS01117 151104
0089 E***********         BN        100 30               BRANCH NAMS01117 151104
     E                    BR        900  3               BRANCH CODES     151104
     E                    BN        900 30               BRANCH NAMES     151104
0090 E*****               CM         20  6 0             INT.CUSTOMER NO.SS01117
0090 E***********         CM        100  6 0             INT.CUSTOMS01117 151104
     E**********          CM        900  6 0             INT.CUSTOMER NO.              151104 CSD027
     E                    CM        900  6               INT.CUSTOMER NO.                     CSD027
0091 E                    CY        200  3               CURRENCIES
     E*                                                                   139568
     E*** Create a new array to hold transition start date for currency.  139568
     E*                                                                   139568
0091 E                    TD        200  5 0             TRANSIT DATE     139568
0092 E**********          EQ        200  4 0             EQUIV. A/C CODES                    BUG2595
0092 E                    EQ        200 10 0             EQUIV. A/C CODES                    BUG2595
0093 E                    SR        200 13 8             SPOT RATES
0094 E                    CD        200  1 0             NO.OF DEC.PLACES
0095 E*****               MD        200  1 0             MULT-DIV INDIC.  E134
0095 E                    MD        200  1               MULT-DIV INDIC.  E134
0118 E***********         ZYDY    4   4  4 0      ZDATE1/2 SR.ARRAYE11096 E15192
0119 E***********         ZMDY   13  13  3 0      ZDATE1/2 SR.ARRAYE11096 E15192
0120 E***********         ZMNM   12  12  3        ZDATE2 SR. ARRAY E11096 E15192
     E                    C1        200  3  A            CURRENCIES       CEU011
     E                    IN        200  1  A            IN CURRENCIES    CEU011
0092 E                    WBR       200 15 0                                                  202042
0096 E*
0100 I/EJECT
0097 I*    PHASD
0098 I*HASA***NS**01                                                      E10217
0099 I**************                          1  32 ALL                   E10217
0100 I*
0101 I*****TABLE,TB*ICDR1**====>TABTB10********************************   S01194
0102 I*ABLE***NS**02***1*CD***2*C0***3*C1******************************   S01194
0103 I*****  AND      12 C1  13 C0                                *****   S01194
0104 I*****                                   1   1 RECI          *****   S01194
0105 I*****                                   2   30RECT          *****   S01194
0106 I*****                                  12  130RCDE          *****   S01194
0107 I*****                                  14  66 TITL          *****   S01194
0108 I*****                                  67  67 DATF          *****   S01194
0109 I*****                                  68  700DFBR        15*****   S01194
0110 I*****                                  74  74 MODI1         *****   S01194
0111 I*****                                  75  75 MODI2         *****   S01194
0112 I*****                                  76  76 MODI3         *****   S01194
0113 I*****                               P  77  790RUND          *****   S01194
0114 I*****                                  80  86 RUNA          *****   S01194
0115 I*****                                  87  870SFLG          *****   S01194
0116 I*****                               P  90  920LCD           *****   S01194
0117 I*****                                  93  93 CHTP          *****   S01194
0118 I*****                               P  94  960TNLU          *****   S01194
0119 I*
0120 I*
0101 I*****TABLE,TB*ICDR2**====>TABTB11********************************   S01194
0122 I*****   NS  03   1 CD   2 C0   3 C1                         *****   S01194
0123 I*****  AND      12 C1  13 C1                                *****   S01194
0124 I*****                                   1   1 RECI          *****   S01194
0125 I*****                                   2   30RECT          *****   S01194
0126 I*****                                  12  130RCDE          *****   S01194
0127 I*****                                  14  16 BCCY          *****   S01194
0128 I*****                                  17  19 BCYL          *****   S01194
0129 I*****                                  20  22 HOCY          *****   S01194
0130 I*****                                  23  280HEAD          *****   S01194
0131 I*****                               P  29  310APDA          *****   S01194
     I*****                                  32  32 BCXF         E11096   S01194
0132 I*****                                  35  35 APFQ          *****   S01194
0133 I*****                               P  36  380LOGS          *****   S01194
0134 I*****                                  39  40 CUZR          *****   S01194
0135 I*****                               P  41  430DNWD          *****   S01194
0136 I*****                                  44  460BVLP          *****   S01194
0137 I*****                                  47  49 LOCY          *****   S01194
0138 I*****                                  50  510FDAY          *****   S01194
     I*****                               P  54  560EOYD         E11096   S01194
     I*****                                  65  680PLAC         E11096   S01194
0139 I*****                                  86  86 ISAV          *****   S01194
0140 I*****                               P  87  890LLOG          *****   S01194
0141 I*****                               P  90  920LCD           *****   S01194
0142 I*****                                  93  93 CHTP          *****   S01194
0143 I*****                               P  94  960TNLU          *****   S01194
0144 I*
0145 I*
0146 I*****TABLE,TB*ICDR3*=====>TABTB20********************************   S01194
0147 I*****   NS  04   1 CD   2 C0   3 C1                         *****   S01194
0148 I*****  AND      12 C2  13 C0                                *****   S01194
0149 I*****                                   1   1 RECI          *****   S01194
0150 I*****                                   2   30RECT          *****   S01194
0151 I*****                                  12  130RCDE          *****   S01194
0152 I*****                                  14  170COMS          *****   S01194
0153 I*****                                  18  210CADC          *****   S01194
0154 I*****                               P  22  240MDIC          *****   S01194
0155 I*****                               P  25  270MCIC          *****   S01194
0156 I*****                               P  28  300MDIA          *****   S01194
0157 I*****                               P  31  330MCIA          *****   S01194
0158 I*****                                  34  370SRPL          *****   S01194
0159 I*****                                  38  410SPAC          *****   S01194
0160 I*****                                  42  450SWAC          *****   S01194
0161 I*****                                  46  490FTAC          *****   S01194
0162 I*****                                  50  530TAC4          *****   S01194
0163 I*****                                  54  570TAC5          *****   S01194
0164 I*****                               P  63  650NOBA          *****   S01194
0165 I*****                               P  66  680TSIZ          *****   S01194
0166 I*****                                  69  69 RACN          *****   S01194
0167 I*****                                  70  700GLSI          *****   S01194
0168 I*****                                  71  710RTSI          *****   S01194
0169 I*****                                  72  720DLSI          *****   S01194
0170 I*****                                  73  730NOSI          *****   S01194
0171 I*****                                  74  740CTSI          *****   S01194
0172 I*****                               P  75  770ELAC          *****   S01194
0173 I*****                               P  78  800ECAC          *****   S01194
0174 I*****                               P  90  920LCD           *****   S01194
0175 I*****                                  93  93 CHTP          *****   S01194
0176 I*****                               P  94  960TNLU          *****   S01194
0177 I*
0178 I*
0179 I*****TABLE,TE*ACCOUNT*CODES*RECORD*1**=====>TABTE10**************   S01194
0180 I*****   NS  05   1 CD   2 C3   3 C0                         *****   S01194
0181 I*****  AND      13 C1                                       *****   S01194
0182 I*****                                   1   1 RECI          *****   S01194
0183 I*****                                   2   30RECT          *****   S01194
0184 I*****                                   9  120ACOD          *****   S01194
0185 I*****                                  13  130SREC          *****   S01194
0186 I*****                                  14  38 ACKN          *****   S01194
0187 I*****                                  39  39 ATYP          *****   S01194
0188 I*****                               P  40  420SHLC          *****   S01194
0189 I*****                               P  43  450SHFC          *****   S01194
0190 I*****                                  48  48 TITO          *****   S01194
0191 I*****                                  49  520BSDR          *****   S01194
0192 I*****                                  53  560BSCR          *****   S01194
0193 I*****                                  57  600PLDR          *****   S01194
0194 I*****                                  61  640PLCR          *****   S01194
0195 I*****                                  65  740RPCD          *****   S01194
0196 I*****                                  75  76 ACCS          *****   S01194
0197 I*****                                  77  77 STYP          *****   S01194
0198 I*****                               P  90  920LCD           *****   S01194
0199 I*****                                  93  93 CHTP          *****   S01194
0200 I*****                               P  94  960TNLU          *****   S01194
0201 I*****TABLE,TR*BRANCH*CODES*RECORD**=====>TABLETR*****************   S01194
0202 I*ABLE***NS**12***1*CD***2*C1***3*C0                         *****   S01194
0203 I*****                                   1   1 RECI          *****   S01194
0204 I*****                                   2   30RECT          *****   S01194
0205 I*****                                  11  130BRCD          *****   S01194
0206 I*****                                  14  43 BRNM          *****   S01194
0207 I*****                                  44  490BICN          *****   S01194
0208 I*****                                  50  51 LOCC          *****   S01194
0209 I*****                                  52  53 CMPY          *****   S01194
0210 I*****                               P  90  920LCD           *****   S01194
0211 I*****                                  93  93 CHTP          *****   S01194
0212 I*****                               P  94  960TNLU          *****   S01194
0213 I*
0214 I*
0215 I*****TABLE**TABLE,TG*CURRENCIES*RECORDS*1&2**=====>TABTG10*******   S01194
0216 I*****   NS  13   1 CD   2 C2   3 C0                         *****   S01194
0217 I*****                                   1   1 RECI          *****   S01194
0218 I*****                                   2   30RECT          *****   S01194
0219 I*****                                  10  12 CCY           *****   S01194
0220 I*****                                  13  130SREC          *****   S01194
0221 I*****                                  14  27 CCNM          *****   S01194
0222 I*****                               P  28  348SPOT          *****   S01194
0223 I*****                                  35  37 CCYS          *****   S01194
0224 I*****                                  38  380CDP           *****   S01194
0225 I*****                                  39  390TNOT          *****   S01194
0226 I*****                                  40  40 DCCY          *****   S01194
0227 I*****                                  41  44 SRC1          *****   S01194
0228 I*****                                  45  48 SRC2          *****   S01194
0229 I*****                                  49  520TACC          *****   S01194
0230 I*****                                  53  560TEQV          *****   S01194
0231 I*****                                  57  600SWQV          *****   S01194
0232 I*****                                  61  640TAC4          *****   S01194
0233 I*****                                  65  680TAC5          *****   S01194
0234 I*****                                  69  69 HIND          *****   S01194
0235 I*****                               P  70  768PART          *****   S01194
0236 I*****                                  77  780SSNO          *****   S01194
0237 I*****                               P  79  858ERLC          *****   S01194
0238 I*****                                  86  860MDIN          *****   S01194
0239 I*****                               P  90  920LCD           *****   S01194
0240 I*****                                  93  93 CHTP          *****   S01194
0241 I*****                               P  94  960TNLU          *****   S01194
0242 I*****TABLE*FILE*CATCHALL*****************************************   S01194
0243 I*****   NS  11                                              *****   S01194
0244 I*
0245 I*****TABLE2*TABLE,TR*BRANCH*CODES*RECORD**=====>TABLETR**********   S01194
0246 I*ABLE2**NS**06***1*CD***2*C1***3*C0                         *****   S01194
0247 I*****                                   1   1 RECI          *****   S01194
0248 I*****                                   2   30RECT          *****   S01194
0249 I*****                                  11  130BRCD          *****   S01194
0250 I*****                                  14  43 BRNM          *****   S01194
0251 I*****                                  44  490BICN          *****   S01194
0252 I*****                                  50  51 LOCC          *****   S01194
0253 I*****                                  52  53 CMPY          *****   S01194
0254 I*****                               P  90  920LCD           *****   S01194
0255 I*****                                  93  93 CHTP          *****   S01194
0256 I*****                               P  94  960TNLU          *****   S01194
0257 I*
0258 I*
0259 I*****TABLE2*TABLE,TG*CURRENCIES*RECORDS*1&2**=====>TABTG20*******   S01194
0260 I*****   NS  07   1 CD   2 C2   3 C0                         *****   S01194
0261 I*****                                   1   1 RECI          *****   S01194
0262 I*****                                   2   30RECT          *****   S01194
0263 I*****                                  10  12 CCY           *****   S01194
0264 I*****                                  13  130SREC          *****   S01194
0265 I*****                                  14  27 CCNM          *****   S01194
0266 I*****                               P  28  348SPOT          *****   S01194
0267 I*****                                  35  37 CCYS          *****   S01194
0268 I*****                                  38  380CDP           *****   S01194
0269 I*****                                  39  390TNOT          *****   S01194
0270 I*****                                  40  40 DCCY          *****   S01194
0271 I*****                                  41  44 SRC1          *****   S01194
0272 I*****                                  45  48 SRC2          *****   S01194
0273 I*****                                  49  520TACC          *****   S01194
0274 I*****                                  53  560TEQV          *****   S01194
0275 I*****                                  57  600SWQV          *****   S01194
0276 I*****                                  61  640TAC4          *****   S01194
0277 I*****                                  65  680TAC5          *****   S01194
0278 I*****                                  69  69 HIND          *****   S01194
0279 I*****                               P  70  768PART          *****   S01194
0280 I*****                                  77  780SSNO          *****   S01194
0281 I*****                               P  79  858ERLC          *****   S01194
0282 I*****                                  86  860MDIN          *****   S01194
0283 I*****                               P  90  920LCD           *****   S01194
0284 I*****                                  93  93 CHTP          *****   S01194
0285 I*****                               P  94  960TNLU          *****   S01194
0286 I*
0287 I*
0288 I*
0289 I*****TABLE2*FILE*CATCHALL****************************************   S01194
0290 I*****   NS  08                                              *****   S01194
0291 I*****                                   1   1 RECI          *****   S01194
0292 I*****                                   2   30RECT          *****   S01194
0293 I/EJECT
0294 I*    ACCNT DETAIL
0295 IACCNT   NS  09   1 CD
0296 I                                        1   1 RECI
0297 I**********                              2   70CNUM                                      CSD027
0297 I                                        2   7 CNUM                                      CSD027
0298 I                                        8  10 CCY
0299 I**********                             11  140ACOD                                      CGL029
0299 I                                       11  140ACODQQ                                    CGL029
0300 I                                       15  160ACSQ
0301 I*****                                  23  250BRCD          *****   S01117
0301 I                                       23  25 BRCA                  S01117
0302 I                                       26  26 ATYP
0303 I                                       27  27 STYP
0304 I                                       29  29 ACST
0305 I                                    P  30  320DACO
0306 I                                    P  33  350DACC
0307 I                                       36  55 ANAM
0308 I                                    P  56  630LDBL
0309 I                                    P  64  710CLBL
0310 I                                       72  72 STFQ
0311 I                                       73  740STDY
0312 I                                    P  75  770LSTD
0313 I                                    P  78  800NSTD
0314 I                                    P  81  820LSTP
0315 I                                    P  83  900CFSB
0316 I                                    P  91  930LMVD
0317 I                                    P  94 1010EPLB
0318 I                                    P 102 1090EPCB
0319 I                                    P 110 1170YTDB
0320 I                                      118 118 GLBT
0321 I                                    P 138 1400DLIM
0322 I                                    P 141 1430LRCR
0323 I                                    P 144 1510RTCB
0324 I                                    P 152 1590RTLB
0325 I                                    P 160 1660DITM
0326 I                                    P 167 1730CITM
0327 I                                    P 178 1837CDIR
0328 I                                    P 184 1897CCIR
0329 I                                    P 178 1837CDIR
0330 I                                    P 184 1897CCIR
0331 I                                      190 1990ACNO
0332 I                                      200 200 RETB
0333 I                                      201 201 ODSC
0334 I                                    P 202 2070ODLN
0335 I                                    P 208 2100ODED
0336 I                                    P 211 2120DIOD
0337 I                                      213 2150FACT
0338 I                                      216 2170FCNO
0339 I                                      218 219 EFAC
0340 I                                    P 220 2270HELD
0341 I                                    P 228 2330MINB
0342 I                                    P 234 2360LACD
0343 I                                    P 237 2380LISP
0344 I                                    P 239 2410RRNM
0345 I                                      242 2430DRIB
0346 I                                    P 244 2497DRIS
0347 I                                    P 250 2520DRCD
0348 I                                      253 2530DRIC
0349 I                                      254 254 DRIF
0350 I                                      255 2560DRDY
0351 I                                    P 257 2590NDID
0352 I                                    P 260 2620LDID
0353 I                                    P 263 2690LDIA
0354 I                                      270 270 SDAP
0355 I                                    P 271 2730LPAR
0356 I                                    P 274 2800DIIE
0357 I                                    P 281 2882DAIC
0358 I                                    P 289 2950MADI
0359 I                                    P 296 3020GADI
0360 I                                      303 303 DDIS
0361 I                                    P 304 3060DDIA
0362 I                                    P 307 3090OLDR
0363 I                                      310 3110OLDB
0364 I                                    P 312 3177OLDS
0365 I                                      318 3190CRIB
0366 I                                    P 320 3257CRIS
0367 I                                    P 326 3280CRCD
0368 I                                      329 3290CRIC
0369 I                                      330 330 CRIF
0370 I                                      331 3320CRDY
0371 I                                    P 333 3350NCID
0372 I                                    P 336 3380LCID
0373 I                                    P 339 3450LCIA
0374 I                                      346 346 SCAP
0375 I                                    P 347 3490LPAP
0376 I                                    P 350 3560CIIE
0377 I                                    P 357 3642CAIC
0378 I                                    P 365 3710MACI
0379 I                                    P 372 3780GACI
0380 I                                      379 379 CDIS
0381 I                                    P 380 3820DCIA
0382 I                                    P 383 3850OLCR
0383 I                                      386 3870OLCB
0384 I                                    P 388 3937OLCS
0385 I                                    P 394 3960LCD
0386 I                                      397 397 CHTP
0387 I                                    P 398 4000TNLU
0299 I************                          401 4100ACOD                              CGL029 BUG1814
 299 I                                      554 5630ACOD                                     BUG1814
0388 I**
0389 I*
0390 I*    ACCNT FILE CATCHALL
0391 I        NS  10
0392 I                                        1   1 RECI
     I/EJECT                                                              CEU011
     IGLACNTL0NS  09   1 CD                                               CEU011
      **  GL Account Master                                               CEU011
      *                                                                   CEU011
     I                                        1   1 RECI                  CEU011
     I**********                              2   70CNUM                               CEU011 CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  10 CCY                   CEU011
     I**********                             11  140ACOD                               CEU011 CGL029
     I**********                             15  160ACSQ                               CEU011 CGL029
     I**********                             23  25 BRCA                               CEU011 CGL029
     I**********                             26  26 ATYP                               CEU011 CGL029
     I**********                             27  27 STYP                               CEU011 CGL029
     I**********                             29  29 ACST                               CEU011 CGL029
     I**********                          P  30  320DACO                               CEU011 CGL029
     I**********                          P  33  350DACC                               CEU011 CGL029
     I**********                             36  55 ANAM                               CEU011 CGL029
     I**********                          P  56  630LDBL                               CEU011 CGL029
     I**********                          P  64  710CLBL                               CEU011 CGL029
     I**********                             72  72 STFQ                               CEU011 CGL029
     I**********                             73  740STDY                               CEU011 CGL029
     I**********                          P  75  770LSTD                               CEU011 CGL029
     I**********                          P  78  800NSTD                               CEU011 CGL029
     I**********                          P  81  820LSTP                               CEU011 CGL029
     I**********                          P  83  900CFSB                               CEU011 CGL029
     I**********                          P  91  930LMVD                               CEU011 CGL029
     I**********                          P  94 1010EPLB                               CEU011 CGL029
     I**********                          P 102 1090EPCB                               CEU011 CGL029
     I**********                          P 110 1170YTDB                               CEU011 CGL029
     I**********                            118 118 GLBT                               CEU011 CGL029
     I**********                          P 138 1400DLIM                               CEU011 CGL029
     I**********                          P 141 1430LRCR                               CEU011 CGL029
     I**********                          P 144 1510RTCB                               CEU011 CGL029
     I**********                          P 152 1590RTLB                               CEU011 CGL029
     I**********                          P 160 1660DITM                               CEU011 CGL029
     I**********                          P 167 1730CITM                               CEU011 CGL029
     I**********                          P 178 1837CDIR                               CEU011 CGL029
     I**********                          P 184 1897CCIR                               CEU011 CGL029
     I**********                          P 178 1837CDIR                               CEU011 CGL029
     I**********                          P 184 1897CCIR                               CEU011 CGL029
     I**********                            190 1990ACNO                               CEU011 CGL029
     I**********                            200 200 RETB                               CEU011 CGL029
     I**********                            201 201 ODSC                               CEU011 CGL029
     I**********                          P 202 2070ODLN                               CEU011 CGL029
     I**********                          P 208 2100ODED                               CEU011 CGL029
     I**********                          P 211 2120DIOD                               CEU011 CGL029
     I**********                            213 2150FACT                               CEU011 CGL029
     I**********                            216 2170FCNO                               CEU011 CGL029
     I**********                            218 219 EFAC                               CEU011 CGL029
     I**********                          P 220 2270HELD                               CEU011 CGL029
     I**********                          P 228 2330MINB                               CEU011 CGL029
     I**********                          P 234 2360LACD                               CEU011 CGL029
     I**********                          P 237 2380LISP                               CEU011 CGL029
     I**********                          P 239 2410RRNM                               CEU011 CGL029
     I**********                            242 2430DRIB                               CEU011 CGL029
     I**********                          P 244 2497DRIS                               CEU011 CGL029
     I**********                          P 250 2520DRCD                               CEU011 CGL029
     I**********                            253 2530DRIC                               CEU011 CGL029
     I**********                            254 254 DRIF                               CEU011 CGL029
     I**********                            255 2560DRDY                               CEU011 CGL029
     I**********                          P 257 2590NDID                               CEU011 CGL029
     I**********                          P 260 2620LDID                               CEU011 CGL029
     I**********                          P 263 2690LDIA                               CEU011 CGL029
     I**********                            270 270 SDAP                               CEU011 CGL029
     I**********                          P 271 2730LPAR                               CEU011 CGL029
     I**********                          P 274 2800DIIE                               CEU011 CGL029
     I**********                          P 281 2882DAIC                               CEU011 CGL029
     I**********                          P 289 2950MADI                               CEU011 CGL029
     I**********                          P 296 3020GADI                               CEU011 CGL029
     I**********                            303 303 DDIS                               CEU011 CGL029
     I**********                          P 304 3060DDIA                               CEU011 CGL029
     I**********                          P 307 3090OLDR                               CEU011 CGL029
     I**********                            310 3110OLDB                               CEU011 CGL029
     I**********                          P 312 3177OLDS                               CEU011 CGL029
     I**********                            318 3190CRIB                               CEU011 CGL029
     I**********                          P 320 3257CRIS                               CEU011 CGL029
     I**********                          P 326 3280CRCD                               CEU011 CGL029
     I**********                            329 3290CRIC                               CEU011 CGL029
     I**********                            330 330 CRIF                               CEU011 CGL029
     I**********                            331 3320CRDY                               CEU011 CGL029
     I**********                          P 333 3350NCID                               CEU011 CGL029
     I**********                          P 336 3380LCID                               CEU011 CGL029
     I**********                          P 339 3450LCIA                               CEU011 CGL029
     I**********                            346 346 SCAP                               CEU011 CGL029
     I**********                          P 347 3490LPAP                               CEU011 CGL029
     I**********                          P 350 3560CIIE                               CEU011 CGL029
     I**********                          P 357 3642CAIC                               CEU011 CGL029
     I**********                          P 365 3710MACI                               CEU011 CGL029
     I**********                          P 372 3780GACI                               CEU011 CGL029
     I**********                            379 379 CDIS                               CEU011 CGL029
     I**********                          P 380 3820DCIA                               CEU011 CGL029
     I**********                          P 383 3850OLCR                               CEU011 CGL029
     I**********                            386 3870OLCB                               CEU011 CGL029
     I**********                          P 388 3937OLCS                               CEU011 CGL029
     I**********                          P 394 3960LCD                                CEU011 CGL029
     I**********                            397 397 CHTP                               CEU011 CGL029
     I**********                          P 398 4000TNLU                               CEU011 CGL029
     I**********                            440 440 INCY                               CEU011 CGL029
     I                                       11  200ACOD                                      CGL029
     I                                       21  220ACSQ                                      CGL029
     I                                       29  31 BRCA                                      CGL029
     I                                       32  32 ATYP                                      CGL029
     I                                       33  33 STYP                                      CGL029
     I                                       34  34 ACST                                      CGL029
     I                                    P  36  380DACO                                      CGL029
     I                                    P  39  410DACC                                      CGL029
     I                                       42  61 ANAM                                      CGL029
     I                                    P  62  690LDBL                                      CGL029
     I                                    P  70  770CLBL                                      CGL029
     I                                       78  78 STFQ                                      CGL029
     I                                       79  800STDY                                      CGL029
     I                                    P  81  830LSTD                                      CGL029
     I                                    P  84  860NSTD                                      CGL029
     I                                    P  87  880LSTP                                      CGL029
     I                                    P  89  960CFSB                                      CGL029
     I                                    P  97  990LMVD                                      CGL029
     I                                    P 100 1070EPLB                                      CGL029
     I                                    P 108 1150EPCB                                      CGL029
     I                                    P 116 1230YTDB                                      CGL029
     I                                      124 124 GLBT                                      CGL029
     I                                    P 144 1460DLIM                                      CGL029
     I                                    P 147 1490LRCR                                      CGL029
     I                                    P 150 1570RTCB                                      CGL029
     I                                    P 158 1650RTLB                                      CGL029
     I                                    P 166 1720DITM                                      CGL029
     I                                    P 173 1790CITM                                      CGL029
     I                                    P 184 1897CDIR                                      CGL029
     I                                    P 190 1957CCIR                                      CGL029
     I                                    P 184 1897CDIR                                      CGL029
     I                                    P 190 1957CCIR                                      CGL029
     I                                      196 2050ACNO                                      CGL029
     I                                      206 206 RETB                                      CGL029
     I                                      207 207 ODSC                                      CGL029
     I                                    P 208 2130ODLN                                      CGL029
     I                                    P 214 2160ODED                                      CGL029
     I                                    P 217 2180DIOD                                      CGL029
     I                                      219 2210FACT                                      CGL029
     I                                      222 2230FCNO                                      CGL029
     I                                      224 225 EFAC                                      CGL029
     I                                    P 226 2330HELD                                      CGL029
     I                                    P 234 2390MINB                                      CGL029
     I                                    P 240 2420LACD                                      CGL029
     I                                    P 243 2440LISP                                      CGL029
     I                                    P 245 2470RRNM                                      CGL029
     I                                      248 2490DRIB                                      CGL029
     I                                    P 250 2557DRIS                                      CGL029
     I                                    P 256 2580DRCD                                      CGL029
     I                                      259 2590DRIC                                      CGL029
     I                                      260 260 DRIF                                      CGL029
     I                                      261 2620DRDY                                      CGL029
     I                                    P 263 2650NDID                                      CGL029
     I                                    P 266 2680LDID                                      CGL029
     I                                    P 269 2750LDIA                                      CGL029
     I                                      276 276 SDAP                                      CGL029
     I                                    P 277 2790LPAR                                      CGL029
     I                                    P 280 2860DIIE                                      CGL029
     I                                    P 287 2942DAIC                                      CGL029
     I                                    P 295 3010MADI                                      CGL029
     I                                    P 302 3080GADI                                      CGL029
     I                                      309 309 DDIS                                      CGL029
     I                                    P 310 3120DDIA                                      CGL029
     I                                    P 313 3150OLDR                                      CGL029
     I                                      316 3170OLDB                                      CGL029
     I                                    P 318 3237OLDS                                      CGL029
     I                                      324 3250CRIB                                      CGL029
     I                                    P 326 3317CRIS                                      CGL029
     I                                    P 332 3340CRCD                                      CGL029
     I                                      335 3350CRIC                                      CGL029
     I                                      336 336 CRIF                                      CGL029
     I                                      337 3380CRDY                                      CGL029
     I                                    P 339 3410NCID                                      CGL029
     I                                    P 342 3440LCID                                      CGL029
     I                                    P 345 3510LCIA                                      CGL029
     I                                      352 352 SCAP                                      CGL029
     I                                    P 353 3550LPAP                                      CGL029
     I                                    P 356 3620CIIE                                      CGL029
     I                                    P 363 3702CAIC                                      CGL029
     I                                    P 371 3770MACI                                      CGL029
     I                                    P 378 3840GACI                                      CGL029
     I                                      385 385 CDIS                                      CGL029
     I                                    P 386 3880DCIA                                      CGL029
     I                                    P 389 3910OLCR                                      CGL029
     I                                      392 3930OLCB                                      CGL029
     I                                    P 394 3997OLCS                                      CGL029
     I                                    P 400 4020LCD                                       CGL029
     I                                      403 403 CHTP                                      CGL029
     I                                    P 404 4060TNLU                                      CGL029
     I                                      452 452 INCY                                      CGL029
     I        NS  10                                                      CEU011
      **   ACCNT FILE CATCHALL                                            CEU011
      *                                                                   CEU011
     I                                        1   1 RECI                  CEU011
0393 I/EJECT
0392 ISDBANK    E DSSDBANKPD                                              S01194
0393 I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
0393 I*                                                                   S01194
0392 ISDTRAD    E DSSDTRADPD                                              S01194
0393 I* TRADING DETAILS ACCESSED VIA ACCESS PROGRAM                       S01194
0393 I*
     ISDMMOD    E DSSDMMODPD                                              S01522
     I* Module Details Accessed via access program                        S01522
     I*                                                                   S01522
     ISCSARD    E DSSCSARDPD                                              S01522
     I* SAR File Details Accessed via access program AOSARDR0             S01522
     I*                                                                   S01522
     ICGPNAR    E DSCGPNARPD                                              S01522
     I* UDC Multi-Language Narrative Data Structure                       S01522
     I*                                                                   S01522
     I##PRM1      DS                                                      086125
      **  Data Structure for Customer and Branch                          086125
      *                                                                   086125
     I                                        1   6 A#CUST                086125
     I                                        7   9 A#BRCA                086125
      *                                                                   086125
     ISDCUST    E DSSDCUSTPD                                              S01522
     I* Customer Datails                                                  S01522
     I*                                                                   S01522
0392 ISDGELR    E DSSDGELRPD                                              S01194
0393 I* LEDGER DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
0393 I*
     I              QQACCD                          QQACC2                                    CGL029
0392 ISDACOD    E DSSDACODPD                                              S01194
0393 I* ACCOUNT CODE DETAILS ACCESSED VIA ACCESS PROGRAM                  S01194
0393 I*
     I              QQACCD                          QQACC3                                    CGL029
0392 ISDCURR    E DSSDCURRPD                                              S01194
0393 I* CURRENCIES DETAILS ACCESSED VIA ACCESS PROGRAM                    S01194
0393 I*
0392 ISDBRCH    E DSSDBRCHPD                                              S01194
0393 I* BRANCH CODE DETAILS ACCESSED VIA ACCESS PROGRAM                   S01194
     I*
     I              QQDFAC                          QQDFA1                                    CGL029
     I***/COPY*WNCPYSRC,DL0450I001                                                            CFC006
     I/COPY WNCPYSRC,DL0450I001                                                             MD020563
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*
     IRUNDAT      DS                                                      S01194
     I** DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.           S01194
     I                                       13  13 @MBIN                 S01194
     I*
     I*********** DS                                               E11096 E15192
     I***DEFINITION OF ALPHA DATES FOR TODAY AND NEXT WORKING DAY  E11096 E15192
     I***TO*TEST*FOR END OF MONTH                                  E11096 E15192
     I***********                             1   7 ZADATE         E11096 E15192
     I***********                             3   5 ZMMM           E11096 E15192
     I***********                             8  14 RUNA           E11096 E15192
     I***********                            10  12 RUNMMM         E11096 E15192
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I**   AUDIT FILE INFORMATION DATA STRUCTURE                          S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I* Named constant:                                                   S01522
     I*                                                                   S01522
     I              'SPOT REVALUATION'    C         ##SPOT                S01522
     I              9999999999900         C         WLMTPA                                    202042
     I              'DL0450001'           C         SECTN                                     CFC006
     I***/COPY*WNCPYSRC,DL0450I002                                                            CFC006
     I/COPY WNCPYSRC,DL0450I002                                                             MD020563
      /EJECT                                                              S01117
     C**                                                                  S01117
     C*********  *ENTRY    PLIST                                    S01117E243
     C*********            PARM           SEQ     5                 S01117E243
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP12                                           S01408
      *                                                                   S01408
     C*
     C** GET MULTI BRANCH INDICATOR FROM DATA AREA - RUNDAT               S01194
     C           *NAMVAR   DEFN           RUNDAT                          S01194
     C                     IN   RUNDAT                                    S01194
     C*
0394 C**** PSEUDO 1ST CYCLE PROCESSING ****
     C                     Z-ADD0         ZERO15 150                      S01182
     C                     Z-ADD0         VOIN    10                      S10736
     C*
0395 C**** ACCESS ICDR1 VIA ZSYSTM************************************    S01194
0396 C****                 EXSR ZSYSTM                           *****    S01194
0397 C***99                SETON                     U7U8        *****    S01194
0398 C***99                GOTO END                              *****    S01194
0399 C*
0399 C**   READ BANK DETAILS VIA ACCESS PROGRAM                           S01194
0395 C                     CALL 'AOBANKR0'                                S01194
0396 C                     PARM '*MSG   ' @RTCD   7                       S01194
0397 C                     PARM '*FIRST ' @OPTN   7                       S01194
0398 C           SDBANK    PARM SDBANK    DSFDY                           S01194
0396 C           @RTCD     IFNE *BLANK                                    S01194
0398 C                     MOVEL'SDBANKPD'DBFILE 10                       S01194
0398 C                     MOVEL'001'     DBASE   3        * * * * * * *  S01194
0397 C                     MOVEL@OPTN     DBOPTN  7        * DBERR 001 *  S01194
0398 C                     MOVEL'*FIRST ' DBKEY  29        * * * * * * *  S01194
0397 C                     SETON                     U7U8                 S01194
0398 C                     EXSR *PSSR                                     S01194
0397 C                     GOTO END                                       S01194
0398 C                     END                                            S01194
      *                                                                   S01522
      **  Call Module Prog. for Module Details.                           S01522
     C                     CALL 'AOMMODR0'                                S01522
     C                     PARM '*MSG   ' @RTCD                           S01522
     C                     PARM '*FIRST ' @OPTN                           S01522
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01522
      *                                                                   S01522
     C           @RTCD     IFNE *BLANK                     B1             S01522
     C                     MOVEL'SDMMODPD'DBFILE           * * * * * * *  S01522
     C                     MOVEL'086'     DBASE            * DBERR 086 *  S01522
     C                     MOVEL@OPTN     DBOPTN           * * * * * * *  S01522
     C                     MOVEL@OPTN     DBKEY             1             S01522
     C                     EXSR *PSSR                       1             S01522
     C                     SETON                     U7U8   1             S01522
     C                     GOTO END                         1             S01522
     C                     ELSE                            X1             S01522
     C/COPY WNCPYSRC,DLH00452
      *                                                                   S01522
      **  Call SAR Prog. for switchable feature                           S01522
     C           BGN1ST    IFEQ 'Y'                        B2             S01522
     C/COPY WNCPYSRC,DLH00453
     C*                                                                   S01522
     C                     CALL 'AOSARDR0'                  2             S01522
     C                     PARM '       ' @RTCD             2             S01522
     C                     PARM '*VERIFY' @OPTN             2             S01522
     C                     PARM 'DLPNAR'  @SARD   6         2             S01522
     C           SCSARD    PARM SCSARD    DSFDY             2             S01522
     C*                                                                   S01522
     C           @RTCD     IFNE *BLANK                     B3             S01522
     C           @RTCD     ANDNE'*NRF   '                   3             S01522
     C                     MOVEL'SCSARDPD'DBFILE            ************* S01522
     C                     MOVEL'089'     DBASE             *DBERROR 089* S01522
     C                     MOVEL@RTCD     DBKEY             * * * * * * * S01522
     C                     EXSR *PSSR                       3             S01522
     C                     SETON                     U7U8   3             S01522
     C                     GOTO END                         3             S01522
     C                     END                             E3             S01522
     C*                                                                   S01522
     C           @RTCD     IFEQ *BLANK                     B3             S01522
     C                     MOVEL'Y'       DLPNAR  1         3             S01522
     C                     END                             E3             S01522
     C                     END                             E2             S01522
     C                     END                             E1             S01522
      *                                                                                       CGL020
      ** Access SAR details to see if CGL020 is enabled.                                      CGL020
      *                                                                                       CGL020
     C                     CALL 'AOSARDR0'                                                    CGL020
     C                     PARM *BLANKS   @RTCD                                               CGL020
     C                     PARM '*VERIFY' @OPTN                                               CGL020
     C                     PARM 'CGL020'  @SARD                                               CGL020
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL020
      *                                                                                       CGL020
     C           @RTCD     IFEQ *BLANKS                                                       CGL020
     C                     MOVE *BLANK    FEEFLG  1                                           CGL020
     C                     Z-ADD0         FEEVAL 130                                          CGL020
     C                     Z-ADD0         FEEPCT  52                                          CGL020
     C                     MOVE *BLANKS   TICKER 10                                           CGL020
     C                     MOVE *BLANKS   EXCHNG 20                                           CGL020
     C                     Z-ADD0         NOMINL 132                                          CGL020
     C                     ELSE                                                               CGL020
      *                                                                                       CGL020
     C           @RTCD     IFNE '*NRF'                                                        CGL020
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL020
     C                     MOVEL'090'     DBASE                                               CGL020
     C                     MOVEL@SARD     DBKEY                                               CGL020
     C                     MOVE *ON       *INU7                                               CGL020
     C                     MOVE *ON       *INU8                                               CGL020
     C                     EXSR *PSSR                                                         CGL020
     C                     GOTO END                                                           CGL020
     C                     ENDIF                                                              CGL020
      *                                                                                       CGL020
     C                     ENDIF                                                              CGL020
0399 C*
0400 C*****ACCESS*ICDR2************************************************   S01194
0401 C*****                MOVEL'01      'TABKEY 12               *****   S01194
0402 C*****                MOVE '  11'    TABKEY                  *****   S01194
0403 C*****      TABKEY    CHAINTABLE                50           *****   S01194
0404 C***50                SETON                     U7U8         *****   S01194
0405 C***50                GOTO END                               *****   S01194
0399 C*
0399 C**   READ GENERAL LEDGER DETAILS VIA ACCESS PROGRAM                 S01194
0395 C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
0396 C                     PARM '*MSG   ' @RTCD   7                       S01194
0397 C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
0396 C           @RTCD     IFNE *BLANK                                    S01194
0398 C                     MOVEL'SDGELRPD'DBFILE 10                       S01194
0398 C                     MOVEL'002'     DBASE   3        * * * * * * *  S01194
0397 C                     MOVEL@OPTN     DBOPTN  7        * DBERR 002 *  S01194
0398 C                     MOVEL'*FIRST ' DBKEY  29        * * * * * * *  S01194
0397 C                     SETON                     U7U8                 S01194
0398 C                     EXSR *PSSR                                     S01194
0397 C                     GOTO END                                       S01194
0398 C                     END                                            S01194
      *                                                                   CEU011
      ** Check if Position/Risk Enquiries & Reports switchable            CEU011
      ** feature is on.                                                   CEU011
      *                                                                   CEU011
     C                     CALL 'AOSARDR0'                                CEU011
     C                     PARM '       ' WLRTCD  7                       CEU011
     C                     PARM '*VERIFY' WLOPTN  7                       CEU011
     C                     PARM 'CEU011'  @SARD   6                       CEU011
     C           SCSARD    PARM SCSARD    DSFDY                           CEU011
      *                                                                   CEU011
     C           WLRTCD    IFNE *BLANKS                                   CEU011
     C           WLRTCD    ANDNE'*NRF   '                                 CEU011
     C                     MOVEL'CEU011'  DBKEY            ************   CEU011
     C                     MOVE 'SCSARDPD'DBFILE           * DBERR  05*   CEU011
     C                     MOVEL'005'     DBASE            ************   CEU011
     C                     SETON                     U7U8LR               CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           WLRTCD    IFEQ *BLANKS                                   CEU011
     C                     MOVE 'Y'       CEU011  1                       CEU011
     C                     MOVE '1'       *IN29                           CEU011
     C                     ELSE                                           CEU011
     C                     MOVE 'N'       CEU011                          CEU011
     C                     MOVE '0'       *IN29                           CEU011
     C                     ENDIF                                          CEU011
0399 C*
0406 C*
0407 C*****ACCESS*ICDR3************************************************   S01194
0408 C*****                MOVEL'01      'TABKEY                  *****   S01194
0409 C*****                MOVE '  20'    TABKEY                  *****   S01194
0410 C*****      TABKEY    CHAINTABLE                51           *****   S01194
0411 C***51                SETON                     U7U8         *****   S01194
0412 C***51                GOTO END                               *****   S01194
0399 C*
0399 C**   READ TRADING DETAILS VIA ACCESS PROGRAM                        S01194
0395 C                     CALL 'AOTRADR0'                                S01194
0396 C                     PARM '*MSG   ' @RTCD   7                       S01194
0397 C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
0396 C           @RTCD     IFNE *BLANK                                    S01194
0398 C                     MOVEL'SDTRADPD'DBFILE 10                       S01194
0398 C                     MOVEL'003'     DBASE   3        * * * * * * *  S01194
0397 C                     MOVEL@OPTN     DBOPTN  7        * DBERR 003 *  S01194
0398 C                     MOVEL'*FIRST ' DBKEY  29        * * * * * * *  S01194
0397 C                     SETON                     U7U8                 S01194
0398 C                     EXSR *PSSR                                     S01194
0397 C                     GOTO END                                       S01194
0398 C                     END                                            S01194
     C***/COPY*WNCPYSRC,DL0450C001                                                            CFC006
     C/COPY WNCPYSRC,DL0450C001                                                             MD020563
      *****************************************************************           AR1097176 MD020563
      ***Chek*if*CFC006*is*installed***********************************           AR1097176 MD020563
      *****************************************************************           AR1097176 MD020563
     C**********           MOVE 'N'       CFC006  1                               AR1097176 MD020563
     C**********           CALL 'AOSARDR0'                                        AR1097176 MD020563
     C**********           PARM *BLANKS   @RTCD                                   AR1097176 MD020563
     C**********           PARM '*VERIFY' @OPTN                                   AR1097176 MD020563
     C**********           PARM 'CFC006'  @SARD                                   AR1097176 MD020563
     C********** SCSARD    PARM SCSARD    DSFDY                                   AR1097176 MD020563
      *****************************************************************           AR1097176 MD020563
     C********** @RTCD     IFEQ *BLANKS                                           AR1097176 MD020563
     C**********           MOVE 'Y'       CFC006                                  AR1097176 MD020563
     C**********           ELSE                                                   AR1097176 MD020563
      *****************************************************************           AR1097176 MD020563
     C********** @RTCD     IFNE '*NRF   '                                         AR1097176 MD020563
     C**********           MOVEL'SCSARDPD'DBFILE                                  AR1097176 MD020563
     C**********           MOVEL'CFC006'  DBKEY                                   AR1097176 MD020563
     C**********           SETON                     U7U8LR                       AR1097176 MD020563
     C**********           EXSR *PSSR                                             AR1097176 MD020563
     C**********           GOTO END                                               AR1097176 MD020563
     C**********           ENDIF                                                  AR1097176 MD020563
     C**********           ENDIF                                                  AR1097176 MD020563
      *                                                                                       CFC006
      ** Enable output indicator for DL0450P1                                                 CFC006
      *                                                                                       CFC006
     C                     MOVEL'N'       SUPFLG  1                                           CFC006
     C********** CFC006    IFEQ 'Y'                                               AR1097176 MD020563
      *                                                                                    AR1097176
     C                     CALL 'AOCOMR0'                                                     CFC006
     C                     PARM 'DLC07  ' PNAME  10                                           CFC006
     C                     PARM '*ALL '   PCSEQ   5                                           CFC006
     C                     PARM SECTN     PSCTN  50                                           CFC006
     C                     PARM *BLANKS   PRTCD                                               CFC006
      *                                                                                       CFC006
     C           PRTCD     IFEQ 'Y      '                                                     CFC006
     C                     MOVEL'Y'       SUPFLG                                              CFC006
     C                     ENDIF                                                              CFC006
      *                                                                                    AR1097176
     C**********           ENDIF                                                  AR1097176 MD020563
0413 C*
0414 C*    SET UP CERTAIN FIELDS FOR OUTPUT TO GESR
0415 C                     BITOF'01234567'ZBITOF  1
0416 C                     Z-ADD0         ACNO   100
0417 C**********           MOVE '     '   TRAT    5                                        AR813358A
0417 C                     MOVE '00000'   TRAT    5                                        AR813358A
     C                     Z-ADD0         LTAI    10                                       AR813358A
     C                     Z-ADD0         XRFN   100                                       AR813358A
     C                     Z-ADD0         SETDAT  50                                       AR813358A
0418 C**********           Z-ADD0         ASOC    60                                          CSD027
0418 C                     MOVE *BLANKS   ASOC    6                                           CSD027
0419 C                     Z-ADD0         CHQN    80
0420 C                     Z-ADD0         REJC    30
0421 C                     Z-ADD0         RRNM    50
     C                     MOVEACPY@      BIS@   80
     C                     Z-ADD0         ORAMT  130                                       AR813358A
     C                     Z-ADD0         NITMS   50                                       AR813358A
     C                     Z-ADD0         CHGA   130                                       AR813358A
0422 C*
0423 C*
0424 C*    DEFINE SPOT VALUE,SPOVL
0425 C                     Z-ADD0         SPOVL  150
0426 C*
0427 C*    DEFINE EQUIV.BAL.,EQBAL1 TO4 WITH NO.OF DEC.POS. EQUAL BCDP
0428 C                     Z-ADD0         EQBAL  150
0429 C*
0430 C*    EXCEPT OUTPUT FOR HEADER FOR GESR
0431 C*    SET ON IND.TO CONDITION EXCEPT OUTPUT & THEN SET OFF AGAIN
0432 C                     SETON                     86
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP14                                           S01408
      *                                                                   S01408
0433 C                     EXCPT
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP22                                           S01408
      *                                                                   S01408
0434 C                     SETOF                     86
0435 C*
0436 C*****ACCESS TABLE,TE TO GET ACCOUNT TYPE FOR SPOT REVAL.P/L A/C**   S01194
0437 C*****                MOVEL'30     ' WRK2   11               *****   S01194
0438 C*****                MOVE SRPL      WRK2                    *****   S01194
0439 C*****                MOVELWRK2      TABKE2 12               *****   S01194
0440 C*****                MOVE '1'       TABKE2                  *****   S01194
0441 C*****      TABKE2    CHAINTABLE                82           *****   S01194
0399 C**   CHAIN ACCOUNT CODE DETAILS VIA ACCESS PROGRAM                  S01194
     C/COPY WNCPYSRC,DL0450C002
0395 C                     CALL 'AOACODR0'                                S01194
0396 C                     PARM '*MSG   ' @RTCD   7                       S01194
0397 C                     PARM '*KEY   ' @OPTN   7                       S01194
0397 C**********           PARM BLSRAC    @AFNB   4                                    S01194 CGL029
0397 C                     PARM BLSRAC    @AFNB  10                                           CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                                     AR752668
     C           @RTCD     IFNE *BLANK                                                      AR752668
     C                     MOVEL'SDACODPD'DBFILE                                            AR752668
     C                     MOVEL'006'     DBASE                                             AR752668
     C                     MOVEL@OPTN     DBOPTN                                            AR752668
     C                     MOVEL@AFNB     DBKEY                                             AR752668
     C                     SETON                     U7U8LR                                 AR752668
     C                     EXSR *PSSR                                                       AR752668
     C                     GOTO END                                                         AR752668
     C                     END                                                              AR752668
      *                                                                                     AR752668
     C/COPY WNCPYSRC,DL0450C003
0399 C*
0442 C*****                MOVE ATYP      EAT2    1               *****   S01194
0442 C                     MOVE A5ACTY    EAT2    1                       S01194
0442 C                     MOVE A5ACSC    ACC2    2                       S10736
0442 C*****                MOVE ACCS      ACC2    2              E12161   S01194
0442 C*****                MOVE A5ACSC    ACC2    2              S01194   E15192
      *                                                                                       CER051
      ** Retrieve details for Loss A/c Code via access object                                 CER051
      *                                                                                       CER051
     C                     CALL 'AOACODR0'                                                    CER051
     C                     PARM '*MSG   ' @RTCD   7                                           CER051
     C                     PARM '*KEY   ' @OPTN   7                                           CER051
     C                     PARM BLSLAC    @AFNB  10                                           CER051
     C           SDACOD    PARM SDACOD    DSSDY                                               CER051
      *                                                                                     AR752668
     C           @RTCD     IFNE *BLANK                                                      AR752668
     C                     MOVEL'SDACODPD'DBFILE                                            AR752668
     C                     MOVEL'007'     DBASE                                             AR752668
     C                     MOVEL@OPTN     DBOPTN                                            AR752668
     C                     MOVEL@AFNB     DBKEY                                             AR752668
     C                     SETON                     U7U8LR                                 AR752668
     C                     EXSR *PSSR                                                       AR752668
     C                     GOTO END                                                         AR752668
     C                     END                                                              AR752668
      *                                                                                     AR752668
      *                                                                                       CER051
     C                     MOVE A5ACTY    EAT6    1                                           CER051
     C                     MOVE A5ACSC    ACC6    2                                           CER051
0443 C*
0444 C*****ACCESS BASE CCY RCD FOR TRADE EQUIV                    *****   S01194
0445 C*****                MOVEL'20      'WRK3   11               *****   S01194
0446 C*****                MOVE BCCY      WRK3                    *****   S01194
0447 C*****                MOVELWRK3      TABKE3                  *****   S01194
0448 C*****                MOVE '1'       TABKE3                  *****   S01194
0449 C*****      TABKE3    CHAINTABLE                82           *****   S01194
0399 C**   CHAIN CURRENCY CODE DETAILS VIA ACCESS PROGRAM                 S01194
0395 C                     CALL 'AOCURRR0'                                S01194
0396 C                     PARM '*MSG   ' @RTCD   7                       S01194
0397 C                     PARM '*KEY   ' @OPTN   7                       S01194
0397 C                     PARM BJCYCD    @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C                     MOVE A6NBDP    WNBDP   10                      CEU011
     C                     ENDIF                                          CEU011
0399 C*
0450 C*****      TACC      COMP 0                        61       *****   S01194
0451 C**N61                MOVE TACC      BTACC   40              *****   S01194
0399 C*                                                                   S01194
0450 C***********A6SPAE    COMP '0'                      61         S01194E28761
     C/COPY WNCPYSRC,DL0450C004
0450 C           A6SPAE    COMP '0000'                   61               E28761
0450 C  N61      A6SPAE    COMP ' '                      61               E28761
0451 C**N61*****           MOVE A6SPAE    BTACC   40                                   S01194 CGL029
0451 C  N61                MOVE A6SPAE    BTACC  100                                          CGL029
     C/COPY WNCPYSRC,DL0450C005
0452 C*
0453 C*****IF BANK DOESN'T HAVE EQ.A/C CODE FOR BASE DON'T ACCESS TABLE,TES01194
0453 C*    IF BANK DOESN'T HAVE EQ.A/C CODE FOR BASE DON'T ACCOUNT FILE   S01194
0454 C*    FOR ACCOUNT TYPES FOR ENTRIES 3 & 4 TO GESR
0455 C   61                GOTO BUILD
0456 C*
0457 C*****ACCESS TABLE,TE FOR ACCOUNT TYPE FOR SPOT TRADE A/C    *****   S01194
0458 C*****                MOVEL'30     ' WRK3                    *****   S01194
0459 C*****                MOVE SPAC      WRK3                    *****   S01194
0460 C*****                MOVELWRK3      TABKE3 12               *****   S01194
0461 C*****                MOVE '1'       TABKE3                  *****   S01194
0462 C*****      TABKE3    CHAINTABLE                83           *****   S01194
0399 C**   CHAIN ACCOUNT CODE DETAILS VIA ACCESS PROGRAM                  S01194
     C/COPY WNCPYSRC,DL0450C006
0395 C                     CALL 'AOACODR0'                                S01194
0396 C                     PARM '*MSG   ' @RTCD   7                       S01194
0397 C                     PARM '*KEY   ' @OPTN   7                       S01194
0397 C**********           PARM BLSPTA    @AFNB   4                                    S01194 CGL029
0397 C                     PARM BLSPTA    @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                                     AR752668
     C           @RTCD     IFNE *BLANK                                                      AR752668
     C                     MOVEL'SDACODPD'DBFILE                                            AR752668
     C                     MOVEL'008'     DBASE                                             AR752668
     C                     MOVEL@OPTN     DBOPTN                                            AR752668
     C                     MOVEL@AFNB     DBKEY                                             AR752668
     C                     SETON                     U7U8LR                                 AR752668
     C                     EXSR *PSSR                                                       AR752668
     C                     GOTO END                                                         AR752668
     C                     END                                                              AR752668
      *                                                                                     AR752668
     C/COPY WNCPYSRC,DL0450C007
0464 C*
0463 C*****                MOVE ATYP      EAT3    1               *****   S01194
0463 C                     MOVE A5ACTY    EAT3    1                       S01194
0442 C                     MOVE A5ACSC    ACC3    2                       S10736
0464 C*
0465 C*****ACCESS TABLE,TE FOR ACCOUNT TYPE FOR BASE CURRENCY A/C EQUIV.  S01194
0466 C*****                MOVEL'30     ' WRK4   11               *****   S01194
0467 C*****                MOVE BTACC     WRK4                    *****   S01194
0468 C*****                MOVELWRK4      TABKE4 12               *****   S01194
0469 C*****                MOVE '1'       TABKE4                  *****   S01194
0470 C*****      TABKE4    CHAINTABLE                84           *****   S01194
0399 C**   CHAIN ACCOUNT CODE DETAILS VIA ACCESS PROGRAM                  S01194
     C/COPY WNCPYSRC,DL0450C012
0395 C                     CALL 'AOACODR0'                                S01194
0396 C                     PARM '*MSG   ' @RTCD   7                       S01194
0397 C                     PARM '*KEY   ' @OPTN   7                       S01194
0397 C***********          PARM A6SPAE    @AFNB   4                                    S01194 CGL029
0397 C                     PARM A6SPAE    @AFNB                                               CGL029
     C***********SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                                     AR752668
     C           @RTCD     IFNE *BLANK                                                      AR752668
     C                     MOVEL'SDACODPD'DBFILE                                            AR752668
     C                     MOVEL'009'     DBASE                                             AR752668
     C                     MOVEL@OPTN     DBOPTN                                            AR752668
     C                     MOVEL@AFNB     DBKEY                                             AR752668
     C                     SETON                     U7U8LR                                 AR752668
     C                     EXSR *PSSR                                                       AR752668
     C                     GOTO END                                                         AR752668
     C                     END                                                              AR752668
      *                                                                                     AR752668
     C/COPY WNCPYSRC,DL0450C013
0471 C*****                MOVE ATYP      EAT4    1               *****   S01194
0463 C                     MOVE A5ACTY    EAT4    1                       S01194
0442 C                     MOVE A5ACSC    ACC4    2                       S10736
0472 C*
0473 C           BUILD     TAG                             ** BUILD TAG **
0474 C*    *** BUILD ARRAYS ***
0475 C*
0476 C*    CURRENCIES,EQ.A/C CODES & SPOT RATES ARRAYS
0477 C*    DEFINE & SET INDEX
0478 C                     Z-ADD1         Y       30
0479 C*    SET LOWER LIMIT FOR READING SEQUENTIALLY WITHIN LIMITS
0480 C*****                MOVE '20      'KEY1    8               *****   S01194
0481 C*****                MOVELKEY1      LLIM1  12               *****   S01194
0482 C*****                MOVE '   1'    LLIM1                   *****   S01194
0482 C                     MOVE *BLANKS   LLIM1   3
0483 C*****      LLIM1     SETLLTABLE2                            *****   S01194
0483 C           LLIM1     SETLLSDCURRL0                                  S01194
0484 C*
0485 C*    THE 1ST CYCLE - READ SEQUENTIALLY WITHIN LIMITS
0486 C           CYCLE1    TAG                             ** CYCLE1 TAG *
0487 C*
0488 C*    SET OFF IND.07 FOR LATER CHECK TO SEE IF CURRENCIES PASSED
0489 C*****                SETOF                     07           *****   S01194
0490 C*
0491 C*****                READ TABLE2                   46       *****   S01194
0491 C                     READ SDCURRL0                 46               S01194
0492 C   46                GOTO ARRAY2                     END OF FILE
0493 C*
0494 C*****IF REC.ID IS NOT D,IGNORE & REPEAT CYCLE               *****   S01194
0495 C*****      RECI      COMP 'D'                  6969         *****   S01194
0495 C***69      DCCY      COMP 'Y'                  6969         *****   S01194
0495 C           A6DLCI    COMP 'Y'                  6969                 S01194
0496 C   69                GOTO CYCLE1
0497 C*
0498 C*****IF CURRENCIES RECORDS 1 & 2 ARE PASSED PROCEED TO NEXT ARRAY   S01194
0499 C*****                GOTO ARRAY2                            *****   S01194
0500 C*****                                                       *****   S01194
0501 C***** F CURRENCY 2, IGNORE & REPEAT CYCLE                   *****   S01194
0502 C*****      SREC      COMP 1                    4747         *****   S01194
0513 C*****                MOVE A5A5ST    A5SREC  10              *****   S01194
0502 C*****      A5SREC    COMP 1                    4747         *****   S01194
0503 C*****                GOTO CYCLE1                            *****   S01194
0504 C*****                                                       *****   S01194
0505 C*    IF ARRAY IS FULL & THERE ARE STILL MORE CURRENCIES,FINISH-ERROR
0506 C           Y         COMP 200                  43
0507 C   43                SETON                     U8
0508 C   43                GOTO END
0509 C*
0510 C*    MOVE DATA TO APPROPRIATE ARRAY ELEMENTS UNLESS CURRENCY IS BASE
0511 C*    CURRENCY & BANK HAS NO EQ.A/C CODE FOR BASE CURRENCY
0512 C*****      CCY       COMP BCCY                     62       *****   S01194
0512 C           A6CYCD    COMP BJCYCD                   62               S01194
0513 C*****                MOVE CDP       BCCDP   10              *****   S01194
0513 C   62                MOVE A6NBDP    BCCDP   10                      S01194
0514 C   62      BCCDP     COMP 1                      5859
0515 C   62      BCCDP     COMP 2                    68  60
0516 C   61 62             GOTO CYCLE1
0517 C*****                MOVE SPOT      SR,Y                    *****   S01194
0518 C*****                MOVE CDP       CD,Y                    *****   S01194
0519 C*****                MOVE TACC      EQ,Y                    *****   S01194
0520 C*****                MOVE CCY       CY,Y                    *****   S01194
0521 C*****                MOVE MDIN      MD,Y                    *****   S01194
     C/COPY WNCPYSRC,DL0450C010
0522 C*
0517 C                     MOVE A6SPRT    SR,Y                            S01194
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP13                                           S01408
      *                                                                   S01408
0518 C                     MOVE A6NBDP    CD,Y                            S01194
0519 C*****************    MOVE A6SWAE    EQ,Y                      S01194BHF099
0519 C                     MOVE A6SPAE    EQ,Y                            BHF099
0520 C                     MOVE A6CYCD    CY,Y                            S01194
     C*                                                                   139568
     C*** Load the transition start date array.                           139568
     C*                                                                   139568
0520 C                     MOVE A6TPSD    TD,Y                            139568
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C                     MOVE A6INCY    IN,Y                            CEU011
     C                     ENDIF                                          CEU011
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP20                                           S01408
      *                                                                   S01408
0521 C                     MOVE A6MDIN    MD,Y                            S01194
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP21                                           S01408
      *                                                                   S01408
0523 C*
0524 C*    INCREMENT ARRAY INDEX
0525 C           Y         ADD  1         Y
0526 C*    REPEAT 1ST CYCLE
0527 C                     GOTO CYCLE1
0528 C*
0529 C           ARRAY2    TAG                             ** ARRAY2 TAG *
0530 C*
0531 C*****INTERNAL CUSTOMER NO.& BRANCH CODE ARRAYS              *****   S01194
0532 C*****IF SINGLE BRANCH, PROCESS SEPARATELY                   *****   S01194
0532 C** IF MULTI BRANCH INDICATOR NOT EQUAL 'Y'                          S01194
0395 C           @MBIN     IFNE 'Y'                                       S01194
0533 C***15                MOVE DFBR      BR,1                    *****   S01194
0534 C***15                MOVEL'10      'TABKEY                  *****   S01194
0535 C***15                MOVE '    '    TABKEY                  *****   S01194
0536 C***15                MOVE DFBR      TABKEY                  *****   S01194
0537 C***15      TABKEY    CHAINTABLE                50           *****   S01194
0538 C***15N12             SETON                     U7U8         *****   S01194
0539 C***15N12             GOTO END                               *****   S01194
0523 C*
0399 C**   READ BRANCH CODE DETAILS VIA ACCESS PROGRAM                    S01194
0395 C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
0396 C                     PARM '*MSG   ' @RTCD   7                       S01194
0397 C                     PARM '*KEY   ' @OPTN   7                       S01194
0397 C                     PARM BJSBRC    @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
0396 C           @RTCD     IFNE *BLANK                                    S01194
0398 C                     MOVEL'SDBRCHPD'DBFILE 10                       S01194
0398 C                     MOVEL'004'     DBASE   3        * * * * * * *  S01194
0397 C                     MOVEL@OPTN     DBOPTN  7        * DBERR 004 *  S01194
0398 C                     MOVELBJSBRC    DBKEY  29        * * * * * * *  S01194
0397 C                     SETON                     U7U8                 S01194
0398 C                     EXSR *PSSR                                     S01194
0397 C                     GOTO END                                       S01194
0398 C                     END                                            S01194
0399 C*
0540 C*****                MOVE BICN      CM,1                    *****   S01194
0540 C                     MOVE A8BICN    CM,1                            S01194
0540 C                     MOVE BJSBRC    BR,1                            E167
0540 C                     MOVE A8BRNM    BN,1                            E167
0541 C                     GOTO ENDPSU
0398 C                     END                                            S01194
0542 C*    DEFINE & SET INDEX
0543 C*********************Z-ADD1         X       20                      LN0330
0543 C                     Z-ADD1         X       30                      LN0330
0544 C*****SET LOWER LIMIT FOR READING SEQUENTIALLY WITHIN LIMITS *****   S01194
0545 C*****ALSO SET KEY FOR CYCLE TERMINATION WHEN KEY CHANGES    *****   S01194
0546 C*****                MOVEL'10      'KEY2    9               *****   S01194
0547 C*****                MOVE ' '       KEY2                    *****   S01194
0548 C*****                MOVELKEY2      LLIM2   3               *****   S01194
0550 C*    IND.42 WILL BE ON FROM A PREVIOUS CYCLE WHEN THE CUSTOMER ARRAY
0551 C*    WAS LOADED IF THERE WERE MORE CUSTOMERS THAN ARRAY ELEMENTS
0552 C*    IF 42 ON,USE LAST BRANCH CODE PLUS 1 FOR BRANCH CODE IN L.LIMIT
0555 C*
0549 C**N42                MOVE '000'     LLIM2   3               *****   S01194
0549 C  N42                MOVE *BLANKS   LLIM2   3                       S01194
0555 C*
0553 C   42                MOVE BRANCH    LLIM2
0554 C   42                SETOF                     42
0555 C*
0556 C*    THE 2ND CYCLE - READ SEQUENTIALLY WITHIN LIMITS
0557 C*****      LLIM2     SETLLTABLE2                            *****   S01194
0557 C           LLIM2     SETGTSDBRCHL1                                  S01194
0558 C           CYCLE2    TAG                             ** CYCLE2 TAG *
0559 C*
0560 C*****                READ TABLE2                   40       *****   S01194
0560 C                     READ SDBRCHL1                 40               S01194
0561 C   40                GOTO ENDPSU                     END OF FILE
0562 C*****HAS*UPPER*LIMIT*BEEN*PASSED*(IE. KEY CHANGED)?         *****   S01117
0563 C*****      RECI      COMP 'D'                      30       *****   S01117
0564 C*****      RECT      COMP 10                   4141         *****   S01117
0565 C**N30N41             GOTO CYCLE2                     DEL.B  *****   S01117
0566 C***41                GOTO ENDPSU                            *****   S01117
0567 C*
0568 C*****CHECK*BRANCH*NOT*DUPLICATE*OF*DEFAULT**************   S01117   097155
0567 C*
0563 C*****      BRCA      IFEQ DFBR                     *****   S01117   S01194
0563 C********** A8BRCD    IFEQ BJSBRC                ********   S01194   097155
0577 C**********           GOTO CYCLE2                ********   S01117   097155
0577 C**********           END                        ********   S01117   097155
0567 C*
0568 C*    MOVE DATA TO APPROPRIATE ARRAY ELEMENTS
0569 C*****                MOVE BRCD      BR,X                    *****   S01194
0569 C                     MOVE A8BRCD    BR,X                            S01194
0569 C*****                MOVE BRNM      BN,X                    *****   S01194
0569 C                     MOVE A8BRNM    BN,X                            S01194
0570 C*****                MOVE BICN      CM,X                    *****   S01194
0570 C                     MOVE A8BICN    CM,X                            S01194
0571 C*    INCREMENT ARRAY INDEX
0572 C           X         ADD  1         X
0573 C*    IF CUSTOMER ARRAY IS FULL & THERE ARE MORE CUSTOMERS FOR
0574 C*    PROCESSING,THEN SET ON IND.42 - PROGRAM WILL BE REPEATED
0575 C***********X*********COMP 20                   42                   LN0330
0575 C***********X         COMP 100                  42            LN0330 151104
     C           X         COMP 900                  42                   151104
     C*
     C**   CHECK TO PREVENT LOOP
     C*
     C           *IN42     IFEQ '1'
     C*****      BRCD      ANDEQ999                               *****   S01194
     C           A8BRCD    ANDEQ'999'                                     S01194
     C                     SETOF                     42
     C                     END
0576 C*    REPEAT THE 2ND CYCLE UNLESS IND.42 ON
0577 C  N42                GOTO CYCLE2
0578 C*
0579 C           ENDPSU    TAG                             ** ENDPSU TAG *
0580 C*    END OF PSEUDO 1ST CYCLE
0578  /EJECT
0581 C********************************************************************
0582 C*    MAIN PROCESSING
0583 C*    RESET CUSTOMER INDEX
0584 C                     Z-ADD1         X
0585 C*
0586 C           START1    TAG                             ** START1 TAG *
0587 C*    CALCULATIONS FOR EACH INDIVIDUAL CUSTOMER
     C*                                                                   139568
     C*** Reset the branch totals fields so that they don't overflow      139568
     C*** into the next branch, and reset Euro detail line indicator.     139568
     C*                                                                   139568
     C                     Z-ADD0         WPOSBL                          139568
     C                     Z-ADD0         WEQBAL                          139568
     C                     Z-ADD0         WPROLO                          139568
     C*                                                                   139568
0588 C*
0589 C*    IF THIS ELEMENT IN CUSTOMER ARRAY IS ZERO,GO TO FINAL STAGE
0590 C********** CM,X      COMP 0                        67                                   CSD027
0590 C           CM,X      COMP *BLANKS                  67                                   CSD027
0591 C   67                GOTO ENDCUS
0592 C*    RESET CURRENCY INDEX TO 1
0593 C                     Z-ADD1         Y
      *                                                                   BHF346
      **  Set *IN50 to prevent DL0450P1 being opened and closed           BHF346
      **  for each currency of a customer                                 BHF346
      *                                                                   BHF346
     C                     MOVE '1'       *IN50                           BHF346
0588 C********************                                          S01117LN0330
0594 C*****OPEN*PRINT*FILE FOR NEW BRANCH                           S01117LN0330
0588 C********************                                          S01117LN0330
     C*********************CLOSEDL0450P1                            S01117LN0330
     C*********************OPEN DL0450P1                            S01117LN0330
     C*********************SETON                     25             S01117LN0330
     C*********************Z-ADD0         PAGE                      S01117LN0330
     C****ENSURE*SPOOL*FILE RECORDED BY RCF.                        S01117LN0330
     C*********************Z-ADDSFNUM     ZSNUM   60                S01117LN0330
     C*********************CALL 'ZSFILE'                            S01117LN0330
     C*********************PARM *BLANKS   SEQ                       S01117LN0330
     C*********************PARM BR,X      @PARM   3                 S01117LN0330
     C*********************PARM           SFILE                     S01117LN0330
     C*********************PARM           SFNUM                     S01117LN0330
     C*********************PARM           ZSNUM                     S01117LN0330
     C*********************PARM *BLANK    ZSERR   1                 S01117LN0330
0588 C*********************                                               LN0330
     C***********ZSERR*****IFEQ 'Y'                                 S01117LN0330
     C** Error*during*ZSFILE processing, return to calling program  S01117LN0330
     C*********************MOVE '1'       *INLR                     S01117LN0330
     C*********************RETRN                                    S01117LN0330
     C*********************END                                      S01117LN0330
0509 C*                                                             S01117LN0330
0594 C*    OUTPUT HEADINGS TO REPORT
0595 C*    SET ON IND.87 TO CONDITION EXCEPT OUTPUT & SET OFF AFTER
0596 C                     SETON                     87
0509 C*    OUTPUT HEADINGSONLY IF THERE ARE DETAILS                       LN0330
0597 C*********************EXCPT                                          LN0330
0598 C*********************SETOF                     87                   LN0330
0599 C*
     C/COPY WNCPYSRC,DL0450CCP1                                           S01408
     C*                                                                   S01408
0600 C           START2    TAG                             ** START2 TAG *
0601 C*    CALCULATIONS FOR EACH CURRENCY FOR EACH CUSTOMER
0602 C*
0603 C*    IF THIS ELEMENT IN CURRENCY ARRAY IS BLANK SKIP TO CALCULATIONS
0604 C*    FOR END OF CURRENCIES FOR THIS CUSTOMER
0605 C           CY,Y      COMP '   '                    65
0606 C   65                GOTO ENDCUR
0607 C*
0608 C**** POSITION BALANCE ************
0609 C*
0610 C*    DEFINE POSITION BALANCE FIELD,POSBL1-4 WITH NO.  OF DEC.POS.FOR
0611 C*    THIS CURRENCY
0612 C           CD,Y      COMP 1                      4445
0613 C           CD,Y      COMP 2                    49  48
0614 C                     Z-ADD0         POSBL  150
     C                     MOVE *OFF      *IN23                           139568
0615 C*
0616 C*    ACCESS POSITION BALANCE(LEDGER BALANCE) FROM ACCNT
0617 C*
0618 C                     MOVELCM,X      WORK1   9
0619 C                     MOVE CY,Y      WORK1
0620 C*****                MOVELSPAC      WORK2   6               *****   S01194
0620 C**********           MOVELBLSPTA    WORK2   6                                    S01194 CGL029
0620 C                     MOVELBLSPTA    WORK2  12                                           CGL029
0621 C                     MOVE '01'      WORK2
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CCP2                                           S01408
     C*                                                                   S01408
0622 C*****                MOVELWORK1     ACKEY  15               *****   S01117
0622 C**********           MOVELWORK1     ACKEY  18                                    S01117 CGL029
     C                     MOVELWORK1     ACKEY  24                                           CGL029
0623 C*****                MOVE WORK2     ACKEY                   *****   S01117
0618 C**********           MOVELWORK2     WORK3   9                                    S01117 CGL029
     C                     MOVELWORK2     WORK3  15                                           CGL029
0619 C                     MOVE BR,X      WORK3                           S01117
0620 C                     MOVE WORK3     ACKEY                           S01117
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           ACKEY     CHAINGLACNTL0             52                   CEU011
     C                     ELSE                                           CEU011
0624 C           ACKEY     CHAINACCNT                52
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
0625 C*    CHECK THAT REC.ID IS'D'   SET IND.53 ON IF NOT
0626 C           RECI      COMP 'D'                  5353
0627 C*    IF CHAIN FAIL OR REC.ID NOT'D'(NO POS.BAL.AVAILABLE),SET TO 0
0628 C   52
0629 COR 53                Z-ADD0         LDBL
0630 C*    REVERSE SIGN OF POS.BAL & PUT IT IN RELEVANT POSBL1 TO 4 FIELD
0631 C                     Z-SUBLDBL      POSBL
0632 C*
0633 C**** EQUIVALENT BALANCE **********
0634 C*
0635 C*    SET ON IND.63 IF EQUIV.A/C CODE DOESN'T EXIST
0636 C                     SETOF                     5455
0637 C           EQ,Y      COMP 0                        63
0638 C*    IF EQUIV.A/C CODE EXISTS ACCESS EQUIV.BAL.FROM ACCNT
0639 C*    N.B. EQUIV.BAL.IS ALSO LDBL,BUT FOR CHAIN WITH DIFFERENT KEY.
0640 C   63                GOTO SKIPCH                     SKIP CHAIN
0641 C                     MOVELCM,X      WORK1
0642 C*****                MOVE BCCY      WORK1                   *****   S01194
0642 C                     MOVE BJCYCD    WORK1                           S01194
0643 C                     MOVELEQ,Y      WORK2
0644 C                     MOVE '01'      WORK2
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CCP3                                           S01408
     C*                                                                   S01408
0644 C                     MOVE BR,X      WORK3                           S01117
0645 C                     MOVELWORK1     ACKEY                           S01117
0646 C*****                MOVE WORK2     ACKEY                   *****   S01117
0645 C                     MOVELWORK2     WORK3                           S01117
0646 C                     MOVE WORK3     ACKEY                           S01117
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           ACKEY     CHAINGLACNTL0             54                   CEU011
     C                     ELSE                                           CEU011
0647 C           ACKEY     CHAINACCNT                54
     C                     ENDIF                                          CEU011
0648 C*    CHECK THAT REC.ID IS'D'   SET IND.55 ON IF NOT
0649 C           RECI      COMP 'D'                  5555
0650 C*
0651 C           SKIPCH    TAG                             ** SKIPCH TAG *
0652 C*****************************************************************   S01194
0653 C*****IF NO EQUIV.A/C CODE OR CHAIN FAILURE OR REC.ID NOT'D'(I.E. NO S01194
0654 C*****EQUIVALENT BAL.AVAILABLE),SET EQUIV.BAL.EQUAL ZERO.    *****   S01194
0655 C*****                                                       *****   S01194
0656 C*****                                                       *****   S01194
0657 C*****                Z-ADD0         LDBL                    *****   S01194
0652 C*                                                                   S01194
0653 C*    IF NO EQUIV.A/C CODE OR CHAIN FAILURE (IE. NO                  S01194
0654 C*    EQUIVALENT BAL.AVAILABLE),SET EQUIV.BAL.EQUAL ZERO.            S01194
0655 C   63                                                               S01194
0657 COR 54                Z-ADD0         LDBL                            S01194
0658 C*    MOVE EQ.BAL. TO EQBAL FIELDS
0659 C                     MOVE LDBL      EQBAL
0660 C*
0661 C*    IF EITHER POS.BAL.OR EQUIV.BAL.AVAILABLE,DO CALCS.& OUTPUT
0662 C  N52N53                                             POS.BAL.AVAIL.
0663 CORN54N55N63          EXSR CALCUL                     EQ.BAL. AVAIL.
0664 C*
0665 C*
0666 C**** END OF PROCESSING FOR THIS CCY FOR THIS CUSTOMER **************
0667 C*
0668 C*    INCREMENT CURRENCY INDEX
0669 C           Y         ADD  1         Y
0670 C*    END OF CCY ARRAY?IF NOT,PROCEED WITH NEXT CCY FOR THIS CUSTOMER
0671 C           Y         COMP 200                  64
0672 C  N64                GOTO START2
0673 C*
0674 C*    END OF NON-ZERO CURRENCY ELEMENTS WITHIN CCY ARRAY TAG
0675 C           ENDCUR    TAG                             ** ENDCUR TAG *
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CCP4                                           S01408
     C*                                                                   S01408
0676 C*
0677 C*    END OF CUSTOMER CALCULATIONS & OUTPUT
0678 C                     EXSR ENDBR
0679 C*
0680 C**** END OF PROCESSING FOR THIS CUSTOMER ***************************
0681 C*
0682 C*    INCREMENT CUSTOMER INDEX
0683 C           X         ADD  1         X
0684 C*    END OF CUSTOMER ARRAY?IF NOT,PROCEED WITH NEXT CUSTOMER
0685 C*****      X         COMP 20                   66           *****   S01117
0685 C********** X         COMP 100                  66                                S01117 256813
     C           X         COMP 900                  66                                       256813
0686 C  N66                GOTO START1
0687 C*
0688 C*    END OF NON-ZERO CUSTOMER ELEMENTS WITHIN CUSTOMER ARRAY TAG
0689 C           ENDCUS    TAG                             ** ENDCUS TAG *
0690 C*
0691 C**** FINAL STAGE ***************************************************
0692 C*
0693 C*    IF IND.42 IS ON THERE ARE STILL MORE CUSTOMERS FOR PROCESSING
0694 C*    SET FIELD'3RANCH'TO LAST BRANCH CODE PLUS 1 FOR NEW LOW.LIMITS
0695 C*****      BR,20     ADD  1         BRANCH  30              *****   S01117
0695 C***********          MOVE BR,100    BRANCH  3                S01117 151104
     C                     MOVE BR,900    BRANCH  3                       151104
0696 C*    BLANK OUT CUSTOMER & BRANCH CODE ARRAYS
0698 C*****                Z-ADD0         BR                      *****   S01117
0697 C                     MOVE *BLANKS   BR                              S01117
0698 C**********           Z-ADD0         CM                                                  CSD027
0698 C                     MOVE *BLANKS   CM                                                  CSD027
0697 C                     MOVE *BLANKS   BN                              S01117
0699 C*    AND IF MORE CUSTOMERS TO PROCESS,REBUILD ARRAY2&REPEAT TO HERE
0700 C   42                GOTO ARRAY2
0701 C*
0702 C*    OUTPUT FILE CONTROL COUNT TO REPORT & A TRAILER TO GESR
0703 C*    SET ON IND.57 SO THAT THE EXCEPT OUTPUT CAN BE CONDITIONED
0705 C                     SETOF                     87                   LN0330
0704 C           COUNT     ADD  2         COUNTT  50
0705 C                     SETON                     57
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP19                                           S01408
      *                                                                   S01408
0706 C                     EXCPT
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP27                                           S01408
      *                                                                   S01408
0707 C*
0708 C*
0709 C*    END OF PROGRAM TAG
0710 C           END       TAG                             *** END TAG ***
0399 C*
0712 C*    MAKE ARRANGEMENTS FOR THE PROGRAM TO FINISH GRACEFULLY
0713 C                     SETON                     LR
0711 C*
0399 C**  ENSURE SPOOL FILE RECORDED BY RCF.                              S01117
     CLR                   Z-ADDSFNUMU    ZSNUM                           S01117
0395 CLR                   CALL 'ZSFILE'                                  S01117
0396 C*R********           PARM *BLANKS   SEQ     5                 S01117LN0811
0396 CLR                   PARM           SEQ     5                       LN0811
0396 CLR                   PARM *BLANKS   @PARM                           S01117
0397 CLR                   PARM           SFILEU                          S01117
0397 C*R***                PARM           SFNUMU                          S01117
0397 CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANK    ZSERR                           S01117
0258 C*
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR                   MOVE '1'       *INLR                           S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0258 C*
0714  /EJECT
0715 C*************************** SUBROUTINES ****************************
0716 C********************************************************************
0717 C*
0718 C*    CALCUL SR. - CALCULATIONS FOR EACH CURRENCY FOR EACH CUSTOMER
0719 C*
0720 C           CALCUL    BEGSR                           *** CALCUL ***
0721 C*
0722 C*    CALCULATE SPOT VALUE
0723 C*    IF POSITION BALANCE IS ZERO SET SPOT VALUE TO ZERO
0724 C           POSBL     COMP 0                        70
0725 C   70                Z-ADD0         SPOVL
0726 C*
0727 C  N70      CD,Y      SUB  BCCDP     N       10   33
0728 C  N70      N         ADD  4         N
0729 C*    SPOT VALUE CALCULATION
0730 C**N70      MD,Y      COMP 0                        88               E134
0730 C  N70      MD,Y      COMP 'D'                      88               E134
0731 C**N70*88** SR,Y      MULT POWERS,N  WK159  159                                          238975
     C  N70 88   SR,Y      MULT POWERS,N  WK159  209                                          238975
0732 C  N70 88   POSBL     DIV  WK159     SPOVL     H
0733 C  N70N88   SR,Y      DIV  POWERS,N  WK159
0734 C  N70N88   POSBL     MULT WK159     SPOVL     H
0735 C*
     C/COPY WNCPYSRC,DL0450C014
0588 C*                                                                   LN0330
0594 C**   OPEN PRINT FILE FOR NEW BRANCH                                 LN0330
0588 C**                                                                  LN0330
     C           *IN50     IFEQ '1'                                       BHF346
     C                     MOVE '0'       *IN50                           BHF346
     C                     CLOSEDL0450P1                                  LN0330
     C                     OPEN DL0450P1                                  LN0330
     C                     SETON                     25                   LN0330
     C                     Z-ADD0         PAGE                            LN0330
     C**  ENSURE SPOOL FILE RECORDED BY RCF.                              LN0330
     C                     Z-ADDSFNUM     ZSNUM   60                      LN0330
     C                     CALL 'ZSFILE'                                  LN0330
     C**********           PARM *BLANKS   SEQ                       LN0330LN0811
     C                     PARM           SEQ                             LN0811
     C                     PARM BR,X      @PARM   3                       LN0330
     C                     PARM           SFILE                           LN0330
     C                     PARM           ZSNUM                           LN0330
     C                     PARM *BLANK    ZSERR   1                       LN0330
0588 C*                                                                   LN0330
     C           ZSERR     IFEQ 'Y'                                       LN0330
     C** Error during ZSFILE processing, return to calling program        LN0330
     C                     MOVE '1'       *INLR                           LN0330
     C                     RETRN                                          LN0330
     C                     END                                      LN0330
     C                     END                                            LN0330
0736 C*    CALCULATE PROFIT/LOSS & SET IND. FOR PROFIT(72)OR LOSS(71)
     C                     Z-ADD0         PROLO                           139568
     C                     Z-ADD0         XPROLO                          139568
0737 C           SPOVL     SUB  EQBAL     PROLO  150 727156
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           BKEUCP    ANDNE*BLANKS                                   CEU011
     C*                                                                   139568
     C*** Has currency begun transition                                   139568
     C*** ie is ccy trans date less than or equal to run date             139568
     C*                                                                   139568
     C           TD,Y      IFLE BJRDNB                                    139568
      *                                                                   CEU011
     C           IN,Y      IFEQ 'Y'                                       CEU011
     C           CY,Y      ANDNEBKEURO                                    CEU011
      *                                                                   CEU011
     C                     Z-ADDPOSBL     XPOSBL 150                      CEU011
      *                                                                   CEU011
     C                     MOVE *BLANKS   PRTCD   7                       CEU011
     C                     MOVE *BLANKS   PEXRT  159                      CEU011
     C                     Z-ADDXPOSBL    PFRAM  183                      CEU011
     C                     MOVE CY,Y      PFRCY   3                       CEU011
     C                     MOVE BKEURO    PTOCY   3                       CEU011
      *                                                                   CEU011
     C                     CALL 'EU0200'                                  CEU011
     C                     PARM           PRTCD   7                       CEU011
     C                     PARM           PFRAM  183                      CEU011
     C                     PARM           PFRCY   3                       CEU011
     C                     PARM           PTOCY   3                       CEU011
     C                     PARM           POUTA  150                      CEU011
     C                     PARM           PINTA  183                      CEU011
     C                     PARM           PEXRT  159                      CEU011
     C                     PARM           PMDIN   1                       CEU011
      *                                                                   CEU011
     C                     Z-ADDPOUTA     XPOSBL                          CEU011
     C                     Z-ADDXPOSBL    XEQBAL 150                      CEU011
     C                     ADD  XPOSBL    WPOSBL 150                      CEU011
     C                     ADD  XEQBAL    WEQBAL 150                      CEU011
      *                                                                   CEU011
      **  Convert Profit/Loss from Base Currency to Euro Currency         CEU011
      *                                                                   CEU011
     C                     Z-ADDPROLO     XPROLO 150                      CEU011
     C***********XPROLO    IFNE 0                                  CEU011 139568
      *                                                                   CEU011
     C                     Z-ADD0         WBASE  159                      CEU011
     C                     Z-ADD0         WEURO  159                      CEU011
     C                     Z-ADD0         XBASE  150                      CEU011
     C                     Z-ADD0         XEURO  150                      CEU011
     C           XPROLO    IFNE 0                                         139568
      *                                                                   CEU011
     C                     MOVE CY        C1                              CEU011
     C                     Z-ADD1         J       30                      CEU011
     C           BJCYCD    LOKUPC1,J                     23               CEU011
      *                                                                   CEU011
     C           MD,J      IFEQ 'D'                                       CEU011
     C           XPROLO    DIV  SR,J      XBASE     H                     CEU011
     C                     ELSE                                           CEU011
     C           XPROLO    MULT SR,J      XBASE     H                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     Z-ADD1         J       30                      CEU011
     C           BKEURO    LOKUPC1,J                     23               CEU011
      *                                                                   CEU011
     C                     Z-ADD0         N                               CEU011
     C********** WNBDP     SUB  CD,J      N            33                              CEU011 151904
     C           CD,J      SUB  WNBDP     N            33                                     151904
     C           N         ADD  4         N                               CEU011
     C           MD,J      IFEQ 'D'                                       CEU011
     C           SR,J      MULT POWERS,N  WEURO                           CEU011
     C*****      XBASE     DIV  WEURO     XEURO     H               CEU011145515
     C           XBASE     MULT WEURO     XEURO     H                     145515
     C                     ELSE                                           CEU011
     C           SR,J      DIV  POWERS,N  WEURO                           CEU011
     C*****      XBASE     MULT WEURO     XEURO     H               CEU011145515
     C           XBASE     DIV  WEURO     XEURO     H                     145515
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C                     Z-ADDXEURO     XPROLO                          CEU011
     C                     ADD  XPROLO    WPROLO 150                      CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C           CY,Y      IFEQ BKEURO                                    CEU011
     C                     ADD  POSBL     WEQBAL                          CEU011
     C                     Z-ADDPOSBL     XEQBAL                          CEU011
     C           PROLO     IFNE 0                                         CEU011
     C******               ADD  POSBL     WPROLO                    CEU011147250
     C***********          ADD  PROLO     WPROLO                    147250148829
     C******               Z-ADDPOSBL     XPROLO                    CEU011145517
     C***********          Z-ADDPROLO     XPROLO                    145517148829
      *                                                                   148829
     C                     Z-ADD1         J                               148829
     C           BKEURO    LOKUPC1,J                     23               148829
      *                                                                   148829
     C                     Z-ADD0         N                               148829
     C           WNBDP     SUB  CD,J      N            33                 148829
     C           N         ADD  4         N                               148829
     C           MD,J      IFEQ 'D'                                       148829
     C           SR,J      MULT POWERS,N  WEURO                           148829
     C                     ELSE                                           148829
     C           SR,J      DIV  POWERS,N  WEURO                           148829
     C                     ENDIF                                          148829
      *                                                                   148829
     C           MD,J      IFEQ 'D'                                       148829
     C           PROLO     MULT WEURO     XPROLO                          148829
     C                     ELSE                                           148829
     C           PROLO     DIV  WEURO     XPROLO                          148829
     C                     ENDIF                                          148829
     C                     ADD  XPROLO    WPROLO                          148829
      *                                                                   148829
      *                                                                   148829
     C                     ENDIF                                          CEU011
     C                     ADD  POSBL     WPOSBL                          CEU011
     C                     ENDIF                                          CEU011
     C                     ENDIF                                          139568
      *                                                                   CEU011
     C           IN,Y      IFEQ 'Y'                                       CEU011
     C           CY,Y      OREQ BKEURO                                    CEU011
     C*                                                                   139568
     C*** Has currency begun transition                                   139568
     C*** ie is ccy trans date less than or equal to run date             139568
     C*                                                                   139568
     C           TD,Y      IFLE BJRDNB                                    139568
     C                     MOVE '1'       *IN23                           CEU011
     C                     ELSE                                           CEU011
     C                     MOVE '0'       *IN23                           CEU011
     C                     ENDIF                                          CEU011
     C                     ENDIF                                          139568
      *                                                                   CEU011
     C                     MOVE CY        C1                              CEU011
     C                     Z-ADD1         J       30                      CEU011
     C           BKEURO    LOKUPC1,J                     24               CEU011
     C           *IN24     IFEQ '1'                                       CEU011
     C                     MOVEASR,J      WEXRT  138                      CEU011
      *                                                                   CEU011
     C                     SELEC                                          CEU011
     C           CD,J      WHEQ 0                                         CEU011
     C                     MOVE '1'       *IN18                           CEU011
     C           CD,J      WHEQ 1                                         CEU011
     C                     MOVE '1'       *IN19                           CEU011
     C           CD,J      WHEQ 2                                         CEU011
     C                     MOVE '1'       *IN21                           CEU011
     C           CD,J      WHEQ 3                                         CEU011
     C                     MOVE '1'       *IN22                           CEU011
     C                     ENDSL                                          CEU011
      *                                                                   CEU011
     C                     ENDIF                                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
     C**
     C**   BRANCH TOTALS OF SPOT VALUES
     C**
     C********** SPOVL     ADD  BRSPV     BRSPV  150                                        MD025993
     C           SPOVL     ADD  BRSPV     BRSPV  170                                        MD025993
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CCP5                                           S01408
     C*                                                                   S01408
     C**
     C**
     C**   IF SPOT VAL. = EQUIV. BAL.  SKIP PROCESSING
     C**    BUT PRINT LINE ON REPORT OUTPUT
     C   56                GOTO ZEROPT
     C**
     C**
0739 C*
0740 C*    SET D/C IND. FOR WHETHER PROFIT OR LOSS
0741 C   71                Z-ADD1         DRCR    10       CREDIT  LOSS
0742 C   72                Z-ADD0         DRCR             DEBIT   PROFIT
0743 C*
0744 C*    BRANCH TOTALS
0745 C*    BRANCH TOTALS OF PROFIT/LOSS
0746 C********** PROLO     ADD  BRPRL     BRPRL  150                                        MD025993
     C           PROLO     ADD  BRPRL     BRPRL  170                                        MD025993
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CCP6                                           S01408
     C*                                                                   S01408
0750 C*
0751 C*****ACCESS TABLE,TE FOR ACCOUNT TYPE FOR EACH A/C EQ.ACCOUNT ENTRY
0752 C*****                MOVEL'30     ' WRK1   11               *****   S01194
0753 C*****                MOVE EQ,Y      WRK1                    *****   S01194
0754 C*****                MOVELWRK1      TABKE1 12               *****   S01194
0755 C*****                MOVE '1'       TABKE1                  *****   S01194
0756 C*****      TABKE1    CHAINTABLE                85           *****   S01194
0399 C**   CHAIN ACCOUNT CODE DETAILS VIA ACCESS PROGRAM                  S01194
0753 C**********           MOVE EQ,Y      EQAFNB  4                                    S01194 CGL029
0753 C                     MOVE EQ,Y      EQAFNB 10                                           CGL029
0395 C                     CALL 'AOACODR0'                                S01194
0396 C                     PARM '*MSG   ' @RTCD   7                       S01194
0397 C                     PARM '*KEY   ' @OPTN   7                       S01194
0397 C**********           PARM EQAFNB    @AFNB   4                                    S01194 CGL029
0397 C                     PARM EQAFNB    @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                                     AR752668
     C           @RTCD     IFNE *BLANK                                                      AR752668
     C                     MOVEL'SDACODPD'DBFILE                                            AR752668
     C                     MOVEL'010'     DBASE                                             AR752668
     C                     MOVEL@OPTN     DBOPTN                                            AR752668
     C                     MOVEL@AFNB     DBKEY                                             AR752668
     C                     SETON                     U7U8LR                                 AR752668
     C                     EXSR *PSSR                                                       AR752668
     C                     GOTO END                                                         AR752668
     C                     END                                                              AR752668
      *                                                                                     AR752668
0399 C*
0757 C*****                MOVE ATYP      EAT1    1               *****   S01194
0757 C                     MOVE A5ACTY    EAT1    1                       S01194
0442 C                     MOVE A5ACSC    ACC1    2                       S10736
0758 C*
0759 C*    SET RETAIL INDICATOR
0760 C           EAT1      COMP 'R'                      73   RETAIL
0761 C   73                Z-ADD1         RIND    10
0762 C  N73                Z-ADD0         RIND
0763 C*
0764 C*    INCREMENT COUNT
0765 C           COUNT     ADD  1         COUNT   50
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CCP7                                           S01408
     C*                                                                   S01408
0766 C*
0767 C*    EXCEPT OUTPUT FOR REPORT
0768 C*    SET ON IND.74 TO CONDITION EXCEPT OUTPUT & SET OFF AFTER OUTPUT
0769 C*********************SETON                     74                   LN0330
     C***  SET ON IND.85 TO CONDITION TRAILER OUTPUT AND SET OFF IND.     LN0330
     C***  87 TO PREVENT FURTHER OUTPUT OF HEADINGS                       LN0330
0769 C                     SETON                     7485                 LN0330
     C***/COPY*WNCPYSRC,DLH00161                                                              CFC006
     C/COPY WNCPYSRC,DLH00161                                                               MD020563
      *                                                                                       CFC006
      ** Disable indicator(s) used in printing the report                                     CFC006
      *                                                                                       CFC006
     C           SUPFLG    IFEQ 'Y'                                                           CFC006
     C                     SETOF                     748587                                   CFC006
     C                     ENDIF                                                              CFC006
      *                                                                                       CFC006
0770 C                     EXCPT
0771 C*********************SETOF                     74                   LN0330
0771 C                     SETOF                     7487                 LN0330
0772 C*
0773 C*    GET MODULUS OF PROFIT OR LOSS
0774 C   71                Z-SUBPROLO     PLMOD  130
0775 C   72                Z-ADDPROLO     PLMOD
0776 C*
0777 C*    IF OF IS ON TURN PAGE & PRINT HEADINGS
0778 C   OF                SETON                     87
     C***/COPY*WNCPYSRC,DLH00162                                                              CFC006
     C/COPY WNCPYSRC,DLH00162                                                               MD020563
      *                                                                                       CFC006
      ** Disable indicator(s) used in printing the report                                     CFC006
      *                                                                                       CFC006
     C           SUPFLG    IFEQ 'Y'                                                           CFC006
     C                     SETOF                     748587                                   CFC006
     C                     ENDIF                                                              CFC006
      *                                                                                       CFC006
0779 C   OF                EXCPT
0780 C                     SETOF                     87
0781 C                     SETOF                     OF
0782 C*
     C* Identify the narrative:                                           S01522
     C*                                                                   S01522
     C                     MOVE EQ,Y      ##ACOD                          S01522
     C                     MOVE 'GB00490' ##MGID  7                       S01522
     C*                                                                   S01522
     C* Determine narrative:                                              S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
      *                                                                                       202042
      ** Check if posting amount is too big                                                   202042
      *                                                                                       202042
     C                     MOVE 'Y'       WREPT   1                                           202042
     C                     MOVE 'N'       WONCE   1                                           202042
      *                                                                                       202042
     C           WREPT     DOWEQ'Y'                                                           202042
      *                                                                                       202042
     C           *IN71     IFEQ '1'                                                           202042
     C           WONCE     ANDEQ'N'                                                           202042
     C                     Z-SUBPROLO     WPLMOD 150                                          202042
     C                     ENDIF                                                              202042
     C           *IN72     IFEQ '1'                                                           202042
     C           WONCE     ANDEQ'N'                                                           202042
     C                     Z-ADDPROLO     WPLMOD                                              202042
     C                     ENDIF                                                              202042
     C                     MOVE 'Y'       WONCE                                               202042
     C                     Z-ADDWPLMOD    WPREVA 150                                          202042
     C           WPLMOD    SUB  WLMTPA    WPLMOD                                              202042
     C           WPLMOD    IFGT 0                                                             202042
     C           COUNT     ADD  1         COUNT                                               202042
     C                     Z-ADDWLMTPA    PLMOD                                               202042
     C                     MOVE 'Y'       WREPT                                               202042
     C                     ELSE                                                               202042
     C                     Z-ADDWPREVA    PLMOD                                               202042
     C                     MOVE 'N'       WREPT                                               202042
     C                     ENDIF                                                              202042
     C*                                                                   S01522
0783 C*    EXCEPT OUTPUT TO GESR  1ST ENTRY
0784 C*    SET ON IND.75 TO CONDITION EXCEPT OUTPUT & SET OFF AFTER OUTPUT
0785 C                     SETON                     75
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP15                                           S01408
      *                                                                   S01408
0786 C                     EXCPT
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP23                                           S01408
      *                                                                   S01408
0787 C                     SETOF                     75
0788 C*
0789 C*    ADD POSTING AMOUNT TO HASH TOTAL
0790 C           PLMOD     DIV  1000      ZZAMT
0791 C                     EXSR GLZADD
      *                                                                                       202042
     C                     ENDDO                                                              202042
      *                                                                                       202042
     C** SKIP OVER NEXT BIT IF PROFIT/LOSS NOT = 0
     C                     GOTO CAEND
     C**
     C** TO GENERATE REPORT OUTPUT LINE FOR ZERO PROFIT/LOSS
     C           ZEROPT    TAG
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CCP8                                           S01408
     C*                                                                   S01408
     C***56****************SETON                     74                   LN0330
     C   56                SETON                     7485                 LN0330
     C***/COPY*WNCPYSRC,DLH00163                                                              CFC006
     C/COPY WNCPYSRC,DLH00163                                                               MD020563
      *                                                                                       CFC006
      ** Disable indicator(s) used in printing the report                                     CFC006
      *                                                                                       CFC006
     C           SUPFLG    IFEQ 'Y'                                                           CFC006
     C                     SETOF                     748587                                   CFC006
     C                     ENDIF                                                              CFC006
      *                                                                                       CFC006
     C   56                EXCPT
     C***74****************SETOF                     74                   LN0330
     C   74                SETOF                     7487                 LN0330
     C** NOW CHECK AGAIN FOR O/FLOW
     C   OF                SETON                     87
     C***/COPY*WNCPYSRC,DLH00164                                                              CFC006
     C/COPY WNCPYSRC,DLH00164                                                               MD020563
      *                                                                                       CFC006
      ** Disable indicator(s) used in printing the report                                     CFC006
      *                                                                                       CFC006
     C           SUPFLG    IFEQ 'Y'                                                           CFC006
     C                     SETOF                     748587                                   CFC006
     C                     ENDIF                                                              CFC006
      *                                                                                       CFC006
     C   OF                EXCPT
     C   87                SETOF                     87
     C                     SETOF                     OF
0792 C*
0793 C*
0794 C*
0795 C*
0796 C*    END OF CALCUL SR.
0797 C           CAEND     ENDSR
0798  /EJECT
0799 C********************************************************************
0800 C********************************************************************
0801 C*
0802 C*    ENDBR SR.- FOR PROCESSING AT END OF CURRENCY ARRAY FOR EACH
0803 C*               CUSTOMER
0804 C*
0805 C           ENDBR     BEGSR                           *** ENDBR ****
0806 C*
0807 C**** INCREMENT COUNT
0808 C*
0809 C*    EXCEPT OUTPUT TO REPORT
0810 C*    SET ON IND.76 TO CONDITION EXCEPT OUTPUT & SET IT OFF AFTER
     C**   ONLY OUTPUT TRAILER IF DETAILS HAVE BEEN PRINTED               LN0330
     C           *IN85     IFEQ '1'                                       LN0330
0811 C                     SETON                     76
0812 C                     EXCPT
0813 C*********************SETOF                     76                   LN0330
0813 C                     SETOF                     7685                 LN0330
0813 C                     END                                            LN0330
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CCP9                                           S01408
     C*                                                                   S01408
0814 C*
0815 C*    REVERSE SIGN OF PROFIT/LOSS & PUT IN A NEW FIELD(PLREV1 TO 4)
0816 C                     Z-SUBBRPRL     PLREV  150 787756
0817 C***56                GOTO BREND                                     E10886
0817 C   56                GOTO BLBPL                                     E10886
0818 C*
0819 C**   INCREMENT COUNT
0820 C           COUNT     ADD  1         COUNT
0821 C**
0822 C*    SET D/C IND. FOR WHETHER PROFIT OR LOSS
0823 C                     Z-ADD1         DRCR             CREDIT LOSS
0824 C   78                Z-ADD0         DRCR             DEBIT PROFIT
     C***SAVE*D/C*IND.*OF*TYPE*2**********                         E12161 E15192
     C***********          Z-ADDDRCR      DRCR2   10               E12161 E15192
0825 C*
0826 C*    GET MODULUS OF BRANCH PROFIT/LOSS
0827 C                     Z-SUBPLREV     BPLMD  130
0828 C   78                Z-ADDPLREV     BPLMD
      *                                                                                       CER051
     C           *IN78     IFEQ '0'                                                           CER051
0829 C*
0830 C*    SET RETAIL INDICATOR
0831 C           EAT2      COMP 'R'                      73
0832 C   73                Z-ADD1         RIND
0833 C  N73                Z-ADD0         RIND
0834 C*
     C* Identify the narrative:                                           S01522
     C*                                                                   S01522
     C                     MOVE BLSRAC    ##ACOD                          S01522
     C**********           MOVE 'GB00500' ##MGID                                       S01522 CER051
     C                     MOVE 'GB00501' ##MGID                                              CER051
     C                     ELSE                                                               CER051
     C           EAT6      COMP 'R'                      73                                   CER051
     C   73                Z-ADD1         RIND                                                CER051
     C  N73                Z-ADD0         RIND                                                CER051
     C                     MOVE BLSLAC    ##ACOD                                              CER051
     C                     MOVE 'GB00502' ##MGID                                              CER051
     C                     ENDIF                                                              CER051
     C*                                                                   S01522
     C* Determine narrative:                                              S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
      *                                                                                       202042
      ** Check if posting amount is too big                                                   202042
      *                                                                                       202042
     C                     MOVE 'Y'       WREPT                                               202042
     C                     MOVE 'N'       WONCE                                               202042
     C                     Z-ADD1         WC      30                                          202042
      *                                                                                       202042
     C           WREPT     DOWEQ'Y'                                                           202042
      *                                                                                       202042
     C           WONCE     IFEQ 'N'                                                           202042
     C                     Z-SUBPLREV     WBPLA                                               202042
     C                     ENDIF                                                              202042
     C           *IN78     IFEQ '1'                                                           202042
     C           WONCE     ANDEQ'N'                                                           202042
     C                     Z-ADDPLREV     WBPLA  150                                          202042
     C                     ENDIF                                                              202042
     C                     MOVE 'Y'       WONCE                                               202042
     C                     Z-ADDWBPLA     WPREVA 150                                          202042
     C           WBPLA     SUB  WLMTPA    WBPLA                                               202042
     C           WBPLA     IFGT 0                                                             202042
     C           COUNT     ADD  1         COUNT                                               202042
     C                     Z-ADDWLMTPA    BPLMD                                               202042
     C                     Z-ADDWLMTPA    WBR,WC                                              202042
     C           WC        ADD  1         WC                                                  202042
     C                     MOVE 'Y'       WREPT                                               202042
     C                     ELSE                                                               202042
     C                     Z-ADDWPREVA    BPLMD                                               202042
     C                     Z-ADDWPREVA    WBR,WC                                              202042
     C                     MOVE 'N'       WREPT                                               202042
     C                     ENDIF                                                              202042
     C*                                                                   S01522
0835 C*    EXCEPT OUTPUT FOR GESR  ENTRY NO.2
0836 C*    SET ON IND.79 TO CONDITION EXCEPT OUTPUT & THEN SET OF AGAIN
0837 C                     SETON                     79
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP16                                           S01408
      *                                                                   S01408
0838 C                     EXCPT
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP24                                           S01408
      *                                                                   S01408
0839 C                     SETOF                     79
0840 C*
0841 C*    ADD POSTING AMOUNT TO HASH TOTAL
0842 C           BPLMD     DIV  1000      ZZAMT
0843 C                     EXSR GLZADD
      *                                                                                       202042
     C                     ENDDO                                                              202042
      *                                                                                       202042
     C                     Z-ADDWC        WLOOP   30                                          202042
     C           WLOOP     ADD  1         WLOOP                                               202042
0844 C*
0845 C*    IF BANK DOESN'T MAINTAIN AN EQ.A/C CODE FOR BASE CURRENCY THEN
0846 C*    SKIP PROCESSING RELATED TO ENTRIES 3 & 4 TO GESR
0847 C***61*********       GOTO EXIT                                      E12161
0847 C***61******          GOTO TRNSF                              E12161 E15192
0847 C   61                GOTO EXIT                                      E15192
0848 C*
0849 C*    PROCESSING RELATED TO ENTRIES 3 & 4 TO GESR
0850 C*
0851 C*    INCREMENT COUNT FOR TWO ENTRIES
0852 C********** COUNT     ADD  2         COUNT                                               202042
     C                     Z-ADD1         WC                                                  202042
0853 C*
0854 C*    DO ENTRY NO.4 1ST
0855 C*    D/C IND. IS SAME AS FOR ENTRY NO.2
0856 C*
0857 C*    SET RETAIL IND.
0858 C           EAT4      COMP 'R'                      73
0859 C   73                Z-ADD1         RIND
0860 C  N73                Z-ADD0         RIND
     C*                                                                   S01522
     C* Identify the narrative:                                           S01522
     C*                                                                   S01522
     C                     MOVE BTACC     ##ACOD                          S01522
     C                     MOVE 'GB00710' ##MGID                          S01522
     C*                                                                   S01522
     C* Determine narrative:                                              S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
      *                                                                                       202042
     C           WLOOP     DOWGTWC                                                            202042
      *                                                                                       202042
     C                     Z-ADDWBR,WC    BPLMD                                               202042
     C           WC        ADD  1         WC                                                  202042
     C           COUNT     ADD  1         COUNT                                               202042
     C*                                                                   S01522
0861 C*
0862 C*    EXCEPT OUTPUT FOR GESR  ENTRY NO.4
0863 C*    SET ON IND.80 TO CONDITION OUTPUT & THEN SET OFF AGAIN
0864 C                     SETON                     80
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP17                                           S01408
      *                                                                   S01408
0865 C                     EXCPT
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP25                                           S01408
      *                                                                   S01408
0866 C                     SETOF                     80
0867 C*
0868 C*    ADD POSTING AMOUNT TO HASH TOTAL
0869 C           BPLMD     DIV  1000      ZZAMT
0870 C                     EXSR GLZADD
      *                                                                                       202042
     C                     ENDDO                                                              202042
      *                                                                                       202042
     C                     Z-ADD1         WC                                                  202042
0871 C*
0872 C*    ENTRY NO.3 NOW
0873 C*    SET D/C IND.FOR PROFIT OR LOSS USING NON-SIGN-REVERSED AMOUNTS
0874 C                     Z-ADD0         DRCR              DEBIT  PROFIT
0875 C   78                Z-ADD1         DRCR             CREDIT  LOSS
0876 C*
0877 C*    SET RETAIL IND.
0878 C           EAT3      COMP 'R'                      73
0879 C   73                Z-ADD1         RIND
0880 C  N73                Z-ADD0         RIND
     C*                                                                   S01522
     C* Identify the narrative:                                           S01522
     C*                                                                   S01522
     C                     MOVE BLSPTA    ##ACOD                          S01522
     C                     MOVE 'GB00720' ##MGID                          S01522
     C*                                                                   S01522
     C* Determine narrative:                                              S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
      *                                                                                       202042
     C           WLOOP     DOWGTWC                                                            202042
      *                                                                                       202042
     C                     Z-ADDWBR,WC    BPLMD                                               202042
     C           WC        ADD  1         WC                                                  202042
     C           COUNT     ADD  1         COUNT                                               202042
     C*                                                                   S01522
0881 C*
0882 C*    EXCEPT OUTPUT FOR GESR   ENTRY NO.3
0883 C*    SET ON IND.81 TO CONDITION OUTPUT & THEN SET OFF AGAIN
0884 C                     SETON                     81
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP18                                           S01408
      *                                                                   S01408
0885 C                     EXCPT
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP26                                           S01408
      *                                                                   S01408
     C                     SETOF                     81                   E12161
0868 C*    ADD POSTING AMOUNT TO HASH TOTAL                               E12161
0869 C           BPLMD     DIV  1000      ZZAMT                           E12161
0870 C                     EXSR GLZADD                                    E12161
      *                                                                                       202042
     C                     ENDDO                                                              202042
      *                                                                                       202042
     C***********TRNSF     TAG                      ** TRNSF TAG **E12161 E15192
     C***********                                                  E11096 E15192
     C*****IF*BASE CCY TRANSFER IS DUE THEN DO A REVERSE ENTRY TO  E11096 E15192
     C*****SPOT*REVAL P&L A/C AND A FURTHER SIMILAR ENTRY TO THE   E11096 E15192
     C*****FIRST*ONE TO THE P&L A/C OF THE BASE CCY.               E11096 E15192
     C***********                                                  E11096 E15192
     C*****BASE*CCY TRANSFER ON ACCRUAL DATE                       E11096 E15192
     C***********                                                  E11096 E15192
     C*****      BCXF      IFEQ 'A'                   *****     E11096    S01194
     C***********BKBCTF    IFEQ 'A'                                S01194 E15192
     C*****      APDA      ANDLTDNWD                  *****     E11096    S01194
     C***********BKAPDT    ANDLTBJDNWD                             S01194 E15192
     C***********ATYP      ANDEQ'G'                                E11096 E15192
     C***********                                                  E11096 E15192
     C***********ACCS      IFEQ 'IN'                        E11096 E12161 E15192
     C***********ACCS      OREQ 'EX'                        E11096 E12161 E15192
     C***********ACC2      IFEQ 'IN'                               E12161 E15192
     C***********ACC2      OREQ 'EX'                               E12161 E15192
     C***********                                                  E11096 E15192
     C***********          EXSR DEBCR                              E11096 E15192
     C***********                                                  E11096 E15192
     C***********          END                                     E11096 E15192
     C***********          END                                     E11096 E15192
     C***********                                                  E11096 E15192
     C*****BASE*CCY TRANSFER IS YEARLY                             E11096 E15192
     C***********                                                  E11096 E15192
     C***********BCXF      IFEQ 'Y'                   ***** E11096 S01194 E15192
     C***********BKBCTF    IFEQ 'Y'                                S01194 E15192
     C***********EOYD      ANDLTDNWD                  ***** E11096 S01194 E15192
     C***********BJEYD     ANDLTBJDNWD                             S01194 E15192
     C***********ATYP      ANDEQ'G'                                E11096 E15192
     C***********                                                  E11096 E15192
     C***********ACCS      IFEQ 'IN'                        E11096 E12161 E15192
     C***********ACCS      OREQ 'EX'                        E11096 E12161 E15192
     C***********ACC2      IFEQ 'IN'                               E12161 E15192
     C***********ACC2      OREQ 'EX'                               E12161 E15192
     C***********                                                  E11096 E15192
     C***********          EXSR DEBCR                              E11096 E15192
     C***********                                                  E11096 E15192
     C***********          END                                     E11096 E15192
     C***********          END                                     E11096 E15192
     C***********                                                  E11096 E15192
     C*****BASE*CCY TRANSFER IS MONTHLY                            E11096 E15192
     C***********                                                  E11096 E15192
     C***********BCXF      IFEQ 'M'                   ***** E11096 S01194 E15192
     C***********BKBCTF    IFEQ 'M'                                S01194 E15192
     C***********ATYP      ANDEQ'G'                                E11096 E15192
     C***********                                                  E11096 E15192
     C***********ACCS      IFEQ 'IN'                        E11906 E12161 E15192
     C***********ACCS      OREQ 'EX'                        E11906 E12161 E15192
     C***********ACC2      IFEQ 'IN'                               E12161 E15192
     C***********ACC2      OREQ 'EX'                               E12161 E15192
     C***********          Z-ADDDNWD      ZDAYNO      ***** E11096 S01194 E15192
     C***********          Z-ADDBJDNWD    ZDAYNO                   S01194 E15192
     C***********          MOVE '0'       *IN98                    E11096 E15192
     C***********          EXSR ZDATE2                             E11096 E15192
     C***********                                                  E11096 E15192
     C***********ZMMM      IFNE RUNMMM                             E11096 E15192
     C***********                                                  E11096 E15192
     C***********          EXSR DEBCR                              E11096 E15192
     C***********                                                  E11096 E15192
     C***********          END                                     E11096 E15192
     C***********          END                                     E11096 E15192
     C***********          END                                     E11096 E15192
     C***********                                                  E11096 E15192
0886 C***********          SETOF                     81            E12161 E15192
0887 C***********                                                  E12161 E15192
0888 C*****ADD POSTING AMOUNT TO HASH TOTAL                        E12161 E15192
0889 C***********BPLMD     DIV  1000      ZZAMT                    E12161 E15192
0890 C***********          EXSR GLZADD                             E12161 E15192
0891 C***********                                                  E12161 E15192
0892 C*****END*OF PROCESSING RELATED TO ENTRIES 3 & 4              E12161 E15192
0893 C***********EXIT      TAG                      ** EXIT TAG ** E12161 E15192
0894 C***********                                                         E15192
0894 C*                                                                   E15192
0893 C           EXIT      TAG                             ** EXIT TAG ** E15192
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP10                                           S01408
     C*                                                                   S01408
0894 C*                                                                   E15192
0895 C*    SET OF IND.77 & 78 IN CASE OF ERROR NEXT TIME THROUGH
0896 C                     SETOF                     7778
0897 C*
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C           BKEUCP    ANDNE*BLANKS                                   CEU011
     C                     Z-ADD0         WPOSBL                          CEU011
     C                     Z-ADD0         WEQBAL                          CEU011
     C                     Z-ADD0         WPROLO                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
0898 C*    BLANK OUT BRANCH TOTALS
     C           BLBPL     TAG                             ** BLBPL TAG** E10886
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0450CP11                                           S01408
     C*                                                                   S01408
0899 C                     Z-ADD0         BRPRL
0900 C                     Z-ADD0         BRSPV
0901 C*
0902 C*
0903 C*    END OF ENDBR SR.
0904 C           BREND     ENDSR
0905 C*
     C*****************************************************************   E15192
     C***********/EJECT                                            E11096 E15192
     C*****************************************************************   E15192
     C***********                                                     *   E15192
     C****DEBCR*SR - THIS SUBROUTINE OUTPUTS THE RECORDS TO PF/GESRPD *   E15192
     C***********    WITH THE DR/CR INDICATOR SET UP CORRECTLY        *   E15192
     C***********                                                     *   E15192
     C*****************************************************************   E15192
     C***********                                                  E11096 E15192
     C***********DEBCR     BEGSR                           ** DEBCR SR ** E15192
     C***OUTPUT*REVERSAL OF ENTRY TYPE 2 TO SPOT REVALUATION P/L A/c.     E15192
     C***SET*DRCR EQUAL TO OPPOSITE OF  DRCR OF ENTRY TYPE 2.      E12161 E15192
     C***********                                                  E11096 E15192
     C***********          Z-ADDDRCR2     DRCR                     E11096 E15192
     C***********DRCR      IFEQ 0                                  E11096 E15192
     C***********          Z-ADD1         DRCR                     E11096 E15192
     C***********          ELSE                                    E11096 E15192
     C***********          Z-ADD0         DRCR                     E11096 E15192
     C***********          END                                     E11096 E15192
     C***********                                                  E11096 E15192
     C***********          SETON                     79            E12161 E15192
     C***********          EXCPT                                   E11096 E15192
     C***********          SETOF                     79            E12161 E15192
     C***********                                                  E11502 E15192
     C*****ADD*POSTING AMOUNT TO HASH TOTAL                        E11502 E15192
     C***********BPLMD     DIV  1000      ZZAMT                    E11502 E15192
     C***********          EXSR GLZADD                             E11502 E15192
     C***********                                                  E11096 E15192
     C***PUT*DRCR EQAL TO THAT OF ENTRY TYPE 2 AND                 E12161 E15192
     C***OUTPUT*TO P/L GENERAL A/c.                                E12161 E15192
     C***********DRCR      IFEQ 0                                  E11096 E15192
     C***********          Z-ADD1         DRCR                     E11096 E15192
     C***********          ELSE                                    E11096 E15192
     C***********          Z-ADD0         DRCR                     E11096 E15192
     C***********          END                                     E11096 E15192
0457 C*****ACCESS TABLE,TE FOR ACCOUNT TYPE FOR GENERAL P/L A/C.   E12161 E15192
0458 C***********          MOVEL'30     ' WRK3                     E12161 E15192
0459 C***********          MOVE PLAC      WRK3                     E12161 E15192
0460 C***********          MOVELWRK3      TABKE3 12                E12161 E15192
0461 C***********          MOVE '1'       TABKE3                   E12161 E15192
0462 C***********TABKE3    CHAINTABLE                83            E12161 E15192
0399 C*****CHAIN*ACCOUNT*CODE*DETAILS*VIA*ACCESS*PROGRAM           S01194 E15192
0395 C**********           CALL 'AOACODR0'                         S01194 E15192
0396 C**********           PARM '*MSG   ' @RTCD   7                S01194 E15192
0397 C**********           PARM '*KEY   ' @OPTN   7                S01194 E15192
0397 C**********           PARM BKPLAC    @AFNB   4                S01194 E15192
     C********** SDACOD    PARM SDACOD    DSFDY                    S01194 E15192
0399 C**********                                                          E15192
0463 C**********           MOVE ATYP      EAT5    1         E12161 S01194 E15192
0463 C**********           MOVE A5ACTY    EAT5    1                S01194 E15192
     C***********                                                  E11096 E15192
     C***********          SETON                     37     E11906 E12161 E15192
     C***********          SETON                     37  79        E12161 E15192
     C***********          EXCPT                                   E11096 E15192
     C***********          SETOF                     37     E11906 E12161 E15192
     C***********          SETOF                     37  79        E12161 E15192
     C***********                                                  E11502 E15192
     C*****ADD*POSTING AMOUNT TO HASH TOTAL                        E11502 E15192
     C***********BPLMD     DIV  1000      ZZAMT                    E11502 E15192
     C***********          EXSR GLZADD                             E11502 E15192
     C***********                                                  E11096 E15192
     C*****INCREMENT COUNT FOR TWO ENTRIES                         E11502 E15192
     C***********COUNT     ADD  2         COUNT                    E11502 E15192
     C***********                                                  E11502 E15192
     C***********          ENDSR                                   E11096 E15192
     C***********                                                  E11096 E15192
     C*************************************************************E11096 E15192
     C/EJECT
     C********************************************************************S01522
     C**  Subroutine SRPNAR determines the required narratives.         **S01522
     C********************************************************************S01522
     C           SRPNAR    BEGSR                           * S R P N A R *S01522
     C*                                                                   S01522
     C* Define the destination narrative field:                           S01522
     C*                                                                   S01522
     C                     MOVE *BLANKS   O#PNAR 30                       S01522
     C*                                                                   S01522
     C* Define the data structure parameter:                              S01522
     C*                                                                   S01522
     C           *LIKE     DEFN CGPNAR    ##PNAR                          S01522
     C*                                                                   S01522
     C* Fill the variable narrative field with the existing value:        S01522
     C*                                                                   S01522
     C***********          MOVE ##SPOT    O#PNAR                    S01522095477
     C/COPY WNCPYSRC,DL0450C008
     C                     MOVEL##SPOT    O#PNAR                          095477
     C/COPY WNCPYSRC,DL0450C009
     C*                                                                   S01522
     C* If the facility is switched off or unavailable,                   S01522
     C*  or UDC is not installed, exit this subroutine:                   S01522
     C*                                                                   S01522
     C           DLPNAR    IFNE 'Y'                                       S01522
     C                     GOTO EXPNAR                                    S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* Determine the customer's number:                                  S01522
     C*                                                                   S01522
     C           *LIKE     DEFN BBCUST    ##CUST                          S01522
     C                     MOVE CM,X      ##CUST    P                     S01522
     C*                                                                   S01522
     C* Determine the customer's name:                                    S01522
     C*                                                                   S01522
     C                     MOVEL##CUST    ##KEY     P                     S01522
     C*                                                                   S01522
     C                     CALL 'AOCUSTR0'                                S01522
     C                     PARM           ##RTN   7                       S01522
     C                     PARM '*KEY   ' ##OPT   7                       S01522
     C                     PARM           ##KEY  10                       S01522
     C                     PARM           ##STS   7                       S01522
     C           SDCUST    PARM SDCUST    DSSDY                           S01522
     C*                                                                   S01522
     C           ##RTN     IFNE *BLANKS                                   S01522
     C                     MOVEL'SDCUSTPD'DBFILE             *************S01522
     C                     MOVEL'101'     DBASE              * DBERR 101 *S01522
     C                     MOVEL##OPT     DBOPTN             *************S01522
     C                     MOVEL##KEY     DBKEY                           S01522
     C                     EXSR *PSSR                                     S01522
     C                     SETON                     U7U8LR               S01522
     C                     GOTO END                                       S01522
     C                     ENDIF                                          S01522
     C*...................................................................S01522
     C/EJECT                                                              S01522
     C*...................................................................S01522
     C* Determine the branch number:                                      S01522
     C*                                                                   S01522
     C           *LIKE     DEFN ACOD      ##ACOD                          S01522
     C           *LIKE     DEFN BRCA      ##BRCA                          S01522
     C                     MOVE BR,X      ##BRCA                          S01522
     C*                                                                   S01522
     C* Determine the value for the deal narrative using AOPNARR0:        S01522
     C*                                                                   S01522
     C                     CLEARCGPNAR                                    S01522
     C                     CLEAR##PRM1                                    086125
     C                     MOVE 'DL'      MNMODI                          S01522
     C                     MOVE ##BRCA    MNBRCA                          S01522
     C                     MOVE ##CUST    MNCUST                          S01522
     C                     MOVE BJCYCD    MNCYCD                          S01522
     C/COPY WNCPYSRC,DL0450C015
     C                     MOVE ##ACOD    MNACCD                          S01522
     C                     MOVE '01'      MNACSQ                          S01522
     C                     MOVE BBCRNM    MNCRNM                          S01522
     C                     MOVE ACNO      MNRACN                          S01522
     C                     MOVE ASOC      MNASOC                          S01522
     C                     MOVE CHQN      MNCHNB                          S01522
     C                     MOVELO#PNAR    MNNARR                          S01522
     C/COPY WNCPYSRC,DLH00454
     C*                                                                   S01522
     C                     CALL 'AOPNARR0'                                S01522
     C                     PARM           ##RTN                           S01522
     C                     PARM           ##MGID                          S01522
     C                     PARM           ##PRM1                          086125
     C           CGPNAR    PARM CGPNAR    ##PNAR                          S01522
     C                     PARM           ##NARR 50                       S01522
     C/COPY WNCPYSRC,DLH00455
     C*                                                                   S01522
     C           ##RTN     IFNE *BLANKS                                   S01522
     C                     MOVEL'CGPNARPD'DBFILE             *************S01522
     C                     MOVEL'102'     DBASE              * DBERR 102 *S01522
     C                     MOVELMNCUST    DBKEY              *************S01522
     C                     EXSR *PSSR                                     S01522
     C                     SETON                     U7U8LR               S01522
     C                     GOTO END                                       S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C                     MOVEL##NARR    O#PNAR    P                     S01522
     C*                                                                   S01522
     C           EXPNAR    TAG                             < EXPNAR       S01522
     C*                                                                   S01522
     C                     ENDSR                                          S01522
     C********************************************************************S01522
     C***********/EJECT                                            E11096 E15192
3270 C*************************************************************E11096 E15192
3271 C***********                                                  E11096 E15192
3272 C*****ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.     E11096 E15192
3273 C***********                                                  E11096 E15192
3274 C*****THE*YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.  E11096 E15192
3275 C***********                                                  E11096 E15192
3276 C***********ZDATE2    BEGSR                    *** ZDATE2 *** E11096 E15192
3277 C***********                                                  E11096 E15192
3278 C*****CLEAR DATE FIELDS.                                      E11096 E15192
3279 C***********          Z-ADD0         ZDATE   60               E11096 E15192
3280 C***********          MOVEL'       ' ZADATE  7                E11096 E15192
3281 C***********                                                  E11096 E15192
3282 C*****CALCULATION TO DEFINE INPUT DAY NUMBER.                 E11096 E15192
3283 C***********          Z-ADDZDAYNO    ZDAYNO  50               E11096 E15192
3284 C***********                                                  E11096 E15192
3285 C***********INE YEAR NUMBER.                                  E11096 E15192
3286 C***********                                                  E11096 E15192
3287 C*****ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.             E11096 E15192
3288 C***********ZDAYNO    SUB  1         ZDAYN1  50   99          E11096 E15192
3289 C***99******          GOTO ZDEND2                             E11096 E15192
3290 C***********                                                  E11096 E15192
3291 C*****CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.      E11096 E15192
3292 C***********ZDAYN1    DIV  1461      ZLYR    20               E11096 E15192
3293 C***********          MVR            ZDAYN1    SAVE REMAINING E11096 E15192
3294 C***********                                          DAYS    E11096 E15192
3295 C*****CALCULATE NUMBER OF REMAINING YEARS.                    E11096 E15192
3296 C***********          Z-ADD1         ZWRK2   20               E11096 E15192
3297 C***********ZDTAG1    TAG                      ** ZDTAG1 TAG *E11096 E15192
3298 C***********ZDAYN1    COMP ZYDY,ZWRK2             90          E11096 E15192
3299 C**N90******ZWRK2     ADD  1         ZWRK2                    E11096 E15192
3300 C**N90******          GOTO ZDTAG1                             E11096 E15192
3301 C***********ZWRK2     SUB  1         ZWRK2   91LEAP YR, 91 ON E11096 E15192
3302 C***********                                                  E11096 E15192
3303 C*****DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.           E11096 E15192
3304 C**N91******ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                   E11096 E15192
3305 C***********                                                  E11096 E15192
3306 C*****CALCULATE ACTUAL YEAR NUMBER.                           E11096 E15192
3307 C***********ZLYR      MULT 4         ZWRK3   30               E11096 E15192
3308 C***********ZWRK3     ADD  72        ZWRK3     BASE IS 1972   E11096 E15192
3309 C***********          Z-ADDZWRK3     ZYEAR   20               E11096 E15192
3310 C***********ZYEAR     ADD  ZWRK2     ZYEAR            YEAR    E11096 E15192
3311 C***********                                                  E11096 E15192
3312 C*****DETERMINE MONTH NUMBER.                                 E11096 E15192
3313 C***********                                                  E11096 E15192
3314 C*****ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.  E11096 E15192
3315 C***********          SETOF                     9293          E11096 E15192
3316 C***91******ZDAYN1    COMP 59                     9293        E11096 E15192
3317 C***91N92***ZDAYN1    SUB  1         ZDAYN1                   E11096 E15192
3318 C***********                                                  E11096 E15192
3319 C*****CALCULATE MONTH NUMBER.                                 E11096 E15192
3320 C***********          Z-ADD2         ZWRK2                    E11096 E15192
3321 C***********ZDTAG2    TAG                      ** ZDTAG2 TAG *E11096 E15192
3322 C***********ZDAYN1    COMP ZMDY,ZWRK2             94          E11096 E15192
3323 C**N94******ZWRK2     ADD  1         ZWRK2                    E11096 E15192
3324 C**N94******          GOTO ZDTAG2                             E11096 E15192
3325 C***********ZWRK2     SUB  1         ZWRK2                    E11096 E15192
3326 C***********                                                  E11096 E15192
3327 C***********          Z-ADDZWRK2     ZMTH    20       MONTH   E11096 E15192
3328 C***********                                                  E11096 E15192
3329 C*****DETERMINE DAY OF MONTH.                                 E11096 E15192
3330 C***********                                                  E11096 E15192
3331 C*****ADD*BACK LAST DAY OF YEAR ADJUSTMENT.                   E11096 E15192
3332 C***********ZDAYN1    ADD  1         ZDAYN1                   E11096 E15192
3333 C***********                                                  E11096 E15192
3334 C*****CALCULATE DAY OF MONTH.                                 E11096 E15192
3335 C***********ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY     E11096 E15192
3336 C***********                                                  E11096 E15192
3337 C*****ADD*BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.E11096 E15192
3338 C***93******ZDAY      ADD  1         ZDAY                     E11096 E15192
3339 C***********                                                  E11096 E15192
3340 C*****FORMAT DATE, DDMMYY OR MMDDYY.                          E11096 E15192
3341 C**N98******          MOVELZDAY      ZWRK4   40               E11096 E15192
3342 C***98******          MOVE ZDAY      ZWRK4                    E11096 E15192
3343 C**N98******          MOVE ZMTH      ZWRK4                    E11096 E15192
3344 C***98******          MOVELZMTH      ZWRK4                    E11096 E15192
3345 C***********          MOVELZWRK4     ZDATE                    E11096 E15192
3346 C***********          MOVE ZYEAR     ZDATE                    E11096 E15192
3347 C***********                                                  E11096 E15192
3348 C*****FORMAT ALPHA DATE, DDMMMYY.                             E11096 E15192
3349 C***********ZDAY      COMP 10                     95          E11096 E15192
3350 C***********          MOVELZDAY      ZWRK5   5                E11096 E15192
3351 C***95******          MOVEL' '       ZWRK5                    E11096 E15192
3352 C***********          MOVE ZMNM,ZMTH ZWRK5                    E11096 E15192
3353 C***********          MOVELZWRK5     ZADATE                   E11096 E15192
3354 C***********          MOVE ZYEAR     ZADATE                   E11096 E15192
3355 C***********                                                  E11096 E15192
3356 C***********ZDEND2    ENDSR                    * ZDEND2 ENDSR*E11096 E15192
3357 C***********                                                  E11096 E15192
3358 C***********                                                  E11096 E15192
3359 C*************************************************************E11096 E15192
     C***********/EJECT                                            E11096 E15192
0906 C********************************************************************
0907 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0908 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0909 C*
0910 CSR         GLZADD    BEGSR                           *** GLZADD ****
0911 C*
0912 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0913 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0914 C*
0915 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0916 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0917 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0918 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0919 C*
0920 CSR                   EXSR GLZSUM
0921 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0922 C*
0923 C********************************************************************
0924 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0925 C*                        GLZADD, GLZSUB, GLZCMP.
0926 C*          PARAMETERS PASSED -
0927 C*                     I/P ZZAMTI ZZAMTD
0928 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0929 C*
0930 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0931 C*
0932 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0933 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0934 CSR                   SETOF                     919293
0935 CSR                   SETOF                     949599
0936 C*
0937 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0938 CSR         ZZAMTI    COMP 0                      9293
0939 CSR 93      ZZAMTD    COMP 0                      9293
0940 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0941 C*
0942 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0943 CSR         ZZTOTI    COMP 0                      9193
0944 CSR 93      ZZTOTD    COMP 0                      9193
0945 C*
0946 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0947 CSR 93                Z-ADDZZAMTI    ZZTOTI
0948 CSR 93                Z-ADDZZAMTD    ZZTOTD
0949 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0950 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0951 CSR 91N92
0952 CORN91 92             GOTO ZZOFPS
0953 C*
0954 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0955 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0956 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0957 C*
0958 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0959 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0960 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0961 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0962 C*
0963 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0964 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0965 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0966 CSRN99                Z-ADDZZWK2     ZZTOTD
0967 CSRN99                Z-ADDZZWK3     ZZTOTI
0968 C*
0969 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0970 CSR 99                Z-ADD0         ZZAMT  153
0971 CSR                   GOTO ZZSEND
0972 C*
0973 C* THE 'SIGNS' ARE DIFFERENT
0974 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0975 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0976 C*
0977 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0978 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0979 C*
0980 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0981 C*
0982 CSR 91                Z-SUBZZTOTI    ZZTOTI
0983 CSR 91                Z-SUBZZTOTD    ZZTOTD
0984 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0985 C*
0986 CSR         ZZTOTI    COMP ZZAMTI               93  95
0987 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0988 C*
0989 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0990 CSR 95                Z-ADD0         ZZTOTI
0991 CSR 95                Z-ADD0         ZZTOTD
0992 CSR 95                GOTO ZZSEND
0993 C*
0994 C* IF ZZTOT GT. ZZAMT.
0995 CSR 93      ZZAMTD    COMP ZZTOTD               94
0996 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0997 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0998 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0999 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
1000 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
1001 C*
1002 C*
1003 C* IF ZZAMT GT. ZZTOT.
1004 CSRN93      ZZTOTD    COMP ZZAMTD               94
1005 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
1006 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
1007 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1008 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1009 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1010 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1011 C*
1012 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1013 CSR                   SETOF                     94
1014 CSR 93 91
1015 CORN93 92             SETON                     94
1016 CSR 94                Z-SUBZZTOTI    ZZTOTI
1017 CSR 94                Z-SUBZZTOTD    ZZTOTD
1018 C**
1019 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1020 CSR 92                Z-SUBZZAMTI    ZZAMTI
1021 CSR 92                Z-SUBZZAMTD    ZZAMTD
1022 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
1023 C**
1024 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1025 CSR                   SETOF                     96
1026 CSR         ZZTOTD    COMP 0                        91
1027 CSR 91      ZZTOTI    COMP 0                      96
1028 CSR 96                MOVE '.000-'   ZZNEGD  5
1029 CSR                   ENDSR                             ** ENDSR **
1030 C*****************************************************************   S01194
1031 C*****                                                       *****   S01194
1032 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RE*****   S01194
1033 C*****                                                       *****   S01194
1034 C*****      ZSYSTM    BEGSR                           *** ZSY*****   S01194
1035 C*****                                                       *****   S01194
1036 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.            *****   S01194
1037 C*****                MOVEL'01      'ZTABKY 12               *****   S01194
1038 C*****                MOVE '  10'    ZTABKY                  *****   S01194
1039 C*****                                                       *****   S01194
1040 C*****      ZTABKY    CHAINTABLE                99    ON NOT *****   S01194
1041 C**N99      RECI      COMP 'D'                  9999  ON, IS *****   S01194
1042 C*****                                                       *****   S01194
1043 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.            *****   S01194
1044 C*****      DATF      COMP 'M'                      98MMDDYY,*****   S01194
1045 C*****                                                       *****   S01194
1046 C*****                ENDSR                                  *****   S01194
1047 C*****************************************************************   S01194
1024 C*    ERROR DUMP SUBROUTINE.                                         S01194
1048 C*                                                                   S01194
1034 C           *PSSR     BEGSR                           ***  PSSR **   S01194
1020 C           @RUN      IFEQ *BLANK                                    S01194
1021 C                     MOVE 'Y'       @RUN    1                       S01194
1020 C                     DUMP                                           S01194
1021 C                     END                                            S01194
1022 C                     ENDSR                           *** *PSSR **   S01194
1048 C**                                                                  S01194
1049 C*****************************************************************   S01194
1050  /EJECT
1051 O*    REPORT HEADINGS
1052 ODL0450P1E  203   87                                                 S01124
1053 O*****                              22 'REFERENCE DL0450'    *****   S01117
1053 O                                   24 'REFERENCE DL0450P1'          S01117
1054 O*****                    TITL      89                       *****   S01194
1054 O                         BJURPT    89                               S01194
1055 O                                  104 'DATE'
1056 O*****                    RUNA     112                       *****   S01194
1056 O                         BJMRDT   112                               S01194
1057 O                                  122 'PAGE'
1058 O                         PAGE  3  127
1059 O        E  1     87
1060 O*****                              61 'REVALUATION OF SPOT' *****   S01117
     O/COPY WNCPYSRC,DL0450O001
1060 O                                   51 'REVALUATION OF SPOT'         S01117
1061 O*****                              78 'TRADING POSITION'    *****   S01117
1061 O                                   68 'TRADING POSITION'            S01117
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OOP5                                           S01408
      *                                                                   S01408
1062 O*****                             106 'BRANCH'              *****   S01117
1063 O*****                    BR,X     110                       *****   S01117
1064 O        E  2     87
1065 O*****                              62 '--------------------'*****   S01117
1065 O                                   52 '--------------------'        S01117
1066 O*****                              78 '----------------'    *****   S01117
1066 O                                   68 '----------------'            S01117
     O/COPY WNCPYSRC,DL0450O008
1064 O        E  2     87
1065 O                                   12 'BRANCH'                      S01117
1065 O                         BR,X      16                               S01117
1066 O                         BN,X      48                               S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0450OOP1                                           S01408
     O*                                                                   S01408
1067 O        E  1     87
     O**********       29                66 'BASE EQUIVALENT'                        CEU011 MD025993
 068 O**********                         77 'SPOT'                                          MD025993
     O                 29                60 'BASE EQUIVALENT'                               MD025993
     O                                   71 'SPOT'                                          MD025993
     O/COPY WNCPYSRC,DL0450O009
     O**********       29               124 'PROFIT/LOSS'                            CEU011 MD025993
     O                 29               118 'PROFIT/LOSS'                                   MD025993
1069 O        E        87
1070 O**********                         18 'CCY'                                           MD025993
1071 O**********                         40 'POSITION'                                      MD025993
     O                                   12 'CCY'                                           MD025993
     O                                   34 'POSITION'                                      MD025993
1072 O***********                        66 'EQUIVALENT'                  CEU011
     O**********      N29                66 'EQUIVALENT'                             CEU011 MD025993
     O**********       29                66 'EURO EQUIVALENT'                        CEU011 MD025993
1073 O**********                         77 'RATE'                                          MD025993
1074 O**********                        103 'SPOT VALUE'                                    MD025993
     O                N29                60 'EQUIVALENT'                                    MD025993
     O                 29                60 'EURO EQUIVALENT'                               MD025993
     O                                   71 'RATE'                                          MD025993
     O                                   97 'SPOT VALUE'                                    MD025993
1075 O***********                       124 'PROFIT/LOSS'                 CEU011
     O**********      N29               124 'PROFIT/LOSS'                            CEU011 MD025993
     O**********       29               124 'EURO EQUIV. P/L'                        CEU011 MD025993
     O                N29               118 'PROFIT/LOSS'                                   MD025993
     O                 29               118 'EURO EQUIV. P/L'                               MD025993
1076 O*
1077 O*    REPORT DETAIL
1078 O        E 2      74
1079 O**********               CY,Y      18                                                 MD025993
1080 O**********       44      POSBL J   40                                                 MD025993
1081 O**********       45      POSBL     42 '  ,   ,   ,   , 0 . -'                         MD025993
1082 O**********       48      POSBL     43 ' ,   ,   ,   , 0 .  -'                         MD025993
1083 O**********       49      POSBL     44 '   ,   ,   , 0 .   -'                          MD025993
1084 O**********       58      EQBAL J   63                                                 MD025993
1085 O**********       59      EQBAL     65 '  ,   ,   ,   , 0 . -'                         MD025993
1086 O**********       60      EQBAL     66 ' ,   ,   ,   , 0 .  -'                         MD025993
1087 O**********       68      EQBAL     67 '   ,   ,   , 0 .   -'                          MD025993
1088 O**********               SR,Y  3   82                                                 MD025993
     O                         CY,Y      12                                                 MD025993
     O                 44      POSBL J   34                                                 MD025993
     O                 45      POSBL     36 '  ,   ,   ,   , 0 . -'                         MD025993
     O                 48      POSBL     37 ' ,   ,   ,   , 0 .  -'                         MD025993
     O                 49      POSBL     38 '   ,   ,   , 0 .   -'                          MD025993
     O                 58      EQBAL J   57                                                 MD025993
     O                 59      EQBAL     59 '  ,   ,   ,   , 0 . -'                         MD025993
     O                 60      EQBAL     60 ' ,   ,   ,   , 0 .  -'                         MD025993
     O                 68      EQBAL     61 '   ,   ,   , 0 .   -'                          MD025993
     O                         SR,Y  3   76                                                 MD025993
     O/COPY WNCPYSRC,DL0450O010
1089 O**********       58      SPOVL J  103                                                 MD025993
1090 O**********       59      SPOVL    105 '  ,   ,   ,   , 0 . -'                         MD025993
1091 O**********       60      SPOVL    106 ' ,   ,   ,   , 0 .  -'                         MD025993
1092 O**********       68      SPOVL    107 '   ,   ,   , 0 .   -'                          MD025993
     O                 58      SPOVL J  100                                                 MD025993
     O                 59      SPOVL    102 '  ,   ,   ,   , 0 . -'                         MD025993
     O                 60      SPOVL    103 ' ,   ,   ,   , 0 .  -'                         MD025993
     O                 68      SPOVL    104 '   ,   ,   , 0 .   -'                          MD025993
1093 O                 58      PROLO J  124
1094 O                 59      PROLO    126 '  ,   ,   ,   , 0 . -'
1095 O                 60      PROLO    127 ' ,   ,   ,   , 0 .  -'
1096 O                 68      PROLO    128 '   ,   ,   , 0 .   -'
      *                                                                   CEU011
     O        E 1      74 23                                              CEU011
     O**********       18 29   XEQBALJ   63                                          CEU011 MD025993
     O**********       19 29   XEQBAL    65 '  ,   ,   ,   , 0 . -'                  CEU011 MD025993
     O**********       21 29   XEQBAL    66 ' ,   ,   ,   , 0 .  -'                  CEU011 MD025993
     O**********       22 29   XEQBAL    67 '   ,   ,   , 0 .   -'                   CEU011 MD025993
     O                 18 29   XEQBALJ   57                                                 MD025993
     O                 19 29   XEQBAL    59 '  ,   ,   ,   , 0 . -'                         MD025993
     O                 21 29   XEQBAL    60 ' ,   ,   ,   , 0 .  -'                         MD025993
     O                 22 29   XEQBAL    61 '   ,   ,   , 0 .   -'                          MD025993
     O                 18 29   XPROLOJ  124                               CEU011
     O                 19 29   XPROLO   126 '  ,   ,   ,   , 0 . -'       CEU011
     O                 21 29   XPROLO   127 ' ,   ,   ,   , 0 .  -'       CEU011
     O                 22 29   XPROLO   128 '   ,   ,   , 0 .   -'        CEU011
      *                                                                   CEU011
     O        E 2      76                                                 CEU011
     O**********          29   BKEUCP    18                                          CEU011 MD025993
     O**********       18 29   WPOSBLJ   40                                          CEU011 MD025993
     O**********       19 29   WPOSBL    42 '  ,   ,   ,   , 0 . -'                  CEU011 MD025993
     O**********       21 29   WPOSBL    43 ' ,   ,   ,   , 0 .  -'                  CEU011 MD025993
     O**********       22 29   WPOSBL    44 '   ,   ,   , 0 .   -'                   CEU011 MD025993
     O                    29   BKEUCP    12                                                 MD025993
     O                 18 29   WPOSBLJ   34                                                 MD025993
     O                 19 29   WPOSBL    36 '  ,   ,   ,   , 0 . -'                         MD025993
     O                 21 29   WPOSBL    37 ' ,   ,   ,   , 0 .  -'                         MD025993
     O                 22 29   WPOSBL    38 '   ,   ,   , 0 .   -'                          MD025993
      *                                                                   CEU011
     O**********       18 29   WEQBALJ   63                                          CEU011 MD025993
     O**********       19 29   WEQBAL    65 '  ,   ,   ,   , 0 . -'                  CEU011 MD025993
     O**********       21 29   WEQBAL    66 ' ,   ,   ,   , 0 .  -'                  CEU011 MD025993
     O**********       22 29   WEQBAL    67 '   ,   ,   , 0 .   -'                   CEU011 MD025993
     O                 18 29   WEQBALJ   57                                                 MD025993
     O                 19 29   WEQBAL    59 '  ,   ,   ,   , 0 . -'                         MD025993
     O                 21 29   WEQBAL    60 ' ,   ,   ,   , 0 .  -'                         MD025993
     O                 22 29   WEQBAL    61 '   ,   ,   , 0 .   -'                          MD025993
      *                                                                   CEU011
     O**********          29   WEXRT 3   82                                          CEU011 MD025993
     O                    29   WEXRT 3   76                                                 MD025993
      *                                                                   CEU011
     O                 18 29   WPROLOJ  124                               CEU011
     O                 19 29   WPROLO   126 '  ,   ,   ,   , 0 . -'       CEU011
     O                 21 29   WPROLO   127 ' ,   ,   ,   , 0 .  -'       CEU011
     O                 22 29   WPROLO   128 '   ,   ,   , 0 .   -'        CEU011
      *                                                                   CEU011
1097 O*
1098 O*    REPORT BRANCH TOTALS
1099 O        E 2      76
1100 O**********                         83 'TOTAL'                                         MD025993
1101 O**********       58      BRSPV J  103                                                 MD025993
1102 O**********       59      BRSPV    105 '  ,   ,   ,   , 0 . -'                         MD025993
1103 O**********       60      BRSPV    106 ' ,   ,   ,   , 0 .  -'                         MD025993
1104 O**********       68      BRSPV    107 '   ,   ,   , 0 .   -'                          MD025993
     O                                   77 'TOTAL'                                         MD025993
     O                 58      BRSPV J  100                                                 MD025993
     O                 59      BRSPV    102 ' ,   ,   ,   ,   . 0 . -'                      MD025993
     O                 60      BRSPV    103 '   ,   ,   ,   , 0 .  -'                       MD025993
     O                 68      BRSPV    104 '  ,   ,   ,   , 0 .   -'                       MD025993
1105 O                 58      BRPRL J  124
1106 O**********       59      BRPRL    126 '  ,   ,   ,   . 0 . -'                         MD025993
1107 O**********       60      BRPRL    127 ' ,   ,   ,   , 0 .  -'                         MD025993
1108 O**********       68      BRPRL    128 '   ,   ,   , 0 .   -'                          MD025993
1106 O                 59      BRPRL    126 ' ,   ,   ,   ,   . 0 . -'                      MD025993
1107 O                 60      BRPRL    127 '   ,   ,   ,   , 0 .  -'                       MD025993
1108 O                 68      BRPRL    128 '  ,   ,   ,   , 0 .   -'                       MD025993
1097 O*
1064 O        E 2      76                                                 S01117
1065 O                                   58 '*** END OF REPORT'           S01117
1065 O                                   69 'FOR BRANCH'                  S01117
1065 O*****                    BR,X      74                               E139
1066 O*****                              79 '***'                  S01117 E139
1066 O                                   75 '***'                         E139
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0450OOP2                                           S01408
     O*                                                                   S01408
1109  /EJECT
1110 O*    REPORT FILE CONTROL TOTAL
1111 O*****   E  203   57                                         *****   S01117
1111 O*L0450AUE**203   LR                                           S01117E139
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OOP6                                           S01408
      *                                                                   S01408
1111 ODL0450AUT  203   LR                                                 E139
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OOP7                                           S01408
      *                                                                   S01408
1112 O*****                              22 'REFERENCE DL0450'    *****   S01117
1112 O                                   24 'REFERENCE DL0450AU'          S01117
1113 O*****                    TITL      89                       *****   S01194
1113 O                         BJURPT    89                               S01194
1114 O                                  104 'DATE'
1115 O*****                    RUNA     112                       *****   S01194
1115 O                         BJMRDT   112                               S01194
1116 O                                  122 'PAGE'
1117 O*****                    PAGE  3  127                       *****   S01194
1117 O                         PAGE1 3  127                               S01194
1118 O********E  1     57                                                 S01117
1118 O****    E  1     LR                                           S01117E139
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OOP8                                           S01408
      *                                                                   S01408
1118 O        T  1     LR                                                 E139
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OOP9                                           S01408
      *                                                                   S01408
1119 O                                   61 'REVALUATION OF SPOT'
1120 O                                   78 'TRADING POSITION'
1121 O                                   92 ' - RUN CONTROL'
1122 O********E        57                                                 S01117
1122 O****    E        LR                                         S01117  E139
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OP10                                           S01408
      *                                                                   S01408
1122 O        T        LR                                                 E139
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OP11                                           S01408
      *                                                                   S01408
1123 O                                   62 '--------------------'
1124 O                                   78 '----------------'
1125 O                                   92 '--------------'
1126 O*****   E   16   57                                                 E139
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OP12                                           S01408
      *                                                                   S01408
1126 O        T   16   LR                                                 E139
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OP13                                           S01408
      *                                                                   S01408
1127 O                                   36 'NUMBER OF ENTRIES'
1128 O                                   46 'GENERATED'
1129 O                         COUNT 3   69
     O*                                                                   S01117
     O** OUTPUT DATABASE ERROR IF NECESSARY                               S01117
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OP14                                           S01408
      *                                                                   S01408
     O        T 3      LRNU7N25                                           S01117
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0450OP15                                           S01408
      *                                                                   S01408
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
1130 O*****   E 2      57
1131 O*****   E   47   57                                                 E139
1132 O*****                              69 '*** END OF REPORT ***'       E139
1133  /EJECT
1134 O*    GESR HEADER
1135 OGESRHH  E        86
1136 O                                    1 'H'
1137 O*
1138 O*    GESR DETAIL   ENTRY NO.1
1139 OGESRPD  E        75
1140 O                                    1 'P'
1141 O                         CM,X       7
1142 O*****                    BCCY      10                       *****   S01194
1142 O                         BJCYCD    10                               S01194
1143 O**********               EQ,Y      14                                                  BUG2595
1143 O                                   14 '0000'                                           BUG2595
1144 O                                   16 '01'
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0450OOP3                                           S01408
     O*                                                                   S01408
1145 O                         ACNO      32
1146 O*****                    RUND      35P                      *****   S01194
1146 O                         BJRDNB    35P                              S01194
1147 O*****                    RUND      38P                      *****   S01194
1147 O                         BJRDNB    38P                              S01194
1148 O                         TRAT      43
1149 O*********** S01522                 59 'SPOT REVALUATION'            S01522
     O/COPY WNCPYSRC,DL0450O002
     O                         O#PNAR    73                               S01522
     O/COPY WNCPYSRC,DL0450O003
1150 O                         PLMOD     80P
1151 O                         DRCR      81
1152 O                         ASOC      87
1153 O                         CHQN      95
1154 O                                  102 'GE-SR'
1155 O                         BR,X     105
1156 O                         RIND     106
1157 O                         REJC     108P
1158 O                         RRNM     114P
1159 O                         EAT1     124
1160 O                         ZBITOF   128
1161 O                                  129 'R'
1162 O                                  130 '0'
     O/COPY WNCPYSRC,DLH00223
1091 O                                  134 '    '                        S01182
     O/COPY WNCPYSRC,DLH00224
1091 O                                  140 '235959'                      S10736
1091 O                         VOIN     141                               S10736
1189 O                         ACC1     146                               S10736
1091 O                                  230 '               '             S01182
1091 O                                  240 '          '                  S01182
1091 O                                  250 '          '                  S01182
1091 O                         ZERO15   258P                              S01182
1091 O                         ZERO15   266P                              S01182
1091 O                                  268 '  '                          S01182
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         EQ,Y     599                                                  BUG2595
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
     O                         SETDAT   530P                                               AR813358A
1163 O*
1164 O*    GESR DETAIL  ENTRIES 2,3 & 4
1165 O        E        79
1167 O       OR        80
1167 O       OR        81
1168 O                                    1 'P'
1169 O                         CM,X       7
1170 O*****                    BCCY      10                        *****  S01194
1170 O                         BJCYCD    10                               S01194
1171 O****************N80N81   SRPL      14                               E12161
1171 O****************N80N81N37SRPL      14                     E12161    S01194
1171 O****************N80N81N37BLSRAC    14                        S01194 E15192
     O/COPY WNCPYSRC,DL0450O004
1171 O**********      N80N81   BLSRAC    14                                            E15192 CGL029
1172 O**********      N79N81   BTACC     14                                                   CGL029
1171 O***********     N80N81   BLSRAC    20                                           CGL029 BUG1814
1172 O***********     N79N81   BTACC     20                                           CGL029 BUG1814
1173 O****************N79N80   SPAC      14                               E11096
1173 O*****           N79N80   SPAC      14                     E12161    S01194
1173 O**********      N79N80   BLSPTA    14                                            S01194 CGL029
1173 O***********     N79N80   BLSPTA    20                                           CGL029 BUG1814
     O/COPY WNCPYSRC,DL0450O005
1173 O****************N79N80N37SPAC      14                     E11906    E12161
     O****************N79N80 37PLAC      14                     E11906    E12161
1171 O****************N80N81 37PLAC      14                     E12161    S01194
1171 O****************N80N81 37BKPLAC    14                        S01194 E15192
1174 O**********                         16 '01'                                              CGL029
1174 O***************                    22 '01'                                      CGL029 BUG1814
1174 O                                   14 '0000'                                           BUG2595
1174 O                                   16 '01'                                             BUG1814
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0450OOP4                                           S01408
     O*                                                                   S01408
1175 O                         ACNO      32
1176 O*****                    RUND      35P                      *****   S01194
1176 O                         BJRDNB    35P                              S01194
1177 O*****                    RUND      38P                      *****   S01194
1177 O                         BJRDNB    38P                              S01194
1178 O                         TRAT      43
1179 O****************                   59 'SPOT REVALUATION'            E11096
1179 O****************N37                59 'SPOT REVALUATION'     E11096 E15192
     O**************** 37                64 'TRANSFER TO PROFIT & 'E11096 E15192
     O**************** 37                68 'LOSS'                 E11096 E15192
1179 O*********** S01522                 59 'SPOT REVALUATION'     E15192 S01522
     O/COPY WNCPYSRC,DL0450O006
     O                         O#PNAR    73                               S01522
     O/COPY WNCPYSRC,DL0450O007
1180 O                         BPLMD     80P
1181 O                         DRCR      81
1182 O                         ASOC      87
1183 O                         CHQN      95
1184 O                                  102 'GE-SR'
1185 O                         BR,X     105
1186 O                         RIND     106
1187 O                         REJC     108P
1188 O                         RRNM     114P
1189 O***********     N80N81   EAT2     124                               E12161
1189 O****************N80N81N37EAT2     124                        E12161 E15192
1189 O****************N80N81   EAT5     124                        E12161 E15192
1189 O**********      N80N81   EAT2     124                                            E15192 CER051
     O                N80N81N78EAT2     124                                                   CER051
     O                N80N81 78EAT6     124                                                   CER051
1190 O                N79N81   EAT4     124
1191 O                N79N80   EAT3     124
1192 O                         ZBITOF   128
1193 O                                  129 'R'
1194 O                                  130 '0'
     O/COPY WNCPYSRC,DLH00225
1091 O                                  134 '    '                        S01182
     O/COPY WNCPYSRC,DLH00226
1091 O                                  140 '235959'                      S10736
1091 O                         VOIN     141                               S10736
1189 O**********      N80N81   ACC2     146                                            S10736 CER051
     O                N80N81N78ACC2     146                                                   CER051
     O                N80N81 78ACC6     146                                                   CER051
1190 O                N79N81   ACC4     146                               S10736
1191 O                N79N80   ACC3     146                               S10736
1091 O                                  230 '               '             S01182
1091 O                                  240 '          '                  S01182
1091 O                                  250 '          '                  S01182
1091 O                         ZERO15   258P                              S01182
1091 O                         ZERO15   266P                              S01182
1091 O                                  268 '  '                          S01182
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O**********      N80N81   BLSRAC   599                                           BUG1814 CER051
     O                N80N81N78BLSRAC   599                                                   CER051
     O                N80N81 78BLSLAC   599                                                   CER051
     O                N79N81   BTACC    599                                                  BUG1814
1173 O                N79N80   BLSPTA   599                                                  BUG1814
     O                         NITMS    271P                                               AR813358A
     O                         CHGA     279P                                               AR813358A
     O                         ORAMT    316P                                               AR813358A
     O                         LTAI     147                                                AR813358A
     O                         XRFN     329                                                AR813358A
     O                         SETDAT   530P                                               AR813358A
1195 O*
1196 O*    GESR TRAILER
1197 OGESRZZ  E        57
1198 O                                    1 'T'
1199 O                         COUNTT     6
1200 O                         ZZTOTI    14P
1201 O                         ZZTOTD    16P
1202 O*
      *
      * ZDATE COMPILE TIME ARRAYS MOVED AND REMOVED BY E15192
      *
      **   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
      *0366073110961461
      **   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
      *000031059090120151181212243273304334365
      **   ZMNM - MONTHS SHORT NAMES
      *JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
      *
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   POWERS - POWERS OF 10
0000001
0000010
0000100
0001000
0010000
0100000
1000000
