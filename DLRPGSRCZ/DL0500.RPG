     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Accruals extract')                            *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
     F*                                                               *
     F*  DL0500  -  DEALS FILE EXTRACT FOR ACCRUALS                   *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  NOTE: Check DL5110 for changes that may apply to it if there *                       CAS005
      *        are amendments done to this program.                   *                       CAS005
      *                                                               *
      *  Last Amend No. 263896             Date 25Sep23               *      
      *  Prev Amend No. MD058815           Date 28Sep21               *
      *                 CSD103             Date 10Aug20               *
      *                 MD051152           Date 02Aug18               *
      *                 MD053295           Date 13Apr19               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 CGL165             Date 17Mar15               *
      *                 AR814519           Date 06Mar15               *
      *                 234893             Date 06Mar15               *
      *                 CDL096             Date 07Oct14               *
      *                 CDL094             Date 11Jun14               *
      *                 CIR017             Date 10Apr14               *
      *                 233545 (2          Date 05Apr10               *
      *                 AR996895           Date 25Nov12               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 16Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CDL049             Date 05Jul06               *
      *                 BUG8167            Date 25May06               *
      *                 CIR014             Date 11May06               *
      *                 CSD031             Date 10Apr06               *
      *                 221626             Date 04May06               *
      *                 218666             Date 27Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG10282           Date 04Feb06               *
      *                 CDL038             Date 10May05               *
      *                 CIR013             Date 11Apr05               *
      *                 CDL033             Date 10Feb05               *
      *                 CDL028             Date 07Feb05               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS005             Date 16Dec02               *
      *                 217684             Date 12May03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 209405             Date 05Nov02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 204923             Date 29Apr02               *
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CIR007             Date 11May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR006             Date 13Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR005             Date 21Jan00               *
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 156954             Date 11Mar99               *
      *                 121768             Date 19Feb98               *
     F*                 117437             DATE 03FEB98               *
     F*                 126017             DATE 20MAR97               *
     F*                 111053             DATE 20FEB97               *
     F*                 097885             DATE 31JAN97               *
     F*                 S01408             DATE 21AUG96               *  *
     F*                 100140             DATE 27JUN96               *
     F*                 S01408             DATE 22MAY96               *  *
     F*                 090221             DATE 15JAN96               *  *
     F*                 S01408             DATE 05FEB96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 087547             DATE 24OCT95               *
     F*                 087546             DATE 24OCT95               *
     F*                 S01408             DATE 16OCT95               *
     F*                 S01408             DATE 04SEP95               *
     F*                 S01408             DATE 22AUG94               *
     F*                 CIR002             DATE 13JUN95               *
     F*                 CIR001             DATE 13JUN95               *
     F*                 067078             DATE 26OCT94               *
     F*                 S01408             DATE 29SEP94               *
     F*                 S01408             DATE 21SEP94               *
     F*                 042900             DATE 13MAY94               *
     F*                 032587             DATE 26APR94               *
     F*                 066550             DATE 04FEB94               *
     F*                 060995             DATE 02FEB94               *
     F*                 031967             DATE 02FEB94               *
     F*                 048327             DATE 16MAR93               *
     F*                 S01392             DATE 20JUL92               *
     F*                 043304             DATE 13AUG92               *
     F*                 040318             DATE 07AUG92               *
     F*                 AUS021             DATE 07AUG92               *
     F*                 E35983 (FUJ808)    DATE 13FEB92               *
     F*                 E28496             DATE 17SEP91               *
     F*                 E22762             DATE 28JUL90               *
     F*                 E22610             DATE 25JUL90               *
     F*                 LN0135             DATE 23MAY90               *
     F*                 E19857             DATE 17APR90               *
     F*                 E17716             DATE 17APR90               *
     F*                 E16138             DATE 14SEP89               *
     F*                 S01117             DATE 20/02/89              *
     F*                 S01194             DATE 20/02/89              *
     F*                 S01147             DATE 27/11/87              *
     F*                 E11045             DATE 18/09/87              *
     F*                 E10517             DATE 06/08/87              *
     F*                 S01119             DATE 17/06/87              *
     F*                 E47291             DATE 29/05/87              *
     F*                 S02093             DATE 22/09/86              *
     F*                 E80945             DATE 11/06/86              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  263896 - Apply 237049                                        *
      *  237049 - Select live 'SI' records as next interest payment   *
      *           date for DL0500 Interest calculation.               *      
      *  MD058815 - Dealing interest Calculation type 6 have different*
      *             interest amount for Calculation type 1 for non-   *
      *             leap year interest period with same parameters.   *
      *             Based from MD052690.                              *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD051152 - FRA/IRS Interest Calculation Basis 6.             *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date                                    *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  AR814519 - Allow negative base rate. Recompile.              *
      *             (Child:AR814520). Applied for MD033488.           *
      *  234893 - Negative rate is treated as positive.  Apply fix    *
      *           227621.                                             *
      *             Applied for MD030272                              *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  CIR017 - SIRS Business Day Conventions for both Legs         *
      *  222381 - Incorrect accrual for swaps with fixed cash flow    *
      *           and calc type 3. Consider calc basis when computing *
      *           for number of days.                                 *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CSC042 - COB Performance improvements. Try to keep number of *
      *           accesses to AOBRCHR0 to a minimum.                  *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  BUG8167- 'TO ACCRUE' is incorrect. Applied fix 218666.       *
      *  CIR014 - Mark to Market Cross-currency Interest Rate Swaps   *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  221626 - Incorrect cash flow accruals. Pass SLIP to ZIBEG,   *
      *           instead of IACD, before calling SR/CFACC.           *
      *  218666 - Significant differences in 'to accrue' figures for  *
      *           OIS deals.                                          *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG10282 - Fix field CLAS for DEALSDC.                       *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  217684 - Authorisation User Malfunction (Recompile)          *
      *  209405 - Fix the OIS misplaced code that caused problem to   *
      *           "To accrue" amount and apply 203305 as a            *
      *           preventative fix.                                   *
      *  204923 - Rate Fix Days Adjustment (OIS)                      *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  CIR007 - Overnight Index Swaps                               *
      *  CIR006 - Amortisation of Caps/Collars/Floors and Individual  *
      *           Compounding Swaps.                                  *
      *  CIR005 - FRA/IRS Business Day Conventions                    *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  156954 - Fix 100140 is incomplete.  It doesn't consider if   *
     F*           date format is MMDDYY.                              *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  117437 - Interest accruals 'Accrued to Date' amount is wrong *
     F*           for N.A. Purchased deal if there is an adjustment   *
     F*           posted for the said deal. The logic of computation  *
     F*           must be the same as of the loan/deposit processing. *
     F*           Applied fix 072747.                                 *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  111053 - Wrong amounts extracted.                            *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  S01408 - Core hook DL0500C116 added                          *
     F*  100140 - Looping problems caused by FRA's fixing on 29th Feb *
     F*           Fix is to ensure that when 1 year is added to 29th  *
     F*           Feb in a leap year, the result is 28th Feb.         *
     F*  S01408 - Core hook DL0500C110 added                          *
     F*           Core hook DL0500C111 added                          *
     F*           Core hook DL0500C112 added                          *
     F*           Core hook DL0500C113 added                          *
     F*           Core hook DL0500C114 added                          *
     F*           Core hook DL0500C115 added                          *
     F*  090221 - Fix 042900 for calc method 3. It accrues an extra   *
     F*           day every 30th of the month where it should only    *
     F*           accrue the extra day if the month has 31 days.      *
     F*  S01408 - Addition of core hook DL0500IIP2                    *
     F*           Addition of core hook DL0500EEP1                    *
     F*           Addition of core hook DL0500CP60                    *
     F*           Addition of core hook DL0500CP61                    *
     F*           Addition of core hook DL0500CP62                    *
     F*           Addition of core hook DL0500CP63                    *
     F*           Addition of core hook DL0500CP64                    *
     F*           Addition of core hook DL0500CP65                    *
     F*           Addition of core hook DL0500CP66                    *
     F*           Addition of core hook DL0500CP67                    *
     F*           Addition of core hook DL0500CP68                    *
     F*           Addition of core hook DL0500CP69                    *
     F*           Addition of core hook DL0500CP70                    *
     F*           Addition of core hook DL0500CP71                    *
     F*           Addition of core hook DL0500CP72                    *
     F*           Addition of core hook DL0500CP73                    *
     F*           Addition of core hook DL0500CP74                    *
     F*           Addition of core hook DL0500CP75                    *
     F*           Addition of core hook DL0500CP76                    *
     F*           Addition of core hook DL0500CP77                    *
     F*           Addition of core hook DL0500CP78                    *
     F*           Addition of core hook DL0500CP79                    *
     F*           Addition of core hook DL0500CP80                    *
     F*           Addition of core hook DL0500CP81                    *
     F*           Addition of core hook DL0500CP82                    *
     F*           Addition of core hook DL0500CP83                    *
     F*           Addition of core hook DL0500CP84                    *
     F*           Addition of core hook DL0500CP85                    *
     F*           Addition of core hook DL0500CP86                    *
     F*           Addition of core hook DL0500CP87                    *
     F*           Addition of core hook DL0500CP88                    *
     F*           Addition of core hook DL0500CP89                    *
     F*           Addition of core hook DL0500CP90                    *
     F*           Addition of core hook DL0500CP91                    *
     F*           Addition of core hook DL0500CP92                    *
     F*           Addition of core hook DL0500CP93                    *
     F*           Addition of core hook DL0500CP94                    *
     F*           Addition of core hook DL0500CP95                    *
     F*           Addition of core hook DL0500CP96                    *
     F*           Addition of core hook DL0500CP97                    *
     F*           Addition of core hook DL0500CP98                    *
     F*           Addition of core hook DL0500CP99                    *
     F*           Addition of core hook DL0500C100                    *
     F*           Addition of core hook DL0500C101                    *
     F*           Addition of core hook DL0500C102                    *
     F*           Addition of core hook DL0500C103                    *
     F*           Addition of core hook DL0500C104                    *
     F*           Addition of core hook DL0500C105                    *
     F*           Addition of core hook DL0500C106                    *
     F*           Addition of core hook DL0500C107                    *
     F*           Addition of core hook DL0500C108                    *
     F*           Addition of core hook DL0500C109                    *
     F*           Addition of core hook DL0500OOP4                    *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  087547 - Move the proper ZIBEG (Date of accrued from).       *
     F*  087546 - Discrepancy in interest calculation.                *
     F*  S01408 - Addition of core hook DL0500CP58                    *
     F*           Addition of core hook DL0500CP59                    *
     F*  S01408 - Addition of core hook DL0500CP56                    *
     F*           Addition of core hook DL0500CP57                    *
     F*  S01408 - Addition of core hook DL0500CCP6                    *
     F*           Addition of core hook DL0500CCP7                    *
     F*           Addition of core hook DL0500CCP8                    *
     F*           Addition of core hook DL0500CCP9                    *
     F*           Addition of core hook DL0500CP10                    *
     F*           Addition of core hook DL0500CP11                    *
     F*           Addition of core hook DL0500CP12                    *
     F*           Addition of core hook DL0500CP13                    *
     F*           Addition of core hook DL0500CP14                    *
     F*           Addition of core hook DL0500CP15                    *
     F*           Addition of core hook DL0500CP16                    *
     F*           Addition of core hook DL0500CP17                    *
     F*           Addition of core hook DL0500CP18                    *
     F*           Addition of core hook DL0500CP19                    *
     F*           Addition of core hook DL0500CP20                    *
     F*           Addition of core hook DL0500CP21                    *
     F*           Addition of core hook DL0500CP22                    *
     F*           Addition of core hook DL0500CP23                    *
     F*           Addition of core hook DL0500CP24                    *
     F*           Addition of core hook DL0500CP25                    *
     F*           Addition of core hook DL0500CP26                    *
     F*           Addition of core hook DL0500CP27                    *
     F*           Addition of core hook DL0500CP28                    *
     F*           Addition of core hook DL0500CP29                    *
     F*           Addition of core hook DL0500CP30                    *
     F*           Addition of core hook DL0500CP31                    *
     F*           Addition of core hook DL0500CP32                    *
     F*           Addition of core hook DL0500CP33                    *
     F*           Addition of core hook DL0500CP34                    *
     F*           Addition of core hook DL0500CP35                    *
     F*           Addition of core hook DL0500CP36                    *
     F*           Addition of core hook DL0500CP37                    *
     F*           Addition of core hook DL0500CP38                    *
     F*           Addition of core hook DL0500CP39                    *
     F*           Addition of core hook DL0500CP40                    *
     F*           Addition of core hook DL0500CP41                    *
     F*           Addition of core hook DL0500CP42                    *
     F*           Addition of core hook DL0500CP43                    *
     F*           Addition of core hook DL0500CP44                    *
     F*           Addition of core hook DL0500CP45                    *
     F*           Addition of core hook DL0500CP46                    *
     F*           Addition of core hook DL0500CP47                    *
     F*           Addition of core hook DL0500CP48                    *
     F*           Addition of core hook DL0500CP49                    *
     F*           Addition of core hook DL0500CP50                    *
     F*           Addition of core hook DL0500CP51                    *
     F*           Addition of core hook DL0500CP52                    *
     F*           Addition of core hook DL0500CP53                    *
     F*           Addition of core hook DL0500CP54                    *
     F*           Addition of core hook DL0500CP55                    *
     F*           Addition of core hook DL0500FFP1                    *
     F*           Addition of core hook DL0500IIP1                    *
     F*           Addition of core hook DL0500OOP1                    *
     F*           Addition of core hook DL0500OOP2                    *
     F*           Addition of core hook DL0500OOP3                    *
     F*  CIR002 - Compounding of Interest.                            *
     F*  CIR001 - Interest Rate Calendars.                            *
     F*  067078 - The negative interest for Internal Contract is not  *
     F*           considered.                                         *
     F*  S01408 - Addition of core hook DL0500CCP4                    *
     F*           Addition of core hook DL0500CCP5                    *
     F*  S01408 - Addition of core hook DL0500FFPG                    *
     F*           Addition of core hook DL0500EEPG                    *
     F*           Addition of core hook DL0500IIPG                    *
     F*           Addition of core hook DL0500CCP1                    *
     F*           Addition of core hook DL0500CCP2                    *
     F*           Addition of core hook DL0500CCP3                    *
     F*  042900 - IRS deal didn't accrue on both the fixed side and   *
     F*           the floating side.  However, it accrued on the      *
     F*           previous day.  This means that both interest        *
     F*           accrued to date amounts for the 2 consecutive days  *
     F*           are the same.                                       *
     F*  032587 - Hash total calculation for deals file differs from  *
     F*           processing in DL0280 (NEGATIVE AMOUNTS).            *
     F*  066550 - GLINTC has had historical problems and inaccuracies *
     F*           and is now externaly descibed and changed to use    *
     F*           ZINTDYZ1. See document atached to error no on GEMS  *
     F*  060995 - Settlement sum in FRA was incorrect.  Interest      *
     F*           for excess days (due to holidays, etc.) of a one    *
     F*           year calculation are calculated separately.         *
     F*           Applied fix 031967 was change to have 10 days       *
     F*           for number of excess days.                          *
     F*  031967 - PROBLEMS CAN OCCUR WITH SETTLEMENT SUMS FOR FRAS    *
     F*           ENTERED WITH MATURITY DATES JUST GREATER THAN 1     *
     F*           YEAR (DUE TO EXACTLY 1 YEAR BEING A NON-WORKING     *
     F*           DAY) AS MIDAS WILL CALCULATE THIS SUM USING         *
     F*           2 CALCULATIONS (1 YEAR CALC PLUS EXTRA DAYS         *
     F*           CALC) RATHER THAN 1 CALC.                           *
     F*           THIS CAUSES THE INCORRECT AMOUNTS.                  *
     F*  048327 - NEXT INTEREST DATE NOT TAKEN INTO CONSIDERATION     *
     F*           PROPERLY                                            *
     F*  S01392 - JAP.SUB-MODULE INCORPORATION (CORE)                 *
     F*  043304 - FRA error in calulation of settlement amount for    *
     F*           Settlement formula - U.                             *
     F*  040318 - Settlement Formula for AUD (SETF=A) sometimes       *
     F*           outputs from DLRADS a negative amount; this causes  *
     F*           (eg.) a -ve Receipt which later becomes a Pay.      *
     F*  AUS021 - AUSTRALIAN PRODUCT. Includes two new settlement     *
     F*           formulas for FRAs. Initially includes one for       *
     F*           Australia and one for USA.                          *
     F*  E35983 - Calculation of discounted settlement amounts in     *
     F*           SR.DLRADS is done in wrong order which causes       *
     F*           half-adjust errors and consequent error of +/-      *
     F*           1 cent in settlement amount on confirmation         *
     F*  E28496 - Recompile for SDFAISPD changes (BQHEOC - Hedged     *
     F*           Events on Cashflow removed).                        *
     F*  E22762 - 'Interest paid/received' and 'interest              *
     F*           capitalised' should be subtracted (not added)       *
     F*           from QINT before subtracting AMAD to give AMTA.     *
     F*  E22610 - In SR DLRADS (calculates discounted settlement      *
     F*           amount for FRA's) discount factor for deals         *
     F*           longer than 1 year should use no. of days from      *
     F*           previous year, not current one.                     *
     F*  LN0135 - REMOVE 'END OF REPORT' FROM AUDIT REPORT            *
     F*  E19857 - For an IRS with a value date later than the         *
     F*           report date, AMTA was being incorrectly             *
     F*           calculated from report date.                        *
     F*  E17716 - Fixes have made SLID and VDAT/OTDT no longer        *
     F*           mutually exclusive, subsequently as SLID is         *
     F*           lower down the ACCEXAO output spec, for SW          *
     F*           deals SLID is output as opposed to VDAT/OTDT.       *
     F*  E16138 - Prevents difference of 0.01 between 'Total          *
     F*           Interest' & sum of 'Interest Accrued To Date'       *
     F*           & 'Interest To Accrue'.                             *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  S01194 - NEW STANDING DATA - USE ACCESS PROGRAMS             *
     F*  S01147 - RELEASE 22 (AMENDMENT TO GLINTC)                    *
     F*  E11045 - FOR NEGOTIABLE ASSETS PURCHASED,WHEN USING          *
     F*           FIRST DAY ACCURAL METHOD,IF NEXT WORKING            *
     F*           DAY IS INTEREST DAY,MATURITY DATE WAS BEING         *
     F*           USED INSTEAD OF NEXT INTEREST DATE.                 *
     F*  E10517 - INTEREST BEARING NEGOTIABLE ASSETS PURCHASED        *
     F*           INCORRECT                                           *
     F*  S01119 - FORWARD RATE AGREEMENTS/INTEREST RATE SWAPS         *
     F*  E47291 - WRONG DATE BEING USED AS 'ACCRUAL FROM' DATE        *
     F*           FOR LOAN/DEPOSIT AND INTEREST BEARING NEGOTIABLE    *
     F*           ASSET DEALS.                                        *
     F*  S01093 - IMPROVEMENTS TO PGM EFFICIENCY                      *
     F*           DEALS ARE READ FROM DEALSL, ONLY LIVE DEALS         *
     F*           ARE PROCESSED                                       *
     F*  E80945 - INDICATOR 98 SETTING IS SAVED AND RESTORED          *
     F*           WHEN S.R.GLINTC IS PERFORMED.                       *
     F*                                                               *
     F*****************************************************************
0013 F*EALS***IP**F*****400  6AI     2 DISK                               S01119
     F*EALS***IP**F*****600  6AI     2 DISK                        S01119 S01392
     F***DEALS***IP  F    1074  6AI     2 DISK                     S01392 CIR005
     F***DEALS** IP  F    2190  6AI     2 DISK                                         CIR005 CGL029
     F*DEALS***IP**F****2325**6AI*****2*DISK                                           CGL029 CDL038
     FDEALS   IP  F    2606  6AI     2 DISK                                                   CDL038
      *                                                                   S01408
     F/COPY WNCPYSRC,DL0500FFP1                                           S01408
      *                                                                   S01408
     FDLCFSCPDIF  E           K        DISK                               CIR001
     F** Cash Flow Schedule File                                          CIR001
     F*                                                                   CIR001
     FDLDEALL5IF  E           K        DISK                                                   CIR014
     F            DLDLDBD0                          KIGNORE                                   CIR014
     F            DLDLDCD0                          KIGNORE                                   CIR014
     F** Midas DL Deals Extension File                                                        CIR014
      *                                                                                       237049
     FDEAMSI  IF  E           K        DISK                                                   237049
      ** Deal Amendment SI records                                                            237049
      *                                                                                       237049
0014 F*************TABLE   IF  F      96 12AI     2 DISK                  S01194
     F*************TABTB70 IF  F      96 12AI     2 DISK                  S01194
0015 FACCEXAN O   F      64            DISK
     F*CCEXAO*O***F******64            DISK                               S01119
0015 F***ACCEXAO*O***F     121            DISK                     S01119 CIR001
0015 F*ACCEXAO*O***F*****137************DISK                                           CIR001 CDL038
0015 FACCEXAO O   F     141            DISK                                                   CDL038
0015 FACCEXAP O   F      64            DISK
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0500FFPG                                           S01408
     F*                                                                   S01408
0016 F**********DL0500P1O   F     132            PRINTER            S01124S01117
0016 FDL0500AUO   F     132            PRINTER                            S01117
     E*                                                                   S01408
     E/COPY WNCPYSRC,DL0500EEP1                                           S01408
     E*                                                                   S01408
     E                    CPY@    1   1 80
0017 E                    INT         2 15 0
0018 E                    DEC         2  3 0
0019 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0020 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0021 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    ##BR      999  3               Branch Codes                         CSC042
     E                    ##BC      999  3               Company Codes                        CSC042
     E*                                                                   S01408
     E/COPY WNCPYSRC,DL0500EEPG                                           S01408
      *                                                                                       CDL033
      *       81      Work indicator                                                          CDL033
      *                                                                                       CDL033
     E*                                                                   S01408
0022 F* ID F  C  H  L    FUNCTION OF INDICATORS
0023 F* 01            DEALS FILE - SWAPS
0024 F* 02            DEALS FILE - LOANS/DEPOSITS
0025 F* 03            DEALS FILE - NEGOTIABLE ASSETS
0026 F* 04            DEALS FILE - TRAILER
0027 F* 05            DEALS FILE - CATCHALL
0028 F* 06            DEALS FILE - NEG.ASSETS SOLD
     F* 07            DEALS FILE - FRA/IRS                                S01119
0029 F**10*********** TABLE FILE ICR 1 **********                         S01194
0030 F**11*********** TABLE FILE ICR 2 **********                         S01194
 031 F**12*********** TABLE FILE ICR 5 **********                         S01194
     F**13*********** TABLE FILE CATCHALL                                 S01194
0032 F*    21         NOTICE DAYS NEGATIVE
0033 F*    22         NEXT INTEREST DATE ZERO
0034 F*    23         SALE DATE - NA PURCHASED - ZERO
0034 F*       30      INITIAL RATE SET (U/TDNSI BIT 0)                    S01119
0034 F*       31      NEGATIVE INTEREST (U/TDSTI BIT 1)                   S01119
0034 F*       33      AVERAGE RATE CAP/COLLAR (U/TDSTI BIT 3)             S01119
0034 F*       34      CAP/COLLAR FLOOR RATE ENTERED (U/TDSTI BIT 4)       S01119
0035 F*       40      CONTROL OF FIRST CYCLE CALCS
0036 F********41******FAIL*OF*CHAIN*TO*TABLE*FILE*********************    S01194
0036 F*       41      FAIL ON CALL TO ANY ACCESS PROGRAM                  S01194
0037 F*       42      HASH AMOUNT IS NEGATIVE
0038 F*       43      LIVE DETAIL RECORD
0039 F*       45      ACCRUALS/PROFIT DATE IS BEFORE NEXT WORKING DAY
0040 F*       46      ON FOR FIRST CYCLE ONLY
0041 F*       47      FOREIGN EXCHANGE RECORD - SWAP
0042 F*       48      RECORD CODE IS '16'
0043 F*       49      START/LAST INT. DATE LATER THAN REPORT CONTROL DATE
0044 F*       50      POSITION SWAP RECORD
0045 F*       51      IGNORE 01 TYPE
0046 F*       52      IGNORE 02 TYPE
0047 F*       53      IGNORE 03 TYPE
0048 F*       54      N/A RECORD HAS DEAL TYPE C1,C2,BD OR BP
0049 F*       55      N/A RECORD HAS DEAL TYPE TA,TB OR DA
0050 F*       56      WRITE EXTRACT FOR INTERNAL DEPOSIT FROM POS. SWAP
0051 F*       57      REP. CTRL. DATE LESS THAN IC 1ST LEG VALUE DATE
0052 F*       58      ACCRUE ON LAST DAY INDICATOR IS Y
     F*       59      N.A. ACCRUALS INDICATOR - Y
0053 F*    60-63      USED TO FIND EARLIEST OF MDAT,NIDT AND SADT
     F*       64      DEAL TYPE C1
     F*       65      NO START/LAST INT. DATE SINCE ACCRUALS CONTROL DATE
0054 F*       70      MATURITY DATE PRECEDES NEXT INTEREST DATE
     F*       71      LAST INTEREST DATE LATER THAN VALUE DATE
 054 F*       72      WORK INDICATOR
     F*       73      WORK INDICATOR
     F*       74      CHAIN for DLDEALL5                                                      CIR014
     F*       80      FILE CONTROLS OUT OF BALANCE
0056 F*       99      ICR 1 DATABASE ERROR
      *                                                                   066550
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
      *                                                                   066550
     E                    FXT     5   5  2                                                    CDL033
0057 I*
0058 I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
0059 I*
0060 IDEALS   NS  01   1 CD   8 CB
0061 I       OR        1 CE   8 CB
0062 I       OR        1 CM   8 CB
0063 I       OR        1 CR   8 CB
0064 I                                        1   1 RECI
0065 I                                        2   70DLNO
0066 I                                        8   8 RCDT
0067 I                                        9  100RCDC
0068 I**********                             11  160CNUM                                      CSD027
0068 I                                       11  16 CNUM                                      CSD027
0069 I************************************** 17  190BRCD                  S01117
0069 I                                       17  19 BRCA                  S01117
0070 I                                       20  21 DTYP
0071 I                                       22  23 DLST
0072 I                                    P  24  260DDAT
0073 I                                    P  27  290VDAT
0074 I                                    P  30  320OTDT
0075 I                                       35  38 BRKC
0076 I                                    P  39  450BAGE
0077 I                                       46  48 PUCY
0078 I                                    P  49  550PUAM
0079 I                                    P  56  628EXRT
0080 I                                       86  88 SLCY
0081 I                                    P  89  950SLAM
0082 I                                    P 117 1230BCEQ
0083 I                                    P 131 1378LCXR
0084 I                                      138 1390PCST
0085 I**********                            140 151 OPCA                                      CGL029
0085 I                                      140 151 OPCAQQ                                    CGL029
0086 I                                      152 161 TSCN
0087 I                                      162 1630SCST
0088 I**********                            164 175 OSCA                                      CGL029
0088 I                                      164 175 OSCAQQ                                    CGL029
0089 I                                      176 185 TPCN
0090 I                                    P 192 1980ORPA
0091 I                                    P 205 2110ORSA
0092 I                                      212 2120FSLI
0093 I                                    P 213 2190LITD
0094 I                                    P 220 2260LILA
0095 I                                    P 227 2330DITD
0096 I                                    P 234 2400DILA
0097 I                                    P 241 2470SPPD
0098 I                                    P 248 2540SPLA
0099 I                                      255 257 SPLC
0100 I                                      258 260 ILCY
0101 I                                    P 261 2670ILAM
0102 I                                      268 270 IDCY
0103 I                                    P 271 2770IDAM
0104 I                                    P 278 2840IDIA
0105 I                                      285 290 SODN
0106 I                                      300 309 FACO
0107 I                                      310 344 SPI
0108 I                                    P 347 3527ILIR
0109 I                                    P 353 3587IDIR
0110 I                                    P 360 3660ILIA
0111 I                                      370 370 DNSI
0112 I                                      371 371 DSTI
0113 I                                      372 372 CNFI
0114 I                                      373 373 ACEI
0115 I                                      374 374 TLXI
0116 I                                      382 3820ILCM
0117 I                                      383 3830IDCM
0118 I                                    P 391 3930ORED
0119 I                                    P 394 3960LCD
0120 I                                      397 397 CHTP
0121 I                                    P 398 4000TNLU
     I                                     10511051 JLRDF                 S01392
     I                                     10521052 JDRDF                 S01392
0085 I                                     12921309 OPCA                                      CGL029
0088 I                                     13101327 OSCA                                      CGL029
     I                                     13641367 CLAS                                      CDL038
     I                                    P223622380BSDT1                                     CDL099
     I                                    P223922410BSDT2                                     CDL099
     I                                    P224222440BRSD2                                     CDL099
0122 I*
0123 I*
0124 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0125 I*
0126 IDEALS   NS  02   1 CD   8 CC
0127 I       OR        1 CE   8 CC
0128 I       OR        1 CM   8 CC
0129 I       OR        1 CR   8 CC
0130 I                                        1   1 RECI
0131 I                                        2   70DLNO
0132 I                                        8   8 RCDT
0133 I                                        9  100RCDC
0134 I**********                             11  160CNUM                                      CSD027
0134 I                                       11  16 CNUM                                      CSD027
0135 I************************************** 17  190BRCD                  S01117
0135 I                                       17  19 BRCA                  S01117
0136 I                                       20  21 DTYP
0137 I                                       22  23 DLST
0138 I                                    P  24  260DDAT
0139 I                                    P  27  290VDAT
0140 I                                    P  30  320MDAT
0141 I                                       33  340CDAS
0142 I                                       35  38 BRKC
0143 I                                    P  39  450BAGE
0144 I                                       46  48 CCY
0145 I                                    P  49  550PCPL
0146 I                                       56  56 INTC
0147 I**********                             63  640BRTT                                      CSD103
0147 I                                       63  64 BRTT                                      CSD103
0148 I                                    P  65  707BRTE
0149 I                                    P  71  767RTSP
0150 I                                    P  77  827INTR
0151 I                                       83  850NOTD          21
0152 I                                       86 105 RNNA
0153 I**********                            106 1110CHNA                                      CSD027
0153 I                                      106 111 CHNA                                      CSD027
0154 I                                      112 1140FACT
0155 I                                      115 1160FCNO
0156 I                                    P 117 1230OPAM
0157 I                                    P 124 1308BCXR
0158 I                                    P 131 1378LCXR
0159 I                                      138 1390SDST
0160 I                                      140 151 OSDA
0161 I                                      152 161 TSTN
0162 I                                      162 1630MDST
0163 I**********                            164 175 OMDA                                      CGL029
0163 I                                      164 175 OMDAQQ                                    CGL029
0164 I                                      176 185 TMAN
0165 I                                      186 1910RODN
0166 I                                    P 192 1980RODA
0167 I                                      199 2040RBDN
0168 I                                    P 205 2110RBDA
0169 I                                      212 2120ICBS
0170 I                                      213 213 IPFR
0171 I                                    P 214 2200TOTI
0172 I                                    P 221 2230NIDT
0173 I                                    P 224 2260IBDT
0174 I                                    P 227 2290SLID
0175 I                                    P 230 2360AIPD
0176 I                                    P 237 2390DLRC
0177 I                                    P 240 2420IACD
0178 I                                    P 243 2490AITC
0179 I                                    P 250 2560AIAN
0180 I                                    P 257 2630AIAP
0181 I                                    P 264 2700IPRD
0182 I                                    P 271 2770IPRM
0183 I                                    P 278 2840ICTD
0184 I                                    P 294 2960DAVD
0185 I                                      297 2990DASN
0186 I                                      300 309 FACO
0187 I                                      310 344 SPI
0188 I                                      345 3460INTF
0189 I                                      370 370 DNSI
0190 I                                      371 371 DSTI
0191 I                                      372 372 CNFI
0192 I                                      373 373 ACEI
0193 I                                      374 374 TLXI
0194 I                                    P 391 3930ORED
0195 I                                    P 394 3960LCD
0196 I                                      397 397 CHTP
0197 I                                    P 398 4000TNLU
     I                                     10721072 JRDFC                 S01392
     I                                     10731073 JFLID                 S01392
0163 I*************************************16721689 OMDA                               CGL029 CDL038
     I                                     17391756 OMDA                                      CDL038
     I                                    P185118530XKRCDT                                    CDL033
     I                                     18791879 XKBSVF                                    CDL033
     I                                    P188218840XKINFD                                    CDL033
     I                                     18851885 XKINFF                                    CDL033
     I                                    P188618917XKBSRF                                    CDL033
     I**********                           18981901 CLAS                             CDL038 BUG10282
     I                                     20102013 CLAS                                    BUG10282
     I                                     23502379 CCYPC                                     CDL096
     I                                     23502352 C1PC                                      CDL096
     I                                     23532355 C2PC                                      CDL096
     I                                     23562358 C3PC                                      CDL096
     I                                     23592361 C4PC                                      CDL096
     I                                     23622364 C5PC                                      CDL096
     I                                     23652367 C6PC                                      CDL096
     I                                     23682370 C7PC                                      CDL096
     I                                     23712373 C8PC                                      CDL096
     I                                     23742376 C9PC                                      CDL096
     I                                     23772379 C0PC                                      CDL096
     I                                     23802381 PYDC                                      CDL096
     I                                     23822383 AMTC                                      CDL096
0198 I*
0199 I*
0200 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
0201 I*
0202 IDEALS   NS  03   1 CD   8 CD
0203 I       OR        1 CE   8 CD
0204 I       OR        1 CM   8 CD
0205 I       OR        1 CR   8 CD
0206 I                                        1   1 RECI
0207 I                                        2   70DLNO
0208 I                                        8   8 RCDT
0209 I                                        9  100RCDC
0210 I**********                             11  160ISCN                                      CSD027
0210 I                                       11  16 ISCN                                      CSD027
0211 I************************************** 17  190BRCD                  S01117
0211 I                                       17  19 BRCA                  S01117
0212 I                                       20  21 DTYP
0213 I                                       22  23 DLST
0214 I                                    P  24  260DDAT
0215 I                                    P  27  290VDAT
0216 I                                    P  30  320MDAT
0217 I                                       33  340IDAS
0218 I                                       35  38 BRKC
0219 I                                    P  39  450BAGE
0220 I                                       46  48 CCY
0221 I                                    P  49  550PUPR
0222 I                                    P  57  627YRAT
0223 I                                    P  71  767RTSP
0224 I                                    P  77  827INTR
0225 I                                       86 105 RNNA
0226 I**********                            106 1110PCUS                                      CSD027
0226 I                                      106 111 PCUS                                      CSD027
0227 I                                      112 1140FACT
0228 I                                      115 1160FCNO
0229 I                                    P 117 1230FVAL
0230 I                                    P 124 1308BCXR
0231 I                                    P 131 1378LCXR
0232 I                                      138 1390SDST
0233 I                                      140 151 OSDA
0234 I                                      152 161 TSTN
0235 I                                      162 1630MDST
0236 I**********                            164 175 OMDA                                      CGL029
0236 I                                      164 175 OMDAQQ                                    CGL029
0237 I                                      176 185 TMAN
0238 I                                    P 192 1980DISA
0239 I                                    P 205 2110DPTD
0240 I                                      212 2120ICBS
0241 I                                      213 213 IPFR
0242 I                                    P 214 2200TOTI
0243 I                                    P 221 2230NIDT            22
0244 I                                    P 224 2260IBDT
0245 I                                    P 227 2290SLID
0246 I                                    P 230 2360AIPD
0247 I                                    P 237 2390DLRC
0248 I                                    P 240 2420IACD
0249 I                                    P 243 2490AITC
0250 I                                    P 250 2560AIAN
0251 I                                    P 257 2630AIAP
0252 I                                    P 264 2700IPRD
0253 I                                    P 271 2770IPRM
0254 I                                    P 278 2840SAPR
0255 I                                      285 2900ASDN
0256 I                                    P 291 2930SADT            23
0257 I                                    P 294 2960DAVD
0258 I                                      297 2990DASN
0259 I                                      300 309 FACO
0260 I                                      310 344 SPI
0261 I                                      345 3460INTF
     I                                    P 348 3540PINT
0262 I                                      370 370 DNSI
0263 I                                      371 371 DSTI
0264 I                                      372 372 CNFI
0265 I                                      373 373 ACEI
0266 I                                      374 374 TLXI
0267 I                                    P 391 3930ORED
0268 I                                    P 394 3960LCD
0269 I                                      397 397 CHTP
0270 I                                    P 398 4000TNLU
     I                                     10511051 JRDFC                 S01392
0236 I*************************************11821199 OMDA                               CGL029 CDL038
     I                                     12451262 OMDA                                      CDL038
     I                                     13171320 CLAS                                      CDL038
0271 I*
0272 I*
     I*    DEALS FILE - DETAIL RECORD - FRA/IRS/CAP & COLLAR.             S01119
     I*                                                                   S01119
     I        NS  07   1 CD   8 CG                                        S01119
     I       OR        1 CE   8 CG                                        S01119
     I       OR        1 CM   8 CG                                        S01119
     I       OR        1 CR   8 CG                                        S01119
0277 I                                        1   1 RECI                  S01119
     I                                        2   70DLNO                  S01119
     I                                        8   8 RCDT                  S01119
     I                                        9  100RCDC                  S01119
     I**********                             11  160CNUM                               S01119 CSD027
     I                                       11  16 CNUM                                      CSD027
     I************************************** 17  190BRCD            S01119S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP                  S01119
     I                                       22  23 DLST                  S01119
     I                                    P  24  260DDAT                  S01119
     I                                    P  27  290VDAT                  S01119
     I                                    P  30  320MDAT                  S01119
     I                                       33  340CDAS                  S01119
     I                                       35  38 BRKC                  S01119
     I                                    P  39  450BAGE                  S01119
     I                                       46  510LNKDN                 S01119
     I                                       52  52 HEDIN                 S01119
     I                                       53  53 TAXI                  S01119
     I                                       54  56 UCUCY                 S01119
     I                                    P  57  630UPAMT                 S01119
     I**********                             64  650UBRTT                              S01119 CSD103
     I                                       64  65 UBRTT                                     CSD103
     I                                    P  66  717USTRT                 S01119
     I                                    P  72  777UBRTE                 S01119
     I                                    P  78  837URTSP                 S01119
     I                                       84  84 USPIN                 S01119
     I                                    P  85  907UEINR                 S01119
     I                                       91  910UICBS                 S01119
     I                                       92  930UFRFD                 S01119
     I                                    P  94  960UINFD                 S01119
     I                                    P  97  990USLIP                 S01119
     I                                    P 100 1020UNICD                 S01119
     I                                    P 103 1050UICBD                 S01119
     I                                      106 106 UICFR                 S01119
     I                                      107 1080UICFD                 S01119
     I                                    P 109 1110UNIPD                 S01119
     I                                    P 112 1140UIPBD                 S01119
     I                                      115 115 UIPFR                 S01119
     I                                      116 1170UIPFD                 S01119
     I                                    P 118 1248UBCXR                 S01119
     I                                    P 125 1270UIACD                 S01119
     I                                    P 128 1340UIALC                 S01119
     I                                    P 135 1410UAITC                 S01119
     I                                    P 142 1480UAIPD                 S01119
     I                                    P 149 1550UAIAN                 S01119
     I                                    P 156 1620UAIAP                 S01119
     I                                    P 163 1690UIPRD                 S01119
     I                                    P 170 1760UIPRM                 S01119
     I                                    P 177 1830UNSAM                 S01119
     I                                    P 184 1900UTAXD                 S01119
     I                                    P 191 1970UTAXM                 S01119
     I                                      198 200 TCUCY                 S01119
     I                                    P 201 2070TPAMT                 S01119
     I**********                            208 2090TBRTT                              S01119 CSD103
     I                                      208 209 TBRTT                                     CSD103
     I                                    P 210 2157TSTRT                 S01119
     I                                    P 216 2217TBRTE                 S01119
     I                                    P 222 2277TRTSP                 S01119
     I                                      228 228 TSPIN                 S01119
     I                                    P 229 2347TEINR                 S01119
     I                                      235 2350TICBS                 S01119
     I                                      236 2370TFRFD                 S01119
     I                                    P 238 2400TINFD                 S01119
     I                                    P 241 2430TSLIP                 S01119
     I                                    P 244 2460TNICD                 S01119
     I                                    P 247 2490TICBD                 S01119
     I                                      250 250 TICFR                 S01119
     I                                      251 2520TICFD                 S01119
     I                                    P 253 2550TNIPD                 S01119
     I                                    P 256 2580TIPBD                 S01119
     I                                      259 259 TIPFR                 S01119
     I                                      260 2610TIPFD                 S01119
     I                                    P 262 2688TBCXR                 S01119
     I                                    P 269 2710TIACD                 S01119
     I                                    P 272 2780TIALC                 S01119
     I                                    P 279 2850TAITC                 S01119
     I                                    P 286 2920TAIPD                 S01119
     I                                    P 293 2990TAIAN                 S01119
     I                                    P 300 3060TAIAP                 S01119
     I                                    P 307 3130TIPRD                 S01119
     I                                    P 314 3200TIPRM                 S01119
     I                                    P 321 3270TNSAM                 S01119
     I                                    P 328 3340TTAXD                 S01119
     I                                    P 335 3410TTAXM                 S01119
     I                                    P 342 3477CLRAT                 S01119
     I                                    P 348 3537FLRAT                 S01119
     I                                    P 354 3550AVPER                 S01119
     I                                    P 356 3638TIRAT                 S01119
     I                                    P 364 3697AACRT                 S01119
     I                                      370 3710RSETM                 S01119
     I**********                            372 383 URACC                              S01119 CGL029
     I                                      372 383 URACQQ                                    CGL029
     I                                      384 393 CPPBK                 S01119
     I                                      394 3950PSETM                 S01119
     I**********                            396 407 UPACC                              S01119 CGL029
     I                                      396 407 UPACQQ                                    CGL029
     I                                      408 417 CPRBK                 S01119
     I                                      418 427 FACO                  S01119
     I                                      428 462 SPI                   S01119
     I                                    P 463 4650SDCAR                 S01119
     I                                    P 466 4680ULPCD                 S01119
     I                                    P 469 4710TLPCD                 S01119
     I                                    P 472 4780UAEXA                 S01119
     I                                    P 479 4850TAEXA                 S01119
     I                                      570 570 UDNSI                 S01119
     I                                      571 571 TDNSI                 S01119
     I                                      572 572 UDSTI                 S01119
     I                                      573 573 TDSTI                 S01119
     I                                      574 574 CNFI                  S01119
     I                                      575 575 ACEI                  S01119
     I                                      576 576 TLXI                  S01119
     I                                      577 577 SETF                  AUS021
     I                                    P 587 5880LSWC                  S01119
     I                                    P 589 5900LSWS                  S01119
     I                                    P 591 5930ORED                  S01119
     I                                    P 594 5960LCD                   S01119
     I                                      597 597 CHTP                  S01119
     I                                    P 598 6000TNLU                  S01119
     I                                      616 616 UINPM                 CIR001
     I                                    P 617 6190UNPCD                 CIR001
     I                                      620 620 TINPM                 CIR001
     I                                    P 621 6230TNPCD                 CIR001
     I                                    P 624 6260UPVD                  CIR001
     I                                    P 627 6330UPFE                  CIR001
     I                                      634 634 UPPR                  CIR001
     I                                    P 635 6410UPAD                  CIR001
     I                                    P 642 6440BODD                  CIR001
     I                                    P 645 6470BOVD                  CIR001
     I                                    P 648 6540BOAM                  CIR001
     I                                      655 655 BAPR                  CIR001
     I                                    P 656 6630OUSI                  CIR001
     I                                    P 664 6710OUSA                  CIR001
     I                                    P 672 6790TUSI                  CIR001
     I                                    P 680 6870TUSA                  CIR001
     I                                     20632065 L1CYP1                CIR005
     I                                     20662068 L1CYP2                CIR005
     I                                     20692071 L1CYP3                CIR005
     I                                     20722074 L1CYP4                CIR005
     I                                     20752077 L1CYP5                CIR005
     I                                     20782080 L1CYP6                CIR005
     I                                     20812083 L1CYP7                CIR005
     I                                     20842086 L1CYP8                CIR005
     I                                     20872089 L1CYP9                CIR005
     I                                     20902092 L1CYP0                CIR005
     I                                     20932094 L1PDCN                CIR005
     I                                     20952096 L1AMCN                CIR005
     I                                     20972099 L1CYR1                CIR005
     I                                     21002102 L1CYR2                CIR005
     I                                     21032105 L1CYR3                CIR005
     I                                     21062108 L1CYR4                CIR005
     I                                     21092111 L1CYR5                CIR005
     I                                     21122114 L1CYR6                CIR005
     I                                     21152117 L1CYR7                CIR005
     I                                     21182120 L1CYR8                CIR005
     I                                     21212123 L1CYR9                CIR005
     I                                     21242126 L1CYR0                CIR005
     I                                     21272129 L2CYP1                CIR005
     I                                     21302132 L2CYP2                CIR005
     I                                     21332135 L2CYP3                CIR005
     I                                     21362138 L2CYP4                CIR005
     I                                     21392141 L2CYP5                CIR005
     I                                     21422144 L2CYP6                CIR005
     I                                     21452147 L2CYP7                CIR005
     I                                     21482150 L2CYP8                CIR005
     I                                     21512153 L2CYP9                CIR005
     I                                     21542156 L2CYP0                CIR005
     I                                     21572158 L2PDCN                CIR005
     I                                     21592160 L2AMCN                CIR005
     I                                     21612163 L2CYR1                CIR005
     I                                     21642166 L2CYR2                CIR005
     I                                     21672169 L2CYR3                CIR005
     I                                     21702172 L2CYR4                CIR005
     I                                     21732175 L2CYR5                CIR005
     I                                     21762178 L2CYR6                CIR005
     I                                     21792181 L2CYR7                CIR005
     I                                     21822184 L2CYR8                CIR005
     I                                     21852187 L2CYR9                CIR005
     I                                     21882190 L2CYR0                CIR005
     I*************************************22902307 UPACC                              CGL029 CDL038
     I*************************************23082325 URACC                              CGL029 CDL038
     I                                     24692486 URACC                                     CDL038
     I                                     24872504 UPACC                                     CDL038
     I                                     26032606 CLAS                                      CDL038
     I/COPY WNCPYSRC,DL0500I001
     I*                                                                   S01119
0273 I*
0274 I*    DEALS FILE -TRAILER RECORD.
0275 I*
0276 IDEALS   NS  04   1 CT
0277 I                                        1   1 RECI
0278 I                                        2   70DLNO
0279 I                                        8   8 RCDT
0280 I                                        9  100RCDC
0281 I**********                             11  160CNUM                                      CSD027
0281 I                                       11  16 CNUM                                      CSD027
0282 I                                    P  17  190NORE
0283 I                                    P  20  220FLSZ
0284 I                                    P  23  250NLRB
0285 I                                    P  26  280NINS
0286 I                                    P  29  310NDEL
0287 I                                    P  32  340NLRA
0288 I                                    P  35  420VLBF
0289 I                                    P  43  440VLBL
0290 I                                    P  45  520VRIF
0291 I                                    P  53  540VRIL
0292 I                                    P  55  620VRDF
0293 I                                    P  63  640VRDL
0294 I                                    P  65  720VLAF
0295 I                                    P  73  740VLAL
0296 I                                    P  75  770DTMR
0297 I                                    P  78  800ITMR
0298 I                                    P 394 3960LCD
0299 I                                      397 397 CHTP
0300 I                                    P 398 4000TNLU
0301 I*
0302 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
0303 I*
0304 I        NS  06   1 CD   8 CE
0305 I       OR        1 CE   8 CE
0306 I       OR        1 CM   8 CE
0307 I       OR        1 CR   8 CE
0308 I                                        1   1 RECI
0309 I                                    P  49  550SAPRDE
0310 I*
0311 I*    CATCHALL
0312 I*
0313 I        NS  05
0314 I                                        1   1 RECI
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0500IIPG                                           S01408
     I*                                                                   S01408
      *                                                                                       237049
      ** Rename DEAMSDI fields to distinguish from DEALS fields                               237049
      *                                                                                       237049
     IDEAMSDIF                                                                                237049
     I              RECI                            RECIA                                     237049
     I              DLNO                            DLNOA                                     237049
     I              VDAT                            VDATA                                     237049
     I              DASN                            DASNA                                     237049
     I              DTYP                            DTYPA                                     237049
     I              DLST                            DLSTA                                     237049
     I              AMTP                            AMTPA                                     237049
     I              PSEQ                            PSEQA                                     237049
     I              BRTT                            BRTTA                                     237049
     I              RTSP                            RTSPA                                     237049
     I              CCY                             CCYA                                      237049
     I              DAAM                            DAAMA                                     237049
     I              MOGI                            MOGIA                                     237049
     I              CNUM                            CNUMA                                     237049
     I              SETP                            SETPA                                     237049
     I              OSAC                            OSACA                                     237049
     I              TSEN                            TSENA                                     237049
     I              FACO                            FACOA                                     237049
     I              SPI                             SPIA                                      237049
     I              OSBR                            OSBRA                                     237049
     I              BRCA                            BRCAA                                     237049
     I              NAAD                            NAADA                                     237049
     I              NASN                            NASNA                                     237049
     I              DAIN                            DAINA                                     237049
     I              LSWC                            LSWCA                                     237049
     I              ORED                            OREDA                                     237049
     I              LCD                             LCDA                                      237049
     I              CHTP                            CHTPA                                     237049
     I              TNLU                            TNLUA                                     237049
     I              RSTM                            RSTMA                                     237049
     I              RONS                            RONSA                                     237049
     I              RIBN                            RIBNA                                     237049
     I              RIBA                            RIBAA                                     237049
     I              ROBN                            ROBNA                                     237049
     I              ROCN                            ROCNA                                     237049
     I              PSTM                            PSTMA                                     237049
     I              PONS                            PONSA                                     237049
     I              PIBN                            PIBNA                                     237049
     I              PIBA                            PIBAA                                     237049
     I              POBN                            POBNA                                     237049
     I              POCN                            POCNA                                     237049
     I              RCRN                            RCRNA                                     237049
     I              RCRA                            RCRAA                                     237049
     I              RVNO                            RVNOA                                     237049
     I              AWBN                            AWBNA                                     237049
     I              AWBA                            AWBAA                                     237049
     I              BENN                            BENNA                                     237049
     I              BENA                            BENAA                                     237049
     I              DTP1                            DTP1A                                     237049
     I              DTP2                            DTP2A                                     237049
     I              DTP3                            DTP3A                                     237049
     I              DTP4                            DTP4A                                     237049
     I              DCHG                            DCHGA                                     237049
     I              BTB1                            BTB1A                                     237049
     I              BTB2                            BTB2A                                     237049
     I              BTB3                            BTB3A                                     237049
     I              BTB4                            BTB4A                                     237049
     I              BTB5                            BTB5A                                     237049
     I              BTB6                            BTB6A                                     237049
     I              CVMR                            CVMRA                                     237049
     I              FSRP                            FSRPA                                     237049
     I              IRCF                            IRCFA                                     237049
     I              FRCF                            FRCFA                                     237049
     I              STCY                            STCYA                                     237049
     I              IC72                            IC72A                                     237049
     I              FCGC                            FCGCA                                     237049
     I              FCGD                            FCGDA                                     237049
     I              FCGA                            FCGAA                                     237049
     I              FCGT                            FCGTA                                     237049
     I              REPI                            REPIA                                     237049
     I              AUTH                            AUTHA                                     237049
     I              EMDAT                           EMDATA                                    237049
     I              BRTE                            BRTEA                                     237049
     I              CLAS                            CLASA                                     237049
0315 I*
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I** EXTERNAL DS FOR GENERAL LEDGER DETAILS                           S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I** EXTERNAL DS FOR MIDAS MODULE DETAILS                             S01194
     I*                                                                   S01194
     ISDDEAL    E DSSDDEALPD                                              S01194
     I** EXTERNAL DS FOR DEAL DATA CODE DETAILS                           S01194
     I*                                                                   S01194
     I              QQACCD                          QQACD1                                    CGL029
     ISDFAIS    E DSSDFAISPD                                              S01194
     I** EXTERNAL DS FOR FRA/IRS DETAILS                                  S01194
     I*                                                                   S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I** EXTERNAL DS FOR BRANCH DETAILS                                   S01117
     I*                                                                   CIR001
     ISCSARD    E DSSCSARDPD                                              CIR001
     I** DUMMY RECORD FORMAT FOR SAR DETAILS                              CIR001
     I*
     ISDCURR    E DSSDCURRPD                                                                  204923
      ** Data Structure for Currency details                                                  204923
      *                                                                                       204923
     IDSSDY     E DSDSSDY                                                                     204923
      ** Second DS for access programs, long data structure                                   204923
      *                                                                   S01408
     I/COPY WNCPYSRC,DL0500IIP1                                           S01408
      *                                                                   S01408
      *                                                                                       CDL033
     ISDBSRT    E DSSDBSRTPD                                                                  CDL033
      ** Externally described DS for Base Rate details                                        CDL033
      *                                                                                       CDL033
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
 316 I*****TABLE FILE I.C.D.R. 1, 2 AND 5                                 S01194
0317 I*****                                                               S01194
0318 I*****TABLE   NS  10   1 CD   2 C0   3 C1                            S01194
0319 I*****  AND      12 C1  13 C0                                        S01194
0320 I*****                                   1   1 RECI                  S01194
0321 I*****                                  14  66 TITL                  S01194
0322 I*****                                  67  67 DATF                  S01194
0323 I*****                               P  77  790RUND                  S01194
0324 I*****                                  80  86 RUNA                  S01194
0325 I*****                                                               S01194
0326 I*****   NS  11   1 CD   2 C0   3 C1                                 S01194
0327 I*****  AND      12 C1  13 C1                                        S01194
0328 I*****                               P  29  310APDA                  S01194
0329 I*****                               P  41  430DNWD                  S01194
0330 I*****                                  52  52 ACLD                  S01194
0325 I*****                                                               S01194
0326 I*****   NS  12   1 CD   2 C0   3 C1                                 S01194
0327 I*****  AND      12 C4  13 C0                                        S01194
0328 I*****                                   1   1 RECI                  S01194
0329 I*****                                   2   30RECT                  S01194
0330 I*****                                  12  130RCDE                  S01194
     I*****                                  14  14 IRFRA          S01119 S01194
     I*****                                  71  71 NAAI                  S01194
0331 I*****                                                               S01194
0332 I*****CATCHALL                                                       S01194
0333 I*****   NS  13                                                      S01194
     I*****                                   1   1 RECI                  S01194
0334 I*****                                                               S01194
0334 I*****                                                               S01194
     I*****                                                         S01119S01194
     I*****TABLE FILE - I.C.D.R. 70 (PF/TABTB70) FRA/IRS DETAILS.   S01119S01194
     I*****                                                         S01119S01194
     I*****TABTB70 NS       1 CD   2 C0   3 C1                      S01119S01194
     I*****  AND      12 C7  13 C0                                  S01119S01194
     I*****                                  16  16 HFRAA           S01119S01194
     I*****                                                         S01119S01194
     I*****CATCHALL.                                                S01119S01194
     I*****   NS                                                    S01119S01194
     I*****                                   1   1 RECI            S01119S01194
     I*****                                                         S01119S01194
     I*                                                                   S01194
0335 I*    DEFINE DATA STRUCTURE FOR TOTALLING VALUE OF RECORDS READ
0336 I*    FROM DEALS FILE
0337 I            DS
0338 I                                        1  130DAMT
0339 I                                        1  130PUAM
0340 I                                        1  130PCPL
0341 I                                        1  130PUPR
0342 I                                        1  130SAPRDE
     I                                        1  130UPAMT                 S01119
     I*                                                                   S01119
     I**   LOCAL DATA AREA TO HOLD DATABASE ERROR DATA                    S01119
     I*                                                                   S01119
     ILDA         DS                            256                       S01119
     I**********                            134 138 DBFILE          S01119S01117
     I**********                            139 167 DBKEY           S01119S01117
     I**********                            168 175 DBPGM           S01119S01117
     I**********                            176 1770DBASE           S01119S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I*                                                                   S01117
     I/COPY WNCPYSRC,DL0500IIP2                                           S01408
      *                                                                   066550
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
      *                                                                   066550
0343 I/EJECT
      *                                                                                       237049
     C           *LIKE     DEFN DLNO      ##DLNO                                              237049
     C           *LIKE     DEFN DLNO      DLNO2                                               237049
     C           *LIKE     DEFN VDAT      VDAT2                                               237049
     C           *LIKE     DEFN DASN      DASN2                                               237049
0344 C*
0345 C*    FIRST CYCLE CALCS
0346 C*
0347 C   40                SETOF                     4650
0348 C   40                GOTO DETAIL
0349 C                     SETON                     4046
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP56                                           S01408
     C*                                                                   S01408
0350 C******************** EXSR ZSYSTM                                    S01194
     C                     MOVEACPY@      BIS@   80
     C                     Z-ADD0         ##BNDX  40                                          CSC042
     C           *LIKE     DEFN ##BNDX    B                                                   CSC042
     C           *LIKE     DEFN ##BNDX    ##BSV                                               CSC042
      *                                                                                       CSC042
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE           ************   S01194
     C                     MOVEL'01'      DBASE            * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '1'       *IN99                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO TOTAL                                     S01194
     C                     END                                            S01194
0351 C***99***             SETON                     U7U8LR               S01194
0352 C***99***             GOTO TOTAL                                     S01194
0353 C*****                MOVE '1'       ZTABKY                          S01194
0354 C*****      ZTABKY    CHAINTABLE                41                   S01194
     C*****      RECI      COMP 'D'                  4141                 S01194
     C** READ GENERAL LEDGER DETAILS VIA ACCESS PROGRAM                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDGELRPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '1'       *IN41                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO TOTAL                                     S01194
     C                     END                                            S01194
     C***41***             SETON                     U7U8LR               S01194
     C***41***             GOTO TOTAL                                     S01194
0355 C***********ACLD      COMP 'Y'                      58               S01194
0355 C           BKALDI    COMP 'Y'                      58               S01194
0356 C*
0357 C***********APDA******COMP DNWD                   45                 S01194
0357 C           BKAPDT    COMP BJDNWD                 45                 S01194
0358 C** DETERMINE TITLE DATE
0359 C*********************Z-ADDDNWD      TDAT    50                      S01194
0360 C***45******APDA******ADD  1         TDAT                            S01194
0359 C                     Z-ADDBJDNWD    TDAT    50                      S01194
0360 C   45      BKAPDT    ADD  1         TDAT                            S01194
0361 C*    DETERMINE REPORT CONTROL DATE
0362 C*********************Z-ADDDNWD      REPCD   50                      S01194
0363 C***58******DNWD******SUB  1         REPCD                           S01194
0364 C***45******APDA******ADD  1         REPCD                           S01194
0365 C***45*58*************Z-ADDAPDA      REPCD                           S01194
0362 C                     Z-ADDBJDNWD    REPCD   50                      S01194
0363 C   58      BJDNWD    SUB  1         REPCD                           S01194
0364 C   45      BKAPDT    ADD  1         REPCD                           S01194
0365 C   45 58             Z-ADDBKAPDT    REPCD                           S01194
0366 C                     Z-ADD0         ZERO15 150                                          CDL038
0366 C                     Z-ADD0         ZERO13 130
0367 C                     Z-ADD0         ZERO11 117
     C                     Z-ADD0         ZERO05  50                      S01119
     C*
     C*****CHAIN*TO*I.C.D.R.5*TO*OBTAIN*N.A.*ACCRUALS*INDICATOR****       S01194
     C********************                                                S01194
     C******************** MOVE '40'      ZTABKY                          S01194
     C********** ZTABKY*** CHAINTABLE                41                   S01194
     C**N41***** RECI***** COMP 'D'                  4141                 S01194
     C** READ DEAL DATA CODES DETAILS VIA ACCESS PROGRAM                  S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDEALPD'DBFILE           ************   S01194
     C                     MOVEL'03'      DBASE            * DBERR 03 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '1'       *IN41                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO TOTAL                                     S01194
     C                     END                                            S01194
     C***41***             SETON                     U7U8LR               S01194
     C***41***             GOTO TOTAL                                     S01194
     C*                                                                   S01194
     C** READ DEAL DATA CODES DETAILS VIA ACCESS PROGRAM                  S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDMMODPD'DBFILE           ************   S01194
     C                     MOVEL'04'      DBASE            * DBERR 04 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '1'       *IN41                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO TOTAL                                     S01194
     C                     END                                            S01194
     C***41***             SETON                     U7U8LR               S01194
     C***41***             GOTO TOTAL                                     S01194
     C*
     C**  CHECK FOR N.A. ACCRUALS INDICATOR -
     C*
     C********** NAAI      COMP 'Y'                      59               S01194
     C           BNNAIA    COMP 'Y'                      59               S01194
     C*
     C*
     C*****IF*FRA/IRS*PRESENT*ACCESS*I.C.D.R.*70.***************    S01119S01194
     C********************                                          S01119S01194
     C********** IRFRA***  IFEQ 'Y'                                 S01119S01194
     C*******************  READ TABTB70                  41         S01119S01194
     C************IN41***  IFEQ '1'                                 S01119S01194
     C***********RECI****  ORNE 'D'                                 S01119S01194
     C*******************  SETON                     U7U8LR         S01119S01194
     C*******************  MOVE 'DL0500  'DBPGM            *********S01119S01194
     C*******************  MOVE '01'      DBASE            *   DBERRS01119S01194
     C*******************  MOVE 'TABLE'   DBFILE           *     01 S01119S01194
     C*******************  MOVEL'TABTB70 'DBKEY            *********S01119S01194
     C*******************  GOTO TOTAL                               S01119S01194
     C*******************  END                                      S01119S01194
     C**   IF FRA/IRS PRESENT ACCESS FRA/IRS DETAILS                S01119S01194
     C*                                                             S01119S01194
     C           BGFIIN    IFEQ 'Y'                                       S01194
     C** READ FRA/IRS DETAILS VIA ACCESS PROGRAM                          S01194
     C                     CALL 'AOFAISR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDFAIS    PARM SDFAIS    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDFAISPD'DBFILE           ************   S01194
     C                     MOVEL'05'      DBASE            * DBERR 05 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '1'       *IN41                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO TOTAL                                     S01194
     C                     END                                            S01194
     C***41***             SETON                     U7U8LR               S01194
     C***41***             GOTO TOTAL                                     S01194
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C******************** MOVE 'N'       HFRAA                     S01119S01194
     C                     MOVE 'N'       BQHFRA                          S01194
     C                     END                                            S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP6                                           S01408
      *                                                                                       CDL099
      ** Determine if feature CDL099 is On                                                    CDL099
      *                                                                                       CDL099
     C                     MOVE *BLANK    CDL099  1                                           CDL099
     C                     CALL 'AOSARDR0'                                                    CDL099
     C                     PARM *BLANKS   @RTCD                                               CDL099
     C                     PARM '*VERIFY' @OPTN                                               CDL099
     C                     PARM 'CDL099'  @SARD                                               CDL099
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL099
      *                                                                                       CDL099
     C           @RTCD     IFEQ *BLANKS                                                       CDL099
     C                     MOVE 'Y'       CDL099                                              CDL099
     C                     ELSE                                                               CDL099
     C                     MOVE 'N'       CDL099                                              CDL099
     C                     ENDIF                                                              CDL099
      *                                                                   S01408
      *                                                                                       CDL033
      ** Determine if Floating Rate CD Issued feature is                                      CDL033
      ** switched on.                                                                         CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    CDL033  1                                           CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*VERIFY' @OPTN                                               CDL033
     C                     PARM 'CDL033'  @SARD                                               CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVE 'Y'       CDL033                                              CDL033
     C                     ELSE                                                               CDL033
     C           @RTCD     IFNE '*NRF   '                                                     CDL033
     C                     MOVE '17'      DBASE                                               CDL033
     C                     MOVEL'CDL033'  DBKEY                                               CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO TOTAL                                                         CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Determine event control date (applicable to this                                     CDL033
      ** program only) to be used for rate fixing processing.                                 CDL033
      *                                                                                       CDL033
     C           BKANWD    IFNE '2'                                                           CDL033
     C           BJDNWD    SUB  1         WEVCD   50                                          CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDBKAPDT    WEVCD                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C*                                                                   S01119
     C** Check if switchable feature CIR001 is switched on                CIR001
     C*                                                                   CIR001
     C                     CALL 'AOSARDR0'                                CIR001
     C                     PARM *BLANKS   @RTCD                           CIR001
     C                     PARM '*VERIFY' @OPTN                           CIR001
     C                     PARM 'CIR001'  @SARD   6                       CIR001
     C           SCSARD    PARM SCSARD    DSFDY                           CIR001
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANK                                    CIR001
     C           @RTCD     ANDNE'*NRF   '                                 CIR001
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR001
     C                     MOVEL'07'      DBASE            * DB ERROR 07 *CIR001
     C                     MOVEL'CIR001'  DBKEY            ***************CIR001
     C                     SETON                     U7U8LR               CIR001
     C                     MOVE '1'       *IN41                           CIR001
     C                     EXSR *PSSR                                     CIR001
     C                     GOTO TOTAL                                     CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           @RTCD     IFEQ *BLANKS                                   CIR001
     C                     MOVE 'Y'       CIR001  1                       CIR001
     C                     MOVE '1'       *IN10                           CIR001
     C                     ELSE                                           CIR001
     C                     MOVE 'N'       CIR001                          CIR001
     C                     MOVE '0'       *IN10                           CIR001
     C                     END                                            CIR001
     C*                                                                   CIR002
     C** Check if switchable feature CIR002 is switched on                CIR002
     C*                                                                   CIR002
     C                     CALL 'AOSARDR0'                                CIR002
     C                     PARM *BLANKS   @RTCD                           CIR002
     C                     PARM '*VERIFY' @OPTN                           CIR002
     C                     PARM 'CIR002'  @SARD   6                       CIR002
     C           SCSARD    PARM SCSARD    DSFDY                           CIR002
     C*                                                                   CIR002
     C           @RTCD     IFNE *BLANK                                    CIR002
     C           @RTCD     ANDNE'*NRF   '                                 CIR002
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR002
     C                     MOVEL'08'      DBASE            * DB ERROR 08 *CIR002
     C                     MOVEL'CIR002'  DBKEY            ***************CIR002
     C                     SETON                     U7U8LR               CIR002
     C                     MOVE '1'       *IN41                           CIR002
     C                     EXSR *PSSR                                     CIR002
     C                     GOTO TOTAL                                     CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C           @RTCD     IFEQ *BLANKS                                   CIR002
     C                     MOVE 'Y'       CIR002  1                       CIR002
     C                     MOVE '1'       *IN11                           CIR002
     C                     ELSE                                           CIR002
     C                     MOVE 'N'       CIR002                          CIR002
     C                     MOVE '0'       *IN11                           CIR002
     C                     END                                            CIR002
      *                                                                   CIR005
      ** Check if switchable feature CIR005 is switched on                CIR005
     C/COPY WNCPYSRC,DL0500C053
      *                                                                   CIR005
     C                     CALL 'AOSARDR0'                                CIR005
     C                     PARM *BLANKS   @RTCD                           CIR005
     C                     PARM '*VERIFY' @OPTN                           CIR005
     C                     PARM 'CIR005'  @SARD                           CIR005
     C           SCSARD    PARM SCSARD    DSFDY                           CIR005
      *                                                                   CIR005
     C           @RTCD     IFNE *BLANK                                    CIR005
     C           @RTCD     ANDNE'*NRF   '                                 CIR005
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR005
     C                     MOVEL'009'     DBASE            * DB ERROR 09 *CIR005
     C                     MOVEL'CIR005'  DBKEY            ***************CIR005
     C                     SETON                     U7U8                 CIR005
     C                     EXSR *PSSR                                     CIR005
     C                     GOTO END                                       CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C           @RTCD     IFEQ *BLANKS                                   CIR005
     C                     MOVE 'Y'       CIR005  1                       CIR005
     C                     ELSE                                           CIR005
     C                     MOVE 'N'       CIR005                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR006
      ** Check if CIR017 is switched on                                                       CIR017
      *                                                                                       CIR017
     C                     CALL 'AOSARDR0'                                                    CIR017
     C                     PARM           @RTCD                                               CIR017
     C                     PARM '*VERIFY' @OPTN                                               CIR017
     C                     PARM 'CIR017'  @SARD                                               CIR017
      *                                                                                       CIR017
     C           @RTCD     IFEQ *BLANKS                                                       CIR017
     C                     MOVE 'Y'       CIR017  1                                           CIR017
     C                     ELSE                                                               CIR017
     C                     MOVE 'N'       CIR017                                              CIR017
     C                     ENDIF                                                              CIR017
      *                                                                                       CDL096
      ** Check if CDL096 - Business Day Conventions for MM Deals - is switched on             CDL096
     C                     CALL 'AOSARDR0'                                                    CDL096
     C                     PARM           @RTCD                                               CDL096
     C                     PARM '*VERIFY' @OPTN                                               CDL096
     C                     PARM 'CDL096'  @SARD                                               CDL096
      *                                                                                       CDL096
     C           @RTCD     IFEQ *BLANKS                                                       CDL096
     C                     MOVE 'Y'       CDL096  1                                           CDL096
     C                     ELSE                                                               CDL096
     C                     MOVE 'N'       CDL096                                              CDL096
     C                     ENDIF                                                              CDL096
      ** Check if switchable feature CIR006 is switched on                CIR006
      *                                                                   CIR006
     C                     CALL 'AOSARDR0'                                CIR006
     C                     PARM *BLANKS   @RTCD                           CIR006
     C                     PARM '*VERIFY' @OPTN                           CIR006
     C                     PARM 'CIR006'  @SARD   6                       CIR006
     C           SCSARD    PARM SCSARD    DSFDY                           CIR006
     C*                                                                   CIR006
     C           @RTCD     IFNE *BLANK                                    CIR006
     C           @RTCD     ANDNE'*NRF   '                                 CIR006
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR006
     C                     MOVEL'010'     DBASE            * DB ERROR 10 *CIR006
     C                     MOVEL'CIR006'  DBKEY            ***************CIR006
     C                     MOVE *ON       *INU7                           CIR006
     C                     MOVE *ON       *INU8                           CIR006
     C                     EXSR *PSSR                                     CIR006
     C                     GOTO END                                       CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           @RTCD     IFEQ *BLANKS                                   CIR006
     C                     MOVE 'Y'       CIR006  1                       CIR006
     C                     ELSE                                           CIR006
     C                     MOVE 'N'       CIR006                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                                       CIR014
      ** Check if switchable feature CIR014 is switched on                                    CIR014
      *                                                                                       CIR014
     C                     CALL 'AOSARDR0'                                                    CIR014
     C                     PARM *BLANKS   @RTCD                                               CIR014
     C                     PARM '*VERIFY' @OPTN                                               CIR014
     C                     PARM 'CIR014'  @SARD   6                                           CIR014
     C           SCSARD    PARM SCSARD    DSFDY                                               CIR014
     C*                                                                                       CIR014
     C           @RTCD     IFNE *BLANK                                                        CIR014
     C           @RTCD     ANDNE'*NRF   '                                                     CIR014
     C                     MOVEL'SCSARDPD'DBFILE                               ***************CIR014
     C                     MOVEL'019'     DBASE                                * DB ERROR 19 *CIR014
     C                     MOVEL'CIR014'  DBKEY                                ***************CIR014
     C                     MOVE *ON       *INU7                                               CIR014
     C                     MOVE *ON       *INU8                                               CIR014
     C                     EXSR *PSSR                                                         CIR014
     C                     GOTO END                                                           CIR014
     C                     ENDIF                                                              CIR014
      *                                                                                       CIR014
     C           @RTCD     IFEQ *BLANKS                                                       CIR014
     C                     MOVE 'Y'       CIR014  1                                           CIR014
     C                     ELSE                                                               CIR014
     C                     MOVE 'N'       CIR014                                              CIR014
     C                     ENDIF                                                              CIR014
      *                                                                                     MD035545
      ** Retrieve system value setting                                                      MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   W0RTCD  7                                         MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'                             MD035545
      *                                                                                     MD035545
     C           W0RTCD    IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C*                                                                   CIR001
     C           KCFSC     KLIST                                          CIR001
     C                     KFLD           DLNO                            CIR001
     C                     KFLD           OTIN                            CIR001
     C                     KFLD           PRDT                            CIR001
     C*                                                                   S01119
      *                                                                                       237049
     C           DAK2      KLIST                                                              237049
     C                     KFLD           DLNO2                                               237049
     C                     KFLD           VDAT2                                               237049
     C                     KFLD           DASN2                                               237049
     C/COPY WNCPYSRC,DL0500C015
0368 C           DETAIL    TAG                             ** DETAIL TAG *
0369 C                     SETOF                     4750
0370 C                     SETOF                     515253
0371 C                     SETOF                     545570
     C                     SETOF                     6465
     C                     Z-ADDDLNO      ##DLNO                                              237049
      *                                                                                       237049
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP58                                           S01408
     C*                                                                   S01408
0372 C***********RECRED****ADD**1*********RECRED  50                      S01093
0373 C   04
0374 COR 05                GOTO TOTAL
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP1                                           S01408
     C*                                                                   S01408
0375 C*
0376 C*    ACCUMULATE VALUE OF LIVE RECORDS READ IN INT,2 DEC,2
0377 C*
0378 C           RECI      COMP 'D'                      43
0372 C   43      RECRED    ADD  1         RECRED  50                      S01093
0379 C   43                Z-ADD2         X
0380 C   43                MOVE DAMT      ZZAMT
0381 C   43                EXSR HASH
     C** READ BRANCH DETAILS VIA ACCESS PROGRAM TO GET COMPANY CODE       S01117
     C                     MOVELBRCA      ##KB                                                CSC042
     C                     EXSR ##CHKB                                                        CSC042
      * If branch is in the array then use the details                                        CSC042
     C           ##FIC     IFEQ 'Y'                        *** B10                            CSC042
     C                     EXSR ##SETB                                                        CSC042
     C                     ELSE                            *** X10                            CSC042
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01194              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01194
     C                     MOVEL'06'      DBASE            * DBERR 06 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVE '1'       *IN41                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO TOTAL                                     S01194
     C                     ELSE                                                               CSC042
      * Details found on the DB so add them to the array                                      CSC042
      * if the array still has room                                                           CSC042
     C                     EXSR ##ADDB                                                        CSC042
     C                     END                                            S01117
     C                     END                             *** E10                            CSC042
*    C***41***             SETON                     U7U8LR               S01194
*    C***41***             GOTO TOTAL                                     S01194
0382 C   02                GOTO TAG2
0383 C   03                GOTO TAG3
0384 C   06                GOTO TOTAL
     C   07                GOTO FRAIRS                                    S01119
0385 C*
0386 C********************************************************************
0387 C*
0388 C*    PROCESS F/X RECORDS
0389 C********************************************************************
0390 C***
0391 C***  HAS 1ST LEG VALUE BEEN REACHED
0392 C***  SET INDICATOR FOR SWAP
0393 C***
0394 C***  CALCULATE 'ACCRUED TO DATE' AND PUT INTO AMAD
0395 C***
0396 C***
0397 C********************************************************************
0398 C           RECI      COMP 'D'                  5151
0399 C   51                GOTO TOTAL
0400 C           RCDC      COMP 14                   5151
0401 C   51      RCDC      COMP 20                       50
0402 C   51N50             GOTO TOTAL
0403 C           FSLI      COMP 2                    5151
0404 C   51                GOTO TOTAL
0405 C*    HAS 1ST LEG VALUE BEEN REACHED
0406 C           FXSWP     TAG                             ** FXSWP TAG **
0407 C           REPCD     COMP OTDT                   57
0408 C  N50                GOTO SWPL
0409 C*
0410 C*    OUTPUT RECORD FOR INTERNAL DEPOSIT
0411 C                     Z-ADDREPCD     ZIEND
0412 C                     Z-ADDOTDT      ZIBEG
     C**
     C**   IF VALUE DATE IS LESS THAN REPORT CONTROL DATE,
     C**   USE VALUE DATE AS END DATE
     C**
     C           VDAT      COMP REPCD                  72
     C   72                Z-ADDVDAT      ZIEND
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C110                                           S01408
      *                                                                                       CDL099
      ** CDL099 Split Value Dates processing                                                  CDL099
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C                     SETOF                     68                                       CDL099
     C           *IN01     IFEQ '1'                                                           CDL099
     C                     SETON                     68                                       CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
      ** Move appropriate values to ZIBEG & ZIEND.                                            CDL099
      *                                                                                       CDL099
     C           *IN68     IFEQ '1'                                                           CDL099
     C           BRSD2     ANDNE0                                                             CDL099
     C                     Z-ADDOTDT      UOTDT   60                                          CDL099
     C                     Z-ADDBRSD2     OTDT                                                CDL099
     C           REPCD     COMP OTDT                   57                                     CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C                     Z-ADDREPCD     ZIEND                                               CDL099
     C                     Z-ADDOTDT      ZIBEG                                               CDL099
      *                                                                                       CDL099
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
0413 C                     MOVE IDCM      ZICALC
0414 C                     Z-ADDIDAM      ZIAMT
0415 C                     Z-ADDIDIR      ZIRATE
     C*                                                                   067078
     C                     TESTB'6'       DSTI           35 NEGATIVE      067078
     C   35                MULT -1        ZIRATE                          067078
     C*                                                                   067078
     C/COPY WNCPYSRC,DL0500CP64                                           S01408
     C*                                                                   S01408
0416 C                     EXSR GLINTC
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP65                                           S01408
     C*                                                                   S01408
     C           JDRDF     IFEQ 'Y'                        ROUND DOWN     S01392
0417 C                     Z-ADDZINTR     AMAD                            S01392
     C                     ELSE                                           S01392
0417 C                     Z-ADDZINTR     AMAD      H
     C                     END                                            S01392
     C   57                Z-ADD0         AMAD
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C111                                           S01408
      *                                                                                       CDL099
      ** If value date is less than report control date, then move                            CDL099
      ** internal deposit interest amount to AMAD.                                            CDL099
      *                                                                                       CDL099
     C           VDAT      IFLT REPCD                                                         CDL099
     C           CDL099    ANDEQ'Y'                                                           CDL099
     C                     Z-ADDIDIA      AMAD                                                CDL099
     C                     ENDIF                                                              CDL099
      *
     C*                                                                   S01408
0418 C           IDIA      SUB  AMAD      AMTA
0419 C                     Z-SUBAMAD      AMAD
0420 C                     Z-SUBAMTA      AMTA
      *                                                                                       234893
      ** Check if deposit rate is negative.                                                   234893
      *                                                                                       234893
     C                     TESTB'6'       DSTI           35                                   234893
      *                                                                                       234893
     C           *IN35     IFEQ '1'                                                           234893
     C                     Z-SUBIDIR      ICIR                                                234893
     C                     ELSE                                                               234893
0421 C                     Z-ADDIDIR      ICIR   137
     C                     ENDIF                                                              234893
0422 C*
0423 C                     SETON                     56
0424 C                     EXCPT
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP5                                           S01408
     C*                                                                   S01408
0425 C                     SETOF                     56
0426 C*
0427 C*    OUTPUT RECORD FOR INTERNAL LOAN
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C112                                           S01408
      *                                                                                       CDL099
      ** If sell date is not zero, then move appropriate value to ZIBEG.                      CDL099
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C           *IN68     IFEQ '1'                                                           CDL099
     C           BSDT2     ANDNE0                                                             CDL099
     C                     Z-ADDUOTDT     OTDT                                                CDL099
     C                     Z-ADDBSDT2     VDAT                                                CDL099
     C                     Z-ADDOTDT      ZIBEG                                               CDL099
     C                     END                                                                CDL099
     C           REPCD     COMP OTDT                   57                                     CDL099
     C                     ENDIF                                                              CDL099
      *
     C*                                                                   S01408
0428 C                     MOVE ILCM      ZICALC
0429 C                     Z-ADDILAM      ZIAMT
0430 C                     Z-ADDILIR      ZIRATE
     C*                                                                   067078
     C                     TESTB'5'       DSTI           35 NEGATIVE      067078
     C   35                MULT -1        ZIRATE                          067078
     C*                                                                   067078
     C/COPY WNCPYSRC,DL0500CP66                                           S01408
     C*                                                                   S01408
0431 C                     EXSR GLINTC
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP67                                           S01408
     C*                                                                   S01408
     C           JLRDF     IFEQ 'Y'                        ROUND DOWN     S01392
0417 C                     Z-ADDZINTR     AMAD                            S01392
     C                     ELSE                                           S01392
0432 C                     Z-ADDZINTR     AMAD      H
     C                     END                                            S01392
     C   57                Z-ADD0         AMAD
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C113                                           S01408
      *                                                                                       CDL099
      ** If sell date is not zero and value date is less than report                          CDL099
      ** control date, then move internal deposit interest to AMAD.                           CDL099
      *                                                                                       CDL099
     C           *IN68     IFEQ '1'                                                           CDL099
     C           CDL099    ANDEQ'Y'                                                           CDL099
     C           BSDT2     ANDNE0                                                             CDL099
     C           VDAT      ANDLTREPCD                                                         CDL099
     C                     Z-ADDIDIA      AMAD                                                CDL099
     C                     ENDIF                                                              CDL099
      *
     C*                                                                   S01408
0433 C           ILIA      SUB  AMAD      AMTA
      *                                                                                       234893
      ** Check if loan rate is negative.                                                      234893
      *                                                                                       234893
     C                     TESTB'5'       DSTI           36                                   234893
      *                                                                                       234893
     C           *IN36     IFEQ '1'                                                           234893
     C                     Z-SUBILIR      ICIR                                                234893
     C                     ELSE                                                               234893
0434 C                     Z-ADDILIR      ICIR
     C                     ENDIF                                                              234893
0435 C                     EXCPT
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP5                                           S01408
     C*                                                                   S01408
0436 C*
0437 C*    ACCUMULATE NUMBER AND VALUE OF INTERNAL CONTRACT EXTRACT
0438 C*        RECORDS WRITTEN IN INT,1 DEC,1
0439 C           RECRIT    ADD  2         RECRIT
0440 C                     MOVE IDAM      ZZAMT
0441 C                     Z-ADD1         X
0442 C                     EXSR HASH
0443 C                     MOVE ILAM      ZZAMT
0444 C                     EXSR HASH
0445 C                     GOTO TOTAL
0446 C*
0447 C*    SET INDICATOR FOR SWAP
0448 C           SWPL      TAG                             ** SWPL TAG  **
0449 C                     SETON                     47
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C114                                           S01408
      *                                                                                       CDL099
      ** If sell date is not zero, then determine P/L currency value                          CDL099
      ** date.                                                                                CDL099
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
      *                                                                                       CDL099
     C           *IN68     IFEQ '1'                                                           CDL099
     C           BSDT2     ANDNE0                                                             CDL099
     C           SPLC      IFNE PUCY                                                          CDL099
     C                     Z-ADDBSDT2     VDAT                                                CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C           VDAT      CABLTREPCD     TOTAL                                               CDL099
     C           REPCD     SUB  OTDT      DAYS                                                CDL099
     C           VDAT      SUB  OTDT      PERIOD                                              CDL099
     C                     GOTO #BTAG1                                                        CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
0450 C*
0451 C*    CALCULATE 'ACCRUED TO DATE' AND PUT INTO AMAD
0452 C           REPCD     SUB  OTDT      DAYS    50
0453 C           VDAT      SUB  OTDT      PERIOD  50
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C115                                           S01408
     C           #BTAG1    TAG                                                                CDL099
     C*                                                                   S01408
0454 C*
0455 C           SPLA      MULT DAYS      PRODUC 150
0456 C           PRODUC    DIV  PERIOD    AMAD   130H
0457 C   57                Z-ADD0         AMAD
0458 C           SPLA      SUB  AMAD      AMTA
0459 C                     GOTO END
0460 C*
0461 C*    TEST FOR LOANS/DEPOSITS
0462 C           TAG2      TAG                             ** TAG2 **
0463 C           RECI      COMP 'D'                  5252
0464 C   52                GOTO TOTAL
0465 C           RCDC      COMP 15                   5252
0466 C   52      RCDC      COMP 16                   5252
0467 C   52                GOTO TOTAL
     C/COPY WNCPYSRC,DL0500C052
0468 C*
0469 C********************************************************************
0470 C*
0471 C*    PROCESS 'LOANS/DEPOSITS'
0472 C*
0473 C*    CHECK IF RECORD CODE IS '16'
0474 C           RCDC      COMP 16                       48
     C/COPY WNCPYSRC,DL0500C084
      *                                                                                       CDL033
      ** Perform initial processing for CF deals.                                             CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
     C                     EXSR SRFRC1                                                        CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0475 C*
0476 C*    CHECK IF START/LAST INTEREST DATE REACHED
0477 C           SLID      COMP 0                    49
0478 C***49******SLID      COMP REPCD                49                   S01392
0478 C   49 58   SLID      COMP REPCD                49                   S01392
0478 C   49N58   SLID      COMP REPCD                49  49               S01392
0479 C   49                Z-ADD0         AMAD
     C/COPY WNCPYSRC,DL0500C051
0480 C   49                GOTO LDTOAC
0481 C*
0482 C*    PUT 'INTEREST CALCULATED' IN ZINTR
     C**
     C**   EXCEPT FOR CALL/NOTICE DEALS WHERE MDAT = 0,
     C**   IF IACD IS GREATER THAN OR EQUAL TO MATURITY DATE, ZINTR = 0
0483 C           MDAT      COMP 0                    73
     C   73      IACD      COMP MDAT                   72
     C   73N72             Z-ADD0         ZINTR
     C/COPY WNCPYSRC,DL0500C041
     C   73N72             GOTO SOTINT
     C**
     C**   IF MATURITY DATE IS LESS THAN REPORT CONTROL DATE,
     C**   USE MATURITY DATE AS END DATE
     C           MDAT      COMP REPCD                  72
0483 C                     Z-ADDIACD      ZIBEG
0484 C                     Z-ADDREPCD     ZIEND
     C   72 73             Z-ADDMDAT      ZIEND
     C*                                                                   S01392
     C* IF FIRST DAY ACCRUALS AND FIRST & LAST DAY INTEREST               S01392
     C*                                                                   S01392
     C  N58      JFLID     IFEQ 'Y'                                       S01392
     C                     SUB  1         ZIEND                           S01392
     C                     END                                            S01392
0485 C                     MOVE ICBS      ZICALC
0486 C                     Z-ADDPCPL      ZIAMT
0487 C                     Z-ADDINTR      ZIRATE
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP68                                           S01408
     C*                                                                   S01408
      *                                                                                       CDL033
      ** For CF deal, process rate change date if it occurs                                   CDL033
      ** on or before the end date.                                                           CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           XKRCDT    ANDLEZIEND                                                         CDL033
     C           XKRCDT    ANDNE*ZERO                                                         CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
      *                                                                                       CDL033
      ** Save original end date.                                                              CDL033
      *                                                                                       CDL033
     C                     Z-ADDZIEND     WXEND   50                                          CDL033
      *                                                                                       CDL033
      ** Process rate change date.                                                            CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC3                                                        CDL033
      *                                                                                       CDL033
      ** Restore original end date.                                                           CDL033
      *                                                                                       CDL033
     C                     Z-ADDWXEND     ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0488 C                     EXSR GLINTC
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP69                                           S01408
     C**
     C           SOTINT    TAG                             *** SOTINT ***
0489 C*
0490 C*    ACCUMULATE 'TOTAL INTEREST TO DATE' IN TOTINT
     C*                                                                   S01392
     C*    IF ROUND DOWN INTEREST INDICATOR IS 'Y'                        S01392
     C*                                                                   S01392
     C/COPY WNCPYSRC,DL0500C042
     C           JRDFC     IFEQ 'Y'                                       S01392
0491 C           ZINTR     ADD  AITC      TOTINT                          S01392
     C                     ELSE                                           S01392
0491 C           ZINTR     ADD  AITC      TOTINT 130H
     C                     END                                            S01392
     C/COPY WNCPYSRC,DL0500C043
0492 C           TOTINT    ADD  AIAN      TOTINT
0493 C           TOTINT    ADD  AIAP      TOTINT
0494 C*
      *  Tropics interface, can not write next interest payment date and frequency in         237049
      *  DEALS file. So, access 'SI' records of DEAMSDI for NIDT.                             237049
      *                                                                                       237049
     C           NIDT      IFEQ *ZEROS                                                        237049
     C                     Z-ADDDLNO      DLNO2                                               237049
     C                     Z-ADDIACD      VDAT2                                               237049
     C                     Z-ADD*ZERO     DASN2                                               237049
     C           DAK2      SETLLDEAMSI                                                        237049
     C           ##DLNO    READEDEAMSI                   99*                                  237049
      *                                                                                       237049
      * Whilst deal amendments can be found, apply the changes                                237049
      *                                                                                       237049
     C           *IN99     IFEQ '0'                                                           237049
     C                     Z-ADDVDATA     NIDT                                                237049
     C                     END                                                                237049
     C                     END                                                                237049
      *                                                                                       237049
     C           NIDT      COMP REPCD                  7070               E16138
0504 C  N70      MDAT      COMP NIDT                   7070               E16138
     C           NIDT      IFEQ REPCD                                     048327
0504 C                     MOVE '0'       *IN70                           048327
0504 C                     END                                            048327
0507 C                     Z-ADDIACD      ZIBEG                           E16138
0508 C                     Z-ADDNIDT      ZIEND                           E16138
      *
      * If CDL096 is On and Amount Convention is 'A', update Next Interest                    CDL096
      * Payment Date to be the Interest Base Date (which contains the                         CDL096
      * correct date that interest should be calculated up to)                                CDL096
     C           CDL096    IFEQ 'Y'                                                           CDL096
     C           *IN02     ANDEQ'1'                                                           CDL096
     C           AMTC      ANDEQ'A '                                                          CDL096
     C           IPFR      ANDNE*BLANKS                                                       CDL096
     C                     Z-ADDIBDT      ZIEND                                               CDL096
     C                     ENDIF                                                              CDL096
      *                                                                                       CDL096
0507 C   70                Z-ADDMDAT      ZIEND                           E16138
0509 C                     MOVE ICBS      ZICALC                          E16138
0510 C                     Z-ADDPCPL      ZIAMT                           E16138
0511 C                     Z-ADDINTR      ZIRATE                          E16138
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP70                                           S01408
     C*                                                                   S01408
      *                                                                                       CDL033
      ** Additional processing for CF deal.                                                   CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
      *                                                                                       CDL033
      ** Restore original accrued interest to control date.                                   CDL033
      *                                                                                       CDL033
     C                     Z-ADDWXAITC    AITC                                                CDL033
      *                                                                                       CDL033
      ** Process rate change date if it occurs on or before                                   CDL033
      ** the end date.                                                                        CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFLE ZIEND                                                         CDL033
     C           XKRCDT    ANDNE*ZERO                                                         CDL033
      *                                                                                       CDL033
      ** Save original end date.                                                              CDL033
      *                                                                                       CDL033
     C                     Z-ADDZIEND     WXEND                                               CDL033
      *                                                                                       CDL033
      ** Process rate change date.                                                            CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC3                                                        CDL033
      *                                                                                       CDL033
      ** Restore original end date.                                                           CDL033
      *                                                                                       CDL033
     C                     Z-ADDWXEND     ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0512 C                     EXSR GLINTC                                    E16138
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP71                                           S01408
     C*                                                                   E16138
0495 C*    ACCUMULATE 'TOTAL INTEREST TO DATE' IN QINT                    E16138
     C*                                                                   S01392
     C*    IF ROUND DOWN INTEREST INDICATOR IS 'Y'                        S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
0491 C           ZINTR     ADD  AITC      QINT                            S01392
     C                     ELSE                                           S01392
0496 C           ZINTR     ADD  AITC      QINT   130H                     E16138
     C                     END                                            S01392
0497 C           QINT      ADD  AIAN      QINT                            E16138
0497 C           QINT      ADD  AIAP      QINT                            E16138
0497 C********** QINT      ADD  IPRD      QINT                      E16138E22762
0497 C********** QINT      ADD  ICTD      QINT                      E16138E22762
0497 C           QINT      SUB  IPRD      QINT                            E22762
0497 C           QINT      SUB  ICTD      QINT                            E22762
0498 C   48                Z-SUBQINT      QINT                            E16138
0499 C*                                                                   E16138
0495 C*    PUT 'INTEREST ACCRUED TO DATE' IN AMAD
0496 C           TOTINT    SUB  IPRD      AMAD
0497 C           AMAD      SUB  ICTD      AMAD
0498 C   48                Z-SUBAMAD      AMAD
     C/COPY WNCPYSRC,DL0500C044
0499 C*
0500 C*    CALCULATE 'INTEREST TO ACCRUE' ONLY IF NOTICE DAYS IS NEGATIVE
0501 C           LDTOAC    TAG                             ** LDTOAC TAG *
0502 C  N21                GOTO NOTNEG
0503 C           NIDT      COMP REPCD                  7070
0504 C  N70      MDAT      COMP NIDT                   7070
     C           NIDT      IFEQ REPCD                                     048327
0504 C                     MOVE '0'       *IN70                           048327
0504 C                     END                                            048327
     C**
     C**    IF MATURITY DATE IS LESS THAN OR EQUAL REPORT CONTROL DATE,
     C**    INTEREST TO ACCRUE IS ZERO.
     C           MDAT      COMP REPCD                  7272
     C   72                Z-ADD0         AMTA
     C   72                GOTO NOTNEG
0505 C      70             MOVE MDAT      ZIEND
0506 C     N70             MOVE NIDT      ZIEND
      * If CDL096 is On and Amount Convention is 'A', update Next Interest                    CDL096
      * Payment Date to be the Interest Base Date (which contains the                         CDL096
      * correct date that interest should be calculated up to)                                CDL096
     C           CDL096    IFEQ 'Y'                                                           CDL096
     C           *IN70     ANDEQ'0'                                                           CDL096
     C           *IN02     ANDEQ'1'                                                           CDL096
     C           AMTC      ANDEQ'A'                                                           CDL096
     C           IPFR      ANDNE*BLANKS                                                       CDL096
     C                     Z-ADDIBDT      ZIEND                                               CDL096
     C                     ENDIF                                                              CDL096
      *                                                                                       CDL096
     C/COPY WNCPYSRC,DL0500C116                                           S01408
0507 C                     Z-ADDREPCD     ZIBEG
0508 C   49                Z-ADDSLID      ZIBEG
     C*                                                                   S01392
     C* IF FIRST & LAST DAY INTEREST                                      S01392
     C*                                                                   S01392
     C           JFLID     IFEQ 'Y'                                       S01392
     C  N58                SUB  1         ZIBEG                           S01392
     C   58 49             SUB  1         ZIBEG                           S01392
     C                     END                                            S01392
0509 C                     MOVE ICBS      ZICALC
0510 C                     Z-ADDPCPL      ZIAMT
0511 C                     Z-ADDINTR      ZIRATE
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP72                                           S01408
     C*                                                                   S01408
      *                                                                                       CDL033
      ** Additional processing for CF deal.                                                   CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
      *                                                                                       CDL033
      ** Initialise result field of interest calculation.                                     CDL033
      *                                                                                       CDL033
     C                     Z-ADD*ZEROS    WXKINT                                              CDL033
      *                                                                                       CDL033
      ** Process rate change date if it occurs within                                         CDL033
      ** calculation period.                                                                  CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFGE ZIBEG                                                         CDL033
     C           XKRCDT    ANDLEZIEND                                                         CDL033
     C           XKRCDT    ANDNE*ZERO                                                         CDL033
      *                                                                                       CDL033
      ** Save original end date.                                                              CDL033
      *                                                                                       CDL033
     C                     Z-ADDZIEND     WXEND                                               CDL033
      *                                                                                       CDL033
      ** Process rate change date.                                                            CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC3                                                        CDL033
      *                                                                                       CDL033
      ** Restore original end date.                                                           CDL033
      *                                                                                       CDL033
     C                     Z-ADDWXEND     ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0512 C                     EXSR GLINTC
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP73                                           S01408
     C*                                                                   S01392
     C*    IF ROUND DOWN INTEREST INDICATOR IS 'Y'                        S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
0491 C                     Z-ADDZINTR     AMTA                            S01392
     C/COPY WNCPYSRC,DL0500C045
     C                     ELSE                                           S01392
0513 C                     Z-ADDZINTR     AMTA      H
     C/COPY WNCPYSRC,DL0500C046
     C                     END                                            S01392
     C/COPY WNCPYSRC,DL0500C085
      *                                                                                       CDL033
      ** For CF deal, add interest calculated up to rate                                      CDL033
      ** change date.                                                                         CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
     C                     ADD  WXKINT    AMTA                                                CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0514 C   48                Z-SUBAMTA      AMTA
     C/COPY WNCPYSRC,DL0500C047
0517 C   49                GOTO NOTNEG                                    E16138
0497 C           QINT      SUB  AMAD      AMTA                            E16138
     C/COPY WNCPYSRC,DL0500C048
0515 C           NOTNEG    TAG                             ** NOTNEG TAG *
0516 C  N21                Z-ADD0         AMTA
     C/COPY WNCPYSRC,DL0500C049
0517 C                     GOTO END
0518 C           TAG3      TAG                             ** TAG 3 **
0519 C           RECI      COMP 'D'                  5353
0520 C   53                GOTO TOTAL
0521 C           RCDC      COMP 17                   5353
0522 C   53                GOTO TOTAL
0523 C           DTYP      COMP 'C1'                     54
0524 C  N54      DTYP      COMP 'C2'                     54
0525 C  N54      DTYP      COMP 'BD'                     54
0526 C  N54      DTYP      COMP 'BP'                     54
0527 C  N54                GOTO NINTB
0528 C*
0529 C********************************************************************
0530 C*
0531 C*    THIS PART PROCESSES NEGOTIABLE ASSETS PURCHASED RECORDS WITH
0532 C*    A  DEAL TYPE OF C1,C2,BD OR BP  -  INTEREST BEARING
0533 C*
     C           IACD      COMP SLID                 65                   087547
     C                     Z-ADDIACD      ZIBEG                           087547
     C                     Z-ADDREPCD     ZIEND                           087547
     C                     Z-ADD0         TAMAD                           087546
0534 C*    CHECK IF VALUE DATE REACHED
0535 C***********VDAT      COMP REPCD                49                   S01392
0535 C   58      VDAT      COMP REPCD                49                   S01392
0535 C  N58      VDAT      COMP REPCD                49  49               S01392
0536 C   49                Z-ADD0         AMAD
0537 C   49                GOTO STODAT
0538 C*********            Z-ADDIACD      ZIBEG                           087547
0539 C*********            Z-ADDREPCD     ZIEND                           087547
     C**
     C**    USE MATURITY DATE AS END DATE IF LESS THAN REPORT CONTROL DATE
     C**
     C           MDAT      COMP REPCD                  72
     C   72                Z-ADDMDAT      ZIEND
0540 C                     MOVE ICBS      ZICALC
     C  N59                Z-ADDPUPR      ZIAMT
     C  N59                Z-ADDYRAT      ZIRATE
     C   59                Z-ADDFVAL      ZIAMT
     C   59                Z-ADDINTR      ZIRATE
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP74                                           S01408
     C*                                                                   S01408
0543 C                     EXSR GLINTC
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP75                                           S01408
     C*                                                                   S01392
     C*    IF ROUND DOWN INTEREST INDICATOR IS 'Y'                        S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
0491 C                     Z-ADDZINTR     AMAD                            S01392
     C                     Z-ADDZINTR     TAMAD                           087546
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     AMAD   130H
     C******************** Z-ADDZINTR     TAMAD                     087546111053
     C                     Z-ADDZINTR     TAMAD  130H                     111053
     C                     END                                            S01392
     C**
     C**   IF LAST INT. DATE IS LATER THAN VALUE DATE,OUTPUT LAST INT.DA
     C**   AS'ACCRUAL FROM' DATE
     C                     SETOF                     71
     C           SLID      COMP VDAT                 71
     C**
     C**    IF IACD IS GREATER THAN MATURITY DATE, ZINTR = 0
     C           IACD      COMP MDAT                   72
     C  N72      AIAP      ADD  AIAN      AMAD
     C  N72                GOTO STODAT
     C**
     C**   CHECK IF THERE HAS BEEN AN INTERIM INTEREST DATE SINCE
     C**   ACCRUALS CONTROL DATE : -
     C******IF*NOT,*SKIP*FOLLOWING*PROCESSING.*************************   117437
     C******ELSE*CALCULATE*INTEREST*BETWEEN*IACD*&*SLID*AND*SUBTRACT***   117437
     C******THIS*FROM*AMAD*TO*OBTAIN*'TOTAL*INTEREST*TO*DATE'**********   117437
     C**
     C           IACD      COMP SLID                 65
     C**N65******          Z-ADDSLID      ZIEND                           117437
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP62                                           S01408
     C*                                                                   S01408
     C**N65******          EXSR GLINTC                                    117437
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP76                                           S01408
0544 C*
0545 C*    ACCUMULATE 'TOTAL INTEREST TO DATE' IN TOTTOD
     C           AMAD      ADD  AIAN      AMAD
     C           AMAD      ADD  AIAP      AMAD
     C**N65******AMAD      SUB  ZINTR     AMAD   130H                     S01392
     C*                                                                   S01392
     C*****IF*ROUND*DOWN*INTEREST*INDICATOR*IS*'Y'**************** S01392 117437
     C*                                                                   S01392
     C************IN65     IFEQ '0'                                S01392 117437
     C***********JRDFC     IFEQ 'Y'                                S01392 117437
     C***********AMAD      SUB  ZINTR     AMAD                     S01392 117437
     C***********          ELSE                                    S01392 117437
     C***********AMAD      SUB  ZINTR     AMAD   130H              S01392 117437
     C***********          END                                     S01392 117437
     C***********          END                                     S01392 117437
     C           AMAD      ADD  AITC      AMAD
     C***********AMAD      SUB  AIPD      AMAD                            E10517
0548 C*
     C           AMAD      SUB  IPRD      AMAD                            117437
      *                                                                   117437
      **   If IPRD not equal to zero, then consider PINT as IPRD          117437
      **   includes both PINT & AIAP.                                     117437
      *                                                                   117437
     C           IPRD      IFNE 0                                         117437
     C                     ADD  PINT      AMAD                            117437
     C                     END                                            117437
0549 C*    CALCULATE INTEREST TO THE EARLIEST OF MDAT, NIDT AND SADT
     C*    WHICH IS GREATER THAN REPORT CONTROL DATE
0550 C           STODAT    TAG                             ** STODAT **
0551 C   22 23             Z-ADDMDAT      TODAT   50
0552 C   22 23             GOTO INTCAL
0553 C*
0554 C***********NIDT      COMP REPCD                  7070               E11045
     C           NIDT      COMP REPCD                  70                 E11045
0555 C   22                SETON                     70
0556 C*
0557 C   70      MDAT      COMP SADT                 606161
     C   70 60   SADT      COMP 0                    60  61
     C   70 60   SADT      COMP REPCD                  6161
0558 C   70 60             Z-ADDSADT      TODAT
0559 C   70 61             Z-ADDMDAT      TODAT
0560 C   70                GOTO INTCAL
0561 C*
0562 C   23      MDAT      COMP NIDT                 606161
0563 C   23 60             Z-ADDNIDT      TODAT
0564 C   23 61             Z-ADDMDAT      TODAT
0565 C   23                GOTO INTCAL
0566 C*
0567 C           MDAT      COMP NIDT                 606161
0568 C   60      NIDT      COMP SADT                 626363
     C   60 62   SADT      COMP REPCD                  6363
0569 C   60 63             Z-ADDNIDT      TODAT
     C   60 62             Z-ADDSADT      TODAT
0570 C   61      MDAT      COMP SADT                 626363
0571 C   61 62             Z-ADDSADT      TODAT
     C   61 62   SADT      COMP REPCD                  6363
0572 C   61 63             Z-ADDMDAT      TODAT
0573 C*
0574 C*
0575 C*    PUT 'INTEREST TO ACCRUE' IN AMTA
0576 C           INTCAL    TAG                             ** INTCAL TAG *
0577 C                     MOVE TODAT     ZIEND
     C* To eliminate the discrepancy in calculating the 'To Accrue'       087546
     C* value, calculate first the total interest from AICD to TODAT,     087546
     C* then subtract the interest from AICD to REPCD (TAMAD).            087546
0578 C******               MOVE REPCD     ZIBEG                           087546
0579 C***49*               MOVE VDAT      ZIBEG            VAL.NOT REACHED087546
0580 C  N59                Z-ADDPUPR      ZIAMT
0581 C  N59                Z-ADDYRAT      ZIRATE
0580 C   59                Z-ADDFVAL      ZIAMT
0581 C   59                Z-ADDINTR      ZIRATE
0582 C                     MOVE ICBS      ZICALC
0583 C                     EXSR GLINTC
     C*                                                                   S01392
     C*    IF ROUND DOWN INTEREST INDICATOR IS 'Y'                        S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
0491 C                     Z-ADDZINTR     AMTA                            S01392
     C                     ELSE                                           S01392
0584 C                     Z-ADDZINTR     AMTA      H
     C                     END                                            S01392
     C*                                                                   087546
     C* (REPCD to TODAT)int. = (IACD to TODAT)int. - (IACD to REPCD) int. 087546
     C                     SUB  TAMAD     AMTA                            087546
     C**
     C**   IF TODAT IS LESS THAN OR EQUAL TO REPORT CONTROL DATE,
     C**   'INTEREST TO ACCRUE' IS ZERO.
     C           TODAT     COMP REPCD                72
     C  N72                Z-ADD0         AMTA
     C**
     C           DTYP      COMP 'C1'                     64
     C   64                GOTO END
     C   59                GOTO INTBY
     C*
0585 C                     GOTO END
0586 C           NINTB     TAG                             ** NINTB TAG **
0587 C           DTYP      COMP 'TB'                     55
0588 C  N55      DTYP      COMP 'DA'                     55
0589 C  N55      DTYP      COMP 'TA'                     55
0590 C  N55                GOTO TOTAL
     C           INTBY     TAG                             ** INTBY TAG **
0591 C*
0592 C*    THIS PART PROCESSES RECORDS WITH DEAL TYPE TB, DA OR TA
0593 C*                                      -  NON-INTEREST BEARING
     C*  OR DEAL TYPES C2,BD OR BP - INTEREST BEARING,
     C*  --                                 IF N.A. ACCRUALS IND. - Y
0594 C*
0595 C           REPCD     SUB  VDAT      DAYS         49
0596 C           MDAT      SUB  VDAT      PERIOD
0597 C*
0598 C   49N54             Z-ADD0         AMAD
0599 C   49N54             Z-ADDDISA      AMTA
0600 C   49N54             GOTO END
     C   49 59 54          Z-ADD0         AMTAD  130
     C   49 59 54          Z-ADDDISA      AMTTA  130
     C   49 59 54          EXCPT
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP5                                           S01408
     C*                                                                   S01408
     C   49 59 54          GOTO END
0601 C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP59                                           S01408
     C*                                                                   S01408
0602 C           DISA      MULT DAYS      PRODUC
     C  N54      PRODUC    DIV  PERIOD    AMAD      H
     C  N54      DISA      SUB  AMAD      AMTA   130
     C   59 54   PRODUC    DIV  PERIOD    AMTAD     H
     C   59 54   DISA      SUB  AMTAD     AMTTA  130
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP57                                           S01408
     C*                                                                   S01408
     C   59 54             EXCPT
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP5                                           S01408
     C*                                                                   S01408
     C                     GOTO END                                       S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   PROCESS FRA/IRS RECORDS.                                       S01119
     C**   N.B. FRA/IRS EXTRACT RECORDS ARE HASHED WHEN WRITTEN.          S01119
     C*                                                                   S01119
     C           FRAIRS    TAG                             **FRAIRS TAG** S01119
     C*                                                                   S01119
     C           *IN07     IFEQ '1'                                       S01119
     C           RECI      ANDEQ'D'                                       S01119
     C*                                                                   CIR001
     C           BOVD      IFNE 0                                         CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C*                                                                   CIR001
     C           BOVD      IFLT MDAT                                      CIR001
     C                     Z-ADDBOVD      MDAT                            CIR001
     C                     END                                            CIR001
     C           BOVD      IFLT TNIPD                                     CIR001
     C                     Z-ADDBOVD      TNIPD                           CIR001
     C                     Z-ADDBOVD      TNICD                           CIR001
     C                     END                                            CIR001
     C           BOVD      IFLT UNIPD                                     CIR001
     C                     Z-ADDBOVD      UNIPD                           CIR001
     C                     Z-ADDBOVD      UNICD                           CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C054
     C                     Z-ADD*ZERO     OTUI   150                      CIR002
     C                     Z-ADD*ZERO     TTUI   150                      CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP7                                           S01408
     C           RCDC      CASEQ21        SRFR             FRA            S01119
     C           RCDC      CASEQ22        SRRS             IRS            S01119
     C           RCDC      CASEQ23        SRRX             X-CCY IRS      S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           RCDC      IFEQ 24                         CAP/COLLARS    S01119
     C                     TESTB'3'       UDSTI          33 AVG. RATE?    S01119
     C           *IN33     IFEQ '0'                                       S01119
     C                     EXSR SRRLNA                     NON-AVERAGE    S01119
     C                     ELSE                                           S01119
     C                     EXSR SRRLAV                     AVERAGE RATE   S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP8                                           S01408
     C*                                                                   CIR001
     C**   Call IRS Fee Amortization processing.                          CIR001
     C*                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C*                                                                   CIR001
     C           RCDC      IFEQ 22                                        CIR001
     C           RCDC      OREQ 23                                        CIR001
     C           RCDC      OREQ 24                                        CIR001
     C                     EXSR SRFAMO                                    CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C**   BYPASS EXTRACT RECORDS HASH TOTALLING AS                       S01119
     C**   FRA/IRS EXTRACT RECORDS HASHED WHEN WRITTEN.                   S01119
     C*                                                                   S01119
     C                     GOTO TOTAL                                     S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*
0605 C*
0606 C********************************************************************
0607 C*
0608 C           END       TAG                             ** END TAG **
0609 C*
0610 C*    ACCUMULATE NUMBER AND VALUE OF EXTRACT RECORDS WRITTEN
0611 C*               IN INT,1  DEC,1
     C**
     C*****IF*NAAI='Y',*USE*FACE*VALUE*FOR*'C1'*HASH*TOTALLING*****       S01194
     C**   IF BNGEST='Y', USE FACE VALUE FOR 'C1' HASH TOTALLING          S01194
     C**
0612 C   01N51
0613 COR 02N52
0614 COR 03N53   RECRIT    ADD  1         RECRIT  50
     C  N64
     CAN 03 59 54RECRIT    ADD  1         RECRIT
     C/COPY WNCPYSRC,DL0500C050
0615 C   01N51             MOVE SPLA      ZZAMT
0616 C   02N52             MOVE PCPL      ZZAMT
0617 C   03                MOVE PUPR      ZZAMT
     C   03 59 64          MOVE FVAL      ZZAMT
0618 C                     Z-ADD1         X       10
0619 C   01N51
0620 COR 02N52
0621 COR 03N53             EXSR HASH
     C**
     C**   ACCUMULATE ADDITIONAL VALUE (FACE VALUE) OF EXTRACT RECORD
     C**   IF IT IS N.A.ACCRUALS INDICATOR = 'Y' - ONLY APPLIES TO
     C**   N.A. PURCHASED INTEREST BEARING DEAL BUT C1
     C**   THIS IS FOR THE 'D' RECORDS
     C**
     C  N64
     CAN 03 59 54          MOVE FVAL      ZZAMT
     C  N64
     CAN 03 59 54          Z-ADD1         X
     C  N64
     CAN 03 59 54          EXSR HASH
0622 C           TOTAL     TAG                             ** TOTAL TAG **
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP4                                           S01408
     C*                                                                   S01408
0623 CLR         INT,2     COMP VLAF                 8080
0624 CLRN80      DEC,2     COMP VLAL                 8080
0625 C*RN80******RECRED    COMP NORE                 8080                 S01093
0625 CLRN80      RECRED    COMP NLRA                 8080                 S01093
     CLR 80                SETON                     U8
0626 CLR         RECRIT    ADD  2         RECRIT
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP3                                           S01408
     C*                                                                   S01408
0627 C*
0628 C********************************************************************
      /EJECT                                                                                  CSC042
     C********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##CHKB - Subroutine to check the Branch in the arrays                                 CSC042
      *                                                                                       CSC042
     C           ##CHKB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C           *LIKE     DEFN A8BRCD    ##KB                                                CSC042
      *                                                                                       CSC042
      * Set off the branch found indicator                                                    CSC042
     C                     MOVEL*BLANK    ##FIC   1                                           CSC042
      *                                                                                       CSC042
      * Save the state of indicator 30 so it can be reset at the end                          CSC042
      * of the SR as it may be used elsewhere in the code                                     CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     MOVEL'Y'       #IN30   1                                           CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL'N'       #IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     SETOF                         30                                   CSC042
      *                                                                                       CSC042
      * Restore the saved Value of B                                                          CSC042
     C                     Z-ADD##BSV     B                                                   CSC042
      *                                                                                       CSC042
     C* Check whether details for Branch already in array                                     CSC042
      *                                                                                       CSC042
      * Is this the same as the last LOKUP, if so we can bypass                               CSC042
      * the LOKUP                                                                             CSC042
      * Defend against B being 0                                                              CSC042
     C           B         IFEQ 0                                                             CSC042
     C                     Z-ADD1         B                                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * If the branch being checked is the same then use these                                CSC042
      * details rather than doing a LOKUP                                                     CSC042
     C           ##KB      IFEQ ##BR,B                                                        CSC042
      * Found so seton 30                                                                     CSC042
     C                     SETON                         30                                   CSC042
     C                     ELSE                                                               CSC042
     C                     Z-ADD1         B                                                   CSC042
     C           ##KB      LOKUP##BR,B                   30                                   CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Save the last update to B                                                             CSC042
     C           *IN30     IFEQ *ON                                                           CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      * Set the indicator to show the data was found                                          CSC042
     C                     MOVEL'Y'       ##FIC                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Reset the state of indicator 30.                                                      CSC042
     C           #IN30     IFEQ 'Y'                                                           CSC042
     C                     MOVEL*ON       *IN30                                               CSC042
     C                     ELSE                                                               CSC042
     C                     MOVEL*OFF      *IN30                                               CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##SETB - Sets up the SDBRCHPD fields used in the code from the                        CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##SETB    BEGSR                                                              CSC042
      *                                                                                       CSC042
     C                     MOVEL##BR,B    A8BRCD                                              CSC042
     C                     MOVEL##BC,B    A8CMCD                                              CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      *                                                                                       CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
      ********************************************************************                    CSC042
      *                                                                                       CSC042
      * ##ADDB - Adds the SDBRCHPD fields used in the code to the                             CSC042
      * arrays                                                                                CSC042
      *                                                                                       CSC042
     C           ##ADDB    BEGSR                                                              CSC042
      *                                                                                       CSC042
      * If there is still room in the array then add the details                              CSC042
     C           ##BNDX    IFLT 999                                                           CSC042
     C                     ADD  1         ##BNDX                                              CSC042
     C                     Z-ADD##BNDX    B                                                   CSC042
     C                     MOVELA8BRCD    ##BR,B                                              CSC042
     C                     MOVELA8CMCD    ##BC,B                                              CSC042
     C                     END                                                                CSC042
      *                                                                                       CSC042
      * Update ##BSV  so next call to ##CHKB checks this latest adddition                     CSC042
      * to the array firss                                                                    CSC042
     C                     Z-ADDB         ##BSV                                               CSC042
      *                                                                                       CSC042
     C                     ENDSR                                                              CSC042
      ********************************************************************                    CSC042
      /EJECT                                                                                  CSC042
0629 C           HASH      BEGSR
0630 C                     Z-ADDINT,X     ZZTOTI
0631 C                     Z-ADDDEC,X     ZZTOTD
     C*
     C** For deals file counter take real value of amount                 032587
     C*                                                                   032587
     C           X         IFEQ 1                                         032587
0632 C           ZZAMT     COMP 0                      42
0633 C   42                Z-SUBZZAMT     ZZAMT
     C                     END                                            032587
0634 C                     EXSR GLZADD
0635 C                     Z-ADDZZTOTI    INT,X
0636 C                     Z-ADDZZTOTD    DEC,X
0637 C                     ENDSR
0638 C********************************************************************
0639 C********************************************************************066550
0640 C***********                                                         066550
0641 C*****GLINTC SR. TO CALCULATE INTEREST BETWEEN ANY TWO DAY NUMBERS.  066550
0642 C***********                                                         066550
0643 C*****THIS*VERSION REPLACES THE ORIGINAL GLINTC SR. NOW NAMED        066550
0644 C*****GLINTO.                                                        066550
0645 C***********                                                         066550
0646 C*****CALCULATION METHODS ARE -                                      066550
0647 C*****1**ACTUAL/365                                                  066550
0648 C*****2**ACTUAL/360                                                  066550
0649 C*****3**360/360 (SOMETIMES CALLED 30/360)                           066550
0650 C*****4**365/365 (EXCLUDING 29/02)                                   066550
0651 C*****5**365/360 (EXCLUDING 29/02)                                   066550
0652 C*****6**ACTUAL/366                                                  066550
0653 C***********                                                         066550
0654 C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.                     066550
0655 C***********                                                         066550
0656 C***********                                                         066550
0657 C*R*********GLINTC    BEGSR                           ** GLINTC  **  066550
0658 C***********                                                         066550
0659 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                           066550
0660 C*R*********          Z-ADDZIBEG     ZIBEG   50       STARTING DATE  066550
0661 C*R*********          Z-ADDZIEND     ZIEND   50       FINISHING DATE 066550
0662 C*R*********          Z-ADDZICALC    ZICALC  10       CALC. BASIS    066550
0663 C*R*********          Z-ADDZIAMT     ZIAMT  150       PRINCIPAL      066550
0664 C*R*********          Z-ADDZIRATE    ZIRATE 117       RATE OF INTRST 066550
0665 C***********                                                         066550
0666 C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED           066550
0667 C*R*********ZIEND     SUB  ZIBEG     ZDAYN1  50                      066550
0668 C***********                                                         066550
0669 C****CHECK*FOR INTEREST CALCULATION BASIS                            066550
0670 C*****USE*OF INDICATRS                                               066550
0671 C*****1,92**2,90  3,91  4,97  5,96  6,95                             066550
0672 C***********          SETOF                     959697               066550
0673 C*R*********ZICALC    COMP 2                    919290               066550
0674 C**N91******          GOTO ZICAL                                     066550
0675 C***********ZICALC    COMP 5                    959796               066550
0676 C***97******ZICALC    COMP 3                    97  91               066550
0677 C***95******                                                         066550
0678 C*R*96******          SETOF                     91                   066550
0679 C**N91******          GOTO ZILPCK                                    066550
0680 C***********                                                         066550
0681 C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WHEN      066550
0682 C*****USING*THE 30/360 BASIS - METHOD 3.                             066550
0683 C***********          EXSR ZSAVE                                     066550
0684 C***********          Z-ADDZIBEG     ZDAYNO                          066550
0685 C***********          EXSR ZDATE2                                    066550
0686 C***********          MOVE ZDAY      ZISD    20                      066550
0687 C***********          MOVE ZMTH      ZISM    20                      066550
0688 C***********          MOVE ZYEAR     ZISY    20                      066550
0689 C***********          Z-ADDZIEND     ZDAYNO                          066550
0690 C***********          EXSR ZDATE2                                    066550
0691 C***********          MOVE ZDAY      ZIFD    20                      066550
0692 C***********          MOVE ZMTH      ZIFM    20                      066550
0693 C***********          MOVE ZYEAR     ZIFY    20                      066550
0694 C***********          EXSR ZRSTOR                                    066550
0695 C***********          SETOF                     93                   066550
0    C****IN*ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEAR IF  066550
     C****ZIEND*IS GREATER THAN ZIBEG,THEN THE DATE ZIEND MUST BE IN A    066550
     C****DIFFERENT CENTURY TO ZIBEG.IF SO ADD 100 YEARS TO IT.           066550
     C***********ZIEND     COMP ZIBEG                93                   066550
     C***93******ZIFY      COMP ZISY                   93                 066550
     C***********          Z-ADDZISY      ZISY2   30                      066550
     C**N93******          Z-ADDZIFY      ZIFY2   30                      066550
     C***93******ZIFY      ADD  100       ZIFY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*START*YEAR*IS*A*LEAP*YEAR*AND*IF*STA***S01147066550
     C*****MONTH*IS*FEBRUARY.***************************************S01147066550
     C***********                                                   S01147066550
     C**N98******          BITOF'0'       ZGLBIT  1          E80945S01147 066550
     C***98******          BITON'0'       ZGLBIT              E80945S01147066550
     C***********ZISY2     ADD  1900      ZLYCHK  40                S01147066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01147066550
     C***********          MVR            ZLYREM  20                S01147066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YE S01147066550
     C***********ZISM      COMP 2                        99*FEBRUAR S01147066550
2209 C**N99******30        SUB  ZISD      ZID1    50   93           S01147066550
2210 C**N99*93***          Z-ADD0         ZID1                      S01147066550
     C***99N98***28        SUB  ZISD      ZID1                      S01147066550
     C***99*98***29        SUB  ZISD      ZID1                      S01147066550
2209 C***********30        SUB  ZISD      ZID1    50   93           S01147066550
2210 C***93******          Z-ADD0         ZID1                      S01147066550
2211 C***********ZISM      COMP 12                       93               066550
2212 C***93******          Z-ADD0         ZISM                            066550
2213 C***93******ZISY      ADD  1         ZISY                            066550
     C***93******ZISY2     ADD  1         ZISY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*END*YEAR*IS*A*LEAP*YEAR*AND*IF*END*MON*S01147066550
     C*****IS*FEBRUARY.*********************************************S01147066550
     C***********                                                   S01147066550
     C***********ZIFY2     ADD  1900      ZLYCHK  40                S01147066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01147066550
     C***********          MVR            ZLYREM  20                S01147066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YE S01147066550
     C***********ZIFM      COMP 2                        99*FEBRUAR S01147066550
2214 C**N99******ZIFD      COMP 31                       93         S01147066550
2214 C***99N98***ZIFD      COMP 28                       93         S01147066550
2214 C***99*98***ZIFD      COMP 29                       93         S01147066550
     C***********          SETOF                     98       E80945S01147066550
     C***********          TESTB'0'       ZGLBIT         98   E80945S01147066550
2214 C***********ZIFD      COMP 31                       93         S01147066550
0702 C***93******ZID1      ADD  30        ZID1                            066550
0703 C**N93******ZID1      ADD  ZIFD      ZID1                            066550
0704 C***********ZIFM      SUB  1         ZIFM                            066550
     C***********ZISY      COMP ZIFY                     93               066550
0706 C***93******ZIFM      SUB  ZISM      ZINOM   30                      066550
0707 C***93******          GOTO ZIOUT                                     066550
0708 C***********12        SUB  ZISM      ZIM1    20                      066550
0709 C***********          Z-ADD1         ZISM                            066550
     C*****USE*ENLARGED FIELDS THAT CAN HANDLE 1999 ONWARDS               066550
     C***********ZISY2     ADD  1         ZISY2                           066550
     C***********ZIFY2     SUB  ZISY2     ZIY1    20                      066550
0712 C***********ZIY1      MULT 12        ZIM2    30                      066550
0713 C***********ZIM2      ADD  ZIFM      ZIM2                            066550
0714 C***********ZIM1      ADD  ZIM2      ZINOM                           066550
0715 C***********ZIOUT     TAG                             * ZIOUT TAG *  066550
0716 C***********ZINOM     MULT 30        ZID2    50                      066550
0717 C***********ZID2      ADD  ZID1      ZDAYN1                          066550
0718 C***********          SETOF                     93                   066550
0719 C***********ZILPCK    TAG                             * ZILPCK TAG * 066550
0720 C**N96N97***          GOTO ZICAL                                     066550
0721 C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.         066550
0722 C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB   066550
0723 C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, & ZIEND.066550
0724 C***********                                                         066550
0725 C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                        066550
0726 C***********ZDAYN1    DIV  1461      ZIMAN   20                      066550
0727 C***********          MVR            ZIREM   50                      066550
0728 C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.                    066550
0729 C***********ZIBEG     SUB  60        ZIBW1   50                      066550
0730 C***********ZIBW1     DIV  1461      ZIDW1   20                      066550
0731 C***********          MVR            ZIDREM  50                      066550
0732 C***********ZIDREM    COMP 0                        94               066550
0733 C***94******          Z-ADDZIBEG     ZIDW2   50                      066550
0734 C***94******          GOTO ZILP1                                     066550
0735 C*****ROUND*UP RESULT                                                066550
0736 C***********ZIDW1     ADD  1         ZIDW2                           066550
0737 C*****CALCULATE NEXT 29 FEB.                                         066550
0738 C***********ZIDW2     MULT 1461      ZIDW2                           066550
0739 C***********ZIDW2     ADD  60        ZIDW2                           066550
0740 C***********ZILP1     TAG                             * ZILP1 TAG *  066550
0741 C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO        066550
0742 C*****ZIREM*THEN ADD 1 TO ZIMAN.                                     066550
0743 C***********ZIDW2     SUB  ZIBEG     ZILPCP  50                      066550
0744 C***********ZIREM     COMP ZILPCP               94  94               066550
0745 C***94******ZIMAN     ADD  1         ZIMAN                           066550
0746 C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1             066550
0747 C*****REQUIRED FOR THIS INTEREST CALCULATION.                        066550
0748 C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                          066550
0749 C***********          SETOF                     94                   066550
0750 C***********ZICAL     TAG                             * ZICAL TAG *  066550
0751 C***********                                                         066550
0752 C****CALCULATE INTEREST                                              066550
0753 C***90******                                                         066550
0754 C*R*91******                                                         066550
0755 C*R*96******ZIAMT     DIV  36000     ZIWRK1 155H                     066550
0756 C***92******                                                         066550
0757 C*R*97******ZIAMT     DIV  36500     ZIWRK1    H                     066550
0758 C***95******ZIAMT     DIV  36600     ZIWRK1    H                     066550
0759 C*R*********ZIWRK1    MULT ZIRATE    ZIWRK2 155H                     066550
0760 C*R*********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF INTRST 066550
0761 C***********                                                         066550
0762 C***********          SETOF                     909192               066550
0763 C***********          SETOF                     959697               066550
0764 C*R*********          ENDSR                                          066550
0765 C***********                                                         066550
0766 C********************************************************************066550
0767 C********************************************************************
0768 C**
0769 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0770 C**
0771 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0772 C**
0773 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0774 C**
0775 C**   CLEAR DATE FIELDS.
0776 C                     Z-ADD0         ZDATE   60
0777 C                     MOVEL'       ' ZADATE  7
0778 C**
0779 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0780 C                     Z-ADDZDAYNO    ZDAYNO  50
0781 C**
0782 C**   DETERMINE YEAR NUMBER.
0783 C**
0784 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0785 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0786 C   99                GOTO ZDEND2
0787 C**
0788 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0789 C           ZDAYN1    DIV  1461      ZLYR    20
0790 C                     MVR            ZDAYN1           SAVE REMAINING
0791 C**                                                   DAYS
0792 C**   CALCULATE NUMBER OF REMAINING YEARS.
0793 C                     Z-ADD1         ZWRK2   20
0794 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0795 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0796 C  N90      ZWRK2     ADD  1         ZWRK2
0797 C  N90                GOTO ZDTAG1
0798 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0799 C**
0800 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0801 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0802 C**
0803 C**   CALCULATE ACTUAL YEAR NUMBER.
0804 C           ZLYR      MULT 4         ZWRK3   30
0805 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0806 C                     Z-ADDZWRK3     ZYEAR   20
0807 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0808 C**
0809 C**   DETERMINE MONTH NUMBER.
0810 C**
0811 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0812 C                     SETOF                     9293
0813 C   91      ZDAYN1    COMP 59                     9293
0814 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0815 C**
0816 C**   CALCULATE MONTH NUMBER.
0817 C                     Z-ADD2         ZWRK2
0818 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0819 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0820 C  N94      ZWRK2     ADD  1         ZWRK2
0821 C  N94                GOTO ZDTAG2
0822 C           ZWRK2     SUB  1         ZWRK2
0823 C**
0824 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0825 C**
0826 C**   DETERMINE DAY OF MONTH.
0827 C**
0828 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0829 C           ZDAYN1    ADD  1         ZDAYN1
0830 C**
0831 C**   CALCULATE DAY OF MONTH.
0832 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0833 C**
0834 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0835 C   93      ZDAY      ADD  1         ZDAY
0836 C**
0837 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0838 C  N98                MOVELZDAY      ZWRK4   40
0839 C   98                MOVE ZDAY      ZWRK4
0840 C  N98                MOVE ZMTH      ZWRK4
0841 C   98                MOVELZMTH      ZWRK4
0842 C                     MOVELZWRK4     ZDATE
0843 C                     MOVE ZYEAR     ZDATE
0844 C**
0845 C**   FORMAT ALPHA DATE, DDMMMYY.
0846 C           ZDAY      COMP 10                     95
0847 C                     MOVELZDAY      ZWRK5   5
0848 C   95                MOVEL' '       ZWRK5
0849 C                     MOVE ZMNM,ZMTH ZWRK5
0850 C                     MOVELZWRK5     ZADATE
0851 C                     MOVE ZYEAR     ZADATE
0852 C**
0853 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0854 C**
0855 C**
0856 C********************************************************************
0857 C**
0858 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS
0859 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.
0860 C**
0861 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS
0862 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.
0863 C**
0864 C           ZSAVE     BEGSR                           *** ZSAVE ***
0865 C**
0866 C                     BITOF'01234567'ZBITS   1
0867 C   90                BITON'0'       ZBITS
0868 C   91                BITON'1'       ZBITS
0869 C   92                BITON'2'       ZBITS
0870 C   93                BITON'3'       ZBITS
0871 C   94                BITON'4'       ZBITS
0872 C   95                BITON'5'       ZBITS
0873 C   96                BITON'6'       ZBITS
0874 C   97                BITON'7'       ZBITS
0875 C**
0876 C                     SETOF                     909192
0877 C                     SETOF                     939495
0878 C                     SETOF                     9697
0879 C**
0880 C                     ENDSR
0881 C**
0882 C**
0883 C********************************************************************
0884 C**
0885 C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS
0886 C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.
0887 C**
0888 C           ZRSTOR    BEGSR                           *** ZRSTOR ***
0889 C**
0890 C                     TESTB'0'       ZBITS          90
0891 C                     TESTB'1'       ZBITS          91
0892 C                     TESTB'2'       ZBITS          92
0893 C                     TESTB'3'       ZBITS          93
0894 C                     TESTB'4'       ZBITS          94
0895 C                     TESTB'5'       ZBITS          95
0896 C                     TESTB'6'       ZBITS          96
0897 C                     TESTB'7'       ZBITS          97
0898 C**
0899 C                     ENDSR
0900 C**
0901 C**
0902 C********************************************************************
0903 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0904 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0905 C*
0906 CSR         GLZADD    BEGSR                           *** GLZADD ****
0907 C*
0908 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0909 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0910 C*
0911 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0912 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0913 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0914 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0915 C*
0916 CSR                   EXSR GLZSUM
0917 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0918 C*
0919 C********************************************************************
0920 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0921 C*                        GLZADD, GLZSUB, GLZCMP.
0922 C*          PARAMETERS PASSED -
0923 C*                     I/P ZZAMTI ZZAMTD
0924 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0925 C*
0926 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0927 C*
0928 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0929 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0930 CSR                   SETOF                     919293
0931 CSR                   SETOF                     949599
0932 C*
0933 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0934 CSR         ZZAMTI    COMP 0                      9293
0935 CSR 93      ZZAMTD    COMP 0                      9293
0936 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0937 C*
0938 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0939 CSR         ZZTOTI    COMP 0                      9193
0940 CSR 93      ZZTOTD    COMP 0                      9193
0941 C*
0942 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0943 CSR 93                Z-ADDZZAMTI    ZZTOTI
0944 CSR 93                Z-ADDZZAMTD    ZZTOTD
0945 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0946 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0947 CSR 91N92
0948 CORN91 92             GOTO ZZOFPS
0949 C*
0950 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0951 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0952 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0953 C*
0954 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0955 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0956 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0957 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0958 C*
0959 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0960 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0961 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0962 CSRN99                Z-ADDZZWK2     ZZTOTD
0963 CSRN99                Z-ADDZZWK3     ZZTOTI
0964 C*
0965 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0966 CSR 99                Z-ADD0         ZZAMT  153
0967 CSR                   GOTO ZZSEND
0968 C*
0969 C* THE 'SIGNS' ARE DIFFERENT
0970 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0971 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0972 C*
0973 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0974 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0975 C*
0976 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0977 C*
0978 CSR 91                Z-SUBZZTOTI    ZZTOTI
0979 CSR 91                Z-SUBZZTOTD    ZZTOTD
0980 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0981 C*
0982 CSR         ZZTOTI    COMP ZZAMTI               93  95
0983 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0984 C*
0985 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0986 CSR 95                Z-ADD0         ZZTOTI
0987 CSR 95                Z-ADD0         ZZTOTD
0988 CSR 95                GOTO ZZSEND
0989 C*
0990 C* IF ZZTOT GT. ZZAMT.
0991 CSR 93      ZZAMTD    COMP ZZTOTD               94
0992 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0993 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0994 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0995 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0996 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0997 C*
0998 C*
0999 C* IF ZZAMT GT. ZZTOT.
1000 CSRN93      ZZTOTD    COMP ZZAMTD               94
1001 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
1002 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
1003 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1004 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1005 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1006 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1007 C*
1008 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1009 CSR                   SETOF                     94
1010 CSR 93 91
1011 CORN93 92             SETON                     94
1012 CSR 94                Z-SUBZZTOTI    ZZTOTI
1013 CSR 94                Z-SUBZZTOTD    ZZTOTD
1014 C**
1015 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1016 CSR 92                Z-SUBZZAMTI    ZZAMTI
1017 CSR 92                Z-SUBZZAMTD    ZZAMTD
1018 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
1019 C**
1020 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1021 CSR                   SETOF                     96
1022 CSR         ZZTOTD    COMP 0                        91
1023 CSR 91      ZZTOTI    COMP 0                      96
1024 CSR 96                MOVE '.000-'   ZZNEGD  5
1025 CSR                   ENDSR                             ** ENDSR **
1026 C********************************************************************
1027 C*****                                                               S01194
1028 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
1029 C*****                                                               S01194
1030 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
1031 C*****                                                               S01194
1032 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
1033 C*****                MOVEL'01      'ZTABKY 12                       S01194
1034 C*****                MOVE '  10'    ZTABKY                          S01194
1035 C*****                                                               S01194
1036 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
1037 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
1038 C*****                                                               S01194
1039 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
1040 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
1041 C*****                                                               S01194
1042 C*****                ENDSR                                          S01194
1043 C*****                                                               S01194
1044 C*****                                                               S01194
1045 C********************************************************************
1046 C/EJECT
     C********************************************************************S01119
     C*                                                                   S01119
     C**   SRFR SR. FORWARD RATE AGREEMENT PROCESSING (DLP0500-GG)        S01119
     C*                                                                   S01119
     C           SRFR      BEGSR                           *** SRFR ***   S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   EXTRACT HEDGED DEALS ONLY.                                     S01119
     C*                                                                   S01119
     C           HEDIN     IFEQ 'Y'                                       S01119
     C*                                                                   S01119
     C**   CLEAR/SET FIELDS FOR PROCESSING & OUTPUT.                      S01119
     C*                                                                   S01119
     C                     MOVE 0         *IN30                           S01119
     C                     MOVE 0         *IN31                           S01119
     C                     Z-ADD0         WAMAD  150                      S01119
     C                     Z-ADD0         WAMTA  150                      S01119
     C*                                                                   S01119
     C                     Z-ADDUPAMT     SZPPL                           S01119
     C                     Z-ADDVDAT      SZVDAT                          S01119
     C                     Z-ADDVDAT      SZSDAT                          S01119
     C                     Z-ADDMDAT      SZMDAT                          S01119
     C                     Z-ADDMDAT      SZEDAT                          S01119
     C                     Z-ADDUICBS     SZICB                           S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDUEINR     SZFLT                           S01119
     C                     Z-ADDTEINR     SZFIX                           S01119
     C                     TESTB'1'       UDSTI          31 NEG.INT.      S01119
     C           *IN31     IFEQ '1'                                       S01119
     C                     Z-SUBUEINR     SZFLT                           S01119
     C                     Z-SUBTEINR     SZFIX                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C                     Z-ADDTEINR     SZFLT                           S01119
     C                     Z-ADDUEINR     SZFIX                           S01119
     C                     TESTB'1'       TDSTI          31 NEG.INT.      S01119
     C           *IN31     IFEQ '1'                                       S01119
     C                     Z-SUBTEINR     SZFLT                           S01119
     C                     Z-SUBUEINR     SZFIX                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C           UIPRD     IFNE 0                                         S01119
     C                     Z-ADDUIPRD     IPRD                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTIPRD     IPRD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     MOVE UCUCY     CCY                             S01119
     C                     Z-ADDVDAT      ACFD    50                      S01119
     C                     Z-ADDMDAT      ACTD    50                      S01119
     C                     Z-ADDUEINR     INTR                            S01119
     C                     Z-ADD0         AMAD                            S01119
     C                     Z-ADD0         AMTA                            S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       UDNSI          30 RATE SET      S01119
     C           *IN30     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       URTPI   1                       S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       URTPI                           S01119
     C                     END                                            S01119
     C                     MOVE 'Y'       TRTPI   1                       S01119
     C                     ELSE                                           S01119
     C                     TESTB'0'       TDNSI          30 RATE SET      S01119
     C           *IN30     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       TRTPI                           S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       TRTPI                           S01119
     C                     END                                            S01119
     C                     MOVE 'Y'       URTPI                           S01119
     C                     END                                            S01119
     C                     Z-ADDVDAT      TACFD   50                      S01119
     C                     Z-ADDMDAT      TACTD   50                      S01119
     C                     Z-ADD0         TAMAD  130                      S01119
     C                     Z-ADD0         TAMTA  130                      S01119
     C                     MOVE 'N'       FLRIND  1                       S01119
     C*                                                                   S01119
     C**   EXTRACT CRITERIA DIFFER FOR FIRST/LAST DAY ACCRUAL.            S01119
     C*                                                                   S01119
     C***********ACLD      IFEQ 'Y'                        LAST DAY S01119S01194
     C           BKALDI    IFEQ 'Y'                        LAST DAY ACC.  S01194
     C*                                                                   S01119
     C           VDAT      IFGT REPCD                                     S01119
     C*                                                                   S01119
     C**   DEAL NOT SETTLED, IE. NOT STARTED ACCRUING, SO AMOUNT          S01119
     C**   TO ACCRUE EQ. CALCULATED DISCOUNTED SETTLEMENT AMOUNT.         S01119
     C**   CAN CALCULATE ONLY IF FLOATING RATE SET.                       S01119
     C*                                                                   S01119
     C           URTPI     IFEQ 'Y'                                       S01119
     C           TRTPI     ANDEQ'Y'                                       S01119
     C           UEINR     IFGE TEINR                                     S01119
     C           UAIAN     SUB  TAIAN     SZIANP                          S01119
     C                     ELSE                            VDAT LE REPCD  S01119
     C           TAIAN     SUB  UAIAN     SZIANP                          S01119
     C                     END                                            S01119
     C                     EXSR DLRADS                                    S01119
     C                     Z-ADDSZDSA     WAMTA                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                            VDAT LE REPCD  S01119
     C           MDAT      IFGT REPCD                                     S01119
     C*                                                                   S01119
     C**   DEAL SETTLED, CALCULATE AMOUNT ACCRUED TO DATE & TO ACCRUE.    S01119
     C*                                                                   S01119
     C           MDAT      SUB  VDAT      PERIOD                          S01119
     C           PERIOD    IFGT 0                                         S01119
     C           IPRD      DIV  PERIOD    DLYACC 155H                     S01119
     C                     ELSE                                           S01119
     C                     Z-ADD0         DLYACC                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           REPCD     SUB  VDAT      DAYS                            S01119
     C           DLYACC    MULT DAYS      WAMAD     H                     S01119
     C*                                                                   S01119
     C           IPRD      SUB  WAMAD     WAMTA                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C***********ACLD******IFNE 'Y'                        FIRST DAYS01119S01194
     C           BKALDI    IFNE 'Y'                        FIRST DAY ACC. S01194
     C*                                                                   S01119
     C           VDAT      IFGE REPCD                                     S01119
     C*                                                                   S01119
     C**   DEAL NOT SETTLED, IE. NOT STARTED ACCRUING, SO AMOUNT          S01119
     C**   TO ACCRUE EQ. CALCULATED DISCOUNTED SETTLEMENT AMOUNT.         S01119
     C**   CAN CALCULATE ONLY IF FLOATING RATE SET.                       S01119
     C*                                                                   S01119
     C           URTPI     IFEQ 'Y'                                       S01119
     C           TRTPI     ANDEQ'Y'                                       S01119
     C                     EXSR DLRADS                                    S01119
     C                     Z-ADDSZDSA     WAMTA                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                            VDAT LT REPCD  S01119
     C           MDAT      IFGE REPCD                                     S01119
     C*                                                                   S01119
     C**   DEAL SETTLED, CALCULATE AMOUNT ACCRUED TO DATE & TO ACCRUE.    S01119
     C*                                                                   S01119
     C           MDAT      SUB  VDAT      PERIOD                          S01119
     C           PERIOD    IFGT 0                                         S01119
     C           IPRD      DIV  PERIOD    DLYACC 155H                     S01119
     C                     ELSE                                           S01119
     C                     Z-ADD0         DLYACC                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           REPCD     SUB  VDAT      DAYS                            S01119
     C           DLYACC    MULT DAYS      WAMAD     H                     S01119
     C*                                                                   S01119
     C           IPRD      SUB  WAMAD     WAMTA                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   PUT ACCRUAL AMOUNTS IN APPROPIATE DETAILS FIELD.               S01119
     C**   (REVERSE AMOUNTS IF AMOUNT BEING PAID.)                        S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           SZFLT     IFGE SZFIX                                     S01119
     C                     Z-SUBWAMAD     AMAD                            S01119
     C                     Z-SUBWAMTA     AMTA                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDWAMAD     TAMAD                           S01119
     C                     Z-ADDWAMTA     TAMTA                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           SZFLT     IFGT SZFIX                                     S01119
     C                     Z-ADDWAMAD     TAMAD                           S01119
     C                     Z-ADDWAMTA     TAMTA                           S01119
     C                     ELSE                                           S01119
     C                     Z-SUBWAMAD     AMAD                            S01119
     C                     Z-SUBWAMTA     AMTA                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   OUTPUT PF/ACCEXAO RECORD.                                      S01119
     C*                                                                   S01119
     C                     EXCPTACCEX                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C**   ACCUMULATE NUMBER AND VALUE OF EXTRACT RECORDS WRITTEN.        S01119
     C*                                                                   S01119
     C                     ADD  1         RECRIT                          S01119
     C                     MOVE UPAMT     ZZAMT                           S01119
     C                     Z-ADD1         X                               S01119
     C                     EXSR HASH                                      S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C********************************************************************S01119
     C*                                                                   S01119
     C**   SRRS SR. SINGLE CCY INTEREST RATE SWAP PROCESSING (DLP0500-HH) S01119
     C*                                                                   S01119
     C           SRRS      BEGSR                           *** SRRS ***   S01119
     C*                                                                   S01119
     C**   CLEAR/SET FIELDS FOR PROCESSING & OUTPUT.                      S01119
     C*                                                                   S01119
     C                     MOVE 0         *IN30                           S01119
     C/COPY WNCPYSRC,DL0500C001
     C*                                                                   S01119
     C                     MOVE UCUCY     CCY                             S01119
     C                     Z-ADDUSLIP     ACFD                            S01119
     C                     Z-ADD0         ACTD                            S01119
     C                     Z-ADD0         NOTD                            S01119
     C                     Z-ADDUEINR     INTR                            S01119
     C                     Z-ADD0         AMAD                            S01119
     C                     Z-ADD0         AMTA                            S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       UDNSI          30 RATE SET      S01119
     C/COPY WNCPYSRC,DL0500C016
     C           *IN30     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       URTPI                           S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       URTPI                           S01119
     C                     END                                            S01119
     C                     ELSE                                           S01119
     C                     MOVE 'Y'       URTPI                           S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0500C022
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       TDNSI          30 RATE SET      S01119
     C/COPY WNCPYSRC,DL0500C017
     C           *IN30     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       TRTPI                           S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       TRTPI                           S01119
     C                     END                                            S01119
     C                     ELSE                                           S01119
     C                     MOVE 'Y'       TRTPI                           S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0500C023
      *                                                                                       CIR007
      ** This code will force a calculation of "interest accrued to                           CIR007
      ** date" and "interest to accrue".                                                      CIR007
      *                                                                                       CIR007
     C           UICFR     IFEQ 'O'                                                           CIR007
     C                     MOVE 'Y'       URTPI                                               CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C           TICFR     IFEQ 'O'                                                           CIR007
     C                     MOVE 'Y'       TRTPI                                               CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C                     Z-ADDTSLIP     TACFD                           S01119
     C                     Z-ADD0         TACTD                           S01119
     C                     Z-ADD0         TAMAD                           S01119
     C                     Z-ADD0         TAMTA                           S01119
     C                     MOVE 'N'       FLRIND                          S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   SET ACCRUAL TO DATE TO EARLIEST DATE PRESENT.                  S01119
     C*                                                                   S01119
     C           UNIPD     IFNE 0                                         S01119
     C                     Z-ADDUNIPD     ACTD                            S01119
     C                     ELSE                                           S01119
     C           UNICD     IFNE 0                                         S01119
     C                     Z-ADDUNICD     ACTD                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDMDAT      ACTD                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                   CIR005
      ** Use Interest Payment Base Date instead of Next Interest          CIR005
      **  Payment Date if Business Day Enhancement is on                  CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A '                                      CIR005
     C           CIR001    IFEQ 'N'                                       CIR005
     C           CIR001    OREQ 'Y'                                       CIR005
     C           UIPFR     ANDNE'Z'                                       CIR005
     C           UIPBD     IFNE 0                                         CIR005
     C                     Z-ADDUIPBD     ACTD                            CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C           UNICD     IFNE 0                                         S01119
     C           UNICD     ANDLTACTD                                      S01119
     C                     Z-ADDUNICD     ACTD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**   SELECT OUR DETAILS FOR ACCRUAL ONLY IF RATE PRESENT.           S01119
     C*                                                                   S01119
     C           URTPI     IFEQ 'Y'                                       S01119
     C*                                                                   S01119
     C**   SET DETAILS TO CALCULATE INTEREST ACCRUED TO DATE.             S01119
     C*                                                                   S01119
     C           UIPFR     IFEQ 'C'                                                           221626
     C           CIR001    ANDEQ'Y'                                                           221626
     C                     Z-ADDUSLIP     ZIBEG                                               221626
     C                     ELSE                                                               221626
     C                     Z-ADDUIACD     ZIBEG                           S01119
     C                     ENDIF                                                              221626
     C           ACTD      IFLE REPCD                                     S01119
     C                     Z-ADDACTD      ZIEND                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDREPCD     ZIEND                           S01119
     C*                                                                   042900
     C** If it is the 30th day, calculation method is 3, and              042900
     C** accrue on last day is 'N', add 1 to ZIEND to have an             042900
     C** accrual on the 30th day of the month.                            042900
     C** This applies only to 31-day months.                              090221
     C*                                                                   042900
     C***********          MOVE BJRDNB    ZDAYNO                    042900111053
     C***********          EXSR ZDATE2                              042900111053
     C***********                                                   042900111053
     C***********ZDAY      IFEQ 30                                  042900111053
     C***********UICBS     ANDEQ3                                   042900111053
     C***********BKALDI    ANDEQ'N'                                 042900111053
     C***********ZMTH      IFEQ 1                                   090221111053
     C***********ZMTH      OREQ 3                                   090221111053
     C***********ZMTH      OREQ 5                                   090221111053
     C***********ZMTH      OREQ 7                                   090221111053
     C***********ZMTH      OREQ 8                                   090221111053
     C***********ZMTH      OREQ 10                                  090221111053
     C***********ZMTH      OREQ 12                                  090221111053
     C***********          ADD  1         ZIEND                     042900111053
     C***********          END                                      090221111053
     C***********          END                                      042900111053
     C*                                                                   042900
     C                     END                                            S01119
     C                     Z-ADDUICBS     ZICALC                          S01119
     C                     Z-ADDUPAMT     ZIAMT                           S01119
     C                     Z-ADDUEINR     ZIRATE                          S01119
     C                     Z-ADD0         ZINTR                           S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP9                                           S01408
     C*                                                                   CIR001
     C** If interest is up-front, use SR/UFACC to calculate accrual       CIR001
     C*                                                                   CIR001
     C           UINPM     IFEQ 'Y'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C           UINPM     OREQ 'D'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C*                                                                   CIR001
     C                     Z-ADDUIPRD     SZIPRD 130                      CIR001
     C                     Z-ADDUAIAN     SZAIAN 130                      CIR001
     C                     Z-ADDUAIAP     SZAIAP 130                      CIR001
     C                     Z-ADDUAITC     SZAITC 130                      CIR001
     C                     Z-ADDUSLIP     SZSLID  50                      CIR001
     C                     Z-ADDACTD      SZACTD  50                      CIR001
     C                     MOVE UINPM     SZINPM  1                       CIR001
     C                     EXSR UFACC                                     CIR001
     C                     Z-ADDSZAMAD    AMAD                            CIR001
     C                     Z-ADDSZAMTA    AMTA                            CIR001
     C*                                                                   CIR001
     C                     ELSE                                           CIR001
     C*                                                                   S01119
     C**   CALCULATE INTEREST ACCRUED TO DATE IF DEAL STARTED ACCRUING.   S01119
     C*                                                                   S01119
     C**  If cash flow swap, obtain cash flow schedule                    CIR001
     C*                                                                   CIR001
     C           UIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     MOVE 'U'       OTIN                            CIR001
     C                     Z-ADDACTD      PRDT                            CIR001
     C           KCFSC     CHAINDLCFSCPD             99                   CIR001
     C      99             Z-ADD*ZERO     CFLA                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP10                                           S01408
      *                                                                   S01408
     C           USLIP     IFLE REPCD                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP11                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C** If a cash flow schedule has been specified, use SR/CFACC         CIR001
     C** to calculate the cash flow accrual.                              CIR001
     C** Otherwise, use SR/GLINTC.                                        CIR001
     C*                                                                   CIR001
     C           UIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     Z-ADDUSLIP     SZSLID                          CIR001
     C                     Z-ADDACTD      SZACTD                          CIR001
     C                     Z-ADDUICBS     ZICALC                                              222381
     C                     EXSR CFACC                                     CIR001
     C                     Z-ADDWKINT     ZINTR                           CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0500C055
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR ZSAVE                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP60                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP77                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP12                                           S01408
      *                                                                   S01408
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     ELSE                                           E19857
     C                     Z-ADDUSLIP     ZIEND                           E19857
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0500C026
     C           *LIKE     DEFN ZINTR     WINTR                                               209405
     C                     Z-ADDZINTR     WINTR                                               209405
     C           ZINTR     ADD  UAIAN     AMAD      H                     S01119
     C                     ADD  UAIAP     AMAD                            S01119
     C                     ADD  UAITC     AMAD                            S01119
     C                     SUB  UIPRD     AMAD                            S01119
     C/COPY WNCPYSRC,DL0500C027
      *                                                                                       CIR007
      ** Calculation for Our Interest Accrued to Date                                         CIR007
      ** If Our side of the deal is an OIS (UICFR = 'O'), call program                        CIR007
      ** DL1651 to calculate the basic amount of interest accrued to                          CIR007
      ** date.                                                                                CIR007
      *                                                                                       CIR007
     C           UICFR     IFEQ 'O'                                                           CIR007
      *                                                                                       204923
      ** Check Rate Fix Day Adjustment                                                        204923
      *                                                                                       204923
     C                     CALL 'AOCURRR0'                                                    204923
     C                     PARM '*MSG   ' PRTCD   7                                           204923
     C                     PARM '*KEY   ' POPTN   7                                           204923
     C                     PARM UCUCY     PCCY    3                                           204923
     C           SDCURR    PARM SDCURR    DSSDY                                               204923
      *                                                                                       204923
     C           PRTCD     IFNE *BLANK                                                        204923
     C                     MOVEL'SDCURRPD'DBFILE                                              204923
     C                     Z-ADD15        DBASE                                               204923
     C                     MOVELPCCY      DBKEY                                               204923
     C                     EXSR *PSSR                                                         204923
     C                     ENDIF                                                              204923
      *                                                                                       CIR007
      ** Add 1 to ZIBEG to give the correct number of days.                                   CIR007
      *                                                                                       CIR007
     C           ZIBEG     ADD  1         PFRDT                                               CIR007
      *                                                                                       CIR007
     C                     CALL 'DL1651'                                                      CIR007
     C                     PARM DLNO      PDLNO   60                                          CIR007
     C                     PARM 'O'       POTCD   1                                           CIR007
     C                     PARM           PFRDT   50                                          CIR007
     C                     PARM ZIEND     PTODT   50                                          CIR007
     C                     PARM           PINTAM 130                                          CIR007
     C                     PARM           PRTNC   1                                           CIR007
     C                     PARM *BLANK    PTOAC   1                                           204923
      *                                                                                       CIR007
      ** If Return Code not blank,then Database Error occured.                                CIR007
      *                                                                                       CIR007
     C           PRTNC     IFNE *BLANKS                                                       CIR007
     C                     MOVEL'DL0500'  DBPGM     P                                         CIR007
     C                     MOVEL'DL1651'  DBFILE    P                                         CIR007
     C                     MOVEL'011'     DBASE     P                                         CIR007
     C                     MOVELPDLNO     DBKEY     P                                         CIR007
     C                     MOVE *ON       *INU7                                               CIR007
     C                     MOVE *ON       *INU8                                               CIR007
     C                     MOVE *ON       *INLR                                               CIR007
     C                     EXSR *PSSR                                                         CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
      ** Add Accrued Interest Adjusted Not Posted and Accrued Interest                        CIR007
      ** Adjusted and Posted.                                                                 CIR007
      *                                                                                       CIR007
     C                     Z-ADDPINTAM    WINTR                                               209405
     C           UAIAN     ADD  PINTAM    PINTAM                                              CIR007
     C           UAIAP     ADD  PINTAM    PINTAM                                              CIR007
     C                     Z-ADDPINTAM    AMAD                                                CIR007
      *                                                                                       CIR007
     C**********           ENDIF                                                       CIR007 209405
      *                                                                                       204923
      ** If A6FXDY not equal to 0, update ZIEND with 'To Date'                                204923
      ** field from DL1651.                                                                   204923
      *                                                                                       204923
     C           A6FXDY    IFNE 0                                                             204923
     C                     Z-ADDPTODT     ZIEND                                               204923
     C                     ENDIF                                                              204923
      *                                                                                       209405
     C                     ENDIF                                                              209405
      *                                                                                       204923
     C*                                                                   S01119
     C**   CALCULATE INTEREST TO ACCRUE.                                  S01119
     C*                                                                   S01119
     C**********           Z-ADDZIEND     ZIBEG                                        S01119 209405
     C                     Z-ADDACTD      ZIEND                           S01119
     C                     Z-ADD0         ZINTR                           S01119
     C           ACTD      IFGE REPCD                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP24                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C** If a cash flow schedule has been specified, use SR/CFACC to      CIR001
     C** calculate the cash flow accrual.                                 CIR001
     C** Otherwise, use SR/GLINTC.                                        CIR001
     C*                                                                   CIR001
     C           UIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     Z-ADDUSLIP     ZIBEG                           CIR001
     C                     Z-ADDREPCD     ZIEND                           CIR001
     C                     Z-ADDUICBS     ZICALC                                              222381
     C           USLIP     IFGT REPCD                                     CIR001
     C                     Z-ADDUSLIP     ZIEND                           CIR001
     C                     END                                            CIR001
     C                     Z-ADDUSLIP     SZSLID                          CIR001
     C                     Z-ADDACTD      SZACTD                          CIR001
     C                     EXSR CFACC                                     CIR001
     C           CFLA      SUB  WKINT     AMTA                            CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR001
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C056
     C                     Z-ADDUPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
      ** Add Unsettled Interest and Unsettled Interest Adjustment to      CIR006
      ** to the Principal Amount if CIR002 is installed.                  CIR006
      ** Do this processing also for Our Processing Method 'A', 'I',      CIR006
      ** or 'L' when CIR006 is installed.                                 CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR ZSAVE                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP79                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP80                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C**********           Z-ADDZINTR     AMTA      H                                  S01119 209405
     C           ZINTR     SUB  WINTR     AMTA      H                                         209405
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP13                                           S01408
      *                                                                                       CIR007
      ** Calculation for Our Interest To Accrue.                                              CIR007
      ** If Our side of the deal is an OIS (UICFR = 'O'), call program                        CIR007
      ** DL1651 to calculate interest to accrue.                                              CIR007
      *                                                                                       CIR007
     C           UICFR     IFEQ 'O'                                                           CIR007
      *                                                                                       CIR007
      ** Add 1 to ZIBEG to give the correct number of days.                                   CIR007
      *                                                                                       CIR007
     C           ZIBEG     ADD  1         PFRDT                                               CIR007
      *                                                                                       CIR007
     C                     CALL 'DL1651'                                                      CIR007
     C                     PARM DLNO      PDLNO                                               CIR007
     C                     PARM 'O'       POTCD                                               CIR007
     C                     PARM           PFRDT                                               CIR007
     C                     PARM ZIEND     PTODT                                               CIR007
     C                     PARM           PINTAM                                              CIR007
     C                     PARM           PRTNC                                               CIR007
     C                     PARM 'Y'       PTOAC                                               204923
      *                                                                                       CIR007
      ** If Return Code not blank then Database Error                                         CIR007
      *                                                                                       CIR007
     C           PRTNC     IFNE *BLANKS                                                       CIR007
     C                     MOVEL'DL0500'  DBPGM     P                                         CIR007
     C                     MOVEL'DL1651'  DBFILE    P                                         CIR007
     C                     MOVEL'012'     DBASE     P                                         CIR007
     C                     MOVELPDLNO     DBKEY     P                                         CIR007
     C                     MOVE *ON       *INU7                                               CIR007
     C                     MOVE *ON       *INU8                                               CIR007
     C                     MOVE *ON       *INLR                                               CIR007
     C                     EXSR *PSSR                                                         CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C**********           Z-ADDPINTAM    AMTA      H                                  CIR007 209405
     C           PINTAM    SUB  WINTR     AMTA      H                                         209405
      *                                                                                       CIR007
     C                     ENDIF                                                              CIR007
      *                                                                   S01408
     C                     END                                            CIR001
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP14                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C                     END                                            S01119
     C*                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C**   REVERSE ACCRUAL AMOUNTS AS BEING PAID.                         S01119
     C*                                                                   S01119
     C                     Z-SUBAMAD      AMAD                            S01119
     C                     Z-SUBAMTA      AMTA                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   SET ACCRUAL TO DATE TO EARLIEST DATE PRESENT.                  S01119
     C*                                                                   S01119
     C           TNIPD     IFNE 0                                         S01119
     C                     Z-ADDTNIPD     TACTD                           S01119
     C                     ELSE                                           S01119
     C           TNICD     IFNE 0                                         S01119
     C                     Z-ADDTNICD     TACTD                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDMDAT      TACTD                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                   CIR005
      ** Use Interest Payment Base Date instead of Next Interest          CIR005
      **  Payment Date if Business Day Enhancement is on                  CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A '                                      CIR005
     C           CIR017    ANDNE'Y'                                                           CIR017
     C           CIR005    OREQ 'Y'                                                           CIR017
     C           CIR017    ANDEQ'Y'                                                           CIR017
     C           L2AMCN    ANDEQ'A '                                                          CIR017
      **                                                                                      CIR017
     C           CIR001    IFEQ 'N'                                       CIR005
     C           CIR001    OREQ 'Y'                                       CIR005
     C           TIPFR     ANDNE'Z'                                       CIR005
     C           TIPBD     IFNE 0                                         CIR005
     C                     Z-ADDTIPBD     TACTD                           CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C           TNICD     IFNE 0                                         S01119
     C           TNICD     ANDLTTACTD                                     S01119
     C                     Z-ADDTNICD     TACTD                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**   SELECT THEIR DETAILS FOR ACCRUAL ONLY IF RATE PRESENT.         S01119
     C*                                                                   S01119
     C           TRTPI     IFEQ 'Y'                                       S01119
     C*                                                                   S01119
     C**   SET DETAILS TO CALCULATE INTEREST ACCRUED TO DATE.             S01119
     C*                                                                   S01119
     C           TIPFR     IFEQ 'C'                                                           221626
     C           CIR001    ANDEQ'Y'                                                           221626
     C                     Z-ADDTSLIP     ZIBEG                                               221626
     C                     ELSE                                                               221626
     C                     Z-ADDTIACD     ZIBEG                           S01119
     C                     ENDIF                                                              221626
     C           TACTD     IFLE REPCD                                     S01119
     C                     Z-ADDTACTD     ZIEND                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDREPCD     ZIEND                           S01119
     C*                                                                   042900
     C** If it is the 30th day, calculation method is 3, and              042900
     C** accrue on last day is 'N', add 1 to ZIEND to have an             042900
     C** accrual on the 30th day of the month.                            042900
     C** This applies only to 31-day months.                              090221
     C*                                                                   042900
     C***********          MOVE BJRDNB    ZDAYNO                    042900111053
     C***********          EXSR ZDATE2                              042900111053
     C***********                                                   042900111053
     C***********ZDAY      IFEQ 30                                  042900111053
     C***********TICBS     ANDEQ3                                   042900111053
     C***********BKALDI    ANDEQ'N'                                 042900111053
     C***********ZMTH      IFEQ 1                                   090221111053
     C***********ZMTH      OREQ 3                                   090221111053
     C***********ZMTH      OREQ 5                                   090221111053
     C***********ZMTH      OREQ 7                                   090221111053
     C***********ZMTH      OREQ 8                                   090221111053
     C***********ZMTH      OREQ 10                                  090221111053
     C***********ZMTH      OREQ 12                                  090221111053
     C***********          ADD  1         ZIEND                     042900111053
     C***********          END                                      090221111053
     C***********          END                                      042900111053
     C*                                                                   042900
     C                     END                                            S01119
     C                     Z-ADDTICBS     ZICALC                          S01119
     C                     Z-ADDTPAMT     ZIAMT                           S01119
     C                     Z-ADDTEINR     ZIRATE                          S01119
     C                     Z-ADD0         ZINTR                           S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP25                                           S01408
     C*                                                                   CIR001
     C** If interest is up-front, use SR/UFACC to calculate accrual       CIR001
     C*                                                                   CIR001
     C           TINPM     IFEQ 'Y'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C           TINPM     OREQ 'D'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C*                                                                   CIR001
     C                     Z-ADDTIPRD     SZIPRD                          CIR001
     C                     Z-ADDTAIAN     SZAIAN                          CIR001
     C                     Z-ADDTAIAP     SZAIAP                          CIR001
     C                     Z-ADDTAITC     SZAITC                          CIR001
     C                     Z-ADDTSLIP     SZSLID                          CIR001
     C                     Z-ADDTACTD     SZACTD                          CIR001
     C                     MOVE TINPM     SZINPM                          CIR001
     C                     EXSR UFACC                                     CIR001
     C                     Z-ADDSZAMAD    TAMAD                           CIR001
     C                     Z-ADDSZAMTA    TAMTA                           CIR001
     C                     ELSE                                           CIR001
     C*                                                                   S01119
     C**   CALCULATE INTEREST ACCRUED TO DATE IF DEAL STARTED ACCRUING.   S01119
     C*                                                                   S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP26                                           S01408
      *                                                                   S01408
     C**  If cash flow swap, obtain cash flow schedule                    CIR001
     C*                                                                   CIR001
     C           TIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     MOVE 'T'       OTIN                            CIR001
     C                     Z-ADDTACTD     PRDT                            CIR001
     C           KCFSC     CHAINDLCFSCPD             99                   CIR001
     C      99             Z-ADD*ZERO     CFLA                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           TSLIP     IFLE REPCD                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP27                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C** If a cash flow schedule has been specified, use SR/CFACC         CIR001
     C** to calculate the cash flow accrual.                              CIR001
     C** Otherwise, use SR/GLINTC.                                        CIR001
     C*                                                                   CIR001
     C           TIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     Z-ADDTSLIP     SZSLID                          CIR001
     C                     Z-ADDTACTD     SZACTD                          CIR001
     C                     Z-ADDTICBS     ZICALC                                              222381
     C                     EXSR CFACC                                     CIR001
     C                     Z-ADDWKINT     ZINTR                           CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount +  their unsettled interest +      CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Processing Method 'A', 'I',    CIR006
      ** or 'L' when CIR006 is installed.                                 CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0500C057
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR ZSAVE                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP61                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP78                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP15                                           S01408
      *                                                                   S01408
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     ELSE                                           E19857
     C                     Z-ADDTSLIP     ZIEND                           E19857
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0500C028
     C                     Z-ADDZINTR     WINTR                                               209405
     C           ZINTR     ADD  TAIAN     TAMAD     H                     S01119
     C                     ADD  TAIAP     TAMAD                           S01119
     C                     ADD  TAITC     TAMAD                           S01119
     C                     SUB  TIPRD     TAMAD                           S01119
     C/COPY WNCPYSRC,DL0500C029
      *                                                                                       CIR007
      ** Calculation for Their Interest Accrued to Date                                       CIR007
      ** If Their side of the deal is an OIS (TICFR = 'O'), call program                      CIR007
      ** DL1651 to calculate the basic amount of interest accrued to                          CIR007
      ** date.                                                                                CIR007
      *                                                                                       CIR007
     C           TICFR     IFEQ 'O'                                                           CIR007
      *                                                                                       204923
      ** Check Rate Fix Day Adjustment                                                        204923
      *                                                                                       204923
     C                     CALL 'AOCURRR0'                                                    204923
     C                     PARM '*MSG   ' PRTCD                                               204923
     C                     PARM '*KEY   ' POPTN                                               204923
     C                     PARM TCUCY     PCCY                                                204923
     C           SDCURR    PARM SDCURR    DSSDY                                               204923
      *                                                                                       204923
     C           PRTCD     IFNE *BLANK                                                        204923
     C                     MOVEL'SDCURRPD'DBFILE                                              204923
     C                     Z-ADD16        DBASE                                               204923
     C                     MOVELPCCY      DBKEY                                               204923
     C                     EXSR *PSSR                                                         204923
     C                     ENDIF                                                              204923
      *                                                                                       CIR007
      ** Add 1 to ZIBEG to give the correct number of days.                                   CIR007
      *                                                                                       CIR007
     C           ZIBEG     ADD  1         PFRDT                                               CIR007
      *                                                                                       CIR007
     C                     CALL 'DL1651'                                                      CIR007
     C                     PARM DLNO      PDLNO                                               CIR007
     C                     PARM 'T'       POTCD                                               CIR007
     C                     PARM           PFRDT                                               CIR007
     C                     PARM ZIEND     PTODT                                               CIR007
     C                     PARM           PINTAM                                              CIR007
     C                     PARM           PRTNC                                               CIR007
     C                     PARM *BLANK    PTOAC                                               204923
      *                                                                                       CIR007
      ** If Return Code not blank, then Database Error occured.                               CIR007
      *                                                                                       CIR007
     C           PRTNC     IFNE *BLANKS                                                       CIR007
     C                     MOVEL'DL0500'  DBPGM     P                                         CIR007
     C                     MOVEL'DL1651'  DBFILE    P                                         CIR007
     C                     MOVEL'013'     DBASE     P                                         CIR007
     C                     MOVELPDLNO     DBKEY     P                                         CIR007
     C                     MOVE *ON       *INU7                                               CIR007
     C                     MOVE *ON       *INU8                                               CIR007
     C                     MOVE *ON       *INLR                                               CIR007
     C                     EXSR *PSSR                                                         CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
      ** Add Accrued Interest Adjusted Not Posted and Accrued Interest                        CIR007
      ** Adjusted and Posted.                                                                 CIR007
      *                                                                                       CIR007
     C                     Z-ADDPINTAM    WINTR                                               209405
     C           TAIAN     ADD  PINTAM    PINTAM                                              CIR007
     C           TAIAP     ADD  PINTAM    PINTAM                                              CIR007
     C                     Z-ADDPINTAM    TAMAD                                               CIR007
      *                                                                                       204923
      ** If A6FXDY not equal to 0, update ZIEND with 'To Date'                                204923
      ** field from DL1651.                                                                   204923
      *                                                                                       204923
     C           A6FXDY    IFNE 0                                                             204923
     C                     Z-ADDPTODT     ZIEND                                               204923
     C                     ENDIF                                                              204923
      *                                                                                       CIR007
     C                     ENDIF                                                              CIR007
     C*                                                                   S01119
     C**   CALCULATE INTEREST TO ACCRUE.                                  S01119
     C*                                                                   S01119
     C**********           Z-ADDZIEND     ZIBEG                                        S01119 209405
     C                     Z-ADDTACTD     ZIEND                           S01119
     C                     Z-ADD0         ZINTR                           S01119
     C           TACTD     IFGE REPCD                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP28                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C** If a cash flow schedule has been specified, use SR/CFACC to      CIR001
     C** calculate the cash flow accrual.                                 CIR001
     C** Otherwise, use SR/GLINTC.                                        CIR001
     C*                                                                   CIR001
     C           TIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     Z-ADDTSLIP     ZIBEG                           CIR001
     C                     Z-ADDREPCD     ZIEND                           CIR001
     C           TSLIP     IFGT REPCD                                     CIR001
     C                     Z-ADDTSLIP     ZIEND                           CIR001
     C                     END                                            CIR001
     C                     Z-ADDTSLIP     SZSLID                          CIR001
     C                     Z-ADDTACTD     SZACTD                          CIR001
     C                     Z-ADDTICBS     ZICALC                                              222381
     C                     EXSR CFACC                                     CIR001
     C           CFLA      SUB  WKINT     TAMTA                           CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR001
     C** Set ZIAMT to principal amount +  their unsettled interest +      CIR002
     C** their unsettled interest adjustment                              CIR002
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C058
     C                     Z-ADDTPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
      ** Add Unsettled Interest and Unsettled Interest Adjustment to      CIR006
      ** to the Principal Amount if CIR002 is installed.                  CIR006
      ** Do this processing also for Their Processing Method 'A', 'I',    CIR006
      ** or 'L' when CIR006 is installed.                                 CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR ZSAVE                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP85                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP86                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C**********           Z-ADDZINTR     TAMTA     H                                  S01119 209405
     C           ZINTR     SUB  WINTR     TAMTA     H                                         209405
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP16                                           S01408
      *                                                                                       CIR007
      ** Calculation for Their Interest To Accrue.                                            CIR007
      ** If Their side of the deal is an OIS (TICFR = 'O'), call                              CIR007
      ** program DL1651 to calculate interest to accrue.                                      CIR007
      *                                                                                       CIR007
     C           TICFR     IFEQ 'O'                                                           CIR007
      *                                                                                       CIR007
      ** Add 1 to ZIBEG to give the correct number of days.                                   CIR007
      *                                                                                       CIR007
     C           ZIBEG     ADD  1         PFRDT                                               CIR007
      *                                                                                       CIR007
     C                     CALL 'DL1651'                                                      CIR007
     C                     PARM DLNO      PDLNO                                               CIR007
     C                     PARM 'T'       POTCD                                               CIR007
     C                     PARM           PFRDT                                               CIR007
     C                     PARM ZIEND     PTODT                                               CIR007
     C                     PARM           PINTAM                                              CIR007
     C                     PARM           PRTNC                                               CIR007
     C                     PARM 'Y'       PTOAC                                               204923
      *                                                                                       CIR007
      ** If Return Code not blank then Database Error Occured.                                CIR007
      *                                                                                       CIR007
     C           PRTNC     IFNE *BLANKS                                                       CIR007
     C                     MOVEL'DL0500'  DBPGM     P                                         CIR007
     C                     MOVEL'DL1651'  DBFILE    P                                         CIR007
     C                     MOVEL'014'     DBASE     P                                         CIR007
     C                     MOVELPDLNO     DBKEY     P                                         CIR007
     C                     MOVE *ON       *INU7                                               CIR007
     C                     MOVE *ON       *INU8                                               CIR007
     C                     MOVE *ON       *INLR                                               CIR007
     C                     EXSR *PSSR                                                         CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C**********           Z-ADDPINTAM    TAMTA     H                                  CIR007 218666
     C           PINTAM    SUB  WINTR     TAMTA     H                                         218666
      *                                                                                       CIR007
     C                     ENDIF                                                              CIR007
      *                                                                   S01408
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     END                                            S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP17                                           S01408
     C*                                                                   S01119
     C*                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0500CP29                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set-up new fields, our total unsettled interest and              CIR002
     C** their total unsettled interest.                                  CIR002
      ** Do this processing also for Our/Their Interest Processing        CIR006
      ** Method 'A', 'I' or 'L' when CIR006 is installed.                 CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C                     Z-ADD0         OTUI                            CIR006
     C                     Z-ADD0         TTUI                            CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
      *                                                                   CIR006
     C/COPY WNCPYSRC,DL0500C059
     C           OUSI      ADD  OUSA      OTUI                            CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C           TUSI      ADD  TUSA      TTUI                            CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C                     END                                            CIR002
     C*                                                                   S01119
     C*                                                                   S01119
     C**   OUTPUT PF/ACCEXAO RECORD.                                      S01119
     C*                                                                   S01119
     C                     EXCPTACCEX                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C**   ACCUMULATE NUMBER AND VALUE OF EXTRACT RECORDS WRITTEN.        S01119
     C*                                                                   S01119
     C                     ADD  1         RECRIT                          S01119
     C                     MOVE UPAMT     ZZAMT                           S01119
     C                     Z-ADD1         X                               S01119
     C                     EXSR HASH                                      S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C********************************************************************S01119
     C*                                                                   S01119
     C**   SRRX SR. CROSS CCY INTEREST RATE SWAP PROCESSING (DLP0500-II)  S01119
     C*                                                                   S01119
     C           SRRX      BEGSR                           *** SRRX ***   S01119
     C*                                                                   S01119
     C**   CLEAR/SET FIELDS FOR PROCESSING & OUTPUT OF OUR DETAILS.       S01119
     C*                                                                   S01119
     C                     MOVE 0         *IN30                           S01119
     C/COPY WNCPYSRC,DL0500C002
     C*                                                                   S01119
     C                     MOVE UCUCY     CCY                             S01119
     C                     Z-ADDUSLIP     ACFD                            S01119
     C                     Z-ADD0         ACTD                            S01119
     C                     Z-ADD0         NOTD                            S01119
     C                     Z-ADDUEINR     INTR                            S01119
     C                     Z-ADD0         AMAD                            S01119
     C                     Z-ADD0         AMTA                            S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       UDNSI          30 RATE SET      S01119
     C/COPY WNCPYSRC,DL0500C018
     C           *IN30     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       URTPI                           S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       URTPI                           S01119
     C                     END                                            S01119
     C                     ELSE                                           S01119
     C                     MOVE 'Y'       URTPI                           S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0500C024
     C                     MOVE 'N'       TRTPI                           S01119
     C                     Z-ADD0         TACFD                           S01119
     C                     Z-ADD0         TACTD                           S01119
     C                     Z-ADD0         TAMAD                           S01119
     C                     Z-ADD0         TAMTA                           S01119
     C                     MOVE 'N'       FLRIND                          S01119
     C*                                                                   S01119
     C**********           Z-ADDTBRTT     SVBRTT  20                                   S01119 CSD103
     C                     MOVE TBRTT     SVBRTT  2                                           CSD103
     C                     Z-ADDTEINR     SVEINR 117                      S01119
     C**********           Z-ADD0         TBRTT                                        S01119 CSD103
     C                     MOVE *BLANKS   TBRTT                                               CSD103
     C                     Z-ADD0         TEINR                           S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   SET ACCRUAL TO DATE TO EARLIEST DATE PRESENT.                  S01119
     C*                                                                   S01119
     C           UNIPD     IFNE 0                                         S01119
     C                     Z-ADDUNIPD     ACTD                            S01119
     C                     ELSE                                           S01119
     C           UNICD     IFNE 0                                         S01119
     C                     Z-ADDUNICD     ACTD                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDMDAT      ACTD                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                   CIR005
      ** Use Interest Payment Base Date instead of Next Interest          CIR005
      **  Payment Date if Business Day Enhancement is on                  CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A '                                      CIR005
     C           CIR001    IFEQ 'N'                                       CIR005
     C           CIR001    OREQ 'Y'                                       CIR005
     C           UIPFR     ANDNE'Z'                                       CIR005
     C           UIPBD     IFNE 0                                         CIR005
     C                     Z-ADDUIPBD     ACTD                            CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C           UNICD     IFNE 0                                         S01119
     C           UNICD     ANDLTACTD                                      S01119
     C                     Z-ADDUNICD     ACTD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**   SELECT OUR DETAILS FOR ACCRUAL ONLY IF RATE PRESENT.           S01119
     C*                                                                   S01119
     C           URTPI     IFEQ 'Y'                                       S01119
     C*                                                                   S01119
     C**   SET DETAILS TO CALCULATE INTEREST ACCRUED TO DATE.             S01119
     C*                                                                   S01119
     C           UIPFR     IFEQ 'C'                                                           221626
     C           CIR001    ANDEQ'Y'                                                           221626
     C                     Z-ADDUSLIP     ZIBEG                                               221626
     C                     ELSE                                                               221626
     C                     Z-ADDUIACD     ZIBEG                           S01119
     C                     ENDIF                                                              221626
     C           ACTD      IFLE REPCD                                     S01119
     C                     Z-ADDACTD      ZIEND                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDREPCD     ZIEND                           S01119
     C                     END                                            S01119
     C                     Z-ADDUICBS     ZICALC                          S01119
     C                     Z-ADDUPAMT     ZIAMT                           S01119
     C                     Z-ADDUEINR     ZIRATE                          S01119
     C                     Z-ADD0         ZINTR                           S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP30                                           S01408
     C*                                                                   CIR001
     C** If interest is up-front, use SR/UFACC to calculate accrual       CIR001
     C*                                                                   CIR001
     C           UINPM     IFEQ 'Y'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C           UINPM     OREQ 'D'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C*                                                                   CIR001
     C                     Z-ADDUIPRD     SZIPRD                          CIR001
     C                     Z-ADDUAIAN     SZAIAN                          CIR001
     C                     Z-ADDUAIAP     SZAIAP                          CIR001
     C                     Z-ADDUAITC     SZAITC                          CIR001
     C                     Z-ADDUSLIP     SZSLID                          CIR001
     C                     Z-ADDACTD      SZACTD                          CIR001
     C                     MOVE UINPM     SZINPM                          CIR001
     C                     EXSR UFACC                                     CIR001
     C                     Z-ADDSZAMAD    AMAD                            CIR001
     C                     Z-ADDSZAMTA    AMTA                            CIR001
     C*                                                                   CIR001
     C                     ELSE                                           CIR001
     C*                                                                   S01119
     C**   CALCULATE INTEREST ACCRUED TO DATE IF DEAL STARTED ACCRUING.   S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0500CP31                                           S01408
      *                                                                   S01408
     C**  If cash flow swap, obtain cash flow schedule                    CIR001
     C*                                                                   CIR001
     C           UIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     MOVE 'U'       OTIN                            CIR001
     C                     Z-ADDACTD      PRDT                            CIR001
     C           KCFSC     CHAINDLCFSCPD             99                   CIR001
     C      99             Z-ADD*ZERO     CFLA                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           USLIP     IFLE REPCD                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP32                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C** If a cash flow schedule has been specified, use SR/CFACC         CIR001
     C** to calculate the cash flow accrual.                              CIR001
     C** Otherwise, use SR/GLINTC.                                        CIR001
     C*                                                                   CIR001
     C           UIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     Z-ADDUSLIP     SZSLID                          CIR001
     C                     Z-ADDACTD      SZACTD                          CIR001
     C                     Z-ADDUICBS     ZICALC                                              222381
     C                     EXSR CFACC                                     CIR001
     C                     Z-ADDWKINT     ZINTR                           CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0500C060
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR ZSAVE                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP81                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP82                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP18                                           S01408
      *                                                                   S01408
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     ELSE                                           E19857
     C                     Z-ADDUSLIP     ZIEND                           E19857
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0500C030
     C                     Z-ADDZINTR     WINTR                                               209405
     C           ZINTR     ADD  UAIAN     AMAD      H                     S01119
     C                     ADD  UAIAP     AMAD                            S01119
     C                     ADD  UAITC     AMAD                            S01119
     C                     SUB  UIPRD     AMAD                            S01119
     C/COPY WNCPYSRC,DL0500C031
     C*                                                                   S01119
     C**   CALCULATE INTEREST TO ACCRUE.                                  S01119
     C*                                                                   S01119
     C**********           Z-ADDZIEND     ZIBEG                                       S01119 209405
     C                     Z-ADDACTD      ZIEND                           S01119
     C                     Z-ADD0         ZINTR                           S01119
     C           ACTD      IFGE REPCD                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP33                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C** If a cash flow schedule has been specified, use SR/CFACC to      CIR001
     C** calculate the cash flow accrual.                                 CIR001
     C** Otherwise, use SR/GLINTC.                                        CIR001
     C*                                                                   CIR001
     C           UIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     Z-ADDUSLIP     ZIBEG                           CIR001
     C                     Z-ADDREPCD     ZIEND                           CIR001
     C           USLIP     IFGT REPCD                                     CIR001
     C                     Z-ADDUSLIP     ZIEND                           CIR001
     C                     END                                            CIR001
     C                     Z-ADDUSLIP     SZSLID                          CIR001
     C                     Z-ADDACTD      SZACTD                          CIR001
     C                     Z-ADDUICBS     ZICALC                                              222381
     C                     EXSR CFACC                                     CIR001
     C           CFLA      SUB  WKINT     AMTA                            CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C061
     C                     Z-ADDUPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR ZSAVE                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C106                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C107                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C**********           Z-ADDZINTR     AMTA      H                                  S01119 209405
     C           ZINTR     SUB  WINTR     AMTA      H                                         209405
      *                                                                                       CIR014
      ** If CIR014 is on, recompute the Calculated Interest Amt                               CIR014
      *                                                                                       CIR014
     C           CIR014    IFEQ 'Y'                                                           CIR014
      *                                                                                       CIR014
      ** If there is a revaluation rate defined for the deal,                                 CIR014
      ** add the Principal Change Amt to the Calculated Interest Amt                          CIR014
      *                                                                                       CIR014
     C                     MOVELDLNO      WDLNO   6                                           CIR014
     C           WDLNO     CHAINDLDLDGD0             74                                       CIR014
      *                                                                                       CIR014
     C           *IN74     IFEQ *OFF                                                          CIR014
     C           F1PRVI    ANDEQ'O'                                                           CIR014
     C           F1LRRC    ANDGTUSLIP                                                         CIR014
     C           USLIP     ANDLTMDAT                                                          CIR014
     C           F1LRVR    ANDNE*ZERO                                                         CIR014
     C                     ADD  F1PCHA    AMTA                                                CIR014
     C                     ENDIF                                                              CIR014
     C                     ENDIF                                                              CIR014
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP19                                           S01408
      *                                                                   S01408
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     END                                            S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP20                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C**   REVERSE ACCRUAL AMOUNTS AS BEING PAID.                         S01119
     C*                                                                   S01119
     C                     Z-SUBAMAD      AMAD                            S01119
     C                     Z-SUBAMTA      AMTA                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP34                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set-up new fields, our total unsettled interest and              CIR002
     C** their total unsettled interest.                                  CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C062
     C                     Z-ADD0         OTUI                            CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C           OUSI      ADD  OUSA      OTUI                            CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C                     Z-ADD0         TTUI                            CIR002
     C                     END                                            CIR002
     C*                                                                   S01119
     C*                                                                   S01119
     C**   OUTPUT PF/ACCEXAO RECORD FOR OUR DETAILS.                      S01119
     C*                                                                   S01119
     C                     EXCPTACCEX                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C**   ACCUMULATE NUMBER AND VALUE OF EXTRACT RECORDS WRITTEN.        S01119
     C*                                                                   S01119
     C                     ADD  1         RECRIT                          S01119
     C                     MOVE UPAMT     ZZAMT                           S01119
     C                     Z-ADD1         X                               S01119
     C                     EXSR HASH                                      S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   CLEAR/SET FIELDS FOR PROCESSING & OUTPUT OF THEIR DETAILS.     S01119
     C*                                                                   S01119
     C                     MOVE '0'       *IN30                           S01119
     C*                                                                   S01119
     C**********           Z-ADDSVBRTT    TBRTT                                        S01119 CSD103
     C                     MOVE SVBRTT    TBRTT                                               CSD103
     C                     Z-ADDSVEINR    TEINR                           S01119
     C*                                                                   S01119
     C                     MOVE TCUCY     CCY                             S01119
     C                     Z-ADDTPAMT     PCPL                            S01119
     C                     Z-ADD0         ACFD                            S01119
     C                     Z-ADD0         ACTD                            S01119
     C                     Z-ADD0         NOTD                            S01119
     C                     Z-ADD0         INTR                            S01119
     C                     Z-ADD0         AMAD                            S01119
     C                     Z-ADD0         AMTA                            S01119
     C**********           Z-ADD0         UBRTT                                        S01119 CSD103
     C                     MOVE *BLANKS   UBRTT                                               CSD103
     C                     MOVE 'N'       URTPI                           S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       TDNSI          30 RATE SET      S01119
     C/COPY WNCPYSRC,DL0500C019
     C           *IN30     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       TRTPI                           S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       TRTPI                           S01119
     C                     END                                            S01119
     C                     ELSE                                           S01119
     C                     MOVE 'Y'       TRTPI                           S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0500C025
     C                     Z-ADDTSLIP     TACFD                           S01119
     C                     Z-ADD0         TACTD                           S01119
     C                     Z-ADD0         TAMAD                           S01119
     C                     Z-ADD0         TAMTA                           S01119
     C                     MOVE 'N'       FLRIND                          S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   SET ACCRUAL TO DATE TO EARLIEST DATE PRESENT.                  S01119
     C*                                                                   S01119
     C           TNIPD     IFNE 0                                         S01119
     C                     Z-ADDTNIPD     TACTD                           S01119
     C                     ELSE                                           S01119
     C           TNICD     IFNE 0                                         S01119
     C                     Z-ADDTNICD     TACTD                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDMDAT      TACTD                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                   CIR005
      ** Use Interest Payment Base Date instead of Next Interest          CIR005
      **  Payment Date if Business Day Enhancement is on                  CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L2AMCN    ANDEQ'A '                                      CIR005
     C           CIR001    IFEQ 'N'                                       CIR005
     C           CIR001    OREQ 'Y'                                       CIR005
     C           TIPFR     ANDNE'Z'                                       CIR005
     C           TIPBD     IFNE 0                                         CIR005
     C                     Z-ADDTIPBD     TACTD                           CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C           TNICD     IFNE 0                                         S01119
     C           TNICD     ANDLTTACTD                                     S01119
     C                     Z-ADDTNICD     TACTD                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**   SELECT THEIR DETAILS FOR ACCRUAL ONLY IF RATE PRESENT.         S01119
     C*                                                                   S01119
     C           TRTPI     IFEQ 'Y'                                       S01119
     C*                                                                   S01119
     C**   SET DETAILS TO CALCULATE INTEREST ACCRUED TO DATE.             S01119
     C*                                                                   S01119
     C           TIPFR     IFEQ 'C'                                                           221626
     C           CIR001    ANDEQ'Y'                                                           221626
     C                     Z-ADDTSLIP     ZIBEG                                               221626
     C                     ELSE                                                               221626
     C                     Z-ADDTIACD     ZIBEG                           S01119
     C                     ENDIF                                                              221626
     C           TACTD     IFLE REPCD                                     S01119
     C                     Z-ADDTACTD     ZIEND                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDREPCD     ZIEND                           S01119
     C                     END                                            S01119
     C                     Z-ADDTICBS     ZICALC                          S01119
     C                     Z-ADDTPAMT     ZIAMT                           S01119
     C                     Z-ADDTEINR     ZIRATE                          S01119
     C                     Z-ADD0         ZINTR                           S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP35                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C** If interest is up-front, use SR/UFACC to calculate accrual       CIR001
     C*                                                                   CIR001
     C           TINPM     IFEQ 'Y'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C           TINPM     OREQ 'D'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C*                                                                   CIR001
     C                     Z-ADDTIPRD     SZIPRD                          CIR001
     C                     Z-ADDTAIAN     SZAIAN                          CIR001
     C                     Z-ADDTAIAP     SZAIAP                          CIR001
     C                     Z-ADDTAITC     SZAITC                          CIR001
     C                     Z-ADDTSLIP     SZSLID                          CIR001
     C                     Z-ADDTACTD     SZACTD                          CIR001
     C                     MOVE TINPM     SZINPM                          CIR001
     C                     EXSR UFACC                                     CIR001
     C                     Z-ADDSZAMAD    TAMAD                           CIR001
     C                     Z-ADDSZAMTA    TAMTA                           CIR001
     C*                                                                   CIR001
     C                     ELSE                                           CIR001
     C*                                                                   S01119
     C**   CALCULATE INTEREST ACCRUED TO DATE.                            S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0500CP36                                           S01408
      *                                                                   S01408
     C**  If cash flow swap, obtain cash flow schedule                    CIR001
     C*                                                                   CIR001
     C           TIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     MOVE 'T'       OTIN                            CIR001
     C                     Z-ADDTACTD     PRDT                            CIR001
     C           KCFSC     CHAINDLCFSCPD             99                   CIR001
     C      99             Z-ADD*ZERO     CFLA                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           TSLIP     IFLE REPCD                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP37                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C** If a cash flow schedule has been specified, use SR/CFACC         CIR001
     C** to calculate the cash flow accrual.                              CIR001
     C** Otherwise, use SR/GLINTC.                                        CIR001
     C*                                                                   CIR001
     C           TIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     Z-ADDTSLIP     SZSLID                          CIR001
     C                     Z-ADDTACTD     SZACTD                          CIR001
     C                     Z-ADDTICBS     ZICALC                                              222381
     C                     EXSR CFACC                                     CIR001
     C                     Z-ADDWKINT     ZINTR                           CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0500C063
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR ZSAVE                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP83                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP84                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP21                                           S01408
      *                                                                   S01408
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     ELSE                                           E19857
     C                     Z-ADDTSLIP     ZIEND                           E19857
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0500C032
     C                     Z-ADDZINTR     WINTR                                               209405
     C           ZINTR     ADD  TAIAN     TAMAD     H                     S01119
     C                     ADD  TAIAP     TAMAD                           S01119
     C                     ADD  TAITC     TAMAD                           S01119
     C                     SUB  TIPRD     TAMAD                           S01119
     C/COPY WNCPYSRC,DL0500C033
     C*                                                                   S01119
     C**   CALCULATE INTEREST TO ACCRUE.                                  S01119
     C*                                                                   S01119
     C**********           Z-ADDZIEND     ZIBEG                                        S01119 209405
     C                     Z-ADDTACTD     ZIEND                           S01119
     C                     Z-ADD0         ZINTR                           S01119
     C           TACTD     IFGE REPCD                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP38                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C** If a cash flow schedule has been specified, use SR/CFACC to      CIR001
     C** calculate the cash flow accrual.                                 CIR001
     C** Otherwise, use SR/GLINTC.                                        CIR001
     C*                                                                   CIR001
     C           TIPFR     IFEQ 'C'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C                     Z-ADDTSLIP     ZIBEG                           CIR001
     C                     Z-ADDREPCD     ZIEND                           CIR001
     C           TSLIP     IFGT REPCD                                     CIR001
     C                     Z-ADDTSLIP     ZIEND                           CIR001
     C                     END                                            CIR001
     C                     Z-ADDTSLIP     SZSLID                          CIR001
     C                     Z-ADDTACTD     SZACTD                          CIR001
     C                     Z-ADDTICBS     ZICALC                                              222381
     C                     EXSR CFACC                                     CIR001
     C           CFLA      SUB  WKINT     TAMTA                           CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C064
     C                     Z-ADDTPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR ZSAVE                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C108                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C109                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C**********           Z-ADDZINTR     TAMTA     H                                  S01119 209405
     C           ZINTR     SUB  WINTR     TAMTA     H                                         209405
      *                                                                                       CIR014
      ** If CIR014 is on, recompute the Calculated Interest Amt                               CIR014
      *                                                                                       CIR014
     C           CIR014    IFEQ 'Y'                                                           CIR014
      *                                                                                       CIR014
      ** If there is a revaluation rate defined for the deal,                                 CIR014
      ** add the Principal Change Amt to the Calculated Interest Amt                          CIR014
      *                                                                                       CIR014
     C                     MOVELDLNO      WDLNO   6                                           CIR014
     C           WDLNO     CHAINDLDLDGD0             74                                       CIR014
      *                                                                                       CIR014
     C           *IN74     IFEQ *OFF                                                          CIR014
     C           F1PRVI    ANDEQ'T'                                                           CIR014
     C           F1LRRC    ANDGTTSLIP                                                         CIR014
     C           TSLIP     ANDLTMDAT                                                          CIR014
     C           F1LRVR    ANDNE*ZERO                                                         CIR014
     C                     ADD  F1PCHA    TAMTA                                               CIR014
     C                     ENDIF                                                              CIR014
     C                     ENDIF                                                              CIR014
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP22                                           S01408
      *                                                                   S01408
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     END                                            S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP23                                           S01408
     C*                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C                     END                                            S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP39                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set-up new fields, our total unsettled interest and              CIR002
     C** their total unsettled interest.                                  CIR002
      ** Do this processing also for Their Interest Processing Method     CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C065
     C                     Z-ADD0         OTUI                            CIR002
     C                     Z-ADD0         TTUI                            CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C           TUSI      ADD  TUSA      TTUI                            CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C                     END                                            CIR002
     C*                                                                   S01119
     C*                                                                   S01119
     C**   OUTPUT PF/ACCEXAO RECORD FOR THEIR DETAILS.                    S01119
     C*                                                                   S01119
     C                     EXCPTACCEX                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C**   ACCUMULATE NUMBER AND VALUE OF EXTRACT RECORDS WRITTEN.        S01119
     C*                                                                   S01119
     C                     ADD  1         RECRIT                          S01119
     C                     MOVE TPAMT     ZZAMT                           S01119
     C                     Z-ADD1         X                               S01119
     C                     EXSR HASH                                      S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C********************************************************************S01119
     C*                                                                   S01119
     C**   SRRLNA SR. INTEREST RATE CAP/COLLAR (NON-AVERAGE RATE)         S01119
     C**              PROCESSING (DLP0500-JJ)                             S01119
     C*                                                                   S01119
     C           SRRLNA    BEGSR                           *** SRRLNA *** S01119
     C*                                                                   S01119
     C**   CLEAR/SET FIELDS FOR PROCESSING & OUTPUT.                      S01119
     C*                                                                   S01119
     C                     MOVE 0         *IN30                           S01119
     C/COPY WNCPYSRC,DL0500C003
     C                     MOVE 0         *IN31                           S01119
     C                     MOVE 0         *IN34                           S01119
     C                     Z-ADD0         WACTD   50                      S01119
     C                     Z-ADD0         WSLIP   50                      S01119
     C                     Z-ADD0         WUAMAD 130                      S01119
     C                     Z-ADD0         WTAMAD 130                      S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0500C040
     C                     MOVE UCUCY     CCY                             S01119
     C                     Z-ADDUSLIP     ACFD                            S01119
     C                     Z-ADD0         ACTD                            S01119
     C                     Z-ADD0         NOTD                            S01119
     C                     Z-ADD0         INTR                            S01119
     C                     Z-ADD0         AMAD                            S01119
     C                     Z-ADD0         AMTA                            S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       UDNSI          30 RATE SET      S01119
     C                     TESTB'4'       UDSTI          34 FLOOR ENTERED S01119
     C/COPY WNCPYSRC,DL0500C020
     C           *IN30     IFEQ '1'                                       S01119
     C                     Z-ADDUEINR     INTR                         ED S01119
     C                     MOVE 'Y'       URTPI                           S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       URTPI                           S01119
     C                     END                                            S01119
     C                     MOVE 'N'       TRTPI                           S01119
     C                     ELSE                                           S01119
     C                     TESTB'0'       TDNSI          30 RATE SET      S01119
     C                     TESTB'4'       TDSTI          34 FLOOR ENTERED S01119
     C/COPY WNCPYSRC,DL0500C021
     C           *IN30     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       TRTPI                           S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       TRTPI                           S01119
     C                     END                                            S01119
     C                     MOVE 'N'       URTPI                           S01119
     C                     END                                            S01119
     C                     Z-ADDTSLIP     TACFD                           S01119
     C                     Z-ADD0         TACTD                           S01119
     C                     Z-ADD0         TAMAD                           S01119
     C                     Z-ADD0         TAMTA                           S01119
     C           *IN34     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       FLRIND                          S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       FLRIND                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   USE PROVIDERS DETAILS.                                         S01119
     C*                                                                   S01119
     C**   PROVIDER'S DETAILS ARE OURS.                                   S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C**   SET ACCRUAL TO DATE TO EARLIEST DATE PRESENT.                  S01119
     C*                                                                   S01119
     C           UNIPD     IFNE 0                                         S01119
     C                     Z-ADDUNIPD     ACTD                            S01119
     C                     ELSE                                           S01119
     C           UNICD     IFNE 0                                         S01119
     C                     Z-ADDUNICD     ACTD                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDMDAT      ACTD                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                   CIR005
      ** Use Interest Payment Base Date instead of Next Interest          CIR005
      **  Payment Date if Business Day Enhancement is on                  CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A '                                      CIR005
     C           UIPBD     ANDNE0                                         CIR005
     C                     Z-ADDUIPBD     ACTD                            CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C           UNICD     IFNE 0                                         S01119
     C           UNICD     ANDLTACTD                                      S01119
     C                     Z-ADDUNICD     ACTD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDACTD      WACTD                           S01119
     C                     Z-ADDUSLIP     WSLIP                           S01119
     C                     Z-ADDUIACD     WIACD   50                      S01119
     C*                                                                   S01119
     C                     TESTB'1'       UDSTI          31 NEG. INT.     S01119
     C/COPY WNCPYSRC,DL0500C004
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   PROVIDER'S DETAILS ARE THEIRS.                                 S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C**   SET ACCRUAL TO DATE TO EARLIEST DATE PRESENT.                  S01119
     C*                                                                   S01119
     C           TNIPD     IFNE 0                                         S01119
     C                     Z-ADDTNIPD     TACTD                           S01119
     C                     ELSE                                           S01119
     C           TNICD     IFNE 0                                         S01119
     C                     Z-ADDTNICD     TACTD                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDMDAT      TACTD                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                   CIR005
      ** Use Interest Payment Base Date instead of Next Interest          CIR005
      **  Payment Date if Business Day Enhancement is on                  CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A '                                      CIR005
     C           TIPBD     ANDNE0                                         CIR005
     C                     Z-ADDTIPBD     TACTD                           CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C           TNICD     IFNE 0                                         S01119
     C           TNICD     ANDLTTACTD                                     S01119
     C                     Z-ADDTNICD     TACTD                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDTACTD     WACTD                           S01119
     C                     Z-ADDTSLIP     WSLIP                           S01119
     C                     Z-ADDTIACD     WIACD                           S01119
     C*                                                                   S01119
     C                     TESTB'1'       TDSTI          31 NEG. INT.     S01119
     C/COPY WNCPYSRC,DL0500C005
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   /////////////////////////////////////////////////////          S01119
     C**   USING OUR DETAILS CALCULATE INTEREST ACCRUAL AMOUNTS.          S01119
     C*                                                                   S01119
     C**   ACCRUED INTEREST TO DATE.                                      S01119
     C*                                                                   S01119
     C                     Z-ADDUICBS     ZICALC                          S01119
     C                     Z-ADDUPAMT     ZIAMT                           S01119
     C                     Z-ADDWIACD     ZIBEG                           S01119
     C           WACTD     IFLE REPCD                                     S01119
     C                     Z-ADDWACTD     ZIEND                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDREPCD     ZIEND                           S01119
     C                     END                                            S01119
     C                     Z-ADD0         ZINTR                           S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                          PROVIDER                    S01119 CSD103
     C           UBRTT     IFNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           UEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** UBRTT     OREQ 0                          TAKER                       S01119 CSD103
     C           UBRTT     OREQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           TEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           TEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     END                                            S01119
     C           WSLIP     IFLE REPCD                                     S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP40                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing              CIR006
      ** Method 'A', 'I' or 'L' when CIR006 is installed.                 CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0500C066
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0500C006
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP87                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     WUAMAD    H                     S01119
     C                     ELSE                                           E19857
     C                     Z-ADDWSLIP     ZIEND                           E19857
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           *IN34     IFEQ '1'                        FLOOR ENTERED  S01119
     C*                                                                   S01119
     C********** UBRTT     IFEQ 0                          TAKER                       S01119 CSD103
     C           UBRTT     IFEQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTTEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** UBRTT     ORNE 0                          PROVIDER                    S01119 CSD103
     C           UBRTT     ORNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTUEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           FLRAT     SUB  UEINR     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           FLRAT     SUB  TEINR     ZIRATE                          S01119
     C                     END                                            S01119
     C           WSLIP     IFLE REPCD                                     S01119
     C                     EXSR ZSAVE                                     S01119
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C067
     C                     Z-ADDUPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0500CP88                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP89                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     WUAMAD    H                     S01119
     C                     ELSE                                           E19857
     C                     Z-ADDWSLIP     ZIEND                           E19857
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   INTEREST TO ACCRUE.                                            S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0500C038
     C                     Z-ADDZIEND     ZIBEG                           S01119
     C                     Z-ADDWACTD     ZIEND                           S01119
     C                     Z-ADD0         ZINTR                           S01119
     C/COPY WNCPYSRC,DL0500C007
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           WACTD     IFGE REPCD                                     S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                          PROVIDER                    S01119 CSD103
     C           UBRTT     IFNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           UEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** UBRTT     OREQ 0                          TAKER                       S01119 CSD103
     C           UBRTT     OREQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           TEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           TEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     END                                            S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP41                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing              CIR006
      ** Method 'A', 'I' or 'L' when CIR006 is installed.                 CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C068
     C                     Z-ADDUPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0500C008
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP90                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     AMTA      H                     S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           *IN34     IFEQ '1'                        FLOOR ENTERED  S01119
     C*                                                                   S01119
     C********** UBRTT     IFEQ 0                          TAKER                       S01119 CSD103
     C           UBRTT     IFEQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTTEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** UBRTT     ORNE 0                          PROVIDER                    S01119 CSD103
     C           UBRTT     ORNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTUEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           FLRAT     SUB  UEINR     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           FLRAT     SUB  TEINR     ZIRATE                          S01119
     C                     END                                            S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP42                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C069
     C                     Z-ADDUPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0500C009
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP91                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     AMTA      H                     S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   ///////////////////////////////////////////////////////        S01119
     C**   USING THEIR DETAILS CALCULATE INTEREST ACCRUAL AMOUNTS.        S01119
     C*                                                                   S01119
     C**   ACCRUED INTEREST TO DATE.                                      S01119
     C*                                                                   S01119
     C                     Z-ADDTICBS     ZICALC                          S01119
     C                     Z-ADDTPAMT     ZIAMT                           S01119
     C                     Z-ADDWIACD     ZIBEG                           S01119
     C           WACTD     IFLE REPCD                                     S01119
     C                     Z-ADDWACTD     ZIEND                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDREPCD     ZIEND                           S01119
     C                     END                                            S01119
     C                     Z-ADD0         ZINTR                           S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                          PROVIDER                    S01119 CSD103
     C           TBRTT     IFNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           TEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** TBRTT     OREQ 0                          TAKER                       S01119 CSD103
     C           TBRTT     OREQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           UEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           TEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           UEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     END                                            S01119
     C           WSLIP     IFLE REPCD                                     S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP46                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0500C070
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C/COPY WNCPYSRC,DL0500C010
     C*                                                                   CIR002
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP92                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     WTAMAD    H                     S01119
     C                     ELSE                                           E19857
     C                     Z-ADDWSLIP     ZIEND                           E19857
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           *IN34     IFEQ '1'                        FLOOR ENTERED  S01119
     C*                                                                   S01119
     C********** TBRTT     IFEQ 0                          TAKER                       S01119 CSD103
     C           TBRTT     IFEQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTUEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** TBRTT     ORNE 0                          PROVIDER                    S01119 CSD103
     C           TBRTT     ORNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTTEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           FLRAT     SUB  TEINR     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           FLRAT     SUB  UEINR     ZIRATE                          S01119
     C                     END                                            S01119
     C           WSLIP     IFLE REPCD                                     S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP47                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C071
     C                     Z-ADDTPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0500C011
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP93                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     WTAMAD    H                     S01119
     C                     ELSE                                           E19857
     C                     Z-ADDWSLIP     ZIEND                           E19857
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   INTEREST TO ACCRUE.                                            S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0500C039
     C                     Z-ADDZIEND     ZIBEG                           S01119
     C********** UBRTT     IFNE 0                          PROVIDER                    S01119 CSD103
     C           UBRTT     IFNE *BLANKS                    PROVIDER                           CSD103
     C                     Z-ADDACTD      ZIEND                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTACTD     ZIEND                           S01119
     C                     END                                            S01119
     C                     Z-ADD0         ZINTR                           S01119
     C/COPY WNCPYSRC,DL0500C012
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           WACTD     IFGE REPCD                                     S01119
     C*                                                                   S01119
     C           TEINR     IFGT CLRAT                      OVER CEILING   S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                          PROVIDER                    S01119 CSD103
     C           TBRTT     IFNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           TEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** TBRTT     OREQ 0                          TAKER                       S01119 CSD103
     C           TBRTT     OREQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           UEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           TEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           UEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     END                                            S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP48                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C072
     C                     Z-ADDTPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C/COPY WNCPYSRC,DL0500C013
     C*                                                                   CIR002
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP94                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     TAMTA     H                     S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           *IN34     IFEQ '1'                        FLOOR ENTERED  S01119
     C*                                                                   S01119
     C********** TBRTT     IFEQ 0                          TAKER                       S01119 CSD103
     C           TBRTT     IFEQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTUEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** TBRTT     ORNE 0                          PROVIDER                    S01119 CSD103
     C           TBRTT     ORNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTTEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           FLRAT     SUB  TEINR     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           FLRAT     SUB  UEINR     ZIRATE                          S01119
     C                     END                                            S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP49                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C073
     C                     Z-ADDTPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0500C014
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP95                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     TAMTA     H                     S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   ACCUMULATE ACCRUED INTEREST TO DATE.                           S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0500C034
     C           WUAMAD    ADD  UAIAN     AMAD             OURS           S01119
     C                     ADD  UAITC     AMAD                            S01119
     C                     ADD  UAIAP     AMAD                            S01119
     C                     SUB  UIPRD     AMAD                            S01119
     C*                                                                   S01119
     C           WTAMAD    ADD  TAIAN     TAMAD            THEIRS         S01119
     C                     ADD  TAITC     TAMAD                           S01119
     C                     ADD  TAIAP     TAMAD                           S01119
     C                     SUB  TIPRD     TAMAD                           S01119
     C/COPY WNCPYSRC,DL0500C035
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           TAMAD     SUB  AMAD      AMAD             NET            S01119
     C                     Z-ADD0         TAMAD                           S01119
     C           TAMTA     SUB  AMTA      AMTA             NET            S01119
     C                     Z-ADD0         TAMTA                           S01119
     C                     ELSE                                           S01119
     C           TAMAD     SUB  AMAD      TAMAD            NET            S01119
     C                     Z-ADD0         AMAD                            S01119
     C           TAMTA     SUB  AMTA      TAMTA            NET            S01119
     C                     Z-ADD0         AMTA                            S01119
     C                     END                                            S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP53                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set-up new fields, our total unsettled interest and              CIR002
     C** their total unsettled interest.                                  CIR002
      ** Do this processing also for Our/Their Interest Processing        CIR006
      ** Method 'A', 'I' or 'L' when CIR006 is installed.                 CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C074
     C                     Z-ADD0         OTUI                            CIR006
     C                     Z-ADD0         TTUI                            CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C           OUSI      ADD  OUSA      OTUI                            CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C           TUSI      ADD  TUSA      TTUI                            CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C                     END                                            CIR002
     C*                                                                   S01119
     C*                                                                   S01119
     C**   OUTPUT PF/ACCEXAO RECORD.                                      S01119
     C*                                                                   S01119
     C                     EXCPTACCEX                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C**   ACCUMULATE NUMBER AND VALUE OF EXTRACT RECORDS WRITTEN.        S01119
     C*                                                                   S01119
     C                     ADD  1         RECRIT                          S01119
     C                     MOVE UPAMT     ZZAMT                           S01119
     C                     Z-ADD1         X                               S01119
     C                     EXSR HASH                                      S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C********************************************************************S01119
     C*                                                                   S01119
     C**   SRRLAV SR. INTEREST RATE CAP/COLLAR (AVERAGE RATE)             S01119
     C**              PROCESSING (DLP0500-JJ)                             S01119
     C*                                                                   S01119
     C           SRRLAV    BEGSR                           *** SRRLAV *** S01119
     C*                                                                   S01119
     C**   CLEAR/SET FIELDS FOR PROCESSING & OUTPUT.                      S01119
     C*                                                                   S01119
     C                     MOVE 0         *IN30                           S01119
     C                     MOVE 0         *IN31                           S01119
     C                     MOVE 0         *IN34                           S01119
     C                     Z-ADD0         WACTD   50                      S01119
     C                     Z-ADD0         WUAMAD 130                      S01119
     C                     Z-ADD0         WTAMAD 130                      S01119
     C*                                                                   S01119
     C                     MOVE UCUCY     CCY                             S01119
     C                     Z-ADDUSLIP     ACFD                            S01119
     C                     Z-ADD0         ACTD                            S01119
     C                     Z-ADD0         NOTD                            S01119
     C                     Z-ADD0         INTR                            S01119
     C                     Z-ADD0         AMAD                            S01119
     C                     Z-ADD0         AMTA                            S01119
     C                     Z-ADD0         TEINR                           S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       UDNSI          30 RATE SET      S01119
     C                     TESTB'4'       UDSTI          34 FLOOR ENTERED S01119
     C           *IN30     IFEQ '1'                                       S01119
     C                     Z-ADDAACRT     INTR                         ED S01119
     C                     Z-ADDAACRT     UEINR                        ED S01119
     C                     MOVE 'Y'       URTPI                           S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       URTPI                           S01119
     C                     END                                            S01119
     C                     MOVE 'N'       TRTPI                           S01119
     C                     ELSE                                           S01119
     C                     TESTB'0'       TDNSI          30 RATE SET      S01119
     C                     TESTB'4'       TDSTI          34 FLOOR ENTERED S01119
     C           *IN30     IFEQ '1'                                       S01119
     C                     Z-ADDAACRT     TEINR                        ED S01119
     C                     MOVE 'Y'       TRTPI                           S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       TRTPI                           S01119
     C                     END                                            S01119
     C                     MOVE 'N'       URTPI                           S01119
     C                     END                                            S01119
     C                     Z-ADDTSLIP     TACFD                           S01119
     C                     Z-ADD0         TACTD                           S01119
     C                     Z-ADD0         TAMAD                           S01119
     C                     Z-ADD0         TAMTA                           S01119
     C           *IN34     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       FLRIND                          S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       FLRIND                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   USE PROVIDERS DETAILS.                                         S01119
     C*                                                                   S01119
     C**   PROVIDER'S DETAILS ARE OURS.                                   S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C**   SET ACCRUAL TO DATE TO EARLIEST DATE PRESENT.                  S01119
     C*                                                                   S01119
     C           UNIPD     IFNE 0                                         S01119
     C                     Z-ADDUNIPD     ACTD                            S01119
     C                     ELSE                                           S01119
     C           UNICD     IFNE 0                                         S01119
     C                     Z-ADDUNICD     ACTD                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDMDAT      ACTD                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                   CIR005
      ** Use Interest Payment Base Date instead of Next Interest          CIR005
      **  Payment Date if Business Day Enhancement is on                  CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A '                                      CIR005
     C           UIPBD     ANDNE0                                         CIR005
     C                     Z-ADDUIPBD     ACTD                            CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C           UNICD     IFNE 0                                         S01119
     C           UNICD     ANDLTACTD                                      S01119
     C                     Z-ADDUNICD     ACTD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDACTD      WACTD                           S01119
     C*                                                                   S01119
     C                     TESTB'1'       UDSTI          31 NEG. INT.     S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   PROVIDER'S DETAILS ARE THEIRS.                                 S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C**   SET ACCRUAL TO DATE TO EARLIEST DATE PRESENT.                  S01119
     C*                                                                   S01119
     C           TNIPD     IFNE 0                                         S01119
     C                     Z-ADDTNIPD     TACTD                           S01119
     C                     ELSE                                           S01119
     C           TNICD     IFNE 0                                         S01119
     C                     Z-ADDTNICD     TACTD                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDMDAT      TACTD                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                   CIR005
      ** Use Interest Payment Base Date instead of Next Interest          CIR005
      **  Payment Date if Business Day Enhancement is on                  CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A '                                      CIR005
     C           TIPBD     ANDNE0                                         CIR005
     C                     Z-ADDTIPBD     TACTD                           CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C           TNICD     IFNE 0                                         S01119
     C           TNICD     ANDLTTACTD                                     S01119
     C                     Z-ADDTNICD     TACTD                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDTACTD     WACTD                           S01119
     C*                                                                   S01119
     C                     TESTB'1'       TDSTI          31 NEG. INT.     S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   /////////////////////////////////////////////////////          S01119
     C**   USING OUR DETAILS CALCULATE INTEREST ACCRUAL AMOUNTS.          S01119
     C*                                                                   S01119
     C**   ACCRUED INTEREST TO DATE.                                      S01119
     C*                                                                   S01119
     C                     Z-ADDUICBS     ZICALC                          S01119
     C                     Z-ADDUPAMT     ZIAMT                           S01119
     C                     Z-ADDSDCAR     ZIBEG                           S01119
     C           WACTD     IFLE REPCD                                     S01119
     C                     Z-ADDWACTD     ZIEND                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDREPCD     ZIEND                           S01119
     C                     END                                            S01119
     C                     Z-ADD0         ZINTR                           S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                          PROVIDER                    S01119 CSD103
     C           UBRTT     IFNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           UEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** UBRTT     OREQ 0                          TAKER                       S01119 CSD103
     C           UBRTT     OREQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           TEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           TEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     END                                            S01119
     C           SDCAR     IFLE REPCD                                     S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP43                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0500C075
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0500CP96                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP97                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     WUAMAD    H                     S01119
     C                     ELSE                                           E19857
     C                     Z-ADDSDCAR     ZIEND                           E19857
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           *IN34     IFEQ '1'                        FLOOR ENTERED  S01119
     C*                                                                   S01119
     C********** UBRTT     IFEQ 0                          TAKER                       S01119 CSD103
     C           UBRTT     IFEQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTTEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** UBRTT     ORNE 0                          PROVIDER                    S01119 CSD103
     C           UBRTT     ORNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTUEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           FLRAT     SUB  UEINR     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           FLRAT     SUB  TEINR     ZIRATE                          S01119
     C                     END                                            S01119
     C           SDCAR     IFLE REPCD                                     S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP43                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C076
     C                     Z-ADDUPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP98                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     WUAMAD    H                     S01119
     C                     ELSE                                           E19857
     C                     Z-ADDSDCAR     ZIEND                           E19857
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   INTEREST TO ACCRUE.                                            S01119
     C*                                                                   S01119
     C                     Z-ADDZIEND     ZIBEG                           S01119
     C                     Z-ADDWACTD     ZIEND                           S01119
     C                     Z-ADD0         ZINTR                           S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           WACTD     IFGE REPCD                                     S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                          PROVIDER                    S01119 CSD103
     C           UBRTT     IFNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           UEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** UBRTT     OREQ 0                          TAKER                       S01119 CSD103
     C           UBRTT     OREQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           TEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           TEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     END                                            S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP44                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C077
     C                     Z-ADDUPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP99                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     AMTA      H                     S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           *IN34     IFEQ '1'                        FLOOR ENTERED  S01119
     C*                                                                   S01119
     C********** UBRTT     IFEQ 0                          TAKER                       S01119 CSD103
     C           UBRTT     IFEQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTTEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** UBRTT     ORNE 0                          PROVIDER                    S01119 CSD103
     C           UBRTT     ORNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTUEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           FLRAT     SUB  UEINR     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           FLRAT     SUB  TEINR     ZIRATE                          S01119
     C                     END                                            S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP45                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + our unsettled interest +         CIR002
     C** our unsettled interest adjustment                                CIR002
      ** Do this processing also for Our Interest Processing Method       CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C078
     C                     Z-ADDUPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     ADD  OUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C100                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     AMTA      H                     S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   ///////////////////////////////////////////////////////        S01119
     C**   USING THEIR DETAILS CALCULATE INTEREST ACCRUAL AMOUNTS.        S01119
     C*                                                                   S01119
     C**   ACCRUED INTEREST TO DATE.                                      S01119
     C*                                                                   S01119
     C                     Z-ADDTICBS     ZICALC                          S01119
     C                     Z-ADDTPAMT     ZIAMT                           S01119
     C                     Z-ADDTIACD     ZIBEG                           S01119
     C           WACTD     IFLE REPCD                                     S01119
     C                     Z-ADDWACTD     ZIEND                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDREPCD     ZIEND                           S01119
     C                     END                                            S01119
     C                     Z-ADD0         ZINTR                           S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                          PROVIDER                    S01119 CSD103
     C           TBRTT     IFNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           TEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** TBRTT     OREQ 0                          TAKER                       S01119 CSD103
     C           TBRTT     OREQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           UEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           TEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           UEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     END                                            S01119
     C           SDCAR     IFLE REPCD                                     S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP51                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0500C079
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C/COPY WNCPYSRC,DL0500C101                                           S01408
     C*                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C102                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     WTAMAD    H                     S01119
     C                     ELSE                                           E19857
     C                     Z-ADDSDCAR     ZIEND                           E19857
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           *IN34     IFEQ '1'                        FLOOR ENTERED  S01119
     C*                                                                   S01119
     C********** TBRTT     IFEQ 0                          TAKER                       S01119 CSD103
     C           TBRTT     IFEQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTUEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** TBRTT     ORNE 0                          PROVIDER                    S01119 CSD103
     C           TBRTT     ORNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTTEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           FLRAT     SUB  TEINR     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           FLRAT     SUB  UEINR     ZIRATE                          S01119
     C                     END                                            S01119
     C           SDCAR     IFLE REPCD                                     S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP50                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C080
     C                     Z-ADDTPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C103                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     WTAMAD    H                     S01119
     C                     ELSE                                           E19857
     C                     Z-ADDSDCAR     ZIEND                           E19857
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   INTEREST TO ACCRUE.                                            S01119
     C*                                                                   S01119
     C                     Z-ADDZIEND     ZIBEG                           S01119
     C                     Z-ADDWACTD     ZIEND                           S01119
     C                     Z-ADD0         ZINTR                           S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           WACTD     IFGE REPCD                                     S01119
     C*                                                                   S01119
     C           TEINR     IFGT CLRAT                      OVER CEILING   S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                          PROVIDER                    S01119 CSD103
     C           TBRTT     IFNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           TEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** TBRTT     OREQ 0                          TAKER                       S01119 CSD103
     C           TBRTT     OREQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           UEINR     ANDGTCLRAT                      OVER CEILING   S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           TEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           UEINR     SUB  CLRAT     ZIRATE                          S01119
     C                     END                                            S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP51                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C081
     C                     Z-ADDTPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C104                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     TAMTA     H                     S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C           *IN34     IFEQ '1'                        FLOOR ENTERED  S01119
     C*                                                                   S01119
     C********** TBRTT     IFEQ 0                          TAKER                       S01119 CSD103
     C           TBRTT     IFEQ *BLANKS                    TAKER                              CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTUEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'0'                        NOT NEG.INT.   S01119
     C*                                                                   S01119
     C********** TBRTT     ORNE 0                          PROVIDER                    S01119 CSD103
     C           TBRTT     ORNE *BLANKS                    PROVIDER                           CSD103
     C           *IN30     ANDEQ'1'                        RATE SET       S01119
     C           FLRAT     ANDGTTEINR                      BELOW FLOOR    S01119
     C           *IN31     ANDEQ'1'                        NEG.INT.       S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           FLRAT     SUB  TEINR     ZIRATE                          S01119
     C                     ELSE                                           S01119
     C           FLRAT     SUB  UEINR     ZIRATE                          S01119
     C                     END                                            S01119
     C                     EXSR ZSAVE                                     S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP52                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set ZIAMT to principal amount + their unsettled interest +       CIR002
     C** their unsettled interest adjustment                              CIR002
      ** Do this processing also for Their Interest Processing            CIR006
      ** 'A', 'I' or 'L' when CIR006 is installed.                        CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C082
     C                     Z-ADDTPAMT     ZIAMT                           CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     ADD  TUSA      ZIAMT                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500C105                                           S01408
     C*                                                                   S01408
     C                     EXSR ZRSTOR                                    S01119
     C                     Z-ADDZINTR     TAMTA     H                     S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   ACCUMULATE ACCRUED INTEREST TO DATE.                           S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0500C036
     C           WUAMAD    ADD  UAIAN     AMAD             OURS           S01119
     C                     ADD  UAITC     AMAD                            S01119
     C                     ADD  UAIAP     AMAD                            S01119
     C                     SUB  UIPRD     AMAD                            S01119
     C*                                                                   S01119
     C           WTAMAD    ADD  TAIAN     TAMAD            THEIRS         S01119
     C                     ADD  TAITC     TAMAD                           S01119
     C                     ADD  TAIAP     TAMAD                           S01119
     C                     SUB  TIPRD     TAMAD                           S01119
     C/COPY WNCPYSRC,DL0500C037
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           TAMAD     SUB  AMAD      AMAD             NET            S01119
     C                     Z-ADD0         TAMAD                           S01119
     C           TAMTA     SUB  AMTA      AMTA             NET            S01119
     C                     Z-ADD0         TAMTA                           S01119
     C                     ELSE                                           S01119
     C           TAMAD     SUB  AMAD      TAMAD            NET            S01119
     C                     Z-ADD0         AMAD                            S01119
     C           TAMTA     SUB  AMTA      TAMTA            NET            S01119
     C                     Z-ADD0         AMTA                            S01119
     C                     END                                            S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP54                                           S01408
      *                                                                   S01408
     C*                                                                   CIR002
     C** Set-up new fields, our total unsettled interest and              CIR002
     C** their total unsettled interest.                                  CIR002
      ** Do this processing also for Our/Their Interest Processing        CIR006
      ** Method 'A', 'I' or 'L' when CIR006 is installed.                 CIR006
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0500C083
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C           OUSI      ADD  OUSA      OTUI                            CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           CIR002    IFEQ 'Y'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C           TUSI      ADD  TUSA      TTUI                            CIR002
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C                     END                                            CIR002
     C*                                                                   S01119
     C*                                                                   S01119
     C**   OUTPUT PF/ACCEXAO RECORD.                                      S01119
     C*                                                                   S01119
     C                     EXCPTACCEX                                     S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C**   ACCUMULATE NUMBER AND VALUE OF EXTRACT RECORDS WRITTEN.        S01119
     C*                                                                   S01119
     C                     ADD  1         RECRIT                          S01119
     C                     MOVE UPAMT     ZZAMT                           S01119
     C                     Z-ADD1         X                               S01119
     C                     EXSR HASH                                      S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C********************************************************************S01119
     C*                                                                  *S01119
     C*   SR: DLRADS - TO CALCULATE DISCOUNTED SETTLED AMOUNT FOR FRA    *S01119
     C*                                                                  *S01119
     C*   CALLED FROM :- SRFR                                            *S01119
     C*   CALLS       :- ZDATE1, ZDATE2                                  *S01119
     C*                                                                  *S01119
     C********************************************************************S01119
     C*                                                                   S01119
     C           DLRADS    BEGSR                           *** DLRADS *** S01119
     C*                                                                   S01119
     C                     Z-ADDSZVDAT    SZVDAT  50                      S01119
     C                     Z-ADDSZMDAT    SZMDAT  50                      S01119
     C                     Z-ADDSZPPL     SZPPL  130                      S01119
     C                     Z-ADDSZFIX     SZFIX  117                      S01119
     C                     Z-ADDSZFLT     SZFLT  117                      S01119
     C                     Z-ADDSZICB     SZICB   10                      S01119
     C                     Z-ADDSZIANP    SZIANP 130                      S01119
     C                     Z-ADD0         SZICVL  30                      S01119
     C                     Z-ADD0         SZSDAT  50                      S01119
     C                     Z-ADD0         SZEDAT  50                      S01119
     C                     Z-ADD0         SZPER   50                      S01119
     C                     Z-ADD0         SPPER   50                                        MD051152
     C                     Z-ADD0         STYR    20                      S01119
     C                     Z-ADD0         STWRK   40                      S01119
     C                     Z-ADD0         STDAY   20                      S01119
     C                     Z-ADD0         STMTH   20                      S01119
     C                     Z-ADD0         ENDYR   20                      S01119
     C                     Z-ADD0         ENDWRK  40                      S01119
     C                     Z-ADD0         ENDDAY  20                      S01119
     C                     Z-ADD0         ENDMTH  20                      S01119
     C                     Z-ADD0         YEAR1   40                      S01119
     C                     Z-ADD0         STORE   40                      S01119
     C                     Z-ADD0         CHK     10                      S01119
     C                     Z-ADD0         YEAR2   40                      S01119
     C                     Z-ADD0         DAY1    20                      S01119
     C                     Z-ADD0         MTHS    20                      S01119
     C                     Z-ADD0         MTHS2   40                      S01119
     C                     Z-ADD0         SZWRK1 117                      S01119
     C**********           Z-ADD0         SZWRK2 157                S01119043304
     C                     Z-ADD0         SZWRK2 207                S01119043304
     C                     Z-ADD0         SZWRK3  50                      S01119
     C                     Z-ADD0         SZWRK4 147                      S01119
     C                     Z-ADD0         SZWRK5 147                      S01119
     C**********           Z-ADD0         SZWRK6 159               S01119 E35983
     C**********           Z-ADD0         SZWRK6 150                                 E35983 MD058815
     C                     Z-ADD0         SZWRK6 180                                        MD058815
     C                     Z-ADD0         SZWRK7 129                      S01119
     C                     Z-ADD0         SZWRK8 150                      AUS021
     C                     Z-ADD0         SZWRK9 157                      AUS021
     C                     Z-ADD0         SZSETL 150                      S01119
     C                     Z-ADD0         SZRDF  117                      S01119
     C                     Z-ADD0         SZRSA  150                      S01119
     C                     Z-ADD0         SZRDS  130                      S01119
     C                     Z-ADD0         SZDISC 117                      S01119
     C                     Z-ADD0         SZDSA  150                      S01119
     C                     Z-ADD0         DATST   60                      S01119
     C                     Z-ADD0         DATEND  60                      S01119
     C                     Z-ADD0         SLEAP   50                      S01119
     C                     Z-ADD0         ELEAP   50                      S01119
     C                     Z-ADD0         CHK2    10                      S01119
     C                     SETOF                     89                   S01119
     C*                                                                   AUS021
     C**  CHECK IF AUSTRALIA FORMULA REQUIRED                             AUS021
     C*                                                                   AUS021
     C           SETF      IFEQ 'A'                                       AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT USING AUSTRALIAN         AUS021
     C*   FORMULA                                                         AUS021
     C*                                                                   AUS021
     C**  CALCULATE DAYS TO MATURITY                                      AUS021
     C*                                                                   AUS021
     C           SZMDAT    SUB  SZVDAT    SZWRK3                          AUS021
     C*                                                                   AUS021
     C**  MULTIPLY FACE VALUE BY (DAYS IN YEAR x 100)                     AUS021
     C*                                                                   AUS021
     C           SZPPL     MULT 36500     SZSETL                          AUS021
     C*                                                                   AUS021
     C**  CALCULATE PROCEEDS FROM FLOATING RATE                           AUS021
     C*                                                                   AUS021
     C           SZWRK3    MULT SZFLT     SZWRK2                          AUS021
     C                     ADD  36500     SZWRK2                          AUS021
     C           SZWRK2    IFNE *ZEROS                                    AUS021
     C           SZSETL    DIV  SZWRK2    SZRSA     H                     AUS021
     C                     ELSE                                           AUS021
     C                     Z-ADD*ZEROS    SZRSA                           AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C**  CALCULATE PROCEEDS FROM FIXED AMOUNT                            AUS021
     C*                                                                   AUS021
     C           SZWRK3    MULT SZFIX     SZWRK2                          AUS021
     C                     ADD  36500     SZWRK2                          AUS021
     C           SZWRK2    IFNE *ZEROS                                    AUS021
     C           SZSETL    DIV  SZWRK2    SZWRK8    H                     AUS021
     C                     ELSE                                           AUS021
     C                     Z-ADD*ZEROS    SZWRK8                          AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT                          AUS021
     C*                                                                   AUS021
     C           SZRSA     IFGT SZWRK8                                    040318
     C           SZRSA     SUB  SZWRK8    SZRDS                           AUS021
     C                     ELSE                                           040318
     C           SZWRK8    SUB  SZRSA     SZRDS                           040318
     C                     END                                            040318
     C*                                                                   AUS021
     C                     ELSE                                           AUS021
     C*                                                                   AUS021
     C**  CHECK IF U.S.A FORMULA REQUIRED                                 AUS021
     C*                                                                   AUS021
     C           SETF      IFEQ 'U'                                       AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT USING U.S.A FORMULA      AUS021
     C*                                                                   AUS021
     C**  CALCULATE DAYS TO MATURITY                                      AUS021
     C*                                                                   AUS021
     C           SZMDAT    SUB  SZVDAT    SZWRK3                          AUS021
     C*                                                                   AUS021
     C**  MULTIPLY INTEREST SETTLEMENT RATE BY DAYS TO MATURITY           AUS021
     C**  AND ADD (DAYS IN YEAR x 100)                                    AUS021
     C*                                                                   AUS021
     C           SZFLT     MULT SZWRK3    SZWRK9                          AUS021
     C                     ADD  36000     SZWRK9                          AUS021
     C*                                                                   AUS021
     C**  CALCULATE DIFFERENCE in RATES                                   AUS021
     C*                                                                   AUS021
     C           SZFLT     IFGT SZFIX                                     AUS021
     C           SZFLT     SUB  SZFIX     SZWRK1                          AUS021
     C                     ELSE                                           AUS021
     C           SZFIX     SUB  SZFLT     SZWRK1                          AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C**  MULTIPLY DIFFERENCE IN RATES BY DAYS TO MATURITY AND            AUS021
     C**  CONTRACT AMOUNT                                                 AUS021
     C*                                                                   AUS021
     C           SZWRK1    MULT SZWRK3    SZWRK2                          AUS021
     C           SZWRK2    MULT SZPPL     SZWRK2                          AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT                          AUS021
     C*                                                                   AUS021
     C           SZWRK9    IFNE *ZEROS                                    AUS021
     C           SZWRK2    DIV  SZWRK9    SZRDS     H                     AUS021
     C                     ELSE                                           AUS021
     C                     Z-ADD*ZEROS    SZRDS                           AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C                     ELSE                                           AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT USING U.K. FORMULA       AUS021
     C*                                                                   S01119
     C**  DETERMINE VALUE ASSOCIATED WITH INTEREST CALCULATION BASIS      S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 2                                         S01119
     C           SZICB     OREQ 3                                         S01119
     C           SZICB     OREQ 5                                         S01119
     C                     Z-ADD360       SZICVL                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 1                                         S01119
     C           SZICB     OREQ 4                                         S01119
     C                     Z-ADD365       SZICVL                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 6                                         S01119
     C                     Z-ADD366       SZICVL                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET START DATE EQUAL TO VALUE DATE                              S01119
     C*                                                                   S01119
     C                     Z-ADDSZVDAT    SZSDAT                          S01119
     C*                                                                   S01119
     C**  PROCESS UNTIL END DATE IS GREATER THAN MATURITY DATE            S01119
     C*                                                                   S01119
     C           *IN89     DOUEQ'1'                                       S01119
     C*                                                                   S01119
     C**  EXECUTE SUB-ROUTINE ZDATE2                                      S01119
     C*                                                                   S01119
     C                     Z-ADDSZSDAT    ZDAYNO                          S01119
     C*                                                                   S01119
     C                     EXSR ZDATE2                                    S01119
     C*                                                                   S01119
     C**  INCREMENT YEAR BY 1                                             S01119
     C*                                                                   S01119
     C                     ADD  1         ZYEAR                           S01119
     C                     MOVE ZYEAR     ZDATE                           S01119
     C*                                                                   100140
     C* 29th February does not exist in a non-leap year.                  100140
     C*                                                                   100140
     C           ZMTH      IFEQ 02                                        100140
     C           ZDAY      ANDEQ29                                        100140
     C                     Z-ADD28        ZDAY                            100140
     C           *IN98     IFEQ '0'                                       156954
     C                     MOVELZDAY      ZDATE                           100140
     C                     ELSE                                           156954
     C                     MOVE ZDAY      W@MDY   40P                     156954
     C                     MOVELZMTH      W@MDY                           156954
     C                     MOVELW@MDY     ZDATE                           156954
     C                     END                                            156954
     C                     END                                            100140
     C*                                                                   S01119
     C**  EXECUTE SUB-ROUTINE ZDATE1                                      S01119
     C*                                                                   S01119
     C                     EXSR ZDATE1                                    S01119
     C                     Z-ADDZDAYNO    SZEDAT                          S01119
     C*                                                                   031967
     C**  CHECK TO SEE IF MATURITY DATE FALLS BETWEEN PERIOD END DATE     031967
     C** *AND*PERIOD*END*DATE*+*5 *THIS*WILL*ONLY*HAPPEN*IF*AN*FRA**031967060995
     C**  AND PERIOD END DATE + 10 (THIS WILL ONLY HAPPEN IF AN FRA 031967060995
     C**  WAS ENTERED WITH AN INCREASED MATURITY DATE DUE TO THE          031967
     C**  ACTUAL MATURITY DATE FALLING ON A NON-WORKING DAY).             031967
     C**  IF IT DOES DO THE LATER DISCOUNTED SETTLEMENT AMOUNT            031967
     C**  CALCULATION UPTO MATURITY DATE OTHERWISE UPTO THE PERIOD        031967
     C**  END DATE. THE NUMBER 5 WAS CHOSEN AS THIS IS THE WORST          031967
     C**  POSIBLE CASE OF NON-WORKING DAYS IN A ROW (EASTER).             031967
     C*                                                                   031967
     C***********SZEDAT    ADD  5         #EDAT   50                031967060995
     C           SZEDAT    ADD  10        #EDAT   50                031967060995
     C*                                                                   S01119
     C**  IF END DATE IS GREATER THAN THE MATURITY DATE                   S01119
     C**  THEN REPLACE END DATE  BY MATURITY DATE                         S01119
     C*                                                                   S01119
     C           SZEDAT    IFGE SZMDAT                                    S01119
     C           SZEDAT    ORLT SZMDAT                                    031967
     C           #EDAT     ANDGESZMDAT                                    031967
     C                     SETON                     89                   S01119
     C                     Z-ADDSZMDAT    SZEDAT                          S01119
     C                     END                                            S01119
      *                                                                   CIR013
     C           SZICB     IFEQ 9                                         CIR013
     C           SZICB     OREQ 6                                                           MD051152
      * Convert start date to YYYYMMDD format                             CIR013
     C                     Z-ADDSZSDAT    @@DAYN  50                      CIR013
     C                     EXSR ZDATE9                                    CIR013
     C                     Z-ADD@@VDT     ZZDATA                          CIR013
      *                                                                   CIR013
      * Convert end date to YYYYMMDD format                               CIR013
     C                     Z-ADDSZEDAT    @@DAYN                          CIR013
     C                     EXSR ZDATE9                                    CIR013
     C                     Z-ADD@@VDT     ZZDATB                          CIR013
      *                                                                                     MD051152
     C                     ENDIF                                                            MD051152
      *                                                                   CIR013
     C           SZICB     IFEQ 9                                                           MD051152
      *                                                                                     MD051152
     C                     EXSR #FEB29                                    CIR013
     C           #29FEB    IFEQ 'N'                                       CIR013
     C                     Z-ADD365       SZICVL                          CIR013
     C                     ELSE                                           CIR013
     C                     Z-ADD366       SZICVL                          CIR013
     C                     ENDIF                                          CIR013
      *                                                                   CIR013
     C                     ENDIF                                          CIR013
     C*                                                                   S01119
     C**  CALCULATE THE PERIOD BETWEEN START DATE AND END DATE            S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 1                                         S01119
     C           SZICB     OREQ 2                                         S01119
     C           SZICB     OREQ 6                                         S01119
     C           SZICB     OREQ 9                                         CIR013
     C           #29FEB    ANDEQ'Y'                                       CIR013
     C           SZEDAT    SUB  SZSDAT    SZPER                           S01119
     C                     END                                            S01119
      *                                                                                     MD051152
      ** Perform no. of days calculation for method 6                                       MD051152
     C           SZICB     IFEQ 6                                                           MD051152
      *                                                                                     MD051152
      ** If start and end date are in the same year, check if the                           MD051152
      ** year is a leap year and add no. of interest days to the                            MD051152
      ** relevant total                                                                     MD051152
     C           ZZYY1     IFEQ ZZYY2                                                       MD051152
     C           ZZYY1     DIV  4         ZZWN5                                             MD051152
     C                     MVR            ZZWN5                                             MD051152
     C           ZZWN5     IFNE 0                                                           MD051152
     C                     Z-ADD365       SZICVL                                            MD051152
     C                     ELSE                                                             MD051152
     C                     Z-ADD366       SZICVL                                            MD051152
     C                     ENDIF                                                            MD051152
     C                     Z-ADDSZPER     SPPER                                             MD051152
      *                                                                                     MD051152
      ** Calculate Settlement Amount                                                        MD051152
     C                     EXSR FRASR                                                       MD051152
      *                                                                                     MD051152
      ** else must break down the interest period into leap years                           MD051152
      ** and non-leap years                                                                 MD051152
     C                     ELSE                                                             MD051152
      ** Add 1 to starting year number                                                      MD051152
     C           ZZYY1     ADD  1         ZZYY2                                             MD051152
      * Get Midas day number for 1st Jan of year after start date                           MD051152
     C                     MOVE '01'      ZZMM2                                             MD051152
     C                     MOVE '01'      ZZDD2                                             MD051152
     C                     MOVE ZZDATB    ZZDTIN                                            MD051152
     C                     EXSR ZDAT10                                                      MD051152
     C                     Z-ADDZZMDNO    ZZENDW  50                                        MD051152
     C           ZZENDW    SUB  SZSDAT    SPPER                                             MD051152
      *                                                                                     MD051152
      ** Check if current year is a leap year                                               MD051152
     C           ZZYY1     DIV  4         ZZWN5                                             MD051152
     C                     MVR            ZZWN5                                             MD051152
     C           ZZWN5     IFNE 0                                                           MD051152
     C                     Z-ADD365       SZICVL                                            MD051152
     C                     ELSE                                                             MD051152
     C                     Z-ADD366       SZICVL                                            MD051152
     C                     ENDIF                                                            MD051152
      *                                                                                     MD051152
      ** Calculate Settlement Amount                                                        MD051152
     C                     EXSR FRASR                                                       MD051152
      *                                                                                     MD051152
      * Finally calculate the days for the last part-year up                                MD051152
      * to the end date                                                                     MD051152
      *                                                                                     MD051152
      * Get Midas day number for 1st Jan of current year                                    MD051152
     C                     MOVE '01'      ZZMM2                                             MD051152
     C                     MOVE '01'      ZZDD2                                             MD051152
     C                     MOVE ZZDATB    ZZDTIN                                            MD051152
     C                     EXSR ZDAT10                                                      MD051152
     C                     Z-ADDZZMDNO    ZZBEG   50                                        MD051152
     C           SZEDAT    SUB  ZZBEG     SPPER                                             MD051152
      *                                                                                     MD051152
      ** Check if year is a leap year                                                       MD051152
     C           ZZYY2     DIV  4         ZZWN5                                             MD051152
     C                     MVR            ZZWN5                                             MD051152
     C           ZZWN5     IFNE 0                                                           MD051152
     C                     Z-ADD365       SZICVL                                            MD051152
     C                     ELSE                                                             MD051152
     C                     Z-ADD366       SZICVL                                            MD051152
     C                     ENDIF                                                            MD051152
      *                                                                                     MD051152
      ** Calculate Settlement Amount                                                        MD051152
     C                     EXSR FRASR                                                       MD051152
      *                                                                                     MD051152
     C                     ENDIF                                                            MD051152
     C                     ENDIF                                                            MD051152
     C*                                                                   S01119
     C**  IF THE END DATE IS LESS THAN OR EQUAL TO THE MATURITY DATE      S01119
     C*                                                                   S01119
     C           *IN89     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 3                                         S01119
     C           SZICB     OREQ 4                                         S01119
     C           SZICB     OREQ 9                                         CIR013
     C           #29FEB    ANDEQ'N'                                       CIR013
     C                     Z-ADDSZICVL    SZPER                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 5                                         S01119
     C                     Z-ADD365       SZPER                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  THE END DATE WAS REPLACED BY THE MATURITY DATE                  S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 4                                         S01119
     C           SZICB     OREQ 5                                         S01119
     C           SZICB     OREQ 9                                         CIR013
     C           #29FEB    ANDEQ'N'                                       CIR013
     C           SZEDAT    SUB  SZSDAT    SZPER                           S01119
     C*                                                                   S01119
     C**  CONVERT BOTH START AND END DAY NUMBERS TO DATES                 S01119
     C*                                                                   S01119
     C                     Z-ADDSZSDAT    ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     Z-ADDZDATE     DATST                           S01119
     C*                                                                   S01119
     C                     Z-ADDSZEDAT    ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     Z-ADDZDATE     DATEND                          S01119
     C*                                                                   S01119
     C**  ATTEMPT TO CALCULATE THE DAY NUMBER FOR 29 FEB IN THE YEAR      S01119
     C*                                                                   S01119
     C           *IN98     IFEQ '0'                                       S01119
     C                     MOVEL'2902'    DATST                           S01119
     C                     MOVEL'2902'    DATEND                          S01119
     C                     ELSE                                           S01119
     C                     MOVEL'0229'    DATST                           S01119
     C                     MOVEL'0229'    DATEND                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDDATST     ZDATE                           S01119
     C                     EXSR ZDATE1                                    S01119
     C                     Z-ADDZDAYNO    SLEAP                           S01119
     C*                                                                   S01119
     C**  IF A DAY NUMBER IS FOUND CHECK IF IT LIES BETWEEN START DATE    S01119
     C**  AND END DATE                                                    S01119
     C*                                                                   S01119
     C           *IN99     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C           SLEAP     IFGE SZSDAT                                    S01119
     C           SLEAP     ANDLESZEDAT                                    S01119
     C           SZPER     SUB  1         SZPER                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDDATEND    ZDATE                           S01119
     C                     EXSR ZDATE1                                    S01119
     C                     Z-ADDZDAYNO    ELEAP                           S01119
     C*                                                                   S01119
     C           *IN99     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C           ELEAP     IFGE SZSDAT                                    S01119
     C           ELEAP     ANDLESZEDAT                                    S01119
     C           SZPER     SUB  1         SZPER                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  FOR METHOD 3 SPLIT BOTH START AND END DATES INTO THEIR          S01119
     C**  RESPECTIVE DAY,MONTH AND YEAR PORTIONS                          S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 3                                         S01119
     C*                                                                   S01119
     C                     Z-ADD0         SZPER                           S01119
     C*                                                                   S01119
     C                     Z-ADDSZSDAT    ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     Z-ADDZDATE     DATST                           S01119
     C*                                                                   S01119
     C                     MOVE DATST     STYR                            S01119
     C                     MOVE DATST     STWRK                           S01119
     C           *IN98     IFEQ '0'                                       S01119
     C                     MOVELDATST     STDAY                           S01119
     C                     MOVELSTWRK     STMTH                           S01119
     C                     ELSE                                           S01119
     C                     MOVELDATST     STMTH                           S01119
     C                     MOVELSTWRK     STDAY                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDSZEDAT    ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     Z-ADDZDATE     DATEND                          S01119
     C*                                                                   S01119
     C                     MOVE DATEND    ENDYR                           S01119
     C                     MOVE DATEND    ENDWRK                          S01119
     C           *IN98     IFEQ '0'                                       S01119
     C                     MOVELDATEND    ENDDAY                          S01119
     C                     MOVELENDWRK    ENDMTH                          S01119
     C                     ELSE                                           S01119
     C                     MOVELDATEND    ENDMTH                          S01119
     C                     MOVELENDWRK    ENDDAY                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CHECK START DATE FOR LEAP YEAR                                  S01119
     C*                                                                   S01119
     C           STYR      ADD  1900      YEAR1                           S01119
     C           YEAR1     DIV  4         STORE                           S01119
     C                     MVR            CHK                             S01119
     C*                                                                   S01119
     C**  CHECK END DATE FOR LEAP YEAR ALLOWING FOR CHANGE IN CENTURY     S01119
     C*                                                                   S01119
     C           ENDYR     ADD  1900      YEAR2                           S01119
     C           YEAR2     IFLT YEAR1                                     S01119
     C                     ADD  100       YEAR2                           S01119
     C                     END                                            S01119
     C           YEAR2     DIV  4         STORE                           S01119
     C                     MVR            CHK2                            S01119
     C*                                                                   S01119
     C**  IF START MONTH DOES NOT EQUAL 2 SUBTRACT DAY PORTION FROM 30    S01119
     C**  SETTING NEGATIVE RESULT TO ZERO FOR ACTUAL DAYS IN MONTH        S01119
     C*                                                                   S01119
     C           STMTH     IFNE 2                                         S01119
     C           30        SUB  STDAY     SZPER                           S01119
     C           SZPER     IFLT 0                                         S01119
     C                     Z-ADD0         SZPER                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF MONTH DOES EQUAL 2                                           S01119
     C*                                                                   S01119
     C           STMTH     IFEQ 2                                         S01119
     C*                                                                   S01119
     C**  IF IT IS NOT A LEAP YEAR SUBTRACT DAY PORTION FROM 28           S01119
     C*                                                                   S01119
     C           CHK       IFNE 0                                         S01119
     C           28        SUB  STDAY     SZPER                           S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  IF IT IS A LEAP YEAR SUBTRACT DAY PORTION FROM 29               S01119
     C*                                                                   S01119
     C           29        SUB  STDAY     SZPER                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  ADJUST START MONTH & YEAR TO CATER FOR YEAR END                 S01119
     C*                                                                   S01119
     C           STMTH     IFEQ 12                                        S01119
     C                     Z-ADD0         STMTH                           S01119
     C                     ADD  1         YEAR1                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF END MONTH IS NOT EQUAL TO 2 AND END DAY IS 31; OR MONTH      S01119
     C**  EQUALS 2 AND IT IS NOT A LEAP YEAR AND END DAY EQUALS 28;       S01119
     C**  OR MONTH EQUALS 2 AND IT IS A LEAP YEAR AND END DAY             S01119
     C**  EQUALS 29 THEN ADD 30 TO PERIOD COUNT                           S01119
     C*                                                                   S01119
     C           ENDMTH    IFNE 2                                         S01119
     C           ENDDAY    ANDEQ31                                        S01119
     C           ENDMTH    OREQ 2                                         S01119
     C           CHK2      ANDNE0                                         S01119
     C           ENDDAY    ANDEQ28                                        S01119
     C           ENDMTH    OREQ 2                                         S01119
     C           CHK2      ANDEQ0                                         S01119
     C           ENDDAY    ANDEQ29                                        S01119
     C*                                                                   S01119
     C                     ADD  30        SZPER                           S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  ADD DAY NUMBER PORTION TO PERIOD COUNT                          S01119
     C*                                                                   S01119
     C                     ADD  ENDDAY    SZPER                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SUBTRACT 1 FROM END MONTH                                       S01119
     C*                                                                   S01119
     C                     SUB  1         ENDMTH                          S01119
     C*                                                                   S01119
     C**  IF START YEAR AND END YEAR ARE THE SAME SUBTRACT START          S01119
     C**  MONTH FROM END MONTH                                            S01119
     C*                                                                   S01119
     C           YEAR1     IFEQ YEAR2                                     S01119
     C           ENDMTH    SUB  STMTH     MTHS                            S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  ADD END MTH TO THE RESULT OF SUBTRACTING START MONTH FROM 12    S01119
     C*                                                                   S01119
     C           12        SUB  STMTH     MTHS                            S01119
     C           ENDMTH    ADD  MTHS      MTHS                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  MULTIPLY THE NUMBER OF MONTHS BY 30 AND ADD TO THE PERIOD       S01119
     C*                                                                   S01119
     C           MTHS      MULT 30        MTHS2                           S01119
     C                     ADD  MTHS2     SZPER                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CALCULATE THIS PERIOD'S DISCOUNTED SETTLEMENT AMOUNT USING      S01119
     C**  THIS EQUATION WHERE SS = SETTLEMENT AMOUNT                      S01119
     C**                       D = PERIOD                                 S01119
     C**                                                                  S01119
     C**        SS = (BASE RATE - FIXED RATE) x D x PRINCIPAL             S01119
     C**             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~       S01119
     C**             (INTEREST CALC BASIS x 100) + (BASE RATE x D)        S01119
     C*                                                                   S01119
     C           SZICB     IFNE 6                                                           MD051152
      *                                                                                     MD051152
     C           SZFLT     IFGE SZFIX                                     S01119
     C*                                                                   S01119
     C           SZFLT     SUB  SZFIX     SZWRK1                          S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C           SZFIX     SUB  SZFLT     SZWRK1                          S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SZWRK1    MULT SZPER     SZWRK2                          S01119
      *                                                                   E35983
      * Multiply now by principal to get larger value for dividing        E35983
      * and avoid errors due to half-adjusting small numbers later        E35983
     C           SZWRK2    MULT SZPPL     SZWRK6                          E35983
      *                                                                   E35983
     C           SZICVL    MULT 100       SZWRK3                          S01119
     C           SZFLT     MULT SZPER     SZWRK4                          S01119
     C           SZWRK3    ADD  SZWRK4    SZWRK5                          S01119
     C********** SZWRK2    DIV  SZWRK5    SZWRK6    H              S01119 E35983
     C           SZWRK6    DIV  SZWRK5    SZSETL    H                     E35983
     C********** SZWRK6    MULT SZPPL     SZSETL    H              S01119 E35983
      *                                                                                     MD051152
     C                     ENDIF                                                            MD051152
     C*                                                                   S01119
     C**  IF VALUE DATE = START DATE THEN FIRST PERIOD SO INITIALISE      S01119
     C**  RUNNING DISCOUNT FACTOR TO 1                                    S01119
     C*                                                                   S01119
     C           SZVDAT    IFEQ SZSDAT                                    S01119
     C*                                                                   S01119
     C                     Z-ADD1         SZRDF                           S01119
     C                     Z-ADDSZSETL    SZRDS                           S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  DIVIDE THE DISCOUNTED SETTLEMENT AMOUNT BY THE RUNNING          E22610
     C**  DISCOUNT FACTOR TO REDISCOUNT THIS PERIOD'S SETTLEMENT AMOUNT   E22610
     C**  BACK TO START DATE                                              E22610
     C*                                                                   E22610
     C           SZSETL    DIV  SZRDF     SZRSA     H                     E22610
     C*                                                                   E22610
     C**  ADD THE REDISCOUNTED SETTLEMENT AMOUNT TO THE RUNNING           E22610
     C**  DISCOUNTED  SETTLEMENT TOTAL                                    E22610
     C*                                                                   E22610
     C           SZRSA     ADD  SZRDS     SZRDS                           E22610
     C*                                                                   E22610
     C                     END                                            E22610
      *                                                                                     MD051152
     C                     Z-ADD0         SZSETL                                            MD051152
      *                                                                                     MD051152
     C**  CALCULATE THIS PERIOD'S DISCOUNT FACTOR USING THE EQUATION      S01119
     C**                                                                  S01119
     C**    FACTOR = 1 +     (D x BASE RATE)                              S01119
     C**                 ~~~~~~~~~~~~~~~~~~~~~~~~~~                       S01119
     C**                 (INTEREST CALC BASIS x 100)                      S01119
     C*                                                                   S01119
     C           SZWRK4    DIV  SZWRK3    SZWRK7    H                     S01119
     C           1         ADD  SZWRK7    SZDISC    H                     S01119
     C*                                                                   S01119
     C**  MULTIPLY THE DISCOUNT FACTOR BY THE RUNNING DISCOUNT FACTOR     S01119
     C**  TO OBTAIN THE NEW RUNNING DISCOUNT FACTOR FOR REDISCOUNTING     S01119
     C**  SETTLEMENT AMOUNTS BACK TO START DATE                           S01119
     C*                                                                   S01119
     C           SZDISC    MULT SZRDF     SZRDF     H                     S01119
     C*                                                                   S01119
     C****DIVIDE THE DISCOUNTED SETRTLEMENT AMOUNT BY THE RUNNING  S01119 E22610
     C****DISCOUNT FACTOR TO REDISCOUNT THIS PERIOD'S SETTLEMENT AMS01119 E22610
     C****BACK TO START DATE                                       S01119 E22610
     C****                                                         S01119 E22610
     C****       SZSETL    DIV  SZRDF     SZRSA     H              S01119 E22610
     C****                                                         S01119 E22610
     C****ADD THE REDISCOUNTED SETTLEMENT AMOUNT TO THE RUNNING    S01119 E22610
     C****DISCOUNTED  SETTLEMENT TOTAL                             S01119 E22610
     C****                                                         S01119 E22610
     C****       SZRSA     ADD  SZRDS     SZRDS                    S01119 E22610
     C****                                                         S01119 E22610
     C****                 END                                     S01119 E22610
     C*                                                                   S01119
     C**  SET THE START DATE TO THE END DATE                              S01119
     C*                                                                   S01119
     C                     Z-ADDSZEDAT    SZSDAT                          S01119
     C                     END                                            S01119
     C*                                                                   AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C                     END                                            AUS021
     C*                                                                   S01119
     C**  ADD THE NET ACCRUED INTEREST ADJUSTMENTS NOT POSTED TO THE      S01119
     C**  RUNNING DISCOUNTED SETTLEMENT TOTAL TO GIVE THE DISCOUNTED      S01119
     C**  SETTLEMENT AMOUNT TOTAL                                         S01119
     C*                                                                   S01119
     C           SZIANP    ADD  SZRDS     SZDSA                           S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP55                                           S01408
      *                                                                   S01408
     C*                                                                   S01119
     C*****************************************************************   CIR001
2922 C/EJECT                                                              CIR001
     C*****************************************************************   CIR001
     C           FRASR     BEGSR                                                            MD051152
      *                                                                                     MD051152
      **  Calculate this period's discounted settlement amount using                        MD051152
      **  this equation where SS = Settlement amount                                        MD051152
      **                       D = PERIOD                                                   MD051152
      **                                                                                    MD051152
      **        SS = (BASE RATE - FIXED RATE) x D x PRINCIPAL                               MD051152
      **             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                         MD051152
      **             (INTEREST CALC BASIS x 100) + (BASE RATE x D)                          MD051152
      *                                                                                     MD051152
     C           SZFLT     IFGE SZFIX                                                       MD051152
      *                                                                                     MD051152
     C           SZFLT     SUB  SZFIX     SZWRK1                                            MD051152
      *                                                                                     MD051152
     C                     ELSE                                                             MD051152
      *                                                                                     MD051152
     C           SZFIX     SUB  SZFLT     SZWRK1                                            MD051152
      *                                                                                     MD051152
     C                     END                                                              MD051152
      *                                                                                     MD051152
     C           SZWRK1    MULT SPPER     SZWRK2                                            MD051152
      *                                                                                     MD051152
      * Multiply now by principal to get larger value for dividing                          MD051152
      * and avoid errors due to half-adjusting small numbers later                          MD051152
     C           SZWRK2    MULT SZPPL     SZWRK6                                            MD051152
      *                                                                                     MD051152
     C           SZICVL    MULT 100       SZWRK3                                            MD051152
     C           SZFLT     MULT SZPER     SZWRK4                                            MD051152
     C           SZWRK3    ADD  SZWRK4    SZWRK5                                            MD051152
     C           SZWRK6    DIV  SZWRK5    W#SET6 180H                                       MD051152
      *                                                                                     MD051152
     C           W#SET6    ADD  SZSETL    SZSETL                                            MD051152
      *                                                                                     MD051152
     C                     ENDSR                                                            MD051152
      *                                                                                     MD051152
     C**************************************************************************            MD051152
      /SPACE 5                                                                              MD051152
     C**************************************************************************            MD051152
     C*                                                               *   CIR001
     C*  SRFAMO - IRS Fee Amortization Processing.                    *   CIR001
     C*                                                               *   CIR001
     C*  Called by  : main processing                                 *   CIR001
     C*                                                               *   CIR001
     C*  Calls      : HASH                                            *   CIR001
     C*                                                               *   CIR001
     C*****************************************************************   CIR001
     C           SRFAMO    BEGSR                                          CIR001
     C*                                                                   CIR001
     C** Write a ACCEXAO file record if the 'Up front fee value date'     CIR001
     C** is not zero or less than or equal to run day number.             CIR001
     C*                                                                   CIR001
     C           UPVD      IFNE 0                                         CIR001
     C           UPVD      ANDLEREPCD                                     CIR001
     C*                                                                   CIR001
     C** Initial ACCEXAO file fields.                                     CIR001
     C*                                                                   CIR001
     C                     Z-ADD*ZERO     NOTD                            CIR001
     C                     Z-ADD*ZERO     INTR                            CIR001
     C                     MOVE *BLANK    ZLOAN   1                       CIR001
     C                     MOVE *BLANK    ZZ005   5                       CIR001
     C**********           Z-ADD*ZERO     UBRTT                                        CIR001 CSD103
     C**********           Z-ADD*ZERO     TBRTT                                        CIR001 CSD103
     C                     MOVE *BLANKS   UBRTT                                               CSD103
     C                     MOVE *BLANKS   TBRTT                                               CSD103
     C                     Z-ADD*ZERO     TEINR                           CIR001
     C                     MOVE *BLANK    URTPI                           CIR001
     C                     MOVE *BLANK    TRTPI                           CIR001
     C                     Z-ADD*ZERO     TACFD                           CIR001
     C                     Z-ADD*ZERO     TACTD                           CIR001
     C                     Z-ADD*ZERO     TAMAD                           CIR001
     C                     Z-ADD*ZERO     TAMTA                           CIR001
     C                     Z-ADD*ZERO     CLRAT                           CIR001
     C                     Z-ADD*ZERO     FLRAT                           CIR001
     C                     MOVE *BLANK    FLRIND                          CIR001
     C                     Z-ADD*ZERO     OTUI                            CIR002
     C                     Z-ADD*ZERO     TTUI                            CIR002
     C*                                                                   CIR001
     C** Set Record id.                                                   CIR001
     C*                                                                   CIR001
     C                     MOVE 'G'       RECI                            CIR001
     C*                                                                   CIR001
     C** Set Currency code.                                               CIR001
     C*                                                                   CIR001
     C           UPPR      IFEQ 'P'                                       CIR001
     C                     MOVE UCUCY     CCY                             CIR001
     C                     ELSE                                           CIR001
     C                     MOVE TCUCY     CCY                             CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C** Set Accural from date.                                           CIR001
     C*                                                                   CIR001
     C                     Z-ADDUPVD      ACFD                            CIR001
     C*                                                                   CIR001
     C** Set Accural control date.                                        CIR001
     C*                                                                   CIR001
     C                     Z-ADDMDAT      ACTD                            CIR001
     C*                                                                   CIR001
     C** If the 'Up-front Fee Payment/Receipt' flag is 'P' then           CIR001
     C** calculate the Principal amount and the 'Total Interest accrued   CIR001
     C** to date' to be negative.                                         CIR001
     C** Otherwise, get the amounts directly from the Deals file.         CIR001
     C*                                                                   CIR001
     C           UPPR      IFEQ 'P'                                       CIR001
     C           UPFE      MULT -1        PCPL                            CIR001
     C           UPAD      MULT -1        AMAD                            CIR001
     C                     ELSE                                           CIR001
     C                     Z-ADDUPFE      PCPL                            CIR001
     C                     Z-ADDUPAD      AMAD                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C** Set Amount to accrue.                                            CIR001
     C*                                                                   CIR001
     C           PCPL      SUB  AMAD      AMTA                            CIR001
     C*                                                                   CIR001
     C** Output PF/ACCEXAO record.                                        CIR001
     C*                                                                   CIR001
     C                     SETON                     74                   CIR001
     C                     EXCPTACCEX                                     CIR001
     C                     SETOF                     74                   CIR001
     C*                                                                   CIR001
     C** Accumulate number and value of extract records written.          CIR001
     C*                                                                   CIR001
     C                     ADD  1         RECRIT                          CIR001
     C                     MOVE UPFE      ZZAMT                           CIR001
     C                     Z-ADD1         X                               CIR001
     C                     EXSR HASH                                      CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     ENDSR                           SRFAMO         CIR001
     C*****************************************************************   CIR001
     C/EJECT                                                              CIR001
     C*****************************************************************   CIR001
     C*                                                               *   CIR001
     C*  UFACC  - To calculate accrual amounts for IRS if interest    *   CIR001
     C*           is up-front.                                        *   CIR001
     C*                                                               *   CIR001
     C*  Called by  : SRRS   - Single CCY interest rate swap          *   CIR001
     C*                        processing                             *   CIR001
     C*               SRRX   - Cross CCy interest rate swap processing*   CIR001
     C*                                                               *   CIR001
     C*  Calls      : GLINTC - Calculate interest between any two nos *   CIR001
     C*               CALIYD - Calculate yield amount                 *   CIR001
     C*                                                               *   CIR001
     C*****************************************************************   CIR001
     C*                                                                   CIR001
     C           UFACC     BEGSR                           *** UFACC **   CIR001
     C*                                                                   CIR001
     C**  CALCULATE INTEREST FROM THE LAST INTEREST PAYMENT DATE          CIR001
     C**  TO THE NEXT INTEREST PAYMENT DATE (ALREADY PAID)                CIR001
     C*                                                                   CIR001
     C                     Z-ADDSZSLID    ZIBEG                           CIR001
     C                     Z-ADDSZACTD    ZIEND                           CIR001
     C*                                                                   CIR001
     C**  YIELD BASIS CALCULATION                                         CIR001
     C*                                                                   CIR001
     C           SZINPM    IFEQ 'Y'                                       CIR001
     C           ZIEND     SUB  ZIBEG     ZDAYN1                          CIR001
     C                     EXSR CALIYD                                    CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR001
     C**  DISCOUNTED BASIS CALCULATION                                    CIR001
     C*                                                                   CIR001
     C                     EXSR GLINTC                                    CIR001
     C                     Z-ADDZINTR     WKINT  130H                     CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C**  IF DEAL STARTED ACCRUING                                        CIR001
     C*                                                                   CIR001
     C           SZSLID    IFLE REPCD                                     CIR001
     C*                                                                   CIR001
     C**  SUBTRACT THIS INTEREST FROM THE INTEREST ACCRUED TO CONTROL     CIR001
     C**  DATE AND ADD THE ACCRUED INTEREST ADJUSTMENTS POSTED TO         CIR001
     C**  OBTAIN THE INTEREST ACCRUED TO THE LAST PAYMENT DATE            CIR001
     C*                                                                   CIR001
     C           SZIPRD    SUB  WKINT     SWIPRD 130                      CIR001
     C           SZAITC    SUB  WKINT     SZAITD 130                      CIR001
     C                     ADD  SZAIAP    SZAITD                          CIR001
     C                     ADD  SZAIAN    SZAITD                          CIR001
     C                     Z-ADDWKINT     SWKINT 130                      CIR001
     C*                                                                   CIR001
     C**  CALCULATE INTEREST FROM THE LAST INTEREST PAYMENT DATE          CIR001
     C**  TO THE REPORT CONTROL DATE                                      CIR001
     C*                                                                   CIR001
     C                     Z-ADD*ZERO     SZAMTA                          CIR001
     C           SZACTD    IFGE REPCD                                     CIR001
     C*                                                                   CIR001
     C**  YIELD BASIS CALCULATION                                         CIR001
     C*                                                                   CIR001
     C           SZINPM    IFEQ 'Y'                                       CIR001
     C           SZACTD    SUB  REPCD     ZDAYN1                          CIR001
     C           ZICALC    IFEQ 9                                                             CIR013
     C                     Z-ADDREPCD     ZIBEG                                               CIR013
     C                     Z-ADDSZACTD    ZIEND                                               CIR013
     C                     ENDIF                                                              CIR013
     C                     EXSR CALIYD                                    CIR001
     C                     Z-ADDWKINT     SZAMTA 130                      CIR001
     C           SWKINT    SUB  WKINT     WKINT                           CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR001
     C**  DISCOUNTED BASIS CALCULATION                                    CIR001
     C*                                                                   CIR001
     C                     Z-ADDREPCD     ZIEND                           CIR001
     C                     EXSR GLINTC                                    CIR001
     C                     Z-ADDZINTR     WKINT     H                     CIR001
     C           SWKINT    SUB  WKINT     SZAMTA                          CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C**  ADD INTEREST CALCULATED TO INTEREST ACCRUED TO CONTROL DATE     CIR001
     C*                                                                   CIR001
     C                     ADD  WKINT     SZAITD                          CIR001
     C*                                                                   CIR001
     C**  CALCULATE INTEREST ACCRUED TO DATE                              CIR001
     C*                                                                   CIR001
     C           SZAITD    SUB  SWIPRD    SZAMAD 130                      CIR001
     C*                                                                   CIR001
     C                     ELSE                                           CIR001
     C*                                                                   CIR001
     C**  IF DEAL NOT YET STARTED                                         CIR001
     C*                                                                   CIR001
     C                     Z-ADD*ZERO     SZAMAD                          CIR001
     C                     Z-ADDWKINT     SZAMTA                          CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     ENDSR                                          CIR001
     C*                                                                   CIR001
     C*****************************************************************   CIR001
     C/EJECT                                                              CIR001
     C*****************************************************************   CIR001
     C*                                                               *   CIR001
     C*  CALIYD - Calculate yield amount.                             *   CIR001
     C*                                                               *   CIR001
     C*  Called by  : UFACC  - To calculate accrual amounts for IRS   *   CIR001
     C*                        if interest is up-front.               *   CIR001
     C*                                                               *   CIR001
     C*  Calls      : none.                                           *   CIR001
     C*                                                               *   CIR001
     C*****************************************************************   CIR001
     C           CALIYD    BEGSR                                          CIR001
      *                                                                   CIR013
     C           ZICALC    IFEQ 9                                         CIR013
      * Convert start date to YYYYMMDD format                             CIR013
     C                     Z-ADDZIBEG     @@DAYN  50                      CIR013
     C                     EXSR ZDATE9                                    CIR013
     C                     Z-ADD@@VDT     ZZDATA                          CIR013
      *                                                                   CIR013
      * Convert end date to YYYYMMDD format                               CIR013
     C                     Z-ADDZIEND     @@DAYN                          CIR013
     C                     EXSR ZDATE9                                    CIR013
     C                     Z-ADD@@VDT     ZZDATB                          CIR013
      *                                                                   CIR013
     C                     EXSR #FEB29                                    CIR013
     C                     ENDIF                                          CIR013
     C*                                                                   CIR001
     C** INTEREST = PRINCIPAL ( 1 - 1 / ( 1 + RATE X NUMBER OF DAYS/360)) CIR001
     C**       I.E. PRINCIPAL ( 1 - 360 / ( 360 + RATE X NUMBER OF DAYS)) CIR001
     C*                                                                   CIR001
     C           ZICALC    IFEQ 2                                         CIR001
     C           ZICALC    OREQ 3                                         CIR001
     C           ZICALC    OREQ 5                                         CIR001
     C                     Z-ADD36000     ZIWRK3  50                      CIR001
     C                     ELSE                                           CIR001
     C           ZICALC    IFEQ 1                                         CIR001
     C           ZICALC    OREQ 4                                         CIR001
     C           ZICALC    OREQ 9                                         CIR013
     C           #29FEB    ANDEQ'N'                                       CIR013
     C                     Z-ADD36500     ZIWRK3                          CIR001
     C                     ELSE                                           CIR001
     C                     Z-ADD36600     ZIWRK3                          CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           ZDAYN1    MULT ZIRATE    ZIWRK4 157                      CIR001
     C                     ADD  ZIWRK3    ZIWRK4                          CIR001
     C*                                                                   CIR001
     C           ZIWRK3    DIV  ZIWRK4    ZIWRK5 159H                     CIR001
     C           1         SUB  ZIWRK5    ZIWRK5                          CIR001
     C           ZIAMT     MULT ZIWRK5    WKINT     H                     CIR001
     C*                                                                   CIR001
     C                     ENDSR                                          CIR001
     C*                                                                   CIR001
     C*****************************************************************   CIR001
     C/EJECT                                                              CIR001
     C*****************************************************************   CIR001
     C*                                                               *   CIR001
     C*  CFACC  - To calculate accrual amounts for cash flow IRS      *   CIR001
     C*           deals.                                              *   CIR001
     C*                                                               *   CIR001
     C*  Called by  : SRRS   - Single CCY interest rate swap          *   CIR001
     C*                        processing                             *   CIR001
     C*               SRRX   - Cross CCy interest rate swap processing*   CIR001
     C*                                                               *   CIR001
     C*  Calls      : none.                                           *   CIR001
     C*                                                               *   CIR001
     C*****************************************************************   CIR001
     C*                                                                   CIR001
     C           CFACC     BEGSR                           *** CFACC **   CIR001
     C*                                                                   CIR001
     C********** ZIEND     SUB  ZIBEG     ZPARPD  50                                   CIR001 222381
     C********** SZACTD    SUB  SZSLID    ZFULPD  50                                   CIR001 222381
     C*                                                                   CIR001
     C                     Z-ADDZIBEG     ZZBEG                                               222381
     C                     Z-ADDZIEND     ZZEND                                               222381
     C                     MOVELZICALC    ZZCALC                                              222381
     C*                                                                                       222381
      ** Use SR/ZINTDY to determine the number of days from the last                          222381
      **   pay date to the event control date.                                                222381
     C*                                                                                       222381
     C                     EXSR ZINTDY                                                        222381
     C*                                                                                       222381
     C           ZZCALC    IFNE '6'                                                           222381
     C                     Z-ADDZZINDY    ZPARPD  50                                          222381
     C                     ELSE                                                               222381
     C                     Z-ADDINT6DY    ZPAR6  157                                          222381
     C                     ENDIF                                                              222381
     C*                                                                                       222381
     C                     Z-ADDSZSLID    ZZBEG                                               222381
     C                     Z-ADDSZACTD    ZZEND                                               222381
     C                     MOVELZICALC    ZZCALC                                              222381
     C*                                                                                       222381
      ** Use SR/ZINTDY to determine the number of days from the last                          222381
      **   pay date to the next payment date.                                                 222381
     C*                                                                                       222381
     C                     EXSR ZINTDY                                                        222381
      *                                                                                       222381
     C           ZZCALC    IFNE '6'                                                           222381
     C                     Z-ADDZZINDY    ZFULPD  50                                          222381
     C                     ELSE                                                               222381
     C                     Z-ADDINT6DY    ZFUL6  157                                          222381
     C                     ENDIF                                                              222381
      *                                                                                       222381
     C* PRO-RATA THE PAYMENT AMOUNT IN THIS ACCRUAL PERIOD                CIR001
     C*                                                                   CIR001
     C           ZZCALC    IFNE '6'                                                           222381
     C           CFLA      MULT ZPARPD    WKINT                           CIR001
     C           ZFULPD    IFNE *ZERO                                     CIR001
     C                     DIV  ZFULPD    WKINT     H                     CIR001
     C                     ELSE                                           CIR001
     C                     Z-ADD*ZERO     WKINT                           CIR001
     C                     END                                            CIR001
     C                     ELSE                                                               222381
     C           CFLA      MULT ZPAR6     WKINT     H                                         222381
     C           ZFUL6     IFNE *ZERO                                                         222381
     C                     DIV  ZFUL6     WKINT     H                                         222381
     C                     ELSE                                                               222381
     C                     Z-ADD*ZERO     WKINT                                               222381
     C                     END                                                                222381
     C                     ENDIF                                                              222381
     C*                                                                   CIR001
     C                     ENDSR                                          CIR001
     C*                                                                   CIR001
     C*****************************************************************   CIR001
     C/EJECT                                                              CIR001
     C********************************************************************S01119
     C**                                                                  S01119
     C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND                     S01119
     C**              CONVERT TO A NUMBER OF DAYS.                        S01119
     C**                                                                  S01119
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.         S01119
     C**                                                                  S01119
     C           ZDATE1    BEGSR                           *** ZDATE1 *** S01119
     C**                                                                  S01119
     C**   CLEAR DAY NUMBER.                                              S01119
     C                     Z-ADD0         ZDAYNO  50                      S01119
     C**                                                                  S01119
     C**   CALCULATION TO DEFINE INPUT DATE FIELD.                        S01119
     C                     Z-ADDZDATE     ZDATE   60                      S01119
     C**                                                                  S01119
     C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.                     S01119
     C                     MOVE ZDATE     ZYEAR   20                      S01119
     C  N98                MOVELZDATE     ZDAY    20                      S01119
     C   98                MOVELZDATE     ZMTH    20                      S01119
     C                     MOVE ZDATE     ZWRK4   40                      S01119
     C  N98                MOVELZWRK4     ZMTH                            S01119
     C   98                MOVELZWRK4     ZDAY                            S01119
     C**                                                                  S01119
     C**   ENSURE MONTH IS VALID.                                         S01119
     C           ZMTH      COMP 0                      9999               S01119
     C  N99      ZMTH      COMP 12                   99                   S01119
     C   99                GOTO ZDEND1                     BYPASS IF ERRORS01119
     C**                                                                  S01119
     C**   CHECK FOR 30 DAY MONTHS.                                       S01119
     C           ZMTH      COMP 4                        90IF 90 ON, 30   S01119
     C  N90      ZMTH      COMP 6                        90DAY MONTH.     S01119
     C  N90      ZMTH      COMP 9                        90               S01119
     C  N90      ZMTH      COMP 11                       90               S01119
     C**                                                                  S01119
     C**   ENSURE DAY IS VALID.                                           S01119
     C           ZDAY      COMP 0                      9999               S01119
     C   90N99   ZDAY      COMP 30                   99                   S01119
     C  N90N99   ZDAY      COMP 31                   99                   S01119
     C   99                GOTO ZDEND1                     BYPASS IF ERRORS01119
     C**                                                                  S01119
     C**   CHECK FOR LEAP YEAR AND FEBRUARY.                              S01119
     C           ZYEAR     ADD  28        ZYEAR                           S01119
     C           ZYEAR     DIV  4         ZLYR    20                      S01119
     C                     MVR            ZLY     10     91LEAP YR, 91 ON S01119
     C           ZMTH      COMP 2                    93  92FEB., 92 ON    S01119
     C**                                                   PAST FEB, 93 ONS01119
     C**   IF FEBUARY FURTHER VALIDATE DAY.                               S01119
     C  N91 92   ZDAY      COMP 28                   99                   S01119
     C   91 92   ZDAY      COMP 29                   99                   S01119
     C   99                GOTO ZDEND1                     BYPASS IF ERRORS01119
     C**                                                                  S01119
     C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANSS01119
     C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.S01119
     C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YRS01119
     C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.S01119
     C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR S01119
     C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTHS01119
     C**                                                                  S01119
     C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*S01119
     C**                                                                  S01119
     C**                                                                  S01119
     C********************************************************************S01119
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
     C/COPY WNCPYSRC,DL0500C086
      *                                                                                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC1 - Processing #1 for CF deals                          *                       CDL033
      *         - Retrieve extension details of deal                  *                       CDL033
      *         - Rate fix date processing                            *                       CDL033
      *         - Value date processing                               *                       CDL033
      *         - Save value of file field/s                          *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC1    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Process rate fix date if it has been reached already,                                CDL033
      ** is not equal to zero, and has not yet been                                           CDL033
      ** processed.                                                                           CDL033
      *                                                                                       CDL033
     C           XKINFD    IFLE WEVCD                                                         CDL033
     C           XKINFD    ANDNE*ZERO                                                         CDL033
     C           XKINFF    ANDNE'Y'                                                           CDL033
      *                                                                                       CDL033
      ** Flag rate fix date as processed.                                                     CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       XKINFF                                              CDL033
      *                                                                                       CDL033
      ** Retrieve base rate details.                                                          CDL033
      ** DB error if not found.                                                               CDL033
      *                                                                                       CDL033
     C                     MOVELBRTT      PBRTT                                               CDL033
     C                     CALL 'AOBSRTR0'                                                    CDL033
     C                     PARM '*MSG   ' PRTCD   7                                           CDL033
     C                     PARM '*KEY   ' POPTN   7                                           CDL033
     C                     PARM CCY       PCCY    3                                           CDL033
     C                     PARM           PBRTT   2                                           CDL033
     C           SDBSRT    PARM SDBSRT    DSSDY                                               CDL033
      *                                                                                       CDL033
     C           PRTCD     IFNE *BLANKS                                                       CDL033
     C                     MOVE '18'      DBASE                                               CDL033
     C                     MOVELCCY       WDBKEY  5                                           CDL033
     C                     MOVE BRTT      WDBKEY                                              CDL033
     C                     MOVELWDBKEY    DBKEY                                               CDL033
     C                     MOVEL'SDBSRTPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO TOTAL                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** If rate fix date falls before value date of new                                      CDL033
      ** rate, use old base rate as fixed base rate.                                          CDL033
      ** Else, use new base rate.                                                             CDL033
      *                                                                                       CDL033
     C           XKINFD    IFLT BAVDNR                                                        CDL033
     C                     Z-ADDBACBSR    XKBSRF                                              CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDBANBRT    XKBSRF                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Perform value date processing.                                                       CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC2                                                        CDL033
      *                                                                                       CDL033
      ** Save value of file field/s used for interest                                         CDL033
      ** calculation.                                                                         CDL033
      *                                                                                       CDL033
     C                     Z-ADDAITC      WXAITC 130                                          CDL033
      *                                                                                       CDL033
     C           EFRC1     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC2 - Processing #2 for CF deals                          *                       CDL033
      *         - Value date processing:                              *                       CDL033
      *           (1) set effective rate to fixed base rate           *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC2    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Bypass processing if rate for value date has been                                    CDL033
      ** set already.                                                                         CDL033
      *                                                                                       CDL033
     C           XKBSVF    IFEQ 'Y'                                                           CDL033
     C                     GOTO EFRC2                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Update effective rate only if base rate has been                                     CDL033
      ** fixed already.                                                                       CDL033
      *                                                                                       CDL033
     C           XKINFF    IFEQ 'Y'                                                           CDL033
     C           XKBSRF    ADD  RTSP      INTR                                                CDL033
     C           INTR      IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     INTR                                                CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Reset the rate fix date flag.                                                        CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    XKINFF                                              CDL033
      *                                                                                       CDL033
     C           EFRC2     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC3 - Processing #3 for CF deals                          *                       CDL033
      *         - Rate change processing:                             *                       CDL033
      *           (1) update accrued interest to control date         *                       CDL033
      *           (2) set effective rate to fixed base rate           *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC3    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date.                                             CDL033
      *                                                                                       CDL033
     C                     Z-ADDXKRCDT    ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WXKINT                                              CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WXKINT 130H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           AITC      ADD  WXKINT    AITC                                                CDL033
      *                                                                                       CDL033
      ** Reset ZIBEG for the next interest computation.                                       CDL033
      *                                                                                       CDL033
     C                     Z-ADDXKRCDT    ZIBEG                                               CDL033
      *                                                                                       CDL033
      ** Update effective rate for the next interest                                          CDL033
      ** computation only if base rate has been fixed                                         CDL033
      ** already.                                                                             CDL033
      *                                                                                       CDL033
     C           XKINFF    IFEQ 'Y'                                                           CDL033
     C           XKBSRF    ADD  RTSP      ZIRATE                                              CDL033
     C           ZIRATE    IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           EFRC3     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      * CKDEAL - Check if Deal Type is included in validations        *                       CDL033
      *****************************************************************                       CDL033
     C           CKDEAL    BEGSR                                                              CDL033
      *                                                                                       CDL033
     C           DTYP      IFNE 'CF'                                                          CDL033
     C                     MOVE *OFF      @FXT    1                                           CDL033
     C                     MOVE *IN49     TVAR    1                                           CDL033
     C           DTYP      LOKUPFXT                      49                                   CDL033
     C           *IN49     IFEQ *ON                                                           CDL033
     C                     MOVE *ON       @FXT                                                CDL033
     C                     ENDIF                                                              CDL033
     C                     MOVE TVAR      *IN49                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDSR                                                              CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
     C**                                                                  S01119
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0500CP63                                           S01408
     C*                                                                   S01408
     C/EJECT                                                              CIR013
     C/COPY ZSRSRC,ZFEB29                                                 CIR013
1047 O**********DL0500P1T  203   LR                                 S01124S01117
1047 ODL0500AUT  203   LR                                                 S01117
1048 O***********************************22 'REFERENCE DL0500'            S01117
1048 O                                   24 'REFERENCE DL0500AU'          S01117
1049 O************************ TITL      89                               S01194
1049 O                         BJURPT    89                               S01194
1050 O                                  104 'DATE'
1051 O************************ RUNA     112                               S01194
1051 O                         BJMRDT   112                               S01194
1052 O                                  127 'PAGE    1'
1053 O        T  1     LR
1054 O                                   67 'INTEREST ACCRUALS EXTRAC'
1055 O                                   82 'T FILE CONTROLS'
1056 O        T        LR
1057 O                                   67 '------------------------'
1058 O                                   82 '---------------'
1059 O        T  220   LRN99
1060 O                                   21 'RUN CONTROLS'
1061 O                                   59 'NUMBER'
1062 O                                   87 'VALUE'
1063 O        T  2     LRN99
1064 O******                             35 'RECORDS ON DEALS FILE'       S01093
1065 O******                   NORE  3   59                               S01093
1064 O                                   35 'LIVE DEALS - ON FILE '       S01093
1065 O                         NLRA  3   59                               S01093
1066 O                         VLAF  Z   84
1067 O                         VLAL      87
1068 O        T  2     LRN99
1069 O******                             37 'RECORDS READ FROM DEALS'     S01093
1070 O******                             42 'FILE'                        S01093
1069 O                                   37 'LIVE DEALS - CALCULATED'     S01093
1071 O                         RECRED3   59
1072 O                         INT,2 Z   84
1073 O                         DEC,2     87
1074 O                       80         105 '** DIFFERENCE **'
1075 O        T  3     LRN99
1076 O                                   37 'RECORDS ON EXTRACT FILE'
1077 O                                   45 'CREATED'
1078 O                         RECRIT3   59
1079 O                         INT,1 Z   84
1080 O                         DEC,1     87
1081 O        T  3     LR U7 U8
1082 O***********************************22 'REFERENCE DL0500'            S01117
1083 O***********************************62 'PRINT TERMINATED, '          S01117
1084 O***********************************80 'DATABASE IN ERROR'           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    76                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
1085 O*****   T 3      LR                                                 LN0135
1086 O*****                              65 '***   END OF REPORT'         LN0135
1087 O*****                              71 '***'                         LN0135
1088 OACCEXAN H        46
1089 O                                    8 'A   0000'
1090 O                         TDAT      11P
1091 O*************************ACLD      12                               S01194
1091 O                         BKALDI    12                               S01194
1092 OACCEXAO E        01 50N51
1093 O                                    1 'D'
1094 O                       56IDCY       4
1095 O                      N56ILCY       4
1096 O                         DTYP       6
1097 O                         DLST       8
1098 O                         CNUM      14
1099 O                         DLNO      20
1100 O                         OTDT      23P
1101 O                         VDAT      26P
1102 O                                   29 '   '
1103 O                         ICIR      35P
1104 O                       56IDAM      42P
1105 O                      N56ILAM      42P
1106 O                         AMAD      49P
1107 O                         AMTA      56P
1108 O                         RCDC      58
     O********************************** 64 '      '                S01119S01117
     O                         BRCA      61                               S01117
     O*************************CMPYM     64                               S01117
     O                         A8CMCD    64                               S01194
     O                                   68 '0000'                        S01119
     O                         ZERO11    74P                              S01119
     O                                   76 'NN'                          S01119
     O                         ZERO05    79P                              S01119
     O                         ZERO05    82P                              S01119
     O                         ZERO13    95                               S01119
     O                         ZERO13   108                               S01119
     O                         ZERO11   114P                              S01119
     O                         ZERO11   120P                              S01119
     O                                  121 'N'                           S01119
     O                         ZERO15   129P                                                  CDL038
     O                         ZERO15   137P                                                  CDL038
     O                         CLAS     141                                                   CDL038
1109 O        D        01 47
1110 O       OR        02N52
1111 O       OR        03 54
1112 O       OR        03 55
1113 O                                    1 'D'
     O                 55 59              1 'E'
     O                 01 47              1 'F'
1114 O                       01SPLC       4
1115 O                       02CCY        4
1116 O                       03CCY        4
1117 O                         DTYP       6
1118 O                         DLST       8
1119 O                N03      CNUM      14
1120 O                 03      ISCN      14
1121 O                         DLNO      20
1122 O**********          01 47OTDT      23P                              E17716
1123 O**********          01N47VDAT      23P                              E17716
1124 O****************       02SLID      23P                              E47291
     O****************N71 03 54VDAT      23P                              E47291
     O**************** 71 03 54SLID      23P                              E47291
     O****************       02IACD      23P                       E47291 E10517
     O****************    03 54IACD      23P                       E47291 E10517
     O                 65    02IACD      23P                              E10517
     O                 65 03 54IACD      23P                              E10517
     O                N65      SLID      23P                              E10517
1122 O                    01 47OTDT      23P                              E17716
1123 O                    01N47VDAT      23P                              E17716
1126 O                    03 55VDAT      23P
1127 O                    01 47VDAT      26P
1128 O                    01N47OTDT      26P
1129 O                    02 70MDAT      26P
1130 O                    02N70NIDT      26P
1131 O                    03 55MDAT      26P
1132 O                    03 54TODAT     26P
1133 O                                   29 '   '
1134 O                       02NOTD      29
1135 O                         ZERO11    35P
1136 O                       02INTR      35P
1137 O                       03YRAT      35P
     O                 59 03 54INTR      35P
1138 O                       01SPLA      42P
1139 O                       02PCPL      42P
1140 O                       03PUPR      42P
     O                 59 03 54FVAL      42P
1141 O                         AMAD      49P
1142 O                         AMTA      56P
1143 O                    02N21ZERO13    56P
1144 O                         RCDC      58
     O********************************** 64 '      '                S01119S01117
     O                         BRCA      61                               S01117
     O*************************CMPYM     64                               S01117
     O                         A8CMCD    64                               S01194
     O                                   68 '0000'                        S01119
     O                         ZERO11    74P                              S01119
     O                                   76 'NN'                          S01119
     O                         ZERO05    79P                              S01119
     O                         ZERO05    82P                              S01119
     O                         ZERO13    95                               S01119
     O                         ZERO13   108                               S01119
     O                         ZERO11   114P                              S01119
     O                         ZERO11   120P                              S01119
     O                                  121 'N'                           S01119
     O                         ZERO15   129P                                                  CDL038
     O                         ZERO15   137P                                                  CDL038
     O                         CLAS     141                                                   CDL038
     O/COPY WNCPYSRC,DL0500O001
     O        E        03 54 59
     O                                    1 'E'
     O                         CCY        4
     O                         DTYP       6
     O                         DLST       8
     O                         ISCN      14
     O                         DLNO      20
     O****************      N71VDAT      23P                              E47291
     O****************       71SLID      23P                              E47291
     O****************         IACD      23P                       E47291 E10517
     O                 65      IACD      23P                              E10517
     O                N65      SLID      23P                              E10517
     O                         MDAT      26P
     O                         YRAT      35P
     O                         PUPR      42P
     O                         AMTAD     49P
     O                         AMTTA     56P
     O                         RCDC      58
     O********************************** 64 '      '                S01119S01117
     O                         BRCA      61                               S01117
     O*************************CMPYM     64                               S01117
     O                         A8CMCD    64                               S01194
     O                                   68 '0000'                        S01119
     O                         ZERO11    74P                              S01119
     O                                   76 'NN'                          S01119
     O                         ZERO05    79P                              S01119
     O                         ZERO05    82P                              S01119
     O                         ZERO13    95                               S01119
     O                         ZERO13   108                               S01119
     O                         ZERO11   114P                              S01119
     O                         ZERO11   120P                              S01119
     O                                  121 'N'                           S01119
     O                         ZERO15   129P                                                  CDL038
     O                         ZERO15   137P                                                  CDL038
     O                         CLAS     141                                                   CDL038
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0500OOP1                                           S01408
      *                                                                   S01408
     O*                                                                   S01119
1092 O********E**              ACCEX                               S01119 CIR001
1092 O        E       N74 10   ACCEX                                      CIR001
1092 O       OR       N74 11                                              CIR001
1092 O       OR       N10N11                                              CIR001
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0500OOP2                                           S01408
      *                                                                   S01408
 093 O                                    1 'D'                           S01119
1094 O                         CCY        4                               S01119
1096 O                         DTYP       6                               S01119
1097 O                         DLST       8                               S01119
1098 O                         CNUM      14                               S01119
1099 O                         DLNO      20                               S01119
1100 O                         ACFD      23P                              S01119
1101 O                         ACTD      26P                              S01119
1102 O                                   29 '000'                         S01119
1103 O                         INTR      35P                              S01119
1105 O                         PCPL      42P                              S01119
1106 O                         AMAD      49P                              S01119
1107 O                         AMTA      56P                              S01119
1108 O                         RCDC      58                               S01119
     O********************************** 64 '      '                S01119S01117
     O                         BRCA      61                               S01117
     O*************************CMPYM     64                               S01117
     O                         A8CMCD    64                               S01194
     O                         UBRTT     66                               S01119
     O                         TBRTT     68                               S01119
     O                         TEINR     74P                              S01119
     O                         URTPI     75                               S01119
     O                         TRTPI     76                               S01119
     O                         TACFD     79P                              S01119
     O                         TACTD     82P                              S01119
     O                         TAMAD     95                               S01119
     O                         TAMTA    108                               S01119
     O                         CLRAT    114P                              S01119
     O                         FLRAT    120P                              S01119
     O                         FLRIND   121                               S01119
     O                         OTUI     129P                              CIR001
     O                         TTUI     137P                              CIR001
     O                         CLAS     141                               CDL038
     O*                                                                   CIR001
     O        E        74 10   ACCEX                                      CIR001
     O       OR        74 11                                              CIR001
     O                                    1 'G'                           CIR001
     O                         CCY        4                               CIR001
     O                         DTYP       6                               CIR001
     O                         DLST       8                               CIR001
     O                         CNUM      14                               CIR001
     O                         DLNO      20                               CIR001
     O                         ACFD      23P                              CIR001
     O                         ACTD      26P                              CIR001
     O                                   29 '000'                         CIR001
     O                         INTR      35P                              CIR001
     O                         PCPL      42P                              CIR001
     O                         AMAD      49P                              CIR001
     O                         AMTA      56P                              CIR001
     O                         RCDC      58                               CIR001
     O                         BRCA      61                               CIR001
     O                         A8CMCD    64                               CIR001
     O                         UBRTT     66                               CIR001
     O                         TBRTT     68                               CIR001
     O                         TEINR     74P                              CIR001
     O                         URTPI     75                               CIR001
     O                         TRTPI     76                               CIR001
     O                         TACFD     79P                              CIR001
     O                         TACTD     82P                              CIR001
     O                         TAMAD     95                               CIR001
     O                         TAMTA    108                               CIR001
     O                         CLRAT    114P                              CIR001
     O                         FLRAT    120P                              CIR001
     O                         FLRIND   121                               CIR001
     O                         OTUI     129P                              CIR001
     O                         TTUI     137P                              CIR001
     O                         CLAS     141                               CDL038
     O*                                                                   S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0500OOP3                                           S01408
      *                                                                   S01408
1145 OACCEXAP T        LR
1146 O                                    8 'TZZZ9999'
1147 O                         RECRIT    11P
1148 O                         INT,1     19P
1149 O                         DEC,1     21P
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0500OOP4                                           S01408
     O*                                                                   S01408
     X/COPY WNCPYSRC,DL0500X001
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
** FXT                                                                                        CDL033
ITIPTDTICI                                                                                    CDL033