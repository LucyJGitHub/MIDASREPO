0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Accruals report')                             *
0002 F********************************************************************
0003 F*                                                                  *
     F*  Midas - Dealing Module
0005 F*                                                                  *
0006 F*     DL0520 - ACCRUALS REPORT                                     *
0007 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD025659           Date 24Mar13               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CSC042             Date 05Feb09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG8167            Date 25May06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CDL033             Date 10Feb05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CDL021             Date 03Feb04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 186259             Date 05Dec00               *
      *               . CIR006             Date 13Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01408             Date 02Sep96               *
      *                 098321             Date 30Jul96                  *
     F*                    S01408          DATE   22AUG95                *
     F*                    CIR002          DATE   13JUN95                *
     F*                    CIR001          DATE   13JUN95                *
     F*                    S01354          DATE   09JAN92                *
     F*                    LN0614          DATE   14SEP90                *
     F*                    S01268          DATE.  10MAY90
     F*                    E135            DATE.  06DEC89
     F*                    S01117          DATE.  24/08/89               *S01117
     F*                    S01194          DATE.  24/08/89               *S01194
     F*                    E15059          DATE.  10/11/88               *
     F*                    S01157          DATE.  04/10/88               *S01157
     F*                    E11212          DATE.  25/08/87               *
     F*                    S01119          DATE.  07/07/87               *
0010 F*                                                                  *
0010 F*------------------------------------------------------------------*
0010 F*                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  MD025659 - Wrong computation of Interest accrual.            *
      *  CSC042 - COB Performance fixes                               *
      *           Try to keep calls to AOCUST to a minimum by reusing *
      *           data if this call is same as last call              *
      *  BUG8167- Display 'ACCRUED TO DATE' & 'TO ACCRUE' for base    *
      *           rate row. Applied fix 219486.                       *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CDL021 - Reports by Deal Type                                *
      *  186259 - Deal subtype total skip to the next page caused by  *
      *           098321.                                             *
      *  CIR006 - Amortisation of Caps/Collars/Floors and Individual  *
      *           Compounding Swaps.                                  *
      *  CDL006 - Dealing Fiduciary                                   *
     F*    S01408 - Addition of hooks DL0520CCP9                      *
     F*    098321 - Overflow handling for DL0520P1. APPLY 083584.     *
     F*    S01408 - Addition of hooks DL0520CCP1                      *
     F*                               DL0520CCP2                      *
     F*                               DL0520CCP3                      *
     F*                               DL0520CCP4                      *
     F*                               DL0520CCP5                      *
     F*                               DL0520CCP6                      *
     F*                               DL0520CCP7                      *
     F*                               DL0520CCP8                      *
     F*                               DL0520FFP1                      *
     F*                               DL0520IIP1                      *
     F*                               DL0520OOP1                      *
     F*                               DL0520OOP2                      *
     F*                               DL0520OOP3                      *
     F*                               DL0520OOP4                      *
     F*                               DL0520OOP5                      *
     F*                               DL0520OOP6                      *
     F*                               DL0520OOP7                      *
     F*                               DL0520OOP8                      *
     F*                               DL0520OOP9                      *
     F*                               DL0520OP10                      *
     F*                               DL0520OP11                      *
     F*       CIR002  -  Compounding of Interest.                        *
     F*       CIR001  -  Interest Rate Calendars.                        *
     F*       S01354  -  Add internal funding deal types                 *
     F*       LN0614  -  'CONSOLIDATED' INSERTED IN REPORT TITLE         *LN0614
     F*       S01268  -  ADD CUSTOMER REPORT TOWN TO REPORT              *
     F*       E135    -  EXCESS PARAMETERS BEING PASSED TO ZSFILE        *
     F*       S01117  -  MULTI-BRANCHING CHANGES                         *S01117
     F*       S01194  -  NEW STANDING DATA CHANGES                       *S01194
     F*       E15059  -  SOME OUTPUT OVERFLOWS WITHOUT GENERATING        *E15059
     F*                  A NEW PAGE HEADING, SO REDUCE NO. OF LINES      *E15059
     F*                  OUTPUT BEFORE A PAGE BREAK IS GENERATED.        *E15059
     F*                                                                  *
     F*       S01157  -  IF DEAL IS A FLOOR (TYPE 'RF') DO NOT           *S01157
     F*                  OUTPUT THE CEILING RATE, INSTEAD OUTPUT         *S01157
     F*                  THE FLOOR RATE. SPLIT DEAL TYPE 'RL' INTO       *S01157
     F*                  'RF','RR' AND 'RP'.                             *S01157
0010 F*       E11212  -  DEAL TYPE HEADINGS NOT ALWAYS PRINTING.         *E11212
0010 F*       S01119  -  FORWARD RATE AGREEMENTS/INTEREST RATE SWAPS     *S01119
0011 F*                                                                  *
0012 F********************************************************************
0013 FSACEX   IP  E           K        DISK
     FACCEXAN IF  E                    DISK                                                   CDL021
     F            ACCEXANF                          KRENAMEHEADER                             CDL021
     FFDDTSTL1IF  E           K        DISK                                                   CDL038
      ** Deal Types/Sub Types                                                                 CDL038
      *                                                                                       CDL038
      *                                                                   S01408
     F/COPY WNCPYSRC,DL0520FFP1                                           S01408
      *                                                                   S01408
0014 F****TABLE   IF  F      96 12AI     2 DISK                           S01194
0015 F****CLINT   IF  F     256  7AI     2 DISK                           S01194
0016 F****DL0520P1O   F     132     OF     PRINTER                 S01124 S01117
0016 FDL0520P1O   F     132     OF     PRINTER      KINFDS SPOOL          S01117
0016 FDL0520AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            SACEX DETAIL
0019 F* 02            SACEX TRAILER
0021 F**04********    TABLE ICR 1                                         S01194
0022 F**05********    TABLE DEAL SUB-TYPES                                S01194
0023 F**06********    TABLE CATCHALL                                      S01194
0024 F**07********    CLINT DETAIL                                        S01194
0025 F**08********    CLINT CATCHALL                                      S01194
0025 F* 04            SOMETHING WRITTEN TO THE DL0520P1                   S01117
     F* 05            CIR001 on                                           CIR001
     F* 06            CIR002 on                                           CIR002
0026 F* 09            SACEX HEADER
0027 F**10********    TABLE CURRENCIES                                    S01194
0027 F* 11            FLOOR DEAL, TYPE 'RF'                               S01157
0028 F*    20         NOTICE DAYS ZERO
0029 F*    21         NOTICE DAYS NEGATIVE
0030 F*    22         NOTICE DAYS POSITIVE
0031 F*    23         INTEREST RATE ZERO
0030 F*    24         OUR BASE RATE POSITIVE                              S01119
0031 F*    25         THEIR BASE RATE POSITIVE                            S01119
0032 F*       14      DEAL TYPE IS '14'
0033 F*       15      DEAL TYPE IS '15'
0034 F*       16      DEAL TYPE IS '16'
0035 F*       17      DEAL TYPE IS '17'
0036 F*       19      DEAL TYPE IS '20'
0037 F*       30      CCY HAS 0 D.P.
0038 F*       31      CCY HAS 1 D.P.
0039 F*       32      CCY HAS 2 D.P.
0040 F*       33      CCY HAS 3 D.P.
0041 F*       34      HASH AMOUNT IS NEGATIVE
0042 F*       35      LOAN/DEP. RECORD - CODE '15' OR '16'
0043 F*       40      FIRST CYCLE
0044 F********41****  CHAIN FAIL TO CLINT                                 S01194
0045 F********42****  CHAIN FAIL TO TABLE                                 S01194
 045 F*       43      RECID- D
 045 F*       44      RECID- E
 045 F*       45      RECID- F
     F*       46      RECID- G                                            CIR001
     F*       51      Our total unsettled interest not zero               CIR002
     F*       52      Their total unsettled interest not zero             CIR002
     F*       60      FRA/IRS DEAL TYPE                                   S01119
     F*       61      DEAL TYPE 'FR' - FUTURE RATE AGREEMENT              S01119
     F*       62      DEAL TYPE 'RS' - INTEREST RATE SWAP                 S01119
     F*       63      DEAL TYPE 'RX' - CROSS CURRENCY INTEREST RATE SWAP  S01119
     F********64******DEAL*TYPE*'RL'*-*INTEREST*RATE*CAP/COLLAR     S01119S01157
     F*       64      DEAL TYPE RF, RR, RA - INTEREST RATE CAP/COLLAR     S01157
     F*       65      FRA/IRS - OUR   RATE PRESENT, RATE TO PRINT         S01119
     F*       66      FRA/IRS - THEIR RATE PRESENT, RATE TO PRINT         S01119
     F*       67      FRA/IRS - OUR   ACCRUAL AMOUNTS TO PRINT            S01119
     F*       68      FRA/IRS - THEIR ACCRUAL AMOUNTS TO PRINT            S01119
     F*       69      'RX' - OUR DETAILS RECORD           -OR-            S01119
     F****************'RL'*-*PROVIDERS*DETAILS*ARE*OURS             S01119S01157
     F*               'RF', 'RR, 'RP' - PROVIDERS DETAILS ARE OURS        S01157
     F*       70      'RX' - THEIR DETAILS RECORD         -OR-            S01119
     F****************'RL'*-*PROVIDERS*DETAILS*ARE*THEIRS           S01119S01157
     F*               'RP', 'RF', 'RR' - PROVIDERS DETAILS ARE THEIRS     S01157
     F********71******'RL'*-*FLOOR*RATE*PRESENT                     S01119S01157
     F*       71      'RP', 'RF', 'RR - FLOOR RATE PRESENT                S01157
     F*       72      'G' deal type - Fee Amortised                       CIR001
0046 F*       80      NO. OF RECORDS DIFFERENCE
0047 F*       81      HASH TOTAL DIFFERENCE
0046 F*       88      DEAL TYPE/SUBTPYE                                                       CDL021
0047 F*       89      DEAL TYPE/SUBTPYE                                                       CDL021
0048 F*             L1CHANGE OF DEAL SUB-TYPE
0049 F*             L2CHANGE OF DEAL TYPE
0050 F*             L3CHANGE OF CURRENCY
 050 F*             L4CHANGE OF RECORD ID
     F/COPY WNCPYSRC,DL0520F001
      *                                                                                       CDL033
     E                    TAB1CP  1   1  2   TAB2CP 50   DEAL TYPE/NARR.                      CDL033
      *                                                                                       CDL033
     E                    CPY@    1   1 80                                S01194
     E/COPY WNCPYSRC,DL0520E002
0051 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0052 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0053 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E***                 TAB1    1  30  2   TAB2   50   DEAL TYPE/NARR.  S01119
     E***                 TAB1    1  34  2   TAB2   50   DEAL TYPE S01119 S01157
     E************        TAB1    1  36  2   TAB2   50   DEAL TYPE/S01157 S01354
     E***********         TAB1    1  38  2   TAB2   50   DEAL TYPE S01354 CDL006
     E                    TAB1    1  44  2   TAB2   50                    CDL006
     E/COPY WNCPYSRC,DL0520E001
0054 E**
0055 I*
0056 I*    SACEX - HEADER
0057 I*
0058 IACCEXANF    09
0060 I*
0061 I*    SORTED ACCRUALS EXTRACT FILE - DETAIL
0062 I*
0063 IACCEXAOF    01
     I              RECI                            RECID L4
0065 I                                              CCY   L3
0066 I                                              DTYP  L2
0067 I                                              DLST  L1
     I                                              CLAS  L1                                  CDL038
0072 I                                              NOTD        222120
0073 I                                              INTR            23
0073 I                                              UBRTT       24        S01119
0073 I                                              TBRTT       25        S01119
0079 IACCEXAPF    02
0078 I*    TRAILER
0083 I*
0087 I*****                                                               S01194
0088 I*****TABLE FILE                                                     S01194
0089 I*****                                                               S01194
0090 I*****ICR 1                                                          S01194
0091 I****TABLE   NS  04   1 CD   2 C0   3 C1                             S01194
0092 I*****   AND      12 C1  13 C0                                       S01194
0093 I*****                                   1   1 RECI                  S01194
0094 I*****                                  14  66 TITL                  S01194
0095 I*****                                  80  86 RUNA                  S01194
0096 I*****                                  87  87 DATF                  S01194
0097 I*****DEAL SUB-TYPES                                                 S01194
0098 I*****   NS  05   1 CD   2 C4   3 C2                                 S01194
0099 I*****                                  12  13 DSCD                  S01194
0100 I*****                                  14  43 DSNM                  S01194
0101 I*****                                                               S01194
0102 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0103 I*****                                                               S01194
0104 I*****TABLE   NS  10   1 CD   2 C2   3 C0                            S01194
0105 I*****  AND      13 C1                                               S01194
0106 I*****                                   1   1 RECI                  S01194
0107 I*****                                   2   30RECT                  S01194
0108 I*****                                  10  12 CCY                   S01194
0109 I*****                                  13  130SREC                  S01194
0110 I*****                                  14  27 CCNM                  S01194
0111 I*****                               P  28  348SPOT                  S01194
0112 I*****                                  35  37 CCYS                  S01194
0113 I*****                                  38  380CDP                   S01194
0114 I*****                                  39  390TNOT                  S01194
0115 I*****                                  40  40 DCCY                  S01194
0116 I*****                                  41  44 SRC1                  S01194
0117 I*****                                  45  48 SRC2                  S01194
0118 I*****                                  49  520TACC                  S01194
0119 I*****                                  53  560TEQV                  S01194
0120 I*****                                  57  600SWQV                  S01194
0121 I*****                                  61  640TAC4                  S01194
0122 I*****                                  65  680TAC5                  S01194
0123 I*****                                  69  69 HIND                  S01194
0124 I*****                               P  70  768PART                  S01194
0125 I*****                                  77  780SSNO                  S01194
0126 I*****                               P  79  858ERLC                  S01194
0127 I*****                                                               S01194
0128 I*****CATCHALL                                                       S01194
0129 I*****                                                               S01194
0130 I*****   NS  06                                                      S01194
0131 I*****                                                               S01194
0132 I*****CLIENT FILE                                                    S01194
0133 I*****                                                               S01194
0134 I*****CLINT   NS  07   1 CD   8 CA                                   S01194
0135 I*****                                   9  28 CRNM                  S01194
0136 I*****                                                               S01194
0137 I*****CATCHALL                                                       S01194
0138 I*****                                                               S01194
0139 I*****   NS  08                                                      S01194
      *                                                                                       CDL021
     IHEADER                                                                                  CDL021
     I              CCY                             ACCY                                      CDL021
     I              DTYP                            ADTYP                                     CDL021
     I              DLST                            ADLST                                     CDL021
     I              CLAS                            ACLAS                                     CDL038
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 243 2460SWRIT                 S01117
     C*                                                                   S01117
     I@BINRY      DS                                                      S01117
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I                                    B   1   40@BKBIN                S01117
     ISPOOLU      DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01194
     I@BANK     E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     I@DLST     E DSSDDLSTPD                                              S01194
     I** EXTERNAL DS FOR DEAL  SUBTYPE DETAILS                            S01194
     I*                                                                   S01117
     I*                                                                   S01194
     I@CUST     E DSSDCUSTPD                                              S01194
     I** EXTERNAL DS FOR CUSTOMER DETAILS                                 S01194
     I*                                                                   S01194
     I@CURR     E DSSDCURRPD                                              S01194
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01194
     I*                                                                   CIR001
     I@GELR     E DSSDGELRPD                                                                MD025659
      ** EXTERNAL DS FOR GENERAL LEDGER DETAILS                                             MD025659
      *                                                                                     MD025659
     ISCSARD    E DSSCSARDPD                                              CIR001
     I** DUMMY RECORD FORMAT FOR SAR DETAILS                              CIR001
     I*
      *                                                                   S01408
     I/COPY WNCPYSRC,DL0520IIP1                                           S01408
      *                                                                   S01408
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01117
0140 I/EJECT
0141 C*
      *                                                                   S01117
      * ENTRY PARAMETER REQUIRED BY RCF                                   S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ                             S01117
     C                     PARM           PARMS   8                       CDL038
     C*********************PARM           PARMS   4                CDL021 CDL038
     C*                                                                   S01194
0142 C*    CONDITION FIRST CYCLE CALCS ON SACEX HEADER
0143 C*
     C           2         SUBSTPARMS:1   TYP1    2                                           CDL021
     C           2         SUBSTPARMS:3   TYP2    2                                           CDL021
     C           4         SUBSTPARMS:5   TYP3    4                                           CDL038
     C           TYP1      IFNE *BLANKS                                                       CDL021
     C           TYP1      ANDNE'**'                                                          CDL021
     C           *IN88     ANDEQ'0'                                                           CDL021
     C                     READ HEADER                   87                                   CDL021
     C                     MOVE '1'       *IN09                                               CDL021
     C                     ENDIF                                                              CDL021
0144 C  N09                GOTO DETAIL
     C           TYP1      IFNE *BLANKS                                                       CDL021
     C           TYP1      ANDNE'**'                                                          CDL021
     C                     MOVE '1'       *IN88                                               CDL021
     C           TYP2      IFNE *BLANKS                                                       CDL021
     C           TYP2      ANDNE'**'                                                          CDL021
     C                     MOVE '1'       *IN89                                               CDL021
     C                     ENDIF                                                              CDL021
     C                     ENDIF                                                              CDL021
0145 C                     SETON                     40
0146 C*****                EXSR ZSYSTM                                    S01194
0147 C***99                SETON                     U7U8LR               S01194
0148 C***99                GOTO END                                       S01194
     C                     MOVEACPY@      BIS@   80                       S01194
     C*
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10         ************* S01194
     C                     MOVEL'01'      DBASE   3         *DBERROR 001* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0327 C*    CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0328 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*
0149 C******               MOVE '1'       WRK4    4                       S01194
0150 C******               MOVE 'A'       KEYCL   7                       S01194
      *                                                                                     MD025659
      ** Call access program for GENERAL LEDGER details                                     MD025659
      *                                                                                     MD025659
     C                     CALL 'AOGELRR1'                                                  MD025659
     C                     PARM *BLANKS   @RTCD                                             MD025659
     C                     PARM '*FIRST ' @OPTN                                             MD025659
     C           @GELR     PARM @GELR     DSSDY                                             MD025659
     C           @RTCD     IFNE *BLANK                                                      MD025659
     C                     MOVEL'SDGELRPD'DBFILE                                            MD025659
     C                     MOVEL'013'     DBASE                                             MD025659
     C                     MOVEL@OPTN     DBKEY                                             MD025659
     C                     MOVE '1'       *INU7                                             MD025659
     C                     MOVE '1'       *INU8                                             MD025659
     C                     MOVE '1'       *INLR                                             MD025659
     C                     EXSR *PSSR                                                       MD025659
     C                     GOTO END                                                         MD025659
     C                     ENDIF                                                            MD025659
      *                                                                                     MD025659
     C           BKAPDT    IFLT BJDNWD                                                      MD025659
     C                     Z-ADDBKAPDT    ZDAYNO                                            MD025659
     C                     MOVE '0'       *IN26                                             MD025659
     C                     ELSE                                                             MD025659
     C           BJDNWD    SUB  1         ZDAYNO                                            MD025659
     C           BKALDI    IFEQ 'Y'                                                         MD025659
     C                     MOVE '0'       *IN26                                             MD025659
     C                     ELSE                                                             MD025659
     C                     MOVE '1'       *IN26                                             MD025659
     C                     ENDIF                                                            MD025659
     C                     ENDIF                                                            MD025659
0151 C**********           Z-ADDTDAT      ZDAYNO                                            MD025659
0152 C                     EXSR ZDATE2
0153 C                     MOVE ZADATE    TDATA   7
     C*                                                                   S01119
     C** Check if switchable feature CIR001 is switched on                CIR001
     C*                                                                   CIR001
     C                     CALL 'AOSARDR0'                                CIR001
     C                     PARM *BLANKS   @RTCD                           CIR001
     C                     PARM '*VERIFY' @OPTN                           CIR001
     C                     PARM 'CIR001'  @SARD   6                       CIR001
     C           SCSARD    PARM SCSARD    DSFDY                           CIR001
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANK                                    CIR001
     C           @RTCD     ANDNE'*NRF   '                                 CIR001
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR001
     C                     MOVEL'06'      DBASE            * DB ERROR 06 *CIR001
     C                     MOVEL'CIR001'  DBKEY            ***************CIR001
     C                     SETON                     U7U8LR               CIR001
     C                     EXSR *PSSR                                     CIR001
     C                     GOTO END                                       CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           @RTCD     IFEQ *BLANKS                                   CIR001
     C                     MOVE 'Y'       CIR001  1                       CIR001
     C                     MOVE '1'       *IN05                           CIR001
     C                     ELSE                                           CIR001
     C                     MOVE 'N'       CIR001                          CIR001
     C                     MOVE '0'       *IN05                           CIR001
     C                     END                                            CIR001
     C*                                                                   CIR002
     C** Check if switchable feature CIR002 is switched on                CIR002
     C*                                                                   CIR002
     C                     CALL 'AOSARDR0'                                CIR002
     C                     PARM *BLANKS   @RTCD                           CIR002
     C                     PARM '*VERIFY' @OPTN                           CIR002
     C                     PARM 'CIR002'  @SARD   6                       CIR002
     C           SCSARD    PARM SCSARD    DSFDY                           CIR002
     C*                                                                   CIR002
     C           @RTCD     IFNE *BLANK                                    CIR002
     C           @RTCD     ANDNE'*NRF   '                                 CIR002
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR002
     C                     MOVEL'07'      DBASE            * DB ERROR 07 *CIR002
     C                     MOVEL'CIR002'  DBKEY            ***************CIR002
     C                     SETON                     U7U8LR               CIR002
     C                     EXSR *PSSR                                     CIR002
     C                     GOTO END                                       CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C           @RTCD     IFEQ *BLANKS                                   CIR002
     C                     MOVE 'Y'       CIR002  1                       CIR002
     C                     MOVE '1'       *IN06                           CIR002
     C                     ELSE                                           CIR002
     C                     MOVE 'N'       CIR002                          CIR002
     C                     MOVE '0'       *IN06                           CIR002
     C                     END                                            CIR002
     C/COPY WNCPYSRC,DL0520CNB1
      *                                                                   CDL006
      ** Check if switchable feature CDL006 is switched on                CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM '       ' @RTCD                           CDL006
     C                     PARM '*VERIFY' @OPTN                           CDL006
     C                     PARM 'CDL006'  @SARD                           CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           @RTCD     IFNE *BLANKS                                   CDL006
     C           @RTCD     ANDNE'*NRF   '                                 CDL006
     C                     MOVEL'SCSARDPD'DBFILE                          CDL006
     C                     MOVEL'CDL006'  DBKEY                           CDL006
     C                     MOVEL'008'     DBASE                           CDL006
     C                     MOVE '1'       *INU7                           CDL006
     C                     MOVE '1'       *INU8                           CDL006
     C                     MOVE '1'       *INLR                           CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     GOTO END                                       CDL006
     C                     ELSE                                           CDL006
     C                     MOVE 'N'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           @RTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     ENDIF                                          CDL006
     C*                                                                   CIR001
      ** Check if switchable feature CIR006 is switched on                CIR006
      *                                                                   CIR006
     C                     CALL 'AOSARDR0'                                CIR006
     C                     PARM *BLANKS   @RTCD                           CIR006
     C                     PARM '*VERIFY' @OPTN                           CIR006
     C                     PARM 'CIR006'  @SARD   6                       CIR006
     C           SCSARD    PARM SCSARD    DSFDY                           CIR006
     C*                                                                   CIR006
     C           @RTCD     IFNE *BLANK                                    CIR006
     C           @RTCD     ANDNE'*NRF   '                                 CIR006
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR006
     C                     MOVEL'10'      DBASE            * DB ERROR 10 *CIR006
     C                     MOVEL'CIR006'  DBKEY            ***************CIR006
     C                     EXSR *PSSR                                     CIR006
     C                     GOTO END                                       CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           @RTCD     IFEQ *BLANKS                                   CIR006
     C                     MOVE 'Y'       CIR006  1                       CIR006
     C                     MOVE '1'       *IN06                           CIR006
     C                     ELSE                                           CIR006
     C                     MOVE 'N'       CIR006                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                                       CDL033
      ** Determine if Floating Rate CD Issued feature is                                      CDL033
      ** switched on.                                                                         CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    CDL033  1                                           CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*VERIFY' @OPTN                                               CDL033
     C                     PARM 'CDL033'  @SARD                                               CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVE 'Y'       CDL033                                              CDL033
     C                     ELSE                                                               CDL033
     C           @RTCD     IFNE '*NRF   '                                                     CDL033
     C                     MOVE '11'      DBASE                                               CDL033
     C                     MOVEL'CDL033'  DBKEY                                               CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO END                                                           CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0520CCP1                                           S01408
      *                                                                   S01408
0154 C           DETAIL    TAG                             ** DETAIL TAG *
0155 C  N01                GOTO TRAIL
0156 C   01                SETOF                     40
0157 C*****AT CHANGE OF DEAL SUB-TYPE, RECOVER NAME FROM TABLE FILE       S01194
0158 C***L1*               MOVEL'42'      KEYT   12                       S01194
0159 C***L1*               MOVE DLST      WRK3    4                       S01194
0160 C***L1*               MOVEL'  '      WRK3                            S01194
0161 C***L1*               MOVE WRK3      KEYT                            S01194
0162 C******               SETOF                     05                   S01194
0163 C***L1*     KEYT      CHAINTABLE                42                   S01194
0164 C***L1N05             SETON                     U7U8LR               S01194
0165 C***L1N05             GOTO END                                       S01194
     C*
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0520CCP8                                           S01408
      *                                                                   S01408
     C*   WHEN DEAL S/TYPE CHANGES
     C** CALL ACCESS PROGRAM FOR DEAL SUBTYPE DETAILS                     S01194
     C           *INL1     IFEQ '1'                                       S01194
     C                     CALL 'AODLSTR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*KEY    '@OPTN   7                       S01194
     C                     PARM DLST      @AQCD   2                       S01194
     C           @DLST     PARM @DLST     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDLSTPD'DBFILE 10         ************* S01194
     C                     MOVEL'02'      DBASE   3         *DBERROR 002* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     MOVELDLST      DBKEY  29                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   CDL038
     C** WHEN DEAL TYPE/SUB-TYPE/CLASS CHANGES                            CDL038
     C** ACCESS DEAL TYPE/SUB-TYPE NARRATIVE                              CDL038
     C*                                                                   CDL038
     C           DTSTK     KLIST                                          CDL038
     C                     KFLD           DTYP                            CDL038
     C                     KFLD           DLST                            CDL038
     C                     KFLD           CLAS                            CDL038
     C           DTSTK     CHAINFDDTSTL1             99                   CDL038
     C*                                                                   CDL038
     C           *IN99     IFEQ *OFF                                      CDL038
     C                     MOVELNARR11    DSTCNR                          CDL038
     C                     ELSE                                           CDL038
     C                     MOVEL*BLANK    DSTCNR                          CDL038
     C                     MOVELASDSTN    DSTCNR 35                       CDL038
     C                     ENDIF                                          CDL038
     C*
     C                     END                                            S01194
0166 C*
0167 C*    AT CHANGE OF DEAL TYPE, SET INDICATORS
0168 C   L2                SETOF                     35
0170 C   L2      RCDC      COMP 15                       15
0171 C   L2      RCDC      COMP 16                       16
0173 C   L2      RCDC      COMP 20                       19
0174 C   L2 15
0175 COR L2 16             SETON                     35
     C**
     C**   IF INTERNAL CONTRACT DEAL TYPE NOT REQUIRED
     C**
     C   L2 19             GOTO SKIPD
     C/COPY WNCPYSRC,DL0520C001
      *                                                                                       CDL033
     C***********CDL033****IFEQ 'Y'                                                    CDL033 CDL038
      *                                                                                       CDL033
      ** Floating Rate CD processing.                                                         CDL033
      *                                                                                       CDL033
     C   L2      DTYP      IFEQ 'CF'                                                          CDL033
      *                                                                                       CDL033
     C   L2      DTYP      LOKUPTAB1CP    TAB2CP         50                                   CDL033
     C   L2N50             SETON                     U7U8LR                                   CDL033
     C   L2N50             MOVEL'TAB1CP  'DBFILE                                              CDL033
     C   L2N50             MOVEL'12'      DBASE                                               CDL033
     C   L2N50             MOVEL'*KEY'    DBOPTN                                              CDL033
     C   L2N50             MOVELDTYP      DBKEY                                               CDL033
     C   L2N50             EXSR *PSSR                                                         CDL033
     C   L2N50             GOTO END                                                           CDL033
     C   L2 50             MOVELTAB2CP    NARR   50                                           CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
      *                                                                                       CDL033
     C**   CHANGED TO PRINT DTYPE INSTEAD OF RECORD TYPE AS NARRATIVE
     C   L2      DTYP      LOKUPTAB1      TAB2           50
     C   L2N50             SETON                     U7U8LR
     C   L2N50             MOVEL'TAB1    'DBFILE            ************* S01194
     C   L2N50             MOVEL'03'      DBASE             *DBERROR 003* S01194
     C   L2N50             MOVEL'*KEY'    DBOPTN            ************* S01194
     C   L2N50             MOVELDTYP      DBKEY                           S01194
     C   L2N50             EXSR *PSSR
     C   L2N50             GOTO END
      *                                                                   CDL006
     C           *INL2     IFEQ '1'                                       CDL006
     C           *IN50     ANDEQ'1'                                       CDL006
     C           CDL006    ANDEQ'N'                                       CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FL'                                      CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C                     MOVEL'TAB1    'DBFILE                          CDL006
     C                     MOVELDTYP      DBKEY                           CDL006
     C                     MOVEL'009'     DBASE                           CDL006
     C                     MOVE '1'       *INU7                           CDL006
     C                     MOVE '1'       *INU8                           CDL006
     C                     MOVE '1'       *INLR                           CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     GOTO END                                       CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C   L2 50             MOVELTAB2      NARR   50
     C**
     C/COPY WNCPYSRC,DL0520C002
      *                                                                                       CDL033
      ** Floating Rate CD processing.                                                         CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C*********************ENDIF                                                       CDL033 CDL038
      *                                                                                       CDL033
     C           SKIPD     TAG                             ** SKIPD TAG **
0176 C*
0177 C*    AT CHANGE OF CURRENCY, SET INDICATORS ACCORDING TO
0178 C*    NUMBER OF DECIMAL PLACES
0179 C*
0180 C***L3*               MOVEL'20'      KEYT                            S01194
0181 C***L3*               MOVELCCY       WRK4                            S01194
0182 C***L3*               MOVE WRK4      KEYT                            S01194
0183 C******               SETOF                     10                   S01194
0184 C***L3*     KEYT      CHAINTABLE                42                   S01194
0185 C***L3N10             SETON                     U7U8LR               S01194
0186 C***L3N10             GOTO END                                       S01194
     C** CALL ACCESS PROGRAM FOR BASE CURRENCY DETAILS                    S01194
     C           *INL3     IFEQ '1'                                       S01194
     C*
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM CCY       @AJCD   3                       S01194
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE            ************* S01194
     C                     MOVEL'04'      DBASE             *DBERROR 004* S01194
     C                     MOVEL@OPTN     DBOPTN            ************* S01194
     C                     MOVELCCY       DBKEY  29                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*
     C                     END                                            S01194
0768 C**
0187 C***L3      CDP       COMP 1                      3031               S01194
0187 C   L3      A6NBDP    COMP 1                      3031               S01194
0188 C***L3      CDP       COMP 2                    33  32               S01194
0188 C   L3      A6NBDP    COMP 2                    33  32               S01194
0189 C*
     C** AT CHANGE OF RECORD ID SET INDICATORS
     C   L4      RECID     COMP 'D'                      43
     C   L4      RECID     COMP 'E'                      44
     C   L4      RECID     COMP 'F'                      45
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           *INL4     ANDEQ'1'                                       CIR001
     C           RECID     COMP 'G'                      46               CIR001
     C                     END                                            CIR001
     C**
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0520CCP2                                           S01408
      *                                                                   S01408
0190 C*    ACCUMULATE NUMBER AND VALUE OF DETAIL RECORDS READ
0191 C*
0192 C           RECRED    ADD  1         RECRED  50
0193 C           PCPL      DIV  1000      ZZAMT        34
0194 C   34                Z-SUBZZAMT     ZZAMT
0195 C                     EXSR GLZADD
0196 C*
0197 C*    ACCUMULATE PRINCIPAL AMOUNT FOR DEAL SUB-TYPE IN PCPL1
0198 C*    ACCUMULATE ACCRUED TO DATE  FOR DEAL SUB-TYPE IN AMAD1
0199 C*    ACCUMULATE AMOUNT TO ACCRUE FOR DEAL SUB TYPE IN AMTA1
0200 C*
0201 C           PCPL1     ADD  PCPL      PCPL1  130
0202 C           AMAD1     ADD  AMAD      AMAD1  130
0203 C           AMTA1     ADD  AMTA      AMTA1  130
0204 C*
     C*                                                                   S01119
     C**   FRA/IRS DEAL TYPES MAY HAVE ACCRUAL AMOUNTS IN THEIR FIELDS.   S01119
     C**   ACCUMULATE THEIR ACCRUED TO DATE  FOR DEAL SUB-TYPE IN AMAD1.  S01119
     C**   ACCUMULATE THEIR AMOUNT TO ACCRUE FOR DEAL SUB-TYPE IN AMTA1.  S01119
     C*                                                                   S01119
     C                     ADD  TAMAD     AMAD1                           S01119
     C                     ADD  TAMTA     AMTA1                           S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0520CCP3                                           S01408
     C*                                                                   CIR002
     C** Check Total Unsettled Interest field if zero.                    CIR002
     C*                                                                   CIR002
     C                     MOVEA'00'      *IN,51                          CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0520CNB2
     C           OTUI      IFNE 0                                         CIR002
     C                     MOVE '1'       *IN51                           CIR002
     C                     END                                            CIR002
     C           TTUI      IFNE 0                                         CIR002
     C                     MOVE '1'       *IN52                           CIR002
     C                     END                                            CIR002
     C                     END                                            CIR002
     C*                                                                   S01119
     C*                                                                   S01119
0205 C*****CHAIN TO CLIENT FILE FOR CUSTOMER REPORTING NAME               S01194
0206 C*****                                                               S01194
0207 C*****                MOVELCNUM      KEYCL                           S01194
0208 C*****      KEYCL     CHAINCLINT                41                   S01194
0209 C**N07                SETON                     U7U8LR               S01194
0210 C**N07                GOTO END                                       S01194
     C*
     C                     MOVE CNUM      CNUMA   6                       S01119
     C*  OBTAIN CUSTOMER REPORTING TOWN
     C*
     C** CALL ACCESS PROGRAM FOR CUSTOMER DETAILS                         S01194
     C           *LIKE     DEFN BBCUST    ##LCUS                                              CSC042
     C           *LIKE     DEFN BBCLST    ##LLST                                              CSC042
     C           *LIKE     DEFN BBCRNM    ##LCNM                                              CSC042
     C           *LIKE     DEFN BBCRTN    ##LCTN                                              CSC042
     C           CNUMA     IFEQ ##LCUS                                                        CSC042
     C                     MOVEL##LLST    BBCLST                                              CSC042
     C                     MOVEL##LCNM    BBCRNM                                              CSC042
     C                     MOVEL##LCTN    BBCRTN                                              CSC042
     C                     ELSE                                                               CSC042
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM CNUMA     @AENB  10                       S01194
     C                     PARM *BLANKS   @KYST   7                       S01194
     C           @CUST     PARM @CUST     DSSDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCUSTPD'DBFILE            ************* S01194
     C                     MOVEL'05'      DBASE             *DBERROR 005* S01194
     C                     MOVEL@OPTN     DBOPTN            ************* S01194
     C                     MOVELCNUMA     DBKEY                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     ELSE                                                               CSC042
     C                     MOVELBBCUST    ##LCUS                                              CSC042
     C                     MOVELBBCLST    ##LLST                                              CSC042
     C                     MOVELBBCRNM    ##LCNM                                              CSC042
     C                     MOVELBBCRTN    ##LCTN                                              CSC042
     C                     END                                            S01194
     C                     END                                                                CSC042
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0520CCP9                                           S01408
     C*                                                                   S01408
     C*
     C*                                                                   S01119
     C**   FRA/IRS DEAL TYPES MAY CONTAIN REPORT DATA IN THEIR FIELDS.    S01119
     C*                                                                   S01119
     C**   'RS' DEAL TYPE CONVERT THEIR DATES.                            S01119
     C**   'RX' DEAL TYPE, CONVERT THEIR DATES FOR REPORT.                S01119
     C*****'RL'*DEAL*TYPE,*CONVERT*THEIR*DATES*FOR*REPORT.          S01119S01157
     C**   'RP', 'RF', 'RR' DEAL TYPE, CONVERT THEIR DATES FOR REPORT.    S01157
     C*                                                                   S01119
     C                     MOVE *BLANK    TACFDA  7                       S01119
     C                     MOVE *BLANK    TACTDA  7                       S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C********** DTYP      OREQ 'RL'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C                     Z-ADDTACFD     ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     MOVE ZADATE    TACFDA                          S01119
     C                     Z-ADDTACTD     ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     MOVE ZADATE    TACTDA                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**   SET PRINT CONTROL CONDITIONS.                                  S01119
     C*                                                                   S01119
     C**   IDENTIFY FRA/IRS DEAL RECORDS.                                 S01119
     C*                                                                   S01119
     C                     MOVEA'00000000'*IN,60           INDS. 60-67    S01119
     C                     MOVEA'0000'    *IN,68           INDS. 68-71    S01119
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0520CCP4                                           S01408
      *                                                                   S01408
     C           CIR001    IFEQ 'Y'                                       CIR001
     C                     MOVE '0'       *IN72            INDS. 72       CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           RECID     ANDEQ'G'                                       CIR001
     C                     MOVE '1'       *IN72                           CIR001
     C                     ELSE                                           CIR001
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C                     MOVE '1'       *IN61                           S01119
     C                     END                                            S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C                     MOVE '1'       *IN62                           S01119
     C                     END                                            S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C                     MOVE '1'       *IN63                           S01119
     C                     END                                            S01119
     C*                                                                   S01157
     C*                                                                   S01157
     C********** DTYP      IFEQ 'RL'                                      S01157
     C           DTYP      IFEQ 'RF'                                      S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C                     MOVE '1'       *IN64                           S01119
     C                     END                                            S01119
     C*                                                                   S01157
     C**   IF FLOOR DEAL DO NOT OUTPUT CEILING RATE.                      S01157
     C**   OUTPUT FLOOR RATE.                                             S01157
     C*                                                                   S01157
     C                     SETOF                     11                   S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RF'                                      S01157
     C                     SETON                     11                   S01157
     C                     END                                            S01157
     C*                                                                   S01119
     C           *IN61     IFEQ '1'                                       S01119
     C           *IN62     OREQ '1'                                       S01119
     C           *IN63     OREQ '1'                                       S01119
     C           *IN64     OREQ '1'                                       S01119
     C                     MOVE '1'       *IN60                           S01119
     C                     END                                            S01119
     C*                                                                   CIR001
     C                     END                                            CIR001
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0520CCP5                                           S01408
     C*                                                                   S01119
     C           *IN60     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C**   FRA/IRS DETERMINE RATE PRESENT.                                S01119
     C*                                                                   S01119
     C           URTPI     IFEQ 'Y'                        OUR RATE       S01119
     C                     MOVE '1'       *IN65            PRESENT        S01119
     C                     END                                            S01119
     C           TRTPI     IFEQ 'Y'                        THEIR RATE     S01119
     C                     MOVE '1'       *IN66            PRESENT        S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**   FR - IF BOTH RATES PRESENT FIND ACCRUAL AMOUNTS TO PRINT.      S01119
     C*                                                                   S01119
     C           *IN61     IFEQ '1'                                       S01119
     C           *IN65     ANDEQ'1'                                       S01119
     C           *IN66     ANDEQ'1'                                       S01119
     C           TAMAD     IFEQ 0                                         S01119
     C           TAMTA     ANDEQ0                                         S01119
     C                     MOVE '1'       *IN67            PRT. OURS      S01119
     C                     ELSE                                           S01119
     C                     MOVE '1'       *IN68            PRT. THEIRS    S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**   RS/RX - IF RATE PRESENT, SET ACCRUAL AMOUNT TO PRINT.          S01119
     C*                                                                   S01119
     C           *IN62     IFEQ '1'                                       S01119
     C           *IN63     OREQ '1'                                       S01119
     C           *IN65     IFEQ '1'                                       S01119
     C                     MOVE '1'       *IN67            PRT. OURS      S01119
     C                     END                                            S01119
     C           *IN66     IFEQ '1'                                       S01119
     C                     MOVE '1'       *IN68            PRT. THEIRS    S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**   RX - DETERMINE IF RECORD IS FOR OUR OR THEIR DETAILS.          S01119
     C*                                                                   S01119
     C           *IN63     IFEQ '1'                                       S01119
     C           ACFD      IFNE 0                                         S01119
     C                     MOVE '1'       *IN69            OUR DETAILS    S01119
     C                     ELSE                                           S01119
     C                     MOVE '1'       *IN70            THEIR DETAILS  S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*****RL*-*DETERMINE*IF*PROVIDERS*DETAILS*OURS*OR*THEIRS.      S01119S01157
     C**   RP, RF, RR - DETERMINE IF PROVIDERS DETAILS OURS OR THEIRS.    S01157
     C*                                                                   S01119
     C           *IN64     IFEQ '1'                                       S01119
     C           UBRTT     IFNE 0                                         S01119
     C                     MOVE '1'       *IN69            OUR DETAILS    S01119
     C                     ELSE                                           S01119
     C                     MOVE '1'       *IN70            THEIR DETAILS  S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*****RL*-*IF*PROVIDERS*RATE*PRESENT,*SET*ACCRUAL*AMOUNTS*TO*P S01119S01157
     C**   RP, RF. RR - IF PROVIDERS RATE PRESENT, SET ACCRUAL AMOUNTS .  S01157
     C**                TO PRINT.                                      .  S01157
     C*                                                                   S01119
     C           *IN69     IFEQ '1'                                       S01119
     C           *IN65     ANDEQ'1'                                       S01119
     C           *IN70     OREQ '1'                                       S01119
     C           *IN66     ANDEQ'1'                                       S01119
     C           TAMAD     IFEQ 0                                         S01119
     C           TAMTA     ANDEQ0                                         S01119
     C                     MOVE '1'       *IN67                           S01119
     C                     ELSE                                           S01119
     C                     MOVE '1'       *IN68                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*****RL*-*CHECK*IF*FLOOR*RATE*PRESENT.                        S01119S01157
     C**   RP, RF, RR - CHECK IF FLOOR RATE PRESENT.                      S01157
     C*                                                                   S01119
     C           FLRIND    IFEQ 'Y'                                       S01119
     C                     MOVE '1'       *IN71                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
0211 C*
0212 C*    CONVERT 'ACCRUAL FROM' AND 'PERIOD TO' DATES TO ALPHA FORMAT
0213 C*
0214 C                     Z-ADDACFD      ZDAYNO
0215 C                     EXSR ZDATE2
0216 C                     MOVE ZADATE    ACFDA   7
0217 C   35N21             GOTO TRAIL
0218 C                     Z-ADDACTD      ZDAYNO
0219 C                     EXSR ZDATE2
0220 C                     MOVE ZADATE    ACTDA   7
0221 C           TRAIL     TAG                             ** TRAIL TAG **
0222 C  N02                GOTO END
0223 C           RECRED    ADD  2         RECRED
0224 C           NORE      COMP RECRED               8080
0225 C           ZZTOTI    COMP HRWN                 8181
0226 C  N81      ZZTOTD    COMP HRDC                 8181
0227 C   80
0228 COR 81                SETON                     U8
0229 C           END       TAG                             ** END TAG **
0230 C*
0231 C*    INCREMENT LINE COUNT TO CONDITION OVERFLOW
0232 C   OF                Z-ADD0         LINE    20
0233 C   L3
0234 COR OFNL3   LINE      ADD  12        LINE
0235 C   L2
0236 COR OFNL2   LINE      ADD  2         LINE
0237 C   L1
0238 COR OFNL1   LINE      ADD  2         LINE
0239 C   01      LINE      ADD  1         LINE
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0520CCP6                                           S01408
      *                                                                   S01408
     C***61******                                          FR 2ND LS01119 CIR001
     C***OR*62***                                          RS 2ND LS01119 CIR001
     C*R*64******LINE******ADD**1*********LINE*************RL*2ND*L S01119S01157
     C*****RP,*RF,*RR*2ND*LINE                                     S01157 CIR001
     C***OR*64***   LINE      ADD  1         LINE                  S01157 CIR001
     C***71*64***LINE******ADD**1*********LINE*************RL*FLOOR S01119S01157
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0520CCP7                                           S01408
      *                                                                   S01408
     C*                                                                   CIR001
     C           *IN61     IFEQ '1'                        FR 2ND LINE    CIR001
     C           *IN62     OREQ '1'                        RS 2ND LINE    CIR001
     C           *IN64     OREQ '1'                        RP,RF,RR 2ND   CIR001
     C           *IN72     OREQ '1'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C           LINE      ADD  1         LINE                            CIR001
     C                     END                                            CIR001
     C*                                                                   CIR002
     C**  RS Total unsettled interest line                                CIR002
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0520CNB3
     C*                                                                   CIR002
     C           *IN62     IFEQ '1'                                       CIR002
     C           *IN51     IFEQ '1'                                       CIR002
     C                     ADD  1         LINE                            CIR002
     C                     END                                            CIR002
     C           *IN52     IFEQ '1'                                       CIR002
     C                     ADD  1         LINE                            CIR002
     C                     END                                            CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C**  RR, RF, RP Total unsettled interest line                        CIR002
     C*                                                                   CIR002
     C           *IN64     IFEQ '1'                                       CIR002
     C           *IN51     IFEQ '1'                                       CIR002
     C           *IN52     OREQ '1'                                       CIR002
     C                     ADD  1         LINE                            CIR002
     C                     END                                            CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C**   RP, RF, RR FLOOR LINE                                          S01157
     C   71 64   LINE      ADD  1         LINE                            S01157
0240 C**                                                                  E15059
0253 C**   LINE CHECK TO CONDITION OVERFLOW FOR DETAIL OUTPUT             E15059
0240 C**                                                                  E15059
     CL1NOF      LINE      COMP 52                   OF                   E15059
     CL2NOF      LINE      COMP 50                   OF                   E15059
     CL3NOF      LINE      COMP 48                   OF                   E15059
0240 C**
0241 C**   LEVEL BREAK CALCULATIONS
0242 C**
0243 C*
0244 C*    ADD SUB-TOTALS TO RUNNING TOTALS
0245 CL1         PCPL2     ADD  PCPL1     PCPL2  130
0246 CL1         AMAD2     ADD  AMAD1     AMAD2  130
0247 CL1         AMTA2     ADD  AMTA1     AMTA2  130
     CL1         LINE      ADD  3         LINE
     C*L1NOF***  LINE      COMP 60                   OF                   E11212
     C*L1NOF***  LINE      COMP 56                   OF         E11212    E15059
     CL1NOF      LINE      COMP 52                   OF                   E15059
0248 C*
0249 CL2         PCPL3     ADD  PCPL2     PCPL3  130
0250 CL2         AMAD3     ADD  AMAD2     AMAD3  130
0251 CL2         AMTA3     ADD  AMTA2     AMTA3  130
0252 C*
0253 C*    LINE CHECK TO CONDITION OVERFLOW
     CL2         LINE      ADD  2         LINE
     C*L2NOF***  LINE      COMP 58                   OF                   E11212
     C*L2NOF***  LINE      COMP 54                   OF         E11212    E15059
     CL2NOF      LINE      COMP 50                   OF                   E15059
     C/COPY WNCPYSRC,DL0520C003
     CL3         LINE      ADD  1         LINE
     C*L3NOF***  LINE      COMP 56                   OF                   E11212
     C*L3NOF***  LINE      COMP 52                   OF         E11212    E15059
     CL3NOF      LINE      COMP 48                   OF                   E15059
0257 CL3                   Z-ADD0         LINE
     C*                                                                   098321
     CL1 OF                Z-ADD0         LINE                            186259
     CL1 OF                EXCPT                                          098321
     C*
     C** ENSURE SPOOL FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   S01117
     C** TO. SWRIT IS INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       S01117
     C** FILE - IF IT IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    S01117
     C** THE FILE. UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     S01117
     C** AN UNITIALISED BINARY FIELD.                                     S01117
     CLR                   MOVE '0'       *IN04                           S01117
     CLR         SWRIT     IFNE 0                                         S01117
     CLR         SWRIT     ANDNE@BKBIN                                    S01117
     CLR                   MOVE '1'       *IN04                           S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR                   MOVE '1'       *INLR                           S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0509 C*                                                                   S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUMU    ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    @PARM                           S01117
     CLR                   PARM           SFILEU                          E135
     CLR                   PARM           ZSNUM                           S01117
     C*R**                 PARM           SFNUMU                   S01117 E135
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR                   MOVE '1'       *INLR                           S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C/COPY WNCPYSRC,DL0520C004
0258 C*
0259 C********************************************************************
0260 C**
0261 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0262 C**
0263 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0264 C**
0265 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0266 C**
0267 C**   CLEAR DATE FIELDS.
0268 C                     Z-ADD0         ZDATE   60
0269 C                     MOVEL'       ' ZADATE  7
0270 C**
0271 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0272 C                     Z-ADDZDAYNO    ZDAYNO  50
0273 C**
0274 C**   DETERMINE YEAR NUMBER.
0275 C**
0276 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0277 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0278 C   99                GOTO ZDEND2
0279 C**
0280 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0281 C           ZDAYN1    DIV  1461      ZLYR    20
0282 C                     MVR            ZDAYN1           SAVE REMAINING
0283 C**                                                   DAYS
0284 C**   CALCULATE NUMBER OF REMAINING YEARS.
0285 C                     Z-ADD1         ZWRK2   20
0286 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0287 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0288 C  N90      ZWRK2     ADD  1         ZWRK2
0289 C  N90                GOTO ZDTAG1
0290 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0291 C**
0292 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0293 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0294 C**
0295 C**   CALCULATE ACTUAL YEAR NUMBER.
0296 C           ZLYR      MULT 4         ZWRK3   30
0297 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0298 C                     Z-ADDZWRK3     ZYEAR   20
0299 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0300 C**
0301 C**   DETERMINE MONTH NUMBER.
0302 C**
0303 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0304 C                     SETOF                     9293
0305 C   91      ZDAYN1    COMP 59                     9293
0306 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0307 C**
0308 C**   CALCULATE MONTH NUMBER.
0309 C                     Z-ADD2         ZWRK2
0310 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0311 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0312 C  N94      ZWRK2     ADD  1         ZWRK2
0313 C  N94                GOTO ZDTAG2
0314 C           ZWRK2     SUB  1         ZWRK2
0315 C**
0316 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0317 C**
0318 C**   DETERMINE DAY OF MONTH.
0319 C**
0320 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0321 C           ZDAYN1    ADD  1         ZDAYN1
0322 C**
0323 C**   CALCULATE DAY OF MONTH.
0324 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0325 C**
0326 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0327 C   93      ZDAY      ADD  1         ZDAY
0328 C**
0329 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0330 C  N98                MOVELZDAY      ZWRK4   40
0331 C   98                MOVE ZDAY      ZWRK4
0332 C  N98                MOVE ZMTH      ZWRK4
0333 C   98                MOVELZMTH      ZWRK4
0334 C                     MOVELZWRK4     ZDATE
0335 C                     MOVE ZYEAR     ZDATE
0336 C**
0337 C**   FORMAT ALPHA DATE, DDMMMYY.
0338 C           ZDAY      COMP 10                     95
0339 C                     MOVELZDAY      ZWRK5   5
0340 C   95                MOVEL' '       ZWRK5
0341 C                     MOVE ZMNM,ZMTH ZWRK5
0342 C                     MOVELZWRK5     ZADATE
0343 C                     MOVE ZYEAR     ZADATE
0344 C**
0345 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0346 C**
0347 C********************************************************************
0348 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0349 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0350 C*
0351 CSR         GLZADD    BEGSR                           *** GLZADD ****
0352 C*
0353 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0354 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0355 C*
0356 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0357 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0358 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0359 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0360 C*
0361 CSR                   EXSR GLZSUM
0362 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0363 C*
0364 C********************************************************************
0365 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0366 C*                        GLZADD, GLZSUB, GLZCMP.
0367 C*          PARAMETERS PASSED -
0368 C*                     I/P ZZAMTI ZZAMTD
0369 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0370 C*
0371 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0372 C*
0373 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0374 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0375 CSR                   SETOF                     919293
0376 CSR                   SETOF                     949599
0377 C*
0378 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0379 CSR         ZZAMTI    COMP 0                      9293
0380 CSR 93      ZZAMTD    COMP 0                      9293
0381 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0382 C*
0383 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0384 CSR         ZZTOTI    COMP 0                      9193
0385 CSR 93      ZZTOTD    COMP 0                      9193
0386 C*
0387 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0388 CSR 93                Z-ADDZZAMTI    ZZTOTI
0389 CSR 93                Z-ADDZZAMTD    ZZTOTD
0390 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0391 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0392 CSR 91N92
0393 CORN91 92             GOTO ZZOFPS
0394 C*
0395 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0396 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0397 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0398 C*
0399 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0400 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0401 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0402 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0403 C*
0404 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0405 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0406 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0407 CSRN99                Z-ADDZZWK2     ZZTOTD
0408 CSRN99                Z-ADDZZWK3     ZZTOTI
0409 C*
0410 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0411 CSR 99                Z-ADD0         ZZAMT  153
0412 CSR                   GOTO ZZSEND
0413 C*
0414 C* THE 'SIGNS' ARE DIFFERENT
0415 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0416 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0417 C*
0418 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0419 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0420 C*
0421 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0422 C*
0423 CSR 91                Z-SUBZZTOTI    ZZTOTI
0424 CSR 91                Z-SUBZZTOTD    ZZTOTD
0425 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0426 C*
0427 CSR         ZZTOTI    COMP ZZAMTI               93  95
0428 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0429 C*
0430 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0431 CSR 95                Z-ADD0         ZZTOTI
0432 CSR 95                Z-ADD0         ZZTOTD
0433 CSR 95                GOTO ZZSEND
0434 C*
0435 C* IF ZZTOT GT. ZZAMT.
0436 CSR 93      ZZAMTD    COMP ZZTOTD               94
0437 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0438 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0439 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0440 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0441 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0442 C*
0443 C*
0444 C* IF ZZAMT GT. ZZTOT.
0445 CSRN93      ZZTOTD    COMP ZZAMTD               94
0446 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0447 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0448 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0449 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0450 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0451 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0452 C*
0453 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0454 CSR                   SETOF                     94
0455 CSR 93 91
0456 CORN93 92             SETON                     94
0457 CSR 94                Z-SUBZZTOTI    ZZTOTI
0458 CSR 94                Z-SUBZZTOTD    ZZTOTD
0459 C**
0460 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0461 CSR 92                Z-SUBZZAMTI    ZZAMTI
0462 CSR 92                Z-SUBZZAMTD    ZZAMTD
0463 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0464 C**
0465 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0466 CSR                   SETOF                     96
0467 CSR         ZZTOTD    COMP 0                        91
0468 CSR 91      ZZTOTI    COMP 0                      96
0469 CSR 96                MOVE '.000-'   ZZNEGD  5
0470 CSR                   ENDSR                             ** ENDSR **
0471 C********************************************************************
0472 C*****                                                               S01194
0473 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0474 C*****                                                               S01194
0475 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0476 C*****                                                               S01194
0477 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0478 C*****                MOVEL'01      'ZTABKY 12                       S01194
0479 C*****                MOVE '  10'    ZTABKY                          S01194
0480 C*****                                                               S01194
0481 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0482 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0483 C*****                                                               S01194
0484 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0485 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0486 C*****                                                               S01194
0487 C*****                ENDSR                                          S01194
0488 C*****                                                               S01194
0489 C*****                                                               S01194
0646 C********************************************************************S01194
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0490 C********************************************************************
0491 C/EJECT
0492 ODL0520P1D  203   L3                                                 S01124
0493 O       OR        OFNL3
0494 O*******                            22 'REFERENCE DL0520'            S01117
0494 O                                   24 'REFERENCE DL0520P1'          S01117
0495 O*******                  TITL      89                               S01194
0495 O                         BJURPT    89                               S01194
0496 O                                  104 'DATE'
0497 O*******                  RUNA     112                               S01194
0497 O                         BJMRDT   112                               S01194
0498 O                                  122 'PAGE'
0499 O                         PAGE  Z  127
0500 O        D  1     L3
0501 O       OR        OFNL3
0502 O**                                 68 'INTEREST ACCRUALS -'
     O                       43          57 'INTEREST ACCRUALS -'
     O                       44          46 'DISCOUNT/PREMIUM'
     O                       44          57 'ACCRUALS -'
     O                       45          46 'SWAP PROFIT/LOSS'
     O                       45          57 'ACCRUALS -'
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OOP1                                           S01408
      *                                                                   S01408
     O                    46 05          57 'FEE AMORTIZATION  -'         CIR001
0504 O**********                         67 'UP TO BUT'                                     MD025659
0505 O**********                         79 'EXCLUDING -'                                   MD025659
     O                                   63 'UP TO'                                         MD025659
     O                 26                77 '& EXCLUDING -'                                 MD025659
     O                N26                77 '& INCLUDING -'                                 MD025659
0506 O                         TDATA     87
     O                    88             94 ' - TYPE'                                         CDL021
     O                    88   TYP1      97                                                   CDL021
     O                 88 89   TYP2     100                                                   CDL021
     O                 88 89   TYP3     104                                                   CDL038
0507 O        D  3     L3
0508 O       OR        OFNL3
     O                       44          38 '--------'
     O                       45          38 '--------'
0509 O                                   62 '------------------------'
0510 O                                   86 '------------------------'
0511 O                                   87 '-'
0507 O        D  2     L3                                                 LN0614
0508 O       OR        OFNL3                                              LN0614
     O                                   18 'CONSOLIDATED'                LN0614
0512 O        D  1     L3
0513 O       OR        OFNL3
0514 O**********                         12 'CUSTOMER'                    S01268
0514 O                                    5 'CUST.'                       S01268
     O                                   11 'NAME'                        S01268
0515 O                                   51 'DEAL   ACCRUAL PERIOD '
0516 O        D  2     L3
0517 O       OR        OFNL3
     O                                   11 'NUMBER TOWN'                 S01268
0518 O                                   49 'NUMBER   FROM     TO '
0519 O***                                69 'RATE     CCY'                S01119
0520 O***                               101 'PRINCIPAL       ACCRUED'     S01119
0521 O***                               125 'TO DATE       TO ACCRUE'     S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OOP9                                           S01408
      *                                                                   S01408
0519 O***********************************72 'RATE     CCY'         S01119 CIR001
0519 O                N05                72 'RATE     CCY'                CIR001
0519 O                N46 05             72 'RATE     CCY'                CIR001
0519 O                 46 05             72 '         CCY'                CIR001
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OOP2                                           S01408
      *                                                                   S01408
0520 O                                  104 'PRINCIPAL       ACCRUED'     S01119
0521 O                                  128 'TO DATE       TO ACCRUE'     S01119
0522 O        D  2     L2
0523 O       OR  2     OFNL2
     O                 50N19   DTYP       3                               CDL038
     O                 50N19   NARR      58                               CDL038
0530 O                 19                26 'INTERNAL CONTRACTS'          CDL038
     O*****************50N19   NARR      54                               CDL038
0530 O*****************19                22 'INTERNAL CONTRACTS'          CDL038
0531 O        D  2     L1
0532 O       OR  2     OFNL1
0533 O                         DLST       3
0534 O******                   DSNM      34                               S01194
0534 O*************************ASDSTN    34                        S01194 CDL038
     O                         CLAS       7                               CDL038
     O                         DSTCNR    43                               CDL038
0535 O***     DF 1     01                                                 S01119
0535 O*****   DF 1     01N60                                       S01119 E11212
0535 O*                                                                   S01268
0535 O* NOT FRA/IRS                                                       S01268
0535 O*                                                                   S01268
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OP10                                           S01408
      *                                                                   S01408
0535 O********D**1     01N60                                       E11212 CIR001
0535 O        D  1     01N60N05                                           CIR001
0535 O       OR  1     01N60N72                                           CIR001
0535 O       AND       05                                                 CIR001
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OOP3                                           S01408
      *                                                                   S01408
0536 O                         CNUM       6
0537 O******                   CRNM      27                               S01194
0537 O                         BBCRNM    27                               S01194
0538 O                         DLNO      34
0539 O                         ACFDA     43
0540 O                         ACTDA     51
0541 O                    20 35          51 'CALL   '
0542 O                    22 35          51 'NOTICE '
0543 O***                      INTR      65 '  0 .       -'               S01119
0544 O***              23 19             65 '             '               S01119
0545 O***                      CCY       69                               S01119
0546 O***                    30PCPL      88 ' ,   ,   ,   , 0 -'          S01119
0547 O***                    31PCPL      88 '   ,   ,   , 0 . -'          S01119
0548 O***                    32PCPL      88 '  ,   ,   , 0 .  -'          S01119
0549 O***                    33PCPL      88 ' ,   ,   , 0 .   -'          S01119
0550 O***                    30AMAD     109 ' ,   ,   ,   , 0 -'          S01119
0551 O***                    31AMAD     109 '   ,   ,   , 0 . -'          S01119
0552 O***                    32AMAD     109 '  ,   ,   , 0 .  -'          S01119
0553 O***                    33AMAD     109 ' ,   ,   , 0 .   -'          S01119
0554 O***                    30AMTA     128 ' ,   ,   ,   , 0 -'          S01119
0555 O***                    31AMTA     128 '   ,   ,   , 0 . -'          S01119
0556 O***                    32AMTA     128 '  ,   ,   , 0 .  -'          S01119
0557 O***                    33AMTA     128 ' ,   ,   , 0 .   -'          S01119
0558 O***                 35N21         128 '                  '          S01119
     O                         INTR      68 '  0 .       -'               S01119
     O                 23 19             68 '             '               S01119
     O                         CCY       72                               S01119
     O                       30PCPL      91 ' ,   ,   ,   , 0 -'          S01119
     O                       31PCPL      91 '   ,   ,   , 0 . -'          S01119
     O                       32PCPL      91 '  ,   ,   , 0 .  -'          S01119
     O                       33PCPL      91 ' ,   ,   , 0 .   -'          S01119
     O                       30AMAD     112 ' ,   ,   ,   , 0 -'          S01119
     O                       31AMAD     112 '   ,   ,   , 0 . -'          S01119
     O                       32AMAD     112 '  ,   ,   , 0 .  -'          S01119
     O                       33AMAD     112 ' ,   ,   , 0 .   -'          S01119
     O                       30AMTA     131 ' ,   ,   ,   , 0 -'          S01119
     O                       31AMTA     131 '   ,   ,   , 0 . -'          S01119
     O                       32AMTA     131 '  ,   ,   , 0 .  -'          S01119
     O                       33AMTA     131 ' ,   ,   , 0 .   -'          S01119
     O                    35N21         131 '                  '          S01119
     O*                                                                   S01268
     O        D  1     01N60                                              S01268
     O                         BBCRTN    17                               S01268
     O*                                                                   S01268
0559 O***     TF12     L1N40                                              S01119
0560 O***                                65 'DEAL SUB-TYPE TOTAL'         S01119
0561 O***                    30PCPL1  B  88 ' ,   ,   ,   , 0 -'          S01119
0562 O***                    31PCPL1  B  88 '   ,   ,   , 0 . -'          S01119
0563 O***                    32PCPL1  B  88 '  ,   ,   , 0 .  -'          S01119
0564 O***                    33PCPL1  B  88 ' ,   ,   , 0 .   -'          S01119
0565 O***                    30AMAD1  B 109 ' ,   ,   ,   , 0 -'          S01119
0566 O***                    31AMAD1  B 109 '   ,   ,   , 0 . -'          S01119
0567 O***                    32AMAD1  B 109 '  ,   ,   , 0 .  -'          S01119
0568 O***                    33AMAD1  B 109 ' ,   ,   , 0 .   -'          S01119
0569 O***                    30AMTA1  B 128 ' ,   ,   ,   , 0 -'          S01119
0570 O***                    31AMTA1  B 128 '   ,   ,   , 0 . -'          S01119
0571 O***                    32AMTA1  B 128 '  ,   ,   , 0 .  -'          S01119
0572 O***                    33AMTA1  B 128 ' ,   ,   , 0 .   -'          S01119
0573 O***     TF 2     L2N40                                              S01119
0574 O***                                65 'DEAL TYPE TOTAL'             S01119
0575 O***                    30PCPL2  B  88 ' ,   ,   ,   , 0 -'          S01119
0576 O***                    31PCPL2  B  88 '   ,   ,   , 0 . -'          S01119
0577 O***                    32PCPL2  B  88 '  ,   ,   , 0 .  -'          S01119
0578 O***                    33PCPL2  B  88 ' ,   ,   , 0 .   -'          S01119
0579 O***                    30AMAD2  B 109 ' ,   ,   ,   , 0 -'          S01119
0580 O***                    31AMAD2  B 109 '   ,   ,   , 0 . -'          S01119
0581 O***                    32AMAD2  B 109 '  ,   ,   , 0 .  -'          S01119
0582 O***                    33AMAD2  B 109 ' ,   ,   , 0 .   -'          S01119
0583 O***                    30AMTA2  B 128 ' ,   ,   ,   , 0 -'          S01119
0584 O***                    31AMTA2  B 128 '   ,   ,   , 0 . -'          S01119
0585 O***                    32AMTA2  B 128 '  ,   ,   , 0 .  -'          S01119
0586 O***                    33AMTA2  B 128 ' ,   ,   , 0 .   -'          S01119
0587 O***     TF 1     L3N40                                              S01119
0588 O***                                65 'CURRENCY TOTAL'              S01119
0589 O***                      CCY       69                               S01119
0590 O***                    30PCPL3  B  88 ' ,   ,   ,   , 0 -'          S01119
0591 O***                    31PCPL3  B  88 '   ,   ,   , 0 . -'          S01119
0592 O***                    32PCPL3  B  88 '  ,   ,   , 0 .  -'          S01119
0593 O***                    33PCPL3  B  88 ' ,   ,   , 0 .   -'          S01119
0594 O***                    30AMAD3  B 109 ' ,   ,   ,   , 0 -'          S01119
0595 O***                    31AMAD3  B 109 '   ,   ,   , 0 . -'          S01119
0596 O***                    32AMAD3  B 109 '  ,   ,   , 0 .  -'          S01119
0597 O***                    33AMAD3  B 109 ' ,   ,   , 0 .   -'          S01119
0598 O***                    30AMTA3  B 128 ' ,   ,   ,   , 0 -'          S01119
0599 O***                    31AMTA3  B 128 '   ,   ,   , 0 . -'          S01119
0600 O***                    32AMTA3  B 128 '  ,   ,   , 0 .  -'          S01119
0601 O***                    33AMTA3  B 128 ' ,   ,   , 0 .   -'          S01119
     O*                                                                   S01119
     O**   FR/RS - COMMON & OUR DETAILS.                                  S01119
     O**   RX    - OUR DETAILS.                                           S01119
     O*                                                                   S01119
     O*****   DF 1     01 61                                       S01119 E11212
     O*****  ORF 1     01 62                                       S01119 E11212
     O*****  ORF 1     01 63 69                                    S01119 E11212
     O        D  1     01 61                                              E11212
     O       OR  1     01 62                                              E11212
     O       OR  1     01 63 69                                           E11212
     O                         CNUM       6                               S01119
     O******                   CRNM      27                        S01119 S01194
     O                         BBCRNM    27                               S01194
     O                         DLNO      34                               S01119
     O                         ACFDA     43                               S01119
     O                         ACTDA     51                               S01119
     O                 24      UBRTT     54                               S01119
     O                 65      INTR      68 '  0 .       -'               S01119
     O                         CCY       72                               S01119
     O                 30      PCPL      91 ' ,   ,   ,   , 0 -'          S01119
     O                 31      PCPL      91 '   ,   ,   , 0 . -'          S01119
     O                 32      PCPL      91 '  ,   ,   , 0 .  -'          S01119
     O                 33      PCPL      91 ' ,   ,   , 0 .   -'          S01119
     O                 30 67   AMAD     112 ' ,   ,   ,   , 0 -'          S01119
     O                 31 67   AMAD     112 '   ,   ,   , 0 . -'          S01119
     O                 32 67   AMAD     112 '  ,   ,   , 0 .  -'          S01119
     O                 33 67   AMAD     112 ' ,   ,   , 0 .   -'          S01119
     O                 30 67   AMTA     131 ' ,   ,   ,   , 0 -'          S01119
     O                 31 67   AMTA     131 '   ,   ,   , 0 . -'          S01119
     O                 32 67   AMTA     131 '  ,   ,   , 0 .  -'          S01119
     O                 33 67   AMTA     131 ' ,   ,   , 0 .   -'          S01119
     O*                                                                   S01119
     O**   FR/RS - THEIR DETAILS.                                         S01119
     O*                                                                   S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OP11                                           S01408
      *                                                                   S01408
     O********D**1     01 61                                       S01119 CIR002
     O*******OR**1     01 62                                       S01119 CIR002
     O********D**1     01 61N06                                           CIR002             BUG8167
     O*******OR**1     01 62N06                                           CIR002             BUG8167
     O*******OR**1     01 62 06                                           CIR002             BUG8167
     O*******AND      N51                                                 CIR002             BUG8167
     O        D  1     01 61                                                                 BUG8167
     O       OR  1     01 62                                                                 BUG8167
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OOP4                                           S01408
      *                                                                   S01408
     O                         BBCRTN    17                               S01268
     O                 62      TACFDA    43                               S01119
     O                 62      TACTDA    51                               S01119
     O                 25      TBRTT     54                               S01119
     O                 66      TEINR     68 '  0 .       -'               S01119
     O                 30 68   TAMAD    112 ' ,   ,   ,   , 0 -'          S01119
     O                 31 68   TAMAD    112 '   ,   ,   , 0 . -'          S01119
     O                 32 68   TAMAD    112 '  ,   ,   , 0 .  -'          S01119
     O                 33 68   TAMAD    112 ' ,   ,   , 0 .   -'          S01119
     O                 30 68   TAMTA    131 ' ,   ,   ,   , 0 -'          S01119
     O                 31 68   TAMTA    131 '   ,   ,   , 0 . -'          S01119
     O                 32 68   TAMTA    131 '  ,   ,   , 0 .  -'          S01119
     O                 33 68   TAMTA    131 ' ,   ,   , 0 .   -'          S01119
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OOP5                                           S01408
      *                                                                   S01408
     O*                                                                   CIR002
     O** Our total unsettled interest not zero.                           CIR002
     O        D  1     01 62 06                                           CIR002
     O       AND       51                                                 CIR002
     O                         BBCRTN    17                               CIR002
     O                                   61 'Total Unsettled'             CIR002
     O                                   72 'Interest :'                  CIR002
     O                 30      OTUI     112 '   ,   ,   ,   , 0 -'        CIR002
     O                 31      OTUI     112 '  ,   ,   ,   , 0 . -'       CIR002
     O                 32      OTUI     112 ' ,   ,   ,   , 0 .  -'       CIR002
     O                 33      OTUI     112 '   ,   ,   , 0 .   -'        CIR002
     O*                                                                   CIR002
     O        D  1     01 62 06                                           CIR002
     O       AND       51                                                 CIR002
     O                 62      TACFDA    43                               CIR002
     O                 62      TACTDA    51                               CIR002
     O                 25      TBRTT     54                               CIR002
     O                 66      TEINR     68 '  0 .       -'               CIR002
     O                 30 68   TAMAD    112 ' ,   ,   ,   , 0 -'          CIR002
     O                 31 68   TAMAD    112 '   ,   ,   , 0 . -'          CIR002
     O                 32 68   TAMAD    112 '  ,   ,   , 0 .  -'          CIR002
     O                 33 68   TAMAD    112 ' ,   ,   , 0 .   -'          CIR002
     O                 30 68   TAMTA    131 ' ,   ,   ,   , 0 -'          CIR002
     O                 31 68   TAMTA    131 '   ,   ,   , 0 . -'          CIR002
     O                 32 68   TAMTA    131 '  ,   ,   , 0 .  -'          CIR002
     O                 33 68   TAMTA    131 ' ,   ,   , 0 .   -'          CIR002
     O*                                                                   CIR002
     O** Their total unsettled interest not zero.                         CIR002
     O        D  1     01 62 06                                           CIR002
     O       AND       52                                                 CIR002
     O                                   61 'Total Unsettled'             CIR002
     O                                   72 'Interest :'                  CIR002
     O                 30      TTUI     112 '   ,   ,   ,   , 0 -'        CIR002
     O                 31      TTUI     112 '  ,   ,   ,   , 0 . -'       CIR002
     O                 32      TTUI     112 ' ,   ,   ,   , 0 .  -'       CIR002
     O                 33      TTUI     112 '   ,   ,   , 0 .   -'        CIR002
0535 O*                                                                   S01268
0535 O* TOWN FOR RX - OUR DETAILS                                         S01268
0535 O*                                                                   S01268
     O        D  1     01 63 69                                           S01119
     O                         BBCRTN    17                               S01268
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OOP6                                           S01408
      *                                                                   S01408
     O                    51 06          61 'Total Unsettled'             CIR002
     O                    51 06          72 'Interest :'                  CIR002
     O                 30 51 06OTUI     112 '   ,   ,   ,   , 0 -'        CIR002
     O                 31 51 06OTUI     112 '  ,   ,   ,   , 0 . -'       CIR002
     O                 32 51 06OTUI     112 ' ,   ,   ,   , 0 .  -'       CIR002
     O                 33 51 06OTUI     112 '   ,   ,   , 0 .   -'        CIR002
     O*                                                                   S01119
     O**   RX - THEIR DETAILS.                                            S01119
     O*                                                                   S01119
     O*****   DF 1     01 63 70                                    S01119 E11212
     O        D  1     01 63 70                                           E11212
     O                         CNUM       6                               S01119
     O******                   CRNM      27                        S01119 S01194
     O                         BBCRNM    27                               S01194
     O                         DLNO      34                               S01119
     O                         TACFDA    43                               S01119
     O                         TACTDA    51                               S01119
     O                 25      TBRTT     54                               S01119
     O                 66      TEINR     68 '  0 .       -'               S01119
     O                         CCY       72                               S01119
     O                 30      PCPL      91 ' ,   ,   ,   , 0 -'          S01119
     O                 31      PCPL      91 '   ,   ,   , 0 . -'          S01119
     O                 32      PCPL      91 '  ,   ,   , 0 .  -'          S01119
     O                 33      PCPL      91 ' ,   ,   , 0 .   -'          S01119
     O                 30 68   TAMAD    112 ' ,   ,   ,   , 0 -'          S01119
     O                 31 68   TAMAD    112 '   ,   ,   , 0 . -'          S01119
     O                 32 68   TAMAD    112 '  ,   ,   , 0 .  -'          S01119
     O                 33 68   TAMAD    112 ' ,   ,   , 0 .   -'          S01119
     O                 30 68   TAMTA    131 ' ,   ,   ,   , 0 -'          S01119
     O                 31 68   TAMTA    131 '   ,   ,   , 0 . -'          S01119
     O                 32 68   TAMTA    131 '  ,   ,   , 0 .  -'          S01119
     O                 33 68   TAMTA    131 ' ,   ,   , 0 .   -'          S01119
0535 O*                                                                   S01268
0535 O* TOWN FOR RX - THEIR DETAILS                                       S01268
0535 O*                                                                   S01268
     O        D  1     01 63 70                                           S01268
     O                         BBCRTN    17                               S01268
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OOP7                                           S01408
      *                                                                   S01408
     O                    52 06          61 'Total Unsettled'             CIR002
     O                    52 06          72 'Interest :'                  CIR002
     O                 30 52 06TTUI     112 '   ,   ,   ,   , 0 -'        CIR002
     O                 31 52 06TTUI     112 '  ,   ,   ,   , 0 . -'       CIR002
     O                 32 52 06TTUI     112 ' ,   ,   ,   , 0 .  -'       CIR002
     O                 33 52 06TTUI     112 '   ,   ,   , 0 .   -'        CIR002
     O*                                                                   S01119
     O*****RL*-*COMMON*DETAILS*&*CEILING*RATE.                     S01119 S01157
     O**   RP, RF, RR - COMMON DETAILS & CEILING RATE.                    S01157
     O*                                                                   S01119
     O*****   DF 1     01 64                                       S01119 E11212
     O        D  1     01 64                                              E11212
     O                         CNUM       6                               S01119
     O*******                  CRNM      27                       S01119  S01194
     O                         BBCRNM    27                               S01194
     O                         DLNO      34                               S01119
     O                         ACFDA     43                               S01119
     O                         ACTDA     51                               S01119
     O                 70      TACFDA    43                               S01119
     O                 70      TACTDA    51                               S01119
     O******************       CLRAT     68 '  0 .       -'        S01119 S01157
     O                N11      CLRAT     68 '  0 .       -'               S01157
     O                 11      FLRAT     68 '  0 .       -'               S01157
     O                         CCY       72                               S01119
     O                 30      PCPL      91 ' ,   ,   ,   , 0 -'          S01119
     O                 31      PCPL      91 '   ,   ,   , 0 . -'          S01119
     O                 32      PCPL      91 '  ,   ,   , 0 .  -'          S01119
     O                 33      PCPL      91 ' ,   ,   , 0 .   -'          S01119
     O*                                                                   S01119
     O*****RL*-*PROVIDERS*RATE*&*OUR*OR*THEIR*ACCRUALS.            S01119 S01157
     O**   RP, RF, RR - PROVIDERS RATE & OUR OR THEIR ACCRUALS.           S01157
     O*                                                                   S01119
     O        D  1     01 64                                              S01119
     O                         BBCRTN    17                               S01268
     O                 24      UBRTT     54                               S01119
     O                 65      INTR      68 '  0 .       -'               S01119
     O                 70 25   TBRTT     54                               S01119
     O                 70 66   TEINR     68 '  0 .       -'               S01119
     O                 30 67   AMAD     112 ' ,   ,   ,   , 0 -'          S01119
     O                 31 67   AMAD     112 '   ,   ,   , 0 . -'          S01119
     O                 32 67   AMAD     112 '  ,   ,   , 0 .  -'          S01119
     O                 33 67   AMAD     112 ' ,   ,   , 0 .   -'          S01119
     O                 30 68   TAMAD    112 ' ,   ,   ,   , 0 -'          S01119
     O                 31 68   TAMAD    112 '   ,   ,   , 0 . -'          S01119
     O                 32 68   TAMAD    112 '  ,   ,   , 0 .  -'          S01119
     O                 33 68   TAMAD    112 ' ,   ,   , 0 .   -'          S01119
     O                 30 67   AMTA     131 ' ,   ,   ,   , 0 -'          S01119
     O                 31 67   AMTA     131 '   ,   ,   , 0 . -'          S01119
     O                 32 67   AMTA     131 '  ,   ,   , 0 .  -'          S01119
     O                 33 67   AMTA     131 ' ,   ,   , 0 .   -'          S01119
     O                 30 68   TAMTA    131 ' ,   ,   ,   , 0 -'          S01119
     O                 31 68   TAMTA    131 '   ,   ,   , 0 . -'          S01119
     O                 32 68   TAMTA    131 '  ,   ,   , 0 .  -'          S01119
     O                 33 68   TAMTA    131 ' ,   ,   , 0 .   -'          S01119
     O*                                                                   S01119
     O*****RL*-*FLOOR*RATE*(IF*PRESENT)                            S01119 S01157
     O**   RP, RR - FLOOR RATE (IF PRESENT);OUTPUT ABOVE IF RF            S01157
     O*                                                                   S01119
     O        D  1     01 64 71                                           S01119
     O       AND      N11                                                 S01157
     O                         FLRAT     68 '  0 .       -'               S01119
     O        E  203                                                      098321
     O                                   24 'REFERENCE DL0520P1'          098321
     O                         BJURPT    89                               098321
     O                                  104 'DATE'                        098321
     O                         BJMRDT   112                               098321
     O                                  122 'PAGE'                        098321
     O                         PAGE  Z  127                               098321
     O        E  1                                                        098321
     O                       43          57 'INTEREST ACCRUALS -'         098321
     O                       44          46 'DISCOUNT/PREMIUM'            098321
     O                       44          57 'ACCRUALS -'                  098321
     O                       45          46 'SWAP PROFIT/LOSS'            098321
     O                       45          57 'ACCRUALS -'                  098321
     O**********                         67 'UP TO BUT'                              098321 MD025659
     O**********                         79 'EXCLUDING -'                            098321 MD025659
     O                                   63 'UP TO'                                         MD025659
     O                 26                77 '& EXCLUDING -'                                 MD025659
     O                N26                77 '& INCLUDING -'                                 MD025659
     O                         TDATA     87                               098321
     O                    88             94 ' - TYPE'                                         CDL021
     O                    88   TYP1      97                                                   CDL021
     O                 88 89   TYP2     100                                                   CDL021
     O                 88 89   TYP3     104                                                   CDL038
     O        E  3                                                        098321
     O                       44          38 '--------'                    098321
     O                       45          38 '--------'                    098321
     O                                   62 '------------------------'    098321
     O                                   86 '------------------------'    098321
     O                                   87 '-'                           098321
      *                                                                   S01408
     O/COPY WNCPYSRC,DL0520OOP8                                           S01408
      *                                                                   S01408
     O*                                                                   CIR002
     O** RR, RP, RF - Print Total unsettled interest                      CIR002
     O        D  1     01 64 06                                           CIR002
     O                    67 51          61 'Total Unsettled'             CIR002
     O                    68 52          61 'Total Unsettled'             CIR002
     O                    67 51          72 'Interest :'                  CIR002
     O                    68 52          72 'Interest :'                  CIR002
     O                 30 67 51OTUI     112 '   ,   ,   ,   , 0 -'        CIR002
     O                 31 67 51OTUI     112 '  ,   ,   ,   , 0 . -'       CIR002
     O                 32 67 51OTUI     112 ' ,   ,   ,   , 0 .  -'       CIR002
     O                 33 67 51OTUI     112 '   ,   ,   , 0 .   -'        CIR002
     O                 30 68 52TTUI     112 '   ,   ,   ,   , 0 -'        CIR002
     O                 31 68 52TTUI     112 '  ,   ,   ,   , 0 . -'       CIR002
     O                 32 68 52TTUI     112 ' ,   ,   ,   , 0 .  -'       CIR002
     O                 33 68 52TTUI     112 '   ,   ,   , 0 .   -'        CIR002
     O*                                                                   CIR001
     O**   FEE AMORTIZED DEALS.                                           CIR001
     O*                                                                   CIR001
     O        D  1     01 72 05                                           CIR001
     O                         CNUM       6                               CIR001
     O                         BBCRNM    27                               CIR001
     O                         DLNO      34                               CIR001
     O                         ACFDA     43                               CIR001
     O                         ACTDA     51                               CIR001
     O                         CCY       72                               CIR001
     O                 30      PCPL      91 ' ,   ,   ,   , 0 -'          CIR001
     O                 31      PCPL      91 '   ,   ,   , 0 . -'          CIR001
     O                 32      PCPL      91 '  ,   ,   , 0 .  -'          CIR001
     O                 33      PCPL      91 ' ,   ,   , 0 .   -'          CIR001
     O                 30      AMAD     112 ' ,   ,   ,   , 0 -'          CIR001
     O                 31      AMAD     112 '   ,   ,   , 0 . -'          CIR001
     O                 32      AMAD     112 '  ,   ,   , 0 .  -'          CIR001
     O                 33      AMAD     112 ' ,   ,   , 0 .   -'          CIR001
     O                 30      AMTA     131 ' ,   ,   ,   , 0 -'          CIR001
     O                 31      AMTA     131 '   ,   ,   , 0 . -'          CIR001
     O                 32      AMTA     131 '  ,   ,   , 0 .  -'          CIR001
     O                 33      AMTA     131 ' ,   ,   , 0 .   -'          CIR001
     O*                                                                   CIR001
     O*                                                                   S01119
0559 O********TF12     L1N40                                    S01119    E15059
0559 O        T 12     L1N40                                              E15059
0560 O                                   65 'DEAL SUB-TYPE TOTAL'         S01119
0561 O                       30PCPL1  B  91 ' ,   ,   ,   , 0 -'          S01119
0562 O                       31PCPL1  B  91 '   ,   ,   , 0 . -'          S01119
0563 O                       32PCPL1  B  91 '  ,   ,   , 0 .  -'          S01119
0564 O                       33PCPL1  B  91 ' ,   ,   , 0 .   -'          S01119
0565 O                       30AMAD1  B 112 ' ,   ,   ,   , 0 -'          S01119
0566 O                       31AMAD1  B 112 '   ,   ,   , 0 . -'          S01119
0567 O                       32AMAD1  B 112 '  ,   ,   , 0 .  -'          S01119
0568 O                       33AMAD1  B 112 ' ,   ,   , 0 .   -'          S01119
0569 O                       30AMTA1  B 131 ' ,   ,   ,   , 0 -'          S01119
0570 O                       31AMTA1  B 131 '   ,   ,   , 0 . -'          S01119
0571 O                       32AMTA1  B 131 '  ,   ,   , 0 .  -'          S01119
0572 O                       33AMTA1  B 131 ' ,   ,   , 0 .   -'          S01119
0573 O********TF 2     L2N40                                    S01119    E15059
0573 O        T  2     L2N40                                              E15059
0574 O                                   65 'DEAL TYPE TOTAL'             S01119
0575 O                       30PCPL2  B  91 ' ,   ,   ,   , 0 -'          S01119
0576 O                       31PCPL2  B  91 '   ,   ,   , 0 . -'          S01119
0577 O                       32PCPL2  B  91 '  ,   ,   , 0 .  -'          S01119
0578 O                       33PCPL2  B  91 ' ,   ,   , 0 .   -'          S01119
0579 O                       30AMAD2  B 112 ' ,   ,   ,   , 0 -'          S01119
0580 O                       31AMAD2  B 112 '   ,   ,   , 0 . -'          S01119
0581 O                       32AMAD2  B 112 '  ,   ,   , 0 .  -'          S01119
0582 O                       33AMAD2  B 112 ' ,   ,   , 0 .   -'          S01119
0583 O                       30AMTA2  B 131 ' ,   ,   ,   , 0 -'          S01119
0584 O                       31AMTA2  B 131 '   ,   ,   , 0 . -'          S01119
0585 O                       32AMTA2  B 131 '  ,   ,   , 0 .  -'          S01119
0586 O                       33AMTA2  B 131 ' ,   ,   , 0 .   -'          S01119
0587 O********TF 1     L3N40                                    S01119    E15059
0587 O        T  1     L3N40                                              E15059
0588 O                                   65 'CURRENCY TOTAL'              S01119
0589 O                         CCY       69                               S01119
0590 O                       30PCPL3  B  91 ' ,   ,   ,   , 0 -'          S01119
0591 O                       31PCPL3  B  91 '   ,   ,   , 0 . -'          S01119
0592 O                       32PCPL3  B  91 '  ,   ,   , 0 .  -'          S01119
0593 O                       33PCPL3  B  91 ' ,   ,   , 0 .   -'          S01119
0594 O                       30AMAD3  B 112 ' ,   ,   ,   , 0 -'          S01119
0595 O                       31AMAD3  B 112 '   ,   ,   , 0 . -'          S01119
0596 O                       32AMAD3  B 112 '  ,   ,   , 0 .  -'          S01119
0597 O                       33AMAD3  B 112 ' ,   ,   , 0 .   -'          S01119
0598 O                       30AMTA3  B 131 ' ,   ,   ,   , 0 -'          S01119
0599 O                       31AMTA3  B 131 '   ,   ,   , 0 . -'          S01119
0600 O                       32AMTA3  B 131 '  ,   ,   , 0 .  -'          S01119
0601 O                       33AMTA3  B 131 ' ,   ,   , 0 .   -'          S01119
0317 O        T 3      LR 04
0318 O                                   76 '*** END OF REPORT ***'
     O*                                                                   S01119
0602 O******  T  203   LR                                                 S01117
0602 ODL0520AUT  203   LR                                                 S01117
0603 O*******                            22 'REFERENCE DL0520'            S01117
0603 O                                   24 'REFERENCE DL0520AU'          S01117
0604 O*******                  TITL      89                               S01194
0604 O                         BJURPT    89                               S01194
0605 O                                  104 'DATE'
0606 O*******                  RUNA     112                               S01194
0606 O                         BJMRDT   112                               S01194
0607 O                                  122 'PAGE'
0608 O********                 PAGE  Z  127                               S01117
0608 O                         PAGE1 Z  127                               S01117
0609 O        T  1     LR
0610 O                                   57 'INTEREST ACCRUALS -'
0611 O**********                         67 'UP TO BUT'                                     MD025659
0612 O**********                         79 'EXCLUDING -'                                   MD025659
     O                                   63 'UP TO'                                         MD025659
     O                 26                77 '& EXCLUDING -'                                 MD025659
     O                N26                77 '& INCLUDING -'                                 MD025659
0613 O                         TDATA     87
     O                    88             94 ' - TYPE'                                         CDL021
     O                    88   TYP1      97                                                   CDL021
     O                 88 89   TYP2     100                                                   CDL021
     O                 88 89   TYP3     104                                                   CDL038
0614 O        T  3     LR
0615 O                                   62 '------------------------'
0616 O                                   86 '------------------------'
0617 O                                   87 '-'
0618 O*****   T  150   LR                                                 E11212
0618 O        T  140   LR                                                 E11212
0619 O                                   31 'RUN CONTROLS'
0620 O                                   59 'PROGRAM'
0621 O                                   84 'EXTRACT FILE'
0622 O        T  3     LR
0623 O                                   31 '------------'
0624 O                                   59 '-------'
0625 O                                   84 '------------'
0626 O        T  2     LR
0627 O                                   36 'NUMBER OF RECORDS'
0628 O                         RECRED3   59
0629 O                         NORE  3   84
0630 O                       80         102 '** DIFFERENCE **'
0631 O        T  3     LR
0632 O                                   29 'HASH TOTAL'
0633 O                         ZZTOTIZ   56
0634 O                         ZZTOTD    59
0635 O                         HRWN  Z   81
0636 O                         HRDC      84
0637 O                       81         102 '** DIFFERENCE **'
     O/COPY WNCPYSRC,DL0520O002
0638 O        T  3     LR U7 U8
0639 O*******                            22 'REFERENCE DL0520'            S01194
0640 O*******                            62 'PRINT TERMINATED, '          S01194
0641 O*******                            80 'DATABASE IN ERROR'           S01194
     O                                   71 '*** PRINT TERMINATED ***'    S01194
     O        T 2      LR U7 U8                                           S01194
     O                                   57 'DATABASE ERROR'              S01194
     O                         DBASE     61                               S01194
     O                                   67 'FILE'                        S01194
     O                         DBFILE    78                               S01194
     O        T 13     LR U7 U8                                           S01194
     O                                   49 'OPTION'                      S01194
     O                         DBOPTN    57                               S01194
     O                                   66 'KEY'                         S01194
     O                         DBKEY     96                               S01194
     O        T   22   LRNU7N04                                           S01194
0742 O                                   59 '***   NO DETAILS TO '        S01194
0743 O                                   71 'REPORT   ***'                S01194
     O*****   T 3      LR                                                 S01117
0643 O*****                              65 '***   END OF REPORT'         S01117
0644 O*****                              71 '***'                         S01117
     O/COPY WNCPYSRC,DL0520O001
**                                                                                            CDL033
CFFLOATING RATE CD ISSUED                                                                     CDL033
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
     X/COPY WNCPYSRC,DL0520X001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   TAB1/TAB2 DEAL TYPE/DEAL TYPE NARRATIVE (ADDED IN TABLES FOR SART8528
CSCERTIFICATE OF DEPOSIT SOLD
BSBOND SOLD
BRBILL REDISCOUNTED
TSTREASURY BILL SOLD
RABANK ACCEPTANCE REDISCOUNTED
TRTRADE ACCEPTANCE REDISCOUNTED
C1PRIMARY CERTIFICATE OF DEPOSIT PURCHASED
C2SECONDARY CERTIFICATE OF DEPOSIT PURCHASED
BPBOND PURCHASED
BDBILL DISCOUNTED
TBTREASURY BILL PURCHASED
DABANK ACCEPTANCE DISCOUNTED
TATRADE ACCEPTANCE DISCOUNTED
FPFOREIGN EXCHANGE PURCHASE
FSFOREIGN EXCHANGE SALE
CXCROSS DEAL
PIPURCHASE TO COVER INTEREST COMMITMENT
SISALE TO COVER INTEREST COMMITMENT
OPOPTION
OTOPTION TAKEDOWN
SWSWAP
ITINTERBANK TAKING
IPINTERBANK PLACING
TDTIME DEPOSIT
TITIME LOAN
CDCALL/NOTICE DEPOSIT TAKING
CLCALL/NOTICE DEPOSIT PLACING
CICERTIFICATE OF DEPOSIT ISSUED
LNCOMMERCIAL LOAN
DLDEMAND LOAN
FRFUTURE RATE AGREEMENT                                                   S01119
RSSINGLE CURRENCY INTEREST RATE SWAP                                      S01157
RXCROSS CURRENCY INTEREST RATE SWAP                                       S01119
RPINTEREST RATE CAP                                                       S01157
RFINTEREST RATE FLOOR                                                     S01157
RRINTEREST RATE COLLAR                                                    S01157
ILINTERNAL LOAN                                                           S01354
IDINTERNAL DEPOSIT                                                        S01354
FLFIDUCIARY DEPOSITS TERM PLACING                                         CDL006
DPFIDUCIARY DEPOSITS CALL PLACING                                         CDL006
LPFIDUCIARY LOANS PLACING                                                 CDL006
FTFIDUCIARY DEPOSITS TERM TAKING                                          CDL006
DTFIDUCIARY DEPOSITS CALL TAKING                                          CDL006
LTFIDUCIARY LOANS TAKING                                                  CDL006
