     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Average rates by currency report')            *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
     F*                                                               *
     F*  DL0600 - AVERAGE RATES REPORT                                *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CLE134             Date 01Aug12               *
      *  Prev Amend No. CLE148             Date 23Jul12               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 225984 (bug8936)   Date 24Oct05               *
      *                 CDL038             Date 10May05               *
      *                 CDL033             Date 10Feb05               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 172406             Date 04Jun01               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 163486             Date 14Oct99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 03May99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 139970             Date 03Aug98               *
      *                 CEU011             Date 11Mar98               *
     F*                 089743             Date 11Feb98               *
     F*                 CLE005             Date 22May97               *
     F*                 090468             Date 19Jul95               *
     F*                 068202             Date 24Oct94               *
     F*                 042920             DATE 10DEC93               *
     F*                 E48220             DATE 01FEB93               *
     F*                 S01393             DATE 30OCT92               *
     F*                 E34885             DATE 13OCT92               *
     F*                 S01392             DATE 22SEP92               *
     F*                 E25515             DATE 07AUG91               *
     F*                 S01270             DATE 07JUN91               *
     F*                 DT0079             DATE 12APR91               *
     F*                 BHF793             DATE 09OCT90               *
     F*                 S01243             DATE 15MAY90               *
     F*                 E299               DATE 23MAR90               *
     F*                 E144               DATE 05DEC89               *
     F*                 E131               DATE 30NOV89               *
     F*                 E92                DATE 23NOV89               *
     F*                 SR84089            DATE 20/04/89              *
     F*                 S01117             DATE 12/04/89              *
     F*                 S01194             DATE 12/04/89              *
     F*                 S01153             DATE 08/04/88              *
     F*                 S01127             DATE 16/06/87              *
     F*                 S03220             DATE 11/05/88              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (recompiled)                                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  225984 - Fix array index error caused by CLE028 amendment.   *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  172406 - Re-compiled over changed DLEVNTL3  logical file .   *
      *             Report showed erroneous rates for currencies that *
      *           should have no entries.                             *
      *           Inserted validation to skip  Events type  11V1 & 11V2
      *           Foreign Exchange Cross Deal  since there is no coding
      *           originally done for their  processing .             *
     F*  163486 - Recompile due to changes in LVENTEL.                *
      *  CDL006 - Fiduciary Dealing.                                  *
     F*  139970 - Amounts and Rates for Consolidated Euro in Average  *
     F*           Rates report are wrong.                             *
     F*  CEU011 - Position/Risk Enquiries & Reports                   *
     F*  089743 - Calculate average balances correctly:               *
     F*             Av bal = Ttl bal * days to mat/days in period     *
     F*        1) Set up the correct no of days for each period,      *
     F*           not the no of days different to previous period.    *
     F*           i.e. monthly is 30 days not 30 less 7 (weekly)      *
     F*        1) Calculate No of Days to Maturity from Event Control *
     F*           date - not no of days from end of previous period,  *
     F*           i.e. 22 days is 22 days not 22 - 7 (weekly)         *
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
     F*  090468 - FOR NON-DETAIL (TRAILER) RECORDS, SHOULD SKIP DETAIL*
     F*           PROCESSING                                          *
     F*  068202 - Include internal contracts in the over 1 year col.  *
     F*  042920 - Adjust ARR1 and AVR to accomodate large amounts     *
     F*  E48220 - DIVIDE BY 0 IF BOTH LEGS OF A SWAP ARE VALUE        *
     F*           SAME DAY                                            *
     F*  S01393 - Recompiled for Strategic Risk Management            *
     F*           Book Code added to PF/EVNTXED                       *
     F*  E34885 - REMOVAL OF CUSTOMER LENDING CHANGES (S01270)        *
     F*           RISK LOAN PI SHOULD REMAIN                          *
     F*  S01392 - JAPANESE SUBMODULE ENHANCEMENTS                     *
     F*  E25515 - REMOVAL OF SYNDICATED LOANS                         *
     F*  S01270 - CUSTOMER LENDING CHANGES                            *
     F*  DT0079 - Program is currently trying to access the           *
     F*           Customer Lending SD file, SDCLNDPD, if Syndicated   *
     F*           Lending is off, irrespective of whether or not      *
     F*           LE is on, which causes a database error if it is    *
     F*           off.  Added a test for LE being on.                 *
     F*  BHF793 - ACCESS TO SYNDICATED LOANS TO BE CONDIDITONED       *
     F*  S01243 - PRINCIPAL INCREASES FOR TERM LOANS                  *
     F*  E299   - 'AU' REPORT SHOULD NOT WRITE 'END OF REPORT'        *
     F*  E144   - 'NO DETAILS TO REPORT' ALWAYS PRODUCED IN P1        *
     F*  S01117/E131-  REMOVE EXTRA PAGE THROW FOR EMPTY FILES        *
     F*  E92    - SHOULD NOT PRODUCE P1 IF EVENTS FILE EMPTY          *
     F*  S84089 - PRINCIPAL INCREASES FOR TERM LOANS                  *
     F*           (THIS IS NOW PART OF CORE)                          *
     F*  S01117 - MULTIBRANCHING - R10                                *
     F*  S01194 - NEW STANDING DATA - ADD ACCESS PROGRAMS             *
     F*  S01153 - CLOSE OF BUSINESS ENHANCEMENTS                      *
     F*  S01127 - LVENTM NOW ALSO BASED OVER FOEVED AND FOEVEZZ       *
     F*           OF FUTURE AND OPTION. SUPPRESS THE PRINTING OF      *
     F*           FO EVENTS. PERFORM ONLY THE ADDITION OF HASH        *
     F*           TOTAL AND RECORD NUMBER.                            *
     F*  S03220 - FUNDS TRANSFER                                      *
     F*                                                               *
     F*****************************************************************
0013 F*VNTM***IP**E           K        DISK                               S01153
     F************BPEVEDF                           KIGNORE         S01127S01153
     F************CPEVEDF                           KIGNORE         S01127S01153
     F************DPEVEDF                           KIGNORE         S01127S01153
     F************TREVEDF                           KIGNORE         S01127S01153
0013 F***EVNTML3*IP**E           K        DISK                     S01153 CEU011
      *                                                                   CEU011
     FDLEVNTL3IP  E           K        DISK                               CEU011
      *                                                                   CEU011
      ** Merged Events File                                               CEU011
      *                                                                   CEU011
     FSDCURRL1IF  E           K        DISK                               CEU011
      *                                                                   CEU011
      ** Currencies File                                                  CEU011
      *                                                                   CEU011
0014 F*****TABLE***IF**F******96 12AI     2 DISK                          S01194
0015 FDL0600AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
0015 FDL0600P1O   F     132            PRINTER      KINFDS SPOOL          S01124
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            EVNTM DETAIL - DEALING
0020 F**03************EVENT TRAILER - COMMERCIAL LOANS                    S01153
0022 F**04************EVNTM DETAIL RECORD - COMMERCIAL LOAN               E25515
0023 F**05************EVENT FILE HEADER                                   S01153
     F* 07            EVNTM DETAIL - CUSTOMER LENDING
     F**08************EVNTM TRAILER - CUSTOMER LENDING                    S01153
     F**09************EVNTM TRAILER - FUNDS TRANSFER                S03220S01153
0024 F* 10            RECORD TO BE IGNORED
0025 F*       11      DEAL TYPE IS 'IT','CD','CI' OR EVENT TYPE '20V1'
0026 F*       12      DEAL TYPE IS 'TD'
0027 F*       13      DEAL TYPE IS 'IP' OR 'CL' OR EVENT TYPE '20V2'
0028 F*       14      DEAL TYPE IS 'DL','TI' OR 'LN'
0029 F*    15         CONTINUE UPDATING ARRAYS FOR FIXED LOAN/DEPOSITS
     F**16************EVNTM DETAIL - LETTERS OF CREDIT                    S01153
     F**17************EVNTM TRAILER - LETTERS OF CREDIT                   S01153
0031 F*       18      DAYS IN PERIOD GREATER THAN EVENT DAYS
0032 F*    19         DO NOT CALCULATE AVERAGES
0033 F*    20         NOTICE DAYS POSITIVE
0034 F*       21      EVENT AMOUNT IS NEGATIVE
0035 F*       22      EVENT CURRENCY IS STERLING
0036 F*       23      CALCULATE TOTAL AMOUNT ON CALL
     F*       24      DEALING TRAILER HAS BEEN READ
0037 F*       25      CONTROLS INCREMENTATION OF I AT TOTAL TIME
     F**26************EVNTM DETAIL - SECURITIES TRADING                   S01153
     F**27************EVNTM TRAILER - SECURITIES TRADING                  S01153
     F**28************EVNTM DETAIL - FUNDS TRANSFER                 S03220S01153
0038 F*       30      NO. OF RECORDS IMBALANCE
0039 F*       31      VALUE OF RECORDS IMBALANCE
0040 F*       33      CONTROLS ARRAY INDEX IN CALL/NOTICE DEALS PROCESSING
0041 F*       34      CONTROLS ARRAY INDEX IN 'SPECIAL DEPOSITS' PROCESS
0042 F*       35      EVENT DATE EQUALS ZERO - ETYP 15M1 OR 16M1
0043 F*       36      EDAT EQUALS NOTD - ETYP 15M1 OR 16M1
0044 F*       37      EDAT NOT EQUAL TO NOTD - ETYP 15M1 OR 16M1
0045 F*       40      CONTROL OF FIRST CYCLE
0046 F*       41      DETAIL RECORD(S) EXIST ON FILE
0047 F*       42      OTHER DATE FALLS OVER 1 YEAR AHEAD
0048 F*       45      CURRENCY HAS 0 DECIMAL PLACES
0049 F*       46      CURRENCY HAS 1 DECIMAL PLACE
0050 F*       47      CURRENCY HAS 2 DECIMAL PLACES
0051 F*       48      CURRENCY HAS 3 DECIMAL PLACES
0052 F*       49      IC SWAP LEG INDICATOR IS 2
0053 F**   EVENT TYPES
0054 F*       43      20V1
0055 F*       44      20V2
0056 F*       50      14V5
0057 F*       51      14V6
0058 F*       52      15M1
0059 F*       53      16M1
0060 F*       54      15M4
0061 F*       55      16M4
0062 F*       56      17M1
0063 F*       57      17M3
     F*       58  - Currencies EOF indicator                          *   CEU011
     F*       59  - Currencies array lokup indicator                  *   CEU011
0064 F*       61      15V1, 16V1
0065 F*       62      15V3, 16V3
0066 F********63******41S1,*41R3,*42S8************************************E25515
0067 F********64******41M1,*41R1,*42M1************************************E25515
     F******  63      62V1,63V1,64V1,65V1,66M1,67M1,62V3,64V3,66V3,66R1   S01392
     F******          70V3,62R4                                           S01392
     F******  64      62M1,63M1,64M1,65M1,66V1,67V1,62R1,64R1,62R3        S01392
     F*       63      62V1,63V1,64V1,65V1,66M1,67M1,62V3,64V3,66V3,66R1   S01392
     F*               70V3,62R4,63R3                                      S01392
     F*       64      62M1,63M1,64M1,65M1,66V1,67V1,62R1,64R1,62R3,63R4   S01392
0068 F**
0069 F*       58      56 AND DEAL TYPE IS C1
0070 F*       OR      57 AND DEAL TYPE IS NOT C1
0071 F*       59      REPORT CONTROL DATE PRECEDES OTHER DATE
0072 F*       60      DIVISOR IS ZERO
0073 F*       70      FIRST CHARACTER OF DEAL SUB-TYPE IS 'Z'
0074 F*       71      FIRST CHARACTER OF DEAL SUB-TYPE IS NOT 'Z'
     F********72******COMMERCIAL*LOANS*TO*END*OF*BOOK*-*YES***************E25515
0022 F**82************EVNTM DETAIL - FO RECORD                      S01127S01153
0023 F**83************EVNTM TRAILER- FO RECORD                      S01127S01153
0075 F*             L1CHANGE OF CURRENCY
0076 E********************************************************************
     E                    CPY@    1   1 80
0077 E                    ARR1       48 15 0
0078 E                    ARR2       48 15 0
0079 E                    ARR3       48  5 0
0080 E                    PERD        7  5 0
0081 E                    ARR4       48  8 0
0082 E*    PERD IS ARRAY OF NUMBER OF DAYS IN EACH PERIOD
0083 E*    TABCUM IS TABLE OF NO. OF DAYS - CUMULATIVE, TO END OF PERIOD
0084 E                    AVA        48  9 0
0085 E                    AVR        48 11 7
     E                    EAM        48  9 0                              CEU011
     E                    ERT        48 11 7                              CEU011
     E                    CTR        48  2 0                              139970
      *                                                                   CEU011
      **  Array for Average Balances and Rates for storing Euro           CEU011
      **  Equivalent amounts                                              CEU011
      *                                                                   CEU011
      *                                                                   CEU011
     E                    TEMP       48  2 0                              042920
     E                    TMP1       48  6 2                              042920
     E                    TMP2       48  6 2                              042920
      *                                                                   CEU011
     E                    CUR       200  3   ICY     1                    CEU011
      *                                                                   CEU011
      ** Array to store Ccy and Sort Sequence no.                         CEU011
      *                                                                   CEU011
0086 E********************************************************************
0087 I*
0098 I*
0099 I*
     I*VNTXECF****05*****                                                 S01153
0097 I*    MERGED EVENTS FILE - HEADER RECORD - DEALING
0087 I*
0098 I*
0099 I*
0100 IEVNTXEDF    01
0097 I*    MERGED EVENTS FILE - DETAIL RECORD - DEALING
0107 I                                              ECCY  L1
0114 I                                              NOTD        20
0151 I*
0152 I*
0154 I***CEVNXCCF****04                                                   E25515
0153 I*****EVNTM*-*MERGED*EVENTS*FILE*DETAIL*-*COMMERCIAL*LOAN            E25515
0162 I**************                                ECCY  L1              E25515
     I**************LNTP                            DTYP                  E25515
0199 I*
0200 I*
     ILVENTELF    07
     I                                              ECCY  L1
     I              DFCE                            LCEQ
     I              CDOM                            CLOC
     I              ECDP                            DEC1
     I              FACT                            FTYP
     I              FCNO                            FSEQ
0200 I*
     I*VNTXEDF****16****                                                  S01153
 201 I*****MERGED EVENTS FILE - DETAIL RECORD - LETTER OF CREDIT          S01153
     I***********                                   ECCY  L1              S01153
     I*    MERGED EVENTS FILE - DETAIL RECORD - SECURITIES TRADING
     I*TEVEABF****26****                                                  S01153
     I***********                                   ECCY  L1              S01153
     I***********   OAME                            OTHA                  S01153
     I***********   ODTE                            OTHD                  S01153
     I*                                                                   S3220
     I*****EVNTM FILE - FUNDS TRANSFER DETAIL                       S03220S01153
     I*PVNTDDF****28                                                S03220S01153
     I************                                  ECCY  L1        S03220S01153
0200 I*
     I*VNTXEZF****17****                                                  S01153
 201 I*****MERGED EVENTS FILE - TRAILER RECORD - LETTER OF CREDIT         S01153
0202 I*
0203 I*VNTXZZF****02****                                                  S01153
0201 I*****MERGED EVENTS FILE - TRAILER RECORD - DEALING                  S01153
0207 I*
0209 I*
0210 I*EVNXZZF****03****                                                  S01153
0208 I*****MERGED EVENTS FILE - TRAILER RECORD - COMMERCIAL LOANS         S01153
0211 I*
     I*VENTZZF****08                                                      S01153
 208 I*****MERGED EVENTS FILE - TRAILER RECORD - CUSTOMER LENDING         S01153
     I*****MERGED EVENTS FILE - TRAILER RECORD - SECURITIES TRADING       S01153
     I*TEVEFCF****27****                                                  S01153
     I***********   HSTA                            HRWN                  S01153
     I***********   HSTB                            HRDC                  S01153
     I*                                                                   S03220
     I*****EVNTM FILE - FUNDS TRANSFER TRAILER                      S03220S01153
     I*PVNTZZF****09                                                S03220S01153
     I*                                                                   S01127
     I*****EVNTM FILE - FO DETAIL RECORD                            S01127S01153
     I*OEVEDF*****82                                                S01127S01153
     I*                                                                   S01127
     I*****EVNTM FILE - FO TRAILER                                  S01127S01153
     I*OEVEZZF****83                                                S01127S01153
0212 I*************                                                       S01194
0213 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.***            S01194
0214 I*************                                                       S01194
0215 I***TABLE***NS       2 C0   3 C1  12 C1                              S01194
0216 I*******AND***   13 C0                                               S01194
0217 I*************                           1   1 RECI                  S01194
0218 I*************                           2   30RECT                  S01194
0219 I*************                          12  130RCDE                  S01194
0220 I*************                          14  66 TITL                  S01194
0221 I*************                          67  67 DATF                  S01194
0222 I*************                          68  700DFBR                  S01194
0223 I*************                          74  74 MODI1                 S01194
0224 I*************                          75  75 MODI2                 S01194
0225 I*************                          76  76 MODI3                 S01194
0226 I*************                       P  77  790RUND                  S01194
0227 I*************                          80  86 RUNA                  S01194
0228 I*************                          87  870SFLG                  S01194
0229 I*************                       P  90  920LCD                   S01194
0230 I*************                          93  93 CHTP                  S01194
0231 I*************                       P  94  960TNLU                  S01194
0232 I*************                                                       S01194
0233 I*************                                                       S01194
0234 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*2.**             S01194
0235 I*************                                                       S01194
0236 I***TABLE***NS*      1 CD   2 C0   3 C1                              S01194
0237 I*******AND***   12 C1  13 C1                                        S01194
0238 I*************                           1   1 RECI                  S01194
0239 I*************                           2   30RECT                  S01194
0240 I*************                          12  130RCDE                  S01194
0241 I*************                          14  16 BCCY                  S01194
0242 I*************                          17  19 BCYL                  S01194
0243 I*************                          20  22 HOCY                  S01194
0244 I*************                          23  280HEAD                  S01194
0245 I*************                       P  29  310APDA                  S01194
0246 I*************                          35  35 APFQ                  S01194
0247 I*************                       P  36  380LOGS                  S01194
0248 I*************                          39  40 CUZR                  S01194
0249 I*************                       P  41  430DNWD                  S01194
0250 I*************                          44  460BVLP                  S01194
0251 I*************                          47  49 LOCY                  S01194
0252 I*************                          50  510FDAY                  S01194
0253 I*************                          86  86 ISAV                  S01194
0254 I*************                       P  87  890LLOG                  S01194
0255 I*************                       P  90  920LCD                   S01194
0256 I*************                          93  93 CHTP                  S01194
0257 I*************                                                       S01194
0258 I*************                                                       S01194
0259 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*5.**             S01194
0260 I*************                                                       S01194
0261 I***TABLE***NS**     1 CD   2 C0   3 C1                              S01194
0262 I*******AND***   12 C4  13 C0                                        S01194
0263 I*************                           1   1 RECI                  S01194
0264 I*************                           2   30RECT                  S01194
0265 I*************                          12  130RCDE                  S01194
0266 I*************                          18  210CSAC                  S01194
0267 I*************                          22  22 TLII                  S01194
0268 I*************                          23  23 MCRI                  S01194
0269 I*************                       P  24  250MCEP                  S01194
0270 I*************                          26  270MCLP                  S01194
0271 I*************                          28  28 FRDI                  S01194
0272 I*************                          29  29 BRCF                  S01194
0273 I*************                          30  350PSCN                  S01194
0274 I*************                          36  380DLBR                  S01194
0275 I*************                          39  420FRPA                  S01194
0276 I*************                          43  460FRPC                  S01194
0277 I*************                          47  49 USCY                  S01194
0278 I*************                          50  52 STCY                  S01194
0279 I*************                       P  53  553MBGE                  S01194
     I*************                          61  61 XPBI                  S01194
0280 I*************                       P  90  920LCD                   S01194
0281 I*************                          93  93 CHTP                  S01194
0282 I*************                       P  94  960TNLU                  S01194
0283 I*************                                                       S01194
0284 I*****TABLE*FILE*-*CURRENCIES*RECORD*1.**                            S01194
0285 I*************                                                       S01194
0286 I***TABLE***NS**06   1 CD   2 C2   3 C0                              S01194
0287 I*******AND**    13 C1                                               S01194
0288 I*************                           1   1 RECI                  S01194
0289 I*************                           2   30RECT                  S01194
0290 I*************                          10  12 CCY                   S01194
0291 I*************                          13  130SREC                  S01194
0292 I*************                          14  27 CCNM                  S01194
0293 I*************                       P  28  348SPOT                  S01194
0294 I*************                          35  37 CCYS                  S01194
0295 I*************                          38  380CDP                   S01194
0296 I*************                          39  390TNOT                  S01194
0297 I*************                          40  40 DCCY                  S01194
0298 I*************                          41  44 SRC1                  S01194
0299 I*************                          45  48 SRC2                  S01194
0300 I*************                          49  520TACC                  S01194
0301 I*************                          53  560TEQV                  S01194
0302 I*************                          57  600SWQV                  S01194
0303 I*************                          61  640TAC4                  S01194
0304 I*************                          65  680TAC5                  S01194
0305 I*************                          69  69 HIND                  S01194
0306 I*************                       P  70  768PART                  S01194
0307 I*************                          77  780SSNO                  S01194
0308 I*************                       P  79  858ERLC                  S01194
0309 I*************                       P  90  920LCD                   S01194
0310 I*************                          93  93 CHTP                  S01194
0311 I*************                       P  94  960TNLU                  S01194
0312 I*************                                                       S01194
0313 I*************                                                       S01194
0314 I*****CATCHALL                                                       S01194
0315 I*************                                                       S01194
0316 I********NS***                                                       S01194
0315 I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
0315 I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I** EXTERNAL DS FOR TRADING DETAILS                                  S01194
0315 I*                                                                   S01194
     I***SDSYLN****E*DSSDSYLNPD                                     S01194E25515
     I***EXTERNAL*DS*FOR*SYNDICATED*LOANS*DETAILS                   S01194E25515
     I***********                                                   S01194E25515
     ISDCLND    E DSSDCLNDPD                                              S01194
     I***EXTERNAL*DS*FOR*COMMERCIAL*LOANS*DETAILS                   S01194E25515
     I** EXTERNAL DS FOR CUSTOMER LENDING DETAILS                         E25515
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              BHF793
     I** EXTERNAL DS FOR MODULE DETAILS                                   BHF793
     I*                                                                   BHF793
     ISCSARD    E DSSCSARDPD                                              CLE005
      ** Switchable Features File                                         CLE005
      *                                                                   CLE005
     ISDGELR    E DSSDGELRPD                                              CEU011
      ** General ledger details                                           CEU011
      *                                                                   CEU011
     I              QQACCD                          QQACD1                                    CGL029
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 243 2460SWRIT                 S01117
     I@BINRY      DS                                                      S01117
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I                                    B   1   40@BKBIN                S01117
     ISPOOLU      DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
0317 I/EJECT
0318 C*    FIRST CYCLE CALCS
     C                     Z-ADDDLNO      DLNO
0319 C   40                GOTO START
      *                                                                   S01117
      * ENTRY PARAMETER REQUIRED BY RCF                                   S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ                             S01117
      *                                                                   S01117
0320 C                     Z-ADD0         RECRED  50
0321 C                     SETON                     40
     C                     MOVEACPY@      BIS@   80
0322 C*********************EXSR ZSYSTM                                    S01194
0323 C***99****************SETON                     U7U8LR               S01194
0324 C***99****************GOTO END                                       S01194
0325 C*********************MOVE '1'       ZTABKY                          S01194
0326 C***********ZTABKY****CHAINTABLE                99                   S01194
0327 C***99****************SETON                     U7U8LR               S01194
0328 C***99****************GOTO END                                       S01194
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0330 C*
     C** READ MODULE DETAILS VIA ACCESS PROGRAM                           BHF793
     C                     CALL 'AOMMODR0'                                BHF793
     C                     PARM '*MSG   ' @RTCD   7                       BHF793
     C                     PARM '*FIRST ' @OPTN   7                       BHF793
     C           SDMMOD    PARM SDMMOD    DSFDY                           BHF793
     C           @RTCD     IFNE *BLANK                                    BHF793
     C                     MOVEL'SDMMODPD'DBFILE 10        ************   BHF793
     C                     MOVEL'91'      DBASE   2        * DBERR 91 *   BHF793
     C                     MOVEL@OPTN     DBKEY            ************   BHF793
     C                     SETON                     U7U8LR               BHF793
     C                     EXSR *PSSR                                     BHF793
     C                     GOTO END                                       BHF793
     C                     END                                            BHF793
      *                                                                   CLE005
      ** Check if CLE005 is switched *ON.                                 CLE005
      *                                                                   CLE005
     C                     MOVE 'N'       CLE005  1                       CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   @RTCD   7                       CLE005
     C                     PARM '*VERIFY' @OPTN   7                       CLE005
     C                     PARM 'CLE005'  @SARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
      *                                                                   CLE005
     C           @RTCD     IFEQ *BLANKS                                   CLE005
     C                     MOVE 'Y'       CLE005                          CLE005
     C                     END                                            CLE005
      *                                                                   CLE005
     C           @RTCD     IFNE *BLANKS                                   CLE005
     C           @RTCD     ANDNE'*NRF  '                                  CLE005
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CLE005
     C                     MOVEL'08'      DBASE   2        * DBERR 08 *   CLE005
     C                     MOVEL@OPTN     DBKEY            ************   CLE005
     C                     SETON                     U7U8LR               CLE005
     C                     EXSR *PSSR                                     CLE005
     C                     GOTO END                                       CLE005
     C                     END                                            CLE005
      *                                                                   CLE005
      ** Check if Position/Risk Enquiries & Reports feature (CEU011)      CEU011
      ** is on.                                                           CEU011
      *                                                                   CEU011
     C                     CALL 'AOSARDR0'                                CEU011
     C                     PARM *BLANKS   @RTCD   7                       CEU011
     C                     PARM '*VERIFY' @OPTN   7                       CEU011
     C                     PARM 'CEU011'  @SARD   6                       CEU011
     C           SCSARD    PARM SCSARD    DSFDY                           CEU011
      *                                                                   CEU011
     C                     MOVE 'N'       CEU011                          CEU011
     C           @RTCD     IFEQ *BLANK                                    CEU011
     C                     MOVE 'Y'       CEU011  1                       CEU011
     C                     ELSE                                           CEU011
      *                                                                   CEU011
      ** database error (return code other than *NRF)                     CEU011
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C           @RTCD     ANDNE'*NRF   '                                 CEU011
     C                     MOVEL'SCSARDPD'DBFILE                          CEU011
     C                     MOVEL'CEU011 ' DBKEY            ************   CEU011
     C                     MOVEL'03'      DBASE            * DBERR 03 *   CEU011
     C                     MOVE *ON       *INU8            ***********    CEU011
     C                     MOVE *ON       *INU8                           CEU011
     C                     MOVE *ON       *INLR                           CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     ENDIF                                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CDL006
      ** Access Switchable Feature Details, Check if CDL006 is            CDL006
      ** switch on.                                                       CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   PRTCD   7                       CDL006
     C                     PARM '*VERIFY 'POPTN   7                       CDL006
     C                     PARM 'CDL006'  PSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           PRTCD     IFNE *BLANKS                                   CDL006
     C           PRTCD     ANDNE'*NRF '                                   CDL006
     C                     MOVEL'015'     DBASE                           CDL006
     C                     MOVEL'SCSARDPD'DBFILE                          CDL006
     C                     MOVELPSARD     DBKEY                           CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     GOTO END                                       CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           PRTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     ELSE                                           CDL006
     C                     MOVE 'N'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,DL0600C004
      *                                                                                       CLE028
      ** Determine if CLE028 enhancement is installed                                         CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   PRTCD                                               CLE028
     C                     PARM '*VERIFY 'POPTN                                               CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
      *                                                                                       CLE028
     C           PRTCD     IFNE *BLANKS                                                       CLE028
     C           PRTCD     ANDNE'*NRF '                                                       CLE028
     C                     MOVEL'16'      DBASE                                               CLE028
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE028
     C                     MOVELPSARD     DBKEY                                               CLE028
     C                     MOVE *ON       *INU7                                               CLE028
     C                     MOVE *ON       *INU8                                               CLE028
     C                     MOVE *ON       *INLR                                               CLE028
     C                     EXSR *PSSR                                                         CLE028
     C                     GOTO END                                                           CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           PRTCD     IFEQ *BLANKS                                                       CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                   CEU011
      ** Retrieve general ledger details                                  CEU011
      *                                                                   CEU011
     C**********           CALL 'AOGELRR0'                                CEU011              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CEU011
     C                     PARM '*FIRST ' @OPTN                           CEU011
     C********** SDGELR    PARM SDGELR    DSFDY                           CEU011              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   CEU011
     C           @RTCD     IFNE *BLANKS                                   CEU011
     C           @RTCD     ANDNE'*NRF   '                                 CEU011
     C                     MOVEL'SDGELRPD'DBFILE           ************   CEU011
     C                     MOVEL'05'      DBASE            * DBERR 05 *   CEU011
     C                     MOVEL'*FIRST'  DBKEY            ************   CEU011
     C                     MOVE *ON       *INU7                           CEU011
     C                     MOVE *ON       *INU8                           CEU011
     C                     MOVE *ON       *INLR                           CEU011
     C                     EXSR *PSSR                                     CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
      ** Retrieve 'In' ccy field indicator and store into                 CEU011
      ** array for later use.                                             CEU011
      *                                                                   CEU011
     C           CEU011    IFEQ 'Y'                                       CEU011
     C                     Z-ADD1         S       30                      CEU011
     C           *LOVAL    SETLLSDCURRL1                                  CEU011
     C           *IN58     DOUEQ'1'                                       CEU011
     C                     READ SDCURRL1                 58               CEU011
     C           *IN58     IFEQ '0'                                       CEU011
     C                     MOVE A6CYCD    CUR,S                           CEU011
     C                     MOVE A6INCY    ICY,S                           CEU011
     C                     ADD  1         S                               CEU011
     C                     ENDIF                                          CEU011
     C                     ENDDO                                          CEU011
     C                     ENDIF                                          CEU011
      *                                                                   CEU011
0331 C*    SET UP THE REPORT CONTROL DATE AS THE NEXT
0332 C*    WORKING DAY IN THE LOCAL CURRENCY LESS ONE
0333 C*    CALENDAR DAY
0334 C***********DNWD      SUB  1         RCD     50                      S01194
0334 C           BJDNWD    SUB  1         RCD     50                      S01194
0335 C*
     C** READ TRADING DETAILS VIA ACCESS PROGRAM FOR CURRENCY CODE        S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDTRADPD'DBFILE 10        ************   S01194
     C                     MOVEL'02'      DBASE   2        * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0336 C*********************MOVE '40'      ZTABKY                          S01194
0337 C***********ZTABKY****CHAINTABLE                99                   S01194
0338 C***99****************SETON                     U7U8LR               S01194
0339 C***99****************GOTO END                                       S01194
     C***********BGSYLN    IFEQ 'Y'                                 BHF793E25515
     C***READ*SYNDICATED*LOANS*DETAILS*VIA*ACCESS*PROGRAM           S01194E25515
     C***********          CALL 'AOSYLNR0'                          S01194E25515
     C***********          PARM '*MSG   ' @RTCD                     S01194E25515
     C***********          PARM '*FIRST ' @OPTN                     S01194E25515
     C***********SDSYLN    PARM SDSYLN    DSFDY                     S01194E25515
     C***********@RTCD     IFNE *BLANK                              S01194E25515
     C***********          MOVEL'SDSYLNPD'DBFILE        ************S01194E25515
     C***********          MOVEL'03'      DBASE         * DBERR 03 *S01194E25515
     C***********          MOVEL@OPTN     DBKEY         ************S01194E25515
     C***********          SETON                     U7U8LR         S01194E25515
     C***********          EXSR *PSSR                               S01194E25515
     C***********          GOTO END                                 S01194E25515
     C***********          END                                      S01194E25515
     C*****CHECK*FOR*COMMERCIAL*LOANS*TO*END*OF*BOOK                      E25515
     C***********XPBI******COMP 'Y'                      72               S01194
     C***********BOGEEB    COMP 'Y'                      72         S01194E25515
     C***********                                                   DT0079E25515
     C***Program*should*not*be*accessing*LE*file*just*because*CL*is*DT0079E25515
     C***off;include*check*for*LE*being*on.                         DT0079E25515
     C*********************ELSE                                     BHF793DT0079
     C***********          END                                      DT0079E25515
     C           BGCSLN    IFEQ 'Y'                                       DT0079
     C***READ*COMMERCIAL*LOANS*DETAILS*VIA*ACCESS*PROGRAM           S01194E25515
     C** READ CUSTOMER LENDING DETAILS VIA ACCESS PROGRAM                 E25515
     C                     CALL 'AOCLNDR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDCLND    PARM SDCLND    DSFDY                                        S01194 CLE134
     C           SDCLND    PARM SDCLND    DSSDY                                               CLE134
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCLNDPD'DBFILE           ************   S01194
     C                     MOVEL'93'      DBASE            * DBERR 93 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C***********BPGEEB    COMP 'Y'                      72         S01194E25515
     C                     END                                            BHF793
     C**
0340 C*
0341 C*****SET*UP*KEY*FIELDS*******                                       S01194
0342 C*********************MOVEL'20'      TABKEY 12                       S01194
0343 C*********************MOVE '1'       WK4     4                       S01194
0344 C                     EXSR PERDAY
      *                                                                                       CDL033
      ** Access Switchable Feature Details, Check if CDL033 is switch on.                     CDL033
      *                                                                                       CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*VERIFY '@OPTN                                               CDL033
     C                     PARM 'CDL033'  PSARD   6                                           CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE *BLANKS                                                       CDL033
     C           @RTCD     ANDNE'*NRF '                                                       CDL033
     C                     MOVEL'94'      DBASE                                               CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVELPSARD     DBKEY                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO END                                                           CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           @RTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVE 'Y'       CDL033  1                                           CDL033
     C                     ELSE                                                               CDL033
     C                     MOVE 'N'       CDL033                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0345 C           START     TAG                             ** START TAG **
0346 C                     EXSR SETOF
0347 C*    ACC. NO. OF RECORDS READ.
0348 C********   RECRED    ADD  1         RECRED                          S01127
     C*    IN FUTURE AND OPTION, TRAILER IS NOT INCLUDED IN NORE          S01127
     C**N83******RECRED    ADD  1         RECRED                    S01127S01153
     C           RECRED    ADD  1         RECRED                          S01153
0349 C***05******          GOTO END                                       S01153
     C***03                                                         S03220S01153
     C***09******                                                   S03220S01153
     C*R*03******                                                   S03220S01153
     C*R*17******                                                         S01153
     C*R*27******                                                         S01153
     C*R*08******                                                         S01153
     C*R*83******                                                   S01127S01153
0350 C*R*02******          GOTO TRAIL                                     S01153
0351 C***01******                                                         E25515
     C*R*07******                                                         E25515
0352 C*R*04******          SETON                     41                   E25515
     C   01                                                               E25515
     COR 07                SETON                     41                   E25515
     C*                                                                   090468
     C** SKIP DETAILS PROCESSING IF TRAILER RECORD                        090468
     C           *IN01     IFNE '1'                                       090468
     C           *IN07     ANDNE'1'                                       090468
     C                     GOTO END                                       090468
     C                     END                                            090468
      ***********                                                  CEU011 139970
     C***********CEU011    IFEQ 'Y'                                CEU011 139970
      ***********                                                  CEU011 139970
      ***Check*if*Event Ccy is an 'In' currency                    CEU011 139970
      ***********                                                  CEU011 139970
     C***********          Z-ADD1         S                        CEU011 139970
     C***********ECCY      LOKUPCUR,S                    59        CEU011 139970
     C************IN59     IFEQ *ON                                CEU011 139970
     C***********          MOVE ICY,S     WINCY   1                CEU011 139970
     C***********          ENDIF                                   CEU011 139970
      ***********                                                  CEU011 139970
     C************IN59     IFEQ *ON                                CEU011 139970
     C***********WINCY     IFEQ 'Y'                                CEU011 139970
     C***********ECCY      OREQ BKEURO                             CEU011 139970
     C***********          ADD  1         WEUR    20               CEU011 139970
     C***********          ENDIF                                   CEU011 139970
     C***********          ENDIF                                   CEU011 139970
     C***********          ENDIF                                   CEU011 139970
0353 C*
0354 C*    ACC. NUMBER AND VALUE OF DETAIL RECORDS READ ONLY VALUE SAR0012
0355 C           EAMT      DIV  1000      ZZAMT        21
0356 C   21                Z-SUBZZAMT     ZZAMT
0357 C*  01
0358 C*
0359 C*    OBTAIN NO. OF D.P. FOR CURRENCY
0360 C***L1****************MOVELECCY      WK4                             S01194
0361 C***L1****************MOVE WK4       TABKEY                          S01194
0362 C***L1******TABKEY****CHAINTABLE                99                   S01194
0363 C***L1N06*************SETON                     LRU7U8               S01194
0364 C***L1N06*************GOTO END                                       S01194
0365 C***L1******CDP*******COMP 1                      4546               S01194
0366 C***L1******CDP*******COMP 2                    48  47               S01194
     C** READ CURRENCY DETAILS VIA ACCESS PROGRAM                         S01194
     C*                                                                   S01194
     C           *INL1     IFEQ '1'                                       S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM ECCY      @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE           ************   S01194
     C                     MOVEL'04'      DBASE            * DBERR 04 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     MOVELECCY      DBKEY  29                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C           A6NBDP    COMP 1                      4546               S01194
     C           A6NBDP    COMP 2                    48  47               S01194
     C*                                                                   S01194
     C                     END                                            S01194
     C*                                                                   S01194
0367 C                     EXSR GLZADD
     C*
     C*****IGNORE*LETTERS*OF*CREDIT*RECORDS***                            S01153
     C***16******          GOTO TRAIL                                     S01153
     C*****IGNORE*SECURITIES*TRADING*RECORDS**                            S01153
     C***26******          GOTO TRAIL                                     S01153
     C*****IGNORE*FUNDS*TRANSFER*RECORDS******                      S03220S01153
     C***28******          GOTO TRAIL                               S03220S01153
      *                                                                   CDL006
      ** Skip all the processing if CDL006 is on and the                  CDL006
      ** the Deal Type = FL, DP, LP, FT, DT or LT.                        CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FL'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C                     GOTO END                                       CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      *                                                                   172406
      * Skip Events type 11V1 & 11V2 - Foreign Exchange Cross Deal  since 172406
      * there isn't  originally designed coding to process them .         172406
      *                                                                   172406
     C           ETYP      IFEQ '11V1'                                    172406
     C           ETYP      OREQ '11V2'                                    172406
     C                     MOVE '0'       *IN41                           172406
     C                     END                                            172406
      *                                                                   172406
0368 C*
0369 C*    SET INDICATORS ACCORDING TO EVENT TYPE
0370 C*
0371 C           ETYP      COMP '20V1'                   43
0372 C           ETYP      COMP '20V2'                   44
0373 C   43
0374 COR 44      FSLI      COMP 2                        49
0375 C   43N49
0376 COR 44N49             GOTO END
0377 C           ETYP      COMP '14V5'                   50
0378 C           ETYP      COMP '14V6'                   51
0379 C           ETYP      COMP '15M1'                   52
     C  N52      ETYP      COMP '61M1'                   52
      *                                                                   CLE005
      ** Check if CLE005 is *ON                                           CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN52     IFEQ '0'                                       CLE005
     C           ETYP      ANDEQ'68M1'                                    CLE005
     C                     SETON                     52                   CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
0380 C           ETYP      COMP '16M1'                   53
0381 C           ETYP      COMP '15M4'                   54
0382 C           ETYP      COMP '16M4'                   55
0383 C           ETYP      COMP '17M1'                   56
0384 C           ETYP      COMP '17M3'                   57
0385 C           ETYP      COMP '15V1'                   61
0386 C  N61      ETYP      COMP '16V1'                   61
0387 C           ETYP      COMP '15V3'                   62
0388 C  N62      ETYP      COMP '16V3'                   62
0389 C***********ETYP      COMP '41S1'                   63               E25515
     C**N63*72***ETYP      COMP '41R3'                   63               E25515
0391 C**N63******ETYP      COMP '42S8'                   63               E25515
     C** ALL EVENTS FOR LE CALL LOAN EXCEPT FOR 61M1 ARE NOW IGNORED
     C**N63******ETYP      COMP '62V1'                   63               E25515
     C           ETYP      COMP '62V1'                   63               E25515
     C  N63      ETYP      COMP '63V1'                   63
     C  N63      ETYP      COMP '63R3'                   63               S01392
     C  N63      ETYP      COMP '64V1'                   63
     C  N63      ETYP      COMP '65V1'                   63
     C  N63      ETYP      COMP '66M1'                   63
     C  N63      ETYP      COMP '67M1'                   63
     C  N63      ETYP      COMP '62V3'                   63               S01243
     C  N63      ETYP      COMP '64V3'                   63               S01243
     C  N63      ETYP      COMP '66V3'                   63               S01243
     C  N63      ETYP      COMP '66R1'                   63
     C*                                                                   S01270
     C****ADDITION*OF*70V3,62R4*EVENTS******                       S01270 E34885
     C**  ADDITION OF 70V3 EVENT                                          E34885
     C*                                                                   S01270
     C           *IN63     IFEQ '0'                                       S01270
     C           ETYP      ANDEQ'70V3'                                    S01270
     C                     SETON                         63               S01270
     C                     END                                            S01270
      *                                                                   CLE005
      ** Check if CLE005 is *ON                                           CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN63     ANDEQ'0'                                       CLE005
      *                                                                   CLE005
     C           ETYP      IFEQ '69M1'                                    CLE005
     C           ETYP      OREQ '69V3'                                    CLE005
     C           ETYP      OREQ '69R1'                                    CLE005
     C           ETYP      OREQ '71V3'                                    CLE005
     C           ETYP      OREQ '72M1'                                    CLE005
     C           ETYP      OREQ '72V3'                                    CLE005
     C           ETYP      OREQ '72R1'                                    CLE005
     C                     SETON                     63                   CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       CLE028
      ** When CLE028 is installed                                                             CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN63     ANDEQ*OFF                                                          CLE028
     C********** ETYP      OREQ '80V1'                                                 CLE028 225984
     C           ETYP      IFEQ '80V1'                                                        225984
     C                     MOVE *ON       *IN63                                               CLE028
     C                     ENDIF                                                              225984
     C                     ENDIF                                                              CLE028
     C*                                                                   S01270
     C************IN63     IFEQ '0'                                S01270 E34885
     C***********ETYP      ANDEQ'62R4'                             S01270 E34885
     C***********          SETON                         63        S01270 E34885
     C***********          END                                     S01270 E34885
     C*                                                                   S01270
0392 C***********ETYP      COMP '41M1'                   64               E25515
0393 C**N64******ETYP      COMP '41R1'                   64               E25515
0394 C**N64******ETYP      COMP '42M1'                   64               E25515
0395 C**N64******ETYP      COMP '41M3'                   64               E25515
0396 C**N64******ETYP      COMP '41R4'                   64               E25515
     C**N64******ETYP      COMP '62M1'                   64               E25515
     C           ETYP      COMP '62M1'                   64               E25515
     C  N64      ETYP      COMP '63M1'                   64
     C  N64      ETYP      COMP '64M1'                   64
     C  N64      ETYP      COMP '65M1'                   64
     C  N64      ETYP      COMP '66V1'                   64
     C  N64      ETYP      COMP '67V1'                   64
     C  N64      ETYP      COMP '62R1'                   64
     C  N64      ETYP      COMP '64R1'                   64
     C  N64      ETYP      COMP '63R4'                   64               S01392
      *                                                                   CLE005
      ** Check if CLE005 is *ON                                           CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           *IN64     ANDEQ'0'                                       CLE005
      *                                                                   CLE005
     C           ETYP      IFEQ '69V1'                                    CLE005
     C           ETYP      OREQ '72V1'                                    CLE005
     C                     SETON                     64                   CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
      *                                                                                       CLE028
      ** When CLE028 is installed                                                             CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           *IN64     ANDEQ*OFF                                                          CLE028
     C********** ETYP      OREQ '80M1'                                                 CLE028 225984
     C           ETYP      IFEQ '80M1'                                                        225984
     C           ETYP      OREQ '80R1'                                                        CLE028
     C                     MOVE *ON       *IN64                                               CLE028
     C                     ENDIF                                                              225984
     C                     ENDIF                                                              CLE028
     C*                                                            S01270 E34885
     C***********                                                  S01270 E34885
     C****ADDITION OF 62R3 EVENT                                   S01270 E34885
     C***********                                                  S01270 E34885
     C************IN64     IFEQ '0'                                S01270 E34885
     C***********ETYP      ANDEQ'62R3'                             S01270 E34885
     C***********          SETON                         64        S01270 E34885
     C***********          END                                     S01270 E34885
     C*                                                            S01270 E34885
0397 C*
0398 C*
0399 C*    NEGATE THE EVENT AMOUNT FOR CERTAIN TYPES OF
0400 C*****EVENTS.*15V1,*16V1,*15V3,*16V3,*41S1,*41R1,*42S8               E25515
0400 C*    EVENTS. 15V1, 16V1, 15V3, 16V3                                 E25515
0401 C   61
0402 COR 62
0403 COR 63                Z-SUBEAMT      EAMT
0404 C*  43
0405 C*R 44
0406 C*  50
0407 C*R 50
0408 C*R 51
0409 C*R 52
0410 C*R 53
0411 C*R 54
0412 C  N56N57   EDAT      COMP RCD                      10
     C   43N10
     COR 44N10   OTHD      COMP RCD                  10
0413 C*
0416 C  N50N51N52
0417 CANN53N54N55
0418 CANN56N57N43
0419 CANN61N62
0420 CANN63N64
0421 CANN44                GOTO END
0422 C   10                GOTO END
0423 C   50
0424 COR 51                EXSR SWAPS
0425 C                     MOVELDLST      DLST1   1
     C   52N07
0427 COR 61
0428 COR 62
0429 COR 53
0430 COR 54
0431 COR 55      DLST1     COMP 'Z'                  717170
0432 C   70                EXSR SPDEP
     C   52 07
     COR 71                EXSR SUBDIV
0434 C*
0435 C   43
0436 COR 63
0437 COR 64
0438 COR 44                EXSR FIXLD
0439 C*
0440 C   56      DTYP      COMP 'C1'                     58
0441 C   57      DTYP      COMP 'C1'                 5858
0442 C   58                EXSR NEGASS
0443 C           END       TAG                             ** END TAG **
0444 C***********TRAIL     TAG                             ** TRAIL TAG **S01153
0601 C*
     C************IN02     IFEQ '1'                                       S01153
     C************         SETON                     24                   S01153
     C************         Z-ADDHRWN      ZZTOTI                          S01153
     C************         Z-ADDHRDC      ZZTOTD                          S01153
     C************         Z-ADDNORE      NORED   50                      S01153
     C************         END                                            S01153
     C*                                                                   S01127
     C***FINANCIAL*FUTURE                                           S01127S01153
     C************IN83     IFEQ '1'                                 S01127S01153
     C************         Z-ADDHRWN      ZZAMTI                    S01127S01153
     C************         Z-ADDHRDC      ZZAMTD                    S01127S01153
     C************         EXSR GLZSUM                              S01127S01153
     C***********NORE      ADD  NORED     NORED                     S01127S01153
     C***********          END                                      S01127S01153
0597 C*
     C************IN03     IFEQ '1'                                       S01153
     C************         Z-ADDHRWN      ZZAMTI                          S01153
     C************         Z-ADDHRDC      ZZAMTD                          S01153
     C************         EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***********NORED     SUB  1         NORED                           S01153
     C************         END                                            S01153
0445 C*
     C************IN08     IFEQ '1'                                       S01153
     C************         Z-ADDHRWN      ZZAMTI                          S01153
     C************         Z-ADDHRDC      ZZAMTD                          S01153
     C************         EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***********NORED     SUB  1         NORED                           S01153
     C***********          END                                            S01153
 445 C*
     C************IN17     IFEQ '1'                                       S01153
     C************         Z-ADDHRWN      ZZAMTI                          S01153
     C************         Z-ADDHRDC      ZZAMTD                          S01153
     C************         EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***********NORED     SUB  1         NORED                           S01153
     C***********          END                                            S01153
     C*
     C************IN27     IFEQ '1'                                       S01153
     C************IN24     IFEQ '1'                                       S01153
     C************         Z-ADDHRWN      ZZAMTI                          S01153
     C************         Z-ADDHRDC      ZZAMTD                          S01153
     C************         EXSR GLZSUM                                    S01153
     C************         ELSE                                           S01153
     C************         Z-ADDHRWN      ZZTOTI                          S01153
     C************         Z-ADDHRDC      ZZTOTD                          S01153
     C************         END                                            S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C************         END                                            S01153
0446 C*    COMPARISON OF VALUES ON TRAILER WITH THOSE
0447 C*    ACCUMULATED IN PROGRAM
0448 C*
0449 C*  30
0450 C*
0451 C********************************************************************
0452 C*
0453 C*    LEVEL BREAK AND SUBROUTINES
0454 C*
0455 C*    AT CHANGE OF CURRENCY, CALCULATE AVERAGE BALANCES AND RATES,
0456 C*    PRINT REPORTS, AND ZEROISE ARRAYS
0457 C*    DO NOT CALCULATE AVERAGES FOR ELEMENTS 37,38,40,42 AND 44
0458 C*
0459 C*    ZEROISE O/P ARRAYS
0460 CL1                   Z-ADD0         AVA
0461 CL1                   Z-ADD0         AVR
0462 CL1                   Z-ADD1         I
0463 C*    ADJUST VALUES IN ARR3 APPROPRIATELY
0464 CL1                   EXSR ADJUST
0465 CL1         LOOP      TAG                             ** LOOP TAG **
0466 CL1         I         COMP 37                       19
0467 CL1N19      I         COMP 38                       19
0468 CL1N19      I         COMP 40                       19
0469 CL1N19      I         COMP 42                       19
0470 CL1N19      I         COMP 44                       19
0471 CL1 19                GOTO INC
0472 CL1         I         COMP 8                      2323
0473 CL1 23                Z-ADD1         ARR3,I
0474 CL1         ARR2,I    COMP 0                        60
     CL1N60      ARR2,I    DIV  100       TEMP4  152                      042920
0475 C***L1N60***   ARR1,I    DIV  ARR2,I    AVR,I     H                  042920
     CL1N60      ARR1,I    DIV  TEMP4     AVR,I     H                     042920
     CL1N60      TMP2,I    DIV  ARR2,I    TEMP3  117H                     042920
     CL1N60      TEMP3     ADD  AVR,I     AVR,I                           042920
0476 CL1         ARR3,I    COMP 0                        60
0477 CL1N60      ARR3,I    MULT 1000      ARR4,I
0478 CL1N60      ARR2,I    DIV  ARR4,I    AVA,I     H
0479 CL1         INC       TAG                             ** INC TAG **
0480 CL1                   Z-ADD0         ARR1,I
0481 CL1                   Z-ADD0         ARR2,I
0482 CL1                   Z-ADD0         ARR3,I
0483 CL1                   Z-ADD0         ARR4,I
     CL1                   Z-ADD0         TEMP,I                          042920
     CL1                   Z-ADD0         TMP1,I                          042920
     CL1                   Z-ADD0         TMP2,I                          042920
     CL1                   Z-ADD0         TEMP3                           042920
0484 CL1         I         ADD  1         I
0485 CL1         I         COMP 48                     2525
0486 CL1 25                GOTO LOOP
0487 C*
0488 C*    CONVERT AMOUNTS TO WHOLE NOS.
0489 CL1 46      AVA       DIV  10        AVA       H
0490 CL1 47      AVA       DIV  100       AVA       H
0491 CL1 48      AVA       DIV  1000      AVA       H
      *                                                                   CEU011
     CL1         CEU011    IFEQ 'Y'                                       CEU011
      *                                                                   139970
      ** Check if Event Ccy is an 'In' currency                           139970
      *                                                                   139970
     CL1                   Z-ADD1         S                               139970
     CL1         ECCY      LOKUPCUR,S                    59               139970
     CL1         *IN59     IFEQ *ON                                       139970
     CL1                   MOVE ICY,S     WINCY   1                       139970
     CL1                   ENDIF                                          139970
     CL1         WINCY     IFEQ 'Y'                                       CEU011
     CL1         ECCY      OREQ BKEURO                                    CEU011
     CL1                   Z-ADD1         X       20                      CEU011
     CL1         X         DOWLE48                                        CEU011
     CL1         X         IFNE 37                                        CEU011
     CL1         X         ANDNE38                                        CEU011
     CL1         X         ANDNE40                                        CEU011
     CL1         X         ANDNE42                                        CEU011
     CL1         X         ANDNE44                                        CEU011
     CL1         ECCY      IFEQ BKEURO                                    CEU011
     CL1                   ADD  AVA,X     EAM,X                           CEU011
     CL1                   ADD  AVR,X     ERT,X                           CEU011
     CL1         AVA,X     IFNE 0                                         139970
     CL1                   ADD  1         CTR,X                           139970
     CL1                   ENDIF                                          139970
     CL1                   ELSE                                           CEU011
     CL1                   MOVE *BLANKS   PRTCD                           CEU011
     CL1                   Z-ADDAVA,X     PFRAM                           CEU011
     CL1                   MOVE ECCY      PFRCY                           CEU011
     CL1                   MOVE BKEURO    PTOCY                           CEU011
     CL1                   Z-ADD0         POUTA                           CEU011
     CL1                   Z-ADD0         PINTA                           CEU011
     CL1                   Z-ADD0         PEXRT                           CEU011
     CL1                   MOVE *BLANKS   PMDIN                           CEU011
      *                                                                   CEU011
     CL1                   CALL 'EU0200'                                  CEU011
     CL1                   PARM           PRTCD   7                       CEU011
     CL1                   PARM           PFRAM  183                      CEU011
     CL1                   PARM           PFRCY   3                       CEU011
     CL1                   PARM           PTOCY   3                       CEU011
     CL1                   PARM           POUTA  150                      CEU011
     CL1                   PARM           PINTA  183                      CEU011
     CL1                   PARM           PEXRT  159                      CEU011
     CL1                   PARM           PMDIN   1                       CEU011
      *                                                                   CEU011
     CL1         PRTCD     IFEQ *BLANKS                                   CEU011
     CL1                   ADD  POUTA     EAM,X                           CEU011
     CL1                   ADD  AVR,X     ERT,X                           CEU011
     CL1         POUTA     IFNE 0                                         139970
     CL1                   ADD  1         CTR,X                           139970
     CL1                   ENDIF                                          139970
     CL1                   ELSE                                           CEU011
     CL1                   MOVEL'*CALL   'DBFILE                          CEU011
     CL1                   MOVEL'EU0200  'DBKEY             ************  CEU011
     CL1                   MOVEL'06'      DBASE             * DBERR 06 *  CEU011
     CL1                   EXSR *PSSR                       ************  CEU011
     CL1                   ENDIF                                          CEU011
     CL1                   ENDIF                                          CEU011
     CL1                   ENDIF                                          CEU011
     CL1                   ADD  1         X                               CEU011
     CL1                   ENDDO                                          CEU011
     CL1                   ELSE                                           CEU011
     CL1         WCPRT     IFNE 'Y'                                       CEU011
     C***L1******WEUR      ANDGT0                                  CEU011 139970
     C***L1******EAM       DIV  WEUR      EAM                      CEU011 139970
     C***L1******ERT       DIV  WEUR      ERT                      CEU011 139970
     CL1                   Z-ADD1         X                               139970
     CL1         X         DOWLE48                                        139970
     CL1         X         IFNE 37                                        139970
     CL1         X         ANDNE38                                        139970
     CL1         X         ANDNE40                                        139970
     CL1         X         ANDNE42                                        139970
     CL1         X         ANDNE44                                        139970
     CL1         CTR,X     IFGT 0                                         139970
     CL1         EAM,X     DIV  CTR,X     EAM,X                           139970
     CL1         ERT,X     DIV  CTR,X     ERT,X                           139970
     CL1                   ENDIF                                          139970
     CL1                   ENDIF                                          139970
     CL1                   ADD  1         X                               139970
     CL1                   ENDDO                                          139970
     CL1                   EXCPT                                          CEU011
     CL1                   MOVE 'Y'       WCPRT   1                       CEU011
     CL1                   ENDIF                                          CEU011
     CL1                   ENDIF                                          CEU011
     CL1                   ENDIF                                          CEU011
     C** TOTAL CALCULATIONS                                               S01117
     C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   S01117
     C** TO. SWRIT IS INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       S01117
     C** FILE - IF IT IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    S01117
     C** THE FILE. UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     S01117
     C** AN UNITIALISED BINARY FIELD.                                     S01117
     CLR         SWRIT     IFNE 0                                         S01117
     CLR         SWRIT     ANDNE@BKBIN                                    S01117
     C*
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANK    ZSERR                           S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     C*
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM *BLANK    ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C** IF NO RECORDS ON FILE THEN READ BANK DETAILS FOR OUTPUT          S01194
     CLR   N40             EXSR #ZZ                                       S01194
0492 C********************************************************************
0493 C*
0494 C*
0495 C*    FILE CONTROL CHECKS
0496 C*    CHECK THE DEALS FILE
0497 C*
0498 C*
0499 C*****CHECK*THE*COMMERCIAL*LOANS*EVENT*FILE                          E25515
0500 C*
0501 C*R 30
0502 C*
0503 C*
     C*R*********          Z-ADDZZTOTI    HRWN                            S01153
     C*R*********          Z-ADDZZTOTD    HRDC                            S01153
     C*R*********          Z-ADDNORED     NORE                            S01153
0504 C*R*********NORE      COMP RECRED               U8U8                 S01153
0505 C*RNU8******ZZTOTI    COMP HRWN                 U8U8                 S01153
0506 C*RNU8******ZZTOTD    COMP HRDC                 U8U8                 S01153
0507 C********************************************************************
0508 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0509 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0510 C*
0511 CSR         GLZADD    BEGSR                           *** GLZADD ****
0512 C*
0513 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0514 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0515 C*
0516 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0517 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0518 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0519 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0520 C*
0521 CSR                   EXSR GLZSUM
0522 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0523 C*
0524 C********************************************************************
0525 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0526 C*                        GLZADD, GLZSUB, GLZCMP.
0527 C*          PARAMETERS PASSED -
0528 C*                     I/P ZZAMTI ZZAMTD
0529 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0530 C*
0531 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0532 C*
0533 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0534 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0535 CSR                   SETOF                     919293
0536 CSR                   SETOF                     949599
0537 C*
0538 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0539 CSR         ZZAMTI    COMP 0                      9293
0540 CSR 93      ZZAMTD    COMP 0                      9293
0541 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0542 C*
0543 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0544 CSR         ZZTOTI    COMP 0                      9193
0545 CSR 93      ZZTOTD    COMP 0                      9193
0546 C*
0547 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0548 CSR 93                Z-ADDZZAMTI    ZZTOTI
0549 CSR 93                Z-ADDZZAMTD    ZZTOTD
0550 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0551 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0552 CSR 91N92
0553 CORN91 92             GOTO ZZOFPS
0554 C*
0555 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0556 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0557 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0558 C*
0559 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0560 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0561 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0562 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0563 C*
0564 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0565 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0566 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0567 CSRN99                Z-ADDZZWK2     ZZTOTD
0568 CSRN99                Z-ADDZZWK3     ZZTOTI
0569 C*
0570 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0571 CSR 99                Z-ADD0         ZZAMT  153
0572 CSR                   GOTO ZZSEND
0573 C*
0574 C* THE 'SIGNS' ARE DIFFERENT
0575 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0576 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0577 C*
0578 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0579 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0580 C*
0581 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0582 C*
0583 CSR 91                Z-SUBZZTOTI    ZZTOTI
0584 CSR 91                Z-SUBZZTOTD    ZZTOTD
0585 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0586 C*
0587 CSR         ZZTOTI    COMP ZZAMTI               93  95
0588 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0589 C*
0590 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0591 CSR 95                Z-ADD0         ZZTOTI
0592 CSR 95                Z-ADD0         ZZTOTD
0593 CSR 95                GOTO ZZSEND
0594 C*
0595 C* IF ZZTOT GT. ZZAMT.
0596 CSR 93      ZZAMTD    COMP ZZTOTD               94
0597 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0598 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0599 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0600 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0601 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0602 C*
0603 C*
0604 C* IF ZZAMT GT. ZZTOT.
0605 CSRN93      ZZTOTD    COMP ZZAMTD               94
0606 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0607 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0608 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0609 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0610 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0611 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0612 C*
0613 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0614 CSR                   SETOF                     94
0615 CSR 93 91
0616 CORN93 92             SETON                     94
0617 CSR 94                Z-SUBZZTOTI    ZZTOTI
0618 CSR 94                Z-SUBZZTOTD    ZZTOTD
0619 C**
0620 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0621 CSR 92                Z-SUBZZAMTI    ZZAMTI
0622 CSR 92                Z-SUBZZAMTD    ZZAMTD
0623 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0624 C**
0625 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0626 CSR                   SETOF                     96
0627 CSR         ZZTOTD    COMP 0                        91
0628 CSR 91      ZZTOTI    COMP 0                      96
0629 CSR 96                MOVE '.000-'   ZZNEGD  5
0630 CSR                   ENDSR                             ** ENDSR **
0631 C********************************************************************
0632 C*
0633 C*    SUBROUTINE TO HASH TOTAL THE INPUT RECORDS FOR
0634 C*    THE DEALS EVENTS FILE
0635 C*****THE*COMMERCIAL*LOANS*EVENTS*FILE*******************************E25515
0636 C*
0637 C*
0638 C*
0639 C*
0640 C********************************************************************
0641 C           PERDAY    BEGSR
0642 C*
0643 C*    ALLOCATES TO ARRAY 'PERD' THE NUMBER OF DAYS IN EACH PERIOD
0644 C                     Z-ADD1         PERD,1
0645 C***********          Z-ADD6         PERD,2                          089743
0646 C***********          Z-ADD23        PERD,3                          089743
0647 C***********          Z-ADD61        PERD,4                          089743
0648 C***********          Z-ADD91        PERD,5                          089743
0649 C***********          Z-ADD183       PERD,6                          089743
     C                     Z-ADD7         PERD,2                          089743
0646 C                     Z-ADD30        PERD,3                          089743
0647 C                     Z-ADD91        PERD,4                          089743
0648 C                     Z-ADD183       PERD,5                          089743
0649 C                     Z-ADD365       PERD,6                          089743
0650 C                     MOVE 99999     PERD,7
0651 C                     ENDSR
0652 C********************************************************************
0653 C           SETOF     BEGSR
0654 C*
0655 C*    SUBROUTINES TO SET OFF INDICATORS
0656 C                     SETOF                     103335
0657 C                     SETOF                     363758
0658 C                     SETOF                     707142
0659 C                     ENDSR
0660 C********************************************************************
0661 C           SWAPS     BEGSR                           SR - SWAPS
0662 C*
0663 C*    SUBROUTINE FOR UPDATING ARRAYS WHEN EVENT TYPE IS
0664 C*    14V5 OR 14V6 - SWAPS
0665 C*
0666 C           OTHD      SUB  EDAT      N1      50
0667 C           OTHD      SUB  RCD       N2      50
0668 C           N2        COMP N1                   59
0669 C   59                Z-ADDN1        N2
0670 C*    SET ARRAY INDEX TO APPROPRIATE VALUE
0671 C   50                MOVE 43        I       20
0672 C   51                MOVE 41        I
0673 C           EAMT      MULT N2        SWWK   150
0674 C           SWWK      ADD  ARR2,I    ARR2,I
0675 C***********ECCY******COMP STCY                     22               S01194
0675 C           ECCY      COMP BLCYCD                   22               S01194
0676 C           N2        MULT OTHA      SWWK
0677 C   22      SWWK      MULT 36500     SWWK
0678 C  N22      SWWK      MULT 36000     SWWK
     C           N1        IFNE *ZERO                                     E48220
0679 C           SWWK      DIV  N1        SWWK      H
     C                     END                                            E48220
     C                     MOVE SWWK      TEMP,I                          042920
     C           TEMP,I    ADD  TMP2,I    TMP2,I                          042920
     C           SWWK      DIV  100       SWWK                            042920
0680 C           SWWK      ADD  ARR1,I    ARR1,I
0681 C           ARR3,I    ADD  N2        ARR3,I
0682 C                     ENDSR
0683 C********************************************************************
0684 C           SPDEP     BEGSR                           SR - SPDEP
0685 C*    SUBROUTINE FOR UPDATING ARRAYS WHEN EVENT TYPE IS
0686 C*    15V1, 16V1, 15V3, 16V3
0687 C*    15M1, 15M4, 16M1, 16M4 AND POSITION 1 OF DEAL SUB TYPE IS Z
0688 C*
     C/COPY WNCPYSRC,DL0600C001
0689 C*    SET ARRAY INDEX ACCORDING TO DEAL TYPE
0690 C           DTYP      COMP 'IT'                     34
0691 C  N34      DTYP      COMP 'CD'                     34
0692 C  N34      DTYP      COMP 'CI'                     34
     C/COPY WNCPYSRC,DL0600C003
      *                                                                                       CDL033
     C  N34      DTYP      COMP 'CF'                     34                                   CDL033
      *                                                                                       CDL033
0693 C   34                Z-ADD45        I
0694 C*
0695 C           DTYP      COMP 'TD'                     34
0696 C   34                MOVE 46        I
0697 C*
0698 C           DTYP      COMP 'IP'                     34
0699 C  N34      DTYP      COMP 'CL'                     34
0700 C   34                MOVE 47        I
0701 C*
0702 C           DTYP      COMP 'DL'                     34
0703 C  N34      DTYP      COMP 'TI'                     34
0704 C  N34      DTYP      COMP 'LN'                     34
0705 C   34                MOVE 48        I
     C                     MOVE EAMT      TEMP,I                          042920
     C           TEMP,I    MULT EXRT      TMP1,I                          042920
     C           TMP1,I    ADD  TMP2,I    TMP2,I                          042920
     C           EAMT      DIV  100       EAMT                            042920
0706 C           EAMT      MULT EXRT      SWWK
     C           EAMT      MULT 100       EAMT                            042920
0707 C           SWWK      ADD  ARR1,I    ARR1,I
0708 C           EAMT      ADD  ARR2,I    ARR2,I
0709 C   52
0710 COR 53      ARR3,I    ADD  1         ARR3,I
0711 C                     ENDSR
0712 C********************************************************************
0713 C           ADJUST    BEGSR                            SR - ADJUST
0714 C*
0715 C*    PUTS NO. OF DAYS IN PERIOD INTO APPROPRIATE ELEMENTS OF ARR3
0716 C*
0717 C                     Z-ADD9         J       20
0718 C           LOOPJ     TAG                             ** LOOPJ TAG **
0719 C           J         COMP 12                     8080
0720 C   80                MOVE PERD,1    ARR3,J
0721 C   80                GOTO INCJ
0722 C           J         COMP 16                     8080
0723 C   80                MOVE PERD,2    ARR3,J
0724 C   80                GOTO INCJ
0725 C           J         COMP 20                     8080
0726 C   80                MOVE PERD,3    ARR3,J
0727 C   80                GOTO INCJ
0728 C           J         COMP 24                     8080
0729 C   80                MOVE PERD,4    ARR3,J
0730 C   80                GOTO INCJ
0731 C           J         COMP 28                     8080
0732 C   80                MOVE PERD,5    ARR3,J
0733 C   80                GOTO INCJ
0734 C           J         COMP 32                     8080
0735 C   80                MOVE PERD,6    ARR3,J
0736 C           INCJ      TAG                             ** INCJ TAG **
0737 C           J         ADD  1         J
0738 C           J         COMP 32                   80
0739 C  N80                GOTO LOOPJ
0740 C                     ENDSR
0741 C********************************************************************
0742 C           SUBDIV    BEGSR                            SR - SUBDIV
0743 C*
0744 C*    THIS SUBROUTINE EXECUTED FOR EVENT TYPES 15M1, 16M1, 15M4, 16M4
0745 C*    15V1, 16V1, 15V3, 16V3
0746 C*    AND POSITIONS 1 OF DEAL SUB-STYPE NOT EQUAL TO Z
0747 C*
0748 C   52
0749 COR 53      EDAT      COMP 0                        35
0750 C***53*************************************
     C   52N35N07
0752 COR 53N35   EDAT      COMP NOTD                 373736
     C   52N35 07          SETON                     37
0753 C***53N35*********************************
0754 C******************************************
0755 C** IF NOTICE DATE = -999 & IS TYPE 15/16V1
0756 C******************************************
0757 C   61N20   NOTD      COMP -999                     37
0758 C   35
0759 COR 61N37
0760 COR 36
0761 COR 62
0762 COR 54
0763 COR 55                EXSR CALNOT
0764 C*
0765 C   37                EXSR FIXLD
0766 C                     ENDSR
0767 C********************************************************************
0768 C           CALNOT    BEGSR
0769 C*
0770 C*    ARRAY UPDATING FOR CALL DEALS OR NOTICE DEALS
0771 C*
0772 C   36
0773 COR 20                GOTO NOTICE
0774 C*    CALL DEALS
0775 C           DTYP      COMP 'CD'                     33
0776 C   33                MOVE '01'      I
0777 C           DTYP      COMP 'CL'                     33
0778 C   33                MOVE '03'      I
0779 C           DTYP      COMP 'DL'                     33
0780 C   33                MOVE '04'      I
     C   07                MOVE '04'      I
0781 C                     GOTO UPDATE
0782 C           NOTICE    TAG                             ** NOTICE TAG *
0783 C           DTYP      COMP 'CD'                     33
0784 C   33                MOVE '05'      I
0785 C           DTYP      COMP 'CL'                     33
0786 C   33                MOVE '07'      I
0787 C           DTYP      COMP 'DL'                     33
0788 C   33                MOVE '08'      I
0789 C           UPDATE    TAG                             ** UPDATE TAG *
     C                     MOVE EAMT      TEMP,I                          042920
     C           EAMT      DIV  100       EAMT                            042920
0790 C           EAMT      MULT EXRT      PROD   150H
     C           TEMP,I    MULT EXRT      TMP1,I                          042920
0790 C   07      EAMT      MULT INTR      PROD
     C           TEMP,I    MULT INTR      TMP1,I                          042920
     C           TMP1,I    ADD  TMP2,I    TMP2,I                          042920
     C           EAMT      MULT 100       EAMT                            042920
0791 C           ARR1,I    ADD  PROD      ARR1,I
0792 C           EAMT      ADD  ARR2,I    ARR2,I
0793 C*  52
0794 C                     ENDSR
0795 C********************************************************************
0796 C           FIXLD     BEGSR
0797 C*
0798 C*    ARRAY UPDATING FOR FIXED LOANS/DEPOSITS
0799 C*
0800 C                     SETOF                     42
0801 C*    FIND NO. OF DAYS FROM LATER OF 'OTHD' AND 'RCD' TO 'EDAT'
0802 C*
0803 C*
0804 C*    FIND THE NUMBER OF DAYS FROM THE REPORT CONTROL
0805 C*    DATE TO, BUT EXCLUDING THE EVENT DATE .
0806 C           EDAT      SUB  RCD       EDYS    50
0807 C                     Z-ADD1         D       10
0808 C*
0809 C*    THIS PART DONE WHEN REPORT CONTROL DATE IS NOT LATER THAN
0810 C*    OTHER DATE
0811 C*
0812 C*
0813 C*    FIND PERIOD IN WHICH OTHER DATE FALLS
0814 C           TAG16     TAG                             ** TAG16 TAG **
0815 C*
0816 C*    ASSIGN SMALLER OF PERD,D AND EVENT DAYS TO N
0817 C           PERD,D    COMP EDYS                 18
0818 C   18                MOVE EDYS      N       50
0819 C  N18                MOVE PERD,D    N
0820 C*
0821 C*
0822 C*    SET INDICATORS ACCORDING TO DEAL TYPE
0823 C*
0824 C           DTYP      COMP 'IT'                     11
0825 C  N11      DTYP      COMP 'CD'                     11
0826 C  N11      DTYP      COMP 'CI'                     11
     C/COPY WNCPYSRC,DL0600C002
      *                                                                                       CDL033
     C  N11      DTYP      COMP 'CF'                     11                                   CDL033
      *                                                                                       CDL033
0827 C   43                SETON                     11
0828 C*
0829 C           DTYP      COMP 'TD'                     12
0830 C*
0831 C           DTYP      COMP 'IP'                     13
0832 C  N13      DTYP      COMP 'CL'                     13
0833 C   44                SETON                     13
0834 C*
0835 C           DTYP      COMP 'DL'                     14
0836 C  N14      DTYP      COMP 'TI'                     14
0837 C  N14      DTYP      COMP 'LN'                     14
0838 C  N14      DTYP      COMP 'TE'                     14
0839 C  N14      DTYP      COMP 'RC'                     14
0840 C  N14      DTYP      COMP 'DS'                     14
     C   07                MOVEA'0001'    *IN,11
0841 C*
0842 C*    CALCULATE ARRAY ELEMENT NUMBER TO BE UPDATED - PUT IN FIELD I
0843 C           D         SUB  1         I
0844 C           I         MULT 4         I
0845 C   11      I         ADD  9         I
0846 C   12      I         ADD  10        I
0847 C   13      I         ADD  11        I
0848 C   14      I         ADD  12        I
0849 C*
0850 C*
0851 C*    IF PERIOD IS OVER 1 YEAR, ADD NUMBER OF DAYS OVER 1 YEAR INTO
0852 C*    APPROPRIATE ELEMENT OF ARRAY 3
0853 C*
0854 C   52
0855 COR 53
0855 COR 43                                                               068202
0855 COR 44                                                               068202
0856 COR 64      ARR3,I    ADD  N         ARR3,I
0857 C   61
0858 COR 63      ARR3,I    SUB  N         ARR3,I
0859 C*
0860 C  N43N44   EAMT      MULT N         EAMTXN 150
0861 C   43
0862 COR 44      ICAM      MULT N         EAMTXN
0863 C           ARR2,I    ADD  EAMTXN    ARR2,I
     C                     MOVE EAMTXN    TEMP,I                          042920
     C           EAMTXN    DIV  100       EAMTXN                          042920
     C  N43N44   TEMP,I    MULT EXRT      TMP1,I                          042920
0864 C  N43N44   EAMTXN    MULT EXRT      AAA    150
0865 C   43
0866 COR 44      EAMTXN    MULT ICIR      AAA
     C   43                                                               042920
     COR 44      TEMP,I    MULT ICIR      TMP1,I                          042920
0867 C***04******EAMTXN    MULT EINR      AAA                             E25515
     C   07      EAMTXN    MULT INTR      AAA
     C   07      TEMP,I    MULT INTR      TMP1,I                          042920
     C           EAMTXN    MULT 100       EAMTXN                          042920
     C           TMP1,I    ADD  TMP2,I    TMP2,I                          042920
0868 C           ARR1,I    ADD  AAA       ARR1,I
0869 C***********EDYS      SUB  N         EDYS       15                   089743
0870 C***15******D         ADD  1         D                               089743
0871 C***15N42***          GOTO TAG16                                     089743
     C  N18      D         ADD  1         D                               089743
     C  N18N42             GOTO TAG16                                     089743
0872 C*    END OF PROCESSING IF EDAYS IS NOT GREATER THAN ZERO
0873 C*
0874 C                     ENDSR
0875 C********************************************************************
0876 C           NEGASS    BEGSR
0877 C*
0878 C*    ARRAY UPDATING FOR NEGOTIABLE ASSETS
0879 C                     Z-ADD39        I
     C                     MOVE EAMT      TEMP,I                          042920
     C           EAMT      DIV  100       EAMT                            042920
     C           TEMP,I    MULT EXRT      TMP1,I                          042920
0880 C           EAMT      MULT EXRT      AAA
     C           EAMT      MULT 100       EAMT                            042920
     C           TMP1,I    ADD  TMP2,I    TMP2,I                          042920
0881 C           ARR1,I    ADD  AAA       ARR1,I
0882 C           ARR2,I    ADD  EAMT      ARR2,I
0883 C           ARR3,I    ADD  1         ARR3,I
0884 C*
0885 C                     ENDSR
0886 C********************************************************************
0887 C*********************                                               S01194
0888 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.   S01194
0889 C*********************                                               S01194
0890 C***********ZSYSTM****BEGSR                           *** ZSYSTM *** S01194
0891 C*********************                                               S01194
0892 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.**                  S01194
0893 C*********************MOVEL'01      'ZTABKY 12                       S01194
0894 C*********************MOVE '  10'    ZTABKY                          S01194
0895 C*********************                                               S01194
0896 C***********ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
0897 C**N99******RECI******COMP 'D'                  9999  ON, IS DELETED S01194
0898 C*********************                                               S01194
0899 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.**                  S01194
0900 C***********DATF******COMP 'M'                      98MMDDYY, 98 ON  S01194
0901 C*********************                                               S01194
0902 C*********************ENDSR                                          S01194
0903 C*********************                                               S01194
0904 C*********************                                               S01194
0905 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*****************************************************************   S01194
     C*                                                                   S01194
     C* SUBROUTINE : #ZZ                                                  S01194
     C*                                                                   S01194
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01194
     C* NO RECORDS READ AND THEREFORE SDBANKPD NOT READ                   S01194
     C*                                                                   S01194
     C           #ZZ       BEGSR                                          S01194
     C*                                                                   S01194
     C** IF FIRST CYCLE NOT PERFORMED GET BANK DETAILS FOR HEADINGS       S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'07'      DBASE   2        * DBERR 07 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO #ZZ9                                      S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C           #ZZ9      ENDSR                                          S01194
     C*****************************************************************   S01194
     C**                                                                  S01194
0906 C/EJECT
0907 ODL0600P1T  203   L1 41                                              S01124
     O*******OR********LRN41NU7                                           S01194
     O*******OR********LRN41                                           S01194E92
     O       OR        LR 41                                                 E92
0908 O***********************************22 'REFERENCE DL0600'            S01117
0908 O                                   24 'REFERENCE DL0600P1'          S01117
0909 O*************************TITL      89                               S01194
0909 O                         BJURPT    89                               S01194
0910 O                                  104 'DATE'
0911 O*************************RUNA     112                               S01194
0911 O                         BJMRDT   112                               S01194
0912 O                                  122 'PAGE'
0913 O                         PAGE  Z  127
0914 O        T  1     L1 41
     O*******OR********LRN41NU7                                           S01194
     O*******OR********LRN41                                           S01194E92
     O       OR        LR 41                                                 E92
0915 O                                   71 'AVERAGE RATES IN 000''S'
0916 O                         ECCY      75
0917 O        T  2     L1 41
     O*******OR********LRN41NU7                                           S01194
     O*******OR********LRN41                                           S01194E92
     O       OR        LR 41                                                 E92
0918 O                                   73 '------------------------'
0919 O                                   75 '--'
     O        T  2     L1 41                                              S01117
     O                                   18 'CONSOLIDATED'                S01117
0920 O********T**1*****L1 41                                              S01194
     O*******OR********LRN41NU7                                           S01194
0920 O        T  1     L1 41NU7                                           S01194
0921 O                                   31 'TAKINGS'
0922 O                                   60 'DEPOSITS'
0923 O                                   87 'PLACINGS'
0924 O                                  112 'LOANS'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
0926 O                                    6 'PERIOD'
0927 O                                   34 'AMOUNT   RATE'
0928 O                                   61 'AMOUNT   RATE'
0929 O                                   88 'AMOUNT   RATE'
0930 O                                  115 'AMOUNT   RATE'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
0932 O                                    4 'CALL'
0933 O                         AVA,1 1   26
0934 O                         AVR,1     39 '  0 .       -'
0935 O                         AVA,2 1   53
0936 O                         AVR,2     66 '  0 .       -'
0937 O                         AVA,3 1   80
0938 O                         AVR,3     93 '  0 .       -'
0939 O                         AVA,4 1  107
0940 O                         AVR,4    120 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
0942 O                                    6 'NOTICE'
0943 O                         AVA,5 1   26
0944 O                         AVR,5     39 '  0 .       -'
0945 O                         AVA,6 1   53
0946 O                         AVR,6     66 '  0 .       -'
0947 O                         AVA,7 1   80
0948 O                         AVR,7     93 '  0 .       -'
0949 O                         AVA,8 1  107
0950 O                         AVR,8    120 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
0952 O                                    5 '1 DAY'
0953 O                         AVA,9 1   26
0954 O                         AVR,9     39 '  0 .       -'
0955 O                         AVA,101   53
0956 O                         AVR,10    66 '  0 .       -'
0957 O                         AVA,111   80
0958 O                         AVR,11    93 '  0 .       -'
0959 O                         AVA,121  107
0960 O                         AVR,12   120 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
0962 O                                    5 '7 DAY'
0963 O                         AVA,131   26
0964 O                         AVR,13    39 '  0 .       -'
0965 O                         AVA,141   53
0966 O                         AVR,14    66 '  0 .       -'
0967 O                         AVA,151   80
0968 O                         AVR,15    93 '  0 .       -'
0969 O                         AVA,161  107
0970 O                         AVR,16   120 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
0972 O                                    7 '1 MONTH'
0973 O                         AVA,171   26
0974 O                         AVR,17    39 '  0 .       -'
0975 O                         AVA,181   53
0976 O                         AVR,18    66 '  0 .       -'
0977 O                         AVA,191   80
0978 O                         AVR,19    93 '  0 .       -'
0979 O                         AVA,201  107
0980 O                         AVR,20   120 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
0982 O                                    7 '3 MONTH'
0983 O                         AVA,211   26
0984 O                         AVR,21    39 '  0 .       -'
0985 O                         AVA,221   53
0986 O                         AVR,22    66 '  0 .       -'
0987 O                         AVA,231   80
0988 O                         AVR,23    93 '  0 .       -'
0989 O                         AVA,241  107
0990 O                         AVR,24   120 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
0992 O                                    7 '6 MONTH'
0993 O                         AVA,251   26
0994 O                         AVR,25    39 '  0 .       -'
0995 O                         AVA,261   53
0996 O                         AVR,26    66 '  0 .       -'
0997 O                         AVA,271   80
0998 O                         AVR,27    93 '  0 .       -'
0999 O                         AVA,281  107
1000 O                         AVR,28   120 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
1002 O                                    6 '1 YEAR'
1003 O                         AVA,291   26
1004 O                         AVR,29    39 '  0 .       -'
1005 O                         AVA,301   53
1006 O                         AVR,30    66 '  0 .       -'
1007 O                         AVA,311   80
1008 O                         AVR,31    93 '  0 .       -'
1009 O                         AVA,321  107
1010 O                         AVR,32   120 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
1012 O                                   11 'OVER 1 YEAR'
1013 O                         AVA,331   26
1014 O                         AVR,33    39 '  0 .       -'
1015 O                         AVA,341   53
1016 O                         AVR,34    66 '  0 .       -'
1017 O                         AVA,351   80
1018 O                         AVR,35    93 '  0 .       -'
1019 O                         AVA,361  107
1020 O                         AVR,36   120 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
1022 O                                   11 'NEG. ASSETS'
1023 O                         AVA,391   80
1024 O                         AVR,39    93 '  0 .       -'
0925 O********T**2*****L1 41                                              S01194
0925 O        T  2     L1 41NU7                                           S01194
1026 O                                    5 'SWAPS'
1027 O                         AVA,411   26
1028 O                         AVR,41    39 '  0 .       -'
1029 O                         AVA,431   80
1030 O                         AVR,43    93 '  0 .       -'
0925 O********T**3*****L1 41                                              S01194
0925 O        T  3     L1 41NU7                                           S01194
1032 O                                   11 'SPEC. DEPS.'
1033 O                         AVA,451   26
1034 O                         AVR,45    39 '  0 .       -'
1035 O                         AVA,461   53
1036 O                         AVR,46    66 '  0 .       -'
1037 O                         AVA,471   80
1038 O                         AVR,47    93 '  0 .       -'
1039 O                         AVA,481  107
1040 O                         AVR,48   120 '  0 .       -'
1041 O*
1081 O********T*2******LR 41                                        S01117S01194
1081 O        T 2      LR 41NU7                                           S01194
1082 O                                   72 '*** END OF REPORT ***'       S01194
     O********T***22***LRNU7N41                                           E92
     O********T***22***LRNU7*41                                        E92E144
1079 O***********************************72 '*** NO DETAILS TO REPORT'    E144
1080 O***********************************76 ' ***'                        E144
1042 O*
     O        E  203   L1                                                 CEU011
     O                                   24 'REFERENCE DL0600P1'          CEU011
     O                         BJURPT    89                               CEU011
     O                                  104 'DATE'                        CEU011
     O                         BJMRDT   112                               CEU011
     O                                  122 'PAGE'                        CEU011
     O                         PAGE  Z  127                               CEU011
     O        E  1     L1                                                 CEU011
     O                                   71 'AVERAGE RATES IN 000''S'     CEU011
     O                         BKEUCP    75                               CEU011
     O        E  2     L1                                                 CEU011
     O                                   73 '------------------------'    CEU011
     O                                   75 '--'                          CEU011
     O        E  2     L1                                                 CEU011
     O                                   18 'CONSOLIDATED'                CEU011
     O        E  1     L1                                                 CEU011
     O                                   31 'TAKINGS'                     CEU011
     O                                   60 'DEPOSITS'                    CEU011
     O                                   87 'PLACINGS'                    CEU011
     O                                  112 'LOANS'                       CEU011
     O        E  2     L1                                                 CEU011
     O                                    6 'PERIOD'                      CEU011
     O                                   34 'AMOUNT   RATE'               CEU011
     O                                   61 'AMOUNT   RATE'               CEU011
     O                                   88 'AMOUNT   RATE'               CEU011
     O                                  115 'AMOUNT   RATE'               CEU011
     O        E  2     L1                                                 CEU011
     O                                    4 'CALL'                        CEU011
     O                         EAM,1 1   26                               CEU011
     O                         ERT,1     39 '  0 .       -'               CEU011
     O                         EAM,2 1   53                               CEU011
     O                         ERT,2     66 '  0 .       -'               CEU011
     O                         EAM,3 1   80                               CEU011
     O                         ERT,3     93 '  0 .       -'               CEU011
     O                         EAM,4 1  107                               CEU011
     O                         ERT,4    120 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                    6 'NOTICE'                      CEU011
     O                         EAM,5 1   26                               CEU011
     O                         ERT,5     39 '  0 .       -'               CEU011
     O                         EAM,6 1   53                               CEU011
     O                         ERT,6     66 '  0 .       -'               CEU011
     O                         EAM,7 1   80                               CEU011
     O                         ERT,7     93 '  0 .       -'               CEU011
     O                         EAM,8 1  107                               CEU011
     O                         ERT,8    120 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                    5 '1 DAY'                       CEU011
     O                         EAM,9 1   26                               CEU011
     O                         ERT,9     39 '  0 .       -'               CEU011
     O                         EAM,101   53                               CEU011
     O                         ERT,10    66 '  0 .       -'               CEU011
     O                         EAM,111   80                               CEU011
     O                         ERT,11    93 '  0 .       -'               CEU011
     O                         EAM,121  107                               CEU011
     O                         ERT,12   120 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                    5 '7 DAY'                       CEU011
     O                         EAM,131   26                               CEU011
     O                         ERT,13    39 '  0 .       -'               CEU011
     O                         EAM,141   53                               CEU011
     O                         ERT,14    66 '  0 .       -'               CEU011
     O                         EAM,151   80                               CEU011
     O                         ERT,15    93 '  0 .       -'               CEU011
     O                         EAM,161  107                               CEU011
     O                         ERT,16   120 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                    7 '1 MONTH'                     CEU011
     O                         EAM,171   26                               CEU011
     O                         ERT,17    39 '  0 .       -'               CEU011
     O                         EAM,181   53                               CEU011
     O                         ERT,18    66 '  0 .       -'               CEU011
     O                         EAM,191   80                               CEU011
     O                         ERT,19    93 '  0 .       -'               CEU011
     O                         EAM,201  107                               CEU011
     O                         ERT,20   120 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                    7 '3 MONTH'                     CEU011
     O                         EAM,211   26                               CEU011
     O                         ERT,21    39 '  0 .       -'               CEU011
     O                         EAM,221   53                               CEU011
     O                         ERT,22    66 '  0 .       -'               CEU011
     O                         EAM,231   80                               CEU011
     O                         ERT,23    93 '  0 .       -'               CEU011
     O                         EAM,241  107                               CEU011
     O                         ERT,24   120 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                    7 '6 MONTH'                     CEU011
     O                         EAM,251   26                               CEU011
     O                         ERT,25    39 '  0 .       -'               CEU011
     O                         EAM,261   53                               CEU011
     O                         ERT,26    66 '  0 .       -'               CEU011
     O                         EAM,271   80                               CEU011
     O                         ERT,27    93 '  0 .       -'               CEU011
     O                         EAM,281  107                               CEU011
     O                         ERT,28   120 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                    6 '1 YEAR'                      CEU011
     O                         EAM,291   26                               CEU011
     O                         ERT,29    39 '  0 .       -'               CEU011
     O                         EAM,301   53                               CEU011
     O                         ERT,30    66 '  0 .       -'               CEU011
     O                         EAM,311   80                               CEU011
     O                         ERT,31    93 '  0 .       -'               CEU011
     O                         EAM,321  107                               CEU011
     O                         ERT,32   120 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                   11 'OVER 1 YEAR'                 CEU011
     O                         EAM,331   26                               CEU011
     O                         ERT,33    39 '  0 .       -'               CEU011
     O                         EAM,341   53                               CEU011
     O                         ERT,34    66 '  0 .       -'               CEU011
     O                         EAM,351   80                               CEU011
     O                         ERT,35    93 '  0 .       -'               CEU011
     O                         EAM,361  107                               CEU011
     O                         ERT,36   120 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                   11 'NEG. ASSETS'                 CEU011
     O                         EAM,391   80                               CEU011
     O                         ERT,39    93 '  0 .       -'               CEU011
     O        E  2     L1                                                 CEU011
     O                                    5 'SWAPS'                       CEU011
     O                         EAM,411   26                               CEU011
     O                         ERT,41    39 '  0 .       -'               CEU011
     O                         EAM,431   80                               CEU011
     O                         ERT,43    93 '  0 .       -'               CEU011
     O        E  3     L1                                                 CEU011
     O                                   11 'SPEC. DEPS.'                 CEU011
     O                         EAM,451   26                               CEU011
     O                         ERT,45    39 '  0 .       -'               CEU011
     O                         EAM,461   53                               CEU011
     O                         ERT,46    66 '  0 .       -'               CEU011
     O                         EAM,471   80                               CEU011
     O                         ERT,47    93 '  0 .       -'               CEU011
     O                         EAM,481  107                               CEU011
     O                         ERT,48   120 '  0 .       -'               CEU011
     O********E*2      L1                                          CEU011 139970
     O***********                        72 '*** END OF REPORT ***'CEU011 139970
1043 O*    RUN CONTROLS REPORT
1044 O********T** 03   LRNU7                                              S01117
1044 ODL0600AUT  203   LR                                                 S01117
1045 O***********                        22 'REFERENCE DL0600'            S01117
1045 O                                   24 'REFERENCE DL0600AU'          S01117
1046 O*************************TITL      89                               S01194
1046 O                         BJURPT    89                               S01194
1047 O                                  104 'DATE'
1048 O*************************RUNA     112                               S01194
1048 O                         BJMRDT   112                               S01194
1049 O                                  122 'PAGE'
1050 O***********              PAGE  Z  127                               S01117
1050 O                         PAGE1 Z  127                               S01117
1051 O********T***05   LRNU7                                              S01117
1051 O        T   05   LR                                                 S01117
1052 O                                   69 'AVERAGE RATES REPORT - R'
1053 O                                   80 'UN CONTROLS'
1054 O********T***06   LRNU7                                              S01117
1054 O        T   06   LR                                                 S01117
1055 O                                   69 '------------------------'
1056 O                                   80 '-----------'
1057 O        T   36   LRNU7
1058 O                                   18 'RUN CONTROLS'
1059 O        T   38   LRNU7
1060 O                                   59 'NUMBER'
1061 O                                   84 'VALUE'
1062 O        T 22     LRNU7
1063 O                                   32 'EVENTS FILE RECORDS READ'
1064 O                         RECRED3   59
1065 O                         ZZTOTIZ   81
1066 O                         ZZTOTD    84
1067 O********T**1     LRNU7                                              S01153
1068 O***********                        27 'EVENTS FILE CONTROL'         S01153
1069 O***********                        34 'TOTALS'                      S01153
1070 O***********              NORE  3   59                               S01153
1071 O***********              HRWN  Z   81                               S01153
1072 O***********              HRDC      84                               S01153
1073 O***********         U8            102 '** DIFFERENCE **'            S01153
     O******* T   22   LRNU7N41                                           E131
     O        T 22     LRNU7N41                                           E131
1079 O                                   72 '*** NO DETAILS TO REPORT'    S01117
1080 O                                   76 ' ***'                        S01117
1074 O********T        LR U7 U8
1075 O********                           22 'REFERENCE DL0600'
1076 O********                           62 'PRINT TERMINATED, '
1077 O********                           82 'DATABASE IN ERROR'
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
1081 O*****   T 2      LR                                                 E299
1082 O*****                              73 '*** END OF REPORT ***'       E299
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
