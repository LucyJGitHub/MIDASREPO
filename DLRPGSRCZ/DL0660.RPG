     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Outstanding Deals by Customer Report')        *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
     F*                                                               *
     F*  DL0660 - OUTSTANDING DEALS BY CUSTOMER REPORT                *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CDL099             Date 06Oct17               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 05Jul06               *
      *                 117314             DATE 26May06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CDL028             Date 07Feb05               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 136233             Date 24May01               *
      *                 185616             Date 06Apr01               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 133929             Date 11Nov99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 101151             Date 04Apr97               *
     F*                 S01408             DATE 31JUL96               *
     F*                 S01408             DATE 22MAY96               *
     F*                 090893             DATE 06SEP95               *
     F*                 060306             DATE 02MAR94               *
     F*                 050789             DATE 25FEB94               *
     F*                 S01378             DATE 15OCT92               *
     F*                 S01393             DATE 15OCT92               *
     F*                 AUS018             DATE 14AUG92               *
     F*                 LN0614             DATE 14SEP90               *
     F*                 E296               DATE 04APR90               *
     F*                 E299               DATE 23MAR90               *
     F*                 E145               DATE 05DEC89               *
     F*                 E131               DATE 30NOV89               *
     F*                 E00093             DATE 24NOV89               *
     F*                 S01117             DATE 24/05/89              *
     F*                 SA1157             DATE 24/05/89              *
     F*                 S01153             DATE 08/07/88              *
     F*                 E10622             DATE 18/08/87              *
     F*                 S01119             DATE 15/06/87              *
     F*                 S01124             DATE 00/00/00              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date                                    *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompiled)                                        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
     F*  117314 - The *IN85/86 processing added for 116472 is not     *
     F*           necessary and can cause overflow errors. Remove it. *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  136233 - Wrong amount shown on SALE/PLACING column for       *
      *           Internal Contract (PS) deals. The amount shown was  *
      *           the buy amount of the first leg instead of the sell *
      *           amount of the second leg. Applied fix 128782.       *
      *           Missing value date on internal loans and deposits.  *
      *  185616 - No headings are printed in the first page.  On the  *
      *           following page, wrong page number is displayed.     *
     F*  133929 - Wrong amount reported under the SALE/PLACING column,*
     F*           instead of the 2nd leg sell amount it reported the  *
     F*           1st leg buy amount.  Fix is to move the value of the*
     F*           1st leg buy amount to variable OUTAM1 instead of    *
     F*           moving it to OUTAMT.  Applied fix 128782.           *
     F*  101151 - Details are printed before the header when the first*
     F*           event is arbitrage internal contract (DTYP=PS).     *
     F*           This is caused by fix 090893. Also header is printed*
     F*           with no details.                                    *
     F*  S01408 - Core hook DL0660CCP9 added.                        *
     F*           Core hook DL0660EEP1 added.                         *
     F*           Core hook DL0660FFP1 added.                         *
     F*  S01408 - Core hook DL0660IIP1 added.                        *
     F*           Core hook DL0660CCP1 added.                         *
     F*           Core hook DL0660CCP2 added.                         *
     F*           Core hook DL0660CCP3 added.                         *
     F*           Core hook DL0660CCP4 added.                         *
     F*           Core hook DL0660CCP5 added.                         *
     F*           Core hook DL0660CCP6 added.                         *
     F*           Core hook DL0660CCP7 added.                         *
     F*           Core hook DL0660CCP8 added.                         *
     F*           Core hook DL0660OOP1 added.                         *
     F*           Core hook DL0660OOP2 added.                         *
     F*  090893 - Amend program to output Deposits and Loans for      *
     F*           arbitrage internal contracts. New LF EVNT1V2        *
     F*           created to extract 20V2 (Internal Contract          *
     F*           loan record) events for this change.                *
     F*  060306 - DL0660: Outstanding deals by customers              *
     F*           for CALL account incorrect.                         *
     F*           (Applied fix 048726).                               *
     F*  050789 - Do not 'reverse out' deal amendment PI or PD amts   *
     F*           if the deal amendment vdate is > next working day   *
     F*           as these amounts are no longer added to principle   *
     F*           by DL0400 (E10847/E15988).                          *
     F*  S01378 - Facilitates the partial sale of a parcel            *
     F*           of negotiable instruments which have been           *
     F*           previously input to the system as a single          *
     F*           transaction (was MOF53). Include parcel             *
     F*           flag on report.                                     *
     F*  S01393 - Recompiled for Strategic Risk Management            *
     F*           Book Code added to PF/EVNTXED                       *
     F*  AUS018 - PROVIDE OPTION OF PRODUCING REPORT FOR FX OR MM     *
     F*           ONLY AS WELL AS OPTION FOR ALL DEAL TYPES           *
     F*  LN0614 - 'CONSOLIDATED' INSERTED IN REPORT TITLE             *
     F*  E296   - SHOULD READ SDBANK WHEN RUN ON EMPTY FILES          *
     F*  E299   - 'AU' REPORT SHOULD NOT WRITE 'END OF REPORT'        *
     F*  E145   - P1 NOT PRODUCING HEADING                            *
     F*  S01117/E131 - REMOVE PAGE THROW AND CENTRE OUTPUT            *
     F*  E00093 - ONLY PRODUCE A P1 REPORT IF DETAILS TO REPORT       *
     F*  S01117 - AMENDMENTS FOR MULTIBRANCHING                       *
     F*  SA1157 - (i) FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL'     *
     F*           INTO 'RR' (COLLAR), 'RP' (CAP) AND 'RF' (FLOOR).    *
     F*           DO NOT OUTPUT CEILING RATE IF DEAL TYPE IS 'RF'.    *
     F*           (ii) IF AN FRA, CAP OR COLLAR HAS FIXED RATE        *
     F*           IN 'OUR' DETAILS (UBRTT = 0) THEN IT IS A           *
     F*           PURCHASE, ELSE IT IS A SALE. BUT IF A FLOOR HAS     *
     F*           FIXED RATE IN 'OUR' DETAILS THEN IT IS A SALE,      *
     F*           ELSE IT IS A PURCHASE.                              *
     F*           (iii) INCLUDE BUY/SELL INDICATOR B OR S             *
     F*           AS PART OF DEAL TYPE                                *
     F*  S01153 - CLOSE OF BUSINESS IMPROVEMENTS                      *
     F*  E10622 - WHEN N.A. PURCHASED DEALS SOLD AMOUNT PRINTED       *
     F*           UNDER PURCHASE INSTEAD OF SALE                      *
     F*  S01119 - BASE RATE TYPE FIELD ADDED FOR FRA/IRS              *
     F*                                                               *
     F*****************************************************************
     F*VNT1***IP**E***********K********DISK                               S01119
     FEVNTXEC IP  E                    DISK                               S01119
0012 FEVNT1J  IS  E           K        DISK                               S01119
     F*VNTXZZ*IF* E                    DISK                     S01119    S01153
     FEVNT1V2 IF  E           K        DISK                               090893
0013 FEVNTD   IF  E           K        DISK
     FDEALS   IF  E           K        DISK                               136233
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0660FFP1                                           S01408
     F*                                                                   S01408
0014 F*****TABLE   IF  F      96 12AI     2 DISK                          S01194
0015 FSDCURRL0IF  E           K        DISK                               S01194
0015 F*PRINT  O   F     132     OF     PRINTER                            S01124
0015 F*L0660P1O***F*****132*****OF     PRINTER                            S01124
0015 FDL0660AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0015 FDL0660P1O   F     132     OF     PRINTER      KINFDS SPOOL          S01124
0016 F*****TABLED  IF  F      96 12AI     2 DISK                          S01194
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            S/EVNT1 DETAIL RECORD
0019 F* 02            S/EVNTD DETAIL RECORD
0020 F*       30      DLNO OF REC READ NOT SAME AS MAIN INPUT
0021 F*       31      PRINCIPAL INCREASE
0022 F*       32      PRINCIPAL DECREASE
0023 F*       33      ETYP 16M1 OR 15M1
0024 F*    10         EVENT DATE ZERO IE.CALL DEAL
0025 F*    11         NOTICE DAYS ZERO OR NEGATIVE
     F*****12*********OUR*DETAILS*FOR*'RL'*EVENT***                S01119 SA1157
     F*    12         OUR DETAILS FOR 'RR', 'RP' AND 'RF' EVENT           SA1157
     F*    13         NON FRA/IRS EVENT TYPE                              S01119
     F*    14         OUR FLOATING RATE ENTERED                           S01119
     F*    15         THEIR FLOATING RATE ENTERED                         S01119
     F*****16****     READ FAIL INDICATOR FOR EVENTS TRAILER    S01119    S01153
     F*    17         THEIR BASE RATE TYPE IS NOT EQUAL TO ZERO           S01119
     F*       18      DEAL TYPE IS 'RF' (FLOOR)                           SA1157
0026 F*       20      MATURITY EVENT
0027 F*     21-24     OVERFLOW SUB HEADING PRINT CONTROL
0028 F*       25      WORK INDICATOR
0028 F*       30      ALLOWS FRA, CAPS AND COLLARS TO PRINT AS SALES      SA1157
0029 F*       40      CONTROL 1ST CYCLE PROCESSING
0030 F*       41      PRINT HEADINGS ON FIRST CYCLE
0031 F*     44-46     INCOMING CURRENCY HAS 0-3 DEC. PLACES.
0032 F*     47-51     OUTGOING CURRENCY HAS 0-3 DEC. PLACES.
     F*       52      PRINT REPORT FOR FX DEAL TYPES                      AUS018
     F*       53      PRINT REPORT FOR MM DEAL TYPES                      AUS018
     F*       54      PRINT REPORT FOR ALL DEAL TYPES                     AUS018
0033 F*     55-58     CONDITION SUB-HEADINGS OUTPUT
0034 F*       60      HASH AMOUNT NEGATIVE
0035 F*     61-63     SELECT RECORDS FOR PRINTING
0036 F*       61      FX - INCOMING & OUTGOING
0037 F*       62      DEAL TYPE ON EVENT IS A PLACING
0038 F*       63      DEAL TYPE ON EVENT IS A TAKING
     F*       64      DEAL TYPE ON EVENT IS A FORWARD RATE AGREEMENT      S01119
     F*       65      DEAL TYPE ON EVENT IS A SINGLE CCY INT. RATE SWAP   S01119
     F*       66      DEAL TYPE ON EVENT IS CROSS CCY INT. RATE SWAP      S01119
     F*       67      DEAL TYPE ON EVENT IS INT. RATE CAP/COLLAR          S01119
     F*       68      FLOOR RATE IS PRESENT                               S01119
     F*       69      ACTUAL AVERAGE RATE USED                            S01119
0039 F*       70      RRINT - ZERO
0040 F********71*     FILE CONTROLS OUT OF BALANCE.                       S01153
0041 F********72*     HRWN - ZERO                                         S01153
0042 F*       73      RWINT- ZERO
0043 F*       74      RWRITN - ZERO                                       E00093
0043 F*       76      NO DETAILS SELECTED FOR PRINTING IF OFF             E00093
     F*       80      SET LOWER LIMIT INDICATOR
     F*       81      E.O.F. INDICATOR
     F*       82      OUTPUT 2ND LEG OF INTERNAL DEAL IF TYPE NOT 'MM'    101151
     F*       83      OUTPUT DEPOSIT/LOAN FOR INT. DEAL IF TYPE NOT 'FX'  101151
     F*       84      OUTPUT LOAN RECORD OF INTERNAL CONTRACT             101151
     F********85,86***OUTPUT SUB-HEADING IF THERE ARE STILL RECORDS 101151117314
     F****************BE PRINTED.                                   101151117314
0044 F**********U7&U8 DATABASE ERROR - TABLE FILE RECORD NOT FOUND        S01194
0044 F*         U7&U8 ERROR ACCESSING BANK DETAILS FILE                   S01194
0045 F***********U8   FILE CONTROLS OUT OF BALANCE                        S01153
     E                    CPY@    1   1 80
0046 E                    CCYA      150  3
0047 E                    DPA       150  1 0
     E*                                                                   S01408
     E/COPY WNCPYSRC,DL0660EEP1                                           S01408
     E*                                                                   S01408
0048 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0049 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0050 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0051 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0052 I*****                                                               S01194
0053 I*ABLED**NS       2 C2   3 C0                                        S01194
0054 I*****                                   1   1 RECIX                 S01194
0055 I*****                                   2   30RECTX                 S01194
0056 I*****                                  10  12 CCYX                  S01194
0057 I*****                                  13  130SRECX                 S01194
0058 I*****                                  38  380CDPX                  S01194
0059 I*****                                                               S01194
0060 I*****   NS                                                          S01194
0061 I*****                                   2   30RECTX                 S01194
0062 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0063 I*****                                                               S01194
0064 I*ABLE***NS       2 C0   3 C1  12 C1                                 S01194
0065 I*****  AND      13 C0                                               S01194
0066 I*****                                   1   1 RECI                  S01194
0067 I*****                                   2   30RECT                  S01194
0068 I*****                                  12  130RCDE                  S01194
0069 I*****                                  14  66 TITL                  S01194
0070 I*****                                  67  67 DATF                  S01194
0071 I*****                                  68  700DFBR                  S01194
0072 I*****                                  74  74 MODI1                 S01194
0073 I*****                                  75  75 MODI2                 S01194
0074 I*****                                  76  76 MODI3                 S01194
0075 I*****                               P  77  790RUND                  S01194
0076 I*****                                  80  86 RUNA                  S01194
0077 I*****                                  87  870SFLG                  S01194
0078 I*****                               P  90  920LCD                   S01194
0079 I*****                                  93  93 CHTP                  S01194
0080 I*****                               P  94  960TNLU                  S01194
0081 I*****CATCHALL                                                       S01194
0082 I*****   NS                                                          S01194
0083 I*
0084 I*    EVENTS FILE - HEADER RECORD.
0085 I*
0086 IEVNTXECF
0088 I*
0089 I*
0090 I*    EVENTS FILE - DETAIL RECORD.
0091 I*
0092 I*VNTXEDF****01********                                              S01119
0092 IEVNT1JF     01                                                      S01119
0095 I*****                                         CNUM  L1              S01117
     I                                              CUNR  L1              S01117
0097 I                                              EDAT            10
0106 I                                              NOTD          1111
0141 I*
0142 I*
0143 I*    EVENTS FILE - TRAILER RECORD.
0142 I***********                                                         S01153
0143 I*****EVENTS FILE - TRAILER RECORD.                                  S01153
0144 I***********                                                         S01153
0145 I*VNTXZZF***                                                         S01153
0152 IEVNTDEDF    02
0110 I*                                                                   S01117
0110 ISPOOL       DS                                                      S01117
0110 I**  File information data structure                                 S01117
0110 I                                       83  92 SFILE                 S01117
0110 I                                    B 123 1240SFNUM                 S01117
     I                                    B 243 2460SWRIT                 S01117
0110 I*                                                                   S01117
0110 ISPOOLU      DS                                                      S01117
0110 I**  File information data structure                                 S01117
0110 I                                       83  92 SFILEU                S01117
0110 I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01194
     I@BINRY      DS                                                      S01117
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I                                    B   1   40@BKBIN                S01117
     I*                                                                   S01194
     I@BANK     E DSSDBANKPD                                              S01194
     I* BANK DETAILS FILE - EXTERNALLY DESCRIBED                          S01194
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0660IIP1                                           S01408
      *                                                                                       CDL099
     I            DS                                                                          CDL099
     I                                        1   3 UOTHD                                     CDL099
     I                                    P   1   30OTHD                                      CDL099
      ** Data structure for other date OTHD                                                   CDL099
      *                                                                                       CDL099
     I@SARD     E DSSCSARDPD                                                                  CDL099
      * Data Structure to access AOSARDR0                                                     CDL099
     I*                                                                   S01408
0202 I/EJECT
0203 C**
0204 C   41                SETOF                     41
0205 C**   CONDITION SUB-HEADING OUTPUT.
0206 C   56                SETOF                     55
0207 C   24                SETOF                     2324
0208 C*****FIRST*CYCLE*ONLY*-*GET*ICDR1,*&*SETUP*CCY*ARRAYS**
0208 C**   FIRST CYCLE ONLY - GET BANK DETAILS & SETUP CCY ARRAYS
0209 C   40                GOTO DETAIL
0210 C**
0211 C*********************SETON                     2140                 E00093
0211 C                     SETON                     214076               E00093
     C*********************SETON                     74                   E00093
     C                     SETOF                     74                   E145
     C                     MOVEACPY@      BIS@   80
      *                                                                   S01117
      * ENTRY PARAMETER REQUIRED BY RCF                                   S01117
     C** PARAMETER ALSO PROVIDED TO SELECT FX, MM OR ALL DEAL TYPES       AUS018
     C*                                                                   AUS018
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           TYPE    2                       AUS018
     C                     PARM           SEQ                             S01117
     C*                                                                   090893
     C** Define key list for chain to EVNT1V2 file                        090893
     C*                                                                   090893
     C           KEY1      KLIST                                          090893
     C                     KFLD           DLNO                            090893
     C                     KFLD           ETYPX                           090893
      *                                                                   S01117
0212 C*****                EXSR ZSYSTM                                    S01194
0213 C***99                SETON                     LRU7U8DATABASE ERROR S01194
     C*                                                                   S01194
     C* USE ACCESS PROGRAM TO READ THE BANK DETAILS FILE                  S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        *************  S01194
     C                     MOVEL'001'     DBASE   3        * DBERR 001 *  S01194
     C                     MOVEL@OPTN     DBKEY   7        *************  S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INU8                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     ELSE                                           S01194
     C*                                                                   S01194
0864 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C*                                                                   S01194
0865 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C                     END                                            S01194
     C*                                                                   S01194
0214 C                     EXSR CCYARR
     C*                                                                   AUS018
     C** INITIALIZE INDICATORS FOR ENTRY PARAMETER, TYPE                  AUS018
     C*                                                                   AUS018
     C                     MOVE '0'       *IN52                           AUS018
     C                     MOVE '0'       *IN53                           AUS018
     C                     MOVE '0'       *IN54                           AUS018
     C***********          SETOF                     86             101151117314
     C*                                                                   AUS018
     C** SET INDICATORS TO REFLECT REPORT TYPE (FX, MM OR ALL)            AUS018
     C** FX=52, MM=53, ALL=54                                             AUS018
     C*                                                                   AUS018
     C           TYPE      IFEQ 'FX'                                      AUS018
     C                     MOVE '1'       *IN52                           AUS018
     C                     ELSE                                           AUS018
     C           TYPE      IFEQ 'MM'                                      AUS018
     C                     MOVE '1'       *IN53                           AUS018
     C                     ELSE                                           AUS018
     C                     MOVE '1'       *IN54                           AUS018
     C                     END                                            AUS018
     C                     END                                            AUS018
0215 C**
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0660CCP1                                           S01408
      *                                                                                       CDL099
      ** Call Access Program to check if CDL099 is enabled                                    CDL099
      *                                                                                       CDL099
     C                     CALL 'AOSARDR0'                                                    CDL099
     C                     PARM           URTCD   7                                           CDL099
     C                     PARM '*KEY   ' UOPTN   7                                           CDL099
     C                     PARM 'CDL099'  USARC   6                                           CDL099
     C           @SARD     PARM @SARD     DSFDY                                               CDL099
     C           URTCD     IFNE *BLANKS                                                       CDL099
     C                     MOVE 'N'       CDL099  1                                           CDL099
     C                     ELSE                                                               CDL099
     C                     MOVE 'Y'       CDL099                                              CDL099
     C                     SETON                     35                                       CDL099
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
0216 C**
0217 C           DETAIL    TAG                             **  DETAIL  **
     C*                                                                   SA1157
     C* SETOFF BUY/SELL CONDITIONING INDICATOR & SALE INDICATOR           SA1157
     C*                                                                   SA1157
     C                     MOVE '0'       *IN75                           SA1157
     C                     MOVE '0'       *IN30                           SA1157
     C*                                                                   SA1157
0218 C                     SETOF                     21
0219 C   22                SETOF                     22
0221 C  N42                SETON                     4142
     C  N01                GOTO END
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0660CCP2                                           S01408
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C                     MOVE *OFF      *IN59                                               CDL099
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
0222 C                     SETOF                     616263
     C                     SETOF                     646566               S01119
     C                     SETOF                     67                   S01119
     C                     SETOF                     26                   090893
     C                     SETOF                     828384               101151
     C***********          SETOF                     85             101151117314
0223 C**   COUNT RECORDS READ FROM EVNT1
0224 C           RREAD     ADD  1         RREAD   50
0225 C**
0226 C**   HASH TOTAL OF DETAIL RECORDS READ.
0227 C           EAMT      DIV  1000      ZZAMT        60
0228 C   60                Z-SUBZZAMT     ZZAMT
0229 C                     Z-ADDRRINT     ZZTOTI
0230 C                     Z-ADDRRDEC     ZZTOTD
0231 C                     EXSR GLZADD
0232 C                     Z-ADDZZTOTI    RRINT  150
0233 C                     Z-ADDZZTOTD    RRDEC   30
0234 C**
0235 C**   TO CONDITION SUB-HEADINGS OUTPUT
0236 C   L1                SETOF                     56
0237 C   L1                SETON                     55
0238 C  N55                SETOF                     56
0239 C   22                SETOF                     2122
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0660CCP9                                           S01408
     C*                                                                   S01408
0240 C**
0241 C**   SELECT DETAIL RECORDS TO BE PRINTED
0242 C                     SETOF                     20
     C*                                                                   SA1157
     C** IF DEAL TYPE IS A FLOOR (RF) OUTPUT FLOOR RATE NOT CEILING       SA1157
     C*                                                                   SA1157
     C                     MOVE '0'       *IN18                           SA1157
     C           DTYP      IFEQ 'RF'                                      SA1157
     C                     MOVE '1'       *IN18                           SA1157
     C                     END                                            SA1157
     C*                                                                   SA1157
0243 C           ETYP      COMP '11V1'                   61 FX
0244 C  N61      ETYP      COMP '12V1'                   61
0245 C  N61      ETYP      COMP '13V1'                   61
0246 C  N61      ETYP      COMP '14V1'                   61
0247 C  N61      ETYP      COMP '20V1'                   61
0248 C  N61      ETYP      COMP '16M1'                   63 TAKING
0249 C  N61      ETYP      COMP '18M1'                   62               E10622
0249 C**N61N63   ETYP      COMP '18M1'                   63               E10622
0250 C  N61N62   ETYP      COMP '15M1'                   62 PLACING       E10622
0250 C**N61      ETYP      COMP '15M1'                   62 PLACING       E10622
0251 C  N61N62   ETYP      COMP '17M1'                   62
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0660CCP3                                           S01408
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
      *                                                                                       CDL099
      ** Include Sale Leg events for Split Value dates with Purchase                          CDL099
      ** already processed.                                                                   CDL099
      *                                                                                       CDL099
     C  N61      ETYP      COMP '11V2'                   59                                   CDL099
     C  N61N59   ETYP      COMP '13V2'                   59                                   CDL099
     C  N61N59   ETYP      COMP '14V2'                   59                                   CDL099
     C   59                SETON                     61                                       CDL099
      *                                                                                       CDL099
      ** Exclude 'V2' events if purchase value date is not reached, as                        CDL099
      ** 'V1' events exist.                                                                   CDL099
      *                                                                                       CDL099
     C   59 61   OTHD      COMP BJRDNB                 6161                                   CDL099
     C   59 61   OTHD      COMP 0                    6161                                     CDL099
     C   59 61   UOTHD     COMP '   '                6161                                     CDL099
     C                     SETOF                     59                                       CDL099
      *                                                                                       CDL099
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
     C*                                                                   S01119
     C**  TEST FOR FRA/IRS EVENT TYPES                                    S01119
     C*                                                                   S01119
     C  N61      ETYP      COMP '21O1'                   64 FR TYPE       S01119
     C  N61N64   ETYP      COMP '22O1'                   65 RS TYPE       S01119
     C  N61N64   ETYP      COMP '23O1'                   66 RX TYPE       S01119
     C**N61N64N65ETYP      COMP '24O1'                   67 RL TYPE S01119SA1157
     C  N61N64N65ETYP      COMP '24O1'                   67 RR/RP/RF TYPE SA1157
0252 C   62
     COR 65                                                               S01119
     COR 66                                                               S01119
     COR 67                                                               S01119
0253 COR 63                SETON                     20    MATURITY EVENT
0254 C  N20      ETYP      COMP '12V1'                   20
     C  N64                                                               S01119
     CANN65N66N67                                                         S01119
0255 CANN61N62N63ETYP      COMP '17S1'                   63               S01119
0255 C**N61N62N63ETYP******COMP '17S1'                   63               S01119
     C**N64******                                               S01119    S01153
     C*NN65N66N67                                               S01119    S01153
0256 C*NN61N62N63          GOTO END                             S01119    S01153
     C**N61N62N63**********GOTO END                                       S01119
     C*                                                                   AUS018
     C** IF FX DEAL + FX TO BE PRINTED OR MM DEAL + MM TO BE PRINTED      AUS018
     C** OR ALL DEALS TO BE PRINTED, SET INDICATORS TO CONDITION          AUS018
     C** SUB-HEADING OUTPUT AND ADD TO RECORDS OUTPUT COUNT               AUS018
     C*                                                                   AUS018
     C           *IN61     IFEQ '1'                                       AUS018
     C           *IN52     ANDEQ'1'                                       AUS018
     C           *IN62     OREQ '1'                                       AUS018
     C           *IN53     ANDEQ'1'                                       AUS018
     C           *IN63     OREQ '1'                                       AUS018
     C           *IN53     ANDEQ'1'                                       AUS018
     C           *IN54     OREQ '1'                                       AUS018
     C           ETYP      OREQ '20V1'                                    090893
0257 C**
0258 C**   TO CONDITION SUB-HEADINGS OUTPUT
0259 C                     SETON                     21
0260 C   55                SETON                     56
0261 C                     SETOF                     55
0262 C**
0263 C**   COUNT RECORDS TO BE PRINTED
0264 C           RWRITN    ADD  1         RWRITN  50
0265 C**
0266 C**   HASH TOTAL OF RECORDS TO BE WRITTEN
0267 C                     Z-ADDRWINT     ZZTOTI
0268 C                     Z-ADDRWDEC     ZZTOTD
0269 C                     EXSR GLZADD
0270 C                     Z-ADDZZTOTI    RWINT  150
0271 C                     Z-ADDZZTOTD    RWDEC   30
     C*                                                                   AUS018
     C                     END                                            AUS018
0272 C**
0273 C**   SET UP INCOMING & OUTGOING AMOUNTS, & DEC. PLACES FOR EDITING.
0274 C                     MOVE '   '     INCCY   3
0275 C                     MOVE '   '     OUTCCY  3
0276 C                     Z-ADD0         INAMT  130
0277 C                     Z-ADD0         OUTAMT 130
0278 C**
0279 C*    SET OFF O/P INDS. FOR AMOUNTS.
0280 C                     SETOF                     444546
0281 C                     SETOF                     474849
0282 C                     SETOF                     5051
0283 C**   IF 61 OR 63, INCOMING AMT IS EVENT AMT, ELSE IS 0.
0284 C   61
     C*R*64********                                                S01119 SA1157
     COR 65                                                               S01119
     COR 66                                                               S01119
     C*R*67********                                                S01119 SA1157
0285 COR 63                EXSR INFLDS
0286 C**
0287 C**   IF 61, OUT GOING AMT IS OTHER AMT, IF 62 IS EVENT AMT, ELSE 0
0288 C   61
     COR 66                                                               S01119
0289 COR 62                EXSR OUTFLD
0290 C*                                                                   SA1157
0291 C**   FRA'S, CAPS AND COLLARS SHOWN UNDER PURCHASES WHEN 'OUR        SA1157
0291 C**   BASE RATE TYPE' (UBRTT) EQUALS ZERO - OTHERWISE UNDER SALES.   SA1157
0291 C**   FLOORS SHOWN UNDER PURCHASES WHEN 'OUR BASE RATE TYPE'         SA1157
0291 C**   (UBRTT) IS NOT EQUAL TO ZERO - OTHERWISE UNDER SALES.          SA1157
0290 C*                                                                   SA1157
0292 C           DTYP      IFEQ 'FR'                       DEAL IS FRA,   SA1157
0292 C           DTYP      OREQ 'RP'                       CAP OR COLLAR  SA1157
0292 C           DTYP      OREQ 'RR'                                      SA1157
0290 C*                                                                   SA1157
0293 C           UBRTT     IFEQ 0                                         SA1157
     C                     MOVE 'B'       BYSL    1                       SA1157
     C                     MOVE '1'       *IN75                           SA1157
0294 C                     EXSR INFLDS                     PURCHASES      SA1157
0295 C                     ELSE                                           SA1157
0294 C                     SETON                     30    OUTPUT IND.    SA1157
     C                     MOVE 'S'       BYSL                            SA1157
     C                     MOVE '1'       *IN75                           SA1157
0294 C                     EXSR OUTFLD                     SALES          SA1157
0295 C                     END                                            SA1157
0290 C*                                                                   SA1157
0295 C                     END                                            SA1157
0290 C*                                                                   SA1157
0292 C           DTYP      IFEQ 'RF'                       DEAL IS A FLOORSA1157
0290 C*                                                                   SA1157
0293 C           UBRTT     IFNE 0                                         SA1157
     C                     MOVE 'B'       BYSL                            SA1157
     C                     MOVE '1'       *IN75                           SA1157
0294 C                     EXSR INFLDS                     PURCHASES      SA1157
0295 C                     ELSE                                           SA1157
0294 C                     SETON                     30    OUTPUT IND.    SA1157
     C                     MOVE 'S'       BYSL                            SA1157
     C                     MOVE '1'       *IN75                           SA1157
0294 C                     EXSR OUTFLD                     SALES          SA1157
0295 C                     END                                            SA1157
0290 C*                                                                   SA1157
0295 C                     END                                            SA1157
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0660CCP4                                           S01408
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
      *                                                                                       CDL099
      ** Convert value & maturity dates to alpha format.                                      CDL099
      *                                                                                       CDL099
     C  N20                Z-ADDEDAT      ZDAYNO                                              CDL099
     C   20                Z-ADDOTHD      ZDAYNO                                              CDL099
     C   59                Z-ADDOTHD      ZDAYNO                                              CDL099
     C                     EXSR ZDATE2                                                        CDL099
     C                     MOVE ZADATE    VDATA   7                                           CDL099
     C  N20                Z-ADDOTHD      ZDAYNO                                              CDL099
     C   20                Z-ADDEDAT      ZDAYNO                                              CDL099
     C   59                Z-ADDEDAT      ZDAYNO                                              CDL099
     C                     EXSR ZDATE2                                                        CDL099
     C                     MOVE ZADATE    MDATA   7                                           CDL099
     C*                                                                                       CDL099
     C                     MOVE '       ' UOTHDA                                              CDL099
     C           OTHD      COMP 0                        36                                   CDL099
     C           UOTHD     COMP '   '                    37                                   CDL099
     C   20                SETON                     36                                       CDL099
     C   59                SETON                     36                                       CDL099
     C   35N36N37          Z-ADDOTHD      ZDAYNO                                              CDL099
     C   35N36N37          EXSR ZDATE2                                                        CDL099
     C   35N36N37          MOVE ZADATE    UOTHDA  7                                           CDL099
     C                     GOTO #BTAG1                                                        CDL099
     C*                                                                                       CDL099
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
0290 C**
0291 C**   CONVERT VALUE & MATURITY DATES TO ALPHA FORMAT
0292 C  N20                Z-ADDEDAT      ZDAYNO
0293 C   20                Z-ADDOTHD      ZDAYNO
0294 C                     EXSR ZDATE2
0295 C                     MOVE ZADATE    VDATA   7
0296 C  N20                Z-ADDOTHD      ZDAYNO
0297 C   20                Z-ADDEDAT      ZDAYNO
0298 C                     EXSR ZDATE2
0299 C                     MOVE ZADATE    MDATA   7
0300 C*
0301 C*    BLANK MATURITY DATE IF 2ND LEG OF A
0302 C*    POSITION SWAP
0303 C           ETYP      COMP '20V1'                   25
0304 C   25      FSLI      COMP 2                        25
0305 C   25                MOVE '       ' MDATA
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0660CCP5                                           S01408
     C           #BTAG1    TAG                                                                CDL099
     C*                                                                   S01408
     C*                                                                   S01119
     C**  IF NON FRA/IRS EVENT TYPE CONDITION OUTPUT                      S01119
     C*                                                                   S01119
     C                     SETOF                     13                   S01119
     C*                                                                   S01119
     C                     MOVEA*IN,61    INDS    3                       S01119
     C           INDS      IFNE '000'                                     S01119
     C                     SETON                     13                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CHECK IF FLOATING RATE HAS BEEN ENTERED FOR FRA/IRS EVENTS      S01119
     C*                                                                   S01119
     C           *IN13     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C           UBRTT     IFNE 0                                         S01119
     C                     TESTB'0'       UDNSI          14               S01119
     C                     ELSE                                           S01119
     C                     SETON                         14               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           TBRTT     IFNE 0                                         S01119
     C                     TESTB'0'       TDNSI          15               S01119
     C                     ELSE                                           S01119
     C                     SETON                         15               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C****IF*'RL'*EVENT*CHECK*IF*OURS*OR*THEIR*DETAILS*TO*BE*USED* S01119 SA1157
     C** IF RR,RA OR RF EVENT CHECK IF OURS OR THEIR DETAILS TO BE USED   SA1157
     C*                                                                   S01119
     C           UBRTT     COMP 0                    1212                 S01119
     C           TBRTT     COMP 0                    1717                 S01119
     C*                                                                   S01119
     C           *IN67     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C**  IF OUR DETAILS CHECK FOR FLOOR RATE                             S01119
     C*                                                                   S01119
     C           *IN12     IFEQ '1'                                       S01119
     C                     TESTB'4'       UDSTI          68               S01119
     C*                                                                   S01119
     C**  AND AVERAGE RATE METHOD                                         S01119
     C*                                                                   S01119
     C                     TESTB'3'       UDSTI          69               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF THEIR DETAILS CHECK FOR FLOOR RATE                           S01119
     C*                                                                   S01119
     C           *IN12     IFEQ '0'                                       S01119
     C                     TESTB'4'       TDSTI          68               S01119
     C*                                                                   S01119
     C**  AND AVERAGE RATE METHOD                                         S01119
     C*                                                                   S01119
     C                     TESTB'3'       TDSTI          69               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   090893
     C** For Arbitrage Internal Contracts, output Deposit and Loan        090893
     C** records as well.                                                 090893
     C*                                                                   090893
     C           ETYP      IFEQ '20V1'                                    090893
     C           FSLI      ANDEQ2                                         090893
     C           DTYP      ANDEQ'PS'                                      090893
     C*                                                                   090893
     C** Set off *IN61 so that printing of the 2nd leg of the Internal    090893
     C** Contract will not be done by the RPG logic cycle. Printing       090893
     C** will be done instead through the EXCPT opcode.                   090893
     C*                                                                   090893
     C                     MOVE '1'       *IN26                           090893
     C                     MOVE '0'       *IN61                           090893
     C*                                                                   090893
     C** Output the 2nd leg of the Internal Contract Swap if report       090893
     C** type is not 'MM'                                                 090893
     C*                                                                   090893
     C           *IN53     IFNE '1'                                       090893
     C***********          EXCPTFXPRT                              090893 101151
     C                     SETON                     82                   101151
     C                     END                                            090893
     C*                                                                   090893
     C** Output the Deposit/Loan record of Arbitrage Internal Contract    090893
     C** if report type is not 'FX'                                       090893
     C*                                                                   090893
     C           *IN52     IFNE '1'                                       090893
     C*                                                                   090893
     C** Output the Deposit record of the Arbitrage Internal Contract     090893
     C*                                                                   090893
     C***********          MOVE VDATA     MDATA                    090893 101151
     C***********          Z-ADDICIR      EXRT                     090893 101151
     C***********          Z-ADDICAM      INAMT                    090893 101151
     C           DLNO      CHAINDEALS                90                   136233
     C           *IN90     IFEQ '0'                                       136233
     C                     Z-ADDOTDT      ZDAYNO                          136233
     C                     EXSR ZDATE2                                    136233
     C                     MOVE ZADATE    VDATA1  7                       136233
     C                     ELSE                                           136233
     C                     MOVEL'DEALSDB 'DBFILE 10        *************  136233
     C                     MOVEL'005'     DBASE   3        * DBERR 005 *  136233
     C                     MOVELDLNO      DBKEY   7        *************  136233
     C                     MOVE '1'       *INLR                           136233
     C                     MOVE '1'       *INU7                           136233
     C                     MOVE '1'       *INU8                           136233
     C                     EXSR *PSSR                                     136233
     C                     END                                            136233
     C                     MOVE VDATA     MDATA1  7                       101151
     C                     Z-ADDICIR      EXRT1  138                      101151
     C                     Z-ADDICAM      INAMT1 130                      101151
     C*                                                                   090893
     C***********          EXCPTDPPRT                              090893 101151
     C                     SETON                     83                   101151
     C*                                                                   090893
     C** Output the Loan record of the Arbitrage Internal Contract        090893
     C*                                                                   090893
     C                     MOVE '20V2'    ETYPX   4                       090893
     C*                                                                   090893
     C** Chain to the events file to get the Loan record of the           090893
     C** Internal Contract.                                               090893
     C*                                                                   090893
     C           KEY1      CHAINEVNT1V2              90                   090893
     C*                                                                   090893
     C           *IN90     IFEQ '1'                                       090893
     C                     MOVEL'EVNT1V2 'DBFILE 10        *************  090893
     C                     MOVEL'003'     DBASE   3        * DBERR 003 *  090893
     C                     MOVELDLNO      DBKEY            *************  090893
     C                     MOVE '1'       *INLR                           090893
     C                     MOVE '1'       *INU7                           090893
     C                     MOVE '1'       *INU8                           090893
     C                     EXSR *PSSR                                     090893
     C                     END                                            090893
     C*                                                                   090893
     C** Convert maturity date to alpha format                            090893
     C*                                                                   090893
     C                     Z-ADDEDAT      ZDAYNO                          090893
     C                     EXSR ZDATE2                                    090893
     C***********          MOVE ZADATE    MDATA                    090893 101151
     C                     MOVE ZADATE    MDATA2  7                       101151
     C                     MOVE ECCY      OUTCCY                          090893
     C***********          Z-ADDICIR      EXRT                     090893 101151
     C                     Z-ADDICIR      EXRT2  138                      101151
     C***********          Z-ADDICAM      OUTAMT                   090893 133929
     C                     Z-ADDICAM      OUTAM1 130                      133929
     C*                                                                   090893
     C***********          EXCPTLNPRT                              090893 101151
     C                     SETON                     84                   101151
     C*                                                                   090893
     C                     END                                            090893
     C                     END                                            090893
0306 C**
0307 C           END       TAG                             **  END  **
0308 C      OF             SETON                     22
0309 C   OFN55             SETON                     23
0310 C   21 23             SETON                     24
0311 C*
     C***********                                                   101151117314
     C***If*printer*overflow, check first if there are still details101151117314
     C***to*be*written*before writing the sub-headings.             101151117314
     C***********                                                   101151117314
     C******OF***          SETON                     86             101151117314
      *                                                                   185616
      ** Need to remove this coding to ensure that headings will be       185616
      ** printed.                                                         185616
      *                                                                   185616
     C********** *IN86     IFEQ '1'                                101151 185616
     C********** *IN52     IFEQ '1'                                101151 185616
     C********** *IN61     ANDEQ'0'                                101151 185616
     C********** *IN53     OREQ '1'                                101151 185616
     C********** *IN62     ANDEQ'0'                                101151 185616
     C********** *IN63     ANDEQ'0'                                101151 185616
     C**********           SETON                     85            101151 185616
     C**********           END                                     101151 185616
     C**********           END                                     101151 185616
     C*****N85***          SETOF                     86             101151117314
0312 C*****CONDITION SUB-HEADINGS ON OVERFLOW
0313 C**
0314 C*****COMPARE COUNTS WITH TRAILER VALUES.  71 - OUT OF BALANCE.      S01153
     C*R*********          READ EVNTXZZ                  16     S01119    S01153
0315 C*R*********RREAD     ADD  2         RREAD                           S01153
0316 C*R*********RREAD     COMP NORE                 7171                 S01153
0317 C*RN71******RRINT     COMP HRWN                 7171                 S01153
0318 C*RN71******RRDEC     COMP HRDC                 7171                 S01153
0319 C**
0320 C**   COMPARE HASH INTEGER FIELDS FOR EDITING.
0321 CLR         RRINT     COMP 0                        70
0322 C*R*********HRWN      COMP 0                        72               S01153
0323 CLR         RWINT     COMP 0                        73
0324 C**
0325 C**   SET 74 IF NO DETAILS REPORTED                                  E00093
     CLR                   SETOF                     74                   E00093
0326 CLR         RWRITN    COMP 0                        74               E00093
0327 C**
0509 C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   S01117
     C** TO. SWRIT IS INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       S01117
     C** FILE - IF IT IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    S01117
     C** THE FILE. UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     S01117
     C** AN UNITIALISED BINARY FIELD.                                     S01117
     CLR         *IN74     IFEQ '0'                                       E00093
     CLR         *IN76     ANDEQ'1'                                       E00093
     CLR         SWRIT     IFNE 0                                         S01117
     CLR         SWRIT     ANDNE@BKBIN                                    S01117
     C*                                                                   E00093
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          E00093
     CLR                   Z-ADDSFNUM     ZSNUM   60                      E00093
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     C*********************PARM           SFNUM                     S01117E00093
     CLR                   PARM           ZSNUM                           E00093
     CLR                   PARM *BLANK    ZSERR   1                       E00093
     C*                                                                   E00093
     CLR         ZSERR     IFEQ 'Y'                                       E00093
     CLR                   SETON                     U7U8                 E00093
     CLR                   RETRN                                          E00093
     CLR                   END                                            E00093
     CLR                   END                                            E00093
     CLR                   END                                            E00093
0509 C*                                                                   S01117
     C** ENSURE AUDIT FILE RECORDED BY RCF                                S01117
     C*                                                                   E00093
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          E00093
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      E00093
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     C*********************PARM           SFNUMU                    S01117E00093
     CLR                   PARM           ZSNUMU                          E00093
     CLR                   PARM *BLANK    ZSERR                           E00093
     C*                                                                   E00093
     CLR         ZSERR     IFEQ 'Y'                                       E00093
     CLR                   SETON                     U7U8                 E00093
     CLR                   RETRN                                          E00093
     CLR                   END                                            E00093
0328 C*****SET*OF FOR NEW PAGE                                            S01153
0329 C***********                                                         S01153
0330 C*R*71******          SETON                         U8               S01153
     C*                                                                   E296
     C* READ THE BANK DETAILS FILE (WHEN RUN ON EMPTY FILES)              E296
     C*                                                                   E296
     CLRN40                CALL 'AOBANKR0'                                E296
     C                     PARM '*MSG    '@RTCD   7                       E296
     C                     PARM '*FIRST  '@OPTN   7                       E296
     C           @BANK     PARM @BANK     DSFDY                           E296
     C*                                                                   E296
     CLRN40      @RTCD     IFNE *BLANK                                    E296
     CLRN40                MOVEL'SDBANKPD'DBFILE 10        *************  E296
     CLRN40                MOVEL'002'     DBASE   3        * DBERR 002 *  E296
     CLRN40                MOVEL@OPTN     DBKEY   7        *************  E296
     CLRN40                MOVE '1'       *INU7                           E296
     CLRN40                MOVE '1'       *INU8                           E296
     CLRN40                EXSR *PSSR                                     E296
     CLR                   END                                            E296
0331 C********************************************************************
0332 C**   INFLDS SR. SETS UP INCOMING AMT & CCY FIELDS & FINDS NBR.
0333 C**   OF DECIMAL PLACES FOR EDITING INCOMING AMOUNT
0334 C           INFLDS    BEGSR                           **  INFLDS  **
0335 C**
0336 C                     MOVE ECCY      INCCY
0337 C                     MOVE ECCY      XCCY
0338 C                     Z-ADDEAMT      INAMT
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0660CCP6                                           S01408
     C*                                                                   S01408
     C           CDL099    IFEQ 'Y'                                                           CDL099
      *                                                                                       CDL099
      ** Set up incoming amounts & currency fields.                                           CDL099
      *                                                                                       CDL099
     C   59                MOVE OTHC      INCCY                                               CDL099
     C   59                MOVE OTHC      XCCY                                                CDL099
     C   59                Z-ADDOTHA      INAMT                                               CDL099
      *                                                                                       CDL099
     C                     ENDIF                                                              CDL099
0339 C**
0340 C**   FOR EVENT TYPE 16M1 READ EVENT FILE FOR PRINCIPAL
0341 C**   INCREASES/DECREASES AND SUB/ADD THESE TO AMOUNT TO BE OUTPUT.
0342 C**
0343 C           ETYP      COMP '16M1'                   33
0344 C  N33                GOTO TAG4
     C                     Z-ADDDLNO      DLNOD
     C                     MOVE ETYP      ETYPD
     C           DLNKEY    KLIST
     C                     KFLD           DLNOD
     C                     KFLD           ETYPD
     C           DLNKEY    SETGTEVNTDEDF               80
     C   80                SETON                     U7U8LR
0346 C           TAG3      TAG
0347 C                     SETOF                     313202
     C                     READ EVNTDEDF                 81
     C   81
0350 CORN02                GOTO TAG4
0351 C           DLNOD     COMP DLNO                 3030
0352 C      30             GOTO TAG4
0353 C           ETYPD     COMP '16V3'                   31
0354 C           ETYPD     COMP '16M4'                   32
0355 C  N31N32             GOTO TAG3
     C*                                                                   050789
     C** No need to add/sub amount if deal amendment value date           050789
     C** greater than next working day.                                   050789
     C           EDATD     IFGT BJDNWD                                    050789
     C                     GOTO TAG3                                      050789
     C                     END                                            050789
     C*                                                                   050789
     C** 'PI' of DEP (V3)- should add to the INAMT                        060306
     C** 'PD' of DEP (M4)- should sub from the INAMT                      060306
     C*                                                                   060306
0356 C***31******INAMT     SUB  EAMTD     INAMT                           060306
0357 C***32******INAMT     ADD  EAMTD     INAMT                           060306
     C   31      INAMT     ADD  EAMTD     INAMT                           060306
     C   32      INAMT     SUB  EAMTD     INAMT                           060306
0358 C                     GOTO TAG3
0359 C           TAG4      TAG
0360 C**
0361 C                     EXSR CCYDEP
0362 C           XDECP     COMP 1                      4445
0363 C           XDECP     COMP 2                    47  46
0364 C                     ENDSR
0365 C********************************************************************
0366 C**   OUTFLD SR. DOES THE SAME FOR OUTGOING AMOUNT & CCY.
0367 C           OUTFLD    BEGSR                           **  OUTFLD  **
     C   66                                                               S01119
0368 COR 61                MOVE OTHC      OUTCCY                          S01119
0368 C***61****************MOVE OTHC      OUTCCY                          S01119
0369 C***62****************MOVE ECCY      OUTCCY                   S01119 SA1157
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0660CCP7                                           S01408
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C   59                MOVE ECCY      OUTCCY                                              CDL099
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
     C*                                                                   SA1157
     C   30                                                SALES          SA1157
0369 COR 62                MOVE ECCY      OUTCCY                          SA1157
0370 C                     MOVE OUTCCY    XCCY
     C   66                                                               S01119
 371 COR 61                Z-ADDOTHA      OUTAMT                          S01119
 371 C***61****************Z-ADDOTHA      OUTAMT                          S01119
0372 C***62****************Z-ADDEAMT      OUTAMT                   S01119 SA1157
0369 C   30                                                SALES          SA1157
0372 COR 62                Z-ADDEAMT      OUTAMT                          SA1157
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0660CCP8                                           S01408
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C   59                Z-ADDEAMT      OUTAMT                                              CDL099
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
0373 C**
0374 C**   FOR EVENT TYPE 15M1 READ EVENT FILE FOR PRINCIPAL
0375 C**   INCREASES/DECREASES AND SUB/ADD THESE TO AMOUNT TO BE OUTPUT.
0376 C**
0377 C                     SETOF                     33
0378 C   62      ETYP      COMP '15M1'                   33
0379 C  N33                GOTO TAG2
     C                     Z-ADDDLNO      DLNOD
     C                     MOVE ETYP      ETYPD
     C           DLNKEY    SETGTEVNTDEDF               80
     C   80                SETON                     U7U8LR
0381 C           TAG1      TAG
0382 C                     SETOF                     313202
     C                     READ EVNTDEDF                 81
     C   81
0385 CORN02                GOTO TAG2
0386 C           DLNOD     COMP DLNO                 3030
0387 C   30                GOTO TAG2
0388 C           ETYPD     COMP '15V3'                   31
0389 C           ETYPD     COMP '15M4'                   32
0390 C  N31N32             GOTO TAG1
     C*                                                                   050789
     C** No need to add/sub amount if deal amendment value date           050789
     C** greater than next working day.                                   050789
     C           EDATD     IFGT BJDNWD                                    050789
     C                     GOTO TAG1                                      050789
     C                     END                                            050789
     C*                                                                   050789
     C** 'PI' of LOANS (V3)- should add to the OUTAMT                     060306
     C** 'PD' of LOANS (M4)- should sub from the OUTAMT                   060306
     C*                                                                   060306
0391 C***31******OUTAMT    SUB  EAMTD     OUTAMT                          060306
0392 C***32******OUTAMT    ADD  EAMTD     OUTAMT                          060306
     C   31      OUTAMT    ADD  EAMTD     OUTAMT                          060306
     C   32      OUTAMT    SUB  EAMTD     OUTAMT                          060306
0393 C                     GOTO TAG1
     C*                                                                   050789
0394 C           TAG2      TAG
0395 C**
0396 C                     EXSR CCYDEP
0397 C           XDECP     COMP 1                      4849
0398 C           XDECP     COMP 2                    51  50
0399 C                     ENDSR
0400 C****
0401 C********************************************************************
0402 C**
0403 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
0404 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
0405 C**
0406 C           CCYARR    BEGSR                           *** CCYARR  ***
0407 C**
0408 C**   SET ARRAY INDEX TO ZERO.
0409 C                     Z-ADD0         X       30
0410 C**
0411 C*****SET*UP*KEY*FOR*CURRENCY*TABLE.**********                       S01194
0412 C*****                MOVEL'20      'XCYKEY 12                       S01194
0413 C*****                MOVE '    '    XCYKEY                          S01194
0414 C**
0415 C*****SET*LOWER*LIMIT*AND*READ*CURRENCY*TABLE*HEADER.**              S01194
0416 C*****      XCYKEY    SETLLTABLED                                    S01194
     C* ACCESS CURRENCIES FILE                                            S01194
     C           *LOVAL    SETLLSDCURRL0                                  S01194
0417 C**
0418 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0419 C           XLOOP     TAG                             ** XLOOP TAG **
0420 C*****                READ TABLED                   99               S01194
     C                     READ SDCURRL0                 99               S01194
0421 C**N99****  RECTX     COMP 20                   9999                 S01194
0422 C**
0423 C**   END IF ALL CURRENCY RECORDS PROCESSED
0424 C   99                GOTO XEND
0425 C**
0426 C*****IGNORE*DELETED*RECORDS*AND*NON-SUB-RECORD*ONE.****             S01194
0427 C*****      RECIX     COMP 'D'                  9797                 S01194
0428 C***97                GOTO XLOOP                                     S01194
0429 C*****      SRECX     COMP 1                    9797                 S01194
0430 C***97                GOTO XLOOP                                     S01194
0431 C**
0432 C**   INCREMENT ARRAY INDEX.
0433 C           X         ADD  1         X
0434 C**
0435 C**   MOVE DATA INTO ARRAYS.
0436 C*****                MOVE CCYX      CCYA,X                          S01194
0437 C*****                MOVE CDPX      DPA,X                           S01194
0436 C                     MOVE A6CYCD    CCYA,X                          S01194
0437 C                     MOVE A6NBDP    DPA,X                           S01194
0438 C**
0439 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0440 C           X         COMP 150                      96
0441 C**
0442 C**   GO TO READ NEXT RECORD.
0443 C  N96                GOTO XLOOP
0444 C**
0445 C           XEND      TAG                             ** XEND TAG  **
0446 C                     ENDSR
0447 C**
0448 C********************************************************************
0449 C**
0450 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
0451 C**
0452 C           CCYDEP    BEGSR                           *** CCYDEP  ***
0453 C**
0454 C**   SET ARRAY INDEX TO ONE AND RESET ERROR INDICATOR.
0455 C                     Z-ADD1         X            99
0456 C**
0457 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0458 C                     Z-ADD0         XDECP   10
0459 C                     MOVE XCCY      XCCY    3
0460 C**
0461 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0462 C**   99 SETON FOR INVALID CURRENCY.
0463 C           XCCY      LOKUPCCYA,X                   95
0464 C   95                MOVE DPA,X     XDECP
0465 C  N95                SETON                     99
0466 C**
0467 C                     ENDSR
0468 C**
0469 C********************************************************************
0470 C**
0471 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0472 C**
0473 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0474 C**
0475 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0476 C**
0477 C**   CLEAR DATE FIELDS.
0478 C                     Z-ADD0         ZDATE   60
0479 C                     MOVEL'       ' ZADATE  7
0480 C**
0481 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0482 C                     Z-ADDZDAYNO    ZDAYNO  50
0483 C**
0484 C**   DETERMINE YEAR NUMBER.
0485 C**
0486 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0487 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0488 C   99                GOTO ZDEND2
0489 C**
0490 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0491 C           ZDAYN1    DIV  1461      ZLYR    20
0492 C                     MVR            ZDAYN1           SAVE REMAINING
0493 C**                                                   DAYS
0494 C**   CALCULATE NUMBER OF REMAINING YEARS.
0495 C                     Z-ADD1         ZWRK2   20
0496 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0497 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0498 C  N90      ZWRK2     ADD  1         ZWRK2
0499 C  N90                GOTO ZDTAG1
0500 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0501 C**
0502 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0503 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0504 C**
0505 C**   CALCULATE ACTUAL YEAR NUMBER.
0506 C           ZLYR      MULT 4         ZWRK3   30
0507 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0508 C                     Z-ADDZWRK3     ZYEAR   20
0509 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0510 C**
0511 C**   DETERMINE MONTH NUMBER.
0512 C**
0513 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0514 C                     SETOF                     9293
0515 C   91      ZDAYN1    COMP 59                     9293
0516 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0517 C**
0518 C**   CALCULATE MONTH NUMBER.
0519 C                     Z-ADD2         ZWRK2
0520 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0521 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0522 C  N94      ZWRK2     ADD  1         ZWRK2
0523 C  N94                GOTO ZDTAG2
0524 C           ZWRK2     SUB  1         ZWRK2
0525 C**
0526 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0527 C**
0528 C**   DETERMINE DAY OF MONTH.
0529 C**
0530 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0531 C           ZDAYN1    ADD  1         ZDAYN1
0532 C**
0533 C**   CALCULATE DAY OF MONTH.
0534 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0535 C**
0536 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0537 C   93      ZDAY      ADD  1         ZDAY
0538 C**
0539 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0540 C  N98                MOVELZDAY      ZWRK4   40
0541 C   98                MOVE ZDAY      ZWRK4
0542 C  N98                MOVE ZMTH      ZWRK4
0543 C   98                MOVELZMTH      ZWRK4
0544 C                     MOVELZWRK4     ZDATE
0545 C                     MOVE ZYEAR     ZDATE
0546 C**
0547 C**   FORMAT ALPHA DATE, DDMMMYY.
0548 C           ZDAY      COMP 10                     95
0549 C                     MOVELZDAY      ZWRK5   5
0550 C   95                MOVEL' '       ZWRK5
0551 C                     MOVE ZMNM,ZMTH ZWRK5
0552 C                     MOVELZWRK5     ZADATE
0553 C                     MOVE ZYEAR     ZADATE
0554 C**
0555 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0556 C**
0557 C**
0558 C********************************************************************
0559 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0560 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0561 C*
0562 CSR         GLZADD    BEGSR                           *** GLZADD ****
0563 C*
0564 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0565 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0566 C*
0567 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0568 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0569 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0570 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0571 C*
0572 CSR                   EXSR GLZSUM
0573 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0574 C*
0575 C********************************************************************
0576 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0577 C*                        GLZADD, GLZSUB, GLZCMP.
0578 C*          PARAMETERS PASSED -
0579 C*                     I/P ZZAMTI ZZAMTD
0580 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0581 C*
0582 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0583 C*
0584 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0585 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0586 CSR                   SETOF                     919293
0587 CSR                   SETOF                     949599
0588 C*
0589 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0590 CSR         ZZAMTI    COMP 0                      9293
0591 CSR 93      ZZAMTD    COMP 0                      9293
0592 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0593 C*
0594 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0595 CSR         ZZTOTI    COMP 0                      9193
0596 CSR 93      ZZTOTD    COMP 0                      9193
0597 C*
0598 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0599 CSR 93                Z-ADDZZAMTI    ZZTOTI
0600 CSR 93                Z-ADDZZAMTD    ZZTOTD
0601 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0602 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0603 CSR 91N92
0604 CORN91 92             GOTO ZZOFPS
0605 C*
0606 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0607 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0608 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0609 C*
0610 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0611 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0612 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0613 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0614 C*
0615 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0616 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0617 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0618 CSRN99                Z-ADDZZWK2     ZZTOTD
0619 CSRN99                Z-ADDZZWK3     ZZTOTI
0620 C*
0621 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0622 CSR 99                Z-ADD0         ZZAMT  153
0623 CSR                   GOTO ZZSEND
0624 C*
0625 C* THE 'SIGNS' ARE DIFFERENT
0626 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0627 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0628 C*
0629 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0630 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0631 C*
0632 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0633 C*
0634 CSR 91                Z-SUBZZTOTI    ZZTOTI
0635 CSR 91                Z-SUBZZTOTD    ZZTOTD
0636 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0637 C*
0638 CSR         ZZTOTI    COMP ZZAMTI               93  95
0639 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0640 C*
0641 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0642 CSR 95                Z-ADD0         ZZTOTI
0643 CSR 95                Z-ADD0         ZZTOTD
0644 CSR 95                GOTO ZZSEND
0645 C*
0646 C* IF ZZTOT GT. ZZAMT.
0647 CSR 93      ZZAMTD    COMP ZZTOTD               94
0648 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0649 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0650 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0651 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0652 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0653 C*
0654 C*
0655 C* IF ZZAMT GT. ZZTOT.
0656 CSRN93      ZZTOTD    COMP ZZAMTD               94
0657 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0658 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0659 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0660 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0661 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0662 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0663 C*
0664 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0665 CSR                   SETOF                     94
0666 CSR 93 91
0667 CORN93 92             SETON                     94
0668 CSR 94                Z-SUBZZTOTI    ZZTOTI
0669 CSR 94                Z-SUBZZTOTD    ZZTOTD
0670 C**
0671 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0672 CSR 92                Z-SUBZZAMTI    ZZAMTI
0673 CSR 92                Z-SUBZZAMTD    ZZAMTD
0674 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0675 C**
0676 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0677 CSR                   SETOF                     96
0678 CSR         ZZTOTD    COMP 0                        91
0679 CSR 91      ZZTOTI    COMP 0                      96
0680 CSR 96                MOVE '.000-'   ZZNEGD  5
0681 CSR                   ENDSR                             ** ENDSR **
0682 C********************************************************************
0683 C********************************************************************
0684 C******                                                              S01194
0685 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0686 C******                                                              S01194
0687 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0688 C*****                                                               S01194
0689 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0690 C*****                MOVEL'01      'ZTABKY 12                       S01194
0691 C*****                MOVE '  10'    ZTABKY                          S01194
0692 C*****                                                               S01194
0693 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0694 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0695 C*****                                                               S01194
0696 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0697 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0698 C*****                                                               S01194
0699 C*****                ENDSR                                          S01194
0700 C*****                                                               S01194
0701 C**
0702 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*****************************************************************   S01194
0703 O*PRINT  H   03   22                                                 S01124
0703 O*******DL0660P1H   03   22                                    S01124E00093
0704 O*******       OR        41                                          E00093
0703 ODL0660P1H   03   22 76N74                                           E00093
     O*******AND      N85                                           101151117314
0704 O       OR        41 76N74                                           E00093
     O*******AND      N85                                           101151117314
0705 O***********                        22 'REFERENCE DL0660'            S01117
0705 O                                   24 'REFERENCE DL0660P1'          S01117
0706 O*****                    TITL      89                               S01194
0706 O                         BJURPT    89                               S01194
0707 O                                  122 'DATE              PAGE'
0708 O*****                    RUNA     112                               S01194
0708 O                         BJMRDT   112                               S01194
0709 O                         PAGE  Z  127
0710 O********H 2      22                                                 E00093
0711 O*******OR        41                                                 E00093
0710 O        H 2      22 76N74                                           E00093
0710 O*******AND      N85                                           101151117314
0711 O       OR        41 76N74                                           E00093
0710 O*******AND      N85                                           101151117314
     O*                                                                   AUS018
     O** PRINT APPROPRIATE HEADING TO REFLECT IF REPORT IS FX OR MM ONLY  AUS018
0712 O***********                        65 'OUTSTANDING DEALS '          AUS018
     O*****************52****************62 'OUTSTANDING FX DEALS 'AUS018 101151
     O*****************53****************62 'OUTSTANDING MM DEALS 'AUS018 101151
     O                 52                65 'OUTSTANDING FX DEALS '       101151
     O                 53                65 'OUTSTANDING MM DEALS '       101151
     O                 54                65 'OUTSTANDING DEALS '          AUS018
0713 O                                   76 'BY CUSTOMER'
0714 O********H 1      22                                                 E00093
0715 O*******OR        41                                                 E00093
0714 O        H 1      22 76N74                                           E00093
0714 O*******AND      N85                                           101151117314
0715 O       OR        41 76N74                                           E00093
0714 O*******AND      N85                                           101151117314
     O*                                                                   AUS018
     O** PRINT APPROPRIATE HEADING TO REFLECT IF REPORT IS FX OR MM ONLY  AUS018
0716 O***********                        65 '------------------'          AUS018
     O*****************52****************62 '---------------------'AUS018 101151
     O*****************53****************62 '---------------------'AUS018 101151
     O                 52                65 '---------------------'       101151
     O                 53                65 '---------------------'       101151
     O                 54                65 '------------------'          AUS018
0717 O                                   76 '-----------'
0714 O        H 2      22 76N74                                           LN0614
0714 O*******AND      N85                                           101151117314
0715 O       OR        41 76N74                                           LN0614
0714 O*******AND      N85                                           101151117314
0716 O                                   18 'CONSOLIDATED'                LN0614
0718 O********H 2      22NLR                                              E00093
0719 O*******OR        41                                                 E00093
0718 O        H 2      22NLR 76                                           E00093
     O*******AND******N74*****************                         E00093 101151
     O*******AND      N74N85                                        101151117314
     O       AND      N74                                                 117314
0719 O       OR        41 76N74                                           E00093
     O*******AND      N85                                           101151117314
0720 O**********                         50 'DEAL   DEAL   VALU'          S01378
0721 O**********                         61 'E  MATURITY'                 S01378
     O***********************************40 'DEAL   DEAL'          S01378 CDL038
     O                                   38 'DEAL   DEAL'                 CDL038
     O                                   61 'VALUE  MATURITY'             S01378
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0660OOP1                                           S01408
      *                                                                                       CDL099
     O                N35                61 'VALUE  MATURITY'                                 CDL099
     O                 35                62 'VALUE  MAT/OTHER'                                CDL099
      *                                                                                       CDL099
     O*                                                                   S01408
0722 O                                   86 'PURCHASE/'
0723 O**********************************125 'SALE/'                       S01119
0723 O                                  126 'SALE/'                       S01119
0724 O********H 1      22NLR                                              E00093
0725 O*******OR        41                                                 E00093
0724 O        H 1      22NLR 76                                           E00093
     O*******AND******N74*****************                         E00093 101151
     O*******AND      N74N85                                        101151117314
     O       AND      N74                                                 117314
0725 O       OR        41 76N74                                           E00093
     O*******AND      N85                                           101151117314
0726 O                                   12 'CUSTOMER'
0727 O**********                         53 'NUMBER  TYPE    DATE  '      S01378
     O***********************************40 'NUMBER  TYPE'         S01378 CDL038
     O                                   38 'NUMBER  TYPE'                CDL038
     O                                   51 'DATE'                        S01378
0728 O                                   65 '  DATE   CCY'
0729 O**********************************102 'TAKING       RATE      '     S01119
0730 O**********************************125 'CCY            PLACING'      S01119
0729 O                                  102 'TAKING            RATE '     S01119
0730 O                                  125 '    CCY        PLACING'      S01119
0731 O        D 2      56 01
0732 O       OR        24NLR 01
0733 O*****                    CNUM       6                               S01117
     O                         CUNR       6                               S01117
0734 O                         CRNM      27
0735 O        D 1      56 01
0736 O       OR 1      24NLR 01
0737 O                         CTWN      17
     O*                                                                   AUS018
     O** CONDITION PRINTING OF LINES BASED ON REPORT TYPE SELECTED        AUS018
0738 O********D*1      61 01                                              AUS018
0740 O*******OR*1      62 01                                              AUS018
0742 O*******OR*1      63 01                                              AUS018
     O*******OR*1      64 01                                        S01119AUS018
     O*******OR*1      65 01                                        S01119AUS018
     O*******OR*1      66 01                                        S01119AUS018
     O*******OR*1      67 01                                        S01119AUS018
     O        D 1      61 01 52                                           AUS018
     O       OR 1      62 01 53                                           AUS018
     O       OR 1      63 01 53                                           AUS018
     O       OR 1      61 01 54                                           AUS018
     O       OR 1      62 01 54                                           AUS018
     O       OR 1      63 01 54                                           AUS018
     O       OR 1      64 01 54                                           AUS018
     O       OR 1      65 01 54                                           AUS018
     O       OR 1      66 01 54                                           AUS018
     O       OR 1      67 01 54                                           AUS018
0743 O**********               DLNO      37                               S01378
0744 O**********               DTYP      40                               S01378
0745 O**********                         41 '-'                           S01378
0746 O**********               DLST      43                               S01378
     O**********       75      BYSL      44                         SA1157S01378
     O*************************DLNO      34                        S01378 CDL038
     O*************************DTYP      37                        S01378 CDL038
     O*************************          38 '-'                    S01378 CDL038
     O*************************DLST      40                        S01378 CDL038
     O*****************75******BYSL      42                        S01378 CDL038
     O*************************PCLI      44                        S01378 CDL038
     O                         DLNO      32                               CDL038
     O                         DTYP      35                               CDL038
     O                                   36 '-'                           CDL038
     O                         DLST      38                               CDL038
     O                         CLAS      42                               CDL038
     O                         PCLI      44                               CDL038
     O                 75      BYSL      44                               CDL038
0747 O                         VDATA     52
0748 O                      N10MDATA     61
0749 O                      N11NOTD      56
0750 O                      N11          61 ' DAYS'
0751 O                    10 11          61 'CALL'
0752 O                    61 10          61 '       '
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0660OOP2                                           S01408
      *                                                                                       CDL099
     O                 35 61N36UOTHDA    61                                                   CDL099
      *                                                                                       CDL099
     O*                                                                   S01408
0753 O                         INCCY     65
0754 O                       44INAMT     84 ' ,   ,   ,   , 0 -'
0755 O                       45INAMT     86 '   ,   ,   , 0 . -'
0756 O                       46INAMT     87 '  ,   ,   , 0 .  -'
0757 O                       47INAMT     88 ' ,   ,   , 0 .   -'
0758 O*************************EXRT     103 '   0 .        -'             S01119
0759 O*************************OUTCCY   106                               S01119
0760 O***********************48OUTAMT   125 ' ,   ,   ,   , 0 -'          S01119
0761 O***********************49OUTAMT   127 '   ,   ,   , 0 . -'          S01119
0762 O***********************50OUTAMT   128 '  ,   ,   , 0 .  -'          S01119
0763 O***********************51OUTAMT   129 ' ,   ,   , 0 .   -'          S01119
     O                    12N67UBRTT     91                               S01119
0758 O                       13EXRT     106 '   0 .        -'             S01119
     O                N67N13 14UEINR    106 '  0 .       -'               S01119
     O*******************N13 67CLRAT    106 '  0 .       -'        S01119 SA1157
     O                N18N13 67CLRAT    106 '  0 .       -'               SA1157
     O                 18N13 67FLRAT    106 '  0 .       -'               SA1157
0759 O                       13OUTCCY   110                               S01119
     O                       30OUTCCY   110                               SA1157
0760 O                    13 48OUTAMT   128 ' ,   ,   ,   , 0 -'          S01119
0761 O                    13 49OUTAMT   130 '   ,   ,   , 0 . -'          S01119
0762 O                    13 50OUTAMT   131 '  ,   ,   , 0 .  -'          S01119
0763 O                    13 51OUTAMT   132 ' ,   ,   , 0 .   -'          S01119
0760 O                    30 48OUTAMT   128 ' ,   ,   ,   , 0 -'          SA1157
0761 O                    30 49OUTAMT   130 '   ,   ,   , 0 . -'          SA1157
0762 O                    30 50OUTAMT   131 '  ,   ,   , 0 .  -'          SA1157
0763 O                    30 51OUTAMT   132 ' ,   ,   , 0 .   -'          SA1157
0738 O********D*1      64 01                                        S01119AUS018
0740 O*******OR*1      65 01                                        S01119AUS018
0742 O*******OR*1      66 01                                        S01119AUS018
0738 O        D 1      64 01 54                                           AUS018
0740 O       OR 1      65 01 54                                           AUS018
0742 O       OR 1      66 01 54                                           AUS018
     O                       17TBRTT     91                               S01119
     O                       15TEINR    106 '  0 .       -'               S01119
0759 O                       66OUTCCY   110                               S01119
0760 O                    66 48OUTAMT   128 ' ,   ,   ,   , 0 -'          S01119
0761 O                    66 49OUTAMT   130 '   ,   ,   , 0 . -'          S01119
0762 O                    66 50OUTAMT   131 '  ,   ,   , 0 .  -'          S01119
0763 O                    66 51OUTAMT   132 ' ,   ,   , 0 .   -'          S01119
     O********D*1      67 01                                        S01119AUS018
0742 O        D 1      67 01 54                                           AUS018
     O                      N12TBRTT     91                               S01119
     O                       12UBRTT     91                               S01119
     O                N12N69 15TEINR    106 '  0 .       -'               S01119
     O                N69 14 12UEINR    106 '  0 .       -'               S01119
     O                       69AACRT    106 '  0 .       -'               S01119
0738 O        D 1      67 01 68                                           S01119
     O*******AND      N18                                           SA1157AUS018
     O       AND      N18 54                                              AUS018
     O                         FLRAT    106 '  0 .       -'               S01119
     O*                                                                   090893
     O********E*1**************FXPRT******                         090893 101151
     O        D 1      82                                                 101151
     O*************************DLNO      34                        090893 CDL038
     O*************************DTYP      37                        090893 CDL038
     O*************************          38 '-'                    090893 CDL038
     O*************************DLST      40                        090893 CDL038
     O*************************PCLI      44                        090893 CDL038
     O                         DLNO      32                               CDL038
     O                         DTYP      35                               CDL038
     O                                   36 '-'                           CDL038
     O                         DLST      38                               CDL038
     O                         CLAS      42                               CDL038
     O                         PCLI      44                               CDL038
     O                         VDATA     52                               090893
     O                      N10MDATA     61                               090893
     O                      N11NOTD      56                               090893
     O                      N11          61 ' DAYS'                       090893
     O                    26 10          61 '       '                     090893
     O                         INCCY     65                               090893
     O                       44INAMT     84 ' ,   ,   ,   , 0 -'          090893
     O                       45INAMT     86 '   ,   ,   , 0 . -'          090893
     O                       46INAMT     87 '  ,   ,   , 0 .  -'          090893
     O                       47INAMT     88 ' ,   ,   , 0 .   -'          090893
     O                       13EXRT     106 '   0 .        -'             090893
     O                N67N13 14UEINR    106 '  0 .       -'               090893
     O                N18N13 67CLRAT    106 '  0 .       -'               090893
     O                 18N13 67FLRAT    106 '  0 .       -'               090893
     O                       13OUTCCY   110                               090893
     O                    13 48OUTAMT   128 ' ,   ,   ,   , 0 -'          090893
     O                    13 49OUTAMT   130 '   ,   ,   , 0 . -'          090893
     O                    13 50OUTAMT   131 '  ,   ,   , 0 .  -'          090893
     O                    13 51OUTAMT   132 ' ,   ,   , 0 .   -'          090893
     O*                                                                   090893
     O********E*1**************DPPRT******                         090893 101151
     O        D 1      83                                                 101151
     O*************************DLNO      34                        090893 CDL038
     O*************************DTYP      37                        090893 CDL038
     O*************************          38 '-'                    090893 CDL038
     O*************************DLST      40                        090893 CDL038
     O*************************PCLI      44                        090893 CDL038
     O                         DLNO      32                               CDL038
     O                         DTYP      35                               CDL038
     O                                   36 '-'                           CDL038
     O                         DLST      38                               CDL038
     O                         CLAS      42                               CDL038
     O                         PCLI      44                               CDL038
     O                         VDATA1    52                               136233
     O*************************MDATA*****61                        090893 101151
     O                         MDATA1    61                               101151
     O                      N11NOTD      56                               090893
     O                      N11          61 ' DAYS'                       090893
     O                    26 10          61 '       '                     090893
     O                         INCCY     65                               090893
     O***********************44INAMT*****84 ' ,   ,   ,   , 0 -'   090893 101151
     O***********************45INAMT*****86 '   ,   ,   , 0 . -'   090893 101151
     O***********************46INAMT*****87 '  ,   ,   , 0 .  -'   090893 101151
     O***********************47INAMT*****88 ' ,   ,   , 0 .   -'   090893 101151
     O***********************13EXRT******06 '   0 .        -'      090893 101151
     O                       44INAMT1    84 ' ,   ,   ,   , 0 -'          101151
     O                       45INAMT1    86 '   ,   ,   , 0 . -'          101151
     O                       46INAMT1    87 '  ,   ,   , 0 .  -'          101151
     O                       47INAMT1    88 ' ,   ,   , 0 .   -'          101151
     O                       13EXRT1    106 '   0 .        -'             101151
     O*                                                                   090893
     O********E*1**************LNPRT******                         090893 101151
     O        D 1      84                                                 101151
     O*************************DLNO      34                        090893 CDL038
     O*************************DTYP      37                        090893 CDL038
     O*************************          38 '-'                    090893 CDL038
     O*************************DLST      40                        090893 CDL038
     O*************************PCLI      44                        090893 CDL038
     O                         DLNO      32                               CDL038
     O                         DTYP      35                               CDL038
     O                                   36 '-'                           CDL038
     O                         DLST      38                               CDL038
     O                         CLAS      42                               CDL038
     O                         PCLI      44                               CDL038
     O                         VDATA1    52                               136233
     O*************************MDATA*****61                        090893 101151
     O                         MDATA2    61                               101151
     O                      N11NOTD      56                               090893
     O                      N11          61 ' DAYS'                       090893
     O                    26 10          61 '       '                     090893
     O***********************13EXRT*****106 '   0 .        -'      090893 101151
     O                       13EXRT2    106 '   0 .        -'             101151
     O                       13OUTCCY   110                               090893
     O********************13*48OUTAMT***128 ' ,   ,   ,   , 0 -'   090893 133929
     O********************13*49OUTAMT***130 '   ,   ,   , 0 . -'   090893 133929
     O********************13*50OUTAMT***131 '  ,   ,   , 0 .  -'   090893 133929
     O********************13*51OUTAMT***132 ' ,   ,   , 0 .   -'   090893 133929
     O                    13 48OUTAM1   128 ' ,   ,   ,   , 0 -'          133929
     O                    13 49OUTAM1   130 '   ,   ,   , 0 . -'          133929
     O                    13 50OUTAM1   131 '  ,   ,   , 0 .  -'          133929
     O                    13 51OUTAM1   132 ' ,   ,   , 0 .   -'          133929
     O********T   03   LR 85                                        101151117314
     O********                           24 'REFERENCE DL0661P1'    101151117314
     O********                 BJURPT    89                         101151117314
     O********                          122 'DATE              PAGE'101151117314
     O********                 BJMRDT   112                         101151117314
     O********                 PAGE  Z  127                         101151117314
     O********T 1      LR 85                                        101151117314
     O********                                                      101151117314
     O***PRINT*APPROPRIATE HEADING TO REFLECT IF REPORT IS FX OR MM ONLY42117314
     O********         52                65 'OUTSTANDING FX DEALS ' 101151117314
     O********         53                65 'OUTSTANDING MM DEALS ' 101151117314
     O********         54                65 'OUTSTANDING DEALS '    101151117314
     O********                           76 'BY CUSTOMER'           101151117314
     O********T 1      LR 85                                        101151117314
     O********                                                      101151117314
     O***PRINT*APPROPRIATE HEADING TO REFLECT IF REPORT IS FX OR MM ONLY42117314
     O********         52                65 '---------------------' 101151117314
     O********         53                65 '---------------------' 101151117314
     O********         54                65 '------------------'    101151117314
     O********                           76 '-----------'           101151117314
1081 O********T 2      LR   N74                                     S01117E00093
1081 O        T 2      LRN74 76                                           E00093
1082 O                                   72 '*** END OF REPORT ***'       S01117
     O********T   22   LRNU7 74                                           E00093
     O********                           59 '***   NO DETAILS TO '        E00093
     O********                           71 'REPORT   ***'                E00093
0764 O********T** 03   LR                                                 S01117
0764 ODL0660AUT  203   LR                                                 S01117
0765 O***********                        22 'REFERENCE DL0660'            S01117
0765 O                                   24 'REFERENCE DL0660AU'          S01117
0766 O*****                    TITL      89                               S01194
0766 O                         BJURPT    89                               S01194
0767 O                                  122 'DATE               PAGE'
0768 O*****                    RUNA     112                               S01194
0768 O                         BJMRDT   112                               S01194
0769 O***********              PAGE  Z  127                               S01117
0769 O                         PAGE1 Z  127                               S01117
0770 O        T 2      LR
     O*                                                                   AUS018
     O** PRINT APPROPRIATE HEADING TO REFLECT IF REPORT IS FX OR MM ONLY  AUS018
0771 O***********                        65 'OUTSTANDING DEALS '          AUS018
     O*****************52****************62 'OUTSTANDING FX DEALS 'AUS018 101151
     O*****************53****************62 'OUTSTANDING MM DEALS 'AUS018 101151
     O                 52                65 'OUTSTANDING FX DEALS '       101151
     O                 53                65 'OUTSTANDING MM DEALS '       101151
     O                 54                65 'OUTSTANDING DEALS '          AUS018
0772 O                                   76 'BY CUSTOMER'
0773 O        T 1      LR
     O*                                                                   AUS018
     O** PRINT APPROPRIATE HEADING TO REFLECT IF REPORT IS FX OR MM ONLY  AUS018
0774 O***********                        65 '------------------'          AUS018
     O*****************52****************62 '---------------------'AUS018 101151
     O*****************53****************62 '---------------------'AUS018 101151
     O                 52                65 '---------------------'       101151
     O                 53                65 '---------------------'       101151
     O                 54                65 '------------------'          AUS018
0775 O                                   76 '-----------'
0776 O        T   20   LRNU7
0777 O                                   18 'RUN CONTROLS'
0778 O        T 2      LRNU7
0779 O                                   59 'NUMBER'
0780 O                                   84 'VALUE'
0781 O        T 2      LRNU7
0782 O                                   32 'SORTED EVENTS FILE RECOR'
0783 O                                   40 'DS INPUT'
0784 O                         RREAD 3   59
0785 O                         RRINT Z   81
0786 O                         RRDEC     84
0787 O                       70RRDEC 3   84
0788 O***********            71          89 '***'                         S01153
0789 O********T*2      LRNU7                                              S01153
0790 O***********                        32 'SORTED EVENTS FILE CONTR'    S01153
0791 O***********                        41 'OL TOTALS'                   S01153
0792 O***********              NORE  3   59                               S01153
0793 O***********              HRWN  Z   81                               S01153
0794 O***********              HRDC      84                               S01153
0795 O***********            72HRDC  3   84                               S01153
0796 O***********            71          89 '***'                         S01153
0797 O        T 2      LRNU7
0798 O                                   31 'RECORDS LISTED IN THIS '
0799 O                                   37 'REPORT'
0800 O                         RWRITN3   59
0801 O                         RWINT Z   81
0802 O                         RWDEC     84
0803 O                       73RWDEC 3   84
0804 O********T*2      LRNU7 71                                           S01153
0805 O***********                        71 '***   DIFFERENCE   ***'      S01153
     O********T   22   LRNU7 74                                           S01117
     O********                           59 '***   NO DETAILS TO '        S01117
     O********                           71 'REPORT   ***'                S01117
     O        T 22     LRNU7 74                                           E131
     O                                   65 '***   NO DETAILS TO '        E131
     O                                   77 'REPORT   ***'                E131
0809 O******  T 2      LRNU7                                              E299
0810 O******                             71 '*** END OF REPORT ***'       E299
0811 O        T 2      LR U7 U8
0812 O***********************************22 'REFERENCE DL0660'
0813 O***********************************62 'PRINT TERMINATED, '
0814 O***********************************80 'DATABASE IN ERROR.'
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     54                               S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
