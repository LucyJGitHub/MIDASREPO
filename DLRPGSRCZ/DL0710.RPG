0001 H        1                                                           S01194
0002 F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Deposits by maturity date report')            *
0002 F*****************************************************************
0004 F*                                                               *
     F*  Midas - Dealing Module                                       *
0004 F*                                                               *
0005 F*       DL0710  -  DEPOSITS BY MATURITY DATE REPORT             *
0006 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0008 F*                                                               *
      *  Last Amend No. CGL165             Date 17Feb15               *
      *  Prev Amend No. CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 AR996895           Date 25Nov12               *
      *                 AR787620           Date 10Jun11               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CDL081             Date 14Dec09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CDL013             Date 08Jun06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CDL028             Date 07Feb05               *
      *                 CDL021             Date 05Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 196633             Date 15Apr01               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 178833             Date 22May00               *
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 121768             DATE 19Feb98               *
      *                 084827             DATE 16Jan98               *
     F*                       126017          DATE 14NOV97            *
     F*                       101985          DATE 03MAR97            *
     F*                       098012          DATE 18FEB97               *
     F*                       097885          DATE 31JAN97               *
     F*                       S01408          DATE 25APR96               *
     F*                       S01408          DATE 06FEB96               *
     F*                       095244          DATE 01NOV95               *
     F*                       095238          DATE 31OCT95               *
     F*                       087554          DATE 01JUN95               *
     F*                       066550          DATE 04FEB94               *
     F*                       048329          DATE 22MAR93               *
     F*                       S01393          DATE 11AUG92               *
     F*                       S01383          DATE 27APR92               *
     F*                       S01354          DATE 07JAN92               *
     F*                       LN0662          DATE 01FEB91               *
     F*                       LN0614          DATE 14SEP90               *
     F*                       BHF348          DATE 31AUG90               *
     F*                       E296            DATE 30MAR90               *
     F*                       E257            DATE 21MAR90               *
     F*                       E146            DATE 07DEC89               *E146
     F*                       E145            DATE 05DEC89               *E145
     F*                       E95             DATE 29NOV89               *S01117
0009 F*                       S01117          DATE 12/05/89              *S01117
     F*                       S01194          DATE 12/05/89              *S01194
     F*                       S01157          DATE 03/10/88              *S01157
0009 F*                       S01153          DATE 08/07/88              *S01153
     F*                       S01119          DATE 15/06/87              *
     F*                       S01124          DATE 00/00/00              *
     F*                                                                  *
0011 F********************************************************************
     F*                                                               *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,DLH00056                                 *
      *             WNCPYSRC,DLH00057                                 *
      *             WNCPYSRC,DLH00058                                 *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (recompiled)                                        *
      *  CDL081 - Tiered withholding tax rounding upgrade             *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CDL013 - Tiered Withholding Tax                              *
      *  CDL049 - Addition of a Reference Rate field                  *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CDL021 - Reports by Deal Type                                *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  196633 - Interest for fixed deals incorrect. It does not     *
      *           include the interest adjustment done for the deal.  *
     F*  178833 - Error in CDL006 causes DLC0804 to fail. Output to   *
     F*           DL0710P3 should be conditioned on *IN61             *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  CDL006 - Fiduciary Dealing.                                  *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  084827 - For discounted bills, TA, TB and DA, output face    *
     F*           value rather than purchase price on the report      *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  101985 - Interest amount is wrong for Call Loans/Deposits    *
     F*  098012 - Wrong interest amount shown for CD deal with MDAT.  *
     F*           Notice days is updated as -999 when maturity date   *
     F*           is entered for CD, should use MDAT as end date      *
     F*           instead of run date + notice days.                  *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  S01408 - Addition of core hook DL0710CCP5                       *
     F*         - Addition of core hook DL0710CCP4                       *
     F*         - Addition of core hook DL0710FFP1                       *
     F*         - Addition of core hook DL0710OOP1                       *
     F*         - Addition of core hook DL0710OOP2                       *
     F*  S01408 - Addition of core hook DL0710CCP1                       *
     F*         - Addition of core hook DL0710CCP2                       *
     F*         - Addition of core hook DL0710CCP3                       *
     F*    095244 - Recompiled for Calculation method 3                  *
     F*    095238 - Recompiled for Calculation method 3                  *
     F*    087554 - Incorrect interest on report, caused by 048329. This *
     F*             fix was designed to recalculate interest for Loans/  *
     F*             Deposits but also tried to recalculate interest for  *
     F*             N/A's Purchased, although the fields are not defined *
     F*             for DEALSDD. Do not recalculate interest for these   *
     F*             deals - use the interest amount on file.             *
     F*    066550 - GLINTC has had historical problems and inaccuracies  *
     F*             and is now externaly descibed and changed to use     *
     F*             ZINTDYZ1. See document atached to error no on GEMS   *
     F*       048329 - Round up calculated interest. According to        *
     F*                Mukhtiar Singh of Sydney; Interest amount printed *
     F*                should be as follows:                             *
     F*                Call Deals: Interest accrued so far plus          *
     F*                            additional notice days.               *
     F*                Term Deals: Should show interest to maturity date.*
     F*                Ideally, this should be done at extract program   *
     F*                DL0400 but it is decided to recalculate it here   *
     F*                because DL0400 extracted details are used for     *
     F*                other processing which if changed might cause     *
     F*                other upsets.                                     *
     F*                                                                  *
     F*       S01393 - Recompiled for Strategic Risk Management          *
     F*                Book Code added to PF/EVNTXED                     *
     F*       S01383 - BASIC RATE TAX INCORPORATION                      *
     F*       S01354 - INTERNAL FUNDING DEALS                            *
     F*       LN0662 - CHANGES TO SDCURRL0 AND L1                        *
     F*       LN0614 - 'CONSOLIDATED' INSERTED IN REPORT TITLE           *LN0614
     F*       BHF348 - RENAME PRINTER FILES TO USE PROGRAM NAME          *
     F*       E296   - PROG SHOULD READ SDBANK WHEN EMPTY FILES          *
     F*       E257   - CHANGE PRINTER FILE NAME TO REFLECT THE ONE REFERE-
     F*                NCED BY RCF IN REPORT DISTRIBUTING                *
     F*       E146   - INCORRECT CUSTOMER NUMBER ON REPORT               *
     F*       E145   - P1 SHOULD HAVE HEADING                            *
0010 F*       E95 - PREVENT P1 IF NO DETAILS                             *
     F*       S01117 - MULTIBRANCHING                                     S01117
     F*       S01194 - NEW STANDING DATA                                  S01194
0011 F*       S01157 - FRA/IRS ENHANCEMENTS                              *S01157
0011 F*                (i)  SPLIT DEAL TYPE 'RL' INTO 'RR' (COLLAR),     *S01157
     F*                     'RP' (CAP) AND 'RF' (FLOOR). DO NOT OUTPUT   *S01157
     F*                     CEILING RATE IF DEAL TYPE IS 'RF'.           *S01157
     F*                (ii) ALTER REPORT TO DISPLAY BUY/SELL INDICATOR   *S01157
     F*                     NEXT TO THE DEAL TYPE (eg. 'FR-01B')         *S01157
     F*       S01153 - CLOSE OF BUSINESS IMPROVEMENTS                     S01153
     F*       S01119 - BASE RATE TYPE FIELD ADDED FOR FRA/IRS            *
0010 F*                                                                  *
0011 F********************************************************************
0012 F* ID F  C  H  L    FUNCTION OF INDICATORS
0013 F**01************SORTED EVENTS FILE - HEADER                         S01153
0014 F* 02                               - DETAIL - REQUIRED
0015 F**03*******                        - TRAILER                        S01153
0016 F* 04                               - NOT REQUIRED
0017 F* 05            DEALS DETAILS
0018 F* 06            EVENTS DETAILS - ARBITRAGE
     F* 08            EVENT TYPE IS 'FR' OR 'RS'                          S01119
     F* 09            EVENT TYPE IS 'RX'                                  S01119
     F**10************EVENT*TYPE*IS*'RL'***                        S01119 S01157
     F* 10            EVENT TYPE IS 'RR', 'RP' OR 'RF'                    S01157
     F* 11            AN FRA/IRS EVENT TYPE                               S01119
     F* 12            OUR DETAILS                                         S01119
     F* 13            FLOOR RATE PRESENT                                  S01119
     F* 14            AVERAGE RATE METHOD USED                            S01119
     F* 15            THEIR DETAILS                                       S01119
     F* 16            OUR FED FUNDS PRESENT                               S01119
     F* 17            THEIR FED FUNDS PRESENT                             S01119
0019 F*       18      DEAL TYPE IS 'RF' (FLOOR)                           S01157
0019 F*       19      INTEREST TAX RATE IS NON-ZERO
0019 F*       20      FIRST CYCLE PROCESSING DONE
0020 F*       21      EVENT TYPE TO BE PROCESSED
0021 F*       22      NO DETAILS TO REPORT
0022 F*       23      OVER FLOW REACHED WITHIN A CONTROL GROUP
0023 F*       24      DEAL TYPE 'CL' OR 'CD'
0024 F*       25      ROLLOVER INDICATOR IS 'Y'
0025 F*       26      EVENT DATE IS ZERO
0026 F*       27      CONDITION OVERFLOW PRINTING
0027 F*       28      EVENT TYPE '17M3'
     F*       29      EVENTS HEADER AND TRAILER READ FAIL                 S01119
0028 F*       30      CCX HAS 0 D.P.
0029 F*       31              1 D.P.
0030 F*       32              2 D.P.
0031 F*       33              3 D.P.
     F*       34      OUR FLOATING RATE HAS BEEN ENTERED                  S01119
     F*       35      THEIR FLOATING RATE HAS BEEN ENTERED                S01119
     F*       36      BUY/SELL FIELD SHOULD BE DISPLAYED                  S01157
0032 F*       40      CHAIN FAIL
0036 F*       41      CHANGE IN EDAT FOR INTERNAL DEALS                   S01354
0036 F*       42      CHANGE IN EDAT FOR MM/FX/FRA/IRSs                   S01354
0037 F*       43      OFF - INTERNAL DEALS, on MM/FX/FRA/IRSs             S01354
      *       44      Change in date for fiduciary related trans.     *   CDL006
0019 F*       45      TAXABLE INDICATOR IS 'Y'
0019 F*       46      OUTPUT AMOUNT ROLLED LINE OR TAX LINE
      *       47      Fiduciary detail line                           *   CDL006
      *       48      Output amt rolled or tax line for fiduciary     *   CDL006
     F*       51      OTHER CCY HAS 0 D.P.                                S01119
     F*       52      OTHER CCY HAS 1 D.P.                                S01119
     F*       53      OTHER CCY HAS 2 D.P.                                S01119
     F*       54      OTHER CCY HAS 3 D.P.                                S01119
     F*       58      P1 IS OPENED FOR OUTPUT                             E95
     F*       59      P2 IS OPENED FOR OUTPUT OF INTERNAL DEALS           S01354
      *       60      P3 is opened for output                         *   CDL006
      *       61      Fiduciary deal type indicator                   *   CDL006
0040 F*       63      OVERFLOW - HEADINGS INDICATOR FOR INTERNAL DEALS    S01354
      *       64      Overflow - headings indicator for P3            *   CDL006
     F*                                                                   S01119
0033 F*VNT2***IP**E***********K********DISK                               S01119
     F***EVNTXEC*IP**E*****               DISK                     S01119 S01354
0033 F***EVNT2J**IS**E*****      K        DISK                     S01119 S01354
     F/COPY WNCPYSRC,DL0710F005
0033 FEVNT2J  IP  E           K        DISK                               S01354
     F*VNTXZZ*IF* E                    DISK                     S01119    S01153
0034 F*TABLE***IF**F******96 12AI     2 DISK                              S01194
0035 F*TABLED**IF**F******96 12AI     2 DISK                              S01194
     F/COPY WNCPYSRC,DL0710F003
     F*SDCURRL0IF  E           K        DISK                       S01194 LN0662
     F/COPY WNCPYSRC,DL0710F004
     FSDCURRL1IF  E           K        DISK                               LN0662
0036 F*EALS***IF**F*****400**6AI     2 DISK                               S01119
     F/COPY WNCPYSRC,DL0710F001
0036 F***DEALS** IF  F     600  6AI     2 DISK                                         S01119 CGL029
0036 FDEALS   IF  F    2325  6AI     2 DISK                                                   CGL029
     F/COPY WNCPYSRC,DL0710F002
     FSDBRTDL1IF  E           K        DISK                               S01383
     FSDCBRTL1IF  E           K        DISK                               S01383
0037 F*PRINT  O   F     132     OF     PRINTER                            S01124
0037 F*L0710P1O***F*****132     OF     PRINTER                      S01124S01117
0037 F*******DL0710P1O   F     132     OF     PRINTER      KINFDS SPOOL   E95
     F**DL0710P1O   F     132     OF     PRINTER      KINFDS SPOOLUC  E95 E257
     F**DL0700P1O   F     132     OF     PRINTER      KINFDS SPOOL  UCE257BHF348
     FDL0710P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  BHF348
0037 F***DL0710AUO   F     132     OA     PRINTER      KINFDSSPOOLUS01117 E257
0037 F**DL0700AUO   F     132     OA     PRINTER      KINFDS SPOOLU   E257BHF348
0037 FDL0710AUO   F     132     OA     PRINTER      KINFDS SPOOLU         BHF348
0049 FDL0710P2O   F     132     OG     PRINTER      KINFDS SPOOL2     UC  S01354
     FDL0710P3O   F     132     OC     PRINTER      KINFDS SPOOL3     UC  CDL006
      *                                                                                       CDL013
     FSDSTAAL1IF  E           K        DISK                           UC                      CDL013
      ** WHT ICD extension file                                                               CDL013
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0710FFP1                                           S01408
     F*                                                                   S01408
     E                    CPY@    1   1 80                                S01194
0038 E                    CCYA      150  3
0039 E                    DPA       150  1 0
0040 E                    INT         2 15 0
0041 E                    DEC         2  3 0
0042 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0043 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0044 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
      *                                                                   066550
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
      *                                                                   066550
0045 I*    EVENTS FILE - HEADER RECORD.                                   S01119
0046 I*                                                                   S01119
0047 I*EVNTXECF    01                                              S01119 S01354
0050 I*
0051 I*    EVENTS FILE - DETAIL RECORD.
0052 I*
0053 I*VNTXEDF                                                            S01119
0053 IEVNT2JF                                                             S01119
0070 I*********************                         EDAT  L1              S01354
0119 I****************************************                            S01119
0120 I*****EVENTS*FILE*-*TRAILER*RECORD.******                            S01119
0121 I****************************************                            S01119
     I*VNTXZZF****03**************************                            S01119
0130 I*********************                                               S01194
0131 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0132 I*********************                                               S01194
0133 I*ABLE***NS*******2 C0   3 C1  12 C1                                 S01194
0134 I*******AND******13 C0                                               S01194
0135 I*********************                   1   1 RECI                  S01194
0136 I*********************                   2   30RECT                  S01194
0137 I*********************                  12  130RCDE                  S01194
0138 I*********************                  14  66 TITL                  S01194
0139 I*********************                  67  67 DATF                  S01194
0140 I*********************                  68  700DFBR                  S01194
0141 I*********************                  74  74 MODI1                 S01194
0142 I*********************                  75  75 MODI2                 S01194
0143 I*********************                  76  76 MODI3                 S01194
0144 I*********************               P  77  790RUND                  S01194
0145 I*********************                  80  86 RUNA                  S01194
0146 I*********************                  87  870SFLG                  S01194
0147 I*********************               P  90  920LCD                   S01194
0148 I*********************                  93  93 CHTP                  S01194
0149 I*********************               P  94  960TNLU                  S01194
0153 I*********************                                               S01194
0154 I*****TABLE FILE*-*INSTALLATION CONTROL DATA RECORD 5.               S01194
0155 I*********************                                               S01194
     I*ABLE***NS***********   2 C0   3 C1                                 S01194
     I*******AND******12 C4  13 C0                                        S01194
     I*********************                   1   1 RECI                  S01194
     I*********************                   2   30RECT                  S01194
     I*********************                  12  130RCDE                  S01194
     I*********************                  18  210CSAC                  S01194
     I*********************                  22  22 TLII                  S01194
     I*********************                  23  23 MCRI                  S01194
     I*********************               P  24  250MCEP                  S01194
     I*********************                  26  270MCLP                  S01194
     I*********************                  28  28 FRDI                  S01194
     I*********************                  29  29 BRCF                  S01194
     I*********************                  30  350PSCN                  S01194
     I*********************                  36  380DLBR                  S01194
     I*********************                  39  420FRPA                  S01194
     I*********************                  43  460FRPC                  S01194
     I*********************                  47  49 USCY                  S01194
     I*********************                  50  52 STCY                  S01194
     I*********************               P  53  553MBGE                  S01194
     I*********************                  56  56 PRID                  S01194
     I*********************               P  90  920LCD                   S01194
     I*********************                  93  93 CHTP                  S01194
     I*********************               P  94  960TNLU                  S01194
     I*********************               P  87  892TAXR                  S01194
0150 I*********************                                               S01194
0151 I*****CATCHALL                                                       S01194
0152 I********NS**********                                                S01194
0153 I*********************                                               S01194
0154 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0155 I*********************                                               S01194
0156 I*ABLED  NS       2 C2   3 C0                                        S01194
0157 I*********************                   1   1 RECIX                 S01194
0158 I*********************                   2   30RECTX                 S01194
0159 I*********************                  10  12 CCYX                  S01194
0160 I*********************                  13  130SRECX                 S01194
0161 I*********************                  38  380CDPX                  S01194
0162 I*********************                                               S01194
0163 I********NS***********                                               S01194
0164 I*********************                   2   30RECTX                 S01194
0165 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0166 I*
0167 IDEALS   NS  05   1 CD   8 CC
0168 I       OR   05   1 CE   8 CC
0169 I       OR   05   1 CM   8 CC
0170 I       OR   05   1 CR   8 CC
0171 I                                        1   1 RECI
0172 I                                        2   70DLNO
0173 I                                        8   8 RCDT
0174 I                                        9  100RCDC
0175 I**********                             11  160CNUM                                      CSD027
0175 I                                       11  16 CNUM                                      CSD027
0176 I*********************                  17  190BRCD                  S01117
0176 I                                       17  19 BRCA                  S01117
0177 I                                       20  21 DTYP
0178 I                                       22  23 DLST
0179 I                                    P  24  260DDAT
0180 I                                    P  27  290VDAT
0181 I                                    P  30  320MDAT
0182 I                                       33  340CDAS
0183 I                                       35  38 BRKC
0184 I                                    P  39  450BAGE
0185 I                                       46  48 CCY
0186 I                                    P  49  550PCPL
0187 I                                       56  56 INTC
0188 I                                       63  640BRTT
0189 I                                    P  65  707BRTE
0190 I                                    P  71  767RTSP
0191 I                                    P  77  827INTR
0192 I                                       83  850NOTD
0193 I                                       86 105 RNNA
0194 I**********                            106 1110CHNA                                      CSD027
0194 I                                      106 111 CHNA                                      CSD027
0195 I                                      112 1140FACT
0196 I                                      115 1160FCNO
0197 I                                    P 117 1230OPAM
0198 I                                    P 124 1308BCXR
0199 I                                    P 131 1378LCXR
0200 I                                      138 1390SDST
0201 I**********                            140 151 OSDA                                      CGL029
0201 I                                      140 151 OSDAQQ                                    CGL029
0202 I                                      152 161 TSTN
0203 I                                      162 1630MDST
0204 I**********                            164 175 OMDA                                      CGL029
0204 I                                      164 175 OMDAQQ                                    CGL029
0205 I                                      176 185 TMAN
0206 I                                      186 1910RODN
0207 I                                    P 192 1980RODA
0208 I                                      199 2040RBDN
0209 I                                    P 205 2110RBDA
0210 I                                      212 2120ICBS
0211 I                                      213 213 IPFR
0212 I                                    P 214 2200TOTI
0213 I                                    P 221 2230NIDT
0214 I                                    P 224 2260IBDT
0215 I                                    P 227 2290SLID
0216 I                                    P 230 2360AIPD
0217 I                                    P 237 2390DLRC
0218 I                                    P 240 2420IACD
0219 I                                    P 243 2490AITC
0220 I                                    P 250 2560AIAN
0221 I                                    P 257 2630AIAP
0222 I                                    P 264 2700IPRD
0223 I                                    P 271 2770IPRM
0224 I                                    P 278 2840ICTD
0225 I                                    P 294 2960DAVD
0226 I                                      297 2990DASN
0227 I                                      300 309 FACO
0228 I                                      310 344 SPI
0229 I                                      345 3460INTF
0230 I                                      370 370 DNSI
0231 I                                      371 371 DSTI
0232 I                                      372 372 CNFI
0233 I                                      373 373 ACEI
0234 I                                      374 374 TLXI
0235 I                                    P 391 3930ORED
0236 I                                    P 394 3960LCD
0237 I                                      397 397 CHTP
0238 I                                    P 398 4000TNLU
0204 I                                     16721689 OMDA                                      CGL029
0201 I                                     16901707 OSDA                                      CGL029
     I                                    P204020478FSRRAT                                    CDL049
     I/COPY WNCPYSRC,DL0710I001
 165 I*    DEALS FILE - DETAIL -  N/A PURCHASED.
 166 I*
0167 I        NS  07   1 CD   8 CD
0168 I       OR   07   1 CE   8 CD
0169 I       OR   07   1 CM   8 CD
0170 I       OR   07   1 CR   8 CD
0177 I                                       20  21 DTYP                  084827
0191 I                                    P  77  827INTR
     I                                    P 117 1230FVAL                  084827
     I                                    P143314408FSRRAT                                    CDL049
0239 I*
0240 I*    CATCHAL
0241 I        NS
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I****************************           83  90 SFILE                 S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I****************************        B 243 2460SWRIT                 S01117
     I                                    B 188 1890OFLLN                 S01354
     I                                    B 367 3680PRTLN                 S01354
      *                                                                   066550
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
      *                                                                   066550
     C*                                                                   S01117
     I**@BINRY****  DS                                                    S01117
     I***DEFINE*A*BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I************                        B   1   40@BKBIN                S01117
     ISPOOLU      DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I****************************           83  90 SFILEU                S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I*                                                                   S01194
     ISPOOL2      DS                                                      S01354
     I** FILE INFORMATION DATA STRUCTURE                                  S01354
     I                                       83  92 SFILE2                S01354
     I                                    B 123 1240SFNUM2                S01354
     I                                    B 188 1890OFLLN2                S01354
     I                                    B 367 3680PRTLN2                S01354
      *                                                                   CDL006
     ISPOOL3      DS                                                      CDL006
      ** File information Data Structure                                  CDL006
     I                                       83  92 SFILE3                CDL006
     I                                    B 123 1240SFNUM3                CDL006
     I                                    B 188 1890OFLLN3                CDL006
     I                                    B 367 3680PRTLN3                CDL006
      *                                                                   CDL006
     I*                                                                   S01354
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                              CDL006
      ** Switchable Features File                                         CDL006
      *                                                                   CDL006
     ISDDEAL    E DSSDDEALPD                                              S01194
     I** EXTERNAL DS FOR DEALIING DETAILS                                 S01194
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I/COPY WNCPYSRC,DL0710I002
     I/EJECT
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CDL081
      ** Named constants                                                                      CDL081
      *                                                                                       CDL081
     I              'BasCcyTaxRoundDown'  C         C#BASE                                    CDL081
     I              'NBasCcyTaxRoundDown' C         C#NBAS                                    CDL081
      *                                                                                       CGL029
      *                                                                   S01117
      * ENTRY PARAMETER REQUIRED BY RCF                                   S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ                             S01117
     C                     PARM           PARMS   8                                           CDL038
     C*********************PARM           PARMS   4                                    CDL021 CDL038
      *                                                                   S01117
     C           2         SUBSTPARMS:1   TYP1    2                                           CDL021
     C           2         SUBSTPARMS:3   TYP2    2                                           CDL021
     C           4         SUBSTPARMS:5   TYP3    4                                           CDL038
     C           TYP1      IFNE *BLANKS                                                       CDL021
     C           TYP1      ANDNE'**'                                                          CDL021
     C                     MOVE '1'       *IN88                                               CDL021
     C           TYP2      IFNE *BLANKS                                                       CDL021
     C           TYP2      ANDNE'**'                                                          CDL021
     C                     MOVE '1'       *IN89                                               CDL021
     C                     ENDIF                                                              CDL021
     C                     ENDIF                                                              CDL021
     C/COPY WNCPYSRC,DLH00407
0243 C* R.I.I.S SETON BY 'EVENT TYPES' AND/OR DEAL SUB-TYPES
     C                     SETOF                     020406
     C                     SETOF                     080910               S01119
     C                     SETOF                     111314               S01119
     C                     SETOF                     151617               S01119
     C                     SETOF                     24                   S01119
     C/COPY WNCPYSRC,DL0710C005
     C           DLNO      CHAINDEALS                40
     C           *IN40     IFEQ '1'
     C*********************GOTO ERROR                                     S01117
     C                     MOVEL'DEALS   'DBFILE 10        ************   S01117
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *   S01117
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01117
     C                     MOVELDLNO      DBKEY  29                       S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO END                                       S01117
     C                     END
     C/COPY WNCPYSRC,DL0710C013
      *                                                                   CDL049
      * Retrieve Reference Rate                                           CDL049
     C           CDL049    IFEQ 'Y'                                       CDL049
     C                     Z-ADDFSRRAT    #RRAT  138                      CDL049
     C                     END                                            CDL049
     C*                                                                   084827
     C* For Accepted/Discounted bills (TA), Discounted bills (BA)         084827
     C* and Treasury Bills (TB), output face value rather than the        084827
     C* purchase price on the report.                                     084827
     C           *IN07     IFEQ '1'                                       084827
     C           DTYP      IFEQ 'TA'                                      084827
     C           DTYP      OREQ 'DA'                                      084827
     C           DTYP      OREQ 'TB'                                      084827
     C                     Z-ADDFVAL      EAMT                            084827
     C                     END                                            084827
     C                     END                                            084827
     C           ETYP      IFEQ '15M1'
     C                     SETON                     02
     C                     ELSE
     C           ETYP      IFEQ '16M1'
     C                     SETON                     02
     C                     ELSE
     C           ETYP      IFEQ '17M3'
     C*
     C** 17M3 NOT PROCESSED FOR INTEREST BEARING N/A PURCHASED
     C*
     C           INTR      IFEQ *ZEROS
     C                     SETON                     02
     C                     ELSE
     C                     SETON                     04
     C                     END
     C*
     C                     ELSE
     C           ETYP      IFEQ '17M1'
     C*
     C**  17M1 PROCESSED FOR INTEREST BEARING N/A'S ONLY
     C*
     C           INTR      IFNE *ZEROS
     C                     SETON                     02
     C                     ELSE
     C                     SETON                     04
     C                     END
     C                     ELSE
     C           ETYP      IFEQ '20V1'
     C           FSLI      IFEQ 2
     C                     SETON                     06
     C                     ELSE
     C                     SETON                     04
     C                     END
     C                     ELSE
     C           ETYP      IFEQ '20V2'
     C           FSLI      IFEQ 2
     C                     SETON                     06
     C                     ELSE
     C                     SETON                     04
     C                     END
     C                     ELSE
     C                     SETON                     04
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C*                                                                   S01119
     C**   CHECK FOR FRA/IRS EVENT TYPES                                  S01119
     C*                                                                   S01119
     C           ETYP      COMP '21O1'                   08               S01119
     C  N08      ETYP      COMP '22O1'                   08               S01119
     C  N08      ETYP      COMP '23O1'                   09               S01119
     C  N08N09   ETYP      COMP '24O1'                   10               S01119
     C*                                                                   S01157
     C** Set up Buy/Sell display field for relevant Event Types           S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN36                           S01157
     C                     MOVELETYP      @BSIND  2                       S01157
     C           @BSIND    IFEQ '21'                                      S01157
     C           @BSIND    OREQ '24'                                      S01157
     C                     MOVE '1'       *IN36                           S01157
     C*                                                                   S01157
     C** If Deal has been bought, then Fixed Rate is on Our Side,EXCEPT   S01157
     C** for Floor, where system is fooled into treating it as a Collar   S01157
     C** with an impossibly high ceiling                                  S01157
     C*                                                                   S01157
     C           UBRTT     IFEQ *ZERO                                     S01157
     C           DTYP      ANDNE'RF'                                      S01157
     C           UBRTT     ORNE *ZERO                                     S01157
     C           DTYP      ANDEQ'RF'                                      S01157
     C                     MOVE 'B'       @BYSL   1                       S01157
     C                     ELSE                                           S01157
     C                     MOVE 'S'       @BYSL                           S01157
     C                     END                                            S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C** IF DEAL TYPE IS A FLOOR OUTPUT FLOOR RATE AND NO CEILING RATE    S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN18                           S01157
     C           DTYP      IFEQ 'RF'                                      S01157
     C                     MOVE '1'       *IN18                           S01157
     C                     END                                            S01157
     C*                                                                   S01119
     C**   SET UP AN INDICATOR IF FRA/IRS EVENT TYPE                      S01119
     C*                                                                   S01119
     C                     MOVEA*IN,08    INDS    4                       S01119
     C           INDS      IFNE '0000'                                    S01119
     C                     SETON                     11                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
0243 C*    FIRST CYCLE CALCULATIONS.
0244 C   20                GOTO NOTFC
0245 C                     SETON                     20
0245 C                     SETON                     23                   E145
     C                     MOVEACPY@      BIS@   80                       S01194
0290 C**  INITIALISE LAST EVENT DATE FIELDS                               S01354
0291 C*                                                                   S01354
0292 C                     Z-SUB99999     INTMDT  50                      S01354
0292 C                     Z-SUB99999     LSTDAT  50                      S01354
0246 C*
0247 C*****ACCESS*INSTALLATION*CONTROL*DATA.**                            S01194
0248 C*********************EXSR ZSYSTM                                    S01194
     C*                                                                   S01194
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   S01194
0249 C*
0249 C*****ACCESS*I.C.D.*RECORD*5.*FOR*THE*INTEREST*TAX*RATE**            S01194
     C*********************MOVE '40'      ZTABKY                          S01194
     C***********ZTABKY****CHAINTABLE                99                   S01194
     C***********TAXR******COMP 0                    1919                 S01194
     C*
     C** READ DEALING DETAILS VIA ACCESS PROGRAM                          S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDEALPD'DBFILE           ************   S01194
     C                     MOVEL'03'      DBASE            * DBERR 03 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                                       CDL013
      ** Call acces program to check if CDL013 is installed                                   CDL013
     C                     CALL 'AOSARDR0'                                                    CDL013
     C                     PARM *BLANKS   @RTCD   7                                           CDL013
     C                     PARM '*VERIFY' @OPTN   7                                           CDL013
     C                     PARM 'CDL013'  @SARD   6                                           CDL013
     C                     PARM           DSFDY                                               CDL013
      *                                                                                       CDL013
      ** If CDL013 NOT installed, set CAR field & indicator to '0'                            CDL013
     C           @RTCD     IFNE *BLANKS                                                       CDL013
     C                     MOVE '0'       CDL013  1                                           CDL013
     C                     MOVE *OFF      *IN62                                               CDL013
      *                                                                                       CDL013
      ** If CDL013 installed                                                                  CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
      ** set CAR field & indicator to '1', set Tax indicator ON and                           CDL013
      ** declare work field to access WHT ICD extension file.                                 CDL013
     C                     MOVE '1'       CDL013                                              CDL013
     C                     MOVE *ON       *IN62                                               CDL013
     C                     MOVE *ON       *IN19                                               CDL013
     C                     MOVEL'RETAIL'  WTYPE  10 P                                         CDL013
      *                                                                                       CDL013
      ** Open & access WHT ICD extension file to retrieve WHT rate                            CDL013
     C                     OPEN SDSTAAL1                                                      CDL013
     C           WTYPE     CHAINSDSTAAL1             40                                       CDL013
      *                                                                                       CDL013
      ** If CHAIN failed                                                                      CDL013
     C           *IN40     IFEQ '1'                                                           CDL013
     C                     MOVEL'SDSTAAL1'DBFILE 10        ************                       CDL013
     C                     MOVELWTYPE     DBOPTN  7        * DBERR 09 *                       CDL013
     C                     MOVEL'09'      DBASE   2        ************                       CDL013
     C                     SETON                     U7U8LR                                   CDL013
     C                     EXSR *PSSR                                                         CDL013
     C                     GOTO END                                                           CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0710CCP4                                           S01408
      *                                                                   CDL049
      * Check if switchable feature CDL049 is present                     CDL049
     C                     CALL 'AOSARDR0'                                CDL049
     C                     PARM '       ' @RTCD   7                       CDL049
     C                     PARM '*VERIFY' @OPTN   7                       CDL049
     C                     PARM 'CDL049'  @SARD   6                       CDL049
      *                                                                   CDL049
     C           @RTCD     IFEQ *BLANK                                    CDL049
     C                     MOVE 'Y'       CDL049  1                       CDL049
     C                     MOVE '1'       *IN67                           CDL049
     C                     ELSE                                           CDL049
     C                     MOVE 'N'       CDL049                          CDL049
     C                     MOVE '0'       *IN67                           CDL049
     C                     ENDIF                                          CDL049
     C/COPY WNCPYSRC,DLH00408
      *                                                                   CDL049
     C*                                                                   S01408
     C**                                                                  S01383
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED     S01383
     C**                                                                  S01383
     C                     CALL 'AOSARDR0'                                S01383
     C                     PARM '       ' @RTCD                           S01383
     C                     PARM '*VERIFY' @OPTN                           S01383
     C                     PARM 'S01383'  @SARD   6                       S01383
     C           @RTCD     IFNE *BLANK                                    S01383
     C           @RTCD     ANDNE'*NRF   '                                 S01383
     C                     MOVEL'SCSARDPD'DBFILE            * * * * * * * S01383
     C                     MOVEL'06'      DBASE             *DBERROR 006* S01383
     C                     MOVEL@RTCD     DBKEY             * * * * * * * S01383
     C                     SETON                     U7U8LR               S01383
     C                     EXSR *PSSR                                     S01383
     C                     GOTO END                                       S01383
     C                     END                                            S01383
     C           @RTCD     IFEQ *BLANK                                    S01383
     C                     MOVEL'Y'       S01383  1                       S01383
     C                     MOVEL'1'       *IN19                           S01383
     C                     END                                            S01383
     C/COPY WNCPYSRC,DLH00409
      *                                                                   CDL006
      ** Check if CDL006 is switched *ON.                                 CDL006
      *                                                                   CDL006
     C                     MOVE 'N'       CDL006  1                       CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM '       ' WRTCD   7                       CDL006
     C                     PARM '*VERIFY' WOPTN   7                       CDL006
     C                     PARM 'CDL006'  WSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           WRTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           WRTCD     IFNE *BLANKS                                   CDL006
     C           WRTCD     ANDNE'*NRF  '                                  CDL006
     C                     MOVEL'SCSARDPD'DBFILE 10                       CDL006
     C                     MOVEL'15'      DBASE   2                       CDL006
     C                     MOVELWOPTN     DBKEY                           CDL006
     C                     SETON                     U7U8LR               CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     GOTO END                                       CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     Z-SUB99999     FIDMDT  50                      CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C/COPY WNCPYSRC,DLH00056
     C*                                                                   S01383
     C** IF BRT SAR INSTALLED, ACCESS BRT INSTALLATION CONTROL DATA       S01383
     C*                                                                   S01383
     C           S01383    IFEQ 'Y'                                       S01383
     C                     MOVE 'D'       KRECI   1                       S01383
     C           KRECI     CHAINSDBRTDD0             40                   S01383
     C           *IN40     IFEQ '1'                                       S01383
     C                     MOVEL'SDBRTDPD'DBFILE            * * * * * * * S01383
     C                     MOVEL'07'      DBASE             *DBERROR 007* S01383
     C                     SETON                     U7U8LR * * * * * * * S01383
     C                     EXSR *PSSR                                     S01383
     C                     GOTO END                                       S01383
     C                     END                                            S01383
     C*                                                                   S01383
     C** ELSE IF BRT SAR NOT INSTALLED, CHECK FOR HK INTEREST TAX         S01383
     C*                                                                   S01383
     C                     ELSE                                           S01383
     C/COPY WNCPYSRC,DLH00410
0793 C           BNHKTR    COMP 0                    1919  TAX RATE NOT 0 S01383
     C/COPY WNCPYSRC,DLH00411
     C                     END                                            S01383
     C***********BNHKTR    COMP 0                    1919          S01194 S01383
      *                                                                                       CDL081
      ** Check if CDL081 is installed                                                         CDL081
      *                                                                                       CDL081
     C                     MOVE 'N'       CDL081  1                                           CDL081
     C                     CALL 'AOSARDR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD   7                                           CDL081
     C                     PARM '*VERIFY' POPTN   7                                           CDL081
     C                     PARM 'CDL081'  PSARD   6                                           CDL081
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C           PRTCD     ANDNE'*NRF   '                                                     CDL081
     C                     MOVEL'075'     DBASE                                               CDL081
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL081
     C                     MOVEL'CDL081'  DBKEY                                               CDL081
     C                     SETON                     U7U8LR                                   CDL081
     C                     EXSR *PSSR                                                         CDL081
     C                     GOTO END                                                           CDL081
     C                     END                                                                CDL081
      *                                                                                       CDL081
     C           PRTCD     IFEQ *BLANKS                                                       CDL081
     C                     MOVE 'Y'       CDL081                                              CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Access withholding tax round down system values if CDL081 is on                      CDL081
      *                                                                                       CDL081
     C           CDL081    IFEQ 'Y'                                                           CDL081
     C                     CALL 'AOSVALR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD                                               CDL081
     C                     PARM C#BASE    SVALK1 20                                           CDL081
     C                     PARM           SVAL1 200                                           CDL081
     C                     PARM C#NBAS    SVALK2 20                                           CDL081
     C                     PARM           SVAL2 200                                           CDL081
     C                     PARM *BLANK    SVALK3 20                                           CDL081
     C                     PARM           SVAL3 200                                           CDL081
     C                     PARM *BLANK    SVALK4 20                                           CDL081
     C                     PARM           SVAL4 200                                           CDL081
     C                     PARM *BLANK    SVALK5 20                                           CDL081
     C                     PARM           SVAL5 200                                           CDL081
     C                     PARM *BLANK    SVALK6 20                                           CDL081
     C                     PARM           SVAL6 200                                           CDL081
     C                     PARM *BLANK    SVALK7 20                                           CDL081
     C                     PARM           SVAL7 200                                           CDL081
     C                     PARM *BLANK    SVALK8 20                                           CDL081
     C                     PARM           SVAL8 200                                           CDL081
     C                     PARM *BLANK    SVALK9 20                                           CDL081
     C                     PARM           SVAL9 200                                           CDL081
     C                     PARM *BLANK    SVALK0 20                                           CDL081
     C                     PARM           SVAL10200                                           CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C                     MOVEL'076'     DBASE                                               CDL081
     C                     MOVEL'SDSVALPD'DBFILE                                              CDL081
     C           SVAL1     IFEQ '*NRF'                                                        CDL081
     C                     MOVELSVALK1    DBKEY                                               CDL081
     C                     ENDIF                                                              CDL081
     C           SVAL2     IFEQ '*NRF'                                                        CDL081
     C                     MOVELSVALK2    DBKEY                                               CDL081
     C                     ENDIF                                                              CDL081
     C                     SETON                     U7U8LR                                   CDL081
     C                     EXSR *PSSR                                                         CDL081
     C                     GOTO END                                                           CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Setup tax amount rounding down indicators                                            CDL081
      *                                                                                       CDL081
     C                     MOVELSVAL1     W#BSRD  1                                           CDL081
     C                     MOVELSVAL2     W#NBRD  1                                           CDL081
     C                     ENDIF                                                              CDL081
0249 C*
0250 C*    SET UP ARRAY OF CURRENCY DECIMAL PLACES.
0251 C                     EXSR CCYARR
0252 C*
0253 C*    DETAIL CALCULATIONS.
0254 C           NOTFC     TAG                             ** NOTFC TAG **
      *                                                                   CDL006
      ** Switch off fiduciary related indicators                          CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     MOVE *OFF      *IN44                           CDL006
     C                     MOVE *OFF      *IN64                           CDL006
     C                     MOVE *OFF      *IN47                           CDL006
     C                     MOVE *OFF      *IN48                           CDL006
     C                     ENDIF                                          CDL006
     C                     MOVE *OFF      *IN61                           CDL006
     C***03******          SETOF                     020406               S01153
0255 C***27******          SETOF                     2327                 S01354
0255 C                     SETOF                     4546
0309 C                     SETOF                     416343               S01354
0309 C                     SETOF                     4223                 S01354
0256 C*
0257 C*    INCREMENT COUNT OF RECORDS READ.
0258 C***01******                                                         S01153
0259 C*R*02******                                                         S01153
0260 C*R*03****************                                               S01119
0259 C   02                                                               S01153
0261 COR 06
     COR 11                                                               S01119
0262 COR 04      NREC      ADD  1         NREC    50
0263 C*
0264 C*    PROCESS DETAIL RECORDS ONLY.
0265 C***03****************GOTO TRAIL                                     S01119
0266 C**N02N04N06**********GOTO END                                       S01119
0266 C  N02N04N06                                                         S01119
     CANN11                GOTO END                                       S00119
      *
      ***RECORD*P1*SPOOL*FILE*ON*RCF*FILES********                E95     S01354
     C************INL1     IFEQ '1'                               E95     S01354
     C************IN58     ANDEQ'0'                               E95     S01354
     C***********          SETON                     58    ALLOW OE95     S01354
     C******               OPEN DL0710P1                                 E95E257
     C*********************OPEN DL0700P1                              E257BHF348
     C***********          OPEN DL0710P1                          BHF348  S01354
     C***********                                                  E95    S01354
      ***TRANSFER BINARY DATA INTO NUMERIC FIELD                   E95    S01354
     C***********          Z-ADDSFNUM     ZSNUM   60               E95    S01354
     C***********          CALL 'ZSFILE'                           E95    S01354
     C***********          PARM           SEQ                      E95    S01354
     C***********          PARM *BLANKS   @PARM   3                E95    S01354
     C***********          PARM           SFILE                    E95    S01354
     C***********          PARM           ZSNUM                    E95    S01354
     C***********          PARM *BLANK    ZSERR   1                E95    S01354
     C***********                                                  E95    S01354
     C***********ZSERR     IFEQ 'Y'                                E95    S01354
     C***********          SETON                     U7U8LR        E95    S01354
     C***********          RETRN                                   E95    S01354
     C***********          END                                     E95    S01354
     C***********          END                                     E95    S01354
0267 C*
0268 C*    ADD EVENT AMOUNT TO INPUT HASH TOTAL.
0269 C                     Z-ADD1         S       10
0270 C           EAMT      DIV  1000      ZZAMT
0271 C                     EXSR HASH
0272 C*
0273 C*    CHECK EVENT TYPE.
0274 C**N02N06*************GOTO END                                       S01119
0274 C  N02N06N11          GOTO END                                       S01119
0331 C*                                                                   S01354
0332 C****    PROCESS INTERNAL FUNDING DEALS                              S01354
0333 C*                                                                   S01354
0334 C           DTYP      IFEQ 'IL'                                      S01354
0335 C           DTYP      OREQ 'ID'                                      S01354
0338 C*                                                                   S01354
0344 C****   TO CHECK IF THERE'S A CHANGE IN EVENT DATE.            ***** S01354
0338 C*                                                                   S01354
0345 C           INTMDT    IFNE EDAT                                      S01354
0346 C                     Z-ADDEDAT      INTMDT                          S01354
0338 C                     MOVE '1'       *IN41                           S01354
      ** RECORD P2 SPOOL FILE ON RCF FILES                                S01354
     C           *IN59     IFEQ '0'                                       S01354
     C                     MOVE '1'       *IN59                           S01354
     C                     MOVE '1'       *IN63                           S01354
     C                     OPEN DL0710P2                                  S01354
     C*                                                                   S01354
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          S01354
     C                     Z-ADDSFNUM2    ZSNUM   60                      S01354
     C                     CALL 'ZSFILE'                                  S01354
     C                     PARM           SEQ                             S01354
     C                     PARM *BLANKS   @PARM   3                       S01354
     C                     PARM           SFILE2                          S01354
     C                     PARM           ZSNUM                           S01354
     C                     PARM *BLANK    ZSERR   1                       S01354
     C*                                                                   S01354
     C           ZSERR     IFEQ 'Y'                                       S01354
     C                     SETON                     U7U8LR               S01354
     C                     RETRN                                          S01354
     C                     END                                            S01354
     C                     END                                            S01354
0338 C                     END                                            S01354
0347 C*                                                                   S01354
0348 C*****  OVERFLOW DETECTED ? CONDITION OUTPUT HEADINGS & DATE   ***** S01354
0338 C*                                                                   S01354
0349 C           OFLLN2    SUB  PRTLN2    @REML2  30                      S01354
0349 C           @REML2    IFLE 4                                         S01354
0349 C                     MOVE '1'       *IN63                           S01354
0349 C                     MOVE '1'       *IN41                           S01354
0349 C                     END                                            S01354
0338 C*                                                                   S01354
0338 C****  ELSE NOT INTERNAL FUNDING DEAL                                S01354
0338 C*                                                                   S01354
0338 C                     ELSE                                           S01354
      *                                                                   CDL006
      ** Check if Deal type is a fiduciary regardless if CDL006 is not    CDL006
      ** installed.                                                       CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FL'                                      CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C                     MOVE *ON       *IN61                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Process Fiduciary Deals                                          CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'FL'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DP'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LP'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'FT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LT'                                      CDL006
      *                                                                   CDL006
      ** Detail line print                                                CDL006
      *                                                                   CDL006
     C                     MOVE *ON       *IN47                           CDL006
      *                                                                   CDL006
      ** Check on the changes in event dates and branch codes             CDL006
      ** Do the necessary actions                                         CDL006
      *                                                                   CDL006
     C           FIDMDT    IFNE EDAT                                      CDL006
     C                     Z-ADDEDAT      FIDMDT                          CDL006
     C                     MOVE *ON       *IN44                           CDL006
     C           *IN60     IFEQ *OFF                                      CDL006
     C                     MOVE *ON       *IN60                           CDL006
     C                     MOVE *ON       *IN64                           CDL006
     C                     OPEN DL0710P3                                  CDL006
      *                                                                   CDL006
      ** Transfer binary data into numeric files                          CDL006
      *                                                                   CDL006
     C                     Z-ADDSFNUM3    ZSNUM3  60                      CDL006
     C                     CALL 'ZSFILE'                                  CDL006
     C                     PARM           SEQ                             CDL006
     C                     PARM BRCA      @PARM   3                       CDL006
     C                     PARM           SFILE3                          CDL006
     C                     PARM           ZSNUM                           CDL006
     C                     PARM *BLANK    ZSERR   1                       CDL006
      *                                                                   CDL006
     C           ZSERR     IFEQ 'Y'                                       CDL006
     C                     SETON                     U7U8LR               CDL006
     C                     RETRN                                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Overflow detected ? condition output heading & date              CDL006
      *                                                                   CDL006
     C           OFLLN3    SUB  PRTLN3    @REML3  30                      CDL006
     C           @REML3    IFLE 4                                         CDL006
     C                     MOVE *ON       *IN44                           CDL006
     C                     MOVE *ON       *IN64                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** If CDL006 is OFF, Do standard MM deals.                          CDL006
      *                                                                   CDL006
     C                     ELSE                                           CDL006
0338 C                     MOVE '1'       *IN43                           S01354
0338 C*                                                                   S01354
0344 C****   TO CHECK IF THERE'S A CHANGE IN EVENT DATE.            ***** S01354
0338 C*                                                                   S01354
0345 C           LSTDAT    IFNE EDAT                                      S01354
     C                     MOVE EDAT      LSTDAT  50                      S01354
0338 C                     MOVE '1'       *IN42                           S01354
0338 C*                                                                   S01354
      ** RECORD P1 SPOOL FILE ON RCF FILES                                S01354
0338 C*                                                                   S01354
     C           *IN58     IFEQ '0'                                       S01354
     C                     MOVE '1'       *IN58                           S01354
     C                     MOVE '1'       *IN23                           S01354
     C                     OPEN DL0710P1                                  S01354
     C*                                                                   S01354
      ** TRANSFER BINARY DATA INTO NUMERIC FIELD                          S01354
     C                     Z-ADDSFNUM     ZSNUM   60                      S01354
     C                     CALL 'ZSFILE'                                  S01354
     C                     PARM           SEQ                             S01354
     C                     PARM *BLANKS   @PARM   3                       S01354
     C                     PARM           SFILE                           S01354
     C                     PARM           ZSNUM                           S01354
     C                     PARM *BLANK    ZSERR   1                       S01354
     C*                                                                   S01354
     C           ZSERR     IFEQ 'Y'                                       S01354
     C                     SETON                     U7U8LR               S01354
     C                     RETRN                                          S01354
     C                     END                                            S01354
     C                     END                                            S01354
     C                     END                                            S01354
0347 C*                                                                   S01354
0348 C*****  OVERFLOW DETECTED ? CONDITION OUTPUT HEADINGS & DATE   ***** S01354
0338 C*                                                                   S01354
0349 C           OFLLN     SUB  PRTLN     @REML   30                      S01354
0349 C           @REML     IFLE 4                                         S01354
0349 C                     MOVE '1'       *IN23                           S01354
0349 C                     MOVE '1'       *IN42                           S01354
0349 C                     END                                            S01354
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
0338 C*                                                                   S01354
     C                     END                                            S01354
0276 C***********                                                         S01354
     C*****SETON*L1 IF DATE HAS CHANGED                                   S01354
     C***********                                                         S01354
     C***********LSTDAT    COMP EDAT                 4545                 S01354
     C***45******          SETON                     L1                   S01354
     C***********          MOVE EDAT      LSTDAT  50                      S01354
     C***********                                                         S01354
0277 C***********          SETON                     27                   S01354
0278 C***21******          SETON                     23                   S01354
0279 C***********          SETOF                     21                   S01354
0280 C*
0280 C*****DETERMINE*IF*TAXABLE*INDICATOR*IS*'Y'********                  S01119
0280 C*    DETERMINE IF TAXABLE INDICATOR IS 'Y' FOR NON FRA/IRS TYPES    S01119
     C                     SETOF                         45
     C           *IN11     IFEQ '0'                                       S01119
     C   19      TAXI      COMP 'Y'                      45
      *                                                                                       CDL013
      ** Set Deal Taxable Indicator *IN45                                                     CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
     C           *IN19     ANDEQ*ON                                                           CDL013
     C           TAXI      ANDNE'0'                                                           CDL013
     C                     MOVE *ON       *IN45                                               CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0710CCP5                                           S01408
     C*                                                                   S01408
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0710C014
0280 C*
0281 C*    INCREMENT COUNT OF LINES WRITTEN
0282 C           NRIT      ADD  1         NRIT    50
0283 C*
0284 C*    ADD EVENT AMOUNT TO OUTPUT HASH TOTALS.
0285 C                     Z-ADD2         S
0286 C                     EXSR HASH
0287 C*
0288 C*    SET INDICATOR FOR NO. OF D.P. FOR CURRENCY.
0289 C                     MOVE ECCY      XCCY
0290 C                     EXSR CCYDEP
0291 C           XDECP     COMP 1                      3031
0292 C           XDECP     COMP 2                    33  32
     C*                                                                   S01119
     C*    FOR CROSS CCY '23O1' WORK OUT OTHER CCY D.P.                   S01119
     C*                                                                   S01119
     C           *IN09     IFEQ '1'                                       S01119
     C                     MOVE OTHC      XCCY                            S01119
     C                     EXSR CCYDEP                                    S01119
     C           XDECP     COMP 1                      5152               S01119
     C           XDECP     COMP 2                    54  53               S01119
     C                     END                                            S01119
0293 C*
0294 C*    FOR EVENTS '17M3' CALCULATE INTEREST
     C*                                                                   S01119
     C           *IN11     IFEQ '0'                                       S01119
     C**                                                                  048329
     C**   RECALCULATE INTEREST AMOUNT FOR LOANS/DEPOSITS -               087554
     C**   RE-CALCULATE OTHA AS INTEREST AMOUNT FOR DEALS IF DEAL IS      048329
     C*    NOT FORWARD DATED                                              048329
     C           VDAT      IFLE BJRDNB                                    048329
     C           *IN05     ANDEQ'1'                                       087554
     C*    STARTS AT VALUE DATE OR INTEREST ACCRUAL CONTROL DATE          048329
     C           IACD      IFGT VDAT                                      048329
     C                     Z-ADDIACD      ZIBEG                           048329
     C*                                                                   048329
     C*  FOR CALL DEALS,PERIOD OF INTEREST CALCULATION TO USE RUN DATE    048329
     C*  PLUS NOTICE DATE                                                 048329
     C*                                                                   048329
     C           DTYP      IFEQ 'CD'                                      048329
     C           DTYP      OREQ 'CL'                                      048329
     C           DTYP      OREQ 'DL'                                      048329
      *                                                                   CDL006
      ** Include Fiduciary deals if CDL006 is ON                          CDL006
      *                                                                   CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DP'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LP'                                      CDL006
      *                                                                   CDL006
     C*  Check if NOTD is -999 (ie. MDAT already entered)                 098012
     C           NOTD      IFEQ -999                                      098012
     C                     Z-ADDMDAT      ZIEND                           098012
     C                     ELSE                                           098012
     C           BJRDNB    ADD  NOTD      ZIEND                           048329
     C                     ADD  1         ZIEND                           101985
     C                     ENDIF                                          098012
     C                     ELSE                                           048329
     C                     Z-ADDMDAT      ZIEND                           048329
     C                     ENDIF                                          048329
     C*                                                                   048329
     C                     ELSE                            IACD<=VDAT     048329
     C                     Z-ADDVDAT      ZIBEG                           048329
     C*                                                                   048329
     C*  FOR CALL DEALS,PERIOD OF INTEREST CALCULATION TO USE             048329
     C*  RUNDATE PLUS NOTICE DATE PLUS 1 EXTRA DAY                        048329
     C*                                                                   048329
     C           DTYP      IFEQ 'CD'                                      048329
     C           DTYP      OREQ 'CL'                                      048329
     C           DTYP      OREQ 'DL'                                      048329
      *                                                                   CDL006
      ** Include Fiduciary deals if CDL006 is ON                          CDL006
      *                                                                   CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DP'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LP'                                      CDL006
      *                                                                   CDL006
     C*  Check if NOTD is -999 (ie. MDAT already entered)                 098012
     C           NOTD      IFEQ -999                                      098012
     C                     Z-ADDMDAT      ZIEND                           098012
     C                     ELSE                                           098012
     C           BJRDNB    ADD  NOTD      ZIEND                           048329
     C                     ADD  1         ZIEND                           048329
     C                     ENDIF                                          098012
     C                     ELSE                                           048329
     C                     Z-ADDMDAT      ZIEND                           048329
     C                     ENDIF                                          048329
     C*                                                                   048329
     C                     ENDIF                                          048329
     C**  CALCULATION BASIS; INTEREST RATE AND PRINCIPAL                  048329
     C                     Z-ADDICBS      ZICALC                          048329
     C                     Z-ADDEXRT      ZIRATE                          048329
     C                     Z-ADDPCPL      ZIAMT                           048329
     C**                                                                  048329
     C/COPY WNCPYSRC,DL0710C002
     C                     EXSR GLINTC                                    048329
     C/COPY WNCPYSRC,DL0710C003
     C** ADD ACCRUED AMOUNT IF ACCRUAL CONTROL DATE IS USED               048329
     C           ZINTR     ADD  AITC      OTHA      H                     048329
     C           OTHA      ADD  AIAP      OTHA                                                196633
     C           OTHA      ADD  AIAN      OTHA                                                196633
     C           OTHA      SUB  IPRD      OTHA                                                196633
     C           OTHA      SUB  ICTD      OTHA                                                196633
     C***FOR*CALL*DEALS,*NO*NEED*TO*ADD*AITC*(ACC*INT*TO*CTL*DATE)                     101985 196633
     C********** DTYP      IFEQ 'CD'                                                   101985 196633
     C********** DTYP      OREQ 'CL'                                                   101985 196633
     C********** DTYP      OREQ 'DL'                                                   101985 196633
      *                                                                   CDL006
      ** Include Fiduciary deals if CDL006 is ON                          CDL006
      *                                                                   CDL006
     C********** CDL006    OREQ 'Y'                                                    CDL006 196633
     C           CDL006    IFEQ 'Y'                                                           196633
     C           DTYP      ANDEQ'DT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DP'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LP'                                      CDL006
      *                                                                   CDL006
     C                     Z-ADDZINTR     OTHA                            101985
     C                     END                                            101985
     C                     END                                            048329
     C*                                                                   S01119
0295 C           ETYP      COMP '17M3'                   28
0296 C   28      OTHA      SUB  EAMT      OTHA
0297 C*
0297 C*    CALCULATE INTEREST
     C***19*45***OTHA******MULT TAXR      TAMT   130H                     S01194
     C***19*45***OTHA******MULT BNHKTR    TAMT   130H              S01194 S01383
     C***19*45***TAMT******DIV  100       TAMT      H                     S01383
     C*                                                                   S01383
     C* IF DEAL IS TAXABLE                                                S01383
     C*                                                                   S01383
     C           *IN45     IFEQ '1'                        B001           S01383
     C/COPY WNCPYSRC,DL0710C008
     C*                                                                   S01383
     C** IF BRT SAR INSTALLED                                             S01383
     C*                                                                   S01383
     C           S01383    IFEQ 'Y'                        B002           S01383
     C*                                                                   S01383
     C           DTYP      IFEQ 'CD'                       B003           S01383
     C           MDAT      ANDEQ0                                         S01383
      *                                                                   CDL006
      ** Include fiduciary deal types if CDL006 is ON                     CDL006
      *                                                                   CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DT'                                      CDL006
     C           MDAT      ANDEQ0                                         CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LT'                                      CDL006
     C           MDAT      ANDEQ0                                         CDL006
     C*                                                                   S01383
     C           VDAT      IFGE BJRDNB                     B004           S01383
     C           NOTD      IFEQ 0                          B005           S01383
     C*                                                                   S01383
     C           VDAT      ADD  1         MDAT                            S01383
     C                     ELSE                                           S01383
     C           NOTD      ADD  VDAT      MDAT                            S01383
     C                     END                             E005           S01383
     C                     END                             E004           S01383
     C*                                                                   S01383
     C           VDAT      IFLT BJRDNB                     B004           S01383
     C           NOTD      IFEQ 0                          B005           S01383
     C*                                                                   S01383
     C           BJRDNB    ADD  1         MDAT                            S01383
     C                     ELSE                                           S01383
     C           NOTD      ADD  BJRDNB    MDAT                            S01383
     C                     END                             E005           S01383
     C                     END                             E004           S01383
     C*                                                                   S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C           EDAT      IFGE DEFF                       B003           S01383
     C           MDAT      ORGE DEFF                                      S01383
     C                     Z-ADDBRTR      BNHKTR                          S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C           EDAT      IFLT DEFF                       B003           S01383
     C           MDAT      ORLT DEFF                                      S01383
     C                     Z-ADDPBRTR     BNHKTR                          S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0710CCP2                                           S01408
     C*                                                                   S01408
     C**********           MOVE CNUM      CLNKEY  60                                   S01383 CSD027
     C                     MOVE CNUM      CLNKEY  6                                           CSD027
     C           CLNKEY    CHAINSDCBRTL1             40                   S01383
     C           *IN40     IFEQ '1'                        B003           S01383
     C           XRECI     ORNE 'D'                                       S01383
0965 C                     SETON                     LRU7U8               S01383
     C                     MOVEL'SDCBRTPD'DBFILE           * * * * * * *  S01383
     C                     MOVEL'08'      DBASE            * DBERR 008 *  S01383
     C                     MOVELCNUM      DBKEY            * * * * * * *  S01383
     C                     EXSR *PSSR                                     S01383
     C                     END                             E003           S01383
     C/COPY WNCPYSRC,DL0710C015
     C*                                                                   S01383
     C           TAXIND    IFEQ 'L'                        B003           S01383
     C/COPY WNCPYSRC,DL0710C009
     C           OTHA      MULT BNHKTR    TAX01  155                      S01383
     C/COPY WNCPYSRC,DL0710C010
     C           TAX01     DIV  100       TAMT   130H                     S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C           TAXIND    IFEQ 'P'                        B003           S01383
     C           BNHKTR    MULT 0.5       TAXRH  155                      S01383
     C/COPY WNCPYSRC,DL0710C011
     C           OTHA      MULT TAXRH     TAX01  155                      S01383
     C/COPY WNCPYSRC,DL0710C012
     C           TAX01     DIV  100       TAMT   130H                     S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C** ELSE BRT SAR IS NOT INSTALLED                                    S01383
     C*                                                                   S01383
1844 C                     ELSE                            X002           S01383
      *                                                                                       CDL013
      ** If CDL013 installed, calculate WHT amount                                            CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
     C/COPY WNCPYSRC,DLH00057
      *                                                                                       CDL013
      ** Set WHT rate                                                                         CDL013
     C                     SELEC                                                              CDL013
     C           TAXI      WHEQ '0'                                                           CDL013
     C                     Z-ADD0         WRATE   52                                          CDL013
     C           TAXI      WHEQ '1'                                                           CDL013
     C                     Z-ADDETXR1     WRATE                                               CDL013
     C           TAXI      WHEQ '2'                                                           CDL013
     C                     Z-ADDETXR2     WRATE                                               CDL013
     C           TAXI      WHEQ '3'                                                           CDL013
     C                     Z-ADDETXR3     WRATE                                               CDL013
     C           TAXI      WHEQ '4'                                                           CDL013
     C                     Z-ADDETXR4     WRATE                                               CDL013
     C           TAXI      WHEQ '5'                                                           CDL013
     C                     Z-ADDETXR5     WRATE                                               CDL013
     C           TAXI      WHEQ '6'                                                           CDL013
     C                     Z-ADDETXR6     WRATE                                               CDL013
     C           TAXI      WHEQ '7'                                                           CDL013
     C                     Z-ADDETXR7     WRATE                                               CDL013
     C           TAXI      WHEQ '8'                                                           CDL013
     C                     Z-ADDETXR8     WRATE                                               CDL013
     C           TAXI      WHEQ '9'                                                           CDL013
     C                     Z-ADDETXR9     WRATE                                               CDL013
     C                     ENDSL                                                              CDL013
      *                                                                                       CDL013
      ** If WHT rate is 0, set Tax Amount to 0                                                CDL013
     C           WRATE     IFEQ 0                                                             CDL013
     C                     Z-ADD0         TAMT                                                CDL013
      *                                                                                       CDL013
      ** Otherwise, calculate WHT                                                             CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
      ** If Deal Ccy = Base Ccy, calculate WHT rounded down                                   CDL013
      ** and CDL081 is off                                                                    CDL081
      *                                                                                       CDL081
     C           CCY       IFEQ BJCYCD                                                        CDL013
     C           CDL081    ANDEQ'N'                                                           CDL081
      *                                                                                       CDL013
      ** Set work adjustment field according to decimal places.                               CDL013
     C           *IN30     IFEQ *ON                                                           CDL013
     C                     Z-ADD1         WADJ    40                                          CDL013
     C                     ENDIF                                                              CDL013
     C           *IN31     IFEQ *ON                                                           CDL013
     C                     Z-ADD10        WADJ                                                CDL013
     C                     ENDIF                                                              CDL013
     C           *IN32     IFEQ *ON                                                           CDL013
     C                     Z-ADD100       WADJ                                                CDL013
     C                     ENDIF                                                              CDL013
     C           *IN33     IFEQ *ON                                                           CDL013
     C                     Z-ADD1000      WADJ                                                CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
      ** Round down Interest Amount                                                           CDL013
     C           OTHA      DIV  WADJ      WTOTAL 150                                          CDL013
     C                     MULT WADJ      WTOTAL                                              CDL013
      *                                                                                       CDL013
      ** Calculate WHT                                                                        CDL013
     C                     MULT WRATE     WTOTAL                                              CDL013
     C                     DIV  100       WTOTAL                                              CDL013
      *                                                                                       CDL013
      ** Round down WHT                                                                       CDL013
     C                     DIV  WADJ      WTOTAL                                              CDL013
     C           WTOTAL    MULT WADJ      TAMT                                                CDL013
      *                                                                                       CDL013
      *                                                                                       CDL013
      ** If Deal Ccy NOT Base Ccy, calculate half-adjusted WHT                                CDL013
     C                     ELSE                                                               CDL013
     C           OTHA      MULT WRATE     TAMT   130H                                         CDL013
      *                                                                                       CDL081
      ** Check if tax amount is to be rounded down                                            CDL081
      *                                                                                       CDL081
     C           CCY       IFEQ BJCYCD                                                        CDL081
     C           CDL081    ANDEQ'Y'                                                           CDL081
     C           W#BSRD    ANDEQ'Y'                                                           CDL081
     C           CCY       ORNE BJCYCD                                                        CDL081
     C           CDL081    ANDEQ'Y'                                                           CDL081
     C           W#NBRD    ANDEQ'Y'                                                           CDL081
     C                     DIV  100       TAMT                                                CDL081
     C                     ELSE                                                               CDL081
     C                     DIV  100       TAMT      H                                         CDL013
     C                     ENDIF                                                              CDL081
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
      ** Define Net Interest = Interest Amount - Tax Amount                                   CDL013
     C           OTHA      SUB  TAMT      WNETI  130                                          CDL013
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
     C/COPY WNCPYSRC,DLH00058
      *                                                                                       CDL013
      ** If CDL013 NOT installed, proceed as usual                                            CDL013
     C                     ELSE                                                               CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0710CCP1                                           S01408
     C*                                                                   S01408
     C*                                                                   S01383
     C   19      OTHA      MULT BNHKTR    TAMT   130H                     S01383
     C   19      TAMT      DIV  100       TAMT      H                     S01383
     C*                                                                   S01383
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0710CCP3                                           S01408
     C*                                                                   S01408
     C                     END                             E002           S01383
     C/COPY WNCPYSRC,DLH00412
     C                     END                             E001           S01383
0297 C*
     C/COPY WNCPYSRC,DL0710C004
0298 C*    CHECK FOR CALL/NOTICE
0299 C*
0300 C***********EDAT******COMP RUND                   24                 S01194
0300 C           EDAT      COMP BJRDNB                 24                 S01194
0301 C   24      EDAT      COMP 0                        26
     C*                                                                   S01119
     C                     END                                            S01119
0384 C*                                                                   S01354
0385 C*    CONVERT MATURITY DATE TO DDMMMYY FORMAT FOR INTERNAL DEALS.    S01354
0386 C   41N24             Z-ADDEDAT      ZDAYNO                          S01354
0387 C   41N24             EXSR ZDATE2                                    S01354
0388 C   41N24             MOVE ZADATE    MDATE                           S01354
0302 C*
0303 C*    CONVERT MATURITY DATE TO DDMMMYY FORMAT.
0304 C***L1N24***          Z-ADDEDAT      ZDAYNO                          S01354
0305 C***L1N24***          EXSR ZDATE2                                    S01354
0306 C***L1N24***          MOVE ZADATE    MDATE   7                       S01354
0304 C   42N24             Z-ADDEDAT      ZDAYNO                          S01354
0305 C   42N24             EXSR ZDATE2                                    S01354
0306 C   42N24             MOVE ZADATE    MDATE   7                       S01354
     C/COPY WNCPYSRC,DL0710C016
      *                                                                   CDL006
      ** Convert maturity date for Fiduciary deals to DDMMMYY format      CDL006
      *                                                                   CDL006
     C           *IN44     IFEQ *ON                                       CDL006
     C           *IN24     ANDEQ*OFF                                      CDL006
     C                     Z-ADDEDAT      ZDAYNO                          CDL006
     C                     EXSR ZDATE2                                    CDL006
     C                     MOVE ZADATE    MDATE   7                       CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,DL0710C001
0307 C*
0308 C*    OBTAIN ROLLED OVER AMOUNT IF NECESSARY.
     C*                                                                   S01119
     C           *IN11     IFEQ '0'                                       S01119
     C*                                                                   S01119
0309 C           RLVI      COMP 'Y'                  04  25
0310 C   25      DLNO      CHAINDEALS                40
0311 C***25N05*************GOTO ERROR                                     S01117
     C   25N05             MOVEL'DEALS   'DBFILE           ************   S01117
     C   25N05             MOVEL'04'      DBASE            * DBERR 04 *   S01117
     C   25N05             MOVEL@OPTN     DBOPTN           ************   S01117
     C   25N05             MOVELDLNO      DBKEY                           S01117
     C   25N05             EXSR *PSSR                                     S01117
     C   25N05             GOTO END                                       S01117
0312 C   06                Z-ADDICIR      EXRT
0313 C   06      EAMT      SUB  ICAM      OTHA
0314 C   06                Z-ADDICAM      EAMT
0316 C*
0316 C*    CONDITION AMOUNT ROLLED OUTPUT
     C   02 25
     COR 19 45             SETON                     46
      *                                                                   CDL006
      ** If CDL006 and Fiduciary transactions, where amount is taxable    CDL006
      ** or amount rolled over, switch on ind. 48 instead of 46.          CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'FT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'DP'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'LP'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           DTYP      ANDEQ'FL'                                      CDL006
      *                                                                   CDL006
     C           *IN02     IFEQ *ON                                       CDL006
     C           *IN25     ANDEQ*ON                                       CDL006
     C           *IN19     OREQ *ON                                       CDL006
     C           *IN45     ANDEQ*ON                                       CDL006
      *                                                                   CDL006
     C                     MOVE *OFF      *IN46                           CDL006
     C                     MOVE *ON       *IN48                           CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CHECK IF FLOATING RATE HAS BEEN ENTERED FOR FRA/IRS EVENTS      S01119
     C*                                                                   S01119
     C           *IN11     IFEQ '1'                                       S01119
     C/COPY WNCPYSRC,DL0710C007
     C*                                                                   S01119
     C           UBRTT     IFNE 0                                         S01119
     C                     TESTB'0'       UDNSI          34               S01119
     C                     ELSE                                           S01119
     C                     SETON                         34               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           TBRTT     IFNE 0                                         S01119
     C                     TESTB'0'       TDNSI          35               S01119
     C                     ELSE                                           S01119
     C                     SETON                         35               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**   CHECK FOR OUR FED FUNDS INDICATOR                              S01119
     C*                                                                   S01119
     C                     TESTB'2'       UDSTI          16               S01119
     C*                                                                   S01119
     C**   CHECK FOR THEIR FED FUNDS INDICATOR                            S01119
     C*                                                                   S01119
     C                     TESTB'2'       TDSTI          17               S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C****IF*'RL'*EVENT*CHECK*IF*OURS*OR*THEIR*DETAILS*TO*BE*USED* S01119 S01157
     C** IF RR,RA OR RF EVENT CHECK IF OURS OR THEIR DETAILS TO BE USED   S01157
     C*                                                                   S01119
     C           UBRTT     COMP 0                    1212                 S01119
     C           TBRTT     COMP 0                    1515                 S01119
     C/COPY WNCPYSRC,DL0710C006
     C*                                                                   S01119
     C           *IN10     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C**  IF OUR DETAILS CHECK FOR FLOOR RATE                             S01119
     C*                                                                   S01119
     C           *IN12     IFEQ '1'                                       S01119
     C                     TESTB'4'       UDSTI          13               S01119
     C*                                                                   S01119
     C**  AND AVERAGE RATE METHOD                                         S01119
     C*                                                                   S01119
     C                     TESTB'3'       UDSTI          14               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF THEIR DETAILS CHECK FOR FLOOR RATE                           S01119
     C*                                                                   S01119
     C           *IN12     IFEQ '0'                                       S01119
     C                     TESTB'4'       TDSTI          13               S01119
     C*                                                                   S01119
     C**  AND AVERAGE RATE METHOD                                         S01119
     C*                                                                   S01119
     C                     TESTB'3'       TDSTI          14               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
0315 C***********          GOTO END                                       E95
0316 C*
0317 C***********TRAIL*****TAG                             ** TRAIL TAG **S01119
0318 C*****COMPARE*INPUT*AND*CALULATED*TOTALS.                            S01119
0319 C***********NREC******COMP NORE                 U8U8                 S01119
0320 C**NU8******INT,1*****COMP HRWN                 U8U8                 S01119
0321 C**NU8******DEC,1*****COMP HRDC                 U8U8                 S01119
0322 C***********NRIT******COMP 0                        22               S01119
0323 C*********************GOTO END
0324 C*********************                                               S01194
0325 C*****SET*ERROR*INDICATORS. **                                       S01194
0326 C***********ERROR*****TAG                             ** ERROR TAG **S01194
0327 C*********************SETON                     LRU7U8               S01194
0328 C*
0329 C           END       TAG                             ** END TAG **
     C**************************
     C***ENSURE*SPOOL*FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   E95
     C***TO.*SWRIT*IS*INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       E95
     C***FILE:-*IF*IT*IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    E95
     C***THE:FILE.*UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     E95
     C***AN*UNITIALISED BINARY FIELD.                                     E95
     C*LR******** SWRIT     IFNE 0                                        E95
     C*LR******** SWRIT     ANDNE@BKBIN                                   E95
     C*LR********           CALL 'ZSFILE'                                 E95
     C*LR********           PARM           SEQ     5                      E95
     C*LR********           PARM *BLANK    @PARM   3                      E95
     C*LR********           PARM           SFILE                          E95
     C*LR********           PARM           SFNUM                          E95
     C*LR********           END                                           E95
     C*                                                                   S01117
     CLR                   Z-ADDSFNUMU    ZSNUM                           S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANK    ZSERR                           E95
     C*                                                                   S01117
0322 CLR         NRIT      COMP 0                        22               S01153
0330 C*
0331 C*****CHECK*FOR*OVERFLOW***                                          S01354
0332 C*L0*OF******          SETON                     21                  S01354
0318 C*****COMPARE INPUT AND CALULATED TOTALS.                  S01119    S01153
     C*R*********          READ EVNTXZZ                  29     S01119    S01153
     C*RN29******          SETON                     03         S01119    S01153
0262 C*R*03******NREC      ADD  1         NREC    50            S01119    S01153
0319 C*R*********NREC      COMP NORE                 U8U8       S01119    S01153
0320 C*RNU8******INT,1     COMP HRWN                 U8U8       S01119    S01153
0321 C*RNU8******DEC,1     COMP HRDC                 U8U8       S01119    S01153
0322 C*R*********NRIT      COMP 0                        22     S01119    S01153
     C*                                                                   E296
     C** READ BANK DETAILS VIA ACCESS PROGRAM (WHEN EMPTY FILES)          E296
     CLRN20                CALL 'AOBANKR0'                                E296
     C                     PARM '*MSG   ' @RTCD   7                       E296
     C                     PARM '*FIRST ' @OPTN   7                       E296
     C           SDBANK    PARM SDBANK    DSFDY                           E296
     CLRN20      BJDFIN    COMP 'M'                      98MMDDYY,        E296
     CLRN20      @RTCD     IFNE *BLANK                                    E296
     CLRN20                MOVEL'SDBANKPD'DBFILE           ************   E296
     CLRN20                MOVEL'05'      DBASE            * DBERR 05 *   E296
     CLRN20                MOVEL@OPTN     DBOPTN           ************   E296
     CLRN20                MOVEL@OPTN     DBKEY                           E296
     CLRN20                EXSR *PSSR                                     E296
     CLR                   END                                            E296
     C*                                                                   E296
0333 C********************************************************************
0334 C**
0335 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
0336 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
0337 C**
0338 C           CCYARR    BEGSR                           *** CCYARR  ***
0339 C**
0340 C**   SET ARRAY INDEX TO ZERO.
0341 C                     Z-ADD0         X       30
0342 C**
0343 C*****SET*UP*KEY*FOR*CURRENCY TABLE.                                 S01194
0344 C*********************MOVEL'20      'XCYKEY 12                       S01194
0345 C*********************MOVE '    '    XCYKEY                          S01194
0346 C*********************                                               S01194
0347 C*****SET*LOWER*LIMIT*AND READ CURRENCY TABLE HEADER.                S01194
0348 C***********XCYKEY****SETLLTABLED                                    S01194
0347 C**   SET LOWER LIMIT AND READ CURRENCY FILE                         S01194
0421 C           *LOVAL    SETLL@A6REA3                                   S01194
0349 C**
0350 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0351 C           XLOOP     TAG                             ** XLOOP TAG **
0352 C*********************READ TABLED                   99               S01194
     C                     READ @A6REA3                  99               S01194
0353 C**N99******RECTX*****COMP 20                   9999                 S01194
0354 C**
0355 C**   END IF ALL CURRENCY RECORDS PROCESSED
0356 C   99                GOTO XEND
0357 C**
0358 C*****IGNORE*DELETED*RECORDS AND NON-SUB-RECORD ONE.                 S01194
0359 C***********RECIX*****COMP 'D'                  9797                 S01194
0360 C***97****************GOTO XLOOP                                     S01194
0361 C***********SRECX*****COMP 1                    9797                 S01194
0362 C***97****************GOTO XLOOP                                     S01194
0363 C**
0364 C**   INCREMENT ARRAY INDEX.
0365 C           X         ADD  1         X
0366 C**
0367 C**   MOVE DATA INTO ARRAYS.
0368 C*********************MOVE CCYX      CCYA,X                          S01194
0369 C*********************MOVE CDPX      DPA,X                           S01194
0368 C                     MOVE A6CYCD    CCYA,X                          S01194
0369 C                     MOVE A6NBDP    DPA,X                           S01194
0370 C**
0371 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0372 C           X         COMP 150                      96
0373 C**
0374 C**   GO TO READ NEXT RECORD.
0375 C  N96                GOTO XLOOP
0376 C**
0377 C           XEND      TAG                             ** XEND TAG  **
0378 C                     ENDSR
0379 C**
0380 C********************************************************************
0381 C**
0382 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
0383 C**
0384 C           CCYDEP    BEGSR                           *** CCYDEP  ***
0385 C**
0386 C**   SET ARRAY INDEX TO ONE AND RESET ERROR INDICATOR.
0387 C                     Z-ADD1         X            99
0388 C**
0389 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0390 C                     Z-ADD0         XDECP   10
0391 C                     MOVE XCCY      XCCY    3
0392 C**
0393 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0394 C**   99 SETON FOR INVALID CURRENCY.
0395 C           XCCY      LOKUPCCYA,X                   95
0396 C   95                MOVE DPA,X     XDECP
0397 C  N95                SETON                     99
0398 C**
0399 C                     ENDSR
0400 C**
0401 C********************************************************************
0402 C*    SR. TO ADD ZZAMT TO HASH TOTALS IN ARRAYS INT & DEC.
0403 C           HASH      BEGSR                           *** HASH ***
0404 C*
0405 C           ZZAMT     COMP 0                      50
0406 C   50                Z-SUBZZAMT     ZZAMT
0407 C                     Z-ADDINT,S     ZZTOTI
0408 C                     Z-ADDDEC,S     ZZTOTD
0409 C                     EXSR GLZADD
0410 C                     Z-ADDZZTOTI    INT,S
0411 C                     Z-ADDZZTOTD    DEC,S
0412 C*
0413 C                     ENDSR
0414 C*
0415 C********************************************************************
0416 C**
0417 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0418 C**
0419 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0420 C**
0421 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0422 C**
0423 C**   CLEAR DATE FIELDS.
0424 C                     Z-ADD0         ZDATE   60
0425 C                     MOVEL'       ' ZADATE  7
0426 C**
0427 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0428 C                     Z-ADDZDAYNO    ZDAYNO  50
0429 C**
0430 C**   DETERMINE YEAR NUMBER.
0431 C**
0432 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0433 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0434 C   99                GOTO ZDEND2
0435 C**
0436 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0437 C           ZDAYN1    DIV  1461      ZLYR    20
0438 C                     MVR            ZDAYN1           SAVE REMAINING
0439 C**                                                   DAYS
0440 C**   CALCULATE NUMBER OF REMAINING YEARS.
0441 C                     Z-ADD1         ZWRK2   20
0442 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0443 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0444 C  N90      ZWRK2     ADD  1         ZWRK2
0445 C  N90                GOTO ZDTAG1
0446 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0447 C**
0448 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0449 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0450 C**
0451 C**   CALCULATE ACTUAL YEAR NUMBER.
0452 C           ZLYR      MULT 4         ZWRK3   30
0453 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0454 C                     Z-ADDZWRK3     ZYEAR   20
0455 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0456 C**
0457 C**   DETERMINE MONTH NUMBER.
0458 C**
0459 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0460 C                     SETOF                     9293
0461 C   91      ZDAYN1    COMP 59                     9293
0462 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0463 C**
0464 C**   CALCULATE MONTH NUMBER.
0465 C                     Z-ADD2         ZWRK2
0466 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0467 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0468 C  N94      ZWRK2     ADD  1         ZWRK2
0469 C  N94                GOTO ZDTAG2
0470 C           ZWRK2     SUB  1         ZWRK2
0471 C**
0472 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0473 C**
0474 C**   DETERMINE DAY OF MONTH.
0475 C**
0476 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0477 C           ZDAYN1    ADD  1         ZDAYN1
0478 C**
0479 C**   CALCULATE DAY OF MONTH.
0480 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0481 C**
0482 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0483 C   93      ZDAY      ADD  1         ZDAY
0484 C**
0485 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0486 C  N98                MOVELZDAY      ZWRK4   40
0487 C   98                MOVE ZDAY      ZWRK4
0488 C  N98                MOVE ZMTH      ZWRK4
0489 C   98                MOVELZMTH      ZWRK4
0490 C                     MOVELZWRK4     ZDATE
0491 C                     MOVE ZYEAR     ZDATE
0492 C**
0493 C**   FORMAT ALPHA DATE, DDMMMYY.
0494 C           ZDAY      COMP 10                     95
0495 C                     MOVELZDAY      ZWRK5   5
0496 C   95                MOVEL' '       ZWRK5
0497 C                     MOVE ZMNM,ZMTH ZWRK5
0498 C                     MOVELZWRK5     ZADATE
0499 C                     MOVE ZYEAR     ZADATE
0500 C**
0501 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0502 C**
0503 C********************************************************************
0504 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0505 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0506 C*
0507 CSR         GLZADD    BEGSR                           *** GLZADD ****
0508 C*
0509 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0510 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0511 C*
0512 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0513 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0514 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0515 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0516 C*
0517 CSR                   EXSR GLZSUM
0518 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0519 C*
0520 C********************************************************************
0521 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0522 C*                        GLZADD, GLZSUB, GLZCMP.
0523 C*          PARAMETERS PASSED -
0524 C*                     I/P ZZAMTI ZZAMTD
0525 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0526 C*
0527 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0528 C*
0529 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0530 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0531 CSR                   SETOF                     919293
0532 CSR                   SETOF                     949599
0533 C*
0534 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0535 CSR         ZZAMTI    COMP 0                      9293
0536 CSR 93      ZZAMTD    COMP 0                      9293
0537 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0538 C*
0539 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0540 CSR         ZZTOTI    COMP 0                      9193
0541 CSR 93      ZZTOTD    COMP 0                      9193
0542 C*
0543 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0544 CSR 93                Z-ADDZZAMTI    ZZTOTI
0545 CSR 93                Z-ADDZZAMTD    ZZTOTD
0546 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0547 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0548 CSR 91N92
0549 CORN91 92             GOTO ZZOFPS
0550 C*
0551 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0552 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0553 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0554 C*
0555 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0556 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0557 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0558 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0559 C*
0560 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0561 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0562 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0563 CSRN99                Z-ADDZZWK2     ZZTOTD
0564 CSRN99                Z-ADDZZWK3     ZZTOTI
0565 C*
0566 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0567 CSR 99                Z-ADD0         ZZAMT  153
0568 CSR                   GOTO ZZSEND
0569 C*
0570 C* THE 'SIGNS' ARE DIFFERENT
0571 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0572 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0573 C*
0574 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0575 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0576 C*
0577 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0578 C*
0579 CSR 91                Z-SUBZZTOTI    ZZTOTI
0580 CSR 91                Z-SUBZZTOTD    ZZTOTD
0581 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0582 C*
0583 CSR         ZZTOTI    COMP ZZAMTI               93  95
0584 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0585 C*
0586 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0587 CSR 95                Z-ADD0         ZZTOTI
0588 CSR 95                Z-ADD0         ZZTOTD
0589 CSR 95                GOTO ZZSEND
0590 C*
0591 C* IF ZZTOT GT. ZZAMT.
0592 CSR 93      ZZAMTD    COMP ZZTOTD               94
0593 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0594 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0595 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0596 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0597 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0598 C*
0599 C*
0600 C* IF ZZAMT GT. ZZTOT.
0601 CSRN93      ZZTOTD    COMP ZZAMTD               94
0602 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0603 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0604 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0605 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0606 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0607 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0608 C*
0609 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0610 CSR                   SETOF                     94
0611 CSR 93 91
0612 CORN93 92             SETON                     94
0613 CSR 94                Z-SUBZZTOTI    ZZTOTI
0614 CSR 94                Z-SUBZZTOTD    ZZTOTD
0615 C**
0616 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0617 CSR 92                Z-SUBZZAMTI    ZZAMTI
0618 CSR 92                Z-SUBZZAMTD    ZZAMTD
0619 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0620 C**
0621 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0622 CSR                   SETOF                     96
0623 CSR         ZZTOTD    COMP 0                        91
0624 CSR 91      ZZTOTI    COMP 0                      96
0625 CSR 96                MOVE '.000-'   ZZNEGD  5
0626 CSR                   ENDSR                             ** ENDSR **
0627 C********************************************************************
0628 C*********************                                               S01194
0629 C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0630 C*********************                                               S01194
0631 C***********ZSYSTM****BEGSR                           *** ZSYSTM *** S01194
0632 C*********************                                               S01194
0633 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0634 C*********************MOVEL'01      'ZTABKY 12                       S01194
0635 C*********************MOVE '  10'    ZTABKY                          S01194
0636 C*********************                                               S01194
0637 C***********ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
0638 C**N99******RECI******COMP 'D'                  9999  ON, IS DELETED S01194
0639 C*********************                                               S01194
0640 C*****CHECK*SYSTEM*DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0641 C***********DATF******COMP 'M'                      98MMDDYY, 98 ON  S01194
0642 C*********************                                               S01194
0643 C*********************ENDSR                                          S01194
0644 C*********************                                               S01194
0645 C*********************                                               S01194
0646 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
1279 C********************************************************************048329
1280 C***********                                                  048329 066550
1281 C*****GLINTC SR. TO CALCULATE INTEREST BETWEEN ANY TWO DAY NUM048329 066550
1282 C***********                                                  048329 066550
1283 C*****THIS*VERSION REPLACES THE ORIGINAL GLINTC SR. NOW NAMED 048329 066550
1284 C*****GLINTO.                                                 048329 066550
1285 C***********                                                  048329 066550
1286 C*****CALCULATION METHODS ARE -                               048329 066550
1287 C*****1**ACTUAL/365                                           048329 066550
1288 C*****2**ACTUAL/360                                           048329 066550
1289 C*****3**360/360 (SOMETIMES CALLED 30/360)                    048329 066550
1290 C*****4**365/365 (EXCLUDING 29/02)                            048329 066550
1291 C*****5**365/360 (EXCLUDING 29/02)                            048329 066550
1292 C*****6**ACTUAL/366                                           048329 066550
1293 C***********                                                  048329 066550
1294 C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.              048329 066550
1295 C***********                                                  048329 066550
1296 C***********                                                  048329 066550
1297 C*R*********GLINTC    BEGSR                           ** GLINT048329 066550
1298 C***********                                                  048329 066550
1299 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                    048329 066550
1300 C*R*********          Z-ADDZIBEG     ZIBEG   50       STARTING048329 066550
1301 C*R*********          Z-ADDZIEND     ZIEND   50       FINISHIN048329 066550
1302 C*R*********          Z-ADDZICALC    ZICALC  10       CALC. BA048329 066550
1303 C*R*********          Z-ADDZIAMT     ZIAMT  150       PRINCIPA048329 066550
1304 C*R*********          Z-ADDZIRATE    ZIRATE 117       RATE OF 048329 066550
1305 C***********                                                  048329 066550
1306 C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED    048329 066550
1307 C*R*********ZIEND     SUB  ZIBEG     ZDAYN1  50               048329 066550
1308 C***********                                                  048329 066550
1309 C****CHECK*FOR INTEREST CALCULATION BASIS                     048329 066550
1310 C*****USE*OF INDICATRS                                        048329 066550
1311 C*****1,92**2,90  3,91  4,97  5,96  6,95                      048329 066550
1312 C***********          SETOF                     959697        048329 066550
1313 C*R*********ZICALC    COMP 2                    919290        048329 066550
1314 C**N91******          GOTO ZICAL                              048329 066550
1315 C***********ZICALC    COMP 5                    959796        048329 066550
1316 C***97******ZICALC    COMP 3                    97  91        048329 066550
1317 C***95******                                                  048329 066550
1318 C*R*96******          SETOF                     91            048329 066550
1319 C**N91******          GOTO ZILPCK                             048329 066550
1320 C***********                                                  048329 066550
1321 C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WH 048329 066550
1322 C*****USING*THE 30/360 BASIS - METHOD 3.                      048329 066550
1323 C***********          EXSR ZSAVE                              048329 066550
1324 C***********          Z-ADDZIBEG     ZDAYNO                   048329 066550
1325 C***********          EXSR ZDATE2                             048329 066550
1326 C***********          MOVE ZDAY      ZISD    20               048329 066550
1327 C***********          MOVE ZMTH      ZISM    20               048329 066550
1328 C***********          MOVE ZYEAR     ZISY    20               048329 066550
1329 C***********          Z-ADDZIEND     ZDAYNO                   048329 066550
1330 C***********          EXSR ZDATE2                             048329 066550
1331 C***********          MOVE ZDAY      ZIFD    20               048329 066550
1332 C***********          MOVE ZMTH      ZIFM    20               048329 066550
1333 C***********          MOVE ZYEAR     ZIFY    20               048329 066550
1334 C***********          EXSR ZRSTOR                             048329 066550
1335 C***********          SETOF                     93            048329 066550
0    C****IN*ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START Y 048329 066550
     C****ZIEND*IS GREATER THAN ZIBEG,THEN THE DATE ZIEND MUST BE  048329 066550
     C****DIFFERENT CENTURY TO ZIBEG.IF SO ADD 100 YEARS TO IT.    048329 066550
     C***********ZIEND     COMP ZIBEG                93             048329066550
     C***93******ZIFY      COMP ZISY                   93          048329 066550
     C***********          Z-ADDZISY      ZISY2   30               048329 066550
     C**N93******          Z-ADDZIFY      ZIFY2   30               048329 066550
     C***93******ZIFY      ADD  100       ZIFY2                    048329 066550
     C***********                                                  048329 066550
2209 C***********30        SUB  ZISD      ZID1    50   93          048329 066550
2210 C***93******          Z-ADD0         ZID1                     048329 066550
2211 C***********ZISM      COMP 12                       93        048329 066550
2212 C***93******          Z-ADD0         ZISM                     048329 066550
2213 C***93******ZISY      ADD  1         ZISY                     048329 066550
     C***93******ZISY2     ADD  1         ZISY2                    048329 066550
     C***********                                                  048329 066550
2214 C***********ZIFD      COMP 31                       93        048329 066550
1342 C***93******ZID1      ADD  30        ZID1                     048329 066550
1343 C**N93******ZID1      ADD  ZIFD      ZID1                     048329 066550
1344 C***********ZIFM      SUB  1         ZIFM                     048329 066550
     C***********ZISY      COMP ZIFY                     93        048329 066550
1346 C***93******ZIFM      SUB  ZISM      ZINOM   30               048329 066550
1347 C***93******          GOTO ZIOUT                              048329 066550
1348 C***********12        SUB  ZISM      ZIM1    20               048329 066550
1349 C***********          Z-ADD1         ZISM                     048329 066550
     C*****USE*ENLARGED FIELDS THAT CAN HANDLE 1999 ONWARDS        048329 066550
     C***********ZISY2     ADD  1         ZISY2                    048329 066550
     C***********ZIFY2     SUB  ZISY2     ZIY1    20               048329 066550
1352 C***********ZIY1      MULT 12        ZIM2    30               048329 066550
1353 C***********ZIM2      ADD  ZIFM      ZIM2                     048329 066550
1354 C***********ZIM1      ADD  ZIM2      ZINOM                    048329 066550
1355 C***********ZIOUT     TAG                             * ZIOUT 048329 066550
1356 C***********ZINOM     MULT 30        ZID2    50               048329 066550
1357 C***********ZID2      ADD  ZID1      ZDAYN1                   048329 066550
1358 C***********          SETOF                     93            048329 066550
1359 C***********ZILPCK    TAG                             * ZILPC 048329 066550
1360 C**N96N97***          GOTO ZICAL                              048329 066550
1361 C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.  048329 066550
1362 C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 2 048329 066550
1363 C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, .048329 066550
1364 C***********                                                  048329 066550
1365 C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                 048329 066550
1366 C***********ZDAYN1    DIV  1461      ZIMAN   20               048329 066550
1367 C***********          MVR            ZIREM   50               048329 066550
1368 C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.             048329 066550
1369 C***********ZIBEG     SUB  60        ZIBW1   50               048329 066550
1370 C***********ZIBW1     DIV  1461      ZIDW1   20               048329 066550
1371 C***********          MVR            ZIDREM  50               048329 066550
1372 C***********ZIDREM    COMP 0                        94        048329 066550
1373 C***94******          Z-ADDZIBEG     ZIDW2   50               048329 066550
1374 C***94******          GOTO ZILP1                              048329 066550
1375 C*****ROUND*UP RESULT                                         048329 066550
1376 C***********ZIDW1     ADD  1         ZIDW2                    048329 066550
1377 C*****CALCULATE NEXT 29 FEB.                                  048329 066550
1378 C***********ZIDW2     MULT 1461      ZIDW2                    048329 066550
1379 C***********ZIDW2     ADD  60        ZIDW2                    048329 066550
1380 C***********ZILP1     TAG                             * ZILP1 048329 066550
1381 C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO 048329 066550
1382 C*****ZIREM*THEN ADD 1 TO ZIMAN.                              048329 066550
1383 C***********ZIDW2     SUB  ZIBEG     ZILPCP  50               048329 066550
1384 C***********ZIREM     COMP ZILPCP               94  94        048329 066550
1385 C***94******ZIMAN     ADD  1         ZIMAN                    048329 066550
1386 C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1      048329 066550
1387 C*****REQUIRED FOR THIS INTEREST CALCULATION.                 048329 066550
1388 C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                   048329 066550
1389 C***********          SETOF                     94            048329 066550
1390 C***********ZICAL     TAG                             * ZICAL 048329 066550
1391 C***********                                                  048329 066550
1392 C****CALCULATE INTEREST                                       048329 066550
1393 C***90******                                                  048329 066550
1394 C*R*91******                                                  048329 066550
1395 C*R*96******ZIAMT     DIV  36000     ZIWRK1 155H              048329 066550
1396 C***92******                                                  048329 066550
1397 C*R*97******ZIAMT     DIV  36500     ZIWRK1    H              048329 066550
1398 C***95******ZIAMT     DIV  36600     ZIWRK1    H              048329 066550
1399 C*R*********ZIWRK1    MULT ZIRATE    ZIWRK2 155H               048329066550
1400 C*R*********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF  048329066550
1401 C***********                                                   048329066550
1402 C***********          SETOF                     909192         048329066550
1403 C***********          SETOF                     959697         048329066550
1404 C*R*********          ENDSR                                    048329066550
1405 C***********                                                   048329066550
1407 C**************************************************************048329066550
1408 C**                                                                  048329
1409 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS   048329
1410 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.         048329
1411 C**                                                                  048329
1412 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS                        048329
1413 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.                       048329
1414 C**                                                                  048329
1415 C           ZSAVE     BEGSR                           *** ZSAVE ***  048329
1416 C**                                                                  048329
1417 C                     BITOF'01234567'ZBITS   1                       048329
1418 C   90                BITON'0'       ZBITS                           048329
1419 C   91                BITON'1'       ZBITS                           048329
1420 C   92                BITON'2'       ZBITS                           048329
1421 C   93                BITON'3'       ZBITS                           048329
1422 C   94                BITON'4'       ZBITS                           048329
1423 C   95                BITON'5'       ZBITS                           048329
1424 C   96                BITON'6'       ZBITS                           048329
1425 C   97                BITON'7'       ZBITS                           048329
1426 C**                                                                  048329
1427 C                     SETOF                     909192               048329
1428 C                     SETOF                     939495               048329
1429 C                     SETOF                     9697                 048329
1430 C**                                                                  048329
1431 C                     ENDSR                                          048329
1432 C**                                                                  048329
1433 C**                                                                  048329
1434 C********************************************************************048329
1435 C**                                                                  048329
1436 C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS       048329
1437 C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.         048329
1438 C**                                                                  048329
1439 C           ZRSTOR    BEGSR                           *** ZRSTOR *** 048329
1440 C**                                                                  048329
1441 C                     TESTB'0'       ZBITS          90               048329
1442 C                     TESTB'1'       ZBITS          91               048329
1443 C                     TESTB'2'       ZBITS          92               048329
1444 C                     TESTB'3'       ZBITS          93               048329
1445 C                     TESTB'4'       ZBITS          94               048329
1446 C                     TESTB'5'       ZBITS          95               048329
1447 C                     TESTB'6'       ZBITS          96               048329
1448 C                     TESTB'7'       ZBITS          97               048329
1449 C**                                                                  048329
1450 C                     ENDSR                                          048329
1451 C**                                                                  048329
1452 C**                                                                  048329
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
      /EJECT                                                              S01194
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
0647 O*PRINT  H  203   01                                                 S01124
0647 O**DL0710P1H  203   01                                               E95
0648 O*******OR  203   02 23                                              E95
     O***DL0710P1H  203   02 23                                        E95E257
     O**DL0700P1H**203***02*23**********                              E257BHF348
     O***DL0710P1H  203   02 23                                    BHF348 S01354
0650 O*******OR**203   06 23                                              S01354
     O*******OR**203   11 23                                       S01119 S01354
     ODL0710P1D  203   23                                                 S01354
0651 O*********************              22 'REFERENCE DL0710'            S01117
0651 O                                   24 'REFERENCE DL0710P1'          S01117
0652 O*********************    TITL      89                               S01194
0652 O                         BJURPT    89                               S01194
0653 O                                  104 'DATE'
     O                 88                81 ' - TYPE'                                         CDL021
     O                 88      TYP1      84                                                   CDL021
     O                 88 89   TYP2      87                                                   CDL021
     O                 88 89   TYP3      91                                                   CDL038
0654 O*********************    RUNA     112                               S01194
0654 O                         BJMRDT   112                               S01194
0655 O                                  123 'PAGE'
0656 O                         PAGE  Z  127
0657 O******  H  1     01                                                 E95
0658 O****** OR  1     02 23                                              E95
     O********H**1     02 23                                       E95    S01354
0660 O*******OR**1     06 23                                              S01354
     O*******OR**1     11 23                                       S01119 S01354
     O        D  1     23                                                 S01354
0661 O                                   70 'DEPOSITS BY MATURITY '
0662 O                                   74 'DATE'
     O                 88                81 ' - TYPE'                                         CDL021
     O                 88      TYP1      84                                                   CDL021
     O                 88 89   TYP2      87                                                   CDL021
     O                 88 89   TYP3      91                                                   CDL038
0663 O******* H  2     01                                                 E95
0664 O*******OR  2     02 23                                              E95
     O********H**2     02 23                                       E95    S01354
0660 O*******OR**2     06 23                                              S01354
     O*******OR**2     11 23                                       S01119 S01354
     O        D  2     23                                                 S01354
0667 O                                   73 '------------------------'
0668 O                                   74 '-'
     O********H**2     02 23                                       LN0614 S01354
0666 O*******OR**2     06 23                                       LN0614 S01354
     O*******OR**2     11 23                                       LN0614 S01354
     O        D  2     23                                                 S01354
0667 O                                   18 'CONSOLIDATED'                LN0614
0669 O******  H  1     01                                                 E95
0670 O****** OR  1     02 23                                              E95
     O********H**1     02 23                                       E95    S01354
0660 O*******OR**1     06 23                                              S01354
     O*******OR**1     11 23                                       S01119 S01354
     O/COPY WNCPYSRC,DL0710O001
     O        D  1     23                                                 S01354
0672 O                                   51 'DEAL   DEAL'
0673 O******  H  1     01                                                 E95
0674 O****** OR  1     02 23                                              E95
     O********H**1     02 23                                       E95    S01354
0660 O*******OR**1     06 23                                              S01354
     O*******OR**1     11 23                                       S01119 S01354
     O        D  1     23                                                 S01354
0676 O                                   14 'CUSTOMER'
0676 O                                   32 'TOWN'
0677 O***********************************61 'NUMBER  TYPE      RATE'      S01119
0677 O                                   51 'NUMBER  TYPE'                S01119
     O                                   67 'RATE'                        S01119
0678 O***********************************76 'CCY F/F'                     S01119
0679 O***********************************94 'PRINCIPAL'                   S01119
0680 O**********************************116 'INTEREST'                    S01119
0678 O                                   81 'CCY F/F'                     S01119
0679 O                                   95 'PRINCIPAL'                   S01119
0680 O                                  118 'INTEREST'                    S01119
     O                 67               130 'REF. RATE'                   CDL049
     O/COPY WNCPYSRC,DL0710O002
0682 O********H*12     02 L1                                              S01354
0683 O*******OR*12     02 23                                              S01354
0684 O*******OR*12     06 L1                                              S01354
0685 O*******OR*12     06 23                                              S01354
     O*******OR*12     11 L1                                       S01119 S01354
     O*******OR*12     11 23                                       S01119 S01354
0682 O********D*12     42                                          S01354 CDL006
     O        D 12     42N61                                              CDL006
0686 O                 24N26   NOTD  Z    3
0687 O                 24N26             15 'DAYS NOTICE'
0688 O                N24                 4 'DATE'
0689 O                N24      MDATE     12
     O/COPY WNCPYSRC,DL0710O010
0690 O                 24 26              4 'CALL'
0691 O********D**1     02                                                 S01354
0692 O*******OR**1     06                                                 S01354
     O*******OR**1     11                                          S01119 S01354
     O/COPY WNCPYSRC,DL0710O003
0691 O********D**1     43                                          S01354 CDL006
     O        D  1     43N61                                              CDL006
0693 O*************************CNUM       6                               E146
0693 O                         CUNR       6                               E146
0694 O                         CRNM      27
0694 O                         CTWN      38
0695 O                         DLNO      45
     O                         DTYP      48                               CDL038
     O                                   49 '-'                           CDL038
     O                         DLST      51                               CDL038
     O                         CLAS      55                               CDL038
     O                 36      @BYSL     56                               CDL038
0696 O*************************DTYP      49                               CDL038
0697 O*************************          50 '-'                           CDL038
0698 O*************************DLST      52                               CDL038
1 97 O*****************36******@BYSL     53                        S01157 CDL038
0699 O*************************EXRT      67 '   0 .        -'             S01119
0700 O*************************ECCY      72                               S01119
0701 O*************************FFIN      75                               S01119
0702 O*****************30******EAMT  1   91                               S01119
0703 O*****************31******EAMT      93 '   ,   ,   , 0 . '           S01119
0704 O*****************32******EAMT      94 '  ,   ,   , 0 .  '           S01119
0705 O*****************33******EAMT      95 ' ,   ,   , 0 .   '           S01119
0706 O*****************30******OTHA     114 ' ,   ,   ,   , 0 -'          S01119
0707 O*****************31******OTHA     116 '   ,   ,   , 0 . -'          S01119
0708 O*****************32******OTHA     117 '  ,   ,   , 0 .  -'          S01119
0709 O*****************33******OTHA     118 ' ,   ,   , 0 .   -'          S01119
     O*****************11N10 12UBRTT     56                        S01119 CDL038
     O/COPY WNCPYSRC,DL0710O004
0699 O                N11      EXRT      71 '   0 .        -'             S01119
     O                 11N10 34UEINR     71 '  0 .       -'               S01119
     O*****************10      CLRAT     71 '  0 .       -'        S01119 S01157
     O                 10N18   CLRAT     71 '  0 .       -'               S01157
     O                 10 18   FLRAT     71 '  0 .       -'               S01157
     O                 11N10 12UBRTT     59                               CDL038
     O/COPY WNCPYSRC,DL0710O005
0700 O                         ECCY      77                               S01119
0701 O                N11      FFIN      80                               S01119
     O                 16                80 'F'                           S01119
0702 O**********       30      EAMT  1   96                               S01119  CDL049
0703 O**********       31      EAMT      98 '   ,   ,   , 0 . '           S01119  CDL049
0704 O**********       32      EAMT      99 '  ,   ,   , 0 .  '           S01119  CDL049
0705 O**********       33      EAMT     100 ' ,   ,   , 0 .   '           S01119  CDL049
0706 O**********       30N11   OTHA     120 ' ,   ,   ,   , 0 -'          S01119  CDL049
0707 O**********       31N11   OTHA     122 '   ,   ,   , 0 . -'          S01119  CDL049
0708 O**********       32N11   OTHA     123 '  ,   ,   , 0 .  -'          S01119  CDL049
0709 O**********       33N11   OTHA     124 ' ,   ,   , 0 .   -'          S01119  CDL049
     O                 30N67   EAMT  1   96                               CDL049
     O                 31N67   EAMT      98 '   ,   ,   , 0 . '           CDL049
     O                 32N67   EAMT      99 '  ,   ,   , 0 .  '           CDL049
     O                 33N67   EAMT     100 ' ,   ,   , 0 .   '           CDL049
     O                 30N11N67OTHA     120 ' ,   ,   ,   , 0 -'          CDL049
     O                 31N11N67OTHA     122 '   ,   ,   , 0 . -'          CDL049
     O                 32N11N67OTHA     123 '  ,   ,   , 0 .  -'          CDL049
     O                 33N11N67OTHA     124 ' ,   ,   , 0 .   -'          CDL049
      *                                                                   CDL049
     O                 30 67   EAMT  1   92                               CDL049
     O                 31 67   EAMT      94 '   ,   ,   , 0 . '           CDL049
     O                 32 67   EAMT      95 '  ,   ,   , 0 .  '           CDL049
     O                 33 67   EAMT      96 ' ,   ,   , 0 .   '           CDL049
     O                 30N11 67OTHA     116 ' ,   ,   ,   , 0 -'          CDL049
     O                 31N11 67OTHA     118 '   ,   ,   , 0 . -'          CDL049
     O                 32N11 67OTHA     119 '  ,   ,   , 0 .  -'          CDL049
     O                 33N11 67OTHA     120 ' ,   ,   , 0 .   -'          CDL049
     O                 67      #RRAT    132 '   0 .        '              CDL049
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0710OOP1                                           S01408
     O*                                                                   S01408
     O********D**1     46                                                 CDL006
     O        D  1     46N61                                              CDL006
     O                    02 25         101 'AMOUNT ROLLED:'                                  CDL013
     O                 30 02 25RBDA  1  119                                                   CDL013
     O                 31 02 25RBDA     121 '   ,   ,   , 0 . '                               CDL013
     O                 32 02 25RBDA     122 '  ,   ,   , 0 .  '                               CDL013
     O                 33 02 25RBDA     123 ' ,   ,   , 0 .   '                               CDL013
      *                                                                                       CDL013
     O        D  1     62 45                                                                  CDL013
     O                                   36 'TAX INDICATOR :'                                 CDL013
     O                         TAXI      38                                                   CDL013
     O                                   59 'W/HOLD TAX AMOUNT:'                              CDL013
     O                 30      TAMT  1   78                                                   CDL013
     O                 31      TAMT      80 '   ,   ,   , 0 . '                               CDL013
     O                 32      TAMT      81 '  ,   ,   , 0 .  '                               CDL013
     O                 33      TAMT      82 ' ,   ,   , 0 .   '                               CDL013
     O                                  101 'NET INTEREST:'                                   CDL013
     O                 30      WNETI 1  119                                                   CDL013
     O                 31      WNETI    121 '   ,   ,   , 0 . '                               CDL013
     O                 32      WNETI    122 '  ,   ,   , 0 .  '                               CDL013
     O                 33      WNETI    123 ' ,   ,   , 0 .   '                               CDL013
      *                                                                                       CDL013
     O**********       30 19 45TAMT  1   45                                                   CDL013
0707 O**********       31 19 45TAMT      47 '   ,   ,   , 0 . '                               CDL013
0708 O**********       32 19 45TAMT      48 '  ,   ,   , 0 .  '                               CDL013
0709 O**********       33 19 45TAMT      49 ' ,   ,   , 0 .   '                               CDL013
0709 O**********          19 45          71 'INTEREST TAX AMOUNT'                             CDL013
     O*****************30 02 25RBDA  1   91                               S01119
0707 O*****************31 02 25RBDA      93 '   ,   ,   , 0 . '           S01119
0708 O*****************32 02 25RBDA      94 '  ,   ,   , 0 .  '           S01119
0709 O*****************33 02 25RBDA      95 ' ,   ,   , 0 .   '           S01119
0709 O********************02 25         110 'AMOUNT ROLLED'               S01119
     O**********       30 02 25RBDA  1   96                                            S01119 CDL013
0707 O**********       31 02 25RBDA      98 '   ,   ,   , 0 . '                        S01119 CDL013
0708 O**********       32 02 25RBDA      99 '  ,   ,   , 0 .  '                        S01119 CDL013
0709 O**********       33 02 25RBDA     100 ' ,   ,   , 0 .   '                        S01119 CDL013
0709 O**********          02 25         115 'AMOUNT ROLLED'                            S01119 CDL013
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0710OOP2                                           S01408
     O*                                                                   S01408
     O********D**1     08                                          S01119 CDL006
     O*******OR**1     09                                          S01119 CDL006
     O        D  1     08N61                                              CDL006
     O       OR  1     09N61                                              CDL006
     O*****************15      TBRTT     56                        S01119 CDL038
     O/COPY WNCPYSRC,DL0710O006
     O                 35      TEINR     71 '  0 .       -'               S01119
     O                 15      TBRTT     59                               CDL038
     O/COPY WNCPYSRC,DL0710O007
     O                 09      OTHC      77                               S01119
     O                 17                80 'F'                           S01119
0706 O                 51 09   OTHA  1   96                               S01119
0707 O                 52 09   OTHA      98 '   ,   ,   , 0 . '           S01119
0708 O                 53 09   OTHA      99 '  ,   ,   , 0 .  '           S01119
0709 O                 54 09   OTHA     100 ' ,   ,   , 0 .   '           S01119
     O********D**1     10                                          S01119 CDL006
     O        D  1     10N61                                              CDL006
     O****************N12      TBRTT     56                        S01119 CDL038
     O*****************12      UBRTT     56                        S01119 CDL038
     O/COPY WNCPYSRC,DL0710O008
     O                N12 35N14TEINR     71 '  0 .       -'               S01119
     O                 12 34N14UEINR     71 '  0 .       -'               S01119
     O                 14      AACRT     71 '  0 .       -'               S01119
     O                N12      TBRTT     59                               CDL038
     O                 12      UBRTT     59                               CDL038
     O********D**1*****10*13                                       S01119 S01157
     O        D  1     10 13N18                                           S01157
     O       AND      N61                                                 CDL006
     O                         FLRAT     71 '  0 .       -'               S01119
     O/COPY WNCPYSRC,DL0710O009
     O********D***22***03NU7 22                                           S01119
     O********T** 22   03NU7 22                                 S01119    S01153
     O********T   22   LRNU7 22                                           E95
0742 O********                           59 '***   NO DETAILS TO '        E95
0743 O********                           71 'REPORT   ***'                E95
0744 O********T 3      LR                                                 E95
0744 O        T 3      LR 58                                              E95
0745 O                                   71 '*** END OF REPORT ***'       S01117
     O********D**203***03                                                 S01119
     O********T**203   03                                       S01119    S01153
     O********T**203***LR                                       S01153    S01117
0647 O***DL0710AUT  203   LR                                        S01117E257
0647 O**DL0700AUT**203***LR**************                             E257BHF348
0647 ODL0710AUT  203   LR                                                 BHF348
0747 O***********                        22 'REFERENCE DL0710'            S01117
0747 O                                   24 'REFERENCE DL0710AU'          S01117
0652 O*********************    TITL      89                               S01194
0652 O                         BJURPT    89                               S01194
     O                                  104 'DATE'
0654 O*********************    RUNA     112                               S01194
0654 O                         BJMRDT   112                               S01194
     O                                  123 'PAGE'
     O*********************    PAGE  Z  127                               S01117
     O                         PAGE1 Z  127                               S01117
     O********D**1*****03                                                 S01119
     O********T**1     03                                       S01119    S01153
     O        T  1     LR                                                 S01153
     O                                   70 'DEPOSITS BY MATURITY '
     O                                   74 'DATE'
     O********D**2*****03                                                 S01119
     O********T**2     03                                       S01119    S01153
     O        T  2     LR                                                 S01153
     O                                   73 '------------------------'
     O                                   74 '-'
0714 O********D**220***03NU7                                              S01119
0714 O********T**220   03NU7                                    S01119    S01153
0714 O        T  220   LRNU7                                              S01153
0715 O                                   18 'RUN CONTROLS'
0716 O********D**2*****03NU7                                              S00119
0716 O********T**2     03NU7                                    S01119    S01153
0716 O        T  2     LRNU7                                              S01153
0717 O                                   59 'NUMBER'
0718 O                                   84 'VALUE'
0719 O********D**2*****03NU7                                              S01119
0719 O********T**2     03NU7                                    S01119    S01153
0719 O        T  2     LRNU7                                              S01153
0720 O                                   27 'SORTED EVENTS FILE '
0721 O                                   40 'RECORDS INPUT'
0722 O                         NREC  3   59
0723 O                         INT,1 Z   81
0724 O                         DEC,1     84
0725 O************     U8                89 '***'                         S01153
0726 O********D**2*****03NU7                                              S01119
0726 O********T**2     03NU7                                    S01119    S01153
0727 O************                       27 'SORTED EVENTS FILE '         S01153
0728 O************                       41 'CONTROL TOTALS'              S01153
0729 O************             NORE  3   59                               S01153
0730 O************             HRWN  Z   81                               S01153
0731 O************             HRDC      84                               S01153
0732 O************     U8                89 '***'                         S01153
0733 O********D********03NU7                                              S01119
0733 O********T**      03NU7                                    S01119    S01153
0733 O        T        LRNU7                                              S01153
0734 O                                   31 'RECORDS LISTED IN THIS '
0735 O                                   37 'REPORT'
0736 O                         NRIT  3   59
0737 O                         INT,2 Z   81
0738 O                         DEC,2     84
0739 O********D*3******03NU7 U8                                           S01119
0739 O********T*3      03NU7 U8                                 S01119    S01153
0740 O***********                        71 '***   DIFFERENCE   ***'      S01153
0744 O********D*3******03NU7                                              S01119
0744 O********T*3      03NU7                                              S01119
0744 O********T*3******LRNU7                                    S01153    S01117
0745 O*********************              71 '*** END OF REPORT ***'       S01117
     O        T 3      LRNU7 22                                           S01117
0742 O                                   59 '***   NO DETAILS TO '        S01117
0743 O                                   71 'REPORT   ***'                S01117
0746 O        T 3      LR U7 U8
0747 O***********************************22 'REFERENCE DL0710'            S01117
0748 O*************************DLNO******40                               S01117
0749 O***********************************64 'PRINT TERMINATED, '          S01117
0750 O***********************************82 'DATABASE IN ERROR.'          S01194
0749 O                                   61 'PRINT TERMINATED, '          S01117
0749 O                                   71 'DEAL NO.'                    S01117
0748 O                         DLNO      78                               S01117
     O        T 2      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   49 'OPTION'                      S01117
     O                         DBOPTN    57                               S01117
     O                                   66 'KEY'                         S01117
     O                         DBKEY     96                               S01117
0941 O********************************************************************S01354
0942 O*****  REPORT DL0710P2 FOR INTERNAL DEALS & 'M1' EVENTS             S01354
0943 O*                                SAME FORMAT & LAYOUTS              S01354
0944 ODL0710P2D  203   63                                                 S01354
0948 O                                   22 'REFERENCE DL0710P2'          S01354
0652 O                         BJURPT    89                               S01354
0950 O                                  104 'DATE'                        S01354
0654 O                         BJMRDT   112                               S01354
0952 O                                  123 'PAGE'                        S01354
0953 O                         PAGE2 Z  127                               S01354
0954 O        D  1     63                                                 S01354
0958 O                                   64 'INTERNAL DEALS BY'           S01354
0959 O                                   78 'MATURITY DATE'               S01354
0960 O        D  2     63                                                 S01354
0964 O                                   64 '-----------------'           S01354
0965 O                                   78 '--------------'              S01354
     O        D  2     63                                                 S01354
0667 O                                   18 'CONSOLIDATED'                S01354
0966 O        D  1     63                                                 S01354
0969 O                                   51 'DEAL   DEAL'                 S01354
0970 O        D  1     63                                                 S01354
0973 O                                   14 'CUSTOMER'                    S01354
0974 O                                   32 'TOWN'                        S01354
0975 O                                   61 'NUMBER  TYPE      RATE'      S01354
0976 O                                   76 'CCY F/F'                     S01354
0977 O                                   94 'PRINCIPAL'                   S01354
0978 O                                  116 'INTEREST'                    S01354
0979 O********D*12     41                                          S01354 CDL006
     O        D 12     41N61                                              CDL006
0982 O                 24N26   NOTD  Z    3                               S01354
0983 O                 24N26             15 'DAYS NOTICE'                 S01354
0984 O                N24                 4 'DATE'                        S01354
0985 O                N24      MDATE     12                               S01354
0986 O                 24 26              4 'CALL'                        S01354
0987 O*                                                                   S01354
0988 O********D**1     02N43                                       S01354 CDL006
     O        D  1     02N43N61                                           CDL006
0989 O                         CUNR       6                               S01354
0990 O                         CRNM      27                               S01354
0991 O                         CTWN      38                               S01354
0992 O                         DLNO      45                               S01354
     O                         DTYP      48                               CDL038
     O                                   49 '-'                           CDL038
     O                         DLST      51                               CDL038
     O                         CLAS      55                               CDL038
     O                 36      @BYSL     56                               CDL038
0993 O*************************DTYP      49                        S01354 CDL038
0994 O*************************          50 '-'                    S01354 CDL038
0995 O*************************DLST      52                        S01354 CDL038
1 97 O*****************36******@BYSL     53                        S01354 CDL038
     O*****************11N10 12UBRTT     56                        S01354 CDL038
0699 O                N11      EXRT      71 '   0 .        -'             S01354
     O                 11N10 12UBRTT     59                               CDL038
0700 O                         ECCY      77                               S01354
0701 O                N11      FFIN      80                               S01354
0702 O                 30      EAMT  1   96                               S01354
0703 O                 31      EAMT      98 '   ,   ,   , 0 . '           S01354
0704 O                 32      EAMT      99 '  ,   ,   , 0 .  '           S01354
0705 O                 33      EAMT     100 ' ,   ,   , 0 .   '           S01354
0706 O                 30N11   OTHA     120 ' ,   ,   ,   , 0 -'          S01354
0707 O                 31N11   OTHA     122 '   ,   ,   , 0 . -'          S01354
0708 O                 32N11   OTHA     123 '  ,   ,   , 0 .  -'          S01354
0709 O                 33N11   OTHA     124 ' ,   ,   , 0 .   -'          S01354
1007 O*                                                                   S01354
1051 O        T 3      LR 59                                              S01354
1052 O                                   71 '*** END OF REPORT ***'       S01354
     ODL0710P3D  203   64                                                 CDL006
     O                                   24 'REFERENCE DL0710P3'          CDL006
     O                         BJURPT    89                               CDL006
     O                                  104 'DATE'                        CDL006
     O                         BJMRDT   112                               CDL006
     O                                  123 'PAGE'                        CDL006
     O                         PAGE3 Z  127                               CDL006
     O        D  1     64                                                 CDL006
     O                                   70 'FIDUCIARY DEALS BY'          CDL006
     O                                   84 'MATURITY DATE'               CDL006
     O        D  2     64                                                 CDL006
     O                                   70 '------------------'          CDL006
     O                                   84 '--------------'              CDL006
     O        D  2     64                                                 CDL006
     O                                   18 'CONSOLIDATED'                CDL006
     O        D  1     64                                                 CDL006
     O                                   51 'DEAL   DEAL'                 CDL006
     O        D  1     64                                                 CDL006
     O                                   14 'CUSTOMER'                    CDL006
     O                                   32 'TOWN'                        CDL006
     O                                   51 'NUMBER  TYPE'                CDL006
     O                                   67 'RATE'                        CDL006
     O                                   81 'CCY F/F'                     CDL006
     O                                   95 'PRINCIPAL'                   CDL006
     O                                  118 'INTEREST'                    CDL006
      *                                                                   CDL006
     O        D 12     44                                                 CDL006
     O                 24N26   NOTD  Z    3                               CDL006
     O                 24N26             15 'DAYS NOTICE'                 CDL006
     O                N24                 4 'DATE'                        CDL006
     O                N24      MDATE     12                               CDL006
     O                 24 26              4 'CALL'                        CDL006
      *                                                                   CDL006
     O        D  1     47                                                 CDL006
     O                         CUNR       6                               CDL006
     O                         CRNM      27                               CDL006
     O                         CTWN      38                               CDL006
     O                         DLNO      45                               CDL006
     O                         DTYP      48                               CDL038
     O                                   49 '-'                           CDL038
     O                         DLST      51                               CDL038
     O                         CLAS      55                               CDL038
     O                 36      @BYSL     56                               CDL038
     O*************************DTYP      49                        CDL006 CDL038
     O*************************          50 '-'                    CDL006 CDL038
     O*************************DLST      52                        CDL006 CDL038
     O*****************36******@BYSL     53                        CDL006 CDL038
     O*****************11N10*12UBRTT     56                        CDL006 CDL038
     O                N11      EXRT      71 '   0 .        -'             CDL006
     O                 11N10 34UEINR     71 '  0 .       -'               CDL006
     O                 10N18   CLRAT     71 '  0 .       -'               CDL006
     O                 10 18   FLRAT     71 '  0 .       -'               CDL006
     O                 11N10 12UBRTT     59                               CDL038
     O                         ECCY      77                               CDL006
     O                N11      FFIN      80                               CDL006
     O                 16                80 'F'                           CDL006
     O                 30      EAMT  1   96                               CDL006
     O                 31      EAMT      98 '   ,   ,   , 0 . '           CDL006
     O                 32      EAMT      99 '  ,   ,   , 0 .  '           CDL006
     O                 33      EAMT     100 ' ,   ,   , 0 .   '           CDL006
     O                 30N11   OTHA     120 ' ,   ,   ,   , 0 -'          CDL006
     O                 31N11   OTHA     122 '   ,   ,   , 0 . -'          CDL006
     O                 32N11   OTHA     123 '  ,   ,   , 0 .  -'          CDL006
     O                 33N11   OTHA     124 ' ,   ,   , 0 .   -'          CDL006
      *                                                                   CDL006
     O        D  1     48                                                 CDL006
     O                 30 19 45TAMT  1   45                               CDL006
     O                 31 19 45TAMT      47 '   ,   ,   , 0 . '           CDL006
     O                 32 19 45TAMT      48 '  ,   ,   , 0 .  '           CDL006
     O                 33 19 45TAMT      49 ' ,   ,   , 0 .   '           CDL006
     O                    19 45          71 'INTEREST TAX AMOUNT'         CDL006
     O                 30 02 25RBDA  1   96                               CDL006
     O                 31 02 25RBDA      98 '   ,   ,   , 0 . '           CDL006
     O                 32 02 25RBDA      99 '  ,   ,   , 0 .  '           CDL006
     O                 33 02 25RBDA     100 ' ,   ,   , 0 .   '           CDL006
     O                    02 25         115 'AMOUNT ROLLED'               CDL006
      *                                                                   CDL006
     O******* D  1     08                                          CDL006 178833
     O*******OR  1     09                                          CDL006 178833
     O        D  1     08 61                                              178833
     O       OR  1     09 61                                              178833
     O*****************15      TBRTT     56                        CDL006 CDL038
     O                 15      TBRTT     59                               CDL038
     O                 09      OTHC      77                               CDL006
     O                 17                80 'F'                           CDL006
     O                 51 09   OTHA  1   96                               CDL006
     O                 52 09   OTHA      98 '   ,   ,   , 0 . '           CDL006
     O                 53 09   OTHA      99 '  ,   ,   , 0 .  '           CDL006
     O                 54 09   OTHA     100 ' ,   ,   , 0 .   '           CDL006
      *                                                                   CDL006
     O******* D  1     10                                          CDL006 178833
     O        D  1     10 61                                              178833
     O****************N12      TBRTT     56                        CDL006 CDL038
     O*****************12      UBRTT     56                        CDL006 CDL038
     O                N12 35N14TEINR     71 '  0 .       -'               CDL006
     O                 12 34N14UEINR     71 '  0 .       -'               CDL006
     O                 14      AACRT     71 '  0 .       -'               CDL006
     O                N12      TBRTT     59                               CDL038
     O                 12      UBRTT     59                               CDL038
      *                                                                   CDL006
     O        D  1     10 13N18                                           CDL006
     O       AND       61                                                 178833
     O                         FLRAT     71 '  0 .       -'               CDL006
      *                                                                   CDL006
     O        T 3      LR 60                                              CDL006
     O                                   71 '*** END OF REPORT ***'       CDL006
1058 O*                                                                   S01354
     O/COPY WNCPYSRC,DL0710O011
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
