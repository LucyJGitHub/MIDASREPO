0001 H        1
0002 F********************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Deals by Deal Sub-Type Report')
0002 F********************************************************************
0003 F*                                                                  *
     F*  Midas - Dealing Module
0005 F*                                                                  *
0006 F*       DL0730 - DEPOSITS BY SUB-TYPE REPORT                       *
0007 F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0009 F*                                                                  *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD031             Date 10Apr06               *
      *  Prev Amend No. CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CDL028             Date 07Feb05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR005             Date 21Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 100097             Date 05Apr97               *
     F*                       S01393          DATE  11AUG92              *
     F*                       LN0646          DATE  17AUG90              *
     F*                       E296            DATE  02APR90              *
     F*                       S01194          DATE  24/08/89             *S01194
     F*                       S01117          DATE  24/08/89             *S01117
     F*                       S01157          DATE  24/08/89             *S01157
     F*                       S01153          DATE  13/06/88             *S01153
     F*                       S01119          DATE  15/06/87             *
     F*                       S01124          DATE  00/00/00             *
     F*                                                                  *
0002 F********************************************************************
0003 F*                                                                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CIR005 - FRA/IRS Business Day Conventions to DEALSDG         *
      *           (recompile)                                         *
     F*       100097 - REOPENED fix. 'PS' now appearing in the report    *
     F*                but no details shown (ie. amount).  Must appear   *
     F*                similarly to DL0711 report.                       *
     F*       S01393 - Recompiled for Strategic Risk Management          *
     F*                Book Code added to PF/EVNTXED                     *
     F*                                                                  *
     F*       LN0646 - 'END' POSITIONED INCORRECTLY AFTER TEST FOR       *
     F*                CROSS-CURRENCY DEAL                               *
0003 F*                                                                  *
     F*       E296   - SHOULD READ SDBANK WHEN FILES EMPTY               *
0003 F*                                                                  *
     F*       S01194 - STANDING DATA CHANGES.                            *S01194
0003 F*                                                                  *
     F*       S01117 - MULTIBRANCHING CHANGE.                            *S01117
0003 F*                                                                  *
     F*       S01157 - (i) IF DEAL IS A FLOOR (TYPE 'RF') DO NOT OUTPUT  *S01157
     F*                CEILING RATE, OUTPUT FLOOR RATE. SPLIT DEAL       *S01157
     F*                TYPE 'RL' INTO 'RP', 'RF', AND 'RR'.              *S01157
     F*                (ii) IF AN FRA, CAP OR COLLAR HAS FIXED RATE      *S01157
     F*                IN 'OUR' DETAILS (UBRTT = 0) THEN IT IS A         *S01157
     F*                PURCHASE, ELSE IT IS A SALE. BUT IF A FLOOR HAS   *S01157
     F*                FIXED RATE IN 'OUR' DETAILS THEN IT IS A SALE,    *S01157
     F*                ELSE IT IS A PURCHASE.                            *S01157
0003 F*                                                                  *
     F*       S01153 - CLOSE OF BUSINESS IMPROVEMENTS                    *S01153
     F*       S01119 - BASE RATE TYPE FIELD ADDED FOR FRA/IRS            *
0011 F*                                                                  *
0012 F********************************************************************
0013 F*VNT3***IP**E***********K********DISK                               S01119
     FEVNTXEC IP  E                    DISK                               S01119
0013 F*VNT3J**IS* E           K        DISK                               S01153
     F*VNTXZZ*IF* E                    DISK                               S01153
0014 F*ABLE   IF  F      96 12AI     2 DISK                       *****   S01194
0013 FEVNTJL1 IS  E           K        DISK                               S01153
0015 F*PRINT  O   F     132     OF     PRINTER                            S01124
     FDL0730AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0015 F**DL0730P1O***F*****132     OF     PRINTER                  S01124  S01117
0015 FDL0730P1O   F     132     OF     PRINTER      KINFDS SPOOL          S01117
0016 F* ID F  C  H  L    FUNCTION OF INDICATORS
0017 F* 01            EVENT DETAIL
0018 F**02*******     EVENT TRAILER
0019 F* 03            EVENT CATCHALL
0020 F**04*****       TABLE FILE - ICR 1                          *****   S01194
0021 F* 05                       - DEAL SUB TYPES
0022 F* 06                       - CURRENCIES RECORD 1
0023 F* 07                       - CATCHALL
     F*       10      FLOOR DEAL, TYPE 'RF'                               S01157
     F*       11      AN FRA/IRS EVENT TYPE                               S01119
     F*       12      OUR DETAILS HAVE BEEN ENTERED                       S01119
     F*       13      FLOOR RATE HAS BEEN ENTERED                         S01119
     F*       14      AVERAGE RATE METHOD USED                            S01119
     F*       15      THEIR DETAILS HAVE BEEN ENTERED                     S01119
     F*       16      OUR FED FUNDS INDICATOR PRESENT                     S01119
     F*       17      THEIR FED FUNDS INDICATOR PRESENT                   S01119
0024 F*    19         HRWN IS ZERO - USED FOR EDITING
0025 F*    20         'EVENT DATE' IS ZERO
0026 F*    21         'NOTICE DAYS' IS ZERO
0027 F*    22         EXCHANGE RATE IS ZERO
0028 F*       25      HASH AMOUNT NEGATIVE
0029 F*       30      EVENT CURRENCY HAS 0 D.P.
0030 F*       31      EVENT CURRENCY HAS 1 D.P.
0031 F*       32      EVENT CURRENCY HAS 2 D.P.
0032 F*       33      EVENT CURRENCY HAS 3 D.P.
0033 F*       34      EVENT DATE EXCEEDS RUN DATE
     F*       35      OUR FLOATING RATE ENTERED                           S01119
     F*       36      THEIR FLOATING RATE ENTERED                         S01119
0034 F*       40      CONTROL OF FIRST CYCLE
0035 F*       41      CONDITION OUTPUT OF HEADINGS
0036 F*       42      OUTPUT HEADINGS
0037 F*       45      EVENT TYPE IS 16M1 OR 18M1
0038 F*       46      EVENT TYPE IS 15M1, 17M1 OR 17S1
0039 F*       47      EVENT IS TO BE OUTPUT TO REPORT
0040 F*       48      DETAILS TO REPORT
0041 F*       50-51   USED FOR EDITING HASH OF VALUES
     F*       52      '21O1' FORWARD RATE AGREEMENT EVENT                 S01119
     F*       53      '22O1' SINGLE CCY INTEREST RATE SWAP EVENT          S01119
     F*       54      '23O1' CROSS CCY INTEREST RATE SWAP EVENT           S01119
     F*       55      '24O1' INTEREST RATE CAP/COLLAR EVENT               S01119
     F*       56      FR, RP, RR, RF DEAL TYPE - SOLD                     S01157
     F*       57      EVENT TYPE IS 20V1                                  100097
     F*       58      EVENT TYPE IS 20V2                                  100097
0042 F*       60-61   CONTROL PRINTING OF DEAL SUB TYPE HEADINGS
     F*       62      OTHER CCY HAS ZERO DECIMAL PLACES                   S01119
     F*       63      OTHER CCY HAS ONE DECIMAL PLACE                     S01119
     F*       64      OTHER CCY HAS TWO DECIMAL PLACES                    S01119
     F*       65      OTHER CCY HAS THREE DECIMAL PLACES                  S01119
0043 F*       80-81   FILE CONTROLS OUT OF BALANCE
0044 F*             L1CHANGE OF DEAL SUB TYPE
     E                    CPY@    1   1 80
0045 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0046 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0047 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0048 E                    INT         2 15 0
0049 E                    DEC         2  3 0
0050 I*
0084 I*    EVENTS FILE - HEADER RECORD.                                   S01119
0085 I*                                                                   S01119
0086 IEVNTXECF                                                            S01119
0088 I*                                                                   S01119
0051 I*    EVENTS FILE - DETAIL RECORD.
0052 I*
0053 I*VNTXEDF****01*******************************                       S01119
0053 I*VNT3JF*****01                                                      S01153
0053 IEVNTJL1F    01                                                      S01153
0058 I                                              EDAT            20
0063 I                                              DLST  L1
     I                                              CLAS  L1                                  CDL038
0065 I                                              EXRT            22
0067 I                                              NOTD            21
0102 I***********                                                         S01153
0103 I*****EVENTS FILE - TRAILER RECORD.                                  S01153
0104 I***********                                                         S01153
0105 I*VNTXZZF*** 02                                                      S01153
0114 I*****                                                       *****   S01194
0115 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.       *****   S01194
0116 I*****                                                       *****   S01194
0117 I*ABLE   NS  04   2 C0   3 C1  12 C1                         *****   S01194
0118 I*****  AND      13 C0                                       *****   S01194
0119 I*****                                   1   1 RECI          *****   S01194
0120 I*****                                   2   30RECT          *****   S01194
0121 I*****                                  12  130RCDE          *****   S01194
0122 I*****                                  14  66 TITL          *****   S01194
0123 I*****                                  67  67 DATF          *****   S01194
0124 I***********                            68  700DFBR          S01117  S01194
     I*****                                  68  70 DFBM          S01117  S01194
0125 I*****                                  74  74 MODI1         *****   S01194
0126 I*****                                  75  75 MODI2         *****   S01194
0127 I*****                                  76  76 MODI3         *****   S01194
0128 I*****                               P  77  790RUND          *****   S01194
0129 I*****                                  80  86 RUNA          *****   S01194
0130 I*****                                  87  870SFLG          *****   S01194
0131 I*****                               P  90  920LCD           *****   S01194
0132 I*****                                  93  93 CHTP          *****   S01194
0133 I*****                               P  94  960TNLU          *****   S01194
0134 I*****                                                       *****   S01194
0135 I*****TABLE FILE - DEAL SUB-TYPES RECORD.                    *****   S01194
0136 I*****                                                       *****   S01194
0137 I*ABLE   NS  05   1 CD   2 C4   3 C2                         *****   S01194
0138 I*****                                   1   1 RECI          *****   S01194
0139 I*****                                   2   30RECT          *****   S01194
0140 I*****                                  12  13 DSCD          *****   S01194
0141 I*****                                  14  43 DSNM          *****   S01194
0142 I*****                                  44  45 DSAC          *****   S01194
0143 I*****                               P  90  920LCD           *****   S01194
0144 I*****                                  93  93 CHTP          *****   S01194
0145 I*****                               P  94  960TNLU          *****   S01194
0146 I*****                                                       *****   S01194
0147 I*****TABLE FILE - CURRENCIES RECORD 1.                      *****   S01194
0148 I*****                                                       *****   S01194
0149 I*ABLE   NS  06   1 CD   2 C2   3 C0                         *****   S01194
0150 I*****  AND      13 C1                                       *****   S01194
0151 I*****                                   1   1 RECI          *****   S01194
0152 I*****                                   2   30RECT          *****   S01194
0153 I*****                                  10  12 CCY           *****   S01194
0154 I*****                                  13  130SREC          *****   S01194
0155 I*****                                  14  27 CCNM          *****   S01194
0156 I*****                               P  28  348SPOT          *****   S01194
0157 I*****                                  35  37 CCYS          *****   S01194
0158 I*****                                  38  380CDP           *****   S01194
0159 I*****                                  39  390TNOT          *****   S01194
0160 I*****                                  40  40 DCCY          *****   S01194
0161 I*****                                  41  44 SRC1          *****   S01194
0162 I*****                                  45  48 SRC2          *****   S01194
0163 I*****                                  49  520TACC          *****   S01194
0164 I*****                                  53  560TEQV          *****   S01194
0165 I*****                                  57  600SWQV          *****   S01194
0166 I*****                                  61  640TAC4          *****   S01194
0167 I*****                                  65  680TAC5          *****   S01194
0168 I*****                                  69  69 HIND          *****   S01194
0169 I*****                               P  70  768PART          *****   S01194
0170 I*****                                  77  780SSNO          *****   S01194
0171 I*****                               P  79  858ERLC          *****   S01194
0172 I*****                               P  90  920LCD           *****   S01194
0173 I*****                                  93  93 CHTP          *****   S01194
0174 I*****                               P  94  960TNLU          *****   S01194
0175 I*****                                                       *****   S01194
0176 I*****CATCHALL                                               *****   S01194
0177 I*****                                                       *****   S01194
0178 I*****   NS  07                                              *****   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
     I*                                                                   S01194
     ISDDLST    E DSSDDLSTPD                                              S01194
     I* DEALING SUB TYPE DETAILS ACCESSED VIA ACCESS PROGRAM              S01194
     I*                                                                   S01194
     ISDTCLS    E DSSDTCLSPD                                              CDL038
     I* TRANSACTION CLASS DETAILS ACCESSED VIA ACCESS PROGRAM             CDL038
     I*                                                                   CDL038
     ISDCURR    E DSSDCURRPD                                              S01194
     I* CURRENCY DETAILS ACCESSED VIA ACCESS PROGRAM                      S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
0393 I*                                                                   S01194
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE FOR P1 FILES                     S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 243 2460SWRIT                 S01117
     I@BINRY      DS                                                      S01117
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I                                    B   1   40@BKBIN                S01117
0393 I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE FOR AU FILE                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
0179 C/EJECT
      *                                                                   S01117
      * ENTRY PARAMETER REQUIRED BY RCF                                   S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ                             S01117
0180 C*
0181 C*    FIRST CYCLE CALCS.
0182 C*
0183 C   42                SETOF                     42
0184 C   40                GOTO DETAIL
0185 C                     SETON                     4041
     C                     MOVEACPY@      BIS@   80
0186 C*****                EXSR ZSYSTM                            *****   S01194
0187 C***99                SETON                     U7U8LR       *****   S01194
0188 C***99                GOTO END                               *****   S01194
0189 C*****                MOVEL'42'      KEYT   12               *****   S01194
0190 C*****                MOVEL'20'      KCUR   12               *****   S01194
0191 C*****                MOVE '1'       WRK4    4               *****   S01194
0327 C*                                                                   S01194
0327 C* CALL ACCESS PROG. FOR BANK DETAILS.                               S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
0327 C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'001'     DBASE   3        * DBERR 001 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
0349 C                     MOVEL@OPTN     DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
0517 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.            *****   S01194
0829 C           BJDFIN    COMP 'M'                      98               S01194
0192 C           DETAIL    TAG                             ** DETAIL TAG *
0193 C                     SETOF                     454647
     C*                                                                   S01157
     C* SET OFF FRA/IRS BUY/SELL INDICATOR                                S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN75                           S01157
     C                     SETOF                     525354               S01119
     C                     SETOF                     556263               S01119
0194 C*********************SETOF                     60                   S01119
0194 C                     SETOF                     606465               S01119
     C                     SETOF                     111213               S01119
     C                     SETOF                     141516               S01119
     C                     SETOF                     173536               S01119
0294 C                     SETOF                     56    FR,RP,ETC. SOLDS01157
0195 C**N01******          GOTO TRAIL                                     S01153
0195 C  N01                GOTO END                                       S01153
0196 C*
0197 C*    ACCUMULATE NUMBER AND VALUE OF DETAIL RECORDS READ IN INT,1
0198 C*    DEC,1
0199 C*
0200 C           RECRED    ADD  1         RECRED  50
0201 C           EAMT      DIV  1000      ZZAMT        25
0202 C   25                Z-SUBZZAMT     ZZAMT
0203 C                     Z-ADD1         X       10
0204 C                     EXSR HASH
0205 C*
0206 C*    AT CHANGE OF DEAL SUB TYPE, RECOVER NARRATIVE FROM TABLE FILE
0207 C*
0208 C  NL1                GOTO NOTL1
0209 C*****                MOVE DLST      KEYT                    *****   S01194
0210 C*****                SETOF                     05           *****   S01194
0211 C*****      KEYT      CHAINTABLE                99           *****   S01194
0212 C**N05                SETON                     U7U8LR       *****   S01194
0213 C**N05                GOTO END                               *****   S01194
0327 C*                                                                   S01194
0327 C* CALL ACCESS PROG. FOR DEAL SUB TYPE DETAILS.                      S01194
     C                     CALL 'AODLSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM DLST      @DLST   2                       S01194
     C           SDDLST    PARM SDDLST    DSFDY                           S01194
0327 C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDLSTPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'002'     DBASE   3        * DBERR 002 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
0349 C                     MOVEL@DLST     DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   CDL038
     C* CALL ACCESS PROG. FOR DEAL CLASS DETAILS.                         CDL038
     C                     CLEARSDTCLS                                    CDL038
     C           CLAS      IFNE *BLANK                                    CDL038
     C                     CALL 'AOTCLSR0'                                CDL038
     C                     PARM *BLANK    @RTCD   7                       CDL038
     C                     PARM '*KEY   ' @OPTN   7                       CDL038
     C                     PARM CLAS      @CLAS   4                       CDL038
     C           SDTCLS    PARM SDTCLS    DSFDY                           CDL038
     C           @RTCD     IFNE *BLANK                                    CDL038
     C                     CLEARSDTCLS                                    CDL038
     C                     ENDIF                                          CDL038
     C                     ENDIF                                          CDL038
     C*                                                                   CDL038
0214 C           NOTL1     TAG                             ** NOTL1 TAG **
0215 C*
0216 C*    PROCESS RECORDS WITH EVENT TYPES 15M1,16M1,17S1,17M1,18M1,     S01119
     C*    21O1,22O1,23O1,24O1.                                           S01119
0217 C*
0218 C           ETYP      COMP '16M1'                   45
0219 C  N45      ETYP      COMP '18M1'                   45
0220 C           ETYP      COMP '15M1'                   46
0221 C  N46      ETYP      COMP '17M1'                   46
0222 C  N46      ETYP      COMP '17S1'                   46
     C  N46      ETYP      COMP '21O1'                   52               S01119
     C  N46N52   ETYP      COMP '22O1'                   53               S01119
     C  N46N52N53ETYP      COMP '23O1'                   54               S01119
     C  N46N52N53ETYP      COMP '24O1'                   55               S01119
     C*                                                                   100097
     C                     MOVE '0'       *IN57                           100097
     C                     MOVE '0'       *IN58                           100097
     C           ETYP      IFEQ '20V1'                     PS deals       100097
     C           ETYP      OREQ '20V2'                                    100097
     C*                                                                   100097
     C           FSLI      IFEQ 2                          2nd leg        100097
     C*                                                                   100097
     C           ETYP      IFEQ '20V1'                                    100097
     C                     MOVE '1'       *IN57            Deposit        100097
     C                     ELSE                                           100097
     C                     MOVE '1'       *IN58            Loan           100097
     C                     END                                            100097
     C*                                                                   100097
     C                     ELSE                                           100097
     C                     GOTO END                                       100097
     C                     END                                            100097
     C*                                                                   100097
     C                     END                                            100097
     C*                                                                   S01119
     C                     MOVEA*IN,52    INDS    4                       S01119
     C           INDS      IFNE '0000'                                    S01119
     C                     SETON                     11                   S01119
     C                     END                                            S01119
0223 C*
0224 C**N45N46*************GOTO END                                       S01119
0224 C**N45N46N11          GOTO END                                       S01153
0225 C                     SETON                     4748
0226 C  N61                SETON                     6061
0227 C*
0228 C*    SET INDICATORS TO PRINT HEADINGS
0229 C   41                SETON                     42
0230 C   41                SETOF                     41
0231 C*
0232 C*    ACCUMULATE NUMBER AND VALUE OF DETAIL RECORDS REPORTED IN
0233 C*    INT,2  DEC,2
0234 C*
0235 C           RECRIT    ADD  1         RECRIT  50
0236 C                     MOVE 2         X
0237 C                     EXSR HASH
0238 C*
0239 C*    CHAIN TO TABLE FILE AND SET INDICATORS ACCORDING TO NUMBER
0240 C*    OF DECIMAL PLACES
0241 C*
0242 C*****                MOVELECCY      WRK4                    *****   S01194
0243 C*****                MOVE WRK4      KCUR                    *****   S01194
0244 C*****                SETOF                     06           *****   S01194
0245 C*****      KCUR      CHAINTABLE                99           *****   S01194
0246 C**N06                SETON                     U7U8LR       *****   S01194
0247 C**N06                GOTO END                               *****   S01194
0327 C*                                                                   S01194
0327 C* CALL ACCESS PROG. FOR CURRENCY DETAILS.                           S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM ECCY      @CRKEY  3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
0327 C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'003'     DBASE   3        * DBERR 003 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
0349 C                     MOVEL@CRKEY    DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
0248 C*****      CDP       COMP 1                      3031       *****   S01194
0248 C           A6NBDP    COMP 1                      3031               S01194
0249 C*****      CDP       COMP 2                    33  32       *****   S01194
0249 C           A6NBDP    COMP 2                    33  32               S01194
0238 C*                                                                   S01119
0239 C*    CHAIN TO TABLE FILE AND SET INDICATORS ACCORDING TO NUMBER     S01119
0240 C*    OF DECIMAL PLACES FOR OTHER CCY IN EVENT TYPE '23O1'           S01119
     C*                                                                   S01119
     C           *IN54     IFEQ '1'                                       S01119
0242 C*****                MOVELOTHC      WRK4                    S01119  S01194
0243 C*****                MOVE WRK4      KCUR                    S01119  S01194
0244 C*****                SETOF                     06           S01119  S01194
0245 C*****      KCUR      CHAINTABLE                99           S01119  S01194
0246 C**N06                SETON                     U7U8LR       S01119  S01194
0247 C**N06                GOTO END                               S01119  S01194
0327 C*                                                                   S01194
0327 C* CALL ACCESS PROG. FOR CURRENCY DETAILS.                           S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM OTHC      @CRKEY  3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
0327 C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'004'     DBASE   3        * DBERR 004 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
0349 C                     MOVEL@CRKEY    DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            LN0646
     C*                                                                   LN0646
0248 C*****      CDP       COMP 1                      6263       S01119  S01194
0248 C           A6NBDP    COMP 1                      6263               S01194
0249 C*****      CDP       COMP 2                    65  64       S01119  S01194
0249 C           A6NBDP    COMP 2                    65  64               S01194
     C                     END                                            S01119
0250 C*
0251 C*    IF MATURITY DATE - IN FIELD 'EVENT DATE'- IS GREATER THAN RUN
0252 C*    DATE, CONVERT IT TO ALPHAMERIC FORMAT
     C*    FOR '21O1' FR EVENT TYPE OTHER DATE USED                       S01119
0253 C*
0254 C***********EDAT      COMP RUND                 34                   S01119
0254 C**N52******EDAT      COMP RUND                 34           S01119  S01194
0254 C  N52      EDAT      COMP BJRDNB               34                   S01194
     C***52******OTHD      COMP RUND                 34           S01119  S01194
     C   52      OTHD      COMP BJRDNB               34                   S01194
0255 C***34****************MOVE EDAT      ZDAYNO                          S01119
0255 C   34N52             MOVE EDAT      ZDAYNO                          S01119
     C   34 52             MOVE OTHD      ZDAYNO                          S01119
0256 C   34                EXSR ZDATE2
0257 C   34                MOVE ZADATE    MATDA   7
0258 C*
0259 C*    CONVERT OTHER DATE TO ALPHAMERIC FORMAT
     C*    CONVERT EVENT TYPE FOR '21O1'                                  S01119
0260 C*
0261 C*********************MOVE OTHD      ZDAYNO                          S01119
0261 C  N52                MOVE OTHD      ZDAYNO                          S01119
     C   52                MOVE EDAT      ZDAYNO                          S01119
0262 C                     EXSR ZDATE2
0263 C                     MOVE ZADATE    VDATA   7
     C*                                                                   S01119
     C**  CHECK IF FLOATING RATE HAS BEEN ENTERED FOR FRA/IRS EVENTS      S01119
     C*                                                                   S01119
     C           *IN11     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C           UBRTT     IFNE 0                                         S01119
     C                     TESTB'0'       UDNSI          35               S01119
     C                     ELSE                                           S01119
     C                     SETON                         35               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           TBRTT     IFNE 0                                         S01119
     C                     TESTB'0'       TDNSI          36               S01119
     C                     ELSE                                           S01119
     C                     SETON                         36               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**   CHECK FOR OUR FED FUNDS INDICATOR                              S01119
     C*                                                                   S01119
     C                     TESTB'2'       UDSTI          16               S01119
     C*                                                                   S01119
     C**   CHECK FOR THEIR FED FUNDS INDICATOR                            S01119
     C*                                                                   S01119
     C                     TESTB'2'       TDSTI          17               S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01157
0291 C**   FRA'S, CAPS AND COLLARS SHOWN UNDER PURCHASES WHEN 'OUR        S01157
0291 C**   BASE RATE TYPE' (UBRTT) EQUALS ZERO - OTHERWISE UNDER SALES.   S01157
0291 C**   FLOORS SHOWN UNDER PURCHASES WHEN 'OUR BASE RATE TYPE'         S01157
0291 C**   (UBRTT) IS NOT EQUAL TO ZERO - OTHERWISE UNDER SALES.          S01157
0290 C*                                                                   S01157
0292 C           DTYP      IFEQ 'FR'                       DEAL IS FRA    S01157
0293 C           UBRTT     ANDNE0                          AND SOLD.      S01157
0292 C           DTYP      OREQ 'RP'                       DEAL IS CAP    S01157
0293 C           UBRTT     ANDNE0                          AND SOLD       S01157
0292 C           DTYP      OREQ 'RR'                       DEAL IS COLLAR S01157
0293 C           UBRTT     ANDNE0                          AND SOLD       S01157
0290 C*                                                                   S01157
0292 C           DTYP      OREQ 'RF'                       DEAL IS FLOOR  S01157
0293 C           UBRTT     ANDEQ0                          AND FLOOR SOLD S01157
0294 C                     SETON                     56    OUTPUT IND.    S01157
     C*                                                                   S01157
     C* PREVENT OUR FEDS FUND INDICATOR BEING DISPLAYED                   S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN16                           S01157
     C*                                                                   S01157
     C* SET UP BUY/SELL INDICATOR FOR SOLD                                S01157
     C*                                                                   S01157
     C                     MOVE 'S'       BYSL    1                       S01157
     C                     MOVE '1'       *IN75                           S01157
     C*                                                                   S01157
0295 C                     END                                            S01157
     C*                                                                   S01157
     C* SET UP BUY/SELL INDICATOR FOR BOUGHT                              S01157
     C*                                                                   S01157
0292 C           DTYP      IFEQ 'FR'                       DEAL IS FRA,   S01157
0293 C           TBRTT     ANDNE0                          BOUGHT         S01157
0292 C           DTYP      OREQ 'RP'                       CAP OR COLLAR  S01157
0293 C           TBRTT     ANDNE0                          BOUGHT         S01157
0292 C           DTYP      OREQ 'RR'                                      S01157
0293 C           TBRTT     ANDNE0                          BOUGHT         S01157
0290 C*                                                                   S01157
0292 C           DTYP      OREQ 'RF'                       DEAL IS A FLOORS01157
0293 C           TBRTT     ANDEQ0                          FLOOR BOUGHT   S01157
     C*                                                                   S01157
     C* PREVENT THEIR FEDS FUND INDICATOR BEING DISPLAYED                 S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN17                           S01157
     C*                                                                   S01157
     C                     MOVE 'B'       BYSL    1                       S01157
     C                     MOVE '1'       *IN75                           S01157
0295 C                     END                                            S01157
0290 C*                                                                   S01157
     C****IF*'RL'*EVENT*CHECK*IF*OURS*OR*THEIR*DETAILS*TO*BE*USED   S01119S01157
     C**  IF RP, RF, RR EVENT CHECK IF OURS OR THEIR DETAILS TO BE USED   S01157
     C*                                                                   S01119
     C           UBRTT     COMP 0                    1212                 S01119
     C           TBRTT     COMP 0                    1515                 S01119
     C*                                                                   S01119
     C           *IN55     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C**  IF OUR DETAILS CHECK FOR FLOOR RATE                             S01119
     C*                                                                   S01119
     C           *IN12     IFEQ '1'                                       S01119
     C                     TESTB'4'       UDSTI          13               S01119
     C*                                                                   S01119
     C**  AND AVERAGE RATE METHOD                                         S01119
     C*                                                                   S01119
     C                     TESTB'3'       UDSTI          14               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF THEIR DETAILS CHECK FOR FLOOR RATE                           S01119
     C*                                                                   S01119
     C           *IN12     IFEQ '0'                                       S01119
     C                     TESTB'4'       TDSTI          13               S01119
     C*                                                                   S01119
     C**  AND AVERAGE RATE METHOD                                         S01119
     C*                                                                   S01119
     C                     TESTB'3'       TDSTI          14               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**    IF A FRA/IRS EVENT TYPE AND DEAL TYPE EQUAL 'RF'              S01157
     C**    OUTPUT FLOOR RATE INSTEAD OF CEILING RATE.                    S01157
     C*                                                                   S01157
     C                     SETOF                     10                   S01157
     C*                                                                   S01157
     C           *IN55     IFEQ '1'                                       S01157
     C           DTYP      ANDEQ'RF'                                      S01157
     C                     SETON                     10                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C*********************END                                      S01157LN0646
     C*                                                                   S01157
0264 C***********TRAIL     TAG                             ** TRAIL TAG **S01153
0265 C**N02******          GOTO END                                       S01153
0266 C***********                                                         S01153
0267 C*****COMPARE*TRAILER*CONTROLS WITH VALUES ACCUMULATED IN PROGRAM    S01119
0268 C*********************                                               S01119
0269 C*********************SETON                     42LR                 S01119
0270 C*********************                                               S01119
0271 C***********NORE******SUB  2         NORE                            S01119
0272 C***********RECRED****COMP NORE                 8080                 S01119
0273 C***********INT,1*****COMP HRWN                 8181                 S01119
0274 C**N81******DEC,1*****COMP HRDC                 8181                 S01119
0275 C***80****************                                               S01119
0276 C*R*81****************SETON                     U8                   S01119
0277 C***********HRWN******COMP 0                        19               S01119
0278 C***********INT,1*****COMP 0                        50               S01119
0279 C***********INT,2*****COMP 0                        51               S01119
0280 C*
0281 C           END       TAG                             ** END TAG **
0282 CL0 OF                SETON                     41
0283 CL1                   SETOF                     6061
     C*                                                                   S01119
0267 C*****COMPARE TRAILER CONTROLS WITH VALUES ACCUMULATED IN PROGRAM    S01153
     C*****AFTER*ALL DETAIL RECORDS HAVE BEEN READ              S01119    S01153
0268 C***********                                               S01119    S01153
     C*R*********          READ EVNTXZZ                  89     S01119    S01153
     CLR                   SETON                     42                   S01119
0270 C*                                                                   S01119
0271 C*R*********NORE      SUB  2         NORE                  S01119    S01153
0272 C*R*********RECRED    COMP NORE                 8080       S01119    S01153
0273 C*R*********INT,1     COMP HRWN                 8181       S01119    S01153
0274 C*RN81******DEC,1     COMP HRDC                 8181       S01119    S01153
0275 C*R*80******                                               S01119    S01153
0276 C*R*81******          SETON                     U8         S01119    S01153
     C***********                                               S01119    S01153
0277 C*R*********HRWN      COMP 0                        19     S01119    S01153
0278 CLR         INT,1     COMP 0                        50               S01119
0279 CLR         INT,2     COMP 0                        51               S01119
     C** ENSURE SPOOL FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   S01117
     C** TO. SWRIT IS INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       S01117
     C** FILE - IF IT IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    S01117
     C** THE FILE. UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     S01117
     C** AN UNITIALISED BINARY FIELD.                                     S01117
     C** ALSO REPORT 'NO DETAILS TO REPORT' IN AU FILE USING *IN25.       S01117
     CLR                   MOVE '0'       *IN25                           S01117
     CLR         SWRIT     IFNE 0                                         S01117
     CLR         SWRIT     ANDNE@BKBIN                                    S01117
     CLR                   MOVE '1'       *IN25                           S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C*  CALL ZSFILE FOR AU FILE.                                         S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0327 C*                                                                   E296
0327 C* CALL ACCESS PROG. FOR BANK DETAILS.(WHEN FILES EMPTY)             E296
     CLRN40                CALL 'AOBANKR0'                                E296
     C                     PARM '*MSG   ' @RTCD   7                       E296
     C                     PARM '*FIRST ' @OPTN   7                       E296
     C           SDBANK    PARM SDBANK    DSFDY                           E296
0327 C*                                                                   E296
     CLRN40      @RTCD     IFNE *BLANK                                    E296
     CLRN40                MOVEL'SDBANKPD'DBFILE 10        * * * * * * *  E296
     CLRN40                MOVEL'005'     DBASE   3        * DBERR 005 *  E296
     CLRN40                MOVEL@OPTN     DBOPTN  7        * * * * * * *  E296
0349 CLRN40                MOVEL@OPTN     DBKEY  29                       E296
0349 CLRN40                SETON                     U7U8                 E296
     CLRN40                EXSR *PSSR                                     E296
     CLR                   END                                            E296
     C*                                                                   E296
0284 C********************************************************************
0285 C*
0286 C           HASH      BEGSR
0287 C                     Z-ADDINT,X     ZZTOTI
0288 C                     Z-ADDDEC,X     ZZTOTD
0289 C                     EXSR GLZADD
0290 C                     Z-ADDZZTOTI    INT,X
0291 C                     Z-ADDZZTOTD    DEC,X
0292 C                     ENDSR
0293 C********************************************************************
0294 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0295 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0296 C*
0297 CSR         GLZADD    BEGSR                           *** GLZADD ****
0298 C*
0299 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0300 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0301 C*
0302 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0303 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0304 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0305 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0306 C*
0307 CSR                   EXSR GLZSUM
0308 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0309 C*
0310 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0311 C*                        GLZADD, GLZSUB, GLZCMP.
0312 C*          PARAMETERS PASSED -
0313 C*                     I/P ZZAMTI ZZAMTD
0314 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0315 C*
0316 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0317 C*
0318 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0319 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0320 CSR                   SETOF                     919293
0321 CSR                   SETOF                     949599
0322 C*
0323 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0324 CSR         ZZAMTI    COMP 0                      9293
0325 CSR 93      ZZAMTD    COMP 0                      9293
0326 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0327 C*
0328 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0329 CSR         ZZTOTI    COMP 0                      9193
0330 CSR 93      ZZTOTD    COMP 0                      9193
0331 C*
0332 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0333 CSR 93                Z-ADDZZAMTI    ZZTOTI
0334 CSR 93                Z-ADDZZAMTD    ZZTOTD
0335 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0336 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0337 CSR 91N92
0338 CORN91 92             GOTO ZZOFPS
0339 C*
0340 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0341 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0342 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0343 C*
0344 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0345 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0346 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0347 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0348 C*
0349 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0350 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0351 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0352 CSRN99                Z-ADDZZWK2     ZZTOTD
0353 CSRN99                Z-ADDZZWK3     ZZTOTI
0354 C*
0355 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0356 CSR 99                Z-ADD0         ZZAMT  153
0357 CSR                   GOTO ZZSEND
0358 C*
0359 C* THE 'SIGNS' ARE DIFFERENT
0360 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0361 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0362 C*
0363 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0364 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0365 C*
0366 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0367 C*
0368 CSR 91                Z-SUBZZTOTI    ZZTOTI
0369 CSR 91                Z-SUBZZTOTD    ZZTOTD
0370 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0371 C*
0372 CSR         ZZTOTI    COMP ZZAMTI               93  95
0373 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0374 C*
0375 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0376 CSR 95                Z-ADD0         ZZTOTI
0377 CSR 95                Z-ADD0         ZZTOTD
0378 CSR 95                GOTO ZZSEND
0379 C*
0380 C* IF ZZTOT GT. ZZAMT.
0381 CSR 93      ZZAMTD    COMP ZZTOTD               94
0382 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0383 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0384 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0385 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0386 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0387 C*
0388 C*
0389 C* IF ZZAMT GT. ZZTOT.
0390 CSRN93      ZZTOTD    COMP ZZAMTD               94
0391 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0392 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0393 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0394 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0395 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0396 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0397 C*
0398 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0399 CSR                   SETOF                     94
0400 CSR 93 91
0401 CORN93 92             SETON                     94
0402 CSR 94                Z-SUBZZTOTI    ZZTOTI
0403 CSR 94                Z-SUBZZTOTD    ZZTOTD
0404 C**
0405 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0406 CSR 92                Z-SUBZZAMTI    ZZAMTI
0407 CSR 92                Z-SUBZZAMTD    ZZAMTD
0408 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0409 C**
0410 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0411 CSR                   SETOF                     96
0412 CSR         ZZTOTD    COMP 0                        91
0413 CSR 91      ZZTOTI    COMP 0                      96
0414 CSR 96                MOVE '.000-'   ZZNEGD  5
0415 CSR                   ENDSR                             ** ENDSR **
0416 C********************************************************************
0417 C**
0418 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0419 C**
0420 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0421 C**
0422 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0423 C**
0424 C**   CLEAR DATE FIELDS.
0425 C                     Z-ADD0         ZDATE   60
0426 C                     MOVEL'       ' ZADATE  7
0427 C**
0428 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0429 C                     Z-ADDZDAYNO    ZDAYNO  50
0430 C**
0431 C**   DETERMINE YEAR NUMBER.
0432 C**
0433 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0434 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0435 C   99                GOTO ZDEND2
0436 C**
0437 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0438 C           ZDAYN1    DIV  1461      ZLYR    20
0439 C                     MVR            ZDAYN1           SAVE REMAINING
0440 C**                                                   DAYS
0441 C**   CALCULATE NUMBER OF REMAINING YEARS.
0442 C                     Z-ADD1         ZWRK2   20
0443 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0444 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0445 C  N90      ZWRK2     ADD  1         ZWRK2
0446 C  N90                GOTO ZDTAG1
0447 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0448 C**
0449 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0450 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0451 C**
0452 C**   CALCULATE ACTUAL YEAR NUMBER.
0453 C           ZLYR      MULT 4         ZWRK3   30
0454 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0455 C                     Z-ADDZWRK3     ZYEAR   20
0456 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0457 C**
0458 C**   DETERMINE MONTH NUMBER.
0459 C**
0460 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0461 C                     SETOF                     9293
0462 C   91      ZDAYN1    COMP 59                     9293
0463 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0464 C**
0465 C**   CALCULATE MONTH NUMBER.
0466 C                     Z-ADD2         ZWRK2
0467 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0468 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0469 C  N94      ZWRK2     ADD  1         ZWRK2
0470 C  N94                GOTO ZDTAG2
0471 C           ZWRK2     SUB  1         ZWRK2
0472 C**
0473 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0474 C**
0475 C**   DETERMINE DAY OF MONTH.
0476 C**
0477 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0478 C           ZDAYN1    ADD  1         ZDAYN1
0479 C**
0480 C**   CALCULATE DAY OF MONTH.
0481 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0482 C**
0483 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0484 C   93      ZDAY      ADD  1         ZDAY
0485 C**
0486 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0487 C  N98                MOVELZDAY      ZWRK4   40
0488 C   98                MOVE ZDAY      ZWRK4
0489 C  N98                MOVE ZMTH      ZWRK4
0490 C   98                MOVELZMTH      ZWRK4
0491 C                     MOVELZWRK4     ZDATE
0492 C                     MOVE ZYEAR     ZDATE
0493 C**
0494 C**   FORMAT ALPHA DATE, DDMMMYY.
0495 C           ZDAY      COMP 10                     95
0496 C                     MOVELZDAY      ZWRK5   5
0497 C   95                MOVEL' '       ZWRK5
0498 C                     MOVE ZMNM,ZMTH ZWRK5
0499 C                     MOVELZWRK5     ZADATE
0500 C                     MOVE ZYEAR     ZADATE
0501 C**
0502 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0503 C**
0504 C*****************************************************************   S01194
0505 C*****                                                       *****   S01194
0506 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD****S01194
0507 C*****                                                       *****   S01194
050  C*****      ZSYSTM    BEGSR                           *** ZSYSTM*****S01194
0509 C*****                                                       *****   S01194
0510 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.            *****   S01194
0511 C*****                MOVEL'01      'ZTABKY 12               *****   S01194
0512 C*****                MOVE '  10'    ZTABKY                  *****   S01194
0513 C*****                                                       *****   S01194
0514 C*****      ZTABKY    CHAINTABLE                99    ON NOT*THERE***S01194
0515 C**N99      RECI      COMP 'D'                  9999  ON, IS*DELETED*S01194
0516 C*****                                                       *****   S01194
0517 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.            *****   S01194
0518 C*****      DATF      COMP 'M'                      98MMDDYY,*98*ON**S01194
0519 C*****                                                       *****   S01194
0520 C*****                ENDSR                                  *****   S01194
0521 C*****                                                       *****   S01194
0522 C*****                                                       *****   S01194
0523 C*****************************************************************   S01194
0726 C*****************************************************************   S01194
1024 C*    ERROR DUMP SUBROUTINE.                                         S01194
1048 C*                                                                   S01194
1034 C           *PSSR     BEGSR                           ***  PSSR **   S01194
1020 C           @RUN      IFEQ *BLANK                                    S01194
1021 C                     MOVE 'Y'       @RUN    1                       S01194
1020 C                     DUMP                                           S01194
1021 C                     END                                            S01194
1022 C                     ENDSR                           *** *PSSR **   S01194
1048 C**                                                                  S01194
0726 C*****************************************************************   S01194
0524 C/EJECT
0525 O*PRINT  D  203   42                                                 S01124
0525 ODL0730P1D  203   42                                                 S01124
0526 O***********                        22 'REFERENCE DL0730'            S01117
     O                                   24 'REFERENCE DL0730P1'          S01117
0527 O*****                    TITL      89                       *****   S01194
0527 O                         BJURPT    89                               S01194
0528 O                                  104 'DATE'
0529 O*****                    RUNA     112                       *****   S01194
0529 O                         BJMRDT   112                               S01194
0530 O                                  122 'PAGE'
0531 O                         PAGE  Z  127
0532 O        D  1     42
     O                                   19 'CONSOLIDATED'                S01117
0533 O                                   72 'DEPOSITS BY DEAL SUB TYP'
0534 O                                   73 'E'
0535 O        D  2     42
0536 O                                   72 '------------------------'
0537 O                                   73 '-'
0538 O        D  1     42NLR
0539 O***********************************47 'DEAL   DEAL  VALUE'          CDL038
0540 O***********************************56 'MATURITY'                    CDL038
     O                                   40 'DEAL   DEAL'                 CDL038
     O                                   51 'VALUE'                       CDL038
     O                                   60 'MATURITY'                    CDL038
0541 O                                   82 'AMOUNT'
0542 O                                  126 'AMOUNT'
0543 O        D  0     42NLR
0544 O                                   12 'CUSTOMER'
0545 O***********************************47 'NUMBER  TYPE   DATE'         CDL038
0546 O***********************************64 'DATE   CCY F/F'              CDL038
     O                                   40 'NUMBER  TYPE'                CDL038
     O                                   51 'DATE '                       CDL038
     O                                   68 'DATE   CCY F/F'              CDL038
0547 O***********************************95 'TAKEN         RATE'          S01119
0548 O**********************************126 'CCY F/F           PLACED'    S01119
0547 O                                   98 'TAKEN            RATE'       S01119
0548 O                                  126 '  CCY F/F         PLACED'    S01119
0549 O        D 22     42NLR
0550 O       OR 22     60N42
0551 O                         DLST       2
     O                         CLAS       6                               CDL038
     O                         ASDSTN    37                               CDL038
     O                         TCCDSC    68                               CDL038
0552 O*****                    DSNM      33                       *****   S01194
0552 O*************************ASDSTN    33                       S01194  CDL038
0553 O        D  1     01 47
0554 O                         CUNR       6
0555 O                         CRNM      27
0556 O                         DLNO      34
0557 O                         DTYP      37
0558 O                                   38 '-'
0559 O                         DLST      40
     O                         CLAS      44                               CDL038
     O                 75      BYSL      45                               CDL038
     O                         VDATA     52                               CDL038
     O                       34MATDA     60                               CDL038
     O                   N20N34NOTD  3   56                               CDL038
     O                   N20N34          60 'DAY'                         CDL038
     O                    20 21          60 'AT CALL'                     CDL038
     O                       45ECCY      64                               CDL038
     O                   N56 11ECCY      64                               CDL038
     O                       57ECCY      64                               CDL038
     O                       45FFIN      66                               CDL038
     O                 16                66 'F'                           CDL038
     O*****************75******BYSL      41                        S01157 CDL038
0560 O*************************VDATA     48                               CDL038
0561 O***********************34MATDA     56                               CDL038
0562 O*******************N20N34NOTD  3   52                               CDL038
0563 O*******************N20N34          56 'DAY'                         CDL038
0564 O********************20*21          56 'AT CALL'                     CDL038
0566 O***********************45FFIN******63                               S01119
0567 O********************45*30EAMT**1***82                               S01119
0568 O********************45*31EAMT******84 '   ,   ,   , 0 . '           S01119
0569 O********************45*32EAMT******85 '  ,   ,   , 0 .  '           S01119
0570 O********************45*33EAMT******86 ' ,   ,   , 0 .   '           S01119
0571 O*************************EXRT*****101 '   0 .        -'             S01119
0572 O***********************22EXRT**Z**100                               S01119
0573 O***********************46ECCY*****105                               S01119
0574 O***********************46FFIN*****108                               S01119
0575 O********************46*30EAMT**1**126                               S01119
0576 O********************46*31EAMT*****128 '   ,   ,   , 0 . '           S01119
0577 O********************46*32EAMT*****129 '  ,   ,   , 0 .  '           S01119
0578 O********************46*33EAMT*****130 ' ,   ,   , 0 .   '           S01119
0565 O***********************45ECCY      60                               CDL038
     O***********************11ECCY      60                        S01119 S01157
     O*******************N56*11ECCY      60                        S01157 CDL038
     O***********************57ECCY      60                        100097 CDL038
0566 O***********************45FFIN      62                        S01119 CDL038
     O*****************16****            62 'F'                    S01119 CDL038
     O                    45 30EAMT  1   81                               S01119
0568 O                    45 31EAMT      83 '   ,   ,   , 0 . '           S01119
0569 O                    45 32EAMT      84 '  ,   ,   , 0 .  '           S01119
0570 O                    45 33EAMT      85 ' ,   ,   , 0 .   '           S01119
     O********************11 30EAMT  1   81                        S01119 S01157
0568 O********************11 31EAMT      83 '   ,   ,   , 0 . '    S01119 S01157
0569 O********************11 32EAMT      84 '  ,   ,   , 0 .  '    S01119 S01157
0570 O********************11 33EAMT      85 ' ,   ,   , 0 .   '    S01119 S01157
     O                N56 11 30EAMT  1   81                               S01157
0568 O                N56 11 31EAMT      83 '   ,   ,   , 0 . '           S01157
0569 O                N56 11 32EAMT      84 '  ,   ,   , 0 .  '           S01157
0570 O                N56 11 33EAMT      85 ' ,   ,   , 0 .   '           S01157
     O                    57 30ICAM  1   81                               100097
     O                    57 31ICAM      83 '   ,   ,   , 0 . '           100097
     O                    57 32ICAM      84 '  ,   ,   , 0 .  '           100097
     O                    57 33ICAM      85 ' ,   ,   , 0 .   '           100097
     O                 11N55 12UBRTT     88                               S01119
0571 O                      N11EXRT     103 '   0 .        -'             S01119
0572 O                   N11 22EXRT  Z  102                               S01119
     O                 11N55 35UEINR    102 '  0 .       -'               S01119
     O                       57ICIR     102 '  0 .       -'               100097
     O                       58ICIR     102 '  0 .       -'               100097
     O**************** 55      CLRAT    102 '  0 .       -'        S01119 S01157
     O                 55N10   CLRAT    102 '  0 .       -'               S01157
     O                 55 10   FLRAT    102 '  0 .       -'               S01157
0573 O                       46ECCY     107                               S01119
0573 O                       56ECCY     107                               S01157
     O                       58ECCY     107                               100097
0574 O                       46FFIN     109                               S01119
0574 O                    56 11FFIN     109                               S01157
0575 O                    46 30EAMT  1  127                               S01119
0576 O                    46 31EAMT     129 '   ,   ,   , 0 . '           S01119
0577 O                    46 32EAMT     130 '  ,   ,   , 0 .  '           S01119
0578 O                    46 33EAMT     131 ' ,   ,   , 0 .   '           S01119
0575 O                 56 11 30EAMT  1  127                               S01157
0576 O                 56 11 31EAMT     129 '   ,   ,   , 0 . '           S01157
0577 O                 56 11 32EAMT     130 '  ,   ,   , 0 .  '           S01157
0578 O                 56 11 33EAMT     131 ' ,   ,   , 0 .   '           S01157
     O                    58 30ICAM  1  127                               100097
     O                    58 31ICAM     129 '   ,   ,   , 0 . '           100097
     O                    58 32ICAM     130 '  ,   ,   , 0 .  '           100097
     O                    58 33ICAM     131 ' ,   ,   , 0 .   '           100097
0579 O********D**1*****01*47***                                           S01119
     O        D  1     01 47N55                                           S01119
0580 O                         CTWN      17
     O                 15      TBRTT     88                               S01119
     O                 36      TEINR    102 '  0 .       -'               S01119
     O                 54      OTHC     107                               S01119
     O                 17               109 'F'                           S01119
     O                 62 54   OTHA  1  127                               S01119
     O                 63 54   OTHA     129 '   ,   ,   , 0 . '           S01119
     O                 64 54   OTHA     130 '  ,   ,   , 0 .  '           S01119
     O                 65 54   OTHA     131 ' ,   ,   , 0 .   '           S01119
0579 O        D  1     01 47 55                                           S01119
0580 O                         CTWN      17                               S01119
     O                N12      TBRTT     88                               S01119
     O                 12      UBRTT     88                               S01119
     O                N12 36N14TEINR    102 '  0 .       -'               S01119
     O                 12 35N14UEINR    102 '  0 .       -'               S01119
     O                 14      AACRT    102 '  0 .       -'               S01119
0579 O        D  1     01 55 13                                           S01119
     O       AND      N10                                                 S01157
     O                         FLRAT    102 '  0 .       -'               S01119
0616 O        T 2      LR 25                                              S01117
0617 O                                   65 '***   END OF REPORT'         S01117
0618 O                                   71 '***'                         S01117
    0O*****   T   20   LRN48                                      *****   S01117
    0O*****                              59 '***   NO DETAILS TO '*****   S01117
    0O*****                              71 'REPORT   ***'        *****   S01117
0525 O********T  203   42 LR                                      S01119  S01117
     ODL0730AUT  203   LR                                                 S01117
0526 O***********                        22 'REFERENCE DL0730'    S01119  S01117
     O                                   24 'REFERENCE DL0730AU'          S01117
0527 O*****                    TITL      89                       S01119  S01194
0527 O                         BJURPT    89                               S01194
0528 O                                  104 'DATE'                        S01119
0529 O*****                    RUNA     112                       S01119  S01194
0529 O                         BJMRDT   112                               S01194
0530 O                                  122 'PAGE'                        S01119
0531 O                         PAGE1 Z  127                               S01119
0532 O********T  1     42 LR                                      S01119  S01117
     O        T  1     LR                                                 S01117
0533 O                                   72 'DEPOSITS BY DEAL SUB TYP'    S01119
0534 O                                   73 'E'                           S01119
0535 O********T  2     42 LR                                      S01119  S01117
     O        T  2     LR                                                 S01117
0536 O                                   72 '------------------------'    S01119
0537 O                                   73 '-'                           S01119
0581 O        T  236   LR
0582 O                                   18 'RUN CONTROLS'
0583 O        T  2     LR
0584 O                                   59 'NUMBER'
0585 O                                   81 'VALUE'
0586 O        T  2     LR
0587 O                                   26 'SORTED EVENTS FILE'
0588 O                                   40 'RECORDS INPUT'
0589 O                         RECRED3   59
0590 O                         INT,1 Z   78
0591 O                       50DEC,1 3   81
0592 O                      N50DEC,1     81
0593 O********T**2     LR                                                 S01153
0594 O***********                        26 'SORTED EVENTS FILE'          S01153
0595 O***********                        41 'CONTROL TOTALS'              S01153
0596 O***********              NORE  3   59                               S01153
0597 O***********              HRWN  Z   78                               S01153
0598 O***********            19HRDC  3   81                               S01153
0599 O***********           N19HRDC      81                               S01153
0600 O        T  3     LR
0601 O                                   30 'RECORDS LISTED IN THIS'
0602 O                                   37 'REPORT'
0603 O                         RECRIT3   59
0604 O                         INT,2 Z   78
0605 O                       51DEC,2 3   81
0606 O                      N51DEC,2     81
     O*                                                                   S01117
     O        T 3      LRNU7N25                                           S01117
0564 O                                   63 '***   NO DETAILS TO REPO'    S01117
0565 O                                   71 'RT   ***'                    S01117
     O*                                                                   S01117
0607 O********T**3     LR 80                                              S01153
0608 O*******OR***     LR 81                                              S01153
0609 O************                       71 '***   DIFFERENCE   ***'      S01153
0612 O********T  3     LR U7 U8                                   *****   S01117
0613 O********                           22 'REFERENCE DL0730'    *****   S01117
0614 O********                           62 'PRINT TERMINATED, '  *****   S01117
0615 O********                           80 'DATABASE IN ERROR'   *****   S01117
0616 O********T 2      LR                                         *****   S01117
0617 O********                           65 '***   END OF REPORT' *****   S01117
0618 O********                           71 '***'                 *****   S01117
     O*                                                                   S01117
     O** OUTPUT DATABASE ERROR IF NECESSARY                               S01117
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   49 'OPTION'                      S01117
     O                         DBOPTN    57                               S01117
     O                                   66 'KEY'                         S01117
     O                         DBKEY     96                               S01117
     O**
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
