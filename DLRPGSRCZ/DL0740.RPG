0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Exposure Against Limits Extract')             *
0002 F********************************************************************
0003 F*                                                                  *
     F*  Midas - Dealing Module
0005 F*                                                                  *
0006 F*      DL0740 - EVENTS FILE EXTRACT - 1                            *
0007 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                               *
      *  Last Amend No. CLE172             Date 01Oct20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE154             Date 06Aug12               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 218582             Date 06Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 236334             Date 06Jan06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CDL038             Date 10May05               *
      *                 CSW037A            Date 02May05               *
      *                 220738             Date 28AUG03               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 03Nov03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 190544             Date 15Feb02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
     F*                  163486              Date   14Oct99           *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                  125894              DATE   19NOV97              *
     F*                  097989              DATE.  12FEB97              *
     F*                  090982              DATE   17JUN96              *
     F*                  088141              DATE.  31JUL95
     F*                  090985              DATE.  07JUL95              *
     F*                  S01498              DATE.  10AUG94
     F*                  S01433              DATE.  15SEP93
     F*                  059349              DATE.  19AUG93
0009 F*                  S01393              DATE.  11AUG92              *
     F*                  S01360              DATE.  03MAR92              *
     F*                  BHF805              DATE.  15OCT90              *
     F*                  LN0603              DATE.  07AUG90              *
     F*                  LN0512              DATE.  26JUL90              *
     F*                  S01274              DATE.  14JUN90              *
     F*                  E200                DATE.  2APR90               *E116
     F*                  E191                DATE.  15DEC89              *E116
0009 F*                  E159                DATE.   6DEC89              *E116
0009 F*                  E116                DATE.   4DEC89              *E116
0009 F*                  S01194              DATE.  16/08/89             *S01194
0009 F*                  S01117              DATE.  16/08/89             *S01117
     F*                  S01196              DATE.  15/08/89
0009 F*                  S01157              DATE.  19/01/89             *S01157
0009 F*                  S01153              DATE.  17/08/88             *
0010 F*                  S01127              DATE.  17/06/87             *S01127
0009 F*                  S03220              DATE.  12/05/88             *
0009 F*                  E12072              DATE.  21/04/88             *
0009 F*                  S01119              DATE.  15/06/87             *
0009 F*                  E10777              DATE.  15/05/87             *
0003 F*                                                                  *
0002 F********************************************************************
     F*                                                                  *
      *  CLE172 - LIBOR Deregulation - Lending (Recompile)            *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  218582 - DLC0806 often fails due to FCOOB. Update 'F' and 'O'*
      *           specs due to change in length of NORE on PF/EVLXCEG.*
      *           Change also the length of work field ERECS to 7,0.  *
      *           Applied fix 213645.                                 *
      *           Applied fix annotated as 236334.                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  236334 - DLC0806 often fails due to FCOOB. Update 'F' and 'O'*
      *           specs due to change in length of NORE on PF/EVLXCEG.*
      *           Change also the length of work field ERECS to 7,0.  *
      *           Applied fix 213645.                                 *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  220738 - Dump if customer closed                             *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Correct parameters on program calls                 *
      *       190544 - Set all MM limit fields to zero.
     F*       163486 - Recompile due to changes in LVENTEL.              *
     F*       125894 - DEALSDG records should not show on DL0765 as      *
     F*                FRA's and IRS's do not represent MM exposure.     *
     F*       097989 - Initialise Child/Parent indicator.  Include any   *
     F*                customer with limits but no exposure.             *
     F*                Applied fix 093718 & removed fix 088141.          *
     F*       090982 - Limits report do not reflect lending limits       *
     F*                correctly. Complete 090985.                       *
     F*       088141 - Do not extract Child record without exposure.
     F*       090985 - Lending Limit not shown on DL0760P1.              *
     F*       S01498 - Portfolio Lending Upgrade to Release 10.
     F*                Ensure LB clients are printed when Portfolio
     F*                Lending is on and LB Clients are to be reported.
     F*       S01433 - Enhanced processing to include precious metals    *
     F*                and money market deals on the report              *
     F*              (NB. This function is to remain switchable until *
     F*              after Alpha-site testing, when it will become    *
     F*              mandatory. At this point DL0760A  will be        *
     F*              renamed to DL0760 and the old version discarded. *
     F*              Meanwhile version with SAR = DL0760A, without =  *
     F*              DL0760).                                         *
     F*      059349 - Exposure Against Limit report does not reflect     *
     F*               client limits when there is no exposure.           *
     F*               Problem was caused by fix E116.  Access the        *
     F*               limit file (PF/SDCLLMPD) by getting the SYSTEM     *
     F*               limits only as of fix E191.                        *
     F*      S01393 - Recompiled for Strategic Risk Management           *
     F*               Book Code added to PF/EVNTXED                      *
     F*      S01360 - MONEY MARKET CUSTOMER EXPOSURE BY COUNTRY REPORT   *
     F*      BHF805 - ACCESS LIMITS OF THE PARENT IF CUST HAS A PARENT   *
     F*      LN0603 - CUSTOMER PARENT NUMBER (PTNU) COULD BE EITHER      *
     F*               BLANKS OR ZERO - CHANGE COMPARISON                 *
     F*      LN0512 - REMOVE END OF REPORT FROM AU REPORT                *S01274
     F*      S01274 - REMOVE EVENTS PROCESSING FOR SECURITIES            *S01274
     F*             - TRADING I AND SYNDICATED LOANS.                    *S01274
0003 F*      E200   - REMOVE EXTRA UPDATE OF TRAILER                     *
     F*      E191   - USE SYSTEM LIMITS, SET UP CUNR                     *
     F*                                                                  *
     F*      E159   - CHANGE CONDITIONING OF CALL TO AOCUSTPD TO ALLOW   *
     F*               FOR PTNU TO BE ALPHA                               *
     F*      E116   - CHANGE LIMIT FILE USE TO SDCLLMPD                  *E116
     F*      S01117 - MULTI-BRANCHING CHANGES                            *S01117
     F*      S01194 - NEW STANDING DATA CHANGES                          *S01194
     F*      S01196 - REMOVAL OF LETTERS OF CREDIT PROCESSING            *S01196
     F*      S01157 - ADD FRA & IRS LIMIT FIELDS TO FILE D-LIMIT AND     *S01157
     F*               D-EVLXCEE.                                         *S01157
     F*      S01153 - CLOSE OF BUSINESS IMPROVEMENTS.                    *S01153
     F*      S03220 - FUNDS TRANSFER INTERFACE                           *S03220
     F*      E12072 - A LOAN SHOWS AN EXPOSURE IN THE EXPOSURE AGAINST   *E12072
     F*               LIMITS REPORT (DL0760) BEFORE THE VALUE DATE       *E12072
     F*               IS REACHED                                         *E12072
     F*     S01127  - LVENTM NOW ALSO BASED OVER FOEVED AND FOEVEZZ      *S01127
     F*               OF FUTURE AND OPTION. PERFORM HASH TOTAL AND       *S01127
     F*               RECORD NUMBER TOTAL. DOES NOT GENERATE ANY OUTPUT  *S01127
     F*               RECORDS.                                           *S01127
     F*      S01119 - ADD 4 NEW EVENT TYPES FOR FRA/IRS.                 *
0010 F*      E10777 - FILE CONTROLS OUT OF BALANCE ON REPORT.            *
0010 F*                                                                  *
0011 F********************************************************************
0012 F* ID F  C  H  L    FUNCTION OF INDICATORS
0013 F**01************EVENT HEADER                                        S01153
0014 F**02            EVENT DETAIL
0015 F* 02            EVENT DETAIL - DEALS
0016 F**03************EVENT TRAILER                                       S01153
0017 F* 04            LIMIT HEADER RECORD
0018 F* 05            LIMIT DETAIL RECORD
     F* 06            EVENT DETAIL - CUSTOMER LENDING
0019 F**07**********  CLINT DETAIL RECORD                                 S01194
0020 F**08            CVENT HEADER RECORD
0021 F**09            CVENT DETAIL RECORD
0022 F**09******      EVENT DETAIL - COMMERCIAL LOANS                     S01274
0023 F**10************CVENT TRAILER RECORD                                S01153
     F**11************EVENT TRAILER -  CUSTOMER LENDING                   S01153
     F**12*********** EVENT DETAIL - LETTERS OF CREDIT                    S01196
     F**13************EVENT TRAILER - LETTERS OF CREDIT                   S01153
     F**14******      EVENT DETAIL - SECURITIES TRADING                   S01274
     F**15************EVENT TRAILER - SECURITIES TRADING                  S01153
     F**16************EVENT DETAIL - FUNDS TRANSFER                S03220 S01153
     F**17************EVENT TRAILER - FUNDS TRANSFER               S03220 S01153
0024 F*    20         PARENT INDICATOR ZERO - NO PARENT RECORD O/P
0025 F*       25      HASH AMOUNT NEGATIVE
0026 F*       40      CONTROL 1ST CYCLE PROCESSING
0027 F******* 41      CHAIN FAIL ON TABLE FOR ICDR2                       S01194
0028 F*       42      EXTRACT THIS DETAIL RECORD.
0029 F********43******EVENT FILE OUT OF BALANCE                           S01153
0030 F********44******CVENT FILE OUT OF BALANCE                           S01153
0031 F*       45      LIMIT FILE OUT OF BALANCE
0022 F**82************EVNTM DETAIL - FO RECORD                     S01127 S01153
0023 F**83************EVNTM TRAILER- FO RECORD                     S01127 S01153
     F* 90      SAR S01433 INSTALLED                                      090985
0032 F*         U7+U8 DATABASE ERROR
     F*                                                               *
     F*****************************************************************
0033 F*VNTM***IP**E           K        DISK                               S01153
0034 F***LIMIT   IS  F      96  6AI     2 DISK                            E116
0035 F***CLINT   IF  F     256  7AI     2 DISK                            S01194
0033 FEVNTML5 IP  E           K        DISK                               S01153
     FSDCLLML2IS  E           K        DISK                               059349
0036 F***TABLE   IF  F      96 12AI     2 DISK                            S01194
0037 FEVLXCEC O   F     320            DISK
0037 F***EVLXCED O   F     320            DISK                                                CGL029
0037 F*EVLXCED*O***F*****336************DISK                                           CGL029 CDL038
     FEVLXCED O   F     340            DISK                                                   CDL038
     F*VLXCEE*O** F     320            DISK                               S01433
0037 FEVLXCEE O   F     350            DISK                               S01433
0037 F*EVLXCEG*O***F*****320************DISK***************************                       236334
     FEVLXCEG O   F     322            DISK                                                   236334
     F***EVLXCBH O   F     320            DISK                           U2  S01360    S01360 CGL029
     F*EVLXCBH*O***F*****336************DISK                           U2              CGL029 CDL038
     FEVLXCBH O   F     340            DISK                           U2                      CDL038
     FEVLXCBE O   F     322            DISK                           U2  S01360
     FSDCLLML0IF  E           K        DISK                               097989
     FEVLXCL0 IF  E           K        DISK                               097989
     F            EVLXCEEF                          KRENAMEEVLXCEL0       097989
0038 F*PRINT  O   F     132            PRINTER                            S01124
0038 F***DL0740P1O   F     132            PRINTER                   S01124SO1117
0038 FDL0740AUO   F     132            PRINTER                            S01117
0039 E********************************************************************
     E                    CPY@    1   1 80                                S01194
0040 E                    INT         2 15 0             HASH TOTALS
0041 E                    DEC         2  3 0             HASH TOTALS
0042 E********************************************************************
0043 I*****
0044 I*****EVENTS*FILE*-*HEADER RECORD.**********                         S01153
0045 I*****
0046 I*VNTXECF****01                                                      S01153
0050 I*
0053 IEVNTXEDF    02
0051 I*    EVENTS FILE - DETAIL RECORD FOR DEALS
0052 I*
0082 I*****                                         CPAR            20    S01194
0082 I*****                                         PTNU            20    E191
0103 I*
0106 I*****CEVNXCCF    09                                                 S01274
0104 I*****CVENT*- COMMERCIAL LOANS EVENTS FILE            - DETAIL       S01274
0105 I*    EVENTS FILE - DETAIL RECORD - COMMERCIAL LOANS
0153 I*
     ILVENTELF    06
     I*    CUSTOMER LENDING EVENTS
     I              DFCE                            LCEQ
     I              ECDP                            DEC1
     I              CDOM                            CLOC
     I              FACT                            FTYP
     I              FCNO                            FSEQ
     I******                                                              S01196
     I******LETTERS OF CREDIT EVENTS - DETAIL                             S01196
     I******                                                              S01196
     I****BVNTXEDF    12                                                  S01196
     I*
     I*****STEVEABF    14                                                 S01274
     I*****SECURITIES TRADING EVENTS - DETAIL                             S01274
     I**********                                                          S01274
     I**********    OAME                            OTHA                  S01274
     I**********    DNEE                            LCEQ                  S01274
     I*                                                                   S03220
     I*****FUNDS*TRANSFER*EVENTS*-*DETAIL                          S03220 S01153
     I*****                                                               S03220
     I*FPVNTDDF****16                                              S03220 S01153
     I*****
0154 I*****EVENTS*FILE*-*TRAILER RECORD.*****                             S01153
0155 I*****
0156 I*VNTXZZF****03                                                      S01153
0168 I*****
0169 I*****CVENT*-*COMMERCIAL*LOANS*EVENTS*FILE************- TRAILER      S01153
0170 I*****
0171 I*EVNXZZF****10                                                      S01153
0172 I*****
     I*VENTZZF****11                                                      S01153
     I*****
     I*****LETTERS*OF*CREDIT*EVENTS*-*TRAILER***************              S01153
     I*****
     I*VNTXEZF****13                                                      S01153
     I*****
     I*****SECURITIES*TRADING*EVENTS*-*TRAILER****                        S01153
     I*****
     I*TEVEFCF****15                                                      S01153
     I***********   HSTA                            HRWN                  S01153
     I***********   HSTB                            HRDC                  S01153
0173 I*****
     I*****FUNDS*TRANSFER*EVENTS*-*TRAILER                         S03220 S01153
     I*****                                                               S03220
     I*FPVNTZZF****17                                              S03220 S01153
     I**************NORE1                           NORE           S03220 S01153
     I*****                                                               S01127
     I*****EVNTM*FILE*-*FO*DETAIL*RECORD                           S01127 S01153
     I*FOEVEDF*****82                                              S01127 S01153
     I*****                                                               S01127
     I*****EVNTM*FILE*-*FO*TRAILER                                 S01127 S01153
     I*FOEVEZZF****83                                              S01127 S01153
     I*****                                                               S03220
0175 I*                                                                   S01194
0176 I**LIMIT   NS  04   1 CH                                             E116
0174 I**   CUSTOMER LIMITS FILE - HEADER RECORD.                          E116
0177 I*****                                   1   1 RECI                  E116
0178 I*****                                   2   70CNUM                  E116
0179 I*****                               P   8  100NOREL                 E116
0180 I*****                               P  11  130FLSZ                  E116
0181 I*****                               P  14  160NLRBL                 E116
0182 I*****                               P  17  190NINSL                 E116
0183 I*****                               P  20  220NAMDL                 E116
0184 I*****                               P  23  250NDELL                 E116
0185 I*****                               P  26  280LNLRA                 E116
0186 I*****                               P  90  920LCD                   E116
0187 I*****                                  93  93 CHTP                  E116
0188 I*****                               P  94  960TNLU                  E116
0189 I*                                                                   E116
0191 I*                                                                   E116
0192 I**LIMIT   NS  05   1 CD                                             E116
0190 I*    CUSTOMER LIMITS FILE - DETAIL RECORD.                          E116
0193 I*****                                   1   1 RECI                  E116
0194 I*****                                   2   70CNUM                  E116
0195 I*****                                   8  100FLTY                  E116
0196 I*****                               P  11  150FLAM                  E116
0197 I*****                               P  16  180FLED                  E116
0198 I*****                               P  19  210FLVD                  E116
0199 I*****                                  22  22 FLRF                  E116
0200 I*****                               P  23  270RLAM                  E116
0201 I*****                                  28  300LLTY                  E116
0202 I*****                               P  31  350LLAM                  E116
0203 I*****                               P  36  380LLED                  E116
0204 I*****                               P  39  410LLRD                  E116
0205 I*****                                  42  42 LLRF                  E116
0206 I*****                                  43  43 LLSE                  E116
     I*****                               P  44  480FRAM            S01157E116
     I*****                               P  49  510FRED            S01157E116
     I*****                               P  52  540FRRD            S01157E116
     I*****                                  55  55 FRRF            S01157E116
     I*****                               P  56  600IRAM            S01157E116
     I*****                               P  61  630IRED            S01157E116
     I*****                               P  64  660IRRD            S01157E116
     I*****                                  67  67 IRRF            S01157E116
0207 I*****                               P  90  920LCD                   E116
0208 I*****                                  93  93 CHTP                  E116
0209 I*****                               P  94  960TNLU                  E116
0210 I*CATCHALL                                                           E116
0211 I**LIMIT   NS                                                        E116
0212 I*****                                                               E116
0213 I*****                                                               S01194
0214 I*****CLIENT FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0215 I*****                                                               S01194
0216 I****CLINT   NS  07   1 CD   8 CA                                    S01194
0217 I*****                                        1   1 RECI             S01194
0218 I*****                                        2   70CNUM             S01194
0219 I*****                                   8   8 RCDT                  S01194
0220 I*****                                   9  28 CRNM                  S01194
0221 I*****                                  29  38 CTWN                  S01194
0222 I*****                                  39  48 CSNM                  S01194
0223 I*****                                  49  56 CASK                  S01194
0224 I*****                                  57  68 TELX                  S01194
0225 I*****                                  69  80 CSID                  S01194
0226 I*****                                  81  82 ACOC                  S01194
0227 I*****                                  83  83 CBSI                  S01194
0228 I*****                                  84  85 CCTZ                  S01194
0229 I*****                                  86  87 CLOC                  S01194
0230 I*****                                  88  930CPAR            20    S01194
0231 I*****                                  94  960BRCD                  S01194
0232 I*****                                  97  980LINS                  S01194
0233 I*****                                  99 1010LIND                  S01194
0234 I*****                               P 102 1040DASU                  S01194
0235 I*****                               P 105 1070CDIC                  S01194
0236 I*****                               P 108 1100DADE                  S01194
0237 I*****                                 111 111 CMIN                  S01194
0238 I*****                                 112 112 CTYP                  S01194
0239 I*****                                 113 124 TELF                  S01194
0240 I*****                                 125 133 CHID                  S01194
0241 I*****                                 134 136 CHAB                  S01194
0242 I*****                               P 250 2520LCD                   S01194
0243 I*****                                 253 253 CHTP                  S01194
0244 I*****                               P 254 2560TNLU                  S01194
0245 I*****CATCHALL                                                       S01194
0246 I*****   NS                                                          S01194
0247 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0248 I*****                                                               S01194
0249 I****TABLE   NS       2 C0   3 C1  12 C1                             S01194
0250 I*****  AND      13 C0                                               S01194
0251 I*****                                   1   1 RECI                  S01194
0252 I*****                                   2   30RECT                  S01194
0253 I*****                                  12  130RCDE                  S01194
0254 I*****                                  14  66 TITL                  S01194
0255 I*****                                  67  67 DATF                  S01194
0256 I*****                                  68  700DFBR                  S01194
0257 I*****                                  74  74 MODI1                 S01194
0258 I*****                                  75  75 MODI2                 S01194
0259 I*****                                  76  76 MODI3                 S01194
0260 I*****                               P  77  790RUND                  S01194
0261 I*****                                  80  86 RUNA                  S01194
0262 I*****                                  87  870SFLG                  S01194
0263 I*****                               P  90  920LCD                   S01194
0264 I*****                                  93  93 CHTP                  S01194
0265 I*****                               P  94  960TNLU                  S01194
0266 I*****                                                               S01194
0267 I*****                                                               S01194
0268 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0269 I*****                                                               S01194
0270 I****TABLE   NS       1 CD   2 C0   3 C1                             S01194
0271 I*****  AND      12 C1  13 C1                                        S01194
0272 I*****                                   1   1 RECI                  S01194
0273 I*****                                   2   30RECT                  S01194
0274 I*****                                  12  130RCDE                  S01194
0275 I*****                                  14  16 BCCY                  S01194
0276 I*****                                  17  19 BCYL                  S01194
0277 I*****                                  20  22 HOCY                  S01194
0278 I*****                                  23  280HEAD                  S01194
0279 I*****                               P  29  310APDA                  S01194
0280 I*****                                  35  35 APFQ                  S01194
0281 I*****                               P  36  380LOGS                  S01194
0282 I*****                                  39  40 CUZR                  S01194
0283 I*****                               P  41  430DNWD                  S01194
0284 I*****                                  44  460BVLP                  S01194
0285 I*****                                  47  49 LOCY                  S01194
0286 I*****                                  50  510FDAY                  S01194
0287 I*****                                  86  86 ISAV                  S01194
0288 I*****                               P  87  890LLOG                  S01194
0289 I*****                               P  90  920LCD                   S01194
0290 I*****                                  93  93 CHTP                  S01194
0291 I*****                               P  94  960TNLU                  S01194
0292 I*****                                                               S01194
0293 I*****   NS                                                          S01194
     I*                                                                   059349
     I**  CUSTOMER LIMITS FILE                                            059349
     I@CLLMIT     12                                                      059349
     I*                                                                   059349
     ILOT1        DS                            159
0107 I                                        1   1 RECI
0108 I                                        2   70DLNO
0109 I***********                             8  130CNUM                  E191
     I                                        8  13 CUNR                  E191
0110 I                                       14  17 ETYP
     I                                       14  15 ETYPA                 S01360
0111 I                                    P  18  200EDAT
0112 I                                    P  21  270EAMT
0113 I                                       28  30 ECCY
0114 I                                       31  320ECSS
0115 I                                       33  34 DTYP
0116 I                                       35  36 DLST
0117 I*****                                  37  390BRCD                  S01117
0117 I                                       37  39 BRCA                  S01117
0118 I                                    P  40  468EXRT
0119 I                                       47  47 NGII
0120 I                                       48  500NOTD
0121 I                                    P  51  530OTHD
0122 I                                    P  54  600OTHA
0123 I                                       61  63 OTHC
0124 I                                    P  64  700DBCE
0125 I                                    P  71  770BCEQ
0126 I                                    P  78  848DBCR
0127 I                                    P  85  910LCEQ
0128 I                                       92  930SETP
0129 I**********                             94 105 OSAC                                      CGL029
0129 I                                       94  95 OSAC1                                     CGL029
0129 I                                       96 105 QQOSA2                                    CGL029
0130 I                                      106 115 TSEN
0131 I                                      119 119 FIPI
0132 I                                      120 120 INCI
0133 I                                      121 121 FCTI
0134 I                                      122 122 RLVI
     I                                      123 128 PTNU                  E191
0135 I***********                           123 1280CPAR                  E191
0136 I                                      129 1290PARI
0137 I                                      130 149 CRNM
0138 I                                      150 159 CTWN
     I***LOT2**      DS                            161                                        CGL029
     I*LOT2********DS****************************177                                   CGL029 CDL038
     ILOT2        DS                            181                                           CDL038
0139 I                                        1   8 CASK
0140 I                                        9  28 PRNM
0141 I                                       29  38 PTWN
0142 I                                       39  46 PASK
0143 I                                       47  48 CCTZ
0144 I                                       49  50 CLOC
0145 I                                       51  52 REGC
0146 I                                       53  550DASN
0147 I                                    P  56  580FFVD
0148 I                                       59  59 FFIN
0149 I                                       60  620FACT
0150 I                                       63  640FCNO
0151 I                                       65  74 FACO
0152 I                                       75 109 SPI
0152 I**********                            110 1150CPCN                                      CSD027
0152 I                                      110 115 CPCN                                      CSD027
0153 I                                      162 177 OSAC2                                     CGL029
     I                                      178 181 CLAS                                      CDL038
     I*                                                             E116  E191
     I*@KEY******* DS                                               E116  E191
     I********                                1   6 CUSTNO          E116  E191
     I********                                7   7 LEVEL           E116  E191
     I********                                8  10 BRNCH           E116  E191
     I*
     I@BANK     E DSSDBANKPD                                              S01194
     I** DUMMY RECORD FORMAT FOR BANK DETAILS                             S01194
     I*                                                                   E116
     I@CLLM     E DSSDCLLMPD                                              E116
     I** DUMMY RECORD FORMAT FOR CUSTOMER LIMITS DETAILS                  E116
     I*                                                                   S01194
     I@CUST     E DSSDCUSTPD                                              S01194
     I** DUMMY RECORD FORMAT FOR CUSTOMER DETAILS                         S01194
     I*                                                                   S01194
     I@DEAL     E DSSDDEALPD                                              S01194
     I** DUMMY RECORD FORMAT FOR DEALING DATA DETAILS                     S01194
     I*
     I@MMOD     E DSSDMMODPD                                              S01498
     I** Dummy record format for Module details                           S01498
     I*                                                                   S01498
     I@LOMB     E DSSDLOMBPD                                              S01498
     I** Dummy record format for Portfolio Lending ICD.                   S01498
     I*                                                                   S01498
     I@LBCS     E DSSDLBCSPD                                              S01498
     I** Dummy record format for Portfolio Lending Customer File          S01498
     I*                                                                   S01498
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I**
     IDSLDY     E DSDSLDY                                                 220738
     I*  THIRD DS FOR ACCESS PROGRAMS, VERY LONG DATA STRUCTURE           220738
      *
0296 C*
0297 C**   FIRST CYCLE PROCESSING - GET ICDR 1 & 2
0298 C   40                GOTO DETAIL
     C                     MOVEACPY@      BIS@   80                       E116
     C*********            MOVE *BLANKS   LMTCUN  6                       E191
0299 C                     SETON                         40
0300 C*****                EXSR ZSYSTM                                    S01194
0301 C***99                SETON                     U7U8LR               S01194
0302 C*****                MOVE '1'       ZTABKY                          S01194
0303 C*****      ZTABKY    CHAINTABLE                41                   S01194
0304 C***41                SETON                     U7U8LR               S01194
0305 C*****                GOTO END                                       S01194
     C*                                                                   S01194
     C**                                                                  090985
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED     090985
     C**                                                                  090985
     C                     SETOF                         90               090985
     C                     CALL 'AOSARDR0'                                090985
     C                     PARM '       ' @RTCD   7                       090985
     C                     PARM '*VERIFY' @OPTN   7                       090985
     C                     PARM 'S01433'  @SARD   6                       090985
     C           @RTCD     IFEQ *BLANK                                    090985
     C                     SETON                         90               090985
     C                     END                                            090985
     C*                                                                   090985
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10         ************* S01194
     C                     MOVEL'01'      DBASE   3         *DBERROR 001* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0757 C*
     C** CALL ACCESS PROGRAM FOR DEALING DATA DETAILS                     S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*FIRST  '@OPTN                           S01194
     C********** @DEAL     PARM @DEAL     DSFDY                           S01194              CGL029
     C           @DEAL     PARM @DEAL     DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDEALPD'DBFILE            ************* S01194
     C                     MOVEL'02'      DBASE             *DBERROR 002* S01194
     C                     MOVEL@OPTN     DBOPTN            ************* S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   S01498
      ** Call Access Program for Module Details                           S01498
     C                     CALL 'AOMMODR0'                                S01498
     C                     PARM '*MSG    '@RTCD   7                       S01498
     C                     PARM '*FIRST  '@OPTN   7                       S01498
     C           @MMOD     PARM @MMOD     DSFDY                           S01498
      *                                                                   S01498
     C           @RTCD     IFNE *BLANK                                    S01498
     C                     MOVEL'SDMMODPD'DBFILE 10         ************* S01498
     C                     MOVEL'08'      DBASE   3         *DBERROR 008* S01498
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01498
     C                     SETON                     U7U8LR               S01498
     C                     EXSR *PSSR                                     S01498
     C                     GOTO END                                       S01498
     C                     END                                            S01498
      *                                                                   S01498
      ** Call Access Program for Portfolio Lending ICD.                   S01498
     C           BGLMCR    IFEQ 'Y'                                       S01498
     C                     CALL 'AOLOMBR0'                                S01498
     C                     PARM '*MSG    '@RTCD   7                       S01498
     C                     PARM '*FIRST  '@OPTN   7                       S01498
     C           @LOMB     PARM @LOMB     DSFDY                           S01498
      *                                                                   S01498
     C           @RTCD     IFNE *BLANK                                    S01498
     C                     MOVEL'SDLOMBPD'DBFILE 10         ************* S01498
     C                     MOVEL'09'      DBASE   3         *DBERROR 009* S01498
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01498
     C                     SETON                     U7U8LR               S01498
     C                     EXSR *PSSR                                     S01498
     C                     GOTO END                                       S01498
     C                     END                                            S01498
     C                     END                                            S01498
      *                                                                   S01498
0306 C*****SET UP KEY FOR CLINT FILE                                      S01194
0307 C*****                MOVE 'A'       CLIKEY  7                       S01194
0308 C*
0309 C                     Z-ADD0         ZERO5   50
0310 C*
0311 C*
0312 C*    INITIALISE THE NUMBER OF RECORDS IN THE EXTRACT
0313 C*    FILE EVLXC
0314 C**********           Z-ADD2         ERECS   50                                          236334
0314 C                     Z-ADD2         ERECS   70                                          236334
0315 C           DETAIL    TAG                             **  DETAIL  **
0316 C*
0317 C********************************************************************
0318 C*
0319 C*
0320 C*    KEEP A TALLY OF THE RECORDS READ
0321 C*****DEALING*FILE
0322 C*     EVENTS FILE
0323 C***01******                                                         S01153
0324 C*R*02******                                                         S01153
     C*R*06******                                                         S01153
     C*R*11******                                                         S01153
0325 C*R*03******                                                         S01153
0324 C*R*10******                                                         S01153
0324 C***02******                                                  S01153 S01274
     C*****OR*06*                                                  S01153 S01274
0324 C*R*82******                                                  S01127 S01153
0326 C*****OR*09*     DRECS     ADD  1         DRECS   50                 S01274
0324 C***12******                                                         S01153
0324 C***12****  DRECS     ADD  1         DRECS                    S01153 S01196
0324 C*R*13******DRECS     ADD  1         DRECS                           S01153
     C***14******                                                         S01153
     C***14******DRECS     ADD  1         DRECS                    S01153 S01274
     C*R*15******DRECS     ADD  1         DRECS                           S01153
     C***16******                                                  S03220 S01153
     C*R*17******DRECS     ADD  1         DRECS                    S03220 S01153
      *                                                                   CDL038
     C   06                MOVE *BLANK    CLAS                            CDL038
      *                                                                   S01274
      ** Increment the count of the number of Dealing or Customer         S01274
      ** Lending event records read.                                      S01274
      *                                                                   S01274
     C           *IN02     IFEQ '1'                                       S01274
     C           *IN06     OREQ '1'                                       S01274
     C*                                                                   S01274
     C           DRECS     ADD  1         DRECS   50                      S01274
     C                     END                                            S01274
      *                                                                   S01498
      ** If Portfolio Lending is switched on, if a LB customer            S01498
      ** is selected for extraction ignore it when the LB setup           S01498
      ** is to, not include LB customers for DL Exposure reports.         S01498
      *                                                                   S01498
     C           BGLMCR    IFEQ 'Y'                                       S01498
     C           LBLCDL    ANDEQ'N'                                       S01498
      *                                                                   S01498
      ** Call Access Program to determine if a LB Customer.               S01498
     C                     CALL 'AOLBCSR0'                                S01498
     C                     PARM '*MSG    '@RTCD                           S01498
     C                     PARM '*KEY    '@OPTN                           S01498
     C                     PARM CUNR      @AENB  10                       S01498
     C*********            PARM *BLANKS   @KYST   7                       S01498              222373
     C           @LBCS     PARM @LBCS     DSSDY                           S01498
     C*                                                                   S01498
     C           @RTCD     IFNE *BLANK                                    S01498
     C           @RTCD     ANDNE'*NRF'                                    S01498
     C                     MOVEL'SDLBCSPD'DBFILE            ************* S01498
     C                     MOVEL'10'      DBASE             *DBERROR 010* S01498
     C                     MOVEL@OPTN     DBOPTN            ************* S01498
     C                     MOVELCUNR      DBKEY  29                       S01498
     C                     SETON                     U7U8LR               S01498
     C                     EXSR *PSSR                                     S01498
     C                     END                                            S01498
      *                                                                   S01498
      ** Customer is a LB customer - ignore.                              S01498
     C           @RTCD     IFEQ *BLANKS                                   S01498
     C                     MOVE *OFF      *IN42                           S01498
     C                     GOTO END                                       S01498
     C                     END                                            S01498
     C                     END                                            S01498
0327 C*
0328 C*
0329 C**   COMMERCIAL LOANS FILE
0330 C***08********
0331 C*R 09********
0332 C*    ********
     C******                                                              E200
     C***INCLUDE EXISTING EVENTS IN NEW TOTAL RECORD (NOT EVNTXEC)        E200
     C******     RECI      IFNE 'A'                                   E191E200
     C******     ERECS     ADD  1         ERECS                       E191E200
     C******               MOVE 2         X                           E191E200
0379 C******     EAMT      DIV  1000      ZZAMT        25                 E200
0380 C***25*               Z-SUBZZAMT     ZZAMT                           E200
     C******               EXSR HASH                                  E191E200
     C******               END                                        E191E200
0333 C*
0334 C*    LIMITS FILE
      *  EXPOSURE REPORTS DL0760/780/800 REPORT ONLY SYSTEM EXPOSURE      E191
      *  AGAINST SYSTEM LIMITS                                            E191
      *                                                                   E191
     C*******    CUNR      COMP LMTCUN               0505            E116 E191
     C*******    *IN05     IFEQ '1'                                  E116 E191
     C           CUNR      IFNE LMTCUN                               E116 E191
     C                     SETON                     05                   E191
     C********** *IN09     IFEQ '1'                                  E116 S01274
     C**********           MOVE BWCN      CUSTNO  6                  E116 S01274
     C**********           ELSE                                      E116 S01274
     C**********           MOVE CUNR      CUSTNO                     E116 S01274
     C**********           END                                       E116 S01274
     C*                                                                   BHF805
     C* IF CUST HAS A PARENT OBTAIN LIMITS FOR THAT PARENT, OTHERWISE     BHF805
     C*   USE CUSTNO TO OBTAIN LIMITS.                                    BHF805
     C*                                                                   BHF805
     C           PTNU      IFNE *BLANKS                                   BHF805
     C           PTNU      ANDNE'000000'                                  BHF805
     C/COPY WNCPYSRC,DL0740C003
     C                     MOVE PTNU      CUSTNO                          BHF805
     C                     ELSE                                           BHF805
     C                     MOVE CUNR      CUSTNO  6                       S01274
     C                     END                                            BHF805
     C*                                                                   S01274
     C********   *IN09     IFEQ '1'                                 E116  E191
     C********   *IN14     OREQ '1'                                 E116  E191
     C********             MOVE BRCA      BRNCH                     E116  E191
     C********             ELSE                                     E116  E191
     C********             MOVE EBRC      BRNCH                     E116  E191
     C********             END                                      E116  E191
     C********             MOVE 'B'       LEVEL                     E116  E191
     C                     CALL 'AOCLLMR0'                                E116
     C                     PARM *BLANKS   @RTCD                           E116
     C                     PARM '*KEY   ' @OPTN                           E116
     C                     PARM CUSTNO    @KEY1   6                       E116
     C                     PARM 'S'       @KEY2   1                       E191
     C                     PARM 'SYS'     @KEY3   3                       E191
     C***********          PARM *BLANKS   @KEY3   3                       E191
     C********             PARM LEVEL     @KEY2   1                 E116
     C********             PARM BRNCH     @KEY3   3                 E116
     C           @CLLM     PARM @CLLM     DSFDY                           S01194
     C*                                                                   E116
     C** IF NO RECORD FOUND SET UP ZERO RECORD                            E116
     C           @RTCD     IFNE *BLANK                                    E116
     C                     MOVE *BLANKS   @CLLM
     C                     Z-ADD0         DZFLAM
     C                     Z-ADD0         DZFLED
     C                     Z-ADD0         DZFLRD
     C                     Z-ADD0         DZMDDR
     C                     Z-ADD0         DZLLAM                          S01433
     C                     Z-ADD0         DZLLED                          S01433
     C                     Z-ADD0         DZLLRD                          S01433
     C                     Z-ADD0         DZFRLA
     C                     Z-ADD0         DZFRED
     C                     Z-ADD0         DZFRRD
     C                     Z-ADD0         DZIRLM
     C                     Z-ADD0         DZIRED
     C                     Z-ADD0         DZIRDT
     C                     Z-ADD0         DZFXFA                          S01433
     C                     Z-ADD0         DZPFAM                          S01433
     C                     Z-ADD0         DZPSAM                          S01433
     C                     Z-ADD0         DZPLED                          S01433
     C                     Z-ADD0         DZPLVD                          S01433
     C                     Z-ADD0         DZMMAM                                              190544
     C                     Z-ADD0         DZMMED                                              190544
     C                     Z-ADD0         DZMMRD                                              190544
     C********             MOVEL'SDCLLMPD'DBFILE            ************* E116
     C********             MOVEL'05'      DBASE             *DBERROR 005* E116
     C********             MOVEL@OPTN     DBOPTN            ************* E116
     C********             MOVELCUSTNO    DBKEY  29                       E191
     C********             MOVE 'S'       DBKEY                           E191
     C********             MOVEL@KEY      DBKEY  29                  E116 E191
     C********             SETON                     U7U8LR               E116
     C********             EXSR *PSSR                                     E116
     C                     END                                            E116
0420 C*                                                                   E116
0421 C*    OBTAIN CUSTOMER DETAILS                                        E116
     C** CALL ACCESS PROGRAM FOR CUSTOMER DETAILS                         E116
     C******               CALL 'AOCUSTR0'                                220738
     C                     CALL 'AOCUSTR1'                                220738
     C                     PARM '*MSG    '@RTCD                           E116
     C                     PARM '*KEY    '@OPTN                           E116
     C                     PARM CUSTNO    @AENB  10                       E116
     C                     PARM *BLANKS   @KYST   7                       E116
     C******     @CUST     PARM @CUST     DSSDY                    S01194 220738
     C           @CUST     PARM @CUST     DSLDY                           220738
     C*                                                                   E116
     C           @RTCD     IFNE *BLANK                                    E116
     C           BBCLST    ANDNE'Y'                                       220738
     C                     MOVEL'SDCUSTPD'DBFILE            ************* E116
     C                     MOVEL'03'      DBASE             *DBERROR 003* E116
     C                     MOVEL@OPTN     DBOPTN            ************* E116
     C                     MOVELCUSTNO    DBKEY  29                       E116
     C                     SETON                     U7U8LR               E116
     C                     EXSR *PSSR                                     E116
     C                     END                                            E116
     C*                                                                   E116
     C*                                                                   E116
     C           BBPAIN    IFEQ 'P'                                       E116
     C                     MOVE '1'       *IN69                           E116
     C                     ELSE                                           E116
     C                     MOVE '0'       *IN69                           E116
     C                     END                                            E116
     C*                                                                   E116
     C*                                                                   E116
0427 C*******    ERECS     ADD  1         ERECS   50                      E116
0335 C***05**    LRECS     ADD  1         LRECS   50                      E191
     C           LRECS     ADD  1         LRECS   50                      E191
     C                     MOVE CUNR      LMTCUN  6                       E116
     C                     END                                            E116
     C/COPY WNCPYSRC,DL0740C001
0336 C**
     C** ACCESS SYSTEM LIMITS CUSTOMER W/O OUTSTANDING DEALS              059349
     C*                                                                   059349
     C  N02N06             SETOF                     05                   059349
     C*                                                                   059349
     C           *IN12     IFEQ '1'                                       059349
     C           DZLEVL    ANDEQ'S'                                       059349
     C                     SETON                     05                   059349
     C                     MOVE DZCUST    CUSTNO                          059349
     C*                                                                   059349
     C** CALL ACCESS PROGRAM FOR CUSTOMER DETAILS                         059349
     C******               CALL 'AOCUSTR0'                         059349 220738
     C                     CALL 'AOCUSTR1'                                220738
     C                     PARM '*MSG    '@RTCD                           059349
     C                     PARM '*KEY    '@OPTN                           059349
     C                     PARM CUSTNO    @AENB  10                       059349
     C                     PARM *BLANKS   @KYST   7                       059349
     C******     @CUST     PARM @CUST     DSSDY                    059349 220738
     C           @CUST     PARM @CUST     DSLDY                           220738
     C*                                                                   059349
     C           @RTCD     IFNE *BLANK                                    059349
     C           BBCLST    ANDNE'Y'                                       220738
     C                     MOVEL'SDCUSTPD'DBFILE            ************* 059349
     C                     MOVEL'05'      DBASE             *DBERROR 005* 059349
     C                     MOVEL@OPTN     DBOPTN            ************* 059349
     C                     MOVELCUSTNO    DBKEY  29                       059349
     C                     SETON                     U7U8LR               059349
     C                     EXSR *PSSR                                     059349
     C                     END                                            059349
     C*                                                                   059349
     C***********BBPCNB    IFNE *BLANKS                            088141 097989
     C***********BBPCNB    ANDNE'000000'                           088141 097989
     C***********          SETOF                     0542          088141 097989
     C***********          ELSE                                    088141 097989
     C*                                                                   088141
     C           BBPAIN    IFEQ 'P'                                       059349
     C                     MOVE '1'       *IN69                           059349
     C                     ELSE                                           059349
     C                     MOVE '0'       *IN69                           059349
     C                     END                                            059349
     C*                                                                   059349
     C           LRECS     ADD  1         LRECS                           059349
     C           ERECS     ADD  1         ERECS                           059349
     C*                                                                   088141
     C***********          END                                     088141 097989
     C*                                                                   088141
     C                     END                                            059349
     C/COPY WNCPYSRC,DL0740C002
     C*                                                                   S01153
     C                     SETOF                         42               S01153
     C*                                                                   S01153
0337 C**   IF HEADER - COUNT
0338 C**
0339 C**   PROCESS DETAIL RECORDS
0340 C   02                EXSR EVENT
     C   06                EXSR EVENT
0341 C***09*******         EXSR EVENT                                     S01274
0341 C***12*               EXSR EVENT                                     S01196
     C***14*******         EXSR EVENT                                     S01274
     C***16******          EXSR EVENT                              S03220 S01153
     C***82******          EXSR EVENT                              S01127 S01153
0342 C***05******          EXSR LIMITS                                    E116
0343 C**
0344 C*****IF*TRAILER*-*COUNT********                                     S01153
0345 C**
0346 C           END       TAG
     C************IN03     IFEQ '1'                                       S01153
     C***********          Z-ADDHRWN      ZZTOTI                          S01153
     C***********          Z-ADDHRDC      ZZTOTD                          S01153
     C***********          Z-ADDNORE      NORED   50                      S01153
     C***********          END                                            S01153
0597 C*
     C***FINANCIAL*FUTURE                                          S01127 S01153
     C************IN83     IFEQ '1'                                S01127 S01153
     C*********************Z-ADDHRWN      ZZAMTI                   S01127 S01153
     C*********************Z-ADDHRDC      ZZAMTD                   S01127 S01153
     C*********************EXSR GLZSUM                             S01127 S01153
     C***********NORE      ADD  NORED     NORED                    S01127 S01153
     C*********************END                                     S01127 S01153
     C*                                                                   S01127
     C************IN10     IFEQ '1'                                       S01153
     C***********          Z-ADDHRWN      ZZAMTI                          S01153
     C***********          Z-ADDHRDC      ZZAMTD                          S01153
     C***********          EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***********NORED     SUB  1         NORED                           S01153
     C***********          END                                            S01153
     C**C*U*S*T*O*M*E*R***L*E*N*D*I*N*G****T*R*A*I*L*E*R*****             S01153
     C************IN11     IFEQ '1'                                       S01153
     C***********          Z-ADDHRWN      ZZAMTI                          S01153
     C***********          Z-ADDHRDC      ZZAMTD                          S01153
     C***********          EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***********NORED     SUB  1         NORED                           S01153
     C***********          END                                            S01153
0597 C*
     C**L*E*T*T*E*R*S***O*F***C*R*E*D*I*T***T*R*A*I*L*E*R***              S01153
     C************IN13     IFEQ '1'                                       S01153
     C************         Z-ADDHRWN      ZZAMTI                          S01153
     C************         Z-ADDHRDC      ZZAMTD                          S01153
     C************         EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C***********NORED     SUB  1         NORED                           S01153
     C***********          END                                            S01153
0597 C*
     C**S*E*C*U*R*I*T*I*E*S***T*R*A*D*I*N*G**T*R*A*I*L*E*R***             S01153
     C************IN15     IFEQ '1'                                       S01153
     C***********          Z-ADDHRWN      ZZAMTI                          S01153
     C***********          Z-ADDHRDC      ZZAMTD                          S01153
     C***********          EXSR GLZSUM                                    S01153
     C***********NORE      ADD  NORED     NORED                           S01153
     C**********           END                                            S01153
0347 C**
     C**F*U*N*D*S***T*R*S*N*S*F*E*R***T*R*A*I*L*E*R                S03220 S01153
     C************IN17     IFEQ '1'                                S03220 S01153
     C*********************Z-ADDHRWN      ZZAMTI                   S03220 S01153
     C*********************Z-ADDHRDC      ZZAMTD                   S03220 S01153
     C*********************EXSR GLZSUM                             S03220 S01153
     C***********NORE      ADD  NORED     NORED                    S03220 S01153
     C*********************END                                     S03220 S01153
0347 C**
0348 C**   COMPARE FILE CONTROL TOTALS & WRITE REPORT
0349 C*****DEALING*FILE
0350 C*****EVENTS*FILE******                                              S01153
     C*R*********          Z-ADDZZTOTI    HRWN                            S01153
     C*R*********          Z-ADDZZTOTD    HRDC                            S01153
     C*R*********          Z-ADDNORED     NORE                            S01153
0351 C*R*********DRECS     COMP NORE                 4343                 S01153
0352 C*RN43******INT,1     COMP HRWN                 4343                 S01153
0353 C*RN43******DEC,1     COMP HRDC                 4343                 S01153
0354 C*
0355 C*
0356 C**   COMMERCIAL LOANS FILE
0357 C*
0358 C*
0359 C*    LIMITS FILE
0360 C*R******   LRECS     COMP LNLRA                4545                 E116
     C*                                                                   S01117
0361 C*R*43***                                                            S01153
0362 C*R 44 U2
0363 C*OR*45****************SETON                     U8                  S01153
0363 C*R*45***             SETON                     U8             S01153E116
     CLR         *IN40     IFNE '1'                                       E116
     C*                                                                   E116
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             E116
     CLR                   CALL 'AOBANKR0'                                E116
     CLR                   PARM '*MSG    '@RTCD   7                       E116
     CLR                   PARM '*FIRST  '@OPTN   7                       E116
     CLR         @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   E116
     CLR         @RTCD     IFNE *BLANK                                    E116
     CLR                   MOVEL'SDBANKPD'DBFILE 10         ************* E116
     CLR                   MOVEL'06'      DBASE   3         *DBERROR 006* E116
     CLR                   MOVEL@OPTN     DBOPTN  7         ************* E116
     CLR                   SETON                     U7U8                 E116
     CLR                   EXSR *PSSR                                     E116
     CLR                   GOTO END2                                      E116
     CLR                   END                                            E116
0757 C*                                                                   E116
     C** CALL ACCESS PROGRAM FOR DEALING DATA DETAILS                     E116
     C**LR******           CALL 'AODEALR0'                                E116                CGL029
     CLR                   CALL 'AODEALR1'                                                    CGL029
     CLR                   PARM '*MSG    '@RTCD                           E116
     CLR                   PARM '*FIRST  '@OPTN                           E116
     C**LR****** @DEAL     PARM @DEAL     DSFDY                           S01194              CGL029
     CLR         @DEAL     PARM @DEAL     DSSDY                                               CGL029
     C*                                                                   E116
     CLR         @RTCD     IFNE *BLANK                                    E116
     CLR                   MOVEL'SDDEALPD'DBFILE            ************* E116
     CLR                   MOVEL'07'      DBASE             *DBERROR 007* E116
     CLR                   MOVEL@OPTN     DBOPTN            ************* E116
     CLR                   SETON                     U7U8                 E116
     CLR                   EXSR *PSSR                                     E116
     CLR                   GOTO END2                                      E116
     CLR                   END                                            E116
     CLR                   ELSE                                           097989
     CLR                   EXSR MORLIM                                    097989
     CLR                   END                                            E116
     CLR         END2      TAG                              *** END2 ***  E116
0364 C*
0365 C********************************************************************
0366 C*    SR. TO PROCESS EVENTS FILE
0367 C           EVENT     BEGSR                           *** EVENT ***
0368 C*
0369 C*
0370 C*    HASH TOTAL THE RECORDS READ
0371 C*****DEALING*FILE
0372 C*     EVENTS FILE
0373 C***02******                                                         S01153
     C*R*06******                                                         S01153
     C*R*12******                                                         S01153
     C*R*14******                                                         S01153
     C*R*16******                                                  S03220 S01153
     C*R*82******                                                  S01127 S01153
0374 C*R*09******          MOVE 1         X       10                      S01153
0374 C                     MOVE 1         X       10                      S01153
     C*                                                                   S01360
     C* IF MONEY MARKET EXPOSURE BY COUNTRY SAR INSTALLED                 S01360
     C*                                                                   S01360
     C           *INU2     IFEQ '1'                                       S01360
     C*                                                                   S01360
     C* IF EVENT IS WITH A CUSTOMER WITH A PARENT OVERWRITE THE           S01360
     C* CUSTOMER DETAILS WITH THE PARENT DETAILS.                         S01360
     C*                                                                   S01360
     C           PTNU      IFNE *BLANKS                                   S01360
     C           PTNU      ANDNE'000000'                                  S01360
     C/COPY WNCPYSRC,DL0740C004
     C                     SETON                     51                   S01360
     C                     ELSE                                           S01360
     C                     SETOF                     51                   S01360
     C                     END                                            S01360
     C*                                                                   S01360
     C* SET ON INDICATOR 50 FOR OUTPUT TO EXTRACT FILE IF                 S01360
     C* EVENT IS FOR MONEY MARKET.                                        S01360
     C*                                                                   S01360
     C           ETYPA     IFNE '11'                                      S01360
     C           ETYPA     ANDNE'12'                                      S01360
     C           ETYPA     ANDNE'13'                                      S01360
     C           ETYPA     ANDNE'14'                                      S01360
     C           ETYPA     ANDNE'21'                                      125894
     C           ETYPA     ANDNE'22'                                      125894
     C           ETYPA     ANDNE'23'                                      125894
     C           ETYPA     ANDNE'24'                                      125894
     C                     SETON                     50                   S01360
     C                     ELSE                                           S01360
     C                     SETOF                     50                   S01360
     C                     END                                            S01360
     C                     END                                            S01360
0375 C*
0376 C*
0377 C*****COMMERCIAL*LOANS*FILE
0378 C*
0379 C           EAMT      DIV  1000      ZZAMT        25
0380 C   25                Z-SUBZZAMT     ZZAMT
0381 C                     EXSR HASH
0382 C*                                                                   S03220
     C                     SETON                         42               S01153
     C*                                                                   S01153
     C**NO*RECORDS*TO*BE*OUTPUT*FOR*FUNDS*TRANSFER                 S03220 S01153
0380 C***16******          GOTO ENDEV                              S03220 S01153
0382 C*
0383 C***********ETYP      COMP '11V1'                   42               S01153
0384 C**N42******ETYP      COMP '12V1'                   42               S01153
0385 C**N42******ETYP      COMP '13V1'                   42               S01153
0386 C**N42******ETYP      COMP '14V1'                   42               S01153
     C**N42******ETYP      COMP '15V1'                   42 E12072        S01153
     C**N42******ETYP      COMP '17V1'                   42 E12072        S01153
0387 C**N42******ETYP      COMP '15M1'                   42               S01153
0388 C**N42******ETYP      COMP '17M1'                   42               S01153
0389 C**N42******ETYP      COMP '17S1'                   42               S01153
0389 C**N42******ETYP      COMP '21E1'   FRA             42 S01119        S01153
0389 C**N42******ETYP      COMP '22E1'   IRS SINGLE CCY  42 S01119        S01153
0389 C**N42******ETYP      COMP '23E1'   IRS CROSS CCY   42 S01119        S01153
0389 C**N42******ETYP      COMP '24E1'   IR CAP/COLLAR   42 S01119        S01153
     C**N42******ETYP      COMP '30P1'                   42               S01153
     C**N42******ETYP      COMP '30S1'                   42               S01153
     C**N42******ETYP      COMP '30C1'                   42               S01153
     C**N42******ETYP      COMP '30C2'                   42               S01153
     C**N42******ETYP      COMP '30A1'                   42               S01153
     C**N42******ETYP      COMP '30D1'                   42               S01153
     C**N42******ETYP      COMP '30D2'                   42               S01153
     C**N42******ETYP      COMP '30M1'                   42               S01153
     C**N42******ETYP      COMP '30M2'                   42               S01153
0390 C**N42******ETYP      COMP '41M1'                   42               S01153
0391 C**N42******ETYP      COMP '41M3'                   42               S01153
0392 C**N42******ETYP      COMP '41R1'                   42               S01153
0393 C**N42******ETYP      COMP '41R3'                   42               S01153
0394 C**N42******ETYP      COMP '41R4'                   42               S01153
0395 C**N42******ETYP      COMP '42M1'                   42               S01153
     C**N42******ETYP      COMP '61R1'                   42               S01153
     C**N42******ETYP      COMP '61M1'                   42               S01153
     C**N42******ETYP      COMP '62M1'                   42               S01153
     C**N42******ETYP      COMP '62R1'                   42               S01153
     C**N42******ETYP      COMP '63M1'                   42               S01153
     C**N42******ETYP      COMP '64R1'                   42               S01153
     C**N42******ETYP      COMP '64M1'                   42               S01153
     C**N42******ETYP      COMP '65M1'                   42               S01153
     C**N42******ETYP      COMP '66R1'                   42               S01153
     C**N42******ETYP      COMP '66M1'                   42               S01153
     C**N42******ETYP      COMP '67M1'                   42               S01153
     C* N42      ETYP      COMP '60V3'                   42               E10777
     C**N42******ETYP      COMP '61V3'                   42     E10777    S01153
     C**N42******ETYP      COMP '80M1'                   42               S01153
     C**N42******ETYP      COMP '81D1'                   42               S01153
     C**N42******ETYP      COMP '81M1'                   42               S01153
     C**N42******ETYP      COMP '81M3'                   42               S01153
     C**N42******ETYP      COMP '82A1'                   42               S01153
     C**N42******ETYP      COMP '82M1'                   42               S01153
     C**N42******ETYP      COMP '84V1'                   42               S01153
     C**N42******ETYP      COMP '84V2'                   42               S01153
0396 C**N42******          GOTO ENDEV                                     S01153
0397 C**
     C*****      *IN20     IFNE '1'                                S01194 E159
     C           PTNU      IFNE '000000'                                  E159
     C           PTNU      ANDNE*BLANKS                                   LN0603
     C/COPY WNCPYSRC,DL0740C005
     C           *IN02     ANDEQ'1'                                       E159
     C                     SETOF                     20                   E191
     C***********
     C***CALL*ACCESS PROGRAM FOR PARENT DETAILS                     S01194BHF805
     C***********          CALL 'AOCUSTR0'                          S01194BHF805
     C***********          PARM '*MSG    '@RTCD                     S01194BHF805
     C***********          PARM '*KEY    '@OPTN                     S01194BHF805
     C***********          PARM PTNU      @AENB  10                 S01194BHF805
     C***********          PARM *BLANKS   @KYST   7                 S01194BHF805
     C***********@CUST     PARM @CUST     DSSDY                     S01194BHF805
     C************                                                  S01194BHF805
     C***********@RTCD     IFNE *BLANK                              S01194BHF805
     C***********          MOVEL'SDCUSTPD'DBFILE            ********S01194BHF805
     C***********          MOVEL'04'      DBASE             *DBERRORS01194BHF805
     C***********          MOVEL@OPTN     DBOPTN            ********S01194BHF805
     C***********          MOVELPTNU      DBKEY  29                 S01194BHF805
     C***********          SETON                     U7U8LR         S01194BHF805
     C***********          EXSR *PSSR                               S01194BHF805
     C***********          ELSE                                     S01194BHF805
     C                     MOVELBBCRNM    PRNM                            S01194
     C                     MOVELBBCRTN    PTWN                            S01194
     C                     MOVELBBCASC    PASK                            S01194
     C***********          END                                      S01194BHF805
     C*
     C**   IF CUST. HAS A PARENT, 2 RECORDS WILL BE WRITTEN.              E191
     C           ERECS     ADD  1         ERECS                           E191
     C*                                                                   E191
     C*    HASH TOTAL THE PARENT RECORD                                   E191
     C                     MOVE 2         X                               E200
     C                     EXSR HASH                                      E191
     C*                                                                   E191
     C                     ELSE                                           E191
     C*                                                                   E191
     C** ELSE HAS NOT GOT A PARENT ASSOCIATED WITH CUSTOMER               E191
     C                     SETON                     20                   E191
     C*                                                                   E191
     C                     END                                            S01194
     C*
0398 C**   COUNT RECORDS TO BE WRITTEN TO EVLXC
      * THIS INCLUDES THE RECORD FROM EVNTML5 + THE RECORD JUST WRITTEN   E200
     C           ERECS     ADD  2         ERECS                           E200
0399 C***********ERECS     ADD  1         ERECS                           E200
0400 C*
0401 C*
0402 C*    HASH TOTAL THE EXTRACTED RECORDS
0403 C                     MOVE 2         X
0404 C                     EXSR HASH
0405 C*
0406 C**
0407 C*****IF CUST. HAS A PARENT, 2 RECORDS WILL BE WRITTEN.              E191
0408 C**N20*02   ERECS     ADD  1         ERECS                           E191
0409 C******                                                              E191
0410 C******                                                              E191
0411 C*****HASH TOTAL THE PARENT RECORD                                   E191
0412 C**N20*02             EXSR HASH                                      E191
0413 C******                                                              E191
0414 C**
0415 C*
0416 C           ENDEV     ENDSR
0417 C********************************************************************E116
0418 C*****SR. TO PROCESS LIMITS RECORDS                                  E116
0419 C******     LIMITS    BEGSR                                          E116
0420 C******                                                              E116
0421 C*****OBTAIN CUSTOMER DETAILS                                        E116
0422 C******               MOVELCNUM      CLIKEY                    S01194E116
0423 C******     CLIKEY    CHAINCLINT                51             S01194E116
0424 C**N07*               SETON                     LRU7U8         S01194E116
     C******                                                        S01194E116
     C******               MOVE CNUM      CNUMA   6                 S01194E116
     C***CALL ACCESS PROGRAM FOR CUSTOMER DETAILS                   S01194E116
     C******               CALL 'AOCUSTR0'                          S01194E116
     C******               PARM '*MSG    '@RTCD                     S01194E116
     C******               PARM '*KEY    '@OPTN                     S01194E116
     C******               PARM CNUMA     @AENB  10                 S01194E116
     C******               PARM *BLANKS   @KYST   7                 S01194E116
     C******               PARM           @CUST                     S01194E116
     C******                                                        S01194E116
     C******     @RTCD     IFNE *BLANK                              S01194E116
     C******               MOVEL'SDCUSTPD'DBFILE      ************* S01194E116
     C******               MOVEL'03'      DBASE       *DBERROR 003* S01194E116
     C******               MOVEL@OPTN     DBOPTN      ************* S01194E116
     C******               MOVELCNUMA     DBKEY  29                 S01194E116
     C******               SETON                     U7U8LR         S01194E116
     C******               EXSR *PSSR                               S01194E116
     C******               END                                      S01194E116
     C******                                                              E116
     C******                                                              E116
0425 C******               TESTB'2'       CMIN           69         S01194E116
     C******     BBBNST    IFEQ 'P'                                 S01194E116
     C******               MOVE '1'       *IN69                     S01194E116
     C******               ELSE                                     S01194E116
     C******               MOVE '0'       *IN69                     S01194E116
     C******               END                                      S01194E116
     C******                                                              E116
     C******                                                              E116
0427 C******     ERECS     ADD  1         ERECS   50                      E116
0428 C******                                                              E116
0429 C******               ENDSR                                          E116
0430 C******                                                              E116
0431 C********************************************************************
0432 C*
0433 C*    SUBROUTINE TO HASH TOTAL THE INPUT RECORDS FOR
0434 C*    THE DEALS EVENTS FILE
0435 C*    THE COMMERCIAL LOANS EVENTS FILE
0436 C*
0437 C           HASH      BEGSR                           ** HASH BEGSR *
0438 C*
0439 C                     Z-ADDINT,X     ZZTOTI
0440 C                     Z-ADDDEC,X     ZZTOTD
0441 C                     EXSR GLZADD
0442 C                     Z-ADDZZTOTI    INT,X
0443 C                     Z-ADDZZTOTD    DEC,X
0444 C*
0445 C                     ENDSR
0446 C*
0447 C********************************************************************
0448 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0449 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0450 C*
0451 CSR         GLZADD    BEGSR                           *** GLZADD ****
0452 C*
0453 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0454 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0455 C*
0456 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0457 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0458 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0459 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0460 C*
0461 CSR                   EXSR GLZSUM
0462 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0463 C*
0464 C********************************************************************
0465 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0466 C*                        GLZADD, GLZSUB, GLZCMP.
0467 C*          PARAMETERS PASSED -
0468 C*                     I/P ZZAMTI ZZAMTD
0469 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0470 C*
0471 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0472 C*
0473 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0474 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0475 CSR                   SETOF                     919293
0476 CSR                   SETOF                     949599
0477 C*
0478 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0479 CSR         ZZAMTI    COMP 0                      9293
0480 CSR 93      ZZAMTD    COMP 0                      9293
0481 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0482 C*
0483 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0484 CSR         ZZTOTI    COMP 0                      9193
0485 CSR 93      ZZTOTD    COMP 0                      9193
0486 C*
0487 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0488 CSR 93                Z-ADDZZAMTI    ZZTOTI
0489 CSR 93                Z-ADDZZAMTD    ZZTOTD
0490 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0491 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0492 CSR 91N92
0493 CORN91 92             GOTO ZZOFPS
0494 C*
0495 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0496 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0497 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0498 C*
0499 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0500 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0501 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0502 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0503 C*
0504 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0505 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0506 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0507 CSRN99                Z-ADDZZWK2     ZZTOTD
0508 CSRN99                Z-ADDZZWK3     ZZTOTI
0509 C*
0510 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0511 CSR 99                Z-ADD0         ZZAMT  153
0512 CSR                   GOTO ZZSEND
0513 C*
0514 C* THE 'SIGNS' ARE DIFFERENT
0515 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0516 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0517 C*
0518 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0519 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0520 C*
0521 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0522 C*
0523 CSR 91                Z-SUBZZTOTI    ZZTOTI
0524 CSR 91                Z-SUBZZTOTD    ZZTOTD
0525 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0526 C*
0527 CSR         ZZTOTI    COMP ZZAMTI               93  95
0528 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0529 C*
0530 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0531 CSR 95                Z-ADD0         ZZTOTI
0532 CSR 95                Z-ADD0         ZZTOTD
0533 CSR 95                GOTO ZZSEND
0534 C*
0535 C* IF ZZTOT GT. ZZAMT.
0536 CSR 93      ZZAMTD    COMP ZZTOTD               94
0537 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0538 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0539 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0540 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0541 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0542 C*
0543 C*
0544 C* IF ZZAMT GT. ZZTOT.
0545 CSRN93      ZZTOTD    COMP ZZAMTD               94
0546 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0547 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0548 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0549 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0550 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0551 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0552 C*
0553 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0554 CSR                   SETOF                     94
0555 CSR 93 91
0556 CORN93 92             SETON                     94
0557 CSR 94                Z-SUBZZTOTI    ZZTOTI
0558 CSR 94                Z-SUBZZTOTD    ZZTOTD
0559 C**
0560 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0561 CSR 92                Z-SUBZZAMTI    ZZAMTI
0562 CSR 92                Z-SUBZZAMTD    ZZAMTD
0563 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0564 C**
0565 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0566 CSR                   SETOF                     96
0567 CSR         ZZTOTD    COMP 0                        91
0568 CSR 91      ZZTOTI    COMP 0                      96
0569 CSR 96                MOVE '.000-'   ZZNEGD  5
0570 CSR                   ENDSR                             ** ENDSR **
0571 C********************************************************************
0572 C*****                                                               S01194
0573 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0574 C*****                                                               S01194
0575 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0576 C*****                                                               S01194
0577 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0578 C*****                MOVEL'01      'ZTABKY 12                       S01194
0579 C*****                MOVE '  10'    ZTABKY                          S01194
0580 C*****                                                               S01194
0581 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0582 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0583 C*****                                                               S01194
0584 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0585 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0586 C*****                                                               S01194
0587 C*****                ENDSR                                          S01194
0588 C*****                                                               S01194
0589 C*****                                                               S01194
0506 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C********************************************************************097989
     C* Write Any Additional Limits Records.                              097989
     C********************************************************************097989
     C*                                                                   097989
     C           MORLIM    BEGSR                                          097989
     C*                                                                   097989
     C** Read loop of customer limits                                     097989
     C*                                                                   097989
     C                     MOVE *IN99     HOLD99  1                       097989
     C                     READ @DZREHS                  99               097989
     C           *IN99     DOWEQ'0'                                       097989
     C           DZFLAM    IFNE *ZERO                                     097989
     C           DZLLAM    ORNE *ZERO                                     097989
      *                                                                   097989
     C           DZCUST    CHAINEVLXCEL0             99                   097989
     C           *IN99     IFEQ '1'                                       097989
     C*                                                                   097989
     C** Move in target values.                                           097989
     C*                                                                   097989
     C                     MOVE DZCUST    CUNR                            097989
     C                     MOVE 'D'       RECI                            097989
     C                     Z-ADD*ZERO     DLNO                            097989
     C                     MOVE 'C   '    ETYP                            097989
     C                     Z-ADD*ZERO     EDAT                            097989
     C                     MOVE DZFXLT    FLTY                            097989
     C                     Z-ADDDZFLAM    FLAM                            097989
     C                     Z-ADDDZFLED    FLED                            097989
     C                     Z-ADDDZFLRD    FLVD                            097989
     C                     MOVE DZFLFQ    FLRF                            097989
     C                     Z-ADDDZMDDR    RLAM                            097989
     C                     MOVE DZLLTY    LLTY                            097989
     C                     Z-ADDDZLLAM    LLAM                            097989
     C                     Z-ADDDZLLED    LLED                            097989
     C                     Z-ADDDZLLRD    LLRD                            097989
     C                     MOVE DZLLFR    LLRF                            097989
     C                     MOVE DZSECD    LLSE                            097989
     C                     Z-ADDDZFRLA    FRAM                            097989
     C                     Z-ADDDZFRED    FRED                            097989
     C                     Z-ADDDZFRRD    FRRD                            097989
     C                     MOVE DZFRFQ    FRRF                            097989
     C                     Z-ADDDZIRLM    IRAM                            097989
     C                     Z-ADDDZIRED    IRED                            097989
     C                     Z-ADDDZIRDT    IRRD                            097989
     C                     MOVE DZIRFQ    IRRF                            097989
     C*                                                                   097989
     C** Retrieve customer details                                        097989
     C*                                                                   097989
     C******               CALL 'AOCUSTR0'                         097989 220738
     C                     CALL 'AOCUSTR1'                                220738
     C                     PARM '*MSG    '@RTCD                           097989
     C                     PARM '*KEY    '@OPTN                           097989
     C                     PARM DZCUST    @AENB                           097989
     C                     PARM *BLANK    @KYST                           097989
     C******     @CUST     PARM @CUST     DSSDY                    097989 220738
     C           @CUST     PARM @CUST     DSLDY                           220738
     C*                                                                   097989
     C           @RTCD     IFEQ *BLANK                                    097989
     C           @RTCD     ORNE *BLANK                                    220738
     C           BBCLST    ANDEQ'Y'                                       220738
     C                     MOVE BBCRNM    CRNM                            097989
     C                     MOVE BBCRTN    CTWN                            097989
     C                     MOVE BBCASC    CASK                            097989
     C           BBPAIN    IFEQ 'P'                                       097989
     C                     Z-ADD1         PARI                            097989
     C                     ELSE                                           097989
     C                     Z-ADD*ZERO     PARI                            097989
     C                     END                                            097989
     C*                                                                   097989
     C** Output customer limits                                           097989
     C*                                                                   097989
     C                     END                                            097989
     C                     END                                            097989
     C                     END                                            097989
     C                     READ @DZREHS                  99               097989
     C                     END                                            097989
     C                     ENDSR                                          097989
0590 C********************************************************************
0591 OEVLXCEC H        1P
0592 O                                    1 'A'
0603 OEVLXCED D        02 42N20
0604 O                         LOT1     159
0605 O**********               LOT2     320                                                   CGL029
0605 O*************************LOT2     336                                            CGL029 CDL038
     O                         LOT2     340                                                   CDL038
0606 O*****                    CPAR      13                               S01194
0606 O                         PTNU      13                               S01194
0607 O                                  128 '000000'
0608 O                                  129 '1'
0609 O                         PRNM     149
0610 O                         PTWN     159
0611 O                         PASK     167
0612 O                                  187 '                    '
0613 O                                  197 '          '
0614 O                                  205 '        '
     OEVLXCBH D        02 50 51                                           S01360
     O       AND       U2                                                 S01360
     O                         LOT1     159                               S01360
     O**********               LOT2     320                                            S01360 CGL029
     O*************************LOT2     336                                            CGL029 CDL038
     O                         LOT2     340                                                   CDL038
     O                         PTNU      13                               S01360
     O                         CUNR     128                               S01360
     O                                  129 '1'                           S01360
     O                         PRNM     149                               S01360
     O                         PTWN     159                               S01360
     O                         PASK     167                               S01360
     O                         CRNM     187                               S01360
     O                         CTWN     197                               S01360
     O                         CASK     205                               S01360
     O                         CCTZ     207                               S01360
     OEVLXCBH D        02 50N51                                           S01360
     O       AND       U2                                                 S01360
     O                         LOT1     159                               S01360
     O**********               LOT2     320                                            S01360 CGL029
     O*************************LOT2     336                                            CGL029 CDL038
     O                         LOT2     340                                                   CDL038
0628 OEVLXCEE D        05
0629 O                                    1 'D'
0630 O                                    7 '000000'
     O***************          CNUM      13                               E191
     O**********               CUNR      13                           E191BHF805
     O                         CUSTNO    13                               BHF805
0632 O                                   17 'C   '
0633 O                         ZERO5     20P
0634 O*****                    FLTY      23                               E116
0635 O*****                    FLAM      28P                              E116
0636 O*****                    FLED      31P                              E116
0637 O*****                    FLVD      34P                              E116
0638 O*****                    FLRF      35                               E116
0639 O*****                    RLAM      40P                              E116
0640 O*****                    LLTY      43                               E116
0641 O*****                    LLAM      48P                              E116
0642 O*****                    LLED      51P                              E116
0643 O*****                    LLRD      54P                              E116
0644 O*****                    LLRF      55                               E116
0645 O*****                    LLSE      56                               E116
     O*****                    FRAM      61P                        S01157E116
     O*****                    FRED      64P                        S01157E116
     O*****                    FRRD      67P                        S01157E116
     O*****                    FRRF      68                         S01157E116
     O*****                    IRAM      73P                        S01157E116
     O*****                    IRED      76P                        S01157E116
     O*****                    IRRD      79P                        S01157E116
     O*****                    IRRF      80                         S01157E116
     O                         DZFXLT    23                               E116
     O                         DZFLAM    28P                              E116
     O                         DZFLED    31P                              E116
     O                         DZFLRD    34P                              E116
     O                         DZFLFQ    35                               E116
     O                         DZMDDR    40P                              E116
     O*******                  DZLLTY    43                       E116    S01433
     O*******                  DZLLAM    48P                      E116    S01433
     O*******                  DZLLED    51P                      E116    S01433
     O*******                  DZLLRD    54P                      E116    S01433
     O*******                  DZLLFR    55                       E116    S01433
     O                N90      DZLLTY    43                               090985
     O                N90      DZLLAM    48P                              090985
     O                N90      DZLLED    51P                              090985
     O                N90      DZLLRD    54P                              090985
     O                N90      DZLLFR    55                               090985
     O***********              DZMMTY    43                        S01433 090985
     O***********              DZMMAM    48P                       S01433 090985
     O***********              DZMMED    51P                       S01433 090985
     O***********              DZMMRD    54P                       S01433 090985
     O***********              DZMMFR    55                        S01433 090985
     O                 90      DZMMTY    43                               090985
     O                 90      DZMMAM    48P                              090985
     O                 90      DZMMED    51P                              090985
     O                 90      DZMMRD    54P                              090985
     O                 90      DZMMFR    55                               090985
     O                         DZSECD    56                               E116
     O                         DZFRLA    61P                              E116
     O                         DZFRED    64P                              E116
     O                         DZFRRD    67P                              E116
     O                         DZFRFQ    68                               E116
     O                         DZIRLM    73P                              E116
     O                         DZIRED    76P                              E116
     O                         DZIRDT    79P                              E116
     O                         DZIRFQ    80                               E116
0646 O                                  129 '0'
0647 O                 69               129 '1'
0648 O*******                  CRNM     149                               S01194
0648 O                         BBCRNM   149                               S01194
0649 O*******                  CTWN     159                               S01194
0649 O                         BBCRTN   159                               S01194
0650 O*******                  CASK     167                               S01194
0650 O                         BBCASC   167                               S01194
0650 O*******                  BRNCH    320                          E116 E191
     O                         DZPLTY   323                               S01433
     O                         DZPFAM   328P                              S01433
     O                         DZPSAM   333P                              S01433
     O                         DZPLED   336P                              S01433
     O                         DZPLVD   339P                              S01433
     O                         DZPLRF   340                               S01433
     O                         DZPLAM   345P                              S01433
     O                         DZFXFA   350P                              S01433
     OEVLXCBE D        05 U2                                              S01360
     O                                    1 'D'                           S01360
     O                                    7 '000000'                      S01360
     O                         CUSTNO    13                               S01360
     O                                   17 'C   '                        S01360
     O                         ZERO5     20P                              S01360
     O                         DZFXLT    23                               S01360
     O                         DZFLAM    28P                              S01360
     O                         DZFLED    31P                              S01360
     O                         DZFLRD    34P                              S01360
     O                         DZFLFQ    35                               S01360
     O                         DZMDDR    40P                              S01360
     O*****                    DZLLTY    43                         S01360S01433
     O*****                    DZLLAM    48P                        S01360S01433
     O******                   DZLLED    51P                        S01360S01433
     O*****                    DZLLRD    54P                        S01360S01433
     O*****                    DZLLFR    55                         S01360S01433
     O                         DZMMTY    43                               S01433
     O                         DZMMAM    48P                              S01433
     O                         DZMMED    51P                              S01433
     O                         DZMMRD    54P                              S01433
     O                         DZMMFR    55                               S01433
     O*                                                                   090982
     O**  If S01433 is not installed, use lending limits details          090982
     O                N90      DZLLTY    43                               090982
     O                N90      DZLLAM    48P                              090982
     O                N90      DZLLED    51P                              090982
     O                N90      DZLLRD    54P                              090982
     O                N90      DZLLFR    55                               090982
     O                         DZSECD    56                               S01360
     O                         DZFRLA    61P                              S01360
     O                         DZFRED    64P                              S01360
     O                         DZFRRD    67P                              S01360
     O                         DZFRFQ    68                               S01360
     O                         DZIRLM    73P                              S01360
     O                         DZIRED    76P                              S01360
     O                         DZIRDT    79P                              S01360
     O                         DZIRFQ    80                               S01360
     O                                  129 '0'                           S01360
     O                 69               129 '1'                           S01360
     O                         BBCRNM   149                               S01360
     O                         BBCRTN   159                               S01360
     O                         BBCASC   167                               S01360
     O                         CCTZ     322                               S01360
0654 OEVLXCEG T        LR
0655 O                                    1 'T'
0656 O**********               ERECS      6                                                   236334
0657 O**********               INT,2     14P                                                  236334
0658 O**********               DEC,2     16P                                                  236334
0656 O                         ERECS      8                                                   236334
0657 O                         INT,2     16P                                                  236334
0658 O                         DEC,2     18P                                                  236334
0660 O*PRINT  T   03   LR                                                 S01124
0660 O****DL0740P1T   03   LR                                      S01124 S01117
0661 O****                               22 'REFERENCE DL0740'            S01117
0660 ODL0740AUT   03   LR                                                 S01117
0661 O                                   22 'REFERENCE DL0740AU'          S01117
0662 O******                   TITL      89                               S01194
0662 O                         BJURPT    89                               S01194
0663 O                                  122 'DATE              PAGE'
0664 O                                  127 '    1'
0665 O******                   RUNA     112                               S01194
0665 O                         BJMRDT   112                               S01194
0666 O        T 2      LR
0667 O                                   68 'EXPOSURE AGAINST LIMITS '
0668 O                                   88 'IN 000''S     EXTRACT'
0669 O******                   BCYL      80                               S01194
0669 O                         BNCYCD    80                               S01194
0670 O        T 1      LR
0671 O                                   68 '------------------------'
0672 O                                   88 '--------------------'
0673 O******  T   14   LR U7 U8
0674 O******                             73 'PRINT TERMINATED, DATABA'
0675 O******                             84 'SE IN ERROR'
0676 O        T   36   LR
0677 O                                   18 'RUN CONTROLS'
0678 O        T   38   LR
0679 O                                   59 'NUMBER'
0680 O                                   84 'VALUE'
0681 O        T   40   LR
0682 O                                   24 'EVENTS FILE - READ'
0683 O                         DRECS 3   59
0684 O                         INT,1 Z   81
0685 O                         DEC,1     84
0686 O********T***42   LR                                                 S01153
0687 O************                       33 '- CONTROL TOTAL'             S01153
0688 O************             NORE  3   59                               S01153
0689 O************             HRWN  Z   81                               S01153
0690 O************             HRDC      84                               S01153
0691 O************           43         109 '***  DIFFERENCE  ***'        S01153
0692 O        T   45   LR
0693 O                                   24 'LIMITS FILE - READ'
0694 O                         LRECS 3   59
0695 O*****   T   47   LR                                                 E116
0696 O*****                              33 '- CONTROL TOTAL'             E116
0697 O*****                    LNLRA 3   59                               E116
0698 O*****                  45         109 '***  DIFFERENCE  ***'        E116
0699 O        T   50   LR
0700 O                                   28 'EXTRACT FILE - WRITTEN'
0701 O                         ERECS 3   59
0702 O                         INT,2 Z   81
0703 O                         DEC,2     84
0569 O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 2      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   49 'OPTION'                      S01117
     O                         DBOPTN    57                               S01117
     O                                   66 'KEY'                         S01117
     O                         DBKEY     96                               S01117
0704 O********T   53   LR                                                 S01117
     O********T 3      LR                                           S01117LN0512
0705 O**********                         72 '*** END OF REPORT ***'       LN0512
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
