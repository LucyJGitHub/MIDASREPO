0001 H        1
0002 F********************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Customer exposure report')                    *
0002 F********************************************************************
0004 F*                                                                  *
     F*  Midas - Dealing Module
0004 F*                                                                  *
0005 F********DL0760*- CUSTOMER EXPOSURE AGAINST LIMITS REPORT           *
0005 F*       DL0760A- CUSTOMER EXPOSURE AGAINST LIMITS REPORT           *
0005 F*                (CALLED BY DLC0806)                               *
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CDL099             Date 06Oct17               *
      *                 CLE154             Date 06Aug12               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 01Sep14               *
      *                 232996             Date 19Aug14               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CCB016             Date 30Nov05               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 05Jul06               *
      *                 218582             Date 06Jun06               *
      *                 186315             Date 06Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 236334             Date 06Jan06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CDL038             Date 10May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 194291             Date 26Feb02               *
      *                 190544             Date 15Feb02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 191399             Date 20Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 184593             Date 12Dec00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 180278             Date 28Sep00               *
      * Midas DBA 3.03 -----------------------------------------------*
     F*                 179353             Date 30Jun00               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 153759             Date 15Oct99               *
     F*                 163486             Date 14Oct99               *
      * Midas DBA 3.01 -----------------------------------------------*
     F*                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 160828             Date 05Jul99               *
      *                 CDL002             Date 16Sep97                  *
     F*                 097989               DATE 12FEB97                *
     F*               089129               DATE 28JUL95                  *
     F*               S01408               DATE 02NOV95                  *
     F*               064258               DATE 06DEC93                  *
     F*               S01433               DATE 15SEP93                  *
     F*               060636               DATE 06OCT93                  *
     F*               E38323               DATE 29JUL92                  *
     F*               S01393               DATE  11AUG92                 *
     F*                    E26066 (BH3024)      DATE  16SEP91            *
     F*                    E28817               DATE  14OCT91            *
     F*                    E25515               DATE  08AUG91            *
     F*                    DT0023               DATE  04APR91            *
     F*                    E22512               DATE  26JUN90            *
     F*                    LN0728               DATE  19SEP90            *BHF244
     F*                    BHF416               DATE  19AUG90            *BHF244
     F*                    BHF244               DATE  10JUL90            *BHF244
0008 F*                    LN0442               DATE  27JUN90            *LN0236
0008 F*                    LN0236               DATE  22MAY90            *LN0236
0008 F*                    LN0049               DATE  27APR90            *LN0049
0008 F*                    E20711               DATE  18APR90            *E20711
0010 F*                    S01194               DATE  25/10/89           *S01194
0010 F*                    S01196               DATE  25/10/89           *S01196
0010 F*                    S01117               DATE  25/10/89           *S01117
0010 F*                    S01195               DATE  25/10/89           *S01195
0010 F*                    S01157               DATE  25/10/89           *S01157
0010 F*                    E12072               DATE  06/05/88           *E12072
0010 F*                    E10421               DATE  03/08/87           *S01157
0010 F*                    S01119               DATE  17/06/87           *S01119
0010 F*                    S1105                DATE  28/04/86           *S1105
     F*****************************************************************
     F*  ANY CHANGES MADE TO THIS PROGRAM SHOULD ALSO BE MADE TO      *
     F*                    DL0760                                     *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  232996 - No Expiry reflected for customers not defined in    *
      *           the customer limits file. This should be No Limit.  *
      *           Improve validation being done by tag LNPROC against *
      *           customers with no limit and no expiry.              *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CCB016 - CoB Performance Enhancements                        *
      *           Call AOLIMTR0 with blank return code instead of     *
      *           *MSG.                                               *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  218582 - DLC0806 often fails due to FCOOB. Rename the field  *
      *           NORE in PF/FWDRTFD since its length is now different*
      *           from the length of NORE in PF/EVLXCEG. Applied fix  *
      *           213645.                                             *
      *           Applied fix annotated as 236334.                    *
      *  186315 - Amended PGM to reset field LLAM to 0 every time     *
      *           a new customer is processed. Applied fix 183230     *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  236334 - DLC0806 often fails due to FCOOB. Rename the field  *
      *           NORE in PF/FWDRTFD since its length is now different*
      *           from the length of NORE in PF/EVLXCEG. Applied fix  *
      *           213645.                                             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  194291 - Customer with zero exposure and zero limit should   *
      *           not be included in the exposure report.             *
      *  190544 - Forward rate limit and interest rate swap limit     *
      *           cannot be captured.  Limit defaulting should be     *
      *           done also for FR and IRS limits.                    *
     F*  191399 - Recompile due to removal of 160828 from EVLSX.      *
      *  184593 - Limits defined for Customer Number with no limits   *
      *           defined. Fix is to skip moving fields from SDLIMTPD *
      *           if not found.                                       *
      *  180278 - Incorrect amounts in field 'LIMIT' under LENDING.   *
     F*  179353 - No indication of MM Line Amount when expiry date is *
     F*           left blank.                                         *
     F*         - Display NO LIMIT instead of EXPIRED after MM field  *
     F*           if no record in Client Limits Maintenance.          *
     F*           Display Expiry date instead of blank after MM       *
     F*           field if with record.                               *
     F*           Display FWD RATE & RATE SWAP Expiry Dates if not    *
     F*           EXPIRED nor NO LIMIT.                               *
     F*  153759 - FX Spot Limits and FX Forward limits should always  *
     F*           be displayed on the report if they have been entered*
     F*  163486 - Recompile due to changes in LVENTEL.                *
      *  CDL006 - Dealing Fiduciary                                   *
     F*  160828 - Recompile due to changes in EVLSX.                  *
     F*  CDL002 - FX Netting. Exclude netted FX deal events and       *
     F*           include FX net events.                              *
     F*  097989 -  Print all customers with limits even if they have     *
     F*            exposures. Applied GEMS fix 093718.                   *
     F*            Duplicate information for Lending shown, *IN54 not    *
     F*            properly reset.                                       *
     F*  089129  - Recompile due to amended Forward Rates file FWDRTFE   *
     F*  S01408  - Core hook added: DL0760ACP1                           *
     F*            Core hook added: DL0760ACP2                           *
     F*  064258  - OUTPUTTING EXPIRED INSTEAD OF DEFAULT                 *
     F*       S01433 - Enhanced processing to include precious metals    *
     F*                and money market deals on the report              *
     F*              (NB. This function is to remain switchable until    *
     F*              after Alpha-site testing, when it will become       *
     F*              mandatory. At this point DL0760A  will be           *
     F*              renamed to DL0760 and the old version discarded.    *
     F*              Meanwhile version with SAR = DL0760A, without =     *
     F*              DL0760).                                            *
     F*  060636 - EXCEPTION REPORTING.                                   *
     F*  E38323 - Recompilation of the program done due to a             *
     F*           change in subroutine ZFWDT                             *
     F*       S01393 - Recompiled for Strategic Risk Management          *
     F*                Book Code added to PF/EVNTXED                     *
     F*       E26066 - Show limits with no expiry date as 'NO EXPIRY'    *
     F*                on report.                                        *
     F*                Also correct the use of indicators set up by      *
     F*                DT0023.                                           *
     F*       E28817 - STEVEAB and STEVEFC are now redundant             *
     F*       E25515 - REMOVAL OF SYNDICATED LOANS                       *
     F*       DT0023 - Program should skip expiry processing if expiry   *
     F*                date not entered.                                 *
     F*       E22512 -  TREAT ZEROS AS BLANKS ON TABLETS.                *E22512
     F*                 (superseded by BHF416 & S01194)
     F*       LN0728 - 'CONSOLIDATED' MISSING FROM REPORT TITLE          *LN0728
     F*       BHF416 - INCLUDE CUST NO. IN REPORT AND ALSO PREVENT       *
     F*                PRINTING EXTRA HEADINGS ALSO                      *
     F*                ASSUMES LAST LIMIT PERIOD WILL BE 999,
     F*                ACTUALLY IF LEFT BLANK WILL DEFAULT TO 000
     F*       BHF244  -  CALLS AOSYLNR0 UNNECESSARILY                    *BHF244
     F*       LN0442  -  REMOVE REDUNDANT CODING                         *LN0442
     F*       LN0236  -  AUDIT REPORT HEADING WAS BEING OVERWRITTEN BY   *LN0236
     F*                  UNDERLINING. UNDERLINING NOT LONG ENOUGH        *LN0236
     F*       LN0049  -  P1 printing headings when no details            *LN0049
     F*       E20711  -  Not printing IRS exposures as FRA field         *E20711
     F*                  RXPOS used in processing,instead of IXPOS.      *E20711
     F*       S01194  -  RELEASE 10 - NEW STANDING DATA                  *S01194
     F*       S01196  -  REMOVE LETTERS OF CREDIT                        *S01196
     F*       S01117  -  RELEASE 10 - MULTIBRANCHING                     *S01117
     F*       S01195  -  NEW HOLIDAY PROCESSING                          *S01195
     F*       S01157  -  STOP FRA/IRS DETAILS FROM BEING REPORTED        *S01157
     F*                  WITH LENDING. CHANGE FORMAT OF REPORT SO        *S01157
     F*                  ONE DEAL TYPE IS PRINTED PER LINE.              *S01157
     F*       E12072  -  A LOAN REPORTS AN EXPOSURE BEFORE THE VALUE     *E12072
     F*                  DATE WAS REACHED.                               *E12072
     F*       E10421  -  NOT PRINTING 'NO DETAILS TO REPORT'             *E10421
     F*       S01119  -  ALLOWS FOR 4 NEW EVENT TYPES FOR FRA/IRS.       *S01119
     F*       S1105   -  LIMITS EXCEPTION REPORTS                        *
0008 F*                                                                  *
0011 F********************************************************************
 012 F* ID F  C  H  L    FUNCTION OF INDICATORS                       *   S01157
     F**07************EVENT DETAIL - LETTERS OF CREDIT              S01157S01196
     F**08*********** EVENT DETAIL - SECURITIES TRADING             S01157BHF416
     F* 08            PRINT FIRST TIME HEADINGS                           BHF416
     F* 55            FUTURE RATE AGREEMENT PRINT LINE.               *   S01157
     F* 56            INTEREST RATE SWAP PRINT LINE.                  *   S01157
     F* 57            FRA/IRS NOT PRESENT DO NOT PRINT LINE.          *   S01157
     F* 85            No record on DEALS                              *   CDL002
     F*                                                               *   CDL002
     F*****************************************************************   CDL002
     F*                                                               *   CDL002
0012 FEVLSX   IP  E           K        DISK
     FFXNEVTL0IS  E           K        DISK                           U3  CDL002
      *                                                                   CDL002
     F/COPY WNCPYSRC,DL0760AF02
      * Deals                                                             CDL002
     FDEALS   IF  E           K        DISK                           UC  CDL002
     F            DEALSDAF                          KIGNORE               CDL002
     F            DEALSDCF                          KIGNORE               CDL002
     F            DEALSDDF                          KIGNORE               CDL002
     F            DEALSDEF                          KIGNORE               CDL002
     F            DEALSDFF                          KIGNORE               CDL002
     F            DEALSDGF                          KIGNORE               CDL002
     FFWDRT   IF  E           K        DISK                               S01433
0013 F*ABLE   IF  F      96 12AI     2 DISK                               S01194
0014 F*DL0760P1O***F*****132     OF    LPRINTER                     S01124S01117
0014 FDL0760AUO   F     132            PRINTER      KINFDS SPOOLU         S01117
   4 F*L0760P1O***F*****132     OF    LPRINTER      KINFDS SPOOL   S01117 060636
     FDL0760P1O   F     132     OF     PRINTER      KINFDS SPOOL          060636
     F/COPY WNCPYSRC,DL0760AF01
     E/EJECT
     E                    CPY@    1   1 80
0015 E                    FCT     1   4  4 0
0035 E                    HCCY       25  3
0035 E***********         INT         2 15 0                              CDL002
0035 E***********         DEC         2  3 0                              CDL002
     E                    INT         3 15 0                              CDL002
     E                    DEC         3  3 0                              CDL002
0016 E**   SIX  ARRAYS FOR FX LIMITS
0017 E                    XFDA        6  3 0             PERIOD END DAYS
0018 E                    XFDT        6  5 0             PERIOD END DATES
0019 E                    XFLM        6  9 0             PERIOD LIMIT AMT.
0020 E                    XFXP        6 13 0             PERIOD EXPOS AMT.
0021 E                    XFXS        6 10 0             PERIOD EXCES AMT.
0022 E                    XFPC        6  3 2             PERIOD PERCENTGE.
     E**   SIX  ARRAYS FOR METAL LIMITS                                   S01433
     E                    XPDA        6  3 0             PERIOD END DAYS  S01433
     E                    XPDT        6  5 0             PERIOD END DATES S01433
     E                    XPLM        6  9 0             PERIOD LIMIT AMT.S01433
     E                    XPXP        6 13 0             PERIOD EXPOS AMT.S01433
     E                    XPXS        6 10 0             PERIOD EXCES AMT.S01433
     E                    XPPC        6  3 2             PERIOD PERCENTGE.S01433
 023 E*****SIX*ARRAYS*FOR LOANS LIMITS.                                   S01433
 023 E**   SIX ARRAYS FOR MONEY MARKET LIMITS.                            S01433
0024 E                    XLDA        6  3 0             PERIOD END DAYS
0025 E                    XLDT        6  5 0             PERIOD END DATES
0026 E                    XLLM        6  9 0             PERIOD LIMIT AMT.
0027 E                    XLXP        6 13 0             PERIOD EXPOS AMT.
0028 E                    XLXS        6 10 0             PERIOD EXCES AMT.
0029 E                    XLPC        6  3 2             PERIOD PERCENTGE
0030 E*****ONE-ELEMENT COMPILE-TIME ARRAY - KEY TO LIMIT REC ON S/TABLE   S01194
0031 E*****               DLKY    1   1 12                                S01194
0032 E*****XFDA*&*XLDA DEFINED AS ALPHANUMERIC.                           S01433
     E**   XFDA & XPDA & XLDA DEFINED AS ALPHANUMERIC.                    S01433
0033 E                    XFDAA       6  3
     E                    XPDAA       6  3                                S01433
0034 E                    XLDAA       6  3
     E/COPY WNCPYSRC,DL0760AE01
      **  Arrays for Fiduciary Deposits                                   CDL006
      *                                                                   CDL006
     E                    FIDA        6  3 0             PERIOD END DAYS  CDL006
     E                    FIDT        6  5 0             PERIOD END DATES CDL006
     E                    FILM        6  9 0             PERIOD LIMIT AMT.CDL006
     E                    FIXP        6 13 0             PERIOD EXPOS AMT.CDL006
     E                    FIXS        6 10 0             PERIOD EXCES AMT.CDL006
     E                    FIPC        6  3 2             PERIOD PERCENTGE CDL006
     E                    FIDAA       6  3                                CDL006
      *                                                                   CDL006
0071 E                    ZYDY    4   4  4 0             ZDATE2 SR.ARRAY  S01117
0072 E                    ZMDY   13  13  3 0             ZDATE2 SR.ARRAY  S01117
0073 E                    ZMNM   12  12  3               ZDATE2 SR.ARRAY  S01117
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E** ARRAY USED TO CALCULATE THE NETTING OF FX DEALS                  S01433
     E                    FXBY      300 22                                S01433
     E                    FXSL      300 22                                S01433
     E                    FXNT      300 76                                S01433
     E*                                                                   S01433
     E** ARRAY USED IN CURRENCY AMOUNT CONVERSION                         S01433
     E                    POWER   1   7  7 3                              S01433
     E*                                                                   S01433
     E** DATE ARRAY                                                       S01433
     E                    DAT        26  5 0A                             S01433
     E*                                                                   S01433
     E** RATE ARRAY                                                       S01433
     E                    RAT        26 13 8                              S01433
     E*                                                                   S01433
     E** NUMBER OF DAYS FORWARD ARRAY                                     S01433
     E                    DFWW       25  5 0                              S01433
     E*                                                                   S01433
     E** FORWARD RATES ARRAY                                              S01433
     E                    RFWW       25 13 8                              S01433
     E*                                                                   S01433
0036 L*L0760P1*66FL*54OL****************                                  060636
0041 I*
0044 IEVLXCEDF    01
0042 I*    EVENTS FILE DETAIL RECORD
0043 I*    DEALING RECORD
0083 I*****                                         CNUM  L1              S01117
0083 I**********************************************CUNR  L1        S01117CDL002
0083 I                                              CUNR  L1M1            CDL002
     I/COPY WNCPYSRC,DL0760AI02
0083 I                                              CASK    M2            CDL002
     I/COPY WNCPYSRC,DL0760AI03
0074 I                                              PARI            10
0044 IEVNTXEDF    01
0083 I*****                                         CNUM  L1              S01117
0083 I**********************************************CUNR  L1        S01117CDL002
0083 I                                              CUNR  L1M1            CDL002
     I/COPY WNCPYSRC,DL0760AI04
0083 I                                              CASK    M2            CDL002
     I/COPY WNCPYSRC,DL0760AI05
0074 I                                              PARI            10
0092 I*           EVENTS LIMIT RECORD
0044 IEVLXCEEF    03
0083 I*****                                         CNUM  L1              S01117
0083 I**********************************************CUNR  L1        S01117CDL002
0083 I                                              CUNR  L1M1            CDL002
     I/COPY WNCPYSRC,DL0760AI06
0083 I                                              CASK    M2            CDL002
     I/COPY WNCPYSRC,DL0760AI07
0074 I                                              PARI            10
0092 I***********                                                         E25515
0094 I***********- COMMERCIAL LOANS EVENT                                 E25515
0114 I*****EVLSX*-                                         - DETAIL       E25515
0095 I***CEVNXCCF****04                                                   E25515
0133 I***********   BWCN                            CNUM  L1              E25515
0138 I***********                                   PARI            10    E25515
0140 I*
     ILVENTELF    05
     I**********CUSTOMER*LENDING EVENT                                    S01433
     I***       CUSTOMER MONEY MARKET EVENT                               S01433
0083 I*****                                         CNUM  L1              S01117
     I**********************************************CUNR  L1        S01117CDL002
0083 I                                              CUNR  L1M1            CDL002
     I/COPY WNCPYSRC,DL0760AI08
0083 I                                              CASK    M2            CDL002
     I/COPY WNCPYSRC,DL0760AI09
     I                                              PARI            10
     I              DFCE                            LCEQ
     I              CDOM                            CLOC
     I              ECDP                            DEC1
     I*
     I*BVNTXEDF****06                                                     S01196
     I**********                                    CNUM  L1              S01196
     I**********                                    PARI            10    S01196
     I*
     I*STEVEABF    07                                                     E28817
     I**********SECURITIES*TRADING*EVENT*-*DETAIL**********************   E28817
0083 I*****                                         CNUM  L1              S01117
     I**********                                    CUNR  L1        S01117E28817
     I**********                                    PARI            10    E28817
     I**********    DNEE                            LCEQ                  E28817
0141 I*
0161 I*    EVENTS FILE - TRAILER RECORD.
0162 I*
0143 IEVLXCEGF    02
0153 I*
     I*                                                                   CDL002
     I*    FX Net EVENTS FILE - RECORD.                                   CDL002
     I*                                                                   CDL002
     IFXNEVTD0    06                                                      CDL002
     I                                              CUNR  L1M1            CDL002
     I/COPY WNCPYSRC,DL0760AI10
     I                                              CASK    M2            CDL002
     I/COPY WNCPYSRC,DL0760AI11
     IFWDRTFDF                                                                                236334
     I              NORE                            NOREF                                     236334
0154 I*****                                                               S01194
0155 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0156 I*****                                                               S01194
0157 I*TABLE***NS       2 C0   3 C1  12 C1                                S01194
0158 I*****  AND      13 C0                                               S01194
0159 I*****                                   1   1 RECI                  S01194
0160 I*****                                   2   30RECT                  S01194
0161 I*****                                  12  130RCDE                  S01194
0162 I*****                                  14  66 TITL                  S01194
0163 I*****                                  67  67 DATF                  S01194
0164 I*****                                  68  700DFBR                  S01194
0165 I*****                                  74  74 MODI1                 S01194
0166 I*****                                  75  75 MODI2                 S01194
0167 I*****                                  76  76 MODI3                 S01194
0168 I*****                               P  77  790RUND                  S01194
0169 I*****                                  80  86 RUNA                  S01194
0170 I*****                                  87  870SFLG                  S01194
0171 I*****                               P  90  920LCD                   S01194
0172 I*****                                  93  93 CHTP                  S01194
0173 I*****                               P  94  960TNLU                  S01194
0174 I*****                                                               S01194
0175 I*****                                                               S01194
0176 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0177 I*****                                                               S01194
0178 I*TABLE***NS       1 CD   2 C0   3 C1                                S01194
0179 I*****  AND      12 C1  13 C1                                        S01194
0180 I*****                                   1   1 RECI                  S01194
0181 I*****                                   2   30RECT                  S01194
0182 I*****                                  12  130RCDE                  S01194
0183 I*****                                  14  16 BCCY                  S01194
0184 I*****                                  17  19 BCYL                  S01194
0185 I*****                                  20  22 HOCY                  S01194
0186 I*****                                  23  280HEAD                  S01194
0187 I*****                               P  29  310APDA                  S01194
0188 I*****                                  35  35 APFQ                  S01194
0189 I*****                               P  36  380LOGS                  S01194
0190 I*****                                  39  40 CUZR                  S01194
0191 I*****                               P  41  430DNWD                  S01194
0192 I*****                                  44  460BVLP                  S01194
0193 I*****                                  47  49 LOCY                  S01194
0194 I*****                                  50  510FDAY                  S01194
0195 I*****                                  86  86 ISAV                  S01194
0196 I*****                               P  87  890LLOG                  S01194
0197 I*****                               P  90  920LCD                   S01194
0198 I*****                                  93  93 CHTP                  S01194
0199 I*****                               P  94  960TNLU                  S01194
0209 I*****                                                               S01194
0210 I*****TABLE FILE - LIMIT TYPES RECORD.                               S01194
0211 I*****                                                               S01194
0212 I*TABLE***NS       1 CD   2 C4   3 C5                                S01194
0213 I*****                                   1   1 RECI                  S01194
0214 I*****                                   2   30RECT                  S01194
0215 I*****                                  11  130LMTP                  S01194
0216 I*****                                  14  16 LEP1                  S01194
0217 I*****                                  17  19 LEP2                  S01194
0218 I*****                                  20  22 LEP3                  S01194
0219 I*****                                  23  25 LEP4                  S01194
0220 I*****                                  26  28 LEP5                  S01194
0221 I*****                                  29  31 LEP6                  S01194
0222 I*****                                  32  340LPC1                  S01194
0223 I*****                                  35  370LPC2                  S01194
0224 I*****                                  38  400LPC3                  S01194
0225 I*****                                  41  430LPC4                  S01194
0226 I*****                                  44  460LPC5                  S01194
0227 I*****                                  47  490LPC6                  S01194
0228 I*****                               P  90  920LCD                   S01194
0229 I*****                                  93  93 CHTP                  S01194
0230 I*****                               P  94  960TNLU                  S01194
0231 I*****                                  14  31 LEPSIN                S01194
0232 I*****                                  32  49 LPCSIN                S01194
0233 I*****                                                               S01194
0257 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0258 I*****                                                               S01194
0259 I*TABLE***NS       1 CD   2 C2   3 C0                                S01194
0260 I*****  AND      13 C1                                               S01194
0261 I*****                                   1   1 RECI                  S01194
0262 I*****                                   2   30RECT                  S01194
0263 I*****                                  10  12 CCY                   S01194
0264 I*****                                  13  130SREC                  S01194
0265 I*****                                  14  27 CCNM                  S01194
0266 I*****                               P  28  348SPOT                  S01194
0267 I*****                                  35  37 CCYS                  S01194
0268 I*****                                  38  380CDP                   S01194
0269 I*****                                  39  390TNOT                  S01194
0270 I*****                                  40  40 DCCY                  S01194
0271 I*****                                  41  44 SRC1                  S01194
0272 I*****                                  45  48 SRC2                  S01194
0273 I*****                                  49  520TACC                  S01194
0274 I*****                                  53  560TEQV                  S01194
0275 I*****                                  57  600SWQV                  S01194
0276 I*****                                  61  640TAC4                  S01194
0277 I*****                                  65  680TAC5                  S01194
0278 I*****                                  69  69 HIND                  S01194
0279 I*****                               P  70  768PART                  S01194
0280 I*****                                  77  780SSNO                  S01194
0281 I*****                               P  79  858ERLC                  S01194
0282 I*****                               P  90  920LCD                   S01194
0283 I*****                                  93  93 CHTP                  S01194
0284 I*****                               P  94  960TNLU                  S01194
0285 I*****                                                               S01194
0286 I*****TABLE FILE - HOLIDAY RECORD.                                   S01195
0287 I*****   E-EXCLUDE, I-INCLUDE.                                       S01195
0288 I*****                                                               S01195
0289 I*TABLE***NS       1 CD   2 C2   3 C2                                S01195
0290 I*****  AND      14 CE                                               S01195
0291 I*****  OR        1 CD   2 C2   3 C2                                 S01195
0292 I*****  AND      14 CI                                               S01195
0293 I*****                                   1   1 RECI                  S01195
0294 I*****                                   2   30RECT                  S01195
0295 I*****                                   8  120HOL                   S01195
0296 I*****                                  13  130SREC                  S01195
0297 I*****                                  14  14 INEX                  S01195
0298 I*****                                  15  89 HCCY                  S01195
0299 I*****                               P  90  920LCD                   S01195
0300 I*****                                  93  93 CHTP                  S01195
0301 I*****                               P  94  960TNLU                  S01195
0302 I*****                                                               S01195
     I*****                                                       S01157  S01194
     I*****                                                       S01157  S01194
     I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.       S01157  S01194
     I*****                                                       S01157  S01194
     I*****   NS       1 CD   2 C0   3 C1                         S01157  S01194
     I*****  AND      12 C4  13 C0                                S01157  S01194
     I*****                                  14  14 IRFRA         S01157  S01194
0303 I*****                                                               S01194
0304 I*****CATCHALL                                                       S01194
0305 I*****   NS                                                          S01194
0306 I*****                                   1   1 RECI                  S01194
0307 I*****                                   2   30RECT                  S01194
0308 I*****                                                               S01194
0309 I*****                                                               S01194
0310 I*****                                                               S01194
     E/COPY ZSRSRC,ZHOLI                                                  S01195
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     ISDDEAL    E DSSDDEALPD                                              S01194
     I** EXTERNAL DS FOR DEALING DETAILS                                  S01194
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01194
     I************                                                  S01194BHF244
     I*SDSYLN****E DSSDSYLNPD                                       S01194BHF244
     I***EXTERNAL*DS FOR SYNDICATED LOANS DETAILS                   S01194BHF244
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I** EXTERNAL DS FOR MIDAS MODULES DETAILS                            S01194
     I*                                                                   S01194
     I*SDCLLM****E*DSSDCLLMPD************                           S01194LN0442
     I** EXTERNAL*DS*FOR*CUSTOMER*LIMITS*DETAILS                    S01194LN0442
     I*                                                                   S01194
     ISDLIMT    E DSSDLIMTPD                                              S01194
     I** EXTERNAL DS FOR LIMITS DETAILS                                   S01194
     I*
     ISDCLLM    E DSSDCLLMPD                                              CDL006
      ** External DS for Client Limits                                    CDL006
      *                                                                   CDL006
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01117
     ISPOOL       DS                                                      S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
0312 I**                                                                  S01117
0311 I********************************************************************S01117
     I**                                                                  S01117
0313 I**   DATA STRUCTURES TO LINK XFDAA/XFDA & XLDAA/XLDA & INPUT FIELDS
0314 I            DS
0315 I                                        1  18 XFDA
0316 I                                        1  18 XFDAA
0317 I                                        1  18 XFDAIN
0318 I            DS
0319 I                                        1  18 XLDA
0320 I                                        1  18 XLDAA
0321 I                                        1  18 XLDAIN
0322 I            DS
0323 I                                        1  18 XFPC
0324 I                                        1  18 XFPCIN
     I**   DATA STRUCTURES TO LINK XPDAA/XPDA & INPUT FIELDS              S01433
     I            DS                                                      S01433
     I                                        1  18 XPDA                  S01433
     I                                        1  18 XPDAA                 S01433
     I                                        1  18 XPDAIN                S01433
     I            DS                                                      S01433
     I                                        1  18 XPPC                  S01433
     I                                        1  18 XPPCIN                S01433
     I*                                                                   S01433
     I** DATA STRUCTURE FOR BUY AMOUNT AND CURRENCY                       S01433
     I            DS                                                      S01433
     I                                        1  22 FXBYDS                S01433
     I                                        1   3 ECCY                  S01433
     I                                        4  160EAMT                  S01433
     I                                       17  210BDAT                  S01433
     I                                       22  22 BCLO                  S01433
     I*                                                                   S01433
     I** DATA STRUCTURE FOR SELL AMOUNT AND CURRENCY                      S01433
     I            DS                                                      S01433
     I                                        1  22 FXSLDS                S01433
     I                                        1   3 OTHC                  S01433
     I                                        4  160OTHA                  S01433
     I                                       17  210SDAT                  S01433
     I                                       22  22 SCLO                  S01433
     I*                                                                   S01433
     I** DATA STRUCTURE TO RESTORE NETTED FX DEALS DETAILS                S01433
     I            DS                                                      S01433
     I                                        1  64 FXNTDS                S01433
     I                                        1   60FXDLNO                S01433
     I                                        7   7 FXCLOP                S01433
     I                                        8  200FXEAMT                S01433
     I                                       21  23 FXECCY                S01433
     I                                       24  360FXOTHA                S01433
     I                                       37  39 FXOTHC                S01433
     I                                       40  41 FXDTYP                S01433
     I                                       42  460FXEDAT                S01433
     I                                       47  510FXOTHD                S01433
     I                                       52  640FXLCEQ                S01433
0314 ILEPSIN      DS                                                      S01194
     I* DATA STRUCTURE OF END/1ST TO 6TH LIMIT PERIODS                    S01194
0216 I                                        1   3 XLEP1                 S01194
0217 I                                        4   6 XLEP2                 S01194
0218 I                                        7   9 XLEP3                 S01194
0219 I                                       10  12 XLEP4                 S01194
0220 I                                       13  15 XLEP5                 S01194
0221 I                                       16  18 XLEP6                 S01194
0314 ILPCSIN      DS                                                      S01194
     I* DATA STRUCTURE OF %/LIMIT FOR 1ST TO 6TH PERIODS                  S01194
0222 I                                        1   30XLPC1                 S01194
0223 I                                        4   60XLPC2                 S01194
0224 I                                        7   90XLPC3                 S01194
0225 I                                       10  120XLPC4                 S01194
0226 I                                       13  150XLPC5                 S01194
0227 I                                       16  180XLPC6                 S01194
0325 I            DS
0326 I                                        1  18 XLPC
0327 I                                        1  18 XLPCIN
     I*                                                                   S01433
     I**   TO FILL DATE ARRAY                                             S01433
     IWWDS1       DS                                                      S01433
     I                                        1  75 DFW                   S01433
     I                                    P   1  75 DFWW                  S01433
     I*                                                                   S01433
     I**   TO FILL FORWARD RATES ARRAY                                    S01433
     IWWDS2       DS                                                      S01433
     I                                        1 175 RFW                   S01433
     I                                    P   1 175 RFWW                  S01433
     I/COPY WNCPYSRC,DL0760AI01
     I            DS                                                      CDL006
     I                                        1  18 FIDA                  CDL006
     I                                        1  18 FIDAA                 CDL006
     I                                        1  18 FIDAIN                CDL006
      *                                                                   CDL006
     I            DS                                                      CDL006
     I                                        1  18 FIPC                  CDL006
     I                                        1  18 FIPCIN                CDL006
     I*                                                                   S01433
     C/EJECT
     C*
0111 C*
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C*                                                                   S01117
0328 C**   ON FIRST CYCLE
0329 C   40                GOTO DETAIL
     C           *LIKE     DEFN A6SPRT    WWSPRT                          S01433
     C           *LIKE     DEFN A6NBDP    WWDECP                          S01433
     C           *LIKE     DEFN A6MDIN    WWMDIV                          S01433
     C           *LIKE     DEFN DLVALU    WWDATE                          S01433
     C***********          MOVE 'N'       NETFX   1                 S01433CDL002
     C*                                                                   S01433
     C**   INITIALISE VARIOUS ARRAY ELEMENTS                              S01433
     C                     Z-ADD1         L       20                      S01433
     C                     Z-ADD1         M       20                      S01433
     C                     Z-ADD1         N       20                      S01433
     C                     Z-ADD1         P       20                      S01433
     C                     Z-ADD1         Y       20                      S01433
0330 C**
0331 C*****                EXSR ZSYSTM                                    S01194
0332 C***99                SETON                     U7U8LR               S01194
0333 C*****                MOVE '1'       ZTABKY                          S01194
0334 C*****      ZTABKY    CHAINTABLE                40                   S01194
0335 C***40                SETON                     U7U8LR               S01194
0336 C***40                                                               S01194
0337 C*R*99**              GOTO END                                       S01194
0338 C*****                                                               S01194
0339 C*****                MOVEL'20      'TABKEY 12                       S01194
0340 C*****                MOVELBCYL      WK4     4                       S01194
0341 C*****                MOVE '1'       WK4                             S01194
0342 C*****                MOVE WK4       TABKEY                          S01194
0343 C*****      TABKEY    CHAINTABLE                40                   S01194
0344 C***40                SETON                     U7U8LR               S01194
0345 C***40                GOTO END                                       S01194
     C*****                                                       S01157  S01194
     C*****CHAIN TO INSTALLATION CONTROL DATA RECORD 5 TO CHECK   S01157  S01194
     C*****WHETHER FRA/IRS PRESENT, IF NOT DO NOT PRINT.          S01157  S01194
     C*****                                                       S01157  S01194
     C*****                MOVEL'01      'TABKEY                  S01157  S01194
     C*****                MOVE '  40'    TABKEY                  S01157  S01194
     C*****      TABKEY    CHAINTABLE                40           S01157  S01194
     C***40                SETON                     U7U8LR       S01157  S01194
     C***40                GOTO END                               S01157  S01194
     C*****                                                       S01157  S01194
     C                     MOVEACPY@      BIS@   80
     C/COPY WNCPYSRC,DL0760AC01
      *                                                                   CDL006
      **  Access SAR Details File to determine if Fiduciary Deposits is   CDL006
      **  installed                                                       CDL006
      *                                                                   CDL006
     C                     MOVEL'N'       CDL006  1                       CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM '       ' PRTCD   7                       CDL006
     C                     PARM '*VERIFY' POPTN   7                       CDL006
     C                     PARM 'CDL006'  PSARD   6                       CDL006
      *                                                                   CDL006
     C           PRTCD     IFEQ *BLANK                                    CDL006
     C                     MOVEL'Y'       CDL006                          CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
     C           PRTCD     IFNE *BLANKS                                   CDL006
     C           PRTCD     ANDNE'*NRF   '                                 CDL006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CDL006
     C                     MOVEL'008'     DBASE            * DBERR  8 *   CDL006
     C                     MOVELPOPTN     DBOPTN           ************   CDL006
     C                     MOVELPOPTN     DBKEY                           CDL006
     C                     MOVE *ON       *INU7                           CDL006
     C                     MOVE *ON       *INU8                           CDL006
     C                     MOVE *ON       *INLR                           CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     GOTO END                                       CDL006
     C                     ENDIF                                          CDL006
     C*                                                                   S01194
     C* Call Access Prog. For BANK DETAILS.                               S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C* If error occurs...                                                S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'01'      DBASE   3        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C** TEST DATE FORMAT VALUE                                           S01194
0951 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0951 C*                                                                   S01194
     C* Call Access Prog. To Obtain DEAL DETAILS For Base CCY For Limits  S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
0951 C*                                                                   S01194
     C* If error occurs...                                                S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDEALPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0951 C*                                                                   S01194
     C* Call Access Prog. to obtain CURRENCY DETAILS for Decimal Places   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BNCYCD    @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
0951 C*                                                                   S01194
     C* If error occurs...                                                S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE           ************   S01194
     C                     MOVEL'03'      DBASE            * DBERR 03 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     MOVEL@AJCD     DBKEY  29                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0951 C*                                                                   S01194
0346 C           A6NBDP    ADD  1         DEP     10                      S01433
     C                     Z-ADDA6NBDP    WWDPI   10                      S01433
0951 C***********                                                   S01194BHF244
     C**Call*Access Prog. to obtain SYNDICATED LOANS DETAIL.        S01194BHF244
     C***********          CALL 'AOSYLNR0'                          S01194BHF244
     C***********          PARM '*MSG   ' @RTCD   7                 S01194BHF244
     C***********          PARM '*FIRST ' @OPTN   7                 S01194BHF244
     C***********SDSYLN    PARM SDSYLN    DSFDY                     S01194BHF244
0951 C***********                                                   S01194BHF244
     C**If*error*occurs...                                          S01194BHF244
     C***********@RTCD     IFNE *BLANK                              S01194BHF244
     C***********          MOVEL'SDSYLNPD'DBFILE        ************S01194BHF244
     C***********          MOVEL'04'      DBASE         * DBERR 04 *S01194BHF244
     C***********          MOVEL@OPTN     DBOPTN  7     ************S01194BHF244
     C***********          MOVEL@OPTN     DBKEY                     S01194BHF244
     C***********          SETON                     U7U8LR         S01194BHF244
     C***********          EXSR *PSSR                               S01194BHF244
     C***********          GOTO END                                 S01194BHF244
     C***********          END                                      S01194BHF244
0356 C***********                                                   S01194BHF244
0349 C*****WHETHER 'EVENTS TO END OF BOOK' INDICATOR IS 'Y'         S01194BHF244
0356 C***********BOGEEB    COMP 'Y'                      78         S01194BHF244
0951 C*                                                                   S01194
     C* Call Access Prog. For MODULE DETAILS.                             S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
0951 C*                                                                   S01194
     C* If error occurs...                                                S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDMMODPD'DBFILE           ************   S01194
     C                     MOVEL'05'      DBASE            * DBERR 05 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     MOVEL@OPTN     DBKEY                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   S01157
     C**   CHECK WHETHER FRA/IRS PRESENT. IF NOT DO NOT PRINT.            S01157
     C*****      IRFRA     IFEQ 'Y'                                 S01157S01194
     C           BGFIIN    IFEQ 'Y'                                       S01194
     C                     SETON                     57                   S01157
     C                     ELSE                                           S01157
     C                     SETOF                     57                   S01157
     C                     END                                            S01157
0357 C**
0358 C*    OBTAIN NO. OF DAYS FORWARD FOR 'SP'
0359 C*****                Z-ADDRUND      ZDAYNO                          S01194
0360 C*****                MOVE BCYL      ZCCY                            S01194
0359 C                     Z-ADDBJRDNB    ZDAYNO                          S01194
0360 C                     MOVE BNCYCD    ZCCY                            S01194
0361 C                     Z-ADD2         ZNRDYS
0361 C                     MOVE BJSLCD    ZLOC                            S01195
0362 C                     EXSR ZFWDT                                     S01195
0362 C*****                EXSR ZDATE3                                    S01195
0363 C*****      ZDYNBR    SUB  RUND      SP      50                      S01194
0363 C           ZDYNBR    SUB  BJRDNB    SP      50                      S01194
     C           BJRDNB    ADD  SP        RUND2   50                      S01433
0364 C*****                                                               S01117
0365 C*****SET OF SO THAT FIRST PAGE HEADINGS ARE FETCHED                 S01117
0366 C*****                SETON                         OF               S01117
0367 C**
     C/COPY WNCPYSRC,DL0760AC15
0368 C                     SETON                     40
      *                                                                   CDL002
      * FX Netting?                                                       CDL002
     C                     MOVE 'N'       CDL002  1                       CDL002
     C           *INU3     IFEQ *ON                                       CDL002
     C                     MOVE 'Y'       CDL002                          CDL002
      * Net FX Customer Exposure?                                         CDL002
     C           BNNTCE    IFEQ 'Y'                                       CDL002
     C                     MOVE BNNTCE    W#NTCE  1                       CDL002
     C                     OPEN DEALS                                     CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
     C                     Z-ADD*ZERO     WWAMT  150                      CDL002
     C                     MOVE *BLANKS   WWCCY   3                       CDL002
      *                                                                   CDL002
0342 C           DETAIL    TAG                             ** DETAIL TAG *
0370 C   02                GOTO TRAILR
0371 C**N01N03N04******                                                   E25515
     C  N01N03                                                            E25515
     CANN06                                                               CDL002
     C*NN05N06N07**********GOTO END                                       S01196
     C*ANN05N07            GOTO END                                S01196 E28817
     CANN05                GOTO END                                       E28817
0372 C**
0373 C**   CONTROL TOTALS
     C           *IN06     IFEQ '0'                                       CDL002
0374 C           RREAD     ADD  1         RREAD   70
     C                     ELSE                                           CDL002
     C           NREAD     ADD  1         NREAD   70                      CDL002
     C                     END                                            CDL002
0361 C**                                                                  S01117
0379 C**   DETAILS TO REPORT                                              S01117
0364 C**                                                                  S01117
0365 C**   SET OVERFLOW IND. AND WRITE HEADINGS FOR FIRST TIME            S01117
0366 C**N31****************SETON                         OF        S01117 LN0049
     C**N31****************EXCPTHEADS                              S01117 LN0049
     C*                                                                   BHF416
     C** PRINT HEADINGS FOR THE FIRST TIME                                BHF416
     C           @FIRST    IFEQ ' '                        B1             BHF416
     C                     SETON                         08*1             BHF416
     C                     MOVE 'Y'       @FIRST  1        *1             BHF416
     C                     END                             E1             BHF416
     C*                                                                   BHF416
0366 C***L1N31*************SETON                         OF               LN0049
     C   L1N31             EXCPTHEADS                                     LN0049
     C                     SETOF                         08               BHF416
     C**                                                                  S01117
     C   01
     COR 06                                                               CDL002
     COR 03                SETON                     80
0349 C  N03      EAMT      DIV  1000      ZZAMT        25
0350 C  N03 25             Z-SUBZZAMT     ZZAMT
     C           *IN06     IFEQ '0'                                       CDL002
0351 C  N03                Z-ADD1         S       10
     C                     ELSE                                           CDL002
     C                     Z-ADD3         S                               CDL002
     C                     END                                            CDL002
0352 C  N03                EXSR HASH
0353 C**
0354 C**   DISREGARD RECORDS WITH FACILITY OR ROLLOVER - Y
0355 C   01      RLVI      COMP 'Y'                      41
0356 C   01N41   FCTI      COMP 'Y'                      41
0357 C   01 41NL1          GOTO END
0358 C**   ON CHANGE OF CUSTOMER CHAIN TO CUSTOMER FILE.
0951 C*                                                                   S01194
0359 C   L1N03             Z-ADD0         FLTY
     C   L1N03             Z-ADD0         LIPLTY                          S01433
0360 C   L1N03             Z-ADD0         LLTY
0360 C   L1N03             Z-ADD0         FRAM                            S01157
0360 C   L1N03             Z-ADD0         IRAM                            S01157
     C   L1N03             Z-ADD0         LLAM                            186315
     C/COPY WNCPYSRC,DL0760AC02
     C           *INL1     IFEQ '1'                                                           232996
     C           *IN03     ANDEQ'0'                                                           232996
     C                     Z-ADD0         FLED                                                232996
     C                     END                                                                232996
      *                                                                   CDL006
      ** If CDL006 is installed, access client limit file                 CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C   L1N03             Z-ADD0         FIFILT                          CDL006
      *                                                                   CDL006
      ** Retrieve the fiduciary limit type and limit amount               CDL006
      *                                                                   CDL006
     C           *INL1     IFEQ *ON                                       CDL006
     C           *IN03     ANDEQ*ON                                       CDL006
     C                     CALL 'AOCLLMR0'                                CDL006
     C                     PARM *BLANKS   PRTCD                           CDL006
     C                     PARM '*KEY   ' POPTN                           CDL006
     C                     PARM CUNR      PCUST   6                       CDL006
     C                     PARM 'S'       PLEVL   1                       CDL006
     C                     PARM 'SYS'     PBCCD   3                       CDL006
     C           SDCLLM    PARM SDCLLM    DSFDY                           CDL006
      *                                                                   CDL006
     C           PRTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE DZFXLT    FIFILT  30                      CDL006
     C                     Z-ADDDZFLAM    FIFILA  90                      CDL006
     C                     ELSE                                           CDL006
     C                     Z-ADD*ZEROS    FIFILT                          CDL006
     C                     Z-ADD*ZEROS    FIFILA                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
0434 C**
0363 C*   - AND THEN CHAIN TO THE LIMITS FILE
0363 C*   - TO SET UP LIMIT PERIODS & AMOUNTS
0364 C   L1                EXSR DLLMT
     C   L1                MOVE 'N'       NAMPRT  1                       S01433
     C   L1                Z-ADD*ZERO     J       30                      S01433
     C   L1                MOVEA*BLANKS   FXBY                            S01433
     C   L1                MOVEA*BLANKS   FXSL                            S01433
     C   L1                MOVEA*BLANKS   FXNT                            S01433
0365 C   L1 03             GOTO END
0366 C   L1 41 01          GOTO END
0440 C**
0441 C**   CHECK IF EVENT TYPE FOR FX DEAL.
0442 C           FXCHEK    TAG                             **  FXCHEK  **
0443 C           ETYP      COMP '11V1'                   42
0444 C  N42      ETYP      COMP '12V1'                   42
0445 C  N42      ETYP      COMP '13V1'                   42
0446 C  N42      ETYP      COMP '14V1'                   42
     C  N42      ETYP      COMP 'NTV1'                   42               CDL002
     C/COPY WNCPYSRC,DL0760AC16
0447 C**
     C*****-*IF*SO*-*CALCULATE EXPOSURE                                   S01433
0449 C  N42                GOTO LONCHK
      *                                                                   CDL002
      *                                                                   CDL002
      * Net FX Customer Exposure?                                         CDL002
     C           W#NTCE    IFEQ 'Y'                                       CDL002
      *   FX Deal Events                                                  CDL002
     C           *IN01     IFEQ *ON                                       CDL002
      *                                                                   CDL002
     C           DLNO      CHAINDEALSDBF             85                   CDL002
     C           *IN85     IFEQ *ON                                       CDL002
     C                     MOVEL'DEALS   'DBFILE           ************   CDL002
     C                     MOVEL'07'      DBASE            * DBERR 07 *   CDL002
     C                     MOVELDLNO      DBKEY            ************   CDL002
     C                     SETON                     U7U8LR               CDL002
     C                     EXSR *PSSR                                     CDL002
     C                     GOTO END                                       CDL002
     C                     ELSE                                           CDL002
     C*   Exclude netted FX deal events                                   CDL002
     C           NETBR     IFNE *BLANKS                                   CDL002
     C                     GOTO LONCHK                                    CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
      *   Net buy event                                                   CDL002
     C           *IN06     IFEQ *ON                                       CDL002
     C*     Include FX net buy events                                     CDL002
     C           INOI      IFNE 'I'                                       CDL002
     C           W#NTCE    ORNE 'Y'                                       CDL002
     C                     GOTO LONCHK                                    CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
0376 C*
0377 C**   - COUNT RECORDS READ IN THIS REPORT
0378 C           RLIST     ADD  1         RLIST   70
0379 C*
0380 C                     Z-ADD2         S
0381 C                     EXSR HASH
     C*********************                                         S01433CDL002
     C**Condition*FX*netting.                                       S01433CDL002
     C***********NETFX*****IFEQ 'Y'                                 S01433CDL002
     C*********************MOVE 'N'       FXCLOP                    S01433CDL002
     C*********************MOVE DLNO      FXDLNO                    S01433CDL002
     C*********************Z-ADDEAMT      FXEAMT                    S01433CDL002
     C*********************MOVE ECCY      FXECCY                    S01433CDL002
     C*********************Z-ADDOTHA      FXOTHA                    S01433CDL002
     C*********************MOVE OTHC      FXOTHC                    S01433CDL002
     C*********************MOVE DTYP      FXDTYP                    S01433CDL002
     C*********************MOVE EDAT      FXEDAT                    S01433CDL002
     C*********************MOVE OTHD      FXOTHD                    S01433CDL002
     C*********************MOVE LCEQ      FXLCEQ                    S01433CDL002
     C*********************Z-ADDEDAT      BDAT                      S01433CDL002
     C*********************Z-ADDEDAT      SDAT                      S01433CDL002
     C*********************MOVE 'N'       SCLO                      S01433CDL002
     C*********************MOVE 'N'       BCLO                      S01433CDL002
     C*********************                                         S01433CDL002
     C*********************MOVE '0'       *IN21                     S01433CDL002
     C*********************ADD  1         J                         S01433CDL002
     C*********************Z-ADD1         K       30                S01433CDL002
     C***********FXBYDS****LOKUPFXSL,K                   21         S01433CDL002
     C************IN21*****IFEQ '1'                                 S01433CDL002
     C*********************MOVE 'Y'       FXCLOP                    S01433CDL002
     C*********************MOVE FXNTDS    FXNT,K                    S01433CDL002
     C*********************MOVE 'Y'       SCLO                      S01433CDL002
     C*********************MOVE FXSLDS    FXSL,K                    S01433CDL002
     C*********************ELSE                                     S01433CDL002
     C***********FXSLDS****LOKUPFXBY,K                   21         S01433CDL002
     C************IN21*****IFEQ '1'                                 S01433CDL002
     C*********************MOVE 'Y'       FXCLOP                    S01433CDL002
     C*********************MOVE FXNTDS    FXNT,K                    S01433CDL002
     C*********************MOVE 'Y'       BCLO                      S01433CDL002
     C*********************MOVE FXBYDS    FXBY,K                    S01433CDL002
     C*********************END                                      S01433CDL002
     C*********************END                                      S01433CDL002
     C*********************                                         S01433CDL002
     C*********************MOVE FXNTDS    FXNT,J                    S01433CDL002
     C*********************MOVE FXBYDS    FXBY,J                    S01433CDL002
     C*********************MOVE FXSLDS    FXSL,J                    S01433CDL002
     C*********************                                         S01433CDL002
     C*********            END                                            000040
     C*********************ELSE                                     000040CDL002
     C*                                                                   000017
0450 C                     Z-ADDEDAT      DLVALU
0383 C*****      CDP       ADD  1         DEP                     *****   S01194
0383 C********** A6NBDP    ADD  1         DEP                      S01194 000040
0451 C           LCEQ      DIV  FCT,DEP   DLAMTF    H
0452 C*********            EXSR DLEXPF                                    000040
     C*                                                                   000040
     C* Call Access Prog. to check for precious metal deal                000040
     C                     MOVE '0'       *IN74                           000040
     C                     CALL 'AOCURRR0'                                000040
     C                     PARM '*MSG   ' @RTCD   7                       000040
     C                     PARM '*KEY   ' @OPTN   7                       000040
     C                     PARM ECCY      @AJCD   3                       000040
     C           SDCURR    PARM SDCURR    DSSDY                           000040
     C*                                                                   000040
     C           @RTCD     IFEQ *BLANK                                    000040
     C           A6PMRT    ANDEQ'Y'                                       000040
     C                     MOVE '1'       *IN74                           000040
     C*                                                                   000040
     C                     ELSE                                           000040
     C                     CALL 'AOCURRR0'                                000040
     C                     PARM '*MSG   ' @RTCD   7                       000040
     C                     PARM '*KEY   ' @OPTN   7                       000040
     C                     PARM OTHC      @AJCD   3                       000040
     C           SDCURR    PARM SDCURR    DSSDY                           000040
     C*                                                                   000040
     C           @RTCD     IFEQ *BLANK                                    000040
     C           A6PMRT    ANDEQ'Y'                                       000040
     C                     MOVE '1'       *IN74                           000040
     C                     END                                            000040
     C*                                                                   000040
     C                     END                                            000040
     C**   CALCULATE EXPOSURE FOR NON PRECIOUS METAL DEAL                 000040
     C  N74                EXSR DLEXPF                                    000040
     C*                                                                   000040
     C**   CALCULATE EXPOSURE FOR PRECIOUS METAL DEAL                     000040
     C   74                EXSR PMEXPF                                    000040
     C*********************END                                      000040CDL002
     C*                                                                   000040
0454 C**
0455 C**   CHECK IF EVENT TYPE FOR LOAN DEAL.
0456 C           LONCHK    TAG                             **  LONCHK  **
0389 C           ETYP      COMP '15M1'                   42
0390 C  N42      ETYP      COMP '17M1'                   42
0391 C  N42      ETYP      COMP '17S1'                   42
     C*****FRA/IRS*EVENTS NO LONGER INCLUDED IN LENDING            S01157 S01433
     C**   FRA/IRS EVENTS NO LONGER INCLUDED IN MONEY MARKET              S01433
     C*                                                                   S01157
0465 C**N42      ETYP      COMP '21E1'                   42        S01119 S01157
0466 C**N42      ETYP      COMP '22E1'                   42        S01119 S01157
0467 C**N42      ETYP      COMP '23E1'                   42        S01119 S01157
0468 C**N42      ETYP      COMP '24E1'                   42        S01119 S01157
     C  N42      ETYP      COMP '30P1'                   42
     C  N42      ETYP      COMP '30S1'                   42
     C  N42      ETYP      COMP '30C1'                   42
     C  N42      ETYP      COMP '30C2'                   42
     C  N42      ETYP      COMP '30A1'                   42
     C  N42      ETYP      COMP '30D1'                   42
     C  N42      ETYP      COMP '30D2'                   42
     C  N42      ETYP      COMP '30M1'                   42
     C  N42      ETYP      COMP '30M2'                   42
0392 C**
     C           ETYP      COMP '15V1'                   44               E12072
     C  N44      ETYP      COMP '17V1'                   44               E12072
     C*
0475 C**   - IF SO - CALCULATE EXPOSURE
0394 C**N42******          GOTO END   **************               E12072 S01157
0476 C**N42N44             GOTO END                                E12072 S01157
0476 C  N42N44             GOTO FRAIRS                                    S01157
0396 C**
0397 C**   - COUNT RECORDS READ IN THIS REPORT
0398 C           RLIST     ADD  1         RLIST
0399 C*
0400 C                     Z-ADD2         S
0401 C                     EXSR HASH
0477 C                     Z-ADDEDAT      DLMATD
0403 C*****      CDP       ADD  1         DEP     10              *****   S01194
0383 C********** A6NBDP    ADD  1         DEP     10               S01194 000040
0478 C           LCEQ      DIV  FCT,DEP   DLAMTL    H
0479 C                     EXSR DLEXPL
     C*                                                                   S01157
     C**     CHECK FOR FRA/IRS EVENT TYPES. CALCULATE EXPOSURE            S01157
     C*                                                                   S01157
     C           FRAIRS    TAG                             **  FRAIRS  ** S01157
     C* FRA EVENT                                                         S01157
     C           ETYP      IFEQ '21E1'                                    S01157
     C           RLIST     ADD  1         RLIST                           S01157
     C                     Z-ADD2         S                               S01157
     C                     EXSR HASH                                      S01157
     C                     Z-ADDEDAT      DLVALU                          S01157
     C*****      CDP       ADD  1         DEP                     S01157  S01194
     C********** A6NBDP    ADD  1         DEP                      S01194 000040
     C           LCEQ      DIV  FCT,DEP   DLAMTF    H                     S01157
     C           RXPOS     ADD  DLAMTF    RXPOS                           S01157
     C                     END                                            S01157
     C* IRS EVENT                                                         S01157
     C           ETYP      IFEQ '22E1'                                    S01157
     C           ETYP      OREQ '23E1'                                    S01157
     C           ETYP      OREQ '24E1'                                    S01157
     C           RLIST     ADD  1         RLIST                           S01157
     C                     Z-ADD2         S                               S01157
     C                     EXSR HASH                                      S01157
     C                     Z-ADDEDAT      DLVALU                          S01157
     C*****      CDP       ADD  1         DEP                     S01157  S01194
     C********** A6NBDP    ADD  1         DEP                      S01194 000040
     C           LCEQ      DIV  FCT,DEP   DLAMTF    H                     S01157
     C           IXPOS     ADD  DLAMTF    IXPOS                           S01157
     C                     END                                            S01157
0480 C**
0407 C                     GOTO END
0408 C**
0481 C           TRAILR    TAG                             **  TRAILR  **
0483 C           RREAD     ADD  2         RREAD
0484 C**
0412 C**   COMPARE CONTROL TOTALS & HASH VALUES.
0413 C**
0414 C           INT,1     COMP HRWN                 4343
0415 C  N43      DEC,1     COMP HRDC                 4343
0416 C  N43      RREAD     COMP NORE                 4343
0489 C   43                SETON                     U8
0418 C**
0419 C           RLIST     COMP 0                        46
0490 C**
0492 C           END       TAG                             **  END  **
      *********************                                               CDL002
     C*********************                                         S01433CDL002
     C**Condition*FX*netting                                        000017CDL002
     C*********************                                         000017CDL002
     C*L1********NETFX*****IFEQ 'Y'                                 000017CDL002
     C***RESTORE*DEAL*ARRAY                                         S01433CDL002
     C*L1******************Z-ADD1         J                         S01433CDL002
     C*L1********FXNT,J****DOWNE*BLANK                              S01433CDL002
     C*L1********J*********ANDLE100                                 S01433CDL002
     C*********************                                         S01433CDL002
     C*L1******************MOVE FXNT,J    FXNTDS                    S01433CDL002
     C*********************                                         S01433CDL002
     C*L1********FXCLOP****IFNE 'Y'                                 S01433CDL002
     C*L1******************MOVE FXDLNO    DLNO                      S01433CDL002
     C*L1******************MOVE FXEAMT    EAMT                      S01433CDL002
     C*L1******************MOVE FXECCY    ECCY                      S01433CDL002
     C*L1******************MOVE FXOTHA    OTHA                      S01433CDL002
     C*L1******************MOVE FXOTHC    OTHC                      S01433CDL002
     C*L1******************MOVE FXDTYP    DTYP                      S01433CDL002
     C*L1******************MOVE FXEDAT    EDAT                      S01433CDL002
     C*L1******************MOVE FXOTHD    OTHD                      S01433CDL002
     C*L1******************MOVE FXLCEQ    LCEQ                      S01433CDL002
     C*L1******************Z-ADDEDAT      DLVALU                    S01433CDL002
     C*********************                                         S01433CDL002
     C*****CALCULATE*REVALUATED AMOUNTS                             S01433CDL002
     C*L1******************Z-ADDEAMT      WWAMT  150                S01433CDL002
     C*L1******************MOVE ECCY      WWCCY   3                 S01433CDL002
     C*L1******************EXSR #ZBB                                S01433CDL002
     C***********A6NBDP****ADD  1         DEP                       S01433000040
     C*L1********WWRVAM****DIV  FCT,DEP   WWRVBA 150H               S01433CDL002
     C*********************                                         S01433CDL002
     C*L1******************Z-ADDOTHA      WWAMT                     S01433CDL002
     C*L1******************MOVE OTHC      WWCCY                     S01433CDL002
     C*L1******************EXSR #ZBB                                S01433CDL002
     C***********A6NBDP****ADD  1         DEP                       S01433000040
     C*L1********WWRVAM****DIV  FCT,DEP   WWRVSA 150H               S01433CDL002
     C*********************                                         S01433CDL002
     C*L1********WWRVBA****ADD  WWRVSA    DLAMTF                    S01433CDL002
     C*L1******************DIV  2         DLAMTF    H               S01433CDL002
     C*********************                                         S01433CDL002
     C*L1******************END                                      000017CDL002
     C*********************                                         000017CDL002
     C*****CALCULATE*EXPOSURE FOR FX                                S01433CDL002
     C*1                   Z-ADDEDAT      DLVALU                          S01433
     C*1         CDP       ADD  1         DEP                             S01433
     C*1         LCEQ      DIV  FCT,DEP   DLAMTF    H                     S01433
     C*********************                                         S01433CDL002
     C**Call*Access*Prog.*to check for precious metal deal          S01433CDL002
     C*L1******************MOVE '0'       *IN74                     S01433CDL002
     C*L1******************CALL 'AOCURRR0'                          S01433CDL002
     C*L1******************PARM '*MSG   ' @RTCD   7                 S01433CDL002
     C*L1******************PARM '*KEY   ' @OPTN   7                 S01433CDL002
     C*L1******************PARM ECCY      @AJCD   3                 S01433CDL002
     C*L1********SDCURR****PARM SDCURR    DSSDY                     S01433CDL002
     C*********************                                         S01433CDL002
     C*L1********@RTCD*****IFEQ *BLANK                              S01433CDL002
     C*L1********A6PMRT****ANDEQ'Y'                                 S01433CDL002
     C*L1******************MOVE '1'       *IN74                     S01433CDL002
     C*********************                                         S01433CDL002
     C*L1******************ELSE                                     S01433CDL002
     C*L1******************CALL 'AOCURRR0'                          S01433CDL002
     C*L1******************PARM '*MSG   ' @RTCD   7                 S01433CDL002
     C*L1******************PARM '*KEY   ' @OPTNN  7                 S01433CDL002
     C*L1******************PARM OTHC      @AJCD   3                 S01433CDL002
     C*L1********SDCURR****PARM SDCURR    DSSDY                     S01433CDL002
     C*********************                                         S01433CDL002
     C*L1********@RTCD*****IFEQ *BLANK                              S01433CDL002
     C*L1********A6PMRT****ANDEQ'Y'                                 S01433CDL002
     C*L1******************MOVE '1'       *IN74                     S01433CDL002
     C*L1******************END                                      S01433CDL002
     C*********************                                         S01433CDL002
     C*L1******************END                                      S01433CDL002
     C*****CALCULATE*EXPOSURE FOR NON PRECIOUS METAL DEAL           S01433CDL002
     C*L1N74***************EXSR DLEXPF                              S01433CDL002
     C*********************                                         S01433CDL002
     C*****CALCULATE*EXPOSURE FOR PRECIOUS METAL DEAL               S01433CDL002
     C*L1*74***************EXSR PMEXPF                              S01433CDL002
     C*********************                                         S01433CDL002
     C*L1******************END                                      S01433CDL002
     C*L1******************ADD  1         J                         S01433CDL002
     C*L1******************END                                      S01433CDL002
0493 C**
0423 C**   ON CHANGE OF CUSTOMER, WORK OUT EXCESS EXPOSURE
0500 C**   - FIRST FOR FX
0425 CL1N80                GOTO NOPRT
0426 CL1                   SETOF                     80
     C**   SET INDICATOR FOR ZERO AMOUNTS IN EXPOSURE ARRAY. IF ANY
     C**   AMOUNTS ARE NON-ZERO INDICATOR WILL BE SET OFF IN DLXCSF/L
     C***L1******          SETON                     60                   097989
     CL1                   MOVEA'1111'    *IN,60           SETON 60-63    097989
0501 CL1                   EXSR DLXCSF
     C**   - THEN FOR PRECIOUS METAL                                      S01433
     CL1                   EXSR DLXCSP                                    S01433
     C*****-*THEN*FOR*LOANS                                               S01433
     C**   - THEN FOR MONEY MARKET                                        S01433
0503 CL1                   EXSR DLXCSL
     C**   - THEN FOR FRA                                                 S01157
     C*                                                                   S01157
     C** Convert exposure amount to thousands first                       S01157
     C*                                                                   S01157
     CL1         RXPOS     DIV  1000      RXPOS     H                     S01157
     CL1         RXPOS     SUB  XRLM      XRXS                            S01157
     C*L1********XRXS      IFLT 0                                   S01157060636
     CL1         XRXS      IFLE 0                                         060636
     CL1                   Z-ADD0         XRXS                            S01157
     CL1                   ELSE                                           S01157
     CL1                   SETON                         70               S01157
     CL1                   END                                            S01157
     C*                                                                   S01157
     C** If exposure is non-zero, then set-off ind 60                     S01157
     C*                                                                   S01157
     CL1         RXPOS     IFGT 0                                         S01157
     C/COPY WNCPYSRC,DL0760AC17
     CL1                   MOVE '0'       *IN60                           S01157
     C/COPY WNCPYSRC,DL0760AC18
     CL1                   END                                            S01157
     C*                                                                   S01157
     C**   - THEN FOR IRS                                                 S01157
     C*                                                                   S01157
     C** Convert exposure amount to thousands first                       S01157
     C*                                                                   S01157
     CL1         IXPOS     DIV  1000      IXPOS     H                     S01157
     CL1         IXPOS     SUB  XILM      XIXS                            S01157
     C*L1********XIXS      IFLT 0                                   S01157060636
     CL1         XIXS      IFLE 0                                         060636
     CL1                   Z-ADD0         XIXS                            S01157
     CL1                   ELSE                                           S01157
     CL1                   SETON                         70               S01157
     CL1                   END                                            S01157
     C*                                                                   S01157
     C** If exposure is non-zero, then set-off ind 60                     S01157
     C*                                                                   S01157
     C*1*********RXPOS     IFGT 0                                   S01157E20711
     CL1         IXPOS     IFGT 0                                   S01157E20711
     C/COPY WNCPYSRC,DL0760AC19
     CL1                   MOVE '0'       *IN60                           S01157
     C/COPY WNCPYSRC,DL0760AC20
     CL1                   END                                            S01157
     C*                                                                   S01157
     C*                                                                   S1105
     C* IF EXCEPTION ONLY AND CUSTOMER NUMBER OVER LIMIT                  S1105
     C*                DO NOT PRINT                                       S1105
     C*                                                                   S1105
     CL1 U1N70             GOTO NPRINT                                    S1105
     CL1                   SETOF                     70                   S1105
0504 C**
     C**   IF ZERO EXPOSURE AND NO LIMITS DO NOT PRINT DETAILS
     C*1*60 30 32          GOTO NOPRT                                     S01157
     CL1 60 30 32                                                         S01157
     C*N*34*36****         GOTO NOPRT                               S01157S01433
     CAN 61 62 63                                                         097989
     CAN 34 36 48          GOTO NOPRT                                     S01433
     C*                                                                   S01157
     C*******PRINTING*SPLIT INTO FOUR SEPERATE ROUTINES. FX, LENDING,     S01433
     C*******FRA*AND IRS.                                                 S01433
     C**     PRINTING SPLIT INTO FIVE SEPERATE ROUTINES. FX, PRECIOUS     S01433
     C**     METAL, MONEY MARKET, FRA AND IRS.                            S01433
     C*                                                                   S01157
0431 C*****-*THEN*PRINT*DETAILS*                                          S01157
     C*                                                                   S01433
     C*****-*PRINTING*SPLIT INTO 4 SEPERATE LINES FX FIRST.         S01157S01433
     C**   - PRINTING SPLIT INTO 5 SEPERATE LINES FX FIRST.               S01433
     C*                                                                   S01157
     CL1                   SETOF                       56                 S01157
     CL1                   Z-ADD0         D                               S01157
0433 C*1***      DLOOP7    TAG                             **  DLOOP7  ** S01157
0433 CL1         FXLOOP    TAG                             **  FXLOOP  ** S01157
0434 CL1         D         ADD  1         D
0435 C*1***      D         COMP 1                        50               S01157
0436 C*1***      D         COMP 2                    52  51               S01157
0435 CL1         D         COMP 1                    51  50               S01157
0510 C**
0511 C*****-*TEST*IF*PERIOD*END*DATE*ZERO                                 S01157
0511 C**   - TEST IF FX PERIOD END DATE ZERO                              S01157
0512 CL1         XFDT,D    COMP 0                    5353  PRINT
0513 C*1***      XLDT,D    COMP 0                    5454  PRINT          S01157
0514 C**
0515 C**   - MOVE EXPOSURE AMT. TO 10 DIGIT FIELD
0517 C*1**                 Z-ADDXLXP,D    LXPOS  100                      S01157
     C********** D         IFEQ 1                                   S01433000040
     C********** FXSP      ANDEQ'Y'                                 S01433000040
     C**********           Z-ADDXFXP1     FXPOS                     S01433000040
     C**********           ELSE                                     S01433000040
0516 CL1                   Z-ADDXFXP,D    FXPOS  100
     C**********           END                                      S01433000040
      *  Print Customer if not already done.                              S01433
     CL1         NAMPRT    IFEQ 'N'                                       S01433
     CL1                   EXCPTCUSTO                                     S01433
     CL1                   MOVE 'Y'       NAMPRT                          S01433
     CL1                   END                                            S01433
0518 C**
0519 C**   - PRINT LINE
     CL1         *IN53     IFEQ '1'                        B1             BHF416
     C/COPY WNCPYSRC,DL0760AC21
     CL1         D         IFEQ 1                                         S01433
     C*1*******  FXSP      IFEQ 'Y'                                 S01433153759
     C*L*******            EXCPT                                          S01433
     CL1                   EXCPTFXLN1S                                    S01433
     C*L1*******           END                                      000040153759
     C**********           ELSE                                     S01433000018
     CL1                   EXCPTFXLN1F                                    S01433
     C**********           END                                      BHF416000040
     CL1                   ELSE                                           S01433
     CL1                   EXCPTFXLN2                                     S01433
     CL1                   END                                            S01433
     CL1                   END                                            S01433
0521 C**
0522 C**   - CALCULATE NEXT START OF PERIOD
0523 CL1         XFDA,D    ADD  1         NEXTF   30
0524 C*1**       XLDA,D    ADD  1         NEXTL   30                      S01157
0525 C**
0526 C**   - IF LESS THAN SIX PERIODS PRINTED, DO AGAIN.
0527 CL1         D         COMP 6                      89
0528 C*1*89                GOTO DLOOP7                                    S01157
0528 CL1 89                GOTO FXLOOP                                    S01157
     C*                                                                   S01433
     C**   - PRINT PRECIOUS METAL DETAILS.                                S01433
     CL1                   SETOF                       47                 S01433
     C*                                                                   S01433
     CL1                   Z-ADD0         D                               S01433
     CL1         PMLOOP    TAG                             **  PMLOOP  ** S01433
     CL1         D         ADD  1         D                               S01433
     CL1         D         COMP 2                    58  52               S01433
     C**                                                                  S01433
     C**   - TEST IF PERIOD END DATE ZERO                                 S01433
     CL1         XPDT,D    COMP 0                    4747  PRINT          S01433
     C**                                                                  S01433
     C**   - MOVE EXPOSURE AMT. TO 10 DIGIT FIELD                         S01433
     CL1                   Z-ADDXPXP,D    PMPOS  100                      S01433
     C********** D         IFEQ 1                                   S01433000040
     C********** PMSP      ANDEQ'Y'                                 S01433000040
     C**********           Z-ADDXPXP1     PMPOS                     S01433000040
     C**********           ELSE                                     S01433000040
     CL1                   Z-ADDXPXP,D    PMPOS  100                      S01433
     C**********           END                                      S01433000040
     C**                                                                  S01433
     C**   - PRINT LINE                                                   S01433
     CL1         *IN47     IFEQ '1'                        B1             S01433
     C/COPY WNCPYSRC,DL0760AC22
     CL1         D         IFEQ 1                                         S01433
     CL1         PMSP      IFEQ 'Y'                                       S01433
     CL1                   EXCPTPMLN1S                                    S01433
     C**********           ELSE                                     S01433000040
     CL1                   END                                            000040
     CL1                   EXCPTPMLN1F                                    S01433
     C**********           END                                      S01433000040
     CL1                   ELSE                                           S01433
     CL1                   EXCPTPMLN2                                     S01433
     CL1                   END                                            S01433
     CL1                   END                                            S01433
     C**                                                                  S01433
     C**   - CALCULATE NEXT START OF PERIOD                               S01433
     CL1         XPDA,D    ADD  1         NEXTM   30                      S01433
     C**                                                                  S01433
     C**   - IF LESS THAN SIX PERIODS PRINTED, DO AGAIN.                  S01433
     CL1         D         COMP 6                      89                 S01433
     CL1 89                GOTO PMLOOP                                    S01433
     C*                                                                   S01157
     C*****-*THEN PRINT LENDING DETAILS                           S01433  S01157
     C**   - THEN PRINT MONEY MARKET DETAILS                              S01433
     C*                                                                   S01157
     CL1                   Z-ADD0         D                               S01157
     C*1**********         SETOF                     53          S01157   S01433
     CL1                   SETOF                       54                 S01433
     CL1         LNLO0P    TAG                             **  LNLOOP  ** S01157
     CL1         D         ADD  1         D                               S01157
     CL1         D         COMP 1                    51  50               S01157
     C**                                                                  S01157
     C*****-*TEST IF LENDING PERIOD END DATE ZERO                  S01433 S01157
     C**   - TEST IF MONEY MARKET PERIOD END DATE ZERO                    S01433
     CL1         XLDT,D    COMP 0                    5454  PRINT          S01157
     C**                                                                  S01157
     C**   - MOVE EXPOSURE AMT. TO 10 DIGIT FIELD                         S01157
     CL1                   Z-ADDXLXP,D    LXPOS  100                      S01157
     C**                                                                  S01157
     C**   - PRINT LINE                                                   S01157
     CL1         *IN54     IFEQ '1'                        B1             BHF416
     C/COPY WNCPYSRC,DL0760AC23
     CL1                   EXCPT                                          S01157
     CL1                   END                                            BHF416
     C**                                                                  S01157
     C**   - CALCULATE NEXT START OF PERIOD                               S01157
     CL1         XLDA,D    ADD  1         NEXTL   30                      S01157
     C**                                                                  S01157
     C**   - IF LESS THAN SIX PERIODS PRINTED, DO AGAIN.                  S01157
     CL1         D         COMP 6                      89                 S01157
     CL1 89                GOTO LNLO0P                                    S01157
     CL1                   SETOF                     54                   097989
     C**                                                                  S01157
     C/COPY WNCPYSRC,DL0760AC03
      *                                                                   CDL006
      ** If CDL006 is installed, Print Fiduciary Deposits details         CDL006
      *                                                                   CDL006
     CL1         CDL006    IFEQ 'Y'                                       CDL006
     CL1                   Z-ADD0         D                               CDL006
     CL1                   MOVE *OFF      *IN45                           CDL006
     CL1         FILO0P    TAG                                            CDL006
     CL1         D         ADD  1         D                               CDL006
     CL1         D         COMP 1                    51  50               CDL006
      *                                                                   CDL006
      ** - Test is Fiducairy period end date zero                         CDL006
      *                                                                   CDL006
     CL1         FIDT,D    COMP 0                    4545                 CDL006
      *                                                                   CDL006
      ** - Move Exposure amount to 10 digit field                         CDL006
      *                                                                   CDL006
     CL1                   Z-ADDFIXP,D    FIXPOS 100                      CDL006
      *                                                                   CDL006
      ** - Print line                                                     CDL006
      *                                                                   CDL006
     CL1         *IN45     IFEQ '1'                                       CDL006
     CL1                   EXCPT                                          CDL006
     CL1                   END                                            CDL006
      *                                                                   CDL006
      ** - Calculate next start of period                                 CDL006
      *                                                                   CDL006
     CL1         FIDA,D    ADD  1         FIEXTL  30                      CDL006
      *                                                                   CDL006
      ** - If less than six periods printed, do again                     CDL006
      *                                                                   CDL006
     CL1         D         COMP 6                      89                 CDL006
     CL1 89                GOTO FILO0P                                    CDL006
     CL1                   END                                            CDL006
     CL1                   MOVE *OFF      *IN45                           CDL006
      *                                                                   CDL006
     C**   - THEN PRINT FRA DETAILS                                       S01157
     CL1         *IN57     IFEQ '1'                        B1             BHF416
     C/COPY WNCPYSRC,DL0760AC24
     C***L1******          SETOF                     54            S01157 097989
     CL1                   SETON                     5550                 S01157
     CL1                   EXCPT                                          S01157
     C**                                                                  S01157
     C**   - THEN PRINT IRS DETAILS                                       S01157
     CL1                   SETOF                     55                   S01157
     CL1                   SETON                     5650                 S01157
     C/COPY WNCPYSRC,DL0760AC25
     CL1                   EXCPT                                          S01157
     C/COPY WNCPYSRC,DL0760AC26
     CL1                   END                                            BHF416
0529 C**
0456 CL1         NOPRT     TAG
0529 C**
0530 C**   - COUNT RECORDS LISTED IN THIS REPORT
     CL1         NPRINT    TAG                             ** NPRINT **   S1105
0529 C**
0532 C**   CHECK IF NO DETAILS REPORTED
0533 CLR         RLIST     COMP 0                        46
0534 C*R*****              SETON                     OF             E10421S01117
0534 CLRN46                SETON                     OF                   S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C** CALL ZSFILE FOR P1 FILE - ONCE - ONLY IF DETAILS TO REPORT       S01117
     CLR         *IN46     IFEQ '0'                                       S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANKS   @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C** CALL ZSFILE FOR AU FILE - ONCE ONLY                              S01117
     CLR                   Z-ADDSFNUMU    ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANKS   @PARM   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
0535 C********************************************************************
0462 C*    SR TO ADD AMOUNT TO HASH TOTAL ARRAYS
0463 C           HASH      BEGSR
0464 C                     Z-ADDINT,S     ZZTOTI
0465 C                     Z-ADDDEC,S     ZZTOTD
0466 C                     EXSR GLZADD
0467 C                     Z-ADDZZTOTI    INT,S
0468 C                     Z-ADDZZTOTD    DEC,S
0469 C                     ENDSR
0470 C*
0471 C********************************************************************
0536 C*    DLLMT SR. SETS UP ARRAYS OF LIMIT PERIODS & AMOUNTS,
0537 C*****FOR*FX*LIMITS AND LENDING LIMITS.
     C*    FOR FX LIMITS, PRECIOUS METAL LIMITS AND MONEY MARKET          S01433
     C*    LIMITS.                                                        S01433
0538 C           DLLMT     BEGSR                           **  DLLMT  **
0539 C**
0540 C**   FIRST RESET ARRAYS TO ZEROES
0541 C                     Z-ADD0         XFDA
0542 C                     Z-ADD0         XFDT
0543 C                     Z-ADD0         XFLM
0544 C                     Z-ADD0         XFXP
0545 C                     Z-ADD0         XFXS
0546 C                     Z-ADD0         XFPC
     C                     Z-ADD0         XFDA1   30                      S01433
     C                     Z-ADD0         XFDT1   30                      S01433
     C                     Z-ADD0         XFLM1   90                      S01433
     C                     Z-ADD0         XFXP1  100                      S01433
     C                     Z-ADD0         XFXS1  100                      S01433
     C                     Z-ADD0         XPDA                            S01433
     C                     Z-ADD0         XPDT                            S01433
     C                     Z-ADD0         XPLM                            S01433
     C                     Z-ADD0         XPXP                            S01433
     C                     Z-ADD0         XPXS                            S01433
     C                     Z-ADD0         XPPC                            S01433
     C                     Z-ADD0         XPDA1   30                      S01433
     C                     Z-ADD0         XPDT1   50                      S01433
     C                     Z-ADD0         XPLM1   90                      S01433
     C                     Z-ADD0         XPXP1  100                      S01433
     C                     Z-ADD0         XPXS1  100                      S01433
0547 C                     Z-ADD0         XLDA
0548 C                     Z-ADD0         XLDT
0549 C                     Z-ADD0         XLLM
0550 C                     Z-ADD0         XLXP
0551 C                     Z-ADD0         XLXS
0552 C                     Z-ADD0         XLPC
     C                     MOVE *BLANKS   FDESC   7                       S01117
     C                     MOVE *BLANKS   FDESC2  7                       153759
     C                     MOVE *BLANKS   LDESC   7                       S01117
     C                     MOVE *BLANKS   PDESC   7                       S01433
     C                     MOVE *BLANKS   FDEF    1                       S01117
     C                     MOVE *BLANKS   LDEF    1                       S01117
     C                     MOVE *BLANKS   PDEF    1                       S01433
     C*********            MOVE 'N'       FXSP                      S01433153759
     C                     MOVE 'Y'       FXSP    1                       153759
     C                     MOVE 'N'       PMSP                            S01433
     C*                                                                   S01157
     C**   SETUP FRA/IRS FIELDS.                                          S01157
     C*                                                                   S01157
     C                     Z-ADD0         XRLM    90                      S01157
     C                     Z-ADD0         RXPOS  100                      S01157
     C                     Z-ADD0         XRXS   100                      S01157
     C                     Z-ADD0         XILM    90                      S01157
     C                     Z-ADD0         IXPOS  100                      S01157
     C                     Z-ADD0         XIXS   100                      S01157
     C/COPY WNCPYSRC,DL0760AC04
      *                                                                   CDL006
      ** If CDL006 is installed                                           CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     Z-ADD0         FIDA                            CDL006
     C                     Z-ADD0         FIDT                            CDL006
     C                     Z-ADD0         FILM                            CDL006
     C                     Z-ADD0         FIXP                            CDL006
     C                     Z-ADD0         FIXS                            CDL006
     C                     Z-ADD0         FIPC                            CDL006
     C                     MOVE *BLANKS   FIDESC  7                       CDL006
     C                     END                                            CDL006
0553 C*
0490 C                     SETOF                     3133
0554 C                     SETOF                     7172
     C                     SETOF                     4975                 S01433
0555 C**
0556 C**
0557 C**
0558 C**   PROCESS FX LIMITS FIRST
0496 C**   - CHECK FOR ZERO LIMIT TYPE OR IF LIMIT HAS EXPIRED.
0497 C           FLTY      COMP 0                    898930
0560 C*****      FLED      COMP RUND                 893189               S01194
0560 C   89      FLED      COMP BJRDNB               893189               S01194
     C                     SETOF                         38               E26066
     C           FLED      IFEQ 0                                         DT0023
     C********** *IN30     ANDEQ'0'                                DT0023 064258
     C**********           MOVE '1'       *IN89                    DT0023 E26066
     C                     MOVE '1'       *IN89                           000040
     C                     MOVE '0'       *IN31                           DT0023
     C**********           MOVE '0'       *IN30                                        064258 194291
     C                     MOVE '1'       *IN38                           E26066
     C                     END                                            DT0023
     C  N89                MOVEL'EXPIRED' FDESC            IF EXPIRED.    S01117
0499 C   89                GOTO BYPAS1                     IF NOT EXPIRED.
0557 C**
0501 C**   - IF EXPIRED, SET FIRST PERIOD END DAYS & DATE TO NINES
0502 C**     & ZEROIZE AMOUNT
0503 C                     Z-ADD999       XFDA,1
0504 C                     Z-ADD99999     XFDT,1
0505 C                     Z-ADD0         XFLM,1
     C                     Z-ADD999       XFDA1                           S01433
     C                     Z-ADD99999     XFDT1                           S01433
     C                     Z-ADD0         XFLM1                           S01433
     C*********************GOTO LNPROC                                    S01433
     C                     GOTO PMPROC                                    S01433
0557 C**
0507 C           BYPAS1    TAG                             **  BYPAS1  **
0508 C**
     C***-*NOT*EXPIRED*-*CHAIN*TO*LIMITS*REC.*ON*S/TABLE,*TI**            S01194
     C*****                MOVE FLTY      DLKY,1                          S01194
     C*****                EXSR DLCHN                                     S01194
     C**N90*               GOTO DLLEND                                    S01194
0951 C*                                                                   S01194
     C** - NOT EXPIRED - ACCESS LIMITS FILE                               S01194
     C                     MOVELFLTY      @CRNB                           S01194
     C                     CALL 'AOLIMTR0'                                S01194
     C**********           PARM '*MSG   ' @RTCD   7                                    S01194 CCB016
     C                     PARM *BLANKS   @RTCD   7                                           CCB016
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @CRNB   3                       S01194
     C           SDLIMT    PARM SDLIMT    DSFDY                           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C** IF LIMITS EXIST CONVERT EXPIRY DATE TO DDMMMYY FORMAT            S01117
     C                     MOVELFLED      ZDAYNO                          S01117
     C                     EXSR ZDATE2                                    S01117
     C                     MOVE ZADATE    FDESC                           S01117
     C                     MOVE ZADATE    FDESC2                          153759
     C                     GOTO XFDTAG                                    S01117
     C** ELSE, IF NO LIMITS ACCESS DEFAULTS                               S01117
     C                     ELSE                                           S01117
     C                     MOVE 'Y'       FDEF                            S01117
     C                     MOVE *BLANKS   LDEF                            S01117
     C                     EXSR DL0131                                    S01117
     C***IF*NO*DEFAULTS THEN THERE ARE NO LIMITS                   S01117 S01433
     C** IF NO DEFAULTS THEN THERE ARE NO SPOT LIMITS                     S01433
     C********   FXLIM     IFEQ 0                                  S01117 S01433
     C           FXLMS     IFEQ 0                                         S01433
     C                     MOVEL'NO LIM.' FDESC                           S01117
     C                     Z-ADD999       XFDA1                           S01433
     C                     Z-ADD99999     XFDT1                           S01433
     C                     Z-ADD999       XFDA,1                          S01433
     C                     Z-ADD99999     XFDT,1                          S01433
     C                     GOTO LMTSF                                     184593
     C                     ELSE                                           S01433
     C                     Z-ADDSP        XFDA,1                          S01433
     C           SP        ADD  BJRDNB    XFDT,1                          S01433
     C                     Z-ADD999       XFDA,2                          S01433
     C                     Z-ADD99999     XFDT,2                          S01433
     C                     MOVEL'DEFAULT' FDESC                           S01433
     C** IF ALL LOWER LEVEL LIMITS HAD SAME TYPE, USE THIS FOR 1ST PRD    S01433
     C           FXSAME    IFEQ 'Y'                                       S01433
     C********             MOVEAFXPER     XFDAA                           S01433
     C                     Z-ADDFXLMS     FLAM                            S01433
     C                     Z-ADDSP        XFDA1                           S01433
     C********             Z-ADDFXLIM     FLAM                            S01433
     C                     MOVE FXPC      XFPCIN                          S01433
     C           FLAM      DIV  XFPC,1    FLAM      H                     S01117
     C********             GOTO LMTSF                              S01194 S01433
     C                     ELSE                                           S01433
     C**  ELSE SET UP SPOT PERIOD                                         S01117
     C                     Z-ADDSP        XFDA1                           S01433
     C           SP        ADD  BJRDNB    XFDT1                           S01433
     C********             Z-ADD999       XFDA,2                   S01117 S01433
     C********             Z-ADD99999     XFDT,2                   S01117 S01433
     C********             Z-ADDFXLIM     XFLM,1                   S01117 S01433
     C                     Z-ADDFXLMS     XFLM1                           S01433
     C                     END                                            S01117
     C                     END                                            S01117
     C** IF NO DEFAULTS THEN THERE ARE NO FORWARD LIMITS                  S01433
     C           FXLMF     IFEQ 0                                         S01433
     C********             MOVEL'NO LIM.' FDESC                     S01433153759
     C                     MOVEL'NO LIM.' FDESC2                          153759
     C                     ELSE                                           S01117
     C********             MOVEL'DEFAULT' FDESC                     S01433153759
     C                     MOVEL'DEFAULT' FDESC2                          153759
     C** IF ALL LOWER LEVEL LIMITS HAD SAME TYPE, USE THIS FOR 1ST PRD    S01117
     C           FXSAME    IFEQ 'Y'                                       S01117
     C                     MOVEAFXPER     XFDAA                           S01117
     C                     Z-ADDFXLMF     FAMM                            S01433
     C                     MOVE FXPC      XFPCIN                          S01117
     C           FAMM      DIV  XFPC,1    FAMM      H                     S01433
     C********             GOTO LMTSF                                     S01194
     C                     ELSE                                           S01117
     C**  ELSE SET UP FORWARD PERIOD                                      S01433
     C********             Z-ADDSP        XFDA,1                          S01433
     C********   SP        ADD  BJRDNB    XFDT,1                          S01433
     C********             Z-ADD999       XFDA,2                          S01433
     C********             Z-ADD99999     XFDT,2                          S01433
     C                     Z-ADDFXLMF     XFLM,1                          S01117
     C********             GOTO LNPROC                            S01194  S01433
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01194
     C*                                                                   S01433
     C           FXLMF     IFEQ 0                                         S01433
     C           FXLMS     ANDEQ0                                         S01433
     C                     GOTO PMPROC                                    S01433
     C                     END                                            S01433
     C           FXSAME    IFEQ 'N'                                       S01433
     C                     GOTO PMPROC                                    S01433
     C                     END                                            S01433
     C**  IF THERE ARE NO FORWARD OR SPOT LIMITS SET ARRAYS TO 999'S      S01433
     C********   FXLMF     IFLE 0                                         S01433
     C********   FXLMS     ORLE 0                                         S01433
     C**  FORWARD LIMITS SET ARRAYS TO 999'S                              S01117
     C********   FXLMF     IFEQ 0                                         S01433
     C********             Z-ADD999       XFDA,1                          S01433
     C********             Z-ADD99999     XFDT,1                          S01433
     C********             END                                            S01433
     C**  SPOT LIMITS SET FIELDS TO 999'S                                 S01117
     C********   FXLMS     IFEQ 0                                         S01433
     C********             Z-ADD999       XFDA1                           S01433
     C********             Z-ADD99999     XFDT1                           S01433
     C********             END                                            S01433
     C**  DO NOT CONTINUE WITH SETTING UP ARRAYS                          S01433
     C                     GOTO LMTSF                                     S01433
     C*                                                                   S01433
     C********             END                                            S01433
0575 C**
0576 C**   - MOVE DATA FROM INPUT FIELDS TO FX ARRAYS
     C           XFDTAG    TAG                             **  XFDTAG   **
0578 C** MOVE END OF LIMIT PERIODS INTO LEPSIN (DS)                       S01194
0578 C                     MOVELA2E1LP    XLEP1                           S01194
0578 C                     MOVELA2E2LP    XLEP2                           S01194
0578 C                     MOVELA2E3LP    XLEP3                           S01194
0578 C                     MOVELA2E4LP    XLEP4                           S01194
0578 C                     MOVELA2E5LP    XLEP5                           S01194
0578 C                     MOVELA2E6LP    XLEP6                           S01194
0577 C                     MOVE LEPSIN    XFDAIN
0578 C** MOVE %/LIMIT FOR PERIODS INTO UP LPCSIN (DS)                     S01194
0578 C                     MOVELA2PL1P    XLPC1                           S01194
0578 C                     MOVELA2PL2P    XLPC2                           S01194
0578 C                     MOVELA2PL3P    XLPC3                           S01194
0578 C                     MOVELA2PL4P    XLPC4                           S01194
0578 C                     MOVELA2PL5P    XLPC5                           S01194
0578 C                     MOVELA2PL6P    XLPC6                           S01194
0578 C                     MOVE LPCSIN    XFPCIN
0579 C**
0580 C**   DLLOOP1 PROCESSES XFDAA - IF ANY ELEMENT IS BLANK OR 999
0581 C**   THE CORRESPONDING ELEMENTS IN XFDA & XFDT ARE SET TO NINES.
0582 C*****ELSE,XFDT*IS*CALCULATED*BY*ADDING*RUND*TO*XFDA,***********     S01194
0582 C**   ELSE,XFDT IS CALCULATED BY ADDING RUN DATE TO XFDA,            S01194
0583 C**        XFLM,IS CALCULATED BY MULTIPLYING LIMIT AMOUNT BY XFPC
0584 C**
     C           LMTSF     TAG                                            S01117
0585 C                     Z-ADD0         D       20
     C***********XFDAA,1   IFEQ 'SP '                               S01433153759
     C***********          MOVE 'Y'       FXSP    1                 S01433153759
     C***********          END                                      S01433153759
0586 C           DLOOP1    TAG                             ** DLOOP1  **
0587 C**
0588 C           D         ADD  1         D
0589 C********** XFDAA,D   COMP '   '                    88               BHF416
     C           XFDAA,D   COMP '000'                    88               BHF416
0590 C           XFDAA,D   COMP '999'                    87
     C           XFDAA,D   COMP 'SP '                    71               S01433
0591 C**
0592 C   88                Z-ADD999       XFDA,D
0593 C*
0594 C**N71******XFDAA,1   COMP 'SP '                    71               S01433
0595 C***71*******         Z-ADDSP        XFDA,1                          S01433
0596 C**
0597 C******     XFDA,D    ADD  RUND      XFDT,D                          S01194
0597 C           XFDA,D    ADD  BJRDNB    XFDT,D                          S01194
0598 C   88
0599 COR 87                Z-ADD99999     XFDT,D
     C   88                                                               S01433
     COR 87                Z-ADD99999     XFDT1                           S01433
0600 C**
0601 C**N88******FLAM      MULT XFPC,D    XFLM,D                          S01433
     C  N88      FAMM      MULT XFPC,D    XFLM,D                          S01433
     C************IN71     IFEQ '1'                                 S01433153759
     C           FLAM      MULT XFPC,1    XFLM1   90                      S01433
     C***********          END                                      S01433153759
0602 C**
0603 C           D         COMP 6                      86
     C   71                Z-ADDSP        XFDA,1                          S01433
     C   71                Z-ADDSP        XFDA1                           S01433
     C   71      SP        ADD  BJRDNB    XFDT,1                          S01433
     C   71      SP        ADD  BJRDNB    XFDT1                           S01433
0604 C   86N87N88          GOTO DLOOP1
0605 C**
     C           PMPROC    TAG                             **  PMPROC  ** S01433
     C**   PROCESS PM LIMITS                                              S01433
     C**   - CHECK FOR ZERO LIMIT TYPE OR IF LIMIT HAS EXPIRED.           S01433
     C           LIPLTY    COMP 0                    898948               S01433
     C   89      LIPLED    COMP BJRDNB               894989               S01433
     C           LIPLED    IFEQ 0                                         S01433
     C********** *IN48     ANDEQ'0'                                 S01433064258
     C                     MOVE '0'       *IN49                           S01433
     C**********           MOVE '0'       *IN48                                        064258 194291
     C                     MOVE '1'       *IN89                           000040
     C                     END                                            S01433
     C  N89                MOVEL'EXPIRED' PDESC            IF EXPIRED.    S01433
     C   89                GOTO BYPAS3                     IF NOT EXPIRED.S01433
     C**                                                                  S01433
     C**   - IF EXPIRED, SET FIRST PERIOD END DAYS & DATE TO NINES        S01433
     C**     & ZEROIZE AMOUNT                                             S01433
     C                     Z-ADD999       XPDA,1                          S01433
     C                     Z-ADD99999     XPDT,1                          S01433
     C                     Z-ADD0         XPLM,1                          S01433
     C                     Z-ADD999       XPDA1                           S01433
     C                     Z-ADD99999     XPDT1                           S01433
     C                     Z-ADD0         XPLM1                           S01433
     C                     GOTO LNPROC                                    S01433
     C**                                                                  S01433
     C           BYPAS3    TAG                             **  BYPAS1  ** S01433
     C*                                                                   S01433
     C** - NOT EXPIRED - ACCESS LIMITS FILE                               S01433
     C                     MOVELLIPLTY    @CRNB                           S01433
     C                     CALL 'AOLIMTR0'                                S01433
     C**********           PARM '*MSG   ' @RTCD   7                                    S01433 CCB016
     C                     PARM *BLANKS   @RTCD                                               CCB016
     C                     PARM '*KEY   ' @OPTN   7                       S01433
     C                     PARM           @CRNB   3                       S01433
     C           SDLIMT    PARM SDLIMT    DSFDY                           S01433
     C           @RTCD     IFEQ *BLANK                                    S01433
     C** IF LIMITS EXIST CONVERT EXPIRY DATE TO DDMMMYY FORMAT            S01433
     C                     MOVELLIPLED    ZDAYNO                          S01433
     C                     EXSR ZDATE2                                    S01433
     C                     MOVE ZADATE    PDESC                           S01433
     C                     GOTO XPDTAG                                    S01433
     C** ELSE, IF NO LIMITS ACCESS DEFAULTS                               S01433
     C                     ELSE                                           S01433
     C                     MOVE 'Y'       PDEF                            S01433
     C                     MOVE *BLANKS   FDEF                            S01433
     C                     MOVE *BLANKS   LDEF                            S01433
     C                     EXSR DL0131                                    S01433
     C** IF NO DEFAULTS THEN THERE ARE NO LIMITS                          S01433
     C           PMLMS     IFEQ 0                                         S01433
     C                     MOVEL'NO LIM.' PDESC                           S01433
     C                     Z-ADD999       XPDA1                           S01433
     C                     Z-ADD99999     XPDT1                           S01433
     C                     Z-ADD999       XPDA,1                          S01433
     C                     Z-ADD99999     XPDT,1                          S01433
     C                     ELSE                                           S01433
     C                     Z-ADDSP        XPDA,1                          S01433
     C                     Z-ADD999       XPDA,2                          S01433
     C           SP        ADD  BJRDNB    XPDT,1                          S01433
     C                     Z-ADD99999     XPDT,2                          S01433
     C                     MOVEL'DEFAULT' PDESC                           S01433
     C** IF ALL LOWER LEVEL LIMITS HAD SAME TYPE, USE THIS FOR 1ST PRD    S01433
     C           PMSAME    IFEQ 'Y'                                       S01433
     C                     Z-ADDSP        XPDA1                           S01433
     C                     Z-ADDPMLMS     LIPSAM                          S01433
     C                     MOVE PMPC      XPPCIN                          S01433
     C           LIPSAM    DIV  XPPC,1    LIPSAM    H                     S01433
     C                     ELSE                                           S01433
     C**  ELSE SET UP SPOT PERIOD                                         S01433
     C                     Z-ADDSP        XPDA1                           S01433
     C           SP        ADD  BJRDNB    XPDT1                           S01433
     C                     Z-ADDPMLMS     XPLM,1                          S01433
     C                     END                                            S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C** IF NO DEFAULTS THEN THERE ARE NO LIMITS                          S01433
     C           PMLMF     IFEQ 0                                         S01433
     C                     MOVEL'NO LIM.' PDESC                           S01433
     C                     ELSE                                           S01433
     C                     MOVEL'DEFAULT' PDESC                           S01433
     C** IF ALL LOWER LEVEL LIMITS HAD SAME TYPE, USE THIS FOR 1ST PRD    S01433
     C           PMSAME    IFEQ 'Y'                                       S01433
     C                     MOVEAPMPER     XPDAA                           S01433
     C                     Z-ADDPMLMF     LIPFAM                          S01433
     C                     MOVE PMPC      XPPCIN                          S01433
     C           LIPFAM    DIV  XPPC,1    LIPFAM    H                     S01433
     C                     ELSE                                           S01433
     C**  ELSE SET UP SPOT PERIOD                                         S01433
     C                     Z-ADDPMLMF     XPLM,1                          S01433
     C********             Z-ADDSP        XMDA,1                          S01433
     C********   SP        ADD  BJRDNB    XMDT,1                          S01433
     C********             Z-ADD999       XMDA,2                          S01433
     C********             Z-ADD99999     XMDT,2                          S01433
     C********             Z-ADDPMLMF     XMLM,1                          S01433
     C                     END                                            S01433
     C                     END                                            S01433
     C                     END                                            S01433
     C           PMLMF     IFEQ 0                                         S01433
     C           PMLMS     ANDEQ0                                         S01433
     C***********          GOTO LMTSP                               S01433000040
     C                     GOTO LNPROC                                    000040
     C                     END                                            S01433
     C*                                                                   S01433
     C           PMSAME    IFEQ 'N'                                       S01433
     C***********          GOTO LMTSP                               S01433000040
     C                     GOTO LNPROC                                    000040
     C                     END                                            S01433
     C                     GOTO LMTSP                                     000040
     C**                                                                  S01433
     C**   - MOVE DATA FROM INPUT FIELDS TO PM ARRAYS                     S01433
     C           XPDTAG    TAG                             **  XFDTAG   **S01433
     C** MOVE END OF LIMIT PERIODS INTO LEPSIN (DS)                       S01433
     C                     MOVELA2E1LP    XLEP1                           S01433
     C                     MOVELA2E2LP    XLEP2                           S01433
     C                     MOVELA2E3LP    XLEP3                           S01433
     C                     MOVELA2E4LP    XLEP4                           S01433
     C                     MOVELA2E5LP    XLEP5                           S01433
     C                     MOVELA2E6LP    XLEP6                           S01433
     C                     MOVE LEPSIN    XPDAIN                          S01433
     C** MOVE %/LIMIT FOR PERIODS INTO UP LPCSIN (DS)                     S01433
     C                     MOVELA2PL1P    XLPC1                           S01433
     C                     MOVELA2PL2P    XLPC2                           S01433
     C                     MOVELA2PL3P    XLPC3                           S01433
     C                     MOVELA2PL4P    XLPC4                           S01433
     C                     MOVELA2PL5P    XLPC5                           S01433
     C                     MOVELA2PL6P    XLPC6                           S01433
     C                     MOVE LPCSIN    XPPCIN                          S01433
     C*                                                                   S01433
     C**                                                                  S01433
     C**   DLLOOP1 PROCESSES XFDAA - IF ANY ELEMENT IS BLANK OR 999       S01433
     C**   THE CORRESPONDING ELEMENTS IN XFDA & XFDT ARE SET TO NINES.    S01433
     C**   ELSE,XFDT IS CALCULATED BY ADDING RUN DATE TO XFDA,            S01433
     C**        XFLM,IS CALCULATED BY MULTIPLYING LIMIT AMOUNT BY XFPC    S01433
     C**                                                                  S01433
     C           LMTSP     TAG                                            S01433
     C                     Z-ADD0         D       20                      S01433
     C           XPDAA,1   IFEQ 'SP '                                     S01433
     C                     MOVE 'Y'       PMSP    1                       S01433
     C                     END                                            S01433
     C           DLOOP8    TAG                             ** DLOOP8  **  S01433
     C**                                                                  S01433
     C           D         ADD  1         D                               S01433
     C           XPDAA,D   COMP 'SP '                    78               S01433
     C           XPDAA,D   COMP '000'                    88               S01433
     C           XPDAA,D   COMP '999'                    87               S01433
     C**                                                                  S01433
     C   88                Z-ADD999       XPDA,D                          S01433
     C**                                                                  S01433
     C           XPDA,D    ADD  BJRDNB    XPDT,D                          S01433
     C   88                                                               S01433
     COR 87                Z-ADD99999     XPDT,D                          S01433
     C   88                                                               S01433
     COR 87                Z-ADD99999     XPDT1                           S01433
     C**                                                                  S01433
     C**N88***** FAMM      MULT XPPC,D    XPLM,D                    S01433000040
     C  N88      LIPFAM    MULT XPPC,D    XPLM,D                          000040
     C           *IN78     IFEQ '1'                                       S01433
     C********** FLAM      MULT XPPC,1    XPLM1                     S01433000040
     C           LIPSAM    MULT XPPC,1    XPLM1                           000040
     C                     END                                            S01433
     C**                                                                  S01433
     C           D         COMP 6                      86                 S01433
     C   78                Z-ADDSP        XPDA,1                          S01433
     C   78                Z-ADDSP        XPDA1                           S01433
     C   78      SP        ADD  BJRDNB    XPDT,1                          S01433
     C   78      SP        ADD  BJRDNB    XPDT1                           S01433
     C   86N87N88          GOTO DLOOP8                                    S01433
     C**                                                                  S01433
     C**                                                                  S01433
0606 C           LNPROC    TAG                             **  LNPROC  **
0607 C**
0608 C*****PROCESS*LENDING LIMITS.                                        S01433
0608 C**   PROCESS MONEY MARKET LIMITS.                                   S01433
0547 C**   -  CHECK FOR ZERO LIMIT TYPE OR IF LIMIT HAS EXPIRED
0548 C           LLTY      COMP 0                    898932
0610 C***89*     LLED      COMP RUND                 893389               S01194
0610 C   89      LLED      COMP BJRDNB               893389               S01194
     C********** LLED      IFEQ 0                                  DT0023 E26066
     C********** *IN30     ANDEQ'0'                                DT0023 E26066
     C                     SETOF                         39               E26066
     C           LLED      IFEQ 0                                         E26066
     C********** *IN32     ANDEQ'0'                                E26066 179353
     C**********           MOVE '1'       *IN89                    DT0023 E26066
     C**********           MOVE '0'       *IN31                    DT0023 E26066
     C           *IN32     IFEQ '0'                                                           232996
     C                     MOVE '0'       *IN33                           E26066
     C                     MOVE '1'       *IN39                           E26066
     C                     MOVE '1'       *IN89                           179353
     C                     MOVE '0'       *IN32                           179353
     C                     ELSE                                                               232996
     C                     MOVE '0'       *IN33                                               232996
     C                     MOVE '0'       *IN39                                               232996
     C                     MOVE '1'       *IN89                                               232996
     C                     MOVE '1'       *IN32                                               232996
     C                     ENDIF                                                              232996
     C                     END                                            DT0023
     C  N89                MOVEL'EXPIRED' LDESC            ** IF EXPIRED*.S01117
0550 C   89                GOTO BYPAS2                     IF NOT EXPIRED.
0552 C**
0553 C**   - IF EXPIRED, SET FIRST PERIOD END DAYS & DATE TO NINES
0554 C**     & ZEROISE AMOUNT
0555 C                     Z-ADD999       XLDA,1
0556 C                     Z-ADD99999     XLDT,1
0557 C                     Z-ADD0         XLLM,1
0619 C****                 GOTO DLLEND                                    S01157
     C/COPY WNCPYSRC,DL0760AC05
     C***********          GOTO FRPROC                             S01157 CDL006
     C/COPY WNCPYSRC,DL0760AC06
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     GOTO FIPROC                                    CDL006
     C                     ELSE                                           180278
     C                     GOTO FRPROC                                    180278
     C                     ENDIF                                          CDL006
0560 C**
0559 C           BYPAS2    TAG                             **  BYPAS2  **
0621 C**
     C***-*NOT*EXPIRED*-*CHAIN*TO*LIMITS*REC.*ON*S/TABLE,*TI**            S01194
     C******************** MOVE FLTY      DLKY,1 *********          E13283S01194
     C*****                MOVE LLTY      DLKY,1                    E13283S01194
     C*****                EXSR DLCHN                                     S01194
     C***90**              GOTO DLLEND                                    S01194
0951 C*                                                             N     S01194
     C** - NOT EXPIRED - ACCESS LIMITS FILE                               S01194
     C                     MOVELLLTY      @CRNB                           S01194
     C                     CALL 'AOLIMTR0'                                S01194
     C**********           PARM '*MSG   ' @RTCD   7                                    S01194 CCB016
     C                     PARM *BLANKS   @RTCD                                               CCB016
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @CRNB   3                       S01194
     C           SDLIMT    PARM SDLIMT    DSFDY                           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C** IF LIMITS EXIST CONVERT EXPIRY DATE TO DDMMMYY FORMAT            S01117
     C                     MOVELLLED      ZDAYNO                          S01117
     C                     EXSR ZDATE2                                    S01117
     C                     MOVE ZADATE    LDESC                           S01117
     C                     GOTO XLDTAG                                    S01117
     C** ELSE, IF NO LIMITS ACCESS DEFAULTS                               S01117
     C                     ELSE                                           S01117
     C                     MOVE 'Y'       LDEF                            S01117
     C                     MOVE *BLANKS   FDEF                            S01117
     C                     EXSR DL0131                                    S01117
     C** IF NO DEFAULTS THEN THERE ARE NO LIMITS                          S01117
     C           LNLIM     IFEQ 0                                         S01117
     C                     MOVEL'NO LIM.' LDESC                           S01117
     C                     Z-ADD999       XLDA,1                          179353
     C                     Z-ADD99999     XLDT,1                          179353
     C                     GOTO LMTSL                                     179353
     C                     ELSE                                           S01117
     C                     Z-ADDSP        XLDA,1                          179353
     C           SP        ADD  BJRDNB    XLDT,1                          179353
     C                     Z-ADD999       XLDA,2                          179353
     C                     Z-ADD99999     XLDT,2                          179353
     C                     MOVEL'DEFAULT' LDESC                           S01117
     C** IF ALL LOWER LEVEL LIMITS HAD SAME TYPE, USE THIS FOR 1ST PRD    S01117
     C           LNSAME    IFEQ 'Y'                                       S01117
     C                     MOVEALNPER     XLDAA                           S01117
     C                     Z-ADDLNLIM     LLAM                            S01117
     C                     MOVELLNPC      XLPCIN                          S01117
     C           LLAM      DIV  XLPC,1    LLAM      H                     S01117
     C                     GOTO LMTSL                                     S01117
     C                     ELSE                                           S01117
     C**  ELSE SET UP SPOT PERIOD                                         S01117
     C                     Z-ADDSP        XLDA,1                          S01117
     C           SP        ADD  BJRDNB    XLDT,1                          S01117
     C***********          Z-ADD999       XLDA,2                   S01117 179353
     C***********          Z-ADD99999     XLDT,2                   S01117 179353
     C                     Z-ADDLNLIM     XLLM,1                          S01117
     C/COPY WNCPYSRC,DL0760AC07
     C***********          GOTO FRPROC                             S01117 CDL006
     C/COPY WNCPYSRC,DL0760AC08
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     GOTO FIPROC                                    CDL006
     C                     ELSE                                           180278
     C                     GOTO FRPROC                                    180278
     C                     ENDIF                                          CDL006
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01194
0626 C**
0627 C*****MOVE*DATA FROM INPUT FIELDS TO LENDING ARRAYS                  S01433
0627 C**   MOVE DATA FROM INPUT FIELDS TO MONEY MARKET ARRAYS             S01433
     C           XLDTAG    TAG                             **   XLDTAG  **
0578 C** MOVE END OF LIMIT PERIODS INTO LEPSIN (DS)                       S01194
0578 C                     MOVELA2E1LP    XLEP1                           S01194
0578 C                     MOVELA2E2LP    XLEP2                           S01194
0578 C                     MOVELA2E3LP    XLEP3                           S01194
0578 C                     MOVELA2E4LP    XLEP4                           S01194
0578 C                     MOVELA2E5LP    XLEP5                           S01194
0578 C                     MOVELA2E6LP    XLEP6                           S01194
0628 C                     MOVE LEPSIN    XLDAIN
0578 C** MOVE %/LIMIT FOR PERIODS INTO UP LPCSIN (DS)                     S01194
0578 C                     MOVELA2PL1P    XLPC1                           S01194
0578 C                     MOVELA2PL2P    XLPC2                           S01194
0578 C                     MOVELA2PL3P    XLPC3                           S01194
0578 C                     MOVELA2PL4P    XLPC4                           S01194
0578 C                     MOVELA2PL5P    XLPC5                           S01194
0578 C                     MOVELA2PL6P    XLPC6                           S01194
0629 C                     MOVE LPCSIN    XLPCIN
0630 C**
     C           LMTSL     TAG                                            S01117
0631 C                     Z-ADD0         D
0632 C**   DLOOP 2 PROCESSES XLDAA IN THE SAME WAY AS DLOOP1
0633 C           DLOOP2    TAG                             **  DLOOP2  **
0634 C**
0635 C           D         ADD  1         D
0636 C********** XLDAA,D   COMP '   '                    88               BHF416
     C           XLDAA,D   COMP '000'                    88               BHF416
0637 C           XLDAA,D   COMP '999'                    87
0638 C**
0639 C   88                Z-ADD999       XLDA,D
0640 C*
0641 C  N72      XLDAA,1   COMP 'SP '                    72
0642 C   72                Z-ADDSP        XLDA,1
0643 C**
0644 C*****      XLDA,D    ADD  RUND      XLDT,D                          S01194
0644 C           XLDA,D    ADD  BJRDNB    XLDT,D                          S01194
0645 C   88
0646 COR 87                Z-ADD99999     XLDT,D
0647 C**
0648 C  N88      LLAM      MULT XLPC,D    XLLM,D
0649 C**
0650 C           D         COMP 6                      86
0651 C   86N87N88          GOTO DLOOP2
     C/COPY WNCPYSRC,DL0760AC09
      *                                                                   CDL006
      ** If CDL006 is installed                                           CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           FIPROC    TAG                                            CDL006
      *                                                                   CDL006
      ** Process Fiduciary limits                                         CDL006
      ** - Check for zero limit type or if limit has expired              CDL006
      *                                                                   CDL006
     C           FIFILT    COMP 0                    898932               CDL006
     C   89      LLED      COMP BJRDNB               893389               CDL006
     C                     SETOF                         39               CDL006
     C           LLED      IFEQ 0                                         CDL006
     C           *IN32     ANDEQ'0'                                       CDL006
     C                     MOVE '0'       *IN33                           CDL006
     C                     MOVE '1'       *IN39                           CDL006
     C                     END                                            CDL006
     C  N89                MOVEL'EXPIRED' FIDESC                          CDL006
     C   89                GOTO FIPAS2                                    CDL006
      *                                                                   CDL006
      ** - If expired, set first period end days & date to nines          CDL006
      ** & zeroise amount                                                 CDL006
      *                                                                   CDL006
     C                     Z-ADD999       FIDA,1                          CDL006
     C                     Z-ADD99999     FIDT,1                          CDL006
     C                     Z-ADD0         FILM,1                          CDL006
     C                     GOTO FRPROC                                    CDL006
      *                                                                   CDL006
     C           FIPAS2    TAG                                            CDL006
      *                                                                   CDL006
      ** - Not expired - Access limtis file                               CDL006
      *                                                                   CDL006
     C                     MOVELFIFILT    @CRNB                           CDL006
     C                     CALL 'AOLIMTR0'                                CDL006
     C**********           PARM '*MSG   ' @RTCD   7                                    CDL006 CCB016
     C                     PARM *BLANKS   @RTCD                                               CCB016
     C                     PARM '*KEY   ' @OPTN   7                       CDL006
     C                     PARM           @CRNB   3                       CDL006
     C           SDLIMT    PARM SDLIMT    DSFDY                           CDL006
      *                                                                   CDL006
     C           @RTCD     IFEQ *BLANK                                    CDL006
      *                                                                   CDL006
      ** Move end of limit periods into LEPSIN (DS)                       CDL006
      *                                                                   CDL006
     C                     MOVELA2E1LP    XLEP1                           CDL006
     C                     MOVELA2E2LP    XLEP2                           CDL006
     C                     MOVELA2E3LP    XLEP3                           CDL006
     C                     MOVELA2E4LP    XLEP4                           CDL006
     C                     MOVELA2E5LP    XLEP5                           CDL006
     C                     MOVELA2E6LP    XLEP6                           CDL006
     C                     MOVE LEPSIN    FIDAIN                          CDL006
      *                                                                   CDL006
      ** Move %/Limit for periods into up LPCSIN (DS)                     CDL006
      *                                                                   CDL006
     C                     MOVELA2PL1P    XLPC1                           CDL006
     C                     MOVELA2PL2P    XLPC2                           CDL006
     C                     MOVELA2PL3P    XLPC3                           CDL006
     C                     MOVELA2PL4P    XLPC4                           CDL006
     C                     MOVELA2PL5P    XLPC5                           CDL006
     C                     MOVELA2PL6P    XLPC6                           CDL006
     C                     MOVE LPCSIN    FIPCIN                          CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
     C                     Z-ADD0         D                               CDL006
      *                                                                   CDL006
      ** FLOOP2 processes FIDAA in the same was as FLOOP1                 CDL006
      *                                                                   CDL006
     C           FLOOP2    TAG                                            CDL006
      *                                                                   CDL006
     C           D         ADD  1         D                               CDL006
     C           FIDAA,D   COMP '000'                    88               CDL006
     C           FIDAA,D   COMP '999'                    87               CDL006
      *                                                                   CDL006
     C   88                Z-ADD999       FIDA,D                          CDL006
      *                                                                   CDL006
     C  N72      FIDAA,1   COMP 'SP '                    72               CDL006
     C   72                Z-ADDSP        FIDA,1                          CDL006
      *                                                                   CDL006
     C           FIDA,D    ADD  BJRDNB    FIDT,D                          CDL006
     C   88                                                               CDL006
     COR 87                Z-ADD99999     FIDT,D                          CDL006
      *                                                                   CDL006
     C  N88      FIFILA    MULT FIPC,D    FILM,D                          CDL006
      *                                                                   CDL006
     C           D         COMP 6                      86                 CDL006
     C   86N87N88          GOTO FLOOP2                                    CDL006
     C                     ENDIF                                          CDL006
     C*                                                                   S01157
     C**   PROCESS FRA/IRS LIMITS.                                        S01157
     C**   CHECK IF FRA LIMIT HAS EXPIRED.                                S01157
     C*                                                                   S01157
     C           FRPROC    TAG                             **  FRPROC  ** S01157
     C*****      FRED      IFLT RUND                                S01157S01194
     C           FRED      IFLT BJRDNB                                    S01194
     C           FRED      ANDNE0                                         S01157
     C                     SETON                     35                   S01157
     C                     Z-ADD0         XRLM                            S01157
     C                     ELSE                                           S01157
     C                     Z-ADDFRAM      XRLM                            S01157
     C                     SETOF                     35                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN34                                               190544
     C                     MOVE '0'       *IN81                                               190544
      *                                                                                       190544
     C           FRAM      IFEQ 0                                         S01157
     C           *IN35     ANDEQ'0'                                       S01157
     C                     MOVE ' '       PDEF                                                190544
     C                     MOVE ' '       FDEF                                                190544
     C                     MOVE ' '       LDEF                                                190544
     C                     MOVE ' '       IRS                                                 190544
     C                     MOVE 'Y'       FRA                                                 190544
     C                     EXSR DL0131                                                        190544
     C           FRLIM     IFEQ 0                                                             190544
     C                     SETON                     34                   S01157
     C                     ELSE                                           S01157
     C**********           SETOF                     34                                S01157 190544
     C                     Z-ADDFRLIM     XRLM                                                190544
     C                     MOVE '1'       *IN81                                               190544
     C                     ENDIF                                                              190544
     C                     END                                            S01157
      *                                                                   179353
      ** Display FR Expiry date if not NO LIMIT nor expired               179353
      *                                                                   179353
     C           *IN34     IFEQ '0'                                       179353
     C           *IN35     ANDEQ'0'                                       179353
     C                     EXSR ZDATE2                                    179353
     C                     MOVE ZADATE    FREDAT  7                       179353
     C                     ENDIF                                          179353
     C*                                                                   S01157
     C*    IRS LIMITS                                                     S01157
     C****       IRED      IFLT RUND                               S01157 S01194
     C           IRED      IFLT BJRDNB                                    S01194
     C           IRED      ANDNE0                                         S01157
     C                     SETON                     37                   S01157
     C                     Z-ADD0         XILM                            S01157
     C                     ELSE                                           S01157
     C                     Z-ADDIRAM      XILM                            S01157
     C                     SETOF                     37                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN36                                               190544
     C                     MOVE '0'       *IN82                                               190544
      *                                                                                       190544
     C           IRAM      IFEQ 0                                         S01157
     C           *IN37     ANDEQ'0'                                       S01157
     C                     MOVE ' '       PDEF                                                190544
     C                     MOVE ' '       FDEF                                                190544
     C                     MOVE ' '       LDEF                                                190544
     C                     MOVE ' '       FRA                                                 190544
     C                     MOVE 'Y'       IRS                                                 190544
     C                     EXSR DL0131                                                        190544
     C           IRLIM     IFEQ 0                                                             190544
     C                     SETON                     36                   S01157
     C                     ELSE                                           S01157
     C**********           SETOF                     36                                S01157 190544
     C                     MOVE '1'       *IN82                                               190544
     C                     Z-ADDIRLIM     XILM                                                190544
     C                     ENDIF                                                              190544
     C                     END                                            S01157
0652 C**
      ** Display IR Expiry date if not NO LIMIT nor expired               179353
      *                                                                   179353
     C           *IN36     IFEQ '0'                                       179353
     C           *IN37     ANDEQ'0'                                       179353
     C                     EXSR ZDATE2                                    179353
     C                     MOVE ZADATE    IREDAT  7                       179353
     C                     ENDIF                                          179353
     C*                                                                   179353
     C** Reset Lending Limit fields and Expiry Dates                      179353
     C*                                                                   179353
     C                     Z-ADD0         LLAM                            179353
     C                     Z-ADD0         LLED                            179353
     C                     Z-ADD0         LLRD                            179353
     C                     Z-ADD0         FRED                            179353
     C                     Z-ADD0         IRED                            179353
0653 C**
0654 C           DLLEND    ENDSR                           **  DLLEND  **
0655 C**
0656 C********************************************************************S01194
0657 C*****DLCHN SR. CHAINS TO TABLE FILE FOR LIMIT TYPE RECORD.          S01194
0658 C*****      DLCHN     BEGSR                           **  DLCHN  **  S01194
0659 C*****      DLKY,1    CHAINTABLE                90                   S01194
0661 C*****                ENDSR                                          S01194
0662 C********************************************************************
0663 C**   DLEXPF SR. CALCULATES EXPOSURE FOR A FX DEAL.
0664 C**
0665 C           DLEXPF    BEGSR                           **  DLEXPF  **
0666 C**
0667 C**   DEFINE INPUT FIELDS
0668 C                     Z-ADDDLVALU    DLVALU  50       VALUE DATE
0669 C                     Z-ADDDLAMTF    DLAMTF 130       LIMIT CCY EQUIV
0670 C**                                                       AMOUNT
0611 C**   IF VALUE DATE IS LESS OR EQUAL TO RUN DATE - FIRST PERIOD ONLY
0672 C*****      DLVALU    COMP RUND                   8989               S01194
0672 C*****      DLVALU    COMP BJRDNB                 8989         S01194S01433
     C           DLVALU    COMP RUND2                  8989               S01433
     C***********FXSP      IFEQ 'Y'                                S01433 179353
     C************IN89     ANDEQ'1'                                S01433 179353
     C           *IN89     IFEQ '1'                                       179353
     C   89      XFXP1     ADD  DLAMTF    XFXP1                           S01433
     C**********           ELSE                                           S01433
     C********** XFXP,1    ADD  DLAMTF    XFXP,1                          S01433
     C**********           END                                            S01433
     C**                                                                  S01433
0674 C   89                GOTO DLFEND
     C                     END                                            S01433
0675 C**
0676 C**   VALUE DATE IS GREATER THAN TODAY - AMOUNT IS ADDED INTO EVERY
0677 C**   PERIOD PRECEDING & INCLUDING THE PERIOD WHICH INCLUDES THE
0678 C**   VALUE DATE.
0679 C                     Z-ADD0         D       20
0680 C**
0681 C           DLOOP3    TAG                             **  DLOOP3  **
0682 C           D         ADD  1         D
0683 C**
0684 C**   ADD AMOUNT INTO THIS PERIOD
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0760ACP1                                           S01408
     C*                                                                   S01408
0685 C           XFXP,D    ADD  DLAMTF    XFXP,D
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0760ACP2                                           S01408
     C*                                                                   S01408
0686 C**
0687 C**   LOOP AGAIN TO ADD AMOUNT INTO NEXT PERIOD IF
0688 C**   - VALUE DATE EXCEEDS THIS END OF PERIOD DATE.
0689 C**   - LESS THAN SIX PERIODS HAVE BEEN USED.
0690 C           DLVALU    COMP XFDT,D               88
0691 C           D         COMP 6                      87
0692 C   87 88             GOTO DLOOP3
0693 C**
0694 C           DLFEND    ENDSR                           **  DLFEND  **
0695 C**
     C********************************************************************S01433
     C**   DLEXPF SR. CALCULATES EXPOSURE FOR A PRECIOUS METAL DEAL       S01433
     C**                                                                  S01433
     C           PMEXPF    BEGSR                           **  PMEXPF  ** S01433
     C**                                                                  S01433
     C**   DEFINE INPUT FIELDS                                            S01433
     C                     Z-ADDDLVALU    DLVALU  50       VALUE DATE     S01433
     C                     Z-ADDDLAMTF    DLAMTF 130       LIMIT CCY EQUIVS01433
     C**                                                       AMOUNT     S01433
     C**   IF VALUE DATE IS LESS OR EQUAL TO RUND - FIRST PERIOD ONLY     S01433
     C           DLVALU    COMP RUND2                  8989               S01433
     C********   XMXP1     IFGT *ZEROS                                    S01433
     C           PMSP      IFEQ 'Y'                                       S01433
     C           *IN89     ANDEQ'1'                                       S01433
     C   89      XPXP1     ADD  DLAMTF    XPXP1                           S01433
     C**********           ELSE                                           S01433
     C********** XPXP,1    ADD  DLAMTF    XPXP,1                          S01433
     C**********           END                                            S01433
     C   89                GOTO DLPEND                                    S01433
     C                     END                                            S01433
     C**                                                                  S01433
     C**   VALUE DATE IS GREATER THAN TODAY - AMOUNT IS ADDED INTO EVERY  S01433
     C**   PERIOD PRECEDING & INCLUDING THE PERIOD WHICH INCLUDES THE     S01433
     C**   VALUE DATE.                                                    S01433
     C                     Z-ADD0         D       20                      S01433
     C**                                                                  S01433
     C           MLOOP2    TAG                             **  DLOOP3  ** S01433
     C           D         ADD  1         D                               S01433
     C**                                                                  S01433
     C**   ADD AMOUNT INTO THIS PERIOD                                    S01433
     C           XPXP,D    ADD  DLAMTF    XPXP,D                          S01433
     C**                                                                  S01433
     C**   LOOP AGAIN TO ADD AMOUNT INTO NEXT PERIOD IF                   S01433
     C**   - VALUE DATE EXCEEDS THIS END OF PERIOD DATE.                  S01433
     C**   - LESS THAN SIX PERIODS HAVE BEEN USED.                        S01433
     C           DLVALU    COMP XPDT,D               88                   S01433
     C           D         COMP 6                      87                 S01433
     C   87 88             GOTO MLOOP2                                    S01433
     C**                                                                  S01433
     C           DLPEND    ENDSR                           **  DLPEND  ** S01433
     C**                                                                  S01433
0696 C********************************************************************
0697 C*****DLEXPL*SR. CALCULATES EXPOSURE FOR A LOAN DEAL.
     C**   DLEXPL SR. CALCULATES EXPOSURE FOR A MONEY MARKT DEAL.         S01433
0698 C**
0699 C           DLEXPL    BEGSR                           **  DLEXPL  ** S01433
0700 C**
0701 C**   DEFINE INPUT FIELDS
0702 C                     Z-ADDDLMATD    DLMATD  50
0703 C                     Z-ADDDLAMTL    DLAMTL 130
0704 C**
0705 C*****IF*MATURITY DATE IS LESS THAN RUND ADD RUN DATE TO IT.         S01194
0706 C********   DLMATD    COMP RUND                   89                 S01194
0707 C***89***   DLMATD    ADD  RUND      DLMATD                          S01194
0705 C**   IF MATURITY DATE IS LESS THAN RUN DATE, ADD RUN DATE TO IT.    S01194
0706 C           DLMATD    COMP BJRDNB                 89                 S01194
0707 C   89      DLMATD    ADD  BJRDNB    DLMATD                          S01194
     C/COPY WNCPYSRC,DL0760AC10
0708 C**
0709 C**   LOOP TO ADD AMOUNT INTO EVERY PERIOD PRECEDING & INCLUDING
0710 C**   THE PERIOD WHICH INCLUDES THE MATURITY DATE.
0711 C                     Z-ADD0         D       20
0712 C           DLOOP4    TAG                             **  DLOOP4  **
     C/COPY WNCPYSRC,DL0760AC11
      *                                                                   CDL006
      ** If CDL006 is installed, and deal type is 'FL', 'DP' or 'LP'      CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FL'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
     C           D         ADD  1         D                               CDL006
      *                                                                   CDL006
      ** Subtract the exposure for value date event                       CDL006
      *                                                                   CDL006
     C   44      FIDT,D    IFLT DLMATD                                    CDL006
     C           FIXP,D    SUB  DLAMTL    FIXP,D                          CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
      ** Add amount into this period                                      CDL006
      *                                                                   CDL006
     C  N44      FIXP,D    ADD  DLAMTL    FIXP,D                          CDL006
      *                                                                   CDL006
      ** Loop again to add amount into next period if                     CDL006
      ** - Maturity date exceeds this end of period date                  CDL006
      ** - Less than six periods have been used                           CDL006
      *                                                                   CDL006
     C           DLMATD    COMP FIDT,D               88                   CDL006
     C           D         COMP 6                      87                 CDL006
0723 C   87 88             GOTO DLOOP4                                    CDL006
     C                     ELSE                                           CDL006
0713 C           D         ADD  1         D
0714 C**
     C**   SUBTRACT THE EXPOSURE FOR VALUE DATE EVENT                     E12072
     C   44      XLDT,D    IFLT DLMATD                                    E12072
     C           XLXP,D    SUB  DLAMTL    XLXP,D                          E12072
     C                     END                                            E12072
     C**                                                                  E12072
0715 C**   ADD AMOUNT INTO THIS PERIOD
0656 C*********  XLXP,D    ADD  DLAMTL    XLXP,D   ****                   E12072
0716 C  N44      XLXP,D    ADD  DLAMTL    XLXP,D                          E12072
0717 C**
0718 C**   LOOP AGAIN TO ADD AMOUNT INTO NEXT PERIOD IF
0719 C**   - MATURITY DATE EXCEEDS THIS END OF PERIOD DATE.
0720 C**   - LESS THAN SIX PERIODS HAVE BEEN USED
0721 C           DLMATD    COMP XLDT,D               88
0722 C           D         COMP 6                      87
0723 C   87 88             GOTO DLOOP4
     C/COPY WNCPYSRC,DL0760AC14
     C                     END                                            CDL006
0724 C**
0725 C                     ENDSR
0726 C********************************************************************
0727 C**   DLXCSF SR. WORKS OUT EXCESS EXPOSURE FOR FX
0728 C**   -FIRST ROUNDS EXPOSURE FOR EACH PERIOD TO NEAREST 1000 UNITS
0729 C**   -THEN COMPARES EXPOSURE AMOUNTS TO CORRESP. LIMIT AMOUNTS.
0730 C           DLXCSF    BEGSR                           **  DLXCSF  **
     C*                                                                   S01433
     C           XFXP1     DIV  1000      XFXP1     H                     S01433
     C   60      XFXP1     COMP 0                        60               S01433
     C           XFXP1     COMP XFLM1                89                   S01433
     C   89                SETON                     70                   S01433
     C   89      XFXP1     SUB  XFLM1     XFXS1  100                      S01433
0731 C                     Z-ADD0         D       20
0732 C           DLOOP5    TAG                             **  DLOOP5  **
0733 C           D         ADD  1         D
0734 C           XFXP,D    DIV  1000      XFXP,D    H
     C   60      XFXP,D    COMP 0                        60
     C*** CHECK FOR LIMIT ALSO                                            097989
     C   61      XFLM,D    COMP 0                        61               097989
0735 C           XFXP,D    COMP XFLM,D               89
0736 C   89      XFXP,D    SUB  XFLM,D    XFXS,D
     C   89                SETON                     70                   S1105
0737 C**
0738 C**   LOOP ROUND AGAIN IF LESS THAN 6 PERIODS HAVE BEEN PROCESSED
0739 C           D         COMP 6                      89
0740 C   89                GOTO DLOOP5
     C/COPY WNCPYSRC,DL0760AC12
0741 C                     ENDSR
0742 C**
     C********************************************************************S01433
     C**   DLXCSP SR. WORKS OUT EXCESS EXPOSURE FOR PRECIOUS METAL        S01433
     C**   -FIRST ROUNDS EXPOSURE FOR EACH PERIOD TO NEAREST 1000 UNITS   S01433
     C**   -THEN COMPARES EXPOSURE AMOUNTS TO CORRESP. LIMIT AMOUNTS.     S01433
     C           DLXCSP    BEGSR                           **  DLXCSP  ** S01433
     C*                                                                   S01433
     C           XPXP1     DIV  1000      XPXP1     H                     S01433
     C/COPY WNCPYSRC,DL0760AC27
     C   60      XPXP1     COMP 0                        60               S01433
     C/COPY WNCPYSRC,DL0760AC28
     C           XPXP1     COMP XPLM1                89                   S01433
     C   89                SETON                     70                   S01433
     C   89      XPXP1     SUB  XPLM1     XPXS1  100                      S01433
     C*                                                                   S01433
     C                     Z-ADD0         D       20                      S01433
     C           MLOOP3    TAG                             **  MLOOP3  ** S01433
     C           D         ADD  1         D                               S01433
     C           XPXP,D    DIV  1000      XPXP,D    H                     S01433
     C/COPY WNCPYSRC,DL0760AC29
     C   60      XPXP,D    COMP 0                        60               S01433
     C/COPY WNCPYSRC,DL0760AC30
     C           XPXP,D    COMP XPLM,D               89                   S01433
     C   89                SETON                     70                   S01433
     C   89      XPXP,D    SUB  XPLM,D    XPXS,D                          S01433
     C**                                                                  S01433
     C**   LOOP ROUND AGAIN IF LESS THAN 6 PERIODS HAVE BEEN PROCESSED    S01433
     C           D         COMP 6                      89                 S01433
     C   89                GOTO MLOOP3                                    S01433
     C                     ENDSR                                          S01433
     C**                                                                  S01433
     C********************************************************************
     C/EJECT                                                              S01433
     C*****************************************************************   S01433
     C**                                                              *   S01433
     C**   #ZBB      - THIS SUBROUTINE CALCULATES THE REVALUATED      *   S01433
     C**               AMOUNT FOR THE SELECTED EVENT.                 *   S01433
     C**                                                              *   S01433
     C**   CALLS     - #ZBBA, #ZBBB, #ZBBC                            *   S01433
     C**                                                              *   S01433
     C**   CALLED BY - MAIN                                           *   S01433
     C**                                                              *   S01433
     C*****************************************************************   S01433
     C           #ZBB      BEGSR                                          S01433
     C*                                                                   S01433
     C** INITIALISE TEMPORARY VARIABLES FOR THIS SUBROUTINE               S01433
     C                     Z-ADD*ZEROS    WWTMP1 138                      S01433
     C                     Z-ADD*ZEROS    WWTMP2  50                      S01433
     C                     Z-ADD*ZEROS    WWTMP3  50                      S01433
     C                     Z-ADD*ZEROS    WWTMP4 188                      S01433
     C                     Z-ADD*ZEROS    WWTMP5 138                      S01433
     C                     Z-ADD*ZEROS    WWRVAM 188                      S01433
     C                     Z-ADD*ZEROS    WWRAT  138                      S01433
     C                     Z-ADD*ZEROS    WWPOW  159                      S01433
     C*                                                                   S01433
     C** FILL FORWARD ARRAYS FOR THIS CURRENCY                            S01433
     C                     EXSR #ZBBA                                     S01433
     C*                                                                   S01433
     C** MOVE BUYED DATE INTO DATE WORK FIELD                             S01433
     C                     Z-ADDDLVALU    WWDATE                          S01433
     C*                                                                   S01433
     C** CALCULATE FORWARD RATE FOR DATE                                  S01433
     C                     EXSR #ZBBB                                     S01433
     C*                                                                   S01433
     C** CALCULATE REVALUATED AMOUNT FOR SOLD DATE                        S01433
     C                     EXSR #ZBBC                                     S01433
     C*                                                                   S01433
     C           #ZBB0     ENDSR                                          S01433
     C*                                                                   S01433
     C*****************************************************************   S01433
     C/EJECT                                                              S01433
     C*****************************************************************   S01433
     C**                                                              *   S01433
     C**   #ZBAA     - THIS SUBROUTINE FILLS THE FORWARD RATE AND     *   S01433
     C**               DATE ARRAYS FOR THE SELECTED CURRENCY          *   S01433
     C**                                                              *   S01433
     C**   CALLS     - NONE                                           *   S01433
     C**                                                              *   S01433
     C**   CALLED BY - #ZBB                                           *   S01433
     C**                                                              *   S01433
     C*****************************************************************   S01433
     C*                                                                   S01433
     C           #ZBBA     BEGSR                                          S01433
     C*                                                                   S01433
     C** INITIALISE ARRAYS                                                S01433
     C                     Z-ADD*ZEROS    DAT                             S01433
     C                     Z-ADD*ZEROS    RAT                             S01433
     C*                                                                   S01433
     C** INITIALISE LAST ELEMENT IN DATE ARRAY                            S01433
     C                     Z-ADD26        WWLAST  20                      S01433
     C*                                                                   S01433
     C** ACCESS FOWARD RATES FILE WITH CURRENT DEAL CURRENCY              S01433
     C           WWCCY     CHAINFWDRT                70                   S01433
     C*                                                                   S01433
     C** PROCESS ONLY ACTIVE RECORDS                                      S01433
     C           *IN70     IFEQ '0'                                       S01433
     C           RECI      ANDEQ'D'                                       S01433
     C           CHTP      ANDNE'D'                                       S01433
     C*                                                                   S01433
     C** PUT TODAYS DATE IN FIRST ELEMENT OF ARRAY                        S01433
     C                     Z-ADDBJRDNB    DAT,1                           S01433
     C                     Z-ADD2         L                               S01433
     C                     Z-ADD1         P                               S01433
     C*                                                                   S01433
     C** IF FORWARD DATE ARRAY IS EMPTY                                   S01433
     C           DFWW,P    IFEQ *ZEROS                                    S01433
     C                     Z-ADD1         WWLAST                          S01433
     C*                                                                   S01433
     C                     ELSE                                           S01433
     C*                                                                   S01433
     C** WHILE A VALID DATE EXISTS IN FORWARD DATE ARRAY USE THESE        S01433
     C**  VALUES TO FILL DATE ARRAY                                       S01433
     C           L         DOWLE26                                        S01433
     C           DFWW,P    ANDNE*ZEROS                                    S01433
     C           DFWW,P    ADD  BJRDNB    DAT,L                           S01433
     C                     ADD  1         L                               S01433
     C           L         IFNE 27                                        S01433
     C           L         SUB  1         P                               S01433
     C                     END                                            S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C** IF FORWARD DATE ARRAY NOT FULL NOTE POSITION OF LAST             S01433
     C**   VALID DATE                                                     S01433
     C           DFWW,25   IFEQ *ZEROS                                    S01433
     C                     Z-ADDP         WWLAST                          S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C* Call Access Prog. to obtain REQUIRED CURRENCY                     S01433
     C                     CALL 'AOCURRR0'                                S01433
     C                     PARM '*MSG   ' @RTCD   7                       S01433
     C                     PARM '*KEY   ' @OPTN   7                       S01433
     C                     PARM WWCCY     @AJCD   3                       S01433
     C           SDCURR    PARM SDCURR    DSSDY                           S01433
     C*                                                                   S01433
     C** IF NO RECORD FOUND OR LAST CHANGE TYPE = 'D' - DBERROR           S01433
     C           @RTCD     IFNE *BLANK                                    S01194
     C           A6TYLC    OREQ 'D'                                       S01433
     C                     MOVEL'SDCURRPD'DBFILE           ************   S01433
     C                     MOVEL'06'      DBASE            * DBERR 06 *   S01433
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01433
     C                     MOVEL@AJCD     DBKEY  29                       S01433
     C                     SETON                     U7U8LR               S01433
     C                     EXSR *PSSR                                     S01433
     C                     GOTO NOPRT                                     S01433
     C                     ELSE                                           S01433
     C*                                                                   S01433
     C**   SAVE SPOT RATE / NO. OF DECIMAL PLACES / MULT/DIV INDICATOR    S01433
     C**   FOR ROUTINE SCONV                                              S01433
     C           A6SPRT    IFEQ 0                                         S01433
     C                     DUMP                                           S01433
     C                     END                                            S01433
      *                                                                   S01433
     C                     Z-ADDA6SPRT    WWSPRT                          S01433
     C                     Z-ADDA6NBDP    WWDECP                          S01433
     C                     MOVE A6MDIN    WWMDIV                          S01433
     C*                                                                   S01433
     C**  FILL FORWARD RATE ARRAY FOR REQUIRED CURRENCY                   S01433
     C                     Z-ADDA6SPRT    RAT,1                           S01433
     C                     Z-ADD2         L                               S01433
     C           L         DOWLE26                                        S01433
     C           L         SUB  1         P                               S01433
     C                     Z-ADDRFWW,P    RAT,L                           S01433
     C                     ADD  1         L                               S01433
     C                     END                                            S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C           #ZBBA0    ENDSR                                          S01433
     C*                                                                   S01433
     C*****************************************************************   S01433
     C/EJECT                                                              S01433
     C*****************************************************************   S01433
     C**                                                              *   S01433
     C**   #ZBBB     - THIS SUBROUTINE CALCULATES THE FORWARD RATE.   *   S01433
     C**                                                              *   S01433
     C**   CALLS     - NONE                                           *   S01433
     C**                                                              *   S01433
     C**   CALLED BY - #ZBB                                           *   S01433
     C**                                                              *   S01433
     C*****************************************************************   S01433
     C*                                                                   S01433
     C           #ZBBB     BEGSR                                          S01433
     C*                                                                   S01433
     C** LOOK UP DATE ARRAY FOR CURRENT DATE                              S01433
     C           WWDATE    LOKUPDAT,Y                    26               S01433
     C*                                                                   S01433
     C** IF WORK DATE DOES NOT MATCH A DATE IN THE DATE ARRAY             S01433
     C           *IN26     IFEQ '0'                                       S01433
     C                     Z-ADD1         N                               S01433
     C           WWDATE    DOWGTDAT,N                                     S01433
     C           N         ANDLTWWLAST                                    S01433
     C                     ADD  1         N                               S01433
     C                     END                                            S01433
     C           N         IFGT 1                                         S01433
     C           N         SUB  1         M                               S01433
     C                     ELSE                                           S01433
     C                     Z-ADD2         N                               S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C** IF DATE BETWEEN TWO DATES ON ARRAY                               S01433
     C           WWDATE    IFLT DAT,N                                     S01433
     C*                                                                   S01433
     C** USE TEMPORARY VARIABLES TO CALCULATE RATE                        S01433
     C           RAT,N     SUB  RAT,M     WWTMP1                          S01433
     C           WWDATE    SUB  DAT,M     WWTMP2                          S01433
     C           DAT,N     SUB  DAT,M     WWTMP3                          S01433
     C           WWTMP1    MULT WWTMP2    WWTMP4                          S01433
     C           WWTMP4    DIV  WWTMP3    WWTMP5                          S01433
     C           RAT,M     ADD  WWTMP5    WWRAT                           S01433
     C*                                                                   S01433
     C                     ELSE                                           S01433
     C*                                                                   S01433
     C** IF WORK DATE AFTER LAST DATE IN ARRAY                            S01433
     C                     MOVE RAT,N     WWRAT                           S01433
     C*                                                                   S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C                     ELSE                                           S01433
     C*                                                                   S01433
     C** EVENT DATE MATCHES A DATE IN THE ARRAY                           S01433
     C                     Z-ADDRAT,Y     WWRAT                           S01433
     C*                                                                   S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C** IF NO RATE RETRIEVED FROM FORWARD RATES FILE USE SPOT RATE       S01433
     C           WWRAT     IFEQ *ZEROS                                    S01433
     C                     Z-ADDWWSPRT    WWRAT                           S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C           #ZBBB0    ENDSR                                          S01433
     C*                                                                   S01433
     C*****************************************************************   S01433
     C/EJECT                                                              S01433
     C*****************************************************************   S01433
     C**                                                              *   S01433
     C**   #ZBBC     - THIS SUBROUTINE CALCULATES THE REVALUATED      *   S01433
     C**               AMOUNT.                                        *   S01433
     C**                                                              *   S01433
     C**   CALLS     - NONE                                           *   S01433
     C**                                                              *   S01433
     C**   CALLED BY - #ZBB                                           *   S01433
     C**                                                              *   S01433
     C*****************************************************************   S01433
     C*                                                                   S01433
     C           #ZBBC     BEGSR                                          S01433
     C*                                                                   S01433
     C** CALCULATE REFERENCE NUMBER FOR POWER ARRAY                       S01433
     C           WWDECP    SUB  WWDPI     T       10                      S01433
     C           T         ADD  4         T                               S01433
     C*                                                                   S01433
     C** CALCULATE REVALUATED AMOUNT                                      S01433
     C           WWMDIV    IFEQ 'M'                                       S01433
     C*                                                                   S01433
     C** APPLY POWER OF 10                                                S01433
     C           WWRAT     DIV  POWER,T   WWPOW                           S01433
     C           WWAMT     MULT WWPOW     WWRVAM                          S01433
     C*                                                                   S01433
     C                     ELSE                                           S01433
     C*                                                                   S01433
     C*                                                                   S01433
     C** APPLY POWER OF 10                                                S01433
     C           WWRAT     MULT POWER,T   WWPOW                           S01433
     C           WWPOW     IFNE 0                                         S01433
     C           WWAMT     DIV  WWPOW     WWRVAM                          S01433
     C                     ELSE                                           S01433
     C                     DUMP                                           S01433
     C                     Z-ADD0         WWRVAM                          S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C                     END                                            S01433
     C*                                                                   S01433
     C           #BBC0     ENDSR                                          S01433
     C*                                                                   S01433
     C*****************************************************************   S01433
0743 C********************************************************************
0744 C*****DLXCSL*SR.*WORKS OUT EXCESS EXPOSURE FOR LOANS.               S01433
0744 C**   DLXCSL SR. WORKS OUT EXCESS EXPOSURE FOR MONEY MARKET         S01433
0745 C           DLXCSL    BEGSR
0746 C                     Z-ADD0         D       20
0747 C           DLOOP6    TAG                             **  DLOOP6  **
0748 C           D         ADD  1         D
0749 C           XLXP,D    DIV  1000      XLXP,D    H
     C***60******XLXP,D    COMP 0                        60               097989
     C   62      XLXP,D    COMP 0                        62               097989
     C*** CHECK FOR LIMIT ALSO                                            097989
     C   63      XLLM,D    COMP 0                        63               097989
0750 C           XLXP,D    COMP XLLM,D               89
0751 C   89      XLXP,D    SUB  XLLM,D    XLXS,D
     C   89                SETON                     70                   S1105
0752 C**
0753 C           D         COMP 6                      89
0754 C   89                GOTO DLOOP6
     C/COPY WNCPYSRC,DL0760AC13
      *                                                                   CDL006
      ** If CDL006 is installed                                           CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     Z-ADD0         D       20                      CDL006
     C           FLOOP6    TAG                                            CDL006
     C           D         ADD  1         D                               CDL006
     C           FIXP,D    DIV  1000      FIXP,D    H                     CDL006
     C   60      FIXP,D    COMP 0                        60               CDL006
     C           FIXP,D    COMP FILM,D               89                   CDL006
     C   89      FIXP,D    SUB  FILM,D    FIXS,D                          CDL006
     C   89                SETON                     70                   CDL006
      *                                                                   CDL006
     C           D         COMP 6                      89                 CDL006
     C   89                GOTO FLOOP6                                    CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
0755 C                     ENDSR
0756 C**
0757 C********************************************************************
0833 C********************************************************************S01194
0834 C*****                                                               S01194
0835 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0836 C*****                                                               S01194
0837 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0838 C*****                                                               S01194
0839 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0840 C*****                MOVEL'01      'ZTABKY 12                       S01194
0841 C*****                MOVE '  10'    ZTABKY                          S01194
0842 C*****                                                               S01194
0843 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0844 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0845 C*****                                                               S01194
0846 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0847 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0848 C*****                                                               S01194
0849 C*****                ENDSR                                          S01194
0850 C*****                                                               S01194
0851 C*****                                                               S01194
0852 C********************************************************************
0757 C/COPY ZSRSRC,ZFWDT                                               ***S01195
0757 C/COPY ZSRSRC,ZACCH                                               ***S01195
0757 C********************************************************************S01194
0758 C*****                                                               S01194
0759 C*****                                                               S01194
0760 C*****ZDATE3 SR. TO CALCULATE ANY NUMBER OF WORKING                  S01194
0761 C*****           DAYS FORWARD IN ANY CURRENCY.                       S01194
0762 C*****                                                               S01194
0763 C*****    THIS SR. CAN BE USED WHEN THE INPUT CYCLE IS RUNNING AS    S01194
0764 C*****    HOLIDAY RECORDS ARE ACCESSED BY CHAIN. THEREFORE NEWLY     S01194
0765 C*****    ADDED RECORDS IN THE OVERFLOW AREA CAN ALSO BE ACCESSED.   S01194
0766 C*****                                                               S01194
0767 C*****      ZDATE3    BEGSR                           *** ZDATE3 *** S01194
0768 C*****                                                               S01194
0769 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                           S01194
0770 C*****                Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01194
0771 C*****                MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01194
0772 C*****                Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01194
0773 C*****                                                DAYS FORWARD   S01194
0774 C*****CLEAR COUNT OF NBR OF DAYS ADDED, & DEFINE ZDYNBR.             S01194
0775 C*****                Z-ADD0         ZDCNT   20                      S01194
0776 C*****                Z-ADDZDAYNO    ZDYNBR  50                      S01194
0777 C*****                                                               S01194
0778 C*****LOOP TO INCREMENT DAY NUMBER AND CHECK FOR HOLIDAY.            S01194
0779 C*****      ZDLOP1    TAG                             ** ZDLOP1 TAG *S01194
0780 C*****                                                               S01194
0781 C*****                SETOF                     9596                 S01194
0782 C*****      ZDYNBR    ADD  1         ZDYNBR                          S01194
0783 C*****                                                               S01194
0784 C*****SET KEY FOR FIRST HOLIDAY RECORD.                              S01194
0785 C*****                MOVEL'22    '  ZDHKEY 12                       S01194
0786 C*****                MOVELZDYNBR    ZWRK6   6                       S01194
0787 C*****                MOVE '1'       ZWRK6                           S01194
0788 C*****                MOVE ZWRK6     ZDHKEY                          S01194
0789 C*****                                                               S01194
0790 C*****CHAIN FOR HOLIDAY RECORD, RECORD 1 OR 2                        S01194
0791 C*****      ZDHCHN    TAG                             ** ZDHCHN TAG *S01194
0792 C*****                                                               S01194
0793 C*****      ZDHKEY    CHAINTABLE                90    ON NOT THERE   S01194
0794 C**N90      RECI      COMP 'D'                  9090  DELETED        S01194
0795 C*****                                                               S01194
0796 C*****NO RECORD 1 FOUND, IS NOT A HOLIDAY                            S01194
0797 C***90N95             GOTO ZDOAGN                                    S01194
0798 C*****                                                               S01194
0799 C*****NO RECORD 2 FOUND                                              S01194
0800 C***90 95 96          GOTO ZDLOP1                     EXC. NOT FOUND S01194
0801 C***90 95N96          GOTO ZDOAGN                     INC. NOT FOUND S01194
0802 C*****                                                               S01194
0803 C*****DETERMINE TYPE FOUND, INCLUDE OR EXCLUDE                       S01194
0804 C*****      INEX      COMP 'E'                  92  91               S01194
0805 C*****                                                               S01194
0806 C*****CHECK IF DAY IS HOLIDAY FOR CURRENCY.                          S01194
0807 C*****      ZCCY      LOKUPHCCY                     93               S01194
0808 C***91 93             GOTO ZDOAGN                     EXCLUDE FOUND  S01194
0809 C***92 93             GOTO ZDLOP1                     INCLUDE FOUND  S01194
0810 C*****                                                               S01194
0811 C*****IF EXCLUDE OR INCLUDE NOT FOUND CHECK                          S01194
0812 C*****FOR SECOND HOLIDAY RECORD, IF REQUIRED.                        S01194
0813 C*****      '   '     LOKUPHCCY                     94ON IF NO RCD.2 S01194
0814 C*****                MOVE ZDHKEY    ZWRK1   1                       S01194
0815 C*****      ZWRK1     COMP '1'                      95               S01194
0816 C***91 95             SETON                     96                   S01194
0817 C***95N94             MOVE '2'       ZDHKEY                          S01194
0818 C***95N94             GOTO ZDHCHN                     GET SECOND REC S01194
0819 C*****                                                               S01194
0820 C***91                GOTO ZDLOP1                     EXC. NOT FOUND S01194
0821 C***92                GOTO ZDOAGN                     INC. NOT FOUND S01194
0822 C*****                                                               S01194
0823 C*****INCREMENT COUNT AND CHECK IF REQUIRED NUMBER OF DAYS           S01194
0824 C*****HAVE BEEN ADDED. IF NOT, GO THROUGH LOOP1 AGAIN.               S01194
0825 C*****      ZDOAGN    TAG                             ** ZDOAGN TAG *S01194
0826 C*****                                                               S01194
0827 C*****      ZDCNT     ADD  1         ZDCNT                           S01194
0828 C*****      ZDCNT     COMP ZNRDYS                 97                 S01194
0829 C***97                GOTO ZDLOP1                                    S01194
0830 C*****                                                               S01194
0831 C*****                ENDSR                                          S01194
0832 C*****                                                               S01194
0869 C********************************************************************
0853 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0854 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0855 C*
0856 CSR         GLZADD    BEGSR                           *** GLZADD ****
0857 C*
0858 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0859 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0860 C*
0861 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0862 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0863 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0864 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0865 C*
0866 CSR                   EXSR GLZSUM
0867 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0868 C*
0869 C********************************************************************
0870 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0871 C*                        GLZADD, GLZSUB, GLZCMP.
0872 C*          PARAMETERS PASSED -
0873 C*                     I/P ZZAMTI ZZAMTD
0874 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0875 C*
0876 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0877 C*
0878 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0879 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0880 CSR                   SETOF                     919293
0881 CSR                   SETOF                     949599
0882 C*
0883 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0884 CSR         ZZAMTI    COMP 0                      9293
0885 CSR 93      ZZAMTD    COMP 0                      9293
0886 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0887 C*
0888 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0889 CSR         ZZTOTI    COMP 0                      9193
0890 CSR 93      ZZTOTD    COMP 0                      9193
0891 C*
0892 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0893 CSR 93                Z-ADDZZAMTI    ZZTOTI
0894 CSR 93                Z-ADDZZAMTD    ZZTOTD
0895 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0896 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0897 CSR 91N92
0898 CORN91 92             GOTO ZZOFPS
0899 C*
0900 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0901 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0902 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0903 C*
0904 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0905 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0906 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0907 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0908 C*
0909 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0910 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0911 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0912 CSRN99                Z-ADDZZWK2     ZZTOTD
0913 CSRN99                Z-ADDZZWK3     ZZTOTI
0914 C*
0915 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0916 CSR 99                Z-ADD0         ZZAMT  153
0917 CSR                   GOTO ZZSEND
0918 C*
0919 C* THE 'SIGNS' ARE DIFFERENT
0920 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0921 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0922 C*
0923 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0924 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0925 C*
0926 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0927 C*
0928 CSR 91                Z-SUBZZTOTI    ZZTOTI
0929 CSR 91                Z-SUBZZTOTD    ZZTOTD
0930 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0931 C*
0932 CSR         ZZTOTI    COMP ZZAMTI               93  95
0933 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0934 C*
0935 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0936 CSR 95                Z-ADD0         ZZTOTI
0937 CSR 95                Z-ADD0         ZZTOTD
0938 CSR 95                GOTO ZZSEND
0939 C*
0940 C* IF ZZTOT GT. ZZAMT.
0941 CSR 93      ZZAMTD    COMP ZZTOTD               94
0942 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0943 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0944 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0945 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0946 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0947 C*
0948 C*
0949 C* IF ZZAMT GT. ZZTOT.
0950 CSRN93      ZZTOTD    COMP ZZAMTD               94
0951 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0952 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0953 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0954 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0955 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0956 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0957 C*
0958 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0959 CSR                   SETOF                     94
0960 CSR 93 91
0961 CORN93 92             SETON                     94
0962 CSR 94                Z-SUBZZTOTI    ZZTOTI
0963 CSR 94                Z-SUBZZTOTD    ZZTOTD
0964 C**
0965 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0966 CSR 92                Z-SUBZZAMTI    ZZAMTI
0967 CSR 92                Z-SUBZZAMTD    ZZAMTD
0968 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0969 C**
0970 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0971 CSR                   SETOF                     96
0972 CSR         ZZTOTD    COMP 0                        91
0973 CSR 91      ZZTOTI    COMP 0                      96
0974 CSR 96                MOVE '.000-'   ZZNEGD  5
0975 CSR                   ENDSR                             ** ENDSR **
0976 C********************************************************************
     C/EJECT                                                              S01117
0699 C********************************************************************S01117
     C**                                                                  S01117
     C**   P/DL0131 TO GET DEFAULT LIMITS FOR CUSTOMER LEVEL              S01117
     C**                                                                  S01117
     C           DL0131    BEGSR                                          S01117
     C********             Z-ADD0         FXLIM   90               S01117 S01433
     C                     Z-ADD0         FXLMS   90                      S01433
     C                     Z-ADD0         FXLMF   90                      S01433
     C                     Z-ADD0         PMLMS   90                      S01433
     C                     Z-ADD0         PMLMF   90                      S01433
     C                     Z-ADD0         LNLIM   90                      S01117
     C                     MOVE 'Y'       FXSAME  1                       S01117
     C                     MOVE 'Y'       PMSAME  1                       S01433
     C                     MOVE 'Y'       LNSAME  1                       S01117
     C                     MOVE *BLANKS   FXPER  18                       S01117
     C                     MOVE *BLANKS   PMPER  18                       S01433
     C                     MOVE *BLANKS   LNPER  18                       S01117
     C                     MOVE *BLANKS   FXPC   18                       S01117
     C                     MOVE *BLANKS   PMPC   18                       S01433
     C                     MOVE *BLANKS   LNPC   18                       S01117
     C                     MOVE 'S'       @RLEV   1                       S01117
     C                     MOVE *BLANKS   ENTY    3                       S01117
     C********             CALL 'DL0131'                           S01117 S01433
     C                     CALL 'DL0131A'                                 S01433
     C                     PARM           CUNR                            S01117
     C                     PARM           @RLEV                           S01117
     C                     PARM           ENTY                            S01117
     C                     PARM           FDEF                            S01117
     C                     PARM           LDEF                            S01117
     C                     PARM           PDEF                            S01433
     C                     PARM           FRA     1                       S01117
     C                     PARM           IRS     1                       S01117
     C********             PARM           FXLIM                    S01117 S01433
     C                     PARM           FXLMS                           S01433
     C                     PARM           FXLMF                           S01433
     C                     PARM           LNLIM                           S01117
     C                     PARM           PMLMS                           S01433
     C                     PARM           PMLMF                           S01433
     C                     PARM           FRLIM   90                      S01117
     C                     PARM           IRLIM   90                      S01117
     C                     PARM           FXSAME                          S01117
     C                     PARM           LNSAME                          S01117
     C                     PARM           PMSAME                          S01433
     C                     PARM           FXPER                           S01117
     C                     PARM           LNPER                           S01117
     C                     PARM           PMPER                           S01433
     C                     PARM           FXPC                            S01117
     C                     PARM           LNPC                            S01117
     C                     PARM           PMPC                            S01433
     C                     PARM           BJRDNB                          S01117
     C                     ENDSR                                          S01117
0848 C********************************************************************S01117
     C/EJECT                                                              S01117
0699 C********************************************************************S01117
0849 C**                                                                  S01117
0850 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.            S01117
0851 C**                                                                  S01117
0852 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.         S01117
0853 C**                                                                  S01117
0854 C           ZDATE2    BEGSR                           *** ZDATE2 *** S01117
0855 C**                                                                  S01117
0856 C**   CLEAR DATE FIELDS.                                             S01117
0857 C                     Z-ADD0         ZDATE   60                      S01117
0858 C                     MOVEL'       ' ZADATE  7                       S01117
0859 C**                                                                  S01117
0860 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.                        S01117
0861 C                     Z-ADDZDAYNO    ZDAYNO  50                      S01117
0862 C**                                                                  S01117
0863 C**   DETERMINE YEAR NUMBER.                                         S01117
0864 C**                                                                  S01117
0865 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    S01117
0866 C           ZDAYNO    SUB  1         ZDAYN1  50   99                 S01117
0867 C   99                GOTO ZDEND2                                    S01117
0868 C**                                                                  S01117
0869 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             S01117
0870 C           ZDAYN1    DIV  1461      ZLYR    20                      S01117
0871 C                     MVR            ZDAYN1           SAVE REMAINING S01117
0872 C**                                                   DAYS           S01117
0873 C**   CALCULATE NUMBER OF REMAINING YEARS.                           S01117
0874 C                     Z-ADD1         ZWRK2   20                      S01117
0875 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *S01117
0876 C           ZDAYN1    COMP ZYDY,ZWRK2             90                 S01117
0877 C  N90      ZWRK2     ADD  1         ZWRK2                           S01117
0878 C  N90                GOTO ZDTAG1                                    S01117
0879 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON S01117
0880 C**                                                                  S01117
0881 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  S01117
0882 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          S01117
0883 C**                                                                  S01117
0884 C**   CALCULATE ACTUAL YEAR NUMBER.                                  S01117
0885 C           ZLYR      MULT 4         ZWRK3   30                      S01117
0886 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972   S01117
0887 C                     Z-ADDZWRK3     ZYEAR   20                      S01117
0888 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           S01117
0889 C**                                                                  S01117
0890 C**   DETERMINE MONTH NUMBER.                                        S01117
0891 C**                                                                  S01117
0892 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         S01117
0893 C                     SETOF                     9293                 S01117
0894 C   91      ZDAYN1    COMP 59                     9293               S01117
0895 C   91N92   ZDAYN1    SUB  1         ZDAYN1                          S01117
0896 C**                                                                  S01117
0897 C**   CALCULATE MONTH NUMBER.                                        S01117
0898 C                     Z-ADD2         ZWRK2                           S01117
0899 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *S01117
0900 C           ZDAYN1    COMP ZMDY,ZWRK2             94                 S01117
0901 C  N94      ZWRK2     ADD  1         ZWRK2                           S01117
0902 C  N94                GOTO ZDTAG2                                    S01117
0903 C           ZWRK2     SUB  1         ZWRK2                           S01117
0904 C**                                                                  S01117
0905 C                     Z-ADDZWRK2     ZMTH    20       MONTH          S01117
0906 C**                                                                  S01117
0907 C**   DETERMINE DAY OF MONTH.                                        S01117
0908 C**                                                                  S01117
0909 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.                          S01117
0910 C           ZDAYN1    ADD  1         ZDAYN1                          S01117
0911 C**                                                                  S01117
0912 C**   CALCULATE DAY OF MONTH.                                        S01117
0913 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            S01117
0914 C**                                                                  S01117
0915 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       S01117
0916 C   93      ZDAY      ADD  1         ZDAY                            S01117
0917 C**                                                                  S01117
0918 C**   FORMAT DATE, DDMMYY OR MMDDYY.                                 S01117
0919 C  N98                MOVELZDAY      ZWRK4   40                      S01117
0920 C   98                MOVE ZDAY      ZWRK4                           S01117
0921 C  N98                MOVE ZMTH      ZWRK4                           S01117
0922 C   98                MOVELZMTH      ZWRK4                           S01117
0923 C                     MOVELZWRK4     ZDATE                           S01117
0924 C                     MOVE ZYEAR     ZDATE                           S01117
0925 C**                                                                  S01117
0926 C**   FORMAT ALPHA DATE, DDMMMYY.                                    S01117
0927 C           ZDAY      COMP 10                     95                 S01117
0928 C                     MOVELZDAY      ZWRK5   5                       S01117
0929 C   95                MOVEL' '       ZWRK5                           S01117
0930 C                     MOVE ZMNM,ZMTH ZWRK5                           S01117
0931 C                     MOVELZWRK5     ZADATE                          S01117
0932 C                     MOVE ZYEAR     ZADATE                          S01117
0933 C**                                                                  S01117
0934 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*S01117
0935 C**                                                                  S01117
0719 C********************************************************************S01117
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0590 C********************************************************************S01194
0977 O*L0760P1H***03   OF                                           S01124S01117
0977 ODL0760P1E   03   OF      HEADS                                      S01117
     O       OR   03   08                                                 BHF416
0978 O*****                              22 'REFERENCE DL0760'            S01117
0978 O*****                              22 'REFERENCE DL0760P1'    S01117S01433
0978 O                                   22 'REFERENCE DL0760AP1'         S01433
0979 O*****                    TITL      89                               S01194
0979 O                         BJURPT    89                               S01194
0980 O                                  122 'DATE              PAGE'
0981 O*****                    RUNA     112                               S01194
0981 O                         BJMRDT   112                               S01194
0982 O                         PAGE  Z  127
0983 O*       H 2      OF                                                 S1105
     O*****   H 2      OFNU1                                        S1105 S01117
     O        E 2      OFNU1   HEADS                                      S01117
     O       OR 2      08NU1                                              BHF416
0929 O                                   68 'EXPOSURE AGAINST LIMITS '
0930 O                                   77 'IN 000''S '
0986 O*****                    BCYL      80                               S01194
0986 O                         BNCYCD    80                               S01194
     O*****   H 2      OF U1                                        S1105 S01117
     O        E 2      OF U1   HEADS                                      S01117
     O       OR 2      08 U1                                              BHF416
0929 O                                   57 'EXCEPTION EXPOSURE'          S1105
     O                                   72 'AGAINST LIMITS'              S1105
0930 O                                   82 'IN 000''S '                  S1105
     O*****                    BCYL      85                         S1105 S01194
     O                         BNCYCD    85                               S01194
0987 O*       H 1      OF                                                 S1105
     O*****   H 1      OFNU1                                        S1105 S01117
     O        E 1      OFNU1   HEADS                                      S01117
     O       OR 1      08NU1                                              BHF416
0933 O                                   68 '------------------------'
0934 O                                   80 '------------'
     O*****   H 1      OF U1                                        S1105 S01117
     O        E 1      OF U1   HEADS                                      S01117
     O       OR 1      08 U1                                              BHF416
     O                                   58 '-------------------'         S1105
     O                                   72 '--------------'              S1105
     O                                   85 '-------------'               S1105
0990 O****    H 21     OFNLR                                              S01157
0991 O****                               54 '------- F O R E I G N  '     S01157
0992 O****                               77 'E X C H A N G E -------'     S01157
0993 O****                              107 '--------------- L E N D '    S01157
0994 O****                              129 'I N G ----------------'      S01157
0995 O****    H  1     OFNLR                                              S01157
0996 O****                               12 'CUSTOMER'                    S01157
0997 O****                               57 'PERIOD       LIMIT      '    S01157
0998 O****                               77 'EXPOSURE        EXCESS'      S01157
0999 O****                              106 'PERIOD       LIMIT     '     S01157
1000 O****                              129 'EXPOSURE        EXCESS'      S01157
     O**                                                                  LN0728
     O        E 21     OF      HEADS                                      LN0728
     O       OR 21     08                                                 LN0728
     O                                   18 'CONSOLIDATED'                LN0728
     O**                                                                  LN0728
     O*****   H 21     OFNLR                                        S01157S01117
     O        E 21     OF      HEADS                                      S01117
     O       OR 21     08                                                 BHF416
     O************                       14 'CUSTOMER'            S01157  S01433
     O************                       88 'PERIOD'              S01157  S01433
     O************                      100 'LIMIT'               S01157  S01433
     O************                      115 'EXPOSURE'            S01157  S01433
     O************                      129 'EXCESS'              S01157  S01433
     O                                   12 'CUSTOMER'                    S01433
     O                                   31 'P/C'                         S01433
     O                                   40 'TYPE'                        S01433
     O**********                         53 'PERIOD'                                   S01433 190544
     O**********                         70 'LIMIT'                                    S01433 190544
     O**********                         88 'EXPOSURE'                                 S01433 190544
     O**********                        109 'EXCESS'                                   S01433 190544
     O                                   61 'PERIOD'                                          190544
     O                                   78 'LIMIT'                                           190544
     O                                   96 'EXPOSURE'                                        190544
     O                                  117 'EXCESS'                                          190544
     O**                                                                  S01157
1001 O****    EF2      50                                                 S01157
1002 O****   OR 1      51                                                 S01157
1003 O****   OR 1      52 53                                              S01157
1003 O****   OR 1      52 54                                              S01157
1004 O****                50   CUNR       6                               S01157
1005 O****                50   CRNM      27                               S01157
1005 O****                50             29 'P'                           S01157
1005 O****                50 10          29 'C'                           S01157
1005 O****                51   CTNM      17                               S01157
1006 O****                   53NEXTF     33                               S01157
1007 O****                50             33 '001'                         S01157
1008 O****                   53          34 '-'                           S01157
1009 O****                   53XFDA,D    37                               S01157
1010 O****             50 71             37 ' SPOT  '                     S01157
1011 O****                   53XFLM,D1   49                               S01157
1010 O****             50 30             49 'NO LIMIT'                    S01157
1010 O****             50 31             49 'EXPIRED'                     S01157
1012 O****                   53FXPOS 1   63                               S01157
1013 O****                   53XFXS,D1   77                               S01157
1014 O****                   54NEXTL     85                               S01157
1015 O****                50             85 '001'                         S01157
1016 O****                   54          86 '-'                           S01157
1017 O****                   54XLDA,D    89                               S01157
1018 O****             50 72             89 ' SPOT  '                     S01157
1019 O****                   54XLLM,D1  101                               S01157
1018 O****             50 32            101 'NO LIMIT'                    S01157
1018 O****             50 33            101 'EXPIRED'                     S01157
1020 O****                   54LXPOS 1  115                               S01157
1021 O****                   54XLXS,D1  129                               S01157
     O*                                                                   S01157
     O*                                                                   S01433
     O        EF2              CUSTO                                      S01433
     O                    50 53CUNR      08                               S01433
     O                    50 53CRNM      30                               S01433
     O                    50 53CTWN      42                               S01433
     O**   FOREIGN EXCHANGE DETAIL LINE.                                  S01157
     O**   SPOT                                                           S01433
     O*                                                                   S01433
     O        EF2              FXLN1S                                     S01433
     O********EF2      50 53                                        S01157S01433
     O*******OR 1      51 53                                        S01157S01433
     O********************50 53CNUM      08                   S01157BHF416S01433
     O********            50 53CUNR      08                         BHF416S01433
     O********            50 53CRNM      30                         S01157S01433
     O********            50 53CTWN      42                         S01157S01433
     O********            50 53          67 'FOREIGN EXCHANGE'      S01157S01433
     O********            50 53          80 'P'                     S01157S01433
     O********         53 50 10          80 'C'                     S01157S01433
     O********               53NEXTF     84                         S01157S01433
     O********            50 53          84 '001'                   S01157S01433
     O********               53          85 '-'                     S01157S01433
     O********               53XFDA,D    88                         S01157S01433
     O********               53XFLM,D1  101                         S01157S01433
     O********         50 30 53         101 'NO LIMIT'              S01157S01433
     O********         50 31 53         101 'EXPIRED'               S01157S01433
     O********         50 38 53         101 'NO EXPIRY'             E26066S01433
     O********               53FXPOS 1  115                         S01157S01433
     O********               53XFXS,D1  129                         S01157S01433
     O                                   36 'FX'                          S01433
     O                                   30 'P'                           S01433
     O                       10          30 'C'                           S01433
     O**********                         51 'SPOT'                                     S01433 190544
     O**********               XFLM1 1   70                                            S01433 190544
     O                                   59 'SPOT'                                            190544
     O                         XFLM1 1   78                                                   190544
     O**********             30FDESC     70                         S01433064258
     O**********             31FDESC     70                         S01433064258
     O**********               FDESC     46                                            064258 190544
     O**********               FXPOS 1   88                               S01433
     O**********               XFXP1 1   88                                            S01433 190544
     O********               53XFXS,D1  129                               S01433
     O**********               XFXS1 1  109                                            S01433 190544
     O                         FDESC     54                                                   190544
     O                         XFXP1 1   96                                                   190544
     O                         XFXS1 1  117                                                   190544
     O*                                                                   S01433
     O**   FORWARD                                                        S01433
     O*                                                                   S01433
     O        EF2              FXLN1F                                     S01433
     O                                   30 'P'                           S01433
     O                       10          30 'C'                           S01433
     O                                   36 'FX'                          S01433
     O**********             53NEXTF     51                                            S01433 190544
     O**********             53          51 '001-'                                     S01433 190544
     O**********             53XFDA,1    54                                            S01433 190544
     O**********             53XFLM,11   70                                            S01433 190544
     O**********          31 53FDESC     70                         S01433064258
     O**********          30 53FDESC     70                         S01433064258
     O**********             53FDESC     46                         064258153759
     O**********             53FDESC2    46                                            153759 190544
     O**********             53FXPOS 1   88                                            S01433 190544
     O**********             53XFXS,11  109                                            S01433 190544
     O                       53NEXTF     59                                                   190544
     O                       53          59 '001-'                                            190544
     O                       53XFDA,1    62                                                   190544
     O                       53XFLM,11   78                                                   190544
     O                       53FDESC2    54                                                   190544
     O                       53FXPOS 1   96                                                   190544
     O                       53XFXS,11  117                                                   190544
     O*                                                                   S01433
     O        EF1              FXLN2                                      S01433
     O**********             53NEXTF     50                                            S01433 190544
     O**********             53          51 '-'                                        S01433 190544
     O**********             53XFDA,D    54                                            S01433 190544
     O**********             53XFLM,D1   70                                            S01433 190544
     O**********       31 53   FDESC     70                         S01433064258
     O**********       30 53   FDESC     70                         S01433064258
     O**********             53FXPOS 1   88                                            S01433 190544
     O**********             53XFXS,D1  109                                            S01433 190544
     O                       53NEXTF     58                                                   190544
     O                       53          59 '-'                                               190544
     O                       53XFDA,D    62                                                   190544
     O                       53XFLM,D1   78                                                   190544
     O                       53FXPOS 1   96                                                   190544
     O                       53XFXS,D1  117                                                   190544
     O*                                                                   S01433
     O**   PRECIOUS METAL DETAIL LINE. (SPOT)                             S01433
     O*                                                                   S01433
     O        EF2              PMLN1S                                     S01433
     O                                   36 'PM'                          S01433
     O**********                         51 'SPOT'                                     S01433 190544
     O**********               XPLM1 1   70                                            S01433 190544
     O**********             48PDESC     70                         S01433064258
     O**********             49PDESC     70                         S01433064258
     O**********               PDESC     46                                            064258 190544
     O**********               XPXP1 1   88                                            S01433 190544
     O**********               XPXS1 1  109                                            S01433 190544
     O                                   59 'SPOT'                                            190544
     O                         XPLM1 1   78                                                   190544
     O                         PDESC     54                                                   190544
     O                         XPXP1 1   96                                                   190544
     O                         XPXS1 1  117                                                   190544
     O*                                                                   S01433
     O**   PRECIOUS METAL DETAIL LINE. (FORWARD)                          S01433
     O*                                                                   S01433
     O        EF2              PMLN1F                                     S01433
     O                                   36 'PM'                          S01433
     O**********                         51 '001-'                                     S01433 190544
     O**********               XPDA,1    54                                            S01433 190544
     O**********               XPLM,11   70                                            S01433 190544
     O**********             48PDESC     70                         S01433064258
     O**********             49PDESC     70                         S01433064258
     O**********               PDESC     46                                            064258 190544
     O**********               PMPOS 1   88                                            S01433 190544
     O**********               XPXS,11  109                                            S01433 190544
     O                                   59 '001-'                                            190544
     O                         XPDA,1    62                                                   190544
     O                         XPLM,11   78                                                   190544
     O                         PDESC     54                                                   190544
     O                         PMPOS 1   96                                                   190544
     O                         XPXS,11  117                                                   190544
     O        EF1              PMLN2                                      S01433
     O**********               NEXTM     50                                            S01433 190544
     O**********                         51 '-'                                        S01433 190544
     O**********               XPDA,D    54                                            S01433 190544
     O**********               XPLM,D1   70                                            S01433 190544
     O**********             48PDESC     70                         S01433064258
     O**********             49PDESC     70                         S01433064258
     O**********               PMPOS 1   88                                            S01433 190544
     O**********               XPXS,D1  109                                            S01433 190544
     O                         NEXTM     58                                                   190544
     O                                   59 '-'                                               190544
     O                         XPDA,D    62                                                   190544
     O                         XPLM,D1   78                                                   190544
     O                         PMPOS 1   96                                                   190544
     O                         XPXS,D1  117                                                   190544
     O*****LENDING*DETAIL LINE.                                           S01433
     O**   MONEY MARKET DETAIL LINE.                                      S01433
     O*                                                                   S01157
     O        EF2      50 54                                              S01157
     O       OR 1      51 54                                              S01157
     O********************50 54CNUM      08                   S01157BHF416S01433
     O*********           50 54CUNR      08                         BHF416S01433
     O*********           50 54CRNM      30                         S01157S01433
     O*********           50 54CTWN      42                         S01157S01433
     O*********           50 54          58 'LENDING'               S01157S01433
     O*********           50 54          80 'P'                     S01157S01433
     O********         54 50 10          80 'C'                     S01157S01433
     O********               54NEXTL     84                         S01577S01433
     O********            50 54          84 '001'                   S01577S01433
     O********               54          85 '-'                     S01577S01433
     O********               54XLDA,D    88                         S01577S01433
     O********         50 72 54          88 ' SPOT  '               S01577S01433
     O********               54XLLM,D1  101                         S01577S01433
     O********         50 32 54         101 'NO LIMIT'              S01577S01433
     O********         50 33 54         101 'EXPIRED'               S01577S01433
     O********         50 39 54         101 'NO EXPIRY'             E26066S01433
     O********               54LXPOS 1  115                         S01577S01433
     O********               54XLXS,D1  129                         S01577S01433
     O**********          50 54          46 'MONEY MARKET'          S01433064258
     O                    50 54          36 'MM'                          064258
     O**********             54NEXTL     50                                            S01433 190544
     O**********          50 54          50 '001'                                      S01433 190544
     O**********             54          51 '-'                                        S01433 190544
     O**********             54XLDA,D    54                                            S01433 190544
     O**********             54XLLM,D1   70                                            S01433 190544
     O**********          32 54LDESC     70                         S01433064258
     O**********          33 54LDESC     70                         S01433064258
     O***********         32 54LDESC     46                        064258 179353
     O***********         33 54LDESC     46                        064258 179353
     O**********             54LDESC  B  46                                            179353 190544
     O**********             54LXPOS 1   88                                            S01433 190544
     O**********             54XLXS,D1  109                                            S01433 190544
     O                       54NEXTL     58                                                   190544
     O                    50 54          58 '001'                                             190544
     O                       54          59 '-'                                               190544
     O                       54XLDA,D    62                                                   190544
     O                       54XLLM,D1   78                                                   190544
     O                       54LDESC  B  54                                                   190544
     O                       54LXPOS 1   96                                                   190544
     O                       54XLXS,D1  117                                                   190544
     O/COPY WNCPYSRC,DL0760AO01
      *                                                                   CDL006
     O        EF2      50 45                                              CDL006
     O       OR 1      51 45                                              CDL006
     O                    50 45          36 'FI'                          CDL006
     O**********             45FIEXTL    50                                            CDL006 190544
     O**********          50 45          50 '001'                                      CDL006 190544
     O**********             45          51 '-'                                        CDL006 190544
     O**********             45FIDA,D    54                                            CDL006 190544
     O**********             45FILM,D1   70                                            CDL006 190544
     O**********          32 45FIDESC    46                                            CDL006 190544
     O**********          33 45FIDESC    46                                            CDL006 190544
     O**********             45FIXPOS1   88                                            CDL006 190544
     O**********             45FIXS,D1  109                                            CDL006 190544
     O                       45FIEXTL    58                                                   190544
     O                    50 45          58 '001'                                             190544
     O                       45          59 '-'                                               190544
     O                       45FIDA,D    62                                                   190544
     O                       45FILM,D1   78                                                   190544
     O                    32 45FIDESC    54                                                   190544
     O                    33 45FIDESC    54                                                   190544
     O                       45FIXPOS1   96                                                   190544
     O                       45FIXS,D1  117                                                   190544
     O*                                                                   S01157
     O**   FORWARD RATE AGREEMENT DETAIL LINE.                            S01157
     O*                                                                   S01157
     O        EF2      57 55                                              S01157
     O***********************  CNUM      08                         S01157BHF416
     O*******                  CUNR      08                         BHF416S01433
     O*******                  CRNM      30                         S01157S01433
     O*******                  CTWN      42                         S01157S01433
     O*******                            73 'FORWARD RATE AGREEMENT'S01157S01433
     O*******                            80 'P'                     S01157S01433
     O*******             10             80 'C'                     S01157S01433
     O*******                  XRLM  1  101                         S01157S01433
     O*******             34            101 'NO LIMIT'              S01157S01433
     O*******             35            101 'EXPIRED'               S01157S01433
     O*******                  RXPOS 1  115                         S01157S01433
     O*******                  XRXS  1  129                         S01157S01433
     O                                   42 'FWD RATE'                    S01433
     O                    81             54 'DEFAULT'                                         190544
     O**********               XRLM  1   70                                            S01433 190544
     O**********          34             70 'NO LIMIT'                                 S01433 190544
     O**********          35             70 'EXPIRED'                                  S01433 190544
     O**********               RXPOS 1   88                                            S01433 190544
     O**********               XRXS  1  109                                            S01433 190544
     O                         XRLM  1   78                                                   190544
     O                    34             78 'NO LIMIT'                                        190544
     O                    35             78 'EXPIRED'                                         190544
     O                         RXPOS 1   96                                                   190544
     O                         XRXS  1  117                                                   190544
     O*                                                                   S01157
     O**   INTEREST RATE SWAP DETAIL LINE.                                S01157
     O*                                                                   S01157
     O        EF2      57 56                                              S01157
     O***********************  CNUM      08                         S01157BHF416
     O*******                  CUNR      08                         BHF416S01433
     O*******                  CRNM      30                         S01157S01433
     O*******                  CTWN      42                         S01157S01433
     O*******                            69 'INTEREST RATE SWAP'    S01157S01433
     O*******                            80 'P'                     S01157S01433
     O*******             10             80 'C'                     S01157S01433
     O*******                  XILM  1  101                         S01157S01433
     O*******             36            101 'NO LIMIT'              S01157S01433
     O*******             37            101 'EXPIRED'               S01157S01433
     O*******                  IXPOS 1  115                         S01157S01433
     O*******                  XIXS  1  129                         S01157S01433
     O                                   43 'RATE SWAP'                   S01433
     O                    82             54 'DEFAULT'                                         190544
     O**********               XILM  1   70                                            S01433 190544
     O**********          36             70 'NO LIMIT'                                 S01433 190544
     O**********          37             70 'EXPIRED'                                  S01433 190544
     O**********               IXPOS 1   88                                            S01433 190544
     O**********               XIXS  1  109                                            S01433 190544
     O                         XILM  1   78                                                   190544
     O                    36             78 'NO LIMIT'                                        190544
     O                    37             78 'EXPIRED'                                         190544
     O                         IXPOS 1   96                                                   190544
     O                         XIXS  1  117                                                   190544
     O*                                                                   S01433
     O*                                                                   S01157
     O********T   22   LR 46NU7                                           E10421
     O*****   TF  22   LR 46NU7                                     E10421S01117
1051 O*****                              63 '***   NO DETAILS TO REPO'    S01117
1052 O*****                              71 'RT   ***'                    S01117
1053 O*****   T 3      LRNU7 31                                    S01117 LN0236
1053 O        T 3      LRNU7N46                                           LN0236
1054 O                                   71 '*** END OF REPORT ***'       S01117
0977 ODL0760AUT   03   LR                                                 S01194
0978 O*******                            22 'REFERENCE DL0760AU'    S01194S01433
0978 O                                   22 'REFERENCE DL0760AAU'         S01433
0979 O                         BJURPT    89                               S01194
0980 O                                  122 'DATE              PAGE'      S01194
0981 O                         BJMRDT   112                               S01194
0982 O                         PAGE1 Z  127                               S01194
0983 O        T 2      LRNU1                                              S01194
0984 O                                   68 'EXPOSURE BY CUSTOMER OF'     S01194
0985 O                                   83 'RISK IN 000''S '             S01194
0986 O                         BNCYCD    86                               S01194
     O        T 2      LR U1                                              S01194
     O                                   57 'EXCEPTION EXPOSURE'          S01194
     O                                   77 'BY CUSTOMER OF RISK'         S01194
     O                                   87 'IN 000''S'                   S01194
     O                         BNCYCD    91                               S01194
0987 O*       T 1      LRNU1                                              S01194
0987 O        T 1      LRNU1                                              LN0236
0988 O                                   66 '----------------------'      S01194
0989 O********                           83 '-----------------'    S01194 LN0236
0989 O                                   86 '--------------------'        LN0236
     O        T 1      LR U1                                              S01194
     O                                   57 '------------------'          S01194
     O                                   75 '------------------'          S01194
     O********                           88 '-------------'        S01194 LN0236
     O                                   91 '----------------'            LN0236
1022 O*****   TF00     LR                                                 S01194
1023 O        T   36   LR
1024 O                                   18 'RUN CONTROLS'
1025 O        T 2      LR
1026 O                                   59 'NUMBER'
1027 O                                   84 'VALUE'
1028 O        T 2      LR
1029 O                                   29 'EXTRACT FILE RECORDS '
1030 O                                   34 'INPUT'
1031 O                         RREAD 3   59
1032 O                         INT,1 Z   81
1033 O                         DEC,1     84
1034 O                 43                89 '***'
1035 O        T 2      LR
1036 O                                   29 'EXTRACT FILE CONTROL '
1037 O                                   35 'TOTALS'
1038 O                         NORE  3   59
1039 O                         HRWN  Z   81
1040 O                         HRDC      84
1041 O                 43                89 '***'
     O        T 2      LR U3                                              CDL002
     O                                   29 'NETTING FILE RECORDS '       CDL002
     O                                   34 'INPUT'                       CDL002
     O                         NREAD 3   59                               CDL002
     O                         INT,3 Z   81                               CDL002
     O                         DEC,3     84                               CDL002
1042 O        T 2      LR
1043 O                                   28 'RECORDS READ IN THIS'
1044 O                                   35 ' REPORT'
1045 O                         RLIST 3   59
1046 O                         INT,2 Z   81
1047 O                         DEC,2     84
1048 O        T 3      LR 43
1049 O                                   71 '***   DIFFERENCE   ***'
     O        T 3      LR 46NU7                                           S01117
1051 O                                   68 '***   NO DETAILS TO REPO'    S01117
1052 O                                   76 'RT   ***'                    S01117
1055 O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   49 'OPTION'                      S01117
     O                         DBOPTN    57                               S01117
     O                                   66 'KEY'                         S01117
     O                         DBKEY     96                               S01117
1053 O*****   T 3      LR                                                 S01117
1054 O*****                              71 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   FCT - CONVERSION FACTORS
0001
0010
0100
1000
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   POWER - POWERS OF 10 FOR CURRENCY CONVERSION                         S01433
0000001
0000010
0000100
0001000
0010000
0100000
1000000
