     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Exposure by Region of Risk by Ctry')          *
/*OVRF*: OVRDBF FILE(EVLA) TOFILE(EVLACB)                           : *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                   *
     F*                                                               *
     F*  DL0782 - COUNTRY EXPOSURE AGAINST LIMITS-BY COUNTRY          *
     F*           CALLED BY DLC806OB OR DLC806BB ACCORDING TO MENU    *
     F*           SELECTION OF ORIGINATING BRANCH OR BOOKING BRANCH;  *
     F*           PROMPT PROGRAM USED IS DL0806B WITH DSPF DL806BFM.  *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CDL096             Date 22Sep14               *
      *  Prev Amend No. CDL094             Date 11Jun14               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CDL028             Date 07Feb05               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CDL002             Date 22Sep97               *
      *                 099251             Date 24Feb97               *
     F*                 067533             DATE 09MAR94               *
     F*                 046303             DATE 13JAN94               *
     F*                 S01393             DATE 30OCT92               *
     F*                 E38323             DATE 30JUL92               *
     F*                 LN0746             DATE 17SEP90               *
     F*                 LN0632             DATE 15AUG90               *
     F*                 LN0226             DATE 05JUN90               *
     F*                 E309               DATE 11APR90               *
     F*                 E305               DATE  9APR90               *
     F*                 E262               DATE  9MAR90               *
     F*                 E257               DATE  9MAR90               *
     F*                 S01157             DATE 07MAR90               *
     F*                 E150               DATE  5DEC89               *
     F*                 E00099             DATE 24NOV89               *
     F*                 E00013             DATE 20NOV89               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  CDL002 - FX Netting. Exclude netted FX deal events and       *
     F*           include FX net events.                              *
     F*  099251 - Different exposure amount shown on the report       *
     F*           and on exception report.                            *
     F*  067533 - Set up Overflow Line correctly in the Print File    *
     F*           definition instead of amending it in the RPG code.  *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
     F*  S01393 - Recompiled for SRM                                  *
     F*  E38323 - Recompilation of the program done due to a change   *
     F*           in subroutine ZFWDT                                 *
     F*  LN0746 - P1 & AU FILES CHANGED TO SAME NAME AS PROGRAM       *
     F*           DUMMY FILES CREATED                                 *
     F*  LN0632 - EXPOSURES AND LIMITS NOT CALCULATED                 *
     F*           PROPERLY FOR FRA/IRS                                *
     F*  LN0226 - INCORPORATE FURTHER CHANGES MADE FOR                *
     F*           R10 - FRA/IRS.  S01117, S01194, S01157 ETC.         *
     F*  E309   - ASSUMES LAST LIMIT PERIOD WILL BE 999,              *
     F*           ACTUALLY IF LEFT BLANK WILL DEFAULT TO 000          *
     F*  E305   - WHEN NO DETAILS, AU SHOULD SHOW ENTITY LEVEL        *
     F*           BRANCH/COMPANY, BOOKING/ORIGINATING BRANCH          *
     F*  E262   - REPORT IS BY COUNTRY BUT P1 SAYS CUSTOMER           *
     F*  E257   - INCORRECT AU AND P1 FILES SPECIFIED FOR RCF         *
     F*  S01157 - FRA/IRS  INCORPORATION                              *
     F*  E150   - NO HEADINGS PRODUCED ON FIRST PAGE                  *
     F*  E00099 - 'NO DETAILS' MSG INCORRECTLY POSITIONED IN          *
     F*           AUDIT REPORT                                        *
     F*  E00013 - CORRECT PROGRAM TO NOT TO PRODUCE A P1 IF           *
     F*           THERE ARE NO DETAILS FOR THAT PARTICULAR            *
     F*           CUSTOMER OR PARENT                                  *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*
     F*  PRODUCTION OPTIONS USING THIS RPG:
     F*    P.O:                               FILE OVERRIDES:
     F*    1. VS SYSTEM LIMITS,               EVLACB OR ACO
     F*    2. VS ALL      "     ALL CTYS               "
     F*    3. VS ALL      "     ONE CTY                "
     F*
     F*    -- WITH 'O' = USING TRANS. ORIGINATING BRANCH
     F*            'B' =  "     "     BOOKING BRANCH
     F*    -- FOR 'ONE BR','ONE CO' OPTIONS, FILE OVERRIDE TO THIS
     F*       BR OR CO IS DONE IN COMPONENT CL PGM
     F*       (DLC806OB OR DLC806BB DEPENDING ON ORIG. OR BOOK. BRANCH)
     F*    -- REPORT VS SYSTEM LIMITS IS NOT DEPENDENT ON BOOKING OR      LN0632
     F*       ORIG BRANCH                                                 LN0632
     F*
     F********************************************************************
     FEVLA    IP  E           K        DISK
     FDEALS   IF  E           K        DISK                           UC  CDL002
     F*                                                                   CDL002
     F** Deals                                                            CDL002
     F            DEALSDAF                          KIGNORE               CDL002
     F*********** DEALSDCF                          KIGNORE        CDL002 CDL006
     F            DEALSDDF                          KIGNORE               CDL002
     F            DEALSDEF                          KIGNORE               CDL002
     F            DEALSDFF                          KIGNORE               CDL002
     F            DEALSDGF                          KIGNORE               CDL002
     FFXNEVTL9IF  E           K        DISK                           UC  CDL002
     F*                                                                   CDL002
     F** Net Events Extract by Parent                                     CDL002
     F**DL0782AUO***F     132     OA     PRINTER      KINFDS SPOOLU       E257
     F**DL0782P1O***F     132     OF    LPRINTER      KINFDS SPOOL1       E257
     F**DL0781AUO***F     132     OA     PRINTER      KINFDS SPOOLU  E257 LN0746
     F**DL0781P1O***F     132     OF    LPRINTER      KINFDS SPOOL1  E257 LN0746
     FDL0782AUO   F     132     OA     PRINTER      KINFDS SPOOLU         LN0746
     F***DL0782P1O** F     132     OF    LPRINTER     KINFDS SPOOL1LN0746 067533
     FDL0782P1O   F     132     OF     PRINTER      KINFDS SPOOL1         067533
     F* 01                EVENT
     F* 30                FRA/IRS MODULE PRESENT IND.                     S01157
     F**40****************1ST PAGE OF DL0782P1                       E150 E257
     F**40****************1ST PAGE OF DL0781P1                       E257 LN0746
     F* 40                1ST PAGE OF DL0782P1                            LN0746
     F* 41                NO DETAILS
     F* 42                1ST CYCLE DONE
     F* 43                PO = 1 - SYS LIMITS ONLY
     F* 44                PO = 2 - ALL LIMITS - ALL ENTITIES
     F* 48                CHANGE OF COUNTRY
     F* 50                PO = 3 - ALL LIMITS - ONE ENTITY
     F* 53                FX LIMIT END DATE NON ZERO
     F* 54                LN   "     "        "
     F* 60                ZERO EXPOSURE FOR COUNTRY/ENTITY
     F* 70                EXPOSURE GTR THAN LIMIT(EXCEPTION REPORTS).
     F* 71                1ST PERIOD IS SPOT-SYS LIM-FX
     F* 72                     "        "           -LN
     F* 73                     "        "   -CO LIM -FX
     F* 74                     "        "           -LN
     F* 75                     "        "   -BR LIM -FX
     F* 76                     "        "           -LN
     F* 84            No record on FXNEVTL9                           *   CDL002
     F* 85            No record on DEALS                              *   CDL002
     F* 86 87 88 89       WORK INDS
     F*
     F* L1                BRANCH
     F* L2                COMPANY
     F* L3                COUNTRY
     F*
     F* U1                FOR EXCEPTION REPORTS(SETON IN CALLING CL).
     E********************************************************************
     E                    CPY@    1   1 80
     E                    FCT     1   4  4 0
     E                    HCY        25  3
     E                    HDG     1   6 22
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E********************************************************************
     E**   SYSTEM LEVEL LIMITS
     E**   SIX  ARRAYS FOR FX LIMITS
     E                    XFDA        6  3 0             PERIOD END DAYS
     E                    XFDT        6  5 0             PERIOD END DATES
     E                    XFLM        6  9 0             PERIOD LIMIT AMT.
     E                    XFXP        6 13 0             PERIOD EXPOS AMT.
     E                    XFXS        6 10 0             PERIOD EXCES AMT.
     E                    XFPC        6  3 2             PERIOD PERCENTGE.
     E**   SIX ARRAYS FOR LOANS LIMITS.
     E                    XLDA        6  3 0             PERIOD END DAYS
     E                    XLDT        6  5 0             PERIOD END DATES
     E                    XLLM        6  9 0             PERIOD LIMIT AMT.
     E                    XLXP        6 13 0             PERIOD EXPOS AMT.
     E                    XLXS        6 10 0             PERIOD EXCES AMT.
     E                    XLPC        6  3 2             PERIOD PERCENTGE
     E**   COMPANY LEVEL LIMITS
     E**   SIX  ARRAYS FOR FX LIMITS
     E                    CFDA        6  3 0             PERIOD END DAYS
     E                    CFDT        6  5 0             PERIOD END DATES
     E                    CFLM        6  9 0             PERIOD LIMIT AMT.
     E                    CFXP        6 13 0             PERIOD EXPOS AMT.
     E                    CFXS        6 10 0             PERIOD EXCES AMT.
     E                    CFPC        6  3 2             PERIOD PERCENTGE.
     E**   SIX ARRAYS FOR LOANS LIMITS.
     E                    CLDA        6  3 0             PERIOD END DAYS
     E                    CLDT        6  5 0             PERIOD END DATES
     E                    CLLM        6  9 0             PERIOD LIMIT AMT.
     E                    CLXP        6 13 0             PERIOD EXPOS AMT.
     E                    CLXS        6 10 0             PERIOD EXCES AMT.
     E                    CLPC        6  3 2             PERIOD PERCENTGE
     E**   BRANCH LEVEL LIMITS
     E**   SIX  ARRAYS FOR FX LIMITS
     E                    BFDA        6  3 0             PERIOD END DAYS
     E                    BFDT        6  5 0             PERIOD END DATES
     E                    BFLM        6  9 0             PERIOD LIMIT AMT.
     E                    BFXP        6 13 0             PERIOD EXPOS AMT.
     E                    BFXS        6 10 0             PERIOD EXCES AMT.
     E                    BFPC        6  3 2             PERIOD PERCENTGE.
     E**   SIX ARRAYS FOR LOANS LIMITS.
     E                    BLDA        6  3 0             PERIOD END DAYS
     E                    BLDT        6  5 0             PERIOD END DATES
     E                    BLLM        6  9 0             PERIOD LIMIT AMT.
     E                    BLXP        6 13 0             PERIOD EXPOS AMT.
     E                    BLXS        6 10 0             PERIOD EXCES AMT.
     E                    BLPC        6  3 2             PERIOD PERCENTGE
     E********************************************************************
     E**
     E**   SYSTEM LEVEL LIMITS
     E**   XFDA & XLDA DEFINED AS ALPHANUMERIC.
     E                    XFDAA       6  3
     E                    XLDAA       6  3
     E**
     E**   COMPANY LEVEL LIMITS
     E**   CFDA & CLDA DEFINED AS ALPHANUMERIC.
     E                    CFDAA       6  3
     E                    CLDAA       6  3
     E**
     E**   BRANCH LEVEL LIMITS
     E**   BFDA & BLDA DEFINED AS ALPHANUMERIC.
     E                    BFDAA       6  3
     E                    BLDAA       6  3
     E/COPY ZSRSRC,ZHOLE                                               ***
     I********************************************************************
     L**DL0782P1*66FL*54OL                                                  E257
     L**DL0781P1*66FL*54OL                                           E257 LN0746
     L***DL0782P1 66FL 54OL                                        LN0746 067533
     IEVLAF       01
     I                                              CCTZ  L3
     I                                              CO    L2
     I                                              BR    L1
     I*
     I*
     I********************************************************************
     I**   SYSTEM LEVEL LIMITS
     I**   DATA STRUCTURES TO LINK XFDAA & XLDAA & INPUT FIELDS
     I            DS
     I                                        1  18 XFDAA
     I********************************        1   3 FLEP1S                CDL002
     I********************************        4   60FLEP2S                CDL002
     I********************************        7   90FLEP3S                CDL002
     I********************************       10  120FLEP4S                CDL002
     I********************************       13  150FLEP5S                CDL002
     I********************************       16  180FLEP6S                CDL002
     I                                        1   3 WFEP1S                CDL002
     I                                        4   60WFEP2S                CDL002
     I                                        7   90WFEP3S                CDL002
     I                                       10  120WFEP4S                CDL002
     I                                       13  150WFEP5S                CDL002
     I                                       16  180WFEP6S                CDL002
     I            DS
     I                                        1  18 XLDAA
     I********************************        1   3 LLEP1S                CDL002
     I********************************        4   60LLEP2S                CDL002
     I********************************        7   90LLEP3S                CDL002
     I********************************       10  120LLEP4S                CDL002
     I********************************       13  150LLEP5S                CDL002
     I********************************       16  180LLEP6S                CDL002
     I                                        1   3 WLEP1S                CDL002
     I                                        4   60WLEP2S                CDL002
     I                                        7   90WLEP3S                CDL002
     I                                       10  120WLEP4S                CDL002
     I                                       13  150WLEP5S                CDL002
     I                                       16  180WLEP6S                CDL002
     I            DS
     I                                        1  18 XFPC
     I                                        1  18 XFPCA
     I********************************        1   30FLPC1S                CDL002
     I********************************        4   60FLPC2S                CDL002
     I********************************        7   90FLPC3S                CDL002
     I********************************       10  120FLPC4S                CDL002
     I********************************       13  150FLPC5S                CDL002
     I********************************       16  180FLPC6S                CDL002
     I                                        1   30WFPC1S                CDL002
     I                                        4   60WFPC2S                CDL002
     I                                        7   90WFPC3S                CDL002
     I                                       10  120WFPC4S                CDL002
     I                                       13  150WFPC5S                CDL002
     I                                       16  180WFPC6S                CDL002
     I            DS
     I                                        1  18 XLPC
     I                                        1  18 XLPCA
     I********************************        1   30LLPC1S                CDL002
     I********************************        4   60LLPC2S                CDL002
     I********************************        7   90LLPC3S                CDL002
     I********************************       10  120LLPC4S                CDL002
     I********************************       13  150LLPC5S                CDL002
     I********************************       16  180LLPC6S                CDL002
     I                                        1   30WLPC1S                CDL002
     I                                        4   60WLPC2S                CDL002
     I                                        7   90WLPC3S                CDL002
     I                                       10  120WLPC4S                CDL002
     I                                       13  150WLPC5S                CDL002
     I                                       16  180WLPC6S                CDL002
     I********************************************************************
     I**   COMPANY LEVEL LIMITS
     I**   DATA STRUCTURES TO LINK CFDAA & CLDAA & INPUT FIELDS
     I            DS
     I                                        1  18 CFDAA
     I********************************        1   3 FLEP1C                CDL002
     I********************************        4   60FLEP2C                CDL002
     I********************************        7   90FLEP3C                CDL002
     I********************************       10  120FLEP4C                CDL002
     I********************************       13  150FLEP5C                CDL002
     I********************************       16  180FLEP6C                CDL002
     I                                        1   3 WFEP1C                CDL002
     I                                        4   60WFEP2C                CDL002
     I                                        7   90WFEP3C                CDL002
     I                                       10  120WFEP4C                CDL002
     I                                       13  150WFEP5C                CDL002
     I                                       16  180WFEP6C                CDL002
     I            DS
     I                                        1  18 CLDAA
     I********************************        1   3 LLEP1C                CDL002
     I********************************        4   60LLEP2C                CDL002
     I********************************        7   90LLEP3C                CDL002
     I********************************       10  120LLEP4C                CDL002
     I********************************       13  150LLEP5C                CDL002
     I********************************       16  180LLEP6C                CDL002
     I                                        1   3 WLEP1C                CDL002
     I                                        4   60WLEP2C                CDL002
     I                                        7   90WLEP3C                CDL002
     I                                       10  120WLEP4C                CDL002
     I                                       13  150WLEP5C                CDL002
     I                                       16  180WLEP6C                CDL002
     I            DS
     I                                        1  18 CFPC
     I                                        1  18 CFPCA
     I********************************        1   30FLPC1C                CDL002
     I********************************        4   60FLPC2C                CDL002
     I********************************        7   90FLPC3C                CDL002
     I********************************       10  120FLPC4C                CDL002
     I********************************       13  150FLPC5C                CDL002
     I********************************       16  180FLPC6C                CDL002
     I                                        1   30WFPC1C                CDL002
     I                                        4   60WFPC2C                CDL002
     I                                        7   90WFPC3C                CDL002
     I                                       10  120WFPC4C                CDL002
     I                                       13  150WFPC5C                CDL002
     I                                       16  180WFPC6C                CDL002
     I            DS
     I                                        1  18 CLPC
     I                                        1  18 CLPCA
     I********************************        1   30LLPC1C                CDL002
     I********************************        4   60LLPC2C                CDL002
     I********************************        7   90LLPC3C                CDL002
     I********************************       10  120LLPC4C                CDL002
     I********************************       13  150LLPC5C                CDL002
     I********************************       16  180LLPC6C                CDL002
     I                                        1   30WLPC1C                CDL002
     I                                        4   60WLPC2C                CDL002
     I                                        7   90WLPC3C                CDL002
     I                                       10  120WLPC4C                CDL002
     I                                       13  150WLPC5C                CDL002
     I                                       16  180WLPC6C                CDL002
     I********************************************************************
     I**   BRANCH LEVEL LIMITS
     I**   DATA STRUCTURES TO LINK BFDAA & BLDAA & INPUT FIELDS
     I            DS
     I                                        1  18 BFDAA
     I********************************        1   3 FLEP1B                CDL002
     I********************************        4   60FLEP2B                CDL002
     I********************************        7   90FLEP3B                CDL002
     I********************************       10  120FLEP4B                CDL002
     I********************************       13  150FLEP5B                CDL002
     I********************************       16  180FLEP6B                CDL002
     I                                        1   3 WFEP1B                CDL002
     I                                        4   60WFEP2B                CDL002
     I                                        7   90WFEP3B                CDL002
     I                                       10  120WFEP4B                CDL002
     I                                       13  150WFEP5B                CDL002
     I                                       16  180WFEP6B                CDL002
     I            DS
     I                                        1  18 BLDAA
     I********************************        1   3 LLEP1B                CDL002
     I********************************        4   60LLEP2B                CDL002
     I********************************        7   90LLEP3B                CDL002
     I********************************       10  120LLEP4B                CDL002
     I********************************       13  150LLEP5B                CDL002
     I********************************       16  180LLEP6B                CDL002
     I                                        1   3 WLEP1B                CDL002
     I                                        4   60WLEP2B                CDL002
     I                                        7   90WLEP3B                CDL002
     I                                       10  120WLEP4B                CDL002
     I                                       13  150WLEP5B                CDL002
     I                                       16  180WLEP6B                CDL002
     I            DS
     I                                        1  18 BFPC
     I********************************        1   30FLPC1B                CDL002
     I********************************        4   60FLPC2B                CDL002
     I********************************        7   90FLPC3B                CDL002
     I********************************       10  120FLPC4B                CDL002
     I********************************       13  150FLPC5B                CDL002
     I********************************       16  180FLPC6B                CDL002
     I                                        1   30WFPC1B                CDL002
     I                                        4   60WFPC2B                CDL002
     I                                        7   90WFPC3B                CDL002
     I                                       10  120WFPC4B                CDL002
     I                                       13  150WFPC5B                CDL002
     I                                       16  180WFPC6B                CDL002
     I            DS
     I                                        1  18 BLPC
     I********************************        1   30LLPC1B                CDL002
     I********************************        4   60LLPC2B                CDL002
     I********************************        7   90LLPC3B                CDL002
     I********************************       10  120LLPC4B                CDL002
     I********************************       13  150LLPC5B                CDL002
     I********************************       16  180LLPC6B                CDL002
     I                                        1   30WLPC1B                CDL002
     I                                        4   60WLPC2B                CDL002
     I                                        7   90WLPC3B                CDL002
     I                                       10  120WLPC4B                CDL002
     I                                       13  150WLPC5B                CDL002
     I                                       16  180WLPC6B                CDL002
     I*                                                                   CDL002
     IW3SAVE      DS                           1000                       CDL002
     I* Saved Event field                                                 CDL002
     I                                        1   2 W3CCTZ                CDL002
     I                                        3   5 W3CO                  CDL002
     I                                        6   8 W3BR                  CDL002
     I                                        1   8 W3KEYP                CDL002
     I*                                                                   CDL002
     IW2EVL     E DSEVLACB                                                CDL002
     I* Event fields                                                      CDL002
     I                                        1   2 W2CCTZ                CDL002
     I                                        3   5 W2CO                  CDL002
     I                                        6   8 W2BR                  CDL002
     I                                        1   8 W2KEYP                CDL002
     I*                                                                   CDL002
     IW1KEY       DS                                                      CDL002
     I                                        1   2 W1CCTZ                CDL002
     I                                        3   5 W1CO                  CDL002
     I                                        6   8 W1BR                  CDL002
     I                                        1   8 W1KEYP                CDL002
     I*                                                                   CDL002
     IW4SAVE      DS                           1000                       CDL002
     I                                        1   2 W4CCTZ                CDL002
     I                                        3   5 W4CO                  CDL002
     I                                        6   8 W4BR                  CDL002
     I                                        1   8 W4KEYP                CDL002
     I* Saved Event field                                                 CDL002
     I********************************************************************
     I/COPY ZSRSRC,ZHOLI                                               ***
     I*
     ISDBANK    E DSSDBANKPD
     I** EXTERNAL DS FOR BANK DETAILS
     I*
     ISDDEAL    E DSSDDEALPD
     I** EXTERNAL DS FOR DEALING DETAILS
     I*
     ISDCURR    E DSSDCURRPD
     I** EXTERNAL DS FOR CURRENCY DETAILS
     I*
     ISDMMOD    E DSSDMMODPD                                              S01157
     I** EXTERNAL DS FOR MODULE DETAILS                                   S01157
     I*                                                                   S01157
     ISCSARD    E DSSCSARDPD                                              CDL002
     I** EXTERNAL DS FOR SWITCHABLE FEATURES DETAILS                      CDL002
     I*                                                                   CDL002
     ISDLIMT    E DSSDLIMTPD                                              CDL002
     I** Dummy record format for Limit Types                              CDL002
     I*                                                                   CDL002
     ISDCNLM    E DSSDCNLMPD                                              CDL002
     I** Dummy record format for Country Limits                           CDL002
     I*                                                                   CDL002
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I**
     ISPOOL1      DS
     I**   FILE INFORMATION DATA STRUCTURE
     I                                       83  92 SFILE1
     I                                    B 123 1240SFNUM1
     I                                    B 243 2460SWRIT                 E00013
     I**
     I@BINRY      DS                                                      E00013
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   E00013
     I                                    B   1   40@BKBIN                E00013
     I**
     ISPOOLU      DS
     I**   FILE INFORMATION DATA STRUCTURE
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
     I/EJECT
     C********************************************************************
     C**
     C**  PARAMETERS - SEQUENCE NUMBER - 5 ALPHA
     C**               PRODUCTION OPTION - ALPHA
     C**               COUNTRY FOR P.O. 2 - ALPHA
     C**               ORIGINATING OR BOOKING BRANCH
     C           *ENTRY    PLIST
     C                     PARM           @RSEQ   5
     C                     PARM           @PROD   1
     C                     PARM           CCTZA   2
     C                     PARM           @OB     1
     C**
     C********************************************************************
     C**   ON FIRST CYCLE - GET ICDR1 & 2
     C           *IN42     IFNE '1'
     C                     EXSR FIRST
     C   U8                GOTO LRTAG
     C                     SETON                     40                   E150
     C                     ELSE                                           E150
     C                     SETOF                     40                   E150
     C                     END
     C**
     C********************************************************************
     C**  DETAIL CYCLE
      *                                                                   CDL006
      ** If CDL006 is installed, chain deal no to LF/DEALS                CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
      *                                                                   CDL006
     C           DLNO      CHAINDEALSDCF             55                   CDL006
      *                                                                   CDL006
     C           *IN55     IFEQ *OFF                                      CDL006
     C           DTYP      IFEQ 'FL'                                      CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C                     GOTO ENDDET                                    CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C*                                                                   CDL002
     C                     MOVE FLEP1S    WFEP1S                          CDL002
     C                     MOVE FLEP2S    WFEP2S                          CDL002
     C                     MOVE FLEP3S    WFEP3S                          CDL002
     C                     MOVE FLEP4S    WFEP4S                          CDL002
     C                     MOVE FLEP5S    WFEP5S                          CDL002
     C                     MOVE FLEP6S    WFEP6S                          CDL002
     C                     MOVE LLEP1S    WLEP1S                          CDL002
     C                     MOVE LLEP2S    WLEP2S                          CDL002
     C                     MOVE LLEP3S    WLEP3S                          CDL002
     C                     MOVE LLEP4S    WLEP4S                          CDL002
     C                     MOVE LLEP5S    WLEP5S                          CDL002
     C                     MOVE LLEP6S    WLEP6S                          CDL002
     C                     MOVE FLPC1S    WFPC1S                          CDL002
     C                     MOVE FLPC2S    WFPC2S                          CDL002
     C                     MOVE FLPC3S    WFPC3S                          CDL002
     C                     MOVE FLPC4S    WFPC4S                          CDL002
     C                     MOVE FLPC5S    WFPC5S                          CDL002
     C                     MOVE FLPC6S    WFPC6S                          CDL002
     C                     MOVE LLPC1S    WLPC1S                          CDL002
     C                     MOVE LLPC2S    WLPC2S                          CDL002
     C                     MOVE LLPC3S    WLPC3S                          CDL002
     C                     MOVE LLPC4S    WLPC4S                          CDL002
     C                     MOVE LLPC5S    WLPC5S                          CDL002
     C                     MOVE LLPC6S    WLPC6S                          CDL002
     C                     MOVE FLEP1C    WFEP1C                          CDL002
     C                     MOVE FLEP2C    WFEP2C                          CDL002
     C                     MOVE FLEP3C    WFEP3C                          CDL002
     C                     MOVE FLEP4C    WFEP4C                          CDL002
     C                     MOVE FLEP5C    WFEP5C                          CDL002
     C                     MOVE FLEP6C    WFEP6C                          CDL002
     C                     MOVE LLEP1C    WLEP1C                          CDL002
     C                     MOVE LLEP2C    WLEP2C                          CDL002
     C                     MOVE LLEP3C    WLEP3C                          CDL002
     C                     MOVE LLEP4C    WLEP4C                          CDL002
     C                     MOVE LLEP5C    WLEP5C                          CDL002
     C                     MOVE LLEP6C    WLEP6C                          CDL002
     C                     MOVE FLPC1C    WFPC1C                          CDL002
     C                     MOVE FLPC2C    WFPC2C                          CDL002
     C                     MOVE FLPC3C    WFPC3C                          CDL002
     C                     MOVE FLPC4C    WFPC4C                          CDL002
     C                     MOVE FLPC5C    WFPC5C                          CDL002
     C                     MOVE FLPC6C    WFPC6C                          CDL002
     C                     MOVE LLPC1C    WLPC1C                          CDL002
     C                     MOVE LLPC2C    WLPC2C                          CDL002
     C                     MOVE LLPC3C    WLPC3C                          CDL002
     C                     MOVE LLPC4C    WLPC4C                          CDL002
     C                     MOVE LLPC5C    WLPC5C                          CDL002
     C                     MOVE LLPC6C    WLPC6C                          CDL002
     C                     MOVE FLEP1B    WFEP1B                          CDL002
     C                     MOVE FLEP2B    WFEP2B                          CDL002
     C                     MOVE FLEP3B    WFEP3B                          CDL002
     C                     MOVE FLEP4B    WFEP4B                          CDL002
     C                     MOVE FLEP5B    WFEP5B                          CDL002
     C                     MOVE FLEP6B    WFEP6B                          CDL002
     C                     MOVE LLEP1B    WLEP1B                          CDL002
     C                     MOVE LLEP2B    WLEP2B                          CDL002
     C                     MOVE LLEP3B    WLEP3B                          CDL002
     C                     MOVE LLEP4B    WLEP4B                          CDL002
     C                     MOVE LLEP5B    WLEP5B                          CDL002
     C                     MOVE LLEP6B    WLEP6B                          CDL002
     C                     MOVE FLPC1B    WFPC1B                          CDL002
     C                     MOVE FLPC2B    WFPC2B                          CDL002
     C                     MOVE FLPC3B    WFPC3B                          CDL002
     C                     MOVE FLPC4B    WFPC4B                          CDL002
     C                     MOVE FLPC5B    WFPC5B                          CDL002
     C                     MOVE FLPC6B    WFPC6B                          CDL002
     C                     MOVE LLPC1B    WLPC1B                          CDL002
     C                     MOVE LLPC2B    WLPC2B                          CDL002
     C                     MOVE LLPC3B    WLPC3B                          CDL002
     C                     MOVE LLPC4B    WLPC4B                          CDL002
     C                     MOVE LLPC5B    WLPC5B                          CDL002
     C                     MOVE LLPC6B    WLPC6B                          CDL002
     C*                                                                   CDL002
     C** Process any net group settlement customers before next           CDL002
     C** customer with events                                             CDL002
     C*                                                                   CDL002
     C* Customer Changed                                                  CDL002
     C           *INL3     IFEQ *ON                                       CDL002
     C           W#NTCE    ANDEQ'Y'                                       CDL002
     C*                                                                   CDL002
     C                     EXSR NEVT1                                     CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C**  IF NEW COUNTRY, GET SYSTEM LIMIT ,O/P CTY HEADING
     C           *INL3     IFEQ '1'
     C                     SETOF                     48
     C                     EXSR LMTS
     C                     MOVE 'N'       NAMPRT  1
     C**
     C**  IS THIS CTY THE ENTITY REQD, FOR OPTION  3
     C           *IN50     IFEQ '1'
     C           CCTZ      IFEQ CCTZA
     C                     MOVE 'Y'       GOT1    1
     C                     END
     C           CCTZ      COMP CCTZA                4848
     C**                                                                  LN0632
     C**  IF REQUIRED COUNTRY HAS BEEN PROCESSED AND THERE IS A CHANGE    LN0632
     C**  OF COUNTRY, DO NOT DO ANY MORE FILE PROCESSING                  LN0632
     C           GOT1      IFEQ 'Y'
     C           *IN48     ANDEQ'1'
     C                     SETON                     LR
     C                     GOTO ENDDET
     C                     END
     C                     END
     C                     END
     C**                                                                  LN0632
     C**  IF THIS COUNTRY IS NOT THE REQUIRED COUNTRY, DO NOT             LN0632
     C**  CALCULATE EXPOSURE                                              LN0632
     C           *IN48     IFEQ '1'                                       LN0632
     C                     GOTO ENDDET                                    LN0632
     C                     END                                            LN0632
     C**
     C**  IF NEW COMPANY & PO NE 1, GET COMPANY LIMIT
     C   L2N43             EXSR LMTC
     C**
     C**  IF NEW BRANCH & PO NE 1, GET BRANCH LIMIT
     C   L1N43             EXSR LMTB
     C*                                                                   CDL002
     C** Net FX Customer Exposure?                                        CDL002
     C           EXEI      IFEQ 'F'                                       CDL002
     C           W#NTCE    ANDEQ'Y'                                       CDL002
     C*                                                                   CDL002
     C           DLNO      CHAINDEALSDBF             85                   CDL002
     C           *IN85     IFEQ *ON                                       CDL002
     C                     MOVEL'DEALS   'DBFILE           ************   CDL002
     C                     MOVEL'11'      DBASE            * DBERR 11 *   CDL002
     C                     MOVELDLNO      DBKEY            ************   CDL002
     C                     SETON                     U7U8LR               CDL002
     C                     EXSR *PSSR                                     CDL002
     C                     GOTO ENDDET                                    CDL002
     C                     ELSE                                           CDL002
     C*                                                                   CDL002
     C**  Exclude netted FX deal events                                   CDL002
     C           NETBR     IFNE *BLANKS                                   CDL002
     C                     MOVE 'N'       EXEI                            CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
     C**
     C********************************************************************
     C** CALC EXPOSURE AGAINST BR,CO & SYS LIMITS
     C** -FX
     C           EXEI      IFEQ 'F'
     C                     Z-ADDEDAT      DLVALU
     C           A6NBDP    ADD  1         DEP
     C           LCEQ      DIV  FCT,DEP   DLAMTF    H
     C  N43                EXSR EXPFB
     C  N43                EXSR EXPFC
     C                     EXSR EXPFS
     C                     ADD  1         RREAD   50
     C                     END
     C**
     C**  -LENDING
     C           EXEI      IFEQ 'L'
     C           EDAT      IFLT BJRDNB
     C           EDAT      ADD  BJRDNB    DLMATD
     C                     ELSE
     C                     Z-ADDEDAT      DLMATD
     C                     END
     C**
     C           A6NBDP    ADD  1         DEP     10
     C           LCEQ      DIV  FCT,DEP   DLAMTL    H
     C  N43                EXSR EXPLB
     C  N43                EXSR EXPLC
     C                     EXSR EXPLS
     C                     ADD  1         RREAD
     C                     END
      *                                                                   S01157
      ** -FRA EVENT                                                       S01157
      *                                                                   S01157
     C           EXEI      IFEQ 'R'                                       S01157
     C           A6NBDP    ADD  1         DEP                             S01157
      *                                                                   S01157
     C           LCEQ      DIV  FCT,DEP   DLAMTR 130H                     S01157
     C  N43      RBPOS     ADD  DLAMTR    RBPOS  100                      S01157
     C  N43      RCPOS     ADD  DLAMTR    RCPOS  100                      S01157
     C           RXPOS     ADD  DLAMTR    RXPOS  100                      S01157
      *                                                                   S01157
     C                     ADD  1         RREAD                           S01157
      *                                                                   S01157
     C                     END                                            S01157
      *                                                                   S01157
      ** -IRS EVENT                                                       S01157
      *                                                                   S01157
     C           EXEI      IFEQ 'I'                                       S01157
     C           A6NBDP    ADD  1         DEP                             S01157
      *                                                                   S01157
     C           LCEQ      DIV  FCT,DEP   DLAMTI 130H                     S01157
     C  N43      IBPOS     ADD  DLAMTI    IBPOS  100                      S01157
     C  N43      ICPOS     ADD  DLAMTI    ICPOS  100                      S01157
     C           IXPOS     ADD  DLAMTI    IXPOS  100                      S01157
      *                                                                   S01157
     C                     ADD  1         RREAD                           S01157
      *                                                                   S01157
     C                     END                                            S01157
      *                                                                   S01157
     C**
     C           ENDDET    TAG                             ** ENDDET **
     C**
     C********************************************************************
     C*                                                                   CDL002
     C** Include FX Net Events                                            CDL002
     CL1         *IN48     IFEQ *OFF                                      CDL002
     CL1         *IN42     ANDEQ*ON                                       CDL002
     CL1         W#NTCE    ANDEQ'Y'                                       CDL002
     CL1                   EXSR NEVTD                                     CDL002
     CL1                   ENDIF                                          CDL002
     C*                                                                   CDL002
     C** ONLY DO FOLLOWING SUBROUTINES IF AT LEAST ONE RECORD IE. FIRST
     C** CYCLE HAS BEEN PROCESSED
      *                                                                   S01157
      *   Execute FRA/IRS subroutines only if FRA/IRS module present.     S01157
      *                                                                   S01157
     CL1N43N48 42          EXSR FXBWRT
     CL1N43N48 42          EXSR LNBWRT
     C*                                                                   S01157
     CL1N43N48 42                                                         S01157
     CAN 30                EXSR FRBWRT                                    S01157
     CL1N43N48 42                                                         S01157
     CAN 30                EXSR IRBWRT                                    S01157
      *
     CL2N43N48 42          EXSR FXCWRT
     CL2N43N48 42          EXSR LNCWRT
      *                                                                   S01157
     CL2N43N48 42                                                         S01157
     CAN 30                EXSR FRCWRT                                    S01157
     CL2N43N48 42                                                         S01157
     CAN 30                EXSR IRCWRT                                    S01157
      *
     CL3N48    42          EXSR FXSWRT
     CL3N48    42          EXSR LNSWRT
      *                                                                   S01157
     CL3N48 30 42          EXSR FRSWRT                                    S01157
     CL3N48 30 42          EXSR IRSWRT                                    S01157
      *                                                                   S01157
      *
     CLR         LRTAG     TAG                             ** LRTAG **
     C*                                                                   CDL002
     C* Process any Net Group Settlement Customers after last customer    CDL002
     C* with events                                                       CDL002
     CLR         W#NTCE    IFEQ 'Y'                                       CDL002
     CLR                   EXSR NEVTLR                                    CDL002
     CLR                   ENDIF                                          CDL002
     C*                                                                   CDL002
     CLR         RLIST     COMP 0                        41
     C*
     C** IF NO DETAILS THEN CALL #ZZ FOR HEADING/DATE ETC. FOR AU
     CLR         *IN41     IFEQ '1'
     CLR                   EXSR #ZZ
     CLR                   END
     C*
     CLR                   SETON                     OF
     CLR                   FREE 'DL0132'
     C**
     C** CALL ZSFILE FOR AU FILE - ONCE ONLY
     CLR                   Z-ADDSFNUMU    ZSNUM   60
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           @RSEQ   5
     CLR                   PARM *BLANKS   @PARM   3
     CLR                   PARM           SFILEU
     CLR                   PARM           ZSNUM
     CLR                   PARM           ZSERR   1
     C*
     CLR         ZSERR     IFEQ 'Y'
     C** Error during ZSFILE processing, return to calling program
     C***************      SETON                     U7U8LR               E00013
     CLR                   SETON                     U7U8                 E00013
     CLR                   RETRN
     CLR                   END
     C**
     C** CALL ZSFILE FOR P1 FILE - ONCE ONLY - ONLY IF DETAILS OUTPUT
     CLR         *IN41     IFEQ '0'
     CLR                   MOVE '0'       *IN25                           E00013
     CLR         SWRIT     IFNE 0                                         E00013
     CLR         SWRIT     ANDNE@BKBIN                                    E00013
     CLR                   MOVE '1'       *IN25                           E00013
     CLR                   Z-ADDSFNUM1    ZSNUM   60
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           @RSEQ   5
     CLR                   PARM *BLANKS   @PARM   3
     CLR                   PARM           SFILE1
     CLR                   PARM           ZSNUM
     CLR                   PARM           ZSERR   1
     CLR                   END                                            E00013
     C*
     CLR         ZSERR     IFEQ 'Y'
     C** Error during ZSFILE processing, return to calling program
     C****************     SETON                     U7U8LR               E00013
     CLR                   SETON                     U7U8                 E00013
     CLR                   RETRN
     CLR                   END
     C**
     CLR                   END
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**    LIST OF SR'S CALLED, FREQUENCY & SEQUENCE
     C**
     C**        SR             FREQ                   SEQ
     C**        --             ----                   ---
     C**        LMTS           X CTY                   4
     C**        LMTC           X CTY ,CO               3
     C**        LMTB           X CTY ,BR               2
     C**
     C**        EXPFS,FC,FB    X FX EVENTS             1
     C**        EXPLS,LC,LB    X LN EVENTS             1
     C**
     C**        FXSWRT         X CTY                   4
     C**        LNSWRT         X CTY                   4
     C**        FRSWRT         X CTY                   4                  S01157
     C**        IRSWRT         X CTY                   4                  S01157
     C**        FXCWRT         X CTY ,CO               3
     C**        LNCWRT         X CTY ,CO               3
     C**        FRCWRT         X CTY ,CO               3                  S01157
     C**        IRCWRT         X CTY ,CO               3                  S01157
     C**        FXBWRT         X CTY ,BR               2
     C**        LNCWRT         X CTY ,BR               2
     C**        FRBWRT         X CTY ,BR               2                  S01157
     C**        IRBWRT         X CTY ,BR               2                  S01157
     C**
     C**   EXCESS EXPOSURE SUBROUTINES
     C**        EXSFS,LS       = FXSWRT,LNSWRT         4
     C**        EXSRS,IS       = FRSWRT,IRSWRT         4                  S01157
     C**
     C**        EXSFC,LC       = FXCWRT,LNCWRT         3
     C**        EXSRC,IC       = FRCWRT,IRCWRT         3                  S01157
     C**
     C**        EXSFB,LB       = FXBWRT,LNBWRT         2
     C**        EXSRB,IB       = FRBWRT,IRBWRT         2                  S01157
     C**
     C**        DL0132         X CTY  + X CTY ,CO      5
     C**        ZACCH          1                       7
     C**        ZFWDT          1                       7
     C**        FIRST          1                       7
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   EXPOSURE SUBROUTINES, AGAINST:
     C**     SYS LIMIT -FX - EXPFS    CO LIMIT -FX - EXPFC
     C**               -LN - EXPLS             -LN - EXPLC
     C**     BR LIMIT  -FX - EXPFB
     C**               -LN - EXPLB
     C**
     C********************************************************************
     C*    SYSTEM LEVEL LIMITS
     C**   EXPFS  SR. CALCULATES EXPOSURE FOR A FX DEAL.
     C**
     C           EXPFS     BEGSR                           **  EXPFS   **
     C**
     C**   DEFINE INPUT FIELDS
     C                     Z-ADDDLVALU    DLVALU  50       VALUE DATE
     C                     Z-ADDDLAMTF    DLAMTF 130       LIMIT CCY EQUIV
     C**                                                       AMOUNT
     C* IF VALUE DATE IS LESS OR EQUAL TO RUN DATE - FIRST PERIOD ONLY
     C           DLVALU    COMP BJRDNB                 8989
     C   89      XFXP,1    ADD  DLAMTF    XFXP,1
     C   89                GOTO EXPFS9
     C**
     C**   VALUE DATE IS GREATER THAN TODAY - AMOUNT IS ADDED INTO EVERY
     C**   PERIOD PRECEDING & INCLUDING THE PERIOD WHICH INCLUDES THE
     C**   VALUE DATE.
     C                     Z-ADD0         D       20
     C**
     C           EXPFS1    TAG                             **  EXPFS1  **
     C           D         ADD  1         D
     C**
     C**   ADD AMOUNT INTO THIS PERIOD
     C           XFXP,D    ADD  DLAMTF    XFXP,D
     C**
     C**   LOOP AGAIN TO ADD AMOUNT INTO NEXT PERIOD IF
     C**   - VALUE DATE EXCEEDS THIS END OF PERIOD DATE.
     C**   - LESS THAN SIX PERIODS HAVE BEEN USED.
     C           DLVALU    COMP XFDT,D               88
     C           D         COMP 6                      87
     C   87 88             GOTO EXPFS1
     C**
     C           EXPFS9    ENDSR                           **  EXPFS9  **
     C**
     C********************************************************************
     C**   SYSTEM LEVEL  LIMITS
     C**   EXPLS  SR. CALCULATES EXPOSURE FOR A LOAN DEAL.
     C**
     C           EXPLS     BEGSR                           **  EXPLS   **
     C**
     C**   DEFINE INPUT FIELDS
     C                     Z-ADDDLMATD    DLMATD  50
     C                     Z-ADDDLAMTL    DLAMTL 130
     C**
     C**   LOOP TO ADD AMOUNT INTO EVERY PERIOD PRECEDING & INCLUDING
     C**   THE PERIOD WHICH INCLUDES THE MATURITY DATE.
     C                     Z-ADD0         D       20
     C           EXPLS1    TAG                             **  EXPLS1  **
     C           D         ADD  1         D
     C**
     C**   ADD AMOUNT INTO THIS PERIOD
     C           XLXP,D    ADD  DLAMTL    XLXP,D
     C**
     C**   LOOP AGAIN TO ADD AMOUNT INTO NEXT PERIOD IF
     C**   - MATURITY DATE EXCEEDS THIS END OF PERIOD DATE.
     C**   - LESS THAN SIX PERIODS HAVE BEEN USED
     C           DLMATD    COMP XLDT,D               88
     C           D         COMP 6                      87
     C   87 88             GOTO EXPLS1
     C**
     C                     ENDSR
     C********************************************************************
     C*    COMPANY LEVEL LIMITS
     C**   EXPFC  SR. CALCULATES EXPOSURE FOR A FX DEAL.
     C**
     C           EXPFC     BEGSR                           **  EXPFC   **
     C**
     C* IF VALUE DATE IS LESS OR EQUAL TO RUN DATE - FIRST PERIOD ONLY
     C           DLVALU    COMP BJRDNB                 8989
     C   89      CFXP,1    ADD  DLAMTF    CFXP,1
     C   89                GOTO EXPFC9
     C**
     C**   VALUE DATE IS GREATER THAN TODAY - AMOUNT IS ADDED INTO EVERY
     C**   PERIOD PRECEDING & INCLUDING THE PERIOD WHICH INCLUDES THE
     C**   VALUE DATE.
     C                     Z-ADD0         D       20
     C**
     C           EXPFC1    TAG                             **  EXPFC1  **
     C           D         ADD  1         D
     C**
     C**   ADD AMOUNT INTO THIS PERIOD
     C           CFXP,D    ADD  DLAMTF    CFXP,D
     C**
     C**   LOOP AGAIN TO ADD AMOUNT INTO NEXT PERIOD IF
     C**   - VALUE DATE EXCEEDS THIS END OF PERIOD DATE.
     C**   - LESS THAN SIX PERIODS HAVE BEEN USED.
     C           DLVALU    COMP CFDT,D               88
     C           D         COMP 6                      87
     C   87 88             GOTO EXPFC1
     C**
     C           EXPFC9    ENDSR                           **  EXPFC9  **
     C**
     C********************************************************************
     C**   COMPANY LEVEL  LIMITS
     C**   EXPLC  SR. CALCULATES EXPOSURE FOR A LOAN DEAL.
     C**
     C           EXPLC     BEGSR                           **  EXPLC   **
     C**
     C**
     C**   LOOP TO ADD AMOUNT INTO EVERY PERIOD PRECEDING & INCLUDING
     C**   THE PERIOD WHICH INCLUDES THE MATURITY DATE.
     C                     Z-ADD0         D       20
     C           EXPLC1    TAG                             **  EXPLC1  **
     C           D         ADD  1         D
     C**
     C**   ADD AMOUNT INTO THIS PERIOD
     C           CLXP,D    ADD  DLAMTL    CLXP,D
     C**
     C**   LOOP AGAIN TO ADD AMOUNT INTO NEXT PERIOD IF
     C**   - MATURITY DATE EXCEEDS THIS END OF PERIOD DATE.
     C**   - LESS THAN SIX PERIODS HAVE BEEN USED
     C           DLMATD    COMP CLDT,D               88
     C           D         COMP 6                      87
     C   87 88             GOTO EXPLC1
     C**
     C                     ENDSR
     C********************************************************************
     C*    BRANCH LEVEL LIMITS
     C**   EXPFB  SR. CALCULATES EXPOSURE FOR A FX DEAL.
     C**
     C           EXPFB     BEGSR                           **  EXPFB   **
     C**
     C* IF VALUE DATE IS LESS OR EQUAL TO RUN DATE - FIRST PERIOD ONLY
     C           DLVALU    COMP BJRDNB                 8989
     C   89      BFXP,1    ADD  DLAMTF    BFXP,1
     C   89                GOTO EXPFB9
     C**
     C**   VALUE DATE IS GREATER THAN TODAY - AMOUNT IS ADDED INTO EVERY
     C**   PERIOD PRECEDING & INCLUDING THE PERIOD WHICH INCLUDES THE
     C**   VALUE DATE.
     C                     Z-ADD0         D       20
     C**
     C           EXPFB1    TAG                             **  EXPFB1  **
     C           D         ADD  1         D
     C**
     C**   ADD AMOUNT INTO THIS PERIOD
     C           BFXP,D    ADD  DLAMTF    BFXP,D
     C**
     C**   LOOP AGAIN TO ADD AMOUNT INTO NEXT PERIOD IF
     C**   - VALUE DATE EXCEEDS THIS END OF PERIOD DATE.
     C**   - LESS THAN SIX PERIODS HAVE BEEN USED.
     C           DLVALU    COMP BFDT,D               88
     C           D         COMP 6                      87
     C   87 88             GOTO EXPFB1
     C**
     C           EXPFB9    ENDSR                           **  EXPFB9  **
     C**
     C********************************************************************
     C**   BRANCH LEVEL  LIMITS
     C**   EXPLB  SR. CALCULATES EXPOSURE FOR A LOAN DEAL.
     C**
     C           EXPLB     BEGSR                           **  EXPLB   **
     C**
     C**
     C**   LOOP TO ADD AMOUNT INTO EVERY PERIOD PRECEDING & INCLUDING
     C**   THE PERIOD WHICH INCLUDES THE MATURITY DATE.
     C                     Z-ADD0         D       20
     C           EXPLB1    TAG                             **  EXPLB1  **
     C           D         ADD  1         D
     C**
     C**   ADD AMOUNT INTO THIS PERIOD
     C           BLXP,D    ADD  DLAMTL    BLXP,D
     C**
     C**   LOOP AGAIN TO ADD AMOUNT INTO NEXT PERIOD IF
     C**   - MATURITY DATE EXCEEDS THIS END OF PERIOD DATE.
     C**   - LESS THAN SIX PERIODS HAVE BEEN USED
     C           DLMATD    COMP BLDT,D               88
     C           D         COMP 6                      87
     C   87 88             GOTO EXPLB1
     C**
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**   BRANCH LEVEL SR'S -
     C**      LMTB
     C********FXBWRT,LNBWRT                                               S01157
     C********EXSFB, EXSLB                                                S01157
     C**      FXBWRT,LNBWRT,FRBWRT,IRBWRT                                 S01157
     C**      EXSFB, EXSLB, EXSRB, EXSIB                                  S01157
     C********************************************************************
     C*   BRANCH LEVEL LIMITS
     C*     LMTB SR. SETS UP ARRAYS OF LIMIT PERIODS & AMOUNTS,
     C*    FOR FX LIMITS AND LENDING LIMITS.
     C           LMTB      BEGSR                           **  LMTB *  *
     C                     MOVE *BLANK    FDESCB  7
     C                     MOVE *BLANK    LDESCB  7
     C                     MOVE *BLANKS   RDESCB  7                       S01157
     C                     MOVE *BLANKS   IDESCB  7                       S01157
     C**
     C**   FIRST RESET ARRAYS TO ZEROES
     C                     Z-ADD0         BFDA
     C                     Z-ADD0         BFDT
     C                     Z-ADD0         BFLM
     C                     Z-ADD0         BFXP
     C                     Z-ADD0         BFXS
     C                     Z-ADD0         BLDA
     C                     Z-ADD0         BLDT
     C                     Z-ADD0         BLLM
     C                     Z-ADD0         BLXP
     C                     Z-ADD0         BLXS
     C*
     C                     SETOF                     7576
     C**
     C**
     C**   PROCESS FX LIMITS FIRST
     C** CASE 1 - LIVE, NON ZERO
     C** IF FX LIMIT TYPE NON ZERO & EXPIRY DATE GT RUN DATE (BJAKTX)
     C           FLTYB     IFNE *BLANKS
     C           FLEDB     IFGT BJRDNB
     C           FLEDB     OREQ 0
     C**
     C**   LMTB1   PROCESSES XFDAA - IF ANY ELEMENT IS BLANK OR 999
     C**   THE CORRESPONDING ELEMENTS IN XFDA & XFDT ARE SET TO NINES.
     C**   ELSE,XFDT IS CALCULATED BY ADDING RUN DATE (BJAKTX) TO XFDA,
     C**        XFLM,IS CALCULATED BY MULTIPLYING LIMIT AMOUNT BY XFPC
     C**
     C                     Z-ADD0         D       20
     C           BFDAA,1   COMP 'SP '                    75
     C           LMTB1     TAG                             ** LMTB1   **
     C**
     C           D         ADD  1         D
     C********** BFDAA,D   COMP '   '                    88               E309
     C           BFDAA,D   COMP '000'                    88               E309
     C           BFDAA,D   COMP '999'                    87
     C**
     C   88                Z-ADD999       BFDA,D
     C  N88                MOVE BFDAA,D   BFDA,D
     C*
     C**
     C           BFDA,D    ADD  BJRDNB    BFDT,D
     C   88
     COR 87                Z-ADD99999     BFDT,D
     C**
     C  N88      FLAMB     MULT BFPC,D    BFLM,D
     C**
     C           D         COMP 6                      86
     C   86N87N88          GOTO LMTB1
     C   75                Z-ADDSP        BFDA,1
     C   75      SP        ADD  BJRDNB    BFDT,1
     C**  GET EXPIRY DATE
     C                     MOVE FLEDB     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    FDESCB
     C                     END
     C                     END
     C**
     C**   CASE 2-EXPIRED
     C**   - IF EXPIRED, SET FIRST PERIOD END DAYS & DATE TO NINES
     C**     & ZEROIZE AMOUNT
     C           FLEDB     IFLE BJRDNB
     C           FLEDB     ANDNE0
     C                     MOVE 'EXPIRED' FDESCB  7
     C                     Z-ADD999       BFDA,1
     C                     Z-ADD99999     BFDT,1
     C                     Z-ADD0         BFLM,1
     C                     END
     C**   CASE 3 - NO LIMIT
     C**   - IF FX LIMIT TYPE 0, NO DEFAULT FOR BRANCH
     C           FLTYB     IFEQ *BLANKS
     C                     MOVE 'NO LIM.' FDESCB
     C                     Z-ADD999       BFDA,1
     C                     Z-ADD99999     BFDT,1
     C                     Z-ADD0         BFLM,1
     C                     END
     C**
     C**   PROCESS LENDING LIMITS.
     C**
     C**   CASE 1 - LIVE, NON ZERO
     C**   IF LN LIMIT TYPE NON ZERO & EXPIRY DATE GT RUN DATE (BJAKTX)
     C           LLTYB     IFNE *BLANKS
     C           LLEDB     IFGT BJRDNB
     C           LLEDB     OREQ 0
     C**
     C**   LMTB2   PROCESSES BLDAA IN THE SAME WAY AS LMTB1
     C           BLDAA,1   COMP 'SP '                    76
     C                     Z-ADD0         D
     C           LMTB2     TAG                             **  LMTB2   **
     C**
     C           D         ADD  1         D
     C********** BLDAA,D   COMP '   '                    88               E309
     C           BLDAA,D   COMP '000'                    88               E309
     C           BLDAA,D   COMP '999'                    87
     C**
     C   88                Z-ADD999       BLDA,D
     C  N88                MOVE BLDAA,D   BLDA,D
     C*
     C**
     C           BLDA,D    ADD  BJRDNB    BLDT,D
     C   88
     COR 87                Z-ADD99999     BLDT,D
     C**
     C  N88      LLAMB     MULT BLPC,D    BLLM,D
     C**
     C           D         COMP 6                      86
     C   86N87N88          GOTO LMTB2
     C   76                Z-ADDSP        BLDA,1
     C   76      SP        ADD  BJRDNB    BLDT,1
     C**  GET EXPIRY DATE
     C                     MOVE LLEDB     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    LDESCB
     C                     END
     C                     END
     C**
     C**   CASE 2 - EXPIRED
     C**   - IF EXPIRED, SET FIRST PERIOD END DAYS & DATE TO NINES
     C**     & ZEROISE AMOUNT
     C           LLEDB     IFLE BJRDNB
     C           LLEDB     ANDNE0
     C                     MOVE 'EXPIRED' LDESCB  7
     C                     Z-ADD999       BLDA,1
     C                     Z-ADD99999     BLDT,1
     C                     Z-ADD0         BLLM,1
     C                     END                                         **
     C**
     C**   CASE 3 - NO  LIMIT
     C**   - IF LIMIT TYPE 0, NO DEFAULT FOR BRANCH
     C           LLTYB     IFEQ *BLANKS
     C                     MOVE 'NO LIM.' LDESCB
     C                     Z-ADD999       BLDA,1
     C                     Z-ADD99999     BLDT,1
     C                     Z-ADD0         BLLM,1
     C                     END
     C**
      *                                                                   S01157
      *   PROCESS FRA LIMITS ===> CASE 1 - Live, Non Zero                 S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expiry Date GT Rundate...                                     S01157
      *                                                                   S01157
     C           RLEDB     IFGT BJRDNB                                    S01157
     C           RLEDB     OREQ 0                                         S01157
      *                                                                   S01157
      *   Get Expiry Date                                                 S01157
      *                                                                   S01157
     C                     Z-ADDRLAMB     BRLM    90                      S01157
     C                     MOVE RLEDB     ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    RDESCB                          S01157
      *                                                                   S01157
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS FRA LIMITS ===> CASE 2 - Expired                        S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expired, Set Description field.                               S01157
      *                                                                   S01157
     C           RLEDB     IFLE BJRDNB                                    S01157
     C           RLEDB     ANDNE0                                         S01157
     C                     MOVE 'EXPIRED' RDESCB  7                       S01157
     C                     Z-ADD0         BRLM                            LN0632
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS FRA LIMITS ===> CASE 3 - No Limit                       S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If limit amount blank...                                         S01157
      *                                                                   S01157
     C           RLAMB     IFEQ 0                                         S01157
      *                                                                   S01157
     C*********************MOVE 'Y'       RDEF                     S01157 LN0632
     C*********************MOVE 'DEFAULT' RDESCB                   S01157 LN0632
     C                     MOVE 'NO LIM.' RDESCB                          LN0632
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS IRS LIMITS ===> CASE 1 - Live, Non Zero                 S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expiry Date GT Rundate...                                     S01157
      *                                                                   S01157
     C           ILEDB     IFGT BJRDNB                                    S01157
     C           ILEDB     OREQ 0                                         S01157
      *                                                                   S01157
      *   Get Expiry Date                                                 S01157
      *                                                                   S01157
     C                     Z-ADDILAMB     BILM    90                      S01157
     C                     MOVE ILEDB     ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    IDESCB                          S01157
      *                                                                   S01157
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS IRS LIMITS ===> CASE 2 - Expired                        S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expired, Set Description field.                               S01157
      *                                                                   S01157
     C           ILEDB     IFLE BJRDNB                                    S01157
     C           ILEDB     ANDNE0                                         S01157
     C                     MOVE 'EXPIRED' IDESCB  7                       S01157
     C                     Z-ADD0         BILM                            LN0632
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS IRS LIMITS ===> CASE 3 - No Limit                       S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If limit amount blank...                                         S01157
      *                                                                   S01157
     C           ILAMB     IFEQ 0                                         S01157
      *                                                                   S01157
     C*********************MOVE 'Y'       IDEF                     S01157 LN0632
     C*********************MOVE 'DEFAULT' IDESCB                   S01157 LN0632
     C                     MOVE 'NO LIM.' IDESCB                          LN0632
     C                     END                                            S01157
     C**                                                                  S01157
     C                     ENDSR                                       **
     C**
     C********************************************************************S01157
      /EJECT                                                              S01157
     C********************************************************************
     C**   BRANCH LEVEL LIMITS
     C**   EXSFB  SR. WORKS OUT EXCESS EXPOSURE FOR FX
     C**   -FIRST ROUNDS EXPOSURE FOR EACH PERIOD TO NEAREST 1000 UNITS
     C**   -THEN COMPARES EXPOSURE AMOUNTS TO CORRESP. LIMIT AMOUNTS.
     C           EXSFB     BEGSR                           **  EXSFB   **
     C                     Z-ADD0         D
     C           EXSFB1    TAG                             **  EXSFB1  **
     C           D         ADD  1         D
     C           BFXP,D    DIV  1000      BFXP,D    H
     C   60      BFXP,D    COMP 0                        60
     C           BFXP,D    COMP BFLM,D               89
     C   89      BFXP,D    SUB  BFLM,D    BFXS,D
     C   89                SETON                     70
     C**
     C**   LOOP ROUND AGAIN IF LESS THAN 6 PERIODS HAVE BEEN PROCESSED
     C           D         COMP 6                      89
     C   89                GOTO EXSFB1
     C                     ENDSR
     C**
     C********************************************************************
     C**   BRANCH LEVEL LIMITS
     C**   EXSLB  SR. WORKS OUT EXCESS EXPOSURE FOR LOANS.
     C           EXSLB     BEGSR                           **  EXSLB **
     C                     Z-ADD0         D
     C           EXSLB1    TAG                             **  EXSLB1  **
     C           D         ADD  1         D
     C           BLXP,D    DIV  1000      BLXP,D    H
     C   60      BLXP,D    COMP 0                        60
     C           BLXP,D    COMP BLLM,D               89
     C   89      BLXP,D    SUB  BLLM,D    BLXS,D
     C   89                SETON                     70
     C**
     C           D         COMP 6                      89
     C   89                GOTO EXSLB1
     C                     ENDSR
     C**
     C********************************************************************
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    EXSRB - CALCULATE FRA EXCESS EXPOSURE                         *S01157
      *          - BRANCH LEVEL                                          *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           EXSRB     BEGSR                           ** EXSRB **    S01157
      *                                                                   S01157
      ** FRA EVENT                                                        S01157
      ** Convert exposure amount to thousands first                       S01157
     C           RBPOS     DIV  1000      RBPOS     H                     S01157
     C           RBPOS     SUB  BRLM      BRXS                            S01157
     C           BRXS      IFLT 0                                         S01157
     C                     Z-ADD0         BRXS   100                      S01157
     C                     ELSE                                           S01157
     C                     SETON                         70               S01157
     C                     END                                            S01157
      *                                                                   S01157
      ** If exposure is non-zero, then set-off ind 60                     S01157
     C           RBPOS     IFGT 0                                         S01157
     C                     MOVE '0'       *IN60                           S01157
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** EXSRB ***  S01157
      *                                                                   S01157
      ********************************************************************S01157
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    EXSIB - CALCULATE IRS EXCESS EXPOSURE                         *S01157
      *          - BRANCH LEVEL                                          *S01157
      *                                                                  *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           EXSIB     BEGSR                           ** EXSIB **    S01157
      *                                                                   S01157
      ** IRS EVENT                                                        S01157
      ** Convert exposure amount to thousands first                       S01157
     C           IBPOS     DIV  1000      IBPOS     H                     S01157
     C           IBPOS     SUB  BILM      BIXS                            S01157
     C           BIXS      IFLT 0                                         S01157
     C                     Z-ADD0         BIXS   100                      S01157
     C                     ELSE                                           S01157
     C                     SETON                         70               S01157
     C                     END                                            S01157
      *                                                                   S01157
      ** If exposure is non-zero, then set-off ind 60                     S01157
     C           IBPOS     IFGT 0                                         S01157
     C                     MOVE '0'       *IN60                           S01157
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** EXSIB ***  S01157
      *                                                                   S01157
      ********************************************************************S01157
      /EJECT                                                              S01157
     C********************************************************************
     C**   FORMAT & OUTPUT CTY/BR  LIMIT & EXPOSURE  FOR FX
     C**
     C           FXBWRT    BEGSR                            ** WRITEB **
     C                     SETON                     60
     C                     SETOF                     70
     C**   CALC EXCESS, CHECK FOR ZERO EXPOSURE
     C                     EXSR EXSFB
     C**
     C**   IF NOT ZERO, PRINT. IN60 STILL ON IF ZERO
     C           *IN60     IFNE '1'
     C**                                                               ***
     C**   IF U1 NOT ON, PRINT EVEN IF EXPOSURE LESS THAN LIMIT.
     C**    IF U1 ON, ONLY PRINT IF EXPOSURE GREATER THAN LIMIT.
     C           *INU1     IFEQ '0'
     C           *INU1     OREQ '1'
     C           *IN70     ANDEQ'1'
     C**
     C**   PRINT DETAILS
     C                     Z-ADD0         D
     C**
     C           D         DOUEQ6                                      **
     C                     ADD  1         D
     C**   MOVE EXPOSURE AMT. TO 10 DIGIT FIELD
     C                     Z-ADDBFXP,D    FXPOS  100
     C**   PRINT 1ST LINE
     C           D         IFEQ 1
     C**   PRINT CTY IF NOT ALREADY DONE
     C           NAMPRT    IFEQ 'N'
     C                     EXCPTCTYO
     C                     MOVE 'Y'       NAMPRT
     C                     END
     C**
     C                     EXCPTBFLIN1
     C                     ADD  1         RLIST   50
     C                     ELSE
     C**   PRINT LINES 2-6 IF REQD
     C**   - TEST IF PERIOD END DATE ZERO
     C           BFDT,D    COMP 0                    53    PRINT
     C   53                EXCPTBFLIN2
     C                     END
     C**
     C**   - CALCULATE NEXT START OF PERIOD
     C           BFDA,D    ADD  1         NEXTF   30
     C**
     C                     END
     C                     END                             *inu1=1
     C                     END
     C                     ENDSR
     C**
     C********************************************************************
     C**   FORMAT & OUTPUT CTY/BR  LIMIT & EXPOSURE  FOR LENDING
     C**
     C           LNBWRT    BEGSR                            ** LNBWRT **
     C                     SETON                     60
     C                     SETOF                     70
     C**   CALC EXCESS, CHECK FOR ZERO EXPOSURE
     C                     EXSR EXSLB
     C**
     C**   IF NOT ZERO, PRINT. IN60 STILL ON IF ZERO
     C           *IN60     IFNE '1'
     C**                                                               ***
     C**   IF U1 NOT ON, PRINT EVEN IF EXPOSURE LESS THAN LIMIT.
     C**    IF U1 ON, ONLY PRINT IF EXPOSURE GREATER THAN LIMIT.
     C           *INU1     IFEQ '0'
     C           *INU1     OREQ '1'
     C           *IN70     ANDEQ'1'
     C**
     C**   PRINT DETAILS
     C                     Z-ADD0         D
     C**
     C           D         DOUEQ6                                      **
     C                     ADD  1         D
     C**   MOVE EXPOSURE AMT. TO 10 DIGIT FIELD
     C                     Z-ADDBLXP,D    LXPOS  100
     C**   PRINT 1ST LINE
     C           D         IFEQ 1
     C**   PRINT CTY IF NOT ALREADY DONE
     C           NAMPRT    IFEQ 'N'
     C                     EXCPTCTYO
     C                     MOVE 'Y'       NAMPRT
     C                     END
     C**
     C                     EXCPTBLLIN1
     C                     ADD  1         RLIST   50
     C                     ELSE
     C**   PRINT LINES 2-6 IF REQD
     C**   - TEST IF PERIOD END DATE ZERO
     C           BLDT,D    COMP 0                    54    PRINT
     C   54                EXCPTBLLIN2
     C                     END
     C**
     C**   - CALCULATE NEXT START OF PERIOD
     C           BLDA,D    ADD  1         NEXTL   30
     C**
     C                     END
     C                     END                             *inu1=1
     C                     END
     C                     ENDSR
     C**
     C********************************************************************
     C/EJECT
      ********************************************************************S01157
      *                                                                  *S01157
      *    FRA - FORMAT & OUTPUT CTY/BR LIMIT & EXPOSURE                 *S01157
      *                                                                  *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           FRBWRT    BEGSR                           ** FRBWRT **   S01157
      *                                                                   S01157
     C                     MOVE '1'       *IN60                           S01157
     C                     MOVE '0'       *IN70                           S01157
      *                                                                   S01157
      *  Calculate Excess Exposure, Check for Zero Exposure               S01157
     C                     EXSR EXSRB                                     S01157
      *                                                                   S01157
      *  If Not Zero, PRINT...*IN60 still ON if Zero                      S01157
     C           *IN60     IFNE '1'                                       S01157
      *                                                                   S01157
      *  If U1 NOT on, PRINT even if exposure LESS than Limit.            S01157
      *  If U1 on, only PRINT if exposure GREATER than Limit.             S01157
     C           *INU1     IFEQ '0'                                       S01157
     C           *INU1     OREQ '1'                                       S01157
     C           *IN70     ANDEQ'1'                                       S01157
      *                                                                   S01157
      *  Print Country if not already done.                               S01157
     C           NAMPRT    IFEQ 'N'                                       S01157
     C                     EXCPTCTYO                                      S01157
     C                     MOVE 'Y'       NAMPRT                          S01157
     C                     END                                            S01157
      *                                                                   S01157
      *  Print details.                                                   S01157
     C                     EXCPTBRLIN                                     S01157
      *                                                                   S01157
     C                     ADD  1         RLIST   50                      S01157
      *                                                                   S01157
      ***Initialise*exposure*field.***                             S01157 099251
     C***********          Z-ADD0         RBPOS                    S01157 099251
     C                     END                                            S01157
      *  Initialise exposure field.                                       099251
     C                     Z-ADD0         RBPOS                           099251
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** FRBWRT *** S01157
      *                                                                   S01157
      ********************************************************************S01157
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    IRS - FORMAT & OUTPUT CTY/BR LIMIT & EXPOSURE                 *S01157
      *                                                                  *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           IRBWRT    BEGSR                           ** IRBWRT **   S01157
      *                                                                   S01157
     C                     MOVE '1'       *IN60                           S01157
     C                     MOVE '0'       *IN70                           S01157
      *                                                                   S01157
      *  Calculate Excess Exposure, Check for Zero Exposure               S01157
     C                     EXSR EXSIB                                     S01157
      *                                                                   S01157
      *  If Not Zero, PRINT...*IN60 still ON if Zero                      S01157
     C           *IN60     IFNE '1'                                       S01157
      *                                                                   S01157
      *  If U1 NOT on, PRINT even if exposure LESS than Limit.            S01157
      *  If U1 on, only PRINT if exposure GREATER than Limit.             S01157
     C           *INU1     IFEQ '0'                                       S01157
     C           *INU1     OREQ '1'                                       S01157
     C           *IN70     ANDEQ'1'                                       S01157
      *                                                                   S01157
      *  Print Country if not already done.                               S01157
     C           NAMPRT    IFEQ 'N'                                       S01157
     C                     EXCPTCTYO                                      S01157
     C                     MOVE 'Y'       NAMPRT                          S01157
     C                     END                                            S01157
      *                                                                   S01157
      *  Print details.                                                   S01157
     C                     EXCPTBILIN                                     S01157
      *                                                                   S01157
     C                     ADD  1         RLIST   50                      S01157
      *                                                                   S01157
      ***Initialise*exposure*field.***                             S01157 099251
     C***********          Z-ADD0         IBPOS                    S01157 099251
     C                     END                                            S01157
      *  Initialise exposure field.                                       099251
     C                     Z-ADD0         IBPOS                           099251
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** IRBWRT *** S01157
      *                                                                   S01157
      ********************************************************************S01157
     C/EJECT
     C********************************************************************
     C**   COMPANY LEVEL SR'S -
     C**      LMTC
     C********FXCWRT,LNCWRT                                               S01157
     C********EXSFC, EXSLC                                                S01157
     C**      FXCWRT,LNCWRT,FRCWRT,IRCWRT                                 S01157
     C**      EXSFC, EXSLC, EXSRC, EXSIC                                  S01157
     C********************************************************************
     C*   COMPANY LEVEL LIMITS
     C*     LMTC SR. SETS UP ARRAYS OF LIMIT PERIODS & AMOUNTS,
     C*    FOR FX LIMITS AND LENDING LIMITS.
     C           LMTC      BEGSR                           **  LMTC *  *
     C                     MOVE *BLANKS   FDESCC  7
     C                     MOVE *BLANKS   LDESCC  7
     C                     MOVE *BLANKS   RDESCC  7                       S01157
     C                     MOVE *BLANKS   IDESCC  7                       S01157
     C                     MOVE *BLANKS   FDEF
     C                     MOVE *BLANKS   LDEF
     C                     MOVE *BLANKS   RDEF    1                       S01157
     C                     MOVE *BLANKS   IDEF    1                       S01157
     C                     MOVE *BLANKS   ASTFC   1
     C                     MOVE *BLANKS   ASTLC   1
     C**
     C**   FIRST RESET ARRAYS TO ZEROES
     C                     Z-ADD0         CFDA
     C                     Z-ADD0         CFDT
     C                     Z-ADD0         CFLM
     C                     Z-ADD0         CFXP
     C                     Z-ADD0         CFXS
     C                     Z-ADD0         CLDA
     C                     Z-ADD0         CLDT
     C                     Z-ADD0         CLLM
     C                     Z-ADD0         CLXP
     C                     Z-ADD0         CLXS
     C*
     C                     SETOF                     7374
     C**
     C**   PROCESS FX LIMITS FIRST
     C**
     C** CASE 1 - LIVE, NON ZERO
     C** IF FX LIMIT TYPE NON ZERO & EXPIRY DATE GT RUN DATE (BJAKTX)
     C           FLTYC     IFNE *BLANKS
     C           FLEDC     IFGT BJRDNB
     C           FLEDC     OREQ 0
     C                     EXSR LMTCF
     C**  GET EXPIRY DATE
     C                     MOVE FLEDC     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    FDESCC
     C                     END
     C                     END
     C**
     C**
     C**   CASE 2-EXPIRED
     C**   - IF EXPIRED, SET FIRST PERIOD END DAYS & DATE TO NINES
     C**     & ZEROIZE AMOUNT
     C           FLEDC     IFLE BJRDNB
     C           FLEDC     ANDNE0
     C                     MOVE 'EXPIRED' FDESCC  7
     C                     Z-ADD999       CFDA,1
     C                     Z-ADD99999     CFDT,1
     C                     Z-ADD0         CFLM,1
     C                     END
     C**   CASE 3 - NO LIMIT
     C**   - IF FX LIMIT TYPE 0, CONDITION DEFAULT
     C           FLTYC     IFEQ *BLANKS
     C                     MOVE 'Y'       FDEF    1
     C                     MOVE 'DEFAULT' FDESCC
     C                     END
     C**
     C**
     C**   PROCESS LENDING LIMITS.
     C**
     C**   CASE 1 - LIVE, NON ZERO
     C**   IF LN LIMIT TYPE NON ZERO & EXPIRY DATE GT RUN DATE (BJAKTX)
     C           LLTYC     IFNE *BLANKS
     C           LLEDC     IFGT BJRDNB
     C           LLEDC     OREQ 0
     C                     EXSR LMTCL
     C**  GET EXPIRY DATE
     C                     MOVE LLEDC     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    LDESCC
     C                     END
     C                     END
     C**
     C**
     C**   CASE 2 - EXPIRED
     C**   - IF EXPIRED, SET FIRST PERIOD END DAYS & DATE TO NINES
     C**     & ZEROISE AMOUNT
     C           LLEDC     IFLE BJRDNB
     C           LLEDC     ANDNE0
     C                     MOVE 'EXPIRED' LDESCC  7
     C                     Z-ADD999       CLDA,1
     C                     Z-ADD99999     CLDT,1
     C                     Z-ADD0         CLLM,1
     C                     END                                         **
     C**
     C**   CASE 3 - NO  LIMIT
     C**   - IF LIMIT TYPE 0, CONDITION DEFAULT
     C           LLTYC     IFEQ *BLANKS
     C                     MOVE 'Y'       LDEF    1
     C                     MOVE 'DEFAULT' LDESCC
     C                     END
     C**
     C**
      *                                                                   S01157
      *   PROCESS FRA LIMITS ===> CASE 1 - Live, Non Zero                 S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expiry Date GT Rundate...                                     S01157
      *                                                                   S01157
     C           RLEDC     IFGT BJRDNB                                    S01157
     C           RLEDC     OREQ 0                                         S01157
      *                                                                   S01157
      *   Get Expiry Date                                                 S01157
      *                                                                   S01157
     C                     Z-ADDRLAMC     CRLM    90                      S01157
     C                     MOVE RLEDC     ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    RDESCC                          S01157
      *                                                                   S01157
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS FRA LIMITS ===> CASE 2 - Expired                        S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expired, Set Description field.                               S01157
      *                                                                   S01157
     C           RLEDC     IFLE BJRDNB                                    S01157
     C           RLEDC     ANDNE0                                         S01157
     C                     MOVE 'EXPIRED' RDESCC  7                       S01157
     C                     Z-ADD0         CRLM                            LN0632
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS FRA LIMITS ===> CASE 3 - No Limit                       S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If limit amount blank...                                         S01157
      *                                                                   S01157
     C           RLAMC     IFEQ 0                                         S01157
      *                                                                   S01157
     C                     MOVE 'Y'       RDEF                            S01157
     C                     MOVE 'DEFAULT' RDESCC                          S01157
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS IRS LIMITS ===> CASE 1 - Live, Non Zero                 S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expiry Date GT Rundate...                                     S01157
      *                                                                   S01157
     C           ILEDC     IFGT BJRDNB                                    S01157
     C           ILEDC     OREQ 0                                         S01157
      *                                                                   S01157
      *   Get Expiry Date                                                 S01157
      *                                                                   S01157
     C                     Z-ADDILAMC     CILM    90                      S01157
     C                     MOVE ILEDC     ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    IDESCC                          S01157
      *                                                                   S01157
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS IRS LIMITS ===> CASE 2 - Expired                        S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expired, Set Description field.                               S01157
      *                                                                   S01157
     C           ILEDC     IFLE BJRDNB                                    S01157
     C           ILEDC     ANDNE0                                         S01157
     C                     MOVE 'EXPIRED' IDESCC  7                       S01157
     C                     Z-ADD0         CILM                            LN0632
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS IRS LIMITS ===> CASE 3 - No Limit                       S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If limit amount blank...                                         S01157
      *                                                                   S01157
     C           ILAMC     IFEQ 0                                         S01157
      *                                                                   S01157
     C                     MOVE 'Y'       IDEF                            S01157
     C                     MOVE 'DEFAULT' IDESCC                          S01157
     C                     END                                            S01157
     C**                                                                  S01157
     C***IF*FX*OR*LN*DEFAULT*REQD*****************                        S01157
     C** If FX, LN,FRA or IRS default required...                         S01157
     C           FDEF      IFEQ 'Y'
     C           LDEF      OREQ 'Y'
     C           RDEF      OREQ 'Y'                                       S01157
     C           IDEF      OREQ 'Y'                                       S01157
     C                     MOVE 'C'       LEVEL
     C                     MOVE CO        ENTITY
     C                     EXSR DL0132
     C**
     C**  APPLY DEFAULT VALUES
     C**                                                                  LN0632
     C** IF FX DEFAULT REQUIRED
     C           FDEF      IFEQ 'Y'
     C** IF FX LIMIT FOUND
     C           FXLIM     IFNE 0
     C**  IF ALL LOWER LEVEL LIMITS HAD SAME TYPE,
     C**  USE THIS FOR 1ST PERIOD
     C           FXSAME    IFEQ 'Y'
     C                     MOVEAFXPER     CFDAA
     C                     Z-ADDFXLIM     FLAMC
     C                     MOVE FXPC      CFPCA
     C*
     C           FLAMC     DIV  CFPC,1    FLAMC     H
     C*
     C                     EXSR LMTCF
     C                     ELSE
     C**  ELSE SET UP SPOT PERIOD
     C                     Z-ADDSP        CFDA,1
     C           SP        ADD  BJRDNB    CFDT,1
     C                     Z-ADD999       CFDA,2
     C                     Z-ADD99999     CFDT,2
     C                     Z-ADDFXLIM     CFLM,1
     C                     MOVE '*'       ASTFC
     C                     END
     C                     ELSE
     C**  IF NOT FOUND
     C                     Z-ADD999       CFDA,1
     C                     Z-ADD99999     CFDT,1
     C                     END
     C                     END
     C**
     C**  IF LN DEFAULT REQUIRED
     C           LDEF      IFEQ 'Y'
     C**  IF LENDING LIMIT FOUND
     C           LNLIM     IFNE 0
     C**  IF ALL LOWER LEVEL LIMITS HAD SAME TYPE,
     C**  USE THIS FOR 1ST PERIOD
     C           LNSAME    IFEQ 'Y'
     C                     MOVEALNPER     CLDAA
     C                     Z-ADDLNLIM     LLAMC
     C                     MOVE LNPC      CLPCA
     C*
     C           LLAMC     DIV  CLPC,1    LLAMC     H
     C*
     C                     EXSR LMTCL
     C                     ELSE
     C**  ELSE SET UP OVERNIGHT PERIOD
     C                     Z-ADD1         CLDA,1
     C           1         ADD  BJRDNB    CLDT,1
     C                     Z-ADD999       CLDA,2
     C                     Z-ADD99999     CLDT,2
     C                     Z-ADDLNLIM     CLLM,1
     C                     MOVE '*'       ASTLC
     C                     END
     C                     ELSE
     C** IF NOT FOUND
     C                     Z-ADD999       CLDA,1
     C                     Z-ADD99999     CLDT,1
     C                     END
     C                     END
      *                                                                   LN0632
      ** If FRA default required, set up company limit                    LN0632
     C           RDEF      IFEQ 'Y'                                       LN0632
     C                     Z-ADDFRLIM     CRLM                            LN0632
     C                     END                                            LN0632
      *                                                                   LN0632
      ** If IRS default required, set up company limit                    LN0632
     C           IDEF      IFEQ 'Y'                                       LN0632
     C                     Z-ADDIRLIM     CILM                            LN0632
     C                     END                                            LN0632
      *                                                                   LN0632
     C                     END
     C**
     C**
     C                     ENDSR                                       **
     C**
     C********************************************************************
     C**  LMTCF SR SETS UP LIMIT ARRAYS FOR FX
     C**  INPUT - CFDAA - PERIOD ARRAY
     C**          CFPC - PERCENTAGE ARRAY
     C**          FLAMC - LIMIT AMOUNT
     C**   IF ANY ELEMENT IS BLANK OR 999
     C**   THE CORRESPONDING ELEMENTS IN CFDA & CFDT ARE SET TO NINES.
     C**   ELSE,CFDT IS CALCULATED BY ADDING RUN DATE (BJAKTX) TO CFDA,
     C**        CFLM,IS CALCULATED BY MULTIPLYING LIMIT AMOUNT BY CFPC
     C**
     C           LMTCF     BEGSR                           **  LMTCF **
     C                     Z-ADD0         D       20
     C           CFDAA,1   COMP 'SP '                    73
     C           LMTC1     TAG                             ** LMTC1   **
     C**
     C           D         ADD  1         D
     C********** CFDAA,D   COMP '   '                    88               E309
     C           CFDAA,D   COMP '000'                    88               E309
     C           CFDAA,D   COMP '999'                    87
     C**
     C   88                Z-ADD999       CFDA,D
     C  N88                MOVE CFDAA,D   CFDA,D
     C*
     C**
     C           CFDA,D    ADD  BJRDNB    CFDT,D
     C   88
     COR 87                Z-ADD99999     CFDT,D
     C**
     C  N88      FLAMC     MULT CFPC,D    CFLM,D
     C**
     C           D         COMP 6                      86
     C   86N87N88          GOTO LMTC1
     C   73                Z-ADDSP        CFDA,1
     C   73      SP        ADD  BJRDNB    CFDT,1
     C                     ENDSR
     C**
     C********************************************************************
     C**  LMTCL SR SETS UP LIMIT ARRAYS FOR LN
     C**  INPUT - CLDAA - PERIOD ARRAY
     C**          CLPC - PERCENTAGE ARRAY
     C**          LLAMC - LIMIT AMOUNT
     C**  PROCESSES CLDAA IN THE SAME WAY AS LMTCF
     C           LMTCL     BEGSR                           **  LMTCL **
     C                     Z-ADD0         D
     C           CLDAA,1   COMP 'SP '                    74
     C           LMTC2     TAG                             **  LMTC2   **
     C**
     C           D         ADD  1         D
     C********** CLDAA,D   COMP '   '                    88               E309
     C           CLDAA,D   COMP '000'                    88               E309
     C           CLDAA,D   COMP '999'                    87
     C**
     C   88                Z-ADD999       CLDA,D
     C  N88                MOVE CLDAA,D   CLDA,D
     C*
     C**
     C           CLDA,D    ADD  BJRDNB    CLDT,D
     C   88
     COR 87                Z-ADD99999     CLDT,D
     C**
     C  N88      LLAMC     MULT CLPC,D    CLLM,D
     C**
     C           D         COMP 6                      86
     C   86N87N88          GOTO LMTC2
     C   74                Z-ADDSP        CLDA,1
     C   74      SP        ADD  BJRDNB    CLDT,1
     C                     ENDSR
     C**
     C********************************************************************
     C**   FORMAT & OUTPUT CTY/CO  LIMIT & EXPOSURE   FOR FX
     C**
     C           FXCWRT    BEGSR                           ** FXCWRT **
     C                     SETON                     60
     C                     SETOF                     70
     C**   CALC EXCESS, CHECK FOR ZERO EXPOSURE
     C                     EXSR EXSFC
     C**   IF NOT ZERO, PRINT. IN60 STILL ON IF ZERO
     C           *IN60     IFNE '1'
     C**
     C**   IF U1 NOT ON, PRINT EVEN IF EXPOSURE LESS THAN LIMIT.
     C**    IF U1 ON, ONLY PRINT IF EXPOSURE GREATER THAN LIMIT.
     C           *INU1     IFEQ '0'
     C           *INU1     OREQ '1'
     C           *IN70     ANDEQ'1'
     C**
     C**   PRINT DETAILS
     C                     Z-ADD0         D
     C**
     C           D         DOUEQ6                                      **
     C                     ADD  1         D
     C**   MOVE EXPOSURE AMT. TO 10 DIGIT FIELD
     C                     Z-ADDCFXP,D    FXPOS  100
     C**   PRINT 1ST LINE
     C           D         IFEQ 1
     C**   PRINT CTY IF NOT ALREADY DONE
     C           NAMPRT    IFEQ 'N'
     C                     EXCPTCTYO
     C                     MOVE 'Y'       NAMPRT
     C                     END
     C**
     C                     EXCPTCFLIN1
     C                     ADD  1         RLIST   50
     C                     ELSE
     C**   PRINT LINES 2-6 IF REQD
     C**   - TEST IF PERIOD END DATE ZERO
     C           CFDT,D    COMP 0                    53    PRINT
     C   53                EXCPTCFLIN2
     C                     END
     C**
     C**   - CALCULATE NEXT START OF PERIOD
     C           CFDA,D    ADD  1         NEXTF   30
     C**
     C                     END
     C                     END                             *inu1=1
     C                     END
     C**
     C                     MOVE *BLANKS   ASTFC
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**   FORMAT & OUTPUT CTY/CO  LIMIT & EXPOSURE   FOR LENDING
     C**
     C           LNCWRT    BEGSR                           ** LNCWRT **
     C                     SETON                     60
     C                     SETOF                     70
     C**   CALC EXCESS, CHECK FOR ZERO EXPOSURE
     C                     EXSR EXSLC
     C**   IF NOT ZERO, PRINT. IN60 STILL ON IF ZERO
     C           *IN60     IFNE '1'
     C**
     C**   IF U1 NOT ON, PRINT EVEN IF EXPOSURE LESS THAN LIMIT.
     C**    IF U1 ON, ONLY PRINT IF EXPOSURE GREATER THAN LIMIT.
     C           *INU1     IFEQ '0'
     C           *INU1     OREQ '1'
     C           *IN70     ANDEQ'1'
     C**
     C**   PRINT DETAILS
     C                     Z-ADD0         D
     C**
     C           D         DOUEQ6                                      **
     C                     ADD  1         D
     C**   MOVE EXPOSURE AMT. TO 10 DIGIT FIELD
     C                     Z-ADDCLXP,D    LXPOS  100
     C**   PRINT 1ST LINE
     C           D         IFEQ 1
     C**   PRINT CTY IF NOT ALREADY DONE
     C           NAMPRT    IFEQ 'N'
     C                     EXCPTCTYO
     C                     MOVE 'Y'       NAMPRT
     C                     END
     C**
     C                     EXCPTCLLIN1
     C                     ADD  1         RLIST   50
     C                     ELSE
     C**   PRINT LINES 2-6 IF REQD
     C**   - TEST IF PERIOD END DATE ZERO
     C           CLDT,D    COMP 0                    54    PRINT
     C   54                EXCPTCLLIN2
     C                     END
     C**
     C**   - CALCULATE NEXT START OF PERIOD
     C           CLDA,D    ADD  1         NEXTL   30
     C**
     C                     END
     C                     END                             *inu1=1
     C                     END
     C**
     C                     MOVE *BLANKS   ASTLC
     C**
     C                     ENDSR
     C**
      ********************************************************************S01157
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    FRA - FORMAT & OUTPUT CTY/CO LIMIT & EXPOSURE                 *S01157
      *                                                                  *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           FRCWRT    BEGSR                           ** FRCWRT **   S01157
      *                                                                   S01157
     C                     MOVE '1'       *IN60                           S01157
     C                     MOVE '0'       *IN70                           S01157
      *                                                                   S01157
      *  Calculate Excess Exposure, Check for Zero Exposure               S01157
     C                     EXSR EXSRC                                     S01157
      *                                                                   S01157
      *  If Not Zero, PRINT...*IN60 still ON if Zero                      S01157
     C           *IN60     IFNE '1'                                       S01157
      *                                                                   S01157
      *  If U1 NOT on, PRINT even if exposure LESS than Limit.            S01157
      *  If U1 on, only PRINT if exposure GREATER than Limit.             S01157
     C           *INU1     IFEQ '0'                                       S01157
     C           *INU1     OREQ '1'                                       S01157
     C           *IN70     ANDEQ'1'                                       S01157
      *                                                                   S01157
      *  Print Country if not already done.                               S01157
     C           NAMPRT    IFEQ 'N'                                       S01157
     C                     EXCPTCTYO                                      S01157
     C                     MOVE 'Y'       NAMPRT                          S01157
     C                     END                                            S01157
      *                                                                   S01157
      *  Print details.                                                   S01157
     C                     EXCPTCRLIN                                     S01157
      *                                                                   S01157
     C                     ADD  1         RLIST   50                      S01157
      *                                                                   S01157
      ***Initialise*exposure*field.***                             S01157 099251
     C***********          Z-ADD0         RCPOS                    S01157 099251
     C                     END                                            S01157
      *  Initialise exposure field.                                       099251
     C                     Z-ADD0         RCPOS                           099251
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** FRCWRT *** S01157
      *                                                                   S01157
      ********************************************************************S01157
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    IRS - FORMAT & OUTPUT CTY/CO LIMIT & EXPOSURE                 *S01157
      *                                                                  *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           IRCWRT    BEGSR                           ** IRCWRT **   S01157
      *                                                                   S01157
     C                     MOVE '1'       *IN60                           S01157
     C                     MOVE '0'       *IN70                           S01157
      *                                                                   S01157
      *  Calculate Excess Exposure, Check for Zero Exposure               S01157
     C                     EXSR EXSIC                                     S01157
      *                                                                   S01157
      *  If Not Zero, PRINT...*IN60 still ON if Zero                      S01157
     C           *IN60     IFNE '1'                                       S01157
      *                                                                   S01157
      *  If U1 NOT on, PRINT even if exposure LESS than Limit.            S01157
      *  If U1 on, only PRINT if exposure GREATER than Limit.             S01157
     C           *INU1     IFEQ '0'                                       S01157
     C           *INU1     OREQ '1'                                       S01157
     C           *IN70     ANDEQ'1'                                       S01157
      *                                                                   S01157
      *  Print Country if not already done.                               S01157
     C           NAMPRT    IFEQ 'N'                                       S01157
     C                     EXCPTCTYO                                      S01157
     C                     MOVE 'Y'       NAMPRT                          S01157
     C                     END                                            S01157
      *                                                                   S01157
      *  Print details.                                                   S01157
     C                     EXCPTCILIN                                     S01157
      *                                                                   S01157
     C                     ADD  1         RLIST   50                      S01157
      *                                                                   S01157
      ***Initialise*exposure*field.***                             S01157 099251
     C***********          Z-ADD0         ICPOS                    S01157 099251
     C                     END                                            S01157
      *  Initialise exposure field.                                       099251
     C                     Z-ADD0         ICPOS                           099251
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** IRCWRT *** S01157
      *                                                                   S01157
     C********************************************************************S01157
      /EJECT                                                              S01157
     C********************************************************************
     C**   COMPANY LEVEL LIMITS
     C**   EXSFC  SR. WORKS OUT EXCESS EXPOSURE FOR FX
     C**   -FIRST ROUNDS EXPOSURE FOR EACH PERIOD TO NEAREST 1000 UNITS
     C**   -THEN COMPARES EXPOSURE AMOUNTS TO CORRESP. LIMIT AMOUNTS.
     C           EXSFC     BEGSR                           **  EXSFC   **
     C                     Z-ADD0         D
     C           EXSFC1    TAG                             **  EXSFC1  **
     C           D         ADD  1         D
     C           CFXP,D    DIV  1000      CFXP,D    H
     C   60      CFXP,D    COMP 0                        60
     C           CFXP,D    COMP CFLM,D               89
     C   89      CFXP,D    SUB  CFLM,D    CFXS,D
     C   89                SETON                     70
     C**
     C**   LOOP ROUND AGAIN IF LESS THAN 6 PERIODS HAVE BEEN PROCESSED
     C           D         COMP 6                      89
     C   89                GOTO EXSFC1
     C                     ENDSR
     C**
     C********************************************************************
     C**   COMPANY LEVEL LIMITS
     C**   EXSLC  SR. WORKS OUT EXCESS EXPOSURE FOR LOANS.
     C           EXSLC     BEGSR                           **  EXSLC  **
     C                     Z-ADD0         D
     C           EXSLC1    TAG                             **  EXSLC1  **
     C           D         ADD  1         D
     C           CLXP,D    DIV  1000      CLXP,D    H
     C   60      CLXP,D    COMP 0                        60
     C           CLXP,D    COMP CLLM,D               89
     C   89      CLXP,D    SUB  CLLM,D    CLXS,D
     C   89                SETON                     70
     C**
     C           D         COMP 6                      89
     C   89                GOTO EXSLC1
     C                     ENDSR
     C**
     C********************************************************************
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    EXSRC - CALCULATE FRA EXCESS EXPOSURE                         *S01157
      *          - COMPANY LEVEL                                         *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           EXSRC     BEGSR                           ** EXSRC **    S01157
      *                                                                   S01157
      ** FRA EVENT                                                        S01157
      ** Convert exposure amount to thousands first                       S01157
     C           RCPOS     DIV  1000      RCPOS     H                     S01157
     C           RCPOS     SUB  CRLM      CRXS                            S01157
     C           CRXS      IFLT 0                                         S01157
     C                     Z-ADD0         CRXS   100                      S01157
     C                     ELSE                                           S01157
     C                     SETON                         70               S01157
     C                     END                                            S01157
      *                                                                   S01157
      ** If exposure is non-zero, then set-off ind 60                     S01157
     C           RCPOS     IFGT 0                                         S01157
     C                     MOVE '0'       *IN60                           S01157
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** EXSRC ***  S01157
      *                                                                   S01157
      ********************************************************************S01157
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    EXSIC - CALCULATE IRS EXCESS EXPOSURE                         *S01157
      *          - COMPANY LEVEL                                         *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           EXSIC     BEGSR                           ** EXSIC **    S01157
      *                                                                   S01157
      ** IRS EVENT                                                        S01157
      ** Convert exposure amount to thousands first                       S01157
     C           ICPOS     DIV  1000      ICPOS     H                     S01157
     C           ICPOS     SUB  CILM      CIXS                            S01157
     C           CIXS      IFLT 0                                         S01157
     C                     Z-ADD0         CIXS   100                      S01157
     C                     ELSE                                           S01157
     C                     SETON                         70               S01157
     C                     END                                            S01157
      *                                                                   S01157
      ** If exposure is non-zero, then set-off ind 60                     S01157
     C           ICPOS     IFGT 0                                         S01157
     C                     MOVE '0'       *IN60                           S01157
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** EXSIC ***  S01157
      *                                                                   S01157
      ********************************************************************S01157
     C/EJECT
     C********************************************************************
     C**   SYSTEM LEVEL SR'S -
     C**      LMTS
     C********FXSWRT,LNSWRT                                               S01157
     C********EXSFS, EXSLS                                                S01157
     C**      FXSWRT,LNSWRT,FRSWRT,IRSWRT                                 S01157
     C**      EXSFS, EXSLS, EXSRS, EXSIS                                  S01157
     C********************************************************************
     C*   SYSTEM LEVEL LIMITS
     C*     LMTS SR. SETS UP ARRAYS OF LIMIT PERIODS & AMOUNTS,
     C*    FOR FX LIMITS AND LENDING LIMITS.
     C           LMTS      BEGSR                           **  LMTS *  *
     C                     MOVE *BLANKS   FDESCS  7
     C                     MOVE *BLANKS   LDESCS  7
     C                     MOVE *BLANKS   RDESC   7                       S01157
     C                     MOVE *BLANKS   IDESC   7                       S01157
     C                     MOVE *BLANKS   FDEF
     C                     MOVE *BLANKS   LDEF
     C                     MOVE *BLANKS   RDEF    1                       S01157
     C                     MOVE *BLANKS   IDEF    1                       S01157
     C                     MOVE *BLANKS   ASTFS   1
     C                     MOVE *BLANKS   ASTLS   1
     C                     Z-ADD0         XRLM                            S01157
     C                     Z-ADD0         XILM                            S01157
     C**
     C**   FIRST RESET ARRAYS TO ZEROES
     C                     Z-ADD0         XFDA
     C                     Z-ADD0         XFDT
     C                     Z-ADD0         XFLM
     C                     Z-ADD0         XFXP
     C                     Z-ADD0         XFXS
     C                     Z-ADD0         XLDA
     C                     Z-ADD0         XLDT
     C                     Z-ADD0         XLLM
     C                     Z-ADD0         XLXP
     C                     Z-ADD0         XLXS
     C*
     C                     SETOF                     7172
     C**
     C**
     C**   PROCESS FX LIMITS FIRST
     C** CASE 1 - LIVE, NON ZERO
     C** IF FX LIMIT TYPE NON ZERO & EXPIRY DATE GT RUN DATE (BJAKTX)
     C           FLTYS     IFNE *BLANKS
     C           FLEDS     IFGT BJRDNB
     C           FLEDS     OREQ 0
     C                     EXSR LMTSF
     C**  GET EXPIRY DATE
     C                     MOVE FLEDS     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    FDESCS
     C                     END
     C                     END
     C**
     C**   CASE 2-EXPIRED
     C**   - IF EXPIRED, SET FIRST PERIOD END DAYS & DATE TO NINES
     C**     & ZEROIZE AMOUNT
     C           FLEDS     IFLE BJRDNB
     C           FLEDS     ANDNE0
     C                     MOVE 'EXPIRED' FDESCS  7
     C                     Z-ADD999       XFDA,1
     C                     Z-ADD99999     XFDT,1
     C                     Z-ADD0         XFLM,1
     C                     END
     C**   CASE 3 - NO LIMIT
     C**   - IF FX LIMIT TYPE 0, CONDITION DEFAULT
     C           FLTYS     IFEQ *BLANKS
     C                     MOVE 'Y'       FDEF    1
     C                     MOVE 'DEFAULT' FDESCS
     C                     END
     C**
     C**   PROCESS LENDING LIMITS.
     C**
     C**   CASE 1 - LIVE, NON ZERO
     C**   IF LN LIMIT TYPE NON ZERO & EXPIRY DATE GT RUN DATE (BJAKTX)
     C           LLTYS     IFNE *BLANKS
     C           LLEDS     IFGT BJRDNB
     C           LLEDS     OREQ 0
     C                     EXSR LMTSL
     C**  GET EXPIRY DATE
     C                     MOVE LLEDS     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    LDESCS
     C                     END
     C                     END
     C**
     C**   CASE 2 - EXPIRED
     C**   - IF EXPIRED, SET FIRST PERIOD END DAYS & DATE TO NINES
     C**     & ZEROISE AMOUNT
     C           LLEDS     IFLE BJRDNB
     C           LLEDS     ANDNE0
     C                     MOVE 'EXPIRED' LDESCS  7
     C                     Z-ADD999       XLDA,1
     C                     Z-ADD99999     XLDT,1
     C                     Z-ADD0         XLLM,1
     C                     END                                         **
     C**
     C**   CASE 3 - NO  LIMIT
     C**   - IF LIMIT TYPE 0, CONDITION DEFAULT
     C           LLTYS     IFEQ *BLANKS
     C                     MOVE 'Y'       LDEF    1
     C                     MOVE 'DEFAULT' LDESCS
     C                     END
     C**
      *                                                                   S01157
      *   PROCESS FRA LIMITS ===> CASE 1 - Live, Non Zero                 S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expiry Date GT Rundate...                                     S01157
      *                                                                   S01157
     C           RLEDS     IFGT BJRDNB                                    S01157
     C           RLEDS     OREQ 0                                         S01157
      *                                                                   S01157
      *   Get Expiry Date                                                 S01157
      *                                                                   S01157
     C                     Z-ADDRLAMS     XRLM    90                      S01157
     C                     MOVE RLEDS     ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    RDESCS                          S01157
      *                                                                   S01157
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS FRA LIMITS ===> CASE 2 - Expired                        S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expired, Set Description field.                               S01157
      *                                                                   S01157
     C           RLEDS     IFLE BJRDNB                                    S01157
     C           RLEDS     ANDNE0                                         S01157
     C                     MOVE 'EXPIRED' RDESCS  7                       S01157
     C                     Z-ADD0         XRLM                            LN0632
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS FRA LIMITS ===> CASE 3 - No Limit                       S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If limit amount blank...                                         S01157
      *                                                                   S01157
     C           RLAMS     IFEQ 0                                         S01157
      *                                                                   S01157
     C                     MOVE 'Y'       RDEF                            S01157
     C                     MOVE 'DEFAULT' RDESCS                          S01157
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS IRS LIMITS ===> CASE 1 - Live, Non Zero                 S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expiry Date GT Rundate...                                     S01157
      *                                                                   S01157
     C           ILEDS     IFGT BJRDNB                                    S01157
     C           ILEDS     OREQ 0                                         S01157
      *                                                                   S01157
      *   Get Expiry Date                                                 S01157
      *                                                                   S01157
     C                     Z-ADDILAMS     XILM    90                      S01157
     C                     MOVE ILEDS     ZDAYNO                          S01157
     C                     EXSR ZDATE2                                    S01157
     C                     MOVE ZADATE    IDESCS                          S01157
      *                                                                   S01157
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS IRS LIMITS ===> CASE 2 - Expired                        S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If Expired, Set Description field.                               S01157
      *                                                                   S01157
     C           ILEDS     IFLE BJRDNB                                    S01157
     C           ILEDS     ANDNE0                                         S01157
     C                     MOVE 'EXPIRED' IDESCS  7                       S01157
     C                     Z-ADD0         XILM                            LN0632
     C                     END                                            S01157
      *                                                                   S01157
      *   PROCESS IRS LIMITS ===> CASE 3 - No Limit                       S01157
      *   ------------------                                              S01157
      *                                                                   S01157
      ** If limit amount blank...                                         S01157
      *                                                                   S01157
     C           ILAMS     IFEQ 0                                         S01157
      *                                                                   S01157
     C                     MOVE 'Y'       IDEF                            S01157
     C                     MOVE 'DEFAULT' IDESCS                          S01157
     C                     END                                            S01157
     C**                                                                  S01157
     C***IF*FX*OR*LN*DEFAULT*REQD*****************                        S01157
     C** If FX, LN, FRA or IRS default required...                        S01157
     C           FDEF      IFEQ 'Y'
     C           LDEF      OREQ 'Y'
     C           RDEF      OREQ 'Y'                                       S01157
     C           IDEF      OREQ 'Y'                                       S01157
     C                     MOVE 'S'       LEVEL   1
     C                     MOVE '   '     ENTITY  3
     C                     EXSR DL0132
     C**
     C**  APPLY DEFAULT VALUES
     C**                                                                  LN0632
     C** IF FX DEFAULT REQUIRED
     C           FDEF      IFEQ 'Y'
     C** IF FX LIMIT FOUND
     C           FXLIM     IFNE 0
     C**  IF ALL LOWER LEVEL LIMITS HAD SAME TYPE,
     C**  USE THIS FOR 1ST PERIOD
     C           FXSAME    IFEQ 'Y'
     C                     MOVEAFXPER     XFDAA
     C                     Z-ADDFXLIM     FLAMS
     C                     MOVE FXPC      XFPCA
     C*
     C           FLAMS     DIV  XFPC,1    FLAMS     H
     C*
     C                     EXSR LMTSF
     C                     ELSE
     C**  ELSE SET UP SPOT PERIOD
     C                     Z-ADDSP        XFDA,1
     C           SP        ADD  BJRDNB    XFDT,1
     C                     Z-ADD999       XFDA,2
     C                     Z-ADD99999     XFDT,2
     C                     Z-ADDFXLIM     XFLM,1
     C                     MOVE '*'       ASTFS
     C                     END
     C                     ELSE
     C**  IF NOT FOUND
     C                     Z-ADD999       XFDA,1
     C                     Z-ADD99999     XFDT,1
     C                     END
     C                     END
     C**
     C**  IF LN DEFAULT REQUIRED
     C           LDEF      IFEQ 'Y'
     C**  IF LENDING LIMIT FOUND
     C           LNLIM     IFNE 0
     C**  IF ALL LOWER LEVEL LIMITS HAD SAME TYPE,
     C**  USE THIS FOR 1ST PERIOD
     C           LNSAME    IFEQ 'Y'
     C                     MOVEALNPER     XLDAA
     C                     Z-ADDLNLIM     LLAMS
     C                     MOVE LNPC      XLPCA
     C*
     C           LLAMS     DIV  XLPC,1    LLAMS     H
     C*
     C                     EXSR LMTSL
     C                     ELSE
     C**  ELSE SET UP OVERNIGHT PERIOD
     C                     Z-ADD1         XLDA,1
     C           1         ADD  BJRDNB    XLDT,1
     C                     Z-ADD999       XLDA,2
     C                     Z-ADD99999     XLDT,2
     C                     Z-ADDLNLIM     XLLM,1
     C                     MOVE '*'       ASTLS
     C                     END
     C                     ELSE
     C** IF NOT FOUND
     C                     Z-ADD999       XLDA,1
     C                     Z-ADD99999     XLDT,1
     C                     END
     C                     END
      *                                                                   LN0632
      ** If FRA default required, set up system limit                     LN0632
     C           RDEF      IFEQ 'Y'                                       LN0632
     C                     Z-ADDFRLIM     XRLM                            LN0632
     C                     END                                            LN0632
      *                                                                   LN0632
      ** If IRS default required, set up system limit                     LN0632
     C           IDEF      IFEQ 'Y'                                       LN0632
     C                     Z-ADDIRLIM     XILM                            LN0632
     C                     END                                            LN0632
      *                                                                   LN0632
     C                     END
     C**
     C                     ENDSR                                       **
     C**
     C********************************************************************
     C**  LMTSF SR SETS UP LIMIT ARRAYS FOR FX
     C**  INPUT - XFDAA - PERIOD ARRAY
     C**          XFPC - PERCENTAGE ARRAY
     C**          FLAMS - LIMIT AMOUNT
     C**   IF ANY ELEMENT IS BLANK OR 999
     C**   THE CORRESPONDING ELEMENTS IN XFDA & XFDT ARE SET TO NINES.
     C**   ELSE,XFDT IS CALCULATED BY ADDING RUN DATE (BJAKTX) TO XFDA,
     C**        XFLM,IS CALCULATED BY MULTIPLYING LIMIT AMOUNT BY XFPC
     C**
     C           LMTSF     BEGSR                           **  LMTSF **
     C                     Z-ADD0         D       20
     C           XFDAA,1   COMP 'SP '                    71
     C           LMTS1     TAG                             ** LMTS1   **
     C**
     C           D         ADD  1         D
     C********** XFDAA,D   COMP '   '                    88               E309
     C           XFDAA,D   COMP '000'                    88               E309
     C           XFDAA,D   COMP '999'                    87
     C**
     C   88                Z-ADD999       XFDA,D
     C  N88                MOVE XFDAA,D   XFDA,D
     C*
     C**
     C           XFDA,D    ADD  BJRDNB    XFDT,D
     C   88
     COR 87                Z-ADD99999     XFDT,D
     C**
     C  N88      FLAMS     MULT XFPC,D    XFLM,D
     C**
     C           D         COMP 6                      86
     C   86N87N88          GOTO LMTS1
     C   71                Z-ADDSP        XFDA,1
     C   71      SP        ADD  BJRDNB    XFDT,1
     C                     ENDSR
     C**
     C********************************************************************
     C**  LMTSL SR SETS UP LIMIT ARRAYS FOR LN
     C**  INPUT - XLDAA - PERIOD ARRAY
     C**          XLPC - PERCENTAGE ARRAY
     C**          LLAMS - LIMIT AMOUNT
     C**  PROCESSES XLDAA IN THE SAME WAY AS LMTSF
     C           LMTSL     BEGSR                           **  LMTSL **
     C                     Z-ADD0         D
     C           XLDAA,1   COMP 'SP '                    72
     C           LMTS2     TAG                             **  LMTS2   **
     C**
     C           D         ADD  1         D
     C********** XLDAA,D   COMP '   '                    88               E309
     C           XLDAA,D   COMP '000'                    88               E309
     C           XLDAA,D   COMP '999'                    87
     C**
     C   88                Z-ADD999       XLDA,D
     C  N88                MOVE XLDAA,D   XLDA,D
     C*
     C**
     C           XLDA,D    ADD  BJRDNB    XLDT,D
     C   88
     COR 87                Z-ADD99999     XLDT,D
     C**
     C  N88      LLAMS     MULT XLPC,D    XLLM,D
     C**
     C           D         COMP 6                      86
     C   86N87N88          GOTO LMTS2
     C   72                Z-ADDSP        XLDA,1
     C   72      SP        ADD  BJRDNB    XLDT,1
     C                     ENDSR
     C**
     C********************************************************************
     C**   FORMAT & OUTPUT CTY/SYS LIMIT & EXPOSURE   FOR FX
     C**
     C           FXSWRT    BEGSR                           ** FXSWRT **
     C                     SETON                     60
     C                     SETOF                     70
     C**   CALC EXCESS, CHECK FOR ZERO EXPOSURE
     C                     EXSR EXSFS
     C**   IF NOT ZERO, PRINT. IN60 STILL ON IF ZERO
     C           *IN60     IFNE '1'
     C**                                                               ***
     C**   IF U1 NOT ON, PRINT EVEN IF EXPOSURE LESS THAN LIMIT.
     C**    IF U1 ON, ONLY PRINT IF EXPOSURE GREATER THAN LIMIT.
     C           *INU1     IFEQ '0'
     C           *INU1     OREQ '1'
     C           *IN70     ANDEQ'1'
     C**
     C**   PRINT DETAILS
     C                     Z-ADD0         D
     C**
     C           D         DOUEQ6                                      **
     C                     ADD  1         D
     C**   MOVE EXPOSURE AMT. TO 10 DIGIT FIELD
     C                     Z-ADDXFXP,D    FXPOS  100
     C**   PRINT 1ST LINE
     C           D         IFEQ 1
     C**   PRINT CTY IF NOT ALREADY DONE
     C           NAMPRT    IFEQ 'N'
     C                     EXCPTCTYO
     C                     MOVE 'Y'       NAMPRT
     C                     END
     C**
     C  N43                EXCPTDASH1
     C                     EXCPTFXLIN1
     C                     ADD  1         RLIST   50
     C                     ELSE
     C**   PRINT LINES 2-6 IF REQD
     C**   - TEST IF PERIOD END DATE ZERO
     C           XFDT,D    COMP 0                    53    PRINT
     C   53                EXCPTFXLIN2
     C                     END
     C**
     C**   - CALCULATE NEXT START OF PERIOD
     C           XFDA,D    ADD  1         NEXTF   30
     C**
     C                     END
     C  N43                EXCPTDASH2
     C                     END                             *inu1=1
     C                     END
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**   FORMAT & OUTPUT CTY/SYS LIMIT & EXPOSURE   FOR LENDING
     C**
     C           LNSWRT    BEGSR                           ** LNSWRT **
     C                     SETON                     60
     C                     SETOF                     70
     C**   CALC EXCESS, CHECK FOR ZERO EXPOSURE
     C                     EXSR EXSLS
     C**   IF NOT ZERO, PRINT. IN60 STILL ON IF ZERO
     C           *IN60     IFNE '1'
     C**                                                               ***
     C**   IF U1 NOT ON, PRINT EVEN IF EXPOSURE LESS THAN LIMIT.
     C**    IF U1 ON, ONLY PRINT IF EXPOSURE GREATER THAN LIMIT.
     C           *INU1     IFEQ '0'
     C           *INU1     OREQ '1'
     C           *IN70     ANDEQ'1'
     C**
     C**   PRINT DETAILS
     C                     Z-ADD0         D
     C**
     C           D         DOUEQ6                                      **
     C                     ADD  1         D
     C**   MOVE EXPOSURE AMT. TO 10 DIGIT FIELD
     C                     Z-ADDXLXP,D    LXPOS  100
     C**   PRINT 1ST LINE
     C           D         IFEQ 1
     C**   PRINT CTY IF NOT ALREADY DONE
     C           NAMPRT    IFEQ 'N'
     C                     EXCPTCTYO
     C                     MOVE 'Y'       NAMPRT
     C                     END
     C**
     C  N43                EXCPTDASH1
     C                     EXCPTLNLIN1
     C                     ADD  1         RLIST   50
     C                     ELSE
     C**   PRINT LINES 2-6 IF REQD
     C**   - TEST IF PERIOD END DATE ZERO
     C           XLDT,D    COMP 0                    54    PRINT
     C   54                EXCPTLNLIN2
     C                     END
     C**
     C**   - CALCULATE NEXT START OF PERIOD
     C           XLDA,D    ADD  1         NEXTL   30
     C**
     C                     END
     C  N43                EXCPTDASH2
     C                     END                             *inu1=1
     C                     END
     C**
     C                     ENDSR
     C**
     C********************************************************************
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    FRA - FORMAT & OUTPUT CTY/SYS LIMIT & EXPOSURE                *S01157
      *                                                                  *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           FRSWRT    BEGSR                           ** FRSWRT **   S01157
      *                                                                   S01157
     C                     MOVE '1'       *IN60                           S01157
     C                     MOVE '0'       *IN70                           S01157
      *                                                                   S01157
      *  Calculate Excess Exposure, Check for Zero Exposure               S01157
     C                     EXSR EXSRS                                     S01157
      *                                                                   S01157
      *  If Not Zero, PRINT...*IN60 still ON if Zero                      S01157
     C           *IN60     IFNE '1'                                       S01157
      *                                                                   S01157
      *  If U1 NOT on, PRINT even if exposure LESS than Limit.            S01157
      *  If U1 on, only PRINT if exposure GREATER than Limit.             S01157
     C           *INU1     IFEQ '0'                                       S01157
     C           *INU1     OREQ '1'                                       S01157
     C           *IN70     ANDEQ'1'                                       S01157
      *                                                                   S01157
      *  Print Country if not already done.                               S01157
     C           NAMPRT    IFEQ 'N'                                       S01157
     C                     EXCPTCTYO                                      S01157
     C                     MOVE 'Y'       NAMPRT                          S01157
     C                     END                                            S01157
      *                                                                   S01157
      *  Print details.                                                   S01157
     C  N43                EXCPTDASH1                                     S01157
      *                                                                   S01157
     C                     EXCPTSRLIN                                     S01157
      *                                                                   S01157
     C  N43                EXCPTDASH2                                     S01157
      *                                                                   S01157
     C                     ADD  1         RLIST   50                      S01157
      *                                                                   S01157
      ***Initialise*exposure*field.***                             S01157 099251
     C***********          Z-ADD0         RXPOS                    S01157 099251
     C                     END                                            S01157
      *  Initialise exposure field.                                       099251
     C                     Z-ADD0         RXPOS                           099251
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** FRSWRT *** S01157
      *                                                                   S01157
      ********************************************************************S01157
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    IRS - FORMAT & OUTPUT CTY/SYS LIMIT & EXPOSURE                *S01157
      *                                                                  *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           IRSWRT    BEGSR                           ** IRSWRT **   S01157
      *                                                                   S01157
     C                     MOVE '1'       *IN60                           S01157
     C                     MOVE '0'       *IN70                           S01157
      *                                                                   S01157
      *  Calculate Excess Exposure, Check for Zero Exposure               S01157
     C                     EXSR EXSIS                                     S01157
      *                                                                   S01157
      *  If Not Zero, PRINT...*IN60 still ON if Zero                      S01157
     C           *IN60     IFNE '1'                                       S01157
      *                                                                   S01157
      *  If U1 NOT on, PRINT even if exposure LESS than Limit.            S01157
      *  If U1 on, only PRINT if exposure GREATER than Limit.             S01157
     C           *INU1     IFEQ '0'                                       S01157
     C           *INU1     OREQ '1'                                       S01157
     C           *IN70     ANDEQ'1'                                       S01157
      *                                                                   S01157
      *  Print Country if not already done.                               S01157
     C           NAMPRT    IFEQ 'N'                                       S01157
     C                     EXCPTCTYO                                      S01157
     C                     MOVE 'Y'       NAMPRT                          S01157
     C                     END                                            S01157
      *                                                                   S01157
      *  Print details.                                                   S01157
     C  N43                EXCPTDASH1                                     S01157
      *                                                                   S01157
     C                     EXCPTSILIN                                     S01157
      *                                                                   S01157
     C  N43                EXCPTDASH2                                     S01157
      *                                                                   S01157
     C                     ADD  1         RLIST   50                      S01157
      *                                                                   S01157
      ***Initialise*exposure*field.***                             S01157 099251
     C***********          Z-ADD0         IXPOS                    S01157 099251
     C                     END                                            S01157
      *  Initialise exposure field.                                       099251
     C                     Z-ADD0         IXPOS                           099251
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** IRSWRT *** S01157
      *                                                                   S01157
     C********************************************************************S01157
      /EJECT                                                              S01157
     C********************************************************************
     C**   SYSTEM LEVEL LIMITS
     C**   EXSFS  SR. WORKS OUT EXCESS EXPOSURE FOR FX
     C**   -FIRST ROUNDS EXPOSURE FOR EACH PERIOD TO NEAREST 1000 UNITS
     C**   -THEN COMPARES EXPOSURE AMOUNTS TO CORRESP. LIMIT AMOUNTS.
     C           EXSFS     BEGSR                           **  EXSFS   **
     C                     Z-ADD0         D
     C           EXSFS1    TAG                             **  EXSFS1  **
     C           D         ADD  1         D
     C           XFXP,D    DIV  1000      XFXP,D    H
     C   60      XFXP,D    COMP 0                        60
     C           XFXP,D    COMP XFLM,D               89
     C   89      XFXP,D    SUB  XFLM,D    XFXS,D
     C   89                SETON                     70
     C**
     C**   LOOP ROUND AGAIN IF LESS THAN 6 PERIODS HAVE BEEN PROCESSED
     C           D         COMP 6                      89
     C   89                GOTO EXSFS1
     C                     ENDSR
     C**
     C********************************************************************
     C**   SYSTEM LEVEL LIMITS
     C**   EXSLS  SR. WORKS OUT EXCESS EXPOSURE FOR LOANS.
     C           EXSLS     BEGSR                           **  EXSLS **
     C                     Z-ADD0         D
     C           EXSLS1    TAG                             **  EXSLS1  **
     C           D         ADD  1         D
     C           XLXP,D    DIV  1000      XLXP,D    H
     C   60      XLXP,D    COMP 0                        60
     C           XLXP,D    COMP XLLM,D               89
     C   89      XLXP,D    SUB  XLLM,D    XLXS,D
     C   89                SETON                     70
     C**
     C           D         COMP 6                      89
     C   89                GOTO EXSLS1
     C                     ENDSR
     C**
     C********************************************************************
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    EXSRS - CALCULATE FRA EXCESS EXPOSURE                         *S01157
      *          - SYSTEM LEVEL                                          *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           EXSRS     BEGSR                           ** EXSRS **    S01157
      *                                                                   S01157
      ** FRA EVENT                                                        S01157
      ** Convert exposure amount to thousands first                       S01157
     C           RXPOS     DIV  1000      RXPOS     H                     S01157
     C           RXPOS     SUB  XRLM      XRXS                            S01157
     C           XRXS      IFLT 0                                         S01157
     C                     Z-ADD0         XRXS   100                      S01157
     C                     ELSE                                           S01157
     C                     SETON                         70               S01157
     C                     END                                            S01157
      *                                                                   S01157
      ** If exposure is non-zero, then set-off ind 60                     S01157
     C           RXPOS     IFGT 0                                         S01157
     C                     MOVE '0'       *IN60                           S01157
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** EXSRC ***  S01157
      *                                                                   S01157
      ********************************************************************S01157
      /EJECT                                                              S01157
      ********************************************************************S01157
      *                                                                  *S01157
      *    EXSIS - CALCULATE IRS EXCESS EXPOSURE                         *S01157
      *          - SYSTEM LEVEL                                          *S01157
      ********************************************************************S01157
      *                                                                   S01157
     C           EXSIS     BEGSR                           ** EXSIS **    S01157
      *                                                                   S01157
      ** IRS EVENT                                                        S01157
      ** Convert exposure amount to thousands first                       S01157
     C           IXPOS     DIV  1000      IXPOS     H                     S01157
     C           IXPOS     SUB  XILM      XIXS                            S01157
     C           XIXS      IFLT 0                                         S01157
     C                     Z-ADD0         XIXS   100                      S01157
     C                     ELSE                                           S01157
     C                     SETON                         70               S01157
     C                     END                                            S01157
      *                                                                   S01157
      ** If exposure is non-zero, then set-off ind 60                     S01157
     C           IXPOS     IFGT 0                                         S01157
     C                     MOVE '0'       *IN60                           S01157
     C                     END                                            S01157
      *                                                                   S01157
     C                     ENDSR                           *** EXSIS ***  S01157
      *                                                                   S01157
      ********************************************************************S01157
      /EJECT                                                              S01157
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C**
     C**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   P/DL0132 TO GET DEFAULT LIMITS FOR SYSTEM OR COMPANY LEVEL
     C**
     C           DL0132    BEGSR
     C                     Z-ADD0         FXLIM   90
     C                     Z-ADD0         LNLIM   90
     C                     MOVE 'Y'       FXSAME  1
     C                     MOVE 'Y'       LNSAME  1
     C                     MOVE *BLANKS   FXPER  18
     C                     MOVE *BLANKS   LNPER  18
     C                     MOVE *BLANKS   FXPC   18
     C                     MOVE *BLANKS   LNPC   18
     C                     CALL 'DL0132'
     C                     PARM           CCTZ
     C                     PARM           LEVEL
     C                     PARM           ENTITY
     C                     PARM           FDEF
     C                     PARM           LDEF
     C******************   PARM           FRA     1                       S01157
     C******************   PARM           IRS     1                       S01157
     C                     PARM           RDEF    1                       S01157
     C                     PARM           IDEF    1                       S01157
     C                     PARM           FXLIM
     C                     PARM           LNLIM
     C                     PARM           FRLIM   90
     C                     PARM           IRLIM   90
     C                     PARM           FXSAME
     C                     PARM           LNSAME
     C                     PARM           FXPER
     C                     PARM           LNPER
     C                     PARM           FXPC
     C                     PARM           LNPC
     C                     PARM           BJRDNB
     C                     ENDSR
     C********************************************************************
     C/COPY ZSRSRC,ZFWDT                                               ***
     C/COPY ZSRSRC,ZACCH                                               ***
     C********************************************************************
     C**  FIRST CYCLE PROCESS
     C           FIRST     BEGSR                            ** FIRST **
     C                     SETON                     42
     C                     MOVEACPY@      BIS@   80
     C*
     C** OBTAIN BANK DETAILS VIA ACCESS PROGRAM
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBANKPD'DBFILE 10        ************
     C                     MOVEL'01'      DBASE   3        * DBERR 01 *
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
     C*
     C** TEST DATE FORMAT VALUE
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     C*                                                                   S01157
     C** Obtain MODULE details via ACCESS PROGRAM                         S01157
     C                     CALL 'AOMMODR0'                                S01157
     C                     PARM '*MSG   ' @RTCD   7                       S01157
     C                     PARM '*FIRST ' @OPTN   7                       S01157
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01157
     C           @RTCD     IFNE *BLANK                                    S01157
     C                     MOVEL'SDMMODPD'DBFILE 10        ************   S01157
     C                     MOVEL'04'      DBASE   3        * DBERR 04 *   S01157
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01157
     C                     SETON                     U7U8LR               S01157
     C                     EXSR *PSSR                                     S01157
     C                     GOTO END                                       S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C** Check if FRA/IRS module present.                                 S01157
     C           BGFIIN    IFEQ 'Y'                                       S01157
     C                     MOVE '1'       *IN30                           S01157
     C                     END                                            S01157
     C*
     C** READ DEAL DETAILS VIA ACCESS PROGRAM FOR BASE CCY FOR LIMITS
     C**********           CALL 'AODEALR0'                                                    CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C********** SDDEAL    PARM SDDEAL    DSFDY                                               CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDDEALPD'DBFILE           ************
     C                     MOVEL'02'      DBASE            * DBERR 02 *
     C                     MOVEL@OPTN     DBOPTN           ************
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
     C*
     C** READ CCY DETAILS VIA ACCESS PROGRAM FOR DECIMAL PLACES
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BNCYCD    @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVEL'03'      DBASE            * DBERR 03 *
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     MOVEL@AJCD     DBKEY  29
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
     C*
     C*    OBTAIN NO. OF DAYS FORWARD FOR 'SP'
     C                     Z-ADDBJRDNB    ZDAYNO
     C                     MOVE BNCYCD    ZCCY
     C                     Z-ADD2         ZNRDYS
     C                     MOVE BJSLCD    ZLOC
     C                     EXSR ZFWDT
     C           ZDYNBR    SUB  BJRDNB    SP      50
     C**  CHECK FOR PO 1 - BANK (SYS) LIMITS ONLY
     C           @PROD     COMP '1'                      43
     C**  CHECK FOR PO 2 - FOR ALL ENTITIES
     C           @PROD     COMP '2'                      44
     C**  CHECK FOR PO 3 - FOR ONE ENTITY
     C           @PROD     COMP '3'                      50
     C**
     C**  SET RPT HEADING ACCORDING TO PROD OPT.
     C                     MOVE @PROD     @PO     10
     C                     MOVE HDG,@PO   OPTION 22
     C**
     C**  IF PRODUCTION OPTION NOT 1, 2 OR 3 THEN INCORRECT PO
     C  N43N44N50          MOVE HDG,4     OPTION
     C**
     C**  FOR ORIGINATING OR BOOKING BRANCH
     C           @OB       IFEQ 'O'
     C                     MOVE HDG,5     BRANCH 22
     C                     ELSE
     C           @OB       IFEQ 'B'
     C                     MOVE HDG,6     BRANCH
     C                     END
     C                     END
     C**
     C**   SET OF SO THAT FIRST PAGE HEADINGS ARE FETCHED
     C*****                SETON                         OF               E00013
     C**
     C           END       ENDSR
     C*                                                                   CDL002
     C*****************************************************************   CDL002
     C           *INZSR    BEGSR                            ** INZSR **   CDL002
     C*****************************************************************   CDL002
      *                                                                   CDL006
      ** Check if CDL006 is installed                                     CDL006
      *                                                                   CDL006
     C                     MOVE 'N'       CDL006  1                       CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   PRTCD   7                       CDL006
     C                     PARM '*VERIFY' POPTN   7                       CDL006
     C                     PARM 'CDL006'  PSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           PRTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006                          CDL006
     C                     OPEN DEALS                                     CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
     C           PRTCD     IFNE *BLANK                                    CDL006
     C           PRTCD     ANDNE'*NRF   '                                 CDL006
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CDL006
     C                     MOVEL'CDL006'  DBKEY            * DBERR 12 *   CDL006
     C                     MOVEL'12'      DBASE   3        ************   CDL006
     C                     MOVE *ON       *INU7                           CDL006
     C                     MOVE *ON       *INU8                           CDL006
     C                     MOVE *ON       *INLR                           CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     END                                            CDL006
     C*                                                                   CDL002
     C* Get Dealing ICD                                                   CDL002
     C**********           CALL 'AODEALR0'                                CDL002              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           CDL002
     C                     PARM '*FIRST ' @OPTN                           CDL002
     C********** SDDEAL    PARM SDDEAL    DSFDY                           CDL002              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    CDL002
     C                     MOVEL'SDDEALPD'DBFILE           ************   CDL002
     C                     MOVEL'08'      DBASE            * DBERR 08 *   CDL002
     C                     MOVEL@OPTN     DBOPTN           ************   CDL002
     C                     SETON                     U7U8LR               CDL002
     C                     EXSR *PSSR                                     CDL002
     C                     END                                            CDL002
     C*                                                                   CDL002
     C* FX Netting?                                                       CDL002
     C                     CALL 'AOSARDR0'                                CDL002
     C                     PARM *BLANKS   @RTCD                           CDL002
     C                     PARM '*VERIFY' @OPTN                           CDL002
     C                     PARM 'CDL002'  WSARD   6                       CDL002
     C           SCSARD    PARM SCSARD    DSFDY                           CDL002
     C                     MOVE 'N'       CDL002  1                       CDL002
     C           @RTCD     IFEQ *BLANK                                    CDL002
     C                     MOVE 'Y'       CDL002                          CDL002
     C                     CLEARW#NTCE                                    CDL002
     C*                                                                   CDL002
     C* Net FX Customer Exposure?                                         CDL002
     C           BNNTCE    IFEQ 'Y'                                       CDL002
     C                     MOVE BNNTCE    W#NTCE  1                       CDL002
      *                                                                   CDL006
      ** Check first if it is not opened by CDL006.                       CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'N'                                       CDL006
     C                     OPEN DEALS                                     CDL002
     C                     ENDIF                                          CDL006
     C                     OPEN FXNEVTL9                                  CDL002
     C*   Get first parent net event                                      CDL002
     C                     READ FXNEVTL9                 84               CDL002
     C           *IN84     IFEQ *OFF                                      CDL002
     C                     MOVE CCTZ      W1CCTZ                          CDL002
     C                     MOVE CO        W1CO                            CDL002
     C                     MOVE BR        W1BR                            CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C                     ENDSR                                          CDL002
     C*                                                                   CDL002
     C*****************************************************************   CDL002
     C           NEVT1     BEGSR                                          CDL002
     C*****************************************************************   CDL002
      *                                                                   CDL002
     C           W1KEYP    IFLT W2KEYP                                    CDL002
      *                                                                   CDL002
      * Save event fields and indicators                                  CDL002
     C                     MOVELW2EVL     W3SAVE                          CDL002
     C                     MOVE *IN01     WRIN01                          CDL002
      *                                                                   CDL002
      * Get FX Net again                                                  CDL002
     C           K1CCTZ    CHAINFXNEVTL9             84                   CDL002
      *                                                                   CDL002
     C                     MOVELW2KEYP    W4KEYP                          CDL002
      *                                                                   CDL002
     C           W1KEYP    DOWLTW3KEYP                                    CDL002
      *                                                                   CDL002
     C                     MOVELW1KEYP    W2KEYP                          CDL002
     C                     EXSR NEVTP                                     CDL002
     C                     ENDDO                                          CDL002
      *                                                                   CDL002
      * Restore event fields and indicators                               CDL002
     C                     MOVELW3SAVE    W2EVL                           CDL002
     C                     MOVE WRIN01    *IN01                           CDL002
      *                                                                   CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
     C           K1CCTZ    KLIST                                          CDL002
     C                     KFLD           W1CCTZ                          CDL002
     C                     KFLD           W1CO                            CDL002
     C                     KFLD           W1BR                            CDL002
      *                                                                   CDL002
     C           *LIKE     DEFN *IN01     WRIN01                          CDL002
      *                                                                   CDL002
     C                     ENDSR                                          CDL002
     C*                                                                   CDL002
      *****************************************************************   CDL002
      * Process any Net Group Settlement Customers after last customer*   CDL002
      * with events                                                   *   CDL002
      *****************************************************************   CDL002
     C           NEVTLR    BEGSR                                      *   CDL002
      *****************************************************************   CDL002
      *                                                                   CDL002
     C           *IN84     DOWEQ*OFF                                      CDL002
      *                                                                   CDL002
      * Get FX Net again                                                  CDL002
     C           K1CCTZ    CHAINFXNEVTL9             84                   CDL002
     C                     EXSR NEVTP                                     CDL002
     C*                                                                   CDL002
     C                     ENDDO                                          CDL002
      *                                                                   CDL002
     C                     ENDSR                                          CDL002
     C*                                                                   CDL002
     C*****************************************************************   CDL002
      * Process net group settlement customer.                        *   CDL002
      *****************************************************************   CDL002
     C           NEVTP     BEGSR                                      *   CDL002
      *****************************************************************   CDL002
     C*                                                                   CDL002
     C** Get Country Limits for Branch                                    CDL002
     C                     CALL 'AOCNLMR0'                                CDL002
     C                     PARM *BLANKS   @RTCD                           CDL002
     C                     PARM '*KEY    '@OPTN                           CDL002
     C                     PARM CCTZ      @CCTZ   2                       CDL002
     C                     PARM 'B'       WWLEV   1                       CDL002
     C                     PARM BR        WWENT   3                       CDL002
     C           SDCNLM    PARM SDCNLM    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVE DXFXLT    FLTYB                           CDL002
     C                     MOVE DXFLED    FLEDB                           CDL002
     C                     MOVE DXFLAM    FLAMB                           CDL002
     C                     MOVE DXLLTY    LLTYB                           CDL002
     C                     MOVE DXLLED    LLEDB                           CDL002
     C                     MOVE DXLLAM    LLAMB                           CDL002
     C                     MOVE DXFRLA    RLAMB                           CDL002
     C                     MOVE DXFRED    RLEDB                           CDL002
     C                     MOVE DXIRLM    ILAMB                           CDL002
     C                     MOVE DXIRED    ILEDB                           CDL002
      *                                                                   CDL002
      * Get FX Limits                                                     CDL002
     C                     CALL 'AOLIMTR0'                                CDL002
     C                     PARM *BLANKS   @RTCD                           CDL002
     C                     PARM '*KEY    '@OPTN                           CDL002
     C                     PARM DXFXLT    WWLTYP  3                       CDL002
     C           SDLIMT    PARM SDLIMT    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVE A2E1LP    FLEP1B                          CDL002
     C                     MOVE A2E2LP    FLEP2B                          CDL002
     C                     MOVE A2E3LP    FLEP3B                          CDL002
     C                     MOVE A2E4LP    FLEP4B                          CDL002
     C                     MOVE A2E5LP    FLEP5B                          CDL002
     C                     MOVE A2E6LP    FLEP6B                          CDL002
     C                     MOVE A2PL1P    FLPC1B                          CDL002
     C                     MOVE A2PL2P    FLPC2B                          CDL002
     C                     MOVE A2PL3P    FLPC3B                          CDL002
     C                     MOVE A2PL4P    FLPC4B                          CDL002
     C                     MOVE A2PL5P    FLPC5B                          CDL002
     C                     MOVE A2PL6P    FLPC6B                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
      * Get Lending Limits                                                CDL002
     C                     CALL 'AOLIMTR0'                                CDL002
     C                     PARM '*MSG    '@RTCD                           CDL002
     C                     PARM '*KEY    '@OPTN                           CDL002
     C                     PARM DXLLTY    WWLTYP  3                       CDL002
     C           SDLIMT    PARM SDLIMT    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVE A2E1LP    LLEP1B                          CDL002
     C                     MOVE A2E2LP    LLEP2B                          CDL002
     C                     MOVE A2E3LP    LLEP3B                          CDL002
     C                     MOVE A2E4LP    LLEP4B                          CDL002
     C                     MOVE A2E5LP    LLEP5B                          CDL002
     C                     MOVE A2E6LP    LLEP6B                          CDL002
     C                     MOVE A2PL1P    LLPC1B                          CDL002
     C                     MOVE A2PL2P    LLPC2B                          CDL002
     C                     MOVE A2PL3P    LLPC3B                          CDL002
     C                     MOVE A2PL4P    LLPC4B                          CDL002
     C                     MOVE A2PL5P    LLPC5B                          CDL002
     C                     MOVE A2PL6P    LLPC6B                          CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
      * Get Country Limits for Company                                    CDL002
     C                     CALL 'AOCNLMR0'                                CDL002
     C                     PARM *BLANKS   @RTCD                           CDL002
     C                     PARM '*KEY    '@OPTN                           CDL002
     C                     PARM CCTZ      @CCTZ   2                       CDL002
     C                     PARM 'C'       WWLEV   1                       CDL002
     C                     PARM CO        WWENT   3                       CDL002
     C           SDCNLM    PARM SDCNLM    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVE DXFXLT    FLTYC                           CDL002
     C                     MOVE DXFLED    FLEDC                           CDL002
     C                     MOVE DXFLAM    FLAMC                           CDL002
     C                     MOVE DXLLTY    LLTYC                           CDL002
     C                     MOVE DXLLED    LLEDC                           CDL002
     C                     MOVE DXLLAM    LLAMC                           CDL002
     C                     MOVE DXFRLA    RLAMC                           CDL002
     C                     MOVE DXFRED    RLEDC                           CDL002
     C                     MOVE DXIRLM    ILAMC                           CDL002
     C                     MOVE DXIRED    ILEDC                           CDL002
      *                                                                   CDL002
      * Get FX Limits                                                     CDL002
     C                     CALL 'AOLIMTR0'                                CDL002
     C                     PARM *BLANKS   @RTCD                           CDL002
     C                     PARM '*KEY    '@OPTN                           CDL002
     C                     PARM DXFXLT    WWLTYP  3                       CDL002
     C           SDLIMT    PARM SDLIMT    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVE A2E1LP    FLEP1C                          CDL002
     C                     MOVE A2E2LP    FLEP2C                          CDL002
     C                     MOVE A2E3LP    FLEP3C                          CDL002
     C                     MOVE A2E4LP    FLEP4C                          CDL002
     C                     MOVE A2E5LP    FLEP5C                          CDL002
     C                     MOVE A2E6LP    FLEP6C                          CDL002
     C                     MOVE A2PL1P    FLPC1C                          CDL002
     C                     MOVE A2PL2P    FLPC2C                          CDL002
     C                     MOVE A2PL3P    FLPC3C                          CDL002
     C                     MOVE A2PL4P    FLPC4C                          CDL002
     C                     MOVE A2PL5P    FLPC5C                          CDL002
     C                     MOVE A2PL6P    FLPC6C                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
      * Get Lending Limits                                                CDL002
     C                     CALL 'AOLIMTR0'                                CDL002
     C                     PARM '*MSG    '@RTCD                           CDL002
     C                     PARM '*KEY    '@OPTN                           CDL002
     C                     PARM DXLLTY    WWLTYP  3                       CDL002
     C           SDLIMT    PARM SDLIMT    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVE A2E1LP    LLEP1C                          CDL002
     C                     MOVE A2E2LP    LLEP2C                          CDL002
     C                     MOVE A2E3LP    LLEP3C                          CDL002
     C                     MOVE A2E4LP    LLEP4C                          CDL002
     C                     MOVE A2E5LP    LLEP5C                          CDL002
     C                     MOVE A2E6LP    LLEP6C                          CDL002
     C                     MOVE A2PL1P    LLPC1C                          CDL002
     C                     MOVE A2PL2P    LLPC2C                          CDL002
     C                     MOVE A2PL3P    LLPC3C                          CDL002
     C                     MOVE A2PL4P    LLPC4C                          CDL002
     C                     MOVE A2PL5P    LLPC5C                          CDL002
     C                     MOVE A2PL6P    LLPC6C                          CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
      * Get Country Limits for System                                     CDL002
     C                     CALL 'AOCNLMR0'                                CDL002
     C                     PARM *BLANKS   @RTCD                           CDL002
     C                     PARM '*KEY    '@OPTN                           CDL002
     C                     PARM CCTZ      @CCTZ   2                       CDL002
     C                     PARM 'S'       WWLEV   1                       CDL002
     C                     PARM 'SYS'     WWENT   3                       CDL002
     C           SDCNLM    PARM SDCNLM    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVE DXFXLT    FLTYS                           CDL002
     C                     MOVE DXFLED    FLEDS                           CDL002
     C                     MOVE DXFLAM    FLAMS                           CDL002
     C                     MOVE DXLLTY    LLTYS                           CDL002
     C                     MOVE DXLLED    LLEDS                           CDL002
     C                     MOVE DXLLAM    LLAMS                           CDL002
     C                     MOVE DXFRLA    RLAMS                           CDL002
     C                     MOVE DXFRED    RLEDS                           CDL002
     C                     MOVE DXIRLM    ILAMS                           CDL002
     C                     MOVE DXIRED    ILEDS                           CDL002
      *                                                                   CDL002
      * Get FX Limits                                                     CDL002
     C                     CALL 'AOLIMTR0'                                CDL002
     C                     PARM *BLANKS   @RTCD                           CDL002
     C                     PARM '*KEY    '@OPTN                           CDL002
     C                     PARM DXFXLT    WWLTYP  3                       CDL002
     C           SDLIMT    PARM SDLIMT    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVE A2E1LP    FLEP1S                          CDL002
     C                     MOVE A2E2LP    FLEP2S                          CDL002
     C                     MOVE A2E3LP    FLEP3S                          CDL002
     C                     MOVE A2E4LP    FLEP4S                          CDL002
     C                     MOVE A2E5LP    FLEP5S                          CDL002
     C                     MOVE A2E6LP    FLEP6S                          CDL002
     C                     MOVE A2PL1P    FLPC1S                          CDL002
     C                     MOVE A2PL2P    FLPC2S                          CDL002
     C                     MOVE A2PL3P    FLPC3S                          CDL002
     C                     MOVE A2PL4P    FLPC4S                          CDL002
     C                     MOVE A2PL5P    FLPC5S                          CDL002
     C                     MOVE A2PL6P    FLPC6S                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
      * Get Lending Limits                                                CDL002
     C                     CALL 'AOLIMTR0'                                CDL002
     C                     PARM '*MSG    '@RTCD                           CDL002
     C                     PARM '*KEY    '@OPTN                           CDL002
     C                     PARM DXLLTY    WWLTYP  3                       CDL002
     C           SDLIMT    PARM SDLIMT    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVE A2E1LP    LLEP1S                          CDL002
     C                     MOVE A2E2LP    LLEP2S                          CDL002
     C                     MOVE A2E3LP    LLEP3S                          CDL002
     C                     MOVE A2E4LP    LLEP4S                          CDL002
     C                     MOVE A2E5LP    LLEP5S                          CDL002
     C                     MOVE A2E6LP    LLEP6S                          CDL002
     C                     MOVE A2PL1P    LLPC1S                          CDL002
     C                     MOVE A2PL2P    LLPC2S                          CDL002
     C                     MOVE A2PL3P    LLPC3S                          CDL002
     C                     MOVE A2PL4P    LLPC4S                          CDL002
     C                     MOVE A2PL5P    LLPC5S                          CDL002
     C                     MOVE A2PL6P    LLPC6S                          CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
     C                     EXSR LMTS                                      CDL002
     C*                                                                   CDL002
     C                     MOVE 'N'       NAMPRT  1                       CDL002
     C*                                                                   CDL002
     C           *IN43     IFEQ *OFF                                      CDL002
     C                     EXSR LMTC                                      CDL002
     C                     EXSR LMTB                                      CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
     C                     EXSR NEVTD                                     CDL002
      *                                                                   CDL002
     C           *IN42     IFEQ *ON                                       CDL002
     C           *IN48     ANDEQ*OFF                                      CDL002
      *                                                                   CDL002
     C           *IN43     IFEQ *OFF                                      CDL002
     C                     EXSR FXBWRT                                    CDL002
     C                     EXSR LNBWRT                                    CDL002
     C           *IN30     IFEQ *ON                                       CDL002
     C                     EXSR FRBWRT                                    CDL002
     C                     EXSR IRBWRT                                    CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
     C                     EXSR FXCWRT                                    CDL002
     C                     EXSR LNCWRT                                    CDL002
     C           *IN30     IFEQ *ON                                       CDL002
     C                     EXSR FRCWRT                                    CDL002
     C                     EXSR IRCWRT                                    CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
     C                     EXSR FXSWRT                                    CDL002
     C                     EXSR LNSWRT                                    CDL002
     C           *IN30     IFEQ *ON                                       CDL002
     C                     EXSR FRSWRT                                    CDL002
     C                     EXSR IRSWRT                                    CDL002
     C                     ENDIF                                          CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
     C                     ENDSR                                          CDL002
      *                                                                   CDL002
      *****************************************************************   CDL002
      * Process all net events for this customer                      *   CDL002
      *****************************************************************   CDL002
     C           NEVTD     BEGSR                                      *   CDL002
      *****************************************************************   CDL002
      *                                                                   CDL002
      * Any net events for this parent/customer?                          CDL002
     C           W2KEYP    IFEQ W1KEYP                                    CDL002
      *                                                                   CDL002
      * Get FX Net again                                                  CDL002
     C           K1CCTZ    CHAINFXNEVTL9             84                   CDL002
      *                                                                   CDL002
      * Process all net events for this parent/customer                   CDL002
     C           W2KEYP    DOWEQW1KEYP                                    CDL002
     C           *IN84     ANDEQ*OFF                                      CDL002
      *                                                                   CDL002
      * Incoming only                                                     CDL002
     C           INOI      IFEQ 'I'                                       CDL002
     C                     Z-ADDEDAT      DLVALU                          CDL002
     C           A6NBDP    ADD  1         DEP                             CDL002
     C           LCEQ      DIV  FCT,DEP   DLAMTF                          CDL002
     C           *IN43     IFEQ *OFF                                      CDL002
     C                     EXSR EXPFB                                     CDL002
     C                     EXSR EXPFC                                     CDL002
     C                     ENDIF                                          CDL002
     C                     EXSR EXPFS                                     CDL002
     C                     ADD  1         RREAD                           CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C* Save current rec                                                  CDL002
     C                     MOVELW2EVL     W4SAVE    P                     CDL002
      *                                                                   CDL002
      * Get Country Net Events                                            CDL002
     C                     READ FXNEVTL9                 84               CDL002
      *                                                                   CDL002
     C                     ENDDO                                          CDL002
     C*                                                                   CDL002
     C           *IN84     IFEQ *OFF                                      CDL002
     C                     MOVE CCTZ      W1CCTZ                          CDL002
     C                     MOVE CO        W1CO                            CDL002
     C                     MOVE BR        W1BR                            CDL002
     C                     ELSE                                           CDL002
     C                     MOVE *HIVAL    W1CCTZ                          CDL002
     C                     MOVE *HIVAL    W1CO                            CDL002
     C                     MOVE *HIVAL    W1BR                            CDL002
     C                     ENDIF                                          CDL002
     C*                                                                   CDL002
     C* Restore Current rec                                               CDL002
     C                     MOVELW4SAVE    W2EVL                           CDL002
     C*                                                                   CDL002
     C                     ENDIF                                          CDL002
      *                                                                   CDL002
     C                     ENDSR                                          CDL002
      *                                                                   CDL002
     C********************************************************************
     C           *PSSR     BEGSR
     C*
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
      *                                                                   CDL002
     C                     SETON                     U7U8LR               CDL002
     C                     RETRN                                          CDL002
     C*
     C                     ENDSR
     C********************************************************************S01157
      /EJECT                                                              S01157
     C********************************************************************
     C*
     C* SUBROUTINE : #ZZ
     C*
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF
     C* NO RECORDS READ AND THEREFORE SDBANKPD NOT READ
     C*
     C           #ZZ       BEGSR
     C*
     C** IF FIRST CYCLE NOT PERFORMED GET BANK DETAILS FOR HEADINGS
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBANKPD'DBFILE           ************
     C                     MOVEL'04'      DBASE            * DBERR 04 *
     C                     MOVEL@OPTN     DBOPTN           ************
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO #ZZ9
     C                     END
     C*
     C** READ DEAL DETAILS VIA ACCESS PROGRAM FOR BASE CCY FOR LIMITS
     C**********           CALL 'AODEALR0'                                                    CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C********** SDDEAL    PARM SDDEAL    DSFDY                                               CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDDEALPD'DBFILE           ************
     C                     MOVEL'10'      DBASE            * DBERR 10 *
     C                     MOVEL@OPTN     DBOPTN           ************
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO #ZZ9
     C                     END
     C*                                                                   E305
     C**  FOR ORIGINATING OR BOOKING BRANCH                               E305
     C           @OB       IFEQ 'O'                                       E305
     C                     MOVE HDG,5     BRANCH 22                       E305
     C                     END                                            E305
     C*                                                                   E305
     C           @OB       IFEQ 'B'                                       E305
     C           @OB       OREQ ' '                                       E305
     C                     MOVE HDG,6     BRANCH                          E305
     C                     END                                            E305
     C*                                                                   E305
     C           #ZZ9      ENDSR
     C********************************************************************S01157
      /EJECT                                                              S01157
     C*****************************************************************
     O**DL0782P1H***03***OF                                               E257
     O**DL0781P1H***03***OF                                          E257 LN0746
     ODL0782P1H   03   OF                                                 LN0746
     O       OR   03   40                                                 E150
     O                                   22 'REFERENCE DL0782P1'
     O                         BJURPT    89
     O                                  122 'DATE              PAGE'
     O                         BJMRDT   112
     O                         PAGE  Z  127
     O        H 2      OFNU1
     O       OR 2      40NU1                                              E150
     O                                   43 'COUNTRY'
     O                                   68 'EXPOSURE AGAINST LIMITS '
     O                                   77 'IN 000''S '
     O                         BNCYCD    80
     O                                   82 '-'
     O                         OPTION   106
     O                         CCTZA    113
     O        H 2      OF U1
     O       OR 2      40 U1                                              E150
     O                                   53 'COUNTRY EXCEPTION'
     O                                   78 'EXPOSURE AGAINST LIMITS '
     O                                   87 'IN 000''S '
     O                         BNCYCD    90
     O                                   92 '-'
     O                         OPTION   116
     O                         CCTZA    123
     O        H 1      OFNU1
     O       OR 1      40NU1                                              E150
     O                                   44 '--------'
     O                                   68 '------------------------'
     O                                   80 '------------'
     O                         BRANCH   106
     O        H 1      OF U1
     O       OR 1      40 U1                                              E150
     O                                   54 '------------------'
     O                                   78 '------------------------'
     O                                   90 '------------'
     O                         BRANCH   116
     O        H 21     OF
     O       OR 21     40                                                 E150
     O                                   16 'COUNTRY NAME'
     O                                   82 'PERIOD'
     O                                   96 'LIMIT'
     O                                  125 'EXPOSURE         EXCESS'
     O**
     O        EF 1             DASH1
     O                                   54 '-----------------------'
     O                                   78 '------------------------'
     O                                  102 '------------------------'
     O                                  126 '------------------------'
     O                                  129 '---'
     O        E  1             DASH2
     O                                   54 '-----------------------'
     O                                   78 '------------------------'
     O                                  102 '------------------------'
     O                                  126 '------------------------'
     O                                  129 '---'
     O**  COUNTRY HEADING
     O        EF21             CTYO
     O                         CCTZ       6
     O                         A4CNNM    37
     O        E  1             CTYO
     O                                   24 '--------------------'
     O                                   37 '-------------'
     O**
     O**  SYSTEM LIMIT - LINE 1 - FX
     O        EF 1             FXLIN1
     O                                    7 'BK.LIM.'
     O                         FDESCS    45
     O                                   63 'FOREIGN EXCHANGE'
     O                                   79 '001-'
     O                         XFDA,1    82
     O                    71             80 ' SPOT  '
     O                         XFLM,11   96
     O                         FXPOS 1  110
     O                         XFXS,11  125
     O**
     O**  SYSTEM LIMIT - LINES 2-6   - FX
     O        E  1             FXLIN2
     O                       53NEXTF     78
     O                       53          79 '-'
     O                       53XFDA,D    82
     O                       53XFLM,D1   96
     O                       53ASTFC     97
     O                       53FXPOS 1  110
     O                       53XFXS,D1  125
     O**
     O**  SYSTEM LIMIT - LINE 1 - LENDING
     O        EF 1             LNLIN1
     O                                    7 'BK.LIM.'
     O                         LDESCS    45
     O                                   54 'LENDING'
     O                                   79 '001-'
     O                         XLDA,1    82
     O                    72             80 ' SPOT  '
     O                         XLLM,11   96
     O                         LXPOS 1  110
     O                         XLXS,11  125
     O**
     O**  SYSTEM LIMIT - LINES 2-6   - LENDING
     O        E  1             LNLIN2
     O                       54NEXTL     78
     O                       54          79 '-'
     O                       54XLDA,D    82
     O                       54XLLM,D1   96
     O                       54ASTLC     97
     O                       54LXPOS 1  110
     O                       54XLXS,D1  125
     O*                                                                   S01157
     O*   SYSTEM LIMIT - FRA                                              S01157
     O*                                                                   S01157
     O        EF 1             SRLIN                                      S01157
     O                                    7 'BK.LIM.'                     S01157
     O                         RDESCS    45                               S01157
     O                                   69 'FORWARD RATE AGREEMENT'      S01157
     O                         XRLM  1   96                               S01157
     O                         RXPOS 1  110                               S01157
     O                         XRXS  1  125                               S01157
     O*                                                                   S01157
     O*                                                                   S01157
     O*   SYSTEM LIMIT - IRS                                              S01157
     O*                                                                   S01157
     O        EF 1             SILIN                                      S01157
     O                                    7 'BK.LIM.'                     S01157
     O                         IDESCS    45                               S01157
     O                                   66 'INTEREST RATE SWAPS'         S01157
     O                         XILM  1   96                               S01157
     O                         IXPOS 1  110                               S01157
     O                         XIXS  1  125                               S01157
     O*                                                                   S01157
      /EJECT                                                              S01157
     O**
     O**  COMPANY LIMIT - LINE 1  FOR FX
     O        EF 1             CFLIN1
     O                                    3 'CO-'
     O                         CO         6
     O                         FDESCC    45
     O                                   63 'FOREIGN EXCHANGE'
     O                                   79 '001-'
     O                         CFDA,1    82
     O                    73             80 ' SPOT  '
     O                         CFLM,11   96
     O                         FXPOS 1  110
     O                         CFXS,11  125
     O**
     O**  COMPANY LIMIT - LINES 2-6  FOR FX
     O        E  1             CFLIN2
     O                       53NEXTF     78
     O                       53          79 '-'
     O                       53CFDA,D    82
     O                       53CFLM,D1   96
     O                       53ASTFS  B  97
     O                       53FXPOS 1  110
     O                       53CFXS,D1  125
     O**
     O**  COMPANY LIMIT - LINE 1  FOR LENDING
     O        EF 1             CLLIN1
     O                                    3 'CO-'
     O                         CO         6
     O                         LDESCC    45
     O                                   54 'LENDING'
     O                                   79 '001-'
     O                         CLDA,1    82
     O                    74             80 ' SPOT  '
     O                         CLLM,11   96
     O                         LXPOS 1  110
     O                         CLXS,11  125
     O**
     O**  COMPANY LIMIT - LINES 2-6  FOR LENDING
     O        E  1             CLLIN2
     O                       54NEXTL     78
     O                       54          79 '-'
     O                       54CLDA,D    82
     O                       54CLLM,D1   96
     O                       54ASTLS  B  97
     O                       54LXPOS 1  110
     O                       54CLXS,D1  125
     O*                                                                   S01157
     O*   COMPANY LIMIT - FRA                                             S01157
     O*                                                                   S01157
     O        EF 1             CRLIN                                      S01157
     O                                    3 'CO-'                         S01157
     O                         CO         6                               S01157
     O                         RDESCC    45                               S01157
     O                                   69 'FORWARD RATE AGREEMENT'      S01157
     O                         CRLM  1   96                               S01157
     O                         RCPOS 1  110                               S01157
     O                         CRXS  1  125                               S01157
     O*                                                                   S01157
     O*                                                                   S01157
     O*   COMPANY LIMIT - IRS                                             S01157
     O*                                                                   S01157
     O        EF 1             CILIN                                      S01157
     O                                    3 'CO-'                         S01157
     O                         CO         6                               S01157
     O                         IDESCC    45                               S01157
     O                                   66 'INTEREST RATE SWAPS'         S01157
     O                         CILM  1   96                               S01157
     O                         ICPOS 1  110                               S01157
     O                         CIXS  1  125                               S01157
     O*                                                                   S01157
      /EJECT                                                              S01157
     O**
     O**  BRANCH LIMIT - LINE 1 FOR FX
     O        EF 1             BFLIN1
     O                                    3 'BR-'
     O                         BR         6
     O                         FDESCB    45
     O                                   63 'FOREIGN EXCHANGE'
     O                                   79 '001-'
     O                         BFDA,1    82
     O                    75             80 ' SPOT  '
     O                         BFLM,11   96
     O                         FXPOS 1  110
     O                         BFXS,11  125
     O**
     O**  BRANCH LIMIT - LINES 2-6  FOR FX
     O        E  1             BFLIN2
     O                       53NEXTF     78
     O                       53          79 '-'
     O                       53BFDA,D    82
     O                       53BFLM,D1   96
     O                       53FXPOS 1  110
     O                       53BFXS,D1  125
     O**
     O**  BRANCH LIMIT - LINE 1   FOR LENDING
     O        EF 1             BLLIN1
     O                                    3 'BR-'
     O                         BR         6
     O                         LDESCB    45
     O                                   54 'LENDING'
     O                                   79 '001-'
     O                         BLDA,1    82
     O                    76             80 ' SPOT  '
     O                         BLLM,11   96
     O                         LXPOS 1  110
     O                         BLXS,11  125
     O**
     O**  BRANCH LIMIT - LINES 2-6   FOR LENDING
     O        E  1             BLLIN2
     O                       54NEXTL     78
     O                       54          79 '-'
     O                       54BLDA,D    82
     O                       54BLLM,D1   96
     O                       54LXPOS 1  110
     O                       54BLXS,D1  125
     O*                                                                   S01157
     O*   BRANCH LIMIT - FRA                                              S01157
     O*                                                                   S01157
     O        EF 1             BRLIN                                      S01157
     O                                    3 'BR-'                         S01157
     O                         BR         6                               S01157
     O                         RDESCB    45                               S01157
     O                                   69 'FORWARD RATE AGREEMENT'      S01157
     O                         BRLM  1   96                               S01157
     O                         RBPOS 1  110                               S01157
     O                         BRXS  1  125                               S01157
     O*                                                                   S01157
     O*                                                                   S01157
     O*   BRANCH LIMIT - IRS                                              S01157
     O*                                                                   S01157
     O        EF 1             BILIN                                      S01157
     O                                    3 'BR-'                         S01157
     O                         BR         6                               S01157
     O                         IDESCB    45                               S01157
     O                                   66 'INTEREST RATE SWAPS'         S01157
     O                         BILM  1   96                               S01157
     O                         IBPOS 1  110                               S01157
     O                         BIXS  1  125                               S01157
     O*                                                                   S01157
     O        T 3      LRN41
     O                                   66 '*** END OF REPORT FOR'
     O                 43                77 ' SYSTEM ***'
     O****************N43                79 ' CUSTOMER ***'                 E262
     O                N43                78 ' COUNTRY ***'                  E262
     O*********        43                66 '*** END OF SYSTEM '
     O*********       N43                66 '*** END OF COUNTRY '
     O*********                          76 'REPORT ***'
     O**
     O**DL0782AUT***03***LR                                                 E257
     O**DL0781AUT***03***LR                                          E257 LN0746
     ODL0782AUT   03   LR                                                 LN0746
     O                                   24 'REFERENCE DL0782AU'
     O                         BJURPT    89
     O                                  122 'DATE              PAGE'
     O                         BJMRDT   112
     O                         PAGE1 Z  127
     O        T 2      LRNU1
     O                                   43 'COUNTRY'
     O                                   68 'EXPOSURE AGAINST LIMITS '
     O                                   77 'IN 000''S '
     O                         BNCYCD    80
     O                                   82 '-'
     O                                   95 'RUN CONTROLS'
     O        T 2      LR U1
     O                                   53 'COUNTRY EXCEPTION'
     O                                   78 'EXPOSURE AGAINST LIMITS '
     O                                   87 'IN 000''S '
     O                         BNCYCD    90
     O                                   92 '-'
     O                                  105 'RUN CONTROLS'
     O        T 1      LRNU1
     O                                   44 '--------'
     O                                   68 '------------------------'
     O                                   83 '---------------'
     O                                   95 '------------'
     O        T 1      LR U1
     O                                   54 '------------------'
     O                                   78 '------------------------'
     O                                   93 '---------------'
     O                                  105 '------------'
     O****    T   22   LR 41NU7                                           E00013
     O*****   T   22   LR 41N25                                    E00013 E99
     O*****  AND      NU7                                          E00013 E99
     O*****                              63 '***   NO DETAILS TO REPO'    E99
     O*****                              71 'RT   ***'                    E99
     O*****   T 2      LR                                                 E99
     O        T 2 22   LR                                                 E99
     O                                   59 'NUMBER'
     O        T 2      LR
     O                                   28 'RECORDS READ IN THIS'
     O                                   35 ' REPORT'
     O                         RREAD 3   59
     O        T 2      LR
     O                                   29 'LIMITS/EXPOSURES REPO'
     O                                   33 'RTED'
     O                         RLIST 3   59
     O        T 2      LR 41N25                                           E99
     O       AND      NU7                                                 E99
     O                                   63 '***   NO DETAILS TO REPO'    E99
     O                                   71 'RT   ***'                    E99
     O        T 3      LR 41N25                                           E305
     O       AND      NU7                                                 E305
1004 O                                   62 '***   AGAINST SYSTEM LIM'    E305
1005 O                                   72 'ITS    ***'                  E305
     O        T 1      LR 41N25                                           E305
     O       AND      NU7                                                 E305
1004 O                                   39 '***'                         E305
1005 O                         BRANCH    65                               E305
1005 O                                   73 '***'                         E305
     O        T 3      LR U7 U8
     O                                   71 '*** PRINT TERMINATED ***'
     O        T 1      LR U7 U8
     O                                   57 'DATABASE ERROR'
     O                         DBASE     61
     O                                   67 'FILE'
     O                         DBFILE    78
     O        T 13     LR U7 U8
     O                                   49 'OPTION'
     O                         DBOPTN    57
     O                                   66 'KEY'
     O                         DBKEY     96
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   FCT - CONVERSION FACTORS
0001
0010
0100
1000
**   HEAD - REPORT HEADINGS, FOR PRODUCTION OPTION & ORIGIN./BOOKING BR
AGAINST BANK LIMITS
ALL COUNTRIES
ONE COUNTRY
INCORRECT P.O.
FOR ORIGINATING BRANCH
FOR BOOKING BRANCH
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
