     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Full/excptn rept-prod op prompt')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module
     F*                                                               *
     F*   DL0806P - FULL/EXCEPTION EXPOSURE REPORT                    *
     F*               (PRODUCTION OPTION PROMPT)                      *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*   LAST AMEND NO. E36223            DATE 30APR92               *
     F*   PREV AMEND NO. LN0774            DATE 21SEP90               *
     F*                  E245              DATE 7MAR90                *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*   E36223 - PARAMETER SHOULD BE CORRECTLY DISPLAYED            *
     F*   LN0774 - TIDYING UP DISPLAY FILE                            *
     F*   E245 - ADD DELETE PROCESSING & RACT, RCMD PARMS             *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*
     FDL0806DFCF  E                    WORKSTN
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*       03         F3 TAKEN ON DISPLAY FILE                         E245
     F*       10         F10 TAKEN ON DISPLAY FILE                        E245
     F*       12         F12 TAKEN ON DISPLAY FILE                        E245
     F*                                                                   E245
     F******* 10      VALID FIELD ENTRY                                   E245
     F*       20      SETS ON ERROR MESSAGE
     F*
     F*****************************************************************
     E                    CPY@    1   1 80
     F*****************************************************************
     E/EJECT
     I*
     IPSDS       SDS
     I*    HOLDS WORKSTATION AND USER ID
     I                                      244 246 WSID
     I                                      254 263 USER
     I*
     I@PARM       DS                            100
     I* PARAMETER FOR FULL OR EXCEPTION REPORTING
     I                                        1   1 @PROD
     IRUNDT       DS                             13                       LN0774
     I                                        1   7 SRUNA                 LN0774
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           LN0774
     C                     IN   RUNDT                                     LN0774
     C**
     C** RECEIVE STANDARD PARAMETERS
     C**
     C           *ENTRY    PLIST
     C                     PARM           @RSEQ   5
     C                     PARM           @RLEV   1
     C                     PARM           @RENT   3
     C                     PARM           @PARM
     C******               PARM           @ACTN   1                       E245
     C                     PARM           @RACT   1                       E245
     C                     PARM           @RCMD   1                       E245
     C**
     C**   INITIALISE SCREEN FIELDS
     C*                                                                   E245
     C**  ACTION CODES E,D DO NOT ALLOW INPUT TO SCREEN FIELDS            E245
     C**  ACTION CODES D ALLOW F10                                        E245
     C           @RACT     IFEQ 'D'                                       E245
     C           @RACT     OREQ 'E'                                       E245
     C           @RACT     OREQ 'A'                                       E36223
     C**********           MOVEL@PARM     @EXPS                      E245 E36223
     C                     MOVEL@PARM     @PROD                      E245 E36223
     C           @PROD     IFEQ 'N'                                       E36223
     C                     MOVE '1'       @EXPS                           E36223
     C                     ELSE                                           E36223
     C                     MOVE '2'       @EXPS                           E36223
     C                     END                                            E36223
     C           @RACT     IFEQ 'D'                                       E36223
     C           @RACT     OREQ 'E'                                       E36223
     C           @RACT     COMP 'D'                      30               E245
     C                     SETON                         40               E245
     C                     END                                            E245
     C                     END                                            E36223
     C**
     C**   DISPLAY FOOTER
     C                     WRITEDL806PD0
     C**
     C**   (LOOP UNTIL EITHER A COMMAND KEY HIT OR VALID SCREEN FIELDS
     C**    ENTERED)
     C**
     C           *IN12     DOUEQ'1'
     C           *IN03     OREQ '1'
     C           *IN10     OREQ '1'                                       E245
     C**
     C                     EXFMTDL806PS0
     C**
     C**   IF CMD/3 IS PRESSED, RETURN TO CALLING PROGRAM
     C**
     C           *IN03     IFEQ '1'
     C************         MOVE 'E'       @ACTN                           E245
     C                     MOVE 'E'       @RCMD                           E245
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C**
     C           *IN12     IFEQ '1'
     C************         MOVE 'F'       @ACTN                           E245
     C                     MOVE 'F'       @RCMD                           E245
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C*                                                                   E245
     C**   IF F10 IS PRESSED, RETURN TO CALLING PROGRAM                   E245
     C           *IN10     IFEQ '1'                                       E245
     C                     MOVE 'D'       @RCMD                           E245
     C                     SETON                     LR                   E245
     C                     RETRN                                          E245
     C                     END                                            E245
     C**
     C**   RESET INDICATORS
     C**
     C*****************    MOVE '0'       *IN10                           E245
     C                     MOVE '0'       *IN20
     C**
     C                     WRITEDL806PS0
     C**
     C*
     C**
     C** DEPENDING ON LEVEL OF REPORTING REQUIRED CHANGE PARAMETER
     C**
     C*    Full reporting
     C           @EXPS     IFEQ '1'
     C**************       MOVE '1'       *IN10
     C                     MOVE 'N'       @PROD
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C**
     c*    Exception Only Reporting
     C           @EXPS     IFEQ '2'
     C**************       MOVE '1'       *IN10
     C                     MOVE 'Y'       @PROD
     C                     SETON                     LR
     C                     RETRN
     C                     END
     C**
     C***IF*VALID INPUT RETURN TO CALLING PROGRAM                         E245
     C******                                                              E245
     C******     *IN10     IFEQ '1'                                       E245
     C******               MOVE 'E'       @ACTN                           E245
     C******               SETON                     LR                   E245
     C******               RETRN                                          E245
     C******               END                                            E245
     C*
     C** ERROR IF SELECTED OPTION IS NOT 1 OR 2
     C*
     C*********  *IN10     IFNE '1'
     C                     MOVE '1'       *IN20
     C*********            END
     C**
     C                     END
     C**
     C********************************************************************
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
