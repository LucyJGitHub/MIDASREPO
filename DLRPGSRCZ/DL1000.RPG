0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Int Paid/Received This Month Extract')        *
0002 F********************************************************************
0003 F*                                                                  *
     F*  Midas - Dealing Module
0005 F*                                                                  *
0006 F*       DL1000 - DEALS FILE EXTRACT                                *
0007 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG10282           Date 04Feb06               *
      *                 CDL038             Date 10May05               *
      *                 BG7717             Date 27Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSD007             Date 28Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 156196             Date 25Apr00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01408             Date 22AUG94               *
     F*                       048933          DATE  19MAR93              *
     F*                       S01354          DATE  03MAR92              *
     F*                       E24503          DATE  08JUL91              *
     F*                       S01314          DATE  14JAN91              *
     F*                       SA1157          DATE  03/10/88             *SA1157
0009 F*                       S01117          DATE  17/02/89             *S01117
0009 F*                       S01194          DATE  17/02/89             *S01194
0009 F*                       E11576          DATE  25/09/87             *
     F*                       S01119          DATE  15/06/87             *
     F*                       S01124          DATE  00/00/00             *
     F*                                                                  *
0012 F********************************************************************
      *                                                                  *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG10282 - Fix field CLAS for DEALSDC.                       *
      *  CDL038 - Extended Deal Sub Type                              *
      *  BG7717 - DBASE error if customer deleted                     *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD007 - Customer Closing                                    *
     F*  156196 - EoM  FOOB. Take real value of DAMT as in DL0500.    *
     F*       S01408 - HOOK DL1000FFPG ADDED.                            *
     F*                HOOK DL1000CCPG ADDED.                            *
     F*                HOOK DL1000CPDR ADDED.                            *
     F*                HOOK DL1000CPD1 ADDED.                            *
     F*                HOOK DL1000CPER ADDED.                            *
     F*       048933 - RESTART RECOVERY PROCESSING REWRITE               *
     F*       S01354 - Ignore Internal Funding Deals                      S01354
     F*       E24503 - If interest received this month (TIPRM) but       *
     F*                no Their Pay Date (TSLIP) use Our Pay Date        *
     F*                (USLIP) because instrument had one set of         *
     F*                interest details and DL0280 updates Our date      *
     F*                fields but Their Amount fields for a Receive      *
     F*                on a Collar etc Sold and vv for a the Bought side *
     F*                (eg for a Rate Change on a Collar if Rate applied *
     F*                is below the Floor for Collars Sold)              *
     F*                (eg for a Rate Change on a Collar if Rate applied *
     F*                is below the Floor for Collars Bought)            *
     F*       S01314 - Release 10 incorporation.  This emulates E23407   *
     F*                from R2, in that a check for Interest on Accounts *
     F*                being present is added, as well as that for       *
     F*                Retail; however the field from the new (SDxxxxxx) *
     F*                table files is chercked instead of the old one.   *
0011 F*       SA1157 - FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL' INTO  *SA1157
     F*                'RR' (COLLAR), 'RP' (CAP) AND 'RF' (FLOOR).       *SA1157
     F*       S01117 - AMENDMENTS FOR MULTI-BRANCHING
     F*       S01194 - STANDING DATA CHANGES DERIVED FROM SYNON
0011 F*       E11576 - PURCHASE PRICE SHOWN INSTEAD OF PRINCIPAL AMOUNT. *E11576
0011 F*                ONLY UPDATE LAST INTEREST DATE IF DEAL HAS        *E11576
0009 F*                MATURED THIS MONTH.                               *E11576
     F*       S01119 - FRA/IRS CHANGES                                   *S01119
0011 F*                                                                  *
0012 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F*EALS***IP**F*****400**6AI*****2*DISK**************                 S01119
     F***DEALS**  IP  F     600  6AI     2 DISK                                        S01119 CGL029
     F*DEALS***IP**F****2325**6AI*****2*DISK                                           CGL029 CDL038
     FDEALS   IP  F    2606  6AI     2 DISK                                                   CDL038
0014 F*EALS2**IF**F*****400**6AI*****2*DISK                               S01117
0014 FDEALS2  IF  F     600  6AI     2 DISK                               S01117
0015 F*LINT***IF**F*****256**7AI*****2*DISK********                       S01194
0016 F*ABLE***IF**F******96*12AI*****2*DISK********                       S01194
0017 FIREXDHH O   F     128            DISK
0017 F*IREXDIC*O***F*****128************DISK                                                  CDL038
0017 FIREXDIC O   F     132            DISK                                                   CDL038
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL1000FFPG                                           S01408
     F*                                                                   S01408
0017 FIREXDZZ O   F     128            DISK
0018 F*PRINT  O   F     132            PRINTER                            S01124
0018 F*L1000P1O***F*****132            PRINTER                     S01124 S01117
0018 FDL1000AUO   F     132            PRINTER                            S01117
0019 F* ID F  C  H  L    FUNCTION OF INDICATORS
0020 F* 01            DEALS - HEADER
0021 F* 02                  - LOANS/DEPOSITS, RECORD ID D OR M
0022 F* 03                  - NEG. ASSETS PURCHASED, RECORD ID D OR M
     F* 10                  - FRA/IRS, RECORD ID D OR M                   S01119
0023 F* 04                  - TRAILER
0024 F* 07                  - OTHER DEALS RECORDS
0025 F* 06            DEALS2- TRAILER
0026 F* 05            CATCHALL ON ALL FILES
0027 F**08************TABLE*FILE*ICR*1*****************************       S01194
0028 F* 09            CLINT FILE DETAIL RECORD
0029 F*    19         TAX DEDUCTED THIS MONTH
 029 F*    20         INTEREST PAID/REC. THIS MONTH IS NOT EQUAL TO ZERO
0030 F*       21      LAST INTEREST DATE IS LATER THAN INTEREST THIS MONTH
0031 F*               REPORT DATE
0032 F*       22      DEAL HAS MATURED THIS MONTH
0033 F*       30      WRITE RECORD TO OUTPUT FILE
0034 F*       32      SET SLID TO MATURITY DATE
0035 F*       40      INTEREST THIS MONTH REPORT DATE EQUALS RUN DATE
0036 F*       41      INTERIM REPORT
0037 F*       42      INTEREST IS PAID
0038 F*       43      INTEREST IS RECEIVED
0039 F*       44      LIVE DEAL RECORD
     F*       50      OUR DETAILS FOR FRA/IRS                             S01119
     F*       53      AVERAGE RATE METHOD USED                            S01119
     F*       77      AMOUNT TO HASH IS NEGATIVE
     F*       78      GENERATE RECORD FOR OUR DETAILS-FRA/IRS             S01119
     F*       79      GENERATE RECORD FOR THEIR DETAILS-FRA/IRS           S01119
0040 F*       85      FILE CONTROLS OUT OF BALANCE
0041 F*             U3RETAIL MODULE EXISTS
0042 F*             U6REPORT ALREADY PRINTED
     E                    CPY@    1   1 80
0043 E                    INT         3 15 0
0044 E                    DEC         3  3 0
0045 E                    TABPUR  4   4  2
0046 E                    TABREC  5   5  2
0047 I*
0048 I*    DEALS FILE - HEADER RECORD.
0049 I*
0050 IDEALS   NS  01   1 CH
0051 I                                        1   1 RECI
0052 I                                        2   70DLNO
0053 I                                        8   8 RCDT
0054 I                                        9  100RCDC
0055 I**********                             11  160CNUM                                      CSD027
0055 I                                       11  16 CNUM                                      CSD027
0056 I                                    P 394 3960LCD
0057 I                                      397 397 CHTP
0058 I                                    P 398 4000TNLU
0059 I*
0060 I*
0061 I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
0062 I*
0063 IDEALS   NS  07   1 CD   8 CB
0064 I       OR   07   1 CE   8 CB
0065 I       OR   07   1 CM   8 CB
0066 I       OR   07   1 CR   8 CB
0067 I                                        1   1 RECI
0068 I                                        2   70DLNO
0069 I                                        8   8 RCDT
0070 I                                        9  100RCDC
0071 I**********                             11  160CNUM                                      CSD027
0071 I                                       11  16 CNUM                                      CSD027
0072 I*****                                  17  190BRCD                  S01117
     I                                       17  19 BRCA                  S01117
0073 I                                       20  21 DTYP
0074 I                                       22  23 DLST
0075 I                                    P  24  260DDAT
0076 I                                    P  27  290VDAT
0077 I                                    P  30  320OTDT
0078 I                                       35  38 BRKC
0079 I                                    P  39  450BAGE
0080 I                                       46  48 PUCY
0081 I                                    P  49  550PUAM
0082 I                                    P  56  628EXRT
0083 I                                       86  88 SLCY
0084 I                                    P  89  950SLAM
0085 I                                    P 117 1230BCEQ
0086 I                                    P 131 1378LCXR
0087 I                                      138 1390PCST
0088 I**********                            140 151 OPCA                                      CGL029
     I                                      140 151 OPCAQQ                                    CGL029
0089 I                                      152 161 TSCN
0090 I                                      162 1630SCST
0091 I**********                            164 175 OSCA                                      CGL029
     I                                      164 175 OSCAQQ                                    CGL029
0092 I                                      176 185 TPCN
0093 I                                    P 192 1980ORPA
0094 I                                    P 205 2110ORSA
0095 I                                      212 2120FSLI
0096 I                                    P 241 2470SPPD
0097 I                                    P 248 2540SPLA
0098 I                                      255 257 SPLC
0099 I                                      285 2900SODN
0100 I                                      300 309 FACO
0101 I                                      310 344 SPI
0102 I                                      370 370 DNSI
0103 I                                      371 371 DSTI
0104 I                                      372 372 CNFI
0105 I                                      373 373 ACEI
0106 I                                      374 374 TLXI
0107 I                                    P 391 3930ORED
0108 I                                    P 394 3960LCD
0109 I                                      397 397 CHTP
0110 I                                    P 398 4000TNLU
     I                                     12921309 OPCA                                      CGL029
     I                                     13101327 OSCA                                      CGL029
     I                                     13641367 CLAS                                      CDL038
0111 I*
0112 I*
0113 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0114 I*
0115 IDEALS   NS  02   1 CD   8 CC
0116 I       OR   07   1 CE   8 CC
0117 I       OR   02   1 CM   8 CC
0118 I       OR   07   1 CR   8 CC
0119 I                                        1   1 RECI
0120 I                                        2   70DLNO
0121 I                                        8   8 RCDT
0122 I                                        9  100RCDC
0123 I**********                             11  160CNUM                                      CSD027
0123 I                                       11  16 CNUM                                      CSD027
0124 I*****                                  17  190BRCD                  S01117
     I                                       17  19 BRCA                  S01117
0125 I                                       20  21 DTYP
0126 I                                       22  23 DLST
0127 I                                    P  24  260DDAT
0128 I                                    P  27  290VDAT
0129 I                                    P  30  320MDAT
0130 I                                       33  340CDAS
0131 I                                       35  38 BRKC
0132 I                                    P  39  450BAGE
0133 I                                       46  48 CCY
0134 I                                    P  49  550PCPL
0135 I                                       56  56 INTC
0136 I**********                             63  640BRTT                                      CSD103
0136 I                                       63  64 BRTT                                      CSD103
0137 I                                    P  65  707BRTE
0138 I                                    P  71  767RTSP
0139 I                                    P  77  827INTR
0140 I                                       83  850NOTD
0141 I                                       86 105 RNNA
0142 I**********                            106 1110CHNA                                      CSD027
0142 I                                      106 111 CHNA                                      CSD027
0143 I                                      112 1140FACT
0144 I                                      115 1160FCNO
0145 I                                    P 117 1230OPAM
0146 I                                    P 124 1308BCXR
0147 I                                    P 131 1378LCXR
0148 I                                      138 1390SDST
0149 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0150 I                                      152 161 TSTN
0151 I                                      162 1630MDST
0152 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0153 I                                      176 185 TMAN
0154 I                                      186 1910RODN
0155 I                                    P 192 1980RODA
0156 I                                      199 2040RBDN
0157 I                                    P 205 2110RBDA
0158 I                                      212 2120ICBS
0159 I                                      213 213 IPFR
0160 I                                    P 214 2200TOTI
0161 I                                    P 221 2230NIDT
0162 I                                    P 224 2260IBDT
0163 I                                    P 227 2290SLID
0164 I                                    P 230 2360AIPD
0165 I                                    P 237 2390DLRC
0166 I                                    P 240 2420IACD
0167 I                                    P 243 2490AITC
0168 I                                    P 250 2560AIAN
0169 I                                    P 257 2630AIAP
0170 I                                    P 264 2700IPRD
0171 I                                    P 271 2770IPRM        2020
0172 I                                    P 278 2840ICTD
0173 I                                    P 294 2960DAVD
0174 I                                      297 2990DASN
0175 I                                      300 309 FACO
0176 I                                      310 344 SPI
0177 I                                      345 3460INTF
     I                                      355 355 TAXI
     I                                    P 363 3690TAXM
     I                                      363 369 TTAX            19
0178 I                                      370 370 DNSI
0179 I                                      371 371 DSTI
0180 I                                      372 372 CNFI
0181 I                                      373 373 ACEI
0182 I                                      374 374 TLXI
0183 I                                    P 391 3930ORED
0184 I                                    P 394 3960LCD
0185 I                                      397 397 CHTP
0186 I                                    P 398 4000TNLU
     I*************************************16721689 OMDA                               CGL029 CDL038
     I*************************************16901707 OSDA                               CGL029 CDL038
     I                                     17211738 OSDA                                      CDL038
     I                                     17391756 OMDA                                      CDL038
     I**********                           18981901 CLAS                             CDL038 BUG10282
     I                                     20102013 CLAS                                    BUG10282
0187 I*
0188 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
0189 I*
0190 IDEALS   NS  03   1 CD   8 CD
0191 I       OR   07   1 CE   8 CD
0192 I       OR   03   1 CM   8 CD
0193 I       OR   07   1 CR   8 CD
0194 I                                        1   1 RECI
0195 I                                        2   70DLNO
0196 I                                        8   8 RCDT
0197 I                                        9  100RCDC
0198 I**********                             11  160ISCN                                      CSD027
0198 I                                       11  16 ISCN                                      CSD027
0199 I*****                                  17  190BRCD                  S01117
     I                                       17  19 BRCA                  S01117
0200 I                                       20  21 DTYP
0201 I                                       22  23 DLST
0202 I                                    P  24  260DDAT
0203 I                                    P  27  290VDAT
0204 I                                    P  30  320MDAT
0205 I                                       33  340IDAS
0206 I                                       35  38 BRKC
0207 I                                    P  39  450BAGE
0208 I                                       46  48 CCY
0209 I                                    P  49  550PUPR
0210 I                                    P  57  627YRAT
0211 I                                    P  71  767RTSP
0212 I                                    P  77  827INTR
0213 I                                       86 105 RNNA
0214 I**********                            106 1110PCUS                                      CSD027
0214 I                                      106 111 PCUS                                      CSD027
0215 I                                      112 1140FACT
0216 I                                      115 1160FCNO
0217 I                                    P 117 1230FVAL
0218 I                                    P 124 1308BCXR
0219 I                                    P 131 1378LCXR
0220 I                                      138 1390SDST
0221 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0222 I                                      152 161 TSTN
0223 I                                      162 1630MDST
0224 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0225 I                                      176 185 TMAN
0226 I                                    P 192 1980DISA
0227 I                                    P 205 2110DPTD
0228 I                                      212 2120ICBS
0229 I                                      213 213 IPFR
0230 I                                    P 214 2200TOTI
0231 I                                    P 221 2230NIDT
0232 I                                    P 224 2260IBDT
0233 I                                    P 227 2290SLID
0234 I                                    P 230 2360AIPD
0235 I                                    P 237 2390DLRC
0236 I                                    P 240 2420IACD
0237 I                                    P 243 2490AITC
0238 I                                    P 250 2560AIAN
0239 I                                    P 257 2630AIAP
0240 I                                    P 264 2700IPRD
0171 I                                    P 271 2770IPRM        2020
0242 I                                    P 278 2840SAPR
0243 I                                      285 2900ASDN
0244 I                                    P 291 2930SADT
0245 I                                    P 294 2960DAVD
0246 I                                      297 2990DASN
0247 I                                      300 309 FACO
0248 I                                      310 344 SPI
0249 I                                      345 3460INTF
0250 I                                      370 370 DNSI
0251 I                                      371 371 DSTI
0252 I                                      372 372 CNFI
0253 I                                      373 373 ACEI
0254 I                                      374 374 TLXI
0255 I                                    P 391 3930ORED
0256 I                                    P 394 3960LCD
0257 I                                      397 397 CHTP
0258 I                                    P 398 4000TNLU
     I*************************************16721689 OMDA                               CGL029 CDL038
     I*************************************16901707 OSDA                               CGL029 CDL038
     I                                     12451262 OSDA                                      CDL038
     I                                     12631280 OMDA                                      CDL038
     I                                     13171320 CLAS                                      CDL038
0259 I*
0260 I*
0261 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
0262 I*
0263 IDEALS   NS  07   1 CD   8 CE
0264 I       OR   07   1 CE   8 CE
0265 I       OR   07   1 CM   8 CE
0266 I       OR   07   1 CR   8 CE
0267 I                                        1   1 RECI
0268 I                                        2   70DLNO
0269 I                                        8   8 RCDT
0270 I                                        9  100RCDC
0271 I**********                             11  160CNUM                                      CSD027
0271 I                                       11  16 CNUM                                      CSD027
0272 I*****                                  17  190BRCD                  S01117
     I                                       17  19 BRCA                  S01117
0273 I                                       20  21 DTYP
0274 I                                       22  23 DLST
0275 I                                    P  24  260DDAT
0276 I                                    P  27  290VDAT
0277 I                                       35  38 BRKC
0278 I                                    P  39  450BAGE
0279 I                                       46  48 CCY
0280 I                                    P  49  550SAPRX
0281 I                                    P  57  627YRAT
0282 I                                    P  77  827INTR
0283 I                                       86 105 RNNA
0284 I**********                            106 1110ISCN                                      CSD027
0284 I                                      106 111 ISCN                                      CSD027
0285 I                                    P 117 1230FVAL
0286 I                                      138 1390SETP
0287 I**********                            140 151 OSAC                                      CGL029
     I                                      140 151 OSACQQ                                    CGL029
0288 I                                      152 161 TSEN
0289 I                                    P 285 2900RPDN
0290 I                                      370 370 DNSI
0291 I                                      371 371 DSTI
0292 I                                      372 372 CNFI
0293 I                                      373 373 ACEI
0294 I                                      374 374 TLXI
0295 I                                    P 391 3930ORED
0296 I                                    P 394 3960LCD
0297 I                                      397 397 CHTP
0298 I                                    P 398 4000TNLU
     I                                     10481065 OSAC                                      CGL029
     I                                     11021105 CLAS                                      CDL038
     I*                                                                   S01119
     I*                                                                   S01119
     I*    DEALS FILE - DETAIL - FRA/IRS                                  S01119
     I*                                                                   S01119
     IDEALS   NS  10   1 CD   8 CG                                        S01119
     I       OR   07   1 CE   8 CG                                        S01119
     I       OR   10   1 CM   8 CG                                        S01119
     I       OR   07   1 CR   8 CG                                        S01119
     I                                        1   1 RECI                  S01119
     I                                        2   70DLNO                  S01119
     I                                        8   8 RCDT                  S01119
     I                                        9  100RCDC                  S01119
     I**********                             11  160CNUM                               S01119 CSD027
     I                                       11  16 CNUM                                      CSD027
     I*****                                  17  190BRCD                  S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP                  S01119
     I                                       22  23 DLST                  S01119
     I                                    P  24  260DDAT                  S01119
     I                                    P  27  290VDAT                  S01119
     I                                    P  30  320MDAT                  S01119
     I                                       33  340CDAS                  S01119
     I                                       35  38 BRKC                  S01119
     I                                    P  39  450BAGE                  S01119
     I                                       46  510LNKDN                 S01119
     I                                       52  52 HEDIN                 S01119
     I                                       53  53 TAXI                  S01119
     I                                       54  56 UCUCY                 S01119
     I                                    P  57  630UPAMT                 S01119
     I**********                             64  650UBRTT                              S01119 CSD103
     I                                       64  65 UBRTT                                     CSD103
     I                                    P  66  717USTRT                 S01119
     I                                    P  72  777UBRTE                 S01119
     I                                    P  78  837URTSP                 S01119
     I                                       84  84 USPIN                 S01119
     I                                    P  85  907UEINR                 S01119
     I                                       91  910UICBS                 S01119
     I                                       92  930UFRFD                 S01119
     I                                    P  94  960UINFD                 S01119
     I                                    P  97  990USLIP                 S01119
     I                                    P 100 1020UNICD                 S01119
     I                                    P 103 1050UICBD                 S01119
     I                                      106 106 UICFR                 S01119
     I                                      107 1080UICFD                 S01119
     I                                    P 109 1110UNIPD                 S01119
     I                                    P 112 1140UIPBD                 S01119
     I                                      115 115 UIPFR                 S01119
     I                                      116 1170UIPFD                 S01119
     I                                    P 118 1248UBCXR                 S01119
     I                                    P 125 1270UIACD                 S01119
     I                                    P 128 1340UIALC                 S01119
     I                                    P 135 1410UAITC                 S01119
     I                                    P 142 1480UAIPD                 S01119
     I                                    P 149 1550UAIAN                 S01119
     I                                    P 156 1620UAIAP                 S01119
     I                                    P 163 1690UIPRD                 S01119
     I                                    P 170 1760UIPRM                 S01119
     I                                    P 177 1830UNSAM                 S01119
     I                                    P 184 1900UTAXD                 S01119
     I                                    P 191 1970UTAXM                 S01119
     I                                      198 200 TCUCY                 S01119
     I                                    P 201 2070TPAMT                 S01119
     I**********                            208 2090TBRTT                              S01119 CSD103
     I                                      208 209 TBRTT                                     CSD103
     I                                    P 210 2157TSTRT                 S01119
     I                                    P 216 2217TBRTE                 S01119
     I                                    P 222 2277TRTSP                 S01119
     I                                      228 228 TSPIN                 S01119
     I                                    P 229 2347TEINR                 S01119
     I                                      235 2350TICBS                 S01119
     I                                      236 2370TFRFD                 S01119
     I                                    P 238 2400TINFD                 S01119
     I                                    P 241 2430TSLIP                 S01119
     I                                    P 244 2460TNICD                 S01119
     I                                    P 247 2490TICBD                 S01119
     I                                      250 250 TICFR                 S01119
     I                                      251 2520TICFD                 S01119
     I                                    P 253 2550TNIPD                 S01119
     I                                    P 256 2580TIPBD                 S01119
     I                                      259 259 TIPFR                 S01119
     I                                      260 2610TIPFD                 S01119
     I                                    P 262 2688TBCXR                 S01119
     I                                    P 269 2710TIACD                 S01119
     I                                    P 272 2780TIALC                 S01119
     I                                    P 279 2850TAITC                 S01119
     I                                    P 286 2920TAIPD                 S01119
     I                                    P 293 2990TAIAN                 S01119
     I                                    P 300 3060TAIAP                 S01119
     I                                    P 307 3130TIPRD                 S01119
     I                                    P 314 3200TIPRM                 S01119
     I                                    P 321 3270TNSAM                 S01119
     I                                    P 328 3340TTAXD                 S01119
     I                                    P 335 3410TTAXM                 S01119
     I                                    P 342 3477CLRAT                 S01119
     I                                    P 348 3537FLRAT                 S01119
     I                                    P 354 3550AVPER                 S01119
     I                                    P 356 3638TIRAT                 S01119
     I                                    P 364 3697AACRT                 S01119
     I                                      370 3710RSETM                 S01119
     I**********                            372 383 URACC                              S01119 CGL029
     I                                      372 383 URACQQ                                    CGL029
     I                                      384 393 CPPBK                 S01119
     I                                      394 3950PSETM                 S01119
     I**********                            396 407 UPACC                              S01119 CGL029
     I                                      396 407 UPACQQ                                    CGL029
     I                                      408 417 CPRBK                 S01119
     I                                      418 427 FACO                  S01119
     I                                      428 462 SPI                   S01119
     I                                    P 463 4650SDCAR                 S01119
     I                                    P 466 4680ULPCD                 S01119
     I                                    P 469 4710TLPCD                 S01119
     I                                    P 472 4780UAEXA                 S01119
     I                                    P 479 4850TAEXA                 S01119
     I                                      570 570 UDNSI                 S01119
     I                                      571 571 TDNSI                 S01119
     I                                      572 572 UDSTI                 S01119
     I                                      573 573 TDSTI                 S01119
     I                                      574 574 CNFI                  S01119
     I                                      575 575 ACEI                  S01119
     I                                      576 576 TLXI                  S01119
     I                                    P 587 5880LSWC                  S01119
     I                                    P 589 5900LSWS                  S01119
     I                                    P 591 5930ORED                  S01119
     I                                    P 594 5960LCD                   S01119
     I                                      597 597 CHTP                  S01119
     I                                    P 598 6000TNLU                  S01119
     I*************************************22902307 UPACC                              CGL029 CDL038
     I*************************************23082325 URACC                              CGL029 CDL038
     I                                     24692486 URACC                                     CDL038
     I                                     24872504 UPACC                                     CDL038
     I                                     26032606 CLAS                                      CDL038
0299 I*
0300 I*
0301 I*    DEALS FILE -TRAILER RECORD.
0302 I*
0303 IDEALS   NS  04   1 CT
0304 I                                        1   1 RECI
0305 I                                        2   70DLNO
0306 I                                        8   8 RCDT
0307 I                                        9  100RCDC
0308 I**********                             11  160CNUM                                      CSD027
0308 I                                       11  16 CNUM                                      CSD027
0309 I                                    P  17  190NORE
0310 I                                    P  20  220FLSZ
0311 I                                    P  23  250NLRB
0312 I                                    P  26  280NINS
0313 I                                    P  29  310NDEL
0314 I                                    P  32  340NLRA
0315 I                                    P  35  420VLBF
0316 I                                    P  43  440VLBL
0317 I                                    P  45  520VRIF
0318 I                                    P  53  540VRIL
0319 I                                    P  55  620VRDF
0320 I                                    P  63  640VRDL
0321 I                                    P  65  720VLAF
0322 I                                    P  73  740VLAL
0323 I                                    P  75  770DTMR
0324 I                                    P  78  800ITMR
0325 I                                    P 394 3960LCD
0326 I                                      397 397 CHTP
0327 I                                    P 398 4000TNLU
0328 I*
0329 I*    CATCHALL
0330 I*
0331 I        NS  05
0332 I*
0333 IDEALS2  NS  06   1 CT
0334 I                                    P  78  800ITMR
0335 I*
0336 I*    CATCHALL
0337 I*
0338 I        NS  05
0339 I*
0340 I*    CLIENT FILE - CUSTOMER STANDING DATA RECORD.
0341 I*
0342 I*LINT***NS**09***1*CD***8 CA                                        S01194
0343 I*****  OR   09   1 CC   8 CA                                        S01194
0344 I*****                                   1   1 RECI                  S01194
0345 I*****                                   2   70CNUM                  S01194
0346 I*****                                   8   8 RCDT                  S01194
0347 I*****                                   9  28 CRNM                  S01194
0348 I*****                                  49  56 CASK                  S01194
0349 I*****                                                               S01194
0350 I*****CATCHALL                                                       S01194
0351 I*****                                                               S01194
0352 I*****   NS  05                                                      S01194
0353 I*****                                                               S01194
0354 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0356 I*ABLE***NS**08***2*C0***3*C1**12 C1                                 S01194
0357 I*****  AND      13 C0                                               S01194
0358 I*****                                   1   1 RECI                  S01194
0359 I*****                                   2   30RECT                  S01194
0360 I*****                                  12  130RCDE                  S01194
0361 I*****                                  14  66 TITL                  S01194
0362 I*****                                  67  67 DATF                  S01194
0363 I*****                                  68  700DFBR                  S01194
0364 I*****                                  74  74 MODI1                 S01194
0365 I*****                                  75  75 MODI2                 S01194
0366 I*****                                  76  76 MODI3                 S01194
0367 I*****                               P  77  790RUND                  S01194
0368 I*****                                  80  86 RUNA                  S01194
0369 I*****                                  87  870SFLG                  S01194
0370 I*****                               P  90  920LCD                   S01194
0371 I*****                                  93  93 CHTP                  S01194
0372 I*****                               P  94  960TNLU                  S01194
0373 I*****                                                               S01194
0374 I*****                                                               S01194
0375 I*****CATCHALL                                                       S01194
0376 I*****                                                               S01194
0377 I*****   NS  05                                                      S01194
0378 I*****                                   1   1 RECI                  S01194
      *                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I* CUSTOMER DETAILS ACCESSED VIA ACCESS PROGRAM                      S01194
      *                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
      *                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I* MODULE INFO. ACCESSED VIA ACCESS PROGRAM                          S01194
      *                                                                   CSD007
     ISCSARD    E DSSCSARDPD                                              CSD007
      ** External Data Structure for Switchable Features                  CSD007
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
      *                                                                   S01194
     IDSLDY     E DSDSLDY                                                 CSD007
      ** Third DS for access programs, very long data structure           CSD007
0379 I*
0380 I*    DATA STRUCTURE FOR HASH TOTALLING OF DEAL AMOUNTS
0381 I*
0382 I            DS
0383 I                                        1  130DAMT
0384 I                                        1  130PUAM
0385 I                                        1  130PCPL
0386 I                                        1  130PUPR
0387 I                                        1  130SAPRX
     I                                        1  130UPAMT                 S01119
     I              '**CUSTOMER DELETED**'C         DLTD                                      BG7717
0388 C*
0389 C*    CONDITION FIRST CYCLE CALCS ON DEALS FILE HEADER
0390 C*
0391 C  N01                GOTO DETAIL
     C                     MOVEACPY@      BIS@   80
0230 C***U7******          SETON                     41                   048933
0231 C***********          SETOF                     U7                   048933
0230 C   U1                SETON                     41                   048933
     C                     Z-ADD0         TAXM   130
0394 C*
0395 C*    CHECK 'INTEREST THIS MONTH REPORT DATE' ON DEALS FILE TRAILER
0396 C           999999    CHAINDEALS2               99
0397 C  N06                SETON                     U7U8LR
0398 C  N06                GOTO END
0399 C*****                EXSR ZSYSTM                                    S01194
0400 C***99                SETON                     U7U8LR               S01194
0401 C***99                GOTO END                                       S01194
0402 C*****      ITMR      COMP RUND                     40               S01194
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     99                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0624 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*                                                                   S01194
0402 C           ITMR      COMP BJRDNB                   40               S01194
0403 C   40                SETON                     U6LR
0404 C   40                GOTO END
0405 C*
0406 C*********************MOVE 'A'       KEYCL   7                       S01194
0407 C*
     C** READ MODULE DETAILS VIA ACCESS PROGRAM                           S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     99                   S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDMMODPD'DBFILE 10        ************   S01194
     C                     MOVEL'02'      DBASE   2        * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0408 C*    IF RETAIL MODULE IS PRESENT, SET SWITCH 3 ON
0409 C*
0410 C*****                TESTB'2'       MODI1          U3               S01194
0410 C           BGRTBN    IFEQ 'Y'                                       S01194
     C           BGIOAC    OREQ 'Y'                                       S01314
0410 C                     SETON                     U3                   S01194
0410 C                     END                                            S01194
      *                                                                   CSD007
      ** Access Switchable Features file and check if CSD007              CSD007
      ** is switched on or not.                                           CSD007
      *                                                                   CSD007
     C                     CALL 'AOSARDR0'                                CSD007
     C                     PARM *BLANKS   @RTCD   7                       CSD007
     C                     PARM '*VERIFY' @OPTN   7                       CSD007
     C                     PARM 'CSD007'  @SARD   6                       CSD007
     C           SCSARD    PARM SCSARD    DSFDY                           CSD007
      *                                                                   CSD007
     C           @RTCD     IFEQ *BLANKS                                   CSD007
     C                     MOVE 'Y'       CSD007  1                       CSD007
      *                                                                   CSD007
     C                     ELSE                                           CSD007
     C                     MOVE 'N'       CSD007                          CSD007
      *                                                                   CSD007
      ** Database Error, if Return Code is not blanks or *NRF             CSD007
      *                                                                   CSD007
     C           @RTCD     IFNE '*NRF   '                                 CSD007
     C                     MOVEL'SCSARDPD'DBFILE 10                       CSD007
     C                     MOVEL'07'      DBASE   2                       CSD007
     C                     MOVEL'CSD007  'DBOPTN  7                       CSD007
     C                     MOVE *ON       *IN99                           CSD007
     C                     MOVE *ON       *INU7                           CSD007
     C                     MOVE *ON       *INU8                           CSD007
     C                     MOVE *ON       *INLR                           CSD007
     C                     EXSR *PSSR                                     CSD007
     C                     GOTO END                                       CSD007
     C                     ENDIF                                          CSD007
     C                     ENDIF                                          CSD007
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1000CCPG                                           S01408
     C*                                                                   S01408
0411 C           DETAIL    TAG                             ** DETAIL TAG *
0412 C                     SETOF                     213032
     C                     SETOF                     787951               S01119
     C                     SETOF                     5253                 S01119
0413 C   04                GOTO TRAIL
0414 C   01
0415 COR 05                GOTO END
0416 C*
     C  N02
     COR 02 19             Z-ADD0         TAXM
0416 C*
0417 C*    ACCUMULATE NUMBER AND VALUE OF DEALS DETAIL RECORDS READ
0418 C*    IN INT,1  DEC,1
0419 C           RECI      COMP 'D'                      44
0420 C   44      RECRED    ADD  1         RECRED  50
0421 C   44                MOVE 1         X       10
0422 C   44      DAMT      DIV  1000      ZZAMT        77
     C***77*******         Z-SUBZZAMT     ZZAMT                           156196
0423 C   44                EXSR HASH
0424 C   07                GOTO END
     C*                                                                   S01354
     C** Ignore Internal Funding Deals                                    S01354
     C*                                                                   S01354
     C           DTYP      CABEQ'IL'      END                             S01354
     C           DTYP      CABEQ'ID'      END                             S01354
     C*                                                                   S01119
     C           *IN10     IFEQ '0'                                       S01119
0425 C           SLID      COMP ITMR                 21
     C                     ELSE                            FRA/IRS        S01119
     C           UIPRM     COMP 0                    7878                 S01119
     C           TIPRM     COMP 0                    7979                 S01119
     C                     MOVE '0'       *IN20                           S01119
     C   78                                                               S01119
     COR 79                SETON                     20                   S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C   78      VDAT      COMP ITMR                 78                   S01119
     C   79      VDAT      COMP ITMR                 79                   S01119
     C                     Z-ADDVDAT      USLIP                           S01119
     C                     Z-ADDVDAT      TSLIP                           S01119
     C                     ELSE                                           S01119
     C***78***** USLIP     COMP ITMR                 78             S01119E24503
     C** May have receive interest but only our date details              E24503
     C           *IN78     IFEQ '1'                        *B02           E24503
     C**                                                                  E24503
     C           USLIP     IFNE *ZERO                      *B03           E24503
     C**                                                                  E24503
     C           USLIP     IFGT ITMR                       *B04           E24503
     C                     MOVE '1'       *IN78                           E24503
     C                     ELSE                            *X04           E24503
     C                     MOVE '0'       *IN78                           E24503
     C                     END                             *E04           E24503
     C**                                                                  E24503
     C                     ELSE                            *X03           E24503
     C**                                                                  E24503
     C           TSLIP     IFGT ITMR                       *B04           E24503
     C                     MOVE '1'       *IN78                           E24503
     C                     Z-ADDTSLIP     USLIP                           E24503
     C                     Z-ADDTEINR     UEINR                           E24503
     C                     ELSE                            *X04           E24503
     C                     MOVE '0'       *IN78                           E24503
     C                     END                             *E04           E24503
     C**                                                                  E24503
     C                     END                             *E03           E24503
     C                     END                             *E02           E24503
     C**                                                                  E24503
     C***79***** TSLIP     COMP ITMR                 79             S01119E24503
     C** May have receive interest but only our date details              E24503
     C           *IN79     IFEQ '1'                        *B02           E24503
     C**                                                                  E24503
     C           TSLIP     IFNE *ZERO                      *B03           E24503
     C**                                                                  E24503
     C           TSLIP     IFGT ITMR                       *B04           E24503
     C                     MOVE '1'       *IN79                           E24503
     C                     ELSE                            *X04           E24503
     C                     MOVE '0'       *IN79                           E24503
     C                     END                             *E04           E24503
     C**                                                                  E24503
     C                     ELSE                            *X03           E24503
     C**                                                                  E24503
     C           USLIP     IFGT ITMR                       *B04           E24503
     C                     MOVE '1'       *IN79                           E24503
     C                     Z-ADDUSLIP     TSLIP                           E24503
     C                     Z-ADDUEINR     TEINR                           E24503
     C                     ELSE                            *X04           E24503
     C                     MOVE '0'       *IN79                           E24503
     C                     END                             *E04           E24503
     C**                                                                  E24503
     C                     END                             *E03           E24503
     C                     END                             *E02           E24503
     C**                                                                  E24503
     C                     END                                            S01119
     C   78                                                               S01119
     COR 79                SETON                     21                   S01119
     C*                                                                   S01119
     C**         DTYP      IFEQ 'RL'                               S01119 SA1157
     C           DTYP      IFEQ 'RR'                                      SA1157
     C           DTYP      OREQ 'RP'                                      SA1157
     C           DTYP      OREQ 'RF'                                      SA1157
     C   78                TESTB'3'       UDSTI          51               S01119
     C   79                TESTB'3'       TDSTI          51               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
0426 C*****      MDAT      COMP RUND                   2222               S01194
0426 C           MDAT      COMP BJRDNB                 2222               S01194
0427 C   22      MDAT      COMP ITMR                 22
0428 C  N20
0429 CORN21N22             GOTO END
0430 C**                   SETON                     30                   S01119
0430 C   02                                                               S01119
0430 COR 03                SETON                     30                   S01119
     C   10 78             SETON                     30                   S01119
0431 C           RCDC      COMP 17                       36
0432 C*
0433 C*    ACCUMULATE NUMBER AND VALUE OF EXTRACTED RECORDS IN INT,2 DEC,2
0434 C*
0435 C           RECRIT    ADD  1         RECRIT  50
     C   10 78 79RECRIT    ADD  1         RECRIT                          S01119
0436 C                     MOVE 2         X
0422 C           DAMT      DIV  1000      ZZAMT        77
     C***77*******         Z-SUBZZAMT     ZZAMT                           156196
0438 C                     EXSR HASH
0439 C*
0440 C*    ACCUMULATE HASH  TOTAL OF 'INTEREST PAID/RECEIVED' AMOUNT ON
0441 C*    EXTRACTED RECORDS IN INT,3  DEC,3
0442 C*
0443 C***********IPRM******DIV**1000******ZZAMT********77******           S01119
0443 C   02                                                               S01119
0443 COR 03      IPRM      DIV  1000      ZZAMT        77                 S01119
     C   10 78   UIPRM     DIV  1000      ZZAMT        77                 S01119
     C   10 79N78TIPRM     DIV  1000      ZZAMT        77                 S01119
     C   77                Z-SUBZZAMT     ZZAMT
0444 C                     MOVE 3         X
0445 C                     EXSR HASH
0445 C   10 78 79          DO
     C           TIPRM     DIV  1000      ZZAMT        77                 S01119
     C   77                Z-SUBZZAMT     ZZAMT
0444 C                     MOVE 3         X
0445 C                     EXSR HASH
     C                     END                                            S01119
0446 C*
0447 C*    SET SLID TO MDAT FOR MATURED DEALS
0448 C*
0449 C   02
     COR 03                                                               S01119
0450 COR 10      RECI      COMP 'M'                      32               S01119
0450 C*R*03******RECI******COMP*'M'**********************32*****          S01119
0451 C***32****************Z-ADDMDAT******SLID******************          S01119
0451 C   02 32                                                            S01119
0451 COR 03 32             Z-ADDMDAT      SLID                            S01119
     C   32 78 10          Z-ADDMDAT      USLIP                           S01119
     C   32 79 10          Z-ADDMDAT      TSLIP                           S01119
0452 C*
0453 C*    SET INDICATOR ACCORDING TO WHETHER INTEREST IS PAID OR RECEIVED
0454 C*
0455 C           DTYP      LOKUPTABPUR                   42
0456 C           DTYP      LOKUPTABREC                   43
0457 C   03                SETON                     43
     C   10 78             SETON                     42                   S01119
0458 C*
0459 C*    ACCESS CLIENT FILE FOR CUSTOMER ALPHA SORT KEY                 S01194
     C*      VIA ACCESS PROGRAM AOMMODR0                                  S01194
0460 C*
0461 C***02****************MOVELCNUM******KEYCL*************              S01119
     C***02                                                         S01119S01194
0461 C*R*10                MOVELCNUM      KEYCL                     S01119S01194
0462 C***03                MOVELISCN      KEYCL                           S01194
0463 C*****      KEYCL     CHAINCLINT                99                   S01194
0464 C**N09                SETON                     U7U8LR               S01194
0465 C**N09                GOTO END                                       S01194
0466 C*                                                                   S01194
     C   02                                                               S01194
     COR 10                MOVELCNUM      CUSTKY  6                       S01194
     C   03                MOVELISCN      CUSTKY                          S01194
     C** READ CUSTOMER DETAILS VIA ACCESS PROGRAM AOCUSTR0                S01194
     C***********          CALL 'AOCUSTR0'                         S01194 CSD007
     C                     CALL 'AOCUSTR2'                                CSD007
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CUSTKY    @KEY1  10                       S01194
     C                     PARM '*NUMBER' @KYST   7                       S01194
     C***********SDCUST    PARM SDCUST    DSSDY                    S01194 CSD007
     C           SDCUST    PARM SDCUST    DSLDY                           CSD007
      *                                                                   CSD007
      ** If CSD007 is on, allow processing of a closed record (return     CSD007
      ** code '*NRF' and date deleted equal to zero).                     CSD007
      *                                                                   CSD007
     C           CSD007    IFEQ 'Y'                                       CSD007
     C           @RTCD     ANDEQ'*NRF'                                    CSD007
     C           BBDTDL    ANDEQ*ZERO                                     CSD007
      *                                                                   CSD007
     C                     ELSE                                           CSD007
      *                                                                   CSD007
      *                                                                                       BG7717
      ** If Customer found but deleted, include this on the report                            BG7717
     C           @RTCD     IFEQ '*NRF'                                                        BG7717
     C           BBDTDL    ANDGT*ZERO                                                         BG7717
     C                     MOVELDLTD      BBCRNM                                              BG7717
      *                                                                                       BG7717
     C                     ELSE                                                               BG7717
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *IN99                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDCUSTPD'DBFILE 10        ************   S01194
     C                     MOVEL'03'      DBASE   2        * DBERR 03 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CSD007
     C                     ENDIF                                          CSD007
     C                     ENDIF                                                              BG7717
0467 C*
0468 C           TRAIL     TAG                             ** TRAIL TAG **
0469 C**N04****************GOTO*END***************                        S01119
0469 C  N04                GOTO END1                                      S01119
0470 C           RECRED    COMP NLRA                 8585
0471 C  N85      INT,1     COMP VLAF                 8585
0472 C  N85      DEC,1     COMP VLAL                 8585
0473 C   85                SETON                     U8
     C*                                                                   S01119
     C**   IF THEIRS DETAILS ON DEALSDG THEN EXCEPT DETAILS               S01119
     C*                                                                   S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1000CPDR                                           S01408
     C*                                                                   S01408
     C           END1      TAG                                            S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1000CPD1                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C   10 79             EXCPT                                          S01119
     C*                                                                   S01119
0474 C           END       TAG
     C*                                                                   S01119
0475 CLR         RECRIT    ADD  2         NORECS  50
     C*                                                                   S01117
0476 C********************************************************************
0477 C*
0478 C           HASH      BEGSR
0479 C*
0480 C                     Z-ADDINT,X     ZZTOTI
0481 C                     Z-ADDDEC,X     ZZTOTD
0482 C                     EXSR GLZADD
0483 C                     Z-ADDZZTOTI    INT,X
0484 C                     Z-ADDZZTOTD    DEC,X
0485 C                     ENDSR
0486 C********************************************************************
0487 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0488 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0489 C*
0490 CSR         GLZADD    BEGSR                           *** GLZADD ****
0491 C*
0492 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0493 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0494 C*
0495 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0496 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0497 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0498 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0499 C*
0500 CSR                   EXSR GLZSUM
0501 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0502 C*
0503 C********************************************************************
0504 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0505 C*                        GLZADD, GLZSUB, GLZCMP.
0506 C*          PARAMETERS PASSED -
0507 C*                     I/P ZZAMTI ZZAMTD
0508 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0509 C*
0510 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0511 C*
0512 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0513 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0514 CSR                   SETOF                     919293
0515 CSR                   SETOF                     949599
0516 C*
0517 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0518 CSR         ZZAMTI    COMP 0                      9293
0519 CSR 93      ZZAMTD    COMP 0                      9293
0520 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0521 C*
0522 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0523 CSR         ZZTOTI    COMP 0                      9193
0524 CSR 93      ZZTOTD    COMP 0                      9193
0525 C*
0526 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0527 CSR 93                Z-ADDZZAMTI    ZZTOTI
0528 CSR 93                Z-ADDZZAMTD    ZZTOTD
0529 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0530 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0531 CSR 91N92
0532 CORN91 92             GOTO ZZOFPS
0533 C*
0534 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0535 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0536 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0537 C*
0538 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0539 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0540 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0541 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0542 C*
0543 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0544 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0545 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0546 CSRN99                Z-ADDZZWK2     ZZTOTD
0547 CSRN99                Z-ADDZZWK3     ZZTOTI
0548 C*
0549 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0550 CSR 99                Z-ADD0         ZZAMT  153
0551 CSR                   GOTO ZZSEND
0552 C*
0553 C* THE 'SIGNS' ARE DIFFERENT
0554 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0555 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0556 C*
0557 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0558 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0559 C*
0560 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0561 C*
0562 CSR 91                Z-SUBZZTOTI    ZZTOTI
0563 CSR 91                Z-SUBZZTOTD    ZZTOTD
0564 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0565 C*
0566 CSR         ZZTOTI    COMP ZZAMTI               93  95
0567 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0568 C*
0569 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0570 CSR 95                Z-ADD0         ZZTOTI
0571 CSR 95                Z-ADD0         ZZTOTD
0572 CSR 95                GOTO ZZSEND
0573 C*
0574 C* IF ZZTOT GT. ZZAMT.
0575 CSR 93      ZZAMTD    COMP ZZTOTD               94
0576 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0577 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0578 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0579 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0580 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0581 C*
0582 C*
0583 C* IF ZZAMT GT. ZZTOT.
0584 CSRN93      ZZTOTD    COMP ZZAMTD               94
0585 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0586 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0587 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0588 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0589 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0590 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0591 C*
0592 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0593 CSR                   SETOF                     94
0594 CSR 93 91
0595 CORN93 92             SETON                     94
0596 CSR 94                Z-SUBZZTOTI    ZZTOTI
0597 CSR 94                Z-SUBZZTOTD    ZZTOTD
0598 C**
0599 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0600 CSR 92                Z-SUBZZAMTI    ZZAMTI
0601 CSR 92                Z-SUBZZAMTD    ZZAMTD
0602 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0603 C**
0604 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0605 CSR                   SETOF                     96
0606 CSR         ZZTOTD    COMP 0                        91
0607 CSR 91      ZZTOTI    COMP 0                      96
0608 CSR 96                MOVE '.000-'   ZZNEGD  5
0609 CSR                   ENDSR                             ** ENDSR **
0610 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
0611 C*****                                                               S01194
0612 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0613 C*****                                                               S01194
0614 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0615 C*****                                                               S01194
0616 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0617 C*****                MOVEL'01      'ZTABKY 12                       S01194
0618 C*****                MOVE '  10'    ZTABKY                          S01194
0619 C*****                                                               S01194
0620 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0621 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0622 C*****                                                               S01194
0623 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0624 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0625 C*****                                                               S01194
0626 C*****                ENDSR                                          S01194
0627 C*****                                                               S01194
0628 C*****                                                               S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1000CPER                                           S01408
     C*                                                                   S01408
0629 C********************************************************************
0630 O*    CONTROL REPORT
0631 O*
0632 O*PRINT  T  203   LRNU6                                              S01124
0632 O*L1000P1T  203   LRNU6                                       S01124 S01117
0632 ODL1000AUT  203   LR                                                 S01117
0633 O***********                        22 'REFERENCE DL1000'            S01117
0633 O                                   22 'REFERENCE DL1000AU'          S01117
0634 O*****                    TITL      89                               S01194
0634 O                         BJURPT    89                               S01194
0635 O                                  104 'DATE'                        S01194
0636 O*****                    RUNA     112                               S01194
0636 O                         BJMRDT   112                               S01194
0637 O                                  127 'PAGE    1'
0638 O********T**1     LRNU6                                              S01117
0638 O        T  1     LR                                                 S01117
0639 O                       41          46 'INTERIM'
0640 O                                   66 'INTEREST THIS MONTH'
0641 O                                   83 'EXTRACT CONTROLS'
0642 O********T**      LRNU6                                              S01117
0638 O        T        LR                                                 S01117
0643 O                       41          46 '*******'
0644 O                                   71 '------------------------'
0645 O                                   83 '------------'
0646 O        T  236   LRNU6
0647 O                                   18 'RUN CONTROLS'
0648 O        T  2     LRNU6
0649 O                                   59 'NUMBER'
0650 O                                   84 'VALUE'
0651 O        T  2     LRNU6
0652 O                                   33 'DEALS FILE RECORDS INPUT'
0653 O                                   41 '- LIVE'
0654 O                         RECRED3   59
0655 O                         INT,1 Z   81
0656 O                         DEC,1     84
0657 O        T  2     LRNU6
0658 O                                   33 'DEALS FILE CONTROL TOTAL'
0659 O                                   41 'S - LIVE'
0660 O                         NLRA  3   59
0661 O                         VLAF  Z   81
0662 O                         VLAL      84
0663 O        T  3     LRNU6
0664 O                                   29 'EXTRACT FILE CREATED'
0665 O                                   45 '- TOTAL RECORDS'
0666 O                         NORECS3   59
0667 O                         INT,2 Z   81
0668 O                         DEC,2     84
0669 O        T  1     LR 85NU6
0670 O                                   71 '***   DIFFERENCE   ***'
0671 O********T********LR U7 U8                                           S01117
0672 O***********************************22 'REFERENCE DL1000'            S01117
0673 O***********************************62 'PRINT TERMINATED, '          S01117
0674 O***********************************80 'DATABASE IN ERROR'           S01117
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBOPTN    54                               S01117
0675 O*                                                                   S01117
0657 O        T  2     LR U6                                              S01117
0672 O                                   55 'REPORT ALREADY PRINTED'      S01117
0675 O*
0676 O*    INTEREST REPORT EXTRACT FILE
0677 O*
0678 OIREXDHH D        1P
0679 O                                    1 'A'
0680 OIREXDIC D        30
0681 O                                    1 'D'
0682 O*****                    BRCD       4                               S01117
0682 O                         BRCA       4                               S01117
0683 O                       42           5 'P'
0684 O                       43           5 'R'
0685 O*****                    CASK      13                               S01194
0685 O                         BBCASC    13                               S01194
0686 O                         SLID      16P
     O                    10 78USLIP     16P                              S01119
0687 O                                   26 '0000000000'
0688 O                         DLNO      32
0689 O*****                    CRNM      52                               S01194
0689 O                         BBCRNM    52                               S01194
0690 O                         DTYP      54
0691 O                         DLST      56
0692 O                         CCY       59
0692 O                    10 78UCUCY     59                               S01119
0693 O                       02PCPL      66P
0694 O********************** 03PUPR      66P                              E11576
0694 O                       03FVAL      66P                              E11576
     O                       10UPAMT     66P                              S01119
0695 O                         INTR      72P
     O                 10 78N51UEINR     72P                              S01119
     O                 10 51 78AACRT     72P                              S01119
0696 O                         IPRM      80P
     O                    10 78UIPRM     80P                              S01119
0697 O                       36ISCN      86
0698 O                      N36CNUM      86
     O                         TAXM     128P
     O                    10 78UTAXM    128P                              S01119
     O                         CLAS     132                               CDL038
0680 OIREXDIC E                                                           S01119
0681 O                                    1 'D'                           S01119
0682 O*****                    BRCD       4                               S01117
0682 O                         BRCA       4                               S01117
0684 O                                    5 'R'                           S01119
0685 O*****                    CASK      13                               S01194
0685 O                         BBCASC    13                               S01194
     O                         TSLIP     16P                              S01119
0687 O                                   26 '0000000000'                  S01119
0688 O                         DLNO      32                               S01119
0689 O*****                    CRNM      52                               S01194
0689 O                         BBCRNM    52                               S01194
0690 O                         DTYP      54                               S01119
0691 O                         DLST      56                               S01119
0692 O                         TCUCY     59                               S01119
     O                         TPAMT     66P                              S01119
     O                         TEINR     72P                              S01119
     O                       51AACRT     72P                              S01119
     O                         TIPRM     80P                              S01119
0698 O                         CNUM      86                               S01119
     O                         TTAXM    128P                              S01119
     O                         CLAS     132                               CDL038
0699 OIREXDZZ T        LR
0700 O                                    1 'T'
0701 O                         NORECS     6
0702 O                         INT,3     14P
0703 O                         DEC,3     16P
0704 O*
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   TABPUR - EVENT CODES FOR EVENTS WITH INTEREST PAID
ITTDCICD
**   TABREC - EVENT CODES FOR EVENTS WITH INTEREST RECEIVED
IPTILNCLDL
