0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Interest paid/rcvd this mnth rept')           *
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Dealing Module                                       *
0005 F*                                                               *
0006 F*    DL1030 - INTEREST THIS MONTH REPORT                        *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CIR020             Date 02Aug21               *
      *  Prev Amend No. CDL102             Date 01Jun21               *
      *                 CSD103             Date 10Aug20               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD042933           Date 22Apr17               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CRE073             Date 06Dec10               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CAS009             Date 16May05               *
      *                 CAS008             Date 16Jun04               *
      *                 CDL028             Date 07Feb05               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 217684             Date 12May03               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR005             Date 21Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 110252             DATE 23JAN98                *
     F*                   S01449             DATE 01DEC93                *
     F*                   048933             DATE 19MAR93                *
     F*                   S01383             DATE 27APR92                *
0011 F*                   S01117             DATE 28/02/89               *
0011 F*                   S01194             DATE 28/02/89               *
0011 F*                   E81120             DATE 17/10/86               *
0011 F*                                                                  *
0011 F*----------------------------------------------------------------  *
0011 F*                                                                  *
      *  CIR020 - LIBOR Deregulation - FRA/IRS (Recompile)            *
      *  CDL102 - LIBOR Deregulation - Dealing (Recompile)            *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  MD042933 - JPY currency is truncated.  Adjust position so    *
      *             that no truncation occurs.                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  CAS008 - IAS 39 Enhancements                                 *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS006 - Hedge Accounting Phase B                            *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  217684 - Authorisation User Malfunction (Recompile)          *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  CDL008 - Continuous Linked Settlement (Recompiled)           *
      *    CIR005 - FRA/IRS Business Day Conventions to DEALSDG         *
      *             (recompile)                                         *
     F*    110252  -  Report includes figures for past months.           *
     F*    S01449  -  Autorecs II - Recompile for change to ACCNTAB      *
     F*    048933  -  RESTART RECOVERY PROCESSING REWRITE                *
     F*    S01383  -  BASIC RATE TAX INCORPORATION                       *
     F*    S01117  -  AMENDMENTS FOR MULTI-BRANCHING
     F*    S01194  -  STANDING DATA CHANGES DERIVED FROM SYNON
0011 F*    E81120  -  INCORRECT USAGE OF FIELD 'IPRM' INSTEAD OF 'TAXM'  *E81120
0011 F*               AND INCORRECT DEFINITION OF 'TAXR'.                *E81120
0011 F*                                                                  *
0012 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 FIRSOD   IP AE           K        DISK
0014 FIRSOR   IS AE           K        DISK                           U1
0015 F*ABLE***IF**F******96*12AI*****2*DISK****************************   S01194
0016 F*****   UF  F     400  6AI     2 DISK                               S01117
0016 F***DEALS***UF  F     500  6AI     2 DISK                                         S01117 CAS004
     F***DEALS** UF  F    2247  6AI     2 DISK                                         CAS004 CAS005
     F***DEALS** UF  F    2441  6AI     2 DISK                                         CAS005 CAS006
     F***DEALS** UF  F    2448  6AI     2 DISK                                         CAS006 CAS008
     FDEALS   UF  F    2458  6AI     2 DISK                                                   CAS008
0017 F***ACCNT** UF  F     400 15AI     2 DISK                                                CGL029
     FACCNT   UF  F     573 21AI     2 DISK                                                   CGL029
     FSDBRTDL1IF  E           K        DISK                               S01383
0018 FDL1030AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0018 F*****0P1O   F     132     OF     PRINTER                    S01124  S01117
0018 FDL1030P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0019 F* ID F  C  H  L    FUNCTION OF INDICATORS
0020 F* 01            IRSOD DETAIL
0021 F* 02            IRSOD TRAILER
0022 F**03************FILES CATCHALL
0023 F* 03            CATCHALL FOR IRSOD AND IRSOR FILES
0024 F* 04            IRSOR DETAIL
0025 F* 05            IRSOR TRAILER
0026 F**06************TABLE FILE - ICR 1*****************************
0027 F**07***********************- BRANCH CODES**********************
0028 F**08********************** - CURRENCIES 1 *********************
0029 F* 09            DEALS FILE TRAILER
0030 F* 10            ADDED BY SOMEONE 18NOV80 FOR ERROR 00965
0031 F* 11            CATCHALL FOR OTHER FILES
0026 F**12************TABLE FILE - I.C.D RECORD 5.*********************
0026 F*       13      MULTIBRANCHING OUTPUT INDICATOR                     S01117
     F*      N14     P1 NOT OPENED/WRITTEN TO SO 'NO DETAILS TO REPORT'   S01117
0032 F*    20         DEAL RECORD
0033 F*    21         RETAIL RECORD
0034 F*       30      CCY HAS 0 D.P.
0035 F*       31      CCY HAS 1 D.P.
0036 F*       32      CCY HAS 2 D.P.
0037 F*       33      CCY HAS 3 D.P.
0038 F*       40      BYPASS FIRST CYCLE CALCS
0039 F*       41      INTERIM REPORT
0040 F*       42      IRSOD TRAILER HAS BEEN PROCESSED
0041 F*       43      IRSOR TRAILER HAS BEEN PROCESSED
0042 F*       45      INTEREST IS PAID
0043 F*       60      FILE CONTROLS OUT OF BALANCE
0044 F*******N61******NO*DETAIL*RECORDS*INPUT****************             S01117
0043 F*       70      TAX RATE NOT EQUAL TO ZERO
     F*       71      TAX PAID/RECEIVED THIS MONTH NOT EQUAL TO ZERO      S01383
0045 F*             L1CHANGE OF 'PAID/RECEIVED' INDICATOR
0046 F*             L2CHANGE OF BRANCH
     E                    CPY@    1   1 80
0047 E                    INT         5 15 0
0048 E                    DEC         5  3 0
0049 E                    RECS        4  5 0
0050 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0051 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0052 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0053 I*
0054 I*    SORTED INTEREST REPORT EXTRACT FILE - DEALS
0055 I*
0056 IIREXDICF    01
0058 I*****                                         BRCD  L2M4            S01117
0058 I                                              BRCA  L2M4            S01117
0059 I              PYRC                            PAVR  L1M3
0060 I                                              CASK    M2
0061 I                                              SLID    M1
0062 I                                              ACNO        2121
0063 I                                              DLNO        2020
0063 I              ZZ001                           ZY0073                S01117
0063 I              ZZ035                           ZY0087                S01117
0082 I*
0072 IIREXDZZF    02
0082 I*
0083 I*    SORTED INTEREST REPORT EXTRACT FILE - RETAIL
0084 I*
0085 IIREXRICF    04
0087 I*****                                         BRCD  L2M4            S01117
0087 I                                              BRCA  L2M4            S01117
0088 I              PYRC                            PAYR  L1M3
0089 I                                              CASK    M2
0090 I                                              SLID    M1
0091 I                                              ACNO        2121
0092 I                                              DLNO        2020
0101 I*
0102 IIREXRZZF    05
0112 I*****                                                               S01194
0113 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0114 I*****                                                               S01194
0115 I*ABLE   NS  06   2 C0   3 C1  12 C1                                 S01194
0116 I*****  AND      13 C0                                               S01194
0117 I*****                                   1   1 RECI                  S01194
0118 I*****                                   2   30RECT                  S01194
0119 I*****                                  12  130RCDE                  S01194
0120 I*****                                  14  66 TITL                  S01194
0121 I*****                                  67  67 DATF                  S01194
0122 I*****                                  68  700DFBR                  S01194
0123 I*****                                  74  74 MODI1                 S01194
0124 I*****                                  75  75 MODI2                 S01194
0125 I*****                                  76  76 MODI3                 S01194
0126 I*****                               P  77  790RUND                  S01194
0127 I*****                                  80  86 RUNA                  S01194
0128 I*****                                  87  870SFLG                  S01194
0129 I*****                               P  90  920LCD                   S01194
0130 I*****                                  93  93 CHTP                  S01194
0131 I*****                               P  94  960TNLU                  S01194
0132 I*****                                                               S01194
0133 I*****TABLE FILE - BRANCH CODES RECORD.                              S01194
0134 I*****                                                               S01194
0135 I*ABLE   NS  07   1 CD   2 C1   3 C0                                 S01194
0136 I*****                                   1   1 RECI                  S01194
0137 I*****                                   2   30RECT                  S01194
0138 I*****                                  11  130BRCD                  S01194
0139 I*****                                  14  43 BRNM                  S01194
0140 I*****                                  44  490BICN                  S01194
0141 I*****                                  50  51 LOCC                  S01194
0142 I*****                                  52  53 CMPY                  S01194
0143 I*****                               P  90  920LCD                   S01194
0144 I*****                                  93  93 CHTP                  S01194
0145 I*****                               P  94  960TNLU                  S01194
0112 I*****                                                               S01194
0113 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.               S01194
0114 I*****                                                               S01194
     I*ABLE***NS**12***1*CD   2 C0   3 C1                                 S01194
     I*****  AND      12 C4  13 C0                                        S01194
     I*****                                   1   1 RECI                  S01194
     I************************************P  87  922TAXR                  E81120
     I*****                               P  87  892TAXR           E81120 S01194
0146 I*****                                                               S01194
0147 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0148 I*****                                                               S01194
0149 I*ABLE   NS  08   1 CD   2 C2   3 C0                                 S01194
0150 I*****  AND      13 C1                                               S01194
0151 I*****                                   1   1 RECI                  S01194
0152 I*****                                   2   30RECT                  S01194
0153 I*****                                  10  12 CCY                   S01194
0154 I*****                                  13  130SREC                  S01194
0155 I*****                                  14  27 CCNM                  S01194
0156 I*****                               P  28  348SPOT                  S01194
0157 I*****                                  35  37 CCYS                  S01194
0158 I*****                                  38  380CDP                   S01194
0159 I*****                                  39  390TNOT                  S01194
0160 I*****                                  40  40 DCCY                  S01194
0161 I*****                                  41  44 SRC1                  S01194
0162 I*****                                  45  48 SRC2                  S01194
0163 I*****                                  49  520TACC                  S01194
0164 I*****                                  53  560TEQV                  S01194
0165 I*****                                  57  600SWQV                  S01194
0166 I*****                                  61  640TAC4                  S01194
0167 I*****                                  65  680TAC5                  S01194
0168 I*****                                  69  69 HIND                  S01194
0169 I*****                               P  70  768PART                  S01194
0170 I*****                                  77  780SSNO                  S01194
0171 I*****                               P  79  858ERLC                  S01194
0172 I*****                               P  90  920LCD                   S01194
0173 I*****                                  93  93 CHTP                  S01194
0174 I*****                               P  94  960TNLU                  S01194
0175 I*****                                                               S01194
0176 I*****CATCHALL                                                       S01194
0177 I*****                                                               S01194
0178 I*****   NS  11                                                      S01194
0179 I*                                                                   S01194
0180 I*    DEALS FILE -TRAILER RECORD.
0181 I*
0182 IDEALS   NS  09   1 CT
0183 I                                        1   1 RECI
0184 I                                        2   70DLNO
0185 I                                        8   8 RCDT
0186 I                                        9  100RCDC
0187 I**********                             11  160CNUM                                      CSD027
0187 I                                       11  16 CNUM                                      CSD027
0188 I                                    P  17  190NORE
0189 I                                    P  20  220FLSZ
0190 I                                    P  23  250NLRB
0191 I                                    P  26  280NINS
0192 I                                    P  29  310NDEL
0193 I                                    P  32  340NLRA
0194 I                                    P  35  420VLBF
0195 I                                    P  43  440VLBL
0196 I                                    P  45  520VRIF
0197 I                                    P  53  540VRIL
0198 I                                    P  55  620VRDF
0199 I                                    P  63  640VRDL
0200 I                                    P  65  720VLAF
0201 I                                    P  73  740VLAL
0202 I                                    P  75  770DTMR
0203 I                                    P  78  800ITMR
0204 I                                    P 394 3960LCD
0205 I                                      397 397 CHTP
0206 I                                    P 398 4000TNLU
0207 I*
0208 I*    CATCHALL
0209 I*
0210 I        NS  11
0211 I*
0212 I*    ACCOUNTS MASTER FILE
0213 I*
0214 IACCNT   NS  10   1 CD
0215 I                                    P 160 1660DITM
0216 I                                    P 167 1730CITM
0217 I*
0218 I        NS  11
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM  AOBANKR0                S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I* BRANCH DETAILS ACCESSED VIA ACCESS PROGRAM  AOBRCHR0              S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I* CURRENCY DETAILS ACCESSED VIA ACCESS PROGRAM  AOCURRR0            S01194
     ISDDEAL    E DSSDDEALPD                                              S01194
     I* DEALS DETAILS ACCESSED VIA ACCESS PROGRAM  AODEALR0               S01194
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0219 I            DS
0220 I**********                              1  15 ACKEY                                     CGL029
     I                                        1  21 ACKEY                                     CGL029
0221 I**********                              1   60CNUM                                      CSD027
0221 I                                        1   6 CNUM                                      CSD027
0222 I                                        7   9 CCY
0223 I**********                             10  130ACOD                                      CGL029
0224 I**********                             14  150ACSQ                                      CGL029
     I                                       10  190ACOD                                      CGL029
     I                                       20  210ACSQ                                      CGL029
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     ******************************************************************
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3                       S01117
0225 C*
0225 C*
0226 C*    FIRST CYCLE CALCS
0227 C*
0228 C   40                GOTO DETAIL
0229 C                     SETON                     40
     C                     MOVEACPY@      BIS@   80
0230 C***U7******          SETON                     41                   048933
0231 C***********          SETOF                     U7                   048933
0230 C   U2                SETON                     41                   048933
0232 C*****                EXSR ZSYSTM                                    S01194
0233 C***99                SETON                     U7U8LR
0234 C***99                GOTO END
     C*                                                                   S01194
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE '1'       *IN99                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C           BJDFIN    IFEQ 'M'                                       S01194
     C                     MOVE '1'       *IN98                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
0227 C*
     C*****                MOVE '  40'    ZTABKY
     C*****      ZTABKY    CHAINTABLE                99                   S01194
     C**N12                SETON                     U7U8LR               S01194
     C**N12                GOTO END                                       S01194
     C*****      TAXR      COMP 0                    7070                 S01194
     C*                                                                   S01194
     C** READ DEALS DETAILS VIA ACCESS PROGRAM                            S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE '1'       *IN99                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDDEALPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C**                                                                  S01383
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED     S01383
     C**                                                                  S01383
     C                     CALL 'AOSARDR0'                                S01383
     C                     PARM '       ' @RTCD                           S01383
     C                     PARM '*VERIFY' @OPTN                           S01383
     C                     PARM 'S01383'  @SARD   6                       S01383
     C           @RTCD     IFNE *BLANK                                    S01383
     C           @RTCD     ANDNE'*NRF   '                                 S01383
     C                     OPEN DL1030P1                                  S01383
     C                     MOVE '1'       *IN99                           S01383
     C                     SETON                     U7U8LR               S01383
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01383
     C                     MOVEL'05'      DBASE            * DBERR 05 *   S01383
     C                     MOVEL@RTCD     DBOPTN           ************   S01383
     C                     EXSR *PSSR                                     S01383
     C                     GOTO END                                       S01383
     C                     END                                            S01383
     C           @RTCD     IFEQ *BLANK                                    S01383
     C                     MOVEL'Y'       S01383  1                       S01383
     C                     MOVEL'1'       *IN70                           S01383
     C                     END                                            S01383
     C*                                                                   S01383
     C** IF BRT SAR INSTALLED, ACCESS BRT INSTALLATION CONTROL DATA       S01383
     C*                                                                   S01383
     C           S01383    IFEQ 'Y'                                       S01383
     C                     MOVE 'D'       KRECI   1                       S01383
     C           KRECI     CHAINSDBRTDD0             99                   S01383
     C           *IN99     IFEQ '1'                                       S01383
     C                     OPEN DL1030P1                                  S01383
     C                     SETON                     U7U8LR               S01383
     C                     MOVEL'SDBRTDPD'DBFILE           ************   S01383
     C                     MOVEL'06'      DBASE            * DBERR 06 *   S01383
     C                     MOVEL'D'       DBOPTN           ************   S01383
     C                     EXSR *PSSR                                     S01383
     C                     GOTO END                                       S01383
     C                     END                                            S01383
     C*                                                                   S01383
     C** ELSE IF BRT SAR NOT INSTALLED, CHECK FOR HK INTEREST TAX         S01383
     C*                                                                   S01383
     C                     ELSE                                           S01383
0793 C           BNHKTR    COMP 0                    7070  TAX RATE NOT 0 S01383
     C                     END                                            S01383
     C***********BNHKTR    IFNE 0                                  S01194 S01383
     C***********          MOVE '1'       *IN70                    S01194 S01383
     C***********          END                                     S01194 S01383
     C*                                                                   S01194
0227 C*
0235 C*****                MOVEL'10'      KEYT   12                       S01194
0236 C*****                MOVEL'20'      KCUR   12                       S01194
0237 C*****                MOVE '1'       WRK4    4                       S01194
0238 C                     Z-ADD0         DETREC  50
     C/COPY WNCPYSRC,DL1030C001
     C** GET MONTH-END DATE IF NOT INTERIM RUN                            110252
     C*                                                                   110252
     C           *IN41     IFEQ '0'                                       110252
     C                     MOVE BJMRDT    WRK5    5                       110252
     C                     MOVELWRK5      MONTH   3                       110252
     C*                                                                   110252
     C           BJDNWD    SUB  1         ZDAYNO                          110252
     C                     EXSR ZDATE2                                    110252
     C           ZMNM,ZMTH DOWNEMONTH                                     110252
     C           ZDAYNO    SUB  1         ZDAYNO                          110252
     C                     EXSR ZDATE2                                    110252
     C                     END                                            110252
     C*                                                                   110252
     C                     Z-ADDZDAYNO    @EMTH   50                      110252
     C                     END                                            110252
     C*                                                                   110252
     C*                                                                   S01117
0239 C           DETAIL    TAG                             ** DETAIL TAG *
     C*                                                                   S01117
     C*                                                                   S01117
     C           *INL2     IFEQ '1'                                       S01117
     C                     CLOSEDL1030P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C*                                                                   S01117
     C                     SETON                     13                   S01117
     C                     OPEN DL1030P1                                  S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** IF P1 FILE OPENED THEN SET ON FLAG                               S01117
     C                     MOVE '1'       *IN14                           S01117
     C*                                                                   S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM BRCA      @PARM   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     13                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0240 C***  ADD 1 TO RECORD COUNT FOR HEADERS AND TRAILERS.
0241 C   02
0241 CORN01N04
0243 COR 05      RECRED    ADD  1         RECRED
0244 C   02
0245 COR 05                GOTO TRAIL
0246 C***  BYPASS DETAIL PROCESSING FOR EITHER CATCHALL OR HEADER.
0241 C  N01N04
0248 COR 11                GOTO END
0249 C*****                SETON                     61                   S01117
0250 C                     Z-ADD0         ZERO13 130
0251 C*
0252 C*    ACCUMULATE TOTAL NUMBER AND VALUE OF DETAIL RECORDS READ
0253 C*    FROM EITHER INPUT FILE IN INT,5 DEC,5
0254 C*
0255 C           RECRED    ADD  1         RECRED  50
0256 C                     Z-ADD5         X       10
0257 C**   CHECK IF NEGATIVE INTEREST
0258 C*
0259 C           IPRM      DIV  1000      ZZAMT        17
0260 C                     EXSR HASH
0261 C*
0262 C*    IF NON-INTERIM & RETAIL,ACCESS ACCNT FOR ZERO OF DR/CR INT.
0263 C*
0264 C  N04
0265 COR 41                GOTO INTIM
0266 C*
0267 C           ACKEY     CHAINACCNT                99
0268 C  N10                SETON                     U7U8LR
0269 C  N10                GOTO END
0270 C           INTIM     TAG                             ** INTIM TAG **
0271 C*
0272 C*    ACCUMULATE NUMBER AND VALUE OF DETAIL RECORDS READ FOR EACH
0273 C*    OF THE CATEGORIES --
0274 C*
0275 C*          INTEREST PAID - DEALS,   INT,1  DEC,1
0276 C*          INTEREST PAID - RETAIL,  INT,2  DEC,2
0277 C*          INTEREST RECEIVED - DEALS,  INT,3  DEC,3
0278 C*          INTEREST RECEIVED - RETAIL, INT,4  DEC,4
0279 C*
0280 C   04      PAYR      COMP '1'                      45
0281 C   01      PAVR      COMP 'P'                      45
0282 C*                                                                   S01383
0282 C* IF DEAL AND NON-ZERO TAX AMOUNT, SET ON INDICATOR TO REPORT TAX   S01383
0282 C*                                                                   S01383
     C                     MOVE '0'       *IN71                           S01383
     C           *IN01     IFEQ '1'                                       S01383
     C           TAXM      ANDNE0                                         S01383
     C                     MOVE '1'       *IN71                           S01383
     C                     END                                            S01383
0282 C*
0283 C   20 45             MOVE 1         X
0284 C  N20 45             MOVE 2         X
0285 C   20N45             MOVE 3         X
0286 C  N20N45             MOVE 4         X
0287 C           IPRM      DIV  1000      ZZAMT
0288 C           RECS,X    ADD  1         RECS,X
0289 C                     EXSR HASH
0290 C*
0291 C*    SET INDICATORS ACCORDING TO DECIMAL PLACES OF CURRENCY
0292 C*
0293 C*****                MOVELCCY       WRK4                            S01194
0294 C*****                MOVE WRK4      KCUR                            S01194
0295 C*****      KCUR      CHAINTABLE                99                   S01194
0296 C**N08                SETON                     U7U8LR               S01194
0297 C**N08                GOTO END                                       S01194
0298 C*****      CDP       COMP 1                      3031               S01194
0299 C*****      CDP       COMP 2                    33  32               S01194
     C*                                                                   S01194
     C** READ CURRENCY DETAILS VIA ACCESS PROGRAM                         S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCY       @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE '1'       *IN99                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDCURRPD'DBFILE           ************   S01194
     C                     MOVEL'03'      DBASE            * DBERR 03 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C           A6NBDP    COMP 1                      3031               S01194
     C           A6NBDP    COMP 2                    33  32               S01194
0300 C*
0301 C*    AT CHANGE OF BRANCH, RECOVER BRANCH NAME FROM TABLE FILE
0302 C*
0303 C  NL2                GOTO NOTL2                      *
0304 C*****                MOVE BRCD      KEYT             *              S01194
0305 C*****      KEYT      CHAINTABLE                99    *              S01194
0306 C**N07***             SETON                     U7U8LR*              S01194
0307 C**N07***             GOTO END                        *              S01194
     C*                                                                   S01194
     C** READ BRANCH DETAILS VIA ACCESS PROGRAM                           S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BRCA      @DSNB   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE '1'       *IN99                           S01194
     C                     SETON                     U7U8LR               S01194
     C                     MOVEL'SDBRCHPD'DBFILE           ************   S01194
     C                     MOVEL'04'      DBASE            * DBERR 04 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0308 C           NOTL2     TAG                             ** NOTL2 TAG **
0309 C*
0310 C*    CONVERT 'LAST INTEREST DATE' TO ALPHAMERIC FORMAT
0311 C                     Z-ADDSLID      ZDAYNO
0312 C                     EXSR ZDATE2
0313 C                     MOVE ZADATE    SLIDA   7
0314 C                     GOTO END
0315 C           TRAIL     TAG                             ** TRAIL TAG **
0316 C   02      DETREC    ADD  NORE      DETREC
0317 C   05      DETREC    ADD  NORE      DETREC
0318 C   02                MOVE HRWN      STORI  150
0319 C   02                MOVE HRDC      STORD   30
0320 C   02                SETON                     42
0321 C   05                MOVE HRWN      STORJ  150
0322 C   05                MOVE HRDC      STORE   30
0323 C   05                SETON                     43
0324 C*
0325 C  N42
0326 CORN43                GOTO END
0327 C*    THIS PART DONE WHEN SECOND TRAILER IS PROCESSED
0328 C                     MOVE STORI     ZZTOTI
0329 C                     MOVE STORD     ZZTOTD
0330 C                     MOVE STORJ     ZZAMTI
0331 C                     MOVE STORE     ZZAMTD
0332 C                     EXSR GLZSUM
0333 C                     MOVE ZZTOTI    STORI
0334 C                     MOVE ZZTOTD    STORD
0335 C*
0336 C*    SET ON U8 IF FILE CONTROLS ARE OUT OF BALANCE
0337 C*
0338 C           RECRED    COMP DETREC               6060
0339 C  N60      STORI     COMP INT,5                6060
0340 C  N60      STORD     COMP DEC,5                6060
0341 C   60                SETON                     U8
0342 C           END       TAG                             ** END TAG **
0343 CLRN41      999999    CHAINDEALS                99
0344 CLRN41N09             SETON                     U7U8
     C*                                                                   S01117
     CLR                   Z-ADDSFNUMU    ZSNUM                           S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANKS   ZSERR   1                       S01117
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
0345 C********************************************************************
0346 C           HASH      BEGSR
0347 C                     MOVE INT,X     ZZTOTI
0348 C                     MOVE DEC,X     ZZTOTD
0349 C  N17                EXSR GLZADD
0350 C   17                EXSR GLZSUB
0351 C                     MOVE ZZTOTI    INT,X
0352 C                     MOVE ZZTOTD    DEC,X
0353 C                     ENDSR
0354 C********************************************************************
0355 C* SUBROUTINE TO SUBTRACT AN AMOUNT (ZZAMT) FROM THE TOTAL
0356 C*                                                   (ZZTOTI,ZZTOTD)
0357 C*  IND '99' IS SET BY AN OVERFLOW ERROR
0358 CSR         GLZSUB    BEGSR                           *** GLZSUB ****
0359 C* PROCESSING. JUST REVERSE THE 'SIGN' AND ADD
0360 CSR                   Z-SUBZZAMT     ZZAMT  153       REVERSE 'SIGN'
0361 CSR                   EXSR GLZADD                       AND 'ADD'
0362 CSR                   Z-SUBZZAMT     ZZAMT            RESTORE 'SIGN'
0363 CSR                   ENDSR
0364 C********************************************************************
0365 C**
0366 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0367 C**
0368 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0369 C**
0370 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0371 C**
0372 C**   CLEAR DATE FIELDS.
0373 C                     Z-ADD0         ZDATE   60
0374 C                     MOVEL'       ' ZADATE  7
0375 C**
0376 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0377 C                     Z-ADDZDAYNO    ZDAYNO  50
0378 C**
0379 C**   DETERMINE YEAR NUMBER.
0380 C**
0381 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0382 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0383 C   99                GOTO ZDEND2
0384 C**
0385 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0386 C           ZDAYN1    DIV  1461      ZLYR    20
0387 C                     MVR            ZDAYN1           SAVE REMAINING
0388 C**                                                   DAYS
0389 C**   CALCULATE NUMBER OF REMAINING YEARS.
0390 C                     Z-ADD1         ZWRK2   20
0391 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0392 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0393 C  N90      ZWRK2     ADD  1         ZWRK2
0394 C  N90                GOTO ZDTAG1
0395 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0396 C**
0397 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0398 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0399 C**
0400 C**   CALCULATE ACTUAL YEAR NUMBER.
0401 C           ZLYR      MULT 4         ZWRK3   30
0402 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0403 C                     Z-ADDZWRK3     ZYEAR   20
0404 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0405 C**
0406 C**   DETERMINE MONTH NUMBER.
0407 C**
0408 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0409 C                     SETOF                     9293
0410 C   91      ZDAYN1    COMP 59                     9293
0411 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0412 C**
0413 C**   CALCULATE MONTH NUMBER.
0414 C                     Z-ADD2         ZWRK2
0415 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0416 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0417 C  N94      ZWRK2     ADD  1         ZWRK2
0418 C  N94                GOTO ZDTAG2
0419 C           ZWRK2     SUB  1         ZWRK2
0420 C**
0421 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0422 C**
0423 C**   DETERMINE DAY OF MONTH.
0424 C**
0425 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0426 C           ZDAYN1    ADD  1         ZDAYN1
0427 C**
0428 C**   CALCULATE DAY OF MONTH.
0429 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0430 C**
0431 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0432 C   93      ZDAY      ADD  1         ZDAY
0433 C**
0434 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0435 C  N98                MOVELZDAY      ZWRK4   40
0436 C   98                MOVE ZDAY      ZWRK4
0437 C  N98                MOVE ZMTH      ZWRK4
0438 C   98                MOVELZMTH      ZWRK4
0439 C                     MOVELZWRK4     ZDATE
0440 C                     MOVE ZYEAR     ZDATE
0441 C**
0442 C**   FORMAT ALPHA DATE, DDMMMYY.
0443 C           ZDAY      COMP 10                     95
0444 C                     MOVELZDAY      ZWRK5   5
0445 C   95                MOVEL' '       ZWRK5
0446 C                     MOVE ZMNM,ZMTH ZWRK5
0447 C                     MOVELZWRK5     ZADATE
0448 C                     MOVE ZYEAR     ZADATE
0449 C**
0450 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0451 C**
0452 C********************************************************************
0453 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0454 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0455 C*
0456 CSR         GLZADD    BEGSR                           *** GLZADD ****
0457 C*
0458 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0459 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0460 C*
0461 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0462 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0463 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0464 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0465 C*
0466 CSR                   EXSR GLZSUM
0467 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0468 C*
0469 C********************************************************************
0470 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0471 C*                        GLZADD, GLZSUB, GLZCMP.
0472 C*          PARAMETERS PASSED -
0473 C*                     I/P ZZAMTI ZZAMTD
0474 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0475 C*
0476 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0477 C*
0478 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0479 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0480 CSR                   SETOF                     919293
0481 CSR                   SETOF                     949599
0482 C*
0483 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0484 CSR         ZZAMTI    COMP 0                      9293
0485 CSR 93      ZZAMTD    COMP 0                      9293
0486 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0487 C*
0488 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0489 CSR         ZZTOTI    COMP 0                      9193
0490 CSR 93      ZZTOTD    COMP 0                      9193
0491 C*
0492 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0493 CSR 93                Z-ADDZZAMTI    ZZTOTI
0494 CSR 93                Z-ADDZZAMTD    ZZTOTD
0495 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0496 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0497 CSR 91N92
0498 CORN91 92             GOTO ZZOFPS
0499 C*
0500 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0501 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0502 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0503 C*
0504 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0505 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0506 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0507 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0508 C*
0509 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0510 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0511 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0512 CSRN99                Z-ADDZZWK2     ZZTOTD
0513 CSRN99                Z-ADDZZWK3     ZZTOTI
0514 C*
0515 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0516 CSR 99                Z-ADD0         ZZAMT  153
0517 CSR                   GOTO ZZSEND
0518 C*
0519 C* THE 'SIGNS' ARE DIFFERENT
0520 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0521 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0522 C*
0523 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0524 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0525 C*
0526 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0527 C*
0528 CSR 91                Z-SUBZZTOTI    ZZTOTI
0529 CSR 91                Z-SUBZZTOTD    ZZTOTD
0530 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0531 C*
0532 CSR         ZZTOTI    COMP ZZAMTI               93  95
0533 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0534 C*
0535 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0536 CSR 95                Z-ADD0         ZZTOTI
0537 CSR 95                Z-ADD0         ZZTOTD
0538 CSR 95                GOTO ZZSEND
0539 C*
0540 C* IF ZZTOT GT. ZZAMT.
0541 CSR 93      ZZAMTD    COMP ZZTOTD               94
0542 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0543 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0544 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0545 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0546 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0547 C*
0548 C*
0549 C* IF ZZAMT GT. ZZTOT.
0550 CSRN93      ZZTOTD    COMP ZZAMTD               94
0551 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0552 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0553 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0554 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0555 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0556 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0557 C*
0558 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0559 CSR                   SETOF                     94
0560 CSR 93 91
0561 CORN93 92             SETON                     94
0562 CSR 94                Z-SUBZZTOTI    ZZTOTI
0563 CSR 94                Z-SUBZZTOTD    ZZTOTD
0564 C**
0565 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0566 CSR 92                Z-SUBZZAMTI    ZZAMTI
0567 CSR 92                Z-SUBZZAMTD    ZZAMTD
0568 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0569 C**
0570 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0571 CSR                   SETOF                     96
0572 CSR         ZZTOTD    COMP 0                        91
0573 CSR 91      ZZTOTI    COMP 0                      96
0574 CSR 96                MOVE '.000-'   ZZNEGD  5
0575 CSR                   ENDSR                             ** ENDSR **
0576 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
0577 C*****                                                               S01194
0578 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0579 C*****                                                               S01194
0580 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0581 C*****                                                               S01194
0582 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0583 C*****                MOVEL'01      'ZTABKY 12                       S01194
0584 C*****                MOVE '  10'    ZTABKY                          S01194
0585 C*****                                                               S01194
0586 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0587 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0588 C*****                                                               S01194
0589 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0590 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0591 C*****                                                               S01194
0592 C*****                ENDSR                                          S01194
0593 C*****                                                               S01194
0594 C*****                                                               S01194
0595 C********************************************************************
0596 O*
0597 O*    INTEREST THIS MONTH REPORT
0598 O*
0599 O*L1030P1H**203   L1NLR                                       S01124 S01117
0600 O*      OR**      OFNL1                                              S01117
     O*      OR**      02N61                                              S01117
0599 ODL1030P1H  203   L1NLR 13                                           S01117
0600 O       OR        OFNL1 13                                           S01117
0601 O*****                              22 'REFERENCE DL1030'            S01117
0601 O                                   22 'REFERENCE DL1030P1'          S01117
0602 O*****                    TITL      89                               S01194
0602 O                         BJURPT    89                               S01194
0603 O                                  104 'DATE'
0604 O*****                    RUNA     112                               S01194
0604 O                         BJMRDT   112                               S01194
0605 O                                  122 'PAGE'
0606 O                         PAGE  Z  127
0607 O********D**1     L1NLR                                              S01117
0608 O*******OR**      OFNL1                                              S01117
     O*******OR**      02N61                                              S01117
0607 O        D  1     L1NLR 13
0608 O       OR        OFNL1 13
0609 O                       41          51 'INTERIM'
0610 O                                   73 'INTEREST THIS MONTH -'
0611 O                       45          78 'PAID'
0612 O                      N45          82 'RECEIVED'
0613 O***********                        95 'BRANCH'                      S01117
0614 O***********              BRNM     126                               S01117
0615 O********D**2     L1NLR                                              S01117
0616 O*******OR**      OFNL1                                              S01117
     O*******OR**      02N61                                              S01117
0615 O        D  2     L1NLR 13                                           S01117
0616 O       OR        OFNL1 13                                           S01117
0617 O                       41          51 '*******'
0618 O                                   71 '-------------------'
0615 O        D  2     L1NLR 13                                           S01117
0616 O       OR        OFNL1 13                                           S01117
0615 O                                   12 'BRANCH'                      S01117
0616 O                         BRCA      16                               S01117
0616 O                         A8BRNM    48                               S01194
0619 O********D**1     L1NLR                                              S01117
0620 O*******OR**      OFNL1                                              S01117
     O*******OR**      02N61                                              S01117
0619 O        D  1     L1NLR 13                                           S01117
0620 O       OR        OFNL1 13                                           S01117
0621 O***********************************42 'DEAL    DEAL'                CDL038
     O                                   41 'DEAL    DEAL'                CDL038
0622 O                                   94 'CURRENT       LAST INT'
0623 O                                  112 'INTEREST'
     O                 70               126 'TAX'
0624 O********D**2     L1NLR                                              S01117
0625 O*******OR**      OFNL1                                              S01117
     O*******OR**      02N61                                              S01117
0624 O        D  2     L1NLR 13                                           S01117
0625 O       OR        OFNL1 13                                           S01117
0626 O                                   12 'CUSTOMER'
0627 O***********************************47 'NUMBER   TYPE  CCY'          CDL038
     O                                   49 'NUMBER   TYPE     CCY'       CDL038
0628 O                                   78 'PRINCIPAL         RATE'
0629 O                                  111 'DATE             AMOUNT'
     O                 70               127 'AMOUNT'
0630 O********D**2     01                                                 S01117
0631 O*******OR**1     04                                                 S01117
0630 O        D  2     01    13                                           S01117
0631 O       OR  1     04    13                                           S01117
0632 O                         CNUM       6
0633 O                         CRNM      27
0634 O***********************20DLNO      35                               CDL038
0635 O***********************20DTYP      39                               CDL038
0636 O***********************20          40 '-'                           CDL038
0637 O***********************20DLST      42                               CDL038
     O                       20DLNO      34                               CDL038
     O                       20DTYP      38                               CDL038
     O                       20          39 '-'                           CDL038
     O                       20DLST      41                               CDL038
     O                       20CLAS      45                               CDL038
0638 O*
0639 O                      N20          32 'RET-'
0640 O                   N20 21ACNO      42
0641 O                   N20N21CNUM      38
0642 O*************************CCY       47                               CDL038
     O                         CCY       49                               CDL038
0643 O**********          01 30PAMT  1   65                                                 MD042933
0644 O**********          01 31PAMT      67 '   ,   ,   , 0 . '                             MD042933
0645 O**********          01 32PAMT      68 '  ,   ,   , 0 .  '                             MD042933
0646 O**********          01 33PAMT      69 ' ,   ,   , 0 .   '                             MD042933
0647 O**********             01INTR      83 '  0 .       -'                                 MD042933
     O                    01 30PAMT  1   66                                                 MD042933
     O                    01 31PAMT      68 '   ,   ,   , 0 . '                             MD042933
     O                    01 32PAMT      69 '  ,   ,   , 0 .  '                             MD042933
     O                    01 33PAMT      70 ' ,   ,   , 0 .   '                             MD042933
     O                       01INTR      84 '  0 .       -'                                 MD042933
0648 O                         SLIDA     93
0649 O*******************N70 30IPRM     112 ' ,   ,   ,   , 0 -'          S01383
0650 O*******************N70 31IPRM     114 '   ,   ,   , 0 . -'          S01383
0651 O*******************N70 32IPRM     115 '  ,   ,   , 0 .  -'          S01383
0652 O*******************N70 33IPRM     116 ' ,   ,   , 0 .   -'          S01383
     O******************* 70 30IPRM     111 ' ,   ,   ,   , 0 -'          S01383
0650 O******************* 70 31IPRM     113 '   ,   ,   , 0 . -'          S01383
0651 O******************* 70 32IPRM     114 '  ,   ,   , 0 .  -'          S01383
0652 O******************* 70 33IPRM     115 ' ,   ,   , 0 .   -'          S01383
     O*****************70 01 30TAXM  1  128                               S01383
0650 O*****************70 01 31IPRM     130 '   ,   ,   , 0 . '           E81120
0651 O*****************70 01 32IPRM     131 '  ,   ,   , 0 .  '           E81120
0652 O*****************70 01 33IPRM     132 ' ,   ,   , 0 .   '           E81120
0650 O*****************70 01 31TAXM     130 '   ,   ,   , 0 . '    E81120 S01383
0651 O*****************70 01 32TAXM     131 '  ,   ,   , 0 .  '    E81120 S01383
0652 O*****************70 01 33TAXM     132 ' ,   ,   , 0 .   '    E81120 S01383
     O                       30IPRM     111 ' ,   ,   ,   , 0 -'          S01383
0650 O                       31IPRM     113 '   ,   ,   , 0 . -'          S01383
0651 O                       32IPRM     114 '  ,   ,   , 0 .  -'          S01383
0652 O                       33IPRM     115 ' ,   ,   , 0 .   -'          S01383
     O                 71 01 30TAXM  1  128                               S01383
0650 O                 71 01 31TAXM     130 '   ,   ,   , 0 . '           S01383
0651 O                 71 01 32TAXM     131 '  ,   ,   , 0 .  '           S01383
0652 O                 71 01 33TAXM     132 ' ,   ,   , 0 .   '           S01383
0653 O********D**2     04                                                 S01117
0653 O        D  2     04 13                                              S01117
0654 O**********               ACOD      36                                                   CGL029
0655 O**********                         38 '-'                                               CGL029
0656 O**********               ACSQ      41                                                   CGL029
     O                         ACOD      42                                                   CGL029
     O                                   44 '-'                                               CGL029
     O                         ACSQ      47                                                   CGL029
     O        T  3     L2 13                                              S01117
     O                                   66 '*** END OF REPORT FOR'
     O                                   77 ' BRANCH ***'
     O*********                          66 '*** END OF BRANCH '          S01117
     O*********                          76 'REPORT ***'                  S01117
     O        T        LR U7 U8                                           S01117
     O                                   80 'DATABASE IN ERROR'           S01117
0657 O********T**203   LR                                                 S01117
0657 ODL1030AUT  203   LR                                                 S01117
0658 O***********                        22 'REFERENCE DL1030'            S01117
0658 O                                   22 'REFERENCE DL1030AU'          S01117
0659 O*****                    TITL      89                               S01194
0659 O                         BJURPT    89                               S01194
0660 O                                  104 'DATE'
0661 O*****                    RUNA     112                               S01194
0661 O                         BJMRDT   112                               S01194
0662 O                                  122 'PAGE'
0663 O********                 PAGE  Z  127                               S01117
0663 O                         PAGE1 Z  127                               S01117
0664 O        T  1     LR
0665 O                       41          51 'INTERIM'
0666 O                                   73 'INTEREST THIS MONTH'
0667 O        T  2     LR
0668 O                       41          51 '*******'
0669 O                                   73 '-------------------'
0670 O        T  236   LR
0671 O                                   18 'RUN CONTROLS'
0672 O        T  2     LR
0673 O                                   59 'NUMBER'
0674 O                                   84 'VALUE'
0675 O        T  2     LR
0676 O                                   21 'INTEREST PAID'
0677 O                                   34 '-DEALS'
0678 O                         RECS,13   59
0679 O                         INT,1 Z   81
0680 O                         DEC,1     84
0681 O        T  2     LR
0682 O                                   21 'INTEREST PAID'
0683 O                                   35 '-RETAIL'
0684 O                         RECS,23   59
0685 O                         INT,2 Z   81
0686 O                         DEC,2     84
0687 O        T  2     LR
0688 O                                   25 'INTEREST RECEIVED'
0689 O                                   34 '-DEALS'
0690 O                         RECS,33   59
0691 O                         INT,3 Z   81
0692 O                         DEC,3     84
0693 O        T  2     LR
0694 O                                   25 'INTEREST RECEIVED'
0695 O                                   35 '-RETAIL'
0696 O                         RECS,43   59
0697 O                         INT,4 Z   81
0698 O                         DEC,4     84
0699 O        T  2     LR
0700 O                                   31 'TOTAL RECORDS LISTED IN'
0701 O                                   43 'THIS REPORT'
0702 O                         RECRED3   59
0703 O                         INT,5 Z   81
0704 O                         DEC,5     84
0705 O        T  3     LR
0706 O                                   32 'EXTRACT FILE CONTROL TOT'
0707 O                                   35 'ALS'
0708 O                         DETREC3   59
0709 O                         STORI Z   81
0710 O                         STORD     84
0711 O        T  3     LR 60
0712 O                                   71 '***   DIFFERENCE   ***'
     C*                                                                   S01117
     O        T 3      LRNU7N14                                           S01117
     O                                   63 '***   NO DETAILS TO REPO'    S01117
     O                                   71 'RT   ***'                    S01117
0716 O********T********LR U7 U8                                           S01117
0717 O***********************************22 'REFERENCE DL1030'            S01117
0718 O***********************************62 'PRINT TERMINATED, '          S01117
0719 O***********************************80 'DATABASE IN ERROR'           S01117
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBOPTN    54                               S01117
0720 O******* T 00     LRNU8
0721 O*******                            68 '*** END OF REPORT ***'
0722 O*
0723 O*    DEALS FILE UPDATE
0724 ODEALS   T        LRN41
0725 O*****                    RUND      80P                              S01194
0725 O*****                    BJRDNB    80P                        S01194110252
     O                 41      BJRDNB    80P                              110252
0726 OACCNT   D        04N41
0727 O                         ZERO13   166P
0728 O                         ZERO13   173P
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
