     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Deals by Customer This Month Report')         *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
     F*                                                               *
     F*  DL1060  -  DEALS BY CUSTOMER THIS MONTH PRINT                *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CDL096             Date 22Sep14               *
      *  Prev Amend No. CDL094             Date 11Jun14               *
      *                 CRE073             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER048             Date 19May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CAS009             Date 16May05               *
      *                 CDL033             Date 10Feb05               *
      *                 CAS008             Date 16Jun04               *
      *                 CDL028             Date 07Feb05               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 217684             Date 12May03               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR005             Date 21Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 S01408             DATE 22MAY96               *
     F*                 070810             DATE 23FEB96               *
     F*                 088139             DATE 30MAY95               *
     F*                 088119             DATE 30MAY95               *
     F*                 066721             DATE 21MAR94               *
     F*                 059741             DATE 16NOV93               *
     F*                 048336             DATE 19MAR93               *
     F*                 048933             DATE 19MAR93               *
     F*                 S01378             DATE 15OCT92               *
     F*                 AUS019             DATE 04AUG92               *
     F*                 S01354             DATE 10JAN92               *
     F*                 LN0728             DATE 19SEP90               *
     F*                 LN0643             DATE 13SEP90               *
     F*                 E299               DATE 23MAR90               *
     F*                 E20585             DATE 17JAN90               *
     F*                 E122               DATE 28NOV89               *
     F*                 E120               DATE 28NOV89               *
     F*                 S01194             DATE 14/03/89              *
     F*                 S01117             DATE 14/03/89              *
     F*                 SA1157             DATE 04/10/88              *
     F*                 S01119             DATE 15/06/87              *
     F*                 S01124             DATE 00/00/00              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  CDL033  - Floating Rate CDs Issued.                          *
      *  CAS008 - IAS 39 Enhancements                                 *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CAS006 - Hedge Accounting Phase B                            *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  217684 - Authorisation User Malfunction (Recompile)          *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  CDL008 - Continuous Linked Settlement (Recompiled)           *
      *  CIR005 - FRA/IRS Business Day Conventions to DEALSDG         *
      *           (recompile)                                         *
     F*  S01408 - Core hook DL1060FFP1 added.                         *
     F*           Core hook DL1060IIP1 added.                         *
     F*           Core hook DL1060CCP1 added.                         *
     F*           Core hook DL1060CCP2 added.                         *
     F*           Core hook DL1060OOP1 added.                         *
     F*           Core hook DL1060OOP2 added.                         *
     F*  070810 - Incoming Amount of deal types IT/CD are printed     *
     F*           under column "Outgoing Amount" instead of under     *
     F*           "Incoming Amount".                                  *
     F*  088139 - Include Nostro Transfer deal type in the FX deal    *
     F*           types array.                                        *
     F*  088119 - Include NA Sold deal types (CS, BS, BR, TS, RA, TR) *
     F*           in the MM deal types array.                         *
     F*  066721 - When printing either just 'MM' or 'FX' report and   *
     F*           customer has deals for both, L1 processing does     *
     F*           not work properly.                                  *
     F*  059741 - Value date printed on the report has the first      *
     F*           char printed twice, eq 14JAN93 becomes 114JAN93     *
     F*  048336 - Includes deposit deal type also; first time level   *
     F*           break not catered for properly.                     *
     F*  048933 - Restart recovery processing rewrite.                *
     F*  S01378 - Facilitates the partial sale of a parcel            *
     F*           of negotiable instruments which have been           *
     F*           previously input to the system as a single          *
     F*           transaction. When NAB is entered the parcel         *
     F*           size defines the number of parcels it may be        *
     F*           split into for selling. When NAS is entered         *
     F*           the parcel size defines the number of parcels       *
     F*           being sold by the transaction. Parcel flag          *
     F*           added to EVDCMED. (was MOF53).                      *
     F*  AUS019 - AUSTRALIAN RELEASE - DEALS THIS MONTH BY CUSTOMER   *
     F*  S01354 - Add internal funding deal types                     *
     F*  LN0728 - 'CONSOLIDATED' MISSING FROM THE HEADET              *
     F*  LN0643 - DATABASE ERROR MESSAGE IN DL1060P1 INCORRECTLY      *
     F*           CONDITIONED                                         *
     F*  E299   - 'AU' REPORT SHOULD NOT WRITE 'END OF REPORT'        *
     F*  E20585 - ALL OUTGOING CURRENCY CODE AND OUTGOING AMOUNT      *
     F*           ARE NOT BEING PRINTED FOR CASH OUTGOING DEALS       *
     F*           FOR L/D (E.G. IT,IP,TI AND SO ON) AND ALSO N/A      *
     F*           PURCHASE.                                           *
     F*  E122   - PREVENT P1 OUTPUT WHEN NO DETAILS TO REPORT         *
     F*  E120   - CALL #ZZ TO READ BANK DETAILS IF NO RECORDS READ    *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  S01194 - STANDING DATA CHANGES DERIVED FROM SYNON            *
     F*  SA1157 - (i) FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL'     *
     F*           INTO 'RR' (COLLAR), 'RP' (CAP) AND 'RF' (FLOOR).    *
     F*           DO NOT OUTPUT CEILING RATE IF DEAL TYPE IS 'FR'.    *
     F*           (ii) IF AN FRA, CAP OR COLLAR HAS FIXED RATE        *
     F*           IN 'OUR' DETAILS (UBRTT = 0) THEN IT IS A           *
     F*           PURCHASE, ELSE IT IS A SALE. BUT IF A FLOOR HAS     *
     F*           FIXED RATE IN 'OUR' DETAILS THEN IT IS A SALE,      *
     F*           ELSE IT IS A PURCHASE.                              *
     F*  S01119 - PROCESS FRA/IRS DEALS                               *
     F*                                                               *
     F*****************************************************************
0011 F/SPACE 3
0012 FEVDCS   IP  E           K        DISK
0013 F*EALS***UF**F*****400**6AI*****2*DISK**************************     S01119
     F***DEALS***UF  F     600  6AI     2 DISK                                         S01119 CAS004
     F***DEALS** UF  F    2247  6AI     2 DISK                                         CAS004 CAS005
     F***DEALS** UF  F    2441  6AI     2 DISK                                         CAS005 CAS006
     F***DEALS** UF  F    2448  6AI     2 DISK                                         CAS006 CAS008
     FDEALS   UF  F    2458  6AI     2 DISK                                                   CAS008
0014 F*ABLE***IF**F******96*12AI*****2*DISK**************************     S01194
0015 F*PRINT  O   F     132     OF     PRINTER                            S01124
0015 F*L1060AUO***F*****132*****OA*****PRINTER                     S01194 S01117
0015 F*L1060P1O***F*****132*****OF*****PRINTER                     S01124 S01117
0015 FDL1060AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0015 FDL1060P1O   F     132     OF     PRINTER      KINFDS SPOOL          S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL1060FFP1                                           S01408
     F*                                                                   S01408
0016 F/SPACE 3
0017 F* ID F  C  H  L    FUNCTION OF INDICATORS
0018 F* 01            S/EVCDS - HEADER
0019 F* 02                      DETAIL
0020 F* 03                      TRAILER
0021 F* 04            S/DEALS - TRAILER
     F**05************LF/TABLE - TABTB40*************                     S01194
0022 F*    20         MATURITY DATE ZERO
0023 F*    21         EVENT AMOUNT NEGATIVE
     F*****U7****     INPUT CYCLE RUN                                     048933
     F*    U1         INPUT CYCLE RUN                                     048933
     F* 13            FLOOR DEAL TYPE 'RF'                                SA1157
0024 F*       39      CALL/NOTICE DEAL
0025 F*       40      1ST CYCLE IND.
0026 F*       41      MATURITY IS NOTICE DAYS
     F** E20585 - MISSING DEAL TYPE FOR *IN42                             E20585
     F**          *IN42 AND *IN43 WILL NEVER ON AT THE SAME TIME          E20585
     F**          CAN USE A SINGLE INDICATOR FOR DEAL TYPE                E20585
0027 F********42N43** DEAL TYPE IS-IP,TI,LN,CL OR DL                      E20585
0028 F*******N42*43** DEAL TYPE IS-FP,FS,PI,SI,OP,OT,SW OR PS             E20585
0027 F*       42      DEAL TYPE IS-IP,TI,LN,CL,DL,C1,C2,BP,BD,TB,TA       E20585
     F***************              OR DA.                          E20585 S01354
     F*                            OR DA, IL, OR ID                       S01354
0028 F*       43      DEAL TYPE IS-FP,FS,PI,SI,OP,OT,SW OR PS             E20585
0029 F*      N42N43   OTHER DEAL TYPES
0030 F*       44      NO DETAIL RECORDS
0031 F*       45      DEAL TYPE OP
0032 F*       47      FEDERAL FUND DEAL  ( FRA/IRS - 'OUR' CCY )          S01119
     F*       48      FEDERAL FUND DEAL  ( FRA/IRS - 'THEIR' CCY )        S01119
     F********49******DEAL*TYPE*IS*FRA/IRS*-*FR,RS,RL,RX*          S01119 SA1157
     F*       49      DEAL TYPE IS FRA/IRS - FR,RS,RR,RP,RF,RX            SA1157
0033 F*       50      EVENT AMOUNT - 0 DEC PLACES ( 'OUR' - FRA/IRS )     S01119
0034 F*       51                     1
0035 F*       52                     2
0036 F*       53                     3
     F*       54      MM Deal                                             AUS019
     F*       55      FX Deal                                             AUS019
     F*       56      Print Record read                                   AUS019
0037 F*       60      OTHER AMOUNT - 0 DEC PLACES ( 'THEIR' - FRA/IRS )   S01119
0038 F*       61                     1
0039 F*       62                     2
0040 F*       63                     3
     F*       64      FRA/IRS DEAL TYPE - FLOOR RATE PRESENT              S01119
0041 F*       65      DON'T UPDATE S/DEALS TRAILER
     F*       66      FRA/IRS TYPE RX DEAL                                S01119
     F********67******FRA/IRS*TYPE*RL*DEAL*                        S01119 SA1157
     F*       67      FRA/IRS TYPE RR, RP OR RF DEAL                      SA1157
     F*       68      FRA/CAP/COLLAR/FLOOR SOLD NOT BOUGHT                SA1157
0042 F*       70      WORK IND.
     F*       71      PRINT 'THEIR FIXED RATE' ON REPORT                  S01119
     F*       72      PRINT 'THEIR FLOATING RATE' ON REPORT               S01119
     F*       73      PRINT 'OUR FIXED RATE' ON REPORT                    S01119
     F*       74      PRINT 'OUR FLOATING RATE' ON REPORT                 S01119
     F*       75      WORK INDICATOR                                      AUS019
0043 F*       80      I/P CYCLE RUN
0044 F*          L1   CHANGE OF CUSTOMER NUMBER
     F*          U7U8 DATABASE ERROR
     F*            U8 FILES OUT OF BALANCE
     E                    CPY@    1   1 80
0045 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0046 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0047 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E/COPY WNCPYSRC,DL1060E001
0048 E**
0049 E********************TAB1   12  12  2               DEAL TYPES       S01354
0049 E***********         TAB1   14  14  2               DEAL TYPESS01354 048336
0049 E***********         TAB1   18  18  2               DEAL TYPE 048336 088119
     E**********          TAB1   24  24  2               MM DEAL TYPES    088119              CDL033
     E                    TAB1   25  25  2               MM Deal Types                        CDL033
     E/COPY WNCPYSRC,DL1060E002
0050 E***********         TAB2    9   9  2               DEAL TYPES       088139
     E                    TAB2   10  10  2               FX DEAL TYPES    088139
     E/COPY WNCPYSRC,DL1060E003
     E****                TAB3    4   4  2               FRA/IRS DTYS01119SA1157
     E                    TAB3    6   6  2               FRA/IRS DTYPS    SA1157
     E/COPY WNCPYSRC,DL1060E004
0051 E/EJECT
0052 I* HEADER
0053 IEVDCMHHF    01
0054 I*
0055 IEVDCMEDF    02
0057 I**********************************************CNUM  L1              S01117
0057 I                                              CUNR  L1              S01117
0060 I                                              EAMT          21
0067 I                                              OTHD            20
0074 I*
0075 IEVDCMZZF    03
0079 I*
0082 I*
0083 I*    DEALS FILE -TRAILER RECORD.
0084 I*
0085 IDEALS   NS  04   1 CT
0086 I* CATCHALL
0087 I        NS
0088 I*
0089 I*
0090 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0091 I*****                                                               S01194
0092 I*ABLE***NS*****  2 C0   3 C1  12 C1                                 S01194
0093 I*****  AND      13 C0                                               S01194
0094 I*****                                   1   1 RECI                  S01194
0095 I*****                                   2   30RECT                  S01194
0096 I*****                                  12  130RCDE                  S01194
0097 I*****                                  14  66 TITL                  S01194
0098 I*****                                  67  67 DATF                  S01194
0099 I*****                                  68  700DFBR                  S01194
0100 I*****                                  74  74 MODI1                 S01194
0101 I*****                                  75  75 MODI2                 S01194
0102 I*****                                  76  76 MODI3                 S01194
0103 I*****                               P  77  790RUND                  S01194
0104 I*****                                  80  86 RUNA                  S01194
0105 I*****                                  87  870SFLG                  S01194
0106 I*****                               P  90  920LCD                   S01194
0107 I*****                                  93  93 CHTP                  S01194
0108 I*****                               P  94  960TNLU                  S01194
     I*****                                                        S01119 S01194
     I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.        S01119 S01194
     I*****                                                        S01119 S01194
     I*ABLE***NS**05***1*CD***2 C0   3 C1                          S01119 S01194
     I*****  AND      12 C4  13 C0                                 S01119 S01194
     I*****                                  47  49 USCY           S01119 S01194
0109 I*****                                                               S01194
0110 I**CATCHALL**                                                        S01194
0111 I*****   NS                                                          S01194
0112 I*****                                   1   1 RECI                  S01194
 542 I*
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I* TRADING DETAILS ACCESSED VIA ACCESS PROGRAM                       S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*
0543 I** LOCAL DATA AREA TO IDENTIFY DATABASE ERRORS
 544 I*
0545 I********LDA        UDS                            256
     ILDA         DS                            256
0546 I*****                                 134 138 DBFILE                S01194
0547 I*****                                 139 167 DBKEY                 S01194
0548 I*****                                 168 175 DBPGM                 S01194
0549 I*****                                 176 1770DBASE                 S01194
0546 I                                      134 141 DBFILE                S01194
0547 I                                      142 170 DBKEY                 S01194
0548 I                                      171 180 DBPGM                 S01194
0549 I                                      181 1830DBASE                 S01194
     I*                                                                   S01117
     ISPOOL       DS                                                      S01117
     I**    SPOOL FILE INFORMATION DATA STRUCTURE                         S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 243 2460SWRIT                 S01117
     I@BINRY      DS                                                      S01117
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I                                    B   1   40@BKBIN                S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I**    SPOOL FILE INFORMATION DATA STRUCTURE                         S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     ISCSARD    E DSSCSARDPD                                                                  CDL033
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL1060IIP1                                           S01408
     I*                                                                   S01408
0113 I/EJECT
      *                                                                   S01117
      * ENTRY PARAMETER REQUIRED BY RCF                                   S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           TYPE    2                       AUS019
     C                     PARM           SEQ                             S01117
      *                                                                   S01117
0114 C* 1 S T   C Y C L E   P R O C E S S I N G
0115 C   40                GOTO START
0116 C                     SETON                     4044OF
     C*                                                                   AUS019
     C** Set up indicators for deal type screening                        AUS019
     C           TYPE      IFEQ 'FX'                                      AUS019
     C                     MOVE '1'       *IN54                           AUS019
     C                     MOVE '0'       *IN55                           AUS019
     C                     END                                            AUS019
     C           TYPE      IFEQ 'MM'                                      AUS019
     C                     MOVE '1'       *IN55                           AUS019
     C                     MOVE '0'       *IN54                           AUS019
     C                     END                                            AUS019
     C           TYPE      IFEQ *BLANKS                                   AUS019
     C                     MOVE '0'       *IN55                           AUS019
     C                     MOVE '0'       *IN54                           AUS019
     C                     END                                            AUS019
     C*                                                                   AUS019
0117 C*****                EXSR ZSYSTM                                    S01194
0118 C***U7******          SETON                     80                   048933
0119 C***********          SETOF                     U7                   048933
0118 C   U1                SETON                     80                   048933
     C**
     C** FOR DATABASE ERROR REFERENCE
     C**
     C*********            MOVE 'DL1060  'DBPGM                           SA1157
     C                     MOVEL'DL1060  'DBPGM                           SA1157
     C                     MOVE ' '       BLANKS 29
     C                     MOVE BLANKS    DBKEY
     C                     MOVEACPY@      BIS@   80
     C*****                EXSR ZSYSTM                                    S01194
     C***** 99 MEANS DATABASE ERROR....BYPASS PROCESSING                  S01194
     C***99                SETON                     LRU7U8               S01194
     C***99                MOVE '01'      DBASE                           S01194
     C***99                MOVELZTABKY    DBKEY                           S01194
     C***99                MOVE 'TABLE'   DBFILE                          S01194
     C***99                GOTO END                                       S01194
     C*
     C           *NAMVAR   DEFN           LDA
     C***********          IN   LDA
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     LRU7U8               S01194
     C           *LOCK     IN   LDA
     C                     MOVEL'01'      DBASE            **********     S01194
     C                     MOVEL'*FIRST ' DBOPTN  7        *  001   *     S01194
     C                     MOVEL'*FIRST ' DBKEY            **********     S01194
     C                     MOVEL'SDBANKPD'DBFILE                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*                                                                   S01194
     C***OBTAIN*US*CCY*CODE********                                       S01119
     C*****                MOVEL'01      'USCYKY 12                       S01119
     C*****                MOVE '  40'    USCYKY                          S01119
     C*****      USCYKY    CHAINTABLE                99                   S01119
     C***END IF DATABASE ERROR                                            S01119
     C*****      *IN05     IFEQ '0'                                       S01119
     C*****                SETON                     LRU7U8               S01119
     C*****                MOVE '05'      DBASE                           S01119
     C*****                MOVELUSCYKY    DBKEY                           S01119
     C*****                MOVE 'TABLE'   DBFILE                          S01119
     C*****                GOTO END                                       S01119
     C*****                END                                            S01119
     C** READ TRADING  DETAILS VIA ACCESS PROGRAM                         S01194
     C** TO OBTAIN US CCY CODE                                            S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     SETON                     LRU7U8               S01194
     C           *LOCK     IN   LDA
     C                     MOVE '05'      DBASE            **********     S01194
     C                     MOVEL'*FIRST ' DBOPTN  7        *  005   *     S01194
     C                     MOVEL'*FIRST ' DBKEY            **********     S01194
     C                     MOVEL'SDTRADPD'DBFILE                          S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1060CCP1                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C** Save customer number for comparison to next output record        066721
     C*                                                                   066721
     C                     MOVE CUNR      SAVCUS  6                       066721
     C*                                                                   066721
     C*                                                                   S01119
0120 C/SPACE 2
0121 C* M A I N   P R O C E S S I N G
      *                                                                                       CDL033
      ** Access Switchable Features file and check if CDL033                                  CDL033
      ** is switched on or not.                                                               CDL033
      *                                                                                       CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*VERIFY' @OPTN                                               CDL033
     C                     PARM 'CDL033'  PSARD   6                                           CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVE 'Y'       CDL033  1                                           CDL033
     C                     ELSE                                                               CDL033
     C                     MOVE 'N'       CDL033                                              CDL033
      *                                                                                       CDL033
      ** Database Error, if Return Code is not blanks or *NRF                                 CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE '*NRF   '                                                     CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVEL'007'     DBASE                                               CDL033
     C                     MOVEL'CDL033  'DBKEY                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0122 C           START     TAG                             ** START TAG **
0123 C  N02                GOTO END
0124 C                     SETOF                     44    DETAIL RECORD
     C/COPY WNCPYSRC,DL1060C001
0125 C* CONVERT VALUE DATE
0126 C                     Z-ADDEDAT      ZDAYNO
0127 C                     EXSR ZDATE2
     C**    99 MEANS DATABASE ERROR....BYPASS PROCESSING
     C   99                SETON                     LRU7U8
     C   99      *LOCK     IN   LDA
     C   99                MOVE '02'      DBASE
     C   99                MOVEL'EVENT'   WORK   10
     C   99                MOVE 'DATE'    WORK
     C   99                MOVELWORK      DBKEY
     C   99                MOVE ZDAYNO    DBKEY
     C   99                MOVE 'EVDCS'   DBFILE
     C   99                OUT  LDA
     C   99                GOTO END
0128 C                     MOVE ZADATE    EDATA   7
0129 C*
0130 C*
0131 C*    CHECK DEAL TYPE
0132 C           DTYP      COMP 'CD'                     39
0133 C  N39      DTYP      COMP 'CL'                     39
0134 C  N39      DTYP      COMP 'DL'                     39
0134 C  N39      DTYP      COMP 'IL'                     39               S01354
0134 C  N39      DTYP      COMP 'ID'                     39               S01354
0294 C**                                                                  SA1157
0294 C** SETOF OUTPUT INDICATOR FOR FRA/CAP/COLLAR/FLOOR SALES            SA1157
0294 C**                                                                  SA1157
0294 C                     SETOF                     68                   SA1157
     C                     SETOF                     10                   SA1157
0294 C**                                                                  SA1157
0135 C* CONVERT MATURITY DATE
0136 C           OTHD      COMP 999                  70
0137 C   70                Z-ADDOTHD      ZDAYNO
0138 C   70                EXSR ZDATE2
     C**    99 MEANS DATABASE ERROR....BYPASS PROCESSING
     C   99                SETON                     LRU7U8
     C   99      *LOCK     IN   LDA
     C   99                MOVE '03'      DBASE
     C   99                MOVEL'OTHER'   WORK   10
     C   99                MOVE 'DATE'    WORK
     C   99                MOVELWORK      DBKEY
     C   99                MOVE ZDAYNO    DBKEY
     C   99                MOVE 'EVDCS'   DBFILE
     C   99                OUT  LDA
     C   99                GOTO END
0139 C                     SETOF                     41
0140 C  N70N20             SETON                     41
0141 C  N70N20             Z-ADDOTHD      DAYS    30
0142 C* DECIMAL PLACES EVENT AMOUNT
     C*                   - OUR PRINCIPAL AMOUNT FOR FRA/IRS              S01119
0143 C           ECDP      COMP 1                      5051
0144 C           ECDP      COMP 2                    53  52
0145 C* DECIMAL PLACES OTHER AMOUNT
     C*                   - THEIR PRINCIPAL AMOUNT FOR FRA/IRS            S01119
0146 C           OCDP      COMP 1                      6061
0147 C           OCDP      COMP 2                    63  62
0148 C* IS DEAL FEDERAL FUND
0149 C           FFIN      COMP 'F'                      47
     C**                                                                  S01119
     C                     SETOF                     48                   S01119
     C* IF DEAL = FEDERAL FUND, DETERMINE WHETHER 'OUR' OR 'THEIR'        S01119
     C* CURRENCY FOR FRA/IRS DEAL TYPE RX.                                S01119
     C           *IN47     IFEQ '1'                                       S01119
     C           DTYP      ANDEQ'RX'                                      S01119
     C*****      OTHC      IFEQ USCY                               S01119 S01194
     C           OTHC      IFEQ BLUSCY                                    S01194
     C                     MOVEA'01'      *IN,47                          S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C**                                                                  S01119
0150 C*
0151 C* SET DEAL TYPE INDICATORS
0152 C                     SETOF                     424345
     C                     SETOF                     49                   S01119
0153 C           DTYP      LOKUPTAB1                     70
0154 C***70******          SETON                     42                   070810
      *                                                                   070810
      **  If a Money Market deal, check if it is a deposit.  If so,       070810
      **  print amount in "Incoming Amount" column, otherwise print       070810
      **  amount in "Outgoing Amount" column.                             070810
      *                                                                   070810
     C           *IN70     IFEQ '1'                                       070810
      *                                                                   070810
     C           DTYP      IFEQ 'IT'                                      070810
     C           DTYP      OREQ 'TD'                                      070810
     C           DTYP      OREQ 'CI'                                      070810
     C/COPY WNCPYSRC,DL1060C002
     C           DTYP      OREQ 'CF'                                                          CDL033
     C           CDL033    ANDEQ'Y'                                                           CDL033
     C           DTYP      OREQ 'CD'                                      070810
     C                     MOVE '0'       *IN42                           070810
     C                     ELSE                                           070810
     C                     MOVE '1'       *IN42                           070810
     C                     END                                            070810
      *                                                                   070810
     C                     END                                            070810
      *                                                                   070810
0155 C   70                GOTO CONTRL
0156 C           DTYP      LOKUPTAB2                     70
0157 C   70                SETON                     43
0158 C           DTYP      COMP 'OP'                     45
     C   70                GOTO CONTRL                                    S01119
     C           DTYP      LOKUPTAB3                     70               S01119
     C   70                SETON                     49                   S01119
     C**  DETERMINE RATE(S) FOR FRA/IRS DEALS                             S01119
     C           *IN49     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C                     Z-ADDRATE      UEINR  117                      S01119
     C*                                                                   S01119
     C* CHECK IF THEIR FIXED RATE IS TO BE SHOWN                          S01119
     C           TEIIND    COMP 'Y'                      71               S01119
     C* CHECK IF THEIR FLOATING RATE IS TO BE SHOWN                       S01119
     C           TBRIND    COMP 'Y'                      72               S01119
     C* CHECK IF OUR FLOATING RATE IS TO BE SHOWN                         S01119
     C           UEIIND    COMP 'Y'                      73               S01119
     C* CHECK IF OUR FLOATING RATE IS TO BE SHOWN                         S01119
     C           UBRIND    COMP 'Y'                      74               S01119
     C**                                                                  S01119
     C**FOR*TYPE*'RL'*-*CEILING*RATE*SHOWN*                         S01119SA1157
     C* FOR TYPE 'RR', 'RP' OR 'RF' - CEILING RATE SHOWN            S01119SA1157
     C* UNLESS 'RF' IN WHICH CASE SHOW FLOOR RATE IN CEILING RATES        SA1157
     C* PLACE - SUPPRESS FLOOR RATE IN NORMAL PLACE                       SA1157
     C*                                                                   S01119
     C**         DTYP      COMP 'RL'                     67        S01119 SA1157
     C           DTYP      COMP 'RR'                     67               SA1157
     C  N67      DTYP      COMP 'RP'                     67               SA1157
     C  N67      DTYP      COMP 'RF'                     67               SA1157
     C           DTYP      COMP 'RF'                     38               SA1157
     C*                                                                   S01119
     C* CHECK IF FLOOR RATE IS TO BE SHOWN                                S01119
     C*                                                                   S01119
     C           FLRIND    COMP 'Y'                      64               S01119
     C**                                                                  S01119
     C* FOR TYPE 'RX' - SECOND (THEIR) CURRENCY & AMOUNT SHOWN            S01119
     C*                                                                   S01119
     C           DTYP      COMP 'RX'                     66               S01119
     C**                                                                  S01119
0291 C**   FRA'S, CAPS AND COLLARS SHOWN UNDER PURCHASES WHEN 'OUR        SA1157
0291 C**   BASE RATE TYPE' (UBRTT) EQUALS ZERO - OTHERWISE UNDER SALES.   SA1157
0291 C**   FLOORS SHOWN UNDER PURCHASES WHEN 'OUR BASE RATE TYPE'         SA1157
0291 C**   (UBRTT) IS NOT EQUAL TO ZERO - OTHERWISE UNDER SALES.          SA1157
0290 C*                                                                   SA1157
0292 C           DTYP      IFEQ 'FR'                       DEAL IS FRA,   SA1157
0293 C           UBRTT     ANDNE0                          SOLD           SA1157
0292 C           DTYP      OREQ 'RP'                       CAP OR COLLAR  SA1157
0293 C           UBRTT     ANDNE0                          SOLD           SA1157
0292 C           DTYP      OREQ 'RR'                                      SA1157
0293 C           UBRTT     ANDNE0                          SOLD           SA1157
0290 C*                                                                   SA1157
0292 C           DTYP      OREQ 'RF'                       DEAL IS A FLOORSA1157
0293 C           UBRTT     ANDEQ0                          FLOOR SOLD     SA1157
0294 C                     SETON                     68    OUTPUT IND.    SA1157
     C*                                                                   SA1157
     C* SET UP BUY/SELL INDICATOR FOR SOLD                                SA1157
     C*                                                                   SA1157
     C                     MOVE 'S'       BYSL    1                       SA1157
     C                     MOVE '1'       *IN10                           SA1157
     C*                                                                   SA1157
0295 C                     END                                            SA1157
     C*                                                                   SA1157
     C* SET UP BUY/SELL INDICATOR FOR BOUGHT                              SA1157
     C*                                                                   SA1157
0292 C           DTYP      IFEQ 'FR'                       DEAL IS FRA,   SA1157
0293 C           TBRTT     ANDNE0                          BOUGHT         SA1157
0292 C           DTYP      OREQ 'RP'                       CAP OR COLLAR  SA1157
0293 C           TBRTT     ANDNE0                          BOUGHT         SA1157
0292 C           DTYP      OREQ 'RR'                                      SA1157
0293 C           TBRTT     ANDNE0                          BOUGHT         SA1157
0290 C*                                                                   SA1157
0292 C           DTYP      OREQ 'RF'                       DEAL IS A FLOORSA1157
0293 C           TBRTT     ANDEQ0                          FLOOR BOUGHT   SA1157
     C                     MOVE 'B'       BYSL    1                       SA1157
     C                     MOVE '1'       *IN10                           SA1157
0295 C                     END                                            SA1157
0290 C*                                                                   SA1157
     C                     END                                            S01119
     C**                                                                  S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1060CCP2                                           S01408
     C*                                                                   S01408
0159 C*
0160 C* C O N T R O L S
0161 C           CONTRL    TAG                             ** CONTRL TAG**
0162 C           RECIN     ADD  1         RECIN   50
0163 C           EAMT      DIV  1000      ZZAMT
0164 C   21                Z-SUBZZAMT     ZZAMT
0165 C                     EXSR GLZADD
     C*                                                                   AUS019
     C** If record read is not the same as TYPE passed as parameter,      AUS019
     C** do not print record                                              AUS019
     C           TYPE      IFNE *BLANKS                                   AUS019
     C*                                                                   AUS019
     C           TYPE      IFEQ 'MM'                                      AUS019
     C           DTYP      LOKUPTAB1                     75               AUS019
     C                     END                                            AUS019
     C*                                                                   AUS019
     C           TYPE      IFEQ 'FX'                                      AUS019
     C           DTYP      LOKUPTAB2                     75               AUS019
     C                     END                                            AUS019
     C*                                                                   AUS019
     C           *IN75     IFEQ '1'                                       AUS019
     C                     MOVE '1'       *IN56                           AUS019
     C*                                                                   066721
     C** Check whether new customer details should be output              066721
     C*                                                                   066721
     C           CUNR      IFNE SAVCUS                                    066721
     C                     SETON                         L1               066721
     C                     MOVE CUNR      SAVCUS                          066721
     C                     END                                            066721
     C*                                                                   066721
     C                     ELSE                                           AUS019
     C                     MOVE '0'       *IN56                           AUS019
     C                     END                                            AUS019
     C*                                                                   AUS019
     C                     ELSE                                           AUS019
     C                     MOVE '1'       *IN56                           AUS019
     C*                                                                   AUS019
     C                     END                                            AUS019
     C*                                                                   AUS019
0166 C           END       TAG                             **  END TAG  **
0167 C/SPACE 2
     C** IN CASE OF DATABASE ERROR
     CLR U7 U8             GOTO VEND
0168 CLR                   Z-ADDHRWN      ZZINT
0169 CLR                   Z-ADDHRDC      ZZDEC
0170 CLR                   EXSR GLZCMP
0171 CLR         ZZDIFI    COMP 0                    U8U8
0172 CLRNU8      ZZDIFD    COMP 0                    U8U8
0173 CLR         NORE      SUB  2         NORE
0174 CLRNU8      RECIN     COMP NORE                 U8U8
0175 CLR                   MOVE '999999'  DLKEY   6
0176 CLR 80
0177 COR U8                SETON                     65
     CLRN65                SETOF                     0470
0178 CLRN65      DLKEY     CHAINDEALS                70
     C** N65 N04 MEANS DATABASE ERROR....BYPASS PROCESSING
     CLRN65N04             SETON                     LRU7U8
     CLRN65N04   *LOCK     IN   LDA
     CLRN65N04             MOVE '04'      DBASE
     CLRN65N04             MOVELDLKEY     DBKEY
     CLRN65N04             MOVE 'DEALS'   DBFILE
     CLRN65N04             OUT  LDA
     CLR         VEND      TAG
     C*                                                                   S01117
     C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   S01117
     C** TO. SWRIT IS INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       S01117
     C** FILE - IF IT IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    S01117
     C** THE FILE. UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     S01117
     C** AN UNITIALISED BINARY FIELD.                                     S01117
     CLR         SWRIT     IFNE 0                                         S01117
     CLR         SWRIT     ANDNE@BKBIN                                    S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     C*R*******            OUT  LDA
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANKS   ZSERR   1                       S01117
     C*R********           IN   LDA
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR                   Z-ADDSFNUMU    ZSNUM                           S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF                                S01117
     C*R********           OUT  LDA
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANKS   ZSERR   1                       S01117
     C*R*********          IN   LDA
     C*                                                                   S01117
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*
     C** IF NO DETAILS THEN CALL #ZZ FOR HEADING/DATE ETC. FOR REPORT     E120
     CLR         *IN44     IFEQ '1'                                       E120
     CLR                   EXSR #ZZ                                       E120
     CLR                   END                                            E120
     C*                                                                   E120
0179 C/EJECT
0180 C********************************************************************
0181 C**
0182 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0183 C**
0184 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0185 C**
0186 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0187 C**
0188 C**   CLEAR DATE FIELDS.
0189 C                     Z-ADD0         ZDATE   60
0190 C                     MOVEL'       ' ZADATE  7
0191 C**
0192 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0193 C                     Z-ADDZDAYNO    ZDAYNO  50
0194 C**
0195 C**   DETERMINE YEAR NUMBER.
0196 C**
0197 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0198 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0199 C   99                GOTO ZDEND2
0200 C**
0201 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0202 C           ZDAYN1    DIV  1461      ZLYR    20
0203 C                     MVR            ZDAYN1           SAVE REMAINING
0204 C**                                                   DAYS
0205 C**   CALCULATE NUMBER OF REMAINING YEARS.
0206 C                     Z-ADD1         ZWRK2   20
0207 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0208 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0209 C  N90      ZWRK2     ADD  1         ZWRK2
0210 C  N90                GOTO ZDTAG1
0211 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0212 C**
0213 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0214 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0215 C**
0216 C**   CALCULATE ACTUAL YEAR NUMBER.
0217 C           ZLYR      MULT 4         ZWRK3   30
0218 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0219 C                     Z-ADDZWRK3     ZYEAR   20
0220 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0221 C**
0222 C**   DETERMINE MONTH NUMBER.
0223 C**
0224 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0225 C                     SETOF                     9293
0226 C   91      ZDAYN1    COMP 59                     9293
0227 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0228 C**
0229 C**   CALCULATE MONTH NUMBER.
0230 C                     Z-ADD2         ZWRK2
0231 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0232 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0233 C  N94      ZWRK2     ADD  1         ZWRK2
0234 C  N94                GOTO ZDTAG2
0235 C           ZWRK2     SUB  1         ZWRK2
0236 C**
0237 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0238 C**
0239 C**   DETERMINE DAY OF MONTH.
0240 C**
0241 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0242 C           ZDAYN1    ADD  1         ZDAYN1
0243 C**
0244 C**   CALCULATE DAY OF MONTH.
0245 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0246 C**
0247 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0248 C   93      ZDAY      ADD  1         ZDAY
0249 C**
0250 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0251 C  N98                MOVELZDAY      ZWRK4   40
0252 C   98                MOVE ZDAY      ZWRK4
0253 C  N98                MOVE ZMTH      ZWRK4
0254 C   98                MOVELZMTH      ZWRK4
0255 C                     MOVELZWRK4     ZDATE
0256 C                     MOVE ZYEAR     ZDATE
0257 C**
0258 C**   FORMAT ALPHA DATE, DDMMMYY.
0259 C           ZDAY      COMP 10                     95
0260 C                     MOVELZDAY      ZWRK5   5
0261 C   95                MOVEL' '       ZWRK5
0262 C                     MOVE ZMNM,ZMTH ZWRK5
0263 C                     MOVELZWRK5     ZADATE
0264 C                     MOVE ZYEAR     ZADATE
0265 C**
0266 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0267 C**
0268 C**
0269 C********************************************************************
0270 C/SPACE 3
0271 C********************************************************************
0272 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0273 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0274 C*
0275 CSR         GLZADD    BEGSR                           *** GLZADD ****
0276 C*
0277 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0278 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0279 C*
0280 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0281 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0282 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0283 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0284 C*
0285 CSR                   EXSR GLZSUM
0286 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0287 C*
0288 C********************************************************************
0289 C* SUBROUTINE TO COMPARE AN AMOUNT TO THE TOTAL.
0290 C*      PARAMETERS. I/P - ZZINT - THE INTEGER PORTION OF THE NUMBER.
0291 C*                  I/P - ZZDEC - THE DECIMAL PORTION OF THE NUMBER.
0292 C*                  O/P - ZZDIFI - IS THE INTEGER DIFFERENCE.
0293 C*                  O/P - ZZDIFD - IS THE DECIMAL DIFFERENCE.
0294 C*                  O/P - ZZNEGD - FOR IMMEDIATE PRINTING ONLY.
0295 C*                  O/P - 96 IS SET IF DIFFERENCE IS NEGATIVE.
0296 C*
0297 C*    IF AN ERROR HAS OCCURED ZZDIFI AND ZZDIFD WILL BE ZERO.
0298 C*        '99' - OVERFLOW ERROR
0299 C*        '97' - THE 'SIGN' ZONES OF ZZINT AND ZZDEC ARE DIFFERENT
0300 C*
0301 CSR         GLZCMP    BEGSR                           *** GLZCMP ****
0302 CSR                   SETOF                     9799
0303 CSR                   Z-ADDZZDEC     ZZDEC   30 919293DEFINE ZZDEC
0304 CSR                   Z-ADDZZINT     ZZINT  150 949596DEFINE ZZINT
0305 C* IF SIGN ZONES DIFFER, SET 97, & RETURN ZERO.
0306 CSR 91 95
0307 COR 92 94             SETON                     97    ERROR -MIXED
0308 C*                                                           STATUS
0309 CSR 97                GOTO ZZQUIT                     BRANCH TO ADMIT
0310 C*
0311 C*  SPECIAL CASES DEALT WITH FIRST
0312 C*      EITHER AMOUNTS EQ '0' OR BOTH AMOUNTS 'EQ'
0313 CSR                   SETOF                     9192
0314 CSR                   SETOF                     9495
0315 CSR 93 96             SETON                     91    * IF I/P FIELD
0316 CSR 91                Z-ADDZZTOTI    ZZDIFI 150       *    ZERO
0317 CSR 91                Z-ADDZZTOTD    ZZDIFD  30       *
0318 CSR 91                GOTO ZZSIGN
0319 C*
0320 CSR         ZZTOTI    COMP ZZINT                    91* IF FIELDS EQ
0321 CSR 91      ZZTOTD    COMP ZZDEC                    91*
0322 CSR 91                Z-ADD0         ZZDIFI           *
0323 CSR 91                Z-ADD0         ZZDIFD           *
0324 CSR 91                GOTO ZZCEND
0325 C*
0326 CSR         ZZTOTI    COMP 0                        91* IF TOTAL
0327 CSR 91      ZZTOTD    COMP 0                        91*    ZERO
0328 CSR 91                Z-SUBZZINT     ZZDIFI           *
0329 CSR 91                Z-SUBZZDEC     ZZDIFD           *
0330 C**
0331 CSR         ZZSIGN    TAG                             *** ZZSIGN ****
0332 C*
0333 C**   IF ZZDIFD IS ZERO, AND ZZDIFI IS NEG. SET UP ZZNEGD.
0334 CSR                   SETOF                     96
0335 CSR 91      ZZDIFD    COMP 0                        94
0336 CSR 94      ZZDIFI    COMP 0                      96
0337 CSR 96                MOVE '.000-'   ZZNEGD  5
0338 CSR 91                GOTO ZZCEND
0339 C*      END OF SPECIAL CASES
0340 C*
0341 C* IF ZZTOTALS EQ 'B' AND ZZINT,ZZDEC EQ 'A'   THEN -
0342 C*  TO COMPARE 'A' WITH 'B'
0343 C*     1. STORE ORIGINAL VALUE OF 'B'.
0344 C*     2. NEGATE 'A'.
0345 C*     3. ADD 'A' TO 'B'.
0346 C*     4. 'B' IS NOW THE DIFFERENCE. STORE 'B' IN FIELD 'C'.
0347 C*     5. RESTORE 'B'.
0348 C*            N.B. 'A' EQ ZZINT AND ZZDEC
0349 C*                 'B' EQ ZZTOTI AND ZZTOTD
0350 C*                 'C' EQ ZZDIFI AND ZZDIFD
0351 C*
0352 C*    STEP #1
0353 CSR                   Z-ADDZZTOTI    ZZSTRI 150
0354 CSR                   Z-ADDZZTOTD    ZZSTRD  30
0355 C*    STEP #2
0356 CSR                   Z-SUBZZINT     ZZAMTI 150
0357 CSR                   Z-SUBZZDEC     ZZAMTD  30
0358 C*    STEP #3
0359 CSR                   EXSR GLZSUM
0360 CSR 99                GOTO ZZQUIT
0361 C*    STEP #4
0362 CSR                   Z-ADDZZTOTI    ZZDIFI
0363 CSR                   MOVE ZZTOTD    ZZDIFD
0364 C*    STEP #5
0365 CSR                   Z-ADDZZSTRI    ZZTOTI 150
0366 CSR                   Z-ADDZZSTRD    ZZTOTD  30
0367 CSR                   GOTO ZZCEND                     BYPASS ADMIT
0368 CSR         ZZQUIT    TAG                             ** ZZQUIT TAG**
0369 CSR                   Z-ADD0         ZZDIFI
0370 CSR                   Z-ADD0         ZZDIFD
0371 CSR         ZZCEND    ENDSR                           ** ZZCEND TAG**
0372 C*
0373 C********************************************************************
0374 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0375 C*                        GLZADD, GLZSUB, GLZCMP.
0376 C*          PARAMETERS PASSED -
0377 C*                     I/P ZZAMTI ZZAMTD
0378 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0379 C*
0380 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0381 C*
0382 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0383 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0384 CSR                   SETOF                     919293
0385 CSR                   SETOF                     949599
0386 C*
0387 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0388 CSR         ZZAMTI    COMP 0                      9293
0389 CSR 93      ZZAMTD    COMP 0                      9293
0390 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0391 C*
0392 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0393 CSR         ZZTOTI    COMP 0                      9193
0394 CSR 93      ZZTOTD    COMP 0                      9193
0395 C*
0396 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0397 CSR 93                Z-ADDZZAMTI    ZZTOTI
0398 CSR 93                Z-ADDZZAMTD    ZZTOTD
0399 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0400 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0401 CSR 91N92
0402 CORN91 92             GOTO ZZOFPS
0403 C*
0404 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0405 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0406 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0407 C*
0408 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0409 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0410 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0411 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0412 C*
0413 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0414 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0415 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0416 CSRN99                Z-ADDZZWK2     ZZTOTD
0417 CSRN99                Z-ADDZZWK3     ZZTOTI
0418 C*
0419 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0420 CSR 99                Z-ADD0         ZZAMT  153
0421 CSR                   GOTO ZZSEND
0422 C*
0423 C* THE 'SIGNS' ARE DIFFERENT
0424 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0425 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0426 C*
0427 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0428 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0429 C*
0430 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0431 C*
0432 CSR 91                Z-SUBZZTOTI    ZZTOTI
0433 CSR 91                Z-SUBZZTOTD    ZZTOTD
0434 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0435 C*
0436 CSR         ZZTOTI    COMP ZZAMTI               93  95
0437 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0438 C*
0439 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0440 CSR 95                Z-ADD0         ZZTOTI
0441 CSR 95                Z-ADD0         ZZTOTD
0442 CSR 95                GOTO ZZSEND
0443 C*
0444 C* IF ZZTOT GT. ZZAMT.
0445 CSR 93      ZZAMTD    COMP ZZTOTD               94
0446 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0447 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0448 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0449 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0450 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0451 C*
0452 C*
0453 C* IF ZZAMT GT. ZZTOT.
0454 CSRN93      ZZTOTD    COMP ZZAMTD               94
0455 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0456 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0457 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0458 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0459 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0460 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0461 C*
0462 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0463 CSR                   SETOF                     94
0464 CSR 93 91
0465 CORN93 92             SETON                     94
0466 CSR 94                Z-SUBZZTOTI    ZZTOTI
0467 CSR 94                Z-SUBZZTOTD    ZZTOTD
0468 C**
0469 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0470 CSR 92                Z-SUBZZAMTI    ZZAMTI
0471 CSR 92                Z-SUBZZAMTD    ZZAMTD
0472 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0473 C**
0474 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0475 CSR                   SETOF                     96
0476 CSR         ZZTOTD    COMP 0                        91
0477 CSR 91      ZZTOTI    COMP 0                      96
0478 CSR 96                MOVE '.000-'   ZZNEGD  5
0479 CSR                   ENDSR                             ** ENDSR **
0480 C********************************************************************
0481 C/SPACE 3
0482 C********************************************************************
0483 C*****                                                               S01194
0484 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0485 C*****                                                               S01194
0486 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0487 C*****                                                               S01194
0488 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0489 C*****                MOVEL'01      'ZTABKY 12                       S01194
0490 C*****                MOVE '  10'    ZTABKY                          S01194
0491 C*****                                                               S01194
0492 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0493 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0494 C*****                                                               S01194
0495 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0496 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0497 C*****                                                               S01194
0498 C*****                ENDSR                                          S01194
0499 C*****                                                               S01194
0500 C********************************************************************
     C**                                                                  S01194
     C*  ERROR DUMP SUB-ROUTINE                                           S01194
     C           *PSSR     BEGSR                           *** *PSSR  *** S01194
     C**                                                                  S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     OUT  LDA
     C                     END                                            S01194
     C                     ENDSR                           * *PSSR  ENDSR*S01194
     C**                                                                  S01194
     C********************************************************************
     C*                                                                   E120
     C* SUBROUTINE : #ZZ                                                  E120
     C*                                                                   E120
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       E120
     C* NO RECORDS READ AND THEREFORE SDBANKPD NOT READ                   E120
     C*                                                                   E120
     C           #ZZ       BEGSR                                          E120
     C*                                                                   E120
     C** IF FIRST CYCLE NOT PERFORMED GET BANK DETAILS FOR HEADINGS       E120
     C*                                                                   E120
     C                     CALL 'AOBANKR0'                                E120
     C                     PARM '*MSG   ' @RTCD   7                       E120
     C                     PARM '*FIRST ' @OPTN   7                       E120
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    E120
     C           *LOCK     IN   LDA
     C                     MOVEL'SDBANKPD'DBFILE           ************   E120
     C                     MOVEL'06'      DBASE            * DBERR 06 *   E120
     C                     MOVEL@OPTN     DBOPTN           ************   E120
     C                     SETON                     U7U8LR               E120
     C                     EXSR *PSSR                                     E120
     C                     GOTO #ZZ9                                      E120
     C                     END                                            E120
     C*                                                                   E120
     C           #ZZ9      ENDSR                                          E120
0597 C*****************************************************************   E120
0501 C/EJECT
0502 O*PRINT  H  203   OF                                                 S01124
0502 O*L1060P1H  203   OF                                          S01124 E122
0502 ODL1060P1H  203   OF 02                                              E122
0503 O*****                              22 'REFERENCE DL1060'            S01117
0503 O                                   24 'REFERENCE DL1060P1'          S01117
0504 O*****                    TITL      89                               S01194
0504 O                         BJURPT    89                               S01194
0505 O                                  122 'DATE              PAGE'
0506 O*****                    RUNA     112                               S01194
0506 O                         BJMRDT   112                               S01194
0507 O                         PAGE  Z  127
0508 O*****   H  1     OF                                                 E122
0508 O        H  1     OF 02                                              E122
0509 O                       80          47 'INTERIM'
     O                 54N55             53 'F.X. '                       AUS019
     O                 55N54             53 'M.M. '                       AUS019
0510 O***********************************72 'DEALS BY CUSTOMER THIS M'    AUS019
0511 O***********************************76 'ONTH'                        AUS019
     O                                   77 'DEALS BY CUSTOMER THIS M'    AUS019
     O                                   81 'ONTH'                        AUS019
0512 O*****   H  2     OF                                                 E122
0512 O        H  2     OF 02                                              E122
0513 O                       80          47 '*******'
     O                 54N55             53 '-----'                       AUS019
     O                 55N54             53 '-----'                       AUS019
0514 O***********************************72 '------------------------'    AUS019
0515 O***********************************76 '----'                        AUS019
     O                                   77 '------------------------'    AUS019
     O                                   81 '----'                        AUS019
0508 O*****   H  1     OF                                                 E122
0508 O        H  1     OF 02                                              E122
0517 O                                   16 'CONSOLIDATED'                LN0728
0517 O***********************************49 'DEAL   DEAL   VALUE'         CDL038
0518 O***********************************60 'MATURITY'                    CDL038
     O                                   41 'DEAL   DEAL'                 CDL038
     O                                   54 'VALUE'                       CDL038
     O                                   64 'MATURITY'                    CDL038
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL1060OOP1                                           S01408
     O*                                                                   S01408
0519 O                                   86 'INCOMING'
0520 O**********************************128*'OUTGOING'*********           S01119
     O                                  130 'OUTGOING'                    S01119
0512 O*****   H  2     OF                                                 E122
0512 O        H  2     OF 02                                              E122
0522 O                                   12 'CUSTOMER'
0523 O***********************************49 'NUMBER  TYPE    DATE'        CDL038
0524 O***********************************67 'DATE  F/F CCY'               CDL038
     O                                   41 'NUMBER  TYPE'                CDL038
     O                                   54 'DATE'                        CDL038
     O                                   69 'DATE  F CCY'                 CDL038
0525 O                                   96 'AMOUNT      RATE'
0526 O**********************************128*'CCY              AMOUNT'     S01119
     O                                  130 'CCY             AMOUNT'      S01119
     O/COPY WNCPYSRC,DL1060O001
0527 O*
0528 O********D*11*****02*L1************************************          S01119
     O********DF11     02 L1                                       S01119 AUS019
0529 O*******OR 01     02NL1                                              AUS019
     O        DF11     02 L1 56                                           AUS019
0529 O       OR 01     02NL1 56                                           AUS019
0530 O***********************L1CNUM       6                               S01117
0530 O                       L1CUNR       6                               S01117
0531 O                       L1CRNM      27
0532 O                         DLNO      35
0533 O                         DTYP      38
0534 O                                   39 '-'
0535 O                         DLST      41
     O                         CLAS      45                               CDL038
     O                 10      BYSL      46                               CDL038
     O                         PCLI      47                               CDL038
     O                         EDATA     55                               CDL038
     O                         ZADATE    63                               CDL038
     O                    39 20          63 '  CALL  '                    CDL038
     O                N42 43N45          63 '        '                    CDL038
     O                    20N39          63 '        '                    CDL038
     O                    39 41DAYS  Z   58                               CDL038
     O                    39 41          63 ' DAYS'                       CDL038
     O                    47   FFIN      65                               CDL038
     O                   N68N42ECCY      69                               CDL038
     O*****************10******BYSL      42                        SA1157 CDL038
0536 O*************************EDATA*****50                               059741
      *                                                                   S01378
      ** Parcel Indicator is non blank ('P') only for NA's bought/sold    S01378
     O*************************PCLI      43                        S01378 CDL038
     O*************************EDATA     51                        S01378 CDL038
0536 O***********              EDATA     50                               S01378
0537 O*************************ZADATE    59                               CDL038
0538 O********************39*20          59 '  CALL  '                    CDL038
0539 O****************N42 43N45          59 '        '                    CDL038
0540 O********************20N39          59 '        '                    CDL038
0541 O********************39*41DAYS  Z   54                               CDL038
0542 O********************39*41          59 ' DAYS'                       CDL038
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL1060OOP2                                           S01408
     O*                                                                   S01408
0543 O********************47***FFIN      62                               CDL038
0544 O**********************N42ECCY      67                               SA1157
0545 O**********************N42EAMT      87 ' ,   ,   ,   , 0 -'          SA1157
0546 O********************51N42EAMT      87 '   ,   ,   , 0 . -'          SA1157
0547 O********************52N42EAMT      87 '  ,   ,   , 0 .  -'          SA1157
0548 O********************53N42EAMT      87 ' ,   ,   , 0 .   -'          SA1157
0544 O*******************N68N42ECCY      67                        SA1157 CDL038
0545 O                   N68N42EAMT      87 ' ,   ,   ,   , 0 -'          SA1157
0546 O                N68 51N42EAMT      87 '   ,   ,   , 0 . -'          SA1157
0547 O                N68 52N42EAMT      87 '  ,   ,   , 0 .  -'          SA1157
0548 O                N68 53N42EAMT      87 ' ,   ,   , 0 .   -'          SA1157
0549 O*************************RATE     102 '   0 .        -'             S01119
     O                N49      RATE     105 '   0 .        -'             S01119
     O                 49N67 73UEINR    104 '  0 .       -'               S01119
     O                 49N67 74UBRTT     90                               S01119
     O*****************49 67   CLRAT    104 '  0 .       -'        S01119 SA1157
     O                 49 67N38CLRAT    104 '  0 .       -'               SA1157
     O                 49 67 38FLRAT    104 '  0 .       -'               SA1157
0550 O***********************43OTHC*****108                               S01119
     O/COPY WNCPYSRC,DL1060O002
     O                       43OTHC     111                               S01119
0551 O***********************43OTHA*****129 ' ,   ,   ,   , 0 -'          S01119
     O                       43OTHA     131 ' ,   ,   ,   , 0 -'          S01119
0552 O********************61*43OTHA*****129 '   ,   ,   , 0 . -'          S01119
     O                    61 43OTHA     131 '   ,   ,   , 0 . -'          S01119
0553 O********************62*43OTHA*****129 '  ,   ,   , 0 .  -'          S01119
     O                    62 43OTHA     131 '  ,   ,   , 0 .  -'          S01119
0554 O********************63*43OTHA*****129 ' ,   ,   , 0 .   -'          S01119
     O                    63 43OTHA     131 ' ,   ,   , 0 .   -'          S01119
0555 O***********************42ECCY*****108                               S01119
     O***********************42ECCY     111                        S01119 SA1157
     O** E20585 - PRINT CODE IF IT IS CASH OUTGOING L/D DEAL              E20585
     O**          OR N/A PURCHASE                                         E20585
     O                       42ECCY     111                               E20585
     O                    68N42ECCY     111                               SA1157
0556 O***********************42EAMT*****129 ' ,   ,   ,   , 0 -'          S01119
     O***********************42EAMT     131 ' ,   ,   ,   , 0 -'   S01119 SA1157
     O** E20585 - PRINT AMOUNT IF IT IS CASH OUTGOING L/D DEAL            E20585
     O**          OR N/A PURCHASE                                         E20585
     O                    50 42EAMT     131 ' ,   ,   ,   , 0 -'          E20585
     O                    51 42EAMT     131 '   ,   ,   , 0 . -'          E20585
     O                    52 42EAMT     131 '  ,   ,   , 0 .  -'          E20585
     O                    53 42EAMT     131 ' ,   ,   , 0 .   -'          E20585
     O                    68N42EAMT     131 ' ,   ,   ,   , 0 -'          SA1157
0557 O********************51*42EAMT*****129 '   ,   ,   , 0 . -'          S01119
     O********************51 42EAMT     131 '   ,   ,   , 0 . -'   S01119 SA1157
     O                 68 51N42EAMT     131 '   ,   ,   , 0 . -'          SA1157
0558 O********************52*42EAMT*****129 '  ,   ,   , 0 .  -'          S01119
     O********************52 42EAMT     131 '  ,   ,   , 0 .  -'   S01119 SA1157
     O                 68 52N42EAMT     131 '  ,   ,   , 0 .  -'          SA1157
0559 O********************53*42EAMT*****129 ' ,   ,   , 0 .   -'          S01119
     O********************53 42EAMT     131 ' ,   ,   , 0 .   -'   S01119 SA1157
     O                 68 53N42EAMT     131 ' ,   ,   , 0 .   -'          SA1157
0560 O********D 00     02 L1                                              AUS019
0560 O        D 00     02 L1 56                                           AUS019
0561 O                         CTWN      17
     O********D 01     02 49                                       S01119 AUS019
     O        D 01     02 49 56                                           AUS019
     O*****************66*48***FFIN      62                        S01119 CDL038
     O                 66 48   FFIN      65                               CDL038
     O                 74 67   UBRTT     90                               S01119
     O                 72      TBRTT     90                               S01119
     O                 73 67   UEINR    104 '  0 .       -'               S01119
     O                 71      TEINR    104 '  0 .       -'               S01119
     O                 66      OTHC     111                               S01119
     O                 66      OTHA     131 ' ,   ,   ,   , 0 -'          S01119
     O                 66 61   OTHA     131 '   ,   ,   , 0 . -'          S01119
     O                 66 62   OTHA     131 '  ,   ,   , 0 .  -'          S01119
     O                 66 63   OTHA     131 ' ,   ,   , 0 .   -'          S01119
     O/COPY WNCPYSRC,DL1060O003
     O********D 01     02 49 64                                    S01119 SA1157
     O        D 01     02 49 64                                           SA1157
     O*******AND      N38                                          SA1157 AUS019
     O       AND      N38 56                                              AUS019
     O                         FLRAT    104 '  0 .       -'               S01119
0562 O*
0739 O*****   T 33     LR U7 U8                                           E122
3853 O*****                              42 '*** REFERENCE'               E122
3854 O*****                    DBPGM     51                               S01194
3855 O*****                              71 '-  DATABASE ERROR AT'        S01194
3856 O*****                    DBASE     74                               S01194
0739 O        T 33     LR U7 U8                                           LN0643
3854 O                         DBPGM     53                               S01194
3855 O                                   70 '-  DATABASE ERROR'           S01194
3857 O*****   T  3     LR U7 U8                                           S01117
3858 O*****                              37 'FILE NAME'                   S01117
3859 O*****                    DBFILE    43                               S01117
3860 O*****                              48 'KEY'                         S01117
3861 O*****                    DBKEY     78                               S01117
0563 O*****   T 3      LR 44                                              E122
0564 O*****                              63 '***   NO DETAILS TO REPO'    E122
0565 O*****                              71 'RT   ***'                    E122
0566 O*****                                                               E122
0563 O*****   T 3      LR                                          S01117 E122
0563 O        T 3      LRN44                                              E122
0564 O                                   71 '*** END OF REPORT ***'       S01117
0566 O*                                                                   S01117
0567 O*    F I L E  C O N T R O L S
0568 O*
0569 O********T**203***LR                                                 S01117
0569 ODL1060AUT  203   LR                                                 S01117
0570 O*****                              22 'REFERENCE DL1060'            S01117
0570 O                                   24 'REFERENCE DL1060AU'          S01117
0571 O*****                    TITL      89                               S01194
0571 O                         BJURPT    89                               S01194
0572 O                                  122 'DATE              PAGE'
0573 O*****                    RUNA     112                               S01194
0573 O                         BJMRDT   112                               S01194
0574 O*****                    PAGE  Z  127                               S01117
0574 O                         PAGE1 Z  127                               S01117
0575 O        T  1     LR
0576 O                       80          47 'INTERIM'
     O                 54N55             53 'F.X. '                       AUS019
     O                 55N54             53 'M.M. '                       AUS019
0577 O***********************************72 'DEALS BY CUSTOMER THIS M'    AUS019
0578 O***********************************76 'ONTH'                        AUS019
     O                                   77 'DEALS BY CUSTOMER THIS M'    AUS019
     O                                   81 'ONTH'                        AUS019
0579 O        T  2     LR
0580 O                       80          47 '*******'
     O                 54N55             53 '-----'                       AUS019
     O                 55N54             53 '-----'                       AUS019
0581 O***********************************72 '------------------------'    AUS019
0582 O***********************************76 '----'                        AUS019
     O                                   77 '------------------------'    AUS019
     O                                   81 '----'                        AUS019
0583 O        T  236   LR
0584 O                                   18 'RUN CONTROLS'
0585 O        T  2     LR
0586 O                                   59 'NUMBER'
0587 O                                   84 'VALUE'
0588 O        T  2     LR
0589 O                                   32 'RECORDS LISTED IN THIS R'
0590 O                                   37 'EPORT'
0591 O                         RECIN 3   59
0592 O                         ZZTOTIZ   81
0593 O                         ZZTOTD    84
0594 O        T  3     LR
0595 O                                   32 'EXTRACT FILE CONTROL TOT'
0596 O                                   35 'ALS'
0597 O                         NORE  3   59
0598 O                         HRWN  Z   81
0599 O                         HRDC      84
0600 O        T  3     LR U8NU7
0601 O                                   71 '***   DIFFERENCE   ***'
0563 O        T 3      LR 44                                              S01117
0564 O                                   63 '***   NO DETAILS TO REPO'    S01117
0565 O                                   71 'RT   ***'                    S01117
0739 O*****   T 33     LR U7 U8                                           S01117
3853 O*****                              42 '*** REFERENCE'               S01117
3854 O*****                    DBPGM     51                               S01117
3855 O*****                              71 '-  DATABASE ERROR AT'        S01117
3856 O*****                    DBASE     74                               S01117
3857 O*****   T  3     LR U7 U8                                           S01117
3858 O*****                              37 'FILE NAME'                   S01117
3859 O*****                    DBFILE    43                               S01117
3860 O*****                              48 'KEY'                         S01117
3861 O*****                    DBKEY     78                               S01117
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    76                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
0602 O*****   T 00     LR                                                 S01117
0603 O*****                              71 '*** END OF REPORT ***'       S01117
0602 O*****   T 3      LR                                           S01117E299
0603 O*****                              71 '*** END OF REPORT ***  S01117E299
0604 O/SPACE 3
0605 ODEALS   T        LRN65 04
0606 O*****                    RUND      77P                              S01194
0606 O                         BJRDNB    77P                              S01194
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  TAB1                                                                 S01354 048336 088119 CDL033
IPTILNCLDLC1C2BPBDTBTADAILIDITTDCICDTSCSBSBRRATRCF
**  TAB2                                                                  088139
FPFSPISIOPOTSWPSCXNX
**  TAB3                                                                  S01119
RXRSRRRPRFFR                                                        S01119SA1157
