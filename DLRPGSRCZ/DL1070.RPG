     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Deals file purge')                            *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
     F*                                                               *
     F*  DL1070  -  DEALS FILE PURGE                                  *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CIR020             Date 02Aug21               *
      *  Prev Amend No. CDL102             Date 01Jun21               *
      *                 AR1075401          Date 01Jun20               *
      *                 CSD103             Date 10Aug20               *
      *                 CER050             Date 16Jun19               *
      *                 MD051650           Date 12Sep18               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD027863           Date 09Feb15               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 AR970738           Date 04Dec12               *
      *                 CLE148             Date 23Jul12               *
      *                 CSW212             Date 03May12               *
      *                 CRE073             Date 06Dec10               *
      *                 AR588416           Date 19Aug10               *
      *                 252554A            Date 11Feb09               *
      *                 262129             Date 07Oct09               *
      *                 CER059             Date 19Jul10               *
      *                 BUG25189           Date 27Jul09               *
      *                 BUG24989           Date 23Jul09               *
      *                 CER054             Date 07Apr09               *
      *                 CER048             Date 19May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CSW208             Date 15Apr08               *
      *                 095907             Date 16Feb07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12682           Date 16Nov06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG10315           Date 07Feb06               *
      *                 237063             Date 20Nov05               *
      *                 CDL038             Date 10May05               *
      *                 CAS009             Date 04May04               *
      *                 BUG7411            Date 01Jun05               *
      *                 CDL028             Date 07Feb05               *
      *                 229600             Date 17Sep04               *
      *                 229544             Date 15Sep04               *
      *                 CAS008             Date 16Jun04               *
      *                 CDL025             Date 25Jan05               *
      *                 CLE040             Date 05Jul04               *
      *                 BUG3937            Date 06Aug04               *
      *                 BUG3035            Date 03Jun04               *
      *                 BUG3021            Date 02Jun04               *
      *                 CLE025             Date 20Oct03               *
      *                 CDL018             Date 03Feb04               *
      *                 CDL012             Date 13Aug03               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 217684             Date 12May03               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      *                 CAS002             Date 14Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR003             Date 13Sep00               *
      *                 CIR006             Date 13Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR005             Date 21Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 175065             Date 01Feb00               *
     F*                 CAP051             DATE 10Nov99               *
     F*                 CDL007             DATE 07Oct99               *
     F*                 CPB001             Date 01Jun99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CPL002             DATE 01Mar99               *
     F*                 CDL002             DATE 22SEP97               *
     F*                 S01408             DATE 15AUG96               *
     F*                 CFF004             DATE 02OCT96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 S01408             DATE 20MAY96               *
     F*                 S01408             DATE 12SEP95               *
     F*                 S01408             DATE 19JUN95               *
     F*                 CIR001             DATE 13JUN95               *
     F*                 S01444             DATE 11APR95               *
     F*                 S01486             DATE 04OCT94               *
     F*                 067566             DATE 08MAR94               *
     F*                 S01453             DATE 14DEC93               *
     F*                 048933             DATE 19MAR93               *
     F*                 E43300             DATE 03AUG92               *
     F*                 AUS007             DATE 13JUL92               *
     F*                 AUS003             DATE 01JUL92               *
     F*                 E24041             DATE 28JUN91               *
     F*                 LN0363             DATE 13JUN90               *
     F*                 LN0171             DATE 14MAY90               *
     F*                 LN0101             DATE 03MAY90               *
     F*                 S01117             DATE 28/04/89              *
     F*                 S01194             DATE 23/02/89              *
     F*                 E13028             DATE 21/09/88              *
     F*                 E15188             DATE 19/09/88              *
     F*                 E11887             DATE 21/04/88              *
     F*                 S01119             DATE 18/06/87              *
     F*                 E10431             DATE 05/03/87              *
     F*                 S1104              DATE 28/04/86              *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  CIR020 - LIBOR Deregulation - FRA/IRS (Recompile)            *
      *  CDL102 - LIBOR Deregulation - Dealing (Recompile)            *
      *  AR1075401 - Increase QFOAMT length in PMHOLDPD. Recompiled.  *
      *              (Child: AR1075402)                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
      *  CER050 - Annualised Percentage Rate                          *
      *  MD051650 - Delete the corresponding records in HISTSAA       *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date                                    *
      *  MD027863 - Drop records from extension files only            *
      *             dropping from DLxHIS.                             *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  AR970738 - Remove condition on deletion of extension files.  *
      *             Apply fix 263291A. (Child: AR970741)              *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSW212 - SWIFT 2012 Changes (Recompile)                      *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  AR588416 - Parameter type mismatch on calling MMDELUDF.      *
      *  252554A - Delete the corresponding record in the UDF files   *
      *            during COB.                                        *
      *  262129 - Upgrade fix 234024 from LBBW-SNG DBA3.5 to MP1.4 .  *
      *           Applied core fix 254018.                            *
      *           Do not delete Rolled-Over deal from historical file *
      *           DLCHISPD if related rollover deal in DEALSDC is     *
      *           still outstanding (with RECI = 'D')                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG25189 - MARG field on DLCHISPD contains invalid data after*
      *             the close of business (Recompile)                 *
      *  BUG24989 - Limit Utilisation Enq - Decimal Data error        *
      *             (Recompile)                                       *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
     F*           (Recompile)                                         *
      *  CSW208 - SWIFT 2008 Changes (Recompile)                      *
     F*  095907 - Drop Processing SE II Enhancement. Applied 127891   *
     F*  127891 - For drop of records in PMMFHLPP, access file        *
     F*           with correct module ID (in accordance with fix      *
     F*           S01313 in PM1144                                    *
      *  BUG12682 - MMC004600 00001 failed (Recompile)                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG10315 - LDNI: Amend System allowed amendment of matured   *
      *             deal                                              *
      *  237063 - EU Tax fixes upgrade to MP build 103 (Recompile).   *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  BUG7411- CDL028 fields missing from DLGHISPD (Recompile)     *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  229600 - Record in file FRNPVLPD not deleted when deal has   *
      *           matured.                                            *
      *  229544 - Recompiled due to inserted fields in DLCHISPD.      *
      *  CAS008 - IAS 39 Enhancements (Recompile)                     *
      *  CDL025 - FX Netting Payment Generation                       *
      *  CLE040 - Collateralised Lending Phase 2 (Recompile)          *
      *  BUG3937 - Error on purging of records in extension files.    *
      *  BUG3035 - Error on calculation when a rate change is done    *
      *            (Recompile)                                        *
      *  BUG3021 - Incorrect dates and amount formatting in           *
      *            certificate and confirmation of balances           *
      *  CLE025 - Credit Lines                                        *
      *  CDL018 - Multiple Settlement Accounts on Loans/Deposit       *
      *  CDL012 - Interest Statements for Call/Time Deposits.         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS006 - Hedge Accounting Phase B                            *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  217684 - Authorisation User Malfunction (Recompile)          *
      *  CAS004 - Hedge Accounting Phase A (Recompile)                *
      *  CAP056 - Automatic Authorisation of Interface Deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  CAS002 - Hedge Strategy/Linkage                              *
      *  CIR003 - FRA/IRS Pay/Receive Messages for Swaps              *
      *  CIR006 - Amortisation of Caps/Collars/Floors and Individual  *
      *           Compounding Swaps. Coding done for Amortisation of  *
      *           Caps/Collars/Floors only.                           *
      *  CDL008 - Continuous Linked Settlement (Recompiled)           *
      *  CIR005 - FRA/IRS Business Day Conventions                    *
      *           (Recompiled due to changes in DEALSDG & DLGHISPD)   *
     F*  175065 - Bring DLGHISPD into line with DEALSDG               *
     F*           (recompiled)                                        *
     F*  CAP051 - Automatic Authorisation (MM and FX Part)            *
     F*           Just Recompiled                                     *
     F*  CDL007 - Deposit Breakdown Penalty                           *
     F*           Just Recompiled                                     *
     F*  CPB001 - Meridian DBA Middleware Replication Customization.  *
     F*           Midas/TOF Interface.                                *
     F*           Do not delete deals matured and dropped during the  *
     F*           same COB. They need to go to Meridian.              *
     F*  CPL002 - Midas-Plato Interface                               *
     F*           Recompile over new PF/DLGHISPD format.              *
     F*  CDL002 - FX Netting. Set records on FX Netting Master file   *
     F*           to historic when relevent deals go historic.        *
     F*  S01408 - Core hook DL1070CCP6 added                          *
     F*         - Core hook DL1070CCP5 added                          *
     F*  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           Recompiled only.                                    *
     F*  S01408   Core hook DL1070CCP4 added                          *
     F*  S01408   Addition of core hooks DL1070CCP1                   *
     F*                                  DL1070CCP2                   *
     F*                                  DL1070CCP3                   *
     F*  S01408   Addition of core hooks DL1070CDBU                   *
     F*                                  DL1070FFPG                   *
     F*  CIR001 - Interest Rate Calendars.                            *
     F*  S01444 - COPY THOSE DEALS THAT HAVE MATURED DURING THE       *
     F*           MONTH TO HISTORIC DEALS FILES WITH A RECI OF 'N'    *
     F*           AND DELETE THE DEALS FROM THE MAIN DEALS FILES.     *
     F*           THE HISTORIC DEALS WILL BE DELETED AFTER A          *
     F*           PERIOD SPECIFIED ON THE DEALING ICD.                *
     F*  S01486 - Portfolio Management Upgrade to Release 10.         *
     F*  067566 - Remove FCOOB processing as not required - this      *
     F*           pgm purges matured deals only, and doesnt process   *
     F*           live deals.  Amended pgm to print no of live        *
     F*           deals, obtained from deals file trailer.            *
     F*  S01453 - MARGIN AND FX POSITIONS/POINTS AND BASE CURRENCY    *
     F*           POSITIONS/POINTS ADDED TO FX INPUT (RECOMPILED)     *
     F*  048933 - REWRITE RESTART RECOVERY PROCESSING                 *
     F*  E43300 - ONLY MAKE DEAL HISTORY IF NOT MATURED TODAY         *
     F*           AS CAN CAUSE DATABASE ERROR IN RETAIL ADVICES       *
     F*           PRODUCTION IF DEAL MADE HISTORY                     *
     F*  AUS007 - AUSTRALIAN BROKERAGE.                               *
     F*  AUS003 - AUSTRALIAN PRODUCT - Extra Days Interest            *
     F*  E24041 - Were getting files out of balance at mont end       *
     F*           because count of records was not conditioned on     *
     F*           deal being matured.  (Branch fix incorporated at    *
     F*           Release 10.)                                        *
     F*  LN0363 - REMOVE 'END OF REPORT' FROM AUDIT REPORT AND ADD    *
     F*           'AU' TO REPORT TITLE                                *
     F*  LN0171 - ZSFILE PROCESSING NOT REQUIRED IF AN 'AU' REPORT    *
     F*           ONLY PRODUCED.                                      *
     F*  LN0101 - MUST LOCK DATA AREA LDA WHEN USING IN OPERATION     *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  S01194 - STANDING DATA CHANGES DERIVED FROM SYNON            *
     F*  E13028 - WORKFIELD 'MDATW' EXTENDED TO CONTRL UPDATE         *
     F*           OF LOANS MATURED THIS MONTH BUT NOT TO BE           *
     F*           DELETED & INITIALISE 'MDATW'                        *
     F*  E15188 - INCREASE SIZE OF FIELD 'DHRPD 'TO ACCOMMODATE       *
     F*           LARGEST VALUE IT MIGHT BE ASKED TO TAKE i.e.        *
     F*           WHEN THE HISTORY RETENTION PERIOD IS 99 MONTHS      *
     F*  E11887 - F.X.& N.A.SOLD WERE BEING DROPPED FROM FILE AS      *
     F*           THESE RECORDS DO NOT HAVE A MATURITY DATE.          *
     F*           WORK FIELD INTRODUCED FOR DATE COMPARISONS.         *
     F*  S01119 - INCLUDE PROCESSING FOR FRA/IRS DEAL TYPES           *
     F*  E10431 - INITIALISATION OF FIELDS IPRM & TAXM                *
     F*  S1104  - REWRITTEN FOR DEALS HISTORY PROCESSING.             *
     F*                                                               *
     F*****************************************************************
0011 F/SPACE 3
     FFXNETML3UF  E           K        DISK                           UC  CDL002
     FFXNETSPDUF  E           K        DISK                           UC                      CDL025
     FDEALSDF UF  E                    DISK
     F*ABTB10*IF**E********************DISK*************                  S01194
     F*ABTB40*IF**E********************DISK*************                  S01194
     F*****DL1070P1O***F     132     OF     PRINTER                 S01124S01117
     F*DL1070P1O***F*****132     OF     PRINTER      KINFDS SPOOL         S01117
     FDL1070AUO   F     132     OF     PRINTER      KINFDS SPOOL          S01117
     FBKRATMN UF  E           K        DISK                               AUS007
     F            BKRATAAF                          KRENAMEBKRATR         AUS007
     FFDDTSTL0IF  E           K        DISK                           UC  S01486
     FPMCHTVPDUF  E           K        DISK                      A    UC  S01486
     FPMMFHLL1UF  E           K        DISK                           UC  S01486
     FDEALSI  US  E           K        DISK                               E10431
     F            DEALSDCF                          KRENAMEDEALIDCF       E10431
     F            DEALSDGF                          KRENAMEDEALIDGF       S01119
     F            DEALSDDF                          KRENAMEDEALIDDF       E10431
     FDEALSH  UP  E           K        DISK
     F                                              KINFDS INFDSH                             CAS002
     FDEALSC  IF  E           K        DISK                                                   262129
     F            DEALSDCF                          KRENAMEXDEALSC                            262129
     F/COPY WNCPYSRC,DL1070F001
     FDLGXSTL0UF  E           K        DISK                               CIR003
     FDLBHISPDO   E           K        DISK                               S01444
     F            DLBHISD0                          KRENAMEDLBHISD1       S01444
     FDLCHISPDO   E           K        DISK                               S01444
     F            DLCHISD0                          KRENAMEDLCHISD1       S01444
     FDLDHISPDO   E           K        DISK                               S01444
     F            DLDHISD0                          KRENAMEDLDHISD1       S01444
     FDLEHISPDO   E           K        DISK                               S01444
     F            DLEHISD0                          KRENAMEDLEHISD1       S01444
     FDLGHISPDO   E           K        DISK                               S01444
     F            DLGHISD0                          KRENAMEDLGHISD1       S01444
      *                                                                                       CAS009
     FDLFHSTL0UF  E           K        DISK         KINFSR *PSSR                              CAS009
      ** Midas DL Fees History File by Deal Number                                            CAS009
      *                                                                                       CAS009
     FMMCFSFL0UF  E           K        DISK         KINFSR *PSSR                              CAS009
     F            MMCFLFD0                          KIGNORE                                   CAS009
      *                                                                                       CAS009
     FMMEIRDLAUF  E           K        DISK         KINFSR *PSSR                              CAS009
      *                                                                                       CAS009
     FMMEIRAL1UF  E           K        DISK         KINFSR *PSSR                              CAS009
     F*                                                                   S01408
      ** Revalued IRSs                                                                        CAS002
     F***IRNPVLL0UF  E           K        DISK         KINFSR *PSSR                    CAS002 CAS005
     FIRNPVAL0UF  E           K        DISK         KINFSR *PSSR                              CAS005
      *                                                                                       CAS002
     FFRNPVAL0UF  E           K        DISK         KINFSR *PSSR                              CAS006
      *                                                                                       CAS006
     FFRNPVLL0UF  E           K        DISK         KINFSR *PSSR                              229600
     F            FRNPVAD0                          KRENAMEFRNPVLD0                           229600
      *                                                                                       229600
      ** Hedge Linkage Transaction Detail File                                                CAS002
     FASHTRNL6IF  E           K        DISK         KINFSR *PSSR                              CAS002
      *                                                                                       CAS002
      ** Revalued SIRS using Base Rate                                                        CAS005
     FIRNPVBL0UF  E           K        DISK         KINFSR *PSSR                              CAS005
     F            IRNPVAD0                          KRENAMEIRNPVBD0                           CAS005
      *                                                                                       CAS005
      ** Revalued CIRS File                                                                   CAS005
     FRXNPVAL0UF  E           K        DISK         KINFSR *PSSR                              CAS005
      *                                                                                       CAS005
      ** Revalued CIRS Using Base Rate                                                        CAS005
     FRXNPVBL0UF  E           K        DISK         KINFSR *PSSR                              CAS005
     F            RXNPVAD0                          KRENAMERXNPVBD0                           CAS005
     FDLTCSTV0UF  E           K        DISK                                                   CDL012
      *                                                                                       CDL018
      ** Further Settlement Accounts                                                          CDL018
     FDLFSACL1UF  E           K        DISK         KINFSR *PSSR                              CDL018
      *                                                                                       CDL018
      ** Deals Extension file                                                                 CLE025
     FDLDEALL5UF  E           K        DISK                                                   CLE025
      *                                                                                       CLE025
     FHIST1   UF  E           K        DISK         KINFSR *PSSR                            MD051650
      *                                                                                       CAS005
      ** Midas DL Deals APR History                                                           CER050
     FDLAPRHI0UF  E           K        DISK                                                   CER050
      *                                                                                       CER050
      ** Midas APR MM Deals History                                                           CER050
     FDLHISTI0UF  E           K        DISK                                                   CER050
      *                                                                                       CER050
     F/COPY WNCPYSRC,DL1070FFPG                                           S01408
     F*                                                                   S01408
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZDATE2Z1                                               AUS003
     I*ABTB10F*****                                                       S01194
     I*****         RECI                            RECIX                 S01194
     I*ABTB40F*****                                                       S01194
     I*****         RECI                            RECIX                 S01194
     IBKRATR                                                              AUS007
     I              RECI                            RECIBK                AUS007
      *                                                                                       262129
     IXDEALSC                                                                                 262129
     I              RECI                            XRECI                                     262129
     I              DLNO                            XDLNO                                     262129
     I              RCDT                            XRCDT                                     262129
     I              RCDC                            XRCDC                                     262129
     I              CNUM                            XCNUM                                     262129
     I              BRCA                            XBRCA                                     262129
     I              DTYP                            XDTYP                                     262129
     I              DLST                            XDLST                                     262129
     I              DDAT                            XDDAT                                     262129
     I              VDAT                            XVDAT                                     262129
     I              MDAT                            XMDAT                                     262129
     I              CDAS                            XCDAS                                     262129
     I              BRKC                            XBRKC                                     262129
     I              BAGE                            XBAGE                                     262129
     I              CCY                             XCCY                                      262129
     I              PCPL                            XPCPL                                     262129
     I              INTC                            XINTC                                     262129
     I              ZZ006                           XZZ006                                    262129
     I              BRTT                            XBRTT                                     262129
     I              BRTE                            XBRTE                                     262129
     I              RTSP                            XRTSP                                     262129
     I              INTR                            XINTR                                     262129
     I              NOTD                            XNOTD                                     262129
     I              RNNA                            XRNNA                                     262129
     I              CHNA                            XCHNA                                     262129
     I              FACT                            XFACT                                     262129
     I              FCNO                            XFCNO                                     262129
     I              OPAM                            XOPAM                                     262129
     I              BCXR                            XBCXR                                     262129
     I              LCXR                            XLCXR                                     262129
     I              SDST                            XSDST                                     262129
     I              OSDA                            XOSDA                                     262129
     I              TSTN                            XTSTN                                     262129
     I              MDST                            XMDST                                     262129
     I              OMDA                            XOMDA                                     262129
     I              TMAN                            XTMAN                                     262129
     I              RODN                            XRODN                                     262129
     I              RODA                            XRODA                                     262129
     I              RBDN                            XRBDN                                     262129
     I              RBDA                            XRBDA                                     262129
     I              ICBS                            XICBS                                     262129
     I              IPFR                            XIPFR                                     262129
     I              TOTI                            XTOTI                                     262129
     I              NIDT                            XNIDT                                     262129
     I              IBDT                            XIBDT                                     262129
     I              SLID                            XSLID                                     262129
     I              AIPD                            XAIPD                                     262129
     I              DLRC                            XDLRC                                     262129
     I              IACD                            XIACD                                     262129
     I              AITC                            XAITC                                     262129
     I              AIAN                            XAIAN                                     262129
     I              AIAP                            XAIAP                                     262129
     I              IPRD                            XIPRD                                     262129
     I              IPRM                            XIPRM                                     262129
     I              ICTD                            XICTD                                     262129
     I              ZZ009                           XZZ009                                    262129
     I              DAVD                            XDAVD                                     262129
     I              DASN                            XDASN                                     262129
     I              FACO                            XFACO                                     262129
     I              SPI                             XSPI                                      262129
     I              INTF                            XINTF                                     262129
     I              ZZ008                           XZZ008                                    262129
     I              TAXI                            XTAXI                                     262129
     I              TAXD                            XTAXD                                     262129
     I              TAXM                            XTAXM                                     262129
     I              DNSI                            XDNSI                                     262129
     I              DSTI                            XDSTI                                     262129
     I              CNFI                            XCNFI                                     262129
     I              ACEI                            XACEI                                     262129
     I              TLXI                            XTLXI                                     262129
     I              ZZ009A                          XZZ09A                                    262129
     I              F57U                            XF57U                                     262129
     I              LSWC                            XLSWC                                     262129
     I              LSWS                            XLSWS                                     262129
     I              ZZ002                           XZZ002                                    262129
     I              ORED                            XORED                                     262129
     I              LCD                             XLCD                                      262129
     I              CHTP                            XCHTP                                     262129
     I              TNLU                            XTNLU                                     262129
     I              DBLN                            XDBLN                                     262129
     I              DRID                            XDRID                                     262129
     I              DDMR                            XDDMR                                     262129
     I              BOKC                            XBOKC                                     262129
     I              LNKDN                           XLNKDN                                    262129
     I              RSTM                            XRSTM                                     262129
     I              RONS                            XRONS                                     262129
     I              RIBN                            XRIBN                                     262129
     I              RIBA                            XRIBA                                     262129
     I              ROBN                            XROBN                                     262129
     I              ROCN                            XROCN                                     262129
     I              PSTM                            XPSTM                                     262129
     I              PONS                            XPONS                                     262129
     I              PIBN                            XPIBN                                     262129
     I              PIBA                            XPIBA                                     262129
     I              POBN                            XPOBN                                     262129
     I              POCN                            XPOCN                                     262129
     I              RCRN                            XRCRN                                     262129
     I              RCRA                            XRCRA                                     262129
     I              RVNO                            XRVNO                                     262129
     I              AWBN                            XAWBN                                     262129
     I              AWBA                            XAWBA                                     262129
     I              BENN                            XBENN                                     262129
     I              BENA                            XBENA                                     262129
     I              DTP1                            XDTP1                                     262129
     I              DTP2                            XDTP2                                     262129
     I              DTP3                            XDTP3                                     262129
     I              DTP4                            XDTP4                                     262129
     I              DCHG                            XDCHG                                     262129
     I              BTB1                            XBTB1                                     262129
     I              BTB2                            XBTB2                                     262129
     I              BTB3                            XBTB3                                     262129
     I              BTB4                            XBTB4                                     262129
     I              BTB5                            XBTB5                                     262129
     I              BTB6                            XBTB6                                     262129
     I              ORBR                            XORBR                                     262129
     I              PRFC                            XPRFC                                     262129
     I              ROBR                            XROBR                                     262129
     I              POBR                            XPOBR                                     262129
     I              CVMR                            XCVMR                                     262129
     I              NACSG                           XNACSG                                    262129
     I              JRDFC                           XJRDFC                                    262129
     I              JFLID                           XJFLID                                    262129
     I              FUID                            XFUID                                     262129
     I              AURO                            XAURO                                     262129
     I              IPDS                            XIPDS                                     262129
     I              ROFQ                            XROFQ                                     262129
     I              RLDN                            XRLDN                                     262129
     I              CNNA                            XCNNA                                     262129
     I              IMET                            XIMET                                     262129
     I              INSA                            XINSA                                     262129
     I              INOS                            XINOS                                     262129
     I              WRPI                            XWRPI                                     262129
     I              PTFR                            XPTFR                                     262129
     I              FXRD                            XFXRD                                     262129
     I              HLEX                            XHLEX                                     262129
     I              FSRP                            XFSRP                                     262129
     I              FSGN                            XFSGN                                     262129
     I              FPRC                            XFPRC                                     262129
     I              TCOF                            XTCOF                                     262129
     I              ACPD                            XACPD                                     262129
     I              ACDA                            XACDA                                     262129
     I              ACAP                            XACAP                                     262129
     I              ACAN                            XACAN                                     262129
     I              COFD                            XCOFD                                     262129
     I              COFM                            XCOFM                                     262129
     I              CFCD                            XCFCD                                     262129
     I              FCTD                            XFCTD                                     262129
     I              STCY                            XSTCY                                     262129
     I              IC72                            XIC72                                     262129
     I              ISCY                            XISCY                                     262129
     I              II72                            XII72                                     262129
     I              RTFC                            XRTFC                                     262129
     I              FCGC                            XFCGC                                     262129
     I              FCGD                            XFCGD                                     262129
     I              FCGA                            XFCGA                                     262129
     I              FCGT                            XFCGT                                     262129
     I              FCMC                            XFCMC                                     262129
     I              FCMD                            XFCMD                                     262129
     I              FCMA                            XFCMA                                     262129
     I              FCMT                            XFCMT                                     262129
     I              FTST                            XFTST                                     262129
     I              FRN1                            XFRN1                                     262129
     I              FRN2                            XFRN2                                     262129
     I              FRN3                            XFRN3                                     262129
     I              FRN4                            XFRN4                                     262129
     I              FACTC                           XFACTC                                    262129
     I              FACPD                           XFACPD                                    262129
     I              FCPRD                           XFCPRD                                    262129
     I              REPI                            XREPI                                     262129
     I              OMDT                            XOMDT                                     262129
     I              PENA                            XPENA                                     262129
     I              BUSR                            XBUSR                                     262129
     I              PRIN                            XPRIN                                     262129
     I              AUTH                            XAUTH                                     262129
     I              TRTP                            XTRTP                                     262129
     I              COLF                            XCOLF                                     262129
     I              COLA                            XCOLA                                     262129
     I              FSOYLC                          XOYLC                                     262129
     I              FSURPL                          XURPL                                     262129
     I              FSTUPL                          XTUPL                                     262129
     I              FSPUPL                          XPUPL                                     262129
     I              FSYUPL                          XYUPL                                     262129
      *                                                                                       262129
     IHISTSAAF                                                                              MD051650
     I              RTYP                            HRTYP                                   MD051650
     I              CNUM                            HCNUM                                   MD051650
     I              EDAT                            HEDAT                                   MD051650
     I              DLNO                            HDLNO                                   MD051650
     I              PCPL                            HPCPL                                   MD051650
     I              NRAT                            HNRAT                                   MD051650
     I              ORAT                            HORAT                                   MD051650
     I              TERM                            HTERM                                   MD051650
     I              DTYP                            HDTYP                                   MD051650
     I              DLST                            HDLST                                   MD051650
     I              BRCA                            HBRCA                                   MD051650
     I              SQNO                            HSQNO                                   MD051650
     I              MDAT                            HMDAT                                   MD051650
     I              SECI                            HSECI                                   MD051650
     I              CCY                             HCCY                                    MD051650
     I              INTC                            HINTC                                   MD051650
     I              CHQI                            HCHQI                                   MD051650
     I              ICBS                            HICBS                                   MD051650
     I              REPI                            HREPI                                   MD051650
     I              CLAS                            HCLAS                                   MD051650
      *                                                                                     MD051650
     IDEALSDBF    01
     IDEALSDCF    02
     I*             ZZ0375                          ZA0375
     IDEALSDDF    03
     I*             ZZ0063                          ZA0063
     I*             ZZ0375                          ZB0375
     IDEALSDEF    04
     I*             ZZ0063                          ZB0063
     I*             ZZ0375                          ZC0375
     IDEALSDGF    07                                                      S01119
     IDLBHISD0    70                                                      S01444
     IDLCHISD0    71                                                      S01444
     IDLDHISD0    72                                                      S01444
     IDLEHISD0    73                                                      S01444
     IDLGHISD0    74                                                      S01444
     IDEALIDCF    05                                                      E10431
     I*                                                                   E10431
     IDEALIDGF    08                                                      S01119
     I*                                                                   S01119
     IDEALIDDF    06                                                      E10431
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM  AOBANKR0                S01194
     I*                                                                   AUS003
     ISDGELR    E DSSDGELRPD                                              AUS003
     I* GENERAL LEDGER DETAILS ACCESSED VIA ACCESS PROGRAM  AOBANKR0      AUS003
     I*                                                                   S01194
     ISDDEAL    E DSSDDEALPD                                              S01194
     I              QQACCD                          QQACC1                                    CGL029
     I* DEALING FILE DETAILS ACCESSED VIA ACCESS PROGRAM  AODEALR0        S01194
     I*                                                                   AUS007
     ISCSARD    E DSSCSARDPD                                              AUS007
     I* SAR FILE DETAILS ACCESSED VIA ACCESS PROGRAM  AOSARDR0            AUS007
     I*                                                                   E10431
     ISDMMOD    E DSSDMMODPD                                              S01486
     I* Access Module Details dile.                                       S01486
     I*                                                                   S01486
     ISDPLIN    E DSSDPLINPD                                              S01486
     I** Dummy record format for access to Instrument Types               S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*
     IDSSDY     E DSDSSDY                                                 S01486
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01486
     I*                                                                   S01486
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I*                                                                   S01486
     I** DS TO SPLIT ZDATE (DDMMYY FROM ZDATE2)                           S01486
     IWWDATE      DS                                                      S01486
     I                                        1   20WWDAY                 S01486
     I                                        3   40WWMTHN                S01486
     I                                        5   60WWYEAR                S01486
     I*                                                                   S01486
     ICHTVDS      DS                                                      S01486
     I**********                              1   60SCCNUM                             S01486 CSD027
     I                                        1   6 SCCNUM                                    CSD027
     I                                        7  10 SCPTFR                S01486
     I                                       11  13 SCINNR                S01486
     I                                       14  16 SCICCY                S01486
     I                                       17  190SCLIND                S01486
     I                                       20  210SCYRNO                S01486
     I                                       22  230SCMTHN                S01486
     I                                       24  26 SCLOIC                                    CER020
     I*                                                                   S01486
     IDTSTDS      DS                                                      S01486
     I                                        1   2 DTYP                  S01486
     I                                        3   4 DLST                  S01486
     I                                        5   8 CLAS                  CDL038
     I*                                                                   E10431
     ILDA        UDS                            256
     I***********                           134 138 DBFILE                CIR001
     I***********                           139 167 DBKEY                 CIR001
     I***********                           168 175 DBPGM                 CIR001
     I***********                           176 1770DBASE                 CIR001
     I                                      134 141 DBFILE                CIR001
     I                                      142 170 DBKEY                 CIR001
     I                                      171 180 DBPGM                 CIR001
     I                                      181 1830DBERR                 CIR001
     I                                      182 1830DBASE                 CIR001
      *                                                                                       CAS002
     IINFDSH      DS                            528                                           CAS002
     I                                       38  45 RCDFMT                                    CAS002
      ** File information data structure                                                      CAS002
     ISVAL1       DS                            200                                           CDL012
     I                                        1   10SVAL11                                    CDL012
      ** DS for AOSVALR0                                                                      CDL012
      *                                                                                       CDL012
     I              'DepIntRetenPerd'     C         SVALKK                                    CDL012
      ** AOSVALR0 key for Deposit Interest Retention Period                                   CDL012
      *                                                                                       CDL012
      *                                                                                       CDL012
     I/COPY WNCPYSRC,DL1070I001
      /EJECT                                                              S01486
     C*===================================================================S01486
     C*                                                                   S01486
     C** CALCULATION SPECIFICATIONS:KEY LISTS                             S01486
     C*                                                                   S01486
     C** DEFINE KEY LIST FOR CHAINING TO PMCHTVPD                         S01486
     C*                                                                   S01486
     C           CHTVKY    KLIST                                          S01486
     C                     KFLD           SCCNUM                          S01486
     C                     KFLD           SCPTFR                          S01486
     C                     KFLD           SCINNR                          S01486
     C                     KFLD           SCICCY                          S01486
     C**********           KFLD           SCLIND                                       S01486 CER020
     C                     KFLD           SCLOIC                                              CER020
     C                     KFLD           SCYRNO                          S01486
     C                     KFLD           SCMTHN                          S01486
     C*                                                                   S01486
     C** DEFINE KEY LIST FOR CHAINING TO FDDTSTPD                         S01486
     C*                                                                   S01486
     C           DTSTKY    KLIST                                          S01486
     C                     KFLD           DTYP                            S01486
     C                     KFLD           DLST                            S01486
     C                     KFLD           CLAS                            CDL038
     C*                                                                   S01486
     C           MFHLKY    KLIST                                          S01486
     C                     KFLD           QFCNUM                          S01486
     C                     KFLD           QFMODI                          S01486
     C                     KFLD           QFTRNB                          S01486
     C                     KFLD           QFTDSS                          S01486
     C                     KFLD           QFTXT2                          S01486
     C                     KFLD           QFPTFR                          S01486
     C*                                                                   S01486
     C           MFHLK1    KLIST                                          S01486
     C                     KFLD           QFCNUM                          S01486
     C                     KFLD           QFMODI                          S01486
     C                     KFLD           QFTRNB                          S01486
     C*                                                                   S01486
     C           WDLKEY    KLIST                                          CIR003
     C                     KFLD           DLNO                            CIR003
     C                     KFLD           WEVCD                           CIR003
     C*===================================================================S01486
      /EJECT                                                              S01486
     C**   FIRST CYCLE PROCESSING
     C           *IN21     IFEQ '0'                        ** IF  001
     C                     MOVE '1'       *IN21
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN           LDA
     C******               IN   LDA                                       LN0101
     C           *LOCK     IN   LDA                                       LN0101
     C                     Z-ADD0         DBERR                           CIR001
     C                     MOVE *BLANKS   DBFILE                          CIR001
     C                     MOVE *BLANKS   DBKEY                           CIR001
     C                     MOVE *BLANKS   DBPGM                           CIR001
     C                     MOVEL'DL1070'  DBPGM                           CIR001
     C*****GET*ICD*RECORD*1**********************************
     C*********************READ*TABTB10F*****************99**
     C*****GET*ICD*RECORD*5**********************************
     C*********************READ TABTB40F*****************99**
     C*
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE '1'       *IN99                           S01194
     C                     MOVEL'SDBANKPD'DBFILE           ************   S01194
     C                     MOVEL'01'      DBASE            * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     SETON                     U7LR                 S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   AUS003
     C** READ GENERAL LEDGER DETAILS VIA ACCESS PROGRAM                   AUS003
     C**********           CALL 'AOGELRR0'                                             AUS003 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           AUS003
     C                     PARM '*FIRST ' @OPTN                           AUS003
     C********** SDGELR    PARM SDGELR    DSFDY                                        AUS003 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   AUS003
     C                     MOVE '1'       *IN99                           AUS003
     C                     MOVEL'SDGELRPD'DBFILE           ************   AUS003
     C                     MOVEL'01'      DBASE            * DBERR 01 *   AUS003
     C                     MOVEL@OPTN     DBOPTN  7        ************   AUS003
     C                     SETON                     U7LR                 AUS003
     C                     EXSR *PSSR                                     AUS003
     C                     END                                            AUS003
     C*
     C** READ DEALING DETAILS VIA ACCESS PROGRAM                          S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVE '1'       *IN99                           S01194
     C                     MOVEL'SDDEALPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     SETON                     U7LR                 S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C**
2890 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    AUS003
2891 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  AUS003
2892 C**                                                                  AUS003
2890 C**   CALCULATE DAY NO FOR BEGINNING OF THIS ACCRUAL MONTH           AUS003
2890 C**   THIS IS NECESSARY FOR CMF'S 4/5/4 ACCRUAL SAR                  AUS003
     C                     Z-ADDBKAPDT    ZDAYNO                          AUS003
     C                     EXSR ZDATE2                                    AUS003
     C                     Z-ADD1         ZDAY                            AUS003
     C  N98                MOVELZDAY      ZWRK4                           AUS003
     C   98                MOVE ZDAY      ZWRK4                           AUS003
     C                     MOVELZWRK4     ZDATE                           AUS003
     C                     EXSR ZDATE1                                    AUS003
     C                     Z-ADDZDAYNO    BEGMON  50                      AUS003
     C*                                                                   S01194
     C**   CALCULATE HISTORY CUT-OFF DATE
     C***********DHRP******MULT 31        DHRPD   30                      E15188
     C*****      DHRP ***  MULT 31 ****   DHRPD * 40               E15188 S01194
     C           BNDHRT    MULT 31        DHRPD   40                      S01194
     C*****      RUND ***  SUB  DHRPD *** HCO *** 50                      S01194
     C           BJRDNB    SUB  DHRPD     HCO     50                      S01194
     C*                                                                   AUS007
     C** Access SAR details file to determine if Australian Brokerage     AUS007
     C** is switched on                                                   AUS007
     C*                                                                   AUS007
     C                     CALL 'AOSARDR0'                                AUS007
     C                     PARM *BLANKS   @RTCD                           AUS007
     C                     PARM '*VERIFY' @OPTN                           AUS007
     C                     PARM 'AUS007'  @SARD   6                       AUS007
     C           SCSARD    PARM SCSARD    DSFDY                           AUS007
     C           @RTCD     IFNE *BLANKS                                   AUS007
     C           @RTCD     ANDNE'*NRF   '                                 AUS007
     C           *LOCK     IN   LDA                        ***************AUS007
     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 013 *AUS007
     C***********          MOVEL'013'     DBASE      ***************AUS007CIR001
     C                     Z-ADD13        DBASE                           CIR001
     C                     MOVEL'AUS007'  DBKEY                           AUS007
     C                     OUT  LDA                                       AUS007
     C                     SETON                     U7U8LR               AUS007
     C                     END                                            AUS007
     C           @RTCD     IFEQ *BLANK                                    AUS007
     C                     MOVEL'Y'       AUS007  1                       AUS007
     C                     ELSE                                           AUS007
     C                     MOVEL'N'       AUS007                          AUS007
     C                     SETON                     25                   AUS007
     C                     END                                            AUS007
      *                                                                                       CAS006
     C                     CALL 'AOSARDR0'                                                    CAS006
     C                     PARM *BLANKS   @RTCD                                               CAS006
     C                     PARM '*VERIFY' @OPTN                                               CAS006
     C                     PARM 'CAS006'  @SARD   6                                           CAS006
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS006
      *                                                                                       CAS006
     C           @RTCD     IFNE *BLANKS                                                       CAS006
     C           @RTCD     ANDNE'*NRF   '                                                     CAS006
     C           *LOCK     IN   LDA                        ***************                    CAS006
     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 018 *                    CAS006
     C                     Z-ADD18        DBASE            ***************                    CAS006
     C                     MOVEL'CAS006'  DBKEY                                               CAS006
     C                     OUT  LDA                                                           CAS006
     C                     MOVE '1'       *INU7                                               CAS006
     C                     MOVE '1'       *INU8                                               CAS006
     C                     MOVE '1'       *INLR                                               CAS006
     C                     EXSR *PSSR                                                         CAS006
     C                     ENDIF                                                              CAS006
      *                                                                                       CAS006
     C           @RTCD     IFEQ *BLANK                                                        CAS006
     C                     MOVEL'Y'       CAS006  1                                           CAS006
     C                     ELSE                                                               CAS006
     C                     MOVEL'N'       CAS006                                              CAS006
     C                     ENDIF                                                              CAS006
     C*                                                                   S01408
      ** Keylist for Hedge Transactions Details file                                          CAS002
      *                                                                                       CAS002
     C                     MOVE 'DL'      WMODUL  2                                           CAS002
      *                                                                                       CAS002
      ** In order to access both derivative and hedged items from                             CAS002
      ** ASHTRNL6, use a partial key list, omitting the Hedge Indicator.                      CAS002
      *                                                                                       CAS002
     C           KHTRN6    KLIST                                                              CAS002
     C                     KFLD           WMODUL                                              CAS002
     C**********           KFLD           DLNO                                         CAS002 CLE148
     C                     KFLD           DLNOA   6                                           CLE148
      *                                                                                       CAS002
     C/COPY WNCPYSRC,DL1070CCP1                                           S01408
     C*                                                                   S01408
      *                                                                   CIR001
      **  Access SAR details file to determine if Australian              CIR001
      **  Modifications is switched on.                                   CIR001
      *                                                                   CIR001
     C                     CALL 'AOSARDR0'                                CIR001
     C                     PARM *BLANKS   @RTCD                           CIR001
     C                     PARM '*VERIFY' @OPTN                           CIR001
     C                     PARM 'CIR001'  @SARD   6                       CIR001
     C           SCSARD    PARM SCSARD    DSFDY                           CIR001
      *                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     ANDNE'*NRF   '                                 CIR001
     C           *LOCK     IN   LDA                        ***************CIR001
     C                     MOVEL'SCSARDPD'DBFILE           * DB ERROR 23 *CIR001
     C                     Z-ADD23        DBASE            ***************CIR001
     C                     MOVEL'CIR001'  DBKEY                           CIR001
     C                     OUT  LDA                                       CIR001
     C                     SETON                     U7U8LR               CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C           @RTCD     IFEQ *BLANKS                                   CIR001
     C                     MOVEL'Y'       CIR001  1                       CIR001
     C                     ELSE                                           CIR001
     C                     MOVEL'N'       CIR001                          CIR001
     C                     END                                            CIR001
      *                                                                   CDL002
      **  Access SAR details file to determine if FX Netting              CDL002
      **  Switchable Feature is switched on.                              CDL002
      *                                                                   CDL002
     C                     CALL 'AOSARDR0'                                CDL002
     C                     PARM *BLANKS   @RTCD                           CDL002
     C                     PARM '*VERIFY' @OPTN                           CDL002
     C                     PARM 'CDL002'  @SARD                           CDL002
     C           SCSARD    PARM SCSARD    DSFDY                           CDL002
      *                                                                   CDL002
     C           @RTCD     IFNE *BLANKS                                   CDL002
     C           @RTCD     ANDNE'*NRF   '                                 CDL002
     C           *LOCK     IN   LDA                        ***************CDL002
     C                     MOVEL'SCSARDPD'DBFILE           * DB ERROR 53 *CDL002
     C                     Z-ADD05        DBASE            ***************CDL002
     C                     MOVEL'CDL002'  DBKEY                           CDL002
     C                     OUT  LDA                                       CDL002
     C                     SETON                     U7U8LR               CDL002
     C                     END                                            CDL002
      *                                                                   CDL002
     C           @RTCD     IFEQ *BLANKS                                   CDL002
     C                     MOVEL'Y'       CDL002  1                       CDL002
     C                     OPEN FXNETML3                                  CDL002
     C                     ELSE                                           CDL002
     C                     MOVEL'N'       CDL002                          CDL002
     C                     END                                            CDL002
      *                                                                                       CDL025
      **  Access SAR details file to determine if FX Split Netting                            CDL025
      **  Switchable Feature is switched on.                                                  CDL025
      *                                                                                       CDL025
     C                     CALL 'AOSARDR0'                                                    CDL025
     C                     PARM *BLANKS   @RTCD                                               CDL025
     C                     PARM '*VERIFY' @OPTN                                               CDL025
     C                     PARM 'CDL025'  @SARD                                               CDL025
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL025
      *                                                                                       CDL025
     C           @RTCD     IFNE *BLANKS                                                       CDL025
     C           @RTCD     ANDNE'*NRF   '                                                     CDL025
     C           *LOCK     IN   LDA                        ***************                    CDL025
     C                     MOVEL'SCSARDPD'DBFILE           * DB ERROR 09 *                    CDL025
     C                     Z-ADD09        DBASE            ***************                    CDL025
     C                     MOVEL'CDL025'  DBKEY                                               CDL025
     C                     OUT  LDA                                                           CDL025
     C                     SETON                     U7U8LR                                   CDL025
     C                     END                                                                CDL025
      *                                                                                       CDL025
     C           @RTCD     IFEQ *BLANKS                                                       CDL025
     C                     MOVEL'Y'       CDL025  1                                           CDL025
     C                     OPEN FXNETSPD                                                      CDL025
     C                     ELSE                                                               CDL025
     C                     MOVEL'N'       CDL025                                              CDL025
     C                     END                                                                CDL025
      *                                                                   CIR006
      ** Determine if SAR CIR006 is installed                             CIR006
      *                                                                   CIR006
     C                     CALL 'AOSARDR0'                                CIR006
     C                     PARM *BLANKS   @RTCD                           CIR006
     C                     PARM '*VERIFY '@OPTN                           CIR006
     C                     PARM 'CIR006'  @SARD                           CIR006
     C           SCSARD    PARM SCSARD    DSFDY                           CIR006
      *                                                                   CIR006
     C           @RTCD     IFNE *BLANKS                                   CIR006
     C           @RTCD     ANDNE'*NRF   '                                 CIR006
     C           *LOCK     IN   LDA                                       CIR006
     C                     MOVEL'SCSARDPD'DBFILE                          CIR006
     C                     Z-ADD24        DBASE                           CIR006
     C                     MOVEL'CIR006'  DBKEY                           CIR006
     C                     OUT  LDA                                       CIR006
     C                     MOVE *ON       *INU7                           CIR006
     C                     MOVE *ON       *INU8                           CIR006
     C                     MOVE *ON       *INLR                           CIR006
     C                     EXSR *PSSR                                     CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           @RTCD     IFEQ *BLANKS                                   CIR006
     C                     MOVE 'Y'       CIR006  1                       CIR006
     C                     ELSE                                           CIR006
     C                     MOVE 'N'       CIR006                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR003
      **  Access SAR details file to determine if CIR003 feature          CIR003
      **  is installed.                                                   CIR003
      *                                                                   CIR003
     C                     CALL 'AOSARDR0'                                CIR003
     C                     PARM *BLANKS   @RTCD                           CIR003
     C                     PARM '*VERIFY' @OPTN                           CIR003
     C                     PARM 'CIR003'  @SARD   6                       CIR003
     C           SCSARD    PARM SCSARD    DSFDY                           CIR003
      *                                                                   CIR003
     C           @RTCD     IFNE *BLANKS                                   CIR003
     C           @RTCD     ANDNE'*NRF   '                                 CIR003
     C           *LOCK     IN   LDA                        ***************CIR003
     C                     MOVEL'SCSARDPD'DBFILE           * DB ERROR 25 *CIR003
     C                     Z-ADD25        DBASE            ***************CIR003
     C                     MOVEL'CIR003'  DBKEY                           CIR003
     C                     OUT  LDA                                       CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           @RTCD     IFEQ *BLANKS                                   CIR003
     C                     MOVEL'Y'       CIR003  1                       CIR003
     C                     ELSE                                           CIR003
     C                     MOVEL'N'       CIR003                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   S01486
      ** Check if switchable feature CAS002 is switched on                                    CAS002
      *                                                                                       CAS002
     C                     CALL 'AOSARDR0'                                                    CAS002
     C                     PARM *BLANKS   PRTCD   7                                           CAS002
     C                     PARM '*VERIFY' POPTN   7                                           CAS002
     C                     PARM 'CAS002'  PSARD   6                                           CAS002
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS002
      *                                                                                       CAS002
     C           PRTCD     IFNE *BLANK                                                        CAS002
     C           PRTCD     ANDNE'*NRF   '                                                     CAS002
     C           *LOCK     IN   LDA                                                           CAS002
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS002
     C                     Z-ADD26        DBASE                                               CAS002
     C                     MOVEL'CAS002'  DBKEY                                               CAS002
     C                     OUT  LDA                                                           CAS002
     C                     EXSR *PSSR                                                         CAS002
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS002
     C           PRTCD     IFEQ *BLANKS                                                       CAS002
     C                     MOVE 'Y'       CAS002  1                                           CAS002
     C                     ELSE                                                               CAS002
     C                     MOVE 'N'       CAS002                                              CAS002
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS002
      ** Check if switchable feature CDL018 is switched on                                    CDL018
      *                                                                                       CDL018
     C                     CALL 'AOSARDR0'                                                    CDL018
     C                     PARM *BLANKS   PRTCD                                               CDL018
     C                     PARM '*VERIFY' POPTN                                               CDL018
     C                     PARM 'CDL018'  PSARD                                               CDL018
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL018
      *                                                                                       CDL018
     C           PRTCD     IFNE *BLANK                                                        CDL018
     C           PRTCD     ANDNE'*NRF   '                                                     CDL018
     C           *LOCK     IN   LDA                                                           CDL018
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL018
     C                     Z-ADD27        DBASE                                               CDL018
     C                     MOVEL'CDL018'  DBKEY                                               CDL018
     C                     OUT  LDA                                                           CDL018
     C                     EXSR *PSSR                                                         CDL018
     C                     ENDIF                                                              CDL018
      *                                                                                       CDL018
     C                     MOVE 'N'       CDL018                                              CDL018
     C           PRTCD     IFEQ *BLANKS                                                       CDL018
     C                     MOVE 'Y'       CDL018  1                                           CDL018
     C                     ENDIF                                                              CDL018
      *                                                                                       CDL018
      ** Check if enhancement CLE025 (Credit Lines) is on                                     CLE025
      *                                                                                       CLE025
     C                     CALL 'AOSARDR0'                                                    CLE025
     C                     PARM *BLANKS   PRTCD                                               CLE025
     C                     PARM '*VERIFY' POPTN                                               CLE025
     C                     PARM 'CLE025'  PSARD                                               CLE025
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE025
      *                                                                                       CLE025
     C           PRTCD     IFNE *BLANKS                                                       CLE025
     C           PRTCD     ANDNE'*NRF   '                                                     CLE025
     C           *LOCK     IN   LDA                                                           CLE025
     C                     MOVEL'SCSARDPD'DBFILE                                              CLE025
     C                     MOVEL'CLE025'  DBKEY                                               CLE025
     C                     Z-ADD29        DBASE                                               CLE025
     C                     OUT  LDA                                                           CLE025
     C                     EXSR *PSSR                                                         CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
     C           PRTCD     IFEQ *BLANKS                                                       CLE025
     C                     MOVE 'Y'       CLE025  1                                           CLE025
     C                     ELSE                                                               CLE025
     C                     MOVE 'N'       CLE025                                              CLE025
     C                     ENDIF                                                              CLE025
      *                                                                                       CLE025
      ** Check if CAS009 is enabled.                                                          CAS009
      *                                                                                       CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANKS   PRTCD                                               CAS009
     C                     PARM '*VERIFY' POPTN                                               CAS009
     C                     PARM 'CAS009'  PSARD                                               CAS009
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS009
      *                                                                                       CAS009
     C                     MOVE 'N'       CAS009  1                                           CAS009
     C           PRTCD     IFEQ *BLANKS                                                       CAS009
     C                     MOVE 'Y'       CAS009                                              CAS009
     C                     ELSE                                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFNE '*NRF   '                                                     CAS009
     C           *LOCK     IN   LDA                                                           CAS009
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS009
     C                     MOVELPSARD     DBKEY                                               CAS009
     C                     Z-ADD101       DBASE                                               CAS009
     C                     OUT  LDA                                                           CAS009
     C                     MOVE *ON       *INU7                                               CAS009
     C                     MOVE *ON       *INU8                                               CAS009
     C                     MOVE *ON       *INLR                                               CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
      ** Call AOSARDR0 to check if CDL099 is enabled                                          CDL099
      *                                                                                       CDL099
     C                     CALL 'AOSARDR0'                                                    CDL099
     C                     PARM           URTCD   7                                           CDL099
     C                     PARM '*KEY   ' UOPTN   7                                           CDL099
     C                     PARM 'CDL099'  USARC   6                                           CDL099
     C           @SARD     PARM @SARD     DSFDY                                               CDL099
      *                                                                                       CDL099
     C           URTCD     IFNE *BLANKS                                                       CDL099
     C                     MOVE 'N'       CDL099  1                                           CDL099
     C                     ELSE                                                               CDL099
     C                     MOVE 'Y'       CDL099                                              CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C/COPY WNCPYSRC,DL1070C011
     C** Call Access program for Midas Modules Details                    S01486
     C                     CALL 'AOMMODR0'                                S01486
     C                     PARM '*MSG    '@RTCD                           S01486
     C                     PARM '*FIRST  '@OPTN                           S01486
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01486
     C*                                                                   S01486
     C           @RTCD     IFNE *BLANK                                    S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVEL'SDMMODPD'DBFILE            ************* S01486
     C                     MOVEL'04'      DBASE             *DBERROR 004* S01486
     C                     MOVEL@OPTN     DBOPTN            ************* S01486
     C                     OUT  LDA                                       S01486
     C                     SETON                     U7U8LR               S01486
     C                     END                                            S01486
      *                                                                   S01486
      ** Define WWICCY, WWAMNT for PM                                     S01486
      *                                                                   S01486
     C                     MOVEL*BLANK    WWICCY  3                       S01486
     C                     Z-ADD0         WWAMNT 150                      S01486
      *                                                                   S01486
      ** Open Portfolio Management files                                  S01486
      *                                                                   S01486
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C                     OPEN FDDTSTL0                                  S01486
     C                     OPEN PMCHTVPD                                  S01486
     C                     OPEN PMMFHLL1                                  S01486
     C                     END                                            S01486
      *                                                                                       CER050
      ** Check if switchable feature CER050 is switched on                                    CER050
      *                                                                                       CER050
     C                     CALL 'AOSARDR0'                                                    CER050
     C                     PARM *BLANKS   PRTCD                                               CER050
     C                     PARM '*VERIFY' POPTN                                               CER050
     C                     PARM 'CER050'  PSARD                                               CER050
     C           SCSARD    PARM SCSARD    DSFDY                                               CER050
      *                                                                                       CER050
     C           PRTCD     IFEQ *BLANKS                                                       CER050
     C                     MOVE 'Y'       CER050  1                                           CER050
     C                     ELSE                                                               CER050
     C                     MOVE 'N'       CER050                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CDL012
      ** Check if switchable feature CDL012 is switched on                                    CDL012
      *                                                                                       CDL002
     C                     CALL 'AOSARDR0'                                                    CDL012
     C                     PARM *BLANKS   PRTCD   7                                           CDL012
     C                     PARM '*VERIFY' POPTN   7                                           CDL012
     C                     PARM 'CDL012'  PSARD   6                                           CDL012
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL012
      *                                                                                       CDL012
     C           PRTCD     IFNE *BLANK                                                        CDL012
     C           PRTCD     ANDNE'*NRF   '                                                     CDL012
     C           *LOCK     IN   LDA                                                           CDL012
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL012
     C                     Z-ADD27        DBASE                                               CDL012
     C                     MOVEL'CDL012'  DBKEY                                               CDL012
     C                     OUT  LDA                                                           CDL012
     C                     EXSR *PSSR                                                         CDL012
     C                     ENDIF                                                              CDL012
      *                                                                                       CDL012
     C           PRTCD     IFEQ *BLANKS                                                       CDL012
     C                     MOVE 'Y'       CDL012  1                                           CDL012
     C                     ELSE                                                               CDL012
     C                     MOVE 'N'       CDL012                                              CDL012
     C                     ENDIF                                                              CDL012
      *                                                                                       CDL012
      ** Retrieve system values for 'DepIntRetenPerd'                                         CDL012
     C                     Z-ADD0         GDIRP   10                                          CDL012
     C           CDL012    IFEQ 'Y'                                                           CDL012
     C                     CALL 'AOSVALR0'                                                    CDL012
     C                     PARM           @RTCD                                               CDL012
     C                     PARM SVALKK    SVALK1 20                                           CDL012
     C                     PARM           SVAL1 200                                           CDL012
     C                     PARM *BLANK    SVALK2 20                                           CDL012
     C                     PARM           SVAL2 200                                           CDL012
     C                     PARM *BLANK    SVALK3 20                                           CDL012
     C                     PARM           SVAL3 200                                           CDL012
     C                     PARM *BLANK    SVALK4 20                                           CDL012
     C                     PARM           SVAL4 200                                           CDL012
     C                     PARM *BLANK    SVALK5 20                                           CDL012
     C                     PARM           SVAL5 200                                           CDL012
     C                     PARM *BLANK    SVALK6 20                                           CDL012
     C                     PARM           SVAL6 200                                           CDL012
     C                     PARM *BLANK    SVALK7 20                                           CDL012
     C                     PARM           SVAL7 200                                           CDL012
     C                     PARM *BLANK    SVALK8 20                                           CDL012
     C                     PARM           SVAL8 200                                           CDL012
     C                     PARM *BLANK    SVALK9 20                                           CDL012
     C                     PARM           SVAL9 200                                           CDL012
     C                     PARM *BLANK    SVALK0 20                                           CDL012
     C                     PARM           SVAL10200                                           CDL012
     C           @RTCD     IFNE *BLANK                                                        CDL012
     C           *LOCK     IN   LDA                                                           CDL012
     C                     MOVEL'SDSVALPD'DBFILE                                              CDL012
     C                     Z-ADD28        DBASE                                               CDL012
     C                     MOVELSVALKK    DBKEY                                               CDL012
     C                     OUT  LDA                                                           CDL012
     C                     EXSR *PSSR                                                         CDL012
     C                     ELSE                                                               CDL012
     C                     Z-ADDSVAL11    GDIRP                                               CDL012
     C                     ENDIF                                                              CDL012
     C                     ENDIF                                                              CDL012
     C**
     C                     END                             ** END 001
     C**   DETAIL PROCESSING
      *                                                                   S01444
      ** Initialise MDATW if deal read from historic file                 S01444
      *                                                                   S01444
     C                     Z-ADD0         MDATW                           S01444
      *                                                                   S01444
      ** Place MDAT in workfield 'MDATW'                                  S01444
      *                                                                   S01444
     C           *IN71     IFEQ '1'                                       S01444
     C           *IN72     OREQ '1'                                       S01444
     C           *IN74     OREQ '1'                                       S01444
     C                     Z-ADDMDAT      MDATW   50                      S01444
     C                     END                                            S01444
      *                                                                   S01444
      ** For FX deals use greater of value date and option to date        S01444
      *                                                                   S01444
     C           *IN70     IFEQ '1'                                       S01444
     C           OTDT      IFGT VDAT                                      S01444
     C                     Z-ADDOTDT      MDATW                           S01444
     C                     ELSE                                           S01444
     C                     Z-ADDVDAT      MDATW                           S01444
     C                     END                                            S01444
     C                     END                                            S01444
      *                                                                   S01444
      ** For NA sold use value date                                       S01444
      *                                                                   S01444
     C           *IN73     IFEQ '1'                                       S01444
     C                     Z-ADDVDAT      MDATW                           S01444
     C                     END                                            S01444
     C/COPY WNCPYSRC,DL1070C008
     C*                                                                   E13028
     C*****INITIALISE*MDATW*                                        E13028S01444
     C*                                                                   E13028
     C*********************Z-ADD0         MDATW                     E13028S01444
     C**   PLACE 'MDAT' IN WORK FIELD 'MDATW'                             E11887
     C           *IN02     IFEQ '1'                                       S01444
     C           *IN03     OREQ '1'                                       S01444
     C           *IN07     OREQ '1'                                       S01444
     C                     Z-ADDMDAT      MDATW   50                      S01444
     C                     END                                            S01444
     C**N01N04*************Z-ADDMDAT      MDATW   50                E11887S01444
     C**   FOR F.X. DEALS USE GREATER OF VALUE DATE AND OPTION TO DATE    E11887
     C   01      OTDT      IFGT VDAT                                      E11887
     C                     Z-ADDOTDT      MDATW                           E11887
     C                     ELSE                                           E11887
     C                     Z-ADDVDAT      MDATW                           E11887
     C                     END                                            E11887
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1070CCP4                                           S01408
     C*                                                                   S01408
      *                                                                                       CDL099
      ** If CDL099 Exists in System, then Initialise Field MDATW.                             CDL099
      ** NOTE: Work Field MDATW is updated in this part of the program                        CDL099
      **       if all conditions are Satisfied.                                               CDL099
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C           *IN01     ANDEQ'1'                                                           CDL099
     C           MDATW     ANDLTBSDT2                                                         CDL099
     C                     Z-ADDBSDT2     MDATW                                               CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C**   FOR N.A.SOLD USE VALUE DATE                                    E11887
     C   04                Z-ADDVDAT      MDATW                           E11887
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1070CCP3                                           S01408
     C*                                                                   S01408
      *                                                                   CIR001
      **  If Deal type is either 'RS' or 'RX' AND if Buy-out value date   CIR001
      **  is not Zero, the work maturity date is set to the Buy-out       CIR001
      **  value date.                                                     CIR001
      **  This is also true for caps/collars/floors if CIR006 is on       CIR006
      *                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           DTYP      IFEQ 'RS'                                      CIR001
     C           DTYP      OREQ 'RX'                                      CIR001
     C           CIR006    OREQ 'Y'                                       CIR006
     C           DTYP      ANDEQ'RP'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           DTYP      ANDEQ'RR'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           DTYP      ANDEQ'RF'                                      CIR006
     C           BOVD      IFNE 0                                         CIR001
     C                     Z-ADDBOVD      MDATW                           CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C/COPY WNCPYSRC,DL1070C010
      *                                                                   CIR001
     C***********AUS007    IFEQ 'Y'                                AUS007 048933
     C************IN02     ANDEQ'1'                                AUS007 048933
     C***********          SETON                     2225          AUS007 048933
     C***********          END                                     AUS007 048933
     C**   DEALS MATURED THIS MONTH - CHANGE RECORD I.D.
     C*****LOAN/DEPOSIT*ON*FREQ*'N'*ONLY*CHGE*IF*MAT.*IN*PREV*MONTHAUS003 048933
     C           RECI      IFEQ 'M'                        ** IF  001
     C           BGN4ST    ANDEQ'N'                                       CPB001
     C           RECI      OREQ 'M'                                       CPB001
     C           BGN4ST    ANDEQ'Y'                                       CPB001
     C           REPI      ANDNE'Y'                                       CPB001
     C*                                                                   CPB001
     C**  FOR FREQ 'N' ONLY MAKE HISTORIC AFTER LAST INT.DTE PROC'ED      048933
     C           MDATW     IFLT BJRDNB                     ** IF  002     048933
     C           IPFR      ANDNE'N'                                       048933
     C           IPFR      OREQ 'N'                                       048933
     C           NIDT      ANDGEMDATW                                     048933
     C           NIDT      ANDLTBJRDNB                                    048933
     C                     MOVE 'N'       RECI                            048933
     C                     ADD  1         RECSM   50                      048933
     C/COPY WNCPYSRC,DL1070C004
     C                     END                             **  E  002     048933
     C/COPY WNCPYSRC,DL1070C009
     C***********MDATW     ANDLTBJRDNB                     **      E43300 048933
     C************IN02     IFEQ '1'                        ** IF   AUS003 048933
     C***********IPFR      ANDEQ'N'                        ** IF   AUS003 048933
     C***********MDAT      ANDGEBEGMON                             AUS003 048933
     C***********          Z-ADD0         IPRM                     AUS003 048933
     C***********          Z-ADD0         TAXM                     AUS003 048933
     C***********          ELSE                            **  X   AUS003 048933
     C***********AUS007    IFEQ 'Y'                                AUS007 048933
     C************IN02     ANDEQ'1'                                AUS007 048933
     C***********          EXSR RDPSVF                             AUS007 048933
     C***********          END                                     AUS007 048933
     C***********          MOVE 'N'       RECI                            048933
     C**   UPDATE RECORD ONLY IF DEAL IS NOT TO BE DELETED
     C***********MDAT******IFGT HCO                        ** IF  002     E13028
     C           MDATW     IFGT HCO                        ** IF  002     E13028
     C*                                                                   E10431
     C**   IF AN NA PURCHASED RECORD ZEROISE IPRM & TAXM                  E10431
     C*                                                                   E10431
     C           *IN02     IFEQ '1'                                       E10431
     C                     Z-ADD0         IPRM                            E10431
     C                     Z-ADD0         TAXM                            E10431
     C/COPY WNCPYSRC,DL1070C006
     C                     END                                            E10431
     C*                                                                   E10431
     C**   IF AN NA SOLD RECORD ZEROISE IPRM                              E10431
     C*                                                                   E10431
     C           *IN03     IFEQ '1'                                       E10431
     C                     Z-ADD0         IPRM                            E10431
     C                     END                                            E10431
     C*                                                                   S01119
     C**   IF AN FRA/IRS RECORD ZEROISE BOTH IPRMS & TAXMS                S01119
     C*                                                                   S01119
     C           *IN07     IFEQ '1'                                       S01119
     C                     Z-ADD0         UIPRM                           S01119
     C                     Z-ADD0         UTAXM                           S01119
     C                     Z-ADD0         TIPRM                           S01119
     C                     Z-ADD0         TTAXM                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
      *                                                                   S01444
      ** Update appropriate history file according to deal type           S01444
      ** being processed                                                  S01444
      *                                                                   S01444
     C           RECI      IFEQ 'N'                                       S01444
     C*                                                                   S01444
     C           *IN01     IFEQ '1'                                       S01444
     C                     WRITEDLBHISD1                                  S01444
     C/COPY WNCPYSRC,DL1070C018
     C*                                                                   CDL002
     C           CDL002    IFEQ 'Y'                                       CDL002
     C                     EXSR NETHST                                    CDL002
     C                     END                                            CDL002
     C/COPY WNCPYSRC,DL1070C012
     C*                                                                   CDL002
     C                     END                                            S01444
     C*                                                                   S01444
     C           *IN02     IFEQ '1'                                       S01444
     C                     WRITEDLCHISD1                                  S01444
     C                     END                                            S01444
     C*                                                                   S01444
     C           *IN03     IFEQ '1'                                       S01444
     C                     WRITEDLDHISD1                                  S01444
     C                     END                                            S01444
     C*                                                                   S01444
     C           *IN04     IFEQ '1'                                       S01444
     C                     WRITEDLEHISD1                                  S01444
     C/COPY WNCPYSRC,DL1070C014
     C                     END                                            S01444
     C*                                                                   S01444
     C           *IN07     IFEQ '1'                                       S01444
     C                     WRITEDLGHISD1                                  S01444
     C                     END                                            S01444
      ****************************************************************                CLE025 BUG3937
      ***If*CLE025*is*on,*delete*the*extension*record*****************                CLE025 BUG3937
      ***corresponding*to*the*deal*being*dropped**********************                CLE025 BUG3937
      ****************************************************************                CLE025 BUG3937
     C********** CLE025    IFEQ 'Y'                                                   CLE025 BUG3937
     C**********           MOVELDLNO      WDLNO   6                                   CLE025 BUG3937
     C**********           SELEC                                                      CLE025 BUG3937
     C********** *IN70     WHEQ *ON                                                   CLE025 BUG3937
     C********** WDLNO     CHAINDLDLDBD0             29                               CLE025 BUG3937
     C********** *IN29     IFEQ *OFF                                                  CLE025 BUG3937
     C**********           DELETDLDLDBD0                                              CLE025 BUG3937
     C**********           ENDIF                                                      CLE025 BUG3937
      ****************************************************************                CLE025 BUG3937
     C********** *IN71     WHEQ *ON                                                   CLE025 BUG3937
     C********** WDLNO     CHAINDLDLDCD0             29                               CLE025 BUG3937
     C********** *IN29     IFEQ *OFF                                                  CLE025 BUG3937
     C**********           DELETDLDLDCD0                                              CLE025 BUG3937
     C**********           ENDIF                                                      CLE025 BUG3937
      ****************************************************************                CLE025 BUG3937
     C********** *IN72     WHEQ *ON                                                   CLE025 BUG3937
     C********** WDLNO     CHAINDLDLDGD0             29                               CLE025 BUG3937
     C********** *IN29     IFEQ *OFF                                                  CLE025 BUG3937
     C**********           DELETDLDLDGD0                                              CLE025 BUG3937
     C**********           ENDIF                                                      CLE025 BUG3937
     C**********           ENDSL                                                      CLE025 BUG3937
      ****************************************************************                CLE025 BUG3937
     C**********           ENDIF                                                      CLE025 BUG3937
      ****************************************************************                CLE025 BUG3937
     C/COPY WNCPYSRC,DL1070C017
      *                                                                   S01444
      ** Increment the count of deleted records                           S01444
      *                                                                   S01444
     C                     ADD  1         RECSD   50                      S01444
      *                                                                   S01444
      ** Delete record from LF/DEALSH                                     S01444
      *                                                                   S01444
     C/COPY WNCPYSRC,DL1070C016
     C                     DELETDEALSH                                    S01444
      *                                                                                      252554A
      ** Delete the corresponding record in the UDF files.                                   252554A
      *                                                                                      252554A
     C                     Z-ADDDLNO      PDDLNO  60                                        AR588416
     C                     CALL 'MMDELUDF'                                                   252554A
     C**********           PARM           DLNO                                      252554A AR588416
     C                     PARM           PDDLNO                                            AR588416
     C                     PARM '*ALL'    #API    4                                          252554A
      *                                                                                      BUG3937
      ***If*CLE025*is*on, delete*the*extension*record                               BUG3937 MD027863
      ***corresponding to the deal being dropped                                    BUG3937 MD027863
      **********                                                                    BUG3937 MD027863
     C********** CLE025    IFEQ 'Y'                                        BUG3937 AR970738 MD027863
     C**********           MOVELDLNO      WDLNO   6                                 BUG3937 MD027863
     C**********           SELEC                                                    BUG3937 MD027863
     C********** *IN01     WHEQ *ON                                        BUG3937 BUG10315 MD027863
     C********** *IN70     WHEQ *ON                                                BUG10315 MD027863
     C**********  DLNO     CHAINDLDLDBD0             29                             BUG3937 MD027863
     C********** *IN29     IFEQ *OFF                                                BUG3937 MD027863
     C**********           DELETDLDLDBD0                                            BUG3937 MD027863
     C**********           ENDIF                                                    BUG3937 MD027863
      **********                                                                   BUG3937 MD027863
     C********** *IN02     WHEQ *ON                                        BUG3937 BUG10315 MD027863
     C********** *IN71     WHEQ *ON                                                BUG10315 MD027863
     C**********  DLNO     CHAINDLDLDCD0             29                             BUG3937 MD027863
     C********** *IN29     IFEQ *OFF                                                BUG3937 MD027863
     C**********           DELETDLDLDCD0                                            BUG3937 MD027863
     C**********           ENDIF                                                    BUG3937 MD027863
      **********                                                                   BUG3937 MD027863
     C********** *IN07     WHEQ *ON                                        BUG3937 BUG10315 MD027863
     C********** *IN74     WHEQ *ON                                                BUG10315 MD027863
     C********** WDLNO     CHAINDLDLDGD0             29                             BUG3937 MD027863
     C********** *IN29     IFEQ *OFF                                                BUG3937 MD027863
     C**********           DELETDLDLDGD0                                            BUG3937 MD027863
     C**********           ENDIF                                                    BUG3937 MD027863
     C**********           ENDSL                                                    BUG3937 MD027863
      **********                                                                    BUG3937 MD027863
     C**********           ENDIF                                           BUG3937 AR970738 MD027863
      *                                                                                       CDL012
      ** If CDL012 is installed AND                                                           CDL012
      **    Interest Retention Period is zero AND                                             CDL012
      **    it is a record from DEALSDC                                                       CDL012
     C           CDL012    IFEQ 'Y'                                                           CDL012
     C           GDIRP     ANDEQ*ZERO                                                         CDL012
     C           *IN02     ANDEQ*ON                                                           CDL012
      *                                                                                       CDL012
     C           DLNO      CHAINDLTCSTV0             54                                       CDL012
     C           *IN54     DOWEQ*OFF                                                          CDL012
      *                                                                                       CDL012
     C                     DELETDLTCSTP0                                                      CDL012
      *                                                                                       CDL012
     C           DLNO      READEDLTCSTV0                 54                                   CDL012
     C                     ENDDO                                                              CDL012
      *                                                                                       CDL012
     C                     ENDIF                                                              CDL012
      *                                                                                     MD051650
      ** Delete records in HISTSAA                                                          MD051650
      *                                                                                     MD051650
     C           DLNO      CHAINHIST1                55                                     MD051650
     C           *IN55     DOWEQ*OFF                                                        MD051650
      *                                                                                     MD051650
     C                     DELETHISTSAAF                                                    MD051650
      *                                                                                     MD051650
     C           DLNO      READEHIST1                    55                                 MD051650
     C                     ENDDO                                                            MD051650
      *                                                                                       CAS002
      ** If CAS002 is installed                                                               CAS002
      *                                                                                       CAS002
     C           CAS002    IFEQ 'Y'                                                           CAS002
      *                                                                                       CAS002
      **   Delete Revalued FRA/IRS record if swap is being purged.                            CAS002
      *                                                                                       CAS002
     C           *IN07     IFEQ '1'                                                           CAS002
      *                                                                                       CAS005
      ** If deal type is 'RS', delete record from IRNPVAPD                                    CAS005
      *                                                                                       CAS005
     C           DTYP      IFEQ 'RS'                                                          CAS005
      *                                                                                       CAS005
     C********** DLNO      CHAINIRNPVLD0             27                                CAS002 CAS005
     C           DLNO      CHAINIRNPVAD0             27                                       CAS005
     C           *IN27     IFEQ '0'                                                           CAS002
     C**********           DELETIRNPVLD0                                               CAS002 CAS005
     C                     DELETIRNPVAD0                                                      CAS005
     C                     ENDIF                                                              CAS002
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Delete record from RXNPVAPD or RXNPVBPD or IRNPVBPD                                  CAS005
      *                                                                                       CAS005
     C                     EXSR SRDLRX                                                        CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS002
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS006
     C           CAS006    IFEQ 'Y'                                                           CAS006
     C           *IN07     ANDEQ'1'                                                           CAS006
      *                                                                                       CAS006
     C           DLNO      CHAINFRNPVAL0             27                                       CAS006
     C           *IN27     IFEQ '0'                                                           CAS006
     C                     DELETFRNPVAL0                                                      CAS006
     C                     ENDIF                                                              CAS006
     C                     ENDIF                                                              CAS006
      *                                                                                       CAS006
      ** If CDL018 is installed                                                               CDL018
      *                                                                                       CDL018
     C           CDL018    IFEQ 'Y'                                                           CDL018
     C           *IN02     ANDEQ'1'                                                           CDL018
      *                                                                                       CDL018
      ** Delete records from Further Settlement accounts file                                 CDL018
     C           DLNO      CHAINDLFSACL1             27                                       CDL018
     C           *IN27     IFEQ '0'                                                           CDL018
     C                     DELETDLFSACD0                                                      CDL018
     C                     ENDIF                                                              CDL018
     C                     ENDIF                                                              CDL018
      *                                                                                       229600
     C           DLNO      CHAINFRNPVLL0             27                                       229600
     C           *IN27     IFEQ '0'                                                           229600
     C                     DELETFRNPVLL0                                                      229600
     C                     ENDIF                                                              229600
      *                                                                                       CDL018
      *                                                                                       CAS002
     C/COPY WNCPYSRC,DL1070C001
     C*                                                                   S01444
     C                     ELSE                                           S01444
     C                     EXCPT
     C/COPY WNCPYSRC,DL1070C013
     C                     END                                            S01444
     C*                                                                   067566
     C** Increment count of deals matured but not deleted.                067566
     C*                                                                   067566
     C                     ADD  1         RECSM   50                      067566
     C***********          ADD  1         RECSM   50               E24041 048933
     C                     END                             ** END 002     AUS003
     C***********          ADD  1         RECSM1  50               AUS003 067566
     C***********          END                                            048933
     C*********************ADD  1         RECSM   50                      E24041
     C                     END                             ** END 001
     C**   CHECK WHETHER DEAL SHOULD BE DELETED
     C***********RECI******IFEQ 'N'                        ** IF  001     S01444
     C***********          ADD  1         RECSM1                   048933 067566
     C***********MDAT      IFLE HCO                        ** IF  002     E11887
     C***********MDATW*****IFLE HCO                        ** IF  00E11887S01444
     C*********************ADD  1         RECSD   50                      S01444
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1070CCP5                                           S01408
     C*                                                                   S01408
      *                                                                   S01444
      ** Delete record if RECI is N and calculated maturity date is       S01444
      ** less than or equal to the history cut off period, or if the      S01444
      ** RECI is R and the last change date is less than or equal to      S01444
      ** the history cut off period                                       S01444
      *                                                                   S01444
     C           RECI      IFEQ 'N'                        ** IF  001     S01444
     C           MDATW     ANDLEHCO                                       S01444
     C           RECI      OREQ 'R'                                       S01444
     C           LCD       ANDLEHCO                                       S01444
     C*                                                                   S01444
      *                                                                                       CAS002
     C                     MOVE *BLANK    WDROPH  1                                           CAS002
      *                                                                                       CAS002
     C           CAS002    IFEQ 'Y'                                                           CAS002
      *                                                                                       CAS002
      ** If processing any of the above Deals History record formats,                         CAS002
      ** check if the deal is specifed as a Derivative or Hedged Item                         CAS002
      ** on the Hedge Transaction Details file                                                CAS002
      *                                                                                       CAS002
     C           RCDFMT    IFEQ 'DLBHISD0'                                                    CAS002
     C           RCDFMT    OREQ 'DLCHISD0'                                                    CAS002
     C           RCDFMT    OREQ 'DLDHISD0'                                                    CAS002
     C           RCDFMT    OREQ 'DLEHISD0'                                                    CAS002
      *                                                                                       CAS002
      ** Verify if record exists                                                              CAS002
      *                                                                                       CAS002
     C                     MOVELDLNO      DLNOA                                               CLE148
     C           KHTRN6    SETLLASHTRNL6                 28                                   CAS002
      *                                                                                       CAS002
      ** If found, the history record cannot be dropped                                       CAS002
      *                                                                                       CAS002
     C           *IN28     IFEQ *ON                                                           CAS002
     C                     MOVE 'N'       WDROPH  1                                           CAS002
     C                     ELSE                                                               CAS002
     C                     MOVE *BLANK    WDROPH                                              CAS002
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS002
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS002
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS002
      ** Verify Related Roll-over deal if active                                              262129
      *                                                                                       262129
     C           RCDFMT    IFEQ 'DLCHISD0'                                                    262129
     C                     MOVE *BLANKS   XRECI                                               262129
     C           RBDN      CHAINXDEALSC              28                                       262129
     C           *IN28     IFEQ *OFF                                                          262129
     C           XRECI     ANDEQ'D'                                                           262129
     C                     MOVE 'N'       WDROPH                                              262129
     C                     ELSE                                                               262129
     C                     MOVE *BLANK    WDROPH                                              262129
     C                     ENDIF                                                              262129
     C                     ENDIF                                                              262129
      *                                                                                       262129
     C/COPY WNCPYSRC,DL1070C020
      *                                                                                       CAS002
      ** If record not found, drop history record                                             CAS002
      *                                                                                       CAS002
     C           WDROPH    IFEQ *BLANK                                                        CAS002
      *                                                                                       CAS002
     C*                                                                   S01486
     C** IF DEALSDB OR DEALSDC                                            S01486
     C** READ AND IF PORTFOLIO REFERENCE NON BLANK AND DEAL TYPE NOT 'OT' S01486
     C** THEN UPDATE PM CHANGES TO HISTORIC TURNOVER FILE                 S01486
     C*                                                                   S01486
     C           *IN01     IFEQ '1'                                       S01486
     C           *IN02     OREQ '1'                                       S01486
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C           PTFR      IFNE *BLANK                                    S01486
     C           DTYP      ANDNE'OT'                                      S01486
     C                     EXSR UPDTVF                                    S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C** IF PORTFOLIO REFERENCE NOT BLANK DELETE ALL HOLDINGS FOR THE     S01486
     C** DEAL FROM LF/PMMFHLL1                                            S01486
     C           BGPFMG    IFEQ 'Y'                                       S01486
     C           PTFR      IFNE *BLANKS                                   S01486
     C                     MOVE CNUM      QFCNUM                          S01486
     C***********          MOVE 'DL'      QFMODI                   S01486 127891
     C           *IN01     IFEQ '1'                                       127891
     C                     MOVE 'FX'      QFMODI                          127891
     C                     END                                            127891
     C           *IN02     IFEQ '1'                                       127891
     C           DTYP      IFEQ 'IP'                                      127891
     C           DTYP      OREQ 'TI'                                      127891
     C           DTYP      OREQ 'CL'                                      127891
     C           DTYP      OREQ 'LN'                                      127891
     C           DTYP      OREQ 'DL'                                      127891
     C                     MOVE 'ML'      QFMODI                          127891
     C                     ELSE                                           127891
     C                     MOVEL'MD'      QFMODI                          127891
     C                     END                                            127891
     C                     END                                            127891
     C           *IN07     IFEQ '1'                                       127891
     C                     MOVEL'FR'      QFMODI                          127891
     C                     END                                            127891
     C                     MOVE DLNO      QFTRNB                          S01486
     C                     MOVE *LOVAL    QFTDSS                          S01486
     C                     MOVE *LOVAL    QFTXT2                          S01486
     C                     MOVE *LOVAL    QFPTFR                          S01486
     C*                                                                   S01486
     C** SET FILE POINTER BEFORE FIRST RECORD FOR DEAL                    S01486
     C           MFHLKY    SETLLPMMFHLL1                                  S01486
     C           MFHLK1    READEPMMFHLL1                 60               S01486
     C*                                                                   S01486
     C           *IN60     DOWEQ'0'                                       S01486
     C                     DELETPMHOLDP0                                  S01486
     C           MFHLK1    READEPMMFHLL1                 60               S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C           CDL002    IFEQ 'Y'                                       CDL002
     C           *IN01     IFEQ '1'                                       CDL002
     C           *IN70     OREQ '1'                                       CDL002
     C                     EXSR NETDRP                                    CDL002
     C                     END                                            CDL002
     C                     END                                            CDL002
      ****************************************************************                CLE025 BUG3937
      ***If*CLE025*is*on,*delete*the*extension*record*****************                CLE025 BUG3937
      ***corresponding*to*the*deal*being*dropped**********************                CLE025 BUG3937
      ****************************************************************                CLE025 BUG3937
     C********** CLE025    IFEQ 'Y'                                                   CLE025 BUG3937
     C**********           MOVELDLNO      WDLNO                                       CLE025 BUG3937
     C**********           SELEC                                                      CLE025 BUG3937
     C********** *IN70     WHEQ *ON                                                   CLE025 BUG3937
     C********** WDLNO     CHAINDLDLDBD0             29                               CLE025 BUG3937
     C********** *IN29     IFEQ *OFF                                                  CLE025 BUG3937
     C**********           DELETDLDLDBD0                                              CLE025 BUG3937
     C**********           ENDIF                                                      CLE025 BUG3937
      ****************************************************************                CLE025 BUG3937
     C********** *IN71     WHEQ *ON                                                   CLE025 BUG3937
     C********** WDLNO     CHAINDLDLDCD0             29                               CLE025 BUG3937
     C********** *IN29     IFEQ *OFF                                                  CLE025 BUG3937
     C**********           DELETDLDLDCD0                                              CLE025 BUG3937
     C**********           ENDIF                                                      CLE025 BUG3937
      ****************************************************************                CLE025 BUG3937
     C********** *IN72     WHEQ *ON                                                   CLE025 BUG3937
     C********** WDLNO     CHAINDLDLDGD0             29                               CLE025 BUG3937
     C********** *IN29     IFEQ *OFF                                                  CLE025 BUG3937
     C**********           DELETDLDLDGD0                                              CLE025 BUG3937
     C**********           ENDIF                                                      CLE025 BUG3937
     C**********           ENDSL                                                      CLE025 BUG3937
      ****************************************************************                CLE025 BUG3937
     C**********           ENDIF                                                      CLE025 BUG3937
      *                                                                                       CAS009
      ** Drop the relevant historic fees if CAS009 is enabled.                                CAS009
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
      *                                                                                       CAS009
     C           DLNO      CHAINDLFHSTL0             10                                       CAS009
     C           *IN10     DOWNE*ON                                                           CAS009
     C                     DELETDLFHSTD0                                                      CAS009
     C           DLNO      READEDLFHSTL0                 10                                   CAS009
     C                     ENDDO                                                              CAS009
      *                                                                                       CAS009
     C           DLNO      CHAINMMCFSFL0             10                                       CAS009
     C           *IN10     DOWNE*ON                                                           CAS009
     C                     DELETMMCFLSD0                                                      CAS009
     C           DLNO      READEMMCFSFL0                 10                                   CAS009
     C                     ENDDO                                                              CAS009
      *                                                                                       CAS009
     C           DLNO      CHAINMMEIRDLA             10                                       CAS009
     C           *IN10     DOWNE*ON                                                           CAS009
     C                     DELETMMEIRDLA                                                      CAS009
     C           DLNO      READEMMEIRDLA                 10                                   CAS009
     C                     ENDDO                                                              CAS009
      *                                                                                       CAS009
     C           DLNO      CHAINMMEIRAL1             10                                       CAS009
     C           *IN10     DOWNE*ON                                                           CAS009
     C                     DELETMMEIRAD0                                                      CAS009
     C           DLNO      READEMMEIRAL1                 10                                   CAS009
     C                     ENDDO                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1070CDBU                                           S01408
     C*                                                                   S01408
     C                     DELETDEALSH
      *                                                                                      252554A
      ** Delete the corresponding record in the UDF files.                                   252554A
      *                                                                                      252554A
     C                     Z-ADDDLNO      PDDLNO                                            AR588416
     C                     CALL 'MMDELUDF'                                                   252554A
     C**********           PARM           DLNO                                      252554A AR588416
     C                     PARM           PDDLNO                                            AR588416
     C                     PARM '*ALL'    #API    4                                          252554A
      *                                                                                      BUG3937
      ** If CLE025 is on, delete the extension record                                        BUG3937
      ** corresponding to the deal being dropped                                             BUG3937
      *                                                                                      BUG3937
     C********** CLE025    IFEQ 'Y'                                                 BUG3937 AR970738
     C                     MOVELDLNO      WDLNO   6                                          BUG3937
     C                     SELEC                                                             BUG3937
     C********** *IN01     WHEQ *ON                                                 BUG3937 BUG10315
     C           *IN70     WHEQ *ON                                                         BUG10315
     C           *IN01     OREQ *ON                                                         AR970738
     C           WDLNO     CHAINDLDLDBD0             29                                      BUG3937
     C           *IN29     IFEQ *OFF                                                         BUG3937
     C                     DELETDLDLDBD0                                                     BUG3937
     C                     ENDIF                                                             BUG3937
      *                                                                                      BUG3937
     C********** *IN02     WHEQ *ON                                                 BUG3937 BUG10315
     C           *IN71     WHEQ *ON                                                         BUG10315
     C           *IN02     OREQ *ON                                                         AR970738
     C           WDLNO     CHAINDLDLDCD0             29                                      BUG3937
     C           *IN29     IFEQ *OFF                                                         BUG3937
     C                     DELETDLDLDCD0                                                     BUG3937
     C                     ENDIF                                                             BUG3937
      *                                                                                      BUG3937
     C********** *IN07     WHEQ *ON                                                 BUG3937 BUG10315
     C           *IN74     WHEQ *ON                                                         BUG10315
     C           *IN07     OREQ *ON                                                         AR970738
     C           WDLNO     CHAINDLDLDGD0             29                                      BUG3937
     C           *IN29     IFEQ *OFF                                                         BUG3937
     C                     DELETDLDLDGD0                                                     BUG3937
     C                     ENDIF                                                             BUG3937
     C                     ENDSL                                                             BUG3937
      *                                                                                      BUG3937
     C**********           ENDIF                                                    BUG3937 AR970738
      *                                                                                      BUG3021
      ** If CDL012 is installed AND                                                          BUG3021
      **    Interest Retention Period is zero AND                                            BUG3021
      **    it is a record from DEALSDC                                                      BUG3021
     C           CDL012    IFEQ 'Y'                                                          BUG3021
     C           GDIRP     ANDEQ*ZERO                                                        BUG3021
     C           *IN02     ANDEQ*ON                                                          BUG3021
      *                                                                                      BUG3021
     C           DLNO      CHAINDLTCSTV0             54                                      BUG3021
     C           *IN54     DOWEQ*OFF                                                         BUG3021
      *                                                                                      BUG3021
     C                     DELETDLTCSTP0                                                     BUG3021
      *                                                                                      BUG3021
     C           DLNO      READEDLTCSTV0                 54                                  BUG3021
     C                     ENDDO                                                             BUG3021
      *                                                                                      BUG3021
     C                     ENDIF                                                             BUG3021
      *                                                                                     MD051650
      ** Delete records in HISTSAA                                                          MD051650
      *                                                                                     MD051650
     C           DLNO      CHAINHIST1                55                                     MD051650
     C           *IN55     DOWEQ*OFF                                                        MD051650
      *                                                                                     MD051650
     C                     DELETHISTSAAF                                                    MD051650
      *                                                                                     MD051650
     C           DLNO      READEHIST1                    55                                 MD051650
     C                     ENDDO                                                            MD051650
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     EXSR SRDLEX                                    CIR003
     C                     ENDIF                                          CIR003
     C*                                                                   S01408
      *                                                                                       CAS002
      ** If CAS002 is installed                                                               CAS002
      *                                                                                       CAS002
     C           CAS002    IFEQ 'Y'                                                           CAS002
      *                                                                                       CAS002
      ** Delete Revalued FRA/IRS record if swap is being purged.                              CAS002
      *                                                                                       CAS002
     C           *IN07     IFEQ '1'                                                           CAS002
      *                                                                                       CAS005
      ** If deal type is 'RS', delete record from IRNPVAPD                                    CAS005
      *                                                                                       CAS005
     C           DTYP      IFEQ 'RS'                                                          CAS005
      *                                                                                       CAS005
     C********** DLNO      CHAINIRNPVLD0             27                                CAS002 CAS005
     C           DLNO      CHAINIRNPVAD0             27                                       CAS005
     C           *IN27     IFEQ '0'                                                           CAS002
     C**********           DELETIRNPVLD0                                               CAS002 CAS005
     C                     DELETIRNPVAD0                                                      CAS005
     C                     ENDIF                                                              CAS002
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Delete record from RXNPVAPD or RXNPVBPD or IRNPVBPD                                  CAS005
      *                                                                                       CAS005
     C                     EXSR SRDLRX                                                        CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS002
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS006
     C           CAS006    IFEQ 'Y'                                                           CAS006
     C           *IN07     ANDEQ'1'                                                           CAS006
     C           CAS006    OREQ 'Y'                                                           229600
     C           *IN74     ANDEQ'1'                                                           229600
      *                                                                                       CAS006
     C           DLNO      CHAINFRNPVAL0             27                                       CAS006
     C           *IN27     IFEQ '0'                                                           CAS006
     C                     DELETFRNPVAL0                                                      CAS006
     C                     ENDIF                                                              CAS006
      *                                                                                       229600
     C           DLNO      CHAINFRNPVLL0             27                                       229600
     C           *IN27     IFEQ '0'                                                           229600
     C                     DELETFRNPVLL0                                                      229600
     C                     ENDIF                                                              229600
     C                     ENDIF                                                              CAS006
      *                                                                                       CAS002
      ** If CDL018 is installed                                                               CDL018
      *                                                                                       CDL018
     C           CDL018    IFEQ 'Y'                                                           CDL018
     C           *IN02     ANDEQ'1'                                                           CDL018
      *                                                                                       CDL018
      ** Delete records from Further Settlement accounts file                                 CDL018
     C           DLNO      CHAINDLFSACL1             27                                       CDL018
     C           *IN27     IFEQ '0'                                                           CDL018
     C                     DELETDLFSACD0                                                      CDL018
     C                     ENDIF                                                              CDL018
     C                     ENDIF                                                              CDL018
      *                                                                                       CDL018
     C/COPY WNCPYSRC,DL1070CCP2                                           S01408
     C*                                                                   S01408
      * If CER050 is on, delete related APR records                                           CER050
     C           CER050    IFEQ 'Y'                                                           CER050
     C                     EXSR SRDLAP                                                        CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C           AUS007    IFEQ 'Y'                                       AUS007
     C           *IN02     ANDEQ'1'                                       AUS007
     C                     EXSR DLDPSV                                    AUS007
     C                     END                                            AUS007
     C*********************END                             ** END 002     S01444
     C                     END                             ** END 001
     C*                                                                   S01408
      *                                                                                       CAS002
     C                     ENDIF                                                              CAS002
      *                                                                                       CAS002
     C/COPY WNCPYSRC,DL1070CCP6                                           S01408
     C*                                                                   S01408
     C**   COUNT EXPIRED 1ST LEGS OF SWAPS FOR FILE CONTROLS
     C           RECI      IFEQ 'E'                        ** IF  001
     C                     ADD  1         RECSE   50
     C                     END                             ** END 001
     C*                                                                   E10431
     C**   IF DEALSDC RECORD READ FROM LF/DEALSI THEN ZEROISE IPRM        E10431
     C**   AND TAXM                                                       E10431
     C*                                                                   E10431
     C           *IN05     IFEQ '1'                                       E10431
     C                     Z-ADD0         IPRM                            E10431
     C                     Z-ADD0         TAXM                            E10431
     C                     EXCPTPURCH                                     E10431
     C/COPY WNCPYSRC,DL1070C007
     C                     END                                            E10431
     C*                                                                   E10431
     C**   IF DEALSDD RECORD READ FROM LF/DEALSI THEN ZEROISE IPRM        E10431
     C*                                                                   E10431
     C           *IN06     IFEQ '1'                                       E10431
     C                     Z-ADD0         IPRM                            E10431
     C                     EXCPTSOLD                                      E10431
     C                     END                                            E10431
     C*                                                                   E10431
     C*                                                                   S01119
     C**   IF DEALSDG RECORD READ FROM LF/DEALSI THEN ZEROISE BOTH IPRMS  S01119
     C**   AND TAXMS                                                      S01119
     C*                                                                   S01119
     C           *IN08     IFEQ '1'                                       S01119
     C                     Z-ADD0         UIPRM                           S01119
     C                     Z-ADD0         UTAXM                           S01119
     C                     Z-ADD0         TIPRM                           S01119
     C                     Z-ADD0         TTAXM                           S01119
     C                     EXCPTFRAIRS                                    S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL1070C003
     C**   TOTAL TIME - UPDATE FILE CONTROLS
     CLR                   MOVE '0'       *IN99
     CLR                   READ DEALSDFF                 99
     C**   ERRROR IF DEALS FILE TRAILER RECORD NOT FOUND   ** ERROR 01
     CLR         *IN99     IFEQ '1'                        ** IF  001
     CLR                   MOVEL'DL1070  'DBPGM
     CLR                   MOVEL'DEALS   'DBFILE
     CLR                   MOVEL'999999  'DBKEY
     CLR                   Z-ADD1         DBASE
     CLR                   MOVE '1'       *INU7
     CLR                   MOVE '1'       *INU8
     CLR                   ELSE                            ** ELS 001
     CLR                   Z-ADDNORE      NORE1   50                      AUS003
     C*R*********          SUB  RECSM1    NORE1                    AUS003 067566
     C*R*********          SUB  RECSM     NORE                            048933
     CLR                   SUB  RECSD     NORE                            048933
     C**   CHECK FILE CONTROLS
     C*R*********NORE      SUB  RECSE     WK5     50                      AUS003
     C***LR******NORE1     SUB  RECSE     WK5     50               AUS003 067566
     C***LR******          ADD  RECSM     WK5                      048933 067566
     C***LR******          SUB  2         WK5                             067566
     C***LR******WK5       COMP NLRA                 U8U8                 067566
     CLR                   END                             ** END 001
     C/COPY WNCPYSRC,DL1070C019
     C*                                                                   S01117
     C*R****               Z-ADDSFNUM     ZSNUM   60                S01117LN0171
     C** ENSURE SPOOL FILE RECORDED BY RCF                          S01117LN0171
     C*R****               OUT  LDA                                       LN0171
     C*R****               CALL 'ZSFILE'                            S01117LN0171
     C*R****               PARM *BLANK    SEQ     5                 S01117LN0171
     C*R****               PARM *BLANK    @PARM   3                 S01117LN0171
     C*R****               PARM           SFILE                     S01117LN0171
     C*R****               PARM           ZSNUM                     S01117LN0171
     C*R****               PARM *BLANKS   ZSERR   1                 S01117LN0171
     C*L****               IN   LDA                                 LN0101LN0171
     C*R****     *LOCK     IN   LDA                                 LN0101LN0171
     C******                                                        S01117LN0171
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM  S01117LN0171
     C*R****     ZSERR     IFEQ 'Y'                                 S01117LN0171
     C*R****               SETON                     U7U8           S01117LN0171
     C*R****               RETRN                                    S01117LN0171
     C*R****               END                                      S01117LN0171
     C******                                                        S01117LN0171
     C**************************************************************AUS007048933
     C**RDPSVF*-*READ FID FILE.                                     AUS007048933
     C**************************************************************AUS007048933
     C***********                                                   AUS007048933
     C***********RDPSVF    BEGSR                                    AUS007048933
     C***********                                                   AUS007048933
     C***********DLNO      CHAINBKRATMN              25             AUS007048933
     C***********                                                   AUS007048933
     C***********          ENDSR                                    AUS007048933
     C****************************************************************    AUS007
     C* DLDPSV - DELETE RECORD FROM DPSVF                                 AUS007
     C****************************************************************    AUS007
     C*                                                                   AUS007
     C           DLDPSV    BEGSR                                          AUS007
     C*                                                                   AUS007
     C***********          MOVE '0'       *IN24                    AUS007 048933
     C           DLNO      CHAINBKRATMN              25                   AUS007
     C************IN25     IFEQ '1'                                AUS007 048933
     C***********          MOVE '1'       *IN24                    AUS007 048933
     C***********          ELSE                                    AUS007 048933
     C***********RECIBK    IFEQ 'N'                                AUS007 048933
     C***********          MOVE '1'       *IN24                    AUS007 048933
     C***********          END                                     AUS007 048933
     C***********          END                                     AUS007 048933
     C***********                                                  AUS007 048933
     C************IN24     IFEQ '1'                                AUS007 048933
     C***********          MOVEL'DL1070  'DBPGM                    AUS007 048933
     C***********          MOVEL'BKRAT   'DBFILE                   AUS007 048933
     C***********          MOVELDLNO      DBKEY                    AUS007 048933
     C***********          Z-ADD4         DBASE                    AUS007 048933
     C***********          ELSE                                    AUS007 048933
     C           *IN25     IFEQ '0'                                       048933
     C           DLNO      DELETBKRATR               2223                 AUS007
     C                     END                                            AUS007
     C*                                                                   AUS007
     C                     ENDSR                                          AUS007
0905 C********************************************************************LN0171
     C/COPY WNCPYSRC,DL1070C005
      *************************************************************       CIR003
      *                                                           *       CIR003
      * SRDLEX - Delete record in DLGXSTPD when deal is drop from *       CIR003
      *          DLGHISTPD                                        *       CIR003
      *                                                           *       CIR003
      *************************************************************       CIR003
     C           SRDLEX    BEGSR                                          CIR003
      *                                                                   CIR003
      ** Value date                                                       CIR003
      *                                                                   CIR003
     C                     MOVE 'VAL'     WEVCD   3                       CIR003
     C           WDLKEY    CHAINDLGXSTL0             26                   CIR003
     C           *IN26     IFEQ '0'                                       CIR003
     C                     DELETDLGXSTD0                                  CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      ** Interest Settlement                                              CIR003
      *                                                                   CIR003
     C                     MOVE 'INT'     WEVCD                           CIR003
     C           WDLKEY    CHAINDLGXSTL0             26                   CIR003
     C           *IN26     IFEQ '0'                                       CIR003
     C                     DELETDLGXSTD0                                  CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      ** Maturity Settlement                                              CIR003
      *                                                                   CIR003
     C                     MOVE 'MAT'     WEVCD                           CIR003
     C           WDLKEY    CHAINDLGXSTL0             26                   CIR003
     C           *IN26     IFEQ '0'                                       CIR003
     C                     DELETDLGXSTD0                                  CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDSR                                          CIR003
      *************************************************************       CIR003
      /EJECT                                                              S01486
     C********************************************************************S01486
     C** UPDTVF      :  S/R TO UPDATE PM CHANGES TO HISTORIC TURNOVER FILES01486
     C********************************************************************S01486
     C*                                                                   S01486
     C           UPDTVF    BEGSR                           **UPDTVF BSR **S01486
     C*                                                                   S01486
     C** CHAIN TO FDDTSTPD WITH DEAL TYPE/SUBTYPE                         S01486
     C** TO GET THE PM INTRUMENT TYPE                                     S01486
     C*                                                                   S01486
     C           DTSTKY    CHAINFDDTSTPD             81                   S01486
     C           *IN81     IFEQ '1'                                       S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVEL'DL1070  'DBPGM                           S01486
     C                     MOVEL'FDDTSTPD'DBFILE                          S01486
     C                     MOVELDTSTDS    DBKEY                           S01486
     C                     Z-ADD2         DBASE                           S01486
1    C                     SETON                     U7U8                 S01486
     C                     OUT  LDA                                       S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C** CONVERT THE DEAL DATE TO DDMMYY FORMAT                           S01486
     C*                                                                   S01486
     C                     Z-ADDDDAT      ZDAYNO                          S01486
     C                     EXSR ZDATE2                                    S01486
     C                     MOVE ZDATE     WWDATE                          S01486
     C*                                                                   S01486
     C** DETERMINE WWICCY AND CALCULATE WWAMNT                            S01486
     C*                                                                   S01486
     C           *IN01     IFEQ '1'                                       S01486
     C                     MOVELSLCY      WWICCY                          S01486
     C                     Z-ADDSLAM      WWAMNT                          S01486
     C                     ELSE                                           S01486
     C           *IN02     IFEQ '1'                                       S01486
     C                     MOVELCCY       WWICCY                          S01486
     C                     Z-ADDPCPL      WWAMNT                          S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C** CHAIN TO SDPLINPD WITH INSTRUMENT TYPE TO GET DISPLAY GROUP      S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM 'BLANKS'  @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM INNR      @AJCD   3                       S01486
     C           SDPLIN    PARM SDPLIN    DSSDY                           S01486
     C*                                                                   S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVEL'DL1070  'DBPGM                           S01486
     C                     MOVEL'SDPLINPD'DBFILE                          S01486
     C                     MOVELINNR      DBKEY                           S01486
     C                     Z-ADD22        DBASE                           S01486
     C                     SETON                     U7U8                 S01486
     C                     OUT  LDA                                       S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C** CHAIN TO PM CHANGES TO HISTORIC TURNOVER FILE                    S01486
     C** TO KNOW IF RECORD ALREADY EXISTS                                 S01486
     C*                                                                   S01486
     C                     MOVE CNUM      SCCNUM                          S01486
     C                     MOVELPTFR      SCPTFR                          S01486
     C                     MOVELPDDSPG    SCDSPG                          S01486
     C                     MOVELPDINNR    SCINNR                          S01486
     C                     MOVELWWICCY    SCICCY                          S01486
     C**********           Z-ADD0         SCLIND                                       S01486 CER020
     C                     MOVEL*BLANKS   SCLOIC                                              CER020
     C                     Z-ADDWWYEAR    SCYRNO                          S01486
     C                     Z-ADDWWMTHN    SCMTHN                          S01486
     C           CHTVKY    CHAINPMCHTVP0             82                   S01486
     C*                                                                   S01486
     C** IF ALREADY EXISTS THEN UPDATE ELSE WRITE                         S01486
     C*                                                                   S01486
     C           *IN82     IFEQ '0'                                       S01486
     C*                                                                   S01486
     C           *IN02     IFEQ '1'                                       S01486
     C           SCTNVR    ADD  WWAMNT    SCTNVR                          S01486
     C                     ELSE                                           S01486
     C           SCTNVF    ADD  WWAMNT    SCTNVF                          S01486
     C                     END                                            S01486
     C                     UPDATPMCHTVP0                                  S01486
     C*                                                                   S01486
     C                     ELSE                                           S01486
     C                     MOVEL'D'       SCRECI                          S01486
     C           *IN02     IFEQ '1'                                       S01486
     C                     Z-ADDWWAMNT    SCTNVR                          S01486
     C                     Z-ADD0         SCTNVF                          S01486
     C                     ELSE                                           S01486
     C                     Z-ADDWWAMNT    SCTNVF                          S01486
     C                     Z-ADD0         SCTNVR                          S01486
     C                     END                                            S01486
     C                     Z-ADD0         SCNUCO                          S01486
     C                     WRITEPMCHTVP0               83                 S01486
     C           *IN83     IFEQ '1'                                       S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVEL'DL1070  'DBPGM                           S01486
     C                     MOVEL'PMCHTVPD'DBFILE                          S01486
     C                     MOVELCHTVDS    DBKEY                           S01486
     C                     Z-ADD3         DBASE                           S01486
     C                     SETON                     U7U8                 S01486
     C                     OUT  LDA                                       S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C                     ENDSR                           **UPDTVF ESR **S01486
     C*                                                                   S01486
     C*===================================================================S01486
     C/EJECT                                                              S01486
     C****************************************************************    CDL002
     C* NETHST - FX NETTING HISTORIC                                      CDL002
     C****************************************************************    CDL002
     C*                                                                   CDL002
     C           NETHST    BEGSR                                          CDL002
     C*                                                                   CDL002
     C           *LIKE     DEFN NETBR     NETR                            CDL002
     C*                                                                   CDL002
     C           NETBR     IFNE *BLANKS                                   CDL002
     C                     MOVELNETBR     NETR                            CDL002
     C                     EXSR NETHSD                                    CDL002
     C                     END                                            CDL002
     C*                                                                   CDL002
     C           NETSR     IFNE *BLANKS                                   CDL002
     C                     MOVELNETSR     NETR                            CDL002
     C                     EXSR NETHSD                                    CDL002
     C                     END                                            CDL002
     C*                                                                   CDL002
     C                     ENDSR                                          CDL002
     C*                                                                   CDL002
     C****************************************************************    CDL002
     C*                                                                   CDL002
     C****************************************************************    CDL002
     C* NETHSD - FX NETTING HISTORIC DETAIL                               CDL002
     C*          SET NETTING RECORD TO HISTORIC IF STILL LIVE             CDL002
     C****************************************************************    CDL002
     C*                                                                   CDL002
     C           NETHSD    BEGSR                                          CDL002
     C*                                                                   CDL002
     C           NETR      CHAINFXNETML3             50                   CDL002
     C           *IN50     IFEQ '0'                                       CDL002
     C           AMRECI    ANDNE'N'                                       CDL002
     C                     MOVEL'N'       AMRECI                          CDL002
     C                     UPDATFXNETMD0                                  CDL002
     C                     END                                            CDL002
     C           CDL025    IFEQ 'Y'                                                           CDL025
     C           NETR      SETLLFXNETSPD                                                      CDL025
     C           NETR      READEFXNETSPD                 50                                   CDL025
     C           *IN50     DOWEQ'0'                                                           CDL025
     C           ASRECI    IFNE 'N'                                                           CDL025
     C                     MOVEL'N'       ASRECI                                              CDL025
     C                     UPDATFXNETSD0                                                      CDL025
     C                     ENDIF                                                              CDL025
     C           NETR      READEFXNETSPD                 50                                   CDL025
     C                     ENDDO                                                              CDL025
     C                     ENDIF                                                              CDL025
     C*                                                                   CDL002
     C                     ENDSR                                          CDL002
     C*                                                                   CDL002
     C****************************************************************    CDL002
     C*                                                                   CDL002
     C****************************************************************    CDL002
     C* NETDRP - FX NETTING DROP                                          CDL002
     C****************************************************************    CDL002
     C*                                                                   CDL002
     C           NETDRP    BEGSR                                          CDL002
     C*                                                                   CDL002
     C           NETBR     IFNE *BLANKS                                   CDL002
     C                     MOVELNETBR     NETR                            CDL002
     C                     EXSR NETDPD                                    CDL002
     C                     END                                            CDL002
     C*                                                                   CDL002
     C           NETSR     IFNE *BLANKS                                   CDL002
     C                     MOVELNETSR     NETR                            CDL002
     C                     EXSR NETDPD                                    CDL002
     C                     END                                            CDL002
     C*                                                                   CDL002
     C                     ENDSR                                          CDL002
     C****************************************************************    CDL002
     C* NETDPD - FX NETTING DROP DETAIL                                   CDL002
     C*          DELET NETTING RECORD WHEN DEALS ARE DELETED              CDL002
     C****************************************************************    CDL002
     C*                                                                   CDL002
     C           NETDPD    BEGSR                                          CDL002
     C*                                                                   CDL002
     C           NETR      CHAINFXNETML3             50                   CDL002
     C           *IN50     IFEQ '0'                                       CDL002
     C                     DELETFXNETML3                                  CDL002
     C                     END                                            CDL002
     C*                                                                   CDL002
     C           CDL025    IFEQ 'Y'                                                           CDL025
     C           NETR      SETLLFXNETSPD                                                      CDL025
     C           NETR      READEFXNETSPD                 50                                   CDL025
     C           *IN50     DOWEQ'0'                                                           CDL025
     C                     DELETFXNETSD0                                                      CDL025
     C           NETR      READEFXNETSPD                 50                                   CDL025
     C                     ENDDO                                                              CDL025
     C                     ENDIF                                                              CDL025
      *                                                                                       CDL025
     C                     ENDSR                                          CDL002
     C*                                                                   CDL002
     C/COPY WNCPYSRC,DL1070C015
     C****************************************************************    CDL002
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      * SRDLRX - Subroutine to delete the record from RXNPVAPD or     *                       CAS005
      *          RXNPVBPD when deal being deleted from the Deals File *                       CAS005
      *          is a cross ccy swap ('RX'), and from IRNPVBPD when   *                       CAS005
      *          deal being deleted is a single ccy swap ('RS').      *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C           SRDLRX    BEGSR                                                              CAS005
      *                                                                                       CAS005
     C           DTYP      IFEQ 'RX'                                                          CAS005
      *                                                                                       CAS005
      ** Delete record from RXNPVAPD                                                          CAS005
      *                                                                                       CAS005
     C           DLNO      CHAINRXNPVAD0             27                                       CAS005
     C           *IN27     IFEQ *OFF                                                          CAS005
     C                     DELETRXNPVAD0                                                      CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Delete record from RXNPVBPD                                                          CAS005
      *                                                                                       CAS005
     C           DLNO      CHAINRXNPVBD0             27                                       CAS005
     C           *IN27     IFEQ *OFF                                                          CAS005
     C                     DELETRXNPVBD0                                                      CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           DTYP      IFEQ 'RS'                                                          CAS005
      *                                                                                       CAS005
      ** Delete record from IRNPVBPD                                                          CAS005
      *                                                                                       CAS005
     C           DLNO      CHAINIRNPVBD0             27                                       CAS005
     C           *IN27     IFEQ *OFF                                                          CAS005
     C                     DELETIRNPVBD0                                                      CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      *****************************************************************                       CAS005
      * SRDLAP - Delete Records from Deals APR Related Files.         *                       CER050
      *****************************************************************                       CER050
     C           SRDLAP    BEGSR                                                              CER050
      *                                                                                       CER050
      ** Delete associated record from deal extension file.                                   CER050
      *                                                                                       CER050
     C           DLNO      SETLLDLAPRHI0                                                      CER050
     C           DLNO      READEDLAPRHI0                 51                                   CER050
      *                                                                                       CER050
     C           *IN51     DOWEQ*OFF                                                          CER050
     C                     DELETDLAPRHI0                                                      CER050
     C           DLNO      READEDLAPRHI0                 51                                   CER050
     C                     ENDDO                                                              CER050
      *                                                                                       CER050
      ** Delete record/s for deal in the history file.                                        CER050
      *                                                                                       CER050
     C           DLNO      CHAINDLHISTI0             52                                       CER050
      *                                                                                       CER050
     C           *IN52     DOWEQ*OFF                                                          CER050
     C                     DELETDLHISTI0                                                      CER050
     C           DLNO      READEDLHISTI0                 52                                   CER050
     C                     ENDDO                                                              CER050
      *                                                                                       CER050
     C                     ENDSR                                                              CER050
      *****************************************************************                       CER050
     C/EJECT                                                              AUS003
     C/COPY WNCPYSRC,DL1070C002
     C/COPY ZSRSRC,ZDATE1Z2                                               AUS003
     C/EJECT                                                              AUS003
     C/COPY ZSRSRC,ZDATE2Z2                                               AUS003
     ODL1070AUT  203   LR                                                 S01124
0324 O*DL1070P1T**203***LR                                                S01124
0325 O************                       22 'REFERENCE DL1070'            LN0363
0325 O                                   22 'REFERENCE DL1070AU'          LN0363
0326 O*****                    TITL      89                               S01194
     O                         BJURPT    89                               S01194
0327 O                                  122 'DATE              PAGE'
0328 O*****                    RUNA     112                               S01194
     O                         BJMRDT   112                               S01194
0329 O                         PAGE  Z  127
0330 O        T  1     LR
0331 O                                   69 'DEALS FILE PURGE'
0332 O        T  1     LR
0333 O                                   69 '----------------'
0335 O        T  236   LR
0336 O                                   18 'RUN CONTROLS'
0358 O        T  2     LR
0359 O                                   31 'DEALS MATURED THIS PERI'
0360 O                                   33 'OD'
0361 O                         RECSM 3   59
0362 O        T  2     LR
0363 O                                   32 'DEALS PURGED THIS PERIOD'
0364 O                         RECSD 3   59
0362 O********T**3*****LR****************                                 067566
0363 O***********************************32 'LIVE DEALS REMAINING - C'    067566
0363 O***********************************41 'ALCULATED'                   067566
0364 O*************************WK5***3***59                               067566
0362 O        T  3     LR
     O                                   32 'LIVE DEALS REMAINING    '    067566
0363 O***********************************32 'LIVE DEALS REMAINING - F'    067566
0363 O***********************************44 'ILE CONTROLS'                067566
0364 O                         NLRA  3   59
0353 O                 U8NU7             87 '***   DIFFERENCE   ***'
     O        T 3      LR U7
     O                                   71 '*** PRINT TERMINATED ***'
     O        T 1      LR U7
     O                                   57 'DATABASE ERROR'
     O                         DBASE     61
     O                                   66 'FILE'
     O                         DBFILE    75
     O        T 13     LR U7
     O                                   49 'DBOPTN'
     O                         DBOPTN    57
     O                                   65 'KEY'
     O                         DBKEY     95
0367 O********T 00     LR                                                 LN0363
0368 O********                           71 '*** END OF REPORT ***'       LN0363
     O*BKRATR**E*       02N25                                      AUS007 048933
     O***********              RECIBK                              AUS007 048933
     ODEALSDBFE        01
     O                         RECI
     ODEALSDCFE        02
     O                         RECI
     O                         IPRM                                       E10431
     O                         TAXM                                       E10431
     ODEALSDDFE        03
     O                         RECI
     O                         IPRM                                       E10431
     ODEALSDEFE        04
     O                         RECI
     ODEALSDGFE        07                                                 S01119
     O                         RECI                                       S01119
     O                         UIPRM                                      S01119
     O                         UTAXM                                      S01119
     O                         TIPRM                                      S01119
     O                         TTAXM                                      S01119
     ODEALIDCFE                PURCH                                      E10431
     O                         IPRM                                       E10431
     O                         TAXM                                       E10431
     ODEALIDDFE                SOLD                                       E10431
     O                         IPRM                                       E10431
     ODEALIDGFE                FRAIRS                                     S01119
     O                         UIPRM                                      S01119
     O                         UTAXM                                      S01119
     O                         TIPRM                                      S01119
     O                         TTAXM                                      S01119
     ODEALSDFFT        LR
     O                         NORE
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
