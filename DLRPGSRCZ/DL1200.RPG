 001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Brokerage extract and calculati')             *
0002 F********************************************************************
0004 F*                                                                  *
     F*  Midas - Dealing Module
0004 F*                                                                  *
0005 F*       DL1200  -  BROKERAGE EXTRACT AND CALCULATION               *
0006 F*                  AMENDED FOR LUXEMBOURG BASIC SYSTEM.            *
0007 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                                  *
      *  Last Amend No. MD053295           Date 13Apr19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *      
      *                 CGL165             Date 17Feb15               *
      *                 AR847323           Date 28Oct14               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 AR996895           Date 25Nov12               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CDL033             Date 10Feb05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSD007             Date 28Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 121768             Date 19Feb98               *
      *                 106813             Date 03Feb98               *
     F*                 126017             DATE 14NOV97               *
     F*                 097885             DATE 31JAN97               *
     F*                 S01408             DATE 28MAY96               *
     F*                 S01408             DATE 22MAY96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                      066550           DATE 04FEB94               *
     F*                      062735           DATE 07FEB94               *
     F*                      AUS007           DATE 13JUL92               *
     F*                      E24118           DATE 22AUG91               *
     F*                      E24763           DATE 02MAY91               *
     F*                      E24764           DATE 01MAY91               *
     F*                      LN0363           DATE 13JUN90               *
     F*                      LN0268           DATE 25MAY90               *
     F*                      E134             DATE 07DEC89               *
     F*                      S01117           DATE 26/04/89              *
     F*                      S01194           DATE 24/04/89              *
     F*                      E16319           DATE 10/01/89              *
     F*                      E12891           DATE 26/05/88              *
     F*                      E12052           DATE 26/05/88              *
     F*                      E12523           DATE 19/05/88              *
     F*                      E12051           DATE 19/05/88              *
     F*                      E12864           DATE 29/02/88              *
     F*                      E10739           DATE 29/02/88              *
     F*                      S01147           DATE 10/12/87              *
0009 F*                      S01119           DATE 17/06/87              *
     F*                      E10507           DATE 17/04/87              *
     F*                      E80945           DATE 24/06/86              *
     F*                      S01124           DATE 00/00/00              *
     F*                                                                  *
0011 F********************************************************************
0009 F*                                                                  *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date                                    *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *      
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  AR847323 - DBASE error if customer deleted. Patterned from   *
      *             core fix BG7717 in MP121. (Child: AR847324)       *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (recompiled)                                        *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD007 - Customer Closing                                    *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  106813 - REMOVE CONVERSION TO GBP AS ALREADY IN GBP.
     F*         - ALSO CONVERT FROM GBP TO BROKER CURRENCY.
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*    097885 - Recompiled for wrong calculation of number of day    *
     F*             interest (ZINTDYZ2).                                 *
     F*    S01408 - CORE HOOK DL1200CCP9 ADDED.                          *
     F*    S01408 - CORE HOOK DL1200FFP1 ADDED.                          *
     F*             CORE HOOK DL1200CCP1 ADDED.                          *
     F*             CORE HOOK DL1200CCP2 ADDED.                          *
     F*             CORE HOOK DL1200CCP3 ADDED.                          *
     F*             CORE HOOK DL1200CCP4 ADDED.                          *
     F*             CORE HOOK DL1200CCP5 ADDED.                          *
     F*             CORE HOOK DL1200CCP6 ADDED.                          *
     F*             CORE HOOK DL1200CCP7 ADDED.                          *
     F*             CORE HOOK DL1200CCP8 ADDED.                          *
     F*             CORE HOOK DL1200OOP1 ADDED.                          *
     F*    095244 - Recompiled for Calculation method 3                  *
     F*    095238 - Recompiled for Calculation method 3                  *
     F*    066550 - GLINTC has had historical problems and inaccuracies  *
     F*             and is now externaly descibed and changed to use     *
     F*             ZINTDYZ1. See document atached to error no on GEMS   *
0009 F*       062735 - FOOB in DL1200.  Should only generate DL1200AU if   *
     F*                there is a data base error; otherwise, report will  *
     F*                not be generated.                                   *
     F*       AUS007  -  AUSTRALIAN BROKERAGE.                           *E16319
     F*       E24118  -  Thousand column truncated in Brokerage          *
     F*                  column.                                         *
     F*       E24763  -  Calculation of brokerage using Luxembourg       *
     F*                  method is wrong.                                *
     F*       E24764  -  Conversion of brokerage amount to local         *
     F*                  currency wrong when using Luxembourg method.    *
     F*                                                                  *
     F*       LN0363  - REMOVE 'END OF REPORT' FOR AUDIT REPORT          *
     F*       LN0268  - CHANGE VALUE OF MUL/DIV IND. SINCE NEW FIELD     *
     F*                 VALUES ARE BEING USED                             *
     F*       E134    - FIX TO USE CORRECT VALUE OF MULT/DIV INDICATOR   *
0009 F*       S01117 -   MULTIBRANCHING                                  *
     F*       S01194  -  NEW STANDING DATA - ADD ACCESS PROGRAMS         *E16319
     F*       E16319  -  TO PREVENT DIVIDE BY ZERO OCCURRING WHEN LON.   *E16319
     F*                  METHOD IS USED, SET BROKERAGE TO ZERO AND       *E16319
     F*                  CAUSE MESSAGE TO BE OUTPUT IN DL1220            *E16319
     F*       E12891  -  LUX.METHOD FX OUTRIGHTS FAILED TO REPORT 'RATE  *E12891
     F*                   NOT ON FILE' WHEN DATE OUT OF BROKERAGE RANGE  *E12891
0009 F*       E12052  -  LUX.METHOD CALC. TO USE SPOT RATE NOT FT RATE   *E12052
     F*       E12523  -  LUX.METHOD FAILED TO CALC LOCAL BROKERAGE; ALSO,*E12523
     F*                   SAR03010 FROM S36 WAS NOT CORRECTLY APPLIED    *E12523
     F*       E12051  -  LUX.MM.INT.CALC METHOD TO BE AS INPUT ON DEAL   *E12051
     F*       E12864  -  FURTHER CORRECT FIX ATTEMPTED BY E10507.        *E12864
     F*       E10739  -  LUX BROKERAGE NEVER CALCULATED.                 *E10739
     F*       S01119  -  FRA/IRS INCORPORATION                           *S01119
     F*       S01147 -   RELEASE 22                                      *
     F*       E10507  -  PROCESSING FOR DEALS WITH BROKERAGE EQUAL TO    *
     F*                  ZERO IS INCORRECT.                              *
0011 F*       E80945  -  INDICATOR 98 SETTING IS SAVED AND RESTORED      *
0011 F*                  WHEN S.R.GLINTC IS PERFORMED.                   *
0009 F*                                                                  *
0011 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 F/SPACE 3
0013 F***DEALS**  IP  F     600  6AI     2 DISK                                        S01119 CGL029
     FDEALS   IP  F    2325  6AI     2 DISK                                                   CGL029
0013 F*EALS***IP**F*****400**6AI     2 DISK                               S01119
0014 F*****TABLE   IF  F      96 12AI     2 DISK                          S01194
0015 F*****TABLED  IF  F      96 12AI     2 DISK                          S01194
0016 FBROKR   IF  F     180  7AI     2 DISK
0017 F*****CLINT   IF  F     256  7AI     2 DISK                          S01194
     FBKRAT   IF  E           K        DISK                               AUS007
0018 FDEALRD  UF  F     400  6AI     2 DISK                           U1
0019 FBROKXHH O   F      96            DISK
0019 F*****BROKXBD*O***F******96            DISK                                              CDL099
0019 FBROKXBD O   F      99            DISK                                                   CDL099
0019 FBROKXTT O   F      96            DISK
0019 FSDCURRL1IF  E           K        DISK                               S01194
0020 F*PRINT  O   F     132            PRINTER                            S01124
0020 F*****DL1200P1O   F     132            PRINTER                 S01124S01117
0020 FDL1200AUO   F     132            PRINTER                            S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL1200FFP1                                           S01408
     F*                                                                   S01408
0021 F/SPACE 3
0022 F* ID F  C  H  L    FUNCTION OF INDICATORS
0023 F* 01            DEALS FILE RECORD - HEADER
0024 F* 02                              - FX
0025 F* 03                              - LOAN/DEPOSIT
0026 F* 04                              - NA PURCHASE
0027 F* 05                              - NA SOLD
0028 F* 06                              - TRAILER
     F* 21                              - FRA/IRS                         S01119
0029 F* 07            BROKR - HEADER
0030 F* 08            BROKR - DETAIL
0031 F**09************CLINT - DETAIL                                      S01194
0032 F**10************TABLE - ICR.2                                       S01194
0033 F**11************TABLE - ICR.5                                       S01194
0034 F* 19            CATCH ALL FOR ALL FILES
0035 F*    20         BROKERAGE AMOUNT ABSENT
0036 F*    22         SWAP
     F*       38      USD-GBP OUTRIGHT USE SPOT IF GT SWAP RATE
0037 F*       39      LUXEMBURG CALC.TYPE 'P'
0038 F*       40      BYPASS FIRST CYCLE CALCS
0039 F*       41      GENERALL WORK IND.
0040 F*       42      BROKER CODE NOT PRESENT ON FILE
0041 F*       46      NO CURRENCY RECORD FOUND
0042 F*       49      EXCLUDE RECORD FROM EXTRACT
0043 F*       50      OUTPUT - RATE NOT ON FILE
0044 F*       51      LUXEMBURG (BROKR TABLE 02)
0045 F*       52      LONDON (BROKR TABLE 01)
0046 F*       53      OPTION DEAL (DTYP - OP,OT)
0047 F*       54      PURCHASE CCY - USD
0048 F*       55      SELL CCY - USD
0049 F*       56      NON-USD DEAL
0050 F*       57      USD/GBP DEAL
0051 F*       58      TERM=0 (USE SPOT RATE)
0052 F*       59      CALL/NOTICE DEAL (DTYP -CL,CD,DL)
     F*       61      WORK INDICATOR   (DTYP -CI)
0053 F********63******NO DETAILS FOR FX PERIOD****************************E12891
0054 F*       64      SWAP 1ST LEG - FSL1=1
0055 F*       65      PERIOD GT S/BROKR PERIOD
0056 F*       66      CROSS-RATE CALCS.
0057 F*       70      MULT/DIV INDICATOR =0(DIVIDE)
0058 F*       72      LUX RATE FOR PERIOD FOUND
0059 F*       89       EXTRACT RECORD
0060 F*          U1    NOT INTERIM RUN - UPDATE DEALS HDR
0061 F*          U7    DATABASE ERROR
0062 F*          U8   FILE CONTROLS OUT OF BALANCE - DEALS
0063 F*       98       DATE FORMAT = MMDDYY
     E                    CPY@    1   1 80
0064 E                    HCCY       25  3               HOLIDAY CURRENCYS
0065 E                    PER        12  3               LUX SWAP/DEP PER
0066 E                    WRA        12  7 0             LUX SWAP/DEP RATE
0067 E                    MTD        12  1               LUX SWP/DEP METH
0068 E                    CYA       150  3               CURRENCY
0069 E****                MDS       150  1 0             MULT/DIV IND SPOTE134
0069 E                    MDS       150  1               MULT/DIV IND SPOTE134
0070 E******              MDF       150  1 0             MULT/DIV IND FIX LN0268
0070 E                    MDF       150  1               MULT/DIV IND FIX LN0268
0071 E                    SPT       150 13 8             SPOT RATES
0072 E                    FTX       150 13 8             FTX RATES
0073 E                    DPA       150  1 0             CCY DEC.PLACES
0074 E                    BRF        11  5 3             LONDON SWAP RATES
0075 E                    DAYS    8   8  5 0A            LON SWAP PER-DAYS
0076 E                    ZYDY    4   4  4 0             SR ZDATE2 ARRAY
0077 E                    ZMDY   13  13  3 0             SR ZDATE2 ARRAY
0078 E                    ZMNM   12  12  3               SR ZDATE2 ARRAY
0079 E                    SRA         3  7 0             LUX SWP RAT/CHA
0080 E                    DRA        12  7 0             LUX DEP RAT/CHA
0081 E                    DT      7   7  5 0             DAYS 1 TO 7
0082 E                    POW     1   7  7 3             CCY CNVERSION
0083 E                    PR          3  5 0A            JULIAN DATE CHECK
0084 E********************ZHC        50  3               ZFREQ SR. ARRAY  S01194
0085 E                    ZFMD   12  12  2               ZFREQ SR. ARRAY
0086 E                    INT         2 15 0             HAST TOT-INTEGER
0087 E                    DEC         2  3 0             HASH TOT-DEC
0088 E                    REC         3  5 0             NO OF RECORDS
     E/COPY ZSRSRC,ZHOLE                                 ZCHKH SR. ARRAY  S01195
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
0089 I/EJECT
0090 I*
0091 I*    DEALS FILE - HEADER RECORD.
0092 I*
0093 IDEALS   NS  01   1 CH   8 CA
0094 I                                        1   1 RECI
0095 I                                        2   70DLNO
0096 I                                        8   8 RCDT
0097 I                                        9  100RCDC
0098 I**********                             11  160CNUM                                      CSD027
0098 I                                       11  16 CNUM                                      CSD027
0099 I                                    P  50  520DLBU
0100 I                                    P 394 3960LCD
0101 I                                      397 397 CHTP
0102 I                                    P 398 4000TNLU
0103 I*
0104 I*
0105 I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
0106 I*
0107 IDEALS   NS  02   1 CD   8 CB
0108 I       OR        1 CE   8 CB
0109 I       OR        1 CM   8 CB
0110 I       OR        1 CR   8 CB
0111 I                                        1   1 RECI
0112 I                                        2   70DLNO
0113 I                                        8   8 RCDT
0114 I                                        9  100RCDC
0115 I**********                             11  160CNUM                                      CSD027
0115 I                                       11  16 CNUM                                      CSD027
0116 I***************************************17  190BRCD                  S01117
0116 I                                       17  19 BRCA                  S01117
0117 I                                       20  21 DTYP
0118 I                                       22  23 DLST
0119 I                                    P  24  260DDAT
0120 I                                    P  27  290VDAT
0121 I                                    P  30  320OTDT
0122 I                                       35  38 BRKC
0123 I                                    P  39  450BAGE            20
0124 I                                       46  48 PUCY
0125 I                                    P  49  550PUAM
0126 I                                    P  56  628EXRT
0127 I                                       86  88 SLCY
0128 I                                    P  89  950SLAM
0129 I                                    P 117 1230BCEQ
0130 I                                    P 124 1300OBCE
0131 I                                    P 131 1378LCXR
0132 I                                      138 1390PCST
0133 I**********                            140 151 OPCA                                      CGL029
     I                                      140 151 OPCAQQ                                    CGL029
0134 I                                      152 161 TSCN
0135 I                                      162 1630SCST
0136 I**********                            164 175 OSCA                                      CGL029
     I                                      164 175 OSCAQQ                                    CGL029
0137 I                                      176 185 TPCN
0138 I                                    P 192 1980ORPA
0139 I                                    P 205 2110ORSA
0140 I                                      212 2120FSLI
0141 I                                    P 241 2470SPPD
0142 I                                    P 248 2540SPLA
0143 I                                      255 257 SPLC
0144 I                                      285 2900SODN
0145 I                                      300 309 FACO
0146 I                                      310 344 SPI
0147 I                                      370 370 DNSI
0148 I                                      371 371 DSTI
0149 I                                      372 372 CNFI
0150 I                                      373 373 ACEI
0151 I                                      374 374 TLXI
0152 I                                    P 391 3930ORED
0153 I                                    P 394 3960LCD
0154 I                                      397 397 CHTP
0155 I                                    P 398 4000TNLU
     I                                     12921309 OPCA                                      CGL029
     I                                     13101327 OSCA                                      CGL029
     I                                    P223622380BSDT1                                     CDL099
     I                                    P223922410BSDT2                                     CDL099
     I                                    P224222440BRSD2                                     CDL099
0156 I*
0157 I*
0158 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0159 I*
0160 IDEALS   NS  03   1 CD   8 CC
0161 I       OR        1 CE   8 CC
0162 I       OR        1 CM   8 CC
0163 I       OR        1 CR   8 CC
0164 I                                        1   1 RECI
0165 I                                        2   70DLNO
0166 I                                        8   8 RCDT
0167 I                                        9  100RCDC
0168 I**********                             11  160CNUM                                      CSD027
0168 I                                       11  16 CNUM                                      CSD027
0116 I***************************************17  190BRCD                  S01117
0116 I                                       17  19 BRCA                  S01117
0170 I                                       20  21 DTYP
0171 I                                       22  23 DLST
0172 I                                    P  24  260DDAT
0173 I                                    P  27  290VDAT
0174 I                                    P  30  320MDAT
0175 I                                       33  340CDAS
0176 I                                       35  38 BRKC
0177 I                                    P  39  450BAGE            20
0178 I                                       46  48 CCY
0179 I                                    P  49  550PCPL
0180 I                                       56  56 INTC
0181 I                                       63  640BRTT
0182 I                                    P  65  707BRTE
0183 I                                    P  71  767RTSP
0184 I                                    P  77  827INTR
0185 I                                       83  850NOTD
0186 I                                       86 105 RNNA
0187 I**********                            106 1110CHNA                                      CSD027
0187 I                                      106 111 CHNA                                      CSD027
0188 I                                      112 1140FACT
0189 I                                      115 1160FCNO
0190 I                                    P 117 1230OPAM
0191 I                                    P 124 1308BCXR
0192 I                                    P 131 1378LCXR
0193 I                                      138 1390SDST
0194 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0195 I                                      152 161 TSTN
0196 I                                      162 1630MDST
0197 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0198 I                                      176 185 TMAN
0199 I                                      186 1910RODN
0200 I                                    P 192 1980RODA
0201 I                                      199 2040RBDN
0202 I                                    P 205 2110RBDA
0203 I                                      212 2120ICBS
0204 I                                      213 213 IPFR
0205 I                                    P 214 2200TOTI
0206 I                                    P 221 2230NIDT
0207 I                                    P 224 2260IBDT
0208 I                                    P 227 2290SLID
0209 I                                    P 230 2360AIPD
0210 I                                    P 237 2390DLRC
0211 I                                    P 240 2420IACD
0212 I                                    P 243 2490AITC
0213 I                                    P 250 2560AIAN
0214 I                                    P 257 2630AIAP
0215 I                                    P 264 2700IPRD
0216 I                                    P 271 2770IPRM
0217 I                                    P 278 2840ICTD
0218 I                                    P 294 2960DAVD
0219 I                                      297 2990DASN
0220 I                                      300 309 FACO
0221 I                                      310 344 SPI
0222 I                                      345 3460INTF
0223 I                                      370 370 DNSI
0224 I                                      371 371 DSTI
0225 I                                      372 372 CNFI
0226 I                                      373 373 ACEI
0227 I                                      374 374 TLXI
0228 I                                    P 391 3930ORED
0229 I                                    P 394 3960LCD
0230 I                                      397 397 CHTP
0231 I                                    P 398 4000TNLU
     I                                     16721689 OMDA                                      CGL029
     I                                     16901707 OSDA                                      CGL029
0232 I*
0233 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
0234 I*
0235 IDEALS   NS  04   1 CD   8 CD
0236 I       OR        1 CE   8 CD
0237 I       OR        1 CM   8 CD
0238 I       OR        1 CR   8 CD
0239 I                                        1   1 RECI
0240 I                                        2   70DLNO
0241 I                                        8   8 RCDT
0242 I                                        9  100RCDC
0243 I**********                             11  160ISCN                                      CSD027
     I**********                             11  160CNUM                                      CSD027
0243 I                                       11  16 ISCN                                      CSD027
     I                                       11  16 CNUM                                      CSD027
0116 I***************************************17  190BRCD                  S01117
0116 I                                       17  19 BRCA                  S01117
0245 I                                       20  21 DTYP
0246 I                                       22  23 DLST
0247 I                                    P  24  260DDAT
0248 I                                    P  27  290VDAT
0249 I                                    P  30  320MDAT
0250 I                                       33  340IDAS
0251 I                                       35  38 BRKC
0252 I                                    P  39  450BAGE            20
0253 I                                       46  48 CCY
0254 I                                    P  49  550PUPR
0255 I                                    P  57  627YRAT
0256 I                                    P  71  767RTSP
0257 I                                    P  77  827INTR
0258 I                                       86 105 RNNA
0259 I**********                            106 1110PCUS                                      CSD027
0259 I                                      106 111 PCUS                                      CSD027
0260 I                                      112 1140FACT
0261 I                                      115 1160FCNO
0262 I                                    P 117 1230FVAL
0263 I                                    P 124 1308BCXR
0264 I                                    P 131 1378LCXR
0265 I                                      138 1390SDST
0266 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0267 I                                      152 161 TSTN
0268 I                                      162 1630MDST
0269 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0270 I                                      176 185 TMAN
0271 I                                    P 192 1980DISA
0272 I                                    P 205 2110DPTD
0273 I                                      212 2120ICBS
0274 I                                      213 213 IPFR
0275 I                                    P 214 2200TOTI
0276 I                                    P 221 2230NIDT
0277 I                                    P 224 2260IBDT
0278 I                                    P 227 2290SLID
0279 I                                    P 230 2360AIPD
0280 I                                    P 237 2390DLRC
0281 I                                    P 240 2420IACD
0282 I                                    P 243 2490AITC
0283 I                                    P 250 2560AIAN
0284 I                                    P 257 2630AIAP
0285 I                                    P 264 2700IPRD
0286 I                                    P 271 2770IPRM
0287 I                                    P 278 2840SAPR
0288 I                                      285 2900ASDN
0289 I                                    P 291 2930SADT
0290 I                                    P 294 2960DAVD
0291 I                                      297 2990DASN
0292 I                                      300 309 FACO
0293 I                                      310 344 SPI
0294 I                                      345 3460INTF
0295 I                                      370 370 DNSI
0296 I                                      371 371 DSTI
0297 I                                      372 372 CNFI
0298 I                                      373 373 ACEI
0299 I                                      374 374 TLXI
0300 I                                    P 391 3930ORED
0301 I                                    P 394 3960LCD
0302 I                                      397 397 CHTP
0303 I                                    P 398 4000TNLU
     I                                     16721689 OMDA                                      CGL029
     I                                     16901707 OSDA                                      CGL029
0304 I*
0305 I*
0306 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
0307 I*
0308 IDEALS   NS  05   1 CD   8 CE
0309 I       OR        1 CE   8 CE
0310 I       OR        1 CM   8 CE
0311 I       OR        1 CR   8 CE
0312 I                                        1   1 RECI
0313 I                                        2   70DLNO
0314 I                                        8   8 RCDT
0315 I                                        9  100RCDC
0316 I**********                             11  160CNUM                                      CSD027
0316 I                                       11  16 CNUM                                      CSD027
0116 I***************************************17  190BRCD                  S01117
0116 I                                       17  19 BRCA                  S01117
0318 I                                       20  21 DTYP
0319 I                                       22  23 DLST
0320 I                                    P  24  260DDAT
0321 I                                    P  27  290VDAT
0322 I                                       35  38 BRKC
0323 I                                    P  39  450BAGE            20
0324 I                                       46  48 CCY
0325 I                                    P  49  550SAPR
0326 I                                    P  57  627YRAT
0327 I                                    P  77  827INTR
0328 I                                       86 105 RNNA
0329 I**********                            106 1110ISCN                                      CSD027
0329 I                                      106 111 ISCN                                      CSD027
0330 I                                    P 117 1230FVAL
0331 I                                    P 124 1308BCXR
0332 I                                    P 131 1378LCXR
0333 I                                      138 1390SETP
0334 I**********                            140 151 OSAC                                      CGL029
     I                                      140 151 OSACQQ                                    CGL029
0335 I                                      152 161 TSEN
     I                                      212 2120ICBS
0336 I                                      285 2900RPDN
0337 I                                    P 291 2930PMDT
0338 I                                      370 370 DNSI
0339 I                                      371 371 DSTI
0340 I                                      372 372 CNFI
0341 I                                      373 373 ACEI
0342 I                                      374 374 TLXI
0343 I                                    P 391 3930ORED
0344 I                                    P 394 3960LCD
0345 I                                      397 397 CHTP
0346 I                                    P 398 4000TNLU
     I                                     10481065 OSAC                                      CGL029
     I*                                                                   S01119
     I*                                                                   S01119
     I*    DEALS FILE - DETAIL - FRA/IRS                                  S01119
     I*                                                                   S01119
     IDEALS   NS  21   1 CD   8 CG                                        S01119
     I       OR        1 CE   8 CG                                        S01119
     I       OR        1 CM   8 CG                                        S01119
     I       OR        1 CR   8 CG                                        S01119
     I                                        1   1 RECI                  S01119
     I                                        2   70DLNO                  S01119
     I                                        8   8 RCDT                  S01119
     I                                        9  100RCDC                  S01119
     I**********                             11  160CNUM                               S01119 CSD027
     I                                       11  16 CNUM                                      CSD027
0116 I***************************************17  190BRCD                  S01117
0116 I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP                  S01119
     I                                       22  23 DLST                  S01119
     I                                    P  24  260DDAT                  S01119
     I                                    P  27  290VDAT                  S01119
     I                                    P  30  320MDAT                  S01119
     I                                       33  340CDAS                  S01119
     I                                       35  38 BRKC                  S01119
     I                                    P  39  450BAGE            20    S01119
     I                                       46  510LNKDN                 S01119
     I                                       52  52 HEDIN                 S01119
     I                                       53  53 TAXI                  S01119
     I                                       54  56 UCUCY                 S01119
     I                                    P  57  630UPAMT                 S01119
     I                                       64  650UBRTT                 S01119
     I                                    P  66  717USTRT                 S01119
     I                                    P  72  777UBRTE                 S01119
     I                                    P  78  837URTSP                 S01119
     I                                       84  84 USPIN                 S01119
     I                                    P  85  907UEINR                 S01119
     I                                       91  910UICBS                 S01119
     I                                       92  930UFRFD                 S01119
     I                                    P  94  960UINFD                 S01119
     I                                    P  97  990USLIP                 S01119
     I                                    P 100 1020UNICD                 S01119
     I                                    P 103 1050UICBD                 S01119
     I                                      106 106 UICFR                 S01119
     I                                      107 1080UICFD                 S01119
     I                                    P 109 1110UNIPD                 S01119
     I                                    P 112 1140UIPBD                 S01119
     I                                      115 115 UIPFR                 S01119
     I                                      116 1170UIPFD                 S01119
     I                                    P 118 1248UBCXR                 S01119
     I                                    P 125 1270UIACD                 S01119
     I                                    P 128 1340UIALC                 S01119
     I                                    P 135 1410UAITC                 S01119
     I                                    P 142 1480UAIPD                 S01119
     I                                    P 149 1550UAIAN                 S01119
     I                                    P 156 1620UAIAP                 S01119
     I                                    P 163 1690UIPRD                 S01119
     I                                    P 170 1760UIPRM                 S01119
     I                                    P 177 1830UNSAM                 S01119
     I                                    P 184 1900UTAXD                 S01119
     I                                    P 191 1970UTAXM                 S01119
     I                                      198 200 TCUCY                 S01119
     I                                    P 201 2070TPAMT                 S01119
     I                                      208 2090TBRTT                 S01119
     I                                    P 210 2157TSTRT                 S01119
     I                                    P 216 2217TBRTE                 S01119
     I                                    P 222 2277TRTSP                 S01119
     I                                      228 228 TSPIN                 S01119
     I                                    P 229 2347TEINR                 S01119
     I                                      235 2350TICBS                 S01119
     I                                      236 2370TFRFD                 S01119
     I                                    P 238 2400TINFD                 S01119
     I                                    P 241 2430TSLIP                 S01119
     I                                    P 244 2460TNICD                 S01119
     I                                    P 247 2490TICBD                 S01119
     I                                      250 250 TICFR                 S01119
     I                                      251 2520TICFD                 S01119
     I                                    P 253 2550TNIPD                 S01119
     I                                    P 256 2580TIPBD                 S01119
     I                                      259 259 TIPFR                 S01119
     I                                      260 2610TIPFD                 S01119
     I                                    P 262 2688TBCXR                 S01119
     I                                    P 269 2710TIACD                 S01119
     I                                    P 272 2780TIALC                 S01119
     I                                    P 279 2850TAITC                 S01119
     I                                    P 286 2920TAIPD                 S01119
     I                                    P 293 2990TAIAN                 S01119
     I                                    P 300 3060TAIAP                 S01119
     I                                    P 307 3130TIPRD                 S01119
     I                                    P 314 3200TIPRM                 S01119
     I                                    P 321 3270TNSAM                 S01119
     I                                    P 328 3340TTAXD                 S01119
     I                                    P 335 3410TTAXM                 S01119
     I                                    P 342 3477CLRAT                 S01119
     I                                    P 348 3537FLRAT                 S01119
     I                                    P 354 3550AVPER                 S01119
     I                                    P 356 3638TIRAT                 S01119
     I                                    P 364 3697AACRT                 S01119
     I                                      370 3710RSETM                 S01119
     I**********                            372 383 URACC                              S01119 CGL029
     I                                      372 383 URACQQ                                    CGL029
     I                                      384 393 CPPBK                 S01119
     I                                      394 3950PSETM                 S01119
     I**********                            396 407 UPACC                              S01119 CGL029
     I                                      396 407 UPACQQ                                    CGL029
     I                                      408 417 CPRBK                 S01119
     I                                      418 427 FACO                  S01119
     I                                      428 462 SPI                   S01119
     I                                    P 463 4650SDCAR                 S01119
     I                                    P 466 4680ULPCD                 S01119
     I                                    P 469 4710TLPCD                 S01119
     I                                    P 472 4780UAEXA                 S01119
     I                                    P 479 4850TAEXA                 S01119
     I                                      570 570 UDNSI                 S01119
     I                                      571 571 TDNSI                 S01119
     I                                      572 572 UDSTI                 S01119
     I                                      573 573 TDSTI                 S01119
     I                                      574 574 CNFI                  S01119
     I                                      575 575 ACEI                  S01119
     I                                      576 576 TLXI                  S01119
     I                                    P 587 5880LSWC                  S01119
     I                                    P 589 5900LSWS                  S01119
     I                                    P 591 5930ORED                  S01119
     I                                    P 594 5960LCD                   S01119
     I                                      597 597 CHTP                  S01119
     I                                    P 598 6000TNLU                  S01119
     I                                     22902307 UPACC                                     CGL029
     I                                     23082325 URACC                                     CGL029
0347 I*
0348 I*
0349 I*    DEALS FILE -TRAILER RECORD.
0350 I*
0351 IDEALS   NS  06   1 CT
0352 I                                        1   1 RECI
0353 I                                        2   70DLNO
0354 I                                        8   8 RCDT
0355 I                                        9  100RCDC
0356 I**********                             11  160CNUM                                      CSD027
0356 I                                       11  16 CNUM                                      CSD027
0357 I************************************P**17  190NORE                  062735
0358 I                                    P  20  220FLSZ
0359 I                                    P  23  250NLRB
0360 I                                    P  26  280NINS
0361 I                                    P  29  310NDEL
0362 I************************************P**32  340NLRA                  062735
0363 I                                    P  35  420VLBF
0364 I                                    P  43  440VLBL
0365 I                                    P  45  520VRIF
0366 I                                    P  53  540VRIL
0367 I                                    P  55  620VRDF
0369 I************************************P**65  720VLAF                  062735
0370 I************************************P**73  740VLAL                  062735
0368 I                                    P  63  640VRDL
0371 I                                    P  75  770DTMR
0372 I                                    P  78  800ITMR
0373 I                                    P 394 3960LCD
0374 I                                      397 397 CHTP
0375 I                                    P 398 4000TNLU
0376 I*
0377 I*
0378 I* CATCHALL
0379 I        NS  19
0380 I                                        1   1 RECI
0381 I*
0382 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.**             S01194
0383 I**********                                                          S01194
0384 I*****TABLE***NS       2 C0   3 C1  12 C1                            S01194
0385 I*******AND***   13 C0                                               S01194
0386 I*************                           1   1 RECI                  S01194
0387 I*************                           2   30RECT                  S01194
0388 I*************                          12  130RCDE                  S01194
0389 I*************                          14  66 TITL                  S01194
0390 I*************                          67  67 DATF                  S01194
0391 I*************                          68  700DFBR                  S01194
0392 I*************                          74  74 MODI1                 S01194
0393 I*************                          75  75 MODI2                 S01194
0394 I*************                          76  76 MODI3                 S01194
0395 I*************                       P  77  790RUND                  S01194
0396 I*************                          80  86 RUNA                  S01194
0397 I*************                          87  870SFLG                  S01194
0398 I*************                       P  90  920LCD                   S01194
0399 I*************                          93  93 CHTP                  S01194
0400 I*************                       P  94  960TNLU                  S01194
0401 I*************                                                       S01194
0402 I*************                                                       S01194
0403 I*************                                                       S01194
0404 I*************                                                       S01194
0405 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*2.**             S01194
0406 I*************                                                       S01194
0407 I*****TABLE***NS  10   1 CD   2 C0   3 C1                            S01194
0408 I*******AND****  12 C1  13 C1                                        S01194
0409 I*************                           1   1 RECI                  S01194
0410 I*************                           2   30RECT                  S01194
0411 I*************                          12  130RCDE                  S01194
0412 I*************                          14  16 BCCY                  S01194
0413 I*************                          17  19 BCYL                  S01194
0414 I*************                          20  22 HOCY                  S01194
0415 I*************                          23  280HEAD                  S01194
0416 I*************                       P  29  310APDA                  S01194
0417 I*************                          35  35 APFQ                  S01194
0418 I*************                       P  36  380LOGS                  S01194
0419 I*************                          39  40 CUZR                  S01194
0420 I*************                       P  41  430DNWD                  S01194
0421 I*************                          44  460BVLP                  S01194
0422 I*************                          47  49 LOCY                  S01194
0423 I*************                          50  510FDAY                  S01194
0424 I*************                          86  86 ISAV                  S01194
0425 I*************                       P  87  890LLOG                  S01194
0426 I*************                       P  90  920LCD                   S01194
0427 I*************                          93  93 CHTP                  S01194
0428 I*************                       P  94  960TNLU                  S01194
0429 I*************                                                       S01194
0430 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*5.**             S01194
0431 I*************                                                       S01194
0432 I*****TABLE***NS  11   1 CD   2 C0   3 C1                            S01194
0433 I*******AND***   12 C4  13 C0                                        S01194
0434 I*************                           1   1 RECI                  S01194
0435 I*************                           2   30RECT                  S01194
0436 I*************                          12  130RCDE                  S01194
0437 I*************                          18  210CSAC                  S01194
0438 I*************                          22  22 TLII                  S01194
0439 I*************                          23  23 MCRI                  S01194
0440 I*************                       P  24  250MCEP                  S01194
0441 I*************                          26  270MCLP                  S01194
0442 I*************                          28  28 FRDI                  S01194
0443 I*************                          29  29 BRCF                  S01194
0444 I*************                          30  350PSCN                  S01194
0445 I*************                          36  380DLBR                  S01194
0446 I*************                          39  420FRPA                  S01194
0447 I*************                          43  460FRPC                  S01194
0448 I*************                          47  49 USCY                  S01194
0449 I*************                          50  52 STCY                  S01194
0450 I*************                       P  53  553MBGE                  S01194
0451 I*************                       P  90  920LCD                   S01194
0452 I*************                          93  93 CHTP                  S01194
0453 I*************                       P  94  960TNLU                  S01194
0454 I*************                                                       S01194
0455 I*************                                                       S01194
0456 I*****TABLE*FILE*-*HOLIDAY*RECORD.**                                 S01194
0457 I********E-EXCLUDE,*I-INCLUDE.**                                     S01194
0458 I*************                                                       S01194
0459 I*****TABLE***NS       1 CD   2 C2   3 C2                            S01194
0460 I*******AND***   14 CE                                               S01194
0461 I*******OR****    1 CD   2 C2   3 C2                                 S01194
0462 I*******AND***   14 CI                                               S01194
0463 I*************                           1   1 RECI                  S01194
0464 I*************                           2   30RECT                  S01194
0465 I*************                           8  120HOL                   S01194
0466 I*************                          13  130SREC                  S01194
0467 I*************                          14  14 INEX                  S01194
0468 I*************                          15  89 HCCY                  S01194
0469 I*************                       P  90  920LCD                   S01194
0470 I*************                          93  93 CHTP                  S01194
0471 I*************                       P  94  960TNLU                  S01194
0472 I*************                                                       S01194
0473 I**TABLE*(BROKER*DETAILS*RECORD)**                                   S01194
0474 I*****TABLE***NS       1 CD   2 C8   3 C0                            S01194
0475 I*************                           1   1 RECI                  S01194
0476 I*************                           2   30RECT                  S01194
0477 I*************                          10  13 BRKC                  S01194
0478 I*************                          14  43 BKNM                  S01194
0479 I*************                          44  53 BKTN                  S01194
0480 I*************                          54  56 BKCY                  S01194
0481 I*************                       P  90  920LCD                   S01194
0482 I*************                          93  93 CHTP                  S01194
0483 I*************                       P  94  960TNLU                  S01194
0484 I*************                                                       S01194
0485 I**CATCHALL***                                                       S01194
0486 I********NS**19*                                                     S01194
0487 I*************                           1   1 RECI                  S01194
0488 I*************                                                       S01194
0489 I*************                                                       S01194
0490 I*****TABLE*FILE*-*CURRENCIES*RECORD*1.**                            S01194
0491 I*************                                                       S01194
0492 I*****TABLED**NS       1 CD   2 C2   3 C0                            S01194
0493 I*******AND***   13 C1                                               S01194
0494 I*************                           1   1 RECIX                 S01194
0495 I*************                           2   30RECTX                 S01194
0496 I*************                          10  12 CCYX                  S01194
0497 I*************                          13  130SREC                  S01194
0498 I*************                          14  27 CCNM                  S01194
0499 I*************                       P  28  348SPOTX                 S01194
0500 I*************                          35  37 CCYS                  S01194
0501 I*************                          38  380CDPX                  S01194
0502 I*************                          39  390TNOT                  S01194
0503 I*************                          40  40 DCCY                  S01194
0504 I*************                          41  44 SRC1                  S01194
0505 I*************                          45  48 SRC2                  S01194
0506 I*************                          49  520TACC                  S01194
0507 I*************                          53  560TEQV                  S01194
0508 I*************                          57  600SWQV                  S01194
0509 I*************                          61  640TAC4                  S01194
0510 I*************                          65  680TAC5                  S01194
0511 I*************                          69  69 HIND                  S01194
0512 I*************                       P  70  768PART                  S01194
0513 I*************                          77  780SSNO                  S01194
0514 I*************                       P  79  858ERLC                  S01194
0515 I*************                          86  860MDINX                 S01194
0516 I*************                          88  880MDIBX                 S01194
0517 I*************                       P  90  920LCD                   S01194
0518 I*************                          93  93 CHTP                  S01194
0519 I*************                       P  94  960TNLU                  S01194
0520 I*************                                                       S01194
0521 I*************                                                       S01194
0522 I*****TABLE*FILE*-*CURRENCIES*RECORD*2.**                            S01194
0523 I*************                                                       S01194
0524 I********NS***    1 CD   2 C2   3 C0                                 S01194
0525 I*******AND***   13 C2                                               S01194
0526 I*************                           1   1 RECI                  S01194
0527 I*************                           2   30RECT                  S01194
0528 I*************                          10  12 CCYX                  S01194
0529 I*************                          13  130SREC                  S01194
0530 I*************                          14  42 EURB                  S01194
0531 I*************                       P  43  498HBERX                 S01194
0532 I*************                       P  90  920LCD                   S01194
0533 I*************                          93  93 CHTP                  S01194
0534 I*************                       P  94  960TNLU                  S01194
0535 I*************                                                       S01194
0536 I*************                                                       S01194
0537 I**CATCHALL***                                                       S01194
0538 I********NS**19**                                                    S01194
0539 I*************                           1   1 RECIX                 S01194
0540 I*************                           2   30RECTX                 S01194
0541 I*
0542 I*    BROKERAGE RATES FILE - HEADER RECORD.
0543 I*
0544 IBROKR   NS  07   1 CH
     I                                        1   1 RECI
     I                                        2   5 BRKC
     I                                        6   8 CCYB
     I************************************P***9  110NORE                  062735
     I                                    P  12  140FLSZ
     I                                    P  15  170NLRB
     I                                    P  18  200NINS
     I                                    P  21  230NAMD
     I                                    P  24  260NDEL
     I************************************P**27  290NLRA                  062735
     I                                       30  31 TBLTP
     I                                    P 174 1760LCD
     I                                      177 177 CHTP
     I                                    P 178 1800TNLU
0560 I*
0561 I* BROKR FILE  -  DETAIL RECORD TYPE 01 (LONDON)
0562 I*
0563 IBROKR   NS  08   1 CD   9 C0  10 C1
     I                                        1   1 RECI
     I                                        2   5 BRKC
     I                                        6   8 CCYB
     I                                        9  100BRKT
     I                                    P  11  147BRRD
     I                                    P  15  187BRRN
     I                                    P  19  210BRFS
     I                                    P  22  54 BRF
     I                                    P 174 1760LCD
     I                                      177 177 CHTP
     I                                    P 178 1800TNLU
0577 I*
0578 I* BROKR FILE  -  DETAIL RECORD TYPE 02 (LUXEMBURG)
0579 I*
0580 I****BROKR   NS  08   1 CD   9 C0  10 C1                             E10739
0580 IBROKR   NS  08   1 CD   9 C0  10 C2                                 E10739
     I                                        1   1 RECI
     I                                        2   5 BRKC
     I                                        6   8 CCYB
     I                                        9  100BRKT
     I                                       11  13 CHCY
     I                                    P  14  170PRMT
     I                                       18  20 PRCY
     I                                       21  23 FXPD
     I                                       24  24 FXMD
     I                                    P  25  280FRA
     I                                       29  37 SPD
     I                                       38  40 SMD
     I                                    P  41  52 SRA
     I                                       53  88 DPD
     I                                       89 100 DMD
     I                                    P 101 148 DRA
     I                                    P 174 1760LCD
     I                                      177 177 CHTP
     I                                    P 178 1800TNLU
0596 I*
0602 I* CATCHALL
0603 I        NS  19
0604 I                                        1   1 RECI
0605 I*
0606 I**CLINT*FILE**-**CUSTOMER*STANDING*DATA*RECORD**                    S01194
0607 I*************                                                       S01194
0608 I*****CLINT***NS  09   8 CA                                          S01194
0609 I*************                           1   1 RECI                  S01194
0610 I*************                           2   70CNUM                  S01194
0611 I*************                           8   8 RCDT                  S01194
0612 I*************                           9  28 CRNM                  S01194
0613 I*************                          29  38 CTWN                  S01194
0614 I*************                          39  48 CSNM                  S01194
0615 I*************                          49  56 CASK                  S01194
0616 I*************                          57  68 TELX                  S01194
0617 I*************                          69  80 CSID                  S01194
0618 I*************                          81  82 ACOC                  S01194
0619 I*************                          83  83 CBSI                  S01194
0620 I*************                          84  85 CCTZ                  S01194
0621 I*************                          86  87 CLOC                  S01194
0622 I*************                          88  930CPAR                  S01194
0624 I*************                          97  980LINS                  S01194
0625 I*************                          99 1010LIND                  S01194
0626 I*************                       P 102 1040DASU                  S01194
0627 I*************                       P 105 1070CDIC                  S01194
0628 I*************                       P 108 1100DADE                  S01194
0629 I*************                         111 111 CMIN                  S01194
0630 I*************                         112 112 CTYP                  S01194
0631 I*************                         113 124 TELF                  S01194
0632 I*************                         125 133 CHID                  S01194
0633 I*************                         134 136 CHAB                  S01194
0634 I*************                       P 250 2520LCD                   S01194
0635 I*************                         253 253 CHTP                  S01194
0636 I*************                       P 254 2560TNLU                  S01194
0637 I*
0642 I*    DEALS FILE - HEADER RECORD.
0643 I*
0644 IDEALRD  NS       1 CH
0645 I                                        1   1 RECI
0646 I                                        2   70DLNO
0647 I                                        8   8 RCDT
0648 I                                        9  100RCDC
0649 I**********                             11  160CNUM                                      CSD027
0649 I                                       11  16 CNUM                                      CSD027
0650 I                                    P 394 3960LCD
0651 I                                      397 397 CHTP
0652 I                                    P 398 4000TNLU
0653 I*
0654 I*
0655 I* CATCHALL
0656 I        NS  19
     I/COPY WNCPYSRC,DL1200I001
0315 I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     ISDDEAL    E DSSDDEALPD                                              S01194
     I** EXTERNAL DS FOR DEAL DETAILS                                     S01194
     I*                                                                   S01194
     ISDBROK    E DSSDBROKPD                                              S01194
     I** EXTERNAL DS FOR BROKER DETAILS                                   S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I** EXTERNAL DS FOR CUSTOMER DETAILS                                 S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I              QQACCD                          QQACC1                                    CGL029
     I** EXTERNAL DS FOR GENERAL LEDGER DETAILS                           S01194
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I              QQACCD                          QQACC2                                    CGL029
     I** EXTERNAL DS FOR TRADING DETAILS                                  S01194
     I*                                                                   AUS007
     ISCSARD    E DSSCSARDPD                                              AUS007
     I** EXTERNAL DS FOR SAR DETAILS                                      AUS007
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSLDY     E DSDSLDY                                                 CSD007
      ** Third DS for access programs, very long data structure           CSD007
      *                                                                   CSD007
     I/COPY ZSRSRC,ZHOLI                                 ZCHKH SR. ARRAY  S01195
     I*                                                                   S01194
     IERROR       DS                             30                       S01194
     I** DATA STRUCTURE FOR DB ERROR FIELDS - OUTPUT TO SPOOL FILE        S01194
     I                                        1   8 DBFILE                S01194
     I                                       10  16 DBOPTN                S01194
     I                                       18  27 DBKEY                 S01194
     I                                       29  30 DBASE                 S01194
      *                                                                                     AR847323
     I              '**CUSTOMER DELETED**'C         DLTD                                    AR847323
      *                                                                                     AR847323
     I*
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I/COPY WNCPYSRC,DL1200I002
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
0658 C*    FIRST CYCLE PROCESSING                                  *
0659 C*                                                                  *
0660 C   40                GOTO BEGIN
0661 C                     SETON                     40
     C/COPY WNCPYSRC,DL1200C004
     C                     MOVEACPY@      BIS@   80
0662 C*
0663 C*****OBTAIN*INSTALLATION*CONTROL*DATA*RECORDS*1,2,5**               S01194
0664 C*********************EXSR ZSYSTM                                    S01194
0665 C***99****************SETON                     LRU7                 S01194
0666 C***99****************MOVEL'ICR.1'   ERROR  30                       S01194
0667 C***99****************MOVE ZTABKY    ERROR                           S01194
0668 C***99****************GOTO EOJ                                       S01194
0669 C*********************                                               S01194
0670 C*****ACCESS*I.C.R.2**                                               S01194
0671 C*********************MOVEL'01'      TABKEY 12                       S01194
0672 C*********************MOVE '11'      TABKEY                          S01194
0673 C*********************EXSR TABCHN                                    S01194
0674 C**N10****************SETON                     LRU7                 S01194
0675 C**N10****************MOVEL'ICR.2'   ERROR                           S01194
0676 C**N10****************MOVE TABKEY    ERROR                           S01194
0677 C**N10****************GOTO EOJ                                       S01194
0678 C*********************                                               S01194
0679 C*****ACCESS*I.C.R.5**                                               S01194
0680 C*********************MOVE '40'      TABKEY                          S01194
0681 C*********************EXSR TABCHN                                    S01194
0682 C**N11****************SETON                     LRU7                 S01194
0683 C**N11****************MOVEL'ICR.5'   ERROR                           S01194
0684 C**N11****************MOVE TABKEY    ERROR                           S01194
0685 C**N11****************GOTO EOJ                                       S01194
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE           ************   S01194
     C                     MOVEL'01'      DBASE            * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO EOJ                                       S01194
     C                     END                                            S01194
0330 C*                                                                   S01194
     C** READ DEALING DETAILS VIA ACCESS PROGRAM                          S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDEALPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO EOJ                                       S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C** READ TRADING DETAILS VIA ACCESS PROGRAM                          S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDTRADPD'DBFILE           ************   S01194
     C                     MOVEL'03'      DBASE            * DBERR 03 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO EOJ                                       S01194
     C                     END                                            S01194
0686 C*
0687 C*    SETUP CURRENCY ARRAYS - FTXRATE,MULT/DIV INDS,SPOT RATE.
0688 C                     EXSR XCYARR
0689 C***96****************SETON                     LRU7                 S01194
0690 C***96****************MOVEL'CCY'     ERROR                           S01194
0691 C***96****************MOVE XCYKEY    ERROR                           S01194
0692 C***96****************GOTO EOJ                                       S01194
     C           *IN96     IFEQ '1'                                       S01194
     C                     MOVEL'SDCURRPD'DBFILE           ************   S01194
     C                     MOVEL'04'      DBASE            * DBERR 04 *   S01194
     C                     MOVE '1'       *INLR            ************   S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO EOJ                                       S01194
     C                     END                                            S01194
0693 C*
0694 C*    ADJUST MINIMUM BROKERAGE TO TAKE ACCOUNT OF DECIMAL PLACES
0695 C                     Z-ADD1         X
0696 C***********LOCY******LOKUPCYA,X                    41               S01194
0696 C           BJLCCY    LOKUPCYA,X                    41               S01194
0697 C           DPA,X     COMP 1                        41
0698 C           DPA,X     COMP 2                        42
0699 C           DPA,X     COMP 3                        43
0700 C***41******MBGE******MULT 10        MBG     63                      S01194
0701 C***42******MBGE******MULT 100       MBG                             S01194
0702 C***43******MBGE******MULT 1000      MBG                             S01194
0703 C**N41N42N43**********Z-ADDMBGE      MBG                             S01194
0700 C   41      BNMBAM    MULT 10        MBG     63                      S01194
0701 C   42      BNMBAM    MULT 100       MBG                             S01194
0702 C   43      BNMBAM    MULT 1000      MBG                             S01194
0703 C  N41N42N43          Z-ADDBNMBAM    MBG                             S01194
0704 C*
0705 C*    CHECK DEALS FILE HEADER PRESENT
0706 C**N01****************SETON                     LRU7                 S01194
0707 C**N01****************MOVEL'DEAL HDR'ERROR                           S01194
0708 C**N01****************GOTO EOJ                                       S01194
     C           *IN01     IFEQ '0'                                       S01194
     C                     MOVEL'DEAL HDR'DBFILE           ************   S01194
     C                     MOVEL'05'      DBASE            * DBERR 05 *   S01194
     C                     MOVE '1'       *INLR            ************   S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     EXSR *PSSR                                     S01194
0708 C                     GOTO EOJ                                       S01194
0708 C                     END                                            S01194
0709 C*
0710 C*    SET UP BLANK FIELD FOR CLEARS
0711 C                     MOVE '        'BLANK  12
0712 C                     Z-ADD0         ZERO13 130
0713 C                     Z-ADD0         ZERO5   50
0714 C*
0715 C*    ESTABLISH WHETHER LONDON OR LUXEMBURG BASED
0716 C                     MOVE BLANK     BKEY    7
0717 C           BKEY      CHAINBROKR                41
0718 C**N07****************SETON                     LRU7                 S01194
0719 C**N07****************MOVEL'BRK.HDR' ERROR                           S01194
0720 C**N07****************MOVE BKEY      ERROR                           S01194
0721 C**N07****************GOTO EOJ                                       S01194
     C           *IN07     IFEQ '0'                                       S01194
     C                     MOVEL'BRK. HDR'DBFILE                          S01194
0708 C                     MOVELBKEY      DBKEY            ************   S01194
     C                     MOVEL'06'      DBASE            * DBERR 06 *   S01194
     C                     MOVE '1'       *INLR            ************   S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     EXSR *PSSR                                     S01194
0721 C                     GOTO EOJ                                       S01194
0721 C                     END                                            S01194
0721 C*                                                                   S01194
0722 C           TBLTP     COMP '01'                 515152
0723 C*
0724 C*    STORE DATE OF LAST BROKERAGE UPDATE
0725 C                     MOVE DLBU      WDLBU   50
     C*                                                                   AUS007
     C** Access SAR details file to determine if Australian Brokerage     AUS007
     C** is switched on                                                   AUS007
     C*                                                                   AUS007
     C                     CALL 'AOSARDR0'                                AUS007
     C                     PARM *BLANKS   @RTCD                           AUS007
     C                     PARM '*VERIFY' @OPTN                           AUS007
     C                     PARM 'AUS007'  @SARD   6                       AUS007
     C           SCSARD    PARM SCSARD    DSFDY                           AUS007
     C           @RTCD     IFNE *BLANKS                                   AUS007
     C           @RTCD     ANDNE'*NRF   '                                 AUS007
     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 013 *AUS007
     C                     MOVEL'013'     DBASE            ***************AUS007
     C                     MOVEL'AUS007'  DBKEY                           AUS007
     C                     SETON                     U7U8LR               AUS007
     C                     END                                            AUS007
     C           @RTCD     IFEQ *BLANK                                    AUS007
     C                     MOVEL'Y'       AUS007  1                       AUS007
     C                     ELSE                                           AUS007
     C                     MOVEL'N'       AUS007                          AUS007
     C                     END                                            AUS007
      *                                                                   CSD007
      ** Access Switchable Features file and check if CSD007              CSD007
      ** is switched on or not.                                           CSD007
      *                                                                   CSD007
     C                     CALL 'AOSARDR0'                                CSD007
     C                     PARM *BLANKS   @RTCD   7                       CSD007
     C                     PARM '*VERIFY' @OPTN   7                       CSD007
     C                     PARM 'CSD007'  @SARD   6                       CSD007
     C           SCSARD    PARM SCSARD    DSFDY                           CSD007
      *                                                                   CSD007
     C           @RTCD     IFEQ *BLANKS                                   CSD007
     C                     MOVE 'Y'       CSD007  1                       CSD007
      *                                                                   CSD007
     C                     ELSE                                           CSD007
     C                     MOVE 'N'       CSD007                          CSD007
      *                                                                   CSD007
      ** Database Error, if Return Code is not blanks or *NRF             CSD007
      *                                                                   CSD007
     C           @RTCD     IFNE '*NRF   '                                 CSD007
     C                     MOVEL'SCSARDPD'DBFILE                          CSD007
     C                     MOVEL'017'     DBASE                           CSD007
     C                     MOVEL'CSD007  'DBKEY                           CSD007
     C                     MOVE *ON       *INU7                           CSD007
     C                     MOVE *ON       *INU8                           CSD007
     C                     MOVE *ON       *INLR                           CSD007
     C                     EXSR *PSSR                                     CSD007
     C                     GOTO EOJ                                       CSD007
     C                     ENDIF                                          CSD007
     C                     ENDIF                                          CSD007
      *                                                                                       CDL033
     C                     MOVEL*BLANKS   CDL033  1                                           CDL033
      *                                                                                       CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*VERIFY' @OPTN                                               CDL033
     C                     PARM 'CDL033'  @SARD                                               CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVEL'Y'       CDL033                                              CDL033
     C                     ELSE                                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE '*NRF'                                                        CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVEL'018'     DBASE                                               CDL033
     C                     MOVEL'CDL033  'DBKEY                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                     MD035545
      ** Retrieve system value setting                                                      MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   W0RTCD  7                                         MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'                             MD035545
      *                                                                                     MD035545
     C           W0RTCD    IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1200CCP1                                           S01408
     C*                                                                   S01408
      ** Check if feature CDL099 is enabled                                                   CDL099
      *                                                                                       CDL099
     C                     MOVEL*BLANKS   CDL099  1                                           CDL099
      *                                                                                       CDL099
     C                     CALL 'AOSARDR0'                                                    CDL099
     C                     PARM *BLANKS   @RTCD                                               CDL099
     C                     PARM '*VERIFY' @OPTN                                               CDL099
     C                     PARM 'CDL099'  @SARD                                               CDL099
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL099
      *                                                                                       CDL099
     C           @RTCD     IFEQ *BLANKS                                                       CDL099
     C                     MOVEL'Y'       CDL099                                              CDL099
     C                     ELSE                                                               CDL099
     C                     MOVEL'N'       CDL099                                              CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
0726 C*                                                                  *
0727 C*    DETAIL PROCESSING
0728 C           BEGIN     TAG                             ** BEGIN TAG **
0729 C*
0730 C*    MAINTAIN HASH TOTALS FOR DEALS FILE
0731 C*****TOTAL*NO*OF*RECORDS*****************************************   062735
0732 C***********REC,3     ADD  1         REC,3                           062735
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1200CCP2                                           S01408
     C*                                                                   S01408
0733 C*
0734 C*    DETAIL RECORDS ONLY
0735 C           RECI      COMP 'D'                      41
0736 C  N41                GOTO START
0737 C   02      PUAM      DIV  1000      ZZAMT
0738 C   03      PCPL      DIV  1000      ZZAMT
0739 C   04      PUPR      DIV  1000      ZZAMT
0740 C   05      SAPR      DIV  1000      ZZAMT
     C*  FIELD 'OUR PRINCIPAL AMOUNT' USED FOR HASHING FRA/IRS RECORDS    S01119
     C   21      UPAMT     DIV  1000      ZZAMT                           S01119
0741 C                     Z-ADD1         X
0742 C                     EXSR HASH
0743 C*
0744 C*    RESET EXTRACT INDICATOR
0745 C           START     TAG                             ** START TAG **
0746 C                     SETOF                     892242
0747 C                     SETOF                     565758
0748 C                     SETOF                     808182
0749 C                     SETOF                     595350
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1200CCP3                                           S01408
     C*                                                                   S01408
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C                     SETOF                     71                                       CDL099
     C                     ENDIF                                                              CDL099
0750 C*
0751 C*    SELECT RECORDS FOR EXTRACTION
0752 C   01
0753 COR 06
0754 COR 19                GOTO EOJ
0755 C           RECI      COMP 'R'                      49REVERSED
0756 C  N49      DTYP      COMP 'PS'                     49INTERNAL
0757 C  N49      BRKC      COMP 'MAIL'                   49INVALID
0758 C  N49      BRKC      COMP 'PHON'                   49BROKER
0759 C  N49      BRKC      COMP 'SWAP'                   49CODES
0760 C  N49      BRKC      COMP 'TELX'                   49CODES
0761 C*
0762 C**CHECK*IF*BROKERAGE TO BE CALCULATED                               E10507
0763 C***********                                                         E10507
0764 C**N49*20***          TESTB'0'       DSTI       49                   E10507
0765 C*
0766 C  N49      ORED      COMP WDLBU                  4949 DEAL SINCE LST
0767 C*                                                    UPDATE
0768 C*CANNOT RE-RUN ON SAME DAY
0769 C***U1N49***DLBU******COMP RUND                     49               S01194
0769 C   U1N49   DLBU      COMP BJRDNB                   49               S01194
0770 C  N49 02             TESTB'1'       DSTI           41
0771 C  N49 41 02FSLI      COMP 2                        49
0772 C  N49 41 02FSLI      COMP 1                        22
0773 C   49                GOTO EOJ
     C           AUS007    IFEQ 'Y'                                       AUS007
     C           DLNO      CHAINBKRAT                30                   AUS007
     C           *IN30     CABEQ'0'       EOJ                             AUS007
     C                     END                                            AUS007
     C/COPY WNCPYSRC,DL1200C001
0774 C*
     C* CHECK IF BROKERAGE IS EQUAL TO ZERO                               E10507
     C* THIS CHECK NOT REQUIRED FOR FRA/IRS                               S01119
     C*                                                                   E10507
     C*  20                GOTO ACCUM                              E10507 S01119
     C***20N21             GOTO ACCUM                              S01119 E12864
     C   20N21             TESTB'0'       DSTI       49                   E12864
     C   49                GOTO ACCUM                                     E12864
     C*
     C* FOR FRA/IRS, IF THERE IS A REAL BROKER CODE ON TABLE FILE         S01119
     C* EXTRACT A RECORD                                                  S01119
     C*                                                                   S01119
     C***21****************MOVE BLANK     TABKEY 12                 S01119S01194
     C***21****************MOVEL'80'      TABKEY                    S01119S01194
     C***21****************MOVE BRKC      TABKEY                    S01119S01194
     C***21******TABKEY****CHAINTABLE                24             S01119S01194
     C***21****24**********GOTO EOJ                                 S01119S01194
     C***21****************MOVE BKCY      CCYBR                     S01119S01194
     C** READ BROKER DETAILS VIA ACCESS PROGRAM                           S01194
     C           *IN21     IFEQ '1'                                       S01194
     C*                                                                   S01194
     C                     CALL 'AOBROKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM BRKC      BQTX    4                       S01194
     C           SDBROK    PARM SDBROK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBROKPD'DBFILE           ************   S01194
     C                     MOVEL'07'      DBASE            * DBERR 07 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVELBRKC      DBKEY                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO EOJ                                       S01194
     C                     END                                            S01194
     C                     MOVE A9BRCY    CCYBR                           S01194
     C*
     C                     END                                            S01194
     C***21 51*************GOTO END51                              S01119 E12523
     C***21 52*************GOTO END52                              S01119 E12523
     C   21                GOTO LOCONV                                    E12523
0774 C*
0775 C*    NO CALCULATION IF BROKERAGE ALREADY PRESENT
     C*
     C* GET BROKER CURRENCY IF BROKERAGE ALREADY PRESENT (IE INPUT)
     C**N20****************MOVE BLANK     TABKEY 12                       S01194
     C**N20****************MOVEL'80'      TABKEY                          S01194
     C**N20****************MOVE BRKC      TABKEY                          S01194
     C**N20******TABKEY****CHAINTABLE                12                   S01194
     C**N20****12**********SETON                     LRU7                 S01194
     C**N20****12**********GOTO EOJ                                       S01194
     C**N20****************MOVE BKCY      CCYBR                           S01194
     C** READ BROKER DETAILS VIA ACCESS PROGRAM                           S01194
     C           *IN20     IFEQ '0'                                       S01194
     C*                                                                   S01194
     C                     CALL 'AOBROKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM BRKC      BQTX    4                       S01194
     C           SDBROK    PARM SDBROK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBROKPD'DBFILE           ************   S01194
     C                     MOVEL'08'      DBASE            * DBERR 08 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVELBRKC      DBKEY                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO EOJ                                       S01194
     C                     END                                            S01194
     C                     MOVE A9BRCY    CCYBR                           S01194
     C*
     C                     END                                            S01194
0776 C**N20N02*************MOVE CCY       CCYBR                           E12523
0777 C**N20*02*************MOVE BLANK     TABKEY 12                       E12523
0778 C**N20*02*************MOVEL'80'      TABKEY                          E12523
0779 C**N20*02*************MOVE BRKC      TABKEY                          E12523
0780 C**N20*02***TABKEY****CHAINTABLE                12                   E12523
0781 C**N20*02*12**********SETON                     LRU7                 E12523
0782 C**N20*02*12**********GOTO EOJ                                       E12523
0783 C**N20*02*************MOVE BKCY      CCYBR                           E12523
0784 C**N20 51*************GOTO END51                                     E12523
0785 C**N20 52*************GOTO END52                                     E12523
0785 C  N20                GOTO LOCONV                                    E12523
0786 C*
0787 C*    SWITCH FOR LONDON OR LUXEMBURG CALCULATIONS
0788 C   51                GOTO LUXTAG
0789 C*                                                                  *
0790 C*    CALCULATE BROKERAGE FOR LONDON BASED DEALS              *
0791 C*    FX DEALS - SWAP AND OUTRIGHT      DO NOT PERFORM CALCULATIONS
0792 C*    -----------------------------     ON OPTION DEALS (OP,OT)
0793 C*                                      OR ON NON-USD CURRENCY DEALS
0794 C*                                                                  *
0795 C  N02                GOTO LLNDEP
0796 C           DTYP      COMP 'OP'                     53
0797 C  N53      DTYP      COMP 'OT'                     53
0798 C   53                GOTO ZBROK
0799 C*
0800 C***********PUCY******COMP USCY                     54               S01194
0801 C***********SLCY******COMP USCY                     55               S01194
0800 C           PUCY      COMP BLUSCY                   54               S01194
0801 C           SLCY      COMP BLUSCY                   55               S01194
0802 C  N54N55             SETON                     56
0803 C   56                GOTO ZBROK
0804 C*
0805 C*    ESTABLISH CURRENCY OF DEAL   --   USD/GBP USE USD
0806 C*    AND OBTAIN BROKT TABLE            USD/OTHER USE OTHER
0807 C*
0808 C***54******SLCY******COMP STCY                     57               S01194
0809 C***55******PUCY******COMP STCY                     57               S01194
0808 C   54      SLCY      COMP BLCYCD                   57               S01194
0809 C   55      PUCY      COMP BLCYCD                   57               S01194
0810 C*
0811 C*
0812 C***57****************MOVE USCY      BKEY                            S01194
0812 C   57                MOVE BLUSCY    BKEY                            S01194
0813 C   54N57             MOVE SLCY      BKEY
0814 C   55N57             MOVE PUCY      BKEY
0815 C*
0816 C                     EXSR CHNBKR
0817 C   42                GOTO ZBROK
0818 C*
0819 C* ESTABLISH TERM OF DEAL            SWAP /  2NDLEG - 1ST LEG
0820 C*                                   OUTRIGHT /(VALUE - DEAL)DATE
0821 C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1200CCP4                                           S01408
     C*                                                                   S01408
      ** For FX deal or swap treated as 2 seperate FX deals, London                           CDL099
      ** brokerage uses spot rate regardless of period.                                       CDL099
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
      *                                                                                       CDL099
     C  N22      VDAT      SUB  DDAT      TERM           58                                   CDL099
      *                                                                                       CDL099
     C           *IN22     IFEQ '1'                                                           CDL099
     C                     Z-ADDVDAT      USTRDT  50                                          CDL099
      *                                                                                       CDL099
     C           BSDT2     IFNE 0                                                             CDL099
     C           BSDT2     ANDGT0                                                             CDL099
     C           BSDT2     ANDGTVDAT                                                          CDL099
     C                     Z-ADDBSDT2     USTRDT                                              CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C                     Z-ADDOTDT      UENDDT  50                                          CDL099
     C           BSDT2     IFNE 0                                                             CDL099
     C           BSDT2     ANDGT0                                                             CDL099
     C           BRSD2     ANDLTOTDT                                                          CDL099
     C                     Z-ADDBRSD2     UENDDT                                              CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
      ** Calculate term.                                                                      CDL099
      *                                                                                       CDL099
     C           UENDDT    SUB  USTRDT    TERM    50     58                                   CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C           CDL099    IFNE 'Y'                                                           CDL099
0822 C   22      OTDT      SUB  VDAT      TERM    50     58  SWAP
0823 C  N22      VDAT      SUB  DDAT      TERM           58  OUTRIGHT
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1200CCP5                                           S01408
     C*                                                                   S01408
0824 C*
0825 C*    OBTAIN RATE FOR CALC OF BROKERAGE
0826 C*    FOR OUTRIGHTS AND DEAL USD-GBP OR SWAPS USE SWAP RATE
0827 C*    FOR OUTRIGHT DEALS USD-OTHER CCY USE OTHER CCY SPOT RATE
0828 C  N57N22
0829 COR 58                MOVE BRFS      FXRATE  53
0830 C  N57N22
0831 COR 58                GOTO SWEND
0832 C*
0833 C*    PICKUP APPROPRIATE SWAP RATE
0834 C*    IF TERM BETWEEN 1 AND 7 DAYS
0835 C                     Z-ADD1         R       20
0836 C           TERM      LOKUPDT,R                     80
0837 C   80                GOTO PICKRT
0838 C*
0839 C*    IF TERM GREATER THAN 7 DAYS
0840 C                     Z-ADD1         R
0841 C           TERM      LOKUPDAYS,R               80  80
0842 C           R         COMP 3                        82  DAYS 182-184
0843 C  N82      R         COMP 5                        82       366,731
0844 C  N82      R         COMP 7                        82  NEED JULIAN
0845 C   82                GOTO JULIAN                       DATE CHECK
0846 C*
0847 C           R         DIV  2         R                  DAYS -181-365
0848 C           R         ADD  7         R                  -730,OVER9999
0849 C                     GOTO PICKRT
0850 C*
0851 C*    ROUTINE TO CHECK IF TERM IS A COMPLETE JULIAN PERIOD
0852 C           JULIAN    TAG                             ** JULIAN TAG *
0853 C*    CALCULATE DATES 6 MONTHS,1 & 2 YRS FORWARD
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1200CCP6                                           S01408
     C*                                                                   S01408
      ** Calculate dates 6 months, 1 & 2 years foward.                                        CDL099
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C                     Z-ADDUSTRDT    ZDAYNO                                              CDL099
     C                     MOVE 'X'       ZFREQ                                               CDL099
     C                     EXSR FREQ                                                          CDL099
     C                     Z-ADDZDAYNO    PR,1                                                CDL099
      *                                                                                       CDL099
     C                     Z-ADDUSTRDT    ZDAYNO                                              CDL099
     C                     MOVE 'Y'       ZFREQ                                               CDL099
     C                     EXSR FREQ                                                          CDL099
     C                     Z-ADDZDAYNO    PR,2                                                CDL099
      *                                                                                       CDL099
     C                     Z-ADDUSTRDT    ZDAYNO                                              CDL099
     C                     MOVE 'Z'       ZFREQ                                               CDL099
     C                     EXSR FREQ                                                          CDL099
     C                     Z-ADDZDAYNO    PR,3                                                CDL099
     C                     Z-ADD1         R                                                   CDL099
     C           UENDDT    LOKUPPR,R                 80  80                                   CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C           CDL099    IFNE 'Y'                                                           CDL099
0854 C                     Z-ADDVDAT      ZDAYNO
0855 C  N22                Z-ADDDDAT      ZDAYNO
0856 C                     MOVE 'X'       ZFREQ
0857 C                     EXSR FREQ
0858 C                     Z-ADDZDAYNO    PR,1
0859 C*
0860 C                     Z-ADDVDAT      ZDAYNO
0861 C  N22                Z-ADDDDAT      ZDAYNO
0862 C                     MOVE 'Y'       ZFREQ
0863 C                     EXSR FREQ
0864 C                     Z-ADDZDAYNO    PR,2
0865 C*
0866 C                     Z-ADDVDAT      ZDAYNO
0867 C  N22                Z-ADDDDAT      ZDAYNO
0868 C                     MOVE 'Z'       ZFREQ
0869 C                     EXSR FREQ
0870 C                     Z-ADDZDAYNO    PR,3
0871 C                     Z-ADD1         R
0872 C   22      OTDT      LOKUPPR,R                 80  80
0873 C  N22      VDAT      LOKUPPR,R                 80  80
     C                     ENDIF                                                              CDL099
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1200CCP7                                           S01408
     C*                                                                   S01408
0874 C   80      R         ADD  7         R
0875 C  N80                Z-ADD11        R
0876 C           PICKRT    TAG                             *** PICKRT ****
0877 C                     Z-ADDBRF,R     FXRATE
     C**
     C**   IF USD-GBP OUTRIGHT USE GREATER OF SPOT AND SWAP RATES
     C**
     C   22
     CORN57                GOTO SWEND
     C                     MOVE BRFS      FXTEST  53
     C           FXTEST    COMP FXRATE               38
     C   38                MOVE BRFS      FXRATE
0878 C*
0879 C           SWEND     TAG                             ** SWEND TAG **
     C*    STORE CURRENCY IN WHICH BROKERAGE WILL BE EXPRESSED (STERLING)
     C*********************MOVE STCY      CCYBR                           S01194
     C                     MOVE BLCYCD    CCYBR                           S01194
     C*
0880 C*
0881 C*    OBTAIN AMOUNT FOR CALCULATION USE USD DOLLAR AMOUNT
0882 C   54                MOVE PUAM      WAMT   130
0883 C   55                MOVE SLAM      WAMT
0884 C*
0885 C* CALCULATE BROKERAGE AS (AMOUNTXRATE)/100,000
0886 C***********WAMT      MULT FXRATE    XBROKG 155                      E24118
0886 C           WAMT      MULT FXRATE    XBROKG 153                      E24118
0887 C           XBROKG    DIV  100000    XBROKG    H
     C*
     C* CONVERT BROKERAGE FROM USD TO GBP
     C*********************MOVE USCY      CCY1                            S01194
     C*********************MOVE STCY      CCY2                            S01194
    *C******************** MOVE BLUSCY    CCY1                      S01194106813
    *C******************** MOVE BLCYCD    CCY2                      S01194106813
    *C******************** Z-ADDXBROKG    AMTIN                           106813
    *C******************** EXSR CNVERT                                    106813
    *C******************** Z-ADDAMTOT     BROKG  130                      106813
0889 C*********************Z-ADDBROKG     GBROK                           E12523
     C                     Z-ADDXBROKG    BROKG  130                      106813
0890 C                     GOTO ENDET
0891 C*                                                                  *
0892 C* LOANS AND DEPOSITS AND NA'S       DO NOT PERFORM CALCULATIONS    *
0893 C* ---------------------------       ON CALL/NOTICE DEALS (CD,CL,DL)*
0894 C*                                                                  *
0895 C           LLNDEP    TAG                             *** LLNDEP ****
0896 C*
0897 C           DTYP      COMP 'CD'                     59
0898 C  N59      DTYP      COMP 'CL'                     59
0899 C  N59      DTYP      COMP 'DL'                     59
0900 C   59                GOTO ZBROK
0901 C*
0902 C*    OBTAIN AMOUNT AND SELECT DEPOSIT RATE
0903 C                     Z-ADDPCPL      WAMT
0904 C  N03                Z-ADDFVAL      WAMT
0905 C                     MOVE CCY       BKEY
     C                     MOVE CCY       CCYBR
0906 C                     EXSR CHNBKR
0907 C   42                GOTO ZBROK
0908 C                     Z-ADDBRRD      RATE
     C           DTYP      COMP 'CI'                     61
     C/COPY WNCPYSRC,DL1200C003
      *                                                                                       CDL033
     C           *IN61     IFEQ *OFF                                                          CDL033
     C           DTYP      COMP 'CF'                     61                                   CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C  N03
     COR 61                Z-ADDBRRN      RATE
     C                     SETOF                     61
0910 C*
0911 C*    CALCULATE BROKERAGE ON LONDON DEALS(NOT FX)
0912 C                     EXSR LONCAL
0913 C   99                GOTO EOJ
0914 C                     GOTO ENDET
0915 C/SPACE 3                                                           *
0916 C*          CALCULATE BROKERAGE FOR LUXEMBURG BASED DEALS           *
0917 C*                                                                  *
0918 C           LUXTAG    TAG                             *** LUXTAG ****
0919 C*********************SETOF*********************39                   E12891
0920 C*
0921 C* SEPARATE FX/OUTRIGHT - FX/SWAP - DEPOSITS/NA
0922 C*
0923 C   02 22             GOTO LXSWAP
0924 C   03
0925 COR 05
0926 COR 04                GOTO LXDNA
0927 C*                                                                  *
0928 C* FX-OUTRIGHT                       DO NOT PERFORM CALCULATIONS    *
0929 C* -----------                       ON OPTION DEALS (OP,OT)        *
0930 C*                                                                  *
0931 C           DTYP      COMP 'OP'                     53
0932 C  N53      DTYP      COMP 'OT'                     53
0933 C*
0934 C* DETERMINE CURRENCY AND OBTAIN APPROPRIATE BROKR TABLE
0935 C*
0936 C                     EXSR LUX1
0937 C   53
0938 COR 42                MOVE WCCY      CCYBR
0939 C   53
0940 COR 42                GOTO ZBROK
0941 C*
0942 C* OBTAIN COMPONENTS FOR CALCULATION
0943 C*
0944 C***********FXPD******COMP ' '**********************63               E12891
0945 C***63****************MOVE WCCY******CCYBR************               E12891
0946 C***63****************GOTO ZBROK**********************               E12891
0972 C           VDAT      SUB  DDAT      TERM                            E12891
0974 C                     MOVEABLANK     PER                             E12891
0975 C                     MOVEAFXPD      PER                             E12891
0976 C                     MOVELFRA       WRA                             E12891
0977 C                     MOVEAFXMD      MTD                             E12891
0978 C                     EXSR PERIOD                                    E12891
0979 C   65                MOVE WCCY      CCYBR                           E12891
0980 C   65                GOTO ZBROK                                     E12891
0947 C                     Z-ADDDDAT      ZIBEG   50
0948 C                     Z-ADDVDAT      ZIEND   50
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1200CCP8                                           S01408
     C*                                                                   S01408
      *                                                                                       CDL099
      ** If sale date is less than purchase date, then move sale date                         CDL099
      ** to ZIEND.                                                                            CDL099
      *                                                                                       CDL099
     C           BSDT2     IFNE 0                                                             CDL099
     C           CDL099    ANDEQ'Y'                                                           CDL099
     C           BSDT2     ANDLTVDAT                                                          CDL099
     C           *IN22     ANDEQ'0'                                                           CDL099
     C                     Z-ADDBSDT2     ZIEND                                               CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
0949 C***********FXMD******COMP 'P'**********************39               E12891
0950 C***39****************MOVE FRA*******RATE****77*******               E12891
0951 C**N39****************MOVE FRA*******CHAM****70*******               E12891
0952 C                     EXSR LUX2
0953 C   99                GOTO EOJ
0954 C                     GOTO ENDET
0955 C*
0956 C*
0957 C* FX-SWAP
0958 C* -------
0959 C*
0960 C           LXSWAP    TAG                             *** LXSWAP ****
0961 C*
0962 C* DETERMINE CURRENCY AND OBTAIN APPROPRIATE BROKR TABLE
0963 C*
0964 C                     EXSR LUX1
0965 C   42                MOVE WCCY      CCYBR
0966 C   42                GOTO ZBROK
0967 C*
0968 C* DETERMINE TERM AND OBTAIN APPROPRIATE SWAP CHARGE AMT/RATE
0969 C*
0970 C           FSLI      COMP 1                        64
0971 C  N64      VDAT      SUB  OTDT      TERM
0972 C   64      OTDT      SUB  VDAT      TERM
0973 C*
0974 C                     MOVEABLANK     PER
0975 C                     MOVEASPD       PER
0976 C                     MOVELSRA       WRA
0977 C                     MOVEASMD       MTD
0978 C                     EXSR PERIOD
0979 C   65                MOVE WCCY      CCYBR
0980 C   65                GOTO ZBROK
0981 C*
0982 C  N64                Z-ADDOTDT      ZIBEG
0983 C  N64                Z-ADDVDAT      ZIEND
0984 C   64                Z-ADDVDAT      ZIBEG
0985 C   64                Z-ADDOTDT      ZIEND
0986 C*
0987 C* CALCULATE BROKERAGE
0988 C*
0989 C***66****************SETON*********************39                   E12891
0990 C                     EXSR LUX2
0991 C   99                GOTO EOJ
0992 C                     GOTO ENDET
0993 C*
0994 C*                                                                  *
0995 C* DEPOSITS AND NEGOTIABLE ASSETS    DO NOT PERFORM CALCULATIONS    *
0996 C* ------------------------------    ON CALL/NOTICE DEALS(CD,CL,DL) *
0997 C*                                                                  *
0998 C           LXDNA     TAG                             **** LXDNA ****
0999 C*
1000 C           DTYP      COMP 'CL'                     59
1001 C  N59      DTYP      COMP 'CD'                     59
1002 C  N59      DTYP      COMP 'DL'                     59
1003 C   59                MOVE CCY       CCYBR
1004 C   59                GOTO ZBROK
1005 C*
1006 C*                        OBTAIN APPROPRIATE BROKR TABLE
1007 C*
1008 C                     MOVE CCY       WCCY
1009 C   03                MOVE PCPL      WAMT
1010 C   04
1011 COR 05                MOVE FVAL      WAMT
1012 C                     MOVE WCCY      BKEY
1013 C                     EXSR CHNBKR
1014 C   42                MOVE WCCY      CCYBR
1015 C   42                GOTO ZBROK
1016 C*
1017 C* DETERMINE TERM AND OBTAIN APPROPRIATE DEP RATE/CHARGE AMT
1018 C*
1019 C   03
1020 COR 04      MDAT      SUB  VDAT      TERM
1021 C   05      PMDT      SUB  VDAT      TERM
1022 C                     MOVEADPD       PER
1023 C                     MOVELDRA       WRA
1024 C                     MOVEADMD       MTD
1025 C*
1026 C                     EXSR PERIOD
1027 C   65                MOVE WCCY      CCYBR
1028 C   65                GOTO ZBROK
1029 C                     Z-ADDVDAT      ZIBEG
1030 C   03
1031 COR 04                Z-ADDMDAT      ZIEND
1032 C   05                Z-ADDPMDT      ZIEND
1033 C*
1034 C* CALCULATE BROKERAGE
1035 C*
1036 C***66****************SETON*********************39                   E12891
1037 C                     EXSR LUX2
1038 C   99                GOTO EOJ
1039 C                     GOTO ENDET
1040 C/SPACE 3
1041 C*
1042 C* FORWARD RECORD WITH ZERO BROKERAGE
1043 C*
1044 C           ZBROK     TAG                             * ZBROK TAG *
1045 C   42
1046 COR 65                SETON                     50
1047 C                     Z-ADD0         GBROK
1048 C                     Z-ADD0         BROKG
1049 C                     GOTO ACCUM
1050 C           ENDET     TAG                             **** ENDET ****
     C*    CONVERT BROKERAGE INTO LOCAL CCY (LONDON, NON-ZERO BROKERAGE)
1051 C*
1052 C*    CONVERT BROKERAGE INTO LOCAL CCY FOR NON-FX DEALS
1053 C*
1054 C***51****************GOTO LUXCNV                                    E12523
1054 C  N51                GOTO LOCONV                                    E12523
1055 C*
1056 C***********END52*****TAG                             ** END52 TAG **E12523
     C*
     C**N20****************Z-ADDBAGE      BROKG                           E12523
     C***21****************Z-ADDBAGE      BROKG                    S01119 E12523
     C*********************MOVE CCYBR     CCY1                            E12523
     C*********************MOVE LOCY      CCY2                            E12523
     C*********************Z-ADDBROKG     AMTIN                           E12523
     C*********************EXSR CNVERT                                    E12523
     C*********************Z-ADDAMTOT     GBROK                           E12523
     C*  MINIMUM BROKERAGE HAS NO RELEVANCE FOR FRA/IRS                   S01119
     C***21****************GOTO ACCUM                              S01119 E12523
1065 C*
1066 C*
1067 C*    UPDATE BROKERAGE TO MINIMUM BROKERAGE IF LESS
1068 C**N42*20***GBROK*****COMP MBG                    41                 E12523
1069 C**N42*20*41**********Z-ADDMBG       GBROK  130                      E12523
1070 C*********************GOTO ACCUM                                     E12523
1071 C           LUXCNV    TAG
1072 C*    DETERMINE BROKERAGE CCY FOR LUXEMBOURG
1073 C  N39                MOVE CHCY      CCYBR   3
1074 C   39                MOVE WCCY      CCYBR
1075 C**N42*20*41**********MOVE LOCY      CCYBR                           S01194
1075 C  N42 20 41          MOVE BJLCCY    CCYBR                           S01194
1076 C*
1077 C*****CONVERT BROKERAGE INTO LOCAL CCY FOR NON-FX DEALS (LUXEMBOURG) E12523
1078 C***********END51*****TAG                             ** END51 TAG **E12523
1077 C*    CONVERT BROKERAGE INTO LOCAL CCY FOR ALL DEALS                 E12523
1078 C           LOCONV    TAG                             * LOCONV TAG **E12523
1079 C**N20N02*************Z-ADDBAGE      BROKG                           E12523
1080 C**N20*02*************Z-ADDBAGE      BROKG                           E12523
     C  N20                Z-ADDBAGE      BROKG                           E12523
1081 C**N20*02*************Z-ADDBAGE      GBROK                           E12523
     C***21****************Z-ADDBAGE      BROKG                    S01119 E12523
1082 C**N02****************MOVE CCYBR     CCY1                            E12523
1083 C**N02****************MOVE LOCY      CCY2                            E12523
1084 C**N02****************Z-ADDBROKG     AMTIN                           E12523
1085 C**N02****************EXSR CNVERT                                    E12523
1086 C**N02****************Z-ADDAMTOT     GBROK                           E12523
1082*C**********           MOVE CCYBR     CCY1                      E12523106813
      *From currency is always GBP as BROKG calulated using GBP rates     106813
1083 C                     MOVE 'GBP'     CCY1                      S01194106813
1082 C                     MOVE CCYBR     CCY1                            E12523
1083 C*********************MOVE LOCY      CCY2                      E12523S01194
1083*C**********           MOVE BJLCCY    CCY2                      S01194106813
      *To Currency is brokers currency                                    106813
1082 C                     MOVE CCYBR     CCY2                      E12523106813
1083 C                     MOVE BJLCCY    CCY2                            S01194
1084 C                     Z-ADDBROKG     AMTIN                           E12523
1085 C                     EXSR CNVERT                                    E12523
1086 C                     Z-ADDAMTOT     GBROK                           E12523
     C* MINIMUM BROKERAGE HAS NO RELEVANCE FOR FRA/IRS                    S01119
     C      21             GOTO ACCUM                                     S01119
1087 C*
1088 C*    UPDATE BROKERAGE TO MINIMUM BROKERAGE IF LESS
1089 C  N42 20   GBROK     COMP MBG                    41
1090 C  N42 20 41          Z-ADDMBG       GBROK  130
1091 C*    ACCUMULATE FILE TOTALS
1092 C           ACCUM     TAG                             ** ACCUM TAG **
1093 C   02      PUAM      DIV  1000      ZZAMT
1094 C   03      PCPL      DIV  1000      ZZAMT
1095 C**N02N03***FVAL******DIV**1000******ZZAMT                           S01119
1095 C  N02N03N21FVAL      DIV  1000      ZZAMT                           S01119
     C   21      UPAMT     DIV  1000      ZZAMT                           S01119
1096 C                     Z-ADD2         X
1097 C                     EXSR HASH
1098 C*
1099 C*    OBTAIN CUSTOMER REPORT NAME
1100 C                     MOVELCNUM      CKEY    7
     C** IF DEAL IS A NEG.ASSET PURCH.USE THE 'BOUGHT FROM'CUSTOMER.IF IT
     C** IS A PRIMARY C.D. ISSUED,PCUS WILL BE THE ISSUING CUSTOMER(ISCN)
     C   04                MOVELPCUS      CKEY                      E2754
1101 C*********************MOVE 'A'       CKEY                            S01194
1102 C***********CKEY******CHAINCLINT                41                   S01194
1103 C**N09****************SETON                     LRU7                 S01194
1104 C**N09****************MOVEL'CLINT'   ERROR                           S01194
1105 C**N09****************MOVE CKEY      ERROR                           S01194
1106 C**N09****************GOTO EOJ                                       S01194
     C** READ BROKER DETAILS VIA ACCESS PROGRAM                           S01194
     C***********          CALL 'AOCUSTR0'                         S01194 CSD007
     C                     CALL 'AOCUSTR2'                                CSD007
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CKEY      KEY1   10                       S01194
     C                     PARM *BLANKS   KYST    7                       S01194
     C***********SDCUST    PARM SDCUST    DSSDY                    S01194 CSD007
     C           SDCUST    PARM SDCUST    DSLDY                           CSD007
      *                                                                   CSD007
      ** If CSD007 is on, allow processing of a closed record (return     CSD007
      ** code '*NRF' and date deleted equal to zero).                     CSD007
      *                                                                   CSD007
     C           CSD007    IFEQ 'Y'                                       CSD007
     C           @RTCD     ANDEQ'*NRF'                                    CSD007
     C           BBDTDL    ANDEQ*ZERO                                     CSD007
      *                                                                   CSD007
     C                     ELSE                                           CSD007
      *                                                                   CSD007
      ** If Customer found but deleted, include this on the report                          AR847323
      *                                                                                     AR847323
     C           @RTCD     IFEQ '*NRF'                                                      AR847323
     C           BBDTDL    ANDGT*ZERO                                                       AR847323
     C                     MOVELDLTD      BBCRNM                                            AR847323
      *                                                                                     AR847323
     C                     ELSE                                                             AR847323
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDCUSTPD'DBFILE           ************   S01194
     C                     MOVEL'09'      DBASE            * DBERR 09 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVELKEY1      DBKEY                           S01194
     C                     MOVELKYST      DBKYST  7                       S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO EOJ                                       S01194
     C                     END                                            S01194
      *                                                                   CSD007
     C                     ENDIF                                                            AR847323
     C                     ENDIF                                          CSD007
      *                                                                   CSD007
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1200CCP9                                           S01408
     C*                                                                   S01408
1107 C*
1108 C* SET INDICATOR TO EXTRACT RECORD
1109 C                     SETON                         89
1110 C           EOJ       TAG                             ** EOJ TAG **
1111 C/SPACE 3
1113 C***LR******   REC,3     COMP NORE                 4141              062735
1114 C***LR******   REC,1     COMP NLRA                 4242              062735
1115 C***LR******   INT,1     COMP VLAF                 4343              062735
1116 C***LRN43***   DEC,1     COMP VLAL                 4343              062735
1117 C***LR*41***                                                         062735
1118 C***OR*42***                                                         062735
1119 C***OR*43***             SETON                     U8                062735
1120 C*                                                                  *
1121 C*****UPDATE*DEALS*FILE*HEADER*WITH*RUND*DATE*TO*INDICATE*WHEN*LAST  S01194
1121 C**   UPDATE DEALS FILE HEADER WITH RUN DATE TO INDICATE WHEN LAS T  S01194
1122 C*    BROKERAGE RUN IF SWITCH 1 ON
1123 CLR U7
1124 COR U8                GOTO FIN
1125 CLR U1                Z-ADD0         DKEY    60
1126 CLR U1      DKEY      CHAINDEALRD               41
     C*                                                                   S01117
1127 CLR         FIN       TAG                             ** FIN TAG **
     C**                                                                  S01117
1128 C********************************************************************
1129 C/SPACE 3
1130 C********************************************************************
1131 C**
1132 C*****ZFREQ*SR.*TO*INCREMENT*A*DAY*NUMBER*DATE*BY*A**                S01194
1132 C**    FREQ SR. TO INCREMENT A DAY NUMBER DATE BY A                  S01194
1133 C**             PERIOD VALUE DETERMINED BY A CODE.
1134 C**
1135 C***********FREQ******BEGSR                           *** ZFREQ ***  S01194
1135 C           FREQ      BEGSR                           *** FREQ ***   S01194
1136 C**
1137 C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
1138 C                     MOVE ZFREQ     ZFREQ   1
1139 C                     Z-ADDZDAYNO    ZDAYNO  50
1140 C                     Z-ADDZMDAY     ZMDAY   20
1141 C                     MOVE ZCCY      ZCCY    3
1142 C**
1143 C*********************MOVE '   '     ZHC                             S01194
1144 C*********************MOVE ' '       ZTABKY 12                       S01194
1145 C**
1146 C**   CONVERT DAY NUMBER TO DATE.
1147 C                     EXSR ZDATE2
1148 C                     Z-ADDZDAY      ZMDAY
1149 C**
1150 C**   CHECK FOR AND INCREMENT FOR CODE D-DAILY-WORKING DAY.
1151 C           ZFREQ     COMP 'D'                      91
1152 C***91******RUND******ADD  1         ZDAYNO                          S01194
1152 C   91      BJRDNB    ADD  1         ZDAYNO                          S01194
1153 C   91                GOTO ZFHCHK
1154 C**
1155 C**   CHECK FOR AND INCREMENT FOR CODE W-WEEKLY.
1156 C           ZFREQ     COMP 'W'                      91
1157 C   91      ZDAYNO    ADD  7         ZDAYNO
1158 C   91                GOTO ZFEND
1159 C**
1160 C**   CHECK FOR AND INCREMENT FOR CODE F-FORTNIGHTLY.
1161 C           ZFREQ     COMP 'F'                      91
1162 C   91      ZDAYNO    ADD  14        ZDAYNO
1163 C   91                GOTO ZFEND
1164 C**
1165 C**   CHECK FOR AND INCREMENT FOR CODE S-SEMI-MONTHLY.
1166 C           ZFREQ     COMP 'S'                      91
1167 C   91      ZDAY      COMP 15                   939292
1168 C   91 92             Z-ADD31        ZDAY
1169 C   91 93             Z-ADD15        ZDAY
1170 C   91 93   ZMTH      ADD  1         ZMTH
1171 C   91                GOTO ZFDATE
1172 C**
1173 C**   CHECK FOR AND INCREMENT FOR CODE M-MONTHLY.
1174 C           ZFREQ     COMP 'M'                      91
1175 C   91                Z-ADDZMDAY     ZDAY
1176 C   91      ZMTH      ADD  1         ZMTH
1177 C   91                GOTO ZFDATE
1178 C**
1179 C**   CHECK FOR AND INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTH
1180 C           ZFREQ     COMP 'R'                      91
1181 C   91                Z-ADD31        ZDAY
1182 C   91      ZMTH      ADD  1         ZMTH
1183 C   91                GOTO ZFDATE
1184 C**
1185 C**   CHECK FOR AND INCREMENT FOR CODE T-BIMONTHLY.
1186 C           ZFREQ     COMP 'T'                      91
1187 C   91                Z-ADDZMDAY     ZDAY
1188 C   91      ZMTH      ADD  2         ZMTH
1189 C   91                GOTO ZFDATE
1190 C**
1191 C**   CHECK FOR AND INCREMENT FOR CODE Q-QUARTERLY.
1192 C           ZFREQ     COMP 'Q'                      91
1193 C   91                Z-ADDZMDAY     ZDAY
1194 C   91      ZMTH      ADD  3         ZMTH
1195 C   91                GOTO ZFDATE
1196 C**
1197 C**   CHECK FOR AND INCREMENT FOR CODE X-SIX MONTHLY.
1198 C           ZFREQ     COMP 'X'                      91
1199 C   91                Z-ADDZMDAY     ZDAY
1200 C   91      ZMTH      ADD  6         ZMTH
1201 C   91                GOTO ZFDATE
1202 C**
1203 C**   CHECK FOR AND INCREMENT FOR CODE Y-YEARLY.
1204 C           ZFREQ     COMP 'Y'                      91
1205 C   91      ZYEAR     ADD  1         ZYEAR
1206 C   91                GOTO ZFDATE
1207 C**
1208 C**   CHECK FOR AND INCREMENT FOR CODE Z 2 YEARS
1209 C           ZFREQ     COMP 'Z'                      91
1210 C   91      ZYEAR     ADD  2         ZYEAR
1211 C   91                GOTO ZFDATE
1212 C**
1213 C**   CHECK FOR AND INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH.
1214 C           ZFREQ     COMP 'L'                      91
1215 C   91                Z-ADD31        ZDAY
1216 C   91      ZMTH      ADD  1         ZMTH
1217 C   91                GOTO ZFDATE
1218 C**
1219 C**   CHECK FOR AND INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.
1220 C           ZFREQ     COMP 'B'                      91
1221 C   91                Z-ADD31        ZDAY
1222 C   91      ZMTH      ADD  1         ZMTH
1223 C   91                GOTO ZFDATE
1224 C**
1225 C**   CHECK FOR AND INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.
1226 C           ZFREQ     COMP 'A'                      91
1227 C*********************MOVEL'01    '  ZTABKY                          S01194
1228 C***91****************MOVE '    11'  ZTABKY                          S01194
1229 C***91******ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
1230 C**N99******RECI******COMP '*'                      99               S01194
     C*                                                                   S01194
     C** READ GENERAL LEDGER DETAILS VIA ACCESS PROGRAM                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDGELRPD'DBFILE           ************   S01194
     C                     MOVEL'10'      DBASE            * DBERR 10 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     MOVE '1'       *IN99                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
1231 C***91N99*************Z-ADDAPDA      ZDAYNO                          S01194
1231 C   91N99             Z-ADDBKAPDT    ZDAYNO                          S01194
1232 C**
1233 C**   BYPASS IF ZFREQ IS 'A' OR ANY OTHER VALUE
1234 C                     GOTO ZFEND
1235 C**
1236 C**
1237 C**   REFORMAT DATE AND ENSURE VALID.
1238 C           ZFDATE    TAG                             ** ZFDATE TAG*
1239 C**
1240 C**   VALIDATE MONTH.
1241 C           ZMTH      COMP 12                   91
1242 C   91      ZMTH      SUB  12        ZMTH
1243 C   91      ZYEAR     ADD  1         ZYEAR
1244 C**
1245 C**   CHECK FOR LEAP YEAR.
1246 C           ZYEAR     DIV  4         ZLYR    20
1247 C                     MVR            ZLY     10     92LEAP YEAR-92 ON
1248 C**
1249 C**   VALIDATE DAY NUMBER.
1250 C                     MOVE ZFMD,ZMTH ZWRK2   20
1251 C           ZMTH      COMP 2                        93
1252 C   92 93             Z-ADD29        ZWRK2
1253 C**
1254 C           ZDAY      COMP ZWRK2                94
1255 C   94                Z-ADDZWRK2     ZDAY
1256 C**
1257 C**   CHECK IF CODE R, TO SUBTRACT 6 DAYS.
1258 C           ZFREQ     COMP 'R'                      91
1259 C   91      ZDAY      SUB  6         ZDAY
1260 C**
1261 C**   REFORMAT DATE, DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.
1262 C                     MOVELZDAY      ZWRK4   40
1263 C                     MOVE ZMTH      ZWRK4
1264 C   98                MOVELZMTH      ZWRK4
1265 C   98                MOVE ZDAY      ZWRK4
1266 C                     MOVELZWRK4     ZDATE
1267 C                     MOVE ZYEAR     ZDATE
1268 C                     EXSR ZDATE1
1269 C**
1270 C**   CHECK IF CODE B,TO BE CHECKED FOR HOLIDAY.
1271 C           ZFREQ     COMP 'B'                      91
1272 C   91N99             GOTO ZFHCHK
1273 C**
1274 C                     GOTO ZFEND
1275 C**
1276 C**
1277 C**   CHECK IF DAY NUMBER IS A HOLIDAY.
1278 C           ZFHCHK    TAG                             ** ZFHCHK TAG *
1279 C**
1280 C**   DETERMINE CODE.
1281 C           ZFREQ     COMP 'D'                      91
1282 C           ZFREQ     COMP 'B'                      92
1283 C**
1284 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD.***                           S01195
1285 C*********************MOVEL'22    '  ZTABKY                          S01195
1286 C*********************MOVELZDAYNO    ZWRK6   6                       S01195
1287 C*********************MOVE 1         ZWRK6                           S01195
1288 C*********************MOVE ZWRK6     ZTABKY                          S01195
1289 C*********************                                               S01195
1290 C*****GET*HOLIDAY*RECORD.***                                         S01195
1291 C***********ZFHCHN****TAG                             ** ZFHCHN TAG* S01195
1292 C***********ZTABKY****CHAINTABLE                93    ON NOT THERE   S01195
1293 C**N93******RECI******COMP '*'                      93               S01195
1294 C*********************                                               S01195
1295 C*****STORE*CURRENCIES*IF*RECORD*FOUND.**                            S01195
1296 C**N94N93*************MOVEAHCCY      ZHC,1                           S01195
1297 C***94N93*************MOVEAHCCY      ZHC,26                          S01195
1298 C*********************                                               S01195
1299 C*****GET*SECORD*RECORD,*IF*NOT*ALREADY*DONE.**                      S01195
1300 C*********************MOVE ZTABKY    ZWRK1N  10                      S01195
1301 C***********ZWRK1N****COMP 1                        94               S01195
1302 C*********************MOVE '2'       ZTABKY                          S01195
1303 C***94N93*************GOTO ZFHCHN                                    S01195
1304 C*********************                                               S01195
1305 C*****BYPASS*TO*END*IF*NO*FIRST*RECORD*FOUND.**                      S01195
1306 C***93*94*************GOTO ZFEND                                     S01195
1307 C*********************                                               S01195
1308 C*****DETERMINE*HOLIDAY*RECORD*TYPE.**                               S01195
1309 C***********INEX******COMP 'E'                      95               S01195
1310 C***********INEX******COMP 'I'                      96               S01195
1311 C*********************                                               S01195
1312 C*****CHECK*IF*CURRENCY*ON*HOLIDAY.**                                S01195
1313 C***********ZCCY******LOKUPZHC                      97               S01195
1314 C*********************                                               S01195
1315 C*****BYPASS*IF*NOT*HOLIDAY*FOR*CURRENCY.**                          S01195
1316 C***95*97*************                                EXCLUDE FOUND  S01195
1317 C*R*96N97*************GOTO ZFEND                      INCL. NOT FOUNDS01195
1318 C*********************                                               S01195
1319 C*****INCREMENT*OR*DECREMENT*DAY*NUMBER*AS*REQUIRED.**               S01195
1320 C***91*95N97**********                                EXCL. NOT FOUNDS01195
1321 C*R*91*96*97ZDAYNO****ADD  1         ZDAYNO           INCLUDE FOUND  S01195
1322 C*********************                                               S01195
1323 C***92*95N97**********                                EXCL. NOT FOUNDS01195
1324 C*R*92*96*97ZDAYNO****SUB  1         ZDAYNO           INCLUDE FOUND  S01195
1325 C*********************GOTO ZFHCHK                                    S01195
     C*                                                                   S01195
     C                     MOVELCCY       ZCCY                            S01195
     C                     MOVELBJSLCD    ZLOC                            S01195
     C*                                                                   S01195
     C           ZFHCHN    TAG                                            S01195
     C                     EXSR ZCHKH                                     S01195
     C*                                                                   S01195
     C** IF NOT A WORKING DAY THEN INCREMENT OR DEVREMENT AS REQUIRED     S01195
     C** AND REPEAT                                                       S01195
     C           ZIND      IFNE 'W'                                       S01195
     C*                                                                   S01195
     C           *IN91     IFEQ '1'                                       S01195
     C                     ADD  1         ZDAYNO                          S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C           *IN92     IFEQ '1'                                       S01195
     C                     SUB  1         ZDAYNO                          S01195
     C                     END                                            S01195
     C*                                                                   S01195
     C                     GOTO ZFHCHN                                    S01195
     C                     END                                            S01195
1326 C**
1327 C**
1328 C           ZFEND     ENDSR                           * ZFEND ENDSR *
1329 C**
1330 C********************************************************************
1331 C/SPACE 3
1330 C********************************************************************S01195
1331  /COPY ZSRSRC,ZCHKH                                                  S01195
1330 C********************************************************************S01195
1331 C/SPACE 3                                                            S01195
1332 C********************************************************************S01195
1331  /COPY ZSRSRC,ZACCH                                                  S01195
1332 C********************************************************************S01195
1331 C/SPACE 3                                                            S01195
1332 C********************************************************************S01195
1333 C**
1334 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
1335 C**              CONVERT TO A NUMBER OF DAYS.
1336 C**
1337 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
1338 C**
1339 C           ZDATE1    BEGSR                           *** ZDATE1 ***
1340 C**
1341 C**   CLEAR DAY NUMBER.
1342 C                     Z-ADD0         ZDAYNO  50
1343 C**
1344 C**   CALCULATION TO DEFINE INPUT DATE FIELD.
1345 C                     Z-ADDZDATE     ZDATE   60
1346 C**
1347 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
1348 C                     MOVE ZDATE     ZYEAR   20
1349 C  N98                MOVELZDATE     ZDAY    20
1350 C   98                MOVELZDATE     ZMTH    20
1351 C                     MOVE ZDATE     ZWRK4   40
1352 C  N98                MOVELZWRK4     ZMTH
1353 C   98                MOVELZWRK4     ZDAY
1354 C**
1355 C**   ENSURE MONTH IS VALID.
1356 C           ZMTH      COMP 0                      9999
1357 C  N99      ZMTH      COMP 12                   99
1358 C   99                GOTO ZDEND1                     BYPASS IF ERROR
1359 C**
1360 C**   CHECK FOR 30 DAY MONTHS.
1361 C           ZMTH      COMP 4                        90IF 90 ON, 30
1362 C  N90      ZMTH      COMP 6                        90DAY MONTH.
1363 C  N90      ZMTH      COMP 9                        90
1364 C  N90      ZMTH      COMP 11                       90
1365 C**
1366 C**   ENSURE DAY IS VALID.
1367 C           ZDAY      COMP 0                      9999
1368 C   90N99   ZDAY      COMP 30                   99
1369 C  N90N99   ZDAY      COMP 31                   99
1370 C   99                GOTO ZDEND1                     BYPASS IF ERROR
1371 C**
1372 C**   CHECK FOR LEAP YEAR AND FEBRUARY.
1373 C           ZYEAR     ADD  28        ZYEAR
1374 C           ZYEAR     DIV  4         ZLYR    20
1375 C                     MVR            ZLY     10     91LEAP YR, 91 ON
1376 C           ZMTH      COMP 2                    93  92FEB., 92 ON
1377 C**                                                   PAST FEB, 93 ON
1378 C**   IF FEBUARY FURTHER VALIDATE DAY.
1379 C  N91 92   ZDAY      COMP 28                   99
1380 C   91 92   ZDAY      COMP 29                   99
1381 C   99                GOTO ZDEND1                     BYPASS IF ERROR
1382 C**
1383 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
1384 C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
1385 C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
1386 C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
1387 C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
1388 C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
1389 C**
1390 C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
1391 C**
1392 C********************************************************************
1393 C/SPACE 3
1394 C********************************************************************
1395 C*    SR TO CONVERT ONE CCY AMT INTO ANOTHER
1396 C           CNVERT    BEGSR
1397 C                     MOVE CCY1      CCY1    3
1398 C                     MOVE CCY2      CCY2    3
1399 C                     Z-ADDAMTIN     AMTIN  155     80
1400 C   80                Z-ADD0         AMTOT
1401 C   80                GOTO CNEND
1402 C                     Z-ADD1         ZI      30
1403 C           CCY1      LOKUPCYA,ZI                   95
1404 C  N95                SETON                     99
1405 C  N95                GOTO CNEND
1406 C******     MDF,ZI    COMP 0                        95               LN0268
1406 C***********MDF,ZI****COMP 'D'                      95         LN0268E24764
     C*                                                                   E24764
     C** Multiply/divide indicator - London method                        E24764
     C*                                                                   E24764
     C   52      MDF,ZI    COMP 'D'                      95               E24764
     C*                                                                   E24764
     C** Multiply/divide indicator - Luxembourg method                    E24764
     C*                                                                   E24764
     C   51      MDS,ZI    COMP 'D'                      95               E24764
     C*                                                                   E24764
1407 C   52      FTX,ZI    IFEQ 0                                         E16319
1408 C                     SETON                         50               E16319
     C                     Z-ADD0         GBROK                           E16319
     C                     Z-ADD0         BROKG                           E16319
     C                     GOTO ACCUM                                     E16319
1409 C                     END                                            E16319
1407 C***95******AMTIN*****DIV  FTX,ZI****AMTIN*****H                     E12052
1408 C**N95******AMTIN*****MULT FTX,ZI****AMTIN*****H                     E12052
1407 C   95 52   AMTIN     DIV  FTX,ZI    AMTIN     H                     E12052
1408 C  N95 52   AMTIN     MULT FTX,ZI    AMTIN     H                     E12052
1407 C   51      SPT,ZI    IFEQ 0                                         E12052
1408 C                     SETON                         50               E16319
     C                     Z-ADD0         GBROK                           E16319
     C                     Z-ADD0         BROKG                           E16319
     C                     GOTO ACCUM                                     E16319
1408 C*********************Z-ADD1         SPT,ZI                E12052    E16319
1409 C                     END                                            E16319
1407 C   95 51   AMTIN     DIV  SPT,ZI    AMTIN     H                     E12052
1408 C  N95 51   AMTIN     MULT SPT,ZI    AMTIN     H                     E12052
1409 C                     Z-ADDDPA,ZI    CDP1    10
1410 C                     Z-ADD1         ZI
1411 C           CCY2      LOKUPCYA,ZI                   95
1412 C  N95                SETON                     99
1413 C  N95                GOTO CNEND
1414 C*****      MDF,ZI    COMP 0                        95               LN0268
1414 C***********MDF,ZI****COMP 'D'                      95         LN0268E24764
     C*                                                                   E24764
     C** Multiply/divide indicator - London method                        E24764
     C*                                                                   E24764
     C   52      MDF,ZI    COMP 'D'                      95               E24764
     C*                                                                   E24764
     C** Multiply/divide indicator - Luxembourg method                    E24764
     C*                                                                   E24764
     C   51      MDS,ZI    COMP 'D'                      95               E24764
     C*                                                                   E24764
1407 C   52      FTX,ZI    IFEQ 0                                         E16319
1408 C                     SETON                         50               E16319
     C                     Z-ADD0         GBROK                           E16319
     C                     Z-ADD0         BROKG                           E16319
     C                     GOTO ACCUM                                     E16319
1409 C                     END                                            E16319
1415 C***95******AMTIN*****MULT FTX,ZI****AMTIN*****H                     E12052
1416 C**N95******AMTIN*****DIV  FTX,ZI****AMTIN*****H                     E12052
1415 C   95 52   AMTIN     MULT FTX,ZI    AMTIN     H                     E12052
1416 C  N95 52   AMTIN     DIV  FTX,ZI    AMTIN     H                     E12052
1407 C   51      SPT,ZI    IFEQ 0                                         E12052
1408 C                     SETON                         50               E16319
     C                     Z-ADD0         GBROK                           E16319
     C                     Z-ADD0         BROKG                           E16319
     C                     GOTO ACCUM                                     E16319
1408 C*********************Z-ADD1         SPT,ZI                E12052    E16319
1409 C                     END                                            E12052
1415 C   95 51   AMTIN     MULT SPT,ZI    AMTIN     H                     E12052
1416 C  N95 51   AMTIN     DIV  SPT,ZI    AMTIN     H                     E12052
1417 C           CDP1      SUB  DPA,ZI    XX      10
1418 C           XX        ADD  4         XX
1419 C           POW,XX    MULT AMTIN     AMTOT  150H
1420 C           CNEND     ENDSR
1421 C********************************************************************
1422 C/SPACE 3
1423 C********************************************************************
1424 C* SUBROUTINE TO OBTAIN BROKERAGE RATE TABLE.
1425 C*            IF NO TABLE PRESENT FOR KEY RETRY
1426 C*            WITH ZERO CURRENCY
1427 C*
1428 C           CHNBKR    BEGSR                           *** CHNBKR ****
1429 C                     SETOF                     4208
1430 C                     MOVELBRKC      BKEY
1431 C           BKEY      CHAINBROKR                42
1432 C  N08                MOVE '   '     BKEY
1433 C  N08      BKEY      CHAINBROKR                42
1434 C  N08                SETON                     42
1435 C                     ENDSR
1436 C*
1437 C********************************************************************
1438 C/SPACE 3
1439 C********************************************************************
1440 C* SUBROUTINE TO PERFORM COMMON  LUXEMBURG PROCESSING
1441 C*            DETERMINE CURRENCY CODE AND AMOUNT TO BE
1442 C*            USED IN CALCULATION
1443 C*            OBTAIN RELEVANT BROKR TABLE
1444 C*
1445 C           LUX1      BEGSR                           **** LUX1  ****
1446 C***********SLCY******COMP USCY                     57               S01194
1446 C           SLCY      COMP BLUSCY                   57               S01194
1447 C   57                MOVE SLCY      WCCY    3
1448 C  N57                MOVE PUCY      WCCY
1449 C   57                MOVE SLAM      WAMT   130
1450 C  N57                MOVE PUAM      WAMT
1451 C*
1452 C                     MOVE WCCY      BKEY
1453 C                     EXSR CHNBKR
1454 C           ENLK1     ENDSR
1455 C*
1456 C********************************************************************
1457 C/SPACE 3
1458 C********************************************************************
1459 C* SUBROUTINE TO PERFORM COMMON LUXEMBURG PROCESSING
1460 C*            DETERMINE CALCULATION TYPE (P/A)
1461 C*            TYPE P - CALCULATE BROKERAGE BY SR GLINTC
1462 C*            TYPE A - CALCULATE BROKERAGE AS (CHARGEXAMT/ PER AMT
1463 C*                     (IF PER CCY # 0 CONVERT AMT TO PER CCY)
1464 C*
1465 C           LUX2      BEGSR                           **** LUX2  ****
1466 C  N39                GOTO CHARGE
1467 C*                    Z-ADDWAMT      ZIAMT
1468 C                     Z-ADDWAMT      ZIAMT
1469 C*********************Z-ADD1         ZICALC  10                      E12051
1469 C   02                Z-ADD1         ZICALC                          E12051
1469 C  N02                Z-ADDICBS      ZICALC                          E12051
1470 C                     Z-ADDRATE      ZIRATE
1471 C                     EXSR GLINTC
1472 C                     Z-ADDZINTR     BROKG     H
1473 C                     GOTO FINLUX
1474 C*
1475 C           CHARGE    TAG                             **** CHARGE ***
1476 C           PRCY      COMP ' '                      66
1477 C   66                MOVE WAMT      WWAMT
1478 C   66                GOTO ACALC
1479 C*
1480 C*
1481 C* CONVERT DEAL AMOUNT TO PER CURRENCY
1482 C*
1483 C                     MOVE WCCY      XCCY    3        DEAL CURRENCY
1484 C                     EXSR XCYLOK
1485 C   99                SETON                     LRU8U7
1486 C   99                GOTO ENLUX
1487 C*
1488 C                     Z-ADDXSPOT     DLSPT  138
1489 C*****                Z-ADDXMDIN     DLMDI   10                      E134
1489 C                     MOVE XMDIN     DLMDI   1                       E134
1490 C                     Z-ADDXDECP     DLDEC   10
1491 C*
1492 C                     MOVE PRCY      XCCY    3        PER CURRENCY
1493 C                     EXSR XCYLOK
1494 C   99                SETON                     LRU7U8
1495 C   99                GOTO ENLUX
1496 C*
1497 C                     Z-ADDXSPOT     PRSPT  138
1498 C*****                Z-ADDXMDIN     PRMDI   10                      E134
1498 C                     MOVE XMDIN     PRMDI   1                       E134
1499 C                     Z-ADDXDECP     PRDEC   10
1500 C*
1501 C*
1502 C* CALCULATE CROSS RATE
1503 C*
1504 C*****      DLMDI     COMP 0                    737370               E134
1504 C           DLMDI     COMP 'D'                  737370               E134
1505 C*****      PRMDI     COMP 0                    757574               E134
1505 C           PRMDI     COMP 'D'                  757574               E134
1506 C*
1507 C   73 75
1508 COR 70 74   DLSPT     DIV  PRSPT     XXSPOT 138
1509 C   73 74
1510 COR 70 75   DLSPT     MULT PRSPT     XXSPOT
1511 C*
1512 C* APPLY DEAL CCY MULT/DIV IND /ADJUST DEC POSN OF CROSS RATE)
1513 C*
1514 C           DLDEC     SUB  PRDEC     XXDECP  10 767778
1515 C***73*77**                                                          E24763
1516 C*R*70*76**           GOTO MVLFT                                     E24763
1515 C   73 76                                                            E24763
1516 COR 70 77             GOTO MVLFT                                     E24763
1517 C   78                GOTO XCALC
1518 C*
1519 C* MOVE DECIMAL PLACES RIGHT
1520 C*
1521 C           MVRGT     TAG                             **** MVRGT ****
1522 C           XXSPOT    MULT 10        XXSPOT
1523 C   76      XXDECP    SUB  1         XXDECP         78
1524 C   77      XXDECP    ADD  1         XXDECP         78
1525 C   78                GOTO XCALC
1526 C                     GOTO MVRGT
1527 C*
1528 C* MOVE DECIMAL PLACES LEFT
1529 C*
1530 C           MVLFT     TAG                             **** MVLFT ****
1531 C           XXSPOT    DIV  10        XXSPOT
1532 C   76      XXDECP    SUB  1         XXDECP         78
1533 C   77      XXDECP    ADD  1         XXDECP         78
1534 C  N78                GOTO MVLFT
1535 C*
1536 C*
1537 C* APPLY CROSS RATE
1538 C*
1539 C           XCALC     TAG                             ****  XCALC  **
1540 C   70      WAMT      DIV  XXSPOT    WWAMT  130
1541 C   73      WAMT      MULT XXSPOT    WWAMT
1542 C*
1543 C           ACALC     TAG                             **** ACALC ****
1544 C*
1545 C* GET DECIMAL POSITIONS FOR CHARGE CURRENCY CONVERT AMOUNT
1546 C   66                MOVE WCCY      XCCY
1547 C  N66                MOVE PRCY      XCCY
1548 C                     EXSR XCYLOK
1549 C   99                SETON                     LRU7U8
1550 C   99                GOTO ENLUX
1551 C                     Z-ADDXDECP     XDECP   10
1552 C           XDECP     COMP 1                    323031
1553 C   32      XDECP     COMP 3                      3233
1554 C   30                Z-ADDPRMT      PRMTA  100
1555 C   31      PRMT      MULT 10        PRMTA
1556 C   32      PRMT      MULT 100       PRMTA
1557 C   33      PRMT      MULT 1000      PRMTA
1558 C           WWAMT     DIV  PRMTA     LXWORK 147
1559 C                     MVR            LXREM   77 66
1560 C   66      LXWORK    ADD  1         LXWORK
1561 C           LXWORK    MULT CHAM      BROKG  130
1562 C*
1563 C           FINLUX    TAG                             *** FINLUX ****
1564 C*********************MOVE BROKG     GBROK                           E12523
1565 C           ENLUX     ENDSR
1566 C*
1567 C********************************************************************
1568 C*
1569 C* SUBROUTINE TO ACCESS CURRENCY ARRAYS (BASED ON STANDARD SR CCYDEP)
1570 C*            MULT/DIV INDICATORS FOR SPOT AND FTX RATES
1571 C*            FT X RATES
1572 C*            SPOT RATES
1573 C*            DEC POINTS
1574 C*
1575 C           XCYLOK    BEGSR                           *** XCYLOK ****
1576 C                     Z-ADD1         X            99
1577 C                     MOVE XCCY      XCCY    3
1578 C                     Z-ADD0         XDECP   10
1579 C*****                Z-ADD0         XMDIN   10                      E134
1579 C                     MOVE *BLANK    XMDIN   1                       E134
1580 C*******              Z-ADD0         XMDIB   10                      LN0268
1580 C                     MOVE *BLANK    XMDIB   1                       LN0268
1581 C                     Z-ADD0         XSPOT  138
1582 C                     Z-ADD0         XHBER  138
1583 C*
1584 C           XCCY      LOKUPCYA,X                    95
1585 C  N95                GOTO FINSR
1586 C*
1587 C                     MOVE DPA,X     XDECP
1588 C                     MOVE MDS,X     XMDIN
1589 C                     MOVE MDF,X     XMDIB
1590 C                     MOVE SPT,X     XSPOT
1591 C                     MOVE FTX,X     XHBER
1592 C           FINSR     TAG                             *** FINSR ****
1593 C  N95                SETON                     4699
1594 C                     ENDSR
1595 C********************************************************************
1596 C/SPACE 3
1597 C********************************************************************
1598 C*
1599 C* SUBROUTINE TO PICK UP APPROPRIATE RATE AND CHARGE AMOUNT
1600 C*            FOR LUXEMBURG SWAP AND DEPOSITS
1601 C*               1. CONVERT PERIOD TO NO. OF DAYS
1602 C*               2. IF NO PERIOD FOUND O/P WITH ZERO BROKERAGE
1603 C*               3. ELSE PICK UP RATE AND CHARGE AMT.
1604 C*
1605 C           PERIOD    BEGSR                           *** PERIOD  ***
1606 C*
1607 C                     Z-ADD0         P       20
1608 C*
1609 C           BEGPER    TAG                             *** BEGPER  ***
1610 C           P         ADD  1         P
1611 C           PER,P     COMP ' '                      65
1612 C   65                GOTO ENPER
1613 C** CONVERT PERIOD
1614 C                     MOVELPER,P     NN      20
1615 C           NN        COMP 0                      35
1616 C   35                Z-SUBNN        NN
1617 C                     MOVE PER,P     A       1
1618 C           A         COMP 'M'                      47
1619 C           A         COMP 'Y'                      48
1620 C  N47N48             Z-ADD1         Z       30
1621 C   47                Z-ADD30        Z
1622 C   48                Z-ADD360       Z
1623 C           NN        MULT Z         CNVTER  50
1624 C*
1625 C           CNVTER    COMP TERM                   47
1626 C   47      P         COMP 12                   474765
1627 C   65                GOTO ENPER
1628 C   47                GOTO BEGPER
1629 C** PICK UP RATE / CHARGE AMOUNT
1630 C***********MTD,P*****COMP 'P'**********************66               E12891
1631 C***66****************MOVE WRA,P*****RATE*************               E12891
1632 C**N66****************MOVE WRA,P*****CHAM*************               E12891
1630 C           MTD,P     COMP 'P'                      39               E12891
1631 C   39                MOVE WRA,P     RATE    77                      E12891
1632 C  N39                MOVE WRA,P     CHAM    70                      E12891
1633 C           ENPER     ENDSR
1634 C********************************************************************
1635 C/SPACE 3
1636 C********************************************************************
1637 C* SUBROUTINE TO CALCULATE BROKERAGE ON LONDON LOANS/DEPS AND NAS.
1638 C*            OBTAIN COMMON INFORMATION:-
1639 C*                   TERM = MATURITY-VALUE DATE
1640 C*                   DIVISOR(Z) 365000 OR 300000 DEPENDING ON METHOD
1641 C*                                                OF CALCUALTION
1642 C*            CALCULATE BROKERAGE BY SR GLINTC
1643 C*
1644 C           LONCAL    BEGSR                           *** LONCAL ****
1645 C                     Z-ADDVDAT      ZIBEG
1646 C                     Z-ADDMDAT      ZIEND
1647 C   05                Z-ADDPMDT      ZIEND
1648 C                     Z-ADDICBS      ZICALC  10
1649 C                     Z-ADDWAMT      ZIAMT  150
1650 C                     Z-ADDRATE      ZIRATE 117
1651 C                     EXSR GLINTC
1652 C                     Z-ADDZINTR     BROKG     H
1653 C           ENLON     ENDSR
1654 C********************************************************************
1655 C/SPACE 3
1656 C********************************************************************
1657 C*********************                                               S01194
1658 C**SUBROUTINE*TO*OBTAIN*TABLE*RECORD**                               S01194
1659 C*********************                                               S01194
1660 C***********TABCHN****BEGSR                           *** TABCHN *** S01194
1661 C***********TABKEY****CHAINTABLE                41                   S01194
1662 C*********************ENDSR                                          S01194
1663 C********************************************************************S01194
1664 C/SPACE 3
1665 C********************************************************************066550
1666 C*****GLINTC SR. TO CALCULATE INTEREST BETWEEN ANY TWO DAY NUMBERS.  066550
1667 C***********                                                         066550
1668 C*****THIS*VERSION REPLACES THE ORIGINAL GLINTC SR. NOW NAMED        066550
1669 C*****GLINTO.                                                        066550
1670 C***********                                                         066550
1671 C*****CALCULATION METHODS ARE -                                      066550
1672 C*****1**ACTUAL/365                                                  066550
1673 C*****2**ACTUAL/360                                                  066550
1674 C*****3**360/360 (SOMETIMES CALLED 30/360)                           066550
1675 C*****4**365/365 (EXCLUDING 29/02)                                   066550
1676 C*****5**365/360 (EXCLUDING 29/02)                                   066550
1677 C*****6**ACTUAL/366                                                  066550
1678 C***********                                                         066550
1679 C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.                     066550
1680 C***********                                                         066550
1681 C***********                                                         066550
1682 C*R*********GLINTC    BEGSR                           ** GLINTC  **  066550
1683 C***********                                                         066550
1684 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                           066550
1685 C*R*********          Z-ADDZIBEG     ZIBEG   50       STARTING DATE  066550
1686 C*R*********          Z-ADDZIEND     ZIEND   50       FINISHING DATE 066550
1687 C*R*********          Z-ADDZICALC    ZICALC  10       CALC. BASIS    066550
1688 C*R*********          Z-ADDZIAMT     ZIAMT  150       PRINCIPAL      066550
1689 C*R*********          Z-ADDZIRATE    ZIRATE 117       RATE OF INTRST 066550
1690 C***********                                                         066550
1691 C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED           066550
1692 C*R*********ZIEND     SUB  ZIBEG     ZDAYN1  50                      066550
1693 C***********                                                         066550
1694 C****CHECK*FOR INTEREST CALCULATION BASIS                            066550
1695 C*****USE*OF INDICATRS                                               066550
1696 C*****1,92**2,90  3,91  4,97  5,96  6,95                             066550
1697 C***********          SETOF                     959697               066550
1698 C*R*********ZICALC    COMP 2                    919290               066550
1699 C**N91******          GOTO ZICAL                                     066550
1700 C***********ZICALC    COMP 5                    959796               066550
1701 C***97******ZICALC    COMP 3                    97  91               066550
1702 C***95******                                                         066550
1703 C*R*96******          SETOF                     91                   066550
1704 C**N91******          GOTO ZILPCK                                    066550
1705 C***********                                                         066550
1706 C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WHEN      066550
1707 C*****USING*THE 30/360 BASIS - METHOD 3.                             066550
1708 C***********          EXSR ZSAVE                                     066550
1709 C***********          Z-ADDZIBEG     ZDAYNO                          066550
1710 C***********          EXSR ZDATE2                                    066550
1711 C***********          MOVE ZDAY      ZISD    20                      066550
1712 C***********          MOVE ZMTH      ZISM    20                      066550
1713 C***********          MOVE ZYEAR     ZISY    20                      066550
1714 C***********          Z-ADDZIEND     ZDAYNO                          066550
1715 C***********          EXSR ZDATE2                                    066550
1716 C***********          MOVE ZDAY      ZIFD    20                      066550
1717 C***********          MOVE ZMTH      ZIFM    20                      066550
1718 C***********          MOVE ZYEAR     ZIFY    20                      066550
1719 C***********          EXSR ZRSTOR                                    066550
1720 C***********          SETOF                     93                   066550
0    C****IN*ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEAR IF  066550
     C****ZIEND*IS GREATER THAN ZIBEG,THEN THE DATE ZIEND MUST BE IN A    066550
     C****DIFFERENT CENTURY TO ZIBEG.IF SO ADD 100 YEARS TO IT.           066550
     C***********ZIEND     COMP ZIBEG                93                   066550
     C***93******ZIFY      COMP ZISY                   93                 066550
     C***********          Z-ADDZISY      ZISY2   30                      066550
     C**N93******          Z-ADDZIFY      ZIFY2   30                      066550
     C***93******ZIFY      ADD  100       ZIFY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*START*YEAR*IS*A*LEAP*YEAR*AND*IF*START*S01147066550
     C*****MONTH*IS*FEBRUARY.***************************************S01147066550
     C***********                                                   S01147066550
     C**N98******          BITOF'0'       ZGLBIT  1           E80945S01147066550
     C***98******          BITON'0'       ZGLBIT              E80945S01147066550
     C***********ZISY2     ADD  1900      ZLYCHK  40                S01147066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01147066550
     C***********          MVR            ZLYREM  20               S01147 066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YES01147 066550
     C***********ZISM      COMP 2                        99*FEBRUARS01147 066550
2209 C**N99******30        SUB  ZISD      ZID1    50   93          S01147 066550
2210 C**N99*93***          Z-ADD0         ZID1                     S01147 066550
     C***99N98***28        SUB  ZISD      ZID1                     S01147 066550
     C***99*98***29        SUB  ZISD      ZID1                     S01147 066550
2209 C***********30        SUB  ZISD      ZID1    50   93          S01147 066550
2210 C***93******          Z-ADD0         ZID1                     S01147 066550
2211 C***********ZISM      COMP 12                       93               066550
2212 C***93******          Z-ADD0         ZISM                            066550
2213 C***93******ZISY      ADD  1         ZISY                            066550
     C***93******ZISY2     ADD  1         ZISY2                           066550
     C***********                                                         066550
     C*****DETERMINE*WHETHER*END*YEAR*IS*A*LEAP*YEAR*AND*IF*END*MO**S01147066550
     C*****IS*FEBRUARY.*********************************************S01147066550
     C***********                                                  S01147 066550
     C***********ZIFY2     ADD  1900      ZLYCHK  40               S01147 066550
     C***********ZLYCHK    DIV  4         ZLYCHK                   S01147 066550
     C***********          MVR            ZLYREM  20               S01147 066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YES01147 066550
     C***********ZIFM      COMP 2                        99*FEBRUARS01147 066550
2214 C**N99******ZIFD      COMP 31                       93        S01147 066550
2214 C***99N98***ZIFD      COMP 28                       93        S01147 066550
2214 C***99*98***ZIFD      COMP 29                       93        S01147 066550
     C***********          SETOF                     98      E80945S01147 066550
     C***********          TESTB'0'       ZGLBIT         98  E80945S01147 066550
2214 C***********ZIFD      COMP 31                       93        S01147 066550
1727 C***93******ZID1      ADD  30        ZID1                            066550
1728 C**N93******ZID1      ADD  ZIFD      ZID1                            066550
1729 C***********ZIFM      SUB  1         ZIFM                            066550
     C***********ZISY      COMP ZIFY                     93               066550
1731 C***93******ZIFM      SUB  ZISM      ZINOM   30                      066550
1732 C***93******          GOTO ZIOUT                                     066550
1733 C***********12        SUB  ZISM      ZIM1    20                      066550
1734 C***********          Z-ADD1         ZISM                            066550
     C*****USE*ENLARGED FIELDS THAT CAN HANDLE 1999 ONWARDS               066550
     C***********ZISY2     ADD  1         ZISY2                           066550
     C***********ZIFY2     SUB  ZISY2     ZIY1    20                      066550
1737 C***********ZIY1      MULT 12        ZIM2    30                      066550
1738 C***********ZIM2      ADD  ZIFM      ZIM2                            066550
1739 C***********ZIM1      ADD  ZIM2      ZINOM                           066550
1740 C***********ZIOUT     TAG                             * ZIOUT TAG *  066550
1741 C***********ZINOM     MULT 30        ZID2    50                      066550
1742 C***********ZID2      ADD  ZID1      ZDAYN1                          066550
1743 C***********          SETOF                     93                   066550
1744 C***********ZILPCK    TAG                             * ZILPCK TAG * 066550
1745 C**N96N97***          GOTO ZICAL                                     066550
1746 C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.         066550
1747 C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB   066550
1748 C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, & ZIEND.066550
1749 C***********                                                         066550
1750 C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                        066550
1751 C***********ZDAYN1    DIV  1461      ZIMAN   20                      066550
1752 C***********          MVR            ZIREM   50                      066550
1753 C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.                    066550
1754 C***********ZIBEG     SUB  60        ZIBW1   50                      066550
1755 C***********ZIBW1     DIV  1461      ZIDW1   20                      066550
1756 C***********          MVR            ZIDREM  50                      066550
1757 C***********ZIDREM    COMP 0                        94               066550
1758 C***94******          Z-ADDZIBEG     ZIDW2   50                      066550
1759 C***94******          GOTO ZILP1                                     066550
1760 C*****ROUND*UP RESULT                                                066550
1761 C***********ZIDW1     ADD  1         ZIDW2                           066550
1762 C*****CALCULATE NEXT 29 FEB.                                         066550
1763 C***********ZIDW2     MULT 1461      ZIDW2                           066550
1764 C***********ZIDW2     ADD  60        ZIDW2                           066550
1765 C***********ZILP1     TAG                             * ZILP1 TAG *  066550
1766 C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO        066550
1767 C*****ZIREM*THEN ADD 1 TO ZIMAN.                                     066550
1768 C***********ZIDW2     SUB  ZIBEG     ZILPCP  50                      066550
1769 C***********ZIREM     COMP ZILPCP               94  94               066550
1770 C***94******ZIMAN     ADD  1         ZIMAN                           066550
1771 C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1             066550
1772 C*****REQUIRED FOR THIS INTEREST CALCULATION.                        066550
1773 C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                          066550
1774 C***********          SETOF                     94                   066550
1775 C***********ZICAL     TAG                             * ZICAL TAG *  066550
1776 C***********                                                         066550
1777 C****CALCULATE INTEREST                                              066550
1778 C***90******                                                         066550
1779 C*R*91******                                                         066550
1780 C*R*96******ZIAMT     DIV  36000     ZIWRK1 155H                     066550
1781 C***92******                                                         066550
1782 C*R*97******ZIAMT     DIV  36500     ZIWRK1    H                     066550
1783 C***95******ZIAMT     DIV  36600     ZIWRK1    H                     066550
1784 C*R*********ZIWRK1    MULT ZIRATE    ZIWRK2 155H                     066550
1785 C*R*********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF INTRST 066550
1786 C***********                                                         066550
1787 C***********          SETOF                     909192               066550
1788 C***********          SETOF                     959697               066550
1789 C*R*********          ENDSR                                          066550
1790 C********************************************************************066550
1791 C/SPACE 3
1792 C********************************************************************
1793 C**
1794 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
1795 C**
1796 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
1797 C**
1798 C           ZDATE2    BEGSR                           *** ZDATE2 ***
1799 C**
1800 C**   CLEAR DATE FIELDS.
1801 C                     Z-ADD0         ZDATE   60
1802 C                     MOVEL'       ' ZADATE  7
1803 C**
1804 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
1805 C                     Z-ADDZDAYNO    ZDAYNO  50
1806 C**
1807 C**   DETERMINE YEAR NUMBER.
1808 C**
1809 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
1810 C           ZDAYNO    SUB  1         ZDAYN1  50   99
1811 C   99                GOTO ZDEND2
1812 C**
1813 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
1814 C           ZDAYN1    DIV  1461      ZLYR    20
1815 C                     MVR            ZDAYN1           SAVE REMAINING
1816 C**                                                   DAYS
1817 C**   CALCULATE NUMBER OF REMAINING YEARS.
1818 C                     Z-ADD1         ZWRK2   20
1819 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
1820 C           ZDAYN1    COMP ZYDY,ZWRK2             90
1821 C  N90      ZWRK2     ADD  1         ZWRK2
1822 C  N90                GOTO ZDTAG1
1823 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
1824 C**
1825 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
1826 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
1827 C**
1828 C**   CALCULATE ACTUAL YEAR NUMBER.
1829 C           ZLYR      MULT 4         ZWRK3   30
1830 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
1831 C                     Z-ADDZWRK3     ZYEAR   20
1832 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
1833 C**
1834 C**   DETERMINE MONTH NUMBER.
1835 C**
1836 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
1837 C                     SETOF                     9293
1838 C   91      ZDAYN1    COMP 59                     9293
1839 C   91N92   ZDAYN1    SUB  1         ZDAYN1
1840 C**
1841 C**   CALCULATE MONTH NUMBER.
1842 C                     Z-ADD2         ZWRK2
1843 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
1844 C           ZDAYN1    COMP ZMDY,ZWRK2             94
1845 C  N94      ZWRK2     ADD  1         ZWRK2
1846 C  N94                GOTO ZDTAG2
1847 C           ZWRK2     SUB  1         ZWRK2
1848 C**
1849 C                     Z-ADDZWRK2     ZMTH    20       MONTH
1850 C**
1851 C**   DETERMINE DAY OF MONTH.
1852 C**
1853 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
1854 C           ZDAYN1    ADD  1         ZDAYN1
1855 C**
1856 C**   CALCULATE DAY OF MONTH.
1857 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
1858 C**
1859 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
1860 C   93      ZDAY      ADD  1         ZDAY
1861 C**
1862 C**   FORMAT DATE, DDMMYY OR MMDDYY.
1863 C  N98                MOVELZDAY      ZWRK4   40
1864 C   98                MOVE ZDAY      ZWRK4
1865 C  N98                MOVE ZMTH      ZWRK4
1866 C   98                MOVELZMTH      ZWRK4
1867 C                     MOVELZWRK4     ZDATE
1868 C                     MOVE ZYEAR     ZDATE
1869 C**
1870 C**   FORMAT ALPHA DATE, DDMMMYY.
1871 C           ZDAY      COMP 10                     95
1872 C                     MOVELZDAY      ZWRK5   5
1873 C   95                MOVEL' '       ZWRK5
1874 C                     MOVE ZMNM,ZMTH ZWRK5
1875 C                     MOVELZWRK5     ZADATE
1876 C                     MOVE ZYEAR     ZADATE
1877 C**
1878 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
1879 C**
1880 C**
1881 C********************************************************************
1882 C/SPACE 3
1883 C********************************************************************
1884 C*
1885 C* SUBROUTINE TO SET UP FOLLOWING ARRAYS FROM CURRENCY RECORDS
1886 C*            (BASED ON STANDARD SR CCYARR)
1887 C*            -CURRENCY CODE
1888 C*            -SPOT RATE
1889 C*            - MULT/DIV IND(SPOT)
1890 C*            -FTX RATE
1891 C*            -MULT/DIV IND(FTX)
1892 C*
1893 C           XCYARR    BEGSR                           *** XCYARR ****
1894 C                     Z-ADD0         X       30 99
1895 C*********************MOVEL'20      'XCYKEY 12                       S01194
1896 C*********************MOVE '    '    XCYKEY                          S01194
1897 C*********************                                               S01194
1898 C**SET*LOWER*LIMIT*AND*READ*CURRENCY*TABLE**                         S01194
1899 C*********************                                               S01194
1900 C***********XCYKEY****SETLLTABLED                                    S01194
1897 C*                                                                   S01194
1898 C* SET LOWER LIMIT AND READ CURRENCY FILE                            S01194
1900 C           *LOVAL    SETLLSDCURRL1                                  S01194
1897 C*                                                                   S01194
1902 C* LOOP TO READ CURRENCY RECORDS
1903 C*
1904 C           XLOOP     TAG                             **** XLOOP ****
1905 C                     SETOF                     99
1906 C*********************READ TABLED                   99               S01194
1907 C**N99******RECTX*****COMP 20                   9999                 S01194
1906 C                     READ SDCURRL1                 99               S01194
1908 C   99                GOTO XEND
1909 C*
1910 C**CURRENCY*RECORD*1**                                               S01194
1911 C*********************                                               S01194
1912 C***********RECIX*****COMP 'D'                  9797                 S01194
1913 C***97****************GOTO XLOOP                                     S01194
1914 C*
1915 C           X         ADD  1         X
1916 C*********************MOVE CCYX      CYA,X                           S01194
1917 C*********************MOVE MDINX     MDS,X                           S01194
1918 C*********************MOVE MDIBX     MDF,X                           S01194
1919 C*********************MOVE SPOTX     SPT,X                           S01194
1920 C*********************MOVE CDPX      DPA,X                           S01194
1916 C                     MOVE A6CYCD    CYA,X                           S01194
1917 C                     MOVE A6MDIN    MDS,X                           S01194
1918 C                     MOVE A6MDHB    MDF,X                           S01194
1919 C                     MOVE A6SPRT    SPT,X                           S01194
1920 C                     MOVE A6NBDP    DPA,X                           S01194
1920 C                     MOVE A6HBRT    FTX,X                           S01194
1921 C*
1922 C**CURRENCY*RECORD*2**                                               S01194
1923 C*********************                                               S01194
1924 C*********************READ TABLED                   99               S01194
1925 C*********************MOVE HBERX     FTX,X                           S01194
1926 C           X         COMP 150                      96
1927 C  N96                GOTO XLOOP
1928 C           XEND      TAG                             ***** XEND ****
1929 C*
1930 C                     ENDSR
1931 C********************************************************************
1932 C/SPACE 3
1933 C********************************************************************
1934 C*********************                                               S01194
1935 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.** S01194
1936 C*********************                                               S01194
1937 C***********ZSYSTM****BEGSR                           *** ZSYSTM *** S01194
1938 C*********************                                               S01194
1939 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.**                  S01194
1940 C*********************MOVEL'01      'ZTABKY 12                       S01194
1941 C*********************MOVE '  10'    ZTABKY                          S01194
1942 C*********************                                               S01194
1943 C***********ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
1944 C**N99******RECI******COMP 'D'                  9999  ON, IS DELETED S01194
1945 C*********************                                               S01194
1946 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.*                   S01194
1947 C***********DATF******COMP 'M'                      98MMDDYY, 98 ON  S01194
1948 C*********************                                               S01194
1949 C*********************ENDSR                                          S01194
1950 C*********************                                               S01194
1951 C*********************                                               S01194
1952 C********************************************************************S01194
1953 C/SPACE 3
1954 C********************************************************************
1955 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
1956 C*   IND '99' IS SET BY AN OVERFLOW ERROR
1957 C*
1958 CSR         GLZADD    BEGSR                           *** GLZADD ****
1959 C*
1960 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
1961 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
1962 C*
1963 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
1964 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
1965 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
1966 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
1967 C*
1968 CSR                   EXSR GLZSUM
1969 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
1970 C*
1971 C********************************************************************
1972 C/SPACE 3
1973 C********************************************************************
1974 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
1975 C*                        GLZADD, GLZSUB, GLZCMP.
1976 C*          PARAMETERS PASSED -
1977 C*                     I/P ZZAMTI ZZAMTD
1978 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
1979 C*
1980 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
1981 C*
1982 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
1983 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
1984 CSR                   SETOF                     919293
1985 CSR                   SETOF                     949599
1986 C*
1987 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
1988 CSR         ZZAMTI    COMP 0                      9293
1989 CSR 93      ZZAMTD    COMP 0                      9293
1990 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1991 C*
1992 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
1993 CSR         ZZTOTI    COMP 0                      9193
1994 CSR 93      ZZTOTD    COMP 0                      9193
1995 C*
1996 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
1997 CSR 93                Z-ADDZZAMTI    ZZTOTI
1998 CSR 93                Z-ADDZZAMTD    ZZTOTD
1999 CSR 93                GOTO ZZSEND                     ZERO BYPASS
2000 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
2001 CSR 91N92
2002 CORN91 92             GOTO ZZOFPS
2003 C*
2004 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
2005 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
2006 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
2007 C*
2008 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
2009 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
2010 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
2011 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
2012 C*
2013 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
2014 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
2015 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
2016 CSRN99                Z-ADDZZWK2     ZZTOTD
2017 CSRN99                Z-ADDZZWK3     ZZTOTI
2018 C*
2019 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
2020 CSR 99                Z-ADD0         ZZAMT  153
2021 CSR                   GOTO ZZSEND
2022 C*
2023 C* THE 'SIGNS' ARE DIFFERENT
2024 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
2025 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
2026 C*
2027 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
2028 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
2029 C*
2030 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
2031 C*
2032 CSR 91                Z-SUBZZTOTI    ZZTOTI
2033 CSR 91                Z-SUBZZTOTD    ZZTOTD
2034 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
2035 C*
2036 CSR         ZZTOTI    COMP ZZAMTI               93  95
2037 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
2038 C*
2039 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
2040 CSR 95                Z-ADD0         ZZTOTI
2041 CSR 95                Z-ADD0         ZZTOTD
2042 CSR 95                GOTO ZZSEND
2043 C*
2044 C* IF ZZTOT GT. ZZAMT.
2045 CSR 93      ZZAMTD    COMP ZZTOTD               94
2046 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
2047 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
2048 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
2049 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
2050 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
2051 C*
2052 C*
2053 C* IF ZZAMT GT. ZZTOT.
2054 CSRN93      ZZTOTD    COMP ZZAMTD               94
2055 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
2056 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
2057 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
2058 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
2059 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
2060 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
2061 C*
2062 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
2063 CSR                   SETOF                     94
2064 CSR 93 91
2065 CORN93 92             SETON                     94
2066 CSR 94                Z-SUBZZTOTI    ZZTOTI
2067 CSR 94                Z-SUBZZTOTD    ZZTOTD
2068 C**
2069 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
2070 CSR 92                Z-SUBZZAMTI    ZZAMTI
2071 CSR 92                Z-SUBZZAMTD    ZZAMTD
2072 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
2073 C**
2074 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
2075 CSR                   SETOF                     96
2076 CSR         ZZTOTD    COMP 0                        91
2077 CSR 91      ZZTOTI    COMP 0                      96
2078 CSR 96                MOVE '.000-'   ZZNEGD  5
2079 CSR                   ENDSR                             ** ENDSR **
2080 C********************************************************************
2081 C********************************************************************
2082 C**
2083 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS
2084 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.
2085 C**
2086 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS
2087 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.
2088 C**
2089 C           ZSAVE     BEGSR                           *** ZSAVE ***
2090 C**
2091 C                     BITOF'01234567'ZBITS   1
2092 C   90                BITON'0'       ZBITS
2093 C   91                BITON'1'       ZBITS
2094 C   92                BITON'2'       ZBITS
2095 C   93                BITON'3'       ZBITS
2096 C   94                BITON'4'       ZBITS
2097 C   95                BITON'5'       ZBITS
2098 C   96                BITON'6'       ZBITS
2099 C   97                BITON'7'       ZBITS
2100 C**
2101 C                     SETOF                     909192
2102 C                     SETOF                     939495
2103 C                     SETOF                     9697
2104 C**
2105 C                     ENDSR
2106 C**
2107 C**
2108 C********************************************************************
2109 C**
2110 C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS
2111 C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.
2112 C**
2113 C           ZRSTOR    BEGSR                           *** ZRSTOR ***
2114 C**
2115 C                     TESTB'0'       ZBITS          90
2116 C                     TESTB'1'       ZBITS          91
2117 C                     TESTB'2'       ZBITS          92
2118 C                     TESTB'3'       ZBITS          93
2119 C                     TESTB'4'       ZBITS          94
2120 C                     TESTB'5'       ZBITS          95
2121 C                     TESTB'6'       ZBITS          96
2122 C                     TESTB'7'       ZBITS          97
2123 C**
2124 C                     ENDSR
2125 C**
2126 C**
2127 C********************************************************************
2128 C/SPACE 3
2129 C/SPACE 3
2130 C********************************************************************
2131 C*    SR.HASH TO CALCULATE HASH TOTALS
2132 C           HASH      BEGSR                           *** HASH ***
2133 C           ZZAMT     COMP 0                      41
2134 C   41                Z-SUBZZAMT     ZZAMT
2135 C                     Z-ADDINT,X     ZZTOTI
2136 C                     Z-ADDDEC,X     ZZTOTD
2137 C                     EXSR GLZADD
2138 C                     Z-ADDZZTOTI    INT,X
2139 C                     Z-ADDZZTOTD    DEC,X
2140 C           REC,X     ADD  1         REC,X
2141 C                     ENDSR
2142 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
     C/COPY WNCPYSRC,DL1200C002
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
2143 O*
2144 O*    UPDATE LAST BROK DATE ON DEALS FILE HEADER WITH RUN DATE
2145 ODEALRD  T        LR U1NU7
2146 O       AND      NU8
2147 O*************************RUND      52P                              S01194
2147 O                         BJRDNB    52P                              S01194
2148 O*
2149 O* BROKX - HEADER RECORD
2150 O*
2151 OBROKXHH H        01
2152 O                                    1 'A'
2153 O* BROKX - DETAIL RECORD
2154 OBROKXBD D        89
2155 O                                    1 'D'
2156 O                         BRKC       5
2157 O                 02                 6 '1'
2158 O                 03                 6 '2'
2159 O                 04                 6 '3'
2160 O                 05                 6 '3'
     O                 21                 6 '4'                           S01119
2161 O                         DLNO      12
2162 O                         DDAT      15P
2163 O                         VDAT      18P
2164 O                N02      MDAT      21P
2165 O                    02N22OTDT      21P
2166 O                    02 22ZERO5     21P
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL1200OOP1                                           S01408
     O*                                                                   S01408
     O                    02 22OTDT      21P                                                  CDL099
     O                 02 71 22UENDDT    21P                                                  CDL099
      *                                                                                       CDL099
2167 O                       05PMDT      21P
2168 O*************************CRNM      41                               S01194
2168 O                         BBCRNM    41                               S01194
2169 O                 02      PUCY      44
2170 O****************N02******CCY*******44***********************        S01119
2170 O                N02N21   CCY       44                               S01119
     O                 21      UCUCY     44                               S01119
2171 O                 02      PUAM      51P
2172 O                 03      PCPL      51P
2173 O****************N02N03***FVAL******51P*********************         S01119
2173 O                N02N03N21FVAL      51P                              S01119
     O                 21      UPAMT     51P                              S01119
2174 O                 02      SLCY      54
2175 O                N02                54 '   '
2176 O                 02      SLAM      61P
2177 O                      N02ZERO13    61P
2178 O                         GBROK  B  68P
2179 O                         CCYBR  B  71
2182 O                                   72 '0'
2183 O                 50                72 '1'
2184 O                 53                72 '2'
2185 O                 59                72 '3'
2186 O                 56 52 02          72 '4'
2187 O                         BROKG  B  79P
2188 O                         DTYP      84
2189 O***********              BRCD      82                               S01117
2189 O                         BRCA      82                               S01117
2189 O                         BSDT2     99P                                                  CDL099
2190 O* BROKR - TRAILER RECORD
2191 OBROKXTT T        LRNU8NU7
2192 O                                    1 'T'
2193 O                         REC,2      6
2194 O                         INT,2     14P
2195 O                         DEC,2     16P
2196 O*
2197 O*
2198 O*  FILE CONTROL REPORT
2199 O*
2200 O*PRINT  T  203   LR                                                 S01124
2200 O*L1200P1T  203   LR                                           S01124S01117
2200 O***DL1200AUT**203***LR*************                          S01117 062735
2200 ODL1200AUD  203   LR U7                                              062735
2201 O***********************************22 'REFERENCE DL1200'            S01117
2201 O                                   24 'REFERENCE DL1200AU'          S01117
2202 O*************************TITL      89                               S01194
2202 O                         BJURPT    89                               S01194
2203 O                                  122 'DATE              PAGE'
2204 O*************************RUNA     112                               S01194
2204 O                         BJMRDT   112                               S01194
2205 O                         PAGE     127
2206 O*
2207 O********T**1*****LR****************                                 062735
2208 O****************NU1****************53 'INTERIM'                     062735
2207 O        D  1     LR U7                                              062735
2208 O                NU1 U7             53 'INTERIM'                     062735
2209 O                                   71 'BROKERAGE EXTRACT'
2210 O*
2211 O********T**3*****LR****************                                 062735
2211 O        T  3     LR U7                                              062735
2212 O                NU1                53 '*******'
2213 O                                   71 '-----------------'
2214 O********T**120***LR****************                                 062735
2215 O***********************************33 'S/DEALS  -  RUN CONTROLS'    062735
2216 O***********************************72 'ON FILE'                     062735
2217 O**********************************102 'IN PROGRAM'                  062735
2218 O********T**2*****LR****************                                 062735
2219 O***********************************33 '-------     ------------'    062735
2220 O***********************************72 '-------'                     062735
2221 O**********************************102 '----------'                  062735
2222 O********T**2*****LR****************                                 062735
2223 O***********************************42 'TOTAL RECORDS ON FILE'       062735
2224 O*************************NORE**3***72                               062735
2225 O*************************REC,3*3**102                               062735
2226 O***********************41*********129 '***   DIFFERENCE   ***'      062735
2227 O********T**2*****LR****************                                 062735
2228 O***********************************43 'DETAIL RECORDS ON FILE'      062735
2229 O*************************NLRA**3***72                               062735
2230 O*************************REC,1*3**102                               062735
2231 O***********************42*********129 '***   DIFFERENCE   ***'      062735
2232 O********T**3*****LR****************                                 062735
2233 O***********************************40 'DETAIL RECORDS HASH'         062735
2234 O***********************************46 'TOTAL'                       062735
2235 O*************************VLAF**Z***69                               062735
2236 O*************************VLAL******72                               062735
2237 O*************************INT,1*Z***99                               062735
2238 O*************************DEC,1****102                               062735
2239 O***********************43*********129 '***   DIFFERENCE   ***'      062735
2240 O********T*31*****LR****************                                 062735
2241 O***********************************33 'S/BROKX  -  RUN CONTROLS'    062735
2242 O**********************************102 'FILE CREATE'                 062735
2243 O********T**2*****LR****************                                 062735
2244 O***********************************33 '-------     ------------'    062735
2245 O**********************************102 '-----------'                 062735
2246 O********T**2*****LR****************                                 062735
2247 O***********************************43 'DETAIL RECORDS ON FILE'      062735
2248 O*************************REC,2*3**102                               062735
2249 O********T**3*****LR****************                                 062735
2250 O***********************************40 'DETAIL RECORDS HASH'         062735
2251 O***********************************46 'TOTAL'                       062735
2252 O*************************INT,2*Z***99                               062735
2253 O*************************DEC,2****102                               062735
2254 O*
2255 O********T 33     LR U7
2256 O********                 ERROR     40
2257 O********                           71 '*** DATABASE ERROR ***'
     O        T 3      LR U7                                              S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7                                              S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    76                               S01117
     O        T 13     LR U7                                              S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     57                               S01117
2258 O*
2259 O********T 3   60 LR                                                 LN0363
2260 O********                           71 '*** END OF REPORT***'        LN0363
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**       FX PERIODS IN DAYS
0000700181001840036500366007300073199999
**       ZYDY YEARS IN DAYS CUMULATIVE 4 YEARS
0366073110961461
**       ZMDY MONTHS IN DAYS CUMULATIVE 1 YEAR
000031059090120151181212243273304334365
**       ZMNN MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** DT
00001000020000300004000050000600007
** POW
1000000        PREVIOUSLY   0010000
0100000
0010000        PREVIOUSLY   1000000
0001000
0000100
0000010
0000001
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
