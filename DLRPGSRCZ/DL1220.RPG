0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Brokerage Report')                            *
0002 F********************************************************************
0004 F*                                                                  *
     F*  Midas - Dealing Module
0004 F*                                                                  *
0005 F*      DL1220 - BROKERAGE REPORT                                   *
0006 F*               AMENDED FOR LUXEMBOURG BASIC SYSTEM.               *
0007 F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0009 F*                                                                  *
      *  Last Amend No. CDL099             Date 06Oct17               *
      *  Prev Amend No. CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG8001            Date 08Jul05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01408             Date 22May96               *
      *                 E22731             Date 22Jul90               *
     F*                      LN0422           DATE  22JUN90              *
     F*                      E17069           DATE  18APR90              *
     F*                      E297             DATE  23MAR90              *
0009 F*                      S01194           DATE  10/10/89             *
0010 F*                      S01117           DATE  10/10/89             *
0009 F*                      S01119           DATE  17/06/87             *
0010 F*                      E43508           DATE  23/10/86             *
0010 F*                      S01124           DATE  00/00/00             *
     F*                                                                  *
0012 F********************************************************************
0010 F*                                                                  *
      *  CDL099 - Split Value Date                                    *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (recompiled)                                           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG8001 - DLC1301 FOOB                                       *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*     S01408 - Core hook DL1220FFP1 added.
     F*              Core hook DL1220IIP1 added.
     F*              Core hook DL1220CCP1 added.
     F*              Core hook DL1220CCP2 added.
     F*              Core hook DL1220OOP1 added.
     F*      E22731  -  IF MORE THAN 200 RECORDS ON BROKER FILE, PGM     *
     F*                 HALTS WITH AN ARRAY INDEX ERROR. EXTEND ARRAY    *
     F*                 SIZE TO THE MAXIMUM INDEX WILL ALLOW - 999.      *
     F*     LN0422 - RECOMPILED BECAUSE OF FORMAT CHANGES TO SDBROKL1    *LN0422
     F*     E17069 - IF MORE THAN 100 RECORDS ON BROKER FILE, PGM        *E17069
     F*              HALTS WITH AN ARRAY INDEX ERROR.                    *E17069
     F*     E297   - 'AU' SHOULD NOT THROW A PAGE BEFORE WRITING 'NO DET'*
     F*     S01117 - MULTI-BRANCHING CHANGES                             *S01117
     F*     S01194 - NEW STANDING DATA CHANGES                           *S01194
0010 F*     E43508 -  PREVIOUS FIX AMENDED TO ACCOUNT FOR FX DEALS       *
0010 F*               REQUIRING 2 LINES ON REPORT.                       *
0010 F*               N.B. THIS IS A R11 FIX TRANSFERRED TO R21          *
0010 F*                                                                  *
0012 F********************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 FBROKG   IP  E           K        DISK
0016 FSDCURRL0IF  E           K        DISK                               S01117
0016 FSDBROKL1IF  E           K        DISK                               S01117
0014 F***TABLE   IF  F      96 12AI     2 DISK                            S01194
0015 F***TABD    IF  F      96 12AI     2 DISK                            S01194
0016 F*PRINT  O   F     132     OF     PRINTER                            S01124
0016 F***DL1220P1O   F     132     OF     PRINTER                         S01124
0016 FDL1220P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01124
0016 FDL1220AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01124
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL1220FFP1                                           S01408
     F*                                                                   S01408
0017 F********************************************************************
0018 F***               USE OF INDICATORS                              ***
0019 F********************************************************************
0020 F* 01            BROKERAGE FILE HEADER
0021 F* 02                           DETAIL
0022 F* 03                           TRAILER
0023 F* 04                           CATCHALL
0024 F**05***         TABLE FILE ICD1                                     S01194
0025 F**06***                    BRANCH CODES RECORD                      S01194
0026 F**07***                    CATCHALL                                 S01194
0027 F**08***         TABD FILE - CURRENCIES RECORD 1                     S01194
0028 F**09***                     BROKER DETAILS RECORD                   S01194
0029 F**10***                     CATCHALL                                S01194
0030 F*       40      FIRST CYCLE INDICATOR
0031 F*       41      INVALID RECORD READ
0032 F*       42
0033 F*       43      LOKUP BROKER CODE SUCCESSFUL
0034 F*       44      DEAL TYPE - FX
0035 F*       45                - DEPOSIT
0036 F*       46                - N.A.
     F*       56                - FRA/IRS                                 S01119
0037 F**      48      PCCY - USD
0038 F**      49      CCCY - USD
     F*       48      EXCPT OUTPUT - NO TRANSACTIONS THIS PERIOD
     F*       49      EXCPT OUTPUT - TOTALS FOR PREVIOUS BROKER
     F*
     F*       50      TRIGGER *IN TO CONDTN EXCPT -TOTALS FOR PREV BROKR
     F*
0039 F****    51      BROKERAGE AMOUNT - 0
0040 F*       51      BROKERAGE AMOUNT > 0
0041 F*       52      NARRATIVE REFERENCE - RATE NOT ON FILE
0042 F*       53                          - OPTION DEAL
0043 F*       54                          - CALL/NOTICE DEAL
     F*       56      SEE ABOVE                                           S01119
0044 F*       60      CURRENCY DECIMAL PLACES
0045 F*       61
0046 F*       62
0047 F*       63
0048 F*       70      RECORD COUNT DIFFERENCES
0049 F*       71      HASH TOTAL DIFFERENCE
 052 F*       72      BROKER CODE DELEATED BUT TRANSACTIONS STILL EXIST
0050 F*       80      CURRENCY DECIMAL PLACES
0051 F*       81
0052 F*       82
0053 F*       83
0054 F*       84
0055 F*       85
0056 F*       86
0057 F*       87
0058 F*       89      ARRAY ERROR
0059 F*       99      DATABASE ERROR
0060 F*             L1 PCCY - PRIME CURRENCY
0061 F*             L2 STYP - DEAL TYPE
0062 F*             L3 BROK - BROKER CODE
0063 F*             L4 BRCA - BRANCH CODE                                 S01117
     E                    CPY@    1   1 80
0064 E                    CCYA      150  3               CCY CODE
0065 E                    CDPA      150  1 0             CCY DEC. PLACES
0066 E****************    BRKA      100  4               BROKER CODE      E17069
0067 E****************    BKNA      100 30               BROKER NAME      E17069
0068 *****************    BKTA      100 10               BROKER TOWN      E17069
0066 E**********          BRKA      200  4               BROKER CODEE17069E22731
0067 E**********          BKNA      200 30               BROKER NAMEE17069E22731
0068 E**********          BKTA      200 10               BROKER TOWNE17069E22731
0066 E                    BRKA      999  4               BROKER CODE      E22731
0067 E                    BKNA      999 30               BROKER NAME      E22731
0068 E                    BKTA      999 10               BROKER TOWN      E22731
0069 E                    ZYDY    4   4  4 0             ZDATE2 SR.ARRAY
0070 E                    ZMDY   13  13  3 0             ZDATE2 SR.ARRAY
0071 E                    ZMNM   12  12  3               ZDATE2 SR.ARRAY
0072 I********************************************************************
0073 I*
0074 I*    BROKERAGE FILE - HEADER RECORD.
0075 IBROKXHHF    01
0073 I*
0077 I*    BROKERAGE FILE - DETAIL RECORD.
0078 IBROKXBDF    02
0080 I                                              BROK  L3
0081 I              DLTP                            STYP  L2
0092 I                                              BRCY  L1
0095 I*****                                         BRCD  L4              S01117
0095 I                                              BRCA  L4              S01117
0097 I*    BROKERAGE FILE - TRAILER RECORD.
0098 IBROKXTTF    03
0103 I*
0105 I****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1                 S01194
0106 I****TABLE   NS  05   2 C0   3 C1  12 C1                             S01194
0107 I****   AND      13 C0                                               S01194
0108 I****                                    1   1 RECI                  S01194
0109 I****                                    2   30RECT                  S01194
0110 I****                                   12  130RCDE                  S01194
0111 I****                                   14  66 TITL                  S01194
0112 I****                                   67  67 DATF                  S01194
0113 I****                                   68  700DFBR                  S01194
0114 I****                                   74  74 MODI1                 S01194
0115 I****                                   75  75 MODI2                 S01194
0116 I****                                   76  76 MODI3                 S01194
0117 I****                                P  77  790RUND                  S01194
0118 I****                                   80  86 RUNA                  S01194
0119 I****                                   87  870SFLG                  S01194
0120 I****                                P  90  920LCD                   S01194
0121 I****                                   93  93 CHTP                  S01194
0122 I****                                P  94  960TNLU                  S01194
0123 I****                                                                S01194
0124 I****                                                                S01194
0125 I**** TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0126 I****                                                                S01194
0127 I****TABLE   NS  11   1 CD   2 C0   3 C1                             S01194
0128 I****   AND      12 C1  13 C1                                        S01194
0129 I****                                   47  49 LOCY                  S01194
0130 I****                                                                S01194
0131 I****TABLE FILE - BRANCH CODES RECORD                                S01194
0132 I*****TABLE   NS  06   1 CD   2 C1   3 C0                            S01194
0133 I*****                                   1   1 RECI                  S01194
0134 I****                                    2   30RECT                  S01194
0135 I****                                   11  130BRCD                  S01194
0136 I****                                   14  43 BRNM                  S01194
0137 I****                                   44  490BICN                  S01194
0138 I****                                   50  51 LOCC                  S01194
0139 I****                                   52  53 CMPY                  S01194
0140 I****                                P  90  920LCD                   S01194
0141 I****                                   93  93 CHTP                  S01194
0142 I****                                P  94  960TNLU                  S01194
0143 I*****                                                               S01194
0144 I**TABLE FILE - CATCHALL                                             S01194
0145 I*****   NS  07                                                      S01194
0146 I*****                                                               S01194
0147 I**TABD (CURRENCIES RECORD 1)                                        S01194
0148 I****TABD    NS  08   1 CD   2 C2   3 C0                             S01194
0149 I****   AND      13 C1                                               S01194
0150 I****                                    1   1 RECI                  S01194
0151 I****                                    2   30RECT                  S01194
0152 I****                                   10  12 CCY                   S01194
0153 I****                                   13  130SREC                  S01194
0154 I****                                   14  27 CCNM                  S01194
0155 I****                                P  28  348SPOT                  S01194
0156 I****                                   35  37 CCYS                  S01194
0157 I****                                   38  380CDP                   S01194
0158 I****                                   39  390TNOT                  S01194
0159 I****                                   40  40 DCCY                  S01194
0160 I****                                   41  44 SRC1                  S01194
0161 I****                                   45  48 SRC2                  S01194
0162 I****                                   49  520TACC                  S01194
0163 I****                                   53  560TEQV                  S01194
0164 I****                                   57  600SWQV                  S01194
0165 I****                                   61  640TAC4                  S01194
0166 I****                                   65  680TAC5                  S01194
0167 I*****                                  69  69 HIND                  S01194
0168 I*****                               P  70  768PART                  S01194
0169 I*****                                  77  780SSNO                  S01194
0170 I*****                               P  79  858ERLC                  S01194
0171 I*****                               P  90  920LCD                   S01194
0172 I*****                                  93  93 CHTP                  S01194
0173 I*****                               P  94  960TNLU                  S01194
0174 I*****                                                               S01194
0175 I*****TABD (BROKER DETAILS RECORD)                                   S01194
0176 I*****TABD    NS  09   1 CD   2 C8   3 C0                            S01194
0177 I*****                                   1   1 RECI                  S01194
0178 I*****                                   2   30RECT                  S01194
0179 I*****                                  10  13 BRKC                  S01194
0180 I*****                                  14  43 BKNM                  S01194
0181 I*****                                  44  53 BKTN                  S01194
0182 I*****                                  54  56 BKCY                  S01194
0183 I*****                               P  90  920LCD                   S01194
0184 I*****                                  93  93 CHTP                  S01194
0185 I*****                               P  94  960TNLU                  S01194
0186 I*****                                                               S01194
0187 I**TABD CATCHALL                                                     S01194
0188 I*****   NS  10                                                      S01194
0189 I*****                                   2   30RECT                  S01194
     I*                                                                   S01194
     I@BANK     E DSSDBANKPD                                              S01194
     I** DUMMY RECORD FORMAT FOR BANK DETAILS                             S01194
     I*
     I@BRCH     E DSSDBRCHPD                                              S01194
     I** DUMMY RECORD FORMAT FOR BRANCH DETAILS                           S01194
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*
     ISPOOL       DS                                                      S01117
     I** SPOOL INFORMATION DATA STRUCTURE                                 S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I*                                                                   S01117
     ISPOOLU      DS                                                      S01117
     I** SPOOL INFORMATION DATA STRUCTURE                                 S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL1220IIP1                                           S01408
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
     I*                                                                   S01408
     C/EJECT
0190 C********************************************************************
     C**
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
     C**                                                                  S01117
0191 C*                 FIRST  CYCLE                                     *
0192 C********************************************************************
0193 C                     SETOF                     OF
0194 C   40                GOTO START
0195 C                     SETON                     40
     C                     MOVEACPY@      BIS@   80
0196 C*
0197 C**FIND*ICD*RECORD*1                                                 S01194
0198 C*****                EXSR ZSYSTM                                    S01194
0199 C***99                SETON                     U8LR                 S01194
0200 C***99                GOTO END                                       S01194
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG    '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10         ************* S01194
     C                     MOVEL'01'      DBASE   3         *DBERROR 001* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0381 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0382 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
0201 C                     Z-ADD0         RECDS   50
0202 C*
0203 C*****ACCESS I.C.R.2                                                 S01194
0204 C*****                MOVEL'01'      TABKEY 12                       S01194
0205 C*****                MOVE '11'      TABKEY                          S01194
0206 C*****      TABKEY    CHAINTABLE                88                   S01194
0207 C**N11                SETON                     LRU7                 S01194
0208 C*
0209 C**SET*UP*KEY*TO*ACCESS*CURRENCY*TABLE                               S01194
0210 C*****                MOVEL'20'      CCYKEY 12                       S01194
0211 C*****                MOVE '1'       CCYKEY                          S01194
0212 C*
0213 C* SET UP CURRENCIES ARRAY
0214 C                     Z-ADD0         Y       30
0215 C*****      CCYKEY    SETLLTABD
0212 C           *LOVAL    SETLLSDCURRL0                                  S01194
0216 C           CREAD     TAG                             * CREAD TAG *
0217 C*****                SETOF                     4108                 S01194
0217 C                     SETOF                     41                   S01194
0218 C*****                READ TABD                     41               S01194
0215 C                     READ SDCURRL0                 41               S01194
0219 C**N41      RECT      COMP 20                   41                   S01194
0220 C   41                GOTO BKREAD
0221 C**N08                GOTO CREAD                                     S01194
0222 C           Y         ADD  1         Y
0223 C*****                MOVE CDP       CDPA,Y                          S01194
0223 C                     MOVE A6NBDP    CDPA,Y                          S01194
0224 C*****                MOVE CCY       CCYA,Y                          S01194
0224 C                     MOVE A6CYCD    CCYA,Y                          S01194
0225 C                     GOTO CREAD
0226 C           BKREAD    TAG                             * BKREAD TAG *
0227 C*
0228 C*    FIND NO OF DECIMALS FOR LOCAL CCY.
0229 C                     Z-ADD1         Y
0230 C*****      LOCY      LOKUPCCYA,Y                   89               S01194
0230 C           BJLCCY    LOKUPCCYA,Y                   89               S01194
     C  N89                MOVEL'SDCURRPD'DBFILE 10         ************* S01194
     C  N89                MOVEL'02'      DBASE   3         *DBERROR 002* S01194
     C  N89                MOVELBJLCCY    DBKEY  29         ************* S01194
     C  N89                MOVEL'*KEY'    DBOPTN  7                       S01194
0231 C  N89                SETON                     U7U8LR
0232 C  N89                GOTO END
0233 C           CDPA,Y    COMP 1                      6465
0234 C           CDPA,Y    COMP 2                    67  66
0235 C*
0236 C* SET*UP*KEY*TO*ACCESS*BROKER*DETAILS*RECORD                        S01194
0237 C******               MOVEL'80'      BKKEY  12                       S01194
0238 C*
0239 C* SET UP BROKER DETAILS ARRAYS
0240 C                     Z-ADD0         X       30
0241 C*****      BKKEY     SETLLTABD                                      S01194
0212 C           *LOVAL    SETLLSDBROKL1                                  S01194
0242 C           READ      TAG                             * READ TAG *
0243 C*****                SETOF                     4209                 S01194
0243 C                     SETOF                     42                   S01194
0244 C*****                READ TABD                     42               S01194
0244 C                     READ SDBROKL1                 42               S01194
0245 C**N42*     RECT      COMP 80                   42                   S01194
0246 C   42                GOTO CALCS
0247 C**N09*               GOTO READ                                      S01194
0248 C           X         ADD  1         X
0249 C*****                MOVE BRKC      BRKA,X                          S01194
0249 C                     MOVE A9BROK    BRKA,X                          S01194
0250 C*****                MOVE BKNM      BKNA,X                          S01194
0250 C                     MOVE A9BKNM    BKNA,X                          S01194
0251 C*****                MOVE BKTN      BKTA,X                          S01194
0251 C                     MOVE A9BRTN    BKTA,X                          S01194
0252 C                     GOTO READ
0253 C           CALCS     TAG                             * CALCS TAG *
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1220CCP2                                           S01408
     C*                                                                   S01408
      *                                                                                       CDL099
      ** Call Access Program to check if CDL099 is enabled                                    CDL099
      *                                                                                       CDL099
     C                     CALL 'AOSARDR0'                                                    CDL099
     C                     PARM           URTCD   7                                           CDL099
     C                     PARM '*VERIFY' UOPTN   7                                           CDL099
     C                     PARM 'CDL099'  USARC   6                                           CDL099
      *                                                                                       CDL099
     C           URTCD     IFNE *BLANKS                                                       CDL099
     C                     MOVE 'N'       CDL099  1                                           CDL099
     C                     ELSE                                                               CDL099
     C                     MOVE 'Y'       CDL099                                              CDL099
     C                     ENDIF                                                              CDL099
0254 C*
0255 C* ZEROIZE FIELDS
0256 C                     Z-ADD0         CBRAMT 150
0257 C                     Z-ADD0         DBRAMT 150
0258 C                     Z-ADD0         TBRADT 150
0259 C                     Z-ADD0         BBRAMT 150
0260 C                     Z-ADD0         X       30
0260 C                     Z-ADD0         LINE    20
0261 C* SET*UP*KEY*TO*ACCESS*BRANCH*CODES*RECORDS                         S01194
0262 C*****                MOVEL'10'      KEY    12                       S01194
0263 C*
0264 C********************************************************************
0265 C*                MAIN  PROCESSING                                  *
0266 C********************************************************************
0267 C           START     TAG                             * START TAG *
0268 C  N02                GOTO END
0269 C                     SETOF                       4445
0270 C                     SETOF                     46
0271 C                     SETOF                     515253
0272 C                     SETOF                     546061
0273 C                     SETOF                     626370
0274 C                     SETOF                     718081
0275 C                     SETOF                     828384
0276 C                     SETOF                     858687
     C                     SETOF                     56                   S01119
     C*
     C**  FOR BROKX DETAIL RCD SETON TRIGGER *IN FOR EXCPT OUTPUT
     C*
     C   02                SETON                     50
     C*
     C*                                                                   S01117
     C           *INL4     IFEQ '1'                                       S01117
     C                     CLOSEDL1220P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C                     SETON                     58    ALLOW OUTPUT   S01117
     C                     OPEN DL1220P1                                  S01117
     C*
     C* REPORT SPOOL FILE GENERATION                                      S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      @PARM   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                         B3            S01117
     C* Error during ZSFILE processing, return to calling program.        S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                              E3            S01117
     C*                                                                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
      ** OBTAIN BRANCH NAME VIA ACCESS PGM/AOBRCHR0                       S01194
     C**********           CALL 'AOBRCHR0'                                S01194              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BRCA      @DSNB   3                       S01194
     C********** @BRCH     PARM @BRCH     DSFDY                           S01194              CGL029
     C           @BRCH     PARM @BRCH     DSSDY                                               CGL029
      *                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDBRCHPD'DBFILE 10         ************* S01194
     C                     MOVEL'03'      DBASE   3         *DBERROR 003* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     MOVELBRCA      DBKEY                           S01194
0281 C                     SETON                     LRU8U7               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
      *
     C                     END                                            S01194
      *
0261 C**   IF DETAILS TO REPORT EXIST, SET INDICATOR
0262 C                     SETON                     59
     C                     ELSE
     C                     SETOF                     58                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0260 C**                                                                  S01117
0277 C*
0278 C* FOR CHANGE OF BRANCH CODE,CHAIN FOR BRANCH NAME
0279 C***L4*               MOVE BRCD      KEY    12                       S01117
0280 C***L4*     KEY       CHAINTABLE                99
0281 C***L4*99             SETON                     LRU8
0282 C***L4*99             GOTO END
0283 C   L4                Z-ADD0         X
0284 C*
0285 C* FOR CHANGE OF BROKER,CHECK FOR BROKERS WITH NO DEALS THIS PERIOD
0286 C           LOOP      TAG                             * LOOP TAG *
0287 C   L3
0288 CORN43      X         ADD  1         X
     C** EMERGENCY FIX ABOVE LINE INCORRECT
     C           BROK      COMP BRKA,X                 7243
     C***72                MOVEL'80'      ERROR  12
     C***72                MOVE BROK      ERROR
     C   72                MOVEL'SDBROKPD'DBFILE 10         ************* S01194
     C   72                MOVEL'04'      DBASE   3         *DBERROR 004* S01194
     C   72                MOVELBROK      DBKEY  29         ************* S01194
     C   72                MOVEL'*KEY'    DBOPTN  7                       S01194
     C   72                SETON                     U8LRU7
     C   72                GOTO END
0290 C           BRKA,X    COMP ' '                      47
0291 C   47                GOTO END
     C  N43                SETON                     48
0292 C  N43                EXCPT
     C  N43                SETOF                     48
     C  N43                SETOF                     L4
0293 C  N43                SETON                     OF
0294 C  N43                GOTO LOOP
0295 C*
0296 C* FIND DEAL TYPE
     C* THERE ARE NOW FOUR DEAL TYPES                                     S01119
0297 C***********STYP***** COMP 2                    464445               S01119
     C           STYP      COMP 1                        44               S01119
     C  N44      STYP      COMP 2                        45               S01119
     C  N44N45   STYP      COMP 3                    56  46               S01119
0298 C*
0299 C**FIND IF FX DEAL CCYS - USD
0300 C*
0301 C* FIND NARR FOR DEALS WITH NO BROKERAGE CALCULATED
     C*  FOR FRA/IRS, ZERO BROKERAGE TO BE OUTPUT                         S01119
0302 C***********BRAMT*****COMP 0                    51                   S01119
     C   56                SETON                     51                   S01119
0302 C  N56      BRAMT     COMP 0                    51                   S01119
     C/COPY WNCPYSRC,DL1220C001
0303 C           NARF      COMP '4'                      52
0304 C           NARF      COMP '3'                      54
0305 C           NARF      COMP '2'                      53
0306 C  N52      NARF      COMP '1'                      52
0307 C           DATE      TAG                             * DATE TAG *
0308 C*
0309 C* CHANGE FORMAT OF DATES
0310 C                     MOVE DDAT      ZDAYNO  50
0311 C                     EXSR ZDATE2
0312 C                     MOVE ZADATE    DLDAT   7
0313 C                     MOVE VDAT      ZDAYNO
0314 C                     EXSR ZDATE2
0315 C                     MOVE ZADATE    VLDAT   7
0316 C                     MOVE MDAT      ZDAYNO
0317 C                     EXSR ZDATE2
0318 C                     MOVE ZADATE    MATDAT  7
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1220CCP1                                           S01408
     C*                                                                   S01408
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C           *IN44     ANDEQ'1'                                                           CDL099
     C           *IN53     ANDEQ'0'                                                           CDL099
     C           BSDAT     ANDNE0                                                             CDL099
     C                     Z-ADDBSDAT     ZDAYNO                                              CDL099
     C                     EXSR ZDATE2                                                        CDL099
     C                     MOVE ZADATE    USTDAT  7                                           CDL099
     C                     SETON                     30                                       CDL099
     C                     ELSE                                                               CDL099
     C                     SETOF                     30                                       CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
0319 C*
0320 C* FIND NO. OF DEC. PLACES FOR CCYS
0321 C                     Z-ADD1         Y
0322 C           PCCY      LOKUPCCYA,Y                   89
     C  N89                MOVEL'SDCURRPD'DBFILE 10         ************* S01194
     C  N89                MOVEL'05'      DBASE   3         *DBERROR 005* S01194
     C  N89                MOVELPCCY      DBKEY  29         ************* S01194
     C  N89                MOVEL'*KEY'    DBOPTN  7                       S01194
0323 C  N89                SETON                     U7U8LR
0324 C  N89                GOTO END
0325 C           CDPA,Y    COMP 1                      6061
0326 C           CDPA,Y    COMP 2                    63  62
0327 C*
0328 C                     Z-ADD1         Y
0329 C   44      CCCY      LOKUPCCYA,Y                   89
     C  N89 44             MOVEL'SDCURRPD'DBFILE 10         ************* S01194
     C  N89 44             MOVEL'06'      DBASE   3         *DBERROR 006* S01194
     C  N89 44             MOVELCCCY      DBKEY  29         ************* S01194
     C  N89 44             MOVEL'*KEY'    DBOPTN  7                       S01194
0330 C  N89 44             SETON                     U7U8LR
0331 C  N89 44             GOTO END
0332 C   44      CDPA,Y    COMP 1                      8081
0333 C   44      CDPA,Y    COMP 2                    83  82
0334 C*
0335 C                     Z-ADD1         Y
0336 C           BRCY      LOKUPCCYA,Y                   89
     C  N89                MOVEL'SDCURRPD'DBFILE 10         ************* S01194
     C  N89                MOVEL'07'      DBASE   3         *DBERROR 007* S01194
     C  N89                MOVELBRCY      DBKEY  29         ************* S01194
     C  N89                MOVEL'*KEY'    DBOPTN  7                       S01194
0337 C  N89                SETON                     U7U8LR
0338 C  N89                GOTO END
0339 C           CDPA,Y    COMP 1                      8485
0340 C           CDPA,Y    COMP 2                    87  86
0341 C*
0342 C* KEEP TOTALS
0343 C   L1                Z-ADD0         CBRAMT
0344 C   L2                Z-ADD0         DBRAMT
0345 C           TBRADT    ADD  BRADT     TBRADT
0346 C           CBRAMT    ADD  BRAMT     CBRAMT
0347 C           DBRAMT    ADD  BRAMT     DBRAMT
0348 C           BBRAMT    ADD  BRAMT     BBRAMT
     C/COPY WNCPYSRC,DL1220C002
0349 C*
0350 C* KEEP HASH TOTAL & RECORD COUNT
0353 C           PAMT      DIV  1000      ZZAMT
     C           ZZAMT     IFLT 0                                                            BUG8001
     C                     Z-SUBZZAMT     ZZAMT                                              BUG8001
     C                     ENDIF                                                             BUG8001
0354 C                     EXSR GLZADD
0356 C           RECDS     ADD  1         RECDS
0357 C   L2                SETON                     55
0357 C   L2                EXCPT
0357 C   L2                SETOF                     55
0357 C   L2                Z-ADD0         LINE
0357 C           END       TAG                             * END TAG *
0357 C**
 357 C*  LINE CHECK TO CONDITION OVERFLOW
0357 C**
0357 C   02      LINE      ADD  1         LINE
0357 C   02 44   LINE      ADD  1         LINE                            E43508
0357 C*  02      LINE      COMP 56                   55  55               E43508
0357 C   02      LINE      COMP 52                   55  55               E43508
0357 C   02 55             EXCPT
0357 C   02 55             Z-ADD0         LINE
0357 C   02                SETOF                     55
0357 CL1         LINE      ADD  3         LINE
0357 C*1         LINE      COMP 56                   55  55               E43508
0357 CL1         LINE      COMP 52                   55  55               E43508
0357 CL1 55                EXCPT
0357 CL1 55                Z-ADD0         LINE
0357 CL1                   SETOF                     55
0357 CL2         LINE      ADD  3         LINE
0357 C*2         LINE      COMP 56                   55  55               E43508
0357 CL2         LINE      COMP 52                   55  55               E43508
0357 CL2 55                EXCPT
0357 CL2 55                Z-ADD0         LINE
0357 CL2                   SETOF                     55
0357 CL3         LINE      ADD  3         LINE
0357 C*3         LINE      COMP 56                   55  55               E43508
0357 CL3         LINE      COMP 52                   55  55               E43508
0357 CL3 55                EXCPT
0357 CL3 55                Z-ADD0         LINE
0357 CL3                   SETOF                     55
0358 C********************************************************************
0359 C*              TOTAL  TIME  PROCESSING                             *
0360 C********************************************************************
     C**
     C**   ON CHANGE OF BRANCH OUTPUT TOTALS FOR LAST BROKER
     C**   AND READ TO END OF BROKER ARRAY AND REPORT BROKERS
     C**   AS HAVING NO TRANSACTIONS THIS PERIOD.
     CL4 72                GOTO L4END
     C**
     CL4 50                SETON                     49
     CL4                   EXCPT
     CL4                   SETOF                     494350
     C**
     CL4         L4LOOP    TAG                             ** L4LOOP TAG *
     CL4         X         ADD  1         X
     CL4         BRKA,X    COMP ' '                      47
     CL4 47                GOTO L4END
     CL4                   SETON                     48
     CL4                   EXCPT
     CL4                   SETOF                     48
     CL4                   GOTO L4LOOP
     CL4         L4END     TAG                             ** L4END TAG **
     C**
0361 CLR         RECDS     COMP NORE                 7070
0362 CLR 70                SETON                     U7
0363 CLR         HRWN      COMP ZZTOTI               7171
0364 CLRN71      HRDC      COMP ZZTOTD               7171
0365 CLR 71                SETON                     U7
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF
     CLR                   Z-ADDSFNUMU    ZSNUM   60
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    @PARM                           S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM *BLANK    ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C** Error during ZSFILE processing, return to calling program        S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0258 C*                                                                   S01117
0366 C********************************************************************
0367 C*                  SUB - ROUTINES                                  *
0368 C********************************************************************
0369 C*****                                                               S01194
0370 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0371 C*****                                                               S01194
0372 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0373 C*****                                                               S01194
0374 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0375 C*****                MOVEL'01      'ZTABKY 12                       S01194
0376 C*****                MOVE '  10'    ZTABKY                          S01194
0377 C*****                                                               S01194
0378 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0379 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0380 C*****                                                               S01194
0381 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0382 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0383 C*****                                                               S01194
0384 C*****                ENDSR                                          S01194
0385 C*****                                                               S01194
0386 C*****                                                               S01194
0387 C********************************************************************
0388 C**
0389 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0390 C**
0391 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0392 C**
0393 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0394 C**
0395 C**   CLEAR DATE FIELDS.
0396 C                     Z-ADD0         ZDATE   60
0397 C                     MOVEL'       ' ZADATE  7
0398 C**
0399 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0400 C                     Z-ADDZDAYNO    ZDAYNO  50
0401 C**
0402 C**   DETERMINE YEAR NUMBER.
0403 C**
0404 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0405 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0406 C   99                GOTO ZDEND2
0407 C**
0408 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0409 C           ZDAYN1    DIV  1461      ZLYR    20
0410 C                     MVR            ZDAYN1           SAVE REMAINING
0411 C**                                                   DAYS
0412 C**   CALCULATE NUMBER OF REMAINING YEARS.
0413 C                     Z-ADD1         ZWRK2   20
0414 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0415 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0416 C  N90      ZWRK2     ADD  1         ZWRK2
0417 C  N90                GOTO ZDTAG1
0418 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0419 C**
0420 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0421 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0422 C**
0423 C**   CALCULATE ACTUAL YEAR NUMBER.
0424 C           ZLYR      MULT 4         ZWRK3   30
0425 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0426 C                     Z-ADDZWRK3     ZYEAR   20
0427 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0428 C**
0429 C**   DETERMINE MONTH NUMBER.
0430 C**
0431 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0432 C                     SETOF                     9293
0433 C   91      ZDAYN1    COMP 59                     9293
0434 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0435 C**
0436 C**   CALCULATE MONTH NUMBER.
0437 C                     Z-ADD2         ZWRK2
0438 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0439 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0440 C  N94      ZWRK2     ADD  1         ZWRK2
0441 C  N94                GOTO ZDTAG2
0442 C           ZWRK2     SUB  1         ZWRK2
0443 C**
0444 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0445 C**
0446 C**   DETERMINE DAY OF MONTH.
0447 C**
0448 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0449 C           ZDAYN1    ADD  1         ZDAYN1
0450 C**
0451 C**   CALCULATE DAY OF MONTH.
0452 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0453 C**
0454 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0455 C   93      ZDAY      ADD  1         ZDAY
0456 C**
0457 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0458 C  N98                MOVELZDAY      ZWRK4   40
0459 C   98                MOVE ZDAY      ZWRK4
0460 C  N98                MOVE ZMTH      ZWRK4
0461 C   98                MOVELZMTH      ZWRK4
0462 C                     MOVELZWRK4     ZDATE
0463 C                     MOVE ZYEAR     ZDATE
0464 C**
0465 C**   FORMAT ALPHA DATE, DDMMMYY.
0466 C           ZDAY      COMP 10                     95
0467 C                     MOVELZDAY      ZWRK5   5
0468 C   95                MOVEL' '       ZWRK5
0469 C                     MOVE ZMNM,ZMTH ZWRK5
0470 C                     MOVELZWRK5     ZADATE
0471 C                     MOVE ZYEAR     ZADATE
0472 C**
0473 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0474 C**
0475 C**
0476 C********************************************************************
0477 C********************************************************************
0478 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0479 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0480 C*
0481 CSR         GLZADD    BEGSR                           *** GLZADD ****
0482 C*
0483 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0484 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0485 C*
0486 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0487 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0488 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0489 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0490 C*
0491 CSR                   EXSR GLZSUM
0492 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0493 C*
0494 C********************************************************************
0495 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0496 C*                        GLZADD, GLZSUB, GLZCMP.
0497 C*          PARAMETERS PASSED -
0498 C*                     I/P ZZAMTI ZZAMTD
0499 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0500 C*
0501 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0502 C*
0503 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0504 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0505 CSR                   SETOF                     919293
0506 CSR                   SETOF                     949599
0507 C*
0508 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0509 CSR         ZZAMTI    COMP 0                      9293
0510 CSR 93      ZZAMTD    COMP 0                      9293
0511 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0512 C*
0513 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0514 CSR         ZZTOTI    COMP 0                      9193
0515 CSR 93      ZZTOTD    COMP 0                      9193
0516 C*
0517 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0518 CSR 93                Z-ADDZZAMTI    ZZTOTI
0519 CSR 93                Z-ADDZZAMTD    ZZTOTD
0520 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0521 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0522 CSR 91N92
0523 CORN91 92             GOTO ZZOFPS
0524 C*
0525 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0526 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0527 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0528 C*
0529 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0530 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0531 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0532 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0533 C*
0534 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0535 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0536 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0537 CSRN99                Z-ADDZZWK2     ZZTOTD
0538 CSRN99                Z-ADDZZWK3     ZZTOTI
0539 C*
0540 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0541 CSR 99                Z-ADD0         ZZAMT  153
0542 CSR                   GOTO ZZSEND
0543 C*
0544 C* THE 'SIGNS' ARE DIFFERENT
0545 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0546 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0547 C*
0548 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0549 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0550 C*
0551 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0552 C*
0553 CSR 91                Z-SUBZZTOTI    ZZTOTI
0554 CSR 91                Z-SUBZZTOTD    ZZTOTD
0555 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0556 C*
0557 CSR         ZZTOTI    COMP ZZAMTI               93  95
0558 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0559 C*
0560 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0561 CSR 95                Z-ADD0         ZZTOTI
0562 CSR 95                Z-ADD0         ZZTOTD
0563 CSR 95                GOTO ZZSEND
0564 C*
0565 C* IF ZZTOT GT. ZZAMT.
0566 CSR 93      ZZAMTD    COMP ZZTOTD               94
0567 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0568 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0569 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0570 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0571 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0572 C*
0573 C*
0574 C* IF ZZAMT GT. ZZTOT.
0575 CSRN93      ZZTOTD    COMP ZZAMTD               94
0576 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0577 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0578 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0579 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0580 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0581 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0582 C*
0583 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0584 CSR                   SETOF                     94
0585 CSR 93 91
0586 CORN93 92             SETON                     94
0587 CSR 94                Z-SUBZZTOTI    ZZTOTI
0588 CSR 94                Z-SUBZZTOTD    ZZTOTD
0589 C**
0590 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0591 CSR 92                Z-SUBZZAMTI    ZZAMTI
0592 CSR 92                Z-SUBZZAMTD    ZZAMTD
0593 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0594 C**
0595 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0596 CSR                   SETOF                     96
0597 CSR         ZZTOTD    COMP 0                        91
0598 CSR 91      ZZTOTI    COMP 0                      96
0599 CSR 96                MOVE '.000-'   ZZNEGD  5
0600 CSR                   ENDSR                             ** ENDSR **
0471 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0601 C********************************************************************
0602 O*PRINT  E   03   48                                                 S01124
0602 O**DL1220P1E   03   48                                       S01124  S01117
0602 ODL1220P1E   03   48 58                                              S01117
0603 O******                             22 'REFERENCE DL1220'            S01117
0603 O                                   24 'REFERENCE DL1220P1'          S01117
0604 O******                   TITL      89                               S01194
0604 O                         BJURPT    89                               S01194
0605 O                                  122 'DATE              PAGE'
0606 O******                   RUNA     114                               S01194
0606 O                         BJMRDT   114                               S01194
0607 O                         PAGE  Z  127
     O*****   E   05   48                                                 S01117
     O        E   05   48 58                                              S01117
     O*****                    BRNM      30                               S01117
0610 O                NU1                53 'INTERIM'
0611 O                                   70 'BROKERAGE REPORT'
     O*****   E   06   48                                                 S01117
     O        E   06   48 58                                              S01117
0613 O                NU1                53 '*******'
0614 O                                   70 '----------------'
     O        E   08   48 58                                              S01117
0616 O                                   12 'BRANCH'                      S01117
     O                         BRCA      16                               S01117
     O                         A8BRNM    48                               S01117
     O*****   E   07   48                                                 S01117
     O        E   10   48 58                                              S01117
0616 O                                    6 'BROKER'
0617 O                         BKNA,X    38
     O*****   E   08   48                                                 S01117
     O        E   11   48 58                                              S01117
0619 O                         BKTA,X    18
     O*****   E   10   48                                                 S01117
     O        E   13   48 58                                              S01117
0621 O                                   28 'NO TRANSACTIONS THIS'
0622 O                                   35 'PERIOD'
     O*****   E 12     49                                                 S01117
     O        E 12     49 58                                              S01117
     O/COPY WNCPYSRC,DL1220O001
     O                                   87 'CURRENCY TOTAL'
     O                 84      TBRADT B 107 '   ,   ,   ,   , 0 '
     O                 85      TBRADT B 107 '  ,   ,   ,   , 0 . '
     O                 86      TBRADT B 107 ' ,   ,   ,   , 0 .  '
     O                 87      TBRADT B 107 '   ,   ,   , 0 .   '
     O                         BRCY     111
     O                 64      CBRAMT   132 '   ,   ,   ,   , 0 '
     O                 65      CBRAMT   132 '  ,   ,   ,   , 0 . '
     O                 66      CBRAMT   132 ' ,   ,   ,   , 0 .  '
     O                 67      CBRAMT   132 '   ,   ,   , 0 .   '
     O*****   E 12     49                                                 S01117
     O        E 12     49 58                                              S01117
     O                 44                81 'FOREIGN EXCHANGE'
     O                 45                81 'DEPOSITS'
     O                 46                81 'NEGOTIABLE ASSETS'
     O                 56                81 'FRA & IRS'                   S01119
     O                                   87 'TOTAL'
     O                 64      DBRAMT B 132 '   ,   ,   ,   , 0 '
     O                 65      DBRAMT B 132 '  ,   ,   ,   , 0 . '
     O                 66      DBRAMT B 132 ' ,   ,   ,   , 0 .  '
     O                 67      DBRAMT B 132 '   ,   ,   , 0 .   '
     O*****   E 12     49                                                 S01117
     O        E 12     49 58                                              S01117
     O                                   88 'BROKER TOTAL'
     O                 64      BBRAMT B 132 '   ,   ,   ,   , 0 '
     O                 65      BBRAMT B 132 '  ,   ,   ,   , 0 . '
     O                 66      BBRAMT B 132 ' ,   ,   ,   , 0 .  '
     O                 67      BBRAMT B 132 '   ,   ,   , 0 .   '
     O/COPY WNCPYSRC,DL1220O002
0623 O*****   E   03   55                                                 S01117
0623 O        E   03   55 58                                              S01117
0628 O******                             22 'REFERENCE DL1220'            S01117
0628 O                                   24 'REFERENCE DL1220P1'          S01117
0629 O******                   TITL      89                               S01194
0629 O                         BJURPT    89                               S01194
0630 O                                  122 'DATE              PAGE'
0631 O*****                    RUNA     114                               S01194
0631 O                         BJMRDT   114                               S01194
0632 O                         PAGE  Z  127
0633 O*****   E   05   55                                                 S01117
0633 O        E   05   55 58                                              S01117
     O*****                    BRNM      30                               S01117
0639 O                NU1                53 'INTERIM'
0640 O                                   70 'BROKERAGE REPORT'
0641 O*****   E   06   55
0641 O        E   06   55 58                                              S01117
0645 O                NU1                53 '*******'                     S01117
0646 O                                   70 '----------------'
     O        E   08   55 58                                              S01117
0616 O                                   12 'BRANCH'                      S01117
     O                         BRCA      16                               S01117
     O                         A8BRNM    48                               S01117
0647 O*****   E   07   55                                                 S01117
0647 O        E   10   55 58                                              S01117
0651 O                                    6 'BROKER'
     O                   N72   BKNA,X    38
0653 O                                   90 'DEAL TYPE'
0654 O                 44               108 'FOREIGN EXCHANGE'
0655 O                 45               116 'DEPOSITS ACCEPTED/PLACED'
0656 O                 46               109 'NEGOTIABLE ASSETS'
     O                 56               101 'FRA & IRS'                   S01119
0657 O*****   E  108   55                                                 S01117
0657 O        E  111   55 58                                              S01117
     O                   N72   BKTA,X    18
0662 O*****   E  1     55                                                 S01117
0662 O        E  1     55 58                                              S01117
0666 O                 44                53 'BUY CCY'
0667 O                                  105 'BROKERAGE'
0668 O*****   E  2     55                                                 S01117
0668 O        E  2     55 58                                              S01117
0672 O                                   18 'DEAL DATE DEAL NO.'
0673 O                                   31 'CUSTOMER'
0674 O                 44                54 'SELL CCY'
0675 O                N44                52 'DEAL CCY'
0676 O                                   77 'AMOUNT    VALUE'
0677 O                      N44          87 'MATURITY'
0678 O                       44          89 'OTHER DATE'
0679 O                                  103 '& CCY'
0680 O******                   LOCY     120
0680 O                         BJLCCY   120
0681 O                                  130 'BROKERAGE'
0682 O*****   D  1     02                                                 S01117
0682 O        D  1     02 58                                              S01117
0683 O                         DLDAT      7
0684 O                         DLNO      16
0685 O                         CNAME     39
0686 O                         PCCY      50
0687 O                 60      PAMT      70 ' ,   ,   ,   , 0 '
0688 O                 61      PAMT      70 '   ,   ,   , 0 . '
0689 O                 62      PAMT      70 '  ,   ,   , 0 .  '
0690 O                 63      PAMT      70 ' ,   ,   , 0 .   '
0691 O                         VLDAT     79
0692 O                         MATDAT    87
0693 O                 54N51N44         107 'CALL/NOTICE DEAL'
     O/COPY WNCPYSRC,DL1220O003
0694 O                N54 84   BRADT    107 ' ,   ,   ,   , 0 '
0695 O                N54 85   BRADT    107 '   ,   ,   , 0 . '
0696 O                N54 86   BRADT    107 '  ,   ,   , 0 .  '
0697 O                N54 87   BRADT    107 ' ,   ,   , 0 .   '
0698 O                N54      BRCY     111
0699 O                N54 64 51BRAMT    132 ' ,   ,   ,   , 0 '
0700 O                N54 65 51BRAMT    132 '   ,   ,   , 0 . '
0701 O                N54 66 51BRAMT    132 '  ,   ,   , 0 .  '
0702 O                N54 67 51BRAMT    132 ' ,   ,   , 0 .   '
     O/COPY WNCPYSRC,DL1220O004
0703 O                 52               129 'RATE NOT ON FILE'
0704 O                 53N51            124 'OPTION DEAL'
0705 O        D  1     02 43 44
     O       AND       58                                                 S01117
0706 O                         CCCY      50
0707 O                 80      CAMT      70 ' ,   ,   ,   , 0 '
0708 O                 81      CAMT      70 '   ,   ,   , 0 . '
0709 O                 82      CAMT      70 '  ,   ,   , 0 .  '
0710 O                 83      CAMT      70 ' ,   ,   , 0 .   '
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL1220OOP1                                           S01408
     O*                                                                   S01408
     O                    30   USTDAT    79                                                   CDL099
     O        T 12     L1 43N72
     O       AND       58                                                 S01117
0712 O                                   87 'CURRENCY TOTAL'
0713 O                 84      TBRADT B 107 '   ,   ,   ,   , 0 '
0714 O                 85      TBRADT B 107 '  ,   ,   ,   , 0 . '
0715 O                 86      TBRADT B 107 ' ,   ,   ,   , 0 .  '
0716 O                 87      TBRADT B 107 '   ,   ,   , 0 .   '
0717 O                         BRCY     111
0718 O                 64      CBRAMT   132 '   ,   ,   ,   , 0 '
0719 O                 65      CBRAMT   132 '  ,   ,   ,   , 0 . '
0720 O                 66      CBRAMT   132 ' ,   ,   ,   , 0 .  '
0721 O                 67      CBRAMT   132 '   ,   ,   , 0 .   '
     O        T 12     L2 43N72
     O       AND       58                                                 S01117
0723 O                 44                81 'FOREIGN EXCHANGE'
0724 O                 45                81 'DEPOSITS'
0725 O                 46                81 'NEGOTIABLE ASSETS'
     O                 56                81 'FRA & IRS'                   S01119
0726 O                                   87 'TOTAL'
0727 O                 64      DBRAMT B 132 '   ,   ,   ,   , 0 '
0728 O                 65      DBRAMT B 132 '  ,   ,   ,   , 0 . '
0729 O                 66      DBRAMT B 132 ' ,   ,   ,   , 0 .  '
0730 O                 67      DBRAMT B 132 '   ,   ,   , 0 .   '
     O        T 12     L3 43N72
     O       AND       58                                                 S01117
0732 O                                   88 'BROKER TOTAL'
0733 O                 64      BBRAMT B 132 '   ,   ,   ,   , 0 '
0734 O                 65      BBRAMT B 132 '  ,   ,   ,   , 0 . '
0735 O                 66      BBRAMT B 132 ' ,   ,   ,   , 0 .  '
0736 O                 67      BBRAMT B 132 '   ,   ,   , 0 .   '
     O/COPY WNCPYSRC,DL1220O005
     O        T 3      L4 58
     O                                   66 '*** END OF REPORT FOR'
     O                                   77 ' BRANCH ***'
     O********                           71 '*** END OF BRANCH REPORT'
     O********                           75 ' ***'
0737 O*
0738 O* FILE CONTROL REPORT
0739 O******* T   03   LR                                                 S01117
0739 ODL1220AUT   03   LR                                                 S01117
0740 O******                             22 'REFERENCE DL1220'            S01117
0740 O                                   24 'REFERENCE DL1220AU'          S01117
0741 O*****                    TITL      89                               S01194
0741 O                         BJURPT    89                               S01194
0742 O                                  122 'DATE              PAGE'
0743 O*****                    RUNA     114                               S01194
0743 O                         BJMRDT   114                               S01194
0744 O*****                    PAGE  Z  127                               S01117
0744 O                         PAGE1 Z  127                               S01117
0745 O        T   05   LR
0746 O                NU1                53 'INTERIM'
0747 O                                   70 'BROKERAGE REPORT'
0748 O        T   06   LR
0749 O                NU1                53 '*******'
0750 O                                   70 '----------------'
0751 O        T   35   LR
0752 O                                   31 'RUN CONTROLS'
0753 O                                   75 'NUMBER'
0754 O                                  104 'VALUE'
0755 O        T   39   LR
0756 O                                   41 'BROKERAGE FILE RECORDS'
0757 O                                   47 'INPUT'
0758 O                         RECDS 3   75
0759 O                         ZZTOTI3  102
0760 O                         ZZTOTD   105
0761 O        T   41   LR
0762 O                                   41 'BROKERAGE FILE CONTROL'
0763 O                                   48 'TOTALS'
0764 O                         NORE  3   75
0765 O                         HRWN  3  102
0766 O                         HRDC     105
0767 O        T   43   LR U7
0768 O                       70          75 '*** DIFFERENCE ***'
0769 O                       71         105 '*** DIFFERENCE ***'
    EO*****   T 33     LR U8 72                                           S01194
    EO*****                    ERROR     40                               S01194
    EO*****                              71 '*** DATABASE ERROR ***'      S01194
0638 O        T  3     LR U7 U8                                           S01194
     O                                   71 '*** PRINT TERMINATED ***'    S01194
     O        T 2      LR U7 U8                                           S01194
     O                                   57 'DATABASE ERROR'              S01194
     O                         DBASE     61                               S01194
     O                                   67 'FILE'                        S01194
     O                         DBFILE    78                               S01194
     O        T 13     LR U7 U8                                           S01194
     O                                   49 'OPTION'                      S01194
     O                         DBOPTN    57                               S01194
     O                                   66 'KEY'                         S01194
     O                         DBKEY     96                               S01194
     O*****   T   22   LRNU7N59                                     S01194E297
     O        T 22     LRNU7N59                                           E297
0742 O                                   59 '***   NO DETAILS TO '        S01194
0743 O                                   71 'REPORT   ***'                S01194
0770 O*****   T 22     LR                                                 S01117
0771 O*****                              73 '*** END OF REPORT ***'       S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
