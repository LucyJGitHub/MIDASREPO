0001 H        1                                                           DL1410
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Interest Payments Files Merge')
0002 F********************************************************************DL1410
0003 F*                                                                  *DL1410
     F*  Midas - Dealing Module
0005 F*                                                                  *DL1410
0006 F*    DL1410 - MERGE INTEREST PAYMENTS FILES                        *DL1410
0007 F*                                                                  *DL1410
      *  (c) Misys International Banking Systems Ltd. 2001            *
0009 F*                                                                  *DL1410
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD027             Date 09Dec05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
0010  *  Prev Amend No. E165               Date 07DEC89               *DL1410
0010 F*                 S01194             Date - 27/04/89            *DL1410
0010 F*               NO. S01117       DATE - 27/04/89                   *DL1410
0011 F*                                                                  *DL1410
0012 F********************************************************************DL1410
0011 F*                                                                  *DL1410
      *  CSD027 - Conversion Of Customer Number to Alpha              *
     F*    E165   : ZSFILE NOT CALLED IF ONLY 'AU' PRODUCED              *
0009 F*    S01194 : NEW STANDING DATA - ADD ACCESS PROGRAMS              *S01117
0009 F*    S01117 : MULTIBRANCHING                                       *S01117
0011 F*                                                                  *DL1410
0012 F********************************************************************DL1410
0013 F*                                                                   DL1410
0014 F* ID F  C  H  L    FUNCTION OF INDICATORS                           DL1410
0015 F*                                                                   DL1410
0016 F* 01            MINTR HEADER                                        DL1410
0017 F* 02            MINTR DETAIL                                        DL1410
0018 F* 03            MINTR TRAILER                                       DL1410
0019 F* 04            MINTN HEADER                                        DL1410
0020 F* 05            MINTN DETAIL                                        DL1410
0021 F* 06            MINTN TRAILER                                       DL1410
0022 F**07************TABLE*ICD*RECORD*1***                               S01194
0023 F* 08            CATCHALL                                            DL1410
0024 F*       10      FIRST CYCLE                                         DL1410
0025 F*       20      EXCEPTION INDICATOR                                 DL1410
0026 F*       35      S/MINTR OR S/MINTN TOTALS OUT OF BALANCE            DL1410
0027 F*          U8   FILE CONTROLS OUT OF BALANCE                        DL1410
0028 F*                                                                   DL1410
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0029 FMINTRMH IP  F      64            DISK                               DL1410
0029 FMINTRMD IS  F      64            DISK                               DL1410
0029 FMINTRMT IS  F      64            DISK                               DL1410
0030 FMINTNMH IS  F      64            DISK                               DL1410
0030 FMINTNMD IS  F      64            DISK                               DL1410
0030 FMINTNMT IS  F      64            DISK                               DL1410
0031 F*****TABLE   IF  F      96 12AI     2 DISK                          S01194
0032 FMINTTMH O   F      64            DISK                               DL1410
0032 FMINTTMD O   F      64            DISK                               DL1410
0032 FMINTTMT O   F      64            DISK                               DL1410
0033 F*L1410P1O** F     132     OF     PRINTER                  S01124    S01117
     F*L1410AUO** F     132     OF     PRINTER      KINFDS SPOOLU   S01117E165
     FDL1410AUO   F     132     OF     PRINTER                            E165
     E                    CPY@    1   1 80
0034 I*                                                                   DL1410
0035 I*    MINTR FILE - HEADER RECORD.                                    DL1410
0036 IMINTRMH NS  01   1 CH                                               DL1410
0037 I                                        1   1 RECI                  DL1410
0038 I                                       18  190RECZ                  DL1410
0039 I                                    P  20  230FILZ                  DL1410
0040 I                                        1  64 LOT                   DL1410
0041 I*                                                                   DL1410
0042 I*    MINTR FILE - DETAIL RECORD.                                    DL1410
0043 IMINTRMD NS  02   1 CD                                               DL1410
0044 I                                        1   1 RECI                  DL1410
0045 I                                        2   2 TAXI                  DL1410
0046 I                                        3   4 DTYP                  DL1410
0047 I**********                              5  100CNUM                  DL1410              CSD027
0047 I                                        5  10 CNUM                  DL1410              CSD027
0048 I                                       11  160DLNO                  DL1410
0049 I                                       18  190TXMN                  DL1410
0050 I                                    P  20  257INTR                  DL1410
0051 I                                    P  26  320GRIT                  DL1410
0052 I                                    P  33  390PCPL                  DL1410
0053 I                                    P  40  420SLID                  DL1410
0054 I                                    P  43  450EDAT                  DL1410
0055 I                                    P  46  520TAXA                  DL1410
0056 I                                       53  53 REVI                  DL1410
0057 I                                       54  56 CCY                   DL1410
0058 I                                       57  590BRNC                  DL1410
0059 I                                        1  64 LOT                   DL1410
0060 I*                                                                   DL1410
0061 I*    MINTR FILE - TRAILER RECORD.                                   DL1410
0062 IMINTRMT NS  03   1 CT                                               DL1410
0063 I                                        1   1 RECI                  DL1410
0064 I                                    P  17  190TRCF                  DL1410
0065 I                                    P  20  220DRCF                  DL1410
0066 I                                    P  23  300TOIF                  DL1410
0067 I                                    P  31  320TODF                  DL1410
0068 I*    CATCHALL                                                       DL1410
0069 I        NS  08                                                      DL1410
0070 I*                                                                   DL1410
0071 I*    MINTN FILE - HEADER RECORD.                                    DL1410
0072 IMINTNMH NS  04   1 CH                                               DL1410
0073 I                                        1   1 RECI                  DL1410
0074 I                                       18  190RECZ                  DL1410
0075 I                                    P  20  230FILZ                  DL1410
0076 I*                                                                   DL1410
0077 I*    MINTN FILE - DETAIL RECORD.                                    DL1410
0078 IMINTNMD NS  05   1 CD                                               DL1410
0079 I                                        1   1 RECI                  DL1410
0080 I                                        2   2 TAXI                  DL1410
0081 I                                        3   4 DTYP                  DL1410
0082 I**********                              5  100CNUM                  DL1410              CSD027
0082 I                                        5  10 CNUM                  DL1410              CSD027
0083 I                                       11  160DLNO                  DL1410
0084 I                                       18  190TXMN                  DL1410
0085 I                                    P  20  257INTR                  DL1410
0086 I                                    P  26  320GRIT                  DL1410
0087 I                                    P  33  390PCPL                  DL1410
0088 I                                    P  40  420SLID                  DL1410
0089 I                                    P  43  450EDAT                  DL1410
0090 I                                    P  46  520TAXA                  DL1410
0091 I                                       53  53 REVI                  DL1410
0092 I                                       54  56 CCY                   DL1410
0093 I                                       57  590BRNC                  DL1410
0094 I                                        1  64 LOT                   DL1410
0095 I*                                                                   DL1410
0096 I*    MINTN FILE - TRAILER RECORD.                                   DL1410
0097 IMINTNMT NS  06   1 CT                                               DL1410
0098 I                                        1   1 RECI                  DL1410
0099 I                                    P  17  190TRCF                  DL1410
0100 I                                    P  20  220DRCF                  DL1410
0101 I                                    P  23  300TOIF                  DL1410
0102 I                                    P  31  320TODF                  DL1410
0103 I*    CATCHALL                                                       DL1410
0104 I        NS  08                                                      DL1410
0105 I*                                                                   DL1410
0106 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.**             S01194
0107 I*********************                                               S01194
0108 I***TABLE***NS**07***2 C0   3 C1  12 C1                              S01194
0109 I*******AND******13*C0                                               S01194
0110 I*********************                   1   1 RECI                  S01194
0111 I*********************                   2   30RECT                  S01194
0112 I*********************                  12  130RCDE                  S01194
0113 I*********************                  14  66 TITL                  S01194
0114 I*********************                  67  67 DATF                  S01194
0115 I*********************                  68  700DFBR                  S01194
0116 I*********************                  74  74 MODI1                 S01194
0117 I*********************                  75  75 MODI2                 S01194
0118 I*********************                  76  76 MODI3                 S01194
0119 I*********************               P  77  790RUND                  S01194
0120 I*********************                  80  86 RUNA                  S01194
0121 I*********************                  87  870SFLG                  S01194
0122 I*********************               P  90  920LCD                   S01194
0123 I*********************                  93  93 CHTP                  S01194
0124 I*********************               P  94  960TNLU                  S01194
0125 I*****CATCHALL********                                               S01194
0126 I********NS**08*******                                               S01194
0925 I**                                                                  S01117
     I**SPOOLU      DS                                              S01117E165
     I*****                                  83  90 SFILEU          S01117E165
     I*****                               B 123 1240SFNUMU          S01117E165
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
0315 I*                                                                   S01194
0127 C*                                                                   DL1410
0128 C*    FIRST CYCLE PROCESSING.                                        DL1410
0129 C   10                GOTO ENDFC                                     DL1410
0130 C                     SETON                     10                   DL1410
     C                     MOVEACPY@      BIS@   80
0131 C*                                                                   DL1410
0132 C*****ACCESS*INSTALLATION*CONTROL*DATA*RECORD*1.**                   DL1410
0133 C*********************EXSR ZSYSTM                                    DL1410
     C** READ BANK DETAILS VIA ACCESS PROGRAM                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0134 C*                                                                   DL1410
0135 C   01      TRCC      ADD  1         TRCC    50                      DL1410
0136 C   01      TREC      ADD  1         TREC    50                      DL1410
0137 C                     GOTO END                                       DL1410
0138 C*                                                                   DL1410
0139 C*    END OF FIRST CYCLE CALCULATIONS.                               DL1410
0140 C*                                                                   DL1410
0141 C           ENDFC     TAG                             ** ENDFC TAG **DL1410
0142 C*                                                                   DL1410
0143 C*    RECORD COUNTS AND HASH TOTALLING                               DL1410
0144 C   02                                                               DL1410
0145 COR 05                EXSR HASH                                      DL1410
0146 C*                                                                   DL1410
0147 C           TRCC      ADD  1         TRCC                            DL1410
0148 C           TREC      ADD  1         TREC                            DL1410
0149 C*                                                                   DL1410
0150 C   03                                                               DL1410
0151 COR 06                EXSR EXCP                                      DL1410
0152 C*                                                                   DL1410
0153 C           END       TAG                             ** END TAG ****DL1410
0154 C*                                                                   DL1410
0155 C*    LR CALCULATIONS                                                DL1410
0156 CLR         TREC      SUB  2         TREC                            DL1410
0157 C*                                                                   DL1410
0158 CLR 35                SETON                     U8                   DL1410
     C**                                                                  S01117
     C***ENSURE*TOTALS*SPOOL*FILE*RECORDED*BY RCF                   S01117E165
     C*R                   CALL 'ZSFILE'                            S01117E165
     C*R                   PARM *BLANK    SEQ     5                 S01117E165
     C*R                   PARM *BLANK    @PARM   3                 S01117E165
     C*R                   PARM           SFILEU                    S01117E165
     C*R                   PARM           SFNUMU                    S01117E165
     C*                                                                   S01194
0159 C*                                                                   DL1410
0160 C********************************************************************DL1410
0161 C*                                                                   DL1410
0162 C*    HASH SR. TO MAINTAIN HASH TOTALS.                              DL1410
0163 C*                                                                   DL1410
0164 C           HASH      BEGSR                           *** HASH ***   DL1410
0165 C*                                                                   DL1410
0166 C           PCPL      DIV  1000      ZZAMT                           DL1410
0167 C*                                                                   DL1410
0168 C*    HASH TOTALLING FOR S/MINTR OR S/MINTN                          DL1410
0169 C                     Z-ADDTOIC      ZZTOTI                          DL1410
0170 C                     Z-ADDTODC      ZZTOTD                          DL1410
0171 C                     EXSR GLZADD                                    DL1410
0172 C                     Z-ADDZZTOTI    TOIC   150                      DL1410
0173 C                     Z-ADDZZTOTD    TODC    30                      DL1410
0174 C           DRCC      ADD  1         DRCC    50                      DL1410
0175 C*                                                                   DL1410
0176 C*    HASH TOTALLING FOR S/MINTT                                     DL1410
0177 C                     Z-ADDTOTI      ZZTOTI                          DL1410
0178 C                     Z-ADDTOTD      ZZTOTD                          DL1410
0179 C                     EXSR GLZADD                                    DL1410
0180 C                     Z-ADDZZTOTI    TOTI   150                      DL1410
0181 C                     Z-ADDZZTOTD    TOTD    30                      DL1410
0182 C           DREC      ADD  1         DREC    50                      DL1410
0183 C*                                                                   DL1410
0184 C                     ENDSR                                          DL1410
0185 C********************************************************************DL1410
0186 C*                                                                   DL1410
0187 C*    SUBROUTINE TO HANDLE S/MINTR AND S/MINTN FOR :                 DL1410
0188 C*     EXCEPTION OUTPUT TO PRINT TOTAL LINES                         DL1410
0189 C*     & COMPARE CALCULATED TOTALS WITH TOTALS ON FILE               DL1410
0190 C*     & THEN ZEROISE CALCULATED TOTALS                              DL1410
0191 C*                                                                   DL1410
0192 C           EXCP      BEGSR                           ***  EXCP  ****DL1410
0193 C*                                                                   DL1410
0194 C                     SETON                     20                   DL1410
0195 C                     EXCPT                                          DL1410
0196 C                     SETOF                     20                   DL1410
0197 C*                                                                   DL1410
0198 C                     Z-ADDTOIC      ZZINT                           DL1410
0199 C                     Z-ADDTODC      ZZDEC                           DL1410
0200 C                     Z-ADDTOIF      ZZTOTI                          DL1410
0201 C                     Z-ADDTODF      ZZTOTD                          DL1410
0202 C                     EXSR GLZCMP                                    DL1410
0203 C  N35      ZZDIFI    COMP 0                    3535                 DL1410
0204 C  N35      ZZDIFD    COMP 0                    3535                 DL1410
0205 C  N35      TRCF      COMP TRCC                 3535                 DL1410
0206 C  N35      DRCF      COMP DRCC                 3535                 DL1410
0207 C*                                                                   DL1410
0208 C                     Z-ADD0         TRCC                            DL1410
0209 C                     Z-ADD0         DRCC                            DL1410
0210 C                     Z-ADD0         TOIC                            DL1410
0211 C                     Z-ADD0         TODC                            DL1410
0212 C*                                                                   DL1410
0213 C                     ENDSR                                          DL1410
0214 C*                                                                   DL1410
0215 C********************************************************************DL1410
0216 C*                                                                   DL1410
0217 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  DL1410
0218 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            DL1410
0219 C*                                                                   DL1410
0220 CSR         GLZADD    BEGSR                           *** GLZADD ****DL1410
0221 C*                                                                   DL1410
0222 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  DL1410
0223 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS DL1410
0224 C*                                                                   DL1410
0225 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       DL1410
0226 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  DL1410
0227 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  DL1410
0228 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  DL1410
0229 C*                                                                   DL1410
0230 CSR                   EXSR GLZSUM                                    DL1410
0231 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *DL1410
0232 C*                                                                   DL1410
0233 C********************************************************************DL1410
0234 C*                                                                   DL1410
0235 C* SUBROUTINE TO COMPARE AN AMOUNT TO THE TOTAL.                     DL1410
0236 C*      PARAMETERS. I/P - ZZINT - THE INTEGER PORTION OF THE NUMBER. DL1410
0237 C*                  I/P - ZZDEC - THE DECIMAL PORTION OF THE NUMBER. DL1410
0238 C*                  O/P - ZZDIFI - IS THE INTEGER DIFFERENCE.        DL1410
0239 C*                  O/P - ZZDIFD - IS THE DECIMAL DIFFERENCE.        DL1410
0240 C*                  O/P - ZZNEGD - FOR IMMEDIATE PRINTING ONLY.      DL1410
0241 C*                  O/P - 96 IS SET IF DIFFERENCE IS NEGATIVE.       DL1410
0242 C*                                                                   DL1410
0243 C*    IF AN ERROR HAS OCCURED ZZDIFI AND ZZDIFD WILL BE ZERO.        DL1410
0244 C*        '99' - OVERFLOW ERROR                                      DL1410
0245 C*        '97' - THE 'SIGN' ZONES OF ZZINT AND ZZDEC ARE DIFFERENT   DL1410
0246 C*                                                                   DL1410
0247 CSR         GLZCMP    BEGSR                           *** GLZCMP ****DL1410
0248 CSR                   SETOF                     9799                 DL1410
0249 CSR                   Z-ADDZZDEC     ZZDEC   30 919293DEFINE ZZDEC   DL1410
0250 CSR                   Z-ADDZZINT     ZZINT  150 949596DEFINE ZZINT   DL1410
0251 C* IF SIGN ZONES DIFFER, SET 97, & RETURN ZERO.                      DL1410
0252 CSR 91 95                                                            DL1410
0253 COR 92 94             SETON                     97    ERROR -MIXED   DL1410
0254 C*                                                           STATUS  DL1410
0255 CSR 97                GOTO ZZQUIT                     BRANCH TO ADMITDL1410
0256 C*                                                                   DL1410
0257 C*  SPECIAL CASES DEALT WITH FIRST                                   DL1410
0258 C*      EITHER AMOUNTS EQ '0' OR BOTH AMOUNTS 'EQ'                   DL1410
0259 CSR                   SETOF                     9192                 DL1410
0260 CSR                   SETOF                     9495                 DL1410
0261 CSR 93 96             SETON                     91    * IF I/P FIELD DL1410
0262 CSR 91                Z-ADDZZTOTI    ZZDIFI 150       *    ZERO      DL1410
0263 CSR 91                Z-ADDZZTOTD    ZZDIFD  30       *              DL1410
0264 CSR 91                GOTO ZZSIGN                                    DL1410
0265 C*                                                                   DL1410
0266 CSR         ZZTOTI    COMP ZZINT                    91* IF FIELDS EQ DL1410
0267 CSR 91      ZZTOTD    COMP ZZDEC                    91*              DL1410
0268 CSR 91                Z-ADD0         ZZDIFI           *              DL1410
0269 CSR 91                Z-ADD0         ZZDIFD           *              DL1410
0270 CSR 91                GOTO ZZCEND                                    DL1410
0271 C*                                                                   DL1410
0272 CSR         ZZTOTI    COMP 0                        91* IF TOTAL     DL1410
0273 CSR 91      ZZTOTD    COMP 0                        91*    ZERO      DL1410
0274 CSR 91                Z-SUBZZINT     ZZDIFI           *              DL1410
0275 CSR 91                Z-SUBZZDEC     ZZDIFD           *              DL1410
0276 C**                                                                  DL1410
0277 CSR         ZZSIGN    TAG                             *** ZZSIGN ****DL1410
0278 C*                                                                   DL1410
0279 C**   IF ZZDIFD IS ZERO, AND ZZDIFI IS NEG. SET UP ZZNEGD.           DL1410
0280 CSR                   SETOF                     96                   DL1410
0281 CSR 91      ZZDIFD    COMP 0                        94               DL1410
0282 CSR 94      ZZDIFI    COMP 0                      96                 DL1410
0283 CSR 96                MOVE '.000-'   ZZNEGD  5                       DL1410
0284 CSR 91                GOTO ZZCEND                                    DL1410
0285 C*      END OF SPECIAL CASES                                         DL1410
0286 C*                                                                   DL1410
0287 C* IF ZZTOTALS EQ 'B' AND ZZINT,ZZDEC EQ 'A'   THEN -                DL1410
0288 C*  TO COMPARE 'A' WITH 'B'                                          DL1410
0289 C*     1. STORE ORIGINAL VALUE OF 'B'.                               DL1410
0290 C*     2. NEGATE 'A'.                                                DL1410
0291 C*     3. ADD 'A' TO 'B'.                                            DL1410
0292 C*     4. 'B' IS NOW THE DIFFERENCE. STORE 'B' IN FIELD 'C'.         DL1410
0293 C*     5. RESTORE 'B'.                                               DL1410
0294 C*            N.B. 'A' EQ ZZINT AND ZZDEC                            DL1410
0295 C*                 'B' EQ ZZTOTI AND ZZTOTD                          DL1410
0296 C*                 'C' EQ ZZDIFI AND ZZDIFD                          DL1410
0297 C*                                                                   DL1410
0298 C*    STEP #1                                                        DL1410
0299 CSR                   Z-ADDZZTOTI    ZZSTRI 150                      DL1410
0300 CSR                   Z-ADDZZTOTD    ZZSTRD  30                      DL1410
0301 C*    STEP #2                                                        DL1410
0302 CSR                   Z-SUBZZINT     ZZAMTI 150                      DL1410
0303 CSR                   Z-SUBZZDEC     ZZAMTD  30                      DL1410
0304 C*    STEP #3                                                        DL1410
0305 CSR                   EXSR GLZSUM                                    DL1410
0306 CSR 99                GOTO ZZQUIT                                    DL1410
0307 C*    STEP #4                                                        DL1410
0308 CSR                   Z-ADDZZTOTI    ZZDIFI                          DL1410
0309 CSR                   MOVE ZZTOTD    ZZDIFD                          DL1410
0310 C*    STEP #5                                                        DL1410
0311 CSR                   Z-ADDZZSTRI    ZZTOTI 150                      DL1410
0312 CSR                   Z-ADDZZSTRD    ZZTOTD  30                      DL1410
0313 CSR                   GOTO ZZCEND                     BYPASS ADMIT   DL1410
0314 CSR         ZZQUIT    TAG                             ** ZZQUIT TAG**DL1410
0315 CSR                   Z-ADD0         ZZDIFI                          DL1410
0316 CSR                   Z-ADD0         ZZDIFD                          DL1410
0317 CSR         ZZCEND    ENDSR                           ** ZZCEND TAG**DL1410
0318 C*                                                                   DL1410
0319 C********************************************************************DL1410
0320 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            DL1410
0321 C*                        GLZADD, GLZSUB, GLZCMP.                    DL1410
0322 C*          PARAMETERS PASSED -                                      DL1410
0323 C*                     I/P ZZAMTI ZZAMTD                             DL1410
0324 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       DL1410
0325 C*                                                                   DL1410
0326 CSR         GLZSUM    BEGSR                           *** GLZSUM ****DL1410
0327 C*                                                                   DL1410
0328 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  DL1410
0329 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  DL1410
0330 CSR                   SETOF                     919293               DL1410
0331 CSR                   SETOF                     949599               DL1410
0332 C*                                                                   DL1410
0333 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      DL1410
0334 CSR         ZZAMTI    COMP 0                      9293               DL1410
0335 CSR 93      ZZAMTD    COMP 0                      9293               DL1410
0336 CSR 93                GOTO ZZSEND                     ZERO BYPASS    DL1410
0337 C*                                                                   DL1410
0338 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       DL1410
0339 CSR         ZZTOTI    COMP 0                      9193               DL1410
0340 CSR 93      ZZTOTD    COMP 0                      9193               DL1410
0341 C*                                                                   DL1410
0342 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           DL1410
0343 CSR 93                Z-ADDZZAMTI    ZZTOTI                          DL1410
0344 CSR 93                Z-ADDZZAMTD    ZZTOTD                          DL1410
0345 CSR 93                GOTO ZZSEND                     ZERO BYPASS    DL1410
0346 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        DL1410
0347 CSR 91N92                                                            DL1410
0348 CORN91 92             GOTO ZZOFPS                                    DL1410
0349 C*                                                                   DL1410
0350 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      DL1410
0351 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   DL1410
0352 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.DL1410
0353 C*                                                                   DL1410
0354 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VEDL1410
0355 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VEDL1410
0356 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           DL1410
0357 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           DL1410
0358 C*                                                                   DL1410
0359 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    DL1410
0360 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. DL1410
0361 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      DL1410
0362 CSRN99                Z-ADDZZWK2     ZZTOTD                          DL1410
0363 CSRN99                Z-ADDZZWK3     ZZTOTI                          DL1410
0364 C*                                                                   DL1410
0365 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. DL1410
0366 CSR 99                Z-ADD0         ZZAMT  153                      DL1410
0367 CSR                   GOTO ZZSEND                                    DL1410
0368 C*                                                                   DL1410
0369 C* THE 'SIGNS' ARE DIFFERENT                                         DL1410
0370 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**DL1410
0371 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            DL1410
0372 C*                                                                   DL1410
0373 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      DL1410
0374 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      DL1410
0375 C*                                                                   DL1410
0376 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           DL1410
0377 C*                                                                   DL1410
0378 CSR 91                Z-SUBZZTOTI    ZZTOTI                          DL1410
0379 CSR 91                Z-SUBZZTOTD    ZZTOTD                          DL1410
0380 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            DL1410
0381 C*                                                                   DL1410
0382 CSR         ZZTOTI    COMP ZZAMTI               93  95               DL1410
0383 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               DL1410
0384 C*                                                                   DL1410
0385 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   DL1410
0386 CSR 95                Z-ADD0         ZZTOTI                          DL1410
0387 CSR 95                Z-ADD0         ZZTOTD                          DL1410
0388 CSR 95                GOTO ZZSEND                                    DL1410
0389 C*                                                                   DL1410
0390 C* IF ZZTOT GT. ZZAMT.                                               DL1410
0391 CSR 93      ZZAMTD    COMP ZZTOTD               94                   DL1410
0392 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          DL1410
0393 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           DL1410
0394 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          DL1410
0395 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          DL1410
0396 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          DL1410
0397 C*                                                                   DL1410
0398 C*                                                                   DL1410
0399 C* IF ZZAMT GT. ZZTOT.                                               DL1410
0400 CSRN93      ZZTOTD    COMP ZZAMTD               94                   DL1410
0401 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      DL1410
0402 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           DL1410
0403 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          DL1410
0404 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          DL1410
0405 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          DL1410
0406 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          DL1410
0407 C*                                                                   DL1410
0408 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          DL1410
0409 CSR                   SETOF                     94                   DL1410
0410 CSR 93 91                                                            DL1410
0411 CORN93 92             SETON                     94                   DL1410
0412 CSR 94                Z-SUBZZTOTI    ZZTOTI                          DL1410
0413 CSR 94                Z-SUBZZTOTD    ZZTOTD                          DL1410
0414 C**                                                                  DL1410
0415 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            DL1410
0416 CSR 92                Z-SUBZZAMTI    ZZAMTI                          DL1410
0417 CSR 92                Z-SUBZZAMTD    ZZAMTD                          DL1410
0418 CSR         ZZSEND    TAG                             ** ZZSEND TAG *DL1410
0419 C**                                                                  DL1410
0420 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           DL1410
0421 CSR                   SETOF                     96                   DL1410
0422 CSR         ZZTOTD    COMP 0                        91               DL1410
0423 CSR 91      ZZTOTI    COMP 0                      96                 DL1410
0424 CSR 96                MOVE '.000-'   ZZNEGD  5                       DL1410
0425 CSR                   ENDSR                             ** ENDSR **  DL1410
0426 C********************************************************************DL1410
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
0427 C*********************                                               S01194
0428 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.***S01194
0429 C*********************                                               S01194
0430 C***********ZSYSTM****BEGSR                           *** ZSYSTM *** S01194
0431 C*********************                                               S01194
0432 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.***                 S01194
0433 C*********************MOVEL'01      'ZTABKY 12                       S01194
0434 C*********************MOVE '  10'    ZTABKY                          S01194
0435 C*********************                                               S01194
0436 C***********ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
0437 C**N99******RECI******COMP 'D'                  9999  ON, IS DELETED S01194
0438 C*********************                                               S01194
0439 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.**                  S01194
0440 C***********DATF******COMP 'M'                      98MMDDYY, 98 ON  S01194
0441 C*********************                                               S01194
0442 C*********************ENDSR                                          S01194
0443 C*********************                                               S01194
0444 C*********************                                               S01194
0445 C********************************************************************DL1410
0446 OMINTTMH D        01                                                 DL1410
0447 O                         LOT       64                               DL1410
0448 OMINTTMD D        02                                                 DL1410
0449 O       OR        05                                                 DL1410
0450 O                         LOT       64                               DL1410
0451 OMINTTMT T        LR                                                 DL1410
0452 O                                    1 'T'                           DL1410
0453 O                         TREC      19P                              DL1410
0454 O                         DREC      22P                              DL1410
0455 O                         TOTI      30P                              DL1410
0456 O                         TOTD      32P                              DL1410
0457 O*                                                                   DL1410
0458 O*L1410P1D**203   01                                       S01124    S01117
     ODL1410AUD  203   01                                                 S01117
0459 O***********                        22 'REFERENCE DL1410'            S01117
     O                                   24 'REFERENCE DL1410AU'          S01117
0460 O*************************TITL      89                               S01194
0460 O                         BJURPT    89                               S01194
0461 O                                  104 'DATE'                        DL1410
0462 O*************************RUNA     112                               S01194
0462 O                         BJMRDT   112                               S01194
0463 O                                  122 'PAGE'                        DL1410
0464 O                         PAGE  Z  127                               DL1410
0465 O        D  1     01                                                 DL1410
0466 O                                   66 'INTEREST PAYMENTS MERGE'     DL1410
0467 O                                   82 '- FILE CONTROLS'             DL1410
0468 O        D  3     01                                                 DL1410
0469 O                                   67 '------------------------'    DL1410
0470 O                                   82 '---------------'             DL1410
0471 O        E  1     20                                                 DL1410
0472 O                    03             11 'S/MINTR'                     DL1410
0473 O                    06             11 'S/MINTN'                     DL1410
0474 O                                   28 '-  RUN TOTALS'               DL1410
0475 O                                   59 'NUMBER'                      DL1410
0476 O                                   84 'VALUE'                       DL1410
0477 O        E  2     20                                                 DL1410
0478 O                                   11 '-------'                     DL1410
0479 O                                   28 '------------'                DL1410
0480 O                                   59 'OF RECORDS'                  DL1410
0481 O                                   84 'OF RECORDS'                  DL1410
0482 O        E  2     20                                                 DL1410
0483 O                                   31 'TOTAL RECORDS - ON FILE'     DL1410
0484 O                         TRCF  3   59                               DL1410
0485 O        E  2     20                                                 DL1410
0486 O                                   32 'TOTAL RECORDS - CALCULAT'    DL1410
0487 O                                   34 'ED'                          DL1410
0488 O                         TRCC  3   59                               DL1410
0489 O        E  2     20                                                 DL1410
0490 O                                   32 'DETAIL RECORDS - ON FILE'    DL1410
0491 O                         DRCF  3   59                               DL1410
0492 O                         TOIF  Z   81                               DL1410
0493 O                         TODF      84                               DL1410
0494 O        E  3     20                                                 DL1410
0495 O                                   32 'DETAIL RECORDS - CALCULA'    DL1410
0496 O                                   35 'TED'                         DL1410
0497 O                         DRCC  3   59                               DL1410
0498 O                         TOIC  Z   81                               DL1410
0499 O                         TODC      84                               DL1410
0500 O        T  1     LR                                                 DL1410
0501 O                                   28 'S/MINTT  -  RUN CONTROLS'    DL1410
0502 O        T  2     LR                                                 DL1410
0503 O                                   28 '-------     ------------'    DL1410
0504 O        T  2     LR                                                 DL1410
0505 O                                   28 'TOTAL RECORDS OUTPUT'        DL1410
0506 O                         TREC  3   59                               DL1410
0507 O        T  1     LR                                                 DL1410
0508 O                                   29 'DETAIL RECORDS OUTPUT'       DL1410
0509 O                         DREC  3   59                               DL1410
0510 O                         TOTI  Z   81                               DL1410
0511 O                         TOTD      84                               DL1410
0512 O        T 3      LR U8                                              DL1410
0513 O                                   72 '** DIFFERENCE **'            DL1410
     O        T 3      LR U7                                              S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7                                              S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7                                              S01117
     O                                   46 'KEY'                         S01117
     O                         DBOPTN    54                               S01117
2259 O        T 3      LR                                                 S01117
2260 O                                   71 '*** END OF REPORT***'        S01117
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
