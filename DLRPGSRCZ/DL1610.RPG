 001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL FRA/IRS rate changes expected extract')       *
0002 F*****************************************************************
0004 F*                                                               *
     F*  Midas - FRA/IRS Module
0004 F*                                                               *
0005 F*  DL1610 - FRA/IRS RATE CHANGES EXPECTED EXTRACT               *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD055733           Date 03Jul20               *
      *                 MD050139           Date 23Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL184             Date 07Dec16               *
      *                 AR568812           Date 02Jul10               *
      *                 CLE064             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 247511             Date 05May07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 163407             Date 28Feb02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 182812             Date 21Sep01               *
      *                 182808             Date 03Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CIR007             Date 11May01               *
      *                 182811             Date 28Apr01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01408             Date 15Aug96               *
      *                 097783             Date 06Feb96               *
     F*                 S01408             DATE 12MAR96               *
     F*                 046303             DATE 13JAN94               *
     F*                 E42688             DATE 05APR93               *
     F*                 E38323             DATE 30JUL92               *
     F*                 E30920             DATE 29JAN92               *
     F*                 S01195             DATE 03APR90               *
     F*                 S01194             DATE 03APR90               *
     F*                 S01117             DATE 03APR90               *
     F*                 S01157             DATE 29JAN89               *
     F*                 E14923             DATE 26AUG88               *
     F*                                                               *
     F*****************************************************************
0008 F*                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD055733 - COB: Multiple UTCHOBJEX calls in LEC06A           *
      *             components.                                       *
      *           - Redeliver of MD050139.                            *	
      *  MD050139- AOSARDR0 called every time causing performance     *
      *            issue. Recompile due to changes in /COPY           *
      *            ZFREQ/ZFRQ*.                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL184 - New Frequencies for Account Statements (Recompile)  *
      *  AR568812 - Deals with base rate code consist of alphabet does*
      *             not show in DL1620P1 report. Applied fix 225018.  *
      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
      *  247511 - IRS deals due for Rate Fixing within the next five  *
      *           working days are missing from the report.           *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  163407 - DL1620P1 reports matured deals.                     *
      *  182812 - Record must only be written to PF/DLDGXD if there   *
      *           is a next rate change date.  Amend SR/UNISR and     *
      *           SR/TNICSR to check if next rate change date is      *
      *           less than maturity date.                            *
      *  182808 - Interest fix date should be checked if rate has     *
      *           been fixed or not, not the value of effective       *
      *           interest rate.                                      *
      *  CIR007 - Overnight Index Swaps                               *
      *  182811 - FRA/IRS Rate Changes Expexted Report misleading for *
      *           cases where the report is generated after the rate  *
      *           fix date has passed but the rate change date is     *
      *           after the rundate. Fix is to calculate the next rate*
      *           change date where the rate fix date is greater than *
      *           current rate change date. Patterned fix after 090451*
      *           and partially applied fix 096447.                   *
     F*  CSD006 - Use long DS with SDBSRTPD.                          *
     F*  S01408 - Core Hook DL1610CCP2 added.                         *
     F*  097783 - Program is not reporting both 'ours' & 'theirs' if  *
     F*           they are the same (ie fix date and base rate type)  *
     F*           Fixed so that the report will output 'their' details*
     F*           (if due) regardless of 'our' details being the same *
     F*  S01408 - Core Hook DL1610CCP1 added.                         *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
     F*  E42688 - Ensure HASH TOTAL is not printed showing decimal    *
     F*           places as this causes confusion.                    *
     F*  E38323 - Recompilation of the program done due a change      *
0008 F*           in copy source ZFWDT subroutine                     *
     F*  E30920 - If deal forward-valued AND Short Term Rate NOT      *
     F*           entered then override the Next Rate Change Date     *
     F*           with the Value Date (but if STR entered then        *
     F*           Next Rate Change Date remains unchanged).           *
     F*           Associated with E30325.                             *
     F*  S01195 - New HOLIDAY processing                              *
     F*  S01194 - New STANDING DATA changes                           *
     F*  S01117 - MULTIBRANCHING changes                              *
0011 F*  S01157 - FRA/IRS enhancements - split deal type 'RL' into    *
     F*           'RR' (COLLAR), 'RP' (CAP) and 'RF' (FLOOR).         *
     F*         - Field ORTH is set up incorrectly for floors         *
     F*  E14923 - Addition of '*** END OF REPORT***' line.            *
0008 F*                                                               *
0010 F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/SPACE 3
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*       40      BYPASS FIRST CYCLE CALCS
     F*       41      SET ON WHEN RECORD EXTRACTED WITH 'OUR' DETAILS
     F****************FOR*DEAL*TYPES*OTHER*THAN*'FR'*OR*'RL'.*            S01157
     F*               FOR DEAL TYPES OTHER THAN 'FR','RR','RP' OR 'RF'.   S01157
     F*       50      PRINT CONTROL TOTALS REPORT
     F********61******CHAIN*TO*TABLE*FILE*UNSUCCESSFUL******              S01194
     F*       U6      FRA/IRS NOT PRESENT IN SYSTEM
     F*       U7      DATABASE ERROR
     F*       U8      GENERAL ERROR INDICATOR
     FDEALSDG IPE E                    DISK
     F*ABDLI**IF**E***********K        DISK                               S01194
     F************TABTB70F                          KIGNORE               S01194
     F************TABTE10F                          KIGNORE               S01194
     F************TABTE20F                          KIGNORE               S01194
     F************TABTG10F                          KIGNORE               S01194
     F************TABTG20F                          KIGNORE               S01194
     F************TABLETRF                          KIGNORE               S01194
     F************TABTB20F                          KIGNORE               S01194
     F************TABLETLF                          KIGNORE               S01194
     F************TABLETSF                          KIGNORE               S01194
     F************TABLET1F                          KIGNORE               S01194
     F************TABLET2F                          KIGNORE               S01194
     F************TABLET5F                          KIGNORE               S01194
     FDLDGXD  O   E           K        DISK
     FDLDGXZ  O   E                    DISK
     FDL1610AUO   F     132     OF     PRINTER
     F/SPACE 3
     E                    CPY@    1   1 80
0061 E**********          HCCY       25  3                                S01194
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E/COPY ZSRSRC,ZFREQBZ1                                               182811
     E/COPY ZSRSRC,ZDATE2Z1                                               182811
     I**********                                                          S01194
     I****RENAME*FIELD*ON*TABLETJ**HOLIDAY*CURRENCY*ARRAY*****            S01194
     I**********                                                          S01194
     I*ABLETJF**                                                          S01194
     I**********    HCCY                            RCCY                  S01194
     I**********                                                          S01194
     I****DATA*STRUCTURE**TO*HOLD*HOLIDAYS*FOR*CURRENCIES*****            S01194
     I**********                                                          S01194
     I**********  DS                             75                       S01194
     I**********                              1  75 HCCY                  S01194
     I**********                              1  75 RCCY                  S01194
     I**********                                                          S01194
     I****DATA*STRUCTURE**TO*HOLD*KEY**TO*CHAIN*TABLE*FILE****            S01194
     I**********                                                          S01194
     I*EY*******  DS                             12                       S01194
     I**********                              1   7 KEY1                  S01194
     I**********                              8  10 KEY2                  S01194
     I**********                             11  12 KEY3                  S01194
     I**********                                                          S01194
     I****LDA*FOR*HANDLING*DATABASE*ERRORS***                             S01194
     I**********                                                          S01194
     I*DA******* UDS                            256                       S01194
     I**********                            134 138 DBFILE                S01194
     I**********                            139 167 DBKEY                 S01194
     I**********                            168 175 DBPGM                 S01194
     I**********                            176 1770DBASE                 S01194
     IDBERR       DS                            256                       S01194
      **   Local data area to hold database error information             S01194
     I                                      134 141 DBFILE                S01194
     I                                      142 170 DBKEY                 S01194
     I                                      171 180 DBPGM                 S01194
     I                                      181 1830DBASE                 S01194
      *                                                                   S01194
0392 ISDBANK    E DSSDBANKPD                                              S01194
0393 I* Bank details accessed via access program                          S01194
0393 I*                                                                   S01194
0392 ISDBSRT    E DSSDBSRTPD                                              S01194
0393 I* Base Rate code details accessed via access program                S01194
0393 I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I* Module details accessed via access program                        S01194
0393 I*                                                                   S01194
     ISCSARD    E DSSCSARDPD                                                                  CIR007
      ** External data structure for SAR details                                              CIR007
      *                                                                                       CIR007
     I/COPY WNCPYSRC,DL1610I001
     IDSFDY     E DSDSFDY                                                 S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* Dummy data structures used by access programs                     S01194
     I* (DSSDY only used if file record over 150 chars. long)             S01194
     I/COPY ZSRSRC,ZAOZ2                                                  182811
     I*                                                                   S01194
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C*
     C           *IN40     CASEQ'0'       P01
     C                     END
     C**
     C** P02,  MAIN PROCESSING
     C**
     C           RECI      IFEQ 'D'                                       163407
     C           DTYP      CASEQ'FR'      P03
     C**         DTYP      CASEQ'RL'      P03                             S01157
     C           DTYP      CASEQ'RR'      P03                             S01157
     C           DTYP      CASEQ'RP'      P03                             S01157
     C           DTYP      CASEQ'RF'      P03                             S01157
     C           DTYP      CASEQ'RS'      P04
     C           DTYP      CASEQ'RX'      P05
     C                     END
     C                     MOVE '0'       *IN,41
     C                     ENDIF                                          163407
     C/SPACE 3
     C*
     C**  IF NO DETAILS PRESENT  HEADINGS SHOULD STILL BE PRINTED
     C*
     C*R******** *IN40     CASEQ'0'       ZSYSTM                          S01194
     C*R********           END                                            S01194
     C*R********           MOVE *BLANKS   FRKEY  12                       S01194
     C*R********           MOVEL'01'      FRKEY                           S01194
     C*R********           MOVE '40'      FRKEY                           S01194
     C*R******** FRKEY     CHAINTABTB40F             61                   S01194
     C*R******** *IN61     IFEQ '1'                                       S01194
     C*R********           SETON                     U7U8                 S01194
     C*R********           END                                            S01194
     C*                                                                   S01194
     CLR         *IN40     IFEQ '0'                                       S01194
     CLR                   EXSR #ZZ                                       S01194
     CLR                   END                                            S01194
     C*
     C**  IF NO DATABASE ERRORS ENCOUNTERED CHECK FOR FRA/IRS
     C*
     CLR         *INU7     IFEQ '0'
     CLR         *INU8     ANDEQ'0'
     C*R*********IRFRA     ANDNE'Y'                                       S01194
     CLR         BGFIIN    ANDNE'Y'                                       S01194
     CLR                   SETON                     U6
     CLR                   END
     C*
     C**  SETUP CONTROL REPORT HEADINGS
     C*
     CLR         *INU6     IFEQ '0'
     CLR         *INU7     ANDEQ'0'
     CLR         *INU8     ANDEQ'0'
     CLR                   SETON                     50
     CLR                   END
     C*
     C**  WHEN ALL THE DEALSDG RECORDS HAVE BEEN READ, WRITE THE HASH
     C**  TOTALS OF THE PRINCIPAL AMOUNTS TO THE TRAILER RECORD AND
     C**  PRODUCE A CONTROL REPORT.
     C*
     CLR                   MOVE 'T'       RECI
     CLR                   MOVE ZZTOTI    HSTP1
     CLR                   MOVE ZZTOTD    HSTP2
     CLR                   WRITEDLDGXZF
     CLR                   EXCPT
     C/EJECT
     C*******************************************************
     C*                                                     *
     C*                 INDEX TO SUBROUTINES                *
     C*                                                     *
     C*                                                     *
     C*        1.   P06 - RECORDS EXTRACTED                 *
     C*        2.   GLZADD                                  *
     C*        3.   GLZSUM                                  *
     C*********4.***P03*-*'FR'*OR*'RL'*DEAL*TYPE*************             S01157
     C*        4.   P03 - 'FR','RR','RP' OR 'RF' DEAL TYPE  *             S01157
     C*        5.   P04 - 'RS' DEAL TYPE                    *
     C*        6.   P05 - 'RX' DEAL TYPE                    *
     C*********7****ZDATE3                                  *             S01195
     C*        7.   ZFWDT                                   *             S01195
     C*********8****ZSYSTM                                  *             S01194
     C*        8.   #ZZ - ENSURE SDBANKPD READ IF NO        *             S01194
     C*                   RECORDS READ FROM DEALSDG         *             S01194
     C*********9****TABCHN                                  *             S01194
     C*        9.   *PSSR - DATABASE ERROR HANDLING         *             S01194
     C*                                                     *
     C*                                                     *
     C*******************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*   SR: P06    - TO PROCESS ALL DEAL TYPE RECORDS, SET THE RATE *
     C*                INDICATOR AND RATE TYPE VALUES AND WRITE       *
     C*                RECORD TO EXTRACT FILE                         *
     C*                                                               *
     C*   CALLED FROM :- P03, P04 AND P05                             *
     C*   CALLS       :- GLZADD                                       *
     C*                                                               *
     C*****************************************************************
     C           P06       BEGSR                           *** P06 **  *
     C**
     C**   IF A FORWARD RATE AGREEMENT (DTYP='FR'), SET THE
     C**   'FIXED/VARIABLE RATE INDICATOR' TO 'F'.
     C**
     C                     MOVE '0'       FVRI
     C           DTYP      IFEQ 'FR'
     C                     MOVE 'F'       FVRI
     C**
     C**   IF INTEREST RATE SWAPS (DTYP='RS' OR 'RX')
     C**   AND IF OUR OR THEIR BASE RATE IS A FLOATING RATE
     C**   SET THE RATE INDICATOR EQUAL TO 'V'.
     C                     ELSE
     C           DTYP      IFEQ 'RS'
     C           DTYP      OREQ 'RX'
     C********** YBRTT     IFGT 0                                                           AR568812
     C********** YBRTT     IFNE 0                                                    AR568812 CSD103
     C           YBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVE 'V'       FVRI
     C**
     C**  IF IT IS NOT A FLOATING RATE, SET THE INDICATOR TO 'FIXED'
     C**
     C                     ELSE
     C                     MOVE 'F'       FVRI
     C                     END
     C                     END
     C                     END
     C**
     C**  IF FWD RATE AGREEMENT, SET NEXT INT CHG DATE = VALUE DATE
     C           DTYP      IFEQ 'FR'
     C                     Z-ADDVDAT      XNICD
     C**
     C****IF*RS,*RX*OR*RL*DEAL,*AND*DEAL*NOT*REACHED*VALUE*DATE*YET,*     S01157
     C***IF*RS,RX,RR,RA*OR*RF*DEAL,AND*DEAL NOT REACHED VALUE DATE YS01157E30920
     C*****SET*NEXT*INT*CHG*DATE*=*VALUE DATE                             E30920
     C** If RS, RX, RP, RR, RF  AND IF deal forward-valued AND            E30920
     C** IF Short Term Rate NOT entered then override the Next            E30920
     C** Rate Change Date with the Value Date                             E30920
     C                     ELSE
     C********** VDAT      IFGE DNWD                                      S01194
     C           VDAT      IFGE BJDNWD                                    S01194
     C********** XSTRT     ANDEQ*ZERO                              E30920 182808
     C           XINFD     ANDLEVDAT                                      182808
     C                     Z-ADDVDAT      XNICD
     C                     END
     C                     END
     C**
     C**  USE SUBROUTINE GLZADD TO PRODUCE HASH TOTALS
     C**
     C           XPAMT     DIV  1000      ZZAMT
     C                     EXSR GLZADD
     C**
     C****ACCESS*TABLE*FOR*BASE*RATE*AND*BASE*RATE*NAME****               S01194
     C**********                                                          S01194
     C**********           MOVE *BLANKS   KEY                             S01194
     C**********           MOVEL'21'      KEY1                            S01194
     C**********           MOVE XCUCY     KEY2                            S01194
     C**********           MOVE XBRTT     KEY3                            S01194
     C********** KEY       CHAINTABLETKF             61                   S01194
      *                                                                   S01194
      * Move Base Rate type into a 2A field and then call                 S01194
      * access program to get base rate shortname                         S01194
     C                     MOVE XBRTT     @BRTT   2                       S01194
     C                     CALL 'AOBSRTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C                     PARM XCUCY     @CUCY   3                       S01194
     C                     PARM           @BRTT                           S01194
     C********** SDBSRT    PARM SDBSRT    DSFDY                     S01194CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
      *                                                                   S01194
     C**N61******RECI      COMP 'D'                  6161                 S01194
     C************IN61     IFEQ '1'                                       S01194
      *                                                                   S01194
      * If error occurs in access program move currency/base rate         S01194
      * fields into a work field to set up DBKEY correctly in             S01194
      * audit report and LDA                                              S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVELXCUCY     WRK5    5                       S01194
     C                     MOVE @BRTT     WRK5                            S01194
      *                                                                   S01194
     C                     Z-ADD0         BRTE
     C                     MOVE *BLANKS   BRTN
      *                                                                   S01194
      * Call DB error routine                                             S01194
     C                     MOVE '03'      DBASE               ************S01194
     C                     MOVE 'SDBSRTPD'DBFILE              *  DBERROR *S01194
     C                     MOVE WRK5      DBKEY               *     03   *S01194
     C                     EXSR *PSSR                         ************S01194
      *                                                                   S01194
      * else move Base Rate Shortname and Type into PF/DLDGXD fields      S01194
     C                     ELSE                                           S01194
     C                     MOVELBABSRN    BRTN                            S01194
     C                     MOVE BACBSR    BRTE                            S01194
     C                     END
      *                                                                   S01408
     C/COPY WNCPYSRC,DL1610CCP1                                           S01408
      *                                                                   S01408
     C**
     C**  IF 'FIXED/VARIABLE RATE INDICATOR' CALCULATED ABOVE IS
     C**  NOT EQUAL TO 'F', SET THE 'FIXED RATE' EQUAL TO ZERO
     C**
     C           FVRI      IFNE 'F'
     C                     MOVE *ZEROS    XEINR
     C                     END
     C**
     C**  IF 'FIXED/VARIABLE RATE INDICATOR' CALCULATED ABOVE IS
     C**  NOT EQUAL TO 'V', SET THE 'VARIABLE RATE TYPE' TO ZERO
     C**
     C           FVRI      IFNE 'V'
     C**********           MOVE *ZEROS    YBRTT                                               CSD103
     C                     MOVE *BLANKS   YBRTT                                               CSD103
     C                     END
     C**
     C**  WRITE A RECORD TO THE EXTRACT FILE
     C**
     C                     MOVE 'D'       RECI
     C                     WRITEDLDGXDF
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*   SR: GLZADD - TO SPLIT A 15,3 FIELD INTO A 15,0 'INTEGER'    *
     C*                FIELD AND A 3,0 'DECIMAL' FIELD                *
     C*                                                               *
     C*   CALLED FROM :- P06                                          *
     C*   CALLS       :- GLZSUM                                       *
     C*                                                               *
     C*****************************************************************
0480 C*
0481 CSR         GLZADD    BEGSR                           *** GLZADD ****
0482 C*
0483 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0484 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0485 C*
0486 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0487 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0488 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0489 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0490 C*
0491 CSR                   EXSR GLZSUM
0492 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*   SR: GLZSUM - TO ADD A 15,0 'INTEGER' FIELD AND A 3,0        *
     C*                'DECIMAL' FIELD TO THE HASH TOTAL FIELDS       *
     C*                                                               *
     C*   CALLED FROM :- GLZADD                                       *
     C*   CALLS       :-                                              *
     C*                                                               *
     C*****************************************************************
0500 C*
0501 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0502 C*
0503 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0504 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0505 CSR                   SETOF                     919293
0506 CSR                   SETOF                     949599
0507 C*
0508 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0509 CSR         ZZAMTI    COMP 0                      9293
0510 CSR 93      ZZAMTD    COMP 0                      9293
0511 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0512 C*
0513 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0514 CSR         ZZTOTI    COMP 0                      9193
0515 CSR 93      ZZTOTD    COMP 0                      9193
0516 C*
0517 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0518 CSR 93                Z-ADDZZAMTI    ZZTOTI
0519 CSR 93                Z-ADDZZAMTD    ZZTOTD
0520 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0521 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0522 CSR 91N92
0523 CORN91 92             GOTO ZZOFPS
0524 C*
0525 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0526 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0527 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0528 C*
0529 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0530 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0531 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0532 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0533 C*
0534 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0535 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0536 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0537 CSRN99                Z-ADDZZWK2     ZZTOTD
0538 CSRN99                Z-ADDZZWK3     ZZTOTI
0539 C*
0540 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0541 CSR 99                Z-ADD0         ZZAMT  153
0542 CSR                   GOTO ZZSEND
0543 C*
0544 C* THE 'SIGNS' ARE DIFFERENT
0545 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0546 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0547 C*
0548 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0549 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0550 C*
0551 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0552 C*
0553 CSR 91                Z-SUBZZTOTI    ZZTOTI
0554 CSR 91                Z-SUBZZTOTD    ZZTOTD
0555 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0556 C*
0557 CSR         ZZTOTI    COMP ZZAMTI               93  95
0558 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0559 C*
0560 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0561 CSR 95                Z-ADD0         ZZTOTI
0562 CSR 95                Z-ADD0         ZZTOTD
0563 CSR 95                GOTO ZZSEND
0564 C*
0565 C* IF ZZTOT GT. ZZAMT.
0566 CSR 93      ZZAMTD    COMP ZZTOTD               94
0567 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0568 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0569 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0570 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0571 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0572 C*
0573 C*
0574 C* IF ZZAMT GT. ZZTOT.
0575 CSRN93      ZZTOTD    COMP ZZAMTD               94
0576 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0577 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0578 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0579 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0580 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0581 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0582 C*
0583 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0584 CSR                   SETOF                     94
0585 CSR 93 91
0586 CORN93 92             SETON                     94
0587 CSR 94                Z-SUBZZTOTI    ZZTOTI
0588 CSR 94                Z-SUBZZTOTD    ZZTOTD
0589 C**
0590 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0591 CSR 92                Z-SUBZZAMTI    ZZAMTI
0592 CSR 92                Z-SUBZZAMTD    ZZAMTD
0593 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0594 C**
0595 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0596 CSR                   SETOF                     96
0597 CSR         ZZTOTD    COMP 0                        91
0598 CSR 91      ZZTOTI    COMP 0                      96
0599 CSR 96                MOVE '.000-'   ZZNEGD  5
0600 CSR                   ENDSR                             ** ENDSR **
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C****SR:*P03****-*TO*PROCESS*'FR'*OR*'RL'*DEAL*TYPE*RECORDS*******   S01157
     C*   SR: P03    - TO PROCESS FR,RR,RA OR RF DEAL TYPE RECORDS    *   S01157
     C*                                                               *
     C*   CALLED FROM :- P02                                          *
     C*                                                               *
     C*   CALLS       :- P06                                          *
     C*                                                               *
     C*****************************************************************
     C**
     C           P03       BEGSR                           *** P03 **  *
     C**
     C**
     C**   IF 'OUR BASE RATE' TYPE IS A FLOATING RATE (UBRTT > 0)
     C**   AND IF 'OUR INTEREST FIX DATE' IS WITHIN 5 MIDAS WORKING
     C**   DAYS AND LESS THAN OR EQUAL TO THE 'FIX DAY CONTROL NUMBER'
     C**   CALCULATED IN P01 ABOVE, THEN EXTRACT A RECORD  WITH 'OUR'
     C**   DETAILS.
     C**
     C********** UBRTT     IFGT 0                                                           AR568812
     C********** UBRTT     IFNE 0                                                    AR568812 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C********** UINFD     IFGT RUND                                      S01194
     C           UINFD     IFGT BJRDNB                                    S01194
     C           UINFD     ANDLEZDYNBR
     C/COPY WNCPYSRC,DL1610C007
     C                     MOVE UINFD     XINFD
     C                     MOVE UCUCY     XCUCY
     C                     MOVE UBRTT     XBRTT
     C           UNICD     IFLT UINFD                                     182811
     C           UNICD     OREQ UINFD                                     182811
     C           UFRFD     ANDNE0                                         182811
     C                     Z-ADDZDYNBR    #DYNBR  50                                          247511
     C                     EXSR UNICSR                                    182811
     C                     Z-ADD#DYNBR    ZDYNBR                                              247511
     C                     ELSE                                           182811
     C                     MOVE UNICD     XNICD
     C                     ENDIF                                          182811
     C                     MOVE UPAMT     XPAMT
     C                     Z-ADDUEINR     XSTRT  117                      E30920
     C                     MOVE 'OURS  '  ORTH
     C/COPY WNCPYSRC,DL1610C013
     C*                                                                   S01157
     C* FLOORS OPERATE IN OPPOSITE WAY TO CAPS/COLLARS                    S01157
     C* HENCE MOVE THEIR TO ORTH                                          S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RF'                                      S01157
     C                     MOVE 'THEIRS'  ORTH                            S01157
     C                     END                                            S01157
     C**
     C**      THE 'FIXED RATE' AND 'VARIABLE RATE TYPE' OUTPUT FIELD
     C**      VALUES ARE SET UP WITH 'THEIR' DETAILS
     C**
     C                     Z-ADDTEINR     XEINR
     C**********           Z-ADDTBRTT     YBRTT                                               CSD103
     C                     MOVELTBRTT     YBRTT                                               CSD103
     C                     EXSR P06
     C                     END
     C**
     C**   OTHERWISE, IF 'THEIR INTEREST FIX DATE' IS WITHIN 5 MIDAS
     C*****WORKING*DAYS*(TINFD*>*RUND)*AND*IS*LESS*THAN*OR*EQUAL*TO**     S01194
     C**   WORKING DAYS (TINFD > BJRDNB) AND IS LESS THAN OR EQUAL TO     S01194
     C**   THE 'FIX DAY' CONTROL DAY NUMBER CALCULATED IN P01 ABOVE,
     C**   EXTRACT A RECORD WITH 'THEIR' DETAILS.
     C**
     C                     ELSE
     C********** TINFD     IFGT RUND                                      S01194
     C           TINFD     IFGT BJRDNB                                    S01194
     C           TINFD     ANDLEZDYNBR
     C/COPY WNCPYSRC,DL1610C008
     C                     MOVE TINFD     XINFD
     C                     MOVE TCUCY     XCUCY
     C                     MOVE TBRTT     XBRTT
     C           TNICD     IFLT TINFD                                     182811
     C           TNICD     OREQ TINFD                                     182811
     C           TFRFD     ANDNE0                                         182811
     C                     Z-ADDZDYNBR    #DYNBR  50                                          247511
     C                     EXSR TNICSR                                    182811
     C                     Z-ADD#DYNBR    ZDYNBR                                              247511
     C                     ELSE                                           182811
     C                     MOVE TNICD     XNICD
     C                     ENDIF                                          182811
     C                     MOVE TPAMT     XPAMT
     C                     Z-ADDTEINR     XSTRT                           E30920
     C                     MOVE 'THEIRS'  ORTH
     C/COPY WNCPYSRC,DL1610C014
     C*                                                                   S01157
     C* FLOORS OPERATE IN OPPOSITE WAY TO CAPS/COLLARS                    S01157
     C* HENCE MOVE OUR TO ORTH                                            S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RF'                                      S01157
     C                     MOVE 'OURS  '  ORTH                            S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     Z-ADDUEINR     XEINR
     C**********           Z-ADDUBRTT     YBRTT                                               CSD103
     C                     MOVELUBRTT     YBRTT                                               CSD103
     C                     EXSR P06
     C                     END
     C                     END
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*   SR: P04    - TO PROCESS 'RS'DEAL TYPE RECORDS               *
     C*                                                               *
     C*   CALLED FROM :- P02                                          *
     C*                                                               *
     C*   CALLS       :- P06                                          *
     C*                                                               *
     C*****************************************************************
     C**
     C           P04       BEGSR                           *** P04 **  *
     C**
     C**   IF 'OUR BASE RATE' TYPE IS A FLOATING RATE (UBRTT > 0)
     C**   AND IF 'OUR INTEREST FIX DATE' IS WITHIN 5 MIDAS WORKING
     C**   DAYS AND LESS THAN OR EQUAL TO THE 'FIX DAY CONTROL NUMBER'
     C**   EXTRACT A RECORD WITH 'OUR' INTEREST DETAILS
     C**
     C/COPY WNCPYSRC,DL1610C015
      *                                                                                       CIR007
      ** For OIS deals, the program must check Our Next Interest                              CIR007
      ** Payment Date, UNIPD.                                                                 CIR007
     C           CIR007    IFEQ 'Y'                                                           CIR007
      *                                                                                       CIR007
     C           UNIPD     IFEQ *ZERO                                                         CIR007
     C                     Z-ADDMDAT      UNIPD                                               CIR007
     C                     ENDIF                                                              CIR007
     C********** UBRTT     IFGT 0                                                    CIR007 AR568812
     C********** UBRTT     IFNE 0                                                    AR568812 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UICFR     ANDEQ'O'                                                           CIR007
     C           UNIPD     ANDGTBJRDNB                                                        CIR007
     C           UNIPD     ANDLEZDYNBR                                                        CIR007
     C                     MOVE *ON       *IN41                                               CIR007
     C                     MOVE UNIPD     XINFD                                               CIR007
     C                     MOVE UCUCY     XCUCY                                               CIR007
     C                     MOVE UBRTT     XBRTT                                               CIR007
     C                     MOVE UNIPD     XNICD                                               CIR007
     C                     MOVE UPAMT     XPAMT                                               CIR007
     C                     Z-ADDUEINR     XSTRT                                               CIR007
     C                     MOVE 'OURS  '  ORTH                                                CIR007
      *                                                                                       CIR007
      ** The Fixed Rate and Variable Rate Type output fields are set                          CIR007
      ** up with 'Their' details                                                              CIR007
     C                     Z-ADDTEINR     XEINR                                               CIR007
     C**********           Z-ADDTBRTT     YBRTT                                        CIR007 CSD103
     C                     MOVELTBRTT     YBRTT                                               CSD103
     C                     EXSR P06                                                           CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C********** UBRTT     IFGT 0                                                           AR568812
     C********** UBRTT     IFNE 0                                                    AR568812 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C********** UINFD     ANDGTRUND                                      S01194
     C           UINFD     ANDGTBJRDNB                                    S01194
     C           UINFD     ANDLEZDYNBR
     C           UICFR     ANDNE'O'                                                           CIR007
     C/COPY WNCPYSRC,DL1610C009
     C                     MOVE '1'       *IN,41
     C                     MOVE UINFD     XINFD
     C                     MOVE UCUCY     XCUCY
     C                     MOVE UBRTT     XBRTT
     C           UNICD     IFLT UINFD                                     182811
     C           UNICD     OREQ UINFD                                     182811
     C           UFRFD     ANDNE0                                         182811
     C                     Z-ADDZDYNBR    #DYNBR  50                                          247511
     C                     EXSR UNICSR                                    182811
     C                     Z-ADD#DYNBR    ZDYNBR                                              247511
     C                     ELSE                                           182811
     C                     MOVE UNICD     XNICD
     C                     ENDIF                                          182811
     C                     MOVE UPAMT     XPAMT
     C                     Z-ADDUEINR     XSTRT                           E30920
     C                     MOVE 'OURS  '  ORTH
     C**
     C**      THE 'FIXED RATE' AND 'VARIABLE RATE TYPE' OUTPUT FIELD
     C**      VALUES ARE SET UP WITH 'THEIR' DETAILS
     C**
     C                     Z-ADDTEINR     XEINR
     C**********           Z-ADDTBRTT     YBRTT                                               CSD103
     C                     MOVELTBRTT     YBRTT                                               CSD103
     C           XNICD     IFGT 0                                         182812
     C                     EXSR P06
     C                     END                                            182812
     C/COPY WNCPYSRC,DL1610C016
     C                     END
     C**
     C**   ALSO, IF 'THEIR BASE RATE TYPE' IS A FLOATING RATE
     C**   (TBRTT > 0), AND IF 'THEIR INTEREST FIX DATE' IS WITHIN 5
     C**   MIDAS WORKING DAYS (TINFD > 'RUN DAY NUMBER') AND IS LESS
     C**   THAN OR EQUAL TO 'FIX CONTROL' DAY NUMBER FROM P01 ABOVE,
     C**
     C/COPY WNCPYSRC,DL1610C017
      *                                                                                       CIR007
      ** For OIS deals, the program must check Their Next Interest                            CIR007
      ** Payment Date, TNIPD.                                                                 CIR007
     C           CIR007    IFEQ 'Y'                                                           CIR007
      *                                                                                       CIR007
     C           TNIPD     IFEQ *ZERO                                                         CIR007
     C                     Z-ADDMDAT      TNIPD                                               CIR007
     C                     ENDIF                                                              CIR007
     C********** TBRTT     IFGT 0                                                    CIR007 AR568812
     C********** TBRTT     IFNE 0                                                    AR568812 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           TICFR     ANDEQ'O'                                                           CIR007
     C           TNIPD     ANDGTBJRDNB                                                        CIR007
     C           TNIPD     ANDLEZDYNBR                                                        CIR007
     C                     MOVE TNIPD     XINFD                                               CIR007
     C                     MOVE TCUCY     XCUCY                                               CIR007
     C                     MOVE TBRTT     XBRTT                                               CIR007
     C                     MOVE TNIPD     XNICD                                               CIR007
     C                     MOVE TPAMT     XPAMT                                               CIR007
     C                     Z-ADDTEINR     XSTRT                                               CIR007
     C                     MOVE 'THEIRS'  ORTH                                                CIR007
     C                     Z-ADDUEINR     XEINR                                               CIR007
     C**********           Z-ADDUBRTT     YBRTT                                        CIR007 CSD103
     C                     MOVELUBRTT     YBRTT                                               CSD103
     C                     EXSR P06                                                           CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C********** TBRTT     IFGT 0                                                           AR568812
     C********** TBRTT     IFNE 0                                                    AR568812 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C********** TINFD     ANDGTRUND                                      S01194
     C           TINFD     ANDGTBJRDNB                                    S01194
     C           TINFD     ANDLEZDYNBR
     C           TICFR     ANDNE'O'                                                           CIR007
     C/COPY WNCPYSRC,DL1610C010
     C*                                                                   097783
0002 C*****THEN*IF*A*RECORD*HAS*BEEN*OUTPUT*WITH*'OUR'*DETAILS*ABOVE***   097783
0002 C*****(*IN41=1),*ONLY*OUTPUT*A*RECORD*WITH*'THEIR'*DETAILS*IF*****   097783
0002 C*****THERE*IS*A*DIFFERENCE*BETWEEN*'OUR'*AND*'THEIR'*BASE*RATE***   097783
0002 C*****TYPE*OR*INTEREST*FIX*DATE.**********************************   097783
     C                     MOVE TINFD     XINFD
     C                     MOVE TCUCY     XCUCY
     C                     MOVE TBRTT     XBRTT
     C           TNICD     IFLT TINFD                                     182811
     C           TNICD     OREQ TINFD                                     182811
     C           TFRFD     ANDNE0                                         182811
     C                     Z-ADDZDYNBR    #DYNBR  50                                          247511
     C                     EXSR TNICSR                                    182811
     C                     Z-ADD#DYNBR    ZDYNBR                                              247511
     C                     ELSE                                           182811
     C                     MOVE TNICD     XNICD
     C                     ENDIF                                          182811
     C                     MOVE TPAMT     XPAMT
     C                     Z-ADDTEINR     XSTRT                           E30920
     C                     MOVE 'THEIRS'  ORTH
     C************IN41     IFEQ '1'                                       097783
     C***********UBRTT     IFNE TBRTT                                     097783
     C***********UINFD     ORNE TINFD                                     097783
     C***********                                                         097783
     C*****THE*'FIXED RATE' AND 'VARIABLE RATE TYPE' OUTPUT FIELD         097783
     C*****VALUES ARE SET UP WITH 'OUR' DETAILS                           097783
     C**********                                                          097783
     C**********           Z-ADDUEINR     XEINR                           097783
     C**********           Z-ADDUBRTT     YBRTT                           097783
     C**********           EXSR P06                                       097783
     C**********           END                                            097783
     C**********                                                          097783
     C*****IF*A*RECORD*HAS*NOT*BEEN*OUTPUT*ALREADY*AND*'THEIR*BASE*RATE   097783
     C*****TYPE'*IS*A*FLOATING*RATE,*EXTRACT*THE*RECORD*WITH*'THEIR'***   097783
     C*****DETAILS**PROVIDING*THE*'INTEREST*FIX*DATE'*IS*WITHIN*5******   097783
     C*****MIDAS*WORKING*DAYS.*****************************************   097783
     C**********                                                          097783
     C**********           ELSE                                           097783
     C                     Z-ADDUEINR     XEINR
     C**********           Z-ADDUBRTT     YBRTT                                               CSD103
     C                     MOVELUBRTT     YBRTT                                               CSD103
     C           XNICD     IFGT 0                                         182812
     C                     EXSR P06
     C                     END                                            182812
     C/COPY WNCPYSRC,DL1610C018
     C**********           END                                            097783
     C                     END
     C                     ENDSR
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*   SR: P05    - TO PROCESS 'RX' DEAL TYPE RECORDS              *
     C*                                                               *
     C*   CALLED FROM :- P02                                          *
     C*                                                               *
     C*   CALLS       :- P06                                          *
     C*                                                               *
     C*****************************************************************
     C**
     C           P05       BEGSR                           *** P05 **  *
     C**
     C**   IF 'OUR BASE RATE' TYPE IS A FLOATING RATE (UBRTT > 0)
     C**   AND IF 'OUR INTEREST FIX DATE' IS WITHIN 5 MIDAS WORKING
     C**   DAYS AND LESS THAN OR EQUAL TO THE 'FIX DAY CONTROL NUMBER'
     C**   EXTRACT A RECORD WITH 'OUR'INTEREST DETAILS
     C**
     C********** UBRTT     IFGT 0                                                           AR568812
     C********** UBRTT     IFNE 0                                                    AR568812 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C********** UINFD     ANDGTRUND                                      S01194
     C           UINFD     ANDGTBJRDNB                                    S01194
     C           UINFD     ANDLEZDYNBR
     C/COPY WNCPYSRC,DL1610C011
     C                     MOVE '1'       *IN,41
     C                     MOVE UINFD     XINFD
     C                     MOVE UCUCY     XCUCY
     C                     MOVE UBRTT     XBRTT
     C           UNICD     IFLT UINFD                                     182811
     C           UNICD     OREQ UINFD                                     182811
     C           UFRFD     ANDNE0                                         182811
     C                     Z-ADDZDYNBR    #DYNBR  50                                          247511
     C                     EXSR UNICSR                                    182811
     C                     Z-ADD#DYNBR    ZDYNBR                                              247511
     C                     ELSE                                           182811
     C                     MOVE UNICD     XNICD
     C                     ENDIF                                          182811
     C                     MOVE UPAMT     XPAMT
     C                     Z-ADDUEINR     XSTRT                           E30920
     C                     MOVE 'OURS  '  ORTH
     C**
     C**      THE 'FIXED RATE' AND 'VARIABLE RATE TYPE' OUTPUT FIELD
     C**      VALUES ARE SET UP WITH 'THEIR' DETAILS
     C**
     C                     Z-ADDTEINR     XEINR
     C**********           Z-ADDTBRTT     YBRTT                                               CSD103
     C                     MOVELTBRTT     YBRTT                                               CSD103
     C           XNICD     IFGT 0                                         182812
     C                     EXSR P06
     C                     END                                            182812
     C                     END
     C**
     C**   ALSO, IF 'THEIR BASE RATE TYPE' IS A FLOATING RATE
     C**   (TBRTT > 0), AND IF 'THEIR INTEREST FIX DATE' IS WITHIN 5
     C**   MIDAS WORKING DAYS (TINFD > 'RUN DAY NUMBER') AND IS LESS
     C**   THAN OR EQUAL TO 'FIX CONTROL' DAY NUMBER FROM P01 ABOVE,
     C**
     C********** TBRTT     IFGT 0                                                           AR568812
     C********** TBRTT     IFNE 0                                                    AR568812 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C********** TINFD     ANDGTRUND                                      S01194
     C           TINFD     ANDGTBJRDNB                                    S01194
     C           TINFD     ANDLEZDYNBR
     C/COPY WNCPYSRC,DL1610C012
     C**
     C**   THEN IF A RECORD HAS BEEN OUTPUT WITH 'OUR' DETAILS ABOVE
     C**   (*IN41=1), ONLY OUTPUT A RECORD WITH 'THEIR' DETAILS IF
     C**   THERE IS A DIFFERENCE BETWEEN 'OUR' AND 'THEIR' BASE RATE
     C**   TYPE OR INTEREST FIX DATE OR CURRENCY.
     C**
     C                     MOVE TINFD     XINFD
     C                     MOVE TCUCY     XCUCY
     C                     MOVE TBRTT     XBRTT
     C           TNICD     IFLT TINFD                                     182811
     C           TNICD     OREQ TINFD                                     182811
     C           TFRFD     ANDNE0                                         182811
     C                     Z-ADDZDYNBR    #DYNBR  50                                          247511
     C                     EXSR TNICSR                                    182811
     C                     Z-ADD#DYNBR    ZDYNBR                                              247511
     C                     ELSE                                           182811
     C                     MOVE TNICD     XNICD
     C                     ENDIF                                          182811
     C                     MOVE TPAMT     XPAMT
     C                     Z-ADDTEINR     XSTRT                           E30920
     C                     MOVE 'THEIRS'  ORTH
     C**
     C**   THE 'FIXED RATE' AND 'VARIABLE RATE TYPE' OUTPUT FIELD
     C**   VALUES ARE SET UP WITH 'OUR' DETAILS
     C**
     C                     Z-ADDUEINR     XEINR
     C**********           Z-ADDUBRTT     YBRTT                                               CSD103
     C                     MOVELUBRTT     YBRTT                                               CSD103
     C           *IN41     IFEQ '1'
     C           UBRTT     IFNE TBRTT
     C           UINFD     ORNE TINFD
     C           UCUCY     ORNE TCUCY
      *                                                                   182812
     C           XNICD     IFGT 0                                         182812
     C                     EXSR P06
     C                     END                                            182812
      *                                                                   182812
     C                     END
     C**
     C**   IF A RECORD HAS NOT BEEN OUTPUT ALREADY AND 'THEIR BASE RATE
     C**   TYPE' IS A FLOATING RATE, EXTRACT THE RECORD WITH 'THEIR'
     C**   DETAILS  PROVIDING THE 'INTEREST FIX DATE' IS WITHIN 5
     C**   MIDAS WORKING DAYS.
     C**
     C                     ELSE
      *                                                                   182812
     C           XNICD     IFGT 0                                         182812
     C                     EXSR P06
     C                     END                                            182812
      *                                                                   182812
     C                     END
     C                     END
     C                     ENDSR
     C/EJECT
      *****************************************************************   182811
      *                                                               *   182811
      *  SR/UNICSR - To calculate our next interest change date       *   182811
      *                                                               *   182811
      *****************************************************************   182811
     C           UNICSR    BEGSR                                          182811
     C           UICFR     IFNE ' '                                       182811
     C                     MOVE UICFR     ZFREQ                           182811
     C                     Z-ADDUICBD     ZDAYNO                          182811
     C                     Z-ADDUICFD     ZMDAY                           182811
     C                     MOVE UCUCY     ZCCY                            182811
     C                     MOVE BJSLCD    ZLOC                            182811
     C                     EXSR ZFREQB                                    182811
     C                     Z-ADD0         ZNRDYS                          182811
     C                     MOVE BJSLCD    ZLOC                            182811
     C                     EXSR ZFWDT                                     182811
      *                                                                   182812
     C           ZDYNBR    IFLT MDAT                                      182812
     C                     Z-ADDZDYNBR    XNICD                           182811
     C                     ELSE                                           182812
     C                     Z-ADD0         XNICD                           182812
     C                     END                                            182812
      *                                                                   182812
     C                     ELSE                                           182811
     C                     Z-ADD0         XNICD                           182811
     C                     ENDIF                                          182811
     C                     ENDSR                                          182811
     C/EJECT                                                              182811
      *****************************************************************   182811
      *                                                               *   182811
      *  SR/TNICSR - To calculate their next interest change date     *   182811
      *                                                               *   182811
      *****************************************************************   182811
     C           TNICSR    BEGSR                                          182811
     C           TICFR     IFNE ' '                                       182811
     C                     MOVE TICFR     ZFREQ                           182811
     C                     Z-ADDTICBD     ZDAYNO                          182811
     C                     Z-ADDTICFD     ZMDAY                           182811
     C                     MOVE TCUCY     ZCCY                            182811
     C                     MOVE BJSLCD    ZLOC                            182811
     C                     EXSR ZFREQB                                    182811
     C                     Z-ADD0         ZNRDYS                          182811
     C                     MOVE BJSLCD    ZLOC                            182811
     C                     EXSR ZFWDT                                     182811
      *                                                                   182812
     C           ZDYNBR    IFLT MDAT                                      182812
     C                     Z-ADDZDYNBR    XNICD                           182811
     C                     ELSE                                           182812
     C                     Z-ADD0         XNICD                           182812
     C                     END                                            182812
      *                                                                   182812
     C                     ELSE                                           182811
     C                     Z-ADD0         XNICD                           182811
     C                     ENDIF                                          182811
     C                     ENDSR                                          182811
     C/EJECT                                                              182811
     C/COPY ZSRSRC,ZFREQBZ2                                               182811
     C/COPY ZSRSRC,ZDATE1Z2                                               182811
     C/COPY ZSRSRC,ZDATE2Z2                                               182811
     C/EJECT                                                              182811
     C*****************************************************************   S01195
     C**********                                                      *   S01195
     C****SR**ZDATE3***TO*CALCULATE*ANY*NUMBER*OF*WORKING*DAYS*********   S01195
     C*****************FORWARD*IN*ANY*CURRENCY*************************   S01195
     C**********                                                      *   S01195
     C****CALLED*FROM**-*P01***                                       *   S01195
     C**********                                                          S01195
     C****CALLS*********                                              *   S01195
     C**********                                                      *   S01195
     C*****************************************************************   S01195
     C**********                                                          S01195
     C***********************************************                     S01195
     C*****SUBROUTINE*CHANGED***                    *                     S01195
     C*****CHAINING*TAKES*PLACE*TO*TABDLI*NOT*TABLE**                     S01195
1226 C***********************************************                  ***S01195
1232 C*********THIS*SR**CAN*BE*USED*WHEN*THE*INPUT*CYCLE*IS*RUNNING*AS    S01195
1233 C*********HOLIDAY*RECORDS*ARE*ACCESSED*BY*CHAIN**THEREFORE*NEWLY*    S01195
1234 C*********ADDED*RECORDS*IN*THE*OVERFLOW*AREA*CAN*ALSO*BE*ACCESSED.   S01195
1235 C**********                                                          S01195
1236 C********** ZDATE3    BEGSR                           *** ZDATE3 *** S01195
1237 C**********                                                          S01195
1238 C*****CALCULATIONS*TO*DEFINE*INPUT*FIELDS***                         S01195
1239 C**********           Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01195
1240 C**********           MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01195
1241 C**********           Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01195
1242 C**********                                           DAYS FORWARD   S01195
1243 C*****CLEAR*COUNT*OF*NBR*OF*DAYS*ADDED**&*DEFINE*ZDYNBR****          S01195
1244 C**********           Z-ADD0         ZDCNT   20                      S01195
1245 C**********           Z-ADDZDAYNO    ZDYNBR  50                      S01195
1246 C**********                                                          S01195
1247 C*****LOOP*TO*INCREMENT*DAY*NUMBER*AND*CHECK*FOR*HOLIDAY***          S01195
1248 C********** ZDLOP1    TAG                             ** ZDLOP1 TAG *S01195
1249 C**********                                                          S01195
1250 C**********           SETOF                     9596                 S01195
1251 C********** ZDYNBR    ADD  1         ZDYNBR                          S01195
1252 C**********                                                          S01195
1253 C*****SET*KEY*FOR*FIRST*HOLIDAY*RECORD****                           S01195
1254 C**********           MOVEL'22    '  ZDHKEY 12                       S01195
1255 C**********           MOVELZDYNBR    ZWRK6   6                       S01195
1256 C**********           MOVE '1'       ZWRK6                           S01195
1257 C**********           MOVE ZWRK6     ZDHKEY                          S01195
1258 C**********                                                          S01195
1259 C*****CHAIN*FOR*HOLIDAY*RECORD**RECORD*1*OR*2***                     S01195
1260 C********** ZDHCHN    TAG                             ** ZDHCHN TAG *S01195
1261 C**********                                                          S01195
1262 C********** ZDHKEY    CHAINTABDLI               90    ON NOT THERE   S01195
1263 C**N90***** RECI      COMP 'D'                  9090  DELETED        S01195
1264 C**********                                                          S01195
1265 C*****NO*RECORD*1*FOUND**IS*NOT*A*HOLIDAY***                         S01195
1266 C***90N95**           GOTO ZDOAGN                                    S01195
1267 C**********                                                          S01195
1268 C*****NO*RECORD*2*FOUND***                                           S01195
1269 C***90*95*96          GOTO ZDLOP1                     EXC. NOT FOUND S01195
1270 C***90*95N96          GOTO ZDOAGN                     INC. NOT FOUND S01195
1271 C**********                                                          S01195
1272 C*****DETERMINE*TYPE*FOUND**INCLUDE*OR*EXCLUDE***                    S01195
1273 C********** INEX      COMP 'E'                  92  91               S01195
1274 C**********                                                          S01195
1275 C*****CHECK*IF*DAY*IS*HOLIDAY*FOR*CURRENCY***                        S01195
1276 C********** ZCCY      LOKUPHCCY                     93               S01195
1277 C***91*93**           GOTO ZDOAGN                     EXCLUDE FOUND  S01195
1278 C***92*93**           GOTO ZDLOP1                     INCLUDE FOUND  S01195
1279 C**********                                                          S01195
1280 C*****IF*EXCLUDE*OR*INCLUDE*NOT*FOUND*CHECK***                       S01195
1281 C*****FOR*SECOND*HOLIDAY*RECORD**IF*REQUIRED**                       S01195
1282 C********** '   '     LOKUPHCCY                     94ON IF NO RCD.2 S01195
1283 C**********           MOVE ZDHKEY    ZWRK1   1                       S01195
1284 C********** ZWRK1     COMP '1'                      95               S01195
1285 C***91*95**           SETON                     96                   S01195
1286 C***95N94**           MOVE '2'       ZDHKEY                          S01195
1287 C***95N94**           GOTO ZDHCHN                     GET SECOND REC S01195
1288 C**********                                                          S01195
1289 C***91*****           GOTO ZDLOP1                     EXC. NOT FOUND S01195
1290 C***92*****           GOTO ZDOAGN                     INC. NOT FOUND S01195
1291 C**********                                                          S01195
1292 C*****INCREMENT*COUNT*AND*CHECK*IF*REQUIRED*NUMBER*OF*DAYS**         S01195
1293 C*****HAVE*BEEN*ADDED**IF*NOT**GO*THROUGH*LOOP1*AGAIN***             S01195
1294 C********** ZDOAGN    TAG                             ** ZDOAGN TAG *S01195
1295 C**********                                                          S01195
1296 C********** ZDCNT     ADD  1         ZDCNT                           S01195
1297 C********** ZDCNT     COMP ZNRDYS                 97                 S01195
1298 C***97*****           GOTO ZDLOP1                                    S01195
1299 C**********                                                          S01195
1300 C**********           ENDSR                                          S01195
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*   P01, FIRST CYCLE PROCESSING                                 *
     C*                                                               *  *
     C*   CALLED FROM :- MAIN PROCESSING                              *
     C*                                                               *
     C****CALLS**********ZSYSTM*TABCHN*ZDATE3**************************   S01194
     C*   CALLS       :- ZFWDT                                        *   S01194
     C*                                                               *
     C*****************************************************************
     C*                                                               *
     C           P01       BEGSR
     C*                                                               *
     C                     MOVE '1'       *IN,40
     C**
     C*****ACCESS*INSTALLATION*CONTROL*DATA*RECORDS*1*AND*2*TO*OBTAIN**   S01194
     C*****BANK'S*TITLE**RUN*DATE*AND*RUN*DAY*NUMBER******                S01194
     C**********                                                          S01194
     C**********           EXSR ZSYSTM                                    S01194
     C**********                                                          S01194
     C****DATA*BASE*ERROR*POINT*1***                                      S01194
     C**********                                                          S01194
     C********** *IN99     IFEQ '1'                                       S01194
     C**********           Z-ADD1         DBASE                           S01194
     C**********           MOVE 'ICR.1'   DBFILE                          S01194
     C**********           MOVELZTABKY    DBKEY                           S01194
     C**********           MOVE 'DL1610'  DBPGM                           S01194
     C**********           SETON                     LRU7U8               S01194
     C**********           EXCPT                                          S01194
     C**********           MOVE *BLANKS   DTYP                            S01194
     C**********                                                          S01194
     C****ACCESS*I*C*R*2**FOR*LOCAL*CCY***                                S01194
     C**********                                                          S01194
     C**********           ELSE                                           S01194
     C**********           MOVEL'01'      TABKEY 12                       S01194
     C**********           MOVE '11'      TABKEY                          S01194
     C**********           EXSR TABCHN                                    S01194
     C**********                                                          S01194
     C***DATABASE*ERROR*POINT*2***                                        S01194
     C**********                                                          S01194
     C********** *IN61     IFEQ '1'                                       S01194
     C**********           Z-ADD2         DBASE                           S01194
     C**********           MOVE 'ICR 2'   DBFILE                          S01194
     C**********           MOVELTABKEY    DBKEY                           S01194
     C**********           MOVE 'DL1610'  DBPGM                           S01194
     C**********           SETON                     LRU7U8               S01194
     C**********           EXCPT                                          S01194
     C**********           MOVE *BLANKS   DTYP                            S01194
      *                                                                   S01194
      * Initialize DBKEY to blanks in case db error occurs                S01194
     C                     MOVE *BLANKS   DBKEY                           S01194
     C*                                                                   S01194
     C/COPY WNCPYSRC,DL1610C019
     C* Call Access prog. for Bank Details.                               S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
      *                                                                   S01194
      * Handle database error                                             S01194
     C           @RTCD     IFNE *BLANKS                      *************S01194
     C                     MOVE '01'      DBASE              *  DBERROR  *S01194
     C                     MOVE 'SDBANKPD'DBFILE             *     01    *S01194
     C                     EXSR *PSSR                        *************S01194
     C                     MOVE *BLANKS   DTYP                            S01194
     C                     END                                            S01194
      *                                                                   S01194
      * Check system date format, DDMMYY or MMDDYY                        S01194
      * *IN98 on if MMDDYY                                                S01194
     C           BJDFIN    IFEQ 'M'                                       S01194
     C                     MOVE '1'       *IN98                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C* Call Access prog. for Module Details provided no error            S01194
     C* so far (otherwise LDA will get overwritten if another             S01194
     C* error occurs)                                                     S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
      *                                                                   S01194
      * Handle database error                                             S01194
     C           @RTCD     IFNE *BLANKS                      *************S01194
     C                     MOVE '02'      DBASE              *  DBERROR  *S01194
     C                     MOVE 'SDMMODPD'DBFILE             *     02    *S01194
     C                     EXSR *PSSR                        *************S01194
     C                     MOVE *BLANKS   DTYP                            S01194
     C                     END                                            S01194
     C                     END                                            S01194
     C**
     C**   CALCULATE THE INTEREST FIX DATE CONTROL DAY NUMBER, WHICH
     C**   IS BASED ON RUN DAY NUMBER PLUS 5  WORKING DAYS LOCAL CCY
     C**
     C**********           ELSE                                           S01194
     C**********           Z-ADDRUND      ZDAYNO                          S01194
     C                     Z-ADDBJRDNB    ZDAYNO                          S01194
     C**********           MOVE LOCY      ZCCY                            S01194
     C                     MOVE BJLCCY    ZCCY                            S01194
     C/COPY WNCPYSRC,DL1610C020
     C                     Z-ADD5         ZNRDYS
     C/COPY WNCPYSRC,DL1610C001
      *                                                                   S01195
      * Set up ZLOC as system location for input to ZFWDT                 S01195
     C                     MOVE BJSLCD    ZLOC                            S01195
     C**********           EXSR ZDATE3                                    S01195
     C                     EXSR ZFWDT                                     S01195
      *                                                                   S01408
     C/COPY WNCPYSRC,DL1610CCP2                                           S01408
      *                                                                   S01408
     C**********           END                                            S01194
     C**********           END                                            S01194
     C*
      ** Access AOSARDR0 to check if CIR007 is switched on                                    CIR007
     C                     MOVE 'N'       CIR007  1                                           CIR007
     C                     CALL 'AOSARDR0'                                                    CIR007
     C                     PARM *BLANKS   PRTCD   7                                           CIR007
     C                     PARM '*VERIFY' POPTN   7                                           CIR007
     C                     PARM 'CIR007'  PSARD   6                                           CIR007
     C           SCSARD    PARM SCSARD    DSFDY                                               CIR007
     C           PRTCD     IFEQ *BLANKS                                                       CIR007
     C                     MOVE 'Y'       CIR007                                              CIR007
     C                     ELSE                                                               CIR007
     C           PRTCD     IFNE '*NRF   '                                                     CIR007
     C                     Z-ADD5         DBASE                                               CIR007
     C                     MOVEL'SCSARDPD'DBFILE                                              CIR007
     C                     MOVELPSARD     DBKEY                                               CIR007
     C                     EXSR *PSSR                                                         CIR007
     C                     MOVE *BLANKS   DTYP                                                CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR007
     C                     ENDSR
     C*
     C*****************************************************************
     C/COPY ZSRSRC,ZFWDT                                                  S01195
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/COPY ZSRSRC,ZCHKH                                                  182811
     C*****************************************************************   S01194
     C**********                                                      *   S01194
     C****SR**ZSYSTM***TO*CHAIN*TO*THE*INSTALLATION*CONTROL*RECORD*1***   S01194
     C**********                                                      *   S01194
     C****CALLED*FROM****P01***                                       *   S01194
     C**********                                                          S01194
     C****CALLS*      :-                                              *   S01194
     C**********                                                      *   S01194
     C*****************************************************************   S01194
     C***********************************************                     S01194
     C*****SUBROUTINE*CHANGED**                     *                     S01194
     C*****CHAINING*TAKES*PLACE*TO*TABDLI*NOT*TABLE**                     S01194
     C***********************************************                     S01194
0369 C**********                                                          S01194
0372 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0373 C**********                                                          S01194
0374 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD***                  S01194
0375 C**********           MOVEL'01      'ZTABKY 12                       S01194
0376 C**********           MOVE '  10'    ZTABKY                          S01194
0377 C**********                                                          S01194
0378 C********** ZTABKY    CHAINTABDLI               99    ON NOT THERE   S01194
0379 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0380 C**********                                                          S01194
0381 C*****CHECK*SYSTEM*DATE*FORMAT**DDMMYY*OR*MMDDYY***                  S01194
0382 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0383 C**********                                                          S01194
0384 C**********           ENDSR                                          S01194
     C/SPACE 5
     C*****************************************************************   S01194
     C**********                                                      *   S01194
     C****SR**TABCHN***TO*CHAIN*TO*THE*INSTALLATION*CONTROL*RECORD*2***   S01194
     C**********                                                      *   S01194
     C****CALLED*FROM****P01***                                       *   S01194
     C**********                                                          S01194
     C****CALLS*      :-                                              *   S01194
     C**********                                                      *   S01194
     C*****************************************************************   S01194
1302 C**********                                                          S01194
1220 C********************************************************************S01194
1221 C**********                                                          S01194
1222 C********** TABCHN    BEGSR                           **  TABCHN  ** S01194
1223 C********** TABKEY    CHAINTABDLI               61                   S01194
1224 C**N61***** RECI      COMP 'D'                  6161                 S01194
1225 C**********           ENDSR                                          S01194
     C/EJECT
      *****************************************************************   S01194
      *                                                               *   S01194
      *  *PSSR SR.     To exit program upon database error            *   S01194
      *                                                               *   S01194
      *****************************************************************   S01194
      *                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
      *                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     MOVEL'DL1610'  DBPGM                           S01194
     C           *NAMVAR   DEFN LDA       @LDA  256                       S01194
     C           *LOCK     IN   @LDA                                      S01194
     C                     MOVE DBERR     @LDA                            S01194
     C                     OUT  @LDA                                      S01194
     C                     SETON                     U7U8LR               S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C                     ENDSR                                          S01194
      *****************************************************************   S01194
      /SPACE 3
      *****************************************************************   S01194
      *                                                               *   S01194
      *  #ZZ  SR.  Called  by main  processing during total time          S01194
      *            calculations if no records read and therefore      *   S01194
      *            SDBANKPD not read.                                 *   S01194
      *                                                               *   S01194
      *****************************************************************   S01194
      *                                                                   S01194
     C           #ZZ       BEGSR                                          S01194
      *                                                                   S01194
      ** If first cycle not performed set BANK details for headings       S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
      *  If database error...                                             S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE           ************   S01194
     C                     MOVEL'004'     DBASE            * DBERR 04 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
      *                                                                   S01194
     C           #ZZ9      ENDSR                                          S01194
     C*****************************************************************   S01194
      /EJECT
2197 O**
2198 O**   FILE CONTROL REPORT
2199 O**
     ODL1610AUE  203   50
     O       OR        LR U7 U8                                           S01117
     O**********                         22 'REFERENCE DL1610'
     O                                   24 'REFERENCE DL1610AU'
     O**********               TITL      89                               S01194
     O                         BJURPT    89                               S01194
     O                                  104 'DATE'
     O**********               RUNA     112                               S01194
     O                         BJMRDT   112                               S01194
     O                                  122 'PAGE'
     O                         PAGE  Z  127
     O        E  1     50
     O                                   63 'FRA/IRS RATE CHANGES'
     O                                   80 'EXPECTED EXTRACT'
     O        E  3     50
     O                                   64 '---------------------'
     O                                   80 '----------------'
     O        E 1      50
     O                                   42 'HASH TOTAL OF PRINCIPAL'
     O                                   52 'AMOUNTS'
     O*************************ZZTOTI    72 '   ,   ,   ,   , 0 '         E42688
     O*************************          73 '.'                           E42688
     O*************************ZZTOTD    76                               E42688
     O                         ZZTOTI    72 '             0 '             E42688
     O                         ZZTOTD    75                               E42688
     O        E 33     LR U7 U8
     O                                   44 'DATABASE ERROR'
     O                         DBASE Z   48
     O                                   59 'IN PROGRAM'
     O                         DBPGM     70
     O        E        LR U7 U8
     O                                   34 'FILE'
     O                         DBFILE    43
     O                                   48 ', KEY'
     O                         DBKEY     84
     O********E*3******LR                                           E14923S01117
     O*****************                  76 '*** END OF REPORT ***' E14923S01117
**  CPY@
(c) Finastra International Limited 2001
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH                                 182811
312831303130313130313031                                                  182811
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN                      182811
0366073110961461                                                          182811
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                        182811
000031059090120151181212243273304334365                                   182811
**   ZMNM - MONTHS SHORT NAMES                                            182811
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC                                      182811
