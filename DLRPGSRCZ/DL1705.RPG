     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Create pay/rec files for SWIFT direct lnk')   *
/*XBIA*: OVRDBF TRANS DTRIN                                         : *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *  DL1705  -  CREATE PAY/RECEIVE EXTRACT FILES (WITH MS MOD)    *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. 260405             Date 04Apr20               *
      *                 MD053295           Date 13Apr19               *
      *                 CSW218             Date 19Mar18               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 MD034285           Date 14Feb17               *
      *                 CGL165             Date 17Feb15               *
      *                 MD031127           Date 13Feb15               *
      *                 MD031141           Date 25Nov14               *
      *                 MD031098           Date 25Nov14               *
      *                 MD030373           Date 25Nov14               *
      *                 CDL096I01          Date 03Nov14               *
      *                 CDL096             Date 29Sep14               *
      *                 CDL094             Date 01Sep14               *
      *                 MD027820           Date 19Aug14               *
      *                 MD027601           Date 11Jul14               *
      *                 MD027307A          Date 17Jun14               *
      *                 AR912803           Date 25Apr12               *
      *                 AR995333A          Date 04Jan12               *
      *                 AR996895           Date 25Nov12               *
      *                 AR805565           Date 25Sep11               *
      *                 CRE073             Date 06Dec10               *
      *                 AR787620           Date 10Jun11               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26839           Date 05Jan10               *
      *                 CER054             Date 07Apr09               *
      *                 BUG22911           Date 17Feb09               *
      *                 CER016A            Date 19May08               *
      *                 CER048             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CDL081             Date 14Dec09               *
      *                 260339             Date 21May09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 237893             Date 30Nov06               *
      *                 232817             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 230948             Date 06Jun06               *
      *                 172477             Date 06Jun06               *
      *                 CDL013             Date 08Jun06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 234068             Date 17Jun05               *
      *                 CGL031             Date 05Jul04               *
      *                 CDL038             Date 10May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CAS009             Date 16May05               *
      *                 CDL033             Date 10Feb05               *
      *                 221673             Date 10Feb05               *
      *                 BUG7056            Date 16May05               *
      *                 BUG6995            Date 10May05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 BUG6479            Date 21Apr05               *
      *                 CAS008             Date 16Jun04               *
      *                 CSD025             Date 11Jan05               *
      *                 CDL025             Date 27Jan05               *
      *                 230558             Date 11Jan05               *
      *                 BUG5312            Date 05Feb05               *
      *                 224890             Date 10May04               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 222097             Date 22Oct03               *
      *                 170231             Date 29Jan02               *
      *                 Rgfix1             Date 05Jul04               *
      *                 LSC044             Date 05Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CDL022             Date 31Mar03               *
      *                 CDL019             Date 30Mar03               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      *                 217684             Date 12May03               *
      *                 211614             Date 27Mar03               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4.01 -------------------------------------------*
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      *                 185845             Date 24Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      *                 153330             Date 10Nov00               *
      *                 CIR003             Date 13Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 179200             Date  1Nov00               *
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 136030             Date 05Oct99               *
     F*                 140335             Date 04Oct99               *
      * Midas DBA 3.01 -----------------------------------------------*
     F*                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 138388             Date 27Apr99               *
     F*                 148322             Date 04Dec98               *
     F*                 137714             Date 26Jun98               *
     F*                 CEU015             Date 19Jun98               *
     F*                 CEU003             Date 12Dec97               *
     F*                 121768             DATE 27Feb98               *
     F*                 S01408             DATE 27Feb98               *
     F*                 114608             DATE 10Feb98               *
     F*                 126017             DATE 14NOV97               *
     F*                 103191             Date 13May97               *
     F*                 111045             Date 21Feb97               *
     F*                 097885             DATE 31JAN97               *
     F*                 CSW005             DATE 17FEB97               *
     F*                 S01408             DATE 08NOV96               *
     F*                 CFF004             DATE 02OCT96               *
     F*                 S01408             DATE 11OCT96               *
     F*                 S01408             DATE 27AUG96               *
     F*                 CSW096             DATE 03SEP96               *
     F*                 104793             DATE 20JUN96               *
     F*                 092905             DATE 18APR96               *
     F*                 S01408             DATE 11APR96               *
     F*                 095991             DATE 29MAR96               *
     F*                 094124             DATE 29MAR96               *
     F*                 073302             DATE 28MAR96               *
     F*                 071538             DATE 28MAR96               *
     F*                 081540             DATE 28MAR96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 087655             DATE 23OCT95               *
     F*                 087084             DATE 21JUN95               *
     F*                 085620             DATE 21JUN95               *
     F*                 083890             DATE 15MAR95               *
     F*                 081947             DATE 08MAR95               *
     F*                 079774             DATE 20DEC94               *
     F*                 079137             DATE 20DEC94               *
     F*                 079139             DATE 20DEC94               *
     F*                 077557             DATE 13OCT94               *
     F*                 S01408             DATE 19AUG94               *
     F*                 066550             DATE 04FEB94               *
     F*                 064052             DATE 01DEC93               *
     F*                 063953             DATE 29NOV93               *
     F*                 S01434             DATE 17NOV93               *
     F*                 042844             DATE 11OCT93               *
     F*                 E47277             DATE 16MAR93               *
     F*                 E49966             DATE  1FEB93               *
     F*                 E28766             DATE 13OCT92               *
     F*                 S01392             DATE 20JUL92               *
     F*                 E42864             DATE 22JUL92               *
     F*                 E42865             DATE 21JUL92               *
     F*                 S01383             DATE 27APR92               *
     F*                 S01354             DATE 10JAN92               *
     F*                 E29588             DATE 22NOV91               *
     F*                 E28178             DATE 06SEP91               *
     F*                 E25974             DATE 02AUG91               *
     F*                 E20250 (ENY001)    DATE 16JUL91               *
     F*                 S01310             DATE 29APR91               *
     F*                 E20474 BHF911      DATE 07NOV90               *
     F*                 BHF871             DATE 23OCT90               *
     F*                 DT0089             DATE 18APR91               *
     F*                 S01314             DATE 19DEC90               *
     F*                 E23447             DATE 11SEP90               *
     F*                 E22600             DATE 31JUN90               *
     F*                 E19772             DATE 25JUN90               *
     F*                 E20444             DATE 03APR90               *
     F*                 E18304             DATE 28MAR90               *
     F*                 S01251             DATE 03FEB90               *
     F*                 LN0655             DATE 21AUG90               *
     F*                 E22405             DATE 15AUG90               *
     F*                 LN0612             DATE 14AUG90               *
     F*                 LN0477             DATE 26JUL90               *
     F*                 BHF147             DATE 13JUN90               *
     F*                 E20435             DATE 11JUN90               *
     F*                 E20287             DATE 11JUN90               *
     F*                 E107               DATE 24NOV89               *
     F*                 E16435             DATE 24/10/89              *
     F*            (S01227 Superceded by Release 10)                  *
     F*            (E16435 Superceded by Multi Branching Fix S01117)  *
     F*                 E16693             DATE 24/10/89              *
     F*                 E11668             DATE 24/10/89              *
     F*                 E16345             DATE 24/10/89              *
     F*                 S01157             DATE 05/10/89              *
     F*                 S01177             DATE 05/10/89              *
     F*                 S01117             DATE 05/10/89              *
     F*                 S01194             DATE 11/10/89              *
     F*                 E14701             DATE 15/08/88              *
     F*                 E13088             DATE 03/08/88              *
     F*                 S01167             DATE 15/05/88              *
     F*                 S01144             DATE 13/01/88              *
     F*                 E11862             DATE 18/11/87              *
     F*                 S01119             DATE 29/07/87              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  260405 - BRT Participation Date of Birth field is missing.   *
      *           Upgrade fix 235425. Recompile over changed SDCBRTPD.*
      *         - Applied for MD055446.                               *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  CSW218 - SWIFT Changes 2018                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  MD034285 - New SWIFT message not generated after PD event.   *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  MD031127 - CGL035/CER048/CER054 tax processing will not be   *
      *             executed for negative interest.                   *
      *  MD031141 - MM taxable TD maturity payment MT103 has a        *
      *             wrong/strange amount                              *
      *  MD031098 - MM Taxable Call Deposit's Interim interest pay-   *
      *             ment MT103 has a wrong/strange amount.            *
      *           - Correct the Interest amount for tax calculation.  *
      *  MD030373 - MM Call Deposit 000055 (taxable CER048) Payment   *
      *             Message (MT103) not generated for interim inte-   *
      *             rest payment (linked to Midas-1323: same bug      *
      *             for time deposit)                                 *
      *           - Correct the start and end dates.                  *
      *  CDL096I01 - CDL096 fix                                       *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompile)                                         *
      *  MD027820 - MM Time Deposit (taxable acc. to CER048): payment *
      *             message (MT103) not generated for interim int pay *
      *  MD027601 - Taxable Call Deposit Maturity:  Payment message   *
      *             contains a strange (wrong) settlement amount      *
      *             (duplicated tax booking 5-12.7.2013)              *
      *           - Aligned the conditions of calculating the with-   *
      *             holding taxes (main tax, second tax and third     *
      *             tax) with the processing of DL0280 (COB Deals     *
      *             update program).                                  *
      *  MD027307A - Second tax is deducted twice.                    *
      *  (Reopen)   - Need to correct fix done for MD027318.          *
      *  AR912803 - Remove check on CSW005 for cover messages as this *
      *             is a non-FT transaction. Apply fix 257737.        *
      *             (Child: AR912804)                                 *
      *  AR995333A - Component DLC0400 failed due to dbase error 6 in *
      *              DL6315. Initialise values after processing       *
      *              interest event. (Child: AR995335)                *
      *  AR996895 - Incorrect acrrual interest calculation.           *
      *             (Child: AR996897) (Recompile)                     *
      *  AR805565 - Component DLC0400 failed due to dbase error 6 in  *
      *             DL6315. Initialise RLINTP field.                  *
      *             (Child: AR805567)                                 *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,DLH00050                                 *
      *             WNCPYSRC,DLH00051                                 *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26839 - JA1_Threshold limit of the main joint customer was*
      *             utilized by the member                            *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  BUG22911 - Changes for Correct Tax Calculation               *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER048 - German Features - Taxes                             *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CDL081 - Tiered withholding tax rounding upgrade             *
      *  260339 - Add more validation so that database error 111 and  *
      *           113 in DL1705 will not be encountered. Applied fix  *
      *           250118.                                             *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  237893 - Applied as fix 232817.                              *
      *  232817 - Check amounts so as not to skip records.            *
      *           Applied fix 227852.                                 *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  230948 - Incorrect settlement method used if IPDS is equal   *
      *           to 'Y' and interest settlement method is specified. *
      *  172477 - CSW011 not integrated causing Field 57 for FRA      *
      *           MT202's not to appear.  Applied fix 170449.         *
      *  CDL013 - Tiered Withholding Tax                              *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  234068 - EU Tax not being calculated if S01438 is off. Fix is*
      *           to also do calculation if CGL031 is on and remove   *
      *           access to file SDCSINPD.                            *
      *  CGL031 - Taxation on Savings Income                          *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  221673 - When negative interest indicator is ON, negate TOTI *
      *           to reflect true interest.  Apply fix 216515.        *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  BUG7056- Apply fix 217962                                    *
      *           SWIFT not generated in I/C when rollover amount is  *
      *           less than the rolled over deal.                     *
      *  BUG6995- MT202 is not generated for cross currency IRS when  *
      *           CIR003 is present.  Make sure that RXAWBN is        *
      *           properly moved to THRAG so that the MT202 can be    *
      *           correctly formatted. Also corrected move of RXRIBN  *
      *           to THRAG.  Apply 223704.                            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  BUG6479- when option takedown is enter, not cancel and       *
      *           amendement messages are produce for the option      *
      *           for MMM.                                            *
      *  CAS008 - IAS 39 Enhancements                                 *
      *  CSD025 - Customer De-Activation                              *
      *  CDL025 - FX Netting Payment Generation (Recompile)           *
      *  230558 - Dberror 011 in file DEAMS after a reversal is done  *
      *           in Deals Amendments Input maintenance.  Fix is to   *
      *           condition call to SR/INTRES only if transaction is  *
      *           not a reversal.  Applied fix 228472.                *
      *  BUG5312  Pf/MMPCHGPPP changed                                *
      *           DL1705C125                                          *
      *  224890 - Incorrect settlement amount is shown on the genera- *
      *           ted MT100/MT103 for CD deals with interest adjust-  *
      *           ments.                                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
     F*  222097 - When an SC is backvalued & then followed by an SI   *
     F*           the SI is calculating Interest from the last AIPD   *
     F*           on the Deal instead of from when the rate Change    *
     F*           tales effect.                                       *
     F*           When doing an SI to a CD the Receipt Settlement     *
     F*           Instructions where being displayed. HNOMDT was      *
     F*           being checked when setting field W#LOD to D for a   *
     F*           Deposit (CD) or an L for a Loan (CL) - but HNOMDT   *
     F*           was never being set as MMDEALLL was only read       *
     F*           if CDL006 was on.                                   *
     F*  170231 - Test for Total interest override flag being off     *
     F*           leads to jump to TAG38E. This prevents Maturity Date*
     F*           being compared to change in BRT rate date.          *
      *                                                               *
      *  Rgfix1 - This program requires change to process fixed term  *
      *           deals where the interest capitalisation inducator   *
      *           is set to 'Y' to ensure that the correct amount of  *
      *           interest is posted at maturity. The change is       *
      *           required so that it takes into account any interest *
      *           previously capitalised rather than taking the       *
      *           residual amount from the total interest field.      *
      *           Without this fix Deals that where known as          *
      *           Amortisers under CAR LSC39 that matured naturally   *
      *           ie with the Principal Change Schedules not being    *
      *           removed early & the Maturity date being what was    *
      *           originally on the deal - where in effect checking   *
      *           the ORIGINAL amount of interest calculated on the   *
      *           deal (based on the original principal amount) &     *
      *           overpaying based on that now wrong amount.          *
      *           Hooks used: DL1705C125,                             *
      *                                                               *
      *  LSC044 - BRT Rate Applied at Maturity                        *
      *           Hooks used: DL1705C011, DL1705C012, DL1705IIP1      *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CDL022 - Deal Amendment Changes                              *
      *           Incorporate error fix 209258                        *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS006 - Hedge Accounting Phase B                            *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  217684 - Authorisation User Malfunction (Recompile)          *
      *  211614 - System did not generate MT202 message for FX deal.  *
      *           Applied fix 196941 and part of 205882.              *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  185845 - Incorrect interest calculated when Settlement of    *
      *           interest was done after rate change.                *
      *  CSD006 - Use long DS with SDBSRTPD.                          *
      *  153330 - When negative interest indicator is ON, negate TOTI *
      *           to reflect true interest.  Apply fix 154920.        *
      *  CIR003 - FRA/IRS Pay/Receive Messages for Swaps.             *
     F*  179200 - 136030 causes pay/recs for Neg Assets Purchased     *
     F*           to be produced for principal + interest at value    *
     F*           date. Ensure new code only activated for bills sold *
     F*           before maturity not for all Neg Assets Purchased.   *
      *  CDL008 - Continuous Linked Settlement (Recompiled)           *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  136030 - Bill sold before maturity does not cancel original  *
     F*           pay/receive message.                                *
     F*  140335 - New Base Rates taking effect on rundate are not     *
     F*           Considered in the interest calculation for the      *
     F*           Report. Applied fixes 133516, 138693 and 141298.    *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  138388 - Maturity message for rolled-over deals generated    *
     F*           outside the deal's telex notice days.               *
     F*  148322 - Cover MT202 has wrong amount.                       *
     F*           EAMT is already in settlement currency so bypass    *
     F*           subroutine AMNTEU.                                  *
     F*  137714 - Use of settlement currency when present omission.   *
     F*  CEU015 - EMU Enhanced MM Deal Rollover                       *
     F*  CEU003 - EMU Settlement Currency Conversion                  *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  S01408 - Core Hook Dl1705C035 moved to match correct         *
     F*           position in R10.6 source.                           *
     F*           Addition of core hook DL1705CC35                    *
     F*  114608 - Database error after deal amendment, in DL1705.     *
     F*           Clear @CLKEY before moving customer number to it.   *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  103191 - Program crashes with database error at 113 when     *
     F*           a roll-over deal with a historic rolled-over deal   *
     F*           is deleted.                                         *
     F*           (Improvement to fix 092905).                        *
     F*  111045 - Fix 104793 incomplete.                              *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  CSW005 - MG34n and MG36n Message Generation.                 *
     F*  S01408 - Addition of core hook DL1705CP32                    *
     F*           Addition of core hook DL1705CP31                    *
     F*           Addition of core hook DL1705CP30                    *
     F*           Addition of core hook DL1705CP29                    *
     F*           Addition of core hook DL1705CP28                    *
     F*  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
     F*  S01408 - Addition of core hook DL1705CP27                    *
     F*           Addition of core hook DL1705CP26                    *
     F*  S01408 - Addition of core hook DL1705IIP2
     F*           Addition of core hook DL1705EEP1
     F*           Addition of core hook DL1705CCP6
     F*           Addition of core hook DL1705CCP7
     F*           Addition of core hook DL1705CCP8
     F*           Addition of core hook DL1705CCP9
     F*           Addition of core hook DL1705CP10
     F*           Addition of core hook DL1705CP11
     F*           Addition of core hook DL1705CP12
     F*           Addition of core hook DL1705CP13
     F*           Addition of core hook DL1705CP14
     F*           Addition of core hook DL1705CP15
     F*           Addition of core hook DL1705CP16
     F*           Addition of core hook DL1705CP17
     F*           Addition of core hook DL1705CP18
     F*           Addition of core hook DL1705CP19
     F*           Addition of core hook DL1705CP20
     F*           Addition of core hook DL1705CP21
     F*           Addition of core hook DL1705CP22
     F*           Addition of core hook DL1705CP23
     F*           Addition of core hook DL1705CP24
     F*           Addition of core hook DL1705CP25
     F*  CSW096 - SWIFT changes 1996                                  *
     F*  104793 - Deals erroneously reported in 'Incomplete SWIFT Pay *
     F*           Telex' due to error in 073302.  Amend 073302 to     *
     F*           reset the defaulting of THRAG.                      *
     F*  092905 - When a new deal is inserted as rollover, program    *
     F*           crashes when deal rolled-over is already a historic *
     F*           deal.                                               *
     F*  S01408 - Addition of core hook DL1705FFP1
     F*           Addition of core hook DL1705IIP1
     F*           Addition of core hook DL1705CCP1
     F*           Addition of core hook DL1705CCP2
     F*           Addition of core hook DL1705CCP3
     F*           Addition of core hook DL1705CCP4
     F*           Addition of core hook DL1705CCP5
     F*  095991 - Deleted deals are still being reported on           *
     F*           Pay/Rec Reports (Apply GEMS 074739/063957)          *
     F*  094124 - Electronic telexes not generated when Midas Telex   *
     F*           installed. Set switch ENXXXX to 'N' if MT installed *
     F*           to generate electronic rather than paper telexes    *
     F*           for settlement type 01.                             *
     F*  073302 - Do not output telex to Incomplete Telexes File      *
     F*           PRSX2 because of nostro not found, if 'Account      *
     F*           With Bank' is entered. Move the 'Account With       *
     F*           Bank' field into Their Settlement Nostro field      *
     F*           if this field is blank.                             *
     F*  071538 - Telexes not being reprinted after nostro was        *
     F*           amended. Fix is to remove the part of E29588        *
     F*           which prevented output of a new telex after an      *
     F*           amendment.                                          *
     F*  081540 - For deal amendment processing, after checking that  *
     F*           deal is live, re-access DEAMS to avoid information  *
     F*           being lost due to DEALS access using common fields  *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  087655 - Duplicate Maturity payment message generated for    *
     F*           Rollover deal:  one in I/C and one in COB.  Applied *
     F*           SG fix 089792.                                      *
     F*  087084 - Two (2) MT202 messages generated for same amount    *
     F*           for a rollover deal.  Only one is necessary.        *
     F*           Applied GEMS fix 083875.                            *
     F*  085620 - All PREX records for the old deal need to have a    *
     F*           different record type to the usual 'D' for deal.    *
     F*           This is so that only the maturity date messages     *
     F*           for a rolled over deal are cancelled.               *
     F*  083890 - On a deal with automatic rollover as yes 2 receive  *
     F*           messages were generated(One in Input Cycle and one  *
     F*           in the COB). Also a maturity message due in the COB *
     F*           was not produced at all. This happened when the     *
     F*           rollover amount was greater than the rolled over    *
     F*           deal's principal+interest. It is because PRI1 and   *
     F*           PRI3 are output incorrectly to PREXPH so DL0330     *
     F*           flags the deal as having produced its maturity      *
     F*           message but not the start date message so the COB   *
     F*           does the start date again and does not do the       *
     F*           maturity message. It is an error in 063953 which    *
     F*           has already been partially fixed by 079139. 079139  *
     F*           code extended to output PINDS correctly to PREXPH   *
     F*           if overall Principal is being increased.            *
     F*  081947 - Apply Fixes : 051877, 064584, 068714, 046715, E47277*
     F*         - (Fix: 051899)                                       *
     F*           MT100 produced instead of MT202 for SWAPS           *
     F*           payment ordering customer field was                 *
     F*           not being cleared after read of DEALS file.         *
     F*           Problems arise because DEALSDG does not contain this*
     F*           field and therefore after reading DEALSDG 'POCN' is *
     F*           used in connection with the wrong DEAL.             *
     F*         - (Fix: 064584)                                       *
     F*           MT210 Cust Addr incorrect for SWAPS                 *
     F*           (064584)   - invalid ordering bank field values     *
     F*         - (Fixes: 068714, 046715, E47277)                     *
     F*           Pay/Receive messages for interest rate swaps        *
     F*           picking-up false settlement instructions.           *
     F*  079774 - When Interest Settlement method is entered, set     *
     F*           their instructions to deal customer                 *
     F*  079137 - Start date p/r should not be deleted when a deal    *
     F*           is rolled over                                      *
     F*  079139 - Principal increase in rollover should be done on    *
     F*           value date not maturity date of new deal            *
     F*  077557 - No messages should be produced for a non rolled     *
     F*           over automatic rollover deal                        *
     F*  S01408 - Addition of hook DL1705CPDR.                        *
     F*  066550 - GLINTC has had historical problems and inaccuracies *
     F*           and is now externaly descibed and changed to use    *
     F*           ZINTDYZ1. See document atached to error no on GEMS  *
     F*  064052 - Should check RODA <>0 to determine if deal is a     *
     F*           rollover and not just RODA greater than zero        *
     F*  063953 - Value date of reversal of maturity pay/receive for  *
     F*           rollovers should be maturity date of old deal and   *
     F*           not value date of old deal                          *
     F*  S01434 - Enhanced processing to 'Rollover Deals'             *
     F*                                                               *
     F*  042844 - The system produced a payment message for the       *
     F*           principal amount of a new, rollover loan. It should *
     F*           have produced an MT210 for the interest only. If    *
     F*           deal is a rollover also produce an additional       *
     F*           PREXPH record with record type 'R' for the rolled   *
     F*           over deal to cancel the maturity pay/receives       *
     F*  E47277 - Blank out cover message and rec. no. for FRA/IRS.   *
     F*  E49966 - Incorrect P/R Amount Reported for Call Deals        *
     F*           with Int. Freq. 'N' , maturing Before EOM           *
     F*  E28766 - End looping on Cover MT202 if not SWIFT.            *
     F*  S01392 - Jap.Sub-module Incorporation (CORE)                 *
     F*  E42864 - CHECK SETTLEMENT METHOD IN COB ALSO.                *
     F*  E42865 - DEAL NO CAN BE BLANK FOR ROLLOVERED DEALS           *
     F*  S01383 - BASIC RATE TAX INCORPORATION                        *
     F*  S01354 - Ignore Internal funding deal types                  *
     F*  E29588 - POST COLLECTION SWIFT RATIONALISATION FIXES         *
     F*            o According to ICD, either restore Complete        *
     F*              Telexes extraction, or route everything          *
     F*              via MG.                                          *
     F*  E28178 - If settling through SWIFT for payments then         *
     F*  (BH3212) blank 'Their Agent' field is allowed, but           *
     F*           this was causing records to be written to           *
     F*           incomplete telexes file.                            *
     F*  E25974 - REPORTED BY CLIENT AS BH3007                        *
     F*           CODE APPLIED BY S01177 ALLOWED TELEX RECORD TO      *
     F*           BE GENERATED AS COMPLETE IF 'THEIR AGENT' WAS       *
     F*           BLANK WHERAS IT SHOULD BE INCOMPLETE                *
0011 F*  ENY001 - APPLY FIX FROM S/36 FOR SWIFT INTERFACE.            *
0011 F*           PREVIOUSLY DOCUMENTED AS 06JUN83 SAREEEEE.          *
     F*  S01310 - CHANGE MTIN FROM 09 TO 01 IN OPREX1                 *
     F*  E20474 - OUTPUT REVERSAL INDICATOR FOR SWIFT MSG - THIS      *
     F*           WILL BE PASSED TO DL1810 TO PREVENT BOGUS           *
     F*           MT203'S FROM BEING PRODUCED.                        *
     F*  BHF871 - DON'T DEAL # FROM DEALSDE IF NAP IS MATURING.       *
     F*           CAUSES ZERO DEAL # ON PREX5PH.                      *
     F*  DT0089 - Dealing Release 10 System Test fix:                 *
     F*           one of the calls to AONOSTR0 had only 8             *
     F*           parameters instead of 11, causing a program         *
     F*           error; copied the three missing parameters          *
     F*           into place.                                         *
     F*  S01314 - Incorporation changes                               *
     F*  E23447 - IF A DEAL IS ENTERED THEN AMENDED TO INCLUDE        *
     F*           SETTLEMENT INSTRUCTIONS, THEN THE NEXT DTRIXDD      *
     F*           RECORD IS IGNORED, AND NO PAY/RECEIVE MESSAGES      *
     F*           ARE PRODUCED                                        *
     F*  E22600 - MT203, CONDITION ON FIELDS 52/53/54 AS WELL.        *
     F*  E19772 - IF SWIFT BIC ADDRESS NO CHECK IS DONE FOR           *
     F*           A TELEX OR STTX ADDRESS.                            *
     F*  E20444 - PROGRAM CONFUSES COUNTERPARTY PAY AND RECEIVE       *
     F*           BANKS WHEN DOING FRA/IRS'S.                         *
     F*  E18304 - STOP REVERSED DEALS GETTING OUTPUT TO PREXPH        *
     F*           IF EXTRACT TYPE IS NOT SWIFT.E20287 supersedes      *
     F*  S01251 - SYNON FIELD/PROGRAM NAME CHANGES                    *
     F*           (superseded by multibranching)                      *
     F*  LN0655 - UNNECESSARY CONDITIONING ON SETUP OF OURSB          *
     F*           FOR FRA/IRS  (LN0612 - 2)                           *
     F*  E22405 - TO ALLOW A MT202 TO BE PRODUCED WITH A              *
     F*           SUPPLEMENTARY MT202.                                *
     F*  LN0612 - 1) redefine BRCD as BRCA;                           *
     F************2) position BYSL ind. in DEALSDG correctly          *
     F*           2) set up Our Settlement Branch on PREXPH           *
     F*           3) add ROBR and POBR to DEALSDG                     *
     F*  LN0477 - END OF REPORT REMOVED FROM AUDIT REPORT             *
     F*  BHF147 - NEEDS TO CALL AOTRADR0 BEFORE COMP OF BLLCTB        *
     F*  E20435 - DURING EOD, ALL PAY/RECEIVES EXCEPT SWIFT ARE       *
     F*           MISSING (ERROR IN E14701).                          *
     F*  E20287 - WHEN A DEAL IS REVERSED PRIOR TO RUNNING PAY/       *
     F*           RECEIVES, TELEXES ARE STILL BEING PRODUCED.         *
     F*  E107 - S01194 - REWRITE SR/SWADDR/REMOVE RUNDAT              *
     F*  E16435 - CLINT KEY OVERWRITTEN IN DB ERROR                   *
     F*                                                               *
     F*  E16693 - INSERT ERROR DETAILS FOR E11668 INTO HEADER BOX     *
     F*                                                               *
     F*  E11668 - CURRENCY AND NOSTRO BEING OUTPUT INCORRRECTLY       *
     F*           TO MSIXOPF                                          *
     F*                                                               *
     F*  E16345 - PRIOR SUBROUTINE REMOVED                            *
     F*                                                               *
     F*  S01194 - INCORPORATION OF NEW STANDING DATA FILES VIA A/O    *
     F*           N.B FIELD PRID IS RESERVED FOR CHASE MANHAT & IS    *
     F*           NOT SUPPORTED BY NEW SD FILES. HENCE ALL CODING     *
     F*           RELATING TO THIS FIELD HAS BEEN REMOVED             *
     F*                                                               *
     F*  S01157 - FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL' INTO    *
     F*           'RR' (COLLAR), 'RP' (CAP) AND 'RF' (FLOOR).         *
     F*                                                               *
     F*  S01177 - EXTENDED SETTLEMENT INSTRUCTIONS                    *
     F*                                                               *
     F*  S01117 - MULTI-BRANCHING MODIFICATIONS                       *
     F*                                                               *
     F*  S01194 - STANDING DATA MODIFICATIONS                         *
     F*                                                               *
     F*  E14701 - WHEN AN AMENDMENT TO A DEAL IS DONE AND PAY/        *
     F*           RECEIVES ARE RUN, DUPLICATE PAY/RECEIVES ARE        *
     F*           PRODUCED EVEN THOUGH THE MESSAGE IS NOT TO BE       *
     F*           SENT VIA SWIFT.                                     *
     F*  E13088 - WRONG MAT. PAYABLE AMT. GENERATED FOR               *
     F*           WITHOLDING TAX DEPOSIT IN ADV. TO PAY               *
     F*  S01167 - INCORPORATION OF BIC CODES + MT200'S                *
     F*  S01144 - RELEASE 22 INCORPORATION                            *
     F*  E11862 - SHOULD RESET THE REVERSAL INDICATOR EVERY CYCLE     *
     F*                                                               *
     F*  S01119 - FRA/IRS INCORPORATION                               *
     F*                                                               *
     F*****************************************************************
     F/SPACE 3
     F* TRANSACTION FILES
     FTRANS   IP  E           K        DISK
     FDAINDHH IS  F      40            DISK                           U6
     FDAINDDL IS  F      40            DISK                           U6
     FDAINDEX IS  F      40            DISK                           U6
     FDLGXSTL0IF  E           K        DISK                               CIR003
     F*SDCSINL6IF**E***********K        DISK                                           CGL031 234068
     FSDJACCLBIF  E           K        DISK                                                   234068
     F* MASTER FILES
     F*EALS   IF  F  ***400  6AI     2 DISK ***********************       S01119
     F*EALS***IF**F*****600  6AI     2 DISK ***********************S01119 S01177
     F*EALS***IF**F    1069  6AI     2 DISK                        S01177 E22405
     F*EALS***UF**F    1070  6AI     2 DISK                        E22405 S01392
0013 F*EALS***UF**F    1074  6AI     2 DISK                        S01392 S01434
     F*DEALS***UF**F    1142  6AI     2 DISK                       S01434 073302
     F*DEALS***IF**F    1142  6AI     2 DISK                       073302 092905
     F*DEALS***UF**F    1142  6AI     2 DISK                       092905 CSW005
     F*DEALS***UF  F    1997  6AI     2 DISK                       CSW005 CEU003
     F*DEALS***UF  F    2006  6AI     2 DISK                       CEU003 CEU015
     F*DEALS**UF**F****2009  6AI     2 DISK                                            CEU015 CAS004
     F***DEALS** UF  F    2247  6AI     2 DISK                                         CAS004 CAS005
     F***DEALS** UF  F    2431  6AI     2 DISK                                         CAS005 CAS006
     F***DEALS** UF  F    2438  6AI     2 DISK                                         CAS006 CGL029
     F***DEALS** UF  F    2540  6AI     2 DISK                                         CGL029 CAS008
     FDEALS   UF  F    2550  6AI     2 DISK                                                   CAS008
0013 FDRSDEALSIF  F    1074  6AI     2 DISK                               S01392
     F*EAMS***IF**F*****200 14AI     2 DISK ***********************       S01177
     F*EAMS***IF**F     828 14AI     2 DISK                         S01177E22405
     F*DEAMS***UF**F     829 14AI     2 DISK                       E22405 073302
     F*DEAMS***IF  F     829 14AI     2 DISK                       073302 CEU003
     F***DEAMS***IF  F     843 14AI     2 DISK                     CEU003 CDL006
     F***DEAMS**IF  F     877 14AI     2 DISK                                          CDL006 CGL029
     FDEAMS   IF  F     933 14AI     2 DISK                                                   CGL029
     F*****TABLE   IF  F      96 12AI     2 DISK                  *****   S01194
     F*****SNAME   IF  F     256 10AI    39 DISK                  *****   S01194
     F*****CLINT   IF  F     256  7AI     2 DISK                  *****   S01194
     FSDBRTDL1IF  E           K        DISK                               S01383
     FSDCBRTL1IF  E           K        DISK                               S01383
     FDLNASSL1IF  E           K        DISK                               136030
     FDTRIXL9 IF  E           K        DISK                                                 MD034285
     F* OUTPUT FILES
     FPREXHH  O   F     160            DISK                      A
     F*PREXPH**O***F*****160************DISK**********************A*      E22600
     F*PREXPH**O**F     182            DISK                      A E22600 CEU003
     F***PREXPH  O   F     211            DISK                   A CEU003 CIR003
     F***PREXPH* O  F      212            DISK                      A                  CIR003 CGL029
     FPREXPH  O   F     230            DISK                      A                            CGL029
     FPREXZZ  O   F     160            DISK                      A
     FDLDLHCL1IF  E           K        DISK                                                   260399
     F*L1705P1O** F     132            PRINTER                            S01117
     FDL1705AUO   F     132            PRINTER                            S01117
     FSDSTAAL1IF  E           K        DISK                                                   CDL013
      * Retail/Dealing WHT ICD extension update                                               CDL013
      *                                                                                       CSW218
     FMEBICDL2IF  E           K        DISK                                                   CSW218
      ** BIC Directory table                                                                  CSW218
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL1705FFP1                                           S01408
     F*                                                                   S01408
     F/EJECT
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F* 02            TRANS FILE HEADER
     F* 03                       DETAIL
     F* 04                       TRAILER
     F* 05            DAIND FILE HEADER
     F* 06                       DETAIL
     F* 07                       TRAILER
     F* 08            DEALS,DB
     F* 09                 ,DC
     F* 10                 ,DD
     F* 11                 ,DE
     F* 15                 ,DG                                            S01119
     F* 16            ROLLOVER AMOUNT NGT 0                               042844
     F* 12            DEAMS,DI - LIVE
     F* 13                     - REVERSED
     F*       19      INTEREST TAX RATE ZERO
     F*    20         DEFAULT BRANCH NULL
     F*    21         PAY/RECEIVE IND 1 ON
     F*    22                         2
     F*    23                         3
     F*    25         LOCAL CCY NOSTRO-TELEX OR BANK AUTHORISATION IND OFF
     F********24******DEAL*TYPE*=*'IT',*'CD'*OR*'TD'********************* CDL006
     F*       24      DEAL TYPE = 'IT','CD','TD','FT','DT' OR 'LT'        CDL006
     F*       26      TAXABLE INDICATOR = 'Y'
      *       28      Negative Interest Indicator                         153330
     F*       29      DEALING -> CHIPS INTERFACE MODULE EXISTS
     F*       30      DEALING -> SWIFT INTERFACE EXISTS
     F*
     F*       31      SETUP O/P REC. WITH - START DETAILS
     F*       32                          - INTEREST DETAILS
     F*       33                          - FINAL DETAILS
     F*    34      RECORD OUTPUT
     F*       35   REVERSAL RECORD READ FROM EXTRACT FILE
     F*
     F*       37      CHAIN FAIL TO DRSDEALS                              S01392
     F*       40      1ST CYCLE IND
     F*       41      CHAIN FAILURE
     F*       42      GENERAL WORK IND.
     F*       43      GENERAL WORK IND
     F*       44      DEFAULT BRANCH ZERO
     F*       45      OUTPUT AMOUNT NEGATIVE
     F*       46      PRODUCT IND. IS ON
     F*       47      USE 'RBDA' AS THE AMOUNT
     F*       48      SET ROLLOVER/CAPITALISATION IND. TO 3
     F*       49      INTEREST CAPITALISATION INDICATOR IS 'Y'
     F*       50      INSTRUCTIONS ARE VALID
     F********51      MESSAGE TYPE 09                                     S01117
     F*       52                   10
     F*       53                   11
     F*       54                   12
     F*       55      OUT OF BALANCE - DTRIN/DLIND
     F*       56                     - DAIND
     F*       57      WORK INDICATOR
     F*       59***** DATABASE ERROR - NO BRANCH CODE RECORD      *****   S01194
     F/COPY WNCPYSRC,DL1705F001
      *                                                                                       CDL033
      *       60      Work indicator                                                          CDL033
      *                                                                                       CDL033
     F*       60*****                  NO TABLE/I1                *****   S01194
     F*       61*****                  NO TABLE/I2                *****   S01194
     F*       62*****                  NO TABLE/I5                *****   S01194
     F*       63                       SINGLE BRANCH RECORD MISSING
     F*       64                       DEAL RECORD MISSING - PROC1
     F*       66                       DEAM RECORD MISSING - PROC2
     F*       67                       DEAL RECORD MISSING - PROC2
     F*       68                       DEAM RECORD MISSING - INTRES
     F*       70      FOREIGN EXCHANGE
     F*       71      LOAN/DEPOSIT PLACED.
     F*       72      DEPOSIT ACCEPTED OR C.D. ISSUED
     F*       73      INT. BEARING NEG. ASSET PURCHASED
     F*       74      NON-INT. BEARING NEG. ASSET PURCHASED
     F*       75      NEG. ASSET SOLD
     F*       76      DEAL AMD. - DEPOSIT PLACED,INT. BEAR NEG. ASS. PURCH
     F*       77                - DEPOSIT ACCEPTED AND TAKINGS
     F*       79      BIT1 TLXI OF ROLLOVER IS 'ON'                       087655
     F*       80      MESSAGE TYPE 01 - SWIFT
     F*       87      FRA/IRS DEAL TYPE IDENTIFIED                        S01119
     F*       89      END OF DAY
     F*             U6-END OF DAY RUN
     F*             U7-DATABASE ERROR - ON OUTPUT FROM PROGRAM
     F*             U7-I/P CYCLE  RUN - ON INPUT TO PROGRAM
     F*             U8-OUT OF BALANCE
     E                    CPY@    1   1 80
     E                    RIP         5  5 0             NO.RECORDS I/P
     E*
     E                    IPSET   5   5  2 0             I/P CYC.SET.TYPES
     E*****               DTABA   5   5  2       DEPT. DEAL TYPES *****   S01194
     E*****               DTABB  11  11  2       DEPT DL.AMD. TYPE*****   S01194
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E**************      PR          8  1 0                              S01117
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E/COPY WNCPYSRC,DL1705EEP1                                           S01408
     E                    FXTERM  5   5  2                                                    CDL033
     E/EJECT
     I*
     I*    DEAL TRANSACTIONS INDEX FILE - HEADER RECORD.
     I*
     IDTRIEHHF    02
     I*
     I*
     I*    DEAL TRANSACTIONS INDEX FILE - DETAIL RECORD.
     I*
     IDTRIEPHF    03
     I              VDAT                            VDATDL
     I              DASN                            DASNDL
     I                                              PRI1        2121
     I                                              PRI2        2222
     I                                              PRI3        2323
     I*
     I*
     I*    DEALS INDEX FILE - TRAILER RECORD.
     I*
     IDTRIEZZF    04
     I*
     I*    DEAL TRANSACTIONS INDEX FILE - HEADER RECORD.
     I*
     IDAINDHH NS  05   1 CH
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I                                        3   80DLNO
     I                                    P   9  110NORE
     I                                    P  12  140FLSZ
     I                                    P  15  170RRLC
     I                                    P  18  200RRNA
     I                                    P  21  230RRLX
     I                                    P  24  260RRXP
     I                                    P  27  290NDLR
     I                                    P  30  320NDAR
     I                                       33  330STPI
     I                                    P  35  370RRNT
     I                                    P  38  400TNLU
     I*
     I* CATCHALL
     I        NS
     I*
     I*    DEAL TRANSACTIONS INDEX FILE - DETAIL RECORD.
     I*
     IDAINDDL NS  06   1 CD   2 CA
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I                                        3   80DLNO
     I                                        9  130VDATDL
     I                                       14  160DASNDL
     I                                       17  17 CHTP
     I                                       18  18 CNRQ
     I                                       19  19 CNPR
     I                                       20  20 REPR
     I                                       21  250RRLA
     I                                       26  26 DADI
     I                                       27  270PRI1        2121
     I                                       28  280PRI2        2222
     I                                       29  290PRI3        2323
     I                                    P  35  370RRNT
     I                                    P  38  400TNLU
     I*
     I* CATCHALL
     I        NS
     I*    DEAL AMENDMENTS INDEX FILE TRAILER RECORD.
     I*
     IDAINDEX NS  07   1 CT
     I                                    P   9  110RIP,2
     I*
     I* CATCHALL
     I        NS
     I*
     I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
     I*
     IDEALS   NS  08   8 CB
     I                                        1   1 RECI
     I                                        1   1 RECIDL                E20474
     I                                        2   70DLNODB
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160CNUM                                      CSD027
     I                                       11  16 CNUM                                      CSD027
     I*****                                  17  190BRCD                  S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP
     I                                       22  23 DLST
     I                                    P  24  260DDAT
     I                                    P  27  290VDAT
     I                                    P  30  320OTDT
     I                                       35  38 BRKC
     I                                    P  39  450BAGE
     I                                       46  48 PUCY
     I                                    P  49  550PUAM
     I                                    P  56  628EXRT
     I                                       86  88 SLCY
     I                                    P  89  950SLAM
     I                                    P 117 1230BCEQ
     I                                    P 131 1378LCXR
     I                                      138 1390PCST
     I**********                            140 151 OPCA                                      CGL029
     I                                      140 151 OPCAQQ                                    CGL029
     I                                      152 161 TSCN
     I                                      162 1630SCST
     I**********                            164 175 OSCA                                      CGL029
     I                                      164 175 OSCAQQ                                    CGL029
     I                                      176 185 TPCN
     I                                    P 192 1980ORPA
     I                                    P 205 2110ORSA
     I                                      212 2120FSLI
     I                                    P 241 2470SPPD
     I                                    P 248 2540SPLA
     I                                      255 257 SPLC
     I                                      285 2900SODN
     I                                      300 309 FACO
     I                                      310 344 SPI
     I                                      370 370 DNSI
     I                                      371 371 DSTI
     I                                      372 372 CNFI
     I                                      373 373 ACEI
     I                                      374 374 TLXI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 402 BOKC                  S01117
     I                                      403 4080LNKDN                 S01117
     I                                      409 4100RSTM                  S01177
     I**********                            411 422 RONS                               S01177 CGL029
     I                                      411 422 RONSQQ                                    CGL029
     I                                      423 430 RIBN                  S01177
     I                                      431 465 RIBA                  S01177
     I**********                            466 4710ROBN                               S01177 CSD027
     I**********                            472 4770ROCN                               S01177 CSD027
     I                                      466 471 ROBN                                      CSD027
     I                                      472 477 ROCN                                      CSD027
     I                                      478 4790PSTM                  S01177
     I**********                            480 491 PONS                               S01177 CGL029
     I                                      480 491 PONSQQ                                    CGL029
     I                                      492 499 PIBN                  S01177
     I                                      500 534 PIBA                  S01177
     I**********                            535 5400POBN                               S01177 CSD027
     I**********                            541 5460POCN                               S01177 CSD027
     I                                      535 540 POBN                                      CSD027
     I                                      541 546 POCN                                      CSD027
     I                                      547 554 RCRN                  S01177
     I                                      555 589 RCRA                  S01177
     I                                      590 597 RVNO                  S01177
     I                                      598 605 AWBN                  S01177
     I                                      606 640 AWBA                  S01177
     I                                      641 648 BENN                  S01177
     I                                      649 683 BENA                  S01177
     I                                      684 718 DTP1                  S01177
     I                                      719 753 DTP2                  S01177
     I                                      754 788 DTP3                  S01177
     I                                      789 823 DTP4                  S01177
     I                                      824 826 DCHG                  S01177
     I                                      827 861 BTB1                  S01177
     I                                      862 896 BTB2                  S01177
     I                                      897 931 BTB3                  S01177
     I                                      932 966 BTB4                  S01177
     I                                      9671001 BTB5                  S01177
     I                                     10021036 BTB6                  S01177
     I                                     10371039 ORBR                  S01117
     I                                     10401043 PRFC                  S01117
     I                                     10441046 ROBR                  S01117
     I                                     10471049 POBR                  S01117
     I                                     10501050 CVMR                  E22405
     I                                     12001202 RSCY                  CEU003
     I                                     12031205 PSCY                  CEU003
     I                                     12061208 IC72                  CEU003
     I                                     12921309 OPCA                                      CGL029
     I                                     13101327 OSCA                                      CGL029
     I                                     13281345 RONS                                      CGL029
     I                                     13461363 PONS                                      CGL029
     I*
     I*
     I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
     I*
     IDEALS   NS  09   8 CC
     I                                        1   1 RECI
     I                                        1   1 RECIDL                E20474
     I                                        2   70DLNODC
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160CNUM                                      CSD027
     I                                       11  16 CNUM                                      CSD027
     I*****                                  17  190BRCD                  S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP
     I                                       22  23 DLST
     I                                    P  24  260DDAT
     I                                    P  27  290VDAT
     I                                    P  30  320MDAT
     I                                       33  340CDAS
     I                                       35  38 BRKC
     I                                    P  39  450BAGE
     I                                       46  48 CCY
     I                                    P  49  550PCPL
     I                                       56  56 INTC
     I**********                             63  640BRTT                                      CSD103
     I                                       63  64 BRTT                                      CSD103
     I                                    P  65  707BRTE
     I                                    P  71  767RTSP
     I                                    P  77  827INTR
     I                                       83  850NOTD
     I                                       86 105 RNNA
     I**********                            106 1110CHNA                                      CSD027
     I                                      106 111 CHNA                                      CSD027
     I                                      112 1140FACT
     I                                      115 1160FCNO
     I                                    P 117 1230OPAM
     I                                    P 124 1308BCXR
     I                                    P 131 1378LCXR
     I                                      138 1390SDST
     I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
     I                                      152 161 TSTN
     I                                      162 1630MDST
     I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
     I                                      176 185 TMAN
     I                                      186 1910RODN
     I                                    P 192 1980RODA
     I                                      199 2040RBDN
     I                                    P 205 2110RBDA
     I                                      212 2120ICBS
     I                                      213 213 IPFR
     I                                    P 214 2200TOTI
     I                                    P 221 2230NIDT
     I                                    P 224 2260IBDT
     I                                    P 227 2290SLID
     I                                    P 230 2360AIPD
     I                                    P 237 2390DLRC
     I                                    P 240 2420IACD
     I                                    P 243 2490AITC
     I                                    P 250 2560AIAN
     I                                    P 257 2630AIAP
     I                                    P 264 2700IPRD
     I                                    P 271 2770IPRM
     I                                    P 278 2840ICTD
     I                                    P 294 2960DAVDDC
     I                                      297 2990DASNDC
     I                                      300 309 FACO
     I                                      310 344 SPI
     I                                      345 3460INTF
     I                                      355 355 TAXI
     I                                      370 370 DNSI
     I                                      371 371 DSTI
     I                                      372 372 CNFI
     I                                      373 373 ACEI
     I                                      374 374 TLXI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I/COPY WNCPYSRC,DL1705I001
     I                                      421 422 BOKC                  S01117
     I                                      423 4280LNKDN                 S01117
     I                                      429 4300RSTM                  S01177
     I**********                            431 442 RONS                               S01177 CGL029
     I                                      431 442 RONSQQ                                    CGL029
     I                                      443 450 RIBN                  S01177
     I                                      451 485 RIBA                  S01177
     I**********                            486 4910ROBN                               S01177 CSD027
     I**********                            492 4970ROCN                               S01177 CSD027
     I                                      486 491 ROBN                                      CSD027
     I                                      492 497 ROCN                                      CSD027
     I                                      498 4990PSTM                  S01177
     I**********                            500 511 PONS                               S01177 CGL029
     I                                      500 511 PONSQQ                                    CGL029
     I                                      512 519 PIBN                  S01177
     I                                      520 554 PIBA                  S01177
     I**********                            555 5600POBN                               S01177 CSD027
     I**********                            561 5660POCN                               S01177 CSD027
     I                                      555 560 POBN                                      CSD027
     I                                      561 566 POCN                                      CSD027
     I                                      567 574 RCRN                  S01177
     I                                      575 609 RCRA                  S01177
     I                                      610 617 RVNO                  S01177
     I                                      618 625 AWBN                  S01177
     I                                      626 660 AWBA                  S01177
     I                                      661 668 BENN                  S01177
     I                                      669 703 BENA                  S01177
     I                                      704 738 DTP1                  S01177
     I                                      739 773 DTP2                  S01177
     I                                      774 808 DTP3                  S01177
     I                                      809 843 DTP4                  S01177
     I                                      844 846 DCHG                  S01177
     I                                      847 881 BTB1                  S01177
     I                                      882 916 BTB2                  S01177
     I                                      917 951 BTB3                  S01177
     I                                      952 986 BTB4                  S01177
     I                                      9871021 BTB5                  S01177
     I                                     10221056 BTB6                  S01177
     I                                     10571059 ORBR                  S01117
     I                                     10601063 PRFC                  S01117
     I                                     10641066 ROBR                  S01117
     I                                     10671069 POBR                  S01117
     I                                     10701070 CVMR                  E22405
     I                                     10721072 JRDFC                 S01392
     I                                     10741074 FUID                  S01392
     I                                     10751075 AURO                  S01434
     I                                     10761076 IPDS                  S01434
     I                                     11151116 IMET                  S01434
     I**********                           11171131 INSA                               S01434 CGL029
     I                                     11171131 INSAQQ                                    CGL029
     I                                     11321141 INOS                  S01434
     I                                     12251227 STCY                  CEU003
     I                                     12281230 IC72                  CEU003
     I                                     12311233 ISCY                  CEU003
     I                                     12341236 II72                  CEU003
     I                                     12371239 RTFC                  CEU015
     I                                     17211738 OSDA                                      CGL029
     I                                     17391756 OMDA                                      CGL029
     I                                     17571774 RONS                                      CGL029
     I                                     17751792 PONS                                      CGL029
     I                                     17931813 INSA                                      CGL029
     I                                     18401840 FSFBRT                                    CDL019
     I                                    P185118530XKRCDT                                    CDL033
     I                                     18791879 XKBSVF                                    CDL033
     I                                    P188218840XKINFD                                    CDL033
     I                                     18851885 XKINFF                                    CDL033
     I                                    P188618917XKBSRF                                    CDL033
     I                                     23502379 CCYPC                                     CDL096
     I                                     23502352 C1PC                                      CDL096
     I                                     23532355 C2PC                                      CDL096
     I                                     23562358 C3PC                                      CDL096
     I                                     23592361 C4PC                                      CDL096
     I                                     23622364 C5PC                                      CDL096
     I                                     23652367 C6PC                                      CDL096
     I                                     23682370 C7PC                                      CDL096
     I                                     23712373 C8PC                                      CDL096
     I                                     23742376 C9PC                                      CDL096
     I                                     23772379 C0PC                                      CDL096
     I                                     23802381 PYDC                                      CDL096
     I                                     23822383 AMTC                                      CDL096
     I/COPY WNCPYSRC,DL1705I002
     I*
     I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
     I*
     IDEALS   NS  10   8 CD
     I                                        1   1 RECI
     I                                        1   1 RECIDL                E20474
     I                                        2   70DLNODD
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160ISCN                                      CSD027
     I                                       11  16 ISCN                                      CSD027
     I*****                                  17  190BRCD                  S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP
     I                                       22  23 DLST
     I                                    P  24  260DDAT
     I                                    P  27  290VDAT
     I                                    P  30  320MDAT
     I                                       33  340IDAS
     I                                       35  38 BRKC
     I                                    P  39  450BAGE
     I                                       46  48 CCY
     I                                    P  49  550PUPR
     I                                    P  57  627YRAT
     I                                    P  71  767RTSP
     I                                    P  77  827INTR
     I                                       86 105 RNNA
     I**********                            106 1110PCUS                                      CSD027
     I                                      106 111 PCUS                                      CSD027
     I                                      112 1140FACT
     I                                      115 1160FCNO
     I                                    P 117 1230FVAL
     I                                    P 124 1308BCXR
     I                                    P 131 1378LCXR
     I                                      138 1390SDST
     I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
     I                                      152 161 TSTN
     I                                      162 1630MDST
     I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
     I                                      176 185 TMAN
     I                                    P 192 1980DISA
     I                                    P 205 2110DPTD
     I                                      212 2120ICBS
     I                                      213 213 IPFR
     I                                    P 214 2200TOTI
     I                                    P 221 2230NIDT
     I                                    P 224 2260IBDT
     I                                    P 227 2290SLID
     I                                    P 230 2360AIPD
     I                                    P 237 2390DLRC
     I                                    P 240 2420IACD
     I                                    P 243 2490AITC
     I                                    P 250 2560AIAN
     I                                    P 257 2630AIAP
     I                                    P 264 2700IPRD
     I                                    P 271 2770IPRM
     I                                    P 278 2840SAPR
     I                                      285 2900ASDN
     I                                    P 291 2930SADT
     I                                    P 294 2960DAVDDD
     I                                      297 2990DASNDD
     I                                      300 309 FACO
     I                                      310 344 SPI
     I                                      345 3460INTF
     I                                    P 348 3540PINT1                 136030
     I                                      370 370 DNSI
     I                                      371 371 DSTI
     I                                      372 372 CNFI
     I                                      373 373 ACEI
     I                                      374 374 TLXI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 402 BOKC                  S01117
     I                                      403 4080LNKDN                 S01117
     I                                      409 4100RSTM                  S01177
     I**********                            411 422 RONS                               S01177 CGL029
     I                                      411 422 RONSQQ                                    CGL029
     I                                      423 430 RIBN                  S01177
     I                                      431 465 RIBA                  S01177
     I**********                            466 4710ROBN                               S01177 CSD027
     I**********                            472 4770ROCN                               S01177 CSD027
     I                                      466 471 ROBN                                      CSD027
     I                                      472 477 ROCN                                      CSD027
     I                                      478 4790PSTM                  S01177
     I**********                            480 491 PONS                               S01177 CGL029
     I                                      480 491 PONSQQ                                    CGL029
     I                                      492 499 PIBN                  S01177
     I                                      500 534 PIBA                  S01177
     I**********                            535 5400POBN                               S01177 CSD027
     I**********                            541 5460POCN                               S01177 CSD027
     I                                      535 540 POBN                                      CSD027
     I                                      541 546 POCN                                      CSD027
     I                                      547 554 RCRN                  S01177
     I                                      555 589 RCRA                  S01177
     I                                      590 597 RVNO                  S01177
     I                                      598 605 AWBN                  S01177
     I                                      606 640 AWBA                  S01177
     I                                      641 648 BENN                  S01177
     I                                      649 683 BENA                  S01177
     I                                      684 718 DTP1                  S01177
     I                                      719 753 DTP2                  S01177
     I                                      754 788 DTP3                  S01177
     I                                      789 823 DTP4                  S01177
     I                                      824 826 DCHG                  S01177
     I                                      827 861 BTB1                  S01177
     I                                      862 896 BTB2                  S01177
     I                                      897 931 BTB3                  S01177
     I                                      932 966 BTB4                  S01177
     I                                      9671001 BTB5                  S01177
     I                                     10021036 BTB6                  S01177
     I                                     10371039 ORBR                  S01117
     I                                     10401043 PRFC                  S01117
     I                                     10441046 POBR                  S01117
     I                                     10471049 ROBR                  S01117
     I                                     10501050 CVMR                  E22405
     I                                     10511051 JRDFC                 S01392
     I                                     11291131 STCY                  CEU003
     I                                     11321134 IC72                  CEU003
     I                                     12451262 OSDA                                      CGL029
     I                                     12631280 OMDA                                      CGL029
     I                                     12811298 RONS                                      CGL029
     I                                     12991316 PONS                                      CGL029
     I*
     I*
     I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
     I*
     IDEALS   NS  11   8 CE
     I                                        1   1 RECI
     I                                        1   1 RECIDL                E20474
     I                                        2   70DLNODE
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160CNUM                                      CSD027
     I                                       11  16 CNUM                                      CSD027
     I*****                                  17  190BRCD                  S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP
     I                                       22  23 DLST
     I                                    P  24  260DDAT
     I                                    P  27  290VDAT
     I                                       35  38 BRKC
     I                                    P  39  450BAGE
     I                                       46  48 CCY
     I                                    P  49  550SAPR
     I                                    P  57  627YRAT
     I                                    P  77  827INTR
     I                                       86 105 RNNA
     I**********                            106 1110ISCN                                      CSD027
     I                                      106 111 ISCN                                      CSD027
     I                                    P 117 1230FVAL
     I                                      138 1390SETP
     I**********                            140 151 OSAC                                      CGL029
     I                                      140 151 OSACQQ                                    CGL029
     I                                      152 161 TSEN
     I                                      162 164 ORBR                  S01117
     I                                      165 167 ROBR                  S01117
     I                                      168 171 PRFC                  S01117
     I*********                           P 285 2900RPDN                  092905
     I                                      285 2900RPDN                  092905
     I                                      370 370 DNSI
     I                                      371 371 DSTI
     I                                      372 372 CNFI
     I                                      373 373 ACEI
     I                                      374 374 TLXI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 402 BOKC                  S01117
     I                                      403 4080LNKDN                 S01117
     I                                      409 4100RSTM                  S01177
     I**********                            411 422 RONS                               S01177 CGL029
     I                                      411 422 RONSQQ                                    CGL029
     I                                      423 430 RIBN                  S01177
     I                                      431 465 RIBA                  S01177
     I**********                            466 4710ROBN                               S01177 CSD027
     I**********                            472 4770ROCN                               S01177 CSD027
     I                                      466 471 ROBN                                      CSD027
     I                                      472 477 ROCN                                      CSD027
     I                                      478 4790PSTM                  S01177
     I**********                            480 491 PONS                               S01177 CGL029
     I                                      480 491 PONSQQ                                    CGL029
     I                                      492 499 PIBN                  S01177
     I                                      500 534 PIBA                  S01177
     I**********                            535 5400POBN                               S01177 CSD027
     I**********                            541 5460POCN                               S01177 CSD027
     I                                      535 540 POBN                                      CSD027
     I                                      541 546 POCN                                      CSD027
     I                                      547 554 RCRN                  S01177
     I                                      555 589 RCRA                  S01177
     I                                      590 597 RVNO                  S01177
     I                                      598 605 AWBN                  S01177
     I                                      606 640 AWBA                  S01177
     I                                      641 648 BENN                  S01177
     I                                      649 683 BENA                  S01177
     I                                      684 718 DTP1                  S01177
     I                                      719 753 DTP2                  S01177
     I                                      754 788 DTP3                  S01177
     I                                      789 823 DTP4                  S01177
     I                                      824 826 DCHG                  S01177
     I                                      827 861 BTB1                  S01177
     I                                      862 896 BTB2                  S01177
     I                                      897 931 BTB3                  S01177
     I                                      932 966 BTB4                  S01177
     I                                      9671001 BTB5                  S01177
     I                                     10021036 BTB6                  S01177
     I                                     10371037 CVMR                  E22405
     I                                     10421044 STCY                  CEU003
     I                                     10451047 IC72                  CEU003
     I                                     10481065 OSAC                                      CGL029
     I                                     10661083 RONS                                      CGL029
     I                                     10841101 PONS                                      CGL029
     I*                                                                   S01119
     I*    DEALS FILE - DETAIL RECORD - FRA/IRS/CAP & COLLAR.             S01119
     I*                                                                   S01119
     I        NS  15   8 CG                                               S01119
     I                                        1   1 RECI                  S01119
     I                                        2   70DLNO                  S01119
     I                                        8   8 RCDT                  S01119
     I                                        9  100RCDC                  S01119
     I**********                             11  160CNUM                               S01119 CSD027
     I                                       11  16 CNUM                                      CSD027
     I***************************************17  190BRCD            S01119LN0612
     I                                       17  19 BRCA                  LN0612
     I                                       20  21 DTYP                  S01119
     I                                       22  23 DLST                  S01119
     I                                    P  24  260DDAT                  S01119
     I                                    P  27  290VDAT                  S01119
     I                                    P  30  320MDAT                  S01119
     I                                       33  340CDAS                  S01119
     I                                       35  38 BRKC                  S01119
     I                                    P  39  450BAGE                  S01119
     I                                       46  510LNKDN                 S01119
     I                                       52  52 HEDIN                 S01119
     I                                       53  53 TAXI                  S01119
     I                                       54  56 UCUCY                 S01119
     I                                    P  57  630UPAMT                 S01119
     I**********                             64  650UBRTT                 S01119              CSD103
     I                                       64  65 UBRTT                                     CSD103
     I                                    P  66  717USTRT                 S01119
     I                                    P  72  777UBRTE                 S01119
     I                                    P  78  837URTSP                 S01119
     I                                       84  84 USPIN                 S01119
     I                                    P  85  907UEINR                 S01119
     I                                       91  910UICBS                 S01119
     I                                       92  930UFRFD                 S01119
     I                                    P  94  960UINFD                 S01119
     I                                    P  97  990USLIP                 S01119
     I                                    P 100 1020UNICD                 S01119
     I                                    P 103 1050UICBD                 S01119
     I                                      106 106 UICFR                 S01119
     I                                      107 1080UICFD                 S01119
     I                                    P 109 1110UNIPD                 S01119
     I                                    P 112 1140UIPBD                 S01119
     I                                      115 115 UIPFR                 S01119
     I                                      116 1170UIPFD                 S01119
     I                                    P 118 1248UBCXR                 S01119
     I                                    P 125 1270UIACD                 S01119
     I                                    P 128 1340UIALC                 S01119
     I                                    P 135 1410UAITC                 S01119
     I                                    P 142 1480UAIPD                 S01119
     I                                    P 149 1550UAIAN                 S01119
     I                                    P 156 1620UAIAP                 S01119
     I                                    P 163 1690UIPRD                 S01119
     I                                    P 170 1760UIPRM                 S01119
     I                                    P 177 1830UNSAM                 S01119
     I                                    P 184 1900UTAXD                 S01119
     I                                    P 191 1970UTAXM                 S01119
     I                                      198 200 TCUCY                 S01119
     I                                    P 201 2070TPAMT                 S01119
     I**********                            208 2090TBRTT                 S01119              CSD103
     I                                      208 209 TBRTT                                     CSD103
     I                                    P 210 2157TSTRT                 S01119
     I                                    P 216 2217TBRTE                 S01119
     I                                    P 222 2277TRTSP                 S01119
     I                                      228 228 TSPIN                 S01119
     I                                    P 229 2347TEINR                 S01119
     I                                      235 2350TICBS                 S01119
     I                                      236 2370TFRFD                 S01119
     I                                    P 238 2400TINFD                 S01119
     I                                    P 241 2430TSLIP                 S01119
     I                                    P 244 2460TNICD                 S01119
     I                                    P 247 2490TICBD                 S01119
     I                                      250 250 TICFR                 S01119
     I                                      251 2520TICFD                 S01119
     I                                    P 253 2550TNIPD                 S01119
     I                                    P 256 2580TIPBD                 S01119
     I                                      259 259 TIPFR                 S01119
     I                                      260 2610TIPFD                 S01119
     I                                    P 262 2688TBCXR                 S01119
     I                                    P 269 2710TIACD                 S01119
     I                                    P 272 2780TIALC                 S01119
     I                                    P 279 2850TAITC                 S01119
     I                                    P 286 2920TAIPD                 S01119
     I                                    P 293 2990TAIAN                 S01119
     I                                    P 300 3060TAIAP                 S01119
     I                                    P 307 3130TIPRD                 S01119
     I                                    P 314 3200TIPRM                 S01119
     I                                    P 321 3270TNSAM                 S01119
     I                                    P 328 3340TTAXD                 S01119
     I                                    P 335 3410TTAXM                 S01119
     I                                    P 342 3477CLRAT                 S01119
     I                                    P 348 3537FLRAT                 S01119
     I                                    P 354 3550AVPER                 S01119
     I                                    P 356 3638TIRAT                 S01119
     I                                    P 364 3697AACRT                 S01119
     I                                      370 3710RSETM                 S01119
     I**********                            372 383 URACC                              S01119 CGL029
     I                                      372 383 URACQQ                                    CGL029
     I                                      384 393 CPPBK                 S01119
     I                                      394 3950PSETM                 S01119
     I**********                            396 407 UPACC                              S01119 CGL029
     I                                      396 407 UPACQQ                                    CGL029
     I                                      408 417 CPRBK                 S01119
     I                                      418 427 FACO                  S01119
     I                                      428 462 SPI                   S01119
     I                                    P 463 4650SDCAR                 S01119
     I                                    P 466 4680ULPCD                 S01119
     I                                    P 469 4710TLPCD                 S01119
     I                                    P 472 4780UAEXA                 S01119
     I                                    P 479 4850TAEXA                 S01119
     I                                      570 570 UDNSI                 S01119
     I                                      571 571 TDNSI                 S01119
     I                                      572 572 UDSTI                 S01119
     I                                      573 573 TDSTI                 S01119
     I                                      574 574 CNFI                  S01119
     I                                      575 575 ACEI                  S01119
     I                                      576 576 TLXI                  S01119
     I                                    P 587 5880LSWC                  S01119
     I                                    P 589 5900LSWS                  S01119
     I                                    P 591 5930ORED                  S01119
     I                                    P 594 5960LCD                   S01119
     I                                      597 597 CHTP                  S01119
     I                                    P 598 6000TNLU                  S01119
     I                                      606 608 ROBR                  LN0612
     I                                      609 611 POBR                  LN0612
     I                                      716 7170RSTM                  CSW005
     I**********                            718 729 RONS                               CSW005 CGL029
     I                                      718 729 RONSQQ                                    CGL029
     I                                      730 737 RIBN                  CSW005
     I                                      738 772 RIBA                  CSW005
     I**********                            773 7780ROBN                               CSW005 CSD027
     I**********                            779 7840ROCN                               CSW005 CSD027
     I                                      773 778 ROBN                                      CSD027
     I                                      779 784 ROCN                                      CSD027
     I                                      785 7860PSTM                  CSW005
     I**********                            787 798 PONS                               CSW005 CGL029
     I                                      787 798 PONSQQ                                    CGL029
     I                                      799 806 PIBN                  CSW005
     I                                      807 841 PIBA                  CSW005
     I**********                            842 8470POBN                               CSW005 CSD027
     I**********                            848 8530POCN                               CSW005 CSD027
     I                                      842 847 POBN                                      CSD027
     I                                      848 853 POCN                                      CSD027
     I                                      854 861 RCRN                  CSW005
     I                                      862 896 RCRA                  CSW005
     I                                      897 904 RVNO                  CSW005
     I                                      905 912 AWBN                  CSW005
     I                                      913 947 AWBA                  CSW005
     I                                      948 955 BENN                  CSW005
     I                                      956 990 BENA                  CSW005
     I                                      9911025 DTP1                  CSW005
     I                                     10261060 DTP2                  CSW005
     I                                     10611095 DTP3                  CSW005
     I                                     10961130 DTP4                  CSW005
     I                                     11311133 DCHG                  CSW005
     I                                     11341168 BTB1                  CSW005
     I                                     11691203 BTB2                  CSW005
     I                                     12041238 BTB3                  CSW005
     I                                     12391273 BTB4                  CSW005
     I                                     12741308 BTB5                  CSW005
     I                                     13091343 BTB6                  CSW005
     I                                     13441344 CVMR                  CSW005
     I                                     19982000 RSCY                  CEU003
     I                                     20012003 PSCY                  CEU003
     I                                     20042006 IC72                  CEU003
     I                                     24692486 URACC                                     CGL029
     I                                     24872504 UPACC                                     CGL029
     I                                     25052522 RONS                                      CGL029
     I                                     25232540 PONS                                      CGL029
     I*
     I* CATCHALL
     I        NS
     I                                        1   1 RECI
0209 I*                                                                   S01392
0210 I**   Deals File - Detail - Takings/Placings/Time Deposits/Loans     S01392
0211 I*                                                                   S01392
0212 IDRSDEALSNS                                                          S01392
0212 I                                    P 214 2200TOTI2                 S01392
     I*
     I*
     I*    DEALS AMENDMENT FILE - DETAIL RECORD.
     I*
     IDEAMS   NS  12   1 CD
     I       OR   13   1 CR
     I                                        1   1 RECIDI
     I                                        2   70DLNODI
     I                                        8  120VDATDI
     I                                       13  150DASNDI
     I                                       16  17 DTYPDI
     I                                       18  19 DLSTDI
     I                                       20  21 AMTPDI
     I                                       22  220PSEQDI
     I**********                             23  240BRTTDI                                    CSD103
     I                                       23  24 BRTTDI                                    CSD103
     I                                    P  25  307RTSPDI
     I                                       31  33 CCYDI
     I                                    P  34  400DAAMDI
     I                                       41  41 MOGIDI
     I**********                             42  470CNUMDI                                    CSD027
     I                                       42  47 CNUMDI                                    CSD027
     I                                       48  490SETPDI
     I**********                             50  61 OSACDI                                    CGL029
     I                                       50  61 OSAC#1                                    CGL029
     I                                       62  71 TSENDI
     I                                       72  81 FACODI
     I                                       82 116 SPIDI
     I                                      117 119 OSBR                  S01117
     I                                    P 139 1410NAADDI
     I                                      142 1440NASNDI
     I                                      145 145 DAINDI
     I                                    P 191 1930OREDDI
     I                                    P 194 1960LCDDI
     I                                      197 197 CHTPDI
     I                                    P 198 2000TNLU
     I                                      201 2020RSTM                  S01177
     I**********                            203 214 RONS                               S01177 CGL029
     I                                      203 214 RONSQQ                                    CGL029
     I                                      215 222 RIBN                  S01177
     I                                      223 257 RIBA                  S01177
     I**********                            258 2630ROBN                               S01177 CSD027
     I**********                            264 2690ROCN                               S01177 CSD027
     I                                      258 263 ROBN                                      CSD027
     I                                      264 269 ROCN                                      CSD027
     I                                      270 2710PSTM                  S01177
     I**********                            272 283 PONS                               S01177 CGL029
     I                                      272 283 PONSQQ                                    CGL029
     I                                      284 291 PIBN                  S01177
     I                                      292 326 PIBA                  S01177
     I**********                            327 3320POBN                               S01177 CSD027
     I**********                            333 3380POCN                               S01177 CSD027
     I                                      327 332 POBN                                      CSD027
     I                                      333 338 POCN                                      CSD027
     I                                      339 346 RCRN                  S01177
     I                                      347 381 RCRA                  S01177
     I                                      382 389 RVNO                  S01177
     I                                      390 397 AWBN                  S01177
     I                                      398 432 AWBA                  S01177
     I                                      433 440 BENN                  S01177
     I                                      441 475 BENA                  S01177
     I                                      476 510 DTP1                  S01177
     I                                      511 545 DTP2                  S01177
     I                                      546 580 DTP3                  S01177
     I                                      581 615 DTP4                  S01177
     I                                      616 618 DCHG                  S01177
     I                                      619 653 BTB1                  S01177
     I                                      654 688 BTB2                  S01177
     I                                      689 723 BTB3                  S01177
     I                                      724 758 BTB4                  S01177
     I                                      759 793 BTB5                  S01177
     I                                      794 828 BTB6                  S01177
     I                                      829 829 CVMR                  E22405
     I                                      838 840 STCYDI                CEU003
     I                                      841 843 IC72DI                CEU003
     I                                      844 845 FCGCDI                CDL006
     I                                      846 865 FCGDDI                CDL006
     I                                    P 866 8720FCGADI                CDL006
     I                                    P 873 8770FCGTDI                CDL006
     I                                      880 897 OSACDI                                    CGL029
     I                                      898 915 RONS                                      CGL029
     I                                      916 933 PONS                                      CGL029
     I*
     I* CATCHALL
     I        NS
     I                                        2   70DLNODI
     I                                    P 139 1410NAADDI
     I                                      142 1440NASNDI
     IDLFVALF                                                             136030
     I              RECI                            RECINS                136030
     I              RPDN                            RPDNNS                136030
     I              VDAT                            VDATNS                136030
     I              FVAL                            FVALNS                136030
     IDTRIXDF                                                                               MD034285
     I              RECI                            DTRECI                                  MD034285
     I              RCDT                            DTRCDT                                  MD034285
     I              DLNO                            DTDLNO                                  MD034285
     I              VDAT                            DTVDAT                                  MD034285
     I              DASN                            DTDASN                                  MD034285
     I              CHTP                            DTCHTP                                  MD034285
     I              CNRQ                            DTCNRQ                                  MD034285
     I              CNPR                            DTCNPR                                  MD034285
     I              REPR                            DTREPR                                  MD034285
     I              TIM                             DTTIM                                   MD034285
     I              PRI1                            DTPRI1                                  MD034285
     I              PRI2                            DTPRI2                                  MD034285
     I              PRI3                            DTPRI3                                  MD034285
     I              BRCA                            DTBRCA                                  MD034285
     I              TNLU                            DTTNLU                                  MD034285
0479 I*****                                                       *****   S01194
0480 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.       *****   S01194
0481 I*****                                                       *****   S01194
0482 I*ABLE   NS       2 C0   3 C1  12 C1                         *****   S01194
0483 I*****  AND      13 C0                                       *****   S01194
0484 I*****                                   1   1 RECI          *****   S01194
0485 I*****                                   2   30RECT          *****   S01194
0486 I*****                                  12  130RCDE          *****   S01194
0487 I*****                                  14  66 TITL          *****   S01194
0488 I*****                                  67  67 DATF          *****   S01194
0489 I*****                                  68  700DFBR    20****S01117  S01194
0489 I*****                                  68  70 DFBM    20****S01117  S01194
     I*****                                  72  72 CHIM          *****   S01194
0490 I*****                                  73  73 SWIM          *****   S01194
0491 I*****                                  74  74 MODI1         *****   S01194
0492 I*****                                  75  75 MODI2         *****   S01194
0493 I*****                                  76  76 MODI3         *****   S01194
0494 I*****                               P  77  790RUND          *****   S01194
0495 I*****                                  80  86 RUNA          *****   S01194
0496 I*****                                  87  870SFLG          *****   S01194
0496 I*****                                  89  89 MODI5         S01135  S01194
0497 I*****                               P  90  920LCD           *****   S01194
0498 I*****                                  93  93 CHTP          *****   S01194
0499 I*****                               P  94  960TNLU          *****   S01194
0500 I*****                                                       *****   S01194
0501 I*****                                                       *****   S01194
0502 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.       *****   S01194
0503 I*****                                                       *****   S01194
0504 I*****   NS              2 C0   3 C1                         *****   S01194
0505 I*****  AND      12 C1  13 C1                                *****   S01194
0506 I*****                                   1   1 RECI          *****   S01194
0507 I*****                                   2   30RECT          *****   S01194
0508 I*****                                  12  130RCDE          *****   S01194
0509 I*****                                  14  16 BCCY          *****   S01194
0510 I*****                                  17  19 BCYL          *****   S01194
0511 I*****                                  20  22 HOCY          *****   S01194
0512 I*****                                  23  280HEAD          *****   S01194
0513 I*****                               P  29  310APDA          *****   S01194
0514 I*****                                  35  35 APFQ          *****   S01194
0515 I*****                               P  36  380LOGS          *****   S01194
0516 I*****                                  39  40 CUZR          *****   S01194
0517 I*****                               P  41  430DNWD          *****   S01194
0518 I*****                                  44  460BVLP          *****   S01194
0519 I*****                                  47  49 LOCY          *****   S01194
0520 I*****                                  50  510FDAY          *****   S01194
0521 I*****                                  52  52 ACLD          *****   S01194
0522 I*****                                  86  86 ISAV          *****   S01194
0523 I*****                               P  87  890LLOG          *****   S01194
0524 I*****                               P  90  920LCD           *****   S01194
0525 I*****                                  93  93 CHTP          *****   S01194
0526 I*****                               P  94  960TNLU          *****   S01194
0527 I*****                                                       *****   S01194
0528 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.       *****   S01194
0529 I*****                                                       *****   S01194
0530 I*ABLE   NS              2 C0   3 C1                         *****   S01194
0531 I*****  AND      12 C4  13 C0                                *****   S01194
0532 I*****                                   1   1 RECI          *****   S01194
0533 I*****                                   2   30RECT          *****   S01194
0534 I*****                                  12  130RCDE          *****   S01194
0535 I*****                                  18  210CSAC          *****   S01194
0536 I*****                                  22  22 TLII          *****   S01194
0537 I*****                                  23  23 MCRI          *****   S01194
0538 I*****                               P  24  250MCEP          *****   S01194
0539 I*****                                  26  270MCLP          *****   S01194
0540 I*****                                  28  28 FRDI          *****   S01194
0541 I*****                                  29  29 BRCF          *****   S01194
0542 I*****                                  30  350PSCN          *****   S01194
0543 I***********                            36  380DLBR          S01117  S01194
0543 I*****                                  36  38 DLBR          S01117  S01194
0544 I*****                                  39  420FRPA          *****   S01194
0545 I*****                                  43  460FRPC          *****   S01194
0546 I*****                                  47  49 USCY          *****   S01194
0547 I*****                                  50  52 STCY          *****   S01194
0548 I*****                               P  53  553MBGE          *****   S01194
0549 I*****                                  56  56 PRID          *****   S01194
0550 I*****                                  57  57 FFNY          *****   S01194
0551 I*****                                  58  58 OURC          *****   S01194
0552 I*****                                  59  59 BRNC          *****   S01194
0553 I*****                                  60  60 LCYN          *****   S01194
0554 I*****                                  78  780PR1           *****   S01194
0555 I*****                                  79  790PR2           *****   S01194
0556 I*****                                  80  800PR3           *****   S01194
0557 I*****                                  81  810PR4           *****   S01194
0558 I*****                                  82  820PR5           *****   S01194
0559 I*****                                  83  830PR6           *****   S01194
0560 I*****                                  84  840PR7           *****   S01194
0561 I*****                                  85  850PR8           *****   S01194
0562 I*****                               P  87  892TAXR          *****   S01194
0563 I*****                               P  90  920LCD           *****   S01194
0564 I*****                                  93  93 CHTP          *****   S01194
0565 I*****                               P  94  960TNLU          *****   S01194
0566 I*****                                                       *****   S01194
0567 I*****TABLE FILE - BRANCH CODES RECORD.                      *****   S01194
0568 I*****                                                       *****   S01194
0569 I*ABLE   NS              2 C1   3 C0                         *****   S01194
0570 I*****                                   1   1 RECI          *****   S01194
0571 I*****                                   2   30RECT          *****   S01194
0572 I*****                                  11  130BRCD          S01117  S01194
0572 I*****                                  11  13 BRCA          S01117  S01194
0573 I*****                                  14  43 BRNM          *****   S01194
0574 I*****                                  44  490BICN          *****   S01194
0575 I*****                                  50  51 LOCC          *****   S01194
0576 I*****                                  52  53 CMPY          S01117  S01194
0576 I*****                                  52  54 CMPYM         S01117  S01194
0577 I*****                               P  90  920LCD           *****   S01194
0578 I*****                                  93  93 CHTP          *****   S01194
0579 I*****                               P  94  960TNLU          *****   S01194
0580 I*****                                                       *****   S01194
0581 I*****                                                       *****   S01194
0582 I*****TABLE FILE - NOSTROS RECORD.                           *****   S01194
0583 I*****                                                       *****   S01194
0584 I*ABLE   NS              2 C7   3 C0                         *****   S01194
0585 I*****                                   1   1 RECI          *****   S01194
0586 I*****                                   2   30RECT          *****   S01194
0587 I*****                                   9  11 CCY           *****   S01194
0588 I*****                                  12  130NOSN          *****   S01194
0589 I*****                                  16  29 ONAC          *****   S01194
0590 I*****                                  30  350CNUMTL        *****   S01194
0591 I*****                                  36  370ACSQ          *****   S01194
0592 I*****                                  38  410ACOD          *****   S01194
0593 I*****                               P  90  920LCD           *****   S01194
0594 I*****                                  93  93 CHTP          *****   S01194
0595 I*****                               P  94  960TNLU          *****   S01194
0596 I*****                                                       *****   S01194
0597 I*****CHALL                                                  *****   S01194
0598 I*****   NS                                                  *****   S01194
0599 I*****                                   1   1 RECI          *****   S01194
0600 I*****                                                       *****   S01194
0178 I*****                                                       S01177  S01194
0179 I*****TABLE FILE - COUNTERPARTY NOSTROS RECORD.              S01177  S01194
0180 I*****                                                       S01177  S01194
0181 I*ABLE   NS       1 CD   2 C7   3 C1                         S01177  S01194
0183 I*****                                   1   1 RECI          S01177  S01194
0184 I*****                                   2   30RECT          S01177  S01194
0185 I*****                                   6  13 CPSH          S01177  S01194
0186 I*****                                  14  48 CPNM          S01177  S01194
0187 I*****                                  49  68 CPTN          S01177  S01194
0188 I*****                               P  90  920LCD           S01177  S01194
0189 I*****                                  93  93 CHTP          S01177  S01194
0190 I*****                               P  94  960TNLU          S01177  S01194
0600 I*****                                                       *****   S01194
0601 I*****CUSTOMER SHORTNAMES FILE - DETAIL RECORD.              *****   S01194
0602 I*****                                                       *****   S01194
0603 I**AME   NS       1 CD                                       *****   S01194
0604 I*****                                   1   1 RECI          *****   S01194
0605 I*****                                  39  48 CSNM          *****   S01194
0606 I*****                                   2   70CNUMCD        *****   S01194
0607 I*****                                                       *****   S01194
0608 I***ATCHALL                                                  *****   S01194
0609 I*****   NS  41                                              *****   S01194
0610 I*****                                                       *****   S01194
0610 I*****                                                       *****   S01194
0611 I*****CLIENT FILE - CUSTOMER STANDING DATA RECORD.           *****   S01194
0612 I*****                                                       *****   S01194
0613 I*LINT   NS  14   1 CD   8 CA                                *****   S01194
0614 I*****                                   1   1 RECI          *****   S01194
0615 I*****                                   8   8 RCDTCL        *****   S01194
0616 I*****                                   9  28 CRNM          *****   S01194
0617 I*****                                  29  38 CTWN          *****   S01194
0618 I*****                                  39  48 CSNM          *****   S01194
0619 I*****                                  49  56 CASK          *****   S01194
0620 I*****                                  57  68 TELX          *****   S01194
0621 I*****                                  69  80 CSID          *****   S01194
0622 I*****                                  81  82 ACOC          *****   S01194
0623 I*****                                  83  83 CBSI          *****   S01194
0624 I*****                                  84  85 CCTZ          *****   S01194
0625 I*****                                  86  87 CLOC          *****   S01194
0626 I*****                                  88  930CPAR          *****   S01194
0628 I*****                                  97  980LINS          *****   S01194
0629 I*****                                  99 1010LIND          *****   S01194
0630 I*****                               P 102 1040DASU          *****   S01194
0631 I*****                               P 105 1070CDIC          *****   S01194
0632 I*****                               P 108 1100DADE          *****   S01194
0633 I*****                                 111 111 CMIN          *****   S01194
0634 I*****                                 112 112 CTYP          *****   S01194
0635 I*****                                 113 124 TELF          *****   S01194
0636 I*****                                 125 133 CHID          *****   S01194
0637 I*****                                 134 136 CHAB          *****   S01194
0637 I*****                                 195 195 GSFM          S01144  S01194
0638 I*****                               P 250 2520LCD           *****   S01194
0639 I*****                                 253 253 CHTP          *****   S01194
0640 I*****                               P 254 2560TNLU          *****   S01194
0641 I*****                                                       *****   S01194
0642 I*****CHALL                                                  *****   S01194
0643 I*****                                                       *****   S01194
     I*****   NS                                                  *****   S01194
0645 I*****                                   1   1 RECI          *****   S01194
0392 ISDBANK    E DSSDBANKPD                                              S01194
0393 I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
0393 I*                                                                   S01194
0392 ISDMMOD    E DSSDMMODPD                                              S01194
0393 I* MODULE DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
0393 I*                                                                   S01194
0392 ISDTRAD    E DSSDTRADPD                                              S01194
0393 I* TRADING DETAILS ACCESSED VIA ACCESS PROGRAM                       S01194
0393 I*                                                                   S01194
0392 ISDDEAL    E DSSDDEALPD                                              S01194
     I              QQACCD                          QQACC1                                    CGL029
0393 I* DEALING DETAILS ACCESSED VIA ACCESS PROGRAM                       S01194
0393 I*                                                                   S01194
0392 ISDBRCH    E DSSDBRCHPD                                              S01194
0393 I* BRANCH DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
0393 I*                                                                   S01194
0392 ISDNOST    E DSSDNOSTPD                                              S01194
     I              QQACCD                          QQACC2                                    CGL029
0393 I* NOSTRO DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
     I*                                                                   S01194
0392 ISDCUST    E DSSDCUSTPD                                              S01194
     I              QQDFAC                          QQDFA1                                    CGL029
0393 I* CUSTOMER DETAILS ACCESSED VIA ACCESS PROGRAM                      S01194
0393 I***********                                                         E107
0392 I*SDCNST****E DSSDCNSTD0                                             S01194
0393 I**COUNTERPARTY DETAILS ACCESSED VIA ACCESS PROGRAM                  S01194
     I*                                                                   S01194
     ISDMGME    E DSSDMGMEPD                                              E29588
      **  Data structure for message management data.                     E29588
      *                                                                   E29588
     ISDLOCN    E DSSDLOCNPD                                                                  234068
      **  Data structure for Location Codes                                                   234068
      *                                                                                       234068
     ISDCTTX    E DSSDCTTXPD                                                                  234068
      ** Data Structure for Country of Tax Code Details                                       234068
      *                                                                                       234068
     ISCSARD    E DSSCSARDPD                                              CSW005
      **  Data structure for Switchable Features file                     CSW005
      *                                                                   CSW005
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
0393 I*                                                                   S01194
     I*                                                                   S01408
     I*                                                                                       CDL013
     I@CURR     E DSSDCURRPD                                                                  CDL013
     I** DUMMY RECORD FORMAT FOR CURRENCY DETAILS                                             CDL013
     I*                                                                                       CDL013
     I/COPY WNCPYSRC,DL1705IIP1                                           S01408
     I*                                                                   S01408
      *                                                                                       CDL033
     ISDGELR    E DSSDGELRPD                                                                  CDL033
     I              QQACCD                          QQACC3                                    CDL033
      ** Externally described DS for General Ledger ICD Details                               CDL033
      *                                                                                       CDL033
     ISDTXPA    E DSSDTXPAPD                                                                BUG22911
      ** Data structure for Tax Parameter File                                              BUG22911
      *                                                                                     BUG22911
     I/EJECT
     I* D A T A   S T R U C T U R E S
     I*
     I*  DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I* KEY FIELDS ON TRANS/DAIND FOR DUPLICATE KEY TEST
     I            DS
     I                                        1  14 KEY
     I                                        1   60DLNO
     I                                        7  110VDATDL
     I                                       12  140DASNDL
     I**LF/TABLE KEY                                              *****   S01194
     I*****       DS                                              *****   S01194
     I*****                                   1  12 ZTABKY        *****   S01194
     I*****                                   1   20RECT          *****   S01194
     I*****                                   8  10 CCY           *****   S01194
     I*****                                  11  120NOSN          *****   S01194
     I* KEY FROM DEALS,DC TO LF/DEAMS
     I            DS
     I                                        1  14 KEY2
     I                                        1   60DLNODC
     I                                        7  110DAVDDC
     I                                       12  140DASNDC
     I* KEY FROM DEAMS,DI TO LF/DEAMS - NEXT REC IN CHAIN.
     I            DS
     I                                        1  14 KEY3
     I                                        1   60DLNODI
     I                                        7  110NAADDI
     I                                       12  140NASNDI
     I* KEY FROM DEALS,DD TO LF/DEAMS
     I            DS
     I                                        1  14 KEY4
     I                                        1   60DLNODD
     I                                        7  110DAVDDD
     I                                       12  140DASNDD
     I* BLANK AREA FOR INITIALISING
     I            DS
     I                                        1  35 BLNK35
     I                                        1  10 BLNK10
     I* THEIR SETTLEMENT A/C   *START/PURCHASE*
     I            DS
     I                                        1  10 TSET1
     I                                        1  10 TSCN
     I                                        1  10 TSTN
     I                                        1  10 TSEN
     I* THEIR SETTLEMENT A/C   *MATURITY/SELL*
     I            DS
     I                                        1  10 TSET2
     I                                        1  10 TPCN
     I                                        1  10 TMAN
     I***O CHANGE SHORT-NAME TO CUSTOMER NUMBER IF APPLICABLE     *****   S01194
     I*****       DS                                              *****   S01194
     I*****                                   1  10 SNCUST        *****   S01194
     I*****                                   1   60CNUMCD        *****   S01194
     I* SETTLEMENT TYPE AT START/PURCHASE
     I            DS
     I                                        1   20SET1
     I                                        1   20PCST
     I                                        1   20SDST
     I                                        1   20SETP
     I* SETTLEMENT TYPE FOR MATURITY/SALE
     I            DS
     I                                        1   20SET2
     I                                        1   20SCST
     I                                        1   20MDST
     I/EJECT
     I* D A T A   S T R U C T U R E   F O R   O U T P U T   R E C O R D
     I            DS
     I****************************************1 160 PREX                  E22600
     I***********                             1 182 PREX           E22600 CEU003
     I**********                              1 211 PREX           CEU003 CIR003
     I**********                              1 212 PREX                               CIR003 CGL029
     I                                        1 230 PREX                                      CGL029
     I                                        1   1 RECIPH
     I                                        2   2 PAYREC
     I                                        3   40SETTLE
     I                                        5   50PRODPH
     I                                        6   8 CURREN
     I**********                              9  20 OURAG                                     CGL029
     I                                        9  20 OURAG1                                    CGL029
     I                                       21  23 OURSB                 S01117
     I                                       31  310FFIN
     I* VALUE DATE WILL BE WRITTEN HERE
     I                                       35  44 THRAG
     I                                       35  40 IFCUST
     I**********                             35  400CUST                                      CSD027
     I**********                             55  600CNUMPH                                    CSD027
     I                                       35  40 CUST                                      CSD027
     I                                       55  60 CNUMPH                                    CSD027
     I                                       61  660DLNOPH
     I* EVENT AMOUNT WILL BE WRITTEN HERE
     I                                       75  75 RCDT
     I                                       76  780DASNPH
     I                                       79  88 OTFACO
     I                                       89  89 CVMI                  S01177
     I                                       99 133 OTSPI
     I                                      134 136 PINDS
     I**********************                137 1420BICN
     I                                      137 142 BICN
     I                                      143 144 DTYP
     I                                      145 146 DLST
     I*****                                 147 1490BRCD                  S01117
     I                                      147 149 BRCA                  S01117
     I                                      150 1500RCPI
     I                                      151 1560RRDN
     I                                      157 158 MTIN
     I                                      159 159 MTEX
     I**********                            161 1660POBK                               E22600 CSD027
     I                                      161 166 POBK                                      CSD027
     I                                      167 174 SDRN                  E22600
     I                                      175 182 RCRD                  E22600
     I                                    P 202 2080OTRA                  CEU003
     I                                      209 211 OTRC                  CEU003
     I                                      212 212 CREQ                  CIR003
     I                                      213 230 OURAG                                     CGL029
     I*
     I* DS FOR DTRIEHH FIELDS
     I            DS
     I                                        1   4 ZZ0034
     I                                    P   2   40RRNT
     I            DS                             40
     I                                    P  14  160NDLR
     I                                    P  17  190NDAR
     I                                        7  40 SPARE
     I* DS FOR PSEUDO I/P PROCESSING
     I            DS                              5
     I                                        1   50RIP1
     I                                        1   50RIP5
     I                                        1   50NORE
     I*                                                                   S01177
     I* DS FOR DETERMINING CONTENTS OF PONS                               S01177
     I            DS                                                      S01177
     I                                        1   6 CUSTST                S01177
     I                                        3   6 CUSTS2                S01177
     I*                                                                   S01177
     I            DS                                                      CSW096
      **  Data structure for determining contents of BBCSID               CSW096
     I                                        1  12 USCSID                CSW096
     I                                        8   8 USID                  CSW096
     I*                                                                   CSW096
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I*7RF      E DSSDNOSTPD                                      S01177  S01194
     I*RUNDAT******DS                                                     E107
     I***DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.           E107
     I*************                          13  13 @MBIN                 E107
     I/COPY WNCPYSRC,DL1705IIP2                                           S01408
     I** Base Rate detailes accessed via Access Program                   140335
     ISDBSRT    E DSSDBSRTPD                                              140335
      *                                                                                       CDL081
      ** Named constants                                                                      CDL081
      *                                                                                       CDL081
     I              'BasCcyTaxRoundDown'  C         C#BASE                                    CDL081
     I              'NBasCcyTaxRoundDown' C         C#NBAS                                    CDL081
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
     I/EJECT
     I/COPY WNCPYSRC,DL1705I003
     C**** GET MULTI BRANCH INDICATOR FROM DATA AREA - RUNDAT             E107
     C*********  *NAMVAR   DEFN           RUNDAT                          E107
     C*********            IN   RUNDAT                                    E107
     C*********                                                           S01117
     C********   @MBIN     IFEQ 'Y'                                       E107
0747 C********             SETON                     44                   E107
     C********             END                                            E107
     C* 1 S T   C Y C L E   P R O C E S S I N G
     C   40                GOTO START
     C                     SETON                     4089
     C/COPY WNCPYSRC,DL1705C105
     C   U7                SETOF                     89
     C                     SETOF                     U7
     C                     MOVEACPY@      BIS@   80
     C                     MOVE 'D'       RECIPH
     C*******              MOVEL'10'      BRKEY  12                       S01194
0752 C*******              EXSR ZSYSTM                            *****   S01194
0753 C***99**              SETON                     LRU760       *****   S01194
0754 C***20**              SETON                     44           *****   S01194
0755 C*******              MOVE ' 11'     ZTABKY                  *****   S01194
0756 C*******              EXSR TABCHN                            *****   S01194
0757 C***99**              SETON                     LRU761       *****   S01194
0758 C*******              MOVE ' 40'     ZTABKY                  *****   S01194
0759 C*******              EXSR TABCHN                            *****   S01194
0760 C***99**              SETON                     LRU762       *****   S01194
0761 C***U7**              GOTO END                               *****   S01194
0327 C* CALL ACCESS PROG. FOR BANK DETAILS.                               S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'001'     DBASE   3        * DBERR 001 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL'FIRST  ' DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
0327 C* CALL MODULE PROG. FOR MODULE DETAILS.                             S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDMMODPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'002'     DBASE   3        * DBERR 002 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL'FIRST  ' DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
      **  Access SDMGMEPD for MG/ME ICD                                   E29588
     C                     CALL 'AOMGMER0'                                E29588
     C                     PARM '*MSG   ' @RTCD                           E29588
     C                     PARM '*FIRST ' @OPTN                           E29588
     C           SDMGME    PARM SDMGME    DSFDY                           E29588
      *                                                                   E29588
     C           @RTCD     IFNE *BLANKS                                   E29588
     C                     MOVE '018'     DBASE            * * * * * * * *E29588
     C                     MOVEL'FIRST'   DBKEY            *  DBERR 018  *E29588
     C                     MOVEL'SDMGMEPD'DBFILE           * * * * * * * *E29588
     C                     SETON                     U7U8LR               E29588
     C                     EXSR *PSSR                                     E29588
     C                     END                                            E29588
      *                                                                   E29588
      * Set up dummy SDMGME field, ENXXXX                                 E29588
      * ENXXXX='Y' => retain PREX1 (Complete telexes) and route 01
      *               settlements to it
      * ENXXXX='N' => original MG/ME processing; 01 settlements are
      *               routed to PREX5 and processed as Electronic/MT
      **REMOVE WHEN MG/ME SD CHANGES DELIVERED                            E29588
      * If Midas Telex installed, generate electronic telexes for sett    094124
      * type 01 and paper for sett type 08.                               094124
      * If MT not installed, output only paper telex messages.            094124
      * Temporary fix until a flag is added to SDMGMEPD to enable user    094124
      * to select either electronic or paper telex messages.              094124
     C           BGMTMI    IFEQ 'Y'                                       094124
     C                     MOVE 'N'       ENXXXX  1                       094124
     C                     ELSE                                           094124
     C                     MOVE 'Y'       ENXXXX  1                       E29588
     C                     END                                            094124
     C/COPY WNCPYSRC,DL1705C077
      *                                                                   S01194
      ** CHECK MULTIBRANCHING FLAG                                        S01194
     C           BGMBIN    COMP 'Y'                      44               E107
0384 C*                                                                   S01194
0829 C**   I.E. IND 98 ON IF DATE FORMAT IND = 'M'                        S01194
0829 C           BJDFIN    COMP 'M'                      98               S01194
0384 C*                                                                   S01194
0762 C*****      PRID      COMP 'Y'                      46       *****   S01194
0763 C*****      LCYN      COMP 'B'                      25       *****   S01194
0763 C***********BLLCTB    COMP 'B'                      25         S01194BHF147
0384 C*                                                                   S01194
0327 C* CALL ACCESS PROGRAM FOR DEALING DETAILS.                          S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
0384 C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDEALPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'003'     DBASE   3        * DBERR 003 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL'FIRST  ' DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C* CALL ACCESS PROGRAM FOR TRADING DETAILS.                          S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
      *                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDTRADPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'016'     DBASE   3        * DBERR 016 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL'FIRST  ' DBKEY  29                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C/COPY WNCPYSRC,DLH00422
     C           BLLCTB    COMP 'B'                      25               BHF147
     C*                                                                   S01194
0764 C                     MOVE ' '       BLNK6   6
0384 C*                                                                   S01194
0765 C*****                MOVE PR1       PR,1                    *****   E16435
0766 C*****                MOVE PR2       PR,2                    *****   E16435
0767 C*****                MOVE PR3       PR,3                    *****   E16435
0768 C*****                MOVE PR4       PR,4                    *****   E16435
0769 C*****                MOVE PR5       PR,5                    *****   E16435
0770 C*****                MOVE PR6       PR,6                    *****   E16435
0771 C*****                MOVE PR7       PR,7                    *****   E16435
0772 C*****                MOVE PR8       PR,8                    *****   E16435
0773 C*
0774 C**   TEST SWIFT IND
0775 C*****                TESTB'0'       SWIM           30       *****   S01194
0775 C           BGSWDL    COMP 'Y'                      30               S01194
     C**   TEST FOR CHIPS INTERFACE
     C*****                TESTB'0'       CHIM           29       *****   S01194
     C           BGCHDL    COMP 'Y'                      29               S01194
     C/COPY WNCPYSRC,DL1705C070
     C**                                                                  S01383
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED     S01383
     C**                                                                  S01383
     C                     CALL 'AOSARDR0'                                S01383
     C                     PARM '       ' @RTCD                           S01383
     C                     PARM '*VERIFY' @OPTN                           S01383
     C                     PARM 'S01383'  @SARD   6                       S01383
     C           @RTCD     IFNE *BLANK                                    S01383
     C           @RTCD     ANDNE'*NRF   '                                 S01383
     C                     MOVEL'SCSARDPD'DBFILE            * * * * * * * S01383
     C                     MOVEL'020'     DBASE             *DBERROR 020* S01383
     C                     MOVEL@RTCD     DBKEY             * * * * * * * S01383
     C                     SETON                     U7U8LR               S01383
     C                     EXSR *PSSR                                     S01383
     C                     GOTO END                                       S01383
     C                     END                                            S01383
     C           @RTCD     IFEQ *BLANK                                    S01383
     C                     MOVEL'Y'       S01383  1                       S01383
     C                     MOVEL'1'       *IN19                           S01383
     C                     END                                            S01383
     C*                                                                   S01383
     C** IF BRT SAR INSTALLED, ACCESS BRT INSTALLATION CONTROL DATA       S01383
     C*                                                                   S01383
     C           S01383    IFEQ 'Y'                                       S01383
     C                     MOVE 'D'       KRECI   1                       S01383
     C           KRECI     CHAINSDBRTDD0             41                   S01383
     C           *IN41     IFEQ '1'                                       S01383
     C                     MOVEL'SDBRTDPD'DBFILE            * * * * * * * S01383
     C                     MOVEL'021'     DBASE             *DBERROR 021* S01383
     C                     SETON                     U7U8LR * * * * * * * S01383
     C                     EXSR *PSSR                                     S01383
     C                     GOTO END                                       S01383
     C                     END                                            S01383
     C*                                                                   S01383
     C** ELSE IF BRT SAR NOT INSTALLED, CHECK FOR HK INTEREST TAX         S01383
     C*                                                                   S01383
     C                     ELSE                                           S01383
0793 C           BNHKTR    COMP 0                    1919  TAX RATE NOT 0 S01383
      *                                                                                       CDL013
      ** Check CDL013 is installed.                                                           CDL013
     C                     CALL 'AOSARDR0'                                                    CDL013
     C                     PARM '       ' @RTCD                                               CDL013
     C                     PARM '*VERIFY' @OPTN                                               CDL013
     C                     PARM 'CDL013'  @SARD   6                                           CDL013
      *                                                                                       CDL013
      ** If program fails perform standard database error processing                          CDL013
     C           @RTCD     IFNE *BLANK                                                        CDL013
     C           @RTCD     ANDNE'*NRF   '                                                     CDL013
     C                     MOVEL'SCSARDPD'DBFILE            * * * * * * *                     CDL013
     C                     MOVEL'038'     DBASE             *DBERROR 038*                     CDL013
     C                     MOVEL@RTCD     DBKEY             * * * * * * *                     CDL013
     C                     SETON                     U7U8LR                                   CDL013
     C                     EXSR *PSSR                                                         CDL013
     C                     GOTO END                                                           CDL013
     C                     END                                                                CDL013
      *                                                                                       CDL013
      ** If CDL013 is installed.                                                              CDL013
     C           @RTCD     IFEQ *BLANK                                                        CDL013
     C                     MOVEL'1'       CDL013  1                                           CDL013
     C                     MOVEL'1'       *IN19                                               CDL013
      *                                                                                       CDL013
      ** Access WHT ICD record to determine WHT rate.                                         CDL013
     C                     MOVEL*BLANKS   ULSTAX 10                                           CDL013
     C                     MOVEL'RETAIL'  ULSTAX                                              CDL013
     C           ULSTAX    CHAINSDSTAAL1             41                                       CDL013
      *                                                                                       CDL013
      ** If no record on file perform standard database error                                 CDL013
      ** processing                                                                           CDL013
     C           *IN41     IFEQ *ON                                                           CDL013
     C                     MOVELULSTAX    DBKEY                                               CDL013
     C                     MOVEL'SDSTAAL1'DBFILE                                              CDL013
     C                     MOVEL'40'      DBASE   3                                           CDL013
     C                     MOVE *ON       *INU7                                               CDL013
     C                     MOVE *ON       *INU8                                               CDL013
     C                     MOVE *ON       *INLR                                               CDL013
     C                     EXSR *PSSR                                                         CDL013
     C                     ENDIF                                                              CDL013
     C                     END                                                                CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CCP1                                           S01408
     C*                                                                   S01408
     C                     END                                            S01383
     C/COPY WNCPYSRC,DL1705C080
     C**                                                                  CEU003
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF EMU SETTLEMENT CCY       CEU003
     C** SAR IS INSTALLED.                                                CEU003
     C**                                                                  CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM '       ' @RTCD                           CEU003
     C                     PARM '*VERIFY' @OPTN                           CEU003
     C                     PARM 'CEU003'  @SARD   6                       CEU003
     C           @RTCD     IFNE *BLANK                                    CEU003
     C           @RTCD     ANDNE'*NRF   '                                 CEU003
     C                     MOVEL'SCSARDPD'DBFILE            * * * * * * * CEU003
     C                     MOVEL'025'     DBASE             *DBERROR 025* CEU003
     C                     MOVEL@RTCD     DBKEY             * * * * * * * CEU003
     C                     SETON                     U7U8LR               CEU003
     C                     EXSR *PSSR                                     CEU003
     C                     GOTO END                                       CEU003
     C                     END                                            CEU003
      *                                                                   CEU003
     C           @RTCD     IFEQ *BLANK                                    CEU003
     C                     MOVEL'Y'       CEU003  1                       CEU003
     C                     ELSE                                           CEU003
     C                     MOVEL'N'       CEU003                          CEU003
     C                     END                                            CEU003
     C*                                                                   CEU015
     C** Access SAR Details file to determine if EMU Enhanced MM          CEU015
     C** Rollover SAR is installed.                                       CEU015
     C*                                                                   CEU015
     C                     CALL 'AOSARDR0'                                CEU015
     C                     PARM '       ' @RTCD                           CEU015
     C                     PARM '*VERIFY' @OPTN                           CEU015
     C                     PARM 'CEU015'  @SARD                           CEU015
     C           @RTCD     IFNE *BLANK                                    CEU015
     C           @RTCD     ANDNE'*NRF   '                                 CEU015
     C                     MOVEL'SCSARDPD'DBFILE            * * * * * * * CEU015
     C                     MOVEL'027'     DBASE             *DBERROR 027* CEU015
     C                     MOVEL@RTCD     DBKEY             * * * * * * * CEU015
     C                     SETON                     U7U8LR               CEU015
     C                     EXSR *PSSR                                     CEU015
     C                     GOTO END                                       CEU015
     C                     END                                            CEU015
      *                                                                   CEU015
     C           @RTCD     IFEQ *BLANK                                    CEU015
     C                     MOVEL'Y'       CEU015  1                       CEU015
     C                     ELSE                                           CEU015
     C                     MOVEL'N'       CEU015                          CEU015
     C                     END                                            CEU015
     C/COPY WNCPYSRC,DL1705C015
0776 C*****TEST*TAX*RATE                                                  S01383
0777 C*****      TAXR      COMP 0                 ***1919**TAX*RATE*NOT*0 S01194
0777 C***********BNHKTR    COMP 0                    1919  TAX RATES01194 S01383
0779 C***44****            GOTO ENDBNK
0780 C*******              MOVE DFBR      ZTABKY                  S01117  S01194
0780 C*****                MOVE DFBM      ZTABKY              ****S01117  S01194
0780 C*****                MOVE BJEGCD    ZTABKY                  *****   S01194
0781 C*******              MOVEL'10'      ZTABKY                  *****   S01194
078  C**N42**              EXSR TABCHN                            *****   S01194
0783 C***99**              SETON                     LRU763       *****   S01194
0784 C***99**              GOTO END                               *****   S01194
      *
0778 C* IF SINGLE BRANCH INSTALLATION
     C           BGMBIN    IFEQ 'N'                                       S01194
     C* CALL ACCESS PROG. FOR BRANCH INTERNAL CUSTOMER NUMBER             S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BJSBRC    @KEYB                           S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBRCHPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'004'     DBASE   3        * DBERR 004 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVELBJSBRC    DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     ELSE                                           S01194
     C                     MOVE A8BICN    BICN                            S01194
     C                     END                                            S01194
     C                     END                                            S01194
      *                                                                   CSW096
      **  Check if SWIFT Changes 1996 (CSW096) is installed.              CSW096
      *                                                                   CSW096
     C                     CALL 'SWIFT96'                                 CSW096
     C                     PARM *BLANKS   @RTCD   7                       CSW096
      *                                                                   CSW096
     C           @RTCD     IFEQ 'CSW096'                                  CSW096
     C                     MOVE 'Y'       CSW096  1                       CSW096
     C                     ELSE                                           CSW096
     C                     MOVE 'N'       CSW096                          CSW096
     C                     ENDIF                                          CSW096
      *                                                                                       CSW218
      ** Check if Swift 2018 changes is installed.                                            CSW218
      *                                                                                       CSW218
     C                     CALL 'SWIF2018'                                                    CSW218
     C                     PARM           PRTCD                                               CSW218
     C           PRTCD     IFEQ 'CSW2018'                                                     CSW218
     C                     MOVEL'Y'       CSW218  1                                           CSW218
     C                     ELSE                                                               CSW218
     C                     MOVEL'N'       CSW218                                              CSW218
     C                     ENDIF                                                              CSW218
      *                                                                                       CSW218
     C           KBICD     KLIST                                                              CSW218
     C                     KFLD           WBICC                                               CSW218
     C                     KFLD           WBICB                                               CSW218
     C/COPY WNCPYSRC,DL1705C010
      *                                                                                       CDL033
      ** Acces Midas General Ledger ICD details.                                              CDL033
      *                                                                                       CDL033
     C                     CALL 'AOGELRR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*FIRST ' @OPTN                                               CDL033
     C           SDGELR    PARM SDGELR    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE *BLANKS                                                       CDL033
     C                     MOVE '901'     DBASE                                               CDL033
     C                     MOVEL@OPTN     DBKEY                                               CDL033
     C                     MOVEL'SDGELRPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO END                                                           CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Determine event control date.                                                        CDL033
      *                                                                                       CDL033
     C           BJDNWD    SUB  1         WEVCD   50                                          CDL033
     C           BKAPDT    IFLT WEVCD                                                         CDL033
     C                     Z-ADDBKAPDT    WEVCD                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Determine if Floating Rate CD Issued feature is                                      CDL033
      ** switched on.                                                                         CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    CDL033  1                                           CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*VERIFY' @OPTN                                               CDL033
     C                     PARM 'CDL033'  @SARD                                               CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVE 'Y'       CDL033                                              CDL033
     C                     ELSE                                                               CDL033
     C           @RTCD     IFNE '*NRF   '                                                     CDL033
     C                     MOVE '902'     DBASE                                               CDL033
     C                     MOVEL'CDL033'  DBKEY                                               CDL033
     C                     MOVEL@OPTN     DBOPTN                                              CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO END                                                           CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                   CSW005
      **  Access Switchable Features file for FRA/IRS Msg Generation.     CSW005
      *                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM *BLANKS   @RTCD                           CSW005
     C                     PARM '*VERIFY' @OPTN                           CSW005
     C                     PARM 'CSW005'  @SARD                           CSW005
     C           SCSARD    PARM SCSARD    DSFDY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C                     MOVEL'Y'       CSW005  1                       CSW005
     C                     ELSE                                           CSW005
     C           @RTCD     IFEQ '*NRF   '                                 CSW005
     C                     MOVEL'N'       CSW005                          CSW005
     C                     ELSE                                           CSW005
     C                     MOVE '024'     DBASE            * * * * * * * *CSW005
     C                     MOVEL@SARD     DBKEY     P      * DB ERROR 24 *CSW005
     C                     MOVEL'SCSARDPD'DBFILE    P      * * * * * * * *CSW005
     C                     MOVE '1'       *INU7                           CSW005
     C                     MOVE '1'       *INU8                           CSW005
     C                     MOVE '1'       *INLR                           CSW005
     C                     EXSR *PSSR                                     CSW005
     C                     ENDIF                                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   172477
      ** Access Switchable features file for FRA-IRS Msg generation.      172477
      *                                                                   172477
     C                     CALL 'AOSARDR0'                                172477
     C                     PARM *BLANKS   @RTCD                           172477
     C                     PARM '*VERIFY' @OPTN                           172477
     C                     PARM 'CSW011'  @SARD                           172477
     C           SCSARD    PARM SCSARD    DSFDY                           172477
      *                                                                   172477
     C           @RTCD     IFEQ *BLANKS                                   172477
     C                     MOVEL'Y'       CSW011  1                       172477
     C                     ELSE                                           172477
     C           @RTCD     IFEQ '*NRF   '                                 172477
     C                     MOVEL'N'       CSW011                          172477
     C                     ELSE                                           172477
     C                     MOVE '028'     DBASE            * * * * * * * *172477
     C                     MOVEL@SARD     DBKEY     P      * DB ERROR 28 *172477
     C                     MOVEL'SCSARDPD'DBFILE    P      * * * * * * * *172477
     C                     MOVE '1'       *INU7                           172477
     C                     MOVE '1'       *INU8                           172477
     C                     MOVE '1'       *INLR                           172477
     C                     EXSR *PSSR                                     172477
     C                     ENDIF                                          172477
     C                     ENDIF                                          172477
      *                                                                   CDL006
      ** Access Switchable Feature Details, Check if CDL006 is            CDL006
      ** switch on.                                                       CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   PRTCD   7                       CDL006
     C                     PARM '*VERIFY 'POPTN   7                       CDL006
     C                     PARM 'CDL006'  PSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           PRTCD     IFNE *BLANKS                                   CDL006
     C           PRTCD     ANDNE'*NRF '                                   CDL006
     C                     MOVEL'SCSARDPD'DBFILE                          CDL006
     C                     MOVE '001'     DBASE                           CDL006
     C                     MOVELPRTCD     DBKEY                           CDL006
     C                     SETON                     U7U8LR               CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     GOTO END                                       CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           PRTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     ELSE                                           CDL006
     C                     MOVE 'N'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CIR003
      ** Check if switchable feature CIR003 is switched on                CIR003
      *                                                                   CIR003
     C                     CALL 'AOSARDR0'                                CIR003
     C                     PARM *BLANKS   @RTCD                           CIR003
     C                     PARM '*VERIFY' @OPTN                           CIR003
     C                     PARM 'CIR003'  @SARD   6                       CIR003
     C           SCSARD    PARM SCSARD    DSFDY                           CIR003
     C*                                                                   CIR003
     C           @RTCD     IFNE *BLANK                                    CIR003
     C           @RTCD     ANDNE'*NRF   '                                 CIR003
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR003
     C                     MOVEL'34'      DBASE            * DB ERROR 34 *CIR003
     C                     MOVEL'CIR003'  DBKEY            ***************CIR003
     C                     MOVE *ON       *INU7                           CIR003
     C                     MOVE *ON       *INU8                           CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           @RTCD     IFEQ *BLANKS                                   CIR003
     C                     MOVE 'Y'       CIR003  1                       CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'N'       CIR003                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      *                                                                                       CDL019
      ** Check if switchable feature CDL019 is switched on                                    CDL019
     C                     CALL 'AOSARDR0'                                                    CDL019
     C                     PARM *BLANKS   @RTCD                                               CDL019
     C                     PARM '*VERIFY' @OPTN                                               CDL019
     C                     PARM 'CDL019'  @SARD   6                                           CDL019
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL019
     C*                                                                                       CDL019
     C           @RTCD     IFEQ *BLANKS                                                       CDL019
     C                     MOVE 'Y'       CDL019  1                                           CDL019
     C                     ELSE                                                               CDL019
     C                     MOVE 'N'       CDL019                                              CDL019
     C                     ENDIF                                                              CDL019
      *                                                                                      BUG6479
      ** Check if switchable feature CSW025 is switched on                                   BUG6479
     C                     CALL 'AOSARDR0'                                                   BUG6479
     C                     PARM *BLANKS   @RTCD                                              BUG6479
     C                     PARM '*VERIFY' @OPTN                                              BUG6479
     C                     PARM 'CSW025'  @SARD                                              BUG6479
     C           SCSARD    PARM SCSARD    DSFDY                                              BUG6479
     C*                                                                                      BUG6479
     C           @RTCD     IFEQ *BLANKS                                                      BUG6479
     C                     MOVE 'Y'       CSW025  1                                          BUG6479
     C                     ELSE                                                              BUG6479
     C                     MOVE 'N'       CSW025                                             BUG6479
     C                     ENDIF                                                             BUG6479
     C*                                                                                       CDL019
      ** Define Key list for DLGXSTL0                                     CIR003
      *                                                                   CIR003
     C           KEY1      KLIST                                          CIR003
     C                     KFLD           WKDLNO  60                      CIR003
     C                     KFLD           WKEDCD  3                       CIR003
      *                                                                                       CGL031
      ** Check if switchable feature CGL031 is switched on                                    CGL031
      *                                                                                       CGL031
     C                     CALL 'AOSARDR0'                                                    CGL031
     C                     PARM *BLANKS   PRTCD                                               CGL031
     C                     PARM '*VERIFY' POPTN                                               CGL031
     C                     PARM 'CGL031'  PSARD                                               CGL031
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL031
      *                                                                                       CGL031
     C           PRTCD     IFNE *BLANK                                                        CGL031
     C           PRTCD     ANDNE'*NRF   '                                                     CGL031
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL031
     C                     MOVEL'37'      DBASE                                               CGL031
     C                     MOVEL'CGL031'  DBKEY                                               CGL031
     C                     MOVE *ON       *INU7                                               CGL031
     C                     MOVE *ON       *INU8                                               CGL031
     C                     EXSR *PSSR                                                         CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C           PRTCD     IFEQ *BLANKS                                                       CGL031
     C                     MOVE 'Y'       CGL031  1                                           CGL031
     C                     MOVE '1'       *IN19                                               234068
     C                     ELSE                                                               CGL031
     C                     MOVE 'N'       CGL031                                              CGL031
     C                     ENDIF                                                              CGL031
      **********                                                                       CGL031 234068
      ***Define*Keylist*for*SDCSINL6.**********************************                CGL031 234068
      **********                                                                       CGL031 234068
     C********** KYEUTX    KLIST                                                       CGL031 234068
     C**********           KFLD           BJRDNB                                       CGL031 234068
     C**********           KFLD           WKMODI                                       CGL031 234068
     C**********           KFLD           DLNO                                         CGL031 234068
      *                                                                                    MD027307A
      ** Access SAR details to check whether CER048 is installed                           MD027307A
      *                                                                                    MD027307A
     C                     CALL 'AOSARDR0'                                                 MD027307A
     C                     PARM *BLANKS   PRTCD                                            MD027307A
     C                     PARM '*VERIFY' POPTN                                            MD027307A
     C                     PARM 'CER048'  PSARD                                            MD027307A
     C           SCSARD    PARM SCSARD    DSFDY                                            MD027307A
      *                                                                                    MD027307A
     C           PRTCD     IFNE *BLANKS                                                    MD027307A
     C           PRTCD     ANDNE'*NRF    '                                                 MD027307A
      *                                                                                    MD027307A
     C                     MOVE 'SCSARDPD'DBFILE                                           MD027307A
     C                     MOVEL'043'     DBASE                                            MD027307A
     C                     MOVEL'CER048'  DBKEY                                            MD027307A
     C                     SETON                     U7U8LR                                MD027307A
     C                     EXSR *PSSR                                                      MD027307A
     C                     GOTO END                                                        MD027307A
      *                                                                                    MD027307A
     C                     ENDIF                                                           MD027307A
      *                                                                                    MD027307A
     C           PRTCD     IFEQ *BLANKS                                                    MD027307A
     C                     MOVE 'Y'       CER048  1                                        MD027307A
     C                     ELSE                                                            MD027307A
     C                     MOVE 'N'       CER048                                           MD027307A
     C                     ENDIF                                                           MD027307A
      *                                                                                    MD027307A
      ** Access SAR details to check whether CER048 is installed                           MD027307A
      *                                                                                    MD027307A
     C                     CALL 'AOSARDR0'                                                 MD027307A
     C                     PARM *BLANKS   PRTCD                                            MD027307A
     C                     PARM '*VERIFY' POPTN                                            MD027307A
     C                     PARM 'CER054'  PSARD                                            MD027307A
     C           SCSARD    PARM SCSARD    DSFDY                                            MD027307A
      *                                                                                    MD027307A
     C           PRTCD     IFNE *BLANKS                                                    MD027307A
     C           PRTCD     ANDNE'*NRF    '                                                 MD027307A
      *                                                                                    MD027307A
     C                     MOVE 'SCSARDPD'DBFILE                                           MD027307A
     C                     MOVEL'043'     DBASE                                            MD027307A
     C                     MOVEL'CER054'  DBKEY                                            MD027307A
     C                     SETON                     U7U8LR                                MD027307A
     C                     EXSR *PSSR                                                      MD027307A
     C                     GOTO END                                                        MD027307A
      *                                                                                    MD027307A
     C                     ENDIF                                                           MD027307A
      *                                                                                    MD027307A
     C           PRTCD     IFEQ *BLANKS                                                    MD027307A
     C                     MOVE 'Y'       CER054  1                                        MD027307A
     C                     ELSE                                                            MD027307A
     C                     MOVE 'N'       CER054                                           MD027307A
     C                     ENDIF                                                           MD027307A
      *                                                                                       CDL081
      ** Check if CDL081 is installed                                                         CDL081
      *                                                                                       CDL081
     C                     MOVE 'N'       CDL081  1                                           CDL081
     C                     CALL 'AOSARDR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD                                               CDL081
     C                     PARM '*VERIFY' POPTN                                               CDL081
     C                     PARM 'CDL081'  PSARD                                               CDL081
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C           PRTCD     ANDNE'*NRF   '                                                     CDL081
     C                     MOVEL'075'     DBASE                                               CDL081
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL081
     C                     MOVEL'CDL081'  DBKEY                                               CDL081
     C                     SETON                     U7U8LR                                   CDL081
     C                     EXSR *PSSR                                                         CDL081
     C                     GOTO END                                                           CDL081
     C                     END                                                                CDL081
      *                                                                                       CDL081
     C           PRTCD     IFEQ *BLANKS                                                       CDL081
     C                     MOVE 'Y'       CDL081                                              CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Access withholding tax round down system values if CDL081 is on                      CDL081
      *                                                                                       CDL081
     C           CDL081    IFEQ 'Y'                                                           CDL081
     C                     CALL 'AOSVALR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD                                               CDL081
     C                     PARM C#BASE    SVALK1 20                                           CDL081
     C                     PARM           SVAL1 200                                           CDL081
     C                     PARM C#NBAS    SVALK2 20                                           CDL081
     C                     PARM           SVAL2 200                                           CDL081
     C                     PARM *BLANK    SVALK3 20                                           CDL081
     C                     PARM           SVAL3 200                                           CDL081
     C                     PARM *BLANK    SVALK4 20                                           CDL081
     C                     PARM           SVAL4 200                                           CDL081
     C                     PARM *BLANK    SVALK5 20                                           CDL081
     C                     PARM           SVAL5 200                                           CDL081
     C                     PARM *BLANK    SVALK6 20                                           CDL081
     C                     PARM           SVAL6 200                                           CDL081
     C                     PARM *BLANK    SVALK7 20                                           CDL081
     C                     PARM           SVAL7 200                                           CDL081
     C                     PARM *BLANK    SVALK8 20                                           CDL081
     C                     PARM           SVAL8 200                                           CDL081
     C                     PARM *BLANK    SVALK9 20                                           CDL081
     C                     PARM           SVAL9 200                                           CDL081
     C                     PARM *BLANK    SVALK0 20                                           CDL081
     C                     PARM           SVAL10200                                           CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C                     MOVEL'076'     DBASE                                               CDL081
     C                     MOVEL'SDSVALPD'DBFILE                                              CDL081
     C           SVAL1     IFEQ '*NRF'                                                        CDL081
     C                     MOVELSVALK1    DBKEY                                               CDL081
     C                     ENDIF                                                              CDL081
     C           SVAL2     IFEQ '*NRF'                                                        CDL081
     C                     MOVELSVALK2    DBKEY                                               CDL081
     C                     ENDIF                                                              CDL081
     C                     SETON                     U7U8LR                                   CDL081
     C                     EXSR *PSSR                                                         CDL081
     C                     GOTO END                                                           CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Setup tax amount rounding down indicators                                            CDL081
      *                                                                                       CDL081
     C                     MOVELSVAL1     W#BSRD  1                                           CDL081
     C                     MOVELSVAL2     W#NBRD  1                                           CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL096
      ** Check if CDL096 - Business Day Conventions for MM Deals - is switched on             CDL096
     C                     CALL 'AOSARDR0'                                                    CDL096
     C                     PARM *BLANKS   @RTCD                                               CDL096
     C                     PARM '*VERIFY' @OPTN                                               CDL096
     C                     PARM 'CDL096'  @SARD   6                                           CDL096
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL096
     C*                                                                                       CDL096
     C           @RTCD     IFEQ *BLANKS                                                       CDL096
     C                     MOVE 'Y'       CDL096  1                                           CDL096
     C                     ELSE                                                               CDL096
     C                     MOVE 'N'       CDL096                                              CDL096
     C                     ENDIF                                                              CDL096
      *                                                                                     MD035545
      ** Retrieve system value setting                                                      MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   W0RTCD  7                                         MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'                             MD035545
      *                                                                                     MD035545
     C           W0RTCD    IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
      *                                                                   CIR003
     C*                                                                   042844
     C** Define field for difference between Rolled Over deal's           042844
     C** Principal plus interest and the Rollover deal's principal        042844
     C*                                                                   042844
     C           *LIKE     DEFN VDATDI    RETAIN                          222097
     C           *LIKE     DEFN PCPL      RLDIFF                          042844
     C           *LIKE     DEFN PCPL      RLCOPY                          042844
     C           *LIKE     DEFN SET2      SVSET2                          079139
     C           *LIKE     DEFN TSET2     SVTSET                          079139
     C/COPY WNCPYSRC,DL1705C032
     C           *LIKE     DEFN EAMT      W#EAMT                          CEU003
     C*                                                                   042844
0785 C           ENDBNK    TAG                             ** ENDBNK TAG**
     C/COPY WNCPYSRC,DL1705CCP7                                           S01408
     C                     GOTO END
     C/SPACE 3
     C           START     TAG                             ** START TAG **
     C* RESET INDS.
     C                     SETOF                     707172
     C                     SETOF                     737475
     C******************   SETOF  ****************   7677 ************    S01119
     C                     SETOF                     767787               S01119
     C                     SETOF                     313233
     C                     SETOF                     39                   E107
     C*******************  SETOF                     5839                 E107
     C/COPY WNCPYSRC,DL1705C081
     C                     SETOF                     2426
     C*******************  SETOF                     8338                 E107
     C*******************  SETOF                     27                   E107
     C*******************  SETOF                     35                   E11862
     C                     SETOF                     383527               E107
     C                     MOVE '0'       *IN81                           136030
     C*                                                                   081947
     C* Clear extended settlement fields for next cycle.                  081947
     C*                                                                   081947
     C                     MOVE *BLANKS   RSTM                            081947
     C                     MOVE *BLANKS   RONS                            081947
     C                     MOVE *BLANKS   RIBN                            081947
     C                     MOVE *BLANKS   RIBA                            081947
     C                     MOVE *BLANKS   ROBN                            081947
     C                     MOVE *BLANKS   ROCN                            081947
     C                     MOVE *BLANKS   PSTM                            081947
     C                     MOVE *BLANKS   PONS                            081947
     C                     MOVE *BLANKS   PIBN                            081947
     C                     MOVE *BLANKS   PIBA                            081947
     C                     MOVE *BLANKS   POBN                            081947
     C                     MOVE *BLANKS   POCN                            081947
     C                     MOVE *BLANKS   RCRN                            081947
     C                     MOVE *BLANKS   RCRA                            081947
     C                     MOVE *BLANKS   RVNO                            081947
     C                     MOVE *BLANKS   AWBN                            081947
     C                     MOVE *BLANKS   AWBA                            081947
     C                     MOVE *BLANKS   BENN                            081947
     C                     MOVE *BLANKS   BENA                            081947
     C                     MOVE *BLANKS   DTP1                            081947
     C                     MOVE *BLANKS   DTP2                            081947
     C                     MOVE *BLANKS   DTP3                            081947
     C                     MOVE *BLANKS   DTP4                            081947
     C                     MOVE *BLANKS   DCHG                            081947
     C                     MOVE *BLANKS   BTB1                            081947
     C                     MOVE *BLANKS   BTB2                            081947
     C                     MOVE *BLANKS   BTB3                            081947
     C                     MOVE *BLANKS   BTB4                            081947
     C                     MOVE *BLANKS   BTB5                            081947
     C                     MOVE *BLANKS   BTB6                            081947
     C**********           Z-ADD0         POCN                                         081947 CSD027
     C                     MOVE *BLANKS   POCN                                                CSD027
     C* PSEUDO I/P PROCESSING
     C   04                MOVE RIP1      RIP,1
     I* IF I/P CYCLE THEN AS LF/DTRIN TRAILER
     C   04                Z-ADDRIP5      RIP,5
     C/EJECT
     C* M A I N L I N E   O F   P R O C E S S I N G
     C* END OF DAY
     C  N89                GOTO NOTEOD
     C   03                EXSR PROC3
     C   04                EXSR TTRANS                     CONTROLS
     C   06                EXSR PROC4
     C   07                EXSR TDAIND                     CONTROLS
     C                     GOTO END
     C/SPACE 3
     C* ELSE IF NOT END OF DAY
     C           NOTEOD    TAG                             ** NOTEOD TAG**
     C   03                EXSR PROC5
     C   04                EXSR TTRANS                     CONTROLS
     C           END       TAG                             **  END TAG  **
     C/SPACE 3
     C* E N D   O F   M A I N L I N E
     C/SPACE 3
     C/SPACE 3
     C** TOTAL TIME PROCESSING                                            S01117
     C*                                                                   S01117
     C** IF NO RECORDS ON FILE THEN READ BANK DETAILS FOR OUTPUT          S01117
     CLR   N40             EXSR #ZZ                                       S01117
     CLR   N40             MOVE '0'       *IN25                           S01117
     CLR    40             MOVE '1'       *IN25                           S01117
     C*                                                                   S01117
     C* FOR CONTROLS ON LF/PREX TRAILERS
     CLR         ROP       ADD  2         ROP     50
     C/COPY WNCPYSRC,DL1705C056
     C/EJECT
     C*                     E N D   O F   D A Y
     C/SPACE 3
     C* P R O C E S S  .3.      - LF / D L I N D
     C*
     C           PROC3     BEGSR                           ***  PROC3  ***
     C* I/P CONTROLS
     C           RIP,3     ADD  1         RIP,3
     C*
     C* THIS KEY EQ. LAST KEY - IF SO GOTO END.
     C           KEY       COMP PREKEY                   42
      *                                                                   CIR003
     C           *IN42     IFEQ '1'                                       CIR003
     C           CIR003    ANDEQ'Y'                                       CIR003
     C           CNRQ      IFEQ 'T'                                       CIR003
     C           CNRQ      OREQ 't'                                       CIR003
     C           CNRQ      OREQ 'O'                                       CIR003
     C           CNRQ      OREQ 'o'                                       CIR003
     C                     MOVE '0'       *IN42                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      ** When processing next record with same deal no., don't just                           211614
      ** skip, check whether P/R indicator was previously processed                           211614
      ** then skip, else process to generate message.                                         211614
      *                                                                                       211614
     C           *IN42     IFEQ '1'                                                           211614
      *                                                                                       211614
     C           *IN21     IFEQ '1'                                                           211614
     C           @@21      ANDEQ'0'                                                           211614
     C                     MOVE '1'       @@21                                                211614
     C                     MOVE '0'       *IN42                                               211614
     C                     ENDIF                                                              211614
      *                                                                                       211614
     C           *IN22     IFEQ '1'                                                           211614
     C           @@22      ANDEQ'0'                                                           211614
     C                     MOVE '1'       @@22                                                211614
     C                     MOVE '0'       *IN42                                               211614
     C                     ENDIF                                                              211614
      *                                                                                       211614
     C           *IN23     IFEQ '1'                                                           211614
     C           @@23      ANDEQ'0'                                                           211614
     C                     MOVE '1'       @@23                                                211614
     C                     MOVE '0'       *IN42                                               211614
     C                     ENDIF                                                              211614
      *                                                                                       211614
     C           *IN42     IFEQ '1'                                                           232817
     C           *IN21     IFEQ '1'                                                           232817
     C           *IN22     OREQ '1'                                                           232817
     C           *IN23     OREQ '1'                                                           232817
     C           XPAMT     IFNE PIAMT                                                         232817
     C           PIAMT     ANDNE0                                                             232817
     C           XRAMT     ORNE RIAMT                                                         232817
     C           RIAMT     ANDNE0                                                             232817
     C                     Z-ADDPIAMT     XPAMT                                               232817
     C                     Z-ADDRIAMT     XRAMT                                               232817
     C                     MOVE '0'       *IN42                                               232817
     C                     ENDIF                                                              232817
     C                     ENDIF                                                              232817
     C                     ENDIF                                                              232817
     C                     ENDIF                                                              211614
      *                                                                                       211614
     C/COPY WNCPYSRC,DL1705C001
     C   42                GOTO P3END
     C                     MOVE KEY       PREKEY 14        SAVE KEY FIELD
      *                                                                                       211614
      ** Save P/R indicators for comparison in the next cycle                                 211614
      *                                                                                       211614
     C                     MOVE *IN21     @@21    1                                           211614
     C                     MOVE *IN22     @@22    1                                           211614
     C                     MOVE *IN23     @@23    1                                           211614
     C                     Z-ADDPIAMT     XPAMT  130                                          232817
     C                     Z-ADDRIAMT     XRAMT  130                                          232817
      *                                                                                       211614
     C* IF ANY PAY/RECEIVE IND SET THEN DO PROCESS DEAL
     C   21
     COR 22
     COR 23                EXSR PROC1
     C*
     C           P3END     ENDSR                           ** P3END TAG **
     C********************************************************************
     C/SPACE 2
     C* P R O C E S S  .4.      - LF / D A I N D
     C*
     C           PROC4     BEGSR                           ***  PROC4  ***
     C* I/P CONTROLS
     C           RIP,4     ADD  1         RIP,4
     C*
     C* THIS KEY EQ..LAST KEY - IF SO GOTO END.
     C           KEY       COMP PREKEY                   42
      *                                                                   CIR003
     C           *IN42     IFEQ '1'                                       CIR003
     C           CIR003    ANDEQ'Y'                                       CIR003
     C           CNRQ      IFEQ 'T'                                       CIR003
     C           CNRQ      OREQ 't'                                       CIR003
     C           CNRQ      OREQ 'O'                                       CIR003
     C           CNRQ      OREQ 'o'                                       CIR003
     C                     MOVE '0'       *IN42                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C/COPY WNCPYSRC,DL1705C002
     C   42                GOTO P4END
     C                     MOVE KEY       PREKEY           SAVE KEY FIELD
     C* IF ANY PAY/RECEIVE IND SET THEN DO PROCESS AMENDMENT
     C   21
     COR 22
     COR 23                EXSR PROC2
     C*
     C           P4END     ENDSR                           ** P4END TAG **
     C********************************************************************
     C/EJECT
     C*                  N O T   E N D   O F   D A Y
     C/SPACE 3
     C* P R O C E S S  .5.      - LF / D T R I N
     C*
     C           PROC5     BEGSR                           ***  PROC5  ***
     C* I/P CONTROLS
     C           RIP,3     ADD  1         RIP,3
     C*
     C* THIS KEY EQ. LAST KEY - IF SO GOTO END.
     C           KEY       COMP PREKEY                   42
      *                                                                   CIR003
     C           *IN42     IFEQ '1'                                       CIR003
     C           CIR003    ANDEQ'Y'                                       CIR003
     C           CNRQ      IFEQ 'T'                                       CIR003
     C           CNRQ      OREQ 't'                                       CIR003
     C           CNRQ      OREQ 'O'                                       CIR003
     C           CNRQ      OREQ 'o'                                       CIR003
     C                     MOVE '0'       *IN42                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      ** When processing next record with same deal no., don't just                           211614
      ** skip, check whether P/R indicator was previously processed                           211614
      ** then skip, else process to generate message.                                         211614
      *                                                                                       211614
     C           *IN42     IFEQ '1'                                                           211614
      *                                                                                       211614
     C           *IN21     IFEQ '1'                                                           211614
     C           @@21      ANDEQ'0'                                                           211614
     C                     MOVE '1'       @@21                                                211614
     C                     MOVE '0'       *IN42                                               211614
     C                     ENDIF                                                              211614
      *                                                                                       211614
     C           *IN22     IFEQ '1'                                                           211614
     C           @@22      ANDEQ'0'                                                           211614
     C                     MOVE '1'       @@22                                                211614
     C                     MOVE '0'       *IN42                                               211614
     C                     ENDIF                                                              211614
      *                                                                                       211614
     C           *IN23     IFEQ '1'                                                           211614
     C           @@23      ANDEQ'0'                                                           211614
     C                     MOVE '1'       @@23                                                211614
     C                     MOVE '0'       *IN42                                               211614
     C                     ENDIF                                                              211614
      *                                                                                       211614
     C                     ENDIF                                                              211614
      *                                                                                       211614
     C/COPY WNCPYSRC,DL1705C003
     C   42                GOTO P5END
     C***********          MOVE KEY       PREKEY           SAVE KEY FIELD E23447
      *                                                                                       211614
      ** Save P/R indicators for comparison in the next cycle                                 211614
      *                                                                                       211614
     C                     MOVE *IN21     @@21    1                                           211614
     C                     MOVE *IN22     @@22    1                                           211614
     C                     MOVE *IN23     @@23    1                                           211614
      *                                                                                       211614
     C           CHTP      COMP 'A'                      42
     C  N42      CHTP      COMP 'I'                      42
     C  N42      CHTP      COMP 'R'                      42
     C*  42 SET IF ACTION CODE EQ 'A','I' OR 'R'
     C* IF ANY PAY/RECEIVE IND SET AND '42' THEN CONTINUE - ELSE END
     C*
     C  N21N22N23
     CORN42                GOTO P5END                      ELSE OPTION
     C*                                                                   E23447
     C** ONLY SAVE LAST KEY IF A MESSAGE IS TO BE PRODUCED , OTHERWISE    E23447
     C** NEXT RECORD MAY HAVE P/R INDICATORS ON AND NOT PRODUCE A MESSG   E23447
     C*                                                                   E23447
     C                     MOVE KEY       PREKEY           SAVE KEY FIELD E23447
     C*
     C* IF A REVERSAL IS BEING PROCESSED SETON 27 TO STOP AN EXTRACT
     C* RECORD BEING CREATED IF THE MESSAGE IS NOT TO BE SENT VIA SWIFT
     C* AND SET ON A REVERSAL INDICATOR 35.
     C*
     C           CHTP      IFEQ 'R'
     C                     SETON                     2735
     C                     END
     C*
     C           RCDT      COMP 'D'                      42
     C   42                EXSR PROC1                      DO DEAL
     C           RCDT      COMP 'A'                      42
     C   42                EXSR PROC2                      DO AMENDMENT
      *                                                                                     MD034285
     C           RCDT      IFEQ 'A'                                                         MD034285
     C                     EXSR PROC6                                                       MD034285
     C                     ENDIF                                                            MD034285
     C*
     C           P5END     ENDSR                           ** P5END TAG **
     C********************************************************************                  MD034285
     C/EJECT                                                                                MD034285
     C*                                                                                     MD034285
     C* P R O C E S S 6 - Generate interest pay/receive when PD/PI insert                   MD034285
     C*                                                                                     MD034285
     C           PROC6     BEGSR                                                            MD034285
      *                                                                                     MD034285
      ** Generate interest pay/receive extract when PD/PI deal insert                       MD034285
      *                                                                                     MD034285
     C           DLNO      CHAINDTRIXL9              59                                     MD034285
      *                                                                                     MD034285
     C           *IN59     IFEQ *OFF                                                        MD034285
     C           DTPRI2    ANDEQ9                                                           MD034285
     C           VDATDI    ANDLTNIDT                                                        MD034285
     C           CHTPDI    ANDEQ'I'                                                         MD034285
     C           AMTPDI    IFEQ 'PI'                                                        MD034285
     C           PRI1      ANDEQ1                                                           MD034285
     C           AMTPDI    OREQ 'PD'                                                        MD034285
     C           PRI3      ANDEQ1                                                           MD034285
     C                     SETOF                     2123                                   MD034285
     C                     SETON                     717222                                 MD034285
     C                     EXSR PROC1                                                       MD034285
     C                     ENDIF                                                            MD034285
     C                     ENDIF                                                            MD034285
      *                                                                                     MD034285
     C                     ENDSR                                                            MD034285
     C********************************************************************
     C/EJECT
     C* P R O C E S S  .1.      - D E A L S
     C*
     C           PROC1     BEGSR                           ***  PROC1  ***
     C* GET LF/DEALS RECORD
     C           DLNO      CHAINDEALS                41
0894 C***41                SETON                     LRU764       *****   S01194
0894 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEALS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'005'     DBASE   3        * DBERR 005 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELDLNO      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
     C           RECI      COMP 'D'                      42
     C  N42      RECI      COMP 'R'                      42
     C/COPY WNCPYSRC,DL1705C083
     C   41
     CORN42                GOTO P1END
     C*COPY WNCPYSRC,DL1705C086      **SOURCE NOT FOUND**                                   AR912803
     C*****************************************************************              CSW005 AR912803
     C****If*record*read*is*FRA/IRS*and*switchable*feature*CSW005*is*on,             CSW005 AR912803
     C****check*further*if*record*is*of*deal*type*FR,*RS*or*RX.********              CSW005 AR912803
     C*****************************************************************              CSW005 AR912803
     C********** CSW005    IFEQ 'Y'                                                  CSW005 AR912803
     C********** *IN15     ANDEQ'1'                                                  CSW005 AR912803
     C*****************************************************************              CSW005 AR912803
     C********** DTYP      IFNE 'FR'                                                 CSW005 AR912803
     C********** DTYP      ANDNE'RS'                                                 CSW005 AR912803
     C********** DTYP      ANDNE'RX'                                                 CSW005 AR912803
     C**********           MOVEL'N'       CSW005                                     CSW005 AR912803
     C**********           ENDIF                                                     CSW005 AR912803
     C*****************************************************************              CSW005 AR912803
     C**********           ENDIF                                                     CSW005 AR912803
     C*****************************************************************              E47277 AR912803
     C***If*FRA/IRS*deal*blank*out*CVMR*and*RVNO***********************              E47277 AR912803
     C*****************************************************************              E47277 AR912803
     C********** *IN15     IFEQ '1'                                                  E47277 AR912803
     C********** CSW005    ANDEQ'N'                                                  CSW005 AR912803
     C********** CSW011    ANDEQ'N'                                                  172477 AR912803
     C********** *IN15     OREQ '1'                                                  172477 AR912803
     C********** CSW011    ANDEQ'Y'                                                  172477 AR912803
     C********** DTYP      ANDNE'FR'                                                 172477 AR912803
     C**********           MOVE *BLANKS   RVNO                                       E47277 AR912803
     C**********           MOVE *BLANKS   CVMR                                       E47277 AR912803
     C**********           Z-ADD0         POBN                                         081947 CSD027
     C**********           Z-ADD0         POCN                                         081947 CSD027
     C**********           Z-ADD0         ROBN                                         081947 CSD027
     C**********           Z-ADD0         ROCN                                         081947 CSD027
     C**********           MOVE *BLANKS   POBN                                       CSD027 AR912803
     C**********           MOVE *BLANKS   POCN                                       CSD027 AR912803
     C**********           MOVE *BLANKS   ROBN                                       CSD027 AR912803
     C**********           MOVE *BLANKS   ROCN                                       CSD027 AR912803
     C**********           END                                                       E47277 AR912803
     C*                                                                   S01392
     C** Reset Round Down and Front-up Interest Inds                      S01392
     C** If not Loan/Deposit or NA Purchased Deal                         S01392
     C*                                                                   S01392
     C  N09N10             MOVEL*BLANK    JRDFC                           S01392
     C  N09                MOVEL*BLANK    FUID                            S01392
0975 C*                                                                   S01354
0976 C**      IGNORE Internal Funding Deals                               S01354
0977 C*                                                                   S01354
0978 C           DTYP      IFEQ 'IL'                                      S01354
0979 C           DTYP      OREQ 'ID'                                      S01354
0982 C                     GOTO P1END                                     S01354
0982 C                     END                                            S01354
0977 C*                                                                   S01354
     C**                                                                  E20287
     C** IF A DEAL IS REVERSED PRIOR TO RUNNING PAY/ REC AND SETTLEMENT   E20287
     C** IS NOT SWIFT(08), TELEXES ARE STILL BEING GENERATED. IF THE      E20287
     C** RECORD ID OF THE DEAL IS 'R' THEN SET ON                         E20287
     C** INDICATOR 27 SO THAT AN OUTPUT RECORD IS NOT                     E20287
     C** WRITTEN FOR NON-SWIFT SETTLEMENT.                                E20287
     C           RECI      IFEQ 'R'                                       E20287
     C                     SETON                     27                   E20287
     C                     END                                            E20287
     C*                                                                   E14701
     C* FOR AN AMENDMENT TO A DEAL -                                      E14701
     C* IF TELEX INDICATOR IS SET ON DEALS FILE FOR THE EVENT BEING       E14701
     C* PROCESSED SET ON 27 TO STOP AN OUTPUT RECORD BEING CREATED IF     E14701
     C* THE MESSAGE IS NOT TO BE SENT VIA SWIFT.                          E14701
     C**                                                                  E14701
     C** DO NOT STOP OUTPUT RECORD FROM BEING CREATED IF RUNNING IN       E20435
     C** END-OF-DAY.                                                      E20435
     C   U6                GOTO P1EOD                                     E20435
     C*                                                                   E14701
     C           CHTP      IFEQ 'A'                                       E14701
     C           *IN21     IFEQ '1'                                       E14701
     C                     TESTB'0'       TLXI           27               E14701
     C                     ELSE                                           E14701
     C*                                                                   E14701
     C           *IN22     IFEQ '1'                                       E14701
     C                     TESTB'2'       TLXI           27               E14701
     C                     ELSE                                           E14701
     C*                                                                   E14701
     C           *IN23     IFEQ '1'                                       E14701
     C                     TESTB'1'       TLXI           27               E14701
     C                     END                                            E14701
     C                     END                                            E14701
     C                     END                                            E14701
     C                     END                                            E14701
     C           P1EOD     TAG                             ** P1EOD TAG **E20435
     C*                                                                   E14701
     C******************   EXSR CONVER ***********************            S01119
     C  N15                EXSR CONVER                                    S01119
     C*
     C*****DETERMINE*'IT'*'CD'*OR*'TD'*DEAL****************************** CDL006
     C** Determine 'IT','CD','TD','FT','DT' or 'LT' deal                  CDL006
     C   09    19DTYP      COMP 'IT'                     24
     C   09N24 19DTYP      COMP 'CD'                     24
     C   09N24 19DTYP      COMP 'TD'                     24
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           *IN09     ANDEQ'1'                                       CDL006
     C           *IN24     ANDNE'1'                                       CDL006
     C           *IN19     ANDEQ'1'                                       CDL006
     C           DTYP      IFEQ 'FT'                                      CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C                     MOVE '1'       *IN24                           CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,DL1705CCP8                                           S01408
     C*
     C*    DETERMINE TAXABLE
     C   19      TAXI      COMP 'Y'                      26
      *                                                                                       CDL013
      ** Additional check on ind.19 and taxable ind. if CDL013 is                             CDL013
      ** installed                                                                            CDL013
      *                                                                                       CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
     C           *IN19     IFEQ *ON                                                           CDL013
     C           TAXI      ANDNE'0'                                                           CDL013
     C                     MOVE *ON       *IN26                                               CDL013
     C                     ENDIF                                                              CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CCP2                                           S01408
     C*                                                                   S01408
     C*
     C*
     C* 'CASE' ON TYPE OF DEAL
     C*
     C* IF FOREIGN EXCHANGE
     C           RCDC      COMP 11                       42
     C  N42      RCDC      COMP 12                       42
     C  N42      RCDC      COMP 13                       42
     C  N42      RCDC      COMP 14                       42
     C  N42      RCDC      COMP 10                       42
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,DL1705CPDR                                           S01408
     C*                                                                   S01408
     C                     MOVE 'N'       RLINTP                                            AR805565
     C   42 08             EXSR PROCAA                     DO DL1705-A A
     C* IF POSITION SWAP
     C  N42      RCDC      COMP 20                       42
     C   42 08             GOTO P1END
     C* IF LOAN/DEPOSIT PLACED
     C           RCDC      COMP 15                       42
     C   42 09             EXSR PROCBA                     DO DL1705-B A
     C   42 09             GOTO P1END                      DO DL1705-B A
     C* IF DEPOSIT ACCEPTED OR C.D. ISSUED
     C           RCDC      COMP 16                       42
     C   42 09             EXSR PROCBB                     DO DL1705-B B
     C   42 09             GOTO P1END
     C* IF INTEREST BEARING NEGOTIABLE ASSET PURCHASED
     C           RCDC      COMP 17                       42
     C           DTYP      COMP 'C1'                     43
     C  N43      DTYP      COMP 'C2'                     43
     C  N43      DTYP      COMP 'BD'                     43
     C  N43      DTYP      COMP 'BP'                     43
     C   42 43 10          EXSR PROCBC                     DO DL1705-B C
     C   42 43 10          GOTO P1END
     C* IF NON-INTEREST BEARING NEGOTIABLE ASSET PURCHASED
     C           RCDC      COMP 17                       42
     C           DTYP      COMP 'TB'                     43
     C  N43      DTYP      COMP 'TA'                     43
     C  N43      DTYP      COMP 'DA'                     43
     C   42 43 10          EXSR PROCBD                     DO DL1705-B D
     C   42 43 10          GOTO P1END
     C* NEGOTIABLE ASSET SOLD
     C           RCDC      COMP 18                       42
     C   42 11             EXSR PROCBE                     DO DL1705-B E
     C   42 11             GOTO P1END
     C/COPY WNCPYSRC,DL1705C004
      *                                                                   CIR003
      ** If CIR003 is installed, process pay/receive during I/C           CIR003
      ** for Cross Currency Swaps deals.                                  CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           *IN89     ANDEQ*OFF                                      CIR003
     C           *IN15     ANDEQ*ON                                       CIR003
     C           DTYP      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C                     EXSR PROCBH                                    CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
     C*                                                                   S01119
     C* IF END OF DAY SELECT FRA/IRS RECORDS FOR PROCBH TO PROCESS        S01119
     C*                                                                   S01119
     C           *IN89     IFEQ '1'                                       S01119
     C           *IN15     ANDEQ'1'                                       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C           DTYP      OREQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C**         DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     EXSR PROCBH                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C* A N Y   O T H E R S
     C* NULL
     C*
     C           P1END     ENDSR                           ** P1END TAG **
     C********************************************************************
     C/EJECT
     C* P R O C E S S  .2.      - D E A L   A M E N D M E N T S
     C*
     C           PROC2     BEGSR                           ***  PROC2  ***
     C*
     C**IF TELEX INDICATOR IS SET ON DEALS FILE FOR THE EVENT BEING****   S01177
     C**PROCESSED SET ON 27 TO STOP AN OUTPUT RECORD BEING CREATED IF**   S01177
     C**THE MESSAGE IS NOT TO BE SENT VIA SWIFT.***********************   S01177
     C*                                                                   S01177
     C*  PAY/RECEIVES SHOULD NOT BE PRODUCED FOR DEAMS IN INPUT CYCLE     S01177
     C*                                                                   S01177
     C*  THIS CODE MOVED TO AFTER CHAIN TO DEALS (WAS USING PREVIOUS      S01177
     C*  DEAL'S TLXI FIELD)                                               S01177
     C*                                                                   S01177
     C****       *IN21     IFEQ '1'                                       S01177
     C****                 TESTB'0'       TLXI           27               S01177
     C****                 END                                            S01177
     C****                                                                S01177
     C****       *IN22     IFEQ '1'                                       S01177
     C****                 TESTB'2'       TLXI           27               S01177
     C****                 END                                            S01177
     C****                                                                S01177
     C****       *IN23     IFEQ '1'                                       S01177
     C****                 TESTB'1'       TLXI           27               S01177
     C****                 END                                            S01177
     C*                                                                   S01177
     C* GET LF/DEAMS RECORD
     C           KEY       CHAINDEAMS                41
0958 C***41                SETON                     LRU766       *****   S01194
0894 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'006'     DBASE   3        * DBERR 006 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY       DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
     C   41                GOTO P2END
     C* TEST IF TELEX BIT ON OR OFF - ONLY FOR I/P CYCLE
     C  N89                TESTB'1'       DAINDI         42-IF ON
     C/COPY WNCPYSRC,DL1705C119
     C** Reversed deal amendments are being ignored.                                          CDL022
     C** Apply fix to process reversed deals (Input Cycle only).                              CDL022
     C**N12                                                                                   CDL022
     C  N12N13N89                                                                             CDL022
     C/COPY WNCPYSRC,DL1705C120
     COR 42N89             GOTO P2END
     C           DLNO      CHAINDEALS                41
0965 C***41                SETON                     LRU767       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEALS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'007'     DBASE   3        * DBERR 007 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELDLNO      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
     C   41                GOTO P2END
     C           RECI      COMP 'D'                      42
     C  N42                GOTO P2END
     C/COPY WNCPYSRC,DL1705C087
     C*                                                                   081540
     C* Re-access Deal Amendments file to avoid info being overwritten    081540
     C* by Deals file access above                                        081540
     C           KEY       CHAINDEAMS                41                   081540
0894 C   41                SETON                     LRU7U8               081540
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  081540
     C   41                MOVEL'024'     DBASE   3        * DBERR 024 *  081540
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  081540
     C   41                MOVELKEY       DBKEY  29                       081540
     C   41                EXSR *PSSR                                     081540
     C   41                GOTO P2END                                     081540
     C*                                                                   S01392
     C** Reset Round Down and Front-up Interest Inds                      S01392
     C** If not Loan/Deposit or NA purchased Deal                         S01392
     C*                                                                   S01392
     C  N09N10             MOVEL*BLANK    JRDFC                           S01392
     C  N09                MOVEL*BLANK    FUID                            S01392
0975 C*                                                                   S01354
0976 C**      IGNORE Internal Funding Deals                               S01354
0977 C*                                                                   S01354
0978 C           DTYP      COMP 'IL'                     42               S01354
0979 C  N42      DTYP      COMP 'ID'                     42               S01354
0982 C   42                GOTO P2END                                     S01354
0977 C*                                                                   S01354
     C                     EXSR CONVER
     C*
     C* IF TELEX INDICATOR IS SET ON DEALS FILE FOR THE EVENT BEING       S01177
     C* PROCESSED SET ON 27 TO STOP AN OUTPUT RECORD BEING CREATED IF     S01177
     C* THE MESSAGE IS NOT TO BE SENT VIA SWIFT (COB ONLY)                S01177
     C*                                                                   S01177
     C           *IN21     IFEQ '1'                                       S01177
     C                     TESTB'0'       TLXI           27               S01177
     C                     END                                            S01177
     C*                                                                   S01177
     C           *IN22     IFEQ '1'                                       S01177
     C                     TESTB'2'       TLXI           27               S01177
     C                     END                                            S01177
     C*                                                                   S01177
     C           *IN23     IFEQ '1'                                       S01177
     C                     TESTB'1'       TLXI           27               S01177
     C                     END                                            S01177
     C*                                                                   S01177
     C*****DETERMINE*'IT'*'CD'*OR*'TD'*DEAL****************************** CDL006
     C** Determine 'IT','CD','TD','FT','DT' or 'LT' deal                  CDL006
     C   09    19DTYP      COMP 'IT'                     24
     C   09N24 19DTYP      COMP 'CD'                     24
     C   09N24 19DTYP      COMP 'TD'                     24
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           *IN09     ANDEQ'1'                                       CDL006
     C           *IN24     ANDNE'1'                                       CDL006
     C           *IN19     ANDEQ'1'                                       CDL006
     C           DTYP      IFEQ 'FT'                                      CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C                     MOVE '1'       *IN24                           CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
     C*
     C/COPY WNCPYSRC,DL1705CP11                                           S01408
     C*    DETERMINE TAXABLE
     C   19      TAXI      COMP 'Y'                      26
      *                                                                                       CDL013
      ** Additional check on ind.19 and taxable ind. if CDL013 is                             CDL013
      ** installed                                                                            CDL013
      *                                                                                       CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
     C           *IN19     IFEQ *ON                                                           CDL013
     C           TAXI      ANDNE'0'                                                           CDL013
     C                     MOVE *ON       *IN26                                               CDL013
     C                     ENDIF                                                              CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CCP3                                           S01408
     C*                                                                   S01408
     C*
     C           RCDC      COMP 15                       42
     C  N42      RCDC      COMP 17                       42
     C   42                EXSR PROCBF                     DO DL1705-B F
     C           RCDC      COMP 16                       42
     C   42                EXSR PROCBG                     DO DL1705-B G
     C/COPY WNCPYSRC,DL1705C005
     C*                                                                   S01119
      *                                                                   CIR003
      ** If CIR003 is installed, process pay/receive during I/C           CIR003
      ** for Cross Currency Swaps deals.                                  CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           *IN89     ANDEQ*OFF                                      CIR003
     C           *IN15     ANDEQ*ON                                       CIR003
     C           DTYP      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C                     EXSR PROCBH                                    CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
     C* IF END OF DAY SELECT FRA/IRS RECORDS FOR PROCBH TO PROCESS        S01119
     C*                                                                   S01119
     C           *IN89     IFEQ '1'                                       S01119
     C           *IN15     ANDEQ'1'                                       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C           DTYP      OREQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C**         DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     EXSR PROCBH                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*
     C           P2END     ENDSR                           ** P2END TAG **
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* CONVERT SHORT-NAME TO CUSTOMER NUMBER ON THEIR SETTLEMENT A/C
     C*  AND 'FOR A/C OF' IF SETTLEMENT TYPES 01 07 OR 08.
     C           CONVER    BEGSR                           *** CONVER ***
     C           SET1      COMP 01                       42
     C  N42      SET1      COMP 07                       42
     C  N42      SET1      COMP 08                       42
     C  N42                GOTO CON2
     C* CONVERT THEIR SETTLEMENT A/C *START/PURCHASE*
0997 C*****      TSET1     CHAINSNAME                41           *****   S01194
0998 C**N41                MOVE SNCUST    TSET1                   *****   S01194
0327 C* CALL ACCESS PROG. FOR CUSTOMER NUMBER DETAILS.                    S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM TSET1     @CLKEY 10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C                     MOVE *BLANKS   TSET1                           S01194
     C                     MOVELBBCUST    TSET1                           S01194
2172 C                     END                                            S01194
0999 C* QUIT IF NEG. ASSET SOLD
     C   11                GOTO ENDCV
     C* SETTLEMENT TYPES 01 07 OR 08
     C           CON2      TAG                             **  CON2 TAG **
     C           SET2      COMP 01                       42
     C  N42      SET2      COMP 07                       42
     C  N42      SET2      COMP 08                       42
     C  N42                GOTO ENDCV
     C* CONVERT THEIR AGENT *MATURITY/SELL*
1008 C*****      TSET2     CHAINSNAME                41           *****   S01194
1009 C**N41                MOVE SNCUST    TSET2                   *****   S01194
0327 C* CALL ACCESS PROG. FOR CUSTOMER NUMBER DETAILS.                    S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM TSET2     @CLKEY 10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C                     MOVE *BLANKS   TSET2                           S01194
     C                     MOVELBBCUST    TSET2                           S01194
2172 C                     END                                            S01194
     C* CONVERT 'FOR A/C OF'
1011 C*****      FACO      CHAINSNAME                41           *****   S01194
1012 C**N41                MOVE SNCUST    FACO                    *****   S01194
0327 C* CALL ACCESS PROG. FOR CUSTOMER NUMBER DETAILS.                    S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM *BLANKS   @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM FACO      @CLKEY 10                       S01194
     C                     PARM *BLANK    @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFEQ *BLANK                                    S01194
     C                     MOVE *BLANKS   FACO                            S01194
     C                     MOVELBBCUST    FACO                            S01194
2172 C                     END                                            S01194
     C           ENDCV     ENDSR                           ** ENDCV TAG **
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* F O R E I G N   E X C H A N G E   * DL1705-AA *
     C           PROCAA    BEGSR                           *** PROCAA ***
     C                     SETON                     70
     C* B U Y   C U R R E N C Y   P R O C E S S I N G
     C  N21N35             GOTO SELLAA
     C                     SETON                     31
     C                     MOVE PCST      SETTLE  20       ** BUY CURRENCY
     C                     MOVE 'R'       PAYREC  1         *
     C                     MOVE OPCA      OURAG             *
     C                     MOVE ROBR      OURSB             *             S01117
     C                     MOVE TSCN      THRAG             *
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE PUCY      W#TRCY  3                       CEU003
     C                     MOVE RSCY      W#STCY  3                       CEU003
     C                     MOVE IC72      W#IC72  3                       CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE PUCY      CURREN  3         *
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'V'       MTEX              *
     C                     EXSR CREATE                     **
     C* S E L L   C U R R E N C Y   P R O C E S S I N G
     C           SELLAA    TAG
     C  N23                GOTO ENDAA
     C                     SETON                     33
     C                     MOVE SCST      SETTLE           ** SELL CURREN.
     C                     MOVE 'P'       PAYREC            *
     C                     MOVE OSCA      OURAG             *
     C                     MOVE POBR      OURSB             *             S01117
     C                     MOVE TPCN      THRAG             *
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE SLCY      W#TRCY                          CEU003
     C                     MOVE PSCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE SLCY      CURREN            *
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'M'       MTEX              *
     C                     EXSR CREATE                     **
     C           ENDAA     ENDSR
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* L O A N S   A N D   D E P O S I T S   P L A C E D   * DL1705-B A *
     C           PROCBA    BEGSR                           *** PROCBA ***
     C/COPY WNCPYSRC,DL1705C057
     C                     SETON                     71
     C* START DATE PROCESSING
     C  N21N35             GOTO INTBA
     C                     SETON                     31
     C***********RODA      COMP 0                    57                   064052
     C           RODA      COMP 0                    5757                 064052
     C*                                                                   042844
     C                     Z-ADD0         RLDIFF                          042844
     C                     MOVE 'N'       RLSCND  1                       042844
     C*                                                                   092905
     C***35******RODN******IFNE *ZEROS                              092905103191
     C***********VDAT******ANDGTBJRDNB                              092905103191
     C           *IN35     IFEQ '1'                                       103191
     C           RODN      IFNE *ZEROS                                    103191
     C           MDAT      ANDGEBJRDNB                                    103191
     C                     Z-ADD0         RODN                            092905
     C                     EXCPTREVROL                                    092905
     C           DLNO      CHAINDEALS                41                   092905
     C/COPY WNCPYSRC,DL1705C091
     C                     END                                            092905
     C                     END                                            103191
     C*******                                                             092905
     C           RODN      IFNE *ZEROS                                    042844
     C/COPY WNCPYSRC,DL1705C033
     C*                                                                   042844
     C** Create record for Rollover deal                                  042844
     C*                                                                   042844
     C           RODN      CHAINDEALS                41                   042844
     C*                                                                   042844
     C           *IN41     IFEQ '1'                                                           260339
     C           RODN      CHAINDLDLHCL1             41                                       260339
     C                     ENDIF                                                              260339
      *                                                                                       260339
     C           *IN41     IFEQ '1'                                       042844
     C                     SETON                     LRU7U8               042844
     C                     MOVEL'DEALS'   DBFILE                          042844
     C                     MOVEL'111'     DBASE                           042844
     C                     MOVELRODN      DBKEY                           042844
     C                     EXSR *PSSR                                     042844
     C                     END                                            042844
     C*                                                                   CEU015
     C           *LIKE     DEFN RBDA      ROLOVR                          CEU015
     C                     MOVE RBDA      ROLOVR                          CEU015
     C           CEU015    IFEQ 'Y'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C                     Z-ADDRBDA      P@FRAM                          CEU015
     C                     MOVELRTFC      P@FRCY                          CEU015
     C                     MOVELCCY       P@TOCY                          CEU015
      *                                                                   CEU015
      ** Convert RBDA to deal currency equivalent via call to EU0200      CEU015
      *                                                                   CEU015
     C                     CALL 'EU0200'                                  CEU015
     C                     PARM *BLANKS   P@RTCD  7                       CEU015
     C                     PARM           P@FRAM 183                      CEU015
     C                     PARM           P@FRCY  3                       CEU015
     C                     PARM           P@TOCY  3                       CEU015
     C                     PARM           P@OUTA 150                      CEU015
     C                     PARM           P@INTA 183                      CEU015
     C                     PARM           P@EXRT 159                      CEU015
     C                     PARM           P@MDIN  1                       CEU015
     C*                                                                   CEU015
     C** Database error processing if P@RTCD = *ERROR                     CEU015
     C*                                                                   CEU015
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU015
     C                     MOVELP@RTCD    DBKEY             ************* CEU015
     C                     MOVEL'EU0200  'DBFILE            *DBERROR 028* CEU015
     C                     MOVEL'28'      DBASE             ************* CEU015
     C                     SETON                     U7U8LR               CEU015
     C                     EXSR *PSSR                                     CEU015
     C                     GOTO END                                       CEU015
     C                     ELSE                                           CEU015
     C                     Z-ADDP@OUTA    ROLOVR                          CEU015
     C                     ENDIF                                          CEU015
     C                     ENDIF                                          CEU015
     C*                                                                   042844
     C                     EXSR INTRES                                    042844
     C                     MOVE MDST      SETTLE                          042844
     C                     MOVE 'R'       PAYREC                          042844
     C                     MOVE OMDA      OURAG                           042844
     C                     MOVE ROBR      OURSB                           042844
     C                     MOVE TMAN      THRAG                           042844
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          042844
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     Z-ADDDLNODC    DLNOPH                          042844
     C*                                                                   042844
     C           FUID      IFNE 'Y'                                       042844
     C/COPY WNCPYSRC,DL1705C034
     C           IPDS      ANDNE'Y'                                       S01434
     C/COPY WNCPYSRC,DL1705C035                                           S01408
     C           PCPL      ADD  INTDUE    AMTDUE                          042844
     C                     ELSE                                           042844
     C                     Z-ADDPCPL      AMTDUE                          042844
     C                     END                                            042844
     C***********AMTDUE    SUB  RBDA      RLDIFF                   042844 CEU015
     C           AMTDUE    SUB  ROLOVR    RLDIFF                          CEU015
     C*                                                                   087655
     C** Generate Cancellation, Maturity only in I/C or TLXI bit1 = 0     087655
     C*                                                                   087655
     C                     TESTB'1'       TLXI           79               087655
     C           *IN89     IFEQ '0'                                       087655
     C           *IN79     OREQ '0'                                       087655
     C*                                                                   042844
     C** Create record for rolled over deal to cancel maturity messages   042844
     C***only*if*Automatic*Rollover*is*No***************************S01434077557
     C*  only if Automatic Rollover is No                                 079137
     C*                                                                   042844
     C***********AURO      IFNE 'Y'                                 S01434077557
     C           AURO      IFNE 'Y'                                       079137
     C                     EXSR CREATE                                    042844
     C***********          END                                      S01434077557
     C                     END                                            079137
     C                     END                                            087655
     C*                                                                   042844
     C** Extra record needed if not whole amount rolled over              042844
     C*                                                                   042844
     C***********RLDIFF    IFNE *ZEROS                              042844079139
     C***********          MOVE 'Y'       RLSCND                    042844079139
     C***********          END                                      042844079139
     C*                                                                   042844
     C** If less than whole amount rolled over need maturity message      042844
     C**  only if maturity message has been created in previous P/R       087084
     C*                                                                   042844
     C***********          MOVE *IN57     @IN57   1                 087084087655
     C***********          TESTB'1'       TLXI           57         087084087655
     C           RLDIFF    IFGT *ZEROS                                    042844
     C************IN57     ANDEQ'1'                                 087084087655
     C           *IN89     ANDEQ'0'                                       087655
     C************IN79     ANDEQ'1'                                       087655             BUG7056
     C                     MOVE 'Y'       RLSCND                          079139
     C                     SETON                     31                   042844
     C** Core Hook moved to correct position - replaced with a new name   S01408
     C*CO*Y*WN*PYSRC*DL1705C035                                           S01408
     C/COPY WNCPYSRC,DL1705CC35                                           S01408
     C                     MOVE MDST      SETTLE                          042844
     C                     MOVE 'R'       PAYREC                          042844
     C                     MOVE OMDA      OURAG                           042844
     C                     MOVE ROBR      OURSB                           042844
     C                     MOVE TMAN      THRAG                           042844
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          042844
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     Z-ADDDLNODC    DLNOPH                          042844
     C                     EXSR CREATE                                    042844
     C                     MOVE 'N'       RLSCND                          042844
     C                     END                                            042844
     C*                                                                   087084
     C***Restore*previous value of indicator                        087084087655
     C***********                                                   087084087655
     C***********          MOVE @IN57     *IN57                     087084087655
     C*                                                                   S01434
     C/COPY WNCPYSRC,DL1705C036
     C           IPDS      IFEQ 'Y'                                       S01434
     C/COPY WNCPYSRC,DL1705C037
     C           INTDUE    ANDNE0                                         S01434
     C           *IN89     IFEQ '0'                                       087655
     C/COPY WNCPYSRC,DL1705C061
     C           *IN89     OREQ '1'                                       087655
     C           *IN79     ANDEQ'1'                                       087655
     C                     MOVE 'Y'       RLINTP  1                       S01434
     C*                                                                   S01434
     C           IMET      IFNE *BLANKS                                   S01434
     C                     MOVE IMET      SETTLE                          S01434
     C                     MOVELINSA      OURAG                           S01434
     C                     MOVE INSA      OURSB                           S01434
     C                     MOVELSET2      SVSET2                          079139
     C                     MOVELIMET      SET2                            079139
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE ISCY      W#STCY                          CEU003
     C                     MOVE II72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   S01434
     C                     MOVEL*BLANKS   SVTSET                          079139
     C           INOS      IFNE *BLANKS                                   S01434
     C                     MOVE INOS      THRAG                           S01434
     C                     MOVELTSET2     SVTSET                          079139
     C                     MOVELINOS      TSET2                           079139
     C                     ELSE                                           S01434
     C***********          MOVE TMAN      THRAG                     S01434079774
     C           IMET      IFNE '08'                                      079774
     C                     MOVELCNUM      THRAG                           079774
     C                     END                                            079774
     C                     END                                            S01434
     C                     EXSR CONVER                                    079139
     C*                                                                   S01434
     C                     ELSE                                           S01434
     C*                                                                   S01434
     C                     MOVE MDST      SETTLE                          S01434
     C                     MOVE OMDA      OURAG                           S01434
     C                     MOVE ROBR      OURSB                           S01434
     C                     MOVE TMAN      THRAG                           S01434
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     END                                            S01434
     C*                                                                   S01434
     C                     MOVE 'R'       PAYREC                          S01434
     C***********          MOVE CCY       CURREN                   S01434 CEU003
     C                     Z-ADDDLNODC    DLNOPH                          S01434
     C                     EXSR CREATE                                    S01434
     C                     MOVE 'N'       RLINTP                          S01434
     C*                                                                   S01434
     C                     MOVELSVSET2    SET2                            079139
     C           SVTSET    IFNE *BLANKS                                   079139
     C                     MOVELSVTSET    TSET2                           079139
     C                     END                                            079139
     C                     EXSR CONVER                                    079139
     C                     END                                            S01434
     C                     END                                            S01434
     C*                                                                   042844
     C** During Close of Business, write a record to PREX4 with the       042844
     C** actual amount rolled over                                        042844
     C*                                                                   042844
     C           *IN89     IFEQ '1'                                       042844
     C/COPY WNCPYSRC,DL1705C062
     C                     SETON                     4731                 042844
     C                     EXSR OPREX4                                    042844
     C                     SETOF                     47                   042844
     C                     END                                            042844
     C*                                                                   042844
     C           RBDN      CHAINDEALS                41                   042844
     C*                                                                   042844
     C           *IN41     IFEQ '1'                                       042844
     C                     SETON                     LRU7U8               042844
     C                     MOVEL'DEALS'   DBFILE                          042844
     C                     MOVEL'112'     DBASE                           042844
     C                     MOVELRBDN      DBKEY                           042844
     C                     EXSR *PSSR                                     042844
     C                     END                                            042844
     C*                                                                   042844
     C                     END                                            042844
     C*                                                                   042844
     C                     MOVE SDST      SETTLE
     C                     MOVE 'P'       PAYREC
     C                     MOVE OSDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
     C                     MOVE TSTN      THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     Z-ADDDLNODC    DLNOPH                          S01177
     C***57*89***          EXSR OPREX4                     CREATEPFS/PREX4042844
     C                     MOVE 'V'       MTEX              *
     C  N57                EXSR CREATE
     C*                                                                   042844
     C** If more than whole amount rolled over need value date message    042844
     C*                                                                   042844
     C           RLDIFF    IFLT *ZEROS                                    042844
     C***********                                                   042844079139
     C***Make*amount*positive***************************************042844079139
     C***********                                                   042844079139
     C***********          Z-ADDRLDIFF    RLCOPY                    042844079139
     C***********          Z-SUBRLCOPY    RLDIFF                    042844079139
     C                     MOVE 'Y'       RLSCND                          079139
     C                     SETON                     31                   042844
     C                     EXSR CREATE                                    042844
     C                     MOVE 'N'       RLSCND                          042844
     C                     END                                            042844
     C*                                                                   042844
     C* INTREST DATE PROCESSING
     C           INTBA     TAG                             ** INTBA TAG **
     C/COPY WNCPYSRC,DL1705C026
     C  N22                GOTO MATBA
     C                     SETON                     32
     C                     EXSR INTRES
     C           IPDS      IFEQ 'Y'                                                           230948
     C           IMET      ANDNE*BLANKS                                                       230948
     C                     MOVE 'Y'       RLINTP                                              230948
     C                     MOVE IMET      SETTLE                                              230948
     C                     MOVE 'R'       PAYREC                                              230948
     C                     MOVELINSA      OURAG                                               230948
     C                     MOVE INSA      OURSB                                               230948
     C                     MOVE TMAN      THRAG                                               230948
     C           OURSB     IFEQ *BLANKS                                                       230948
     C                     MOVELROBR      OURSB                                               230948
     C                     ENDIF                                                              230948
     C                     ELSE                                                               230948
     C                     MOVE MDST      SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
     C                     MOVE TMAN      THRAG
     C                     ENDIF                                                              230948
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     Z-ADDDLNODC    DLNOPH                          S01177
     C           INTC      COMP 'Y'                      49
     C                     MOVE 'I'       MTEX              *
     C                     EXSR CREATE
     C                     MOVE 'N'       RLINTP                                           AR995333A
     C                     SETOF                     49
     C* MATURITY DATE PROCESSING
     C           MATBA     TAG                             ** MATBA TAG **
     C**N23******          GOTO ENDBA                                     042844
     C*                                                                   042844
     C** Need to produce maturity messages for rolled over deal number.   042844
     C** and not produce maturity messages for non rolled over automatic  077557
     C** deals                                                            077557
     C*                                                                   042844
     C           *IN23     IFEQ '0'                                       042844
     C***********RBDN      ANDEQ0                                  042844 138388
     C           *IN23     OREQ '1'                                       077557
     C           RBDN      ANDEQ0                                         077557
     C           AURO      ANDEQ'Y'                                       077557
     C                     GOTO ENDBA                                     042844
     C                     END                                            042844
     C*                                                                   042844
     C                     SETON                     33
     C                     EXSR INTRES
     C                     MOVE MDST      SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
     C                     MOVE TMAN      THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C* IF 'ROLLED OVER BY DEAL AMOUNT' NGT ZERO
     C           RBDA      COMP 0                    42
     C                     Z-ADDDLNODC    DLNOPH                          E42865
     C   42                GOTO GTBA
     C           IPFR      IFNE 'N'                                       E49966
     C/COPY WNCPYSRC,DL1705C038
     C           IPDS      ANDNE'Y'                                       S01434
     C/COPY WNCPYSRC,DL1705C039
     C           PCPL      ADD  INTDUE    AMTDUE
     C                     ELSE                                           E49966
     C                     Z-ADDPCPL      AMTDUE                          E49966
     C                     END                                            E49966
     C*****                Z-ADDDLNODC    DLNOPH                    S01177E42865
     C                     MOVE 'M'       MTEX              *
     C                     EXSR CREATE
     C/COPY WNCPYSRC,DL1705C040
     C*                                                                   S01434
     C                     SETON                     33                                    AR995333A
     C           IPDS      IFEQ 'Y'                                       S01434
     C           INTDUE    ANDNE0                                         S01434
     C                     MOVE 'Y'       RLINTP  1                       S01434
     C*                                                                   S01434
     C           IMET      IFNE *BLANKS                                   S01434
     C                     MOVE IMET      SETTLE                          S01434
     C                     MOVELINSA      OURAG                           S01434
     C                     MOVE INSA      OURSB                           S01434
     C                     MOVELSET2      SVSET2                          079139
     C                     MOVELIMET      SET2                            079139
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE ISCY      W#STCY                          CEU003
     C                     MOVE II72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   S01434
     C                     MOVEL*BLANKS   SVTSET                          079139
     C           INOS      IFNE *BLANKS                                   S01434
     C                     MOVE INOS      THRAG                           S01434
     C                     MOVELTSET2     SVTSET                          079139
     C                     MOVELINOS      TSET2                           079139
     C                     ELSE                                           S01434
     C                     MOVE TMAN      THRAG                           S01434
     C                     END                                            S01434
     C                     EXSR CONVER                                    079139
     C*                                                                   S01434
     C                     ELSE                                           S01434
     C*                                                                   S01434
     C                     MOVE MDST      SETTLE                          S01434
     C                     MOVE OMDA      OURAG                           S01434
     C                     MOVE ROBR      OURSB                           S01434
     C                     MOVE TMAN      THRAG                           S01434
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     END                                            S01434
     C*                                                                   S01434
     C                     MOVE 'R'       PAYREC                          S01434
     C***********          MOVE CCY       CURREN                   S01434 CEU003
     C                     Z-ADDDLNODC    DLNOPH                          S01434
     C                     EXSR CREATE                                    S01434
     C                     MOVE 'N'       RLINTP                          S01434
      *                                                                   079139
     C                     MOVELSVSET2    SET2                            079139
     C           SVTSET    IFNE *BLANKS                                   079139
     C                     MOVELSVTSET    TSET2                           079139
     C                     END                                            079139
     C                     EXSR CONVER                                    079139
     C                     END                                            S01434
     C/COPY WNCPYSRC,DL1705C041
     C                     GOTO ENDBA
     C* ELSE 'ROLLED OVER BY DEAL AMOUNT' GT ZERO
     C           GTBA      TAG                             ** GTBA TAG **
     C                     Z-ADDRBDA      ROLOVR                          CEU015
     C           CEU015    IFEQ 'Y'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C                     Z-ADDRBDA      P@FRAM                          CEU015
     C                     MOVELRTFC      P@FRCY                          CEU015
     C                     MOVELCCY       P@TOCY                          CEU015
      *                                                                   CEU015
      ** Convert RBDA to deal currency equivalent via call to EU0200      CEU015
      *                                                                   CEU015
     C                     CALL 'EU0200'                                  CEU015
     C                     PARM *BLANKS   P@RTCD                          CEU015
     C                     PARM           P@FRAM                          CEU015
     C                     PARM           P@FRCY                          CEU015
     C                     PARM           P@TOCY                          CEU015
     C                     PARM           P@OUTA                          CEU015
     C                     PARM           P@INTA                          CEU015
     C                     PARM           P@EXRT                          CEU015
     C                     PARM           P@MDIN                          CEU015
     C*                                                                   CEU015
     C** Database error processing if P@RTCD = *ERROR                     CEU015
     C*                                                                   CEU015
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU015
     C                     MOVELP@RTCD    DBKEY             ************* CEU015
     C                     MOVEL'EU0200  'DBFILE            *DBERROR 029* CEU015
     C                     MOVEL'29'      DBASE             ************* CEU015
     C                     SETON                     U7U8LR               CEU015
     C                     EXSR *PSSR                                     CEU015
     C                     GOTO END                                       CEU015
     C                     ELSE                                           CEU015
     C                     Z-ADDP@OUTA    ROLOVR                          CEU015
     C                     ENDIF                                          CEU015
     C                     ENDIF                                          CEU015
     C           INTDUE    ADD  PCPL      AMTDUE 130
     C/COPY WNCPYSRC,DL1705C042
     C           IPFR      IFEQ 'N'                                       E49966
     C/COPY WNCPYSRC,DL1705C043
     C           IPDS      OREQ 'Y'                                       S01434
     C/COPY WNCPYSRC,DL1705C044
     C                     Z-ADDPCPL      AMTDUE                          E49966
     C                     END                                            E49966
     C***********AMTDUE    SUB  RBDA      AMTDUE     57                   CEU015
     C           AMTDUE    SUB  ROLOVR    AMTDUE     57                   CEU015
     C* CREATE PFS/PREX4 WITH 'RBDA' AS THE AMOUNT
     C  N57                SETON                     47
     C*                                                                   S01392
     C** If Front-up Interest = 'Y'                                       S01392
     C*                                                                   S01392
     C           FUID      IFEQ 'Y'                                       S01392
1104 C                     EXSR OPREX4                                    S01392
     C                     ELSE                                           S01392
     C/COPY WNCPYSRC,DL1705C063
     C  N57 89             EXSR OPREX4
     C/COPY WNCPYSRC,DL1705C064
     C                     END                                            S01392
     C  N57                SETOF                     47
     C  N57                GOTO ENDBA                      DIFF NOT POSVE
     C* CREATE S/PREXX WITH 'AMTDUE' AS THE AMOUNT
     C                     SETON                     33
     C                     MOVE 'M'       MTEX              *
     C                     EXSR CREATE
     C           ENDBA     ENDSR                           ** ENDBA TAG **
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* D E P O S I T S   A C C E P T E D , T A K I N G S   * DL1705-B B *
     C*   A N D   C . D . ' S   I S S U E D
     C           PROCBB    BEGSR                           ***  PROCBB ***
     C/COPY WNCPYSRC,DL1705C069
     C                     SETON                     72
     C* START DATE PROCESSING
     C  N21N35             GOTO INTBB
     C                     SETON                     31
     C***********RODA      COMP 0                    57                   064052
     C           RODA      COMP 0                    5757                 064052
     C*                                                                   042844
     C                     Z-ADD0         RLDIFF                          042844
     C                     MOVE 'N'       RLSCND                          042844
     C*                                                                   092905
     C***35******RODN******IFNE *ZEROS                              092905103191
     C***********VDAT******ANDGTBJRDNB                              092905103191
     C           *IN35     IFEQ '1'                                       103191
     C           RODN      IFNE *ZEROS                                    103191
     C           MDAT      ANDGEBJRDNB                                    103191
     C                     Z-ADD0         RODN                            092905
     C                     EXCPTREVROL                                    092905
     C           DLNO      CHAINDEALS                41                   092905
     C/COPY WNCPYSRC,DL1705C092
     C                     END                                            092905
     C                     END                                            103191
     C*******                                                             092905
     C           RODN      IFNE *ZEROS                                    042844
     C/COPY WNCPYSRC,DL1705C045
     C*                                                                   042844
     C** Create record for Rollover deal                                  042844
     C*                                                                   042844
     C           RODN      CHAINDEALS                41                   042844
     C*                                                                   042844
     C           *IN41     IFEQ '1'                                                           260339
     C           RODN      CHAINDLDLHCL1             41                                       260339
     C                     ENDIF                                                              260339
      *                                                                                       260339
     C           *IN41     IFEQ '1'                                       042844
     C                     SETON                     LRU7U8               042844
     C                     MOVEL'DEALS'   DBFILE                          042844
     C                     MOVEL'113'     DBASE                           042844
     C                     MOVELRODN      DBKEY                           042844
     C                     EXSR *PSSR                                     042844
     C                     END                                            042844
     C*                                                                   CEU015
     C                     Z-ADDRBDA      ROLOVR                          CEU015
     C           CEU015    IFEQ 'Y'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C                     Z-ADDRBDA      P@FRAM                          CEU015
     C                     MOVELRTFC      P@FRCY                          CEU015
     C                     MOVELCCY       P@TOCY                          CEU015
      *                                                                   CEU015
      ** Convert RBDA to deal currency equivalent via call to EU0200      CEU015
      *                                                                   CEU015
     C                     CALL 'EU0200'                                  CEU015
     C                     PARM *BLANKS   P@RTCD                          CEU015
     C                     PARM           P@FRAM                          CEU015
     C                     PARM           P@FRCY                          CEU015
     C                     PARM           P@TOCY                          CEU015
     C                     PARM           P@OUTA                          CEU015
     C                     PARM           P@INTA                          CEU015
     C                     PARM           P@EXRT                          CEU015
     C                     PARM           P@MDIN                          CEU015
     C*                                                                   CEU015
     C** Database error processing if P@RTCD = *ERROR                     CEU015
     C*                                                                   CEU015
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU015
     C                     MOVELP@RTCD    DBKEY             ************* CEU015
     C                     MOVEL'EU0200  'DBFILE            *DBERROR 032* CEU015
     C                     MOVEL'32'      DBASE             ************* CEU015
     C                     SETON                     U7U8LR               CEU015
     C                     EXSR *PSSR                                     CEU015
     C                     GOTO END                                       CEU015
     C                     ELSE                                           CEU015
     C                     Z-ADDP@OUTA    ROLOVR                          CEU015
     C                     ENDIF                                          CEU015
     C                     ENDIF                                          CEU015
     C*                                                                   042844
     C/COPY WNCPYSRC,DL1705C097
      *                                                                                       CDL033
      ** Compute interest due differently for CF deals                                        CDL033
      ** (rolled over deal).                                                                  CDL033
      *                                                                                       CDL033
     C           DTYP      LOKUPFXTERM                   69                                   CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C           CDL033    OREQ 'Y'                                                           CDL033
     C           *IN69     ANDEQ*ON                                                           CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC1                                                        CDL033
     C                     EXSR SRFRC5                                                        CDL033
     C                     EXSR SRFRC6                                                        CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
      *
     C                     EXSR INTRES                                    042844
     C/COPY WNCPYSRC,DL1705C098
     C                     ENDIF                                                              CDL033
     C                     MOVE MDST      SETTLE                          042844
     C                     MOVE 'P'       PAYREC                          042844
     C                     MOVE OMDA      OURAG                           042844
     C                     MOVE POBR      OURSB                           042844
     C                     MOVE TMAN      THRAG                           042844
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          042844
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     Z-ADDDLNODC    DLNOPH                          042844
     C*                                                                   042844
     C           FUID      IFNE 'Y'                                       042844
     C/COPY WNCPYSRC,DL1705C046
     C           IPDS      ANDNE'Y'                                       S01434
     C/COPY WNCPYSRC,DL1705C047
     C           PCPL      ADD  INTDUE    AMTDUE                          042844
     C                     ELSE                                           042844
     C                     Z-ADDPCPL      AMTDUE                          042844
     C                     END                                            042844
     C***********AMTDUE    SUB  RBDA      RLDIFF                   042844 CEU015
     C           AMTDUE    SUB  ROLOVR    RLDIFF                          CEU015
     C*                                                                   087655
     C** Generate Cancellation, Maturity only in I/C or TLXI bit1 = 0     087655
     C*                                                                   087655
     C                     TESTB'1'       TLXI           79               087655
     C           *IN89     IFEQ '0'                                       087655
     C           *IN79     OREQ '0'                                       087655
     C*                                                                   042844
     C** Create record for rolled over deal to cancel maturity messages   042844
     C***only*if*Automatic*Rollover*is*No***************************S01434077557
     C*  only if Automatic Rollover is No                                 079137
     C*                                                                   042844
     C***********AURO      IFNE 'Y'                                 S01434077557
     C           AURO      IFNE 'Y'                                       079137
     C                     EXSR CREATE                                    042844
     C***********          END                                      S01434077557
     C                     END                                            079137
     C                     END                                            087655
     C*                                                                   042844
     C** Extra record needed if not whole amount rolled over              042844
     C*                                                                   042844
     C***********RLDIFF    IFNE *ZEROS                                    079139
     C***********          MOVE 'Y'       RLSCND                          079139
     C***********          END                                            079139
     C*                                                                   042844
     C** If less than whole amount rolled over need maturity message      042844
     C*                                                                   042844
     C           RLDIFF    IFGT *ZEROS                                    042844
     C           *IN89     ANDEQ'0'                                       087655
     C************IN79     ANDEQ'1'                                       087655             BUG7056
     C                     MOVE 'Y'       RLSCND                          079139
     C                     SETON                     31                   042844
     C                     MOVE MDST      SETTLE                          042844
     C                     MOVE 'P'       PAYREC                          042844
     C                     MOVE OMDA      OURAG                           042844
     C                     MOVE POBR      OURSB                           042844
     C                     MOVE TMAN      THRAG                           042844
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          042844
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     Z-ADDDLNODC    DLNOPH                          042844
     C                     EXSR CREATE                                    042844
     C                     MOVE 'N'       RLSCND                          042844
     C                     END                                            042844
     C*                                                                   S01434
     C/COPY WNCPYSRC,DL1705C048
     C           IPDS      IFEQ 'Y'                                       S01434
     C/COPY WNCPYSRC,DL1705C049
     C           INTDUE    ANDNE0                                         S01434
     C           *IN89     IFEQ '0'                                       087655
     C/COPY WNCPYSRC,DL1705C065
     C           *IN89     OREQ '1'                                       087655
     C           *IN79     ANDEQ'1'                                       087655
     C                     MOVE 'Y'       RLINTP  1                       S01434
     C*                                                                   S01434
     C           IMET      IFNE *BLANKS                                   S01434
     C                     MOVE IMET      SETTLE                          S01434
     C                     MOVELINSA      OURAG                           S01434
     C                     MOVE INSA      OURSB                           S01434
     C                     MOVELSET2      SVSET2                          079139
     C                     MOVELIMET      SET2                            079139
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE ISCY      W#STCY                          CEU003
     C                     MOVE II72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   S01434
     C                     MOVEL*BLANKS   SVTSET                          079139
     C           INOS      IFNE *BLANKS                                   S01434
     C                     MOVE INOS      THRAG                           S01434
     C                     MOVELTSET2     SVTSET                          079139
     C                     MOVELINOS      TSET2                           079139
     C                     ELSE                                           S01434
     C***********          MOVE TMAN      THRAG                     S01434079774
     C           IMET      IFNE '08'                                      079774
     C                     MOVELCNUM      THRAG                           079774
     C                     END                                            079774
     C                     END                                            S01434
     C                     EXSR CONVER                                    079139
     C*                                                                   S01434
     C                     ELSE                                           S01434
     C*                                                                   S01434
     C                     MOVE MDST      SETTLE                          S01434
     C                     MOVE OMDA      OURAG                           S01434
     C                     MOVE POBR      OURSB                           S01434
     C                     MOVE TMAN      THRAG                           S01434
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     END                                            S01434
     C*                                                                   S01434
     C                     MOVE 'P'       PAYREC                          S01434
     C***********          MOVE CCY       CURREN                   S01434 CEU003
     C                     Z-ADDDLNODC    DLNOPH                          S01434
     C                     EXSR CREATE                                    S01434
     C                     MOVE 'N'       RLINTP                          S01434
     C*                                                                   079139
     C                     MOVELSVSET2    SET2                            079139
     C           SVTSET    IFNE *BLANKS                                   079139
     C                     MOVELSVTSET    TSET2                           079139
     C                     END                                            079139
     C                     EXSR CONVER                                    079139
     C                     END                                            S01434
     C                     END                                            S01434
     C*                                                                   042844
     C** During Close of Business, write a record to PREX4 with the       042844
     C** actual amount rolled over                                        042844
     C*                                                                   042844
     C           *IN89     IFEQ '1'                                       042844
     C/COPY WNCPYSRC,DL1705C066
     C                     SETON                     4731                 042844
     C                     EXSR OPREX4                                    042844
     C                     SETOF                     47                   042844
     C                     END                                            042844
     C*                                                                   042844
     C           RBDN      CHAINDEALS                41                   042844
     C*                                                                   042844
     C           *IN41     IFEQ '1'                                       042844
     C                     SETON                     LRU7U8               042844
     C                     MOVEL'DEALS'   DBFILE                          042844
     C                     MOVEL'113'     DBASE                           042844
     C                     MOVELRBDN      DBKEY                           042844
     C                     EXSR *PSSR                                     042844
     C                     END                                            042844
     C*                                                                   042844
     C                     END                                            042844
     C*                                                                   042844
     C                     MOVE SDST      SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OSDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
     C                     MOVE TSTN      THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     Z-ADDDLNODC    DLNOPH                          S01177
     C***57*89***          EXSR OPREX4                     CREATEPFS/PREX4042844
     C                     MOVE 'V'       MTEX              *
     C  N57                EXSR CREATE                                    042844
     C*                                                                   042844
     C** If more than whole amount rolled over need value date message    042844
     C*                                                                   042844
     C           RLDIFF    IFLT *ZEROS                                    042844
     C***********                                                   042844079139
     C***Make*amount*positive***************************************042844079139
     C***********                                                   042844079139
     C***********          Z-ADDRLDIFF    RLCOPY                    042844079139
     C***********          Z-SUBRLCOPY    RLDIFF                    042844079139
     C                     MOVE 'Y'       RLSCND                          079139
     C                     SETON                     31                   042844
     C                     EXSR CREATE                                    042844
     C                     MOVE 'N'       RLSCND                          042844
     C                     END                                            042844
     C*                                                                   042844
     C* INTEREST DATE PROCESSING
     C           INTBB     TAG                             ** INTBB TAG **
     C/COPY WNCPYSRC,DL1705C027
      *                                                                                       CDL033
      ** Perform initial computation of interest for                                          CDL033
      ** CF deals.                                                                            CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C                     EXSR SRFRC1                                                        CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C  N22                GOTO MATBB
     C                     SETON                     32
     C/COPY WNCPYSRC,DL1705C099
      *                                                                                       CDL033
      ** Compute interest due differently for CF deals.                                       CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC5                                                        CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
     C                     EXSR INTRES
     C/COPY WNCPYSRC,DL1705C100
     C                     ENDIF                                                              CDL033
     C           IPDS      IFEQ 'Y'                                                           230948
     C           IMET      ANDNE*BLANKS                                                       230948
     C                     MOVE 'Y'       RLINTP                                              230948
     C                     MOVE IMET      SETTLE                                              230948
     C                     MOVE 'P'       PAYREC                                              230948
     C                     MOVELINSA      OURAG                                               230948
     C                     MOVE INSA      OURSB                                               230948
     C                     MOVE TMAN      THRAG                                               230948
     C           OURSB     IFEQ *BLANKS                                                       230948
     C                     MOVELROBR      OURSB                                               230948
     C                     ENDIF                                                              230948
     C                     ELSE                                                               230948
     C                     MOVE MDST      SETTLE
     C                     MOVE 'P'       PAYREC
     C                     MOVE OMDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
     C                     MOVE TMAN      THRAG
     C                     ENDIF                                                              230948
      *                                                                   137714
      * If CEU003 switched on then use settlement currency if present     137714
      * as currency parameter to call AONOSTR0.                           137714
      *                                                                   137714
     C           CEU003    IFEQ 'Y'                                       137714
     C                     MOVE CCY       W#TRCY                          137714
     C                     MOVE STCY      W#STCY                          137714
     C                     MOVE IC72      W#IC72                          137714
     C           W#STCY    IFNE *BLANK                                    137714
     C                     MOVE W#STCY    CURREN                          137714
     C                     ELSE                                           137714
     C                     MOVE W#TRCY    CURREN                          137714
     C                     ENDIF                                          137714
     C                     ELSE                                           137714
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          137714
     C                     Z-ADDDLNODC    DLNOPH                          S01177
     C           INTC      COMP 'Y'                      49
     C                     MOVE 'I'       MTEX              *
     C                     EXSR CREATE
     C                     MOVE 'N'       RLINTP                                           AR995333A
     C                     SETOF                     49
     C* MATURITY DATE PROCESSING
     C           MATBB     TAG                             ** MTABB TAG **
     C**N23******          GOTO ENDBB                                     042844
     C*                                                                   042844
     C** Need to produce maturity messages for rolled over deal number.   042844
     C** and not produce maturity messages for non rolled over automatic  077557
     C** deals                                                            077557
     C*                                                                   042844
     C           *IN23     IFEQ '0'                                       042844
     C***********RBDN      ANDEQ0                                  042844 138388
     C           *IN23     OREQ '1'                                       077557
     C           RBDN      ANDEQ0                                         077557
     C           AURO      ANDEQ'Y'                                       077557
     C                     GOTO ENDBB                                     042844
     C                     END                                            042844
     C*                                                                   042844
     C                     SETON                     33
     C/COPY WNCPYSRC,DL1705C101
      *                                                                                       CDL033
      ** Compute interest due differently for CF deals.                                       CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
      *                                                                                       CDL033
     C           NIDT      IFGT WIACD                                                         CDL033
     C                     EXSR SRFRC5                                                        CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC6                                                        CDL033
      *                                                                                       CDL033
     C                     ELSE                                                               CDL033
      *                                                                                       CDL033
     C                     EXSR INTRES
     C/COPY WNCPYSRC,DL1705C102
     C                     ENDIF                                                              CDL033
     C                     MOVE MDST      SETTLE
     C                     MOVE 'P'       PAYREC
     C                     MOVE OMDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
     C                     MOVE TMAN      THRAG
      *                                                                   137714
      * If CEU003 switched on then use settlement currency if present     137714
      * as currency parameter to call AONOSTR0.                           137714
      *                                                                   137714
     C           CEU003    IFEQ 'Y'                                       137714
     C                     MOVE CCY       W#TRCY                          137714
     C                     MOVE STCY      W#STCY                          137714
     C                     MOVE IC72      W#IC72                          137714
     C           W#STCY    IFNE *BLANK                                    137714
     C                     MOVE W#STCY    CURREN                          137714
     C                     ELSE                                           137714
     C                     MOVE W#TRCY    CURREN                          137714
     C                     ENDIF                                          137714
     C                     ELSE                                           137714
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          137714
     C                     Z-ADDDLNODC    DLNOPH                          S01177
     C* IF 'ROLLED OVER BY DEAL AMOUNT' NGT ZERO
     C           RBDA      COMP 0                    42
     C   42                GOTO GTBB
     C           IPFR      IFNE 'N'                                       E49966
     C/COPY WNCPYSRC,DL1705C050
     C           IPDS      ANDNE'Y'                                       S01434
     C/COPY WNCPYSRC,DL1705C051
     C           PCPL      ADD  INTDUE    AMTDUE
     C                     ELSE                                           E49966
     C                     Z-ADDPCPL      AMTDUE                          E49966
     C                     END                                            E49966
     C                     MOVE 'M'       MTEX              *
     C                     EXSR CREATE
     C*                                                                   S01434
     C                     SETON                     33                                    AR995333A
     C/COPY WNCPYSRC,DL1705C052
     C           IPDS      IFEQ 'Y'                                       S01434
     C           INTDUE    ANDNE0                                         S01434
     C                     MOVE 'Y'       RLINTP  1                       S01434
     C*                                                                   S01434
     C           IMET      IFNE *BLANKS                                   S01434
     C                     MOVE IMET      SETTLE                          S01434
     C                     MOVELINSA      OURAG                           S01434
     C                     MOVE INSA      OURSB                           S01434
     C                     MOVELSET2      SVSET2                          079139
     C                     MOVELIMET      SET2                            079139
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE ISCY      W#STCY                          CEU003
     C                     MOVE II72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   S01434
     C                     MOVEL*BLANKS   SVTSET                          079139
     C           INOS      IFNE *BLANKS                                   S01434
     C                     MOVE INOS      THRAG                           S01434
     C                     MOVELTSET2     SVTSET                          079139
     C                     MOVELINOS      TSET2                           079139
     C                     ELSE                                           S01434
     C                     MOVE TMAN      THRAG                           S01434
     C                     END                                            S01434
     C                     EXSR CONVER                                    079139
     C*                                                                   S01434
     C                     ELSE                                           S01434
     C*                                                                   S01434
     C                     MOVE MDST      SETTLE                          S01434
     C                     MOVE OMDA      OURAG                           S01434
     C                     MOVE POBR      OURSB                           S01434
     C                     MOVE TMAN      THRAG                           S01434
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     END                                            S01434
     C*                                                                   S01434
     C                     MOVE 'P'       PAYREC                          S01434
     C***********          MOVE CCY       CURREN                   S01434 CEU003
     C                     Z-ADDDLNODC    DLNOPH                          S01434
     C                     EXSR CREATE                                    S01434
     C                     MOVE 'N'       RLINTP                          S01434
     C*                                                                   079139
     C                     MOVELSVSET2    SET2                            079139
     C           SVTSET    IFNE *BLANKS                                   079139
     C                     MOVELSVTSET    TSET2                           079139
     C                     END                                            079139
     C                     EXSR CONVER                                    079139
     C                     END                                            S01434
     C/COPY WNCPYSRC,DL1705C053
     C                     GOTO ENDBB
     C* ELSE 'ROLLED OVER BY DEAL AMOUNT' GT ZERO
     C           GTBB      TAG                             ** GTBB TAG **
     C                     Z-ADDRBDA      ROLOVR                          CEU015
     C           CEU015    IFEQ 'Y'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C                     Z-ADDRBDA      P@FRAM                          CEU015
     C                     MOVELRTFC      P@FRCY                          CEU015
     C                     MOVELCCY       P@TOCY                          CEU015
      *                                                                   CEU015
      ** Convert RBDA to deal currency equivalent via call to EU0200      CEU015
      *                                                                   CEU015
     C                     CALL 'EU0200'                                  CEU015
     C                     PARM *BLANKS   P@RTCD                          CEU015
     C                     PARM           P@FRAM                          CEU015
     C                     PARM           P@FRCY                          CEU015
     C                     PARM           P@TOCY                          CEU015
     C                     PARM           P@OUTA                          CEU015
     C                     PARM           P@INTA                          CEU015
     C                     PARM           P@EXRT                          CEU015
     C                     PARM           P@MDIN                          CEU015
     C*                                                                   CEU015
     C** Database error processing if P@RTCD = *ERROR                     CEU015
     C*                                                                   CEU015
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU015
     C                     MOVELP@RTCD    DBKEY             ************* CEU015
     C                     MOVEL'EU0200  'DBFILE            *DBERROR 030* CEU015
     C                     MOVEL'30'      DBASE             ************* CEU015
     C                     SETON                     U7U8LR               CEU015
     C                     EXSR *PSSR                                     CEU015
     C                     GOTO END                                       CEU015
     C                     ELSE                                           CEU015
     C                     Z-ADDP@OUTA    ROLOVR                          CEU015
     C                     ENDIF                                          CEU015
     C                     ENDIF                                          CEU015
     C           INTDUE    ADD  PCPL      AMTDUE
     C/COPY WNCPYSRC,DL1705C054
     C           IPFR      IFEQ 'N'                                       E49966
     C           IPDS      OREQ 'Y'                                       S01434
     C/COPY WNCPYSRC,DL1705C055
     C                     Z-ADDPCPL      AMTDUE                          E49966
     C                     END                                            E49966
     C***********AMTDUE    SUB  RBDA      AMTDUE     57                   CEU015
     C           AMTDUE    SUB  ROLOVR    AMTDUE     57                   CEU015
     C* CREATE PFS/PREX4 WITH 'RBDA' AS THE AMOUNT
     C  N57                SETON                     47
     C*                                                                   S01392
     C** If Front-up Interest = 'Y'                                       S01392
     C*                                                                   S01392
     C           FUID      IFEQ 'Y'                                       S01392
1104 C                     EXSR OPREX4                                    S01392
     C                     ELSE                                           S01392
     C/COPY WNCPYSRC,DL1705C067
     C  N57 89             EXSR OPREX4
     C/COPY WNCPYSRC,DL1705C068
     C                     END                                            S01392
     C  N57                SETOF                     47
     C  N57                GOTO ENDBB                      DIFF NOT POSVE
     C* CREATE S/PREXX WITH 'AMTDUE' AS THE AMOUNT
     C                     SETON                     33
     C                     MOVE 'M'       MTEX              *
     C                     EXSR CREATE
     C           ENDBB     ENDSR                           ** ENDBB TAG **
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* N E G .   A S S E T S   PU R C H . - INT.BEAR * DL1705-BC *
     C           PROCBC    BEGSR                           *** PROCBC ***
     C                     SETON                     73
     C                     Z-ADDDLNODD    DLNOPH                          S01177
     C           *IN81     IFEQ '0'                                       136030
     C                     Z-ADDDLNODD    PDLNO                           136030
     C                     Z-ADDFVAL      PFVAL                           136030
     C                     END                                            136030
     C* VALUE DATE PROCESSING
     C  N21N35             GOTO INTBC
     C                     SETON                     31
     C                     MOVE SDST      SETTLE
     C                     MOVE 'P'       PAYREC
     C                     MOVE OSDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
     C                     MOVE TSTN      THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'V'       MTEX              *
     C                     EXSR CREATE
     C* INTREST DATE PROCESSING
     C           INTBC     TAG                             ** INTBC TAG **
     C  N22                GOTO MATBC
     C                     SETON                     32
     C                     MOVE MDST      SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
     C                     MOVE TMAN      THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'I'       MTEX              *
     C                     EXSR CREATE
     C* MATURITY DATE PROCESSING
     C           MATBC     TAG                             ** MATBC TAG **
     C  N23                GOTO ENDBC
     C           *IN81     IFEQ '0'                                       136030
     C           SADT      COMP 0                    4242
     C                     ELSE                                           136030
     C                     MOVE '0'       *IN42                           136030
     C                     END                                            136030
     C   42                GOTO ENDBC
     C                     SETON                     33
     C                     MOVE MDST      SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
     C                     MOVE TMAN      THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     EXSR CREATE
     C                     MOVE 'M'       MTEX              *
     C           ENDBC     ENDSR                           ** ENDBC TAG **
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* N E G .   A S S E T S   P U R C H . - NON INT.BEAR * DL1705-BD
     C           PROCBD    BEGSR                           *** PROCBD ***
     C                     SETON                     74
     C                     Z-ADDDLNODD    DLNOPH                          S01177
     C           *IN81     IFEQ '0'                                       136030
     C                     Z-ADDDLNODD    PDLNO                           136030
     C                     Z-ADDFVAL      PFVAL                           136030
     C                     END                                            136030
     C* VALUE DATE PROCESSING
     C  N21N35             GOTO MATBD
     C                     SETON                     31
     C                     MOVE SDST      SETTLE
     C                     MOVE 'P'       PAYREC
     C                     MOVE OSDA      OURAG
     C                     MOVE POBR      OURSB                           S01117
     C                     MOVE TSTN      THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'V'       MTEX              *
     C                     EXSR CREATE
     C* MATURITY DATE PROCESSING
     C           MATBD     TAG                             ** MATBD TAG **
     C  N23                GOTO ENDBD
     C           *IN81     IFEQ '0'                                       136030
     C           SADT      COMP 0                    4242
     C                     ELSE                                           136030
     C                     MOVE '0'       *IN42                           136030
     C                     END                                            136030
     C   42                GOTO ENDBD
     C                     SETON                     33
     C                     MOVE MDST      SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OMDA      OURAG
     C                     MOVE ROBR      OURSB                           S01117
     C                     MOVE TMAN      THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C***********          Z-ADDDLNODE    DLNOPH                    S01177BHF871
     C                     MOVE 'M'       MTEX              *
     C                     EXSR CREATE
     C           ENDBD     ENDSR                           ** ENDBD TAG **
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* N E G O T I A B L E   A S S E T S   S O L D   * DL1705-BE *
     C           PROCBE    BEGSR                           *** PROCBE ***
     C                     SETON                     75
     C                     Z-ADDDLNODE    SDLNO   60                      136030
     C                     Z-ADDFVAL      SFVAL  130                      136030
     C                     Z-ADDRPDN      PDLNO   60                      136030
     C* TEST VALUE DATE TELEX IND.
     C  N23                GOTO ENDBE
     C                     SETON                     31
     C* VALUE DATE PROCESSING
     C                     MOVE SETP      SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OSAC      OURAG
     C                     MOVE OSBR      OURSB                           S01117
     C                     MOVE TSEN      THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCY       W#TRCY                          CEU003
     C                     MOVE STCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     Z-ADDDLNODE    DLNOPH                          BHF871
     C                     MOVE 'M'       MTEX              *
     C                     EXSR CREATE
      ** Also output to extract file PREXPH a record of the neg. asset    136030
      ** purchased for deletion/cancellation processing in DL6315.        136030
     C           PDLNO     CHAINDEALS                41                   136030
     C           *IN41     IFEQ '1'                                       136030
     C                     SETON                     LRU7U8               136030
     C                     MOVEL'DEALS   'DBFILE           * * * * * * *  136030
     C                     MOVEL'019'     DBASE            * DBERR 019 *  136030
     C                     MOVEL'*KEY   ' DBOPTN           * * * * * * *  136030
     C                     MOVELPDLNO     DBKEY                           136030
     C                     EXSR *PSSR                                     136030
     C                     END                                            136030
     C           RECI      IFEQ 'D'                                       136030
     C           RECI      OREQ 'R'                                       136030
     C                     MOVE '1'       *IN42                           136030
     C                     ELSE                                           136030
     C                     MOVE '0'       *IN42                           136030
     C                     END                                            136030
     C           *IN41     IFEQ '1'                                       136030
     C           *IN42     OREQ '0'                                       136030
     C                     GOTO ENDBE                                     136030
     C                     END                                            136030
     C                     Z-ADDFVAL      PFVAL  130                      136030
     C                     TESTB'1'       TLXI           81               136030
     C           *IN81     IFEQ '1'                                       136030
     C                     MOVE '0'       *IN35                           136030
     C                     MOVE '0'       *IN21                           136030
     C                     MOVE '0'       *IN22                           136030
     C                     MOVE '1'       *IN23                           136030
     C                     MOVE '0'       *IN31                           136030
     C                     MOVE '0'       *IN32                           136030
     C                     MOVE '1'       *IN33                           136030
     C                     MOVE '0'       *IN75                           136030
     C                     MOVEL*BLANK    FUID                            136030
     C                     EXSR CONVER                                    136030
     C           *IN19     IFEQ '1'                                       136030
     C           TAXI      COMP 'Y'                      24               136030
     C                     END                                            136030
     C           DTYP      IFEQ 'C1'                                      136030
     C           DTYP      OREQ 'C2'                                      136030
     C           DTYP      OREQ 'BD'                                      136030
     C           DTYP      OREQ 'BP'                                      136030
     C                     EXSR PROCBC                                    136030
     C                     ELSE                                           136030
     C                     EXSR PROCBD                                    136030
     C                     END                                            136030
     C                     END                                            136030
     C           ENDBE     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* D E A L   A M E N D M E N T S   * DL1705-BF *
     C*  DEPOSITS PLACED AND INT.BEARING NEG. ASSETS PURCHASED
     C           PROCBF    BEGSR                           *** PROCBF ***
     C                     SETON                     76
     C* INCREASE OF PRINCIPAL
     C/COPY WNCPYSRC,DL1705C121
     C**N21N35**           GOTO INTBF                                                         CDL022
     C  N21                GOTO INTBF                                                         CDL022
     C/COPY WNCPYSRC,DL1705C122
     C                     SETON                     31
     C                     MOVE SETPDI    SETTLE
     C                     MOVE 'P'       PAYREC
     C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
     C                     MOVE TSENDI    THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCYDI     W#TRCY                          CEU003
     C                     MOVE STCYDI    W#STCY                          CEU003
     C                     MOVE IC72DI    W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCYDI     CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'V'       MTEX              *
     C                     EXSR CREATE
     C* SETTLEMENT/CAPITALISATION OF INTEREST
     C           INTBF     TAG                             ** INTBF TAG **
     C  N22                GOTO DECBF
     C  N89      AMTPDI    COMP 'CI'                     42
     C  N89 42             GOTO DECBF
      *                                                                                       230558
      ** Perform interest calculations only when record is not a Deal                         230558
      ** amendment reversal so as to avoid DBERR 011 and 012.                                 230558
      *                                                                                       230558
     C           *IN13     IFEQ '0'                                                           230558
     C                     EXSR INTRES
     C* IF DEPOSIT PLACED AND INTREST TO BE CAPITALISED AND END OF DAY
     C   09      INTC      COMP 'Y'                      57
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CP28                                           S01408
     C*                                                                   S01408
     C                     SETON                     48
     C   09 57 89          SETON                     32
     C   09 57 89          EXSR OPREX4                     CREATEPFS/PREX4
     C                     SETOF                     48
     C   09 57             GOTO DECBF
      *                                                                                       230558
     C                     ENDIF                                                              230558
      *                                                                                       230558
     C* OTHERWISE
     C                     SETON                     32
     C                     MOVE SETPDI    SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
     C                     MOVE TSENDI    THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCYDI     W#TRCY                          CEU003
     C                     MOVE STCYDI    W#STCY                          CEU003
     C                     MOVE IC72DI    W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCYDI     CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'I'       MTEX              *
     C                     EXSR CREATE
     C* DECREASE OF PRINCIPAL
     C           DECBF     TAG                             ** DECBF TAG **
     C  N23                GOTO ENDBF
     C                     SETON                     33
     C                     MOVE SETPDI    SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
     C                     MOVE TSENDI    THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCYDI     W#TRCY                          CEU003
     C                     MOVE STCYDI    W#STCY                          CEU003
     C                     MOVE IC72DI    W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCYDI     CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'M'       MTEX              *
     C                     EXSR CREATE
     C           ENDBF     ENDSR                           ** ENDBF TAG **
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* D E A L   A M E N D M E N T S   * DL1705-BG *
     C*  DEPOSITS ACCEPTED AND TAKINGS
     C           PROCBG    BEGSR                           *** PROCBG ***
     C                     SETON                     77
     C* INCREASE OF PRINCIPAL
     C/COPY WNCPYSRC,DL1705C123
     C**N21N35**           GOTO INTBG                                                         CDL022
     C  N21                GOTO INTBG                                                         CDL022
     C/COPY WNCPYSRC,DL1705C124
     C                     SETON                     31
     C                     MOVE SETPDI    SETTLE
     C                     MOVE 'R'       PAYREC
     C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
     C                     MOVE TSENDI    THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCYDI     W#TRCY                          CEU003
     C                     MOVE STCYDI    W#STCY                          CEU003
     C                     MOVE IC72DI    W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCYDI     CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'V'       MTEX              *
     C                     EXSR CREATE
     C* SETTLEMENT/CAPITALISATION OF INTEREST
     C           INTBG     TAG                             ** INTBG TAG **
     C  N22                GOTO DECBG
     C  N89      AMTPDI    COMP 'CI'                     42
     C  N89 42             GOTO DECBG
      *                                                                                       230558
      ** Perform interest calculations only when record is not a Deal                         230558
      ** amendment reversal so as to avoid DBERR 011 and 012.                                 230558
      *                                                                                       230558
     C           *IN13     IFEQ '0'                                                           230558
     C                     EXSR INTRES
     C* IF DEPOSIT PLACED AND INTREST TO BE CAPITALISED AND END OF DAY
     C   09      INTC      COMP 'Y'                      57
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CP29                                           S01408
     C*                                                                   S01408
     C                     SETON                     48
     C   09 57 89          SETON                     32
     C   09 57 89          EXSR OPREX4                     CREATEPFS/PREX4
     C                     SETOF                     48
     C   09 57             GOTO DECBG
      *                                                                                       230558
     C                     ENDIF                                                              230558
      *                                                                                       230558
     C* OTHERWISE
     C                     SETON                     32
     C                     MOVE SETPDI    SETTLE
     C                     MOVE 'P'       PAYREC
     C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
     C                     MOVE TSENDI    THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCYDI     W#TRCY                          CEU003
     C                     MOVE STCYDI    W#STCY                          CEU003
     C                     MOVE IC72DI    W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCYDI     CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'I'       MTEX              *
     C                     EXSR CREATE
     C* DECREASE OF PRINCIPAL
     C           DECBG     TAG                             ** DECBG TAG **
     C  N23                GOTO ENDBG
     C                     SETON                     33
     C                     MOVE SETPDI    SETTLE
     C                     MOVE 'P'       PAYREC
     C                     MOVE OSACDI    OURAG
     C                     MOVE OSBR      OURSB                           S01117
     C                     MOVE TSENDI    THRAG
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE CCYDI     W#TRCY                          CEU003
     C                     MOVE STCYDI    W#STCY                          CEU003
     C                     MOVE IC72DI    W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCYDI     CURREN
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'M'       MTEX              *
     C                     EXSR CREATE
     C           ENDBG     ENDSR                           ** ENDBG TAG **
     C********************************************************************
     C/EJECT
     C*****************************************************************   S01119
     C* FRA/IRS RECORD PROCESSING DL1705-BH                               S01119
     C*                                                                   S01119
     C           PROCBH    BEGSR                                          S01119
     C*                                                                   S01119
     C* INTEREST PAY/RECIEVE IND3-1                                       S01119
     C                     MOVE '1'       *IN87                           S01119
     C           PRI3      IFEQ 1                                         S01119
     C                     Z-ADDPIAMT     EAMT                            S01119
     C*********************MOVEL'1'       PINDS                    S01119 S01157
     C*                                                                   S01157
     C** PINDS gets over-written later on and hence is incorrect; save    S01157
     C** setting in a new field to set up correctly                       S01157
     C*                                                                   S01157
     C                     MOVE '001'     @FRIND  3                       S01157
     C*                                                                   S01157
     C                     MOVE PSETM     SETTLE                          S01119
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE UCUCY     W#TRCY                          CEU003
     C                     MOVE PSCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE UCUCY     CURREN                          S01119
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'P'       PAYREC                          S01119
     C                     MOVE UPACC     OURAG                           S01119
     C***********          MOVE CPPBK     THRAG                    S01119 E20444
     C                     MOVE CPRBK     THRAG                           E20444
     C                     MOVE 'V'       MTEX                            S01119
     C***********BRCA******IFNE POBR                                LN0612LN0655
     C                     MOVE POBR      OURSB                           LN0612
     C*********************ELSE                                     LN0612LN0655
     C*********************MOVE BRCA      OURSB                     LN0612LN0655
     C*********************END                                      LN0612LN0655
     C/COPY WNCPYSRC,DL1705C006
      *                                                                   CIR003
      ** If CIR0003 is installed, generate record to PREXPH for           CIR003
      ** Cross Currency Swap exchanges of principal.                      CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           DTYP      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C           CNRQ      OREQ 'o'                                       CIR003
     C           CNRQ      OREQ 'O'                                       CIR003
     C           CNRQ      OREQ 't'                                       CIR003
     C           CNRQ      OREQ 'T'                                       CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C           CNRQ      OREQ 'o'                                       CIR003
     C           CNRQ      OREQ 't'                                       CIR003
     C                     MOVEL'VAL'     WKEDCD                          CIR003
     C                     ELSE                                           CIR003
     C                     MOVEL'MAT'     WKEDCD                          CIR003
     C                     ENDIF                                          CIR003
     C                     MOVE DLNO      WKDLNO                          CIR003
      *                                                                   CIR003
     C           KEY1      CHAINDLGXSTD0             60                   CIR003
     C           *IN60     IFEQ *ON                                       CIR003
     C                     MOVEL'DLGXSTPD'DBFILE            ************* CIR003
     C                     MOVEL'35'      DBASE             *DBERROR 035* CIR003
     C                     MOVE *ON       *INU7             ************* CIR003
     C                     MOVE *ON       *INU8                           CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     Z-ADD0         WXVDT   50                      CIR003
     C           CNRQ      IFEQ 'o'                                       CIR003
     C           CNRQ      OREQ 'O'                                       CIR003
     C                     MOVE UCUCY     CURREN                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 't'                                       CIR003
     C           CNRQ      OREQ 'T'                                       CIR003
     C                     MOVE TCUCY     CURREN                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C                     MOVE TPAMT     EAMT                            CIR003
     C                     MOVE TCUCY     CURREN                          CIR003
     C                     MOVE VDAT      WXVDT                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     MOVE 'P'       PAYREC                          CIR003
     C                     MOVE RXPSTM    SETTLE                          CIR003
     C                     MOVE RXPONS    OURAG                           CIR003
     C***********          MOVE RXAWBN    THRAG                                       CIR003 BUG6995
     C                     MOVELRXAWBN    THRAG                                              BUG6995
     C                     MOVE RXPOBR    OURSB                           CIR003
     C                     MOVE CNRQ      CREQ    1                       CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     EXSR CREATE                                    S01119
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE *BLANKS   CREQ                            CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     END                                            S01119
     C*                                                                   S01119
     C* INTEREST PAY/RECIEVE IND1-1                                       S01119
     C           PRI1      IFEQ 1                                         S01119
     C                     Z-ADDRIAMT     EAMT                            S01119
     C*********************MOVE '1'       PINDS                    S01119 S01157
     C*                                                                   S01157
     C** PINDS gets over-written later on and hence is incorrect; save    S01157
     C** setting in a new field to set up correctly                       S01157
     C*                                                                   S01157
     C                     MOVE '100'     @FRIND                          S01157
     C*                                                                   S01157
     C                     MOVE RSETM     SETTLE                          S01119
      *                                                                   CEU003
      * If CEU003 switched on then use settlement currency if present     CEU003
      * as currency parameter to call AONOSTR0.                           CEU003
      *                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C                     MOVE TCUCY     W#TRCY                          CEU003
     C                     MOVE RSCY      W#STCY                          CEU003
     C                     MOVE IC72      W#IC72                          CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     MOVE W#STCY    CURREN                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE W#TRCY    CURREN                          CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     MOVE TCUCY     CURREN                          S01119
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     MOVE 'R'       PAYREC                          S01119
     C                     MOVE URACC     OURAG                           S01119
     C***********          MOVE CPRBK     THRAG                    S01119 E20444
     C                     MOVE CPPBK     THRAG                           E20444
     C                     MOVE 'M'       MTEX                            S01119
     C***********BRCA******IFNE ROBR                                LN0612LN0655
     C                     MOVE ROBR      OURSB                           LN0612
     C*********************ELSE                                     LN0612LN0655
     C*********************MOVE BRCA      OURSB                     LN0612LN0655
     C*********************END                                      LN0612LN0655
     C/COPY WNCPYSRC,DL1705C007
      *                                                                   CIR003
      ** If CIR0003 is installed, generate record to PREXPH for           CIR003
      ** Cross Currency Swap exchanges of principal.                      CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           DTYP      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C           CNRQ      OREQ 'o'                                       CIR003
     C           CNRQ      OREQ 'O'                                       CIR003
     C           CNRQ      OREQ 't'                                       CIR003
     C           CNRQ      OREQ 'T'                                       CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C           CNRQ      OREQ 'o'                                       CIR003
     C           CNRQ      OREQ 't'                                       CIR003
     C                     MOVEL'VAL'     WKEDCD                          CIR003
     C                     ELSE                                           CIR003
     C                     MOVEL'MAT'     WKEDCD                          CIR003
     C                     ENDIF                                          CIR003
     C                     MOVE DLNO      WKDLNO                          CIR003
      *                                                                   CIR003
     C           KEY1      CHAINDLGXSTD0             60                   CIR003
     C           *IN60     IFEQ *ON                                       CIR003
     C                     MOVEL'DLGXSTPD'DBFILE            ************* CIR003
     C                     MOVEL'36'      DBASE             *DBERROR 036* CIR003
     C                     MOVE *ON       *INU7             ************* CIR003
     C                     MOVE *ON       *INU8                           CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     Z-ADD0         WXVDT   50                      CIR003
     C           CNRQ      IFEQ 'o'                                       CIR003
     C           CNRQ      OREQ 'O'                                       CIR003
     C                     MOVE UCUCY     CURREN                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 't'                                       CIR003
     C           CNRQ      OREQ 'T'                                       CIR003
     C                     MOVE TCUCY     CURREN                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C                     MOVE UPAMT     EAMT                            CIR003
     C                     MOVE UCUCY     CURREN                          CIR003
     C                     MOVE VDAT      WXVDT                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     MOVE 'R'       PAYREC                          CIR003
     C                     MOVE RXRSTM    SETTLE                          CIR003
     C                     MOVE RXRONS    OURAG                           CIR003
     C***********          MOVE RXRIBN    THRAG                                       CIR003 BUG6995
     C                     MOVELRXRIBN    THRAG                                              BUG6995
     C                     MOVE RXROBR    OURSB                           CIR003
     C                     MOVE CNRQ      CREQ                            CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     EXSR CREATE                                    S01119
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE *BLANKS   CREQ                            CIR003
     C                     ENDIF                                          CIR003
     C                     END                                            S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* S U B R O U T I N E   T O   D E T E R M I N E   W H I C H
     C*
     C* R E C O R D S   T O   C R E A T E
     C*       I/P PARMS - SETTLE - SETTLEMENT TYPE
     C*                 - CURREN - CURRENCY
     C*                 - PAYREC - PAY/RECEIVE IND.
     C*                 - OURAG  - OUR AGENT
     C*                 - THRAG  - THEIR AGENT
     C           CREATE    BEGSR                           *** CREATE ***
     C/COPY WNCPYSRC,DL1705C094
     C****************     SETOF                       3958               E107
     C                     SETOF                       39                 E107
     C   49                GOTO SELSE3
     C**IF*I/P*CYCLE*CHECK*SETTLEMENT*TYPE                                E42864
     C**N89******SETTLE    LOKUPIPSET                    42               E42864
     C**N89N42*************GOTO ENDCRE                                    E42864
     C* CHECK SETTLEMENT TYPE                                             E42864
     C           SETTLE    LOKUPIPSET                    42               E42864
     C  N42                GOTO ENDCRE                                    E42864
     C* IF INT.BEAR. NEG. ASSET GET INTEREST
     C   73                EXSR INTRES
     C* SELECT FIELDS FROM FRA/IRS RECORDS                                S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DLH00467
     C           *IN15     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C           SETTLE    IFEQ 01                                        S01119
     C           SETTLE    OREQ 07                                        S01119
     C           SETTLE    OREQ 08                                        S01119
     C*                                                                   S01119
     C*****      CURREN    IFNE LOCY                              S01119  S01194
     C*****      CURREN    OREQ LOCY                              S01119  S01194
     C           CURREN    IFNE BJLCCY                                    S01194
     C           CURREN    OREQ BJLCCY                                    S01194
     C*****      LCYN      ANDEQ'T'                               S01119  S01194
     C           BLLCTB    ANDEQ'T'                                       S01194
     C                     EXSR PROCEE                                    S01119
     C*                                                                   S01119
     C           *IN50     CASEQ'1'       OPREX1                          S01119
     C           *IN50     CASEQ'0'       OPREX2                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*****      CURREN    IFEQ LOCY                              S01119  S01194
     C           CURREN    IFEQ BJLCCY                                    S01194
     C*****      LCYN      ANDEQ'B'                               S01119  S01194
     C           BLLCTB    ANDEQ'B'                                       S01194
     C                     EXSR OPREX3                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                            NOT 01/07/08   S01119
     C*                                                                   S01119
     C           SETTLE    IFEQ 02                                        S01119
     C           SETTLE    OREQ 12                                        S01119
     C                     MOVE '1'       *IN39                           S01119
     C                     EXSR OPREX3                                    S01119
     C*                                                                   S01119
     C                     ELSE                            ELSE NOT 02/12 S01119
     C*                                                                   S01119
     C           OURAG     IFEQ *BLANK                                    S01119
     C                     MOVE '01'      OURASQ                          S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C                     MOVE OURAG     OURASQ                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     EXSR OPREX4                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                             SETTLE 01/07/08S01119
     C                     GOTO ENDCRE                                    S01119
     C                     END                             *IN15          S01119
     C*                                                                   S01119
     C* 'CASE' ON SETTLEMENT TYPE                          ** IF 07 OR 08
     C           SETTLE    COMP 07                       42 *
     C  N42      SETTLE    COMP 08                       42 *
     C  N42                GOTO SELSE1                      *
     C                     EXSR PROCEE                      * VAL. INSTR.
     C   50                EXSR OPREX1                      * CREATE-PREX1
     C  N50                EXSR OPREX2                      *       -PREX2
     C                     GOTO ENDCRE                      *
     C           SELSE1    TAG                             ** ELSEIF 01
     C           SETTLE    COMP 01                       42 *
     C  N42                GOTO SELSE2                      *
1396 C*****      CURREN    COMP LOCY                     42 *     *****   S01194
1396 C           CURREN    COMP BJLCCY                   42 *             S01194
     C* CURRENCY NOT EQ LOCAL CURRENCY                      *
1    C   42 25             GOTO CURELS
     C                     EXSR PROCEE                      * VAL. INSTR.
     C   50                EXSR OPREX1                      * CREATE-PREX1
     C  N50                EXSR OPREX2                      *       -PREX2
     C                     GOTO ENDCCY                      *
     C* ELSE CURRENCY EQ LOCAL CURRENCY                     *
     C           CURELS    TAG                              * CURELS TAG**
     C                     SETON                     39
     C                     EXSR OPREX3                      * CREATE PREX3
     C           ENDCCY    TAG                              *
     C* ENDIF                                               *
     C                     GOTO ENDCRE                      *
     C           SELSE2    TAG                             ** ELSEIF 02
     C           SETTLE    COMP 02                       42 *     OR 12
     C  N42      SETTLE    COMP 12                       42 *
     C  N42                GOTO SELSE3                      *
     C                     SETON                     39
     C                     EXSR OPREX3                      * CREATE PREX3
     C                     GOTO ENDCRE                      *
     C           SELSE3    TAG                             ** ELSE
     C                     MOVE OURAG     OURASQ  2         * A/C SEQ
     C           OURASQ    COMP '  '                     42 * NULL
     C   42                MOVE '01'      OURAG             * DEFAULT 01
     C                     EXSR OPREX4                      * CREATE PREX4
     C           ENDCRE    TAG                                                             AR995333A
     C                     SETOF                     313233                                AR995333A
     C********** ENDCRE    ENDSR                                                           AR995333A
     C                     ENDSR                                                           AR995333A
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* I N T E R E S T   C A L C U L A T I O N   * DL1705-DD *
     C           INTRES    BEGSR                           *** INTRES ***
     C* IF LOAN/DEPOSIT
     C  N71N72             GOTO NEGAS
     C/COPY WNCPYSRC,DL1705C059
     C* IF INTERIM CALCULATION
     C  N32                GOTO MATLD
     C* SPEC. REF 1.1
     C           DAVDDC    COMP 0                        42
     C  N42      DAVDDC    COMP NIDT                 42
     C   42                GOTO TAG18
     C* REF. 1.2
     C           LOOP1     TAG                             ** LOOP1 TAG **
     C                     SETOF                     1213
     C           KEY2      CHAINDEAMS                41
1440 C***41                SETON                     LRU768       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'008'     DBASE   3        * DBERR 008 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY2      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
     C   41                GOTO ENDINT
     C* REF. 1.3
     C   12      VDATDI    COMP IACD                 42  42
     C   12 42             GOTO TAG16
     C* REF. 1.4
     C           TAG14     TAG                             ** TAG14 TAG **
     C           NAADDI    COMP NIDT                 42
     C  N42      NAADDI    COMP 0                        42
     C   42                GOTO TAG18
     C* REF. 1.5
     C                     MOVE KEY3      KEY2
     C                     GOTO LOOP1
     C           TAG16     TAG                             ** TAG16 TAG **
     C* REF. 1.6
     C* A 'CASE' ON AMENDMENT TYPE
     C           AMTPDI    COMP 'PI'                     42** IF PRINCIPAL
     C  N42                GOTO TAG162                      *    INCREASE
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1459 C           ZINTR     ADD  AITC      AITC                            S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
     C                     Z-ADDVDATDI    IACD              *
     C           DAAMDI    ADD  PCPL      PCPL              *
     C                     GOTO END1IN                      *
     C           TAG162    TAG                             ** IF PRINCIPAL
     C           AMTPDI    COMP 'PD'                     42 *    DECREASE
     C  N42                GOTO TAG163                      *
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1459 C           ZINTR     ADD  AITC      AITC                            S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
     C                     Z-ADDVDATDI    IACD              *
     C           PCPL      SUB  DAAMDI    PCPL              *
     C                     GOTO END1IN                      *
     C           TAG163    TAG                             ** IF SPREAD
     C           AMTPDI    COMP 'SC'                     42 *  RATE CHANGE
     C  N42                GOTO END1IN                      *
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1459 C           ZINTR     ADD  AITC      AITC                            S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
     C                     Z-ADDVDATDI    IACD              *
     C           INTR      SUB  RTSP      INTR              *
     C           INTR      ADD  RTSPDI    INTR              *
     C                     Z-ADDRTSPDI    RTSP              *
     C           END1IN    TAG                             **ENDIF
     C* REF. 1.7
     C                     GOTO TAG14
     C*
     C           TAG18     TAG                             ** TAG18 TAG **
     C** Acquire details from Base Rate Code                              140335
     C********** BRTT      IFNE 0                                         140335              CSD103
     C           BRTT      IFNE *BLANKS                                                       CSD103
     C                     MOVE BRTT      WBRTT   2                       140335
     C                     CALL 'AOBSRTR0'                                140335
     C                     PARM '*MSG   ' @RTCD   7                       140335
     C                     PARM '*KEY   ' @OPTN   7                       140335
     C                     PARM CCY       @BCCY   3                       140335
     C                     PARM WBRTT     @BBSRT  2                       140335
     C********** SDBSRT    PARM SDBSRT    DSFDY                     140335CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C                     END                                            140335
     C**  Determine whether rate change should be considered              140335
     C                     MOVE 'N'       RCHG    1                       140335
     C                     SELEC                                          140335
     C           DTYP      WHEQ 'CD'                                      140335
     C           DTYP      OREQ 'CL'                                      140335
     C                     MOVE 'Y'       RCHG                            140335
     C           DTYP      WHEQ 'IP'                                      140335
     C           DTYP      OREQ 'TI'                                      140335
     C           DTYP      OREQ 'IT'                                      140335
     C           DTYP      OREQ 'TD'                                      140335
     C           NIDT      IFNE 0                                         140335
     C           IPFR      ORNE *BLANKS                                   140335
     C                     MOVE 'Y'       RCHG                            140335
     C                     ENDIF                                          140335
     C                     ENDSL                                          140335
     C                     Z-ADDIACD      ZIBEG
     C                     Z-ADDNIDT      ZIEND
      * If CDL096 is On and Amount Convention is 'A', update Next Interest                    CDL096
      * Payment Date to be the Interest Base Date (which contains the                         CDL096
      * correct date that interest should be calculated up to)                                CDL096
     C           CDL096    IFEQ 'Y'                                                           CDL096
     C           *IN09     ANDEQ'1'                                                           CDL096
     C           IPFR      ANDNE' '                                                           CDL096
     C           AMTC      ANDEQ'A '                                                          CDL096
     C                     Z-ADDIBDT      ZIEND                                               CDL096
     C                     ENDIF                                                              CDL096
     C/COPY WNCPYSRC,DL1705CCP6                                           S01408
     C           NIDT      IFGT MDAT                                      E49966
     C           MDAT      ANDNE0                                         E49966
     C/COPY WNCPYSRC,DL1705C084
     C                     Z-ADDMDAT      ZIEND                           E49966
     C                     END                                            E49966
      ** If business day conventions are being used and preceding or                       CDL096I01
      ** modified preceding is the payment convention, if maturity date                    CDL096I01
      ** falls on a holiday the next interest payment date will be the                     CDL096I01
      ** working day before the maturity date so should use interest                       CDL096I01
      ** base date calculated based on the interest payment day in month                   CDL096I01
      ** as comparison                                                                     CDL096I01
     C           CDL096    IFEQ 'Y'                                                        CDL096I01
     C           IPFR      ANDNE' '                                                        CDL096I01
     C           MDAT      ANDNE0                                                          CDL096I01
     C           IBDT      ANDGEMDAT                                                       CDL096I01
     C           PYDC      IFEQ 'P '                                                       CDL096I01
     C           PYDC      OREQ 'MP'                                                       CDL096I01
     C           PYDC      OREQ 'MF'                                                       CDL096I01
     C                     Z-ADDMDAT      ZIEND                                            CDL096I01
     C                     ENDIF                                                           CDL096I01
     C                     ENDIF                                                           CDL096I01
     C                     Z-ADDICBS      ZICALC
     C                     Z-ADDPCPL      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL1705C028
     C** If new base rate takes effect today, consider it in the calc     140335
     C                     Z-ADDZIEND     OLDEND  50                      140335
     C           OLDEND    IFGT BJRDNB                                    140335
     C********** BRTT      ANDNE0                                         140335              CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           BAVDNR    ANDEQBJRDNB                                    140335
     C           RCHG      ANDEQ'Y'                                       140335
     C                     Z-ADDBJRDNB    ZIEND                           140335
     C                     END                                            140335
     C                     EXSR GLINTC
     C           OLDEND    IFGT BJRDNB                                    140335
     C********** BRTT      ANDNE0                                         140335              CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           BAVDNR    ANDEQBJRDNB                                    140335
     C           RCHG      ANDEQ'Y'                                       140335
     C                     Z-ADDZINTR     OLDINT                          140335
     C                     Z-ADDBJRDNB    ZIBEG                           140335
     C                     Z-ADDOLDEND    ZIEND                           140335
     C/COPY WNCPYSRC,DL1705C112
     C                     Z-ADDBANBRT    ZIRATE                          140335
     C/COPY WNCPYSRC,DL1705C106
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
      *                                                                                       CDL033
     C                     ADD  RTSP      ZIRATE                                              CDL033
      *                                                                                       CDL033
     C           ZIRATE    IFLT *ZEROS                                                        CDL033
     C                     Z-ADD*ZEROS    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                    140335
     C                     ADD  OLDINT    ZINTR                           140335
     C/COPY WNCPYSRC,DL1705C107
     C                     END                                            140335
     C/COPY WNCPYSRC,DL1705C029
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
1491 C                     Z-ADDZINTR     INTCAL           INTEREST CALC. S01392
1493 C           ZINTR     ADD  AITC      ITODTE                          S01392
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     INTCAL 130H      INTEREST CALC.
     C/COPY WNCPYSRC,DL1705C085
     C*
     C           ZINTR     ADD  AITC      ITODTE 130H
     C                     END                                            S01392
     C           ITODTE    ADD  AIAP      ITODTE
     C           ITODTE    ADD  AIAN      ITODTE           INTREST TO DATE
     C/COPY WNCPYSRC,DL1705C113
     C*
     C           ITODTE    SUB  IPRD      INTDUE 130
     C           INTDUE    SUB  ICTD      INTDUE           INTEREST DUE
     C/COPY WNCPYSRC,DL1705C114
     C*
     C**  SETUP INT CAP. TO-DATE & INT. PAY/REC TO-DATE                   E13088
     C           INTC      COMP 'Y'                      42               E13088
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CP30                                           S01408
     C*                                                                   S01408
     C   42      INTDUE    ADD  ICTD      ICTD                            E13088
     C  N42      INTDUE    ADD  IPRD      IPRD                            E13088
     C           INTCAL    ADD  AITC      AITC                                             AR995333A
     C*
     C/COPY WNCPYSRC,DL1705CP12                                           S01408
     C   19                EXSR CALTAX                     INTEREST TAX
     C   19      INTDUE    SUB  ITAX      INTDUE
     C/COPY WNCPYSRC,DL1705CP13                                           S01408
     C*
     C***********INTC      COMP 'Y'                      42               E13088
     C   42      INTDUE    ADD  PCPL      PCPL
     C***42******INTDUE    ADD  ICTD      ICTD                            E13088
     C**N42******INTDUE    ADD  IPRD      IPRD                            E13088
     C                     Z-ADDNIDT      IACD
     C**********           Z-ADDITODTE    AITC                                                224890
     C********** INTDUE    ADD  AITC      AITC                                      224890 AR995333A
     C   38                GOTO TAG38
     C                     GOTO ENDLOD
     C* IF MATURITY OF LOAN/DEPOSIT
     C           MATLD     TAG                             ** MATLD TAG **
     C*
     C* SPEC. REF 3.1
     C           DAVDDC    COMP 0                        42
     C   42                GOTO TAG38
     C* REF. 3.2
     C           LOOP2     TAG                             ** LOOP2 TAG **
     C                     SETOF                     1213
     C           KEY2      CHAINDEAMS                41
1440 C***41                SETON                     LRU768       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'009'     DBASE   3        * DBERR 009 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY2      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
     C   41                GOTO ENDINT
     C* REF. 3.3
     C   12      VDATDI    COMP IACD                 42  42
     C   12 42             GOTO TAG36
     C* REF. 3.4
     C           TAG34     TAG                             ** TAG34 TAG **
     C           NAADDI    COMP 0                        42
     C   42                GOTO TAG38
     C* REF. 3.5
     C                     MOVE KEY3      KEY2
     C                     GOTO LOOP2
     C           TAG36     TAG                             ** TAG36 TAG **
     C* REF. 3.6
     C* A 'CASE' ON AMENDMENT TYPE
     C           AMTPDI    COMP 'PI'                     42** IF PRINCIPAL
     C  N42                GOTO TAG362                      *    INCREASE
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C           ZINTR     ADD  AITC      AITC                            S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
     C                     Z-ADDVDATDI    IACD              *
     C           DAAMDI    ADD  PCPL      PCPL              *
     C                     GOTO END3IN                      *
     C           TAG362    TAG                             ** IF PRINCIPAL
     C           AMTPDI    COMP 'PD'                     42 *    DECREASE
     C  N42                GOTO TAG363                      *
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C           ZINTR     ADD  AITC      AITC                            S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
     C                     Z-ADDVDATDI    IACD              *
     C           PCPL      SUB  DAAMDI    PCPL              *
     C                     GOTO END3IN                      *
     C           TAG363    TAG                             ** IF SPREAD
     C           AMTPDI    COMP 'SC'                     42 *  RATE CHANGE
     C  N42                GOTO TAG364                      *
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C           ZINTR     ADD  AITC      AITC                            S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
     C                     Z-ADDVDATDI    IACD              *
     C           INTR      SUB  RTSP      INTR              *
     C           INTR      ADD  RTSPDI    INTR              *
     C                     Z-ADDRTSPDI    RTSP              *
     C                     GOTO END3IN                      *
     C           TAG364    TAG                             ** IF CAPITAL.
     C           AMTPDI    COMP 'CI'                     42 *  OF INTEREST
     C  N42                GOTO TAG365                      *
     C           TG364B    TAG                             ** TAG364B **
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C                     Z-ADDZINTR     INTCAL              INTREST CALCS01392
     C           ZINTR     ADD  AITC      ITODTE                          S01392
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     INTCAL    H       * INTREST CALC
     C*                                                     *
     C           ZINTR     ADD  AITC      ITODTE    H       *
     C                     END                                            S01392
     C           ITODTE    ADD  AIAP      ITODTE            *
     C           ITODTE    ADD  AIAN      ITODTE            * INT. TO DATE
     C*                                                     *
     C           IPRD      ADD  ICTD      INTDUE            *
     C           ITODTE    SUB  INTDUE    INTDUE            * INTEREST DUE
     C*
     C           ICTD      ADD  INTDUE    ICTD              *             E13088
     C*
     C/COPY WNCPYSRC,DL1705CP14                                           S01408
     C   19                EXSR CALTAX                     INTEREST TAX
     C   19      INTDUE    SUB  ITAX      INTDUE
     C/COPY WNCPYSRC,DL1705CP15                                           S01408
     C*                                                     *
     C           PCPL      ADD  INTDUE    PCPL              *
     C***********ICTD      ADD  INTDUE    ICTD              *             E13088
     C*                                                     *
     C                     Z-ADDVDATDI    IACD              *
     C*                                                     *
     C                     Z-ADDITODTE    AITC              *
     C                     GOTO END3IN                      *
     C           TAG365    TAG                             ** IF SET.MENT
     C           AMTPDI    COMP 'SI'                     42 *  OF INTEREST
     C  N42                GOTO END3IN                      *
     C           INTC      COMP 'Y'                      42 *
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CP31                                           S01408
     C*                                                                   S01408
     C   42                GOTO TG364B                      * AS FOR CI
     C*                                                     *
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C                     Z-ADDZINTR     INTCAL              INTREST CALCS01392
     C           ZINTR     ADD  AITC      ITODTE                          S01392
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     INTCAL    H       * INTREST CALC
     C*                                                     *
     C           ZINTR     ADD  AITC      ITODTE    H       *
     C                     END                                            S01392
     C           ITODTE    ADD  AIAP      ITODTE            *
     C           ITODTE    ADD  AIAN      ITODTE            * INT. TO DATE
     C*                                                     *
     C           IPRD      ADD  ICTD      INTDUE            *
     C           ITODTE    SUB  INTDUE    INTDUE            * INTEREST DUE
     C*                                                     *
     C           IPRD      ADD  INTDUE    IPRD              *             E13088
     C*                                                     *
     C/COPY WNCPYSRC,DL1705CP16                                           S01408
     C   19                EXSR CALTAX                     INTEREST TAX
     C   19      INTDUE    SUB  ITAX      INTDUE
     C/COPY WNCPYSRC,DL1705CP17                                           S01408
     C*                                                     *
     C***********IPRD      ADD  INTDUE    IPRD              *             E13088
     C*                                                     *
     C*                                                     *
     C*
     C                     Z-ADDVDATDI    IACD
     C                     Z-ADDITODTE    AITC
     C*
     C           END3IN    TAG                             **ENDIF
     C* REF. 3.7
     C                     GOTO TAG34
     C*
     C           TAG38     TAG                             ** TAG38 TAG **
     C           NIDT      COMP IACD                 38
     C   38                GOTO TAG18
     C* IF TOTAL INTEREST OVERRIDE FLAG ON.
     C                     TESTB'2'       DNSI           42
     C/COPY WNCPYSRC,DL1705C125                                           Rgfix1
      *                                                                                       CDL019
      * Always recalculate final interest for fixed deposits/loans                            CDL019
     C           DTYP      IFEQ 'TD'                                                          CDL019
     C           DTYP      OREQ 'IT'                                                          CDL019
     C           DTYP      OREQ 'IP'                                                          CDL019
     C                     MOVEL'1'       *IN42                                               CDL019
     C                     ENDIF                                                              CDL019
      *                                                                                       CDL019
     C  N42                GOTO TAG38E
     C** Acquire details from Base Rate Code                              140335
     C********** BRTT      IFNE 0                                         140335              CSD103
     C           BRTT      IFNE *BLANKS                                                       CSD103
     C                     MOVE BRTT      WBRTT   2                       140335
     C                     CALL 'AOBSRTR0'                                140335
     C                     PARM '*MSG   ' @RTCD   7                       140335
     C                     PARM '*KEY   ' @OPTN   7                       140335
     C                     PARM CCY       @BCCY   3                       140335
     C                     PARM WBRTT     @BBSRT  2                       140335
     C********** SDBSRT    PARM SDBSRT    DSFDY                     140335CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C                     END                                            140335
     C**  Determine whether rate change should be considered              140335
     C                     MOVE 'N'       RCHG    1                       140335
     C                     SELEC                                          140335
     C           DTYP      WHEQ 'CD'                                      140335
     C           DTYP      OREQ 'CL'                                      140335
     C                     MOVE 'Y'       RCHG                            140335
     C           DTYP      WHEQ 'IP'                                      140335
     C           DTYP      OREQ 'TI'                                      140335
     C           DTYP      OREQ 'IT'                                      140335
     C           DTYP      OREQ 'TD'                                      140335
     C           NIDT      IFNE 0                                         140335
     C           IPFR      ORNE *BLANKS                                   140335
     C                     MOVE 'Y'       RCHG                            140335
     C                     END                                            140335
     C                     ENDSL                                          140335
      *                                                                                       CDL019
      ** Consider rate change if fixed deposit/loan and rate not fixed                        CDL019
     C           CDL019    IFEQ 'Y'                                                           CDL019
     C           FSFBRT    ANDNE'Y'                                                           CDL019
     C           DTYP      IFEQ 'TD'                                                          CDL019
     C           DTYP      OREQ 'IT'                                                          CDL019
     C           DTYP      OREQ 'IP'                                                          CDL019
     C                     MOVE 'Y'       RCHG                                                CDL019
     C                     ENDIF                                                              CDL019
     C                     ENDIF                                                              CDL019
      *                                                                                       CDL019
     C                     Z-ADDIACD      ZIBEG
     C                     Z-ADDMDAT      ZIEND
     C                     Z-ADDICBS      ZICALC
     C                     Z-ADDPCPL      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL1705C030
     C** If new base rate takes effect today, consider it in the calc     140335
     C                     Z-ADDZIEND     OLDEND  50                      140335
     C           OLDEND    IFGT BJRDNB                                    140335
     C********** BRTT      ANDNE0                                         140335              CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           BAVDNR    ANDEQBJRDNB                                    140335
     C           RCHG      ANDEQ'Y'                                       140335
     C                     Z-ADDBJRDNB    ZIEND                           140335
     C                     END                                            140335
     C                     EXSR GLINTC
     C           OLDEND    IFGT BJRDNB                                    140335
     C********** BRTT      ANDNE0                                         140335              CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           BAVDNR    ANDEQBJRDNB                                    140335
     C           RCHG      ANDEQ'Y'                                       140335
     C                     Z-ADDZINTR     OLDINT                          140335
     C                     Z-ADDBJRDNB    ZIBEG                           140335
     C                     Z-ADDOLDEND    ZIEND                           140335
     C/COPY WNCPYSRC,DL1705C115
     C                     Z-ADDBANBRT    ZIRATE                          140335
     C/COPY WNCPYSRC,DL1705C108
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
      *                                                                                       CDL033
     C                     ADD  RTSP      ZIRATE                                              CDL033
      *                                                                                       CDL033
     C           ZIRATE    IFLT *ZEROS                                                        CDL033
     C                     Z-ADD*ZEROS    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                    140335
     C                     ADD  OLDINT    ZINTR                           140335
     C/COPY WNCPYSRC,DL1705C109
     C                     END                                            140335
     C/COPY WNCPYSRC,DL1705C031
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C                     Z-ADDZINTR     INTCAL           INTEREST CALC. S01392
     C           ZINTR     ADD  AITC      ITODTE                          S01392
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     INTCAL 130H      INTEREST CALC.
     C*
     C           ZINTR     ADD  AITC      ITODTE 130H
     C                     END                                            S01392
     C           ITODTE    ADD  AIAP      ITODTE
     C           ITODTE    ADD  AIAN      ITODTE           INTREST TO DATE
     C/COPY WNCPYSRC,DL1705C116
     C*
     C           ITODTE    SUB  IPRD      INTDUE 130
     C           INTDUE    SUB  ICTD      INTDUE           INTEREST DUE
     C*
     C/COPY WNCPYSRC,DL1705CP18                                           S01408
     C   19                EXSR CALTAX                     INTEREST TAX
     C   19      INTDUE    SUB  ITAX      INTDUE
     C/COPY WNCPYSRC,DL1705CP19                                           S01408
     C*
     C                     GOTO ENDLOD
     C           TAG38E    TAG                             ** TAG38E TAG**
     C                     TESTB'1'       DSTI           28               153330
     C           *IN28     IFEQ '1'                                       153330
     C                     Z-SUBTOTI      TOTI                            153330
     C                     ENDIF                                          153330
     C           TOTI      SUB  IPRD      INTDUE           INTEREST DUE
     C           *IN28     IFEQ '1'                                       153330
     C                     Z-SUBTOTI      TOTI                            153330
     C                     ENDIF                                          153330
     C/COPY WNCPYSRC,DL1705CP20                                           S01408
     C** Total interest override flag test sends down to this TAG,        170231
     C** therefore misses out code that moves maturity date to w'field    170231
     C** ZIEND, which is compared to BRT change date in SR CALTAX.        170231
     C*                                                                   170231
     C   19                Z-ADDMDAT      ZIEND                           170231
     C   19                EXSR CALTAX                     INTEREST TAX
     C   19      INTDUE    SUB  ITAX      INTDUE
     C/COPY WNCPYSRC,DL1705CP21                                           S01408
     C*
     C           ENDLOD    TAG                             ** ENDLOD TAG**
     C                     GOTO ENDINT
     C           NEGAS     TAG                             ** NEGAS TAG **
     C* NEGOTIABLE ASSETS PURCHASED
     C  N73                GOTO SETCAP
     C* IF INTERIM CALCULATION
     C  N32                GOTO MATNA
     C* REF. 2.1
     C                     Z-ADDSLID      ZIBEG
     C                     Z-ADDNIDT      ZIEND
     C                     Z-ADDICBS      ZICALC
     C                     Z-ADDFVAL      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL1705C016
     C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL1705C017
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C                     Z-ADDZINTR     INTDUE           INTEREST DUE   S01392
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     INTDUE    H      INTEREST DUE
     C                     END                                            S01392
     C*
     C                     Z-ADDNIDT      SLID
     C                     GOTO END1NA
     C* IF NEG. ASS. TO MATURITY
     C           MATNA     TAG                             ** MATNA TAG **
     C* REF. 4.1
     C           DAVDDD    COMP 0                        42
     C   42                GOTO TAG48
     C* REF. 4.2
     C           LOOP3     TAG                             ** LOOP3 TAG **
     C                     SETOF                     1213
     C           KEY4      CHAINDEAMS                41
1440 C***41                SETON                     LRU768       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'010'     DBASE   3        * DBERR 010 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY4      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
     C   41                GOTO ENDINT
     C* REF. 4.3
     C   12      VDATDI    COMP SLID                 42
     C   12 42             GOTO TAG46
     C* REF. 4.4
     C           TAG44     TAG                             ** TAG44 TAG **
     C           NAADDI    COMP 0                        42
     C   42                GOTO TAG48
     C* REF. 4.5
     C                     MOVE KEY3      KEY4
     C                     GOTO LOOP3
     C*
     C* REF. 4.6
     C           TAG46     TAG                             ** TAG46 TAG **
     C                     Z-ADDVDATDI    SLID
     C* REF. 4.7
     C                     GOTO TAG44
     C* REF. 4.8
     C           TAG48     TAG                             ** TAG48 TAG **
     C                     Z-ADDSLID      ZIBEG
     C                     Z-ADDMDAT      ZIEND
     C                     Z-ADDICBS      ZICALC
     C                     Z-ADDFVAL      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL1705C018
     C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL1705C019
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C                     Z-ADDZINTR     INTDUE           INTEREST DUE   S01392
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     INTDUE    H      INTEREST DUE
     C                     END                                            S01392
     C*
     C           END1NA    TAG                             ** END1NA TAG**
     C                     GOTO ENDINT
     C*
     C* DEAL AMENDMENT - SETTLEMENT/CAPITALISATION OF INTEREST
     C           SETCAP    TAG                             ** SETCAP TAG**
     C  N76N77             GOTO ERRINT
     C* REF. 5.1
     C                     SETOF                     1213
     C   09      KEY2      CHAINDEAMS                41
     C  N09      KEY4      CHAINDEAMS                41
1440 C***41                SETON                     LRU768       *****   S01194
0965 C   41                SETON                     LRU7U8               S01194
     C   41                MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C   41                MOVEL'011'     DBASE   3        * DBERR 011 *  S01194
     C   41                MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C   41                MOVELKEY4      DBKEY  29                       S01194
     C   41                EXSR *PSSR                                     S01194
     C   41                GOTO ERRINT
     C* REF  5.1.1
     C           TAG511    TAG                             ** TAG511 TAG**
     C           VDATDI    COMP IACD                   42
     C   42
     CORN12                GOTO TAG53
     C* REF 5.2
     C   10                GOTO TAG526
     C* A 'CASE' AN AMENDMENT TYPE
     C           AMTPDI    COMP 'PI'                     42** IF PRINCIPAL
     C  N42                GOTO SCELS1                      *    INCREASE
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C           ZINTR     ADD  AITC      AITC                            S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
     C                     Z-ADDVDATDI    IACD              *
     C           DAAMDI    ADD  PCPL      PCPL
     C                     GOTO END1SC                      *
     C*                                                     *
     C           SCELS1    TAG                             ** IF PRINCIPAL
     C           AMTPDI    COMP 'PD'                     42 *    DECREASE
     C  N42                GOTO SCELS2                      *
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C           ZINTR     ADD  AITC      AITC                            S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
     C                     Z-ADDVDATDI    IACD              *
     C           PCPL      SUB  DAAMDI    PCPL
     C                     GOTO END1SC                      *
     C*                                                     *
     C           SCELS2    TAG                             ** IF SPREAD
     C           AMTPDI    COMP 'SC'                     42 *  RATE CHANGE
     C  N42                GOTO SCELS3                      *
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C           ZINTR     ADD  AITC      AITC                            S01392
     C                     ELSE                                           S01392
     C           ZINTR     ADD  AITC      AITC      H
     C                     END                                            S01392
     C           INTR      SUB  RTSP      INTR              *
     C           RTSPDI    ADD  INTR      INTR              *
     C                     Z-ADDRTSPDI    RTSP              *
     C                     Z-ADDVDATDI    IACD                            185845
     C                     GOTO END1SC                      *
     C*                                                     *
     C           SCELS3    TAG                             ** IF CAPITAL-
     C           AMTPDI    COMP 'CI'                     42 *  ISATION OF
     C  N42                GOTO SCELS4                      * INTREST
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C                     Z-ADDZINTR     INTCAL            * INTREST CALLS01392
     C           ZINTR     ADD  AITC      ITODTE                          S01392
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     INTCAL    H       * INTREST CALL
     C*  II                                                 *
     C           ZINTR     ADD  AITC      ITODTE    H       *
     C                     END                                            S01392
     C           ITODTE    ADD  AIAN      ITODTE            * INT. TO DATE
     C           ITODTE    ADD  AIAP      ITODTE
     C*  III                                                *
     C           ITODTE    SUB  IPRD      INTDUE            *
     C           INTDUE    SUB  ICTD      INTDUE            * INT. DUE
     C*
     C           INTDUE    ADD  ICTD      ICTD              *             E13088
     C*
     C/COPY WNCPYSRC,DL1705CP22                                           S01408
     C         19          EXSR CALTAX                     INTEREST TAX
     C         19INTDUE    SUB  ITAX      INTDUE
     C/COPY WNCPYSRC,DL1705CP23                                           S01408
     C*
     C*  IV                                                 *
     C           INTDUE    ADD  PCPL      PCPL              *
     C***********INTDUE    ADD  ICTD      ICTD              *             E13088
     C*  V                                                  *
     C                     Z-ADDVDATDI    IACD              *
     C*  VI                                                 *
     C                     Z-ADDITODTE    AITC              *
     C*  VII                                                *
     C           AIAN      ADD  AIAP      AIAP              *
     C*  VIII                                               *
     C                     Z-ADD0         AIAN              *
     C                     GOTO END1SC                      *
     C           SCELS4    TAG                             ** IF SET.MENT
     C           AMTPDI    COMP 'SI'                     42 *  OF INTEREST
     C  N42                GOTO END1SC                      *
     C           INTC      COMP 'Y'                      U7 *
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CP32                                           S01408
     C*                                                                   S01408
     C   U7                SETON                     LR69   *
     C   U7                GOTO ENDINT                      *
     C                     EXSR GETINT                      *
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C                     Z-ADDZINTR     INTCAL            * INTREST CALLS01392
     C           ZINTR     ADD  AITC      ITODTE                          S01392
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     INTCAL    H       * INT. CALC.
     C*  II                                                 *
     C           ZINTR     ADD  AITC      ITODTE    H       *
     C                     END                                            S01392
     C           ITODTE    ADD  AIAN      ITODTE            * INT. TO DATE
     C           ITODTE    ADD  AIAP      ITODTE
     C*  III                                                *
     C           ITODTE    SUB  IPRD      INTDUE            *
     C           INTDUE    SUB  ICTD      INTDUE            * INT. DUE
     C*  IV                                                 *             E13088
     C           INTDUE    ADD  IPRD      IPRD              *             E13088
     C*
     C/COPY WNCPYSRC,DL1705CP24                                           S01408
     C         19          EXSR CALTAX                     INTEREST TAX
     C         19INTDUE    SUB  ITAX      INTDUE
     C/COPY WNCPYSRC,DL1705CP25                                           S01408
     C*
     C***IV******                                           *             E13088
     C***********INTDUE    ADD  IPRD      IPRD              *             E13088
     C*  V                                                  *
     C                     Z-ADDVDATDI    IACD              *
     C*  VI                                                 *
     C                     Z-ADDITODTE    AITC              *
     C*  VII                                                *
     C           AIAN      ADD  AIAP      AIAP              *
     C*  VIII                                               *
     C                     Z-ADD0         AIAN              *
     C           END1SC    TAG                             ** END1SC TAG**
     C*
     C                     GOTO TAG53
     C           TAG526    TAG                             ** TAG526 TAG**
     C                     Z-ADDSLID      ZIBEG
     C                     Z-ADDVDATDI    ZIEND
     C                     Z-ADDICBS      ZICALC
     C                     Z-ADDFVAL      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL1705C020
     C                     EXSR GLINTC
     C/COPY WNCPYSRC,DL1705C021
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C                     Z-ADDZINTR     INTDUE           INTEREST DUE   S01392
     C                     ELSE                                           S01392
     C                     Z-ADDZINTR     INTDUE    H      INTEREST DUE
     C                     END                                            S01392
     C*
     C                     Z-ADDVDATDI    SLID
     C* REF. 5.3
     C           TAG53     TAG                             ** TAG53 TAG **
     C           VDATDL    COMP VDATDI                   42
     C   42      DASNDL    COMP DASNDI                   42
     C  N42                SETOF                     1213
     C  N42                Z-ADDVDATDI    RETAIN                                              222097
     C  N42                MOVE AMTPDI    RETYPE  2                                           222097
     C  N42      KEY3      CHAINDEAMS                41
1440 C**N42 41             SETON                     LRU768       *****   S01194
0965 C  N42 41             SETON                     LRU7U8               S01194
     C  N42 41             MOVEL'DEAMS   'DBFILE 10        * * * * * * *  S01194
     C  N42 41             MOVEL'012'     DBASE   3        * DBERR 012 *  S01194
     C  N42 41             MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C  N42 41             MOVELKEY3      DBKEY  29                       S01194
     C  N42 41             EXSR *PSSR                                     S01194
     C  N42 41             GOTO ERRINT
     C           AMTPDI    IFEQ 'SI'                                                          222097
     C           RETYPE    ANDEQ'SC'                                                          222097
     C  N42                Z-ADDRETAIN    IACD                                                222097
     C                     END                                                                222097
     C  N42                GOTO TAG511
     C                     GOTO ENDINT
     C           ERRINT    TAG                             ** ERRINT TAG**
     C                     Z-ADD0         INTDUE
     C                     Z-ADD0         INTCAL
     C                     Z-ADD0         ITODTE
     C           ENDINT    ENDSR                           ** ENDINT TAG**
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* GET INTEREST FOR COMMON PARTS OF 'INTRES' SUBROUTINE.
     C           GETINT    BEGSR                           *** GETINT ***
     C** Acquire details from Base Rate Code                              140335
     C********** BRTT      IFNE 0                                         140335              CSD103
     C           BRTT      IFNE *BLANKS                                                       CSD103
     C                     MOVE BRTT      WBRTT   2                       140335
     C                     CALL 'AOBSRTR0'                                140335
     C                     PARM '*MSG   ' @RTCD   7                       140335
     C                     PARM '*KEY   ' @OPTN   7                       140335
     C                     PARM CCY       @BCCY   3                       140335
     C                     PARM WBRTT     @BBSRT  2                       140335
     C********** SDBSRT    PARM SDBSRT    DSFDY                     140335CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C                     END                                            140335
     C**  Determine whether rate change should be considered              140335
     C                     MOVE 'N'       RCHG    1                       140335
     C                     SELEC                                          140335
     C           DTYP      WHEQ 'CD'                                      140335
     C           DTYP      OREQ 'CL'                                      140335
     C                     MOVE 'Y'       RCHG                            140335
     C           DTYP      WHEQ 'IP'                                      140335
     C           DTYP      OREQ 'TI'                                      140335
     C           DTYP      OREQ 'IT'                                      140335
     C           DTYP      OREQ 'TD'                                      140335
     C           NIDT      IFNE 0                                         140335
     C           IPFR      ORNE *BLANKS                                   140335
     C                     MOVE 'Y'       RCHG                            140335
     C                     END                                            140335
     C                     ENDSL                                          140335
     C                     Z-ADDIACD      ZIBEG
     C                     Z-ADDVDATDI    ZIEND
     C                     Z-ADDICBS      ZICALC
     C                     Z-ADDPCPL      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C/COPY WNCPYSRC,DL1705C022
     C** If new base rate takes effect today, consider it in the calc     140335
     C           *IN71     IFEQ '1'                                       140335
     C           *IN72     OREQ '1'                                       140335
     C           VDATDI    IFGT BJRDNB                                    140335
     C********** BRTT      ANDNE0                                         140335              CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           BAVDNR    ANDEQBJRDNB                                    140335
     C           RCHG      ANDEQ'Y'                                       140335
     C                     Z-ADDBJRDNB    ZIEND                           140335
     C                     END                                            140335
     C                     END                                            140335
     C                     EXSR GLINTC
     C           *IN71     IFEQ '1'                                       140335
     C           *IN72     OREQ '1'                                       140335
     C           VDATDI    IFGT BJRDNB                                    140335
     C********** BRTT      ANDNE0                                         140335              CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           BAVDNR    ANDEQBJRDNB                                    140335
     C           RCHG      ANDEQ'Y'                                       140335
     C                     Z-ADDZINTR     OLDINT 152                      140335
     C                     Z-ADDBJRDNB    ZIBEG                           140335
     C                     Z-ADDVDATDI    ZIEND                           140335
     C/COPY WNCPYSRC,DL1705C117
     C                     Z-ADDBANBRT    ZIRATE                          140335
     C/COPY WNCPYSRC,DL1705C110
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
      *                                                                                       CDL033
     C                     ADD  RTSP      ZIRATE                                              CDL033
      *                                                                                       CDL033
     C           ZIRATE    IFLT *ZEROS                                                        CDL033
     C                     Z-ADD*ZEROS    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                    140335
     C                     ADD  OLDINT    ZINTR                           140335
     C/COPY WNCPYSRC,DL1705C111
     C                     END                                            140335
     C                     END                                            140335
     C/COPY WNCPYSRC,DL1705C023
     C                     ENDSR
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C*    CALCULATE INTEREST TAX
     C*
     C           CALTAX    BEGSR                           ** CALTAX TAG *
     C                     Z-ADD0         ITAX   130
     C                     Z-ADD0         WNTAMT                                              234068
1844 C***24*26*  INTDUE    MULT TAXR      ITAX      H             *****   S01194
1844 C***24*26***INTDUE    MULT BNHKTR    ITAX                     S01194 S01383
1845 C***24*26***ITAX      DIV  100       ITAX      H                     S01383
     C*                                                                   S01383
     C**IF*DEAL*IS*A*DEPOSIT*TAKEN*(IT,CD,TD),*AND*IT*IS*TAXABLE** S01383 CDL006
     C** If Deal is a deposit taken (IT,CD,TD,FT,DT or LT) and            CDL006
     C** it is taxable.                                                   CDL006
     C*                                                                   S01383
     C           *IN24     IFEQ '1'                        B001           S01383
     C           *IN26     ANDEQ'1'                                       S01383
     C/COPY WNCPYSRC,DL1705C071
     C*                                                                   S01383
     C** IF BRT SAR INSTALLED                                             S01383
     C*                                                                   S01383
     C           S01383    IFEQ 'Y'                        B002           S01383
     C/COPY WNCPYSRC,DL1705C011
     C*                                                                   S01383
     C           ZIEND     IFGE DEFF                       B003           S01383
     C                     Z-ADDBRTR      BNHKTR                          S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C           ZIEND     IFLT DEFF                       B003           S01383
     C                     Z-ADDPBRTR     BNHKTR                          S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C**********           MOVE CNUM      CLNKEY  60                                   S01383 CSD027
     C                     MOVE CNUM      CLNKEY  6                                           CSD027
     C           CLNKEY    CHAINSDCBRTL1             41                   S01383
     C           *IN41     IFEQ '1'                        B003           S01383
     C           XRECI     ORNE 'D'                                       S01383
0965 C                     SETON                     LRU7U8               S01383
     C                     MOVEL'SDCBRTPD'DBFILE           * * * * * * *  S01383
     C                     MOVEL'022'     DBASE            * DBERR 022 *  S01383
     C                     MOVELCNUM      DBKEY            * * * * * * *  S01383
     C                     EXSR *PSSR                                     S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C           TAXIND    IFEQ 'L'                        B003           S01383
     C/COPY WNCPYSRC,DL1705C072
     C           INTDUE    MULT BNHKTR    TAX01  155                      S01383
     C/COPY WNCPYSRC,DL1705C073
     C           TAX01     DIV  100       ITAX      H                     S01383
     C                     END                             E003           S01383
     C*                                                                   S01383
     C           TAXIND    IFEQ 'P'                        B003           S01383
     C           BNHKTR    MULT 0.5       TAXRH  155                      S01383
     C/COPY WNCPYSRC,DL1705C074
     C           INTDUE    MULT TAXRH     TAX01  155                      S01383
     C/COPY WNCPYSRC,DL1705C075
     C           TAX01     DIV  100       ITAX      H                     S01383
     C                     END                             E003           S01383
     C/COPY WNCPYSRC,DL1705C012
     C*                                                                   S01383
     C** ELSE BRT SAR IS NOT INSTALLED                                    S01383
     C*                                                                   S01383
1844 C                     ELSE                            X002           S01383
      *                                                                                       CDL013
      *** if CAR CDL013 is installed.                                                         CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
     C/COPY WNCPYSRC,DLH00050
      *                                                                                       CDL013
      ** Call access program for base currency details                                        CDL013
      *                                                                                       CDL013
     C                     CALL 'AOCURRR0'                                                    CDL013
     C                     PARM '*MSG    '@RTCD                                               CDL013
     C                     PARM '*KEY    '@OPTN                                               CDL013
     C                     PARM BJCYCD    @AJCD   3                                           CDL013
     C           @CURR     PARM @CURR     DSSDY                                               CDL013
      *                                                                                       CDL013
      ** If no record is found perform standard database error process-                       CDL013
      ** ing                                                                                  CDL013
      *                                                                                       CDL013
     C           @RTCD     IFNE *BLANK                                                        CDL013
     C                     MOVEL'SDCURRPD'DBFILE                                              CDL013
     C                     MOVEL'39'      DBASE                                               CDL013
     C                     MOVEL@OPTN     DBOPTN                                              CDL013
     C                     MOVELBJCYCD    DBKEY  29                                           CDL013
     C                     MOVE *ON       *INU7                                               CDL013
     C                     MOVE *ON       *INU8                                               CDL013
     C                     MOVE *ON       *INLR                                               CDL013
     C                     EXSR *PSSR                                                         CDL013
     C                     GOTO END                                                           CDL013
     C                     END                                                                CDL013
      *                                                                                       CDL013
      *** Set WHT rate.                                                                       CDL013
     C                     SELEC                                                              CDL013
     C           TAXI      WHEQ '1'                                                           CDL013
     C                     Z-ADDETXR1     ULWHTR  52                                          CDL013
     C           TAXI      WHEQ '2'                                                           CDL013
     C                     Z-ADDETXR2     ULWHTR                                              CDL013
     C           TAXI      WHEQ '3'                                                           CDL013
     C                     Z-ADDETXR3     ULWHTR                                              CDL013
     C           TAXI      WHEQ '4'                                                           CDL013
     C                     Z-ADDETXR4     ULWHTR                                              CDL013
     C           TAXI      WHEQ '5'                                                           CDL013
     C                     Z-ADDETXR5     ULWHTR                                              CDL013
     C           TAXI      WHEQ '6'                                                           CDL013
     C                     Z-ADDETXR6     ULWHTR                                              CDL013
     C           TAXI      WHEQ '7'                                                           CDL013
     C                     Z-ADDETXR7     ULWHTR                                              CDL013
     C           TAXI      WHEQ '8'                                                           CDL013
     C                     Z-ADDETXR8     ULWHTR                                              CDL013
     C           TAXI      WHEQ '9'                                                           CDL013
     C                     Z-ADDETXR9     ULWHTR                                              CDL013
     C                     ENDSL                                                              CDL013
      *                                                                                       CDL013
      *                                                                                       CDL013
      *** If WHT rate is ZERO set tax amount to ZERO.                                         CDL013
     C           ULWHTR    IFEQ *ZERO                                                         CDL013
     C                     Z-ADD0         ITAX                                                CDL013
      *                                                                                       CDL013
      *** otherwise calculate tax amount.                                                     CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
      *** if Deal Ccy is equal to Base Ccy round down Interest Amount.                        CDL013
      *** and CDL081 is off                                                                   CDL081
      *                                                                                       CDL081
     C           CCY       IFEQ BJCYCD                                                        CDL013
     C           CDL081    ANDEQ'N'                                                           CDL081
      *                                                                                       CDL013
      *** set work adjustment field according to decimal places.                              CDL013
     C                     SELEC                                                              CDL013
     C           A6NBDP    WHEQ 1                                                             CDL013
     C                     Z-ADD10        ULWKAD  40                                          CDL013
     C           A6NBDP    WHEQ 2                                                             CDL013
     C                     Z-ADD100       ULWKAD                                              CDL013
     C           A6NBDP    WHEQ 3                                                             CDL013
     C                     Z-ADD1000      ULWKAD                                              CDL013
     C           A6NBDP    WHEQ 0                                                             CDL013
     C                     Z-ADD1         ULWKAD                                              CDL013
     C                     ENDSL                                                              CDL013
      *                                                                                       CDL013
      *** round down Interest Amount.                                                         CDL013
     C           TOTI      DIV  ULWKAD    ULTINT 150                                          CDL013
     C                     MULT ULWKAD    ULTINT                                              CDL013
      *                                                                                       CDL013
      *** calculate and then round down Tax Amount.                                           CDL013
     C           ULTINT    MULT ULWHTR    ITAX                                                CDL013
     C                     DIV  100       ITAX                                                CDL013
     C           ITAX      DIV  ULWKAD    ULITAX 150                                          CDL013
     C           ULITAX    MULT ULWKAD    ITAX                                                CDL013
      *                                                                                       CDL013
      *** otherwise (Deal Ccy NOT = Base Ccy) calculate Tax amount                            CDL013
      *** without rounding down.                                                              CDL013
     C                     ELSE                                                               CDL013
     C           TOTI      MULT ULWHTR    ITAX                                                CDL013
      *                                                                                       CDL081
      ** Check if tax amount is to be rounded down                                            CDL081
      *                                                                                       CDL081
     C           CCY       IFEQ BJCYCD                                                        CDL081
     C           CDL081    ANDEQ'Y'                                                           CDL081
     C           W#BSRD    ANDEQ'Y'                                                           CDL081
     C           CCY       ORNE BJCYCD                                                        CDL081
     C           CDL081    ANDEQ'Y'                                                           CDL081
     C           W#NBRD    ANDEQ'Y'                                                           CDL081
     C                     DIV  100       ITAX                                                CDL081
     C                     ELSE                                                               CDL081
     C                     DIV  100       ITAX      H                                         CDL013
     C                     ENDIF                                                              CDL081
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
     C/COPY WNCPYSRC,DLH00051
      *                                                                                       CDL013
      *** otherwise perform Original Tax calculations.                                        CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CCP4                                           S01408
     C*                                                                   S01408
     C*                                                                   S01383
1844 C           INTDUE    MULT BNHKTR    ITAX                            S01383
     C/COPY WNCPYSRC,DL1705C076
     C*                                                                   S01392
     C** Round Down Interest                                              S01392
     C*                                                                   S01392
     C           JRDFC     IFEQ 'Y'                                       S01392
     C           ITAX      DIV  100       ITAX                            S01383
     C                     ELSE                                           S01392
     C           ITAX      DIV  100       ITAX      H                     S01383
     C                     END                                            S01392
      *                                                                                       CDL013
      ** Endif for New Tax Process(If CDL013 is installed)                                    CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CCP5                                           S01408
     C*                                                                   S01408
     C*                                                                   S01383
     C                     END                             E002           S01383
     C/COPY WNCPYSRC,DLH00423
     C                     END                             E001           S01383
      *                                                                                       CGL031
      ** If CGL031 is installed, retrieve tax amount in original                              CGL031
      ** currency and accumulate.                                                             CGL031
      ** No CGL031/CER048/CER054 tax processing for negative interest                       MD031127
      *                                                                                       CGL031
     C                     TESTB'1'       DSTI           28                                 MD031127
      *                                                                                     MD031127
     C           CGL031    IFEQ 'Y'                                                           CGL031
     C           *IN24     ANDEQ'1'                                                           234068
     C           *IN28     ANDEQ'0'                                                         MD031127
      *                                                                                       CGL031
     C                     MOVEL'D'       WKMODI  1                                           CGL031
      *                                                                                       CGL031
     C********** KYEUTX    SETLLSDCSINL6             84                                CGL031 234068
     C********** KYEUTX    READESDCSINL6                 84                            CGL031 234068
      **********                                                                       CGL031 234068
     C********** *IN84     DOWEQ'0'                                                    CGL031 234068
      **********                                                                       CGL031 234068
     C********** TSSTAT    IFEQ 'T'                                                    CGL031 234068
     C**********           ADD  TSTXSR    ITAX                                         CGL031 234068
     C**********           ENDIF                                                       CGL031 234068
      **********                                                                       CGL031 234068
     C********** KYEUTX    READESDCSINL6                 84                            CGL031 234068
      **********                                                                       CGL031 234068
     C**********           ENDDO                                                       CGL031 234068
      *                                                                                       234068
      ** Call Deposits                                                                        234068
      *                                                                                       234068
     C           DTYP      IFEQ 'CD'                                                          234068
     C           MDAT      ANDEQ0                                                             234068
     C           DTYP      OREQ 'DT'                                                          234068
     C           CDL006    ANDEQ'Y'                                                           234068
     C           MDAT      ANDEQ0                                                             234068
     C           DTYP      OREQ 'LT'                                                          234068
     C           CDL006    ANDEQ'Y'                                                           234068
     C           MDAT      ANDEQ0                                                             234068
      *                                                                                       234068
     C           VDAT      IFGE BJRDNB                                                        234068
     C           NOTD      IFEQ 0                                                             234068
     C           VDAT      ADD  1         WKMDAT  50                                          234068
     C                     ELSE                                                               234068
     C           NOTD      ADD  VDAT      WKMDAT                                              234068
     C                     ENDIF                                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           VDAT      IFLT BJRDNB                                                        234068
     C           NOTD      IFEQ 0                                                             234068
     C           BJRDNB    ADD  1         WKMDAT                                              234068
     C                     ELSE                                                               234068
     C           NOTD      ADD  BJRDNB    WKMDAT                                              234068
     C                     ENDIF                                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Else, Fixed Term Deposits                                                            234068
      *                                                                                       234068
     C                     ELSE                                                               234068
     C                     Z-ADDMDAT      WKMDAT                                              234068
     C                     ENDIF                                                              234068
      *                                                                                     MD027820
      ** Use the interest due in calculating the interest tax                               MD027820
      ** if the interest payment date is not zero                                           MD027820
      *                                                                                     MD027820
     C           NIDT      IFNE *ZEROS                                                      MD027820
     C           DTYP      IFEQ 'TD'                                                        MD027820
     C           DTYP      OREQ 'TI'                                                        MD027820
     C           DTYP      OREQ 'IT'                                                        MD027820
     C           DTYP      OREQ 'IP'                                                        MD027820
     C           DTYP      OREQ 'CD'                                                        MD031098
     C                     Z-ADDNIDT      WKMDAT                                            MD027820
     C**********           Z-ADDINTDUE    TOTI                                     MD027820 MD031141
     C                     ENDIF                                                            MD027820
     C                     ENDIF                                                            MD027820
      *                                                                                     MD030373
     C********** NIDT      IFNE *ZEROS                                             MD030373 MD031141
     C********** AMTPDI    ANDEQ'SC'                                               MD030373 MD031141
     C********** NIDT      ANDEQWKMDAT                                             MD030373 MD031141
     C**********           Z-ADDINTDUE    TOTI                                     MD030373 MD031141
     C**********           ENDIF                                                   MD030373 MD031141
      *                                                                                     MD030373
     C           NIDT      IFEQ *ZEROS                                                      MD030373
     C           AMTPDI    IFEQ 'SI'                                                        MD030373
     C           AMTPDI    OREQ 'SC'                                                        MD030373
     C           AMTPDI    OREQ 'CI'                                                        MD031141
     C           DTYP      IFEQ 'CD'                                                        MD030373
     C           DTYP      OREQ 'TD'                                                        MD030373
     C                     Z-ADDVDATDI    WKMDAT                                            MD030373
     C**********           Z-ADDINTDUE    TOTI                                     MD030373 MD031141
     C                     ENDIF                                                            MD030373
     C                     ENDIF                                                            MD030373
     C                     ENDIF                                                            MD030373
      *                                                                                       234068
     C                     MOVE DLNO      WDLNO   6                                           234068
     C                     MOVE CNUM      WCNUM   6                                           234068
     C                     EXSR SRCHKD                                                        234068
     C                     Z-ADDINTDUE    TOTI                                              MD031141
     C           WSKIP     IFEQ 'N'                                                           234068
     C                     EXSR SRCEUT                                                        234068
     C                     ELSE                                                               234068
     C                     Z-ADD*ZEROS    WNTAMT                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C                     ADD  WNTAMT    ITAX                                                234068
      *                                                                                       CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C/COPY WNCPYSRC,DL1705C058
     C                     ENDSR
     C*******************************************************************
     C/SPACE 3
     C********************************************************************
     C* VALIDATION OF INSTRUCTIONS  * DL1705-EE *
     C*       I/P  OURAG - OUR AGENT A/C
     C*            THRAG - THEIR AGENT A/C
     C*
     C*       O/P  PAYREC - WILL BE SET TO 'C' IF NECCESSARY
     C*            IND.50 - INSTRUCTIONS VALID
     C           PROCEE    BEGSR                           *** PROCEE ***
     C                     SETOF                     50
     C           OURAG     COMP ' '                  5050  ** OUR AGENT
     C  N50                GOTO ENDEE                       *  VALIDATION.
1860 C*****                MOVELOURAG     NOSN              *     *****   S01194
1860 C                     MOVELOURAG     @KEYE             *             S01194
1861 C*****                MOVE CURREN    CCY               *     *****   S01194
1862 C*****                Z-ADD70        RECT              *     *****   S01194
1863 C*****                EXSR TABCHN                      *     *****   S01194
0327 C*                                                                   S01194
     C* CALL ACCESS PROG. FOR NOSTRO DETAILS                              S01194
     C                     CALL 'AONOSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @KEYA   6                       S01194
     C                     PARM CURREN    @KEYB   3                       S01194
     C**********           PARM *BLANKS   @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANKS   @KEYC  10                                           CGL029
     C                     PARM *BLANKS   @KEYD   2                       S01194
     C                     PARM           @KEYE   2                       S01194
     C                     PARM *BLANKS   @KEYG   3                       S01194
     C                     PARM *BLANKS   @KEYH  10                       S01194
     C                     PARM *BLANKS   @KEYI   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
1864 C                     SETOF                     50     *             S01194
1865 C                     GOTO ENDEE                      **             S01194
1865 C                     END                             **             S01194
0327 C*                                                                   S01194
1864 C***99**              SETOF                     50     *     *****   S01194
1865 C***99**              GOTO ENDEE                      **     *****   S01194
0327 C*                                                                   S01194
     C*
     C********** THRAG     COMP ' '                  5050  ** THIER AGENT S01177
     C**N50*****           GOTO ENDEE                       *  VALIDATION.S01177
      *                                                                   073302
      * If Their Agent field is still blank, use Account With Bank        073302
      *                                                                   073302
     C           THRAG     COMP ' '                  5050  ** THIER AGENT E25974
      *                                                                   E28178
      **If*settling*through*SWIFT*(method*08)*then*THRAG*can*be****E28178 073302
      **blank.*Defaults*to*the*nostro*value*and*message*is*still***E28178 073302
      **complete***************************************************E28178 073302
     C           *IN50     IFNE '1'                                       E28178
     C***********SETTLE    IFEQ 08                                 E28178 073302
     C***********          SETON                     50            E28178 073302
     C***********          MOVE A7CUST    IFCUST                   E28178 073302
     C***********          END                                     E28178 073302
     C           SETTLE    IFEQ 08                                        104793
     C           SETTLE    OREQ 01                                        111045
     C                     SETON                     50                   104793
     C                     MOVE A7CUST    IFCUST                          104793
     C                     END                                            104793
     C           THRAG     IFEQ *BLANKS                                   104793
     C                     MOVEL*BLANKS   THRAG                           073302
     C                     MOVELAWBN      THRAG                           073302
     C                     END                                            104793
     C           THRAG     COMP ' '                  5050                 073302
     C                     END                                            E28178
     C  N50                GOTO ENDEE                       *  VALIDATION.E25974
      *                                                                   E28178
     C***********IFCUST    COMP '000001'             42     *             073302
     C***42******IFCUST    COMP '999999'               42   *             073302
     C**N42******          GOTO ENDEE                      **NOT A CUSTNO.073302
     C*
     C           PAYREC    COMP 'P'                      42** CREDIT VAL.
1874 C***42*     CNUMTL    COMP CUST                     42 *     *****   S01194
1874 C***42******A7CUST    COMP IFCUST                   42 *      S01194 073302
     C***42******          MOVE 'C'       PAYREC           **             073302
     C*
     C           ENDEE     ENDSR                           ** ENDEE TAG **
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* S E T U P   A N D   W R I T E   O U T P U T   R E C O R D
     C           OUTPUT    BEGSR                           *** OUTPUT ***
     C* NB. SOME FIELDS HAVE ALREADY BEEN SETUP AND SOME ARE COMMON
     C*
     C* IF FOREIGN EXCHANGE EXTRACT
     C  N70                GOTO ELSEO1
     C           DTYP      COMP 'OP'                     42
     C   42                Z-ADDOTDT      VDATPH
     C  N42                Z-ADDVDAT      VDATPH  50
     C**********           Z-ADDCNUM      CNUMPH                                              CSD027
     C                     MOVE CNUM      CNUMPH                                              CSD027
     C                     Z-ADDDLNODB    DLNOPH
     C                     Z-ADD0         PRODPH
     C           PAYREC    COMP 'R'                      42
     C   42                Z-ADDPUAM      EAMT   130
     C  N42                Z-ADDSLAM      EAMT
     C                     MOVE 'D'       RCDT
     C                     Z-ADD0         DASNPH
     C   42                MOVE BLNK10    OTFACO 10
     C   42                MOVE BLNK35    OTSPI  35
     C                     Z-ADD0         RCPI
     C                     Z-ADD0         RRDN
     C  N42                MOVE FACO      OTFACO
     C  N42                MOVE SPI       OTSPI
     C/COPY WNCPYSRC,DL1705C013
     C                     GOTO ENDO
     C* NON-FX DEALS EXTRACT
     C           ELSEO1    TAG                             ** ELSEO1 TAG**
     C  N71N72N73
     CANN74N75N87          GOTO ELSEO2                                    S01119
     C*NN74N75 **********  GOTO ELSEO2  ****************************      S01119
      *                                                                   073302
      * If Their Agent field is still blank, use Account With Bank        073302
      *                                                                   073302
     C           THRAG     COMP '  '                 5353                 073302
     C           *IN53     IFEQ '0'                                       073302
     C                     MOVE *BLANKS   THRAG                           073302
     C                     MOVELAWBN      THRAG                           073302
     C                     ELSE                                           073302
     C                     MOVE '0'       *IN53                           073302
     C                     END                                            073302
      *                                                                   073302
     C           SETTLE    COMP 07                       42
     C  N42      SETTLE    COMP 08                       42
     C                     Z-ADD0         PRODPH
1912 C***46                Z-ADD2         PRODPH                  *****   S01194
1913 C***46      DTYP      LOKUPDTABA                    42       *****   S01194
1914 C***46 42             Z-ADD1         PRODPH                  *****   S01194
     C   31                Z-ADDVDAT      VDATPH
     C   32                Z-ADDNIDT      VDATPH
     C   33                Z-ADDMDAT      VDATPH
     C           *IN09     IFEQ '1'                                       063953
     C           *IN31     ANDEQ'1'                                       063953
     C           *IN57     ANDEQ'1'                                       063953
     C           RLSCND    IFNE 'Y'                                       079139
     C           RLSCND    OREQ 'Y'                                       079139
     C           RLDIFF    ANDGT*ZEROS                                    079139
     C                     Z-ADDMDAT      VDATPH                          063953
     C                     END                                            079139
     C                     END                                            063953
     C   15                Z-ADDEVDAT     VDATPH                          S01119
     C**N10*****           Z-ADDCNUM      CNUMPH                                              CSD027
     C***10*****           Z-ADDISCN      CNUMPH                                              CSD027
     C  N10                MOVE CNUM      CNUMPH                                              CSD027
     C   10                MOVE ISCN      CNUMPH                                              CSD027
     C           DTYP      COMP 'CI'                     42
     C/COPY WNCPYSRC,DL1705C104
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           DTYP      ANDEQ'CF'                                                          CDL033
     C                     MOVE *ON       *IN42                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C***42*****           Z-ADDCHNA      CNUMPH                                              CSD027
     C   42                MOVE CHNA      CNUMPH                                              CSD027
     C           PAYREC    COMP 'R'                      42
     C***10N42**           Z-ADDPCUS      CNUMPH                                              CSD027
     C***10*42**           Z-ADDISCN      CNUMPH                                              CSD027
     C   10N42             MOVE PCUS      CNUMPH                                              CSD027
     C   10 42             MOVE ISCN      CNUMPH                                              CSD027
     C** 09 ********       Z-ADDDLNODC    DLNOPH                          S01177
     C** 10 ********       Z-ADDDLNODD    DLNOPH                          S01177
     C** 11 ********       Z-ADDDLNODE    DLNOPH                          S01177
     C* LOANS AND DEPOSITS
     C           *IN15     IFEQ '0'                                       S01119
     C                     Z-ADDRBDA      ROLOVR                          CEU015
     C           CEU015    IFEQ 'Y'                                       CEU015
     C           *IN09     ANDEQ'1'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C                     Z-ADDRBDA      P@FRAM                          CEU015
     C                     MOVELRTFC      P@FRCY                          CEU015
     C                     MOVELCCY       P@TOCY                          CEU015
      *                                                                   CEU015
      ** Convert RBDA to deal currency equivalent via call to EU0200      CEU015
      *                                                                   CEU015
     C                     CALL 'EU0200'                                  CEU015
     C                     PARM *BLANKS   P@RTCD                          CEU015
     C                     PARM           P@FRAM                          CEU015
     C                     PARM           P@FRCY                          CEU015
     C                     PARM           P@TOCY                          CEU015
     C                     PARM           P@OUTA                          CEU015
     C                     PARM           P@INTA                          CEU015
     C                     PARM           P@EXRT                          CEU015
     C                     PARM           P@MDIN                          CEU015
     C*                                                                   CEU015
     C** Database error processing if P@RTCD = *ERROR                     CEU015
     C*                                                                   CEU015
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU015
     C                     MOVELP@RTCD    DBKEY             ************* CEU015
     C                     MOVEL'EU0200  'DBFILE            *DBERROR 031* CEU015
     C                     MOVEL'31'      DBASE             ************* CEU015
     C                     SETON                     U7U8LR               CEU015
     C                     EXSR *PSSR                                     CEU015
     C                     GOTO END                                       CEU015
     C                     ELSE                                           CEU015
     C                     Z-ADDP@OUTA    ROLOVR                          CEU015
     C                     ENDIF                                          CEU015
     C                     ENDIF                                          CEU015
     C*                                                                   S01392
     C** Front-up Interest = 'Y'                                          S01392
     C*                                                                   S01392
     C           FUID      IFEQ 'Y'                        B001           S01392
     C           PCPL      SUB  TOTI      EAMT                            S01392
     C*                                                                   042844
     C** Set up amounts for rollovers                                     042844
     C*                                                                   042844
     C           *IN09     IFEQ '1'                                       042844
     C           *IN31     ANDEQ'1'                                       042844
     C           *IN57     ANDEQ'1'                                       042844
     C                     Z-ADDAMTDUE    EAMT                            042844
     C*                                                                   042844
     C** Amount for second message is the diffeerence                     042844
     C*                                                                   042844
     C           RLSCND    IFEQ 'Y'                                       042844
     C           RLDIFF    IFLT 0                                         079139
     C                     Z-SUBRLDIFF    EAMT                            079139
     C                     ELSE                                           079139
     C                     Z-ADDRLDIFF    EAMT                            042844
     C                     END                                            042844
     C                     END                                            042844
     C*                                                                   042844
     C** Amount for internal settlement is amount rolled over             042844
     C*                                                                   042844
     C           *IN47     IFEQ '1'                                       042844
     C                     Z-ADDRBDA      EAMT                            042844
     C                     END                                            042844
     C                     END                                            042844
     C*                                                                   042844
     C   32                Z-ADDINTDUE    EAMT                            S01392
     C   33                Z-ADDPCPL      EAMT                            S01392
     C           *IN33     IFEQ '1'                        B002           S01392
     C           RBDN      ANDNE*ZERO                                     S01392
     C           RBDN      CHAINDRSDEALS             37                   S01392
     C           *IN37     IFEQ '1'                        B003           S01392
     C                     MOVEL'DRSDEALS'DBFILE           * * * * * * *  S01194
     C                     MOVEL'023'     DBASE            * DBERR 023 *  S01194
     C                     MOVEL'*KEY   ' DBOPTN           * * * * * * *  S01194
     C                     MOVELRBDN      DBKEY                           S01194
     C                     SETON                     U7U8LR               S01392
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDO                                      S01392
     C                     END                             E003           S01392
     C           CEU015    IFEQ 'Y'                                       CEU015
     C           RTFC      ANDNE*BLANKS                                   CEU015
     C                     Z-ADDTOTI2     P@FRAM                          CEU015
     C                     MOVELRTFC      P@FRCY                          CEU015
     C                     MOVELCCY       P@TOCY                          CEU015
      *                                                                   CEU015
      ** Convert RBDA to deal currency equivalent via call to EU0200      CEU015
      *                                                                   CEU015
     C                     CALL 'EU0200'                                  CEU015
     C                     PARM *BLANKS   P@RTCD                          CEU015
     C                     PARM           P@FRAM                          CEU015
     C                     PARM           P@FRCY                          CEU015
     C                     PARM           P@TOCY                          CEU015
     C                     PARM           P@OUTA                          CEU015
     C                     PARM           P@INTA                          CEU015
     C                     PARM           P@EXRT                          CEU015
     C                     PARM           P@MDIN                          CEU015
     C*                                                                   CEU015
     C** Database error processing if P@RTCD = *ERROR                     CEU015
     C*                                                                   CEU015
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU015
     C                     MOVELP@RTCD    DBKEY             ************* CEU015
     C                     MOVEL'EU0200  'DBFILE            *DBERROR 033* CEU015
     C                     MOVEL'33'      DBASE             ************* CEU015
     C                     SETON                     U7U8LR               CEU015
     C                     EXSR *PSSR                                     CEU015
     C                     GOTO END                                       CEU015
     C                     ELSE                                           CEU015
     C                     Z-ADDP@OUTA    TOTI2                           CEU015
     C                     ENDIF                                          CEU015
     C                     ENDIF                                          CEU015
     C           MTIN      IFEQ '12'                       B003           S01392
     C           PCPL      SUB  TOTI2     EAMT                            S01392
     C                     ELSE                                           S01392
     C                     Z-ADDTOTI2     EAMT                            S01392
     C                     END                             E003           S01392
     C                     END                             E002           S01392
     C                     ELSE                            X001           S01392
     C   09                Z-ADDPCPL      EAMT
     C   09 32             Z-ADDINTDUE    EAMT
     C   09 33             Z-ADDAMTDUE    EAMT
     C/COPY WNCPYSRC,DL1705C082
     C***09*33*47          Z-ADDRBDA      EAMT                            CEU015
     C   09 33 47          Z-ADDROLOVR    EAMT                            CEU015
     C*                                                                   042844
     C** Set up amounts for rollovers                                     042844
     C*                                                                   042844
     C           *IN09     IFEQ '1'                                       042844
     C           *IN31     ANDEQ'1'                                       042844
     C           *IN57     ANDEQ'1'                                       042844
     C                     Z-ADDAMTDUE    EAMT                            042844
     C*                                                                   042844
     C** Amount for second message is the diffeerence                     042844
     C*                                                                   042844
     C           RLSCND    IFEQ 'Y'                                       042844
     C           RLDIFF    IFLT 0                                         079139
     C                     Z-SUBRLDIFF    EAMT                            079139
     C                     ELSE                                           079139
     C                     Z-ADDRLDIFF    EAMT                            042844
     C                     END                                            079139
     C                     END                                            042844
     C*                                                                   042844
     C** Amount for internal settlement is amount rolled over             042844
     C*                                                                   042844
     C           *IN47     IFEQ '1'                                       042844
     C***********          Z-ADDRBDA      EAMT                     042844 CEU015
     C                     Z-ADDROLOVR    EAMT                            CEU015
     C                     END                                            042844
     C                     END                                            042844
     C*                                                                   042844
     C           RLINTP    IFEQ 'Y'                                       S01434
     C                     Z-ADDINTDUE    EAMT                            S01434
     C                     END                                            S01434
     C*                                                                   S01434
     C                     END                             E001           S01392
     C* INT-BEAR. NEG. ASSETS. PURCH.
     C   73                Z-ADDPUPR      EAMT
     C   73 32             Z-ADDINTDUE    EAMT
     C   73 33             Z-ADDFVAL      EAMT
     C   73 33   INTDUE    ADD  EAMT      EAMT
     C* NON-INT-BEAR. NEG. ASSETS PURCH.
     C   74                Z-ADDPUPR      EAMT
     C   74 33             Z-ADDFVAL      EAMT
     C* NEG. ASSETS SOLD
     C   75                Z-ADDSAPR      EAMT
     C                     ELSE                                           S01119
     C                     Z-ADDDLNO      DLNOPH                          S01119
     C                     END                                            S01119
     C           *IN10     IFEQ '1'                                       136030
     C           *IN81     ANDEQ'1'                                       179200
     C                     Z-ADDPFVAL     EAMT                            136030
     C           PDLNO     SETLLDLNASSL1             83                   136030
     C           PDLNO     READEDLNASSL1                 83               136030
     C           *IN83     DOWEQ'0'                                       136030
     C           EAMT      SUB  FVALNS    EAMT                            136030
     C           PDLNO     READEDLNASSL1                 83               136030
     C                     END                                            136030
     C           *IN73     IFEQ '1'                                       136030
     C           EAMT      ANDNE0                                         136030
     C                     Z-ADDEAMT      ZIAMT                           136030
     C                     Z-ADDICBS      ZICALC                          136030
     C                     Z-ADDINTR      ZIRATE                          136030
     C                     Z-ADDMDAT      ZIEND                           136030
     C                     Z-ADDIACD      ZIBEG                           136030
     C                     EXSR GLINTC                                    136030
     C           JRDFC     IFEQ 'Y'                                       136030
     C                     ADD  ZINTR     EAMT                            136030
     C                     ELSE                                           136030
     C                     ADD  ZINTR     EAMT      H                     136030
     C                     END                                            136030
     C                     ADD  AITC      EAMT                            136030
     C                     ADD  AIAN      EAMT                            136030
     C                     ADD  AIAP      EAMT                            136030
     C                     SUB  IPRD      EAMT                            136030
     C                     ADD  PINT1     EAMT                            136030
     C                     END                                            136030
     C                     END                                            136030
     C*
     C                     MOVE 'D'       RCDT
     C           *IN10     IFEQ '1'                                       136030
     C           EAMT      ANDEQ0                                         136030
     C                     MOVE 'F'       RCDT                            136030
     C                     END                                            136030
     C*                                                                   042844
     C** If record being produced for Rolled Over deal then record type   042844
     C** needs setting to 'R' to cancel the maturity messages             042844
     C*                                                                   042844
     C           *IN09     IFEQ '1'                                       042844
     C           *IN31     ANDEQ'1'                                       042844
     C           *IN57     ANDEQ'1'                                       042844
     C           RLSCND    ANDNE'Y'                                       S01434
     C           *IN47     ANDEQ'0'                                       042844
     C           RLINTP    ANDNE'Y'                                       S01434
     C                     MOVE 'R'       RCDT                            042844
     C                     END                                            042844
     C*                                                                   085620
     C** If record being produced for Rolled Over deal then record type   085620
     C** needs setting to 'S' so nothing else is cancelled                085620
     C*                                                                   085620
     C           *IN09     IFEQ '1'                                       085620
     C           *IN31     ANDEQ'1'                                       085620
     C           *IN57     ANDEQ'1'                                       085620
     C           RLSCND    ANDEQ'Y'                                       085620
     C           *IN47     ANDEQ'0'                                       085620
     C                     MOVE 'S'       RCDT                            085620
     C                     END                                            085620
     C*                                                                   042844
     C           RLINTP    IFEQ 'Y'                                       S01434
     C                     MOVE 'I'       RCDT                            S01434
     C                     END                                            S01434
     C*                                                                   S01434
     C                     Z-ADD0         DASNPH
     C           PAYREC    COMP 'R'                      42
     C   42                MOVE BLNK10    OTFACO
     C   42                MOVE BLNK35    OTSPI
     C                     Z-ADD0         RCPI
     C                     Z-ADD0         RRDN
     C  N42                MOVE FACO      OTFACO
     C  N42                MOVE SPI       OTSPI
     C* IF LOAN OR DEPOSIT                                 **
     C  N09                GOTO ENDROL                      *
     C   49                Z-ADD3         RCPI
     C* IF START DATE PROCESSING                            *
     C***31******RODA      COMP 0                    42     *             064052
     C   31      RODA      COMP 0                    4242                 064052
     C   31 42             Z-ADD1         RCPI              *
     C   31 42             Z-ADDRODN      RRDN              *
     C* ELSE MATURITY PROCESSING                            *
     C   47                Z-ADD2         RCPI              *
     C   47                Z-ADDRBDN      RRDN              *
     C* ENDIF                                               *
     C           ENDROL    TAG                             ** ENDROL TAG**
     C                     GOTO ENDO
     C           ELSEO2    TAG                             ** ELSEO2 TAG**
     C* DEAL AMENDMENT EXTRACT
     C  N76N77             GOTO ENDO
     C                     Z-ADD0         PRODPH
1970 C***46                Z-ADD2         PRODPH                  *****   S01194
1971 C***46      DTYP      LOKUPDTABB                    42       *****   S01194
1972 C***46 42             Z-ADD1         PRODPH                  *****   S01194
     C*
     C                     Z-ADDVDATDI    VDATPH
     C**********           Z-ADDCNUMDI    CNUMPH                                              CSD027
     C                     MOVE CNUMDI    CNUMPH                                              CSD027
     C                     Z-ADDDLNODI    DLNOPH
     C   31
     COR 33                Z-ADDDAAMDI    EAMT
     C   32                Z-ADDINTDUE    EAMT
     C                     MOVE 'A'       RCDT
     C                     Z-ADDDASNDI    DASNPH
     C                     MOVE FACODI    OTFACO
     C                     MOVE SPIDI     OTSPI
     C                     MOVE DTYPDI    DTYP
     C                     MOVE DLSTDI    DLST
     C                     Z-ADD0         RCPI
     C                     Z-ADD0         RRDN
     C   48                Z-ADD3         RCPI
     C           ENDO      TAG                             ** ENDO TAG **
     C* COMMON ROUTINES
     C                     MOVE '100'     PINDS
     C   32                MOVE '010'     PINDS
     C   33                MOVE '001'     PINDS
     C           *IN09     IFEQ '1'                                       063953
     C           *IN31     ANDEQ'1'                                       063953
     C           *IN57     ANDEQ'1'                                       063953
     C           RLSCND    IFNE 'Y'                                       083890
     C           RLSCND    OREQ 'Y'                                       083890
     C           RLDIFF    ANDGT*ZEROS                                    083890
     C                     MOVE '001'     PINDS                           063953
     C                     END                                            083890
     C                     END                                            063953
     C                     Z-ADD0         FFIN
1995 C*****      CURREN    COMP USCY                     42       *****   S01194
1995 C           CURREN    COMP BLUSCY                   42               S01194
     C                     TESTB'2'       DSTI           43
     C  N43                TESTB'3'       DSTI           43
     C   42 43             Z-ADD1         FFIN
     C   42N43             Z-ADD2         FFIN
     C***44**              MOVE BRCD      BRKEY                           S01117
2000 C***44**              MOVE BRCA      BRKEY                   S01117  S01194
2001 C***44**    BRKEY     CHAINTABLE                41                   S01194
2002 C***44*41             SETON                     LRU759               S01194
     C           BGMBIN    IFEQ 'Y'                                       S01194
     C* CALL ACCESS PROG. FOR BRANCH INTERNAL CUSTOMER NUMBER             S01194
     C**********           CALL 'AOBRCHR0'                                             S01194 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM BRCA      @KEYB                           S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBRCHPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'013'     DBASE   3        * DBERR 013 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVELBRCA      DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     ELSE                                           S01194
     C                     MOVE A8BICN    BICN                            S01194
     C                     END                                            S01194
     C                     END                                            S01194
     C           DTYP      COMP 'OP'                     42
     C/COPY WNCPYSRC,DL1705C118
     C*                                                                                      BUG6479
     C** If MMM is install and transaction type is 'OP' then                                 BUG6479
     C** allow output of zero amount.                                                        BUG6479
     C           CSW025    IFNE 'Y'                                                          BUG6479
     C   42      EAMT      COMP 0                        42
     C                     ELSE                                                              BUG6479
     C                     MOVE '0'       *IN42                                              BUG6479
     C                     END                                                               BUG6479
     C**   IF AMOUNT NEGATIVE
     C           EAMT      COMP 0                      45
     C   45      PAYREC    COMP 'P'                      43REVERSE TX IF
     C   45 43             MOVE 'R'       PAYREC           NEGATIVE
     C   45N43             MOVE 'P'       PAYREC
     C   45                Z-SUBEAMT      EAMT
     C* IF AMOUNT NEGATIVE SETON '45'
     C*
     C* SUPPRESS OUTPUT IF NULL EAMT OR REQUIRED BRANCH CODE NOT FOUND.
     C   42
     COR 44 41             GOTO NOPREX
     C*
     C*                                                                   S01117
     C           OURSB     IFEQ *BLANKS                                   S01117
     C                     MOVE BRCA      OURSB                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C* INTERNAL SETTLEMENTS NEVER OVERIDDEN BY CHIPS OR SWIFT.
     C   54                GOTO OUTEXT
     C*
     C* IF PAYMENT AND TELEX IS INCOMPLETE THEN DO NOT SEND BY SWIFT OR
     C*  CHIPS
     C           X         IFEQ 2                           INCOMPLETE
     C           PAYREC    CABNE'R'       OUTEXT            NOT RECEIVE
     C                     END
     C*****************************************************************   S01167
     C**         PAYREC    IFEQ 'P'                                       S01167
     C**         PAYREC    OREQ 'C'                                       S01167
     C**         DTYP      CABEQ'NX'      OUTEXT                          S01167
     C**                   END                                            S01167
     C* IF CHIPS INTERFACE EXISTS, DETERMINE IF EVENT IS FOR CHIPS
     C  N29                GOTO SWPRTY
     C           PAYREC    COMP 'P'                      42 = PAYMENT
     C  N42      PAYREC    COMP 'C'                      42 = CREDIT
     C   42      SETTLE    COMP 07                       42 = CHIPS
     C***42**    CURREN    COMP USCY                  ***42*=*US*DOLLARS**S01194
     C   42      CURREN    COMP BLUSCY                   42 = US DOLLARS  S01194
     C*
     C*  IF EVENT IS FOR CHIPS, CHECK DATE.
     C  N42                GOTO SWPRTY
     C***89**    VDATPH    COMP DNWD              *****4343*EOD=NXT*WRK*DYS01194
     C   89      VDATPH    COMP BJDNWD                 4343 EOD=NXT WRK DYS01194
     C**N89**    VDATPH    COMP RUND              *******43*I/P=TODAY*****S01194
     C  N89      VDATPH    COMP BJRDNB                   43 I/P=TODAY     S01194
     C*  IF CHIPS PAYMENT DATE IS WRONG, SKIP OUTPUT
     C  N43                GOTO NOPREX
     C*
     C*  IF CHIPS PAYMENT DATE IS CORRECT, OUTPUT TO CHIPS EXTRACT FILE.
     C   43                MOVE '02'      MTIN
     C   43                GOTO OUTEXT
     C*
     C***IF*SWIFT INTERFACE EXISTS AND EVENT IS NOT A LOCAL CCY           E16345
     C****BANKERS AUTHORISATION, TEST SWIFT PRIORITY                      E16345
     C*  IF SWIFT OR TELEX & EVENT NOT A LOCAL CCY BANKERS                E16345
     C*  AUTHORISATION, CHECK SETTLEMENT INSTRUCTIONS, SET MTIN TO 01     E16345
     C           SWPRTY    TAG                             ** SWPRTY TAG *
     C***30N39***          EXSR PRIOR                                     E16345
     C***30N39***          EXSR SWADDR                              E16345ENY001
     C           ENXXXX    IFEQ 'Y'                                       E29588
     C   30N39             EXSR PRIFIX                                    E29588
     C                     ELSE                                           E29588
     C   30N39             EXSR SWADDR                                    E29588
     C                     END                                            E29588
     C*
     C*  IF THE RECORD BEING PROCESSED IS A REVERSAL OR AN AMENDMENT TO
     C*  A MESSAGE THAT WAS NOT TRANSMITTED VIA SWIFT DONT OUTPUT A
     C*  RECORD TO THE EXTRACT FILE.
     C*
     C           OUTEXT    TAG                             ** OUTEXT TAG *
      *                                                                   E29588
      ***********                                                  E29588 071538
      ***For*PAPER*report,*check*if*for*the*DEAMS*or*DEALS         E29588 071538
      ***transaction,*a*report*hasn't*already*been*produced        E29588 071538
      ***********                                                  E29588 071538
     C***********          MOVE *IN36     IN36    1                E29588 071538
     C***********          MOVE 'Y'       REP308  1                E29588 071538
     C***********MTIN      IFEQ '09'                               E29588 071538
      ***********                                                  E29588 071538
     C************IN12     IFEQ '1'                                E29588 071538
     C************IN13     OREQ '1'                                E29588 071538
     C***********          TESTB'6'       DAINDI         36        E29588 071538
     C***********          ELSE                                    E29588 071538
     C***********          TESTB'6'       TLXI           36        E29588 071538
     C***********          END                                     E29588 071538
      ***********                                                  E29588 071538
      ****A*report*has*already*been*produced,*hence*no*extract     E29588 071538
      ****should*be*generated*for*DL0308*(PREX1PH)                 E29588 071538
     C************IN36     IFEQ '1'                                E29588 071538
     C***********          MOVE 'N'       REP308                   E29588 071538
     C***********          END                                     E29588 071538
     C***********          END                                     E29588 071538
      ***********                                                         071538
      ***If*the*record*being*processed*is*a*reversal*or*an*amendment*to   071538
      ***a*message*that*was*not*transmitted*via*SWIFT*don't*output*a      071538
      ***record*to*the*extract*file.                                      071538
      ***********                                                  E29588 071538
     C***********MTIN      IFNE '01'                                      071538
     C************IN27     ANDEQ'1'                                       071538
      ***********                                                  E29588 071538
      ***IF*PAPER*and*DL0308*extract*required,*switch*on*BIT*6     E29588 071538
      ***of*TLXI*(DEALS)*or*DAINDI*(DEAMS)*to*stop*any*more*extractE29588 071538
      ***to*DL0308*for*this*transaction.                           E29588 071538
     C***********MTIN      IFEQ '09'                               E29588 071538
     C***********REP308    ANDEQ'Y'                                E29588 071538
     C************IN12     IFEQ '1'                                E29588 071538
     C************IN13     OREQ '1'                                E29588 071538
     C***********          BITON'6'       DAINDI                   E29588 071538
     C***********          EXCPTDAINB                              E29588 071538
     C***********          ELSE                                    E29588 071538
     C***********          BITON'6'       TLXI                     E29588 071538
     C***********          EXCPTTLXIB                              E29588 071538
     C***********          END                                     E29588 071538
     C***********          MOVE IN36      *IN36                    E29588 071538
      *                                                            E29588 071538
     C***********          ELSE                                    E29588 071538
     C***********          MOVE IN36      *IN36                    E29588 071538
     C***********          GOTO NOPREX                                    071538
     C***********          END                                     E29588 071538
     C***********          END                                            071538
      *                                                            E29588 071538
     C/COPY WNCPYSRC,DL1705C078
      *                                                                   095991
      *  If the record being processed is a reversal don't output a       095991
      *  record to the extract file (in effect ignores next block)        095991
      *                                                                   095991
     C           MTIN      IFNE '01'                                      095991
     C           RECIDL    ANDEQ'R'                                       095991
     C/COPY WNCPYSRC,DL1705C079
     C                     GOTO NOPREX                                    095991
     C                     END                                            095991
      *                                                                   095991
      *                                                                   E29588
     C           MTIN      IFEQ '01'                                      E20474
     C           RECIDL    ANDEQ'R'                                       E20474
     C                     SETON                     88                   E20474
     C                     END                                            E20474
      *
     C** Before outputting record, check for FRA deal type and set up     S01157
     C** PINDS indicators with value saved earlier.                       S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C                     MOVE @FRIND    PINDS                           S01157
     C                     END                                            S01157
      *                                                                   CIR003
      ** If CIR003 is intalled, check for Cross Currency Swap deals       CIR003
      ** and set up PINDS indicators with saved values before             CIR003
      ** output to PREXPH.                                                CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           DTYP      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
     C                     MOVE @FRIND    PINDS                           CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C                     MOVE WXVDT     VDATPH                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C/COPY WNCPYSRC,DL1705C008
     C*                                                                   S01157
     C*                                                                   S01177
     C** IF MESSAGE TO BE SENT VIA SWIFT                                  S01177
     C           MTIN      IFEQ '01'                       B1             S01177
     C           PAYREC    IFNE 'R'                        *1             S01177
     C*                                                                   S01177
     C** CHECK WHETHER BENEFICIARY IS A BANK                              S01177
     C                     MOVELBENN      CHK1    1        *1             S01177
     C*                                                                   S01177
     C** IF BENEFICIARY IS NUMERIC CHECK CLINT FOR DETAILS                S01177
     C           CHK1      IFGE '0'                        B*2            S01177
     C*****                MOVELCNUM      ZCLKEY           **2    S01177  S01194
     C*****N10                MOVELCNUM      ZCLKEY           **2 S01177  S01194
     C*****10                MOVELCNUMPH    ZCLKEY           **2  S01177  S01194
     C*****                MOVE 'A'       ZCLKEY           **2    S01177  S01194
     C*****                EXSR CLICHN                     **2    S01177  S01194
     C                     MOVE *BLANKS   @CLKEY                          114608
     C  N10                MOVELCNUM      @CLKEY           **2            S01194
     C   10                MOVELCNUMPH    @CLKEY           **2            S01194
0327 C* CALL ACCESS PROG. FOR CUSTOMER DETAILS.                           S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @CLKEY 10                       S01194
     C                     PARM           @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           @KYST     OREQ '*ERROR'                                  S01194
     C                     MOVEL'SDCUSTPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'014'     DBASE   3        * DBERR 014 *  S01194
     C                     MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL@CLKEY    DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
2172 C                     END                                            S01194
     C*                                                                   S01177
     C*****      *IN99     IFEQ '1'                        B**3   S01177  S01194
     C*****                SETON                     LRU785***3   S01177  S01194
     C*****                END                             E**3   S01177  S01194
     C*****                TESTB'0'       CMIN           36**2            S01177
     C           BBPAIN    IFEQ 'P'                        B*3            S01194
     C                     SETON                     36    **2            S01194
     C                     END                             E*3            S01194
     C*                                                                   S01177
     C** OTHERWISE BENEFICIARY IS A COUNTERPARTY NOSTRO AND MUST          S01177
     C** THEREFORE BE A BANK                                              S01177
     C                     ELSE                            X*2            S01177
     C                     SETON                     36    **2            S01177
     C                     END                             E*2            S01177
     C*                                                                   S01177
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CP26                                           S01408
     C*                                                                   S01408
     C** IF BENEFICIARY IS A BANK 'CNUMPH' IS ORDERING BANK OTHERWISE     S01177
     C** ORDERING CUSTOMER                                                S01177
     C           *IN15     IFEQ *OFF                                      081947
     C           CSW005    OREQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       172477
     C           DTYP      ANDEQ'FR'                                      172477
     C********** POBN      IFEQ 0                          B*2                         S01177 CSD027
     C********** POCN      ANDEQ0                          **2                         S01177 CSD027
     C           POBN      IFEQ *BLANKS                    B*2                                CSD027
     C           POCN      ANDEQ*BLANKS                    **2                                CSD027
     C                     MOVELCNUM      CNUMPH           **2            S01177
     C                     ELSE                            X*2            S01177
     C********** POBN      IFNE 0                          B**3           S01177       S01177 CSD027
     C           POBN      IFNE *BLANKS                    B**3                               CSD027
     C                     MOVELPOBN      CNUMPH           ***3           S01177
     C                     ELSE                            X**3           S01177
     C                     MOVELPOCN      CNUMPH           ***3           S01177
     C                     END                             E**3           S01177
     C                     END                             E*2            S01177
     C                     END                                            081947
     C                     END                             E1             S01177
     C                     SETOF                     36                   S01177
      * NOTE THAT *IN36 IS NOT USED IN THIS PROGRAM FOR ANYTHING !!       S01117
      *                                                                   S01117
     C*                                                                   S01177
     C           PAYREC    IFEQ 'R'                        B1             S01177
     C           *IN15     IFEQ *OFF                                      081947
     C           CSW005    OREQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       172477
     C           DTYP      ANDEQ'FR'                                      172477
     C********** ROBN      IFEQ 0                          B*2                         S01177 CSD027
     C********** ROCN      ANDEQ0                          **2                         S01177 CSD027
     C           ROBN      IFEQ *BLANKS                    B*2                                CSD027
     C           ROCN      ANDEQ*BLANKS                    **2                                CSD027
     C                     MOVELCNUM      CNUMPH           **2            S01177
     C                     ELSE                            X*2            S01177
     C********** ROBN      IFNE 0                          B**3                        S01177 CSD027
     C           ROBN      IFNE *BLANKS                    B**3                               CSD027
     C                     MOVELROBN      CNUMPH           ***3           S01177
     C                     ELSE                            X**3           S01177
     C                     MOVELROCN      CNUMPH           ***3           S01177
     C                     END                             E**3           S01177
     C                     END                             E*2            S01177
     C                     END                                            081947
     C                     END                             E1             S01177
     C*                                                                   S01177
     C** IF MT202 PART OF MT100 / SUPPLEMENTARY MT202 MESSAGE BEING       S01177
     C** PRODUCED SET UP DETAILS AS BELOW                                 S01177
     C                     MOVE *BLANKS   CVMI                            E22405
     C           MT202     TAG                                            S01177
     C           MTIN      IFEQ '01'                       B1             S01177
     C*                                                                   E22405
     C** IF COVER MESSAGE REQUIRED INDICATOR SET TO 'N' THEN THIS COVER   E22405
     C** SHOULDN'T BE EXTRACTED                                           E22405
     C           CVMI      IFEQ 'P'                                       E22405
     C           RVNO      ANDNE*BLANK                                    E22405
     C           PAYREC    ANDNE'R'                                       E22405
     C           CVMR      ANDNE'Y'                                       E22405
     C                     GOTO NOPREX                                    E22405
     C                     END                                            E22405
     C*                                                                   E22405
     C           CVMI      IFEQ 'P'                        B*2            S01177
     C           RVNO      ANDNE*BLANK                     **2            S01177
     C           PAYREC    ANDNE'R'                        **2            S01177
     C           CVMR      ANDEQ'Y'                        **2            E22405
     C                     MOVE *BLANKS   OTFACO           **2            S01177
     C                     MOVE *BLANKS   THRAG            **2            S01177
     C                     MOVELRVNO      OTFACO           **2            S01177
     C                     MOVELRCRN      THRAG            **2            S01177
     C*****                MOVE *BLANKS   OURAG            **2            S01177
     C*****                MOVELPONS      OURAG            **2            S01177
     C** If PONS is 6 numeric its a customer number, if chars 3 - 6       S01177
     C** are blank it is a 2 digit nostro code                            S01177
     C                     MOVELPONS      CUSTST           **2            S01177
     C*                                                                   S01177
     C           CUSTS2    IFNE *BLANKS                    B**3           S01177
     C** PONS is cust no so set up OURAG as cust no followed by blanks    S01177
     C                     MOVE *BLANKS   OURAG            ***3           S01177
     C                     MOVELCUSTST    OURAG            ***3           S01177
     C*                                                                   S01177
     C                     ELSE                            X**3           S01177
     C** Access SDNOSTPD with PONS & currency as key to get cust no.      S01177
     C*                                                                   S01177
     C                     MOVE CURREN    @KEYB            ***3           S01177
     C                     MOVELPONS      @KEYE            ***3           S01177
      *                                                                   S01177
     C                     CALL 'AONOSTR0'                 ***3           S01177
     C                     PARM *BLANK    @RTCD   7        ***3           S01177
     C                     PARM '*KEY   ' @OPTN   7        ***3           S01177
     C                     PARM *BLANK    @KEYA   6        ***3           S01177
     C                     PARM           @KEYB   3        ***3           S01177
     C**********           PARM *BLANK    @KEYC   4        ***3                        S01177 CGL029
     C                     PARM *BLANK    @KEYC                                               CGL029
     C                     PARM *BLANK    @KEYD   2        ***3           S01177
     C                     PARM           @KEYE   2        ***3           S01177
     C                     PARM *BLANKS   @KEYG                           S01194
     C                     PARM *BLANKS   @KEYH                           S01194
     C                     PARM *BLANKS   @KEYI                           S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01177
     C** DB error on call to AONOSTR0 or                                  S01177
     C** DB error if no customer number found for this currency/nostro    S01177
     C           @RTCD     IFNE *BLANK                     B***4          S01177
     C                     MOVEL'SDNOSTPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'015'     DBASE   3        * DBERR 015 *  S01194
     C                     MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL@KEYB     DBKEY  29        ****4          S01194
     C                     MOVE @KEYE     DBKEY            ****4          S01194
     C                     SETON                     U7U8LR****4          S01177
     C                     EXSR *PSSR                      ****4          S01194
     C                     END                             E***4          S01177
     C*                                                                   S01177
     C** Set up OURAG as CUST NO/____/NOSTRO CODE                         S01177
     C                     MOVE *BLANKS   OURAG            ***3           S01177
     C                     MOVE @KEYE     OURAG            ***3           S01177
     C                     MOVELA7CUST    OURAG            ***3           S01177
     C                     END                             E**3           S01177
     C*                                                                   S01177
     C*                                                                   S01177
     C                     MOVE 'S'       CVMI             **2            S01177
     C                     EXSR HASH                       **2            S01177
     C                     END                             E*2            S01177
     C                     END                             E1             S01177
     C*                                                                   S01177
     C** IF MT100 PART OF MT100 / SUPPLEMENTARY MT202 MESSAGE BEING       S01177
     C** PRODUCED SET UP DETAILS AS BELOW                                 S01177
     C           CVMI      IFEQ ' '                        B*2            S01177
     C           RVNO      ANDNE*BLANKS                    **2            S01177
     C           PAYREC    ANDNE'R'                        **2            S01177
     C                     MOVE *BLANKS   OURAG            **2            S01177
     C                     MOVELRVNO      OURAG            **2            S01177
     C                     MOVE 'P'       CVMI             **2            S01177
     C*                                                                   E22600
     C** Set up Field 53                                                  E22600
     C                     MOVEL*BLANKS   CUSTST                          E22600
     C                     MOVELPONS      CUSTST                          E22600
     C                     MOVE *BLANKS   SDRN                            E22600
     C*                                                                   E22600
     C           CUSTS2    IFNE *BLANKS                                   E22600
     C** PONS is cust no so set up SDRN as cust no followed by blanks     E22600
     C                     MOVELCUSTST    SDRN                            E22600
     C*                                                                   E22600
     C                     ELSE                                           E22600
     C** Access SDNOSTPD with PONS & currency as key to get cust no.      E22600
     C*                                                                   E22600
     C*********************MOVE *BLANKS   RTCD    7                 E22600S01314
     C                     MOVEL'*MSG   ' RTCD    7                       S01314
     C                     MOVEL'*KEY'    OPTN    7                       E22600
     C                     MOVE *BLANKS   KEYA    6                       E22600
     C                     MOVE CURREN    KEYB    3                       E22600
     C**********           MOVE *BLANKS   KEYC    4                                    E22600 CGL029
     C                     MOVE *BLANKS   KEYC   10                                           CGL029
     C                     MOVE *BLANKS   KEYD    2                       E22600
     C                     MOVELPONS      KEYE    2                       E22600
      *                                                                   E22600
     C                     CALL 'AONOSTR0'             90                 E22600
     C                     PARM           RTCD                            E22600
     C                     PARM           OPTN                            E22600
     C                     PARM           KEYA                            E22600
     C                     PARM           KEYB                            E22600
     C                     PARM           KEYC                            E22600
     C                     PARM           KEYD                            E22600
     C                     PARM           KEYE                            E22600
     C                     PARM *BLANKS   @KEYG   3                       DT0089
     C                     PARM *BLANKS   @KEYH  10                       DT0089
     C                     PARM *BLANKS   @KEYI   1                       DT0089
     C           SDNOST    PARM SDNOST    DSFDY                           E22600
     C*                                                                   E22600
     C** DB error on call to AONOSTR0                                     E22600
     C           *IN90     IFEQ '1'                                       E22600
     C*********************SETON                     U7LR           E22600S01314
     C*********************ELSE                                     E22600S01314
     C*                                                                   E22600
     C** DB error if no customer number found for this currency/nostro    E22600
     C***********RTCD      IFNE *BLANKS                             E22600S01314
     C           RTCD      ORNE *BLANKS                                   S01314
     C*********************SETON                     U7LR91         E22600S01314
     C                     SETON                     U7U8LR               S01314
     C                     EXSR *PSSR                                     S01314
     C                     GOTO END                                       S01314
     C*********************END                                      E22600S01314
     C*********************END                                      E22600S01314
     C                     ELSE                                     E22600S01314
     C                     MOVELA7CUST    SDRN                            E22600
     C                     END                                      E22600S01314
     C                     END                                            E22600
     C*                                                                   E22600
     C                     END                             E*2            S01177
     C                     END                             E1             S01177
     C*
     C** Before outputting record, check for FRA deal type and set up     S01157
     C** PINDS indicators with value saved earlier.                       S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C                     MOVE @FRIND    PINDS                           S01157
     C                     END                                            S01157
      *                                                                   CIR003
      ** If CIR003 is intalled, check for Cross Currency Swap deals       CIR003
      ** and set up PINDS indicators with saved values before             CIR003
      ** output to PREXPH.                                                CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           DTYP      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
     C                     MOVE @FRIND    PINDS                           CIR003
     C           CNRQ      IFEQ 'Y'                                       CIR003
     C           CNRQ      OREQ 'N'                                       CIR003
     C                     MOVE WXVDT     VDATPH                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C/COPY WNCPYSRC,DL1705C009
     C*                                                                   S01157
     C*                                                                   E22600
     C** Determine the vlaues for fields 53/54 for payment messages       E22600
     C** to be placed on PREX.                                            E22600
     C*                                                                   E22600
     C           CVMI      IFNE 'P'                                       E22600
     C                     MOVE *BLANKS   SDRN                            E22600
     C                     END                                            E22600
     C*                                                                   E22600
     C                     MOVE *BLANKS   POBK                            E22600
     C                     MOVE *BLANKS   RCRD                            E22600
     C*                                                                   E22600
     C/COPY WNCPYSRC,DL1705C014
     C           PAYREC    IFNE 'R'                                       E22600
     C           DTYP      ANDNE'NX'                                      E22600
     C/COPY WNCPYSRC,DL1705C093
     C                     MOVE *BLANKS   POBK                            E22600
     C                     MOVE *BLANKS   RCRD                            E22600
     C* Field 52                                                          E22600
     C********** POBN      IFNE 0                                                      E22600 CSD027
     C           POBN      IFNE *BLANKS                                                       CSD027
     C                     MOVELPOBN      POBK                            E22600
     C                     END                                            E22600
     C* Field 54                                                          E22600
     C           CVMI      IFNE 'S'                                       E22600
     C           RCRN      ANDNE*BLANKS                                   E22600
     C                     MOVELRCRN      RCRD                            E22600
     C                     END                                            E22600
     C*                                                                   E22600
     C                     END                                            E22600
     C/COPY WNCPYSRC,DL1705CCP9                                           S01408
     C*                                                                   E22600
      * Initialise Original Transaction fields.                           CEU003
      *                                                                   CEU003
     C                     Z-ADD0         OTRA                            CEU003
     C                     MOVE *BLANKS   OTRC                            CEU003
      *                                                                   CEU003
      * If settlement currency defined, set up EAMT in settlement ccy     CEU003
      * and set up fields OTRA, OTRC.                                     CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
      *                                                                   148322
      ** For cover MT202, EAMT is already in settle currency so bypass.   148322
      *                                                                   148322
     C           CVMI      IFNE 'S'                                       148322
     C                     EXSR AMNTEU                                    CEU003
     C                     ENDIF                                          148322
     C                     ENDIF                                          CEU003
      *                                                                   CEU003
     C                     SETON                     34
     C/COPY WNCPYSRC,DL1705C095
     C                     EXCPT
     C/COPY WNCPYSRC,DL1705C096
     C*                                                                   E28766
     C           CVMR      IFEQ *BLANKS                                   E28766
     C           CVMR      OREQ 'N'                                       E28766
     C           MTIN      ORNE '01'                                      E28766
     C                     MOVEL*BLANKS   CVMI                            E28766
     C                     END                                            E28766
     C*                                                                   E28766
     C** IF PRIMARY PART OF MT100 / MT202 MESSAGE COMBINATION SENT        S01177
     C** BRANCH TO TAG MT202 TO SET UP SECOND PART OF MULTIPLE MESSAGE    S01177
     C           CVMI      CABEQ'P'       MT202                           S01177
     C                     MOVE *BLANKS   CVMI                            S01177
     C                     SETOF                     88                   E20474
     C* RESET O/P INDS.
     C           NOPREX    TAG                             ** NOPREX TAG *
     C                     SETOF                     313233
     C                     ENDSR
     C********************************************************************
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL1705CP27                                           S01408
     C*                                                                   S01408
     C/EJECT
     C* O U T P U T   R O U T I N E S
     C/SPACE 2
     C********************************************************************
     C*
     C           OPREX1    BEGSR                           *** OPREX1 ***
     C*********************MOVE '09'      MTIN                            S01310
     C           ENXXXX    IFNE 'Y'                                       E29588
     C                     MOVE '01'      MTIN                            S01310
     C                     ELSE                                           E29588
     C                     MOVE '09'      MTIN                            E29588
     C                     END                                            E29588
     C                     Z-ADD1         X       10
     C******************   SETON                     51                   S01117
     C******************   SETON                     58                   E107
     C                     SETOF                     34
     C                     EXSR OUTPUT
     C******************   SETOF                     51                   S01117
     C   34                EXSR HASH
     C                     SETOF                     34
     C                     ENDSR
     C********************************************************************
     C/SPACE 2
     C********************************************************************
     C*
     C           OPREX2    BEGSR                           *** OPREX2 ***
     C                     MOVE '10'      MTIN
     C                     Z-ADD2         X
     C******************   SETON                     58                   E107
     C                     SETOF                     34
     C                     EXSR OUTPUT
     C   34                EXSR HASH
     C                     SETOF                     34
     C                     ENDSR
     C********************************************************************
     C/SPACE 2
     C********************************************************************
     C*
     C           OPREX3    BEGSR                           *** OPREX3 ***
     C                     MOVE '11'      MTIN
     C                     Z-ADD3         X
     C                     SETOF                     34
     C                     EXSR OUTPUT
     C   34                EXSR HASH
     C                     SETOF                     34
     C                     ENDSR
     C********************************************************************
     C/SPACE 2
     C********************************************************************
     C*
     C           OPREX4    BEGSR                           *** OPREX4 ***
     C                     MOVE '12'      MTIN
     C                     Z-ADD4         X
     C                     SETON                     54
     C                     SETOF                     34
     C                     EXSR OUTPUT
     C                     SETOF                     54
     C   34                EXSR HASH
     C                     SETOF                     34
     C                     ENDSR
     C*****************************************************************   E16345
     C*****                                                       *****   E16345
     C*****SUBROUTINE TO FIND MESSAGE TYPE PRIORITY               *****   E16345
     C*****                                                       *****   E16345
     C*****      PRIOR     BEGSR                                  *****   E16345
     C*****                                                       *****   E16345
     C*****                Z-ADD0         P       10              *****   E16345
     C*****      LOOP1A    TAG                                    *****   E16345
     C*****      P         ADD  1         P                       *****   E16345
     C*****      P         COMP 9                    78  78       *****   E16345
     C***78                SETON                     82           *****   E16345
     C***78                GOTO SWIFT                             *****   E16345
     C*****                Z-ADD1         N       10              *****   E16345
     C*****      LOOP2A    TAG                                    *****   E16345
     C*****      PR,N      COMP P                        79       *****   E16345
     C***79                GOTO PRI                               *****   E16345
     C*****      N         ADD  1         N                       *****   E16345
     C*****      N         COMP 9                    78  78       *****   E16345
     C***78                GOTO LOOP1A                            *****   E16345
     C*****                GOTO LOOP2A                            *****   E16345
     C*****                                                       *****   E16345
     C*****      PRI       TAG                                    *****   E16345
     C*****TELEX                                                  *****   E16345
     C*****      N         COMP 4                        81       *****   E16345
     C***81 58             GOTO PREND                             *****   E16345
     C***81                GOTO LOOP1A                            *****   E16345
     C*****                                                       *****   E16345
     C*****SWIFT                                                  *****   E16345
     C*****      N         COMP 1                        82       *****   E16345
     C*****      SWIFT     TAG                                    *****   E16345
     C***82                EXSR SWADDR                            *****   E16345
     C***82 80             MOVE '01'      MTIN                    *****   E16345
     C***N82                GOTO LOOP1A                           *****   E16345
     C*****      PREND     TAG                                    *****   E16345
     C*****                ENDSR                                  *****   E16345
     C********************************************************************ENY001
     C           PRIFIX    BEGSR                                          ENY001
     C*    IS THE SETTLEMENT THROUGH SWIFT                                ENY001
     C           SETTLE    COMP 08                       78               ENY001
     C  N78                GOTO FIREND                                    ENY001
     C*    OUTPUT TO SWIFT IF SWIFT ADDRESS EXISTS                        ENY001
     C                     EXSR SWADDR                                    ENY001
     C   80                MOVE '01'      MTIN                            ENY001
     C           FIREND    ENDSR                                          ENY001
     C********************************************************************
     C*
     C*****SWADDR - SUBROUTINE TO CHECK IF SWIFT ADDRESS EXISTS           E16345
     C*    SWADDR - SUBROUTINE TO CHECK SETTLEMENT INSTRUCTIONS           E16345
     C*
     C           SWADDR    BEGSR
     C*
     C                     SETOF                     80
      *                                                                   E107
      * IF SETTLEMENT ACCOUNT IS NON BLANK IT MAY BE A NOSTRO             S01194
      * CUSTOMER NUMBER OR CUSTOMER SHORTNAME OR A RETAIL ACCOUNT         S01194
      * NUMBER                                                            S01194
      *                                                                   S01194
      **  CHECK FOR EMPTY FIELD                                           S01194
     C           OURAG     CABEQ*BLANKS   SAEND                           S01194
      *                                                                   S01194
      ** CHECK FOR 2 DIGIT NOSTRO CODE                                    S01194
     C**********           MOVE OURAG     CHK10  10                                    S01194 CGL029
     C                     MOVE OURAG     CHK10  16                                           CGL029
     C           CHK10     IFEQ *BLANKS                                   S01194
     C                     MOVELOURAG     @KEYE                           S01194
      *                                                                   S01194
     C* CALL ACCESS PROG. FOR NOSTRO DETAILS                              S01194
     C                     CALL 'AONOSTR0'                                S01194
     C/COPY WNCPYSRC,DL1705C088
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C/COPY WNCPYSRC,DL1705C089
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM *BLANKS   @KEYA   6                       S01194
     C                     PARM CURREN    @KEYB   3                       S01194
     C**********           PARM *BLANKS   @KEYC   4                                    S01194 CGL029
     C                     PARM *BLANKS   @KEYC                                               CGL029
     C                     PARM *BLANKS   @KEYD   2                       S01194
     C                     PARM           @KEYE   2                       S01194
     C                     PARM *BLANKS   @KEYG                           S01194
     C                     PARM *BLANKS   @KEYH                           S01194
     C                     PARM *BLANKS   @KEYI                           S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
      *                                                                   S01194
      * IF DATABASE ERROR ACCESS PROGRAM RETAINS CONTROL OF PROCESSING    S01194
      *                                                                   S01194
     C/COPY WNCPYSRC,DL1705C090
      * IF NOSTRO NOT FOUND SKIP TO END OF SUBROUTINE                     S01194
     C           @RTCD     CABNE*BLANK    SAEND                           S01194
      *                                                                   S01194
      * MOVE NOSTRO CUSTOMER NUMBER TO KEY FOR AOCUSTR0                   S01194
     C                     MOVELA7CUST    @KEYF                           S01194
      *
      * IF NOT A NOSTRO 2 DIGIT CODE SET UP KEY FOR AOCUSTR0
     C                     ELSE
     C                     MOVELOURAG     @KEYF
      *
     C                     END
      *                                                                   S01194
      * NOW THE DETAILS MAY BE CUST NO. OR SHORTNAME                      S01194
      * ACCESS PROGRAM WORKS FOR BOTH                                     S01194
      *                                                                   S01194
     C* CALL ACCESS PROG. FOR CUSTOMER DETAILS.                           S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEYF  10                       S01194
     C                     PARM           @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
      *                                                                   S01194
      * IF DATABASE ERROR ACCESS PROGRAM RETAINS CONTROL OF PROCESSING    S01194
      *                                                                   S01194
      *  IF RECORD FOUND CHECK SW ID AND SW MSG FORMAT FLAGS              S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C/COPY WNCPYSRC,DL1705C024
     C           BBCSID    COMP *BLANKS              8080                 S01194
     C           BBGSFM    COMP 'Y'                      80               S01194
     C/COPY WNCPYSRC,DL1705C025
      *                                                                   S01194
     C           CSW218    IFEQ 'N'                                                           CSW218
      *                                                                                       CSW218
      **   IF SWIFT ADDRESS BIC CODE DO NOT OUTPUT                        S01167
     C                     MOVE BBCSID    CSBIC   4                       S01194
     C                     MOVE *BLANKS   USCSID                          CSW096
     C                     MOVE BBCSID    USCSID                          CSW096
     C           BBGSFM    IFEQ 'Y'                                       S01194
     C           CSBIC     ANDEQ'BIC '                                    S01167
     C           SETP      ANDEQ08                                        S01167
     C           BBTXA1    ANDEQ*BLANKS                                   E19772
     C           BBSTAD    ANDEQ*BLANKS                                   E19772
     C           CSW096    ANDEQ'N'                                       CSW096
     C           BBGSFM    OREQ 'Y'                                       CSW096
     C           USID      ANDEQ'1'                                       CSW096
     C           SETP      ANDEQ08                                        CSW096
     C           BBTXA1    ANDEQ*BLANKS                                   CSW096
     C           BBSTAD    ANDEQ*BLANKS                                   CSW096
     C           CSW096    ANDEQ'Y'                                       CSW096
     C                     SETOF                     80                   S01167
     C                     END                                            S01194
      *                                                                                       CSW218
     C                     ELSE                                                               CSW218
      ** Check if SWIFT address is connected to SWIFTNet FIN when CSW218 is ON                CSW218
     C                     MOVEL*BLANKS   WSID19  1                                           CSW218
     C           BBCSID    IFNE *BLANKS                                                       CSW218
     C                     MOVELBBCSID    WBICC   8                                           CSW218
     C           3         SUBSTBBCSID:9  WBICB   3                                           CSW218
     C           WBICB     IFEQ *BLANKS                                                       CSW218
     C                     MOVEL'XXX'     WBICB                                               CSW218
     C                     ENDIF                                                              CSW218
     C           KBICD     CHAINMEBICDL2             20                                       CSW218
     C           *IN20     IFEQ '0'                                                           CSW218
     C           1         SUBSTBDXINF:19 WSID19                                              CSW218
      *                                                                                       CSW218
      ** BIC address indicates not connected if the                                           CSW218
      ** Extra Information field position 19 is set to 'N'                                    CSW218
     C           WSID19    IFEQ 'N'                                                           CSW218
     C           BBGSFM    ANDEQ'Y'                                                           CSW218
     C           SETP      ANDEQ08                                                            CSW218
     C           BBTXA1    ANDEQ*BLANKS                                                       CSW218
     C           BBSTAD    ANDEQ*BLANKS                                                       CSW218
     C                     SETOF                     80                                       CSW218
     C                     ENDIF                                                              CSW218
     C                     ENDIF                                                              CSW218
     C                     ENDIF                                                              CSW218
     C                     ENDIF                                                              CSW218
      *                                                                                       CSW218
     C                     END                                            S01167
     C/COPY WNCPYSRC,DL1705C060
      *                                                                   S01194
      * SET UP FIELDS FOR RETURN FROM SUBROUTINE IF *IN80 SET ON          S01194
      * NOSTRO RIGHT ALIGNED AND CUSTOMER NUMBER LEFT ALIGNED             S01194
     C           *IN80     IFEQ '1'                                       S01194
     C                     MOVE '01'      MTIN                            E16345
     C                     MOVE *BLANKS   OURAG                           S01194
     C                     MOVE A7NONB    OURAG                           S01194
     C                     MOVELBBCUST    OURAG                           S01194
     C                     END
      *                                                                   S01194
     C           SAEND     ENDSR
      *                                                                   S01194
      *                                                                   S01194
     C**********           MOVE '  '      CHK2                            E11668
     C***********OURAG     COMP ' '                      86               S01194
     C***86******          GOTO SAEND                                     S01194
     C********                                                            S01194
     C*****CHECK WHETHER FIELD CONTENTS ARE ALPHAMERIC OR NUMERIC         S01194
     C********                                                            S01194
     C********             MOVELOURAG     CHK1    1                       S01194
     C********   CHK1      COMP '0'                    90                 S01194
     C***90***             GOTO ALPHA                                     S01194
     C********                                                            S01194
     C*****CONTENTS ARE NUMERIC - CHECK IF NOSTRO,CUSTOMER NUMBER,        S01194
     C*****ACCOUNT NUMBER OR RETAIL ACCOUNT NUMBER                        S01194
     C*********                                                           S01194
     C*********            MOVE OURAG     CHK10  10                       S01194
     C*********  CHK10     COMP ' '                      90               S01194
     C**N90****            MOVELOURAG     ZCLKEY  7                       S01194
     C**N90**              GOTO QCUST                                     S01194
     C********                                                            S01194
     C*****NOSTRO                                                         S01194
     C********                                                            S01194
     C********             MOVELOURAG     CHK2    2                       S01194
     C********             MOVELCURREN    CHK5    5               *****   S01194
     C*****                MOVE CHK2      CHK5                    *****   S01194
2147 C*****                MOVELCURREN    CHK5    5               *****   S01194
2148 C*****                MOVE CHK2      CHK5                    *****   S01194
2149 C*****                MOVE CHK5      ZTABKY                  *****   S01194
2150 C*****                MOVEL'70'      ZTABKY                  *****   S01194
2151 C*****                EXSR TABCHN                            *****   S01194
0327 C*******                                                             S01194
0327 C**CALL ACCESS PROG. FOR NOSTRO DETAILS                              S01194
     C********             CALL 'AONOSTR0'                                S01194
     C********             PARM '*MSG   ' @RTCD   7                       S01194
     C********             PARM '*KEY   ' @OPTN   7                       S01194
     C********             PARM *BLANKS   @KEYA   6                       S01194
     C********             PARM CURREN    @KEYB   3                       S01194
     C********             PARM *BLANKS   @KEYC   4                       S01194
     C********             PARM *BLANKS   @KEYD   2                       S01194
     C********             PARM CHK2      @KEYE   2                       S01194
     C******               PARM *BLANKS   @KEYG                           S01194
     C******               PARM *BLANKS   @KEYH                           S01194
     C******               PARM *BLANKS   @KEYI                           S01194
     C********             PARM           SDNOST                          S01194
0327 C********                                                            S01194
1864 C********   @RTCD     IFNE *BLANK                                    S01194
     C********             MOVEL'SDNOSTPD'DBFILE 10        * * * * * * *  S01194
     C********             MOVEL'016'     DBASE   3        * DBERR 016 *  S01194
     C********             MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C********             MOVEL@KEYB     DBKEY  29                       S01194
     C********             MOVEL@KEYE     DBKEY                           S01194
0349 C********             SETON                     U7U8LR               S01194
0349 C********             EXSR *PSSR                                     S01194
2172 C********             GOTO SAEND                                     S01194
0327 C********                                                            S01194
     C********             ELSE                                           S01194
2154 C********             MOVELA7AENB    @CLKEY                          S01194
     C********             GOTO QCUST                                     S01194
0349 C********             END                                            S01194
0327 C********                                                            S01194
1864 C***99**              SETON                     83           *****   S01194
1865 C***99**              GOTO SAEND                             *****   S01194
0327 C********                                                            S01194
2154 C*****                MOVELCNUMTL    ZCLKEY                  *****   S01194
     C*****                GOTO QCUST                             *****   S01194
     C********                                                            S01194
     C*****CONTENTS ARE ALPHAMERIC                                        S01194
     C********                                                            S01194
2159 C********   ALPHA     TAG                                            S01194
2154 C********             MOVELOURAG     @CLKEY                          S01194
2160 C********             MOVELOURAG     CHK10  10               *****   S01194
2161 C*****      CHK10     CHAINSNAME                99           *****   S01194
2162 C***99                SETON                     84           *****   S01194
2163 C***99                GOTO SAEND                             *****   S01194
2164 C*****                MOVELCNUMCD    ZCLKEY                  *****   S01194
2165 C******                                                              S01194
2166 C*****CUSTOMER NUMBER                                                S01194
2167 C*******                                                             S01194
2168 C*******    QCUST     TAG                                            S01194
2169 C*****                MOVE 'A'       ZCLKEY                          S01117
2170 C*****                EXSR CLICHN                            *****   S01194
0327 C**CALL*ACCESS PROG. FOR CUSTOMER DETAILS.                           S01194
     C********             CALL 'AOCUSTR0'                                S01194
     C********             PARM '*MSG   ' @RTCD   7                       S01194
     C********             PARM '*KEY   ' @OPTN   7                       S01194
     C********             PARM           @CLKEY 10                       S01194
     C********             PARM           @KYST   7                       S01194
     C********             PARM           SDCUST                          S01194
     C********   @RTCD     IFNE *BLANK                                    S01194
     C********   @KYST     OREQ '*ERROR'                                  S01194
     C********             MOVEL'SDCUSTPD'DBFILE 10        * * * * * * *  S01194
     C********             MOVEL'017'     DBASE   3        * DBERR 017 *  S01194
     C********             MOVEL'*KEY   ' DBOPTN  7        * * * * * * *  S01194
     C********             MOVEL@CLKEY    DBKEY  29                       S01194
0349 C********             SETON                     U7U8LR               S01194
0349 C********             EXSR *PSSR                                     S01194
2172 C********             GOTO SAEND                                     S01194
2172 C********             END                                            S01194
2171 C***99**              SETON                     85           *****   S01194
2172 C***99**              GOTO SAEND                             *****   S01194
2173 C*****      CSID      COMP ' '                  8080         *****   S01194
2173 C*******    BBBYTX    COMP ' '                  8080                 S01194
     C****       CSID      COMP ' '                  8080                 S01144
     C*****      GSFM      COMP 'Y'                      80       E11666  S01194
     C*******    BBM1ST    COMP 'Y'                      80               S01194
     C*******                                                             S01167
     C**   IF SWIFT ADDRESS BIC CODE DO NOT OUTPUT                        S01167
     C***                                                                 S01167
     C*****                MOVE CSID      CSBIC   4              S01167   S01194
     C********             MOVE BBBYTX    CSBIC   4                       S01194
     C*****      GSFM      IFEQ 'Y'                               S01167  S01194
     C********   BBM1ST    IFEQ 'Y'                                       S01194
     C********   CSBIC     ANDEQ'BIC '                                    S01167
     C********   SETP      ANDEQ08                                        S01167
     C********             SETOF                     80                   S01167
     C********             END                                            S01167
     C********                                                            S01194
     C***80                MOVELZCLKEY    OURAG                           S01194
     C***80                MOVEL@CLKEY    OURAG                           S01194
     C***80                MOVE BLNK6     OURAG                           S01194
     C***80                MOVE CHK2      OURAG                           E11668
     C***80                MOVE '01'      MTIN                            E16345
     C*********                                                           S01194
     C********   SAEND     TAG                                            S01194
     C***99***             SETON                     U7LR                 S01194
     C********             ENDSR                                          S01194
     C*
     C********************************************************************
     C********************************************************************
     C/EJECT
2184 C*****************************************************************   S01194
2185 C*****                                                       *****   S01194
2186 C*****      TABCHN    BEGSR                           *** TABCHN**   S01194
2187 C*****                SETOF                     99           *****   S01194
2188 C*****      ZTABKY    CHAINTABLE                41           *****   S01194
2189 C***41                SETON                     99           *****   S01194
2190 C**N41      RECI      COMP 'D'                  9999         *****   S01194
2191 C*****                ENDSR                                  *****   S01194
2192 C*****************************************************************   S01194
2193 C*****                                                       *****   S01194
2194 C*****CLICHN SR. TO RANDOM ACCESS CLIENT FILE.               *****   S01194
219  C*****                                                       *****   S01194
2196 C*****      CLICHN    BEGSR                           *** CLICHN**   S01194
2197 C*****                                                       *****   S01194
2198 C*****                                                       *****   S01194
2199 C*****RANDOM ACCESS CLIENT FILE BY KEY.                      *****   S01194
2200 C*****      ZCLKEY    CHAINCLINT                99    ON NOT THERE   S01194
2201 C**N99      RECI      COMP 'D'                  9999  ON IF INACTIVE S01194
2202 C*****                                                       *****   S01194
2203 C*****                ENDSR                                  *****   S01194
2204 C*****                                                       *****   S01194
2205 C*****************************************************************   S01194
     C/SPACE 3
     C********************************************************************
     C*
     C           HASH      BEGSR                           ***  HASH  ***
     C                     Z-ADDINT       ZZTOTI
     C                     Z-ADDDEC       ZZTOTD
     C           EAMT      DIV  1000      ZZAMT
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    INT    150
     C                     Z-ADDZZTOTD    DEC     30
     C*
     C           ROP       ADD  1         ROP
     C                     ENDSR
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     CSR         GLZADD    BEGSR                           *** GLZADD ****
     C*
     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     CSR                   EXSR GLZSUM
     CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     CSR         GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     CSR                   SETOF                     919293
     CSR                   SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     CSR         ZZAMTI    COMP 0                      9293
     CSR 93      ZZAMTD    COMP 0                      9293
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     CSR         ZZTOTI    COMP 0                      9193
     CSR 93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     CSR 93                Z-ADDZZAMTI    ZZTOTI
     CSR 93                Z-ADDZZAMTD    ZZTOTD
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     CSR 91N92
     CORN91 92             GOTO ZZOFPS
     C*
     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     CSRN99                Z-ADDZZWK2     ZZTOTD
     CSRN99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     CSR 99                Z-ADD0         ZZAMT  153
     CSR                   GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     CSR 91                Z-SUBZZTOTI    ZZTOTI
     CSR 91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     CSR         ZZTOTI    COMP ZZAMTI               93  95
     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     CSR 95                Z-ADD0         ZZTOTI
     CSR 95                Z-ADD0         ZZTOTD
     CSR 95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     CSR 93      ZZAMTD    COMP ZZTOTD               94
     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     CSRN93      ZZTOTD    COMP ZZAMTD               94
     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     CSR                   SETOF                     94
     CSR 93 91
     CORN93 92             SETON                     94
     CSR 94                Z-SUBZZTOTI    ZZTOTI
     CSR 94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     CSR 92                Z-SUBZZAMTI    ZZAMTI
     CSR 92                Z-SUBZZAMTD    ZZAMTD
     CSR         ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     CSR                   SETOF                     96
     CSR         ZZTOTD    COMP 0                        91
     CSR 91      ZZTOTI    COMP 0                      96
     CSR 96                MOVE '.000-'   ZZNEGD  5
     CSR                   ENDSR                             ** ENDSR **
     C********************************************************************CEU003
     C/SPACE 3                                                            CEU003
     C********************************************************************CEU003
     C* SUBROUTINE TO SET UP EAMT, OTRA AND OTRC FOR OUTPUT TO            CEU003
     C* PREXPH                                                            CEU003
     C*                                                                   CEU003
     CSR         AMNTEU    BEGSR                                          CEU003
     C*                                                                   CEU003
     C                     MOVE EAMT      W#EAMT                          CEU003
     C*                                                                   CEU003
     C* If settlement currency present, convert Event amount from         CEU003
     C* Transaction currency to settlement currency using EU0200.         CEU003
     C*                                                                   CEU003
     C           W#STCY    IFNE *BLANK                                    CEU003
     C                     CALL 'EU0200'                                  CEU003
     C                     PARM *BLANK    P@RTCD  7                       CEU003
     C                     PARM W#EAMT    P@FRAM 183                      CEU003
     C                     PARM W#TRCY    P@FRCY  3                       CEU003
     C                     PARM W#STCY    P@TOCY  3                       CEU003
     C           EAMT      PARM           P@OUTA 150                      CEU003
     C                     PARM           P@INTA 183                      CEU003
     C                     PARM           P@EXRT 159                      CEU003
     C                     PARM           P@MDIN  1                       CEU003
     C*                                                                   CEU003
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU003
     C                     MOVEL'EU0200  'DBFILE 10        * * * * * * *  CEU003
     C                     MOVEL'026'     DBASE   3        * DBERR 026 *  CEU003
     C                     MOVELP@RTCD    DBOPTN  7        * * * * * * *  CEU003
     C                     MOVEL*BLANK    DBKEY  29                       CEU003
     C                     SETON                     U7U8LR               CEU003
     C                     EXSR *PSSR                                     CEU003
     C                     ENDIF                                          CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C* Set up fields OTRA and OTRC                                       CEU003
     C*                                                                   CEU003
     C           W#IC72    IFNE *BLANK                                    CEU003
     C           W#IC72    IFEQ W#TRCY                                    CEU003
     C                     Z-ADDW#EAMT    OTRA                            CEU003
     C                     MOVE W#TRCY    OTRC                            CEU003
     C                     ELSE                                           CEU003
     C                     CALL 'EU0200'                                  CEU003
     C                     PARM *BLANK    P@RTCD  7                       CEU003
     C                     PARM W#EAMT    P@FRAM 183                      CEU003
     C                     PARM W#TRCY    P@FRCY  3                       CEU003
     C                     PARM W#IC72    P@TOCY  3                       CEU003
     C           OTRA      PARM           P@OUTA 150                      CEU003
     C                     PARM           P@INTA 183                      CEU003
     C                     PARM           P@EXRT 159                      CEU003
     C                     PARM           P@MDIN  1                       CEU003
     C                     MOVE W#IC72    OTRC                            CEU003
     C                     ENDIF                                          CEU003
     C                     ELSE                                           CEU003
     C                     Z-ADD0         OTRA                            CEU003
     C                     MOVE *BLANK    OTRC                            CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     CSR                   ENDSR                             ** ENDSR **  CEU003
     C********************************************************************
     C/SPACE 3
     C********************************************************************066550
     C***********                                                         066550
     C*****GLINTC SR. TO CALCULATE INTEREST BETWEEN ANY TWO DAY NUMBERS.  066550
     C***********                                                         066550
     C*****THIS*VERSION REPLACES THE ORIGINAL GLINTC SR. NOW NAMED        066550
     C*****GLINTO.                                                        066550
     C***********                                                         066550
     C*****CALCULATION METHODS ARE -                                      066550
     C*****1**ACTUAL/365                                                  066550
     C*****2**ACTUAL/360                                                  066550
     C*****3**360/360 (SOMETIMES CALLED 30/360)                           066550
     C*****4**365/365 (EXCLUDING 29/02)                                   066550
     C*****5**365/360 (EXCLUDING 29/02)                                   066550
     C*****6**ACTUAL/366                                                  066550
     C***********                                                         066550
     C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.                     066550
     C***********                                                         066550
     C***********                                                         066550
     C*R*********GLINTC    BEGSR                           ** GLINTC  **  066550
     C***********                                                         066550
     C*****CALCULATIONS TO DEFINE INPUT FIELDS.                           066550
     C*R*********          Z-ADDZIBEG     ZIBEG   50       STARTING DATE  066550
     C*R*********          Z-ADDZIEND     ZIEND   50       FINISHING DATE 066550
     C*R*********          Z-ADDZICALC    ZICALC  10       CALC. BASIS    066550
     C*R*********          Z-ADDZIAMT     ZIAMT  150       PRINCIPAL      066550
     C*R*********          Z-ADDZIRATE    ZIRATE 117       RATE OF INTRST 066550
     C***********                                                         066550
     C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED           066550
     C*R*********ZIEND     SUB  ZIBEG     ZDAYN1  50                      066550
     C***********                                                         066550
     C****CHECK*FOR INTEREST CALCULATION BASIS                            066550
     C*****USE*OF INDICATRS                                               066550
     C*****1,92**2,90  3,91  4,97  5,96  6,95                             066550
     C*R*********ZICALC    COMP 2                    919290               066550
     C**N91******          GOTO ZILPCK                                    066550
     C***********ZICALC    COMP 5                    959796               066550
     C***97******ZICALC    COMP 3                    97  91               066550
     C***95******                                                         066550
     C*R*96******          SETOF                     91                   066550
     C**N91******          GOTO ZILPCK                                    066550
     C***********                                                         066550
     C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WHEN      066550
     C*****USING*THE 30/360 BASIS - METHOD 3.                             066550
     C***********          EXSR ZSAVE                                     066550
     C***********          Z-ADDZIBEG     ZDAYNO                          066550
     C***********          EXSR ZDATE2                                    066550
     C***********          MOVE ZDAY      ZISD    20                      066550
     C***********          MOVE ZMTH      ZISM    20                      066550
     C***********          MOVE ZYEAR     ZISY    20                      066550
     C***********          Z-ADDZIEND     ZDAYNO                          066550
     C***********          EXSR ZDATE2                                    066550
     C***********          MOVE ZDAY      ZIFD    20                      066550
     C***********          MOVE ZMTH      ZIFM    20                      066550
     C***********          MOVE ZYEAR     ZIFY    20                      066550
     C***********          EXSR ZRSTOR                                    066550
     C***********          SETOF                     93                   066550
     C****IN*ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YEAR IF  066550
     C****ZIEND*IS GREATER THAN ZIBEG,THEN THE DATE ZIEND MUST BE IN A    066550
     C****DIFFERENT CENTURY TO ZIBEG.IF SO ADD 100 YEARS TO IT.           066550
     C***********ZIEND     COMP ZIBEG                93                   066550
     C***93******ZIFY      COMP ZISY                   93                 066550
     C***********          Z-ADDZISY      ZISY2   30                      066550
     C**N93******          Z-ADDZIFY      ZIFY2   30                      066550
     C***93******ZIFY      ADD  100       ZIFY2                           066550
     C***********                                                         066550
     C*****DETERMINE WHETHER START YEAR IS A LEAP YEAR AND IF START       066550
     C*****MONTH*IS FEBRUARY.                                             066550
     C***********                                                         066550
     C**N98******          BITOF'0'       ZGLBIT  1                       066550
     C***98******          BITON'0'       ZGLBIT                          066550
     C***********ZISY2     ADD  1900      ZLYCHK  40                      066550
     C***********ZLYCHK    DIV  4         ZLYCHK                          066550
     C***********          MVR            ZLYREM  20                      066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YEAR     066550
     C***********ZISM      COMP 2                        99*FEBRUARY      066550
     C**N99******30        SUB  ZISD      ZID1    50   93                 066550
     C**N99*93***          Z-ADD0         ZID1                            066550
     C***99N98***28        SUB  ZISD      ZID1                            066550
     C***99*98***29        SUB  ZISD      ZID1                            066550
     C***********ZISM      COMP 12                       93               066550
     C***93******          Z-ADD0         ZISM                            066550
     C***93******ZISY      ADD  1         ZISY                            066550
     C***93******ZISY2     ADD  1         ZISY2                           066550
     C***********                                                         066550
     C*****DETERMINE WHETHER END YEAR IS A LEAP YEAR AND IF END MONTH     066550
     C*****IS*FEBRUARY.                                                   066550
     C***********                                                         066550
     C***********ZIFY2     ADD  1900      ZLYCHK  40                      066550
     C***********ZLYCHK    DIV  4         ZLYCHK                          066550
     C***********          MVR            ZLYREM  20                      066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YEAR     066550
     C***********ZIFM      COMP 2                        99*FEBRUARY      066550
     C**N99******ZIFD      COMP 31                       93               066550
     C***99N98***ZIFD      COMP 28                       93               066550
     C***99*98***ZIFD      COMP 29                       93               066550
     C***********          SETOF                     98                   066550
     C***********          TESTB'0'       ZGLBIT         98               066550
     C***93******ZID1      ADD  30        ZID1                            066550
     C**N93******ZID1      ADD  ZIFD      ZID1                            066550
     C***********ZIFM      SUB  1         ZIFM                            066550
     C***********ZISY      COMP ZIFY                     93               066550
     C***93******ZIFM      SUB  ZISM      ZINOM   30                      066550
     C***93******          GOTO ZIOUT                                     066550
     C***********12        SUB  ZISM      ZIM1    20                      066550
     C***********          Z-ADD1         ZISM                            066550
     C*****USE*ENLARGED FIELDS THAT CAN HANDLE 1999 ONWARDS               066550
     C***********ZISY2     ADD  1         ZISY2                           066550
     C***********ZIFY2     SUB  ZISY2     ZIY1    20                      066550
     C***********ZIY1      MULT 12        ZIM2    30                      066550
     C***********ZIM2      ADD  ZIFM      ZIM2                            066550
     C***********ZIM1      ADD  ZIM2      ZINOM                           066550
     C***********ZIOUT     TAG                             * ZIOUT TAG *  066550
     C***********ZINOM     MULT 30        ZID2    50                      066550
     C***********ZID2      ADD  ZID1      ZDAYN1                          066550
     C***********          SETOF                     93                   066550
     C***********ZILPCK    TAG                             * ZILPCK TAG * 066550
     C**N96N97***          GOTO ZICAL                                     066550
     C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.         066550
     C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 FEB   066550
     C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, & ZIEND.066550
     C***********                                                         066550
     C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                        066550
     C***********ZDAYN1    DIV  1461      ZIMAN   20                      066550
     C***********          MVR            ZIREM   50                      066550
     C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.                    066550
     C***********ZIBEG     SUB  60        ZIBW1   50                      066550
     C***********ZIBW1     DIV  1461      ZIDW1   20                      066550
     C***********          MVR            ZIDREM  50                      066550
     C***********ZIDREM    COMP 0                        94               066550
     C***94******          Z-ADDZIBEG     ZIDW2   50                      066550
     C***94******          GOTO ZILP1                                     066550
     C*****ROUND*UP RESULT                                                066550
     C***********ZIDW1     ADD  1         ZIDW2                           066550
     C*****CALCULATE NEXT 29 FEB.                                         066550
     C***********ZIDW2     MULT 1461      ZIDW2                           066550
     C***********ZIDW2     ADD  60        ZIDW2                           066550
     C***********ZILP1     TAG                             * ZILP1 TAG *  066550
     C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO        066550
     C*****ZIREM*THEN ADD 1 TO ZIMAN.                                     066550
     C***********ZIDW2     SUB  ZIBEG     ZILPCP  50                      066550
     C***********ZIREM     COMP ZILPCP               94  94               066550
     C***94******ZIMAN     ADD  1         ZIMAN                           066550
     C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1             066550
     C*****REQUIRED FOR THIS INTEREST CALCULATION.                        066550
     C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                          066550
     C***********          SETOF                     94                   066550
     C***********ZICAL     TAG                             * ZICAL TAG *  066550
     C***********                                                         066550
     C****CALCULATE INTEREST                                              066550
     C***90******                                                         066550
     C*R*91******                                                         066550
     C*R*96******ZIAMT     DIV  36000     ZIWRK1 155H                     066550
     C***92******                                                         066550
     C*R*97******ZIAMT     DIV  36500     ZIWRK1    H                     066550
     C***95******ZIAMT     DIV  36600     ZIWRK1    H                     066550
     C*R*********ZIWRK1    MULT ZIRATE    ZIWRK2 155H                     066550
     C*R*********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF INTRST 066550
     C***********                                                         066550
     C***********          SETOF                     909192               066550
     C***********          SETOF                     959697               066550
     C*R*********          ENDSR                                          066550
     C***********                                                         066550
     C********************************************************************066550
     C/SPACE
     C********************************************************************
     C**
     C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS
     C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.
     C**
     C**   THIS SR. IS REQUIRED ONLY IF INDICATORS
     C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.
     C**
     C           ZSAVE     BEGSR                           *** ZSAVE ***
     C**
     C                     BITOF'01234567'ZBITS   1
     C   90                BITON'0'       ZBITS
     C   91                BITON'1'       ZBITS
     C   92                BITON'2'       ZBITS
     C   93                BITON'3'       ZBITS
     C   94                BITON'4'       ZBITS
     C   95                BITON'5'       ZBITS
     C   96                BITON'6'       ZBITS
     C   97                BITON'7'       ZBITS
     C**
     C                     SETOF                     909192
     C                     SETOF                     939495
     C                     SETOF                     9697
     C**
     C                     ENDSR
     C**
     C**
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C**
     C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS
     C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.
     C**
     C           ZRSTOR    BEGSR                           *** ZRSTOR ***
     C**
     C                     TESTB'0'       ZBITS          90
     C                     TESTB'1'       ZBITS          91
     C                     TESTB'2'       ZBITS          92
     C                     TESTB'3'       ZBITS          93
     C                     TESTB'4'       ZBITS          94
     C                     TESTB'5'       ZBITS          95
     C                     TESTB'6'       ZBITS          96
     C                     TESTB'7'       ZBITS          97
     C**
     C                     ENDSR
     C**
     C**
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C**
     C**
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* CONTROL CHECK ONLF/DTRIN DURING I/P CYCLE ORLF/DLIND AT END OF DAY
     C           TTRANS    BEGSR                           *** TTRANS ***
     C* FOR 'H' AND 'T'
     C           RIP,3     ADD  2         RIP,3
     C  N55N89   RIP,3     COMP RIP,5                5555
     C  N55 89   RIP,1     COMP RIP,3                5555
     C   55                SETON                     U8
     C                     ENDSR
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C* CONTROL CHECK ON LF/DAIND *END OF DAY*
     C           TDAIND    BEGSR                           *** TDAIND ***
     C* FOR 'H' AND 'T'
     C           RIP,4     ADD  2         RIP,4
     C  N56      RIP,2     COMP RIP,4                5656
     C   56                SETON                     U8
     C                     ENDSR
     C********************************************************************
     C/SPACE 3
     C********************************************************************
0880 C*****                                                       *****   S01194
0881 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD*   S01194
0882 C*****                                                       *****   S01194
0883 C*****      ZSYSTM    BEGSR                           *** ZSYSTM**** S01194
0884 C*****                                                       *****   S01194
0885 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.            *****   S01194
0886 C*****                MOVEL'01      'ZTABKY 12               *****   S01194
0887 C*****                MOVE '  10'    ZTABKY                  *****   S01194
0888 C*****                                                       *****   S01194
0889 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0890 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0891 C*****                                                       *****   S01194
0892 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.            *****   S01194
0893 C*****      DATF      COMP 'M'                      98MMDDYY,*98*ON  S01194
0894 C*****                                                       *****   S01194
0895 C*****                ENDSR                                  *****   S01194
0896 C*****                                                       *****   S01194
2655 C********************************************************************
     C/EJECT                                                              S01119
     C*****************************************************************
     C*
     C* SUBROUTINE : #ZZ
     C*
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF
     C* NO RECORDS READ AND THEREFORE SDBANKPD NOT READ
     C*
     C           #ZZ       BEGSR
     C*
     C** IF FIRST CYCLE NOT PERFORMED GET BANK DETAILS FOR HEADINGS
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBANKPD'DBFILE 10        ************
     C                     MOVEL'018'     DBASE   3        * DBERR 018*
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     MOVEL@OPTN     DBKEY  29
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     GOTO #ZZ9
     C                     END
     C*
     C           #ZZ9      ENDSR
     C*****************************************************************
     C/EJECT                                                                                  234068
      *****************************************************************                       234068
      *                                                               *                       234068
      *  SRCHKD - Subroutine to check the effectivity date            *                       234068
      *                                                               *                       234068
      *****************************************************************                       234068
     C           SRCHKD    BEGSR                                                              234068
      *                                                                                       234068
      ** Access the Branch details to get location code                                       234068
      *                                                                                       234068
     C                     CALL 'AOBRCHR0'                                                    234068
     C                     PARM '*MSG    'PRTCD                                               234068
     C                     PARM '*KEY    'POPTN                                               234068
     C                     PARM BRCA      PDSNB   3                                           234068
     C           SDBRCH    PARM SDBRCH    DSFDY                                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Access the Country of Tax using the branch's location code                           234068
      *                                                                                       234068
     C                     CALL 'AOLOCNR0'                                                    234068
     C                     PARM *BLANKS   PRTCD                                               234068
     C                     PARM '*KEY   ' POPTN                                               234068
     C                     PARM A8LCCD    PLOCN   3                                           234068
     C           SDLOCN    PARM SDLOCN    DSFDY                                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Retreive the country of residence of the customer                                    234068
      *                                                                                       234068
     C                     CALL 'AOCUSTR0'                                                    234068
     C                     PARM *BLANKS   PRTCD                                               234068
     C                     PARM '*KEY   ' POPTN                                               234068
     C                     PARM WCNUM     PCNUM  10                                           234068
     C                     PARM           PKEYS   7                                           234068
     C           SDCUST    PARM SDCUST    DSSDY                                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Retrieve effective date                                                              234068
      *                                                                                       234068
     C                     CALL 'AOCTTXR0'                                                    234068
     C                     PARM *BLANKS   PRTCD                                               234068
     C                     PARM '*KEY   ' POPTN                                               234068
     C                     PARM DVCNCD    PCTRT   2                                           234068
     C                     PARM BBCOLC    PCTRR   2                                           234068
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234068
      *                                                                                       234068
      ** If no record is found, access with country of tax only                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     CALL 'AOCTTXR0'                                                    234068
     C                     PARM *BLANKS   PRTCD                                               234068
     C                     PARM '*KEY   ' POPTN                                               234068
     C                     PARM DVCNCD    PCTRT                                               234068
     C                     PARM *BLANKS   PCTRR                                               234068
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234068
      *                                                                                       234068
     C           PRTCD     IFNE *BLANKS                                                       234068
     C                     ENDIF                                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
      ** Set Flag EU, Local or German                                                       MD027601
      *                                                                                     MD027601
     C           BBCOLC    IFNE EWCTRT                                                      MD027601
     C                     MOVE 'E'       WELGTX  1                                         MD027601
     C                     ELSE                                                             MD027601
      *                                                                                     MD027601
     C           CER048    IFEQ 'Y'                                                         MD027601
      *                                                                                     MD027601
     C           BBCOLC    IFEQ EWCTRT                                                      MD027601
     C           EWTHMD    ANDEQ'Y'                                                         MD027601
     C                     MOVE 'G'       WELGTX                                            MD027601
     C                     ELSE                                                             MD027601
     C                     MOVE 'L'       WELGTX                                            MD027601
     C                     ENDIF                                                            MD027601
      *                                                                                     MD027601
     C                     ELSE                                                             MD027601
      *                                                                                     MD027601
     C                     MOVE 'G'       WELGTX                                            MD027601
     C                     ENDIF                                                            MD027601
      *                                                                                     MD027601
     C                     ENDIF                                                            MD027601
      *                                                                                     MD027601
     C           WKMDAT    IFLT EWEDT1                                                        234068
     C           WELGTX    OREQ 'E'                                                         MD027601
     C           TAXI      OREQ 'N'                                                         MD030373
     C                     MOVE 'Y'       WSKIP   1                                           234068
     C                     ELSE                                                               234068
     C                     MOVE 'N'       WSKIP                                               234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C                     ENDSR                                                              234068
      *****************************************************************                       234068
     C/EJECT                                                                                  234068
      *****************************************************************                       234068
      *                                                               *                       234068
      *  SRCEUT - Calculate EU Tax Amount                             *                       234068
      *                                                               *                       234068
      *****************************************************************                       234068
     C           SRCEUT    BEGSR                                                              234068
      *                                                                                       234068
     C                     Z-ADD*ZEROS    WNTAMT 130                                          234068
      *                                                                                       234068
      ** Call EU Tax Calculation for Private Individual                                       234068
      *                                                                                       234068
     C                     CALL 'ZATXCLPI'                                                    234068
      *                                                                                       234068
     C                     PARM 'D'       @@MODI  1                                           234068
     C                     PARM WDLNO     @@TRRF 18                                           234068
     C                     PARM BRCA      @@BRCA  3                                           234068
     C                     PARM WCNUM     @@CUST  6                                           234068
     C                     PARM VDAT      @@STRD  50                                          234068
     C                     PARM WKMDAT    @@ENDD  50                                          234068
     C                     PARM TOTI      @@TOTI 150                                          234068
     C                     PARM *ZERO     @@TAXR  64                                          234068
     C                     PARM CCY       @@OCCY  3                                           234068
     C                     PARM *BLANKS   PINTH   1                                           CER048
      *                                                                                       234068
      ** Output parameters                                                                    234068
      *                                                                                       234068
     C                     PARM           @@IAED 150                                          234068
     C                     PARM           @@TAXA 150                                          234068
     C                     PARM           @@TOTO 150                                          234068
     C                     PARM           @@TXCY  3                                           234068
     C                     PARM           @@CTAX  2                                           234068
     C                     PARM           @@TXBS  2                                           234068
     C                     PARM           @@WTAC  40                                          234068
     C                     PARM           @@COLC  2                                           234068
     C                     PARM           @@STAT  5                                           234068
     C                     PARM           @@TRTE  1                                           234068
     C                     PARM           @@TXR1  64                                          234068
     C**********           PARM *ZEROS    PSTXB   20                                 CER048 BUG22911
     C**********           PARM *ZEROS    PSTAC  100                                 CER048 BUG22911
     C**********           PARM *ZEROS    PSTTR   64                                 CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP   1                                  CER048 BUG22911
     C**********           PARM *ZEROS    PSTXA  150                                 CER048 BUG22911
     C                     PARM           @@KEY  10                                           234068
     C                     PARM           @@FILE 10                                           234068
     C                     PARM           @@RTRN  7                                           234068
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       234068
     C                     SELEC                                                              234068
      *                                                                                       234068
     C           @@RTRN    WHEQ 'ERROR'                                                       234068
     C                     MOVE @@FILE    DBFILE                                              234068
     C                     MOVE @@KEY     DBKEY                                               234068
     C                     MOVE '1'       *IN15                                               234068
     C                     EXSR *PSSR                                                         234068
      *                                                                                       234068
     C           @@RTRN    WHNE 'JOINT'                                                       234068
     C                     Z-ADD@@TAXA    WNTAMT                                              234068
      *                                                                                     MD027601
      ** Add Second Tax if CER048 is switched ON.                                           MD027601
      *                                                                                     MD027601
     C           CER048    IFEQ 'Y'                                                         MD027601
     C                     ADD  PSTXA     WNTAMT                                            MD027601
     C                     ENDIF                                                            MD027601
      *                                                                                     MD027601
      ** Add Third Tax if CER054 is switched ON.                                            MD027601
      *                                                                                     MD027601
     C           CER054    IFEQ 'Y'                                                         MD027601
     C                     ADD  PTTXA     WNTAMT                                            MD027601
     C                     ENDIF                                                            MD027601
      *                                                                                     MD027601
      *                                                                                       234068
     C           @@RTRN    WHEQ 'JOINT'                                                       234068
     C                     EXSR SRCALJ                                                        234068
     C                     ENDSL                                                              234068
      *                                                                                       234068
      ** Calculate Tax according to the effective date                                        234068
      *                                                                                       234068
     C           EWTRT1    IFEQ '1'                                                           234068
     C           VDAT      ANDLTEWEDT1                                                        234068
     C           WKMDAT    SUB  VDAT      WINTP   50                                          234068
     C           WKMDAT    SUB  EWEDT1    WEFFP   50                                          234068
      *                                                                                       234068
     C           WNTAMT    MULT WEFFP     WEFAMT 160                                          234068
     C           WEFAMT    DIV  WINTP     WNTAMT                                              234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C                     ENDSR                                                              234068
      *****************************************************************                       234068
     C/EJECT                                                                                  234068
      *****************************************************************                       234068
      *                                                               *                       234068
      *  SRCJAH - Calculate EU Tax Amount for Joint Account Members   *                       234068
      *                                                               *                       234068
      *****************************************************************                       234068
     C           SRCALJ    BEGSR                                                              234068
      *                                                                                       234068
     C           WCNUM     SETLLSDJACCLB                                                      234068
     C           WCNUM     READESDJACCLB                 21                                   234068
      *                                                                                       234068
     C                     Z-ADD*ZEROS    WTAXA                                               234068
      *                                                                                       234068
     C           *IN21     DOWEQ'0'                                                           234068
      *                                                                                       234068
     C                     EXSR SRCZJA                                                        234068
      *                                                                                       234068
     C           @@RTRN    IFEQ 'ERROR'                                                       234068
     C                     MOVE @@FILE    DBFILE                                              234068
     C                     MOVE @@KEY     DBKEY                                               234068
     C                     MOVE '1'       *IN15                                               234068
     C                     EXSR *PSSR                                                         234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           @@STAT    IFEQ 'TAXAB'                                                       234068
     C           @@STAT    OREQ 'DISCL'                                                       234068
     C           @@STAT    OREQ 'SELF '                                                       234068
     C                     ADD  @@TAXA    WTAXA  150                                          234068
      *                                                                                    MD027307A
     C           CER048    IFEQ 'Y'                                                        MD027307A
     C                     ADD  PSTXA     WTAXA                                            MD027307A
     C                     ENDIF                                                           MD027307A
      *                                                                                    MD027307A
     C           CER054    IFEQ 'Y'                                                        MD027307A
     C                     ADD  PTTXA     WTAXA                                            MD027307A
     C                     ENDIF                                                           MD027307A
      *                                                                                    MD027307A
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           @@RTRN    IFEQ 'NOTAX'                                                       234068
     C           @@RTRN    OREQ 'TAXAB'                                                       234068
     C           WCNUM     READESDJACCLB                 21                                   234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C           @@RTRN    IFEQ 'LAST '                                                       234068
     C                     MOVE '1'       *IN21                                               234068
     C                     ENDIF                                                              234068
      *                                                                                       234068
     C                     ENDDO                                                              234068
      *                                                                                       234068
      ** Accumulate the taxa amount from the account holder and                               234068
      ** non-account holder                                                                   234068
      *                                                                                       234068
     C                     ADD  WTAXA     WNTAMT                                              234068
      *                                                                                       234068
     C                     ENDSR                                                              234068
      *****************************************************************                       234068
     C/EJECT                                                                                  234068
      *****************************************************************                       234068
      *                                                               *                       234068
      *  SRCZJA - Calls European W/Tax Calculation for Joint Accounts *                       234068
      *                                                               *                       234068
      *****************************************************************                       234068
     C           SRCZJA    BEGSR                                                              234068
      *                                                                                       234068
     C                     CALL 'ZATXCLJA'                                                    234068
     C                     PARM 'D'       @@MODI                                              234068
     C                     PARM WDLNO     @@TRRF                                              234068
     C                     PARM BRCA      @@BRCA                                              234068
     C                     PARM WCNUM     @@JANO  6                                           234068
     C                     PARM JCCUST    @@CUST                                              234068
     C                     PARM JCNAHO    @@NARF 10                                           234068
     C                     PARM JCINVP    @@INVP 10                                           234068
     C                     PARM JCPAHT    PPAHT   1                                         BUG26839
     C                     PARM VDAT      @@STRD                                              234068
     C                     PARM WKMDAT    @@ENDD                                              234068
     C                     PARM TOTI      @@TOTI                                              234068
     C                     PARM *ZERO     @@TAXR                                              234068
     C                     PARM CCY       @@OCCY                                              234068
     C                     PARM *BLANKS   PINTH                                               CER048
      *                                                                                       234068
      ** Output parameters                                                                    234068
      *                                                                                       234068
     C                     PARM           @@IAED                                              234068
     C                     PARM           @@TAXA                                              234068
     C                     PARM           @@TOTO                                              234068
     C                     PARM           @@TXCY                                              234068
     C                     PARM           @@CTAX                                              234068
     C                     PARM           @@TXBS                                              234068
     C                     PARM           @@WTAC                                              234068
     C                     PARM           @@COLC                                              234068
     C                     PARM           @@STAT                                              234068
     C                     PARM           @@TRTE                                              234068
     C                     PARM           @@TXR1                                              234068
     C                     PARM           @@JAMG  1                                           234068
     C**********           PARM *ZEROS    PSTXB                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTAC                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTTR                                      CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTXA                                      CER048 BUG22911
     C                     PARM           @@KEY                                               234068
     C                     PARM           @@FILE                                              234068
     C                     PARM           @@RTRN                                              234068
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       234068
     C                     ENDSR                                                              234068
      *****************************************************************                       234068
1034 C/EJECT
0726 C*****************************************************************   S01194
1024 C*    ERROR DUMP SUBROUTINE.                                         S01194
1048 C*                                                                   S01194
1034 C           *PSSR     BEGSR                           ***  PSSR **   S01194
1020 C           @RUN      IFEQ *BLANK                                    S01194
1021 C                     MOVE 'Y'       @RUN    1                       S01194
1020 C                     DUMP                                           S01194
1021 C                     END                                            S01194
1022 C                     ENDSR                           *** *PSSR **   S01194
1048 C**                                                                  S01194
     C********************************************************************
     C/COPY WNCPYSRC,DL1705C103
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC1 - Processing #1 for CF deals                          *                       CDL033
      *         - Retrieve extension details of deal                  *                       CDL033
      *         - Rate fix date processing                            *                       CDL033
      *         - Value date processing                               *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
     C           SRFRC1    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Retrieve extension details of deal.                                                  CDL033
      ** DB error if not found.                                                               CDL033
      *                                                                                       CDL033
     C           *IN60     IFEQ *ON                                                           CDL033
     C                     MOVE '903'     DBASE                                               CDL033
     C                     MOVELDLNODC    DBKEY                                               CDL033
     C                     MOVEL'MMDELDY1'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO END                                                           CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Initialise secondary rate fix date processed flag.                                   CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    WWINFF  1                                           CDL033
      *                                                                                       CDL033
      ** Perform rate fixing if this is an end of day run.                                    CDL033
      *                                                                                       CDL033
     C           *IN89     IFEQ *ON                                                           CDL033
     C                     EXSR SRFRC2                                                        CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Reset processing flag to blank.                                                      CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    WCFLAG  1                                           CDL033
      *                                                                                       CDL033
      ** Initialise interest calculation work fields.  Work                                   CDL033
      ** fields are used to prevent file fields from being                                    CDL033
      ** changed.                                                                             CDL033
      *                                                                                       CDL033
     C                     Z-ADDIACD      WIACD   50                                          CDL033
     C                     Z-ADDAITC      WAITC  130                                          CDL033
     C                     Z-ADDIPRD      WIPRD  130                                          CDL033
     C                     MOVE XKINFF    WINFF   1                                           CDL033
      *                                                                                       CDL033
     C                     Z-ADDINTR      ZIRATE                                              CDL033
     C                     Z-ADDICBS      ZICALC                                              CDL033
     C                     Z-ADDPCPL      ZIAMT                                               CDL033
      *                                                                                       CDL033
      ** Value date processing.                                                               CDL033
      *                                                                                       CDL033
      ** Set up effective rate for value date if this rate                                    CDL033
      ** has to be set to the fixed base rate.                                                CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC3                                                        CDL033
      *                                                                                       CDL033
      ** Process rate change date.                                                            CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFLE VDAT                                                          CDL033
     C                     EXSR SRFRC4                                                        CDL033
     C                     MOVE 'Y'       WCFLAG                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           EFRC1     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC2 - Processing #2 for CF deals                          *                       CDL033
      *         - Rate fix date processing during end of day run      *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC2    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** No further processing required if rate fix date has                                  CDL033
      ** not been reached yet, or is equal to zero or it has                                  CDL033
      ** already been processed.                                                              CDL033
      *                                                                                       CDL033
     C           XKINFD    IFGT WEVCD                                                         CDL033
     C           XKINFD    OREQ *ZERO                                                         CDL033
     C           XKINFF    OREQ 'Y'                                                           CDL033
     C                     GOTO EFRC2                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Flag rate fix date as to be processed in this                                        CDL033
      ** run.                                                                                 CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WWINFF                                              CDL033
      *                                                                                       CDL033
      ** Retrieve base rate details.                                                          CDL033
      ** DB error if not found.                                                               CDL033
      *                                                                                       CDL033
     C                     MOVELBRTT      @BBSRT                                              CDL033
     C                     CALL 'AOBSRTR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*KEY   ' @OPTN                                               CDL033
     C                     PARM CCY       @BCCY                                               CDL033
     C                     PARM           @BBSRT                                              CDL033
     C           SDBSRT    PARM SDBSRT    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE *BLANKS                                                       CDL033
     C                     MOVE '904'     DBASE                                               CDL033
     C                     MOVELCCY       WDBKEY  5                                           CDL033
     C                     MOVE BRTT      WDBKEY                                              CDL033
     C                     MOVELWDBKEY    DBKEY                                               CDL033
     C                     MOVEL@OPTN     DBOPTN                                              CDL033
     C                     MOVEL'SDBSRTPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO END                                                           CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** If rate fix date falls before value date of new                                      CDL033
      ** rate, use old base rate.                                                             CDL033
      *                                                                                       CDL033
     C           XKINFD    IFLT BAVDNR                                                        CDL033
     C                     Z-ADDBACBSR    WCFRAT 117                                          CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDBANBRT    WCFRAT                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Add spread rate to base rate.                                                        CDL033
      *                                                                                       CDL033
     C           WCFRAT    ADD  RTSP      WCFRAT                                              CDL033
     C           WCFRAT    IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     WCFRAT                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           EFRC2     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC3 - Processing #3 for CF deals                          *                       CDL033
      *         - Value date processing:                              *                       CDL033
      *           (1) set effective rate to fixed base rate           *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC3    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Bypass processing if rate for value date has been                                    CDL033
      ** set already.                                                                         CDL033
      *                                                                                       CDL033
     C           XKBSVF    IFEQ 'Y'                                                           CDL033
     C                     GOTO EFRC3                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Update effective rate only if base rate has been                                     CDL033
      ** fixed or if rate fix date is to be processed in                                      CDL033
      ** this run.                                                                            CDL033
      *                                                                                       CDL033
     C           WINFF     IFEQ 'Y'                                                           CDL033
     C           XKBSRF    ADD  RTSP      ZIRATE                                              CDL033
     C           ZIRATE    IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ELSE                                                               CDL033
     C           WWINFF    IFEQ 'Y'                                                           CDL033
     C                     Z-ADDWCFRAT    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Reset the rate fix date flags.                                                       CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    WINFF                                               CDL033
     C                     MOVE *BLANK    WWINFF                                              CDL033
      *                                                                                       CDL033
     C           EFRC3     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC4 - Processing #4 for CF deals                          *                       CDL033
      *         - Rate change processing:                             *                       CDL033
      *           (1) update accrued interest to control date         *                       CDL033
      *           (2) set effective rate to fixed base rate           *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC4    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Bypass processing in this subroutine if rate change                                  CDL033
      ** date is zero.                                                                        CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFEQ *ZERO                                                         CDL033
     C                     GOTO EFRC4                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date.                                             CDL033
      *                                                                                       CDL033
     C                     Z-ADDWIACD     ZIBEG                                               CDL033
     C                     Z-ADDXKRCDT    ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT                                               CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT  130H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           WAITC     ADD  WKINT     WAITC                                               CDL033
      *                                                                                       CDL033
      ** Reset interest accrual control date to rate change                                   CDL033
      ** date.                                                                                CDL033
      *                                                                                       CDL033
     C                     Z-ADDXKRCDT    WIACD                                               CDL033
      *                                                                                       CDL033
      ** Update effective rate only if base rate has been                                     CDL033
      ** fixed or if rate fix date is to be processed in                                      CDL033
      ** this run.                                                                            CDL033
      *                                                                                       CDL033
     C           WINFF     IFEQ 'Y'                                                           CDL033
     C           XKBSRF    ADD  RTSP      ZIRATE                                              CDL033
     C           ZIRATE    IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ELSE                                                               CDL033
     C           WWINFF    IFEQ 'Y'                                                           CDL033
     C                     Z-ADDWCFRAT    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           EFRC4     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC5 - Processing #5 for CF deals                          *                       CDL033
      *         - Interest date processing                            *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC5    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Bypass processing if next interest date is zero.                                     CDL033
      *                                                                                       CDL033
     C           NIDT      IFEQ *ZERO                                                         CDL033
     C                     GOTO EFRC5                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Process rate change date if it is not yet processed                                  CDL033
      ** before.                                                                              CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFLE NIDT                                                          CDL033
     C           WCFLAG    ANDEQ*BLANK                                                        CDL033
     C                     EXSR SRFRC4                                                        CDL033
     C                     MOVE 'Y'       WCFLAG                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date up to                                        CDL033
      ** interest payment date.                                                               CDL033
      *                                                                                       CDL033
     C                     Z-ADDWIACD     ZIBEG                                               CDL033
     C                     Z-ADDNIDT      ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT                                               CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT     H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           WAITC     ADD  WKINT     WAITC                                               CDL033
      *                                                                                       CDL033
      ** Reset interest accrual control date to next interest                                 CDL033
      ** date.                                                                                CDL033
      *                                                                                       CDL033
     C                     Z-ADDNIDT      WIACD                                               CDL033
      *                                                                                       CDL033
      ** Calculate interest due on interest date.                                             CDL033
      *                                                                                       CDL033
     C           WAITC     ADD  AIAP      INTDUE                                              CDL033
     C                     ADD  AIAN      INTDUE                                              CDL033
     C                     SUB  WIPRD     INTDUE                                              CDL033
     C                     SUB  ICTD      INTDUE                                              CDL033
      *                                                                                       CDL033
      ** Update interest paid / received to date.                                             CDL033
      *                                                                                       CDL033
     C                     ADD  INTDUE    WIPRD                                               CDL033
      *                                                                                       CDL033
     C           EFRC5     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC6 - Processing #6 for CF deals                          *                       CDL033
      *         - Maturity date processing                            *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC6    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Process rate change date if it is not yet processed                                  CDL033
      ** before.                                                                              CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFLE MDAT                                                          CDL033
     C           WCFLAG    ANDEQ*BLANK                                                        CDL033
     C                     EXSR SRFRC4                                                        CDL033
     C                     MOVE 'Y'       WCFLAG                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Calculate interest from accrued interest to control                                  CDL033
      ** date up to maturity.                                                                 CDL033
      *                                                                                       CDL033
     C                     Z-ADDWIACD     ZIBEG                                               CDL033
     C                     Z-ADDMDAT      ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT                                               CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT     H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Calculate interest due on maturity.                                                  CDL033
      *                                                                                       CDL033
     C           WAITC     ADD  WKINT     INTDUE                                              CDL033
     C                     ADD  AIAP      INTDUE                                              CDL033
     C                     ADD  AIAN      INTDUE                                              CDL033
     C                     SUB  WIPRD     INTDUE                                              CDL033
     C                     SUB  ICTD      INTDUE                                              CDL033
      *                                                                                       CDL033
     C           EFRC6     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C/EJECT
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
     C/EJECT                                                              126017
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/COPY WNCPYSRC,DL1705CP10                                           S01408
      /EJECT                                                              066550
     O*                  C O N T R O L   R E P O R T
     O/SPACE 3
     O*L1705P1T**203   LR                                                 S01117
     ODL1705AUT  203   LR                                                 S01117
     O*****                              22 'REFERENCE DL1705'    *****   S01117
     O                                   24 'REFERENCE DL1705AU'          S01117
2661 O*****                    TITL      89                       *****   S01194
2661 O                         BJURPT    89                               S01194
2662 O                                  122 'DATE              PAGE'
2663 O*****                    RUNA     112                       *****   S01194
2663 O                         BJMRDT   112                               S01194
     O                                  130 '1'
     O        T  1     LR
     O                                   63 'PAY/RECEIVE EXTRACT - FI'
     O                                   80 'LE CONTROL REPORT'
     O                                  113 'EXCEPTION'
     O                       89         113 'NON EXCEPTION'
     O        T  3     LR
     O                                   63 '------------------------'
     O                                   80 '-----------------'
     O        T  1     LR
     O                                   28 'S/DTRIN - RUN CONTROLS'
     O                       89          13 'DLIND'
     O                                   59 'NUMBER'
     O                                   84 'VALUE'
     O        T  2     LR
     O                                   28 '----------------------'
     O                                   59 'OF RECORDS'
     O                                   84 'OF RECORDS'
     O        T  2     LR
     O                                   31 'TOTAL RECORDS - ON FILE'
     O                      N89RIP,5 3   59
     O                       89RIP,1 3   59
     O        T  3     LR
     O                                   32 'TOTAL RECORDS - CALCULAT'
     O                                   34 'ED'
     O                         RIP,3 3   59
     O                       55         119 '***   DIFFERENCE   ***'
     O        T  1     LR 89
     O                                   28 'S/DAIND - RUN CONTROLS'
     O        T  2     LR 89
     O                                   28 '----------------------'
     O        T  2     LR 89
     O                                   31 'TOTAL RECORDS - ON FILE'
     O                         RIP,2 3   59
     O        T  3     LR 89
     O                                   32 'TOTAL RECORDS - CALCULAT'
     O                                   34 'ED'
     O                         RIP,4 3   59
     O                       56         119 '***   DIFFERENCE   ***'
     O        T  1     LR
     O                                   28 'S/PREX - RUN CONTROLS'
     O        T  2     LR
     O                                   28 '----------------------'
     O        T  3     LR
     O                                   28 'TOTAL RECORDS OUTPUT'
     O                         ROP   3   59
     O                         INT   Z   81
     O                         DEC       84
     O*                                                                   S01117
     O        T 3      LRNU7N25                                           S01117
0564 O                                   63 '***   NO DETAILS TO REPO'    S01117
0565 O                                   71 'RT   ***'                    S01117
     O*****   T 00     LRNU7                                      *****   S01117
     O********T*11     LRNU7 25                                     S01117LN0477
     O**********                         71 '*** END OF REPORT ***'       LN0477
     O/SPACE 3
2715 O*****DATABASE ERROR                                         *****   S01194
2716 O*****   T  203   LR U7                                      *****   S01194
2717 O*****                              22 'REFERENCE DL1705'    *****   S01194
2661 O*****                    TITL      89                       *****   S01194
2719 O*****                             122 'DATE              PAG*****   S01194
2720 O*****                    RUNA     112                       *****   S01194
2721 O*****                             130 '2'                   *****   S01194
2722 O*****   T  1     LR U7                                      *****   S01194
2723 O*****                              63 'PAY/RECEIVE EXTRACT -*****   S01194
2724 O*****                              75 'TABASE ERROR'        *****   S01194
2725 O*****                             113 'EXCEPTION'           *****   S01194
2726 O*****                  89         113 'NON EXCEPTION'       *****   S01194
2727 O*****   T  3     LR U7                                      *****   S01194
2728 O*****                              63 '---------------------*****   S01194
2729 O*****                              75 '------------'        *****   S01194
2730 O*****   T 3      U7 60 LR                                   *****   S01194
2731 O*****                              67 'INSTALLATION CONTROL *****   S01194
2732 O*****                              80 'ORD 1 MISSING'       *****   S01194
2733 O*****   T 3      U7 61 LR                                   *****   S01194
2734 O*****                              67 'INSTALLATION CONTROL *****   S01194
2735 O*****                              80 'ORD 2 MISSING'       *****   S01194
2736 O*****   T 3      U7 62 LR                                   *****   S01194
2737 O*****                           ***67**INSTALLATION*CONTROL*REC**   S01194
2738 O*****                              80 'ORD 5 MISSING'       *****   S01194
2739 O*****   T 3      U7 63 LR                                   *****   S01194
2740 O*****                              70 'DEFAULT BRANCH CODE R*****   S01194
2741 O*****                              80 'RD MISSING'          *****   S01194
2742 O*****   T 3      U7 64 LR                                   *****   S01194
2743 O*****                              58 'DEAL RECORD'         *****   S01194
2744 O*****                    DLNO      65                       *****   S01194
2745 O*****                              80 'MISSING *PROC1*'     *****   S01194
2746 O*****   T 3      U7 66 LR                                   *****   S01194
2747 O*****                              49 'DEAM RECORD'         *****   S01194
2748 O*****                    KEY       64                       *****   S01194
2749 O*****                              80 'MISSING *PROC2*'     *****   S01194
2750 O*****   T 3      U7 67 LR                                   *****   S01194
2751 O*****                              58 'DEAL RECORD'         *****   S01194
2752 O*****                    DLNO      65                       *****   S01194
2753 O*****                              80 'MISSING *PROC2*'     *****   S01194
2754 O*****   T 3      U7 68 LR                                   *****   S01194
2755 O*****                              48 'DEAM RECORD'         *****   S01194
2756 O*****                    KEY2      64                       *****   S01194
2757 O*****                              67 'OR'                  *****   S01194
2758 O*****                    KEY4      82                       *****   S01194
2759 O*****                              99 'MISSING *INTRES*'    *****   S01194
2760 O*****   T 3      U7 59 LR                                   *****   S01194
2761 O*****                              76 'NO BRANCH CODE'      *****   S01194
2762 O*****                    BRCD      80                       S01117  S01194
2762 O*****                    BRCA      80                       S01117  S01194
2763 O*****   T 3      U7 LR 83                                   *****   S01194
2764 O*****                              58 'TABLE FILE RECORD'   *****   S01194
2765 O*****                    ZTABKY    71                       *****   S01194
2766 O*****                              80 'MISSING'             *****   S01194
2767 O*****   T 3      U7 LR 84                                   *****   S01194
2768 O*****                              58 'SNAME FILE RECORD'   *****   S01194
2769 O*****                    CHK10     71                       *****   S01194
2770 O*****                              79 'MISSING'             *****   S01194
2771 O*****   T 3      LR U7 85                                   *****   S01194
2772 O*****                              58 'CLINT FILE RECORD'   *****   S01194
2773 O*****                    ZCLKEY    71                       S01177  S01194
2773 O*****                    ZCLKEY    67                       S01177  S01194
2774 O*****                              76 'MISSING'             *****   S01194
     O*****   T 3      U7 LR 90                                           S01177
     O*****                              70 'ERROR ON ACCESSING'          S01177
     O*****                              79 'SDNOSTPD'                    S01177
     O*****   T 3      U7 LR 91                                           S01177
     O*****                              58 'NOST FILE RECORD '           S01177
     O*****                    KEYB      62                               S01177
     O*****                    KEYE      66                               S01177
     O*****                              79 'MISSING'                     S01177
     O*****   T 3      U7 LR
     O*****                              71 '*** END OF REPORT ***'
     O*                                                                   S01117
     O** OUTPUT DATABASE ERROR IF NECESSARY                               S01117
     O/COPY WNCPYSRC,DL1705O001
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   49 'OPTION'                      S01117
     O                         DBOPTN    57                               S01117
     O                                   66 'KEY'                         S01117
     O                         DBKEY     96                               S01117
     O********T*13     LR U7 U8                                     S01117LN0477
     O**********                         71 '*** END OF REPORT ***'       LN0477
     O*                                                                   S01117
     O/EJECT
     O* O U T P U T   E X T R A C T S
     OPREXHH  HADD     1P
     O                                    1 'A'
     OPREXZZ  TADD     LR
     O                                    1 'T'
     O                         ROP        4P
     O                         INT       12P
     O                         DEC       14P
     OPREXPH  EADD     34
     O*************************PREX     160                               E22600
     O***********              PREX     182                        E22600 CEU003
     O**********               PREX     211                        CEU003 CIR003
     O**********               PREX     212                                            CIR003 CGL029
     O                         PREX     230                                                   CGL029
     O                         VDATPH    34P
     O                         EAMT      74P
     O                 88      RECIDL   160                               E20474
     O*DEALS***E                TLXIB                              E29588 071538
     O*********                TLXI     374                        E29588 071538
     ODEALS   E                REVROL                                     092905
     O                         RODN     191                               092905
     O*DEAMS***E                DAINB                              E29588 071538
     O*********                DAINDI   145                        E29588 071538
     O/SPACE 3
     O/SPACE 3
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** IPSET - I/P CYCLE SETTLEMENT TYPES
0102070812
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
     X/COPY WNCPYSRC,DL1705X001
** FXTERM Fixed Term Deals                                                                    CDL033
ITIPTDTICI
